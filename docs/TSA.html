<!DOCTYPE html><html lang="en"><head><title>Help for package TSA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TSA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TSA-package'><p>Time Series Analysis</p></a></li>
<li><a href='#acf'>
<p>Auto- and Cross- Covariance and -Correlation Function Estimation</p></a></li>
<li><a href='#airmiles'><p>Monthly Airline Passenger-Miles in the US</p></a></li>
<li><a href='#airpass'><p>Monthly total international airline passengers</p></a></li>
<li><a href='#ar1.2.s'><p>A simulated AR(1) series</p></a></li>
<li><a href='#ar1.s'><p>A simulated AR(1) series</p></a></li>
<li><a href='#ar2.s'><p>Asimulated AR(2) series / time series</p></a></li>
<li><a href='#arima'><p>Fitting an ARIMA model with Exogeneous Variables</p></a></li>
<li><a href='#arima.boot'><p>Compute the Bootstrap Estimates of an ARIMA Model</p></a></li>
<li><a href='#arimax'><p>Fitting an ARIMA model with Exogeneous Variables</p></a></li>
<li><a href='#arma11.s'><p> A Simulated ARMA(1,1) Series/ time series</p></a></li>
<li><a href='#ARMAspec'><p>Theoretical spectral density function of a stationary ARMA model</p></a></li>
<li><a href='#armasubsets'><p>Selection of Subset ARMA Models</p></a></li>
<li><a href='#beersales'><p>Monthly beer sales / time series</p></a></li>
<li><a href='#bluebird'><p>Blue Bird Potato Chip Data</p></a></li>
<li><a href='#bluebirdlite'>
<p>Bluebird Lite potato chip data</p></a></li>
<li><a href='#boardings'>
<p>Monthly public transit boardings and gasoline price in Denver</p></a></li>
<li><a href='#BoxCox.ar'><p>Determine the power transformation for serially correlated data</p></a></li>
<li><a href='#co2'><p>Levels of Carbon Dioxide at Alert, Canada / Time series</p></a></li>
<li><a href='#color'><p>Color property/time series</p></a></li>
<li><a href='#CREF'><p>Daily CREF Values</p></a></li>
<li><a href='#cref.bond'><p>Daily CREF Bond Values</p></a></li>
<li><a href='#days'><p>Number of days between payment to Winegard Corp. / time series</p></a></li>
<li><a href='#deere1'><p>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 1</p></a></li>
<li><a href='#deere2'><p>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 2</p></a></li>
<li><a href='#deere3'><p>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 3</p></a></li>
<li><a href='#detectAO'><p>Additive Outlier Detection</p></a></li>
<li><a href='#detectIO'><p>Innovative Outlier Detection</p></a></li>
<li><a href='#eacf'><p>Compute the sample extended acf (ESACF)</p></a></li>
<li><a href='#eeg'><p>EEG Data</p></a></li>
<li><a href='#electricity'><p> Monthly US electricity production / time series</p></a></li>
<li><a href='#euph'>
<p>A digitized sound file of a B flat</p>
played on a euphonium</a></li>
<li><a href='#explode.s'><p> A simulated explosive AR(1) series</p></a></li>
<li><a href='#fitted.Arima'><p>Fitted values of an arima model.</p></a></li>
<li><a href='#flow'>
<p>Monthly River Flow for the Iowa River</p></a></li>
<li><a href='#garch.sim'><p>Simulate a GARCH process</p></a></li>
<li><a href='#gBox'><p>Generalized Portmanteau Tests for GARCH Models</p></a></li>
<li><a href='#gold'><p>Gold Price / time series</p></a></li>
<li><a href='#google'>
<p>Daily returns of the google stock</p></a></li>
<li><a href='#hare'><p>Canadian hare data/ time series</p></a></li>
<li><a href='#harmonic'><p>Construct harmonic functions for fitting harmonic trend model</p></a></li>
<li><a href='#hours'><p> Average hours worked in US manufacturing sector / time series</p></a></li>
<li><a href='#ima22.s'><p>Simulated IMA(2,2) series / time series</p></a></li>
<li><a href='#JJ'><p>Quarterly earnings per share for the Johnson &amp; Johnson Company</p></a></li>
<li><a href='#Keenan.test'><p> Keenan's one-degree test for nonlinearity</p></a></li>
<li><a href='#kurtosis'><p>Kurtosis</p></a></li>
<li><a href='#lagplot'><p>Lagged Regression Plot</p></a></li>
<li><a href='#larain'><p>Annual rainfall in Los Angeles / time series</p></a></li>
<li><a href='#LB.test'><p>Portmanteau Tests for Fitted ARIMA models</p></a></li>
<li><a href='#ma1.1.s'><p>A simulated MA(1) series / time series</p></a></li>
<li><a href='#ma1.2.s'><p>A simulated MA(1) series / time series</p></a></li>
<li><a href='#ma2.s'><p>A simulated MA(2) series</p></a></li>
<li><a href='#McLeod.Li.test'><p>McLeod-Li test</p></a></li>
<li><a href='#milk'><p>Monthly Milk Production</p></a></li>
<li><a href='#oil.price'><p>Monthly Oil Price / time series</p></a></li>
<li><a href='#oilfilters'>
<p>Monthly sales to dealers of a specialty oil</p>
filter/time series</a></li>
<li><a href='#periodogram'><p>Computing the periodogram</p></a></li>
<li><a href='#plot.Arima'><p>Compute and Plot the Forecasts Based on a Fitted Time Series Model</p></a></li>
<li><a href='#plot.armasubsets'><p>Plot the Best Subset ARMA models</p></a></li>
<li><a href='#plot1.acf'><p>Plot1</p></a></li>
<li><a href='#predict.TAR'><p>Prediction based on  a fitted TAR model</p></a></li>
<li><a href='#prescrip'><p> Cost per prescription / time series</p></a></li>
<li><a href='#prewhiten'><p>Prewhiten a Bivariate Time Series, and Compute and Plot Their Sample Cross-Correlation Function</p></a></li>
<li><a href='#prey.eq'><p>Prey series / time series</p></a></li>
<li><a href='#qar.sim'><p>Simulate a first-order quadratic AR model</p></a></li>
<li><a href='#retail'><p>U.K. retail sales / time series</p></a></li>
<li><a href='#robot'><p>The distance of a robot from a desired position / time series</p></a></li>
<li><a href='#rstandard.Arima'><p>Compute the Standardized Residuals from a Fitted ARIMA Model</p></a></li>
<li><a href='#runs'><p>Runs test</p></a></li>
<li><a href='#rwalk'><p>A simulated random walk / Time series</p></a></li>
<li><a href='#season'><p>Extract the season info from a time series</p></a></li>
<li><a href='#skewness'><p>Skewness</p></a></li>
<li><a href='#SP'><p>Quarterly Standard &amp; Poor's Composite Index of stock price values /</p>
time series</a></li>
<li><a href='#spec'><p>Computing the spectrum</p></a></li>
<li><a href='#spots'><p>Relative annual sunspot number / time series</p></a></li>
<li><a href='#spots1'>
<p>Annual international sunspot numbers</p></a></li>
<li><a href='#star'><p>Star Brightness</p></a></li>
<li><a href='#summary.armasubsets'><p>Summary of output from the armasubsets function</p></a></li>
<li><a href='#tar'><p>Estimation of a TAR model</p></a></li>
<li><a href='#tar.sim'><p>Simulate a two-regime TAR model</p></a></li>
<li><a href='#tar.skeleton'><p>Find the asympotitc behavior of the skeleton of a TAR model</p></a></li>
<li><a href='#tbone'>
<p>A digitized sound file of a B flat</p>
played on a tenor trombone</a></li>
<li><a href='#tempdub'><p>Monthly average temperature in Dubuque/time series</p></a></li>
<li><a href='#tlrt'><p>Likelihood ratio test for threshold nonlinearity</p></a></li>
<li><a href='#Tsay.test'><p>Tsay's Test for nonlinearity</p></a></li>
<li><a href='#tsdiag.Arimax'><p>Model Diagnostics for a Fitted ARIMAX Model</p></a></li>
<li><a href='#tsdiag.TAR'><p>Model diagnostics for a fitted TAR model</p></a></li>
<li><a href='#tuba'>
<p>A digitized sound file of a B flat</p>
played on a BB flat tuba</a></li>
<li><a href='#units'>
<p>Annual sales of certain large equipment</p></a></li>
<li><a href='#usd.hkd'><p>Daily US Dollar to Hong Kong Dollar Exchange Rates</p></a></li>
<li><a href='#veilleux'><p>An experimental prey-predator time series</p></a></li>
<li><a href='#wages'><p>Average hourly wages in the apparel industry / time series</p></a></li>
<li><a href='#winnebago'><p>Monthly unit sales of recreational vehicles / time series</p></a></li>
<li><a href='#zlag'><p>Compute the lag of a vector.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Series Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Kung-Sik Chan, Brian Ripley </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kung-Sik Chan &lt;kungsik.chan@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>leaps, locfit, mgcv, tseries</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains R functions and datasets detailed in the book
        "Time Series Analysis with Applications in R (second edition)" by Jonathan Cryer and Kung-Sik Chan.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://stat.uiowa.edu/~kchan/TSA.htm">https://stat.uiowa.edu/~kchan/TSA.htm</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-05 09:45:19 UTC; hornik</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-05 11:36:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='TSA-package'>Time Series Analysis</h2><span id='topic+TSA-package'></span><span id='topic+TSA'></span>

<h3>Description</h3>

<p>Contains R functions and datasets detailed in the book
&quot;Time Series Analysis with Applications in R (second edition)&quot; by J.D. Cryer and K.S. Chan</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> TSA</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-9-9</td>
</tr>
<tr>
 <td style="text-align: left;">
License:</td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kung-Sik Chan, Brian Ripley</p>

<hr>
<h2 id='acf'>
Auto- and Cross- Covariance and -Correlation Function Estimation</h2><span id='topic+acf'></span>

<h3>Description</h3>

<p>This function calls the acf function in the stats package and processes to drop lag-0 of the acf. It only works for univariate time series, so x below should be 1-dimensional.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf(x, lag.max = NULL, type = c("correlation", "covariance", "partial")[1], 
plot = TRUE, na.action = na.fail, demean = TRUE, drop.lag.0 = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acf_+3A_x">x</code></td>
<td>
<p>a univariate or multivariate (not ccf) numeric time series object or a numeric vector or matrix, or an &quot;acf&quot; object.</p>
</td></tr>
<tr><td><code id="acf_+3A_lag.max">lag.max</code></td>
<td>
<p>maximum number of lags at which to calculate the acf. Default is 10*log10(N/m) where N is the number of observations and m the number of series.</p>
</td></tr>
<tr><td><code id="acf_+3A_type">type</code></td>
<td>
<p>character string giving the type of acf to be computed. Allowed values are &quot;correlation&quot; (the default), &quot;covariance&quot; or &quot;partial&quot;.</p>
</td></tr>
<tr><td><code id="acf_+3A_plot">plot</code></td>
<td>

<p>logical. If TRUE (the default) the acf is plotted.</p>
</td></tr>                                                                           
<tr><td><code id="acf_+3A_na.action">na.action</code></td>
<td>
<p>function to be called to handle missing values. na.pass can be used.</p>
</td></tr>
<tr><td><code id="acf_+3A_demean">demean</code></td>
<td>

<p>logical. Should the covariances be about the sample means?</p>
</td></tr>
<tr><td><code id="acf_+3A_drop.lag.0">drop.lag.0</code></td>
<td>
<p>logical. Should lag 0 be dropped</p>
</td></tr>
<tr><td><code id="acf_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to plot.acf.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;acf&quot;, which is a list with the following elements: 
</p>
<table role = "presentation">
<tr><td><code>lag</code></td>
<td>
<p> A three dimensional array containing the lags at which the acf is estimated.</p>
</td></tr> 
<tr><td><code>acf</code></td>
<td>
<p> An array with the same dimensions as lag containing the estimated acf.</p>
</td></tr> 
<tr><td><code>type</code></td>
<td>
<p> The type of correlation (same as the type argument).</p>
</td></tr> 
<tr><td><code>n.used</code></td>
<td>
<p> The number of observations in the time series.</p>
</td></tr> 
<tr><td><code>series</code></td>
<td>
<p> The name of the series x.</p>
</td></tr> 
<tr><td><code>snames</code></td>
<td>
<p> The series names for a multivariate time series.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Original authors of stats:::acf are: Paul Gilbert, Martyn Plummer, B.D. Ripley. This wrapper is written by Kung-Sik Chan</p>


<h3>References</h3>

<p> ~put references to the literature/web site here ~ </p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+plot.acf">plot.acf</a></code>, <code><a href="stats.html#topic+ARMAacf">ARMAacf</a></code> for the exact autocorrelations of a given ARMA process.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rwalk)
model1=lm(rwalk~time(rwalk))
summary(model1)
acf(rstudent(model1),main='')
</code></pre>

<hr>
<h2 id='airmiles'>Monthly Airline Passenger-Miles in the US</h2><span id='topic+airmiles'></span>

<h3>Description</h3>

<p>Monthly U.S. airline passenger-miles: 01/1996 - 05/2005.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(airmiles)</code></pre>


<h3>Format</h3>

<p>The format is:
'ts' int [1:113, 1] 30983174 32147663 38342975 35969113 36474391 38772238 40395657 41738499 33580773 36389842 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;airmiles&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 1996 2005   12
</p>


<h3>Source</h3>

<p><code>www.bts.gov/xml/air_traffic/src/index.xml#MonthlySystem</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(airmiles)
## maybe str(airmiles) ; plot(airmiles) ...
</code></pre>

<hr>
<h2 id='airpass'>Monthly total international airline passengers </h2><span id='topic+airpass'></span>

<h3>Description</h3>

<p>Monthly total international airline passengers from 01/1960-
12/1971.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(airpass)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:144] from 1960 to 1972: 112 118 132 129 121 135 148 148 136 119 ...
</p>


<h3>Source</h3>

<p>Box, G. E. P., Jenkins, G. M. and Reinsel, G. C. (1994) Time Series Analysis, Forecasting
and Control. Second Edition. New York: Prentice-Hall.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(airpass)
## maybe str(airpass) ; plot(airpass) ...
</code></pre>

<hr>
<h2 id='ar1.2.s'>A simulated AR(1) series</h2><span id='topic+ar1.2.s'></span>

<h3>Description</h3>

<p>A simulated AR(1) series with the AR coefficient equal  to 0.4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ar1.2.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:60] from 1 to 60: -0.0678  1.4994  0.4888  0.3987 -0.5162 ...
</p>


<h3>Details</h3>

<p>The model is Y(t)=0.4*Y(t-1)+e(t) where the e's are iid standard normal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ar1.2.s)
## maybe str(ar1.2.s) ; plot(ar1.2.s) ...
</code></pre>

<hr>
<h2 id='ar1.s'>A simulated AR(1) series</h2><span id='topic+ar1.s'></span>

<h3>Description</h3>

<p>A simulated AR(1) series with the AR coefficient equal  to 0.9.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ar1.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:60] from 1 to 60: -1.889 -1.691 -1.962 -0.566 -0.627 ...
</p>


<h3>Details</h3>

<p>The model is Y(t)=0.9*Y(t-1)+e(t) where the e's are iid standard normal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ar1.s)
## maybe str(ar1.s) ; plot(ar1.s) ...
</code></pre>

<hr>
<h2 id='ar2.s'>Asimulated AR(2) series / time series</h2><span id='topic+ar2.s'></span>

<h3>Description</h3>

<p>Asimulated AR(2) series with AR coefficients being equal to 1.5 and -0.75</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ar2.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:120] from 1 to 120: -2.064 -1.937  0.406  2.039  2.953 ...
</p>


<h3>Details</h3>

<p>The model is Y(t)=1.5*Y(t-1)-0.75*Y(t-2)+e(t) where the e's are iid
standard normal random variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ar2.s)
## maybe str(ar2.s) ; plot(ar2.s) ...
</code></pre>

<hr>
<h2 id='arima'>Fitting an ARIMA model with Exogeneous Variables</h2><span id='topic+arima'></span>

<h3>Description</h3>

<p>This function is identical to the arimax function which builds on and 
extends the capability of the arima function in R stats by allowing the
incorporation of transfer functions, and innovative and additive outliers.
For backward compatitibility, the function is also named arima.
Note in the computation of AIC, the number of parameters excludes the noise
variance. This function is heavily based on 
the arima function of the stats core
of R, see the help page of this function for details on arguments
<code>x</code> to <code>kappa</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>arima(x, order = c(0, 0, 0), seasonal = list(order = c(0, 0, 0), period = NA),
 xreg = NULL, include.mean = TRUE, transform.pars = TRUE, fixed = NULL, 
init = NULL, method = c("CSS-ML", "ML", "CSS"), n.cond, optim.control = list(),
 kappa = 1e+06, io = NULL, xtransf, transfer = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arima_+3A_x">x</code></td>
<td>
<p>time series response</p>
</td></tr>
<tr><td><code id="arima_+3A_order">order</code></td>
<td>
<p>regular ARIMA order</p>
</td></tr>
<tr><td><code id="arima_+3A_seasonal">seasonal</code></td>
<td>
<p>seasonal ARIMA order</p>
</td></tr>
<tr><td><code id="arima_+3A_xreg">xreg</code></td>
<td>
<p>a dataframe containing covariates</p>
</td></tr>
<tr><td><code id="arima_+3A_include.mean">include.mean</code></td>
<td>
<p>if true, an intercept term is incorporated in the model;
applicable only to stationary models.</p>
</td></tr>
<tr><td><code id="arima_+3A_transform.pars">transform.pars</code></td>
<td>
<p>if true, the AR parameters are transformed to 
ensure stationarity</p>
</td></tr>
<tr><td><code id="arima_+3A_fixed">fixed</code></td>
<td>
<p>a vector indicating which coefficients are fixed or free</p>
</td></tr>
<tr><td><code id="arima_+3A_init">init</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="arima_+3A_method">method</code></td>
<td>
<p>estimation method</p>
</td></tr>
<tr><td><code id="arima_+3A_n.cond">n.cond</code></td>
<td>
<p>number of initial values to be conditioned on in a conditional
analysis</p>
</td></tr>
<tr><td><code id="arima_+3A_optim.control">optim.control</code></td>
<td>
<p>control parameters for the optimization procedure</p>
</td></tr>
<tr><td><code id="arima_+3A_kappa">kappa</code></td>
<td>
<p>prior variance; used in dealing with initial values</p>
</td></tr>
<tr><td><code id="arima_+3A_io">io</code></td>
<td>
<p>a list of time points at which the model may have an innovative outlier. The time point of the outlier can be given either as absolute time point
or as c(a,b), i.e. at the b-th 'month' of the a-th 'year' where each 
year has frequency(x) months, assuming x is a time series.
</p>
</td></tr>
<tr><td><code id="arima_+3A_xtransf">xtransf</code></td>
<td>

<p>xtranf is a matrix with each column containing a covariate that affects
the time series response in terms of an ARMA filter of order (p,q), i.e.
if Z is one such covariate, its effect on the time series is 
<code class="reqn">(theta_0+theta_1B+...+theta_{q-1}B^{q-1})/(1-phi_1 B -...-phi_p B^p) Z_t</code>
In particular, if <code class="reqn">p=0</code> and <code class="reqn">q=1</code>, this specifies a simple regression 
relationship, which should be included in xreg and not here.
Note that the filter starts with zero initial values. Hence, it is pertinent
to mean-delete each distributed-lag covariate, and this 
is not done automatically.
</p>
</td></tr>
<tr><td><code id="arima_+3A_transfer">transfer</code></td>
<td>
<p>a list consisting of the ARMA orders for each transfer (distributed lag) covariate.  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An Arimax object contining the model fit.
</p>


<h3>Author(s)</h3>

<p>Original author of the arima function in R stats: Brian Ripley. The arimax function is based on the stats:::arima function, with modifications by Kung-Sik Chan.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+arima">arima</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hare)
arima(sqrt(hare),order=c(3,0,0))


</code></pre>

<hr>
<h2 id='arima.boot'>Compute the Bootstrap Estimates of an ARIMA Model</h2><span id='topic+arima.boot'></span>

<h3>Description</h3>

<p>This function bootstraps time series according to the fitted ARMA(p,d,q) model supplied by the fitted object arima.fit, and estimate the same model using the
arima function. Any bootstrap sample that has problem when fitted with the ARIMA model will be omitted from the final results and all error messages will be suppressed. You can check if there is any fitting problem by running the command geterrmessage().</p>


<h3>Usage</h3>

<pre><code class='language-R'>arima.boot(arima.fit, cond.boot = FALSE, is.normal = TRUE, B = 1000, init, ntrans = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arima.boot_+3A_arima.fit">arima.fit</code></td>
<td>
<p>a fitted object from the arima function (seasonal components not allowed)</p>
</td></tr> 
<tr><td><code id="arima.boot_+3A_cond.boot">cond.boot</code></td>
<td>
<p>whether or not 
the bootstrap is conditional on the (p+d) initial values; if
it is set true. If false (default), the stationary bootstrap is used. </p>
</td></tr>
<tr><td><code id="arima.boot_+3A_is.normal">is.normal</code></td>
<td>
<p>if true (default), errors are normally distributed, 
otherwise
errors are drawn randomly and with replacement from the residuals of the fitted model.
</p>
</td></tr>
<tr><td><code id="arima.boot_+3A_b">B</code></td>
<td>
<p>number of bootstrap replicates (1000, default)</p>
</td></tr>
<tr><td><code id="arima.boot_+3A_init">init</code></td>
<td>
<p>initial values for the bootstrap; needed if cond.boot=True 
default values are the initial values of the time series of the fitted 
model.</p>
</td></tr>
<tr><td><code id="arima.boot_+3A_ntrans">ntrans</code></td>
<td>
<p>number of transient values for the stationary bootstrap. 
Default=100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix each row of which consists of the coefficient estimates of 
a bootstrap time-series.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(hare)
arima.hare=arima(sqrt(hare),order=c(3,0,0))
boot.hare=arima.boot(arima.hare,B=50,init=sqrt(hare)[1:3],ntrans=100)
apply(boot.hare,2,quantile, c(.025,.975))
period.boot=apply(boot.hare,1,function(x){
roots=polyroot(c(1,-x[1:3]))
min1=1.e+9
rootc=NA
for (root in roots) {
if( abs(Im(root))&lt;1e-10) next
if (Mod(root)&lt; min1) {min1=Mod(root); rootc=root}
}
if(is.na(rootc)) period=NA else period=2*pi/abs(Arg(rootc))
period
})
hist(period.boot)
quantile(period.boot,c(0.025,.975))

</code></pre>

<hr>
<h2 id='arimax'>Fitting an ARIMA model with Exogeneous Variables</h2><span id='topic+arimax'></span>

<h3>Description</h3>

<p>This function builds on and 
extends the capability of the arima function in R stats  by allowing the
incorporation of transfer functions, innovative and additive outliers.
For backward compatitibility, the function is also named arima.
Note in the computation of AIC, the number of parameters excludes the noise
variance.  See the help page of arima in stats for details on arguments
<code>x</code> to <code>kappa</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arimax(x, order = c(0, 0, 0), seasonal = list(order = c(0, 0, 0), period = NA),
 xreg = NULL, include.mean = TRUE, transform.pars = TRUE, fixed = NULL, 
init = NULL, method = c("CSS-ML", "ML", "CSS"), n.cond, optim.control = list(),
 kappa = 1e+06, io = NULL, xtransf, transfer = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arimax_+3A_x">x</code></td>
<td>
<p>time series response</p>
</td></tr>
<tr><td><code id="arimax_+3A_order">order</code></td>
<td>
<p>regular ARIMA order</p>
</td></tr>
<tr><td><code id="arimax_+3A_seasonal">seasonal</code></td>
<td>
<p>seasonal ARIMA order</p>
</td></tr>
<tr><td><code id="arimax_+3A_xreg">xreg</code></td>
<td>
<p>a dataframe containing covariates</p>
</td></tr>
<tr><td><code id="arimax_+3A_include.mean">include.mean</code></td>
<td>
<p>if true, an intercept term is incorporated in the model;
applicable only to stationary model.</p>
</td></tr>
<tr><td><code id="arimax_+3A_transform.pars">transform.pars</code></td>
<td>
<p>if true, the AR parameters are transformed to 
ensure stationarity</p>
</td></tr>
<tr><td><code id="arimax_+3A_fixed">fixed</code></td>
<td>
<p>a vector indicating which coefficients are fixed or free</p>
</td></tr>
<tr><td><code id="arimax_+3A_init">init</code></td>
<td>
<p>initial values</p>
</td></tr>
<tr><td><code id="arimax_+3A_method">method</code></td>
<td>
<p>estimation method</p>
</td></tr>
<tr><td><code id="arimax_+3A_n.cond">n.cond</code></td>
<td>
<p>number of initial values to be conditioned on a conditional
analysis</p>
</td></tr>
<tr><td><code id="arimax_+3A_optim.control">optim.control</code></td>
<td>
<p>control parameters for the optimization procedure</p>
</td></tr>
<tr><td><code id="arimax_+3A_kappa">kappa</code></td>
<td>
<p>prior variance; used in dealing with initial values</p>
</td></tr>
<tr><td><code id="arimax_+3A_io">io</code></td>
<td>
<p>a list of time points at which the model may have an innovative outlier. The time point of the outlier can be given either as absolute time point
or as c(a,b), i.e. at the b-th 'month' of the a-th 'year' where each 
year has frequency(x) months, assuming x is a time series.
</p>
</td></tr>
<tr><td><code id="arimax_+3A_xtransf">xtransf</code></td>
<td>

<p>xtranf is a matrix with each column containing a covariate that affects
the time series response in terms of an ARMA filter of order (p,q), i.e.
if Z is one such covariate, its effect on the time series is 
<code class="reqn">(theta_0+theta_1B+...+theta_{q-1}B^{q-1})/(1-phi_1 B -...-phi_p B^p) Z_t</code>
In particular, if <code class="reqn">p=0</code> and <code class="reqn">q=1</code>, this specifies a simple regression 
relationship, which should be included in xreg and not here.
Note that the filter starts with zero initial values. Hence, it is pertinent
to mean-delete each distributed-lag covariate, which is not done automatically.
</p>
</td></tr>
<tr><td><code id="arimax_+3A_transfer">transfer</code></td>
<td>
<p>a list consisting of the ARMA orders for each transfer (distributed lag) covariate.  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An Arimax object containing the model fit.
</p>


<h3>Author(s)</h3>

<p>Original author of the arima function in R stats: Brian Ripley. The arimax function is based on the stats:::arima function, with modifications by Kung-Sik Chan.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+arima">arima</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(airmiles)
plot(log(airmiles),ylab='Log(airmiles)',xlab='Year', main='')
acf(diff(diff(window(log(airmiles),end=c(2001,8)),12)),lag.max=48,main='')
air.m1=arimax(log(airmiles),order=c(0,1,1),seasonal=list(order=c(0,1,1),
period=12),xtransf=data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69)),
transfer=list(c(0,0),c(1,0)),xreg=data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84)),method='ML')


</code></pre>

<hr>
<h2 id='arma11.s'> A Simulated ARMA(1,1) Series/ time series</h2><span id='topic+arma11.s'></span>

<h3>Description</h3>

<p>A simulated ARMA(1,1) series with the model given by:
<code class="reqn">y_t=0.6*y_{t-1}+e_t+0.3*e_{t-1}</code> where the e's are iid standard normal 
random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(arma11.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:100] from 1 to 100: -0.765  1.297  0.668 -1.607 -0.626 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arma11.s)
## maybe str(arma11.s) ; plot(arma11.s) ...
</code></pre>

<hr>
<h2 id='ARMAspec'>Theoretical spectral density function of a stationary ARMA model</h2><span id='topic+ARMAspec'></span>

<h3>Description</h3>

<p>Computes and plots the theoretical spectral density function of a stationary ARMA model</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARMAspec(model, freq = seq(0, 0.5, 0.001), plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARMAspec_+3A_model">model</code></td>
<td>
<p>an arma model</p>
</td></tr>
<tr><td><code id="ARMAspec_+3A_freq">freq</code></td>
<td>
<p>  vector of frequency over which the spectral density is computed</p>
</td></tr>
<tr><td><code id="ARMAspec_+3A_plot">plot</code></td>
<td>
<p>if true, plot the spectral density function; default is true</p>
</td></tr>
<tr><td><code id="ARMAspec_+3A_...">...</code></td>
<td>
<p>other parameters to be passed to the plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list:
</p>
<table role = "presentation">
<tr><td><code>spec</code></td>
<td>
<p>spectral density values</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>same as freq in the input</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the arma model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>See Also</h3>

<p><code><a href="#topic+spec">spec</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
theta=.9 # Reset theta for other MA(1) plots
ARMAspec(model=list(ma=-theta)) 

</code></pre>

<hr>
<h2 id='armasubsets'>Selection of Subset ARMA Models</h2><span id='topic+armasubsets'></span>

<h3>Description</h3>

<p>This function finds a number of subset ARMA models.
A &quot;long&quot; AR model is fitted to the data y to compute the residuals
which are taken as a proxy of the error process.
Then, an ARMA model is approximated by a regression model with the 
the covariates being the lags of the time series and the lags of the
error process.
Subset ARMA models may then be selected using the subset regression 
technique by leaps and bounds, via the regsubsets function of the leaps
package in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>armasubsets(y, nar, nma, y.name = "Y", ar.method = "ols", ...)
</code></pre>


<h3>Arguments</h3>

 <table role = "presentation">
<tr><td><code id="armasubsets_+3A_y">y</code></td>
<td>
<p>time-series data</p>
</td></tr>
<tr><td><code id="armasubsets_+3A_nar">nar</code></td>
<td>
<p>maximum AR order</p>
</td></tr>
<tr><td><code id="armasubsets_+3A_nma">nma</code></td>
<td>
<p>maximum MA order</p>
</td></tr>
<tr><td><code id="armasubsets_+3A_y.name">y.name</code></td>
<td>
<p>label of the time series</p>
</td></tr>
<tr><td><code id="armasubsets_+3A_ar.method">ar.method</code></td>
<td>
<p>method used for fitting the long AR model; default is ols
with the AR order determined by AIC</p>
</td></tr>
<tr><td><code id="armasubsets_+3A_...">...</code></td>
<td>
<p>arguments passed to the plot.armasubsets function</p>
</td></tr> </table>


<h3>Value</h3>

<p>An object of the armasubsets class to be processed by the plot.armasubsets
function.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(92397)
test=arima.sim(model=list(ar=c(rep(0,11),.8),ma=c(rep(0,11),0.7)),n=120)
res=armasubsets(y=test,nar=14,nma=14,y.name='test',ar.method='ols')
plot(res)
</code></pre>

<hr>
<h2 id='beersales'>Monthly beer sales / time series</h2><span id='topic+beersales'></span>

<h3>Description</h3>

<p>Monthly beer sales in millions of barrels, 01/1975 - 12/1990.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(beersales)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:192] from 1975 to 1991: 11.12  9.84 11.57 13.01 13.42 ...
</p>


<h3>Source</h3>

<p>Frees, E. W., Data Analysis Using Regression Models,
Prentice Hall, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beersales)
## maybe str(beersales) ; plot(beersales) ...
</code></pre>

<hr>
<h2 id='bluebird'>Blue Bird Potato Chip Data</h2><span id='topic+bluebird'></span>

<h3>Description</h3>

<p>Weekly unit sales (log-transformed) of Bluebird standard potato chips 
(New Zealand)
and their price for 104 weeks.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bluebird)</code></pre>


<h3>Format</h3>

<p>The format is:
mts [1:104, 1:2] 11.5 11.5 11.8 11.9 11.3 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr [1:2] &quot;log.sales&quot; &quot;price&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 1 104 1
- attr(*, &quot;class&quot;)= chr [1:2] &quot;mts&quot; &quot;ts&quot;
</p>


<h3>Source</h3>

<p>www.stat.auckland.ac.nz/~balemi/Assn3.xls</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bluebird)
## maybe str(bluebird) ; plot(bluebird) ...
</code></pre>

<hr>
<h2 id='bluebirdlite'>
Bluebird Lite potato chip data
</h2><span id='topic+bluebirdlite'></span>

<h3>Description</h3>

<p>Weekly unit sales (log-transformed) of Bluebird Lite potato chips (New Zealand) and
their price for 104 weeks. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bluebirdlite)</code></pre>


<h3>Format</h3>

<p>A data frame with 104 observations on the following 2 variables.
</p>

<dl>
<dt><code>log.sales</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>price</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>www.stat.auckland.ac.nz/~balemi/Assn3.xls
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bluebirdlite)
## maybe str(bluebirdlite) ; plot(bluebirdlite) ...
</code></pre>

<hr>
<h2 id='boardings'>
Monthly public transit boardings and gasoline price in Denver</h2><span id='topic+boardings'></span>

<h3>Description</h3>

<p>Monthly public transit boardings (mostly buses and light rail) and
gasoline price (both log-transformed), Denver,
Colorado region, 08/2000 - 03/2006.
</p>


<h3>Source</h3>

<p>Personal communication
from Lee Cryer, Project Manager, Regional Transportation
District, Denver, Colorado. Denver gasoline prices were obtained
from the Energy Information Administration, U.S. Department of
Energy, Washington, D.C.at www.eia.doe.gov
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(boardings)
plot(boardings)
## maybe str(boardings) ; plot(boardings) ...
</code></pre>

<hr>
<h2 id='BoxCox.ar'>Determine the power transformation for serially correlated data</h2><span id='topic+BoxCox.ar'></span>

<h3>Description</h3>

<p>Determine the appropriate 
power transformation for time-series data. The objective is
to estimate the power transformation so that the transformed time series is
approximately a Gaussian AR process.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BoxCox.ar(y, order, lambda = seq(-2, 2, 0.01), plotit = TRUE, 
method = c("mle", "yule-walker", "burg", "ols", "yw"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BoxCox.ar_+3A_y">y</code></td>
<td>
<p> univariate time series (must be positive)</p>
</td></tr>
<tr><td><code id="BoxCox.ar_+3A_order">order</code></td>
<td>
<p> AR order for the data; if missing, the order is determined by
AIC for the log-transformed data</p>
</td></tr>
<tr><td><code id="BoxCox.ar_+3A_lambda">lambda</code></td>
<td>
<p> a vector of candidate power transformation values; if missing, it is
set to be from -2 to 2, with increment .01</p>
</td></tr>
<tr><td><code id="BoxCox.ar_+3A_plotit">plotit</code></td>
<td>
<p> logical value, if true, plot the profile
log-likelihood for  
the power estimator</p>
</td></tr>
<tr><td><code id="BoxCox.ar_+3A_method">method</code></td>
<td>
<p> method of AR estimation; default is &quot;mle&quot;</p>
</td></tr>
<tr><td><code id="BoxCox.ar_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to the ar function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that contains the following:
</p>
<table role = "presentation">
<tr><td><code>lambda</code></td>
<td>
<p>candidate power transformation parameter values</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>profile log-likelihood</p>
</td></tr>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate of the power transformation
value</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>95% C.I. of the power transformation value</p>
</td></tr> </table>


<h3>Note</h3>

<p> The procedure is very computer intensive. Be patient for the outcome</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hare)
# hare.transf=BoxCox.ar(y=hare)
# hare.transf$ci
</code></pre>

<hr>
<h2 id='co2'>Levels of Carbon Dioxide at Alert, Canada / Time series</h2><span id='topic+co2'></span>

<h3>Description</h3>

<p>Monthly CO2 level at Alert, Northwest Territories, Canada,
near the Artic Circle, 01/1994 - 12/2004.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(co2)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:132] from 1994 to 2005: 363 364 365 364 364 ...
</p>


<h3>Source</h3>

<p><code>http://cdiac.ornl.gov/trends/co2/sio-alt.htm</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co2)
## maybe str(co2) ; plot(co2) ...
</code></pre>

<hr>
<h2 id='color'>Color property/time series</h2><span id='topic+color'></span>

<h3>Description</h3>

 
<p>Color property from 35 consecutive batches in an industrial process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(color)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:35] from 1 to 35: 67 63 76 66 69 71 72 71 72 72 ...
</p>


<h3>Source</h3>

<p>&ldquo;The Estimation of Sigma for an X Chart&rdquo;, Journal of Quality
Technology, Vol. 22, No. 3 (July 1990), by Jonathan D. Cryer and Thomas P. Ryan.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(color)
## maybe str(color) ; plot(color) ...
</code></pre>

<hr>
<h2 id='CREF'>Daily CREF Values</h2><span id='topic+CREF'></span>

<h3>Description</h3>

<p>Daily values of one unit of the CREF (College Retirement Equity
Fund) Stock fund, 08/26/04 - 08/15/06.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CREF)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:501] from 1 to 501: 170 170 169 170 171 ...
</p>


<h3>Source</h3>

<p>www.tiaa-cref.org/performance/retirement/data/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CREF)
## maybe str(CREF) ; plot(CREF) ...
</code></pre>

<hr>
<h2 id='cref.bond'>Daily CREF Bond Values</h2><span id='topic+cref.bond'></span>

<h3>Description</h3>

<p>Daily values of one unit of the CREF (College Retirement Equity
Fund) Bond fund, 08/26/04 - 08/15/06.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CREF)</code></pre>


<h3>Source</h3>

<p>www.tiaa-cref.org/performance/retirement/data/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CREF)
## maybe str(CREF) ; plot(CREF) ...
</code></pre>

<hr>
<h2 id='days'>Number of days between payment to Winegard Corp. / time series</h2><span id='topic+days'></span>

<h3>Description</h3>

<p>Accounts receivable data. Number of days until a distributor of
Winegard Company products pays their account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(days)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:130] from 1 to 130: 39 39 41 26 28 28 25 26 24 38 ...
</p>


<h3>Source</h3>

<p>Personal
communication from Mark Selergren, Vice President, Winegard,
Inc., Burlington, Iowa.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(days)
## maybe str(days) ; plot(days) ...
</code></pre>

<hr>
<h2 id='deere1'>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 1</h2><span id='topic+deere1'></span>

<h3>Description</h3>

<p>82 consecutive values for the amount of deviation (in 0.000025 inch
units) from a specified target value in an industrial machining process at Deere &amp; Co.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(deere1)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:82] from 1 to 82: 3 0 -1 -4 7 3 7 3 3 -1 ...
</p>


<h3>Source</h3>

<p>Personal communication from William F.
Fulkerson, Deere &amp; Co. Technical Center, Moline, Illinois.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(deere1)
## maybe str(deere1) ; plot(deere1) ...
</code></pre>

<hr>
<h2 id='deere2'>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 2</h2><span id='topic+deere2'></span>

<h3>Description</h3>

<p>102 consecutive values for the deviation (in 0.0000025 inch units) from a specified target value.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(deere2)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:102] from 1 to 102: -18 -24 -17 -27 -37 -34 -8 14 18 7 ...
</p>


<h3>Source</h3>

<p>Personal communication from William F.
Fulkerson, Deere &amp; Co. Technical Center, Moline, Illinois.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(deere2)
## maybe str(deere2) ; plot(deere2) ...
</code></pre>

<hr>
<h2 id='deere3'>Deviations of an industrial process at Deere &amp; Co. &ndash; Series 3</h2><span id='topic+deere3'></span>

<h3>Description</h3>

<p>Fifty seven consecutive values for the deviation (in 0.0000025 inch units) from a specified target value.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(deere3)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:57] from 1 to 57:  -500 -1250  -500 -3000 -2375 ...
</p>


<h3>Source</h3>

<p>Personal communication from William F.
Fulkerson, Deere &amp; Co. Technical Center, Moline, Illinois.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(deere3)
## maybe str(deere3) ; plot(deere3) ...
</code></pre>

<hr>
<h2 id='detectAO'>Additive Outlier Detection</h2><span id='topic+detectAO'></span>

<h3>Description</h3>

<p>This function serves to detect whether there are any additive outliers
(AO). It implements the
test statistic <code class="reqn">lambda_{2,t}</code> proposed by Chang, Chen and Tiao (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectAO(object, alpha = 0.05, robust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectAO_+3A_object">object</code></td>
<td>
<p>a fitted ARIMA model</p>
</td></tr>
<tr><td><code id="detectAO_+3A_alpha">alpha</code></td>
<td>
<p>family significance level (5% is the default)
Bonferroni rule is used to control the family error rate.</p>
</td></tr>
<tr><td><code id="detectAO_+3A_robust">robust</code></td>
<td>
<p>if true, the noise standard deviation is estimated by
mean absolute residuals times sqrt(pi/2). Otherwise,
it is the estimated by sqrt(sigma2) from the arima fit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>ind</code></td>
<td>
<p>the time indices of potential AO</p>
</td></tr>
<tr><td><code>lambda2</code></td>
<td>
<p>the corresponding test statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p> Chang, I.H., Tiao, G.C. and C. Chen (1988). Estimation of Time Series Parameters in the Presence of Outliers. 
Technometrics, 30, 193-204.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detectIO">detectIO</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
y=arima.sim(model=list(ar=.8,ma=.5),n.start=158,n=100)
y[10]
y[10]=10
y=ts(y,freq=1,start=1)
plot(y,type='o')
acf(y)
pacf(y)
eacf(y)
m1=arima(y,order=c(1,0,0))
m1
detectAO(m1)
detectAO(m1, robust=FALSE)
detectIO(m1)
</code></pre>

<hr>
<h2 id='detectIO'>Innovative Outlier Detection</h2><span id='topic+detectIO'></span>

<h3>Description</h3>

<p>This function serves to detect whether there are any innovative
outliers (IO). It implements the
test statistic <code class="reqn">lambda_{2,t}</code> proposed by Chang, Chen and Tiao (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectIO(object, alpha = 0.05, robust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detectIO_+3A_object">object</code></td>
<td>
<p>a fitted ARIMA model</p>
</td></tr>
<tr><td><code id="detectIO_+3A_alpha">alpha</code></td>
<td>
<p>family significance level (5% is the default)
Bonferroni rule is used to control the family error rate.</p>
</td></tr>
<tr><td><code id="detectIO_+3A_robust">robust</code></td>
<td>
<p>if true, the noise standard deviation is estimated by
mean absolute residuals times sqrt(pi/2). Otherwise,
it is the estimated by sqrt(sigma2) from the arima fit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>ind</code></td>
<td>
<p>the time indices of potential AO</p>
</td></tr>
<tr><td><code>lambda1</code></td>
<td>
<p>the corresponding test statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p> Chang, I.H., Tiao, G.C. and C. Chen (1988). Estimation of Time Series Parameters in the Presence of Outliers. 
Technometrics, 30, 193-204.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+detectIO">detectIO</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
y=arima.sim(model=list(ar=.8,ma=.5),n.start=158,n=100)
y[10]
y[10]=10
y=ts(y,freq=1,start=1)
plot(y,type='o')
acf(y)
pacf(y)
eacf(y)
m1=arima(y,order=c(1,0,0))
m1
detectAO(m1)
detectAO(m1, robust=FALSE)
detectIO(m1)
</code></pre>

<hr>
<h2 id='eacf'>Compute the sample extended acf (ESACF)</h2><span id='topic+eacf'></span>

<h3>Description</h3>

<p>Computes the sample extended acf (ESACF) for the time series stored in z.
The matrix of ESACF with the AR order up to ar.max and the MA order
up to ma.max is stored in the matrix EACFM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eacf(z, ar.max = 7, ma.max = 13)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eacf_+3A_z">z</code></td>
<td>
<p>the time series data</p>
</td></tr>
<tr><td><code id="eacf_+3A_ar.max">ar.max</code></td>
<td>
<p>maximum AR order; default=7</p>
</td></tr>
<tr><td><code id="eacf_+3A_ma.max">ma.max</code></td>
<td>
<p>maximum MA order; default=13</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following two components:  
</p>
<table role = "presentation">
<tr><td><code>eacf</code></td>
<td>
<p>a matrix of sample extended ACF</p>
</td></tr> 
<tr><td><code>symbol</code></td>
<td>
<p>corresponding matrix of symbols indicating the significance of
the ESACF</p>
</td></tr> 
</table>
<p>Side effect of the eacf function:
The function prints a coded ESACF table with
significant values denoted by * and nosignificant values by 0. 
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Tsay, R. and Tiao, G. (1984). &quot;Consistent Estimates of Autoregressive Parameters and
Extended Sample Autocorrelation Function for Stationary and Nonstationary
ARMA Models.&quot; Journal of the American Statistical Association, 79 (385), pp.
84-96.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arma11.s)
eacf(arma11.s)
</code></pre>

<hr>
<h2 id='eeg'>EEG Data</h2><span id='topic+eeg'></span>

<h3>Description</h3>

<p>An electroencephalogram (EEG) is a noninvasive test used to detect
and record the electrical activity generated in the brain. These data
were measured at a frequency of 256 per second and came from a
patient suffering a seizure. This a portion of a series on the website
of Professor Richard Smith, University of North Carolina. His
source: Professors Mike West and Andrew Krystal, Duke University.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(eeg)</code></pre>


<h3>Format</h3>

<p>The format is:
ts [1:13000, 1]  -3.08 -20.15 -45.05 -69.95 -94.57 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;eeg&quot;
- attr(*, &quot;tsp&quot;)= num [1:3]  2001 15000     1
</p>


<h3>Source</h3>

<p><code>http://www.stat.unc.edu/faculty/rs/s133/Data/datadoc.html</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eeg)
## maybe str(eeg) ; plot(eeg) ...
</code></pre>

<hr>
<h2 id='electricity'> Monthly US electricity production / time series</h2><span id='topic+electricity'></span>

<h3>Description</h3>

<p>Monthly U.S. electricity generation (in millions of kilowatt hours)
of all types: coal, natural gas, nuclear, petroleum, and wind,
01/1973 - 12/2005.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(electricity)</code></pre>


<h3>Format</h3>

<p>The format is:
'ts' int [1:396, 1] 160218 143539 148158 139589 147395 161244 173733 177365 156875 154197 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;electricity&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 1973 2006   12
</p>


<h3>Source</h3>

<p>Source: www.eia.doe.gov/emeu/mer/elect.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(electricity)
## maybe str(electricity) ; plot(electricity) ...
</code></pre>

<hr>
<h2 id='euph'>
A digitized sound file of a B flat 
played on a euphonium</h2><span id='topic+euph'></span>

<h3>Description</h3>

<p>A digitized sound file of about 0.4 seconds of a B flat just below
middle C played on a euphonium by one of the authors (JDC), a
member of the group Tempered Brass.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(euph)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:1105] from 1 to 1105: 0.244 0.635 0.712 0.608 0.317 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(euph)
## maybe str(euph) ; plot(euph) ...
</code></pre>

<hr>
<h2 id='explode.s'> A simulated explosive AR(1) series</h2><span id='topic+explode.s'></span>

<h3>Description</h3>

<p>A simulated AR(1) series with the AR(1) coefficient being 3.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(explode.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:8] from 1 to 8:  0.63  0.64  3.72 12.67 39.57 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(explode.s)
## maybe str(explode.s) ; plot(explode.s) ...
</code></pre>

<hr>
<h2 id='fitted.Arima'>Fitted values of an arima model.</h2><span id='topic+fitted.Arima'></span>

<h3>Description</h3>

<p>Computes the fitted values of an arima model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arima'
fitted(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.Arima_+3A_object">object</code></td>
<td>
<p>a fitted model from the arima function.</p>
</td></tr>
<tr><td><code id="fitted.Arima_+3A_...">...</code></td>
<td>
<p>other arguments; not used here but kept to be consistent with the 
generic method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fitted values</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+arima">arima</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hare)
hare.m1=arima(sqrt(hare),order=c(3,0,0))
fitted(hare.m1)
</code></pre>

<hr>
<h2 id='flow'>
Monthly River Flow for the Iowa River</h2><span id='topic+flow'></span>

<h3>Description</h3>

<p>Flow data (in cubic feet per second) for the Iowa river measured at
Wapello, Iowa for the period 09/1958 - 08/2006.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(flow)</code></pre>


<h3>Source</h3>

<p><code>http://waterdata.usgs.gov/ia/nwis/sw</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(flow)
## maybe str(flow) ; plot(flow) ...
</code></pre>

<hr>
<h2 id='garch.sim'>Simulate a GARCH process</h2><span id='topic+garch.sim'></span>

<h3>Description</h3>

<p>Simulate a GARCH process.</p>


<h3>Usage</h3>

<pre><code class='language-R'>garch.sim(alpha, beta, n = 100, rnd = rnorm, ntrans = 100,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="garch.sim_+3A_alpha">alpha</code></td>
<td>
<p>The vector of  ARCH coefficients including the intercept term as the 
first element</p>
</td></tr>
<tr><td><code id="garch.sim_+3A_beta">beta</code></td>
<td>
<p>The vector of GARCH coefficients</p>
</td></tr>
<tr><td><code id="garch.sim_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="garch.sim_+3A_rnd">rnd</code></td>
<td>
<p>random number generator for the noise; default is normal</p>
</td></tr>
<tr><td><code id="garch.sim_+3A_ntrans">ntrans</code></td>
<td>
<p>burn-in size, i.e. number of initial simulated data to be discarded</p>
</td></tr>
<tr><td><code id="garch.sim_+3A_...">...</code></td>
<td>
<p>parameters to be passed to the random number generator</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulate data from the GARCH(p,q) model:
<code class="reqn">x_t=\sigma_{t|t-1} e_t</code> where <code class="reqn">\{e_t\}</code> is iid,  <code class="reqn">e_t</code> 
independent of past <code class="reqn">x_{t-s}, s=1,2,\ldots</code>, and
</p>
<p style="text-align: center;"><code class="reqn">\sigma_{t|t-1}=\sum_{j=1}^p \beta_j \sigma_{t-j|t-j-1}+
\alpha_0+\sum_{j=1}^q \alpha_j x_{t-i}^2</code>
</p>



<h3>Value</h3>

<p>simulated GARCH time series of size n.
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1235678)
garch01.sim=garch.sim(alpha=c(.01,.9),n=500)
plot(garch01.sim,type='l', main='',ylab=expression(r[t]),xlab='t')
</code></pre>

<hr>
<h2 id='gBox'>Generalized Portmanteau Tests for GARCH Models</h2><span id='topic+gBox'></span>

<h3>Description</h3>

<p>Perform a goodness-of-fit test for the GARCH model by checking whether the 
standardized residuals are iid based on the ACF of the absolute residuals
or squared residuals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gBox(model, lags = 1:20, x, method = c("squared", "absolute")[1], plot = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gBox_+3A_model">model</code></td>
<td>
<p>fitted model from the garch function of the tseries library</p>
</td></tr>
<tr><td><code id="gBox_+3A_lags">lags</code></td>
<td>
<p>a vector of maximum ACF lags to be  used in the test</p>
</td></tr>
<tr><td><code id="gBox_+3A_x">x</code></td>
<td>
<p>time series data to which the GARCH model is fitted</p>
</td></tr>
<tr><td><code id="gBox_+3A_method">method</code></td>
<td>
<p>&quot;squared&quot;: test is based on squared residuals; &quot;absolute&quot;: test is
based on absolute residuals</p>
</td></tr>
<tr><td><code id="gBox_+3A_plot">plot</code></td>
<td>
<p>logical variable, if TRUE, the p-values of the tests are plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lags</code></td>
<td>
<p>lags in the input</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>a vector of p-values of the tests</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>x</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(tseries) # need to uncomment this line when running the example
data(CREF)
r.cref=diff(log(CREF))*100
m1=tseries::garch(x=r.cref,order=c(1,1))
summary(m1)
gBox(m1,x=r.cref,method='squared')

</code></pre>

<hr>
<h2 id='gold'>Gold Price / time series</h2><span id='topic+gold'></span>

<h3>Description</h3>

<p>Daily price of gold (in $ per troy ounce) for the 252 trading days of 2005</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gold)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:252] from 1 to 252: 427 426 426 423 421 ...
</p>


<h3>Source</h3>

<p>www.lbma.org.uk/2005dailygold.htm</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gold)
## maybe str(gold) ; plot(gold) ...
</code></pre>

<hr>
<h2 id='google'>
Daily returns of the google stock</h2><span id='topic+google'></span>

<h3>Description</h3>

<p>Daily returns of the google stock from 08/20/04 - 09/13/06.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(google)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:521] from 1 to 521:  0.0764  0.0100 -0.0423  0.0107  0.0179 ...
</p>


<h3>Source</h3>

<p><code>http://finance.yahoo.com/q/hp?s=GOOG</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(google)
## maybe str(google) ; plot(google) ...
</code></pre>

<hr>
<h2 id='hare'>Canadian hare data/ time series</h2><span id='topic+hare'></span>

<h3>Description</h3>

<p>Annual number of hare data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hare)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:31] from 1905 to 1935: 50 20 20 22 27 50 55 78 70 59 ...
</p>


<h3>Details</h3>

<p>These are yearly hare abundances  for the main drainage of
the Hudson Bay, based 
on trapper questionnaires.
</p>


<h3>Source</h3>

<p>MacLulich, D. A.   (1937)   Fluctuations in the Number of the
Varying Hare (Lepus americanus)  (Univ. of Toronto Press, Toronto)
</p>


<h3>References</h3>

<p>Stenseth, N. C., Falck, W., Bjornstad, O. N. and  Krebs. C. J. (1997)
Population regulation in snowshoe hare and Canadian lynx: Asymmetric
food web configurations between hare and lynx. Proc. Natl. Acad. Sci.,
94, 5147-5152.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hare)
</code></pre>

<hr>
<h2 id='harmonic'>Construct harmonic functions for fitting harmonic trend model</h2><span id='topic+harmonic'></span>

<h3>Description</h3>

<p>The function creates a matrix of the first m pairs of harmonic functions for
fitting a harmonic trend 
(cosine-sine trend, Fourier regresssion) models with the response
being x, a time series.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harmonic(x, m = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="harmonic_+3A_x">x</code></td>
<td>
<p>a time series</p>
</td></tr>
<tr><td><code id="harmonic_+3A_m">m</code></td>
<td>
<p>the number of pairs of harmonic functions to be created; 2m must be
less than or equal to the frequency of x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix consisting of <code class="reqn">\cos(2k \pi t), \sin(2k \pi t), k=1,2,...,m,</code>
excluding any zero functions.
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+season">season</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tempdub)
# first creates the first pair of harmonic functions and then fit the model
har.=harmonic(tempdub,1)
model4=lm(tempdub~har.)
summary(model4)
</code></pre>

<hr>
<h2 id='hours'> Average hours worked in US manufacturing sector / time series</h2><span id='topic+hours'></span>

<h3>Description</h3>

<p>Average hours worked (times 10) in U.S. manufacturing sector,
from 07/1982 - 06/1987</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hours)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:60] from 1983 to 1987: 389 390 389 390 393 397 392 388 396 398 ...
</p>


<h3>Source</h3>

<p>Cryer, J. D. Time Series Analysis,
Duxbury Press, 1986.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hours)
## maybe str(hours) ; plot(hours) ...
</code></pre>

<hr>
<h2 id='ima22.s'>Simulated IMA(2,2) series / time series</h2><span id='topic+ima22.s'></span>

<h3>Description</h3>

<p>A simulated IMA(2,2) series with theta1=1 and
theta2=-0.6</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ima22.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:62] from 1 to 62:  0.00000  0.00000 -0.00569  2.12404  2.15337 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ima22.s)
## maybe str(ima22.s) ; plot(ima22.s) ...
</code></pre>

<hr>
<h2 id='JJ'>Quarterly earnings per share for the Johnson &amp; Johnson Company</h2><span id='topic+JJ'></span>

<h3>Description</h3>

<p>Quarterly earnings per share for 1960Q1 to 1980Q4 of the U.S. company,
Johnson &amp; Johnson, Inc.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(JJ)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:84] from 1960 to 1981: 0.71 0.63 0.85 0.44 0.61 0.69 0.92 0.55 0.72 0.77 ...
</p>


<h3>Source</h3>

<p><code>http://www.stat.pitt.edu/stoffer/tsa2/</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(JJ)
## maybe str(JJ) ; plot(JJ) ...
</code></pre>

<hr>
<h2 id='Keenan.test'> Keenan's one-degree test for nonlinearity</h2><span id='topic+Keenan.test'></span>

<h3>Description</h3>

<p>Carry out Keenan's 1-degree test for nonlinearity against the null
hypothesis that the time series follows some AR process.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Keenan.test(x, order, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Keenan.test_+3A_x">x</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="Keenan.test_+3A_order">order</code></td>
<td>
<p>working AR order; if missing, it is estimated by minimizing
AIC via the ar function.</p>
</td></tr>
<tr><td><code id="Keenan.test_+3A_...">...</code></td>
<td>
<p>user-supplied options to the ar function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is designed to have  optimal local power against depature 
from the linear autoregressive function in the direction of the square of
the linear autoregressive function.
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<table role = "presentation">
<tr><td><code>test.stat</code></td>
<td>
<p>The observed test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value of the test</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>working AR order</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Keenan, D. M. (1985), A Tukey nonadditivity-type test for time series Nonlinearity,  Biometrika,  72,   39-44.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsay.test">Tsay.test</a></code>,<code><a href="#topic+tlrt">tlrt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spots)
Keenan.test(sqrt(spots))
</code></pre>

<hr>
<h2 id='kurtosis'>Kurtosis</h2><span id='topic+kurtosis'></span>

<h3>Description</h3>

<p>Computes the Kurtosis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kurtosis(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kurtosis_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="kurtosis_+3A_na.rm">na.rm</code></td>
<td>
<p>logical variable, if true, missing values are excluded from analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given data <code class="reqn">x_1,x_2,\ldots, x_n</code>, the sample kurtosis is 
defined by the formula:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{i=1}^n (x_i-\bar{x})^4/n}{(\sum_{i=1}^n 
(x_i-\bar{x})^2/n)^2}-3.</code>
</p>



<h3>Value</h3>

<p>The function returns the kurtosis of the data.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CREF)
r.cref=diff(log(CREF))*100
kurtosis(r.cref)
</code></pre>

<hr>
<h2 id='lagplot'>Lagged Regression Plot</h2><span id='topic+lagplot'></span>

<h3>Description</h3>

<p>Computes and plots the nonparametric regression function of a time series against
its various lags. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagplot(x, lag.max = 6, deg = 1, nn = 0.7, method = c("locfit", "gam", "both")[1])
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lagplot_+3A_x">x</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="lagplot_+3A_lag.max">lag.max</code></td>
<td>
<p>maximum lag</p>
</td></tr>
<tr><td><code id="lagplot_+3A_deg">deg</code></td>
<td>
<p>degree of local polynomial, needed only for the locfit method</p>
</td></tr>
<tr><td><code id="lagplot_+3A_nn">nn</code></td>
<td>
<p>fraction of nearest data contained in a window, needed only for the
locfit method</p>
</td></tr>
<tr><td><code id="lagplot_+3A_method">method</code></td>
<td>
<p>Two methods for nonparametric estimation: &quot;locfit&quot; is
the default which 
uses the local polynomial approach via the locfit library to estimate the
conditional mean function of <code class="reqn">E(X_t|X_{t-k}=x)</code> for <code class="reqn">1\le k \le lag.max</code>; 
Another method is GAM, via the mgcv library.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Side effects: The nonparametric lagged regression functions are plotted lag by
lag, with the raw data superimposed on the plots. 
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2534567)
par(mfrow=c(3,2))
y=arima.sim(n=61,model=list(ar=c(1.6,-0.94),ma=-0.64))
# lagplot(y)
</code></pre>

<hr>
<h2 id='larain'>Annual rainfall in Los Angeles / time series</h2><span id='topic+larain'></span>

<h3>Description</h3>

<p>Annual precipitation (in inches) in Los Angeles, 1878-1992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(larain)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:115] from 1778 to 1892: 20.86 17.41 18.65  5.53 10.74 ...
</p>


<h3>Source</h3>

<p>Personal communication from Professor Donald Bentley,
Pomona College, Claremont, California. For more data see
<code>http://www.wrh.noaa.gov/lox/climate/cvc.php</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(larain)
## maybe str(larain) ; plot(larain) ...
</code></pre>

<hr>
<h2 id='LB.test'>Portmanteau Tests for Fitted ARIMA models</h2><span id='topic+LB.test'></span>

<h3>Description</h3>

<p>This function modifies the Box.test function in the stats package, and it
computes the Ljung-Box or Box-Pierce tests checking whether or not the
residuals appear to be white noise. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LB.test(model, lag = 12, type = c("Ljung-Box", "Box-Pierce"), no.error = FALSE,
 omit.initial = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LB.test_+3A_model">model</code></td>
<td>
<p>model fit from the arima function</p>
</td></tr>
<tr><td><code id="LB.test_+3A_lag">lag</code></td>
<td>
<p>number of lags of the autocorrelation of the residuals to be
included in the test statistic. (default=12)</p>
</td></tr>
<tr><td><code id="LB.test_+3A_type">type</code></td>
<td>
<p>either Ljung-Box or Box-Pierce</p>
</td></tr>
<tr><td><code id="LB.test_+3A_no.error">no.error</code></td>
<td>
<p>a system variable; normally it is not changed</p>
</td></tr>
<tr><td><code id="LB.test_+3A_omit.initial">omit.initial</code></td>
<td>
<p>if true, (d+Ds) initial residuals are omitted from 
the test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list:
</p>
<table role = "presentation">
<tr><td><code>statistics</code></td>
<td>
<p>test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>d.f. of the Chi-square test</p>
</td></tr>
<tr><td><code>lag</code></td>
<td>
<p>no of lags</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan, based on A. Trapletti's work  on the Box.test function in the stats package</p>


<h3>References</h3>

<p>Box, G. E. P. and Pierce, D. A. (1970), Distribution of residual correlations in autoregressive-integrated moving average time series models. Journal of the American Statistical Association, 65, 15091526. 
</p>
<p>Ljung, G. M. and Box, G. E. P. (1978), On a measure of lack of fit in time series models. Biometrika 65, 553564. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(color)
m1.color=arima(color,order=c(1,0,0))
LB.test(m1.color)
</code></pre>

<hr>
<h2 id='ma1.1.s'>A simulated MA(1) series / time series</h2><span id='topic+ma1.1.s'></span>

<h3>Description</h3>

<p>A simulated MA(1) series with the MA(1) coefficient equal to 0.9.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ma1.1.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:120] from 1 to 120:  0.182 -0.748 -0.355  1.014 -2.363 ...
</p>


<h3>Details</h3>

<p>The model is <code class="reqn">Y(t)=e(t)-0.9e(t-1)</code> where the e's are iid standard normal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ma1.1.s)
## maybe str(ma1.1.s) ; plot(ma1.1.s) ...
</code></pre>

<hr>
<h2 id='ma1.2.s'>A simulated MA(1) series / time series</h2><span id='topic+ma1.2.s'></span>

<h3>Description</h3>

<p>A simulated MA(1) series with the MA(1) coefficient equal to -0.9.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ma1.2.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:120] from 1 to 120:  1.511  1.821  0.957 -1.538 -2.888 ...
</p>


<h3>Details</h3>

<p>The model is <code class="reqn">Y(t)=e(t)+0.9e(t-1)</code> where the e's are iid standard normal.  </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ma1.2.s)
## maybe str(ma1.2.s) ; plot(ma1.2.s) ...
</code></pre>

<hr>
<h2 id='ma2.s'>A simulated MA(2) series</h2><span id='topic+ma2.s'></span>

<h3>Description</h3>

<p>A simulated MA(2) series with MA coefficients being 1 and -0.6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ma2.s)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:120] from 1 to 120: -0.4675  0.0815  0.9938 -2.6959  2.8116 ...
</p>


<h3>Details</h3>

<p>The model is <code class="reqn">Y(t)=e(t)-e(t-1)+0.6*e(t-2)</code> where the e's are iid standard normal
random variables. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ma2.s)
## maybe str(ma2.s) ; plot(ma2) ...
</code></pre>

<hr>
<h2 id='McLeod.Li.test'>McLeod-Li test</h2><span id='topic+McLeod.Li.test'></span>

<h3>Description</h3>

<p>Perform the McLeod-Li test for conditional heteroscedascity
(ARCH).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>McLeod.Li.test(object, y, gof.lag, col = "red", omit.initial = TRUE, 
plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="McLeod.Li.test_+3A_object">object</code></td>
<td>
<p>a fitted Arima model, ususally the output from the arima
function. If supplied, then the Mcleod-Li test is applied to the residuals
of the model, and the y-argument is ignored.</p>
</td></tr>
<tr><td><code id="McLeod.Li.test_+3A_y">y</code></td>
<td>
<p>time series data with which one wants to test for the presence of
conditional heteroscedascity</p>
</td></tr>  
<tr><td><code id="McLeod.Li.test_+3A_gof.lag">gof.lag</code></td>
<td>
<p>maximum number of lags for which the test is carried out.</p>
</td></tr>
<tr><td><code id="McLeod.Li.test_+3A_col">col</code></td>
<td>
<p>color of the reference line</p>
</td></tr>
<tr><td><code id="McLeod.Li.test_+3A_omit.initial">omit.initial</code></td>
<td>
<p>suppress the initial (d+Ds) residuals if set to be TRUE</p>
</td></tr>
<tr><td><code id="McLeod.Li.test_+3A_plot">plot</code></td>
<td>
<p>suppress plotting if set to be FALSE</p>
</td></tr>
<tr><td><code id="McLeod.Li.test_+3A_...">...</code></td>
<td>
<p> other arguments to be passed to the plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test checks for the presence of conditional heteroscedascity by computing the
Ljung-Box (portmanteau) test with the squared data (if y is supplied and object
suppressed) or with the squared residuals from an arima model (if an arima
model is passed to the function via the object argument.) 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pvlaues</code></td>
<td>
<p>the vector of p-values for the Ljung-Box test statistics
computed using the first <code class="reqn">m</code> lags of the ACF of the squared data or residuals,
for <code class="reqn">m</code> ranging from 1 to gof.lag.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>McLeod, A. I. and W. K. Li (1983). Diagnostic checking ARMA time series models
using squared residual autocorrelations. Journal of Time Series Analysis, 4,
269273.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CREF)
r.cref=diff(log(CREF))*100
McLeod.Li.test(y=r.cref)
</code></pre>

<hr>
<h2 id='milk'>Monthly Milk Production</h2><span id='topic+milk'></span>

<h3>Description</h3>

<p> Average monthly milk production per cow in the US,
01/1994 - 12/2005</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(milk)</code></pre>


<h3>Format</h3>

<p>The format is:
'ts' int [1:144, 1] 1343 1236 1401 1396 1457 1388 1389 1369 1318 1354 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;milk&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 1994 2006   12
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(milk)
str(milk) 
plot(milk) 
</code></pre>

<hr>
<h2 id='oil.price'>Monthly Oil Price / time series</h2><span id='topic+oil.price'></span>

<h3>Description</h3>

<p>Monthly spot price for crude oil, Cushing, OK (in U.S. dollars per
barrel), 01/1986 - 01/2006.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(oil.price)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:241] from 1986 to 2006: 22.9 15.4 12.6 12.8 15.4 ...
</p>


<h3>Source</h3>

<p>tonto.eia.doe.gov/dnav/pet/hist/rwtcM.htm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil.price)
## maybe str(oil.price) ; plot(oil.price) ...
</code></pre>

<hr>
<h2 id='oilfilters'>
Monthly sales to dealers of a specialty oil
filter/time series</h2><span id='topic+oilfilters'></span>

<h3>Description</h3>

<p>Monthly wholesale specialty oil filters sales, Deere &amp; Co, 07/1983 -
06/1987.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(oilfilters)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:48] from 1984 to 1987: 2385 3302 3958 3302 2441 3107 5862 4536 4625 4492 ...
- attr(*, &quot;freq&quot;)= num 12
- attr(*, &quot;start&quot;)= num [1:2] 1987    7
</p>


<h3>Source</h3>

<p>Data courtesy of William F. Fulkerson, Deere &amp; Company, Technical Center, Moline,
Illinois.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oilfilters)
## maybe str(oilfilters) ; plot(oilfilters) ...
</code></pre>

<hr>
<h2 id='periodogram'>Computing the periodogram</h2><span id='topic+periodogram'></span>

<h3>Description</h3>

<p>This is a wrapper that computes the periodogram</p>


<h3>Usage</h3>

<pre><code class='language-R'>periodogram(y,log='no',plot=TRUE,ylab="Periodogram", xlab="Frequency",lwd=2,...) 
</code></pre>


<h3>Arguments</h3>

 <table role = "presentation">
<tr><td><code id="periodogram_+3A_y">y</code></td>
<td>
<p>A univariate time series</p>
</td></tr>
<tr><td><code id="periodogram_+3A_log">log</code></td>
<td>
<p>if set to &quot;yes&quot;, the periodogram is plotted on the log-scale; default=&quot;no&quot;</p>
</td></tr>
<tr><td><code id="periodogram_+3A_plot">plot</code></td>
<td>
<p>The periodogram is plotted if it is set to be TRUE which is the
default</p>
</td></tr>
<tr><td><code id="periodogram_+3A_ylab">ylab</code></td>
<td>
<p>label on the y-axis</p>
</td></tr>
<tr><td><code id="periodogram_+3A_xlab">xlab</code></td>
<td>
<p>label on the x-axis</p>
</td></tr>
<tr><td><code id="periodogram_+3A_lwd">lwd</code></td>
<td>
<p>thickness of the periodogram lines</p>
</td></tr>
<tr><td><code id="periodogram_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to the plot function</p>
</td></tr> </table>


<h3>Value</h3>

<p>A list that contains the following elements:
</p>
<table role = "presentation">
<tr><td><code>freq</code></td>
<td>
<p>Vector of frequencies at which the spectral density is estimated. (Possibly approximate Fourier frequencies.</p>
</td></tr> 
<tr><td><code>spec</code></td>
<td>
<p>Vector of estimates of the periodogram at frequencies corresponding to freq.</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Bloomfield, P. (1976) Fourier Analysis of Time Series: An Introduction. Wiley. 
</p>
<p>Brockwell, P. J. and Davis, R. A. (1991) Time Series: Theory and Methods. Second edition. Springer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(star)
plot(star,xlab='Day',ylab='Brightness')
periodogram(star,ylab='Variable Star Periodogram');  abline(h=0)
</code></pre>

<hr>
<h2 id='plot.Arima'>Compute and Plot the Forecasts Based on a Fitted Time Series Model</h2><span id='topic+plot.Arima'></span>

<h3>Description</h3>

<p> Plots the time series data and its predictions with 95% prediction bounds.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arima'
plot(x, n.ahead = 12, col = "black", ylab = object$series, 
lty = 2, n1, newxreg, transform, Plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Arima_+3A_x">x</code></td>
<td>
<p>a fitted arima model</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_n.ahead">n.ahead</code></td>
<td>
<p>number of prediction steps ahead (default=12)</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_col">col</code></td>
<td>
<p>color of the prediction bounds</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_ylab">ylab</code></td>
<td>
<p>label of the y-axis</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_lty">lty</code></td>
<td>
<p>line type of the point predictor; default=dashed lines</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_n1">n1</code></td>
<td>
<p>starting time point of the plot (default=earliest time point)</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_newxreg">newxreg</code></td>
<td>
<p>a matrix of covariate(s) over the period of prediction</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_transform">transform</code></td>
<td>
<p>function used to transform the forecasts and their prediction
bounds; if missing, no transformation will be carried out. This option is useful if the model was fitted to the transformed data and it is desirable to obtain the forecasts on the original scale. For example, if the model was fitted with the logarithm of the data, then transform = exp will plot the forecasts and their
prediction bounds on the original scale.</p>
</td></tr> 
<tr><td><code id="plot.Arima_+3A_plot">Plot</code></td>
<td>
<p>Plotting will be suppressed if Plot is set to be FALSE; default is TRUE</p>
</td></tr>
<tr><td><code id="plot.Arima_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Side effects of the function: plot the forecasts and their 95% prediction
bounds, unless Plot is set to be FALSE.
The part of the observed series is plotted with all data plotted as
open circles and linked by a smooth line. By default the predicted values
are plotted as open circles joined up by a dashed line. The plotting style of
the predicted values can be altered by supplying relevant plotting options, e.g
specifying the options type='o', pch=19 and lty=1 will plot the predicted
values as solid circles that are overlaid on the connecting smooth solid line.
The prediction limits are plotted as dotted lines, with default color being
black. However, the prediction limits can be drawn in 
other colors.
For example, setting col='red' paints the prediction limits in red.  
An interesting use of the col argument is setting col=NULL which has the effect
of not drawing the prediction limits.
</p>
<p>The function returns 
an invisible list containing the following components.
</p>
<table role = "presentation">
<tr><td><code>pred</code></td>
<td>
<p>the time series of predicted values</p>
</td></tr>
<tr><td><code>lpi</code></td>
<td>
<p>the corresponding lower 95% prediction limits</p>
</td></tr>
<tr><td><code>upi</code></td>
<td>
<p>the corresponding upper 95% prediction limits</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil.price)
oil.IMA11alt=arima(log(oil.price),order=c(0,1,1),
# create the design matrix of the covariate for prediction
xreg=data.frame (constant=seq(oil.price)))
n=length(oil.price)
n.ahead=24
newxreg=data.frame(constant=(n+1):(n+n.ahead))
# do the prediction and plot the results
plot(oil.IMA11alt,n.ahead=n.ahead,newxreg=newxreg,
ylab='Log(Oil Price)',xlab='Year',n1=c(2000,1))
# do the same thing but on the orginal scale
plot(oil.IMA11alt,n.ahead=n.ahead,newxreg=newxreg,
ylab='Oil Price',xlab='Year',n1=c(2000,1),transform=exp,pch=19, lty=1,type='o')
# Setting pch=19 plots the predicted values as solid circles.
res=plot(oil.IMA11alt,n.ahead=n.ahead,newxreg=newxreg,
ylab='Oil Price',xlab='Year',n1=c(2000,1),transform=exp,pch=19,col=NULL)
# Setting col=NULL will make the prediction bands invisible. Try col='red'. 
res
# prints the predicted values and their 95% prediction limits.

</code></pre>

<hr>
<h2 id='plot.armasubsets'>Plot the Best Subset ARMA models</h2><span id='topic+plot.armasubsets'></span>

<h3>Description</h3>

<p>This function is adapted from the plot.regsubsets function of the leaps
package, and its main use is to plot the output from the
armasubsets function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'armasubsets'
plot(x, labels = obj$xnames, main = NULL, 
scale = c("BIC", "AICc", "AIC", "Cp", "adjR2", "R2"), 
col = gray(c(seq(0.4, 0.7, length = 10), 0.9)), draw.grid = TRUE, 
axis.at.3 = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.armasubsets_+3A_x">x</code></td>
<td>
<p>an object of class armasubsets</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_labels">labels</code></td>
<td>
<p>variable names</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_main">main</code></td>
<td>
<p>title for plot</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_scale">scale</code></td>
<td>
<p>which summary statistic to use for ordering plots</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_col">col</code></td>
<td>
<p>the last color should be close to but distinct from white</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_draw.grid">draw.grid</code></td>
<td>
<p>a logical argument; if it is true (default), gray grid lines are superimposed on the graph.</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_axis.at.3">axis.at.3</code></td>
<td>
<p>a logical argument; if if it is true (default), the x-labels are drawn on the upper
horizontal axis.</p>
</td></tr>
<tr><td><code id="plot.armasubsets_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot the few best subset ARMA models.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan, based on previoud work by Thomas Lumley and Merlise Clyde</p>


<h3>See Also</h3>

<p>armasubsets</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(53331)
test=arima.sim(model=list(ar=c(rep(0,11),.8),ma=c(rep(0,11),0.7)),n=120)
res=armasubsets(y=test,nar=14,nma=14,y.name='test',ar.method='ols')
plot(res)
</code></pre>

<hr>
<h2 id='plot1.acf'>Plot1</h2><span id='topic+plot1.acf'></span>

<h3>Description</h3>

<p>A workhorse function for the acf function in the TSA pacakage.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>

<hr>
<h2 id='predict.TAR'>Prediction based on  a fitted TAR model</h2><span id='topic+predict.TAR'></span>

<h3>Description</h3>

<p>Predictions based on  a fitted TAR model. The errors are assumed to be
normally distributed. 
The predictive distributions are approximated by simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TAR'
predict(object, n.ahead = 1, n.sim = 1000,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.TAR_+3A_object">object</code></td>
<td>
<p>a fitted TAR model from the tar function</p>
</td></tr>
<tr><td><code id="predict.TAR_+3A_n.ahead">n.ahead</code></td>
<td>
<p>number of prediction steps ahead</p>
</td></tr>
<tr><td><code id="predict.TAR_+3A_n.sim">n.sim</code></td>
<td>
<p>simulation size</p>
</td></tr>
<tr><td><code id="predict.TAR_+3A_...">...</code></td>
<td>
<p>other arguments; not used here but kept for consistency with 
the generic method</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>a vector of medians of the 1-step to n.ahead-step predictive
distributions</p>
</td></tr>
<tr><td><code>pred.interval</code></td>
<td>
<p>a matrix whose i-th row consists of the 2.5 and 97.5 precentiles of the i-step predictive distribution</p>
</td></tr>
<tr><td><code>pred.matrix</code></td>
<td>
<p> a matrix whose j-th column consists of all simulated 
values from the j-step predictive distribution</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p> &quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tar">tar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prey.eq)
prey.tar.1=tar(y=log(prey.eq),p1=4,p2=4,d=3,a=.1,b=.9,print=TRUE)
set.seed(2357125)
pred.prey=predict(prey.tar.1,n.ahead=60,n.sim=1000)
yy=ts(c(log(prey.eq),pred.prey$fit),frequency=1,start=1)
plot(yy,type='n',ylim=range(c(yy,pred.prey$pred.interval)),ylab='Log Prey',
xlab=expression(t))
lines(log(prey.eq))
lines(window(yy, start=end(prey.eq)[1]+1),lty=2)
lines(ts(pred.prey$pred.interval[2,],start=end(prey.eq)[1]+1),lty=2)
lines(ts(pred.prey$pred.interval[1,],start=end(prey.eq)[1]+1),lty=2)
</code></pre>

<hr>
<h2 id='prescrip'> Cost per prescription / time series</h2><span id='topic+prescrip'></span>

<h3>Description</h3>

<p>Monthly U.S. average prescription costs for the months 08/1986 -
03/1992.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prescrip)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:68] from 1987 to 1992: 14.5 14.7 14.8 14.6 14.3 ...
</p>


<h3>Source</h3>

<p>Frees, E. W., Data Analysis Using Regression
Models, Prentice Hall, 1996.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prescrip)
## maybe str(prescrip) ; plot(prescrip) ...
</code></pre>

<hr>
<h2 id='prewhiten'>Prewhiten a Bivariate Time Series, and Compute and Plot Their Sample Cross-Correlation Function</h2><span id='topic+prewhiten'></span>

<h3>Description</h3>

<p>The bivariate time series are prewhitened according to an AR model fitted to
the x-component of the bivariate series. Alternatively, if an ARIMA model 
is provided, it will be used to prewhiten both series. The CCF of the
prewhitened bivariate
series is then computed and plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prewhiten(x, y, x.model = ar.res,ylab="CCF", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prewhiten_+3A_x">x</code></td>
<td>
<p>first component series</p>
</td></tr>
<tr><td><code id="prewhiten_+3A_y">y</code></td>
<td>
<p>second  component series</p>
</td></tr>
<tr><td><code id="prewhiten_+3A_x.model">x.model</code></td>
<td>
<p>an ARIMA model; if provided, it is used to prewhiten both series. Otherwise, an AR model is fitted to the x-series and used to prewhiten both
series.The AR order is chosen by minimizing the AIC and the fit carried out by
the ar.ols function.</p>
</td></tr>
<tr><td><code id="prewhiten_+3A_ylab">ylab</code></td>
<td>
<p>label of y-axis; default is &quot;CCF&quot;</p>
</td></tr>
<tr><td><code id="prewhiten_+3A_...">...</code></td>
<td>
<p> additional parameters to be passed to the ar.ols and the
ccf function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components: 
</p>
<table role = "presentation">
<tr><td><code>ccf</code></td>
<td>
<p>Output from the ccf function on the prewhitened data.</p>
</td></tr>
<tr><td><code>ar</code></td>
<td>
<p>The AR model fit to the x-series, or x.model if it is provided.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(milk)
data(electricity)
milk.electricity=ts.intersect(milk,log(electricity))
plot(milk.electricity,yax.flip=TRUE,main='') 
ccf(as.numeric(milk.electricity[,1]),as.numeric(milk.electricity[,2]),
main='milk &amp; electricity',ylab='CCF')
me.dif=ts.intersect(diff(diff(milk,12)),diff(diff(log(electricity),12)))
prewhiten(as.numeric(me.dif[,1]),as.numeric(me.dif[,2]),
,ylab='CCF' )
</code></pre>

<hr>
<h2 id='prey.eq'>Prey series / time series</h2><span id='topic+prey.eq'></span>

<h3>Description</h3>

<p>The stationary part of the Didinium series in the veilleux data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prey.eq)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:57] from 7 to 35:  26.9  53.2  65.6  81.2 143.9 ...
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+veilleux">veilleux</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prey.eq)
## maybe str(prey.eq) ; plot(prey.eq) ...
</code></pre>

<hr>
<h2 id='qar.sim'>Simulate a first-order quadratic AR model</h2><span id='topic+qar.sim'></span>

<h3>Description</h3>

<p>Simulates a first-order quadratic AR model with normally distributed noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qar.sim(const = 0, phi0 = 0, phi1 = 0.5, sigma = 1, n = 20, init = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qar.sim_+3A_const">const</code></td>
<td>
<p>intercept</p>
</td></tr>
<tr><td><code id="qar.sim_+3A_phi0">phi0</code></td>
<td>
<p>coefficient of the lag 1</p>
</td></tr>
<tr><td><code id="qar.sim_+3A_phi1">phi1</code></td>
<td>
<p>coefficient of the squared lag 1</p>
</td></tr>
<tr><td><code id="qar.sim_+3A_sigma">sigma</code></td>
<td>
<p>noise standard deviation</p>
</td></tr>
<tr><td><code id="qar.sim_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="qar.sim_+3A_init">init</code></td>
<td>
<p>number of burn-in values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quadratic AR(1) model specifies that 
</p>
<p style="text-align: center;"><code class="reqn">Y_t = \mathrm{const}+\phi_0 Y_{t-1}+\phi_1 Y^2_{t-1}+e_t</code>
</p>

<p>where <code class="reqn">e_t</code> are iid normally distributed with zero mean and standard
deviation <code class="reqn">\sigma</code>. If <code class="reqn">\sigma=0</code>, the model is deterministic. 
</p>


<h3>Value</h3>

<p>A simulated series from the quadratic AR(1) model, as a vector</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tar.sim">tar.sim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234567)
plot(y=qar.sim(n=15,phi1=.5,sigma=1),x=1:15,type='l',ylab=expression(Y[t]),xlab='t')
y=qar.sim(n=100,const=0.0,phi0=3.97, phi1=-3.97,sigma=0,init=.377)
plot(y,x=1:100,type='l',ylab=expression(Y[t]),xlab='t')
acf(y,main='')
</code></pre>

<hr>
<h2 id='retail'>U.K. retail sales / time series</h2><span id='topic+retail'></span>

<h3>Description</h3>

<p>Monthly total UK (United Kingdom) retail sales (non-food stores in
billions of pounds), 01/1983 - 12/1987.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(retail)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:60] from 1983 to 1988: 81.3 78.9 93.8 94 97.8 1.6 99.6 1.2 98 1.7 ...
</p>


<h3>Source</h3>

<p>www.statistics.gov.uk/statbase/TSDdownload1.asp
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(retail)
## maybe str(retail) ; plot(retail) ...
</code></pre>

<hr>
<h2 id='robot'>The distance of a robot from a desired position / time series</h2><span id='topic+robot'></span>

<h3>Description</h3>

<p>Final position in the x direction of an industrial robot put through a
series of planned exercises many times.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(robot)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:324] from 1 to 324: 0.0011 0.0011 0.0024 0 -0.0018 0.0055 0.0055 -0.0015 0.0047 -1e-04 ...
</p>


<h3>Source</h3>

<p>Personal communication
from William F. Fulkerson, Deere &amp; Co. Technical Center,
Moline, Illinois.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(robot)
## maybe str(robot) ; plot(robot) ...
</code></pre>

<hr>
<h2 id='rstandard.Arima'>Compute the Standardized Residuals from a Fitted ARIMA Model</h2><span id='topic+rstandard.Arima'></span>

<h3>Description</h3>

<p>Computes the internally standardized residuals from a fitted ARIMA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arima'
rstandard(model,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rstandard.Arima_+3A_model">model</code></td>
<td>
<p>model fitted by the arima function</p>
</td></tr>
<tr><td><code id="rstandard.Arima_+3A_...">...</code></td>
<td>
<p>not used; kept here for consistency with the generic method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>residuals/(error std. dev.) </p>


<h3>Value</h3>

<p>time series of standarized residuals</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil.price)
m1.oil=arima(log(oil.price),order=c(0,1,1))
plot(rstandard(m1.oil),ylab='Standardized residuals',type='l')
abline(h=0)
</code></pre>

<hr>
<h2 id='runs'>Runs test</h2><span id='topic+runs'></span>

<h3>Description</h3>

<p>Test the independence of a sequence of random variables by checking
whether there are too many or too few 
runs above (or below) the median.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runs(x,k=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runs_+3A_x">x</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="runs_+3A_k">k</code></td>
<td>
<p>the value above or below which runs are counted; default is zero, so
data is assumed to have zero median</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The runs
test examines the data 
in sequence to look for patterns
that would give
evidence against independence. Runs above or below k 
are counted. A small number
of runs would indicate that neighboring values are 
positively dependent and tend to hang together over time. 
On the other hand, too many runs would indicate that the
data 
oscillate back and forth across their median of zero. 
Then neighboring residuals
are negatively dependent. 
So either too few or too many runs lead us to reject independence.
When applied to residuals, the runs test is useful for model diagnostics.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pvalue</code></td>
<td>
<p>p-value of the test</p>
</td></tr>
<tr><td><code>observed.runs</code></td>
<td>
<p>observed number of runs</p>
</td></tr>
<tr><td><code>expected.runs</code></td>
<td>
<p>expected number of runs</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>number of data less than or equal to k</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>number of data above k</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tempdub)
month.=season(tempdub) # the period sign is included to make the printout from
# the following command clearer.
model3=lm(tempdub~month.) # intercept is automatically included so one month (Jan) is dropped
summary(model3)
runs(rstudent(model3))
</code></pre>

<hr>
<h2 id='rwalk'>A simulated random walk / Time series</h2><span id='topic+rwalk'></span>

<h3>Description</h3>

<p>A simulated random walk with standard normal increments 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rwalk)</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(rwalk)
## maybe str(rwalk) ; plot(rwalk) ...
</code></pre>

<hr>
<h2 id='season'>Extract the season info from a time series</h2><span id='topic+season'></span>

<h3>Description</h3>

<p>Extract the season info from a equally spaced 
time series and create a vector of the
season info. For example for monthly data, the function outputs a
vector containing the months of the data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>season(x, labels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="season_+3A_x">x</code></td>
<td>
<p> a time series</p>
</td></tr>
<tr><td><code id="season_+3A_labels">labels</code></td>
<td>
<p> the user supplied labels for the seasons</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time series must have frequency greater than 1, otherwise the 
function will stop and issue an error message.
If labels is missing, labels will be set as follows:
It is set to be c(&quot;1Q&quot;,&quot;2Q&quot;,&quot;3Q&quot;,&quot;4Q)
if the frequency of x equals 4, c(&quot;January&quot;,...,&quot;December&quot;)
if the frequency equals 12, and c(&quot;Monday&quot;,...,&quot;Sunday&quot;) if
frequency equals 7. Otherwise, it is set to be c(&quot;S1&quot;,...)
</p>


<h3>Value</h3>

<p>An invisible vector containing the seasons of the data 
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+harmonic">harmonic</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tempdub)
month.=season(tempdub) # the period sign is included to make the printout from
# the commands two line below clearer; ditto below.
model2=lm(tempdub~month.-1) # -1 removes the intercept term 
summary(model2)
</code></pre>

<hr>
<h2 id='skewness'>Skewness</h2><span id='topic+skewness'></span>

<h3>Description</h3>

<p>Computes the skewness of the data</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewness(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="skewness_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="skewness_+3A_na.rm">na.rm</code></td>
<td>
<p>logical variable, if true, missing values are excluded from analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given data <code class="reqn">x_1,x_2,\ldots, x_n</code>, the sample skewness is 
defined by the formula:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{i=1}^n (x_i-\bar{x})^3/n}{(\sum_{i=1}^n 
(x_i-\bar{x})^2/n)^{3/2}}.</code>
</p>



<h3>Value</h3>

<p>The function returns the skewness of the data.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CREF)
r.cref=diff(log(CREF))*100
skewness(r.cref)
</code></pre>

<hr>
<h2 id='SP'>Quarterly Standard &amp; Poor's Composite Index of stock price values /
time series</h2><span id='topic+SP'></span>

<h3>Description</h3>

<p>Quarterly S&amp;P Composite Index, 1936Q1 - 1977Q4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SP)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:168] from 1936 to 1978: 149 148 160 172 179 ...
</p>


<h3>Source</h3>

<p>Frees,
E. W., Data Analysis Using Regression Models, Prentice Hall, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SP)
## maybe str(SP) ; plot(SP) ...
</code></pre>

<hr>
<h2 id='spec'>Computing the spectrum</h2><span id='topic+spec'></span>

<h3>Description</h3>

<p>This is a wrapper that allows the user to invoke either the spec.pgram
function or the spec.ar function in the stats pacakge.  Note that the seasonal attribute of
the data, if it exists, will be removed, for our preferred way of presenting
the output.</p>


<h3>Usage</h3>

<pre><code class='language-R'> spec(x, taper = 0, detrend = FALSE, demean = TRUE, method = c("pgram", 
    "ar")[1], ci.plot = FALSE, ylim = range(c(lower.conf.band, upper.conf.band)), 
    ...) </code></pre>


<h3>Arguments</h3>

<p>A list that contains the following:
</p>
<table role = "presentation">
<tr><td><code id="spec_+3A_x">x</code></td>
<td>
<p>A univariate or multivariate time series</p>
</td></tr>
<tr><td><code id="spec_+3A_taper">taper</code></td>
<td>
<p>amount of taper; 0 is the default</p>
</td></tr>
<tr><td><code id="spec_+3A_detrend">detrend</code></td>
<td>
<p>logical; if True, the data are detrended; default is False</p>
</td></tr>
<tr><td><code id="spec_+3A_demean">demean</code></td>
<td>
<p>logical; if True, the data are centered; default is True</p>
</td></tr>
<tr><td><code id="spec_+3A_method">method</code></td>
<td>
<p>String specifying the method used to estimate the spectral density. Allowed methods are &quot;pgram&quot; (the default) and &quot;ar&quot;.</p>
</td></tr>
<tr><td><code id="spec_+3A_ci.plot">ci.plot</code></td>
<td>
<p>logical; if True, the 95% confidence band will be plotted.</p>
</td></tr>
<tr><td><code id="spec_+3A_ylim">ylim</code></td>
<td>
<p>Plotting parameter vector specifying the minimum and maximum of the 
y-axis.</p>
</td></tr>
<tr><td><code id="spec_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is from the spec.pgram function or spec.ar function, and 
the following description of the output is taken from the help manual
of the spec function in the stats package. 
An object of class &quot;spec&quot;, which is a list containing at least the following components: 
</p>
<table role = "presentation">
<tr><td><code>freq</code></td>
<td>
<p>Vector of frequencies at which the spectral density is estimated. (Possibly approximate Fourier frequencies.) The units are the reciprocal of cycles per unit time (and not per observation spacing): see Details below.</p>
</td></tr> 
<tr><td><code>spec</code></td>
<td>
<p>Vector (for univariate series) or matrix (for multivariate series) of estimates of the spectral density at frequencies corresponding to freq. 
coh NULL for univariate series. For multivariate time series, a matrix containing the squared coherency between different series. Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency between columns i and j of x, where i &lt; j.</p>
</td></tr> 
<tr><td><code>phase</code></td>
<td>
<p>NULL for univariate series. For multivariate time series a matrix containing the cross-spectrum phase between different series. The format is the same as coh.</p>
</td></tr> 
<tr><td><code>series</code></td>
<td>
<p>The name of the time series.</p>
</td></tr> 
<tr><td><code>snames</code></td>
<td>
<p>For multivariate input, the names of the component series.</p>
</td></tr> 
<tr><td><code>method</code></td>
<td>
<p>The method used to calculate the spectrum.</p>
</td></tr> 
</table>
<p>The result is returned invisibly if plot is true.
</p>


<h3>References</h3>

<p>Bloomfield, P. (1976) Fourier Analysis of Time Series: An Introduction. Wiley. 
</p>
<p>Brockwell, P. J. and Davis, R. A. (1991) Time Series: Theory and Methods. Second edition. Springer. 
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S-PLUS. Fourth edition. Springer. (Especially pages 3927.) 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(271435); n=200; phi=-0.6
y=arima.sim(model=list(ar=phi),n=n)
k=kernel('daniell',m=15)
sp=spec(y,kernel=k,main='',sub='',xlab='Frequency',
ylab='Log(Smoothed Sample Spectrum)',ci.plot=TRUE,ci.col='black')
lines(sp$freq,ARMAspec(model=list(ar=phi),sp$freq,plot=FALSE)$spec,lty=4)
abline(h=0)
</code></pre>

<hr>
<h2 id='spots'>Relative annual sunspot number / time series</h2><span id='topic+spots'></span>

<h3>Description</h3>

<p> Annual American (relative) sunspot numbers collected
from 1945 to 2007.
The annual (relative) sunspot number is a weighted average of
solar activities measured from a network of observatories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spots)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:61] from 1945 to 2005:  32.3  99.9 170.9 166.6 174.1 ...
</p>


<h3>Source</h3>

<p><code>http://www.ngdc.noaa.gov/stp/SOLAR/ftpsunspotnumber.html#american</code>
</p>


<h3>References</h3>

<p> &quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spots)
## maybe str(spots) ; plot(spots) ...
</code></pre>

<hr>
<h2 id='spots1'>
Annual international sunspot numbers
</h2><span id='topic+spots1'></span>

<h3>Description</h3>

<p>Annual international sunspot numbers, NOAA National Geophysical
Data Center, 1700 - 2005.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spots1)</code></pre>


<h3>Format</h3>

<p>The format is:
ts [1:306, 1] 5 11 16 23 36 58 29 20 10 8 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;spots&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 1700 2005    1
</p>


<h3>Source</h3>

<p><code>ftp://ftp.ngdc.noaa.gov/STP/SOLAR_DATA/SUNSPOT_NUMBERS/YEARLY.PLT</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spots1)
## maybe str(spots1) ; plot(spots1) ...
</code></pre>

<hr>
<h2 id='star'>Star Brightness</h2><span id='topic+star'></span>

<h3>Description</h3>

<p>Brightness (magnitude)
of a particular star at midnight on 600 consecutive nights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(star)</code></pre>


<h3>Source</h3>

<p>Whittaker, E. T. and Robinson, G., (1924). The Calculus of Observations. London:
Blackie and Son.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(star)
## maybe str(star) ; plot(star) ...
data(star)
plot(star,xlab='Day',ylab='Brightness')
</code></pre>

<hr>
<h2 id='summary.armasubsets'>Summary of output from the armasubsets function</h2><span id='topic+summary.armasubsets'></span>

<h3>Description</h3>

<p>Add the calculation of AIC and AICc. See the help manual of
regsubsets function of the leaps package</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'armasubsets'
summary(object, all.best = TRUE, matrix = TRUE, matrix.logical = FALSE,
 df = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.armasubsets_+3A_object">object</code></td>
<td>
<p>armasubsets object</p>
</td></tr>
<tr><td><code id="summary.armasubsets_+3A_all.best">all.best</code></td>
<td>
<p>Show all the best subsets or just one of each size</p>
</td></tr>
<tr><td><code id="summary.armasubsets_+3A_matrix">matrix</code></td>
<td>
<p>Show a matrix of the variables in each model or just summary statistics</p>
</td></tr>
<tr><td><code id="summary.armasubsets_+3A_matrix.logical">matrix.logical</code></td>
<td>
<p>With matrix=TRUE, the matrix is logical TRUE/FALSE or string &quot;*&quot;/code&quot; &quot;</p>
</td></tr>
<tr><td><code id="summary.armasubsets_+3A_df">df</code></td>
<td>
<p>Specify a number of degrees of freedom for the summary statistics. The default is n-1</p>
</td></tr>
<tr><td><code id="summary.armasubsets_+3A_...">...</code></td>
<td>
<p>Other arguments for future methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Kung-Sik Chan, based on previous work of Thomas Lumley</p>

<hr>
<h2 id='tar'>Estimation of a TAR model</h2><span id='topic+tar'></span>

<h3>Description</h3>

<p>Estimation of a two-regime TAR model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tar(y, p1, p2, d, is.constant1 = TRUE, is.constant2 = TRUE, transform = "no",
 center = FALSE, standard = FALSE, estimate.thd = TRUE, threshold, 
method = c("MAIC", "CLS")[1], a = 0.05, b = 0.95, order.select = TRUE, print = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tar_+3A_y">y</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="tar_+3A_p1">p1</code></td>
<td>
<p>AR order of the lower regime</p>
</td></tr>
<tr><td><code id="tar_+3A_p2">p2</code></td>
<td>
<p>AR order of the upper regime</p>
</td></tr>
<tr><td><code id="tar_+3A_d">d</code></td>
<td>
<p>delay parameter</p>
</td></tr>
<tr><td><code id="tar_+3A_is.constant1">is.constant1</code></td>
<td>
<p>if True, intercept included in the lower regime, otherwise
the intercept is fixed at zero</p>
</td></tr> 
<tr><td><code id="tar_+3A_is.constant2">is.constant2</code></td>
<td>
<p>similar to is.constant1 but for the upper regime</p>
</td></tr>
<tr><td><code id="tar_+3A_transform">transform</code></td>
<td>
<p>available transformations: &quot;no&quot; (i.e. use raw data), &quot;log&quot;, &quot;log10&quot; and
&quot;sqrt&quot;</p>
</td></tr>
<tr><td><code id="tar_+3A_center">center</code></td>
<td>
<p>if set to be True, data are centered before analysis</p>
</td></tr>
<tr><td><code id="tar_+3A_standard">standard</code></td>
<td>
<p>if set to be True, data are standardized before analysis</p>
</td></tr>
<tr><td><code id="tar_+3A_estimate.thd">estimate.thd</code></td>
<td>
<p>if True, threshold parameter is estimated, otherwise
it is fixed at the value supplied by threshold</p>
</td></tr>
<tr><td><code id="tar_+3A_threshold">threshold</code></td>
<td>
<p>known threshold value, only needed to be supplied if estimate.thd is set to be False.</p>
</td></tr>
<tr><td><code id="tar_+3A_method">method</code></td>
<td>
<p>&quot;MAIC&quot;: estimate the TAR model by minimizing  the AIC; 
&quot;CLS&quot;: estimate the TAR model by the method of Conditional Least Squares.</p>
</td></tr>
<tr><td><code id="tar_+3A_a">a</code></td>
<td>
<p>lower percent; the threshold is searched over the interval defined by the
a*100 percentile to the b*100 percentile of the time-series variable</p>
</td></tr>
<tr><td><code id="tar_+3A_b">b</code></td>
<td>
<p>upper percent</p>
</td></tr>
<tr><td><code id="tar_+3A_order.select">order.select</code></td>
<td>
<p>If method is &quot;MAIC&quot;, setting order.select to True will
enable the function to further select the AR order in 
each regime by minimizing 
AIC</p>
</td></tr>
<tr><td><code id="tar_+3A_print">print</code></td>
<td>
<p>if True, the estimated model will be printed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-regime Threshold Autoregressive  (TAR) model is given by the following
formula:
</p>
<p style="text-align: center;"><code class="reqn">
        Y_t = \phi_{1,0}+\phi_{1,1} Y_{t-1} +\ldots+                                                                                          \phi_{1,p} Y_{t-p_1} +\sigma_1 e_t,
         \mbox{  if } Y_{t-d}\le r </code>
</p>

<p style="text-align: center;"><code class="reqn"> Y_t = \phi_{2,0}+\phi_{2,1} Y_{t-1} +\ldots+\phi_{2,p_2} Y_{t-p}+\sigma_2 e_t,
\mbox{  if } Y_{t-d} &gt; r.</code>
</p>

<p>where r is the threshold and d the delay.
</p>


<h3>Value</h3>

<p>A list of class &quot;TAR&quot; which can be further processed by the 
by the predict and tsdiag functions.
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Tong, H. (1990) &quot;Non-linear Time Series, a Dynamical System Approach,&quot; Clarendon Press Oxford
</p>
<p>&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.TAR">predict.TAR</a></code>, 
<code><a href="#topic+tsdiag.TAR">tsdiag.TAR</a></code>, 
<code><a href="#topic+tar.sim">tar.sim</a></code>, 
<code><a href="#topic+tar.skeleton">tar.skeleton</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prey.eq)
prey.tar.1=tar(y=log(prey.eq),p1=4,p2=4,d=3,a=.1,b=.9,print=TRUE)
</code></pre>

<hr>
<h2 id='tar.sim'>Simulate a two-regime TAR model</h2><span id='topic+tar.sim'></span>

<h3>Description</h3>

<p>Simulate a two-regime TAR model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tar.sim(object, ntransient = 500, n = 500, Phi1, Phi2, thd, d, p, sigma1, 
sigma2, xstart = rep(0, max(p,d)), e)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tar.sim_+3A_object">object</code></td>
<td>
<p>a TAR model fitted by the tar function; if it is supplied, the 
model parameters and initial values are extracted from it</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_ntransient">ntransient</code></td>
<td>
<p>the burn-in size</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_n">n</code></td>
<td>
<p>sample size of the simulated series</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_phi1">Phi1</code></td>
<td>
<p>the coefficient vector of the lower-regime model</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_phi2">Phi2</code></td>
<td>
<p>the coefficient vector of the upper-regime model</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_thd">thd</code></td>
<td>
<p>threshold</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_d">d</code></td>
<td>
<p>delay</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_p">p</code></td>
<td>
<p>maximum autoregressive order</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_sigma1">sigma1</code></td>
<td>
<p>noise std. dev. in the lower regime</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_sigma2">sigma2</code></td>
<td>
<p>noise std. dev. in the upper regime</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_xstart">xstart</code></td>
<td>
<p>initial values for the simulation</p>
</td></tr>
<tr><td><code id="tar.sim_+3A_e">e</code></td>
<td>
<p>standardized noise series of size equal to length(xstart)+ntransient+n; if missing, it will be generated as some normally distributed errors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-regime Threshold Autoregressive  (TAR) model is given by the following
formula:
</p>
<p style="text-align: center;"><code class="reqn">
        Y_t = \phi_{1,0}+\phi_{1,1} Y_{t-1} +\ldots+                                                                                          \phi_{1,p} Y_{t-p_1} +\sigma_1 e_t,
         \mbox{  if } Y_{t-d}\le r </code>
</p>

<p style="text-align: center;"><code class="reqn"> Y_t = \phi_{2,0}+\phi_{2,1} Y_{t-1} +\ldots+\phi_{2,p_2} Y_{t-p}+\sigma_2 e_t,
\mbox{  if } Y_{t-d} &gt; r.</code>
</p>

<p>where r is the threshold and d the delay.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>y</code></td>
<td>
<p>simulated TAR series</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>the standardized errors</p>
</td></tr> 
</table>
<p>...
</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Tong, H. (1990) &quot;Non-linear Time Series, a Dynamical System Approach,&quot; Clarendon Press Oxford
&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tar">tar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234579)
y=tar.sim(n=100,Phi1=c(0,0.5),
Phi2=c(0,-1.8),p=1,d=1,sigma1=1,thd=-1,
sigma2=2)$y
plot(y=y,x=1:100,type='b',xlab="t",ylab=expression(Y[t]))
</code></pre>

<hr>
<h2 id='tar.skeleton'>Find the asympotitc behavior of the skeleton of a TAR model</h2><span id='topic+tar.skeleton'></span>

<h3>Description</h3>

<p>The skeleton of a TAR model is obtained by suppressing the noise term from
the TAR model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tar.skeleton(object, Phi1, Phi2, thd, d, p, ntransient = 500, n = 500, 
xstart, plot = TRUE,n.skeleton = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tar.skeleton_+3A_object">object</code></td>
<td>
<p>a TAR model fitted by the tar function; if it is supplied, the 
model parameters and initial values are extracted from it</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_ntransient">ntransient</code></td>
<td>
<p>the burn-in size</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_n">n</code></td>
<td>
<p>sample size of the skeleton trajectory</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_phi1">Phi1</code></td>
<td>
<p>the coefficient vector of the lower-regime model</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_phi2">Phi2</code></td>
<td>
<p>the coefficient vector of the upper-regime model</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_thd">thd</code></td>
<td>
<p>threshold</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_d">d</code></td>
<td>
<p>delay</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_p">p</code></td>
<td>
<p>maximum autoregressive order</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_xstart">xstart</code></td>
<td>
<p>initial values for the iteration of the skeleton</p>
</td></tr>
<tr><td><code id="tar.skeleton_+3A_plot">plot</code></td>
<td>
<p>if True, the time series plot of the skeleton is drawn</p>
</td></tr> 
<tr><td><code id="tar.skeleton_+3A_n.skeleton">n.skeleton</code></td>
<td>
<p>number of last n.skeleton points of the skeleton to be plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-regime Threshold Autoregressive  (TAR) model is given by the following
formula:
</p>
<p style="text-align: center;"><code class="reqn">
        Y_t = \phi_{1,0}+\phi_{1,1} Y_{t-1} +\ldots+                                                                                          \phi_{1,p} Y_{t-p_1} +\sigma_1 e_t,
         \mbox{  if } Y_{t-d}\le r </code>
</p>

<p style="text-align: center;"><code class="reqn"> Y_t = \phi_{2,0}+\phi_{2,1} Y_{t-1} +\ldots+\phi_{2,p_2} Y_{t-p}+\sigma_2 e_t,
\mbox{  if } Y_{t-d} &gt; r.</code>
</p>

<p>where r is the threshold and d the delay.
</p>


<h3>Value</h3>

<p>A vector that contains the trajectory of the skeleton, with the burn-in
discarded.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Tong, H. (1990) &quot;Non-linear Time Series, a Dynamical System Approach,&quot; Clarendon Press Oxford.
&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tar">tar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prey.eq)
prey.tar.1=tar(y=log(prey.eq),p1=4,p2=4,d=3,a=.1,b=.9,print=TRUE)
tar.skeleton(prey.tar.1)
</code></pre>

<hr>
<h2 id='tbone'>
A digitized sound file of a B flat 
played on a tenor trombone</h2><span id='topic+tbone'></span>

<h3>Description</h3>

<p>A digitized sound file of about 0.4 seconds of a B flat just below
middle C played on a tenor trombone by Chuck Kreeb, a member of
Tempered Brass and a friend of one of the authors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tbone)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:17689] from 1 to 17689: 0.0769 0.0862 0.0961 0.1050 0.1129 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tbone)
## maybe str(tbone) ; plot(tbone) ...
</code></pre>

<hr>
<h2 id='tempdub'>Monthly average temperature in Dubuque/time series</h2><span id='topic+tempdub'></span>

<h3>Description</h3>

<p>Monthly average temperature (in degrees Fahrenheit) 
recorded in Dubuque 1/1964 - 12/1975.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tempdub)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:144] from 1964 to 1976: 24.7 25.7 30.6 47.5 62.9 68.5 73.7 67.9 61.1 48.5 ...
</p>


<h3>Source</h3>

<p><code>http://mesonet.agron.iastate.edu/climodat/index.phtml?station=ia2364&amp;report=16</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tempdub)
## maybe str(tempdub) ; plot(tempdub) ...
</code></pre>

<hr>
<h2 id='tlrt'>Likelihood ratio test for threshold nonlinearity</h2><span id='topic+tlrt'></span>

<h3>Description</h3>

<p>Carry out the likelihood ratio test for threshold nonlinearity, with
the null hypothesis being a normal AR process and the alternative
hypothesis being a TAR model with homogeneous, normally distributed errors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tlrt(y, p, d = 1, transform = "no", a = 0.25, b = 0.75,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tlrt_+3A_y">y</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="tlrt_+3A_p">p</code></td>
<td>
<p>working AR order</p>
</td></tr>
<tr><td><code id="tlrt_+3A_d">d</code></td>
<td>
<p>delay</p>
</td></tr>
<tr><td><code id="tlrt_+3A_transform">transform</code></td>
<td>
<p>available transformations: &quot;no&quot; (i.e. use raw data), &quot;log&quot;, &quot;log10&quot; and
&quot;sqrt&quot;</p>
</td></tr>
<tr><td><code id="tlrt_+3A_a">a</code></td>
<td>
<p>lower percent; the threshold is searched over the interval defined by the
a*100 percentile to the b*100 percentile of the time-series variable</p>
</td></tr> 
<tr><td><code id="tlrt_+3A_b">b</code></td>
<td>
<p>upper percent</p>
</td></tr>
<tr><td><code id="tlrt_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to the ar function which determines the 
Ar order, if p is missing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The search for the threshold parameter may be narrower than that defined by the
user as the function attempts to ensure adequate sample size in each 
regime of the TAR model.
The p-value of the test is based on large-sample approximation and also 
is more reliable for small p-values. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>p.value</code></td>
<td>
<p>p-value of the test</p>
</td></tr>
<tr><td><code>test.statistic</code></td>
<td>
<p>likelihood ratio test statistic</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>the actual lower fraction that defines the interval of search
for the threshold; it may differ from the a specified by the user</p>
</td></tr> 
<tr><td><code>b</code></td>
<td>
<p>the actual upper fraction that defines the interval of search
for the threshold</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Chan, K.S. (1990).  Percentage points of likelihood ratio tests for
threshold autoregression.   Journal of Royal Statistical  Society, B  53, 3,  691-696.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Keenan.test">Keenan.test</a></code>, <code><a href="#topic+Tsay.test">Tsay.test</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spots)
pvaluem=NULL
for (d in 1:5){
res=tlrt(sqrt(spots),p=5,d=d,a=0.25,b=0.75)
pvaluem= cbind( pvaluem, round(c(d,signif(c(res$test.statistic, 
res$p.value))),3))
}
rownames(pvaluem)=c('d','test statistic','p-value')
pvaluem
</code></pre>

<hr>
<h2 id='Tsay.test'>Tsay's Test for nonlinearity</h2><span id='topic+Tsay.test'></span>

<h3>Description</h3>

<p>Carry out Tsay's test for quadratic nonlinearity in a time series. </p>


<h3>Usage</h3>

<pre><code class='language-R'>Tsay.test(x, order, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Tsay.test_+3A_x">x</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="Tsay.test_+3A_order">order</code></td>
<td>
<p>working linear AR order; if missing, it will be estimated
via the ar function by minimizing AIC</p>
</td></tr>
<tr><td><code id="Tsay.test_+3A_...">...</code></td>
<td>
<p>options to be passed to the ar function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis is that the true model is an AR process. The AR order, if missing, is estimated by minimizing AIC via the 
ar function, i.e. fitting autoregressive model to the data. The default
fitting method of the ar function is &quot;yule-walker.&quot; 
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<table role = "presentation">
<tr><td><code>test.stat</code></td>
<td>
<p>The observed test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value of the test</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>working AR order</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>Tsay, R. S. (1986), Nonlinearity test for time series,  
Biometrika, 73, 461-466.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Tsay.test">Tsay.test</a></code>,<code><a href="#topic+tlrt">tlrt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spots)
Tsay.test(sqrt(spots))
</code></pre>

<hr>
<h2 id='tsdiag.Arimax'>Model Diagnostics for a Fitted ARIMAX Model</h2><span id='topic+tsdiag.Arimax'></span>

<h3>Description</h3>

<p>This function is modified from the tsdiag function of the
stats package.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Arimax'
tsdiag(object, gof.lag, tol = 0.1, col = "red", omit.initial = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsdiag.Arimax_+3A_object">object</code></td>
<td>
<p>a fitted ARIMAX model</p>
</td></tr>
<tr><td><code id="tsdiag.Arimax_+3A_gof.lag">gof.lag</code></td>
<td>
<p>maximum lag used in ACF and Ljung-Box tests for the residuals</p>
</td></tr>
<tr><td><code id="tsdiag.Arimax_+3A_tol">tol</code></td>
<td>
<p>tolerance (default=0.1); see below</p>
</td></tr>
<tr><td><code id="tsdiag.Arimax_+3A_col">col</code></td>
<td>
<p>color of some warning lines in the figures (default=red)</p>
</td></tr>
<tr><td><code id="tsdiag.Arimax_+3A_omit.initial">omit.initial</code></td>
<td>
<p>suppress the initial (d+Ds) residuals if true</p>
</td></tr>
<tr><td><code id="tsdiag.Arimax_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to the acf function</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Side effects: 
Plot the time plot of the standardized residuals. Red dashed line at
+/-qnorm(0.025/no of data) are added to the plot. Data beyond these lines are deemed outliers,
based on the Bonferronni rule.
The ACF of the standardized residuals is plotted.
The p-values of the Ljung-Box test are plotted using a variety of 
the first K residuals. K starts at the lag on and beyond which the 
moving-average weights (in the MA(infinity) representation) 
are less than tol.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan, based on the tsdiag function of the stats pacakage</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(color)
m1.color=arima(color,order=c(1,0,0))
tsdiag(m1.color,gof=15,omit.initial=FALSE)
</code></pre>

<hr>
<h2 id='tsdiag.TAR'>Model diagnostics for a fitted TAR model</h2><span id='topic+tsdiag.TAR'></span>

<h3>Description</h3>

<p>The time series plot and the sample ACF of the standardized residuals are plotted.
Also, a portmanteau test for detecting residual correlations in the standardized
residuals are carried out. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TAR'
tsdiag(object, gof.lag, col = "red",xlab = "t", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsdiag.TAR_+3A_object">object</code></td>
<td>
<p>a fitted TAR model output from the tar function</p>
</td></tr>
<tr><td><code id="tsdiag.TAR_+3A_gof.lag">gof.lag</code></td>
<td>
<p>number of lags of ACF to be examined</p>
</td></tr>
<tr><td><code id="tsdiag.TAR_+3A_col">col</code></td>
<td>
<p>color of the lines flagging outliers, etc.</p>
</td></tr>
<tr><td><code id="tsdiag.TAR_+3A_xlab">xlab</code></td>
<td>
<p>x labels for the plots</p>
</td></tr>
<tr><td><code id="tsdiag.TAR_+3A_...">...</code></td>
<td>
<p> any additional user-supplied options to be passed to the
acf function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Side effects: plot the time-series plot of the standardized residuals, their
sample ACF and portmanteau test for residual autocorrelations in the standardized errors.</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>References</h3>

<p>&quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tar">tar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prey.eq)
prey.tar.1=tar(y=log(prey.eq),p1=4,p2=4,d=3,a=.1,b=.9,print=TRUE)
tsdiag(prey.tar.1)
</code></pre>

<hr>
<h2 id='tuba'>
A digitized sound file of a B flat 
played on a BB flat tuba</h2><span id='topic+tuba'></span>

<h3>Description</h3>

<p>A digitized sound file of about 0.4 seconds of a B flat an octave and
one whole step below middle C played on a BB flat tuba by Linda
Fisher, a member of Tempered Brass and a friend one of the authors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tuba)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:4402] from 1 to 4402: 0.217 0.209 0.200 0.195 0.196 ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tuba)
## maybe str(tuba) ; plot(tuba) ...
</code></pre>

<hr>
<h2 id='units'>
Annual sales of certain large equipment
</h2><span id='topic+units'></span>

<h3>Description</h3>

<p>Annual sales of certain large equipment, 1983 - 2005.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(units)</code></pre>


<h3>Format</h3>

<p>The format is:
ts [1:24, 1]  71.7  78.6 111.1 125.6 133.0 ...
- attr(*, &quot;tsp&quot;)= num [1:3] 1982 2005    1
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr &quot;Units&quot;
</p>


<h3>Source</h3>

<p>Proprietary
sales data from a large international company
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(units)
## maybe str(units) ; plot(units) ...
</code></pre>

<hr>
<h2 id='usd.hkd'>Daily US Dollar to Hong Kong Dollar Exchange Rates</h2><span id='topic+usd.hkd'></span>

<h3>Description</h3>

<p>Daily USD/HKD
(US dollar to Hong Kong dollar) exchange rate from January 1, 2005 to March 7, 2006
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(usd.hkd)</code></pre>


<h3>Format</h3>

<p>A data frame with 431 observations on the following 6 variables.
</p>

<dl>
<dt><code>r</code></dt><dd><p>daily returns of USD/HKD exchange rates</p>
</dd>
<dt><code>v</code></dt><dd><p>estimated conditional variances based on an AR(1)+GARCH(3,1) model</p>
</dd>
<dt><code>hkrate</code></dt><dd><p>daily USD/HKD exchange rates</p>
</dd>
<dt><code>outlier1</code></dt><dd><p>dummy variable of day 203, corresponding to July 22, 2005</p>
</dd>
<dt><code>outlier2</code></dt><dd><p>dummy variable of day 290, another possible outlier</p>
</dd>
<dt><code>day</code></dt><dd><p>calendar day</p>
</dd>
</dl>



<h3>Source</h3>

<p><code>http://www.oanda.com/convert/fxhistory</code>
</p>


<h3>References</h3>

<p> &quot;Time Series Analysis, with Applications in R&quot; by J.D. Cryer and K.S. Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(usd.hkd)
## maybe str(usd.hkd) ; plot(usd.hkd) ...
</code></pre>

<hr>
<h2 id='veilleux'>An experimental prey-predator time series</h2><span id='topic+veilleux'></span>

<h3>Description</h3>

<p>A data frame consisting of bivariate time series from an experiment for 
studying prey-predator dynamics. The first time series consists of
the numbers of
prey individuals (Didinium natsutum) per ml measured
every twelve hours over a period of 35 days; the second time series consists
of the corresponding number of predators (Paramecium aurelia) per ml.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(veilleux)</code></pre>


<h3>Format</h3>

<p>The format is:
mts [1:71, 1:2]  15.7  53.6  73.3  93.9 115.4 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : NULL
..$ : chr [1:2] &quot;Didinium&quot; &quot;Paramecium&quot;
- attr(*, &quot;tsp&quot;)= num [1:3] 0 35 2
- attr(*, &quot;class&quot;)= chr [1:2] &quot;mts&quot; &quot;ts&quot;
</p>


<h3>Source</h3>

<p><code>http://www-personal.buseco.monash.edu.au/~hyndman/TSDL/</code>
</p>


<h3>References</h3>

<p>Veilleux (1976) &quot;The analysis of a predatory interaction between 
Didinium and Paramecium&quot;, Masters thesis, University of Alberta. 
</p>
<p>Jost &amp; Ellner (2000) &quot;Testing for predator dependence in 
predator-prey dynamics: a non-parametric approach&quot;, Proceedings of 
the Royal Society of London B, 267, 1611-1620.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(veilleux)
## maybe str(veilleux) ; plot(veilleux) ...
</code></pre>

<hr>
<h2 id='wages'>Average hourly wages in the apparel industry / time series</h2><span id='topic+wages'></span>

<h3>Description</h3>

<p>Average hourly wages in the apparel industry, from 07/1981 - 06/1987.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wages)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:72] from 1982 to 1987: 4.92 4.96 5.04 5.05 5.04 5.04 5.18 5.13 5.15 5.18 ...
</p>


<h3>Source</h3>

<p>Cryer, J. D. Time Series Analysis,
Duxbury Press, 1986.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wages)
## maybe str(wages) ; plot(wages) ...
</code></pre>

<hr>
<h2 id='winnebago'>Monthly unit sales of recreational vehicles / time series</h2><span id='topic+winnebago'></span>

<h3>Description</h3>

<p>Monthly unit sales of recreational vehicles from Winnebago, Inc., Forrest City, Iowa, from 11/1966 - 02/1972. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(winnebago)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:64] from 1967 to 1972: 61 48 53 78 75 58 146 193 124 120 ...
</p>


<h3>Source</h3>

<p>Roberts, H. V., Data Analysis for
Managers with Minitab, second edition, The Scientific Press, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(winnebago)
## maybe str(winnebago) ; plot(winnebago) ...
</code></pre>

<hr>
<h2 id='zlag'>Compute the lag of a vector.</h2><span id='topic+zlag'></span>

<h3>Description</h3>

<p>Computes the lag of a vector, with missing elements replaced
by NA</p>


<h3>Usage</h3>

<pre><code class='language-R'>zlag(x, d= 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zlag_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="zlag_+3A_d">d</code></td>
<td>
<p>compute the lag d of x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector whose k-th element equals x[k-d] with x[t]=NA for t&lt;=0</p>


<h3>Author(s)</h3>

<p>Kung-Sik Chan</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- Should be DIRECTLY executable !! ----
##-- ==&gt;  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.
x=1:5
zlag(x,2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
