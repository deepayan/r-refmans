<!DOCTYPE html><html lang="en"><head><title>Help for package ivo.table</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ivo.table}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ivo_flextable_theme'><p>Use nice fonts and colors for tables</p></a></li>
<li><a href='#ivo_table'><p>Create pretty frequency/contingency tables</p></a></li>
<li><a href='#ivo_table_add_mask'><p>Add masking (censoring) to a table</p></a></li>
<li><a href='#ivo_table_masked'><p>Create a masked frequency/contingency table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nicely Formatted Contingency Tables and Frequency Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Nicely formatted frequency tables and contingency tables (1-way, 2-way, 3-way and 4-way tables), that can easily be exported to HTML or 'Office' documents. Designed to work with pipes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mthulin/ivo.table">https://github.com/mthulin/ivo.table</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mthulin/ivo.table/issues">https://github.com/mthulin/ivo.table/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, flextable, checkmate, officer, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, palmerpenguins</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-15 14:01:02 UTC; mans</td>
</tr>
<tr>
<td>Author:</td>
<td>Måns Thulin [aut, cre],
  Kajsa Grind [aut],
  Stefan Furne [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Måns Thulin &lt;mans@statistikkonsult.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-15 14:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ivo_flextable_theme'>Use nice fonts and colors for tables</h2><span id='topic+ivo_flextable_theme'></span>

<h3>Description</h3>

<p>A flextable theme for ivo_table objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivo_flextable_theme(
  x,
  kway = 2,
  rowsums = FALSE,
  caption = NA,
  highlight_cols = NULL,
  highlight_rows = NULL,
  color = "darkgreen",
  font_name = "Arial",
  bold_cols = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivo_flextable_theme_+3A_x">x</code></td>
<td>
<p>A flextable.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_kway">kway</code></td>
<td>
<p>The number of &quot;horizontal&quot; variables in the table.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_rowsums">rowsums</code></td>
<td>
<p>A logical, saying whether the rightmost column in the table contains the sum of each row. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_caption">caption</code></td>
<td>
<p>An optional string containing a table caption.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_highlight_cols">highlight_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_highlight_rows">highlight_rows</code></td>
<td>
<p>A numeric vector containing the indices of the rows that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_color">color</code></td>
<td>
<p>A named color or a color HEX code, used for the lines in the table. Defaults to &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_font_name">font_name</code></td>
<td>
<p>The name of the font to be used in the table. Defaults to &quot;Arial&quot;.</p>
</td></tr>
<tr><td><code id="ivo_flextable_theme_+3A_bold_cols">bold_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should use a bold font.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default settings use a dark green color and a sans serif font.
</p>


<h3>Value</h3>

<p>A styled flextable.
</p>


<h3>Author(s)</h3>

<p>Måns Thulin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(tidyr)
library(dplyr)
library(flextable)
example_data &lt;- data.frame(Year = sample(2020:2023, 50, replace = TRUE),
A = sample(c("Type 1", "Type 2"), 50, replace = TRUE),
B = sample(c("Apples", "Oranges", "Bananas"), 50, replace = TRUE),
C = sample(c("Swedish", "Norwegian", "Chilean"), 50, replace = TRUE))
example_data |&gt; select(B, A) |&gt;
  ftable(exclude=NULL) |&gt;
  data.frame() |&gt;
  spread(A, Freq) |&gt;
  regulartable() |&gt;
  ivo_flextable_theme()
</code></pre>

<hr>
<h2 id='ivo_table'>Create pretty frequency/contingency tables</h2><span id='topic+ivo_table'></span>

<h3>Description</h3>

<p><code>ivo_table()</code> lets you easily create a table using pretty fonts and colors. If you want the table with masked values use <code>ivo_table_masked()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivo_table(
  df,
  extra_header = TRUE,
  exclude_missing = FALSE,
  missing_string = "(Missing)",
  colsums = FALSE,
  rowsums = FALSE,
  sums_string = "Total",
  caption = NA,
  highlight_cols = NULL,
  highlight_rows = NULL,
  percent_by = NA,
  color = "darkgreen",
  font_name = "Arial",
  bold_cols = NULL,
  long_table = FALSE,
  remove_zero_rows = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivo_table_+3A_df">df</code></td>
<td>
<p>A data frame with 1-4 columns</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_extra_header">extra_header</code></td>
<td>
<p>Should the variable name be displayed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_exclude_missing">exclude_missing</code></td>
<td>
<p>Whether to exclude missing values from the table. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_missing_string">missing_string</code></td>
<td>
<p>A string used to indicate missing values. Defaults to &quot;(Missing)&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_colsums">colsums</code></td>
<td>
<p>A logical indicating whether the sum of each column should be computed. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_rowsums">rowsums</code></td>
<td>
<p>A logical indicating whether the sum of each row should be computed. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_sums_string">sums_string</code></td>
<td>
<p>A string that is printed in the column/row where row/column sums are shown. Defaults to &quot;Total&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_caption">caption</code></td>
<td>
<p>An optional string containing a table caption.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_highlight_cols">highlight_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_highlight_rows">highlight_rows</code></td>
<td>
<p>A numeric vector containing the indices of the rows that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_percent_by">percent_by</code></td>
<td>
<p>Used to get percentages instead of frequencies. There are three options: &quot;row&quot; to get percentages by row (each row sum is 100 percent), &quot;col&quot; to get percentages by column (each the sum of each row to 100 percent) and &quot;tot&quot; to get percentages out of the total (the sum of all cells is 100 percent). The default, NA, means that frequencies are displayed instead.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_color">color</code></td>
<td>
<p>A named color or a color HEX code, used for the lines in the table. Defaults to &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_font_name">font_name</code></td>
<td>
<p>The name of the font to be used in the table. Defaults to &quot;Arial&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_bold_cols">bold_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should use a bold font.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_long_table">long_table</code></td>
<td>
<p>For one-way tables: FALSE (the default) means that the table will be wide and consist of a single row, TRUE means that the table will be long and consist of a single column.</p>
</td></tr>
<tr><td><code id="ivo_table_+3A_remove_zero_rows">remove_zero_rows</code></td>
<td>
<p>If set to TRUE, removes all rows that contain nothing but zeros. The default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>ivo_table()</code> and <code>ivo_table_masked()</code> takes a <code>data.frame</code> with 1-4 columns. The order of the columns in the <code>data.frame</code> will determine where they will be displayed in the table. The first column will always be displayed at the top of the table. If there are more than one column the following 2-4 columns will be displayed to the left in the order 2, 3, 4. To change how the columns are displayed in the table; change the place of the columns in the <code>data.frame</code> using <code>dplyr::select()</code>.
</p>


<h3>Value</h3>

<p>A stylized <code>flextable</code>.
</p>


<h3>Author(s)</h3>

<p>Måns Thulin and Kajsa Grind
</p>


<h3>See Also</h3>

<p>ivo_table_add_mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
example_data &lt;- data.frame(Year = sample(2020:2023, 50, replace = TRUE),
A = sample(c("Type 1", "Type 2"), 50, replace = TRUE),
B = sample(c("Apples", "Oranges", "Bananas"), 50, replace = TRUE),
C = sample(c("Swedish", "Norwegian", "Chilean"), 50, replace = TRUE))

### 1 way tables ###
data1 &lt;- example_data |&gt; dplyr::select(Year)

ivo_table(data1)
ivo_table(data1, extra_header = FALSE) # Remove the header
ivo_table(data1, color = "orange") # Change color on table lines
ivo_table(data1, long_table = TRUE) # Draw the table in a long format
ivo_table(data1, font_name = "Garamond") # Use a different font

ivo_table_masked(data1) # No masking because all counts are &gt;=5
ivo_table_masked(data1, cell = 15) # Counts below &lt;=15 are masked

# With pipes
example_data |&gt; dplyr::select(Year) |&gt; ivo_table()

### 2-way tables ###
data2 &lt;- example_data |&gt; dplyr::select(A, B)
data2_swap &lt;- example_data |&gt; dplyr::select(B, A)

# Basic tables:
ivo_table(data2)
ivo_table(data2_swap) # Swap order of the columns
ivo_table(data2, colsums = TRUE) # Add the sum of each column
ivo_table(data2, rowsums = TRUE) # Add the sum of each row
ivo_table(data2, caption = "Awesome table") # Add a caption
ivo_table(data2, highlight_cols = 3) # Highlight column 3
ivo_table(data2, highlight_rows = 2, highlight_cols = 3) # Highlight cell at row 2 column 3
ivo_table(data2, bold_cols = 1) # Make the names in the first column bold

# Tables with percentages:
ivo_table(data2, percent_by = "row") # By row
ivo_table(data2, percent_by = "col") # By column
ivo_table(data2, percent_by = "tot") # By total

# Masked tables:
ivo_table_masked(data2)
ivo_table_masked(data2, cell = 7) # Counts &lt;= 7 are masked
# Row and column sums are also masked:
ivo_table_masked(
data2,
cell = 3,
colsums = TRUE,
rowsums = TRUE)

# Add a note at the end of the table:
# (colwidths must be set to the number of columns in the table)
ivo_table(data2) |&gt;
  flextable::add_footer_row(values = "This is a footnote.",
                            colwidths = 3)

# Add footnotes to cells in the table:
ivo_table(data2) |&gt;
flextable::footnote(i = c(1, 3), j = c(1, 2),
                    value = flextable::as_paragraph(c(
                      "Some remark.",
                      "Some comment.")),
                    ref_symbols = c("a", "b"))

# Add footnotes to cells in the table header:
ivo_table(data2) |&gt;
flextable::footnote(i = 2, j = c(1, 3),
                    value = flextable::as_paragraph(c(
                      "Some remark.",
                      "Some comment.")),
                    ref_symbols = c("a", "b"),
                    part = "header")

### 3-way tables ###
data3 &lt;- example_data |&gt; dplyr::select(C, B, Year)

ivo_table(data3)
ivo_table(data3, colsums = TRUE, rowsums = TRUE) # Add the sum of each column and each row

ivo_table_masked(
data3,
cell = 3,
caption = "Values between 1 and 3 are masked."
)

### 4-way tables ###
data4 &lt;- example_data |&gt; dplyr::select(Year, B, C, A)

ivo_table(data4)
ivo_table(data4, remove_zero_rows = TRUE) # Remove the row with zeros

# Add the sum of each column and each row and highlight column 6:
ivo_table(
data4,
colsums = TRUE,
rowsums = TRUE,
highlight_cols = 6)

ivo_table_masked(data4, colsums = TRUE, rowsums = TRUE)
</code></pre>

<hr>
<h2 id='ivo_table_add_mask'>Add masking (censoring) to a table</h2><span id='topic+ivo_table_add_mask'></span>

<h3>Description</h3>

<p>Table masking using cell counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivo_table_add_mask(df, cell = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivo_table_add_mask_+3A_df">df</code></td>
<td>
<p>A data frame containing a column called &quot;Freq&quot;, e.g. a frequency table created using <code>ftable(exclude=NULL) |&gt; data.frame()</code>.</p>
</td></tr>
<tr><td><code id="ivo_table_add_mask_+3A_cell">cell</code></td>
<td>
<p>The cell count at which masking should be used. Cell counts between 1 and this number will be masked. The default is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Masking is used to prevent the distribution of tables where individuals could be identified.
</p>


<h3>Value</h3>

<p>A data frame with masked cell counts.
</p>


<h3>Author(s)</h3>

<p>Måns Thulin
</p>


<h3>See Also</h3>

<p>ivo_table_masked for masked tables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)
example_data &lt;- data.frame(Year = sample(2020:2023, 50, replace = TRUE),
A = sample(c("Type 1", "Type 2"), 50, replace = TRUE),
B = sample(c("Apples", "Oranges", "Bananas"), 50, replace = TRUE),
C = sample(c("Swedish", "Norwegian", "Chilean"), 50, replace = TRUE))
# With masking limit set at 7:
example_data |&gt; select(Year, A) |&gt;
  ftable(exclude=NULL) |&gt;
  data.frame() |&gt;
  ivo_table_add_mask(cell = 7)

</code></pre>

<hr>
<h2 id='ivo_table_masked'>Create a masked frequency/contingency table</h2><span id='topic+ivo_table_masked'></span>

<h3>Description</h3>

<p><code>ivo_table_masked()</code> lets you easily create pretty masked tables. If you want the table without masked values use <code>ivo_table()</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivo_table_masked(
  df,
  cell = 5,
  extra_header = TRUE,
  exclude_missing = FALSE,
  missing_string = "(Missing)",
  colsums = FALSE,
  rowsums = FALSE,
  sums_string = "Total",
  caption = NA,
  highlight_cols = NULL,
  highlight_rows = NULL,
  color = "darkgreen",
  font_name = "Arial",
  bold_cols = NULL,
  long_table = FALSE,
  remove_zero_rows = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivo_table_masked_+3A_df">df</code></td>
<td>
<p>A data frame with 1-4 columns</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_cell">cell</code></td>
<td>
<p>The largest value that will be masked. Defaults to 5, meaning that values between 1 and 5 are masked.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_extra_header">extra_header</code></td>
<td>
<p>Should the variable name be displayed? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_exclude_missing">exclude_missing</code></td>
<td>
<p>Whether to exclude missing values from the table. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_missing_string">missing_string</code></td>
<td>
<p>A string used to indicate missing values. Defaults to &quot;(Missing)&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_colsums">colsums</code></td>
<td>
<p>A logical indicating whether the sum of each column should be computed. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_rowsums">rowsums</code></td>
<td>
<p>A logical indicating whether the sum of each row should be computed. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_sums_string">sums_string</code></td>
<td>
<p>A string that is printed in the column/row where row/column sums are shown. Defaults to &quot;Total&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_caption">caption</code></td>
<td>
<p>An optional string containing a table caption.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_highlight_cols">highlight_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_highlight_rows">highlight_rows</code></td>
<td>
<p>A numeric vector containing the indices of the rows that should be highlighted.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_color">color</code></td>
<td>
<p>A named color or a color HEX code, used for the lines in the table. Defaults to &quot;darkgreen&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_font_name">font_name</code></td>
<td>
<p>The name of the font to be used in the table. Defaults to &quot;Arial&quot;.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_bold_cols">bold_cols</code></td>
<td>
<p>A numeric vector containing the indices of the columns that should use a bold font.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_long_table">long_table</code></td>
<td>
<p>For one-way tables: FALSE (the default) means that the table will be wide and consist of a single row, TRUE means that the table will be long and consist of a single column.</p>
</td></tr>
<tr><td><code id="ivo_table_masked_+3A_remove_zero_rows">remove_zero_rows</code></td>
<td>
<p>If set to TRUE, removes all rows that contain nothing but zeros. The default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>ivo_table()</code> and <code>ivo_table_masked()</code> takes a <code>data.frame</code> with 1-4 columns. The order of the columns in the <code>data.frame</code> will determine where they will be displayed in the table. The first column will always be displayed at the top of the table. If there are more than one column the following 2-4 columns will be displayed to the left in the order 2, 3, 4. To change how the columns are displayed in the table; change the place of the columns in the <code>data.frame</code> using <code>dplyr::select()</code>.
</p>


<h3>Value</h3>

<p>A stylized <code>flextable</code>.
</p>


<h3>Author(s)</h3>

<p>Måns Thulin and Kajsa Grind
</p>


<h3>See Also</h3>

<p>ivo_table_add_mask
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
example_data &lt;- data.frame(Year = sample(2020:2023, 50, replace = TRUE),
A = sample(c("Type 1", "Type 2"), 50, replace = TRUE),
B = sample(c("Apples", "Oranges", "Bananas"), 50, replace = TRUE),
C = sample(c("Swedish", "Norwegian", "Chilean"), 50, replace = TRUE))

### 1-way tables ###
data1 &lt;- example_data |&gt; dplyr::select(Year)
ivo_table_masked(data1) # No masking because all counts are &gt;=5
ivo_table_masked(data1, cell = 15) # Counts below &lt;=15 are masked

# With pipes
example_data |&gt; dplyr::select(Year) |&gt; ivo_table()

### 2-way tables ###
data2 &lt;- example_data |&gt; dplyr::select(A, B)
ivo_table_masked(data2)
ivo_table_masked(data2, cell = 7) # Counts &lt;= 7 are masked
# Row and column sums are also masked:
ivo_table_masked(
data2,
cell = 3,
colsums = TRUE,
rowsums = TRUE)

### 3-way tables ###
data3 &lt;- example_data |&gt; dplyr::select(C, B, Year)
ivo_table_masked(
data3,
cell = 3,
caption = "Values between 1 and 3 are masked."
)

### 4-way tables ###
data4 &lt;- example_data |&gt; dplyr::select(Year, B, C, A)
ivo_table_masked(data4, colsums = TRUE, rowsums = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
