<!DOCTYPE html><html><head><title>Help for package DEMOVA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DEMOVA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DEMOVA-package'>
<p>DEvelopment of (multi-linear QSPR/QSAR) MOdels VAlidated using test set.</p></a></li>
<li><a href='#fitting'>
<p>Performance of selected model</p></a></li>
<li><a href='#graphe_3Sets'>
<p>Predictions for the external validation set and graph</p></a></li>
<li><a href='#LMO'>
<p>Leave Many Out</p></a></li>
<li><a href='#LOO'>
<p>Leave One Out</p></a></li>
<li><a href='#prediction'>
<p>Predictions for the test set and graph</p></a></li>
<li><a href='#preselection'>
<p>Suppression of missing or constant descriptors</p></a></li>
<li><a href='#scramb'>
<p>scrambling</p></a></li>
<li><a href='#select_MLR'>
<p>Development of the model (multi linear regression)</p></a></li>
<li><a href='#select_variables'>
<p>Selection of descriptors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>DEvelopment (of Multi-Linear QSPR/QSAR) MOdels VAlidated using
Test Set</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-03-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Vinca Prana</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vinca Prana &lt;vinca.prana@free.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tool for the development of multi-linear QSPR/QSAR models (Quantitative structure-property/activity relationship). Theses models are used in chemistry, biology and pharmacy to find a relationship between the structure of a molecule and its property (such as activity, toxicology but also physical properties). The various functions of this package allows: selection of descriptors based of variances, intercorrelation and user expertise; selection of the best multi-linear regression in terms of correlation and robustness; methods of internal validation (Leave-One-Out, Leave-Many-Out, Y-scrambling) and external using test sets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>leaps</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-15 16:07:15 UTC</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-15 19:54:06</td>
</tr>
</table>
<hr>
<h2 id='DEMOVA-package'>
DEvelopment of (multi-linear QSPR/QSAR) MOdels VAlidated using test set.
</h2><span id='topic+DEMOVA-package'></span><span id='topic+DEMOVA'></span>

<h3>Description</h3>

<p>Tool for the development of multi-linear QSPR/QSAR models (Quantitative structure-property/activity relationship). Theses models are used in chemistry, biology and pharmacy to find a relationship between the structure of a molecule and its property (such as activity, toxicology but also physical properties). The various functions of this package allows: selection of descriptors based of variances, intercorrelation and user expertise; selection of the best multi-linear regression in terms of correlation and robustness; methods of internal validation (Leave-One-Out, Leave-Many-Out, Y-scrambling) and external using test sets.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DEMOVA</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-03-15</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Example of input files are avaible into the floder &quot;tests&quot;. <br />
# data&lt;-read.csv(&quot;NameOfInputFile.csv&quot;,header = TRUE , sep=&quot; &quot;)  <br />
# mydesc&lt;-data[,3:dim[2]] <br />
Functions should be use in this order: <br /> 
- preselection <br /> 
- select_variables <br /> 
- select_MLR <br /> 
- fit <br /> 
- LOO / LMO / Scramb  (No specific order between these ones. Optional to do the rest) <br /> 
- prediction <br /> 
- graphe_3Sets <br /> 
</p>


<h3>Author(s)</h3>

<p>Vinca Prana <br />
Maintainer: Vinca Prana &lt;vinca.prana@free.fr&gt;
</p>


<h3>References</h3>

<p>1. Selassie, C. D. History of Quantitative Structure-Activity Relationship; Burger's Medicinal Chemistry and Drug Discovery Sixth Edition; John Wiley &amp; Sons Inc., 2002; Vol. 1. (2)  <br />
2. Willett, P. Chemoinformatics: a History. Wiley Interdisciplinary Reviews: Computational Molecular Science 2011, 1, 46-56.
</p>

<hr>
<h2 id='fitting'>
Performance of selected model
</h2><span id='topic+fitting'></span>

<h3>Description</h3>

<p>Perform a multi linear regression between property and previously selected descriptors (using select_MLR function). <br />
Calculate R2 coefficient and the predicted values from the MLR. Trace the graph experimental values vs predicted values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitting(mydata, n, property)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitting_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="fitting_+3A_n">n</code></td>
<td>

<p>Number of selected descriptors of the regression (determined using select_MLR function)
</p>
</td></tr>
<tr><td><code id="fitting_+3A_property">property</code></td>
<td>

<p>Name of the studied proterty
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prediction_TrainSet_Y.csv</code></td>
<td>
<p> File containing prediction obtained using the fitting</p>
</td></tr>
<tr><td><code>Y_TrainingSet.tiff</code></td>
<td>
<p> Image representing experimental values vs predicted values for the training set</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p> lm object return by the function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># First run select_MLR to define n
# y&lt;-data[,2]
# mydata&lt;-cbind(y,MLR)
# fit&lt;-fitting(data,dim(MLR)[2],"Name of property")
</code></pre>

<hr>
<h2 id='graphe_3Sets'>
Predictions for the external validation set and graph
</h2><span id='topic+graphe_3Sets'></span>

<h3>Description</h3>

<p>Calulate the predicted values for the external validation set and trace the graph experimental values vs predicted values for training, test and external validation sets. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphe_3Sets(fit, mydata, mynewdata, mynewdata2, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphe_3Sets_+3A_fit">fit</code></td>
<td>

<p>Multi linear regression between property and selected descriptors (lm object)
</p>
</td></tr>
<tr><td><code id="graphe_3Sets_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="graphe_3Sets_+3A_mynewdata">mynewdata</code></td>
<td>

<p>Dataframe containing property and selected descriptors values for the test set
</p>
</td></tr>
<tr><td><code id="graphe_3Sets_+3A_mynewdata2">mynewdata2</code></td>
<td>

<p>Dataframe containing property and selected descriptors values for the external validation set
</p>
</td></tr>
<tr><td><code id="graphe_3Sets_+3A_n">n</code></td>
<td>

<p>Numbers of selected descriptors of the regression (determined using select_MLR)
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Rext</code>, <code>Rext2</code></td>
<td>
<p>return a list containing the value of the determination coefficient of the test set and of the external validation set</p>
</td></tr>
<tr><td><code>Graphe_3sets.tiff</code></td>
<td>
<p>Image representing experimental values vs predicted values for the all three sets</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># This function have to be run last!

## "Test_set.csv" should be with the following form
## ID property SelectedDesc1 SelectedDesc2 ... 

# new_nom&lt;-'Test_set.csv'
# newdata&lt;-read.csv(new_nom,header=TRUE , sep=" ")
# mynewdata=newdata[,2:dim[2]]


## "External_set.csv" should be with the following form
## ID property SelectedDesc1 SelectedDesc2 ... 

# new_nom2&lt;-'External_set.csv'
# newdata2&lt;-read.csv(new_nom2,header=TRUE , sep=" ")
# mynewdata2=newdata2[,2:dim[2]]

#graphe_3Sets(fit,mynewdata,mynewdata2,dim(MLR)[2])
</code></pre>

<hr>
<h2 id='LMO'>
Leave Many Out
</h2><span id='topic+LMO'></span>

<h3>Description</h3>

<p>Calculate the robustness of the equation using the leave many out method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMO(mydata, cv, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMO_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="LMO_+3A_cv">cv</code></td>
<td>

<p>Numbers of fold
</p>
</td></tr>
<tr><td><code id="LMO_+3A_n">n</code></td>
<td>

<p>Numbers of selected descriptors of the regression (determined using Select_MLR)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return Q2, the coefficient that measure the robstness
</p>


<h3>References</h3>

<p>1. Gramatica, P. Principles of QSAR Models Validation: Internal and External. Qsar &amp;
Combinatorial Science 2007, 26, 694-701.  <br />
2. Golbraikh, A.; Tropsha, A. Beware of Q(2)! Journal of Molecular Graphics &amp; Modelling 2002,
20, 269-276.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First run Select_MLR to define n

#LMO(mydata,5,dim(MLR)[2])
#LMO(mydata,10,dim(MLR)[2])
</code></pre>

<hr>
<h2 id='LOO'>
Leave One Out
</h2><span id='topic+LOO'></span>

<h3>Description</h3>

<p>Calculate the robustness of the equation using the leave one out method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LOO(mydata, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LOO_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="LOO_+3A_n">n</code></td>
<td>

<p>Numbers of selected descriptors of the regression (determined using Select_MLR)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return Q2, the coefficient that measure the robstness
</p>


<h3>References</h3>

<p>1. Gramatica, P. Principles of QSAR Models Validation: Internal and External. Qsar &amp; Combinatorial Science 2007, 26, 694-701.  <br />
2. Golbraikh, A.; Tropsha, A. Beware of Q(2)! Journal of Molecular Graphics &amp; Modelling 2002, 20, 269-276.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First run Select_MLR to define n

# LOO(mydata,dim(MLR)[2])
</code></pre>

<hr>
<h2 id='prediction'>
Predictions for the test set and graph
</h2><span id='topic+prediction'></span>

<h3>Description</h3>

<p>Calulate the predicted values for the test set and trace the graph experimental values vs predicted values for both training and test sets. This function also give the R2 test coefficent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prediction(fit, mydata, mynewdata, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prediction_+3A_fit">fit</code></td>
<td>

<p>Multi linear regression between property and selected descriptors
</p>
</td></tr>
<tr><td><code id="prediction_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="prediction_+3A_mynewdata">mynewdata</code></td>
<td>

<p>Dataframe containing property and selected descriptors values for the test set
</p>
</td></tr>
<tr><td><code id="prediction_+3A_n">n</code></td>
<td>

<p>Numbers of selected descriptors of the regression (determined using Select_MLR)
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Exp.vs.Pred.tiff</code></td>
<td>
<p>Image representing experimental values vs predicted values for the both sets</p>
</td></tr>
<tr><td><code>Rext</code></td>
<td>
<p>return the value of the determination coefficient of the test set</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># This function have to be run after choise of the model.

## "Test_set.csv" should be with the following form
## ID property SelectedDesc1 SelectedDesc2 ... 

#new_nom&lt;-'Test_set.csv'
#newdata&lt;-read.csv(new_nom,header=TRUE , sep=" ")
#mynewdata=newdata[,2:dim[2]]

#prediction(fit,mynewdata,dim(MLR)[2])
</code></pre>

<hr>
<h2 id='preselection'>
Suppression of missing or constant descriptors
</h2><span id='topic+preselection'></span>

<h3>Description</h3>

<p>Remove descriptors with missing values and a variance lower than 0.001. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preselection(desc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preselection_+3A_desc">desc</code></td>
<td>

<p>Dataframe containing the names of desciptors and their values
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a dataframe without the removed variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The input file should be with the following form
## id_molecule propriete x1 x2 x3 ... # Header line
## molecule1 1 0.02 500 ...
## molecule2 5 0.06 600 ...

# nom&lt;-"NameOfInputFile.csv"
# data&lt;-read.csv(nom,header = TRUE , sep=" ") 
# dim&lt;-dim(data)
# mydesc&lt;-data[,3:dim[2]]
# id&lt;-data[,1]
# y&lt;-data[,2] 

# d&lt;-preselection(mydesc)

</code></pre>

<hr>
<h2 id='scramb'>
scrambling
</h2><span id='topic+scramb'></span>

<h3>Description</h3>

<p>Perform the y-scrambling method that consit to permute y values and try to develop new models. They have to be unperformants in order to validate the original one. The graph R2 vs r(y,yrandom) is created. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scramb(mydata, k, n, cercle = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scramb_+3A_mydata">mydata</code></td>
<td>

<p>Dataframe containing names and values of response and descriptors
</p>
</td></tr>
<tr><td><code id="scramb_+3A_k">k</code></td>
<td>

<p>Number of random run
</p>
</td></tr>
<tr><td><code id="scramb_+3A_n">n</code></td>
<td>

<p>Number of selected descriptors of the regression (determined using Select_MLR)
</p>
</td></tr>
<tr><td><code id="scramb_+3A_cercle">cercle</code></td>
<td>

<p>Value is TRUE or FALSE (by default) . If it TRUE it's draw a circle around the point representinf the original model
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of 
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p> Mean of R^2 new model </p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p> RStandard deviation of R^2 new model</p>
</td></tr>
</table>
<p>And also
</p>
<table>
<tr><td><code>Scramb.tiff</code></td>
<td>
<p>Description of 'comp1'</p>
</td></tr>
<tr><td><code>Scramb.csv</code></td>
<td>
<p>Description of 'comp2'</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tropsha, A.; Gramatica, P.; Gombar, V. K. The Importance of Being Earnest: Validation Is the
Absolute Essential for Successful Application and Interpretation of QSPR Models. Qsar \&amp;
Combinatorial Science 2003, 22, 69-77.   <br />
Rucker, C.; Rucker, G.; Meringer, M. y-Randomization and Its Variants in QSPR/QSAR. J.
Chem. Inf. Model. 2007, 47, 2345-2357.<br />
Lindgren, F.; Hansen, B.; Karcher, W.; Sjostrom, M.; Eriksson, L. Model Validation by
Permutation Tests: Applications to Variable Selection. Journal of Chemometrics 1996, 10, 521-532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First run Select_MLR to define n

# scramb(mydata,1000,nom,dim(MLR)[2])
</code></pre>

<hr>
<h2 id='select_MLR'>
Development of the model (multi linear regression)
</h2><span id='topic+select_MLR'></span>

<h3>Description</h3>

<p>From a list of descriptors and responses values, this function choose the best compromise between correlation and robustness to select the best model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_MLR(y, desc, n, method = "forward")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_MLR_+3A_y">y</code></td>
<td>

<p>Vector with values of the property/response
</p>
</td></tr>
<tr><td><code id="select_MLR_+3A_desc">desc</code></td>
<td>

<p>Dataframe containing the names of desciptors and their values
</p>
</td></tr>
<tr><td><code id="select_MLR_+3A_n">n</code></td>
<td>

<p>Maximal number (integer) of desciptors for the final equation
</p>
</td></tr>
<tr><td><code id="select_MLR_+3A_method">method</code></td>
<td>

<p>Determine the method used to build the regression. Can be: &quot;backward&quot;, &quot;forward&quot; (by default) or &quot;seqrep&quot;. For more info see leaps package.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return the list of selected variables for the choosen MLR.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First run Select_variables to remove descriptors with missing or constant values.
# MLR&lt;-select_MLR(y,desc,5)
</code></pre>

<hr>
<h2 id='select_variables'>
Selection of descriptors
</h2><span id='topic+select_variables'></span>

<h3>Description</h3>

<p>This function allow the user to select wanted descriptors between both that are intercorrelated with a correlation coefficent higher that ThresholdInterCor. The selection can also be automatic based on the correlation with the property of each variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_variables(id, y, d, ThresholdInterCor, auto = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_variables_+3A_id">id</code></td>
<td>

<p>List of the names of observations
</p>
</td></tr>
<tr><td><code id="select_variables_+3A_y">y</code></td>
<td>

<p>List of the values of the property/response
</p>
</td></tr>
<tr><td><code id="select_variables_+3A_d">d</code></td>
<td>

<p>Dataframe containing the names of desciptors and their values (without missing or constant values)
</p>
</td></tr>
<tr><td><code id="select_variables_+3A_thresholdintercor">ThresholdInterCor</code></td>
<td>

<p>Threshold value (double) of the accepted intercorrelation between descriptors (should be between 0 and 1)
</p>
</td></tr>
<tr><td><code id="select_variables_+3A_auto">auto</code></td>
<td>

<p>Two possible values: TRUE or FALSE (by default). The selection of descriptors is done automatically based on the correlation between descriptor and property (auto=TRUE) or is done manually by user (auto=FALSE)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a dataframe containing only of non intercorrelated variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run after Preselection : d&lt;-Preselection(desc)

# desc&lt;-select_variables(id,y,d,0.95)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
