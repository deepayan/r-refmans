<!DOCTYPE html><html><head><title>Help for package eixport</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eixport}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chem_edgar'><p>Agregate EDGAR emissions NetCDF files into a RasterStack by</p></a></li>
<li><a href='#edgar'><p>Emissions EDGAR</p></a></li>
<li><a href='#eixport-deprecated'><p>Deprecated functions in package <span class="pkg">eixport</span>.</p></a></li>
<li><a href='#eixport-package'><p>eixport: Export Emissions to Atmospheric Models</p></a></li>
<li><a href='#emis_opt'><p>List of WRF emission species</p></a></li>
<li><a href='#emisco'><p>Emissions from VEIN examples</p></a></li>
<li><a href='#gCO'><p>Gridded emissions from VEIN demo</p></a></li>
<li><a href='#Lights'><p>Spatial distribution example</p></a></li>
<li><a href='#rawprofile'><p>Raw profile</p></a></li>
<li><a href='#sfx_explode'><p>splits line by vertex</p></a></li>
<li><a href='#st_explode'><p>Split line by vertex (experimental)</p></a></li>
<li><a href='#to_as4wrf'><p>Generates emissions dataframe to generate WRF-Chem inputs</p></a></li>
<li><a href='#to_brams_spm'><p>Inputs for BRAMS-SPM</p></a></li>
<li><a href='#to_munich'><p>Export emissions to Model of Urban Network of Intersecting Canyons and Highways (MUNICH)</p></a></li>
<li><a href='#to_rline'><p>Export emissions to other formats</p></a></li>
<li><a href='#to_wrf'><p>Combine total/spatial/temporal/split and write emission to file</p></a></li>
<li><a href='#wrf_add'><p>Function to add values for variables on emission files</p></a></li>
<li><a href='#wrf_create'><p>Create emission files for the WRF-Chem model</p></a></li>
<li><a href='#wrf_get'><p>Function to read variables of emission files</p></a></li>
<li><a href='#wrf_grid'><p>Creates grid from wrf file</p></a></li>
<li><a href='#wrf_meta'><p>Returns metadata (attributes) of wrf file in a data.frame</p></a></li>
<li><a href='#wrf_plot'><p>Simple plot from wrf emission file</p></a></li>
<li><a href='#wrf_profile'><p>Create a spatial profile from a wrf emission file and a data frame with</p></a></li>
<li><a href='#wrf_put'><p>Function to write variables in emission files</p></a></li>
<li><a href='#wrf_raster'><p>Creates raster from a variable from a wrf file</p></a></li>
<li><a href='#wrf_summary'><p>Summary of variables inside WRF files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Export Emissions to Atmospheric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Emissions are the mass of pollutants released into the atmosphere. Air quality models need emissions data, with spatial and temporal distribution, to represent air pollutant concentrations. This package, eixport, creates inputs for the air quality models 'WRF-Chem' Grell et al (2005) &lt;<a href="https://doi.org/10.1016%2Fj.atmosenv.2005.04.027">doi:10.1016/j.atmosenv.2005.04.027</a>&gt;, 'MUNICH' Kim et al (2018) &lt;<a href="https://doi.org/10.5194%2Fgmd-11-611-2018">doi:10.5194/gmd-11-611-2018</a>&gt; , 'BRAMS-SPM' Freitas et al (2005) &lt;<a href="https://doi.org/10.1016%2Fj.atmosenv.2005.07.017">doi:10.1016/j.atmosenv.2005.07.017</a>&gt; and 'RLINE' Snyder et al (2013) &lt;<a href="https://doi.org/10.1016%2Fj.atmosenv.2013.05.074">doi:10.1016/j.atmosenv.2013.05.074</a>&gt;. See the 'eixport' website (<a href="https://atmoschem.github.io/eixport/">https://atmoschem.github.io/eixport/</a>) for more information, documentations and examples. More details in Ibarra-Espinosa et al (2018) &lt;<a href="https://doi.org/10.21105%2Fjoss.00607">doi:10.21105/joss.00607</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://atmoschem.github.io/eixport/">https://atmoschem.github.io/eixport/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/atmoschem/eixport/issues/">https://github.com/atmoschem/eixport/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sf, ncdf4, raster, methods, cptcity, utils, data.table</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr, lwgeom, units, knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-04 04:11:41 UTC; sergio</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Ibarra-Espinosa
    <a href="https://orcid.org/0000-0002-3162-1905"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Daniel Schuch <a href="https://orcid.org/0000-0001-5977-4519"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Edmilson Freitas <a href="https://orcid.org/0000-0001-8783-2747"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Ibarra-Espinosa &lt;zergioibarra@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-04 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='chem_edgar'>Agregate EDGAR emissions NetCDF files into a RasterStack by</h2><span id='topic+chem_edgar'></span>

<h3>Description</h3>

<p>The Emissions Database for Global Atmospheric Research (EDGAR) is a
project from the Joint Research Centre. This function reads the NetCDF and
merge/aggregate into diferent chemical mechanisms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chem_edgar(path, chem, merge = FALSE, k = rep(1, 34), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chem_edgar_+3A_path">path</code></td>
<td>
<p>Character; path to the NetCDF files from EDGAR. The directory
<strong>must</strong> have one file for each of the following pollutants:
&quot;voc&quot; from 1 to 25, &quot;co&quot;, &quot;nox&quot;, &quot;nmvoc&quot;,&quot;so2&quot;, &quot;nh3&quot;,
&quot;pm10&quot;, &quot;pm2.5&quot;, &quot;bc&quot; and &quot;oc&quot;</p>
</td></tr>
<tr><td><code id="chem_edgar_+3A_chem">chem</code></td>
<td>
<p>Character; chemical mechanism: &quot;edgar&quot;, &quot;radm&quot;, &quot;radmsorg&quot;,
&quot;cbmz_mosaic&quot;, &quot;cptec&quot;, &quot;ecb05_opt1&quot;,
&quot;neu_cb05&quot; (thanks to Daniel Schuch) and
&quot;ufpr_cbmz&quot; (thanks to Leila Martins).
</p>

<ul>
<li><p> When chem is &quot;edgar&quot; units are: &quot;g km-2 h-1&quot;
</p>
</li>
<li><p> Other mechanisms: gases &quot;mol km-2 h-1&quot; and aerosols: &quot;ug m-2 s-1&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="chem_edgar_+3A_merge">merge</code></td>
<td>
<p>Logical; in the case that tehre are more than one NetCDF per pollutant,
merge = TRUE will merge them with sum. Default is FALSE.</p>
</td></tr>
<tr><td><code id="chem_edgar_+3A_k">k</code></td>
<td>
<p>Numeric; Value to factorize each pollutant.</p>
</td></tr>
<tr><td><code id="chem_edgar_+3A_verbose">verbose</code></td>
<td>
<p>Logical to print more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>RasterStack
</p>


<h3>Note</h3>

<p>Molecular weights were obtained from
</p>
<p>Development of  Improved Chemical Speciation Database for Processing Emissions of
Volatile Organic Compounds for Air Quality Models
https://intra.engr.ucr.edu/~carter/emitdb/
</p>
<p>Some mappings were obtained from:
</p>
<p>Carter, W. P. (2015). Development of a database for chemical
mechanism assignments for volatile organic emissions.
Journal of the Air &amp; Waste Management Association, 65(10), 1171-1184.
</p>
<p>Lopez-Norena, Ana and Fernandez, Rafael &amp; Puliafito, SALVADOR. (2019).
ESPECIACION DE INVENTARIOS DE EMISIONES DE AEROSOLES Y COMPUESTOS ORGANICOS
VOLATILES PARA EL MODELO WRF-CHEM, APLICADO A LOS ESQUEMAS RADM-2,
CBM-Z Y MOZART-4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run
# Downloading EDGAR data ####
get_edgar(
  dataset = "v432_VOC_spec",
  destpath = "V50_432_AP/TOT/",
  sector = c("TOTALS"),
  type = "nc",
  year = 2012
)

get_edgar(
  dataset = "v50_AP",
  destpath = "V50_432_AP/TOT",
  sector = c("TOTALS"),
  type = "nc",
  year = 2014
)

get_edgar(
  dataset = "v432_VOC_spec",
  destpath = "V50_432_AP/TRO/",
  sector = c("TRO"),
  type = "nc",
  year = 2012, ask = F
)

get_edgar(
  dataset = "v50_AP",
  destpath = "V50_432_AP/TRO",
  sector = c("TRO_RES", "TRO_noRES"),
  type = "nc",
  year = 2014
)

totals &lt;- list.files(
  path = "V50_432_AP/TOT/",
  full.names = TRUE,
  pattern = ".zip"
)
lapply(totals, unzip, exdir = "V50_432_AP/TOT//")


tros &lt;- list.files(
  path = "V50_432_AP/TRO",
  full.names = TRUE,
  pattern = ".zip"
)
lapply(tros, unzip, exdir = "V50_432_AP/TRO/")
edgar_chem("V50_432_AP/TOT", "radm")

## End(Not run)
</code></pre>

<hr>
<h2 id='edgar'>Emissions EDGAR</h2><span id='topic+edgar'></span>

<h3>Description</h3>

<p>Several datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(edgar)
</code></pre>


<h3>Format</h3>

<p>A data.frame with links to download EDGAR data
</p>

<dl>
<dt>data</dt><dd><p>datasets</p>
</dd>
<dt>pol</dt><dd><p>pollutants</p>
</dd>
<dt>sector</dt><dd><p>Sector</p>
</dd>
<dt>links</dt><dd><p>description</p>
</dd>
<dt>url</dt><dd><p>URL</p>
</dd>
<dt>year</dt><dd><p>Year</p>
</dd>
<dt>type</dt><dd><p>nc, txt or NA</p>
</dd>
<dt>note</dt><dd><p>Notes</p>
</dd>
</dl>
<p>data(edgar)

</p>


<h3>Source</h3>

<p><a href="https://edgar.jrc.ec.europa.eu/">https://edgar.jrc.ec.europa.eu/</a>
</p>

<hr>
<h2 id='eixport-deprecated'>Deprecated functions in package <span class="pkg">eixport</span>.</h2><span id='topic+eixport-deprecated'></span><span id='topic+get_edgar'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("-deprecated")</code>.
</p>
<p>The Emissions Database for Global Atmospheric Research (EDGAR) is a
project from the Joint Research Centre. They provide provides global past and
present day anthropogenic emissions of greenhouse gases and air
pollutants by country and on spatial grid. <code><a href="#topic+get_edgar">get_edgar</a></code> provide
functions to download any of the EDGAR datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_edgar(
  dataset = "v50_AP",
  pol,
  sector,
  year,
  n = parallel::detectCores()/2,
  destpath = tempdir(),
  type = "nc",
  ask = TRUE,
  copyright = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eixport-deprecated_+3A_dataset">dataset</code></td>
<td>
<p>Character; name of the datasets:  &quot;v50_AP&quot;,  &quot;v432_AP&quot;, &quot;v432_VOC_spec&quot;,
&quot;htap_v2_2&quot;, &quot;v50_GHG</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_pol">pol</code></td>
<td>
<p>Character; one of the pollutants shown on note.</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_sector">sector</code></td>
<td>
<p>Character; one of the sectors shown on note.</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_year">year</code></td>
<td>
<p>Integer;  years.</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_n">n</code></td>
<td>
<p>Integer; Number of cores in the machine, by default the half.</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_destpath">destpath</code></td>
<td>
<p>Character: Path to create the directory for downloads datasets</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_type">type</code></td>
<td>
<p>Extension, character/ Indicates if the file should be &quot;txt&quot;, &quot;nc&quot; or &quot;other&quot;.
txt with untis t/year and nc with units are ug/m2/s</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_ask">ask</code></td>
<td>
<p>Logical; Are these URL ok?</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_copyright">copyright</code></td>
<td>
<p>Logical; to show copyright information.</p>
</td></tr>
<tr><td><code id="eixport-deprecated_+3A_verbose">verbose</code></td>
<td>
<p>Logical, to print more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Downloads data
</p>


<h3>Note</h3>

<p><strong>I recommend 2 ways:</strong>
</p>
<p><strong>1. include 'sector' and do not include 'pol', which download all pollutants as default</strong>
</p>
<p>get_edgar(dataset = &quot;v432_AP&quot;,
destpath = tempdir(),
sector = c(&quot;TRO&quot;, &quot;TOTALS&quot;),
year = 2012)
</p>
<p><strong>2. include 'pol' and do not include 'sector', which download all sectors as default</strong>
</p>
<p>get_edgar(dataset = &quot;v432_AP&quot;,
destpath = tempdir(),
pol = c(&quot;CO&quot;, &quot;NOx&quot;),
year = 2012)
</p>

<table>
<tr>
 <td style="text-align: left;">
dataset  </td><td style="text-align: left;"> pollutant </td><td style="text-align: left;">            sector  </td><td style="text-align: left;"> years </td>
</tr>
<tr>
 <td style="text-align: left;">
v50_AP  </td><td style="text-align: left;">   BC, CO,  NH3, NMVOC, NOx, OC, PM10,
PM2.5, SO2  </td><td style="text-align: left;"> "AWB" "CHE" "ENE" "FFF" "FOO_PAP" "IND" "IRO"
"NFE" "NMM" "PRO" "RCO" "REF_TRF" "SWD_INC" "TNR_Aviation_CDS"
"TNR_Aviation_CRS" "TNR_Aviation_LTO" "TNR_Aviation_SPS" "TNR_Other"
"TNR_Ship" "TOTALS" "TRO_RES" "TRO_noRES" "AGS" "MNM" "PRU_SOL"
"SWD_LDF" "WWT" "NEU"  </td><td style="text-align: left;"> 1970-2015 </td>
</tr>
<tr>
 <td style="text-align: left;">
v50_GHG  </td><td style="text-align: left;">  CH4,CO2_excl_short-cycle_org_C, CO2_org_short-cycle_C, N2O
</td><td style="text-align: left;"> AGS AWB CHE ENE ENF FFF IND IRO MNM PRO PRO_COAL PRO_GAS PRO_OIL RCO
REF_TRF SWD_INC SWD_LDF TNR_Aviation_CDS TNR_Aviation_CRS TNR_Aviation_LTO
TNR_Aviation_SPS TNR_Other TNR_Ship TOTALS TRO WWT NEU NFE NMM PRU_SOL IDE N2O
</td><td style="text-align: left;"> 1970-2018 </td>
</tr>
<tr>
 <td style="text-align: left;">
v432  </td><td style="text-align: left;">  CH4,CO2_excl_short-cycle_org_C, CO2_org_short-cycle_C, N2O
</td><td style="text-align: left;"> AGS AWB CHE ENE ENF FFF IND IRO MNM PRO RCO REF_TRF SWD_INC SWD_LDF
TNR_Aviation_CDS TNR_Aviation_CRS TNR_Aviation_LTO TNR_Aviation_SPS
TNR_Other TNR_Ship TOTALS TRO WWT NEU NFE NMM PRU_SOL IDE N2O
</td><td style="text-align: left;"> 1970-2012 </td>
</tr>
<tr>
 <td style="text-align: left;">
v432_AP  </td><td style="text-align: left;">   BC, CO,  NH3, NMVOC, NOx, OC, PM10,
PM2.5_bio, PM2.5_fossil, SO2  </td><td style="text-align: left;"> AWB CHE ENE FFF FOO_PAP IND IRO NFE NMM
PRO RCO REF_TRF SWD_INC TNR_Aviation_CDS TNR_Aviation_CRS TNR_Aviation_LTO
TNR_Aviation_SPS TNR_Other TNR_Ship TOTALS TRO AGS MNM PRU_SOL SWD_LDF
NEU </td><td style="text-align: left;"> 1970-2012 </td>
</tr>
<tr>
 <td style="text-align: left;">
v432_VOC_spec </td><td style="text-align: left;">   voc1, voc2, voc3, voc3, voc5, voc6, voc7, voc8, bvoc9, voc10.
voc11, voc12, voc13, voc14, voc15, voc16, voc17, voc18, voc19, voc20,
voc21, voc22, voc23, voc24, voc25, TOTALS
</td><td style="text-align: left;">  ENE, IND, PPA, RCO, REF
TNR_Aviation_CDS, TNR_Aviation_CRS,
TNR_Aviation_LTO, TNR_Aviation_SPS, TNR_Other, TNR_Ship, TOTALS,
TRO, TRF </td><td style="text-align: left;"> 1970-2012 </td>
</tr>
<tr>
 <td style="text-align: left;">
htap_v2_2  </td><td style="text-align: left;"> BC, CO, NH3, NMVOC, NOx, OCm, PM10, PM2.5, SO2 </td><td style="text-align: left;">
AIR, ENERGY, INDUSTRY, RESIDENTIAL, SHIPS TRANSPORT </td><td style="text-align: left;"> 2008 and 2010 \cr
</td>
</tr>

</table>

<p>voc11 only 2008
</p>


<h3>References</h3>


<ul>
<li> <p><strong>v50_AP</strong> Crippa, M., Solazzo, E., Huang, G., Guizzardi, D., Koffi, E.,
Muntean, M., Schieberle, C., Friedrich, R., Janssens-Maenhout, G.:
High resolution temporal profiles in the Emissions Database for
Global Atmospheric Research, Nature Scientific Data, 2020, in press.
</p>
</li>
<li> <p><strong>v432</strong>:  Muntean, M., Guizzardi, D., Schaaf, E., Crippa, M., Solazzo, E.,
Olivier, J.G.J., Vignati, E. Fossil CO2 emissions of all world countries - 2018
Report, EUR 29433 EN, Publications Office  of the European Union, Luxembourg,
2018, ISBN 978-92-79-97240-9, doi:10.2760/30158, JRC113738.
</p>
</li>
<li> <p><strong>v432_AP</strong>:Crippa, M., Guizzardi, D., Muntean, M., Schaaf, E., Dentener, F.,
van Aardenne, J. A., Monni, S., Doering, U., Olivier, J. G. J., Pagliari, V.,
and Janssens-Maenhout, G.: Gridded emissions of air pollutants for the period
1970–2012 within EDGAR v4.3.2, Earth Syst. Sci. Data, 10, 1987–2013,
https://doi.org/10.5194/essd-10-1987-2018, 2018.
</p>
</li>
<li> <p><strong>v432_VOC_spec</strong>: Huang, G., Brook, R., Crippa, M., Janssens-Maenhout, G.,
Schieberle, C., Dore, C., Guizzardi, D., Muntean, M., Schaaf, E., and Friedrich, R.:
Speciation of anthropogenic emissions of non-methane volatile organic compounds: a
global gridded data set for 1970–2012, Atmos. Chem. Phys., 17, 7683-7701,
https://doi.org/10.5194/acp-17-7683-2017, 2017.
</p>
</li>
<li> <p><strong>htap_v2_2</strong>: Janssens-Maenhout, G., Crippa, M., Guizzardi, D.,
Dentener, F., Muntean, M., Pouliot, G., Keating, T., Zhang, Q., Kurokawa, J.,
Wankmüller, R., Denier van der Gon, H., Kuenen, J. J. P., Klimont, Z.,
Frost, G., Darras, S., Koffi, B., and Li, M.: HTAP_v2.2: a mosaic of
regional and global emission grid maps for 2008 and 2010 to study
hemispheric transport of air pollution, Atmos. Chem. Phys., 15,
11411–11432, https://doi.org/10.5194/acp-15-11411-2015, 2015.
</p>
</li></ul>

<p>MNM is MNN for NOx v432_AP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# see all the links:
data(edgar)
head(edgar)
# Download all pollutants for sector
get_edgar(dataset = "v50_AP",
          pol = "CO",
          sector = "TOTALS",
          year = 2014,
          destpath = tempdir(),
          type = "nc",
          ask = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='eixport-package'>eixport: Export Emissions to Atmospheric Models</h2><span id='topic+eixport'></span><span id='topic+eixport-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Emissions are the mass of pollutants released into the atmosphere. Air quality models need emissions data, with spatial and temporal distribution, to represent air pollutant concentrations. This package, eixport, creates inputs for the air quality models 'WRF-Chem' Grell et al (2005) <a href="https://doi.org/10.1016/j.atmosenv.2005.04.027">doi:10.1016/j.atmosenv.2005.04.027</a>, 'MUNICH' Kim et al (2018) <a href="https://doi.org/10.5194/gmd-11-611-2018">doi:10.5194/gmd-11-611-2018</a> , 'BRAMS-SPM' Freitas et al (2005) <a href="https://doi.org/10.1016/j.atmosenv.2005.07.017">doi:10.1016/j.atmosenv.2005.07.017</a> and 'RLINE' Snyder et al (2013) <a href="https://doi.org/10.1016/j.atmosenv.2013.05.074">doi:10.1016/j.atmosenv.2013.05.074</a>. See the 'eixport' website (<a href="https://atmoschem.github.io/eixport/">https://atmoschem.github.io/eixport/</a>) for more information, documentations and examples. More details in Ibarra-Espinosa et al (2018) <a href="https://doi.org/10.21105/joss.00607">doi:10.21105/joss.00607</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sergio Ibarra-Espinosa <a href="mailto:zergioibarra@gmail.com">zergioibarra@gmail.com</a> (<a href="https://orcid.org/0000-0002-3162-1905">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Daniel Schuch <a href="mailto:underschuch@gmail.com">underschuch@gmail.com</a> (<a href="https://orcid.org/0000-0001-5977-4519">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Edmilson Freitas <a href="mailto:edmilson.freitas@iag.usp.br">edmilson.freitas@iag.usp.br</a> (<a href="https://orcid.org/0000-0001-8783-2747">ORCID</a>) [thesis advisor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://atmoschem.github.io/eixport/">https://atmoschem.github.io/eixport/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/atmoschem/eixport/issues/">https://github.com/atmoschem/eixport/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='emis_opt'>List of WRF emission species</h2><span id='topic+emis_opt'></span>

<h3>Description</h3>

<p>Emission package definitions from WRF 4.0.1, for use in wrf_create function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(emis_opt)
</code></pre>


<h3>Format</h3>

<p>A list of emision variables names, same number as emis_opt in namelist.
</p>


<h3>Note</h3>

<p>look to the number of aerosol of the emis_opt in WRF domumentation / code.
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>Source</h3>

<p><a href="https://github.com/wrf-model/WRF">https://github.com/wrf-model/WRF</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrf_create">wrf_create</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(emis_opt)
names(emis_opt)
emis_opt[["eradm"]]

</code></pre>

<hr>
<h2 id='emisco'>Emissions from VEIN examples</h2><span id='topic+emisco'></span>

<h3>Description</h3>

<p>Emissions for street models such as munich. They need to be splitted
using st_explode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(emisco)
</code></pre>


<h3>Format</h3>

<p>A <code>sf</code> object of type LINESTRING with 1505 rows and 24 variables:
</p>

<dl>
<dt>V8</dt><dd><p>Emissions for 08:00-09:00 in Easth Sao Paulo, Brazil (g/h)</p>
</dd>
<dt>geometry</dt><dd><p>Geometry class sfc_LINESTRING sfc</p>
</dd>
</dl>
<p>data(emisco)

</p>


<h3>Source</h3>

<p><a href="https://github.com/atmoschem/vein">https://github.com/atmoschem/vein</a>
</p>

<hr>
<h2 id='gCO'>Gridded emissions from VEIN demo</h2><span id='topic+gCO'></span>

<h3>Description</h3>

<p>Emissions in g/h for morning rush hour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gCO)
</code></pre>


<h3>Format</h3>

<p>A sf object of POLYGON with 437 rows and 2 variables:
</p>

<dl>
<dt>V9</dt><dd><p>Emissions of CO (g/h) for 08:00-09:00</p>
</dd>
<dt>geometry</dt><dd><p>geometry</p>
</dd>
</dl>
<p>data(gCO)

</p>


<h3>Source</h3>

<p><a href="https://github.com/atmoschem/vein">https://github.com/atmoschem/vein</a>
</p>

<hr>
<h2 id='Lights'>Spatial distribution example</h2><span id='topic+Lights'></span>

<h3>Description</h3>

<p>Spatial distribution for vehicular emissions based on an image of persistent lights of the
Defense Meteorological Satellite Program (DMSP) for 5 Brazilian states (Sao Paulo, Rio de Janeiro, Mato Grosso, and Santa Catarina e Parana).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Lights)
</code></pre>


<h3>Format</h3>

<p>A matrix of spatial distribution
</p>


<h3>Details</h3>

<p><a href="https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program">https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program</a>
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>Source</h3>

<p><a href="https://ngdc.noaa.gov/eog/dmsp/downloadV4composites.html">https://ngdc.noaa.gov/eog/dmsp/downloadV4composites.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to_wrf">to_wrf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
           wrfchemi_dir = file.path(tempdir(), "EMISS"),
           frames_per_auxinput5 = 24)

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                    pattern = "wrfchemi",
                    full.names = TRUE)

data(Lights)

perfil &lt;- c(0.010760058, 0.005280596, 0.002883553, 0.002666932,
           0.005781312, 0.018412838, 0.051900411, 0.077834636,
           0.067919758, 0.060831614, 0.055852868, 0.052468599,
           0.050938043, 0.051921718, 0.052756244, 0.052820165,
           0.058388406, 0.072855890, 0.075267137, 0.063246412,
           0.042713523, 0.029108975, 0.022091855, 0.015298458)

plot(perfil,
     ty = "l",
     col= "purple",
     xlab = "Hour",
     main = "Time profile",
     ylab = "Weight",
     axes = FALSE,
     xlim = c(0, 24))
axis(2)
axis(1,
     at = c(0, 6, 12, 18, 24),
     labels = c("00:00","06:00","12:00","18:00","00:00"))

to_wrf(Lights,
       files[1],
       total = 1521983,
       profile = perfil,
       name = "E_CO")

## End(Not run)

</code></pre>

<hr>
<h2 id='rawprofile'>Raw profile</h2><span id='topic+rawprofile'></span>

<h3>Description</h3>

<p>Raw profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rawprofile)
</code></pre>


<h3>Format</h3>

<p>A matrix with 1 column and 168 rows
</p>

<p>data(rawprofile)

</p>

<hr>
<h2 id='sfx_explode'>splits line by vertex</h2><span id='topic+sfx_explode'></span>

<h3>Description</h3>

<p><code><a href="#topic+sfx_explode">sfx_explode</a></code> splits line by vertex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sfx_explode(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sfx_explode_+3A_x">x</code></td>
<td>
<p>sf LINESTRING.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spatial lines
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(emisco)
dim(emisco)
dfco &lt;- sfx_explode(emisco[1:100, ])
dim(dfco)
}
</code></pre>

<hr>
<h2 id='st_explode'>Split line by vertex (experimental)</h2><span id='topic+st_explode'></span>

<h3>Description</h3>

<p><code><a href="#topic+st_explode">st_explode</a></code> split a lines data.frame into
each vertex. It to mimic the function explode from qgis, that the reason for the name
<code><a href="#topic+st_explode">st_explode</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st_explode(net)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st_explode_+3A_net">net</code></td>
<td>
<p>A spatial dataframe of class &quot;sp&quot; or &quot;sf&quot;. When class is &quot;sp&quot;
it is transformed to &quot;sf&quot;.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>All variables are transformed into numeric.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# do not run
library(vein)
data(net)
net2 &lt;- st_explode(net)
dim(net)
dim(net2)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_as4wrf'>Generates emissions dataframe to generate WRF-Chem inputs</h2><span id='topic+to_as4wrf'></span>

<h3>Description</h3>

<p><code>to_as4wrf</code> returns a dataframes with columns lat, long, id, pollutants,
local time and GMT time. This dataframe has the proper format to be used with WRF
assimilation system: &quot;Another Asimilation System 4 WRF (AAS4WRF)&quot; as published
by Vera-Vala et al (2016)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_as4wrf(sdf, nr = 1, dmyhm, tz, crs = 4326, islist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_as4wrf_+3A_sdf">sdf</code></td>
<td>
<p>Gridded emissions, which can be a SpatialPolygonsDataFrame, or a list
of SpatialPolygonsDataFrame, or a sf object of &quot;POLYGON&quot;. The user must enter
a list with 36 SpatialPolygonsDataFrame with emissions for the mechanism CBMZ.
When there  are no emissions available, the SpatialPolygonsDataFrame must contain
0.</p>
</td></tr>
<tr><td><code id="to_as4wrf_+3A_nr">nr</code></td>
<td>
<p>Number of repetitions of the emissions period</p>
</td></tr>
<tr><td><code id="to_as4wrf_+3A_dmyhm">dmyhm</code></td>
<td>
<p>String indicating Day Month Year Hour and Minute in the format
&quot;d-m-Y H:M&quot; e.g.: &quot;01-05-2014 00:00&quot; It represents the time of the first
hour of emissions in Local Time</p>
</td></tr>
<tr><td><code id="to_as4wrf_+3A_tz">tz</code></td>
<td>
<p>Time zone as required in for function <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>
</td></tr>
<tr><td><code id="to_as4wrf_+3A_crs">crs</code></td>
<td>
<p>Coordinate reference system, e.g: &quot;+init=crs:4326&quot;. Used to
transform the coordinates of the output</p>
</td></tr>
<tr><td><code id="to_as4wrf_+3A_islist">islist</code></td>
<td>
<p>logical value to indicate if sdf is a list or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data-frame of gridded emissions  g/h
</p>


<h3>Note</h3>

<p>The user must produce a text file with the data-frame resulting of this
function. Then, use this file with the NCL script AAS4WRF.ncl
</p>
<p>The reference of the emissions assimilation system is Vara-Vela, A.,
Andrade, M. F., Kumar, P., Ynoue, R. Y., and Munoz, A. G.: Impact of
vehicular emissions on the formation of fine particles in the Sao Paulo
Metropolitan Area: a numerical study with the WRF-Chem model, Atmos. Chem.
Phys., 16, 777-797, doi:10.5194/acp-16-777-2016, 2016.
A good website with timezones is http://www.timezoneconverter.com/cgi-bin/tzc
The crs is the same as used by <code><a href="sf.html#topic+sf">sf</a></code> package
It returns a dataframe with id,, long, lat, pollutants, time_lt, time_utc
and day-UTC-hour (dutch)
The pollutants for the CBMZ are: e_so2, e_no, e_ald, e_hcho, e_ora2, e_nh3
e_hc3, e_hc5, e_hc8, e_eth, e_co, e_ol2, e_olt, e_oli, e_tol, e_xyl, e_ket
e_csl, e_iso, e_no2, e_ch3oh, e_c2h5oh, e_pm25i, e_pm25j, e_so4i, e_so4j
e_no3i, e_no3j, e_orgi, e_orgj, e_eci, e_ecj, e_so4c, e_no3c, e_orgc, e_ecc
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrf_create">wrf_create</a></code> <code><a href="#topic+to_wrf">to_wrf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(gCO)
df &lt;- to_as4wrf(sdf = gCO,
                dmyhm = "29-04-2018 00:00",
                tz = "America/Sao_Paulo")
head(df)
df2 &lt;- to_as4wrf(sdf = list(co = gCO, pm = gCO),
                 dmyhm = "29-04-2018 00:00",
                 tz = "America/Sao_Paulo")
head(df2)
}
</code></pre>

<hr>
<h2 id='to_brams_spm'>Inputs for BRAMS-SPM</h2><span id='topic+to_brams_spm'></span>

<h3>Description</h3>

<p>Create inputs for BRAMS-SPM. The inputs consist of a data-frame
or a list of data-frames with daily emissions (mol/day), lat, long. Also,
including a functions describing the hourly profile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_brams_spm(sdf, epsg = 4326)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_brams_spm_+3A_sdf">sdf</code></td>
<td>
<p>Grid emissions, which can be a SpatialPolygonsDataFrame or polygon
grid class sf' including the hourly emissions in mol/h for 24 hours. The
object can also be a list of objects SpatialPolygonsDataFrame or Spatial
Features polygon grid class 'sf'.</p>
</td></tr>
<tr><td><code id="to_brams_spm_+3A_epsg">epsg</code></td>
<td>
<p>Coordinate reference system, e.g: &quot;4326&quot;. Used to transform the
coordinates of the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data-frame of daily gridded emissions, lat, long and a message with
function.
</p>


<h3>Note</h3>

<p>When the input is class 'Spatial', they are converted to 'sf'. If the
input is a data-frame, the output is a data-frame. If the input is a list,
the output is a list.
</p>


<h3>Author(s)</h3>

<p>Sergio Ibarra and Edmilson Freitas
</p>


<h3>References</h3>

<p>SPM BRAMS: FREITAS, E. MARTINS, L.,  SILVA, P. and ANDRADE, M.
A simple photochemical module implemented in rams for tropospheric ozone
concentration forecast in the metropolitan area of são paulo, brazil:
Coupling and validation. Atmospheric Environment, Elsevier, n. 39, p.
6352–6361, 2005.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(gCO)
df1 &lt;- to_brams_spm(sdf = gCO,
                    epsg = 4326)
head(df1)
df2 &lt;- to_brams_spm(sdf = list(co = gCO, pm = gCO),
                    epsg = 4326)
lapply(df2, head)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_munich'>Export emissions to Model of Urban Network of Intersecting Canyons and Highways (MUNICH)</h2><span id='topic+to_munich'></span>

<h3>Description</h3>

<p><code><a href="#topic+to_munich">to_munich</a></code> Export spatial emissions objects
according the format required by MUNICH. This function was designed to
read street emissions from VEIN by it can be used to read any other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_munich(sdf, idbrin, typo, width, height, crs = 4326)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_munich_+3A_sdf">sdf</code></td>
<td>
<p>Street Emissions object class 'sf' LINESTRING or &quot;SpatialLinesdataFrame&quot;.
The columns are the emissions.</p>
</td></tr>
<tr><td><code id="to_munich_+3A_idbrin">idbrin</code></td>
<td>
<p>Integer; id.</p>
</td></tr>
<tr><td><code id="to_munich_+3A_typo">typo</code></td>
<td>
<p>Integer; id2.</p>
</td></tr>
<tr><td><code id="to_munich_+3A_width">width</code></td>
<td>
<p>Integer; width.</p>
</td></tr>
<tr><td><code id="to_munich_+3A_height">height</code></td>
<td>
<p>Integer; heigth.</p>
</td></tr>
<tr><td><code id="to_munich_+3A_crs">crs</code></td>
<td>
<p>Numeric; Coordenade Reference System to project data or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with a data frame with columns &quot;i&quot;, &quot;idbrin&quot;, &quot;typo&quot;, &quot;xa&quot;,
&quot;ya&quot;, &quot;xb&quot;, &quot;yb&quot; and the pollutants; and another data.frame with &quot;i&quot;,
&quot;length&quot; (m), &quot;width&quot; (with value 0) and &quot;height&quot; (with value 0). Width and
height must be obtained by the user.
</p>


<h3>Note</h3>

<p>The user must ensure that the spatial object has one line feature
per vertex and lines with more than one vertex must be previously splitted.
the resulting units must be <strong>ug/km/h</strong>
</p>


<h3>References</h3>

<p>Kim, Y., Wu, Y., Seigneur, C., and Roustan, Y.:
Multi-scale modeling of urban air pollution: development and application of
a Street-in-Grid model (v1.0) by coupling MUNICH (v1.0) and Polair3D
(v1.8.1), Geosci. Model Dev., 11, 611-629,
https://doi.org/10.5194/gmd-11-611-2018, 2018.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run
library(vein)
library(units)
library(sf)
data(net)
data(pc_profile)
data(profiles)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
pc1 &lt;- my_age(x = net$ldv,
              y = PC_G,
              name = "PC")

# Estimation for morning rush hour and local emission factors and speed
speed &lt;- data.frame(S8 = net$ps)
lef &lt;- EmissionFactorsList(ef_cetesb("CO",
                                     "PC_G",
                                     agemax = ncol(pc1)))
E_CO &lt;- emis(veh = pc1,
             lkm = net$lkm,
             ef = lef,
             speed = speed)

# rowSums drop units
net$CO  &lt;- set_units(rowSums(E_CO), g/h)

# selecting only CO and exploding lines and updating emissions
df &lt;- st_explode(net["CO"])

# st_explode should not drop units, must fix
df$CO  &lt;- set_units(df$CO, g/h)

# now we have split line in vertex
# selecting 1000 links
dfco &lt;- df[1:1000,"CO"]

###########
#MUNICH relies in a python script that reads emissions with units ug/km/h
# Therefore
dfco$CO &lt;- set_units(dfco$CO, ug/h)
dfco$CO&lt;- dfco$CO/set_units(st_length(dfco), km)
etm &lt;- to_munich(sdf = dfco)

names(etm)
class(etm)
head(etm$Emissions)
head(etm$Street)

write.table(x = etm$Emissions,
            file = paste0(tempfile(), "_Emissions.txt"),
            row.names = FALSE,
            sep = " ",
            quote = FALSE)

write.table(x = etm$Street,
            file = paste0(tempfile(), "_Street.txt"),
            row.names = FALSE,
            sep = " ",
            quote = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_rline'>Export emissions to other formats</h2><span id='topic+to_rline'></span>

<h3>Description</h3>

<p>Export emissions object according to format of file 'Sources.txt'
of the model R-LINE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_rline(
  Emis,
  Z_b,
  Z_e,
  dCL,
  sigmaz0,
  lanes,
  Hw1,
  dw1,
  Hw2,
  dw2,
  Depth,
  Wtop,
  Wbottom,
  experimental = FALSE,
  crs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_rline_+3A_emis">Emis</code></td>
<td>
<p>Column with the emissions whose unit must be g/ms.</p>
</td></tr>
<tr><td><code id="to_rline_+3A_z_b">Z_b</code></td>
<td>
<p>initial meters above sea level (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_z_e">Z_e</code></td>
<td>
<p>final meters above sea level (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_dcl">dCL</code></td>
<td>
<p>offset distance for each source relative to the centerline.</p>
</td></tr>
<tr><td><code id="to_rline_+3A_sigmaz0">sigmaz0</code></td>
<td>
<p>vertical dispersion (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_lanes">lanes</code></td>
<td>
<p>number of lanes at each street.</p>
</td></tr>
<tr><td><code id="to_rline_+3A_hw1">Hw1</code></td>
<td>
<p>Height of the barrier 1 (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_dw1">dw1</code></td>
<td>
<p>Distance to barrier 1 (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_hw2">Hw2</code></td>
<td>
<p>height of the barrier 2 (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_dw2">dw2</code></td>
<td>
<p>Distance to barrier 2 (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_depth">Depth</code></td>
<td>
<p>Depth of the depression. USed for depressed roadway (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_wtop">Wtop</code></td>
<td>
<p>width of the opening at the top of the depression (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_wbottom">Wbottom</code></td>
<td>
<p>width of the roadway at the bottom of the depression (m).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_experimental">experimental</code></td>
<td>
<p>Boolean argument to denote the use of the experimental
features (TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="to_rline_+3A_crs">crs</code></td>
<td>
<p>Numeric; Coordenade Reference System to project data or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with format for R-LINE model.
</p>


<h3>Note</h3>

<p>Michelle G. Snyder, Akula Venkatram, David K. Heist, Steven G. Perry,
William B. Petersen, Vlad Isakov, RLINE: A line source dispersion model
for near-surface releases, In Atmospheric Environment, Volume 77, 2013,
Pages 748-756, ISSN 1352-2310, https://doi.org/10.1016/j.atmosenv.2013.05.074.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(emisco)
emisco &lt;- st_explode(emisco)
emisco$V8 &lt;- units::set_units(emisco$V8, "g/ms")
Source &lt;- to_rline(Emis = emisco["V8"],
                   Z_b =0,
                   Z_e =0,
                   dCL = 0,
                   sigmaz0 = 2,
                   lanes = 1)
head(Source)
write.table(x = Source,
            file = paste0(tempdir(), "/Sources.txt"),
            row.names = FALSE,
            sep = " ",
            quote = FALSE)
}
</code></pre>

<hr>
<h2 id='to_wrf'>Combine total/spatial/temporal/split and write emission to file</h2><span id='topic+to_wrf'></span>

<h3>Description</h3>

<p>Function to expand, split and write emissions. The input is expanded into
time by profile and split between variables with diferent weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_wrf(
  POL,
  file = file.choose(),
  name = NA,
  total = NA,
  norm = FALSE,
  profile = 1,
  weights = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_wrf_+3A_pol">POL</code></td>
<td>
<p>matrix or array of emissions of spatial weights</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_file">file</code></td>
<td>
<p>emission file name</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_name">name</code></td>
<td>
<p>species to be write</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_total">total</code></td>
<td>
<p>total of emited species (modifier)</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_norm">norm</code></td>
<td>
<p>if the spatial weights need to be normalized (modifier)</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_profile">profile</code></td>
<td>
<p>temporal profile to expand the emissions (modifier)</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_weights">weights</code></td>
<td>
<p>weight of each species (modifier)</p>
</td></tr>
<tr><td><code id="to_wrf_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Note</h3>

<p>length(profile) must be the number of times in the emission
file (value of frames_per_auxinput5 if wrf_create() was used to
create this file).
</p>
<p>total is an additional way to calculate or correct the total emissions
</p>
<p>sum(profile) = 1 and sum(weights) = 1 to conserve mass
</p>
<p>names and weights must have the same length
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>See Also</h3>

<p><a href="#topic+wrf_create">wrf_create</a>, <code><a href="#topic+wrf_get">wrf_get</a></code>,<code><a href="#topic+wrf_profile">wrf_profile</a></code>  and <code><a href="#topic+wrf_plot">wrf_plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
           wrfchemi_dir = file.path(tempdir(), "EMISS"),
           frames_per_auxinput5 = 24)

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                    pattern = "wrfchemi",
                    full.names = TRUE)

data(Lights)

perfil &lt;- c(0.010760058, 0.005280596, 0.002883553, 0.002666932,
            0.005781312, 0.018412838, 0.051900411, 0.077834636,
            0.067919758, 0.060831614, 0.055852868, 0.052468599,
            0.050938043, 0.051921718, 0.052756244, 0.052820165,
            0.058388406, 0.072855890, 0.075267137, 0.063246412,
            0.042713523, 0.029108975, 0.022091855, 0.015298458)

plot(perfil,
     ty = "l",
     col= "purple",
     xlab = "Hour",
     main = "Time profile",
     ylab = "Weight",
     axes = FALSE,
     xlim = c(0, 24))
axis(2)
axis(1,
     at = c(0, 6, 12, 18, 24),
     labels = c("00:00","06:00","12:00","18:00","00:00"))

to_wrf(Lights,
      files[1],
      total = 1521983,
      profile = perfil,
      name = "E_CO")

## End(Not run)
</code></pre>

<hr>
<h2 id='wrf_add'>Function to add values for variables on emission files</h2><span id='topic+wrf_add'></span>

<h3>Description</h3>

<p>Add values to a variable in a netCDF file, the main use is to combine different
emissions like top-down emission (EmissV emissions) and inventary emission (sush as EDGAR,
GAINS, RETRO, etc).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_add(file = file.choose(), name = NA, POL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_add_+3A_file">file</code></td>
<td>
<p>name of file interactively (default) or specified</p>
</td></tr>
<tr><td><code id="wrf_add_+3A_name">name</code></td>
<td>
<p>name of the variable (any variable)</p>
</td></tr>
<tr><td><code id="wrf_add_+3A_pol">POL</code></td>
<td>
<p>variable to be written</p>
</td></tr>
</table>


<h3>Note</h3>

<p>this function might be deprecated in future
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# create the folder and emission file
dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
           wrfchemi_dir = file.path(tempdir(), "EMISS"))

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                    pattern = "wrfchemi",
                    full.names = TRUE)

# open, put some numbers and write
CO &lt;- wrf_get(file = files[1], name = "E_CO")
CO[] = rnorm(length(CO),mean = 5,sd = 1)
wrf_put(file = files[1], name = "E_CO", POL = CO)
# open, put some different numbers and write
CO[] = rnorm(length(CO),mean = 10,sd = 1)
wrf_add(file = files[1], name = "E_CO", POL = CO)
}
</code></pre>

<hr>
<h2 id='wrf_create'>Create emission files for the WRF-Chem model</h2><span id='topic+wrf_create'></span>

<h3>Description</h3>

<p>Create WRF-chem emission files using information from the WRF initial condictions (wrfinput) file(s). The wrfinput file of the corresponding domain is read from the current folder or from the wrfinput_dir.
</p>
<p>There are two emission styles available: the 12 hour pair of emissions (that will be recycled by the model) using io_style_emissions = 1 and the date_hour format using io_style_emissions = 2 (default), see notes for more detail.
</p>
<p>The initial time is the original (wrfinput file) adjusted by the day_offset argument, this argument can be useful for split the emissions into several files or for a restarted simulation. The emissions are recorded at the interval of 60 minutes (or the auxinput5_interval_m argument) for 1 time (or frames_per_auxinput5 argument times).
</p>
<p>The variables created on output file is based on emis_opt data or a character vector contains the species, any change in variables need to be followed by a change in the n_aero for the correspondent number of aerosol species in the emission file (the n_aero last variables).
</p>
<p>Title argument will be written on global attribute TITLE, from the version 4.0 the model checks if the TITLE version contains &quot;V4.&quot;, this can be disabled setting 'force_use_old_data = .true.' on WRF namelist.input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_create(
  wrfinput_dir = getwd(),
  wrfchemi_dir = wrfinput_dir,
  domains = 1,
  frames_per_auxinput5 = 1,
  auxinput5_interval_m = 60,
  day_offset = 0,
  io_style_emissions = 2,
  kemit = 1,
  variables = "ecb05_opt2",
  n_aero = 15,
  COMPRESS = NA,
  force_ncdf4 = FALSE,
  title = "Anthropogenic emissions for WRF V4.0",
  separator = "default",
  prefix = "wrfchemi",
  overwrite = TRUE,
  return_fn = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_create_+3A_wrfinput_dir">wrfinput_dir</code></td>
<td>
<p>input folder with the wrfinput file(s)</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_wrfchemi_dir">wrfchemi_dir</code></td>
<td>
<p>output folder</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_domains">domains</code></td>
<td>
<p>domain / domains to be process</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_frames_per_auxinput5">frames_per_auxinput5</code></td>
<td>
<p>value from wrf &amp;time_control namelist.input,
number of times (frames) in a single emission file</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_auxinput5_interval_m">auxinput5_interval_m</code></td>
<td>
<p>value from wrf &amp;time_control namelist.input,
interval in minutes between different times (frames) see Details</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_day_offset">day_offset</code></td>
<td>
<p>number of days (can be a fraction) see Details</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_io_style_emissions">io_style_emissions</code></td>
<td>
<p>from wrf &amp;chem namelist.input, 1 for 12z/00z style and 2 to date_hour style, see Details</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_kemit">kemit</code></td>
<td>
<p>from wrf &amp;chem namelist.input number of vertical levels of the emission file</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_variables">variables</code></td>
<td>
<p>emission species, can be used <code>emis_opt</code></p>
</td></tr>
<tr><td><code id="wrf_create_+3A_n_aero">n_aero</code></td>
<td>
<p>number of aerosol species</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_compress">COMPRESS</code></td>
<td>
<p>integer between 1 (least comp.) and 9 (most comp.) or NA for
no compression</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_force_ncdf4">force_ncdf4</code></td>
<td>
<p>force NetCDF4 format</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_title">title</code></td>
<td>
<p>TITLE attribute for the NetCDF</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_separator">separator</code></td>
<td>
<p>filename alternative separator for hour:minutes:seconds with io_style_emission=2</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_prefix">prefix</code></td>
<td>
<p>file name prefix, default is wrfchemi (wrf default)</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_overwrite">overwrite</code></td>
<td>
<p>logical, defoult is true, if FALSE check if the file exist</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_return_fn">return_fn</code></td>
<td>
<p>logical, return the name of the last file created</p>
</td></tr>
<tr><td><code id="wrf_create_+3A_verbose">verbose</code></td>
<td>
<p>print file info</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Using io_style_emissions = 1, the wrfchemi_00z will be generated with day_offset = 0 and
wrfchemi_12z with day_offset = 0.5 (frames_per_auxinput5 and auxinput5_interval_m will have no effect).
</p>
<p>Windows users may need to rename the emission files or change in namelist the defoult filename before run wrf.exe with these emission files.
</p>
<p>The separator argument can be useful for write in NTSF format discs on linux systems, for 'default' the separator is ':' for linux-like systems and '%3A' for windowns.
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to_wrf">to_wrf</a></code> and <code><a href="#topic+emis_opt">emis_opt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run

# emissions for a 1 day forecast for domains 1 and 2

dir.create(file.path(tempdir(), "EMISS"))

# emissions on date_hour style
wrf_create(wrfinput_dir         = system.file("extdata", package = "eixport"),
           wrfchemi_dir         = file.path(tempdir(), "EMISS"),
           domains              = 1:2,
           frames_per_auxinput5 = 25,
           auxinput5_interval_m = 60,
           verbose              = TRUE)

# emissions on 00z / 12z style, create the 00z
wrf_create(wrfinput_dir         = system.file("extdata", package = "eixport"),
           wrfchemi_dir         = file.path(tempdir(), "EMISS"),
           domains              = 1:2,
           io_style_emissions   = 1,
           day_offset           = 0,
           verbose              = TRUE,
           )
# emissions on 00z / 12z style, create the 12z
wrf_create(wrfinput_dir         = system.file("extdata", package = "eixport"),
           wrfchemi_dir         = file.path(tempdir(), "EMISS"),
           domains              = 1:2,
           io_style_emissions   = 1,
           day_offset           = 0.5,
           verbose              = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='wrf_get'>Function to read variables of emission files</h2><span id='topic+wrf_get'></span>

<h3>Description</h3>

<p>Read a variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_get(
  file = file.choose(),
  name = NA,
  as_raster = FALSE,
  raster_crs = "WRF",
  raster_lev = 1,
  k = NA,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_get_+3A_file">file</code></td>
<td>
<p>name of file interactively (default) or specified</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_name">name</code></td>
<td>
<p>name of the variable (any variable) or time to return a POSIXlt object from model</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_as_raster">as_raster</code></td>
<td>
<p>return a raster instead of an array</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_raster_crs">raster_crs</code></td>
<td>
<p>crs of outputif as_raster is TRUE, see details</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_raster_lev">raster_lev</code></td>
<td>
<p>level for rasters from a 4D variable</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_k">k</code></td>
<td>
<p>multiplier</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
<tr><td><code id="wrf_get_+3A_...">...</code></td>
<td>
<p>additional parameters passed to wrf_raster</p>
</td></tr>
</table>


<h3>Format</h3>

<p>array or raster object
</p>


<h3>Details</h3>

<p>wrf_get can return a raster object with the option as_raster = TRUE,
raster_crs can be used to specify the output crs of the raster object,
raster_crs = 'latlon' can be especifyed to use latlon option in wrf_raster.
If raster_crs is 'WRF' (default), the output projection is equivalent to
the WRF grid.
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrf_plot">wrf_plot</a></code> and <code><a href="#topic+wrf_put">wrf_put</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{

# create the folder and emission file
dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
         wrfchemi_dir = file.path(tempdir(), "EMISS"))

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                   pattern = "wrfchemi",
                   full.names = TRUE)

# open, put some numbers and write
CO &lt;- wrf_get(file = files[1],
              name = "E_CO")

CO[] = rnorm(length(CO))

wrf_put(file = files[1],
        name = "E_CO",
        POL = CO)

COr &lt;- wrf_get(file = files[1],
               name = "E_CO",
               as_raster = TRUE)

}
</code></pre>

<hr>
<h2 id='wrf_grid'>Creates grid from wrf file</h2><span id='topic+wrf_grid'></span>

<h3>Description</h3>

<p>Return a Spatial Feature multipolygon or matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_grid(filewrf, type = "wrfinput", matrix = FALSE, as_raster = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_grid_+3A_filewrf">filewrf</code></td>
<td>
<p>wrf file</p>
</td></tr>
<tr><td><code id="wrf_grid_+3A_type">type</code></td>
<td>
<p>Type of wrf file: &quot;wrfinput&quot; or &quot;geo&quot;. When type is &quot;geo&quot;, lat
long comes from mass grid, XLONG_M and XLAT_M</p>
</td></tr>
<tr><td><code id="wrf_grid_+3A_matrix">matrix</code></td>
<td>
<p>if the output is matrix or polygon (sf)</p>
</td></tr>
<tr><td><code id="wrf_grid_+3A_as_raster">as_raster</code></td>
<td>
<p>logical, to return a raster</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The default crs is 4326 (see http://spatialreference.org/ref/epsg/)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# Do not run
wrf &lt;- paste(system.file("extdata", package = "eixport"),
                         "/wrfinput_d02", sep="")
gwrf  &lt;- wrf_grid(wrf)
plot(gwrf, axes = TRUE)
}
</code></pre>

<hr>
<h2 id='wrf_meta'>Returns metadata (attributes) of wrf file in a data.frame</h2><span id='topic+wrf_meta'></span>

<h3>Description</h3>

<p><code><a href="#topic+wrf_meta">wrf_meta</a></code> returns the attributes of a wrf
NetCDF file in a data.frame. Therefore, there is no need to
use ncdump -h &quot;wrf_file&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_meta(file = file.choose())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_meta_+3A_file">file</code></td>
<td>
<p>Character; name of file interactively (default) or specified</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>{
file = paste0(system.file("extdata", package = "eixport"),"/wrfinput_d02")
wrf_meta(file)
}
</code></pre>

<hr>
<h2 id='wrf_plot'>Simple plot from wrf emission file</h2><span id='topic+wrf_plot'></span>

<h3>Description</h3>

<p>Create a quick plot from wrf emission file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_plot(
  file = file.choose(),
  name = NA,
  time = 1,
  nivel = 1,
  barra = T,
  lbarra = 0.2,
  col = cptcity::cpt(n = 20, rev = T),
  map = NULL,
  skip = FALSE,
  no_title = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_plot_+3A_file">file</code></td>
<td>
<p>emission file name</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_name">name</code></td>
<td>
<p>pollutant name</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_time">time</code></td>
<td>
<p>time from emission file</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_nivel">nivel</code></td>
<td>
<p>level from the emission file</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_barra">barra</code></td>
<td>
<p>barblot if TRUE</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_lbarra">lbarra</code></td>
<td>
<p>length of barplot</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_col">col</code></td>
<td>
<p>color vector</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_map">map</code></td>
<td>
<p>function call to plot map lines, points and annotation (experimental)</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_skip">skip</code></td>
<td>
<p>logical, skip plot of constant valuess</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_no_title">no_title</code></td>
<td>
<p>no title plot</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE print some information</p>
</td></tr>
<tr><td><code id="wrf_plot_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to plot methods</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the file contains levels (kemit&gt;1), and one frame (auxinput5_interval_m = 1)
time with control the level which will be ploted
</p>
<p>In case of an error related to plot.new() margins lbarra must be adjusted
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Lights">Lights</a></code>, <code><a href="#topic+to_wrf">to_wrf</a></code> and <code><a href="#topic+wrf_create">wrf_create</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{

dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
          wrfchemi_dir = file.path(tempdir(), "EMISS"))

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                   pattern = "wrfchemi",
                   full.names = TRUE)

# load end write some data in this emission file
data(Lights)
to_wrf(Lights, files[1], total = 1521983, name = "E_CO")

wrf_plot(files[1], "E_CO")
}
</code></pre>

<hr>
<h2 id='wrf_profile'>Create a spatial profile from a wrf emission file and a data frame with</h2><span id='topic+wrf_profile'></span>

<h3>Description</h3>

<p>returns a traffic intensity profile (based on wrf file Times)
and a traffic intensity data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_profile(x, file, adjust = 0, verbose = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_profile_+3A_x">x</code></td>
<td>
<p>data.frame of intenticy of traffic by hours (rows) and weekdays
(columns)</p>
</td></tr>
<tr><td><code id="wrf_profile_+3A_file">file</code></td>
<td>
<p>emission file name</p>
</td></tr>
<tr><td><code id="wrf_profile_+3A_adjust">adjust</code></td>
<td>
<p>numer of hours to advance (positive value) or delay (negative value)</p>
</td></tr>
<tr><td><code id="wrf_profile_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Format</h3>

<p>a numeric vector
</p>


<h3>Note</h3>

<p>It might be deprecatedin future release
</p>


<h3>Author(s)</h3>

<p>Daniel Schuch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrf_create">wrf_create</a></code> and <code><a href="#topic+to_wrf">to_wrf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Profile based on Sao Paulo tunnel experiments
data(rawprofile)
rawprofile  &lt;- matrix(rawprofile, nrow = 24, byrow = TRUE)
rawprofile &lt;- as.data.frame(rawprofile)
names(rawprofile) &lt;- c("Sunday","Monday","Tuesday","Wednesday","Thursday",
                       "Friday","Saturday")
row.names(rawprofile) &lt;- c("00:00","01:00","02:00","03:00","04:00","05:00",
                           "06:00","07:00","08:00","09:00","10:00","11:00",
                           "12:00","13:00","14:00","15:00","16:00","17:00",
                           "18:00","19:00","20:00","21:00","22:00","23:00")

print(rawprofile)

# create the folder and emission file
dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
          wrfchemi_dir = file.path(tempdir(), "EMISS"),
          frames_per_auxinput5 = 24)

files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                    pattern = "wrfchemi",
                    full.names = TRUE)

profile &lt;- wrf_profile(rawprofile,files[1])

plot(profile,
     ty="l",
     lty = 2,
     axe = FALSE,
     main = "Traffic Intensity for Sao Paulo", xlab = "hour")
axis(2)
axis(1,
     at = 0.5 + c(0, 6, 12, 18, 24),
    labels = c("00:00","06:00","12:00","18:00", "00:00"))

## End(Not run)
</code></pre>

<hr>
<h2 id='wrf_put'>Function to write variables in emission files</h2><span id='topic+wrf_put'></span>

<h3>Description</h3>

<p>Extract variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_put(
  file = file.choose(),
  name = NA,
  POL,
  k,
  check = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_put_+3A_file">file</code></td>
<td>
<p>Character; name of file interactively (default) or specified</p>
</td></tr>
<tr><td><code id="wrf_put_+3A_name">name</code></td>
<td>
<p>Character; name of the variable (any variable)</p>
</td></tr>
<tr><td><code id="wrf_put_+3A_pol">POL</code></td>
<td>
<p>Numeric; emissions input or string/POSIXlt time</p>
</td></tr>
<tr><td><code id="wrf_put_+3A_k">k</code></td>
<td>
<p>Numeric; multiplier. If the length is more than 1, it multiplies POL for each
value of k. It can be used if you want to add an hourly profile to your emissions.</p>
</td></tr>
<tr><td><code id="wrf_put_+3A_check">check</code></td>
<td>
<p>logic (default is FALSE), TRUE to check for NA and negative values and replace with zeros</p>
</td></tr>
<tr><td><code id="wrf_put_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Schuch and Sergio Ibarra
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrf_plot">wrf_plot</a></code> and <code><a href="#topic+wrf_get">wrf_get</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# create the folder and emission file
dir.create(file.path(tempdir(), "EMISS"))
wrf_create(wrfinput_dir = system.file("extdata", package = "eixport"),
          wrfchemi_dir = file.path(tempdir(), "EMISS"))

# get the name of created file
files &lt;- list.files(path = file.path(tempdir(), "EMISS"),
                    pattern = "wrfchemi",
                    full.names = TRUE)

# open, put some numbers and write
CO &lt;- wrf_get(file = files[1],
              name = "E_CO")

CO[] = rnorm(length(CO))

wrf_put(file = files[1],
        name = "E_CO",
        POL = CO)
}
</code></pre>

<hr>
<h2 id='wrf_raster'>Creates raster from a variable from a wrf file</h2><span id='topic+wrf_raster'></span>

<h3>Description</h3>

<p>Return a Raster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_raster(
  file = file.choose(),
  name = NA,
  latlon = F,
  level = 1,
  as_polygons = FALSE,
  map,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_raster_+3A_file">file</code></td>
<td>
<p>wrf file</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_name">name</code></td>
<td>
<p>variable name</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_latlon">latlon</code></td>
<td>
<p>project the output in &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_level">level</code></td>
<td>
<p>only for 4d data, default is 1 (surface)</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_as_polygons">as_polygons</code></td>
<td>
<p>logical, true to return a poligon instead of a raster</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_map">map</code></td>
<td>
<p>(optional) file with lat-lon variables and grid information</p>
</td></tr>
<tr><td><code id="wrf_raster_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>{

wrf &lt;- paste(system.file("extdata", package = "eixport"),
                         "/wrfinput_d02", sep="")

r &lt;- wrf_raster(file=wrf, name='XLAT')

library(raster)
plot(r, axes = TRUE)
}
</code></pre>

<hr>
<h2 id='wrf_summary'>Summary of variables inside WRF files</h2><span id='topic+wrf_summary'></span>

<h3>Description</h3>

<p>This return returns a summary for each variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrf_summary(file, vars, clean = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrf_summary_+3A_file">file</code></td>
<td>
<p>String path to the wrf.</p>
</td></tr>
<tr><td><code id="wrf_summary_+3A_vars">vars</code></td>
<td>
<p>String of WRF variables. If missing, all variables.</p>
</td></tr>
<tr><td><code id="wrf_summary_+3A_clean">clean</code></td>
<td>
<p>logical, default is FALSE, TRUE for remove Times, XLAT and XLONG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# do not run
file = paste0(system.file("extdata", package = "eixport"),"/wrfinput_d02")
wrf_summary(file = file)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
