<!DOCTYPE html><html><head><title>Help for package FD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FD-package'>
<p>Measuring Functional Diversity from Multiple Traits, and Other Tools for Functional Ecology</p></a></li>
<li><a href='#dbFD'><p>Distance-Based Functional Diversity Indices</p></a></li>
<li><a href='#dummy'><p>Dummy Functional Trait Dataset</p></a></li>
<li><a href='#fdisp'><p>Functional Dispersion</p></a></li>
<li><a href='#functcomp'><p>Functional Composition</p></a></li>
<li><a href='#gowdis'><p>Gower Dissimilarity</p></a></li>
<li><a href='#mahaldis'><p>Mahalanobis Distance</p></a></li>
<li><a href='#maxent'>
<p>Estimating Probabilities via Maximum Entropy: Improved Iterative Scaling</p></a></li>
<li><a href='#maxent.test'>
<p>Inferential Permutation Tests for Maximum Entropy Models</p></a></li>
<li><a href='#simul.dbFD'><p>Simulations to Explore Relationships Between Functional Diversity Indices</p></a></li>
<li><a href='#tussock'><p>Functional Composition of Short-Tussock Grasslands</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Measuring Functional Diversity (FD) from Multiple Traits, and
Other Tools for Functional Ecology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-12.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Etienne Laliberté, Pierre Legendre, Bill Shipley</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Etienne Laliberté &lt;etiennelaliberte@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes different multidimensional FD indices.  Implements a distance-based framework to measure FD that allows any number and type of functional traits, and can also consider species relative abundances.  Also contains other useful tools for functional ecology.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>ade4, ape, geometry, vegan</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-26 11:29:22 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 13:55:56 UTC</td>
</tr>
</table>
<hr>
<h2 id='FD-package'>
Measuring Functional Diversity from Multiple Traits, and Other Tools for Functional Ecology
</h2><span id='topic+FD-package'></span><span id='topic+FD'></span>

<h3>Description</h3>

<p><span class="pkg">FD</span> is a package to compute different multidimensional functional diversity (FD) indices. It implements a distance-based framework to measure FD that allows any number and type of functional traits, and can also consider species relative abundances. It also contains other tools for functional ecologists (e.g. <code><a href="#topic+maxent">maxent</a></code>).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FD</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-12</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2014-08-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><span class="pkg">FD</span> computes different multidimensional FD indices. To compute FD indices, a species-by-trait(s) matrix is required (or at least a species-by-species distance matrix). <code><a href="#topic+gowdis">gowdis</a></code> computes the Gower dissimilarity from different trait types (continuous, ordinal, nominal, or binary), and tolerates <code><a href="base.html#topic+NA">NA</a></code>s. It can treat ordinal variables as described by Podani (1999), and can handle asymetric binary variables and variable weights. <code><a href="#topic+gowdis">gowdis</a></code> is called by <code><a href="#topic+dbFD">dbFD</a></code>, the main function of <span class="pkg">FD</span>.  
</p>
<p><code><a href="#topic+dbFD">dbFD</a></code> uses principal coordinates analysis (PCoA) to return PCoA axes, which are then used as &lsquo;traits&rsquo; to compute FD. <code><a href="#topic+dbFD">dbFD</a></code> computes several multidimensional FD indices, including the three indices of Villéger et al. (2008): functional richness (FRic), functional evenness (FEve), and functional divergence (FDiv). It also computes functional dispersion (FDis) (Laliberté and Legendre 2010), Rao's quadratic entropy (Q) (Botta-Dukát 2005), a posteriori functional group richness (FGR), and the community-level weighted means of trait values (CWM), an index of functional composition. Some of these indices can be weighted by species abundances. <code><a href="#topic+dbFD">dbFD</a></code> includes several options for flexibility.  
</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté, Pierre Legendre and Bill Shipley
</p>
<p>Maintainer: Etienne Laliberté &lt;etiennelaliberte@gmail.com&gt; <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a>
</p>


<h3>References</h3>

<p>Botta-Dukát, Z. (2005) Rao's quadratic entropy as a measure of functional diversity based on multiple traits. <em>Journal of Vegetation Science</em> <b>16</b>:533-540.
</p>
<p>Laliberté, E. and P. Legendre (2010) A distance-based framework for measuring functional diversity from multiple traits. <em>Ecology</em> <b>91</b>:299-305.
</p>
<p>Podani, J. (1999) Extending Gower's general coefficient of similarity to ordinal characters. <em>Taxon</em> <b>48</b>:331-340.
</p>
<p>Villéger, S., N. W. H. Mason and D. Mouillot (2008) New multidimensional functional diversity indices for a multifaceted framework in functional ecology. <em>Ecology</em> <b>89</b>:2290-2301.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># examples with a dummy dataset

ex1 &lt;- gowdis(dummy$trait)
ex1

ex2 &lt;- functcomp(dummy$trait, dummy$abun)
ex2

ex3 &lt;- dbFD(dummy$trait, dummy$abun)
ex3

# examples with real data from New Zealand short-tussock grasslands
# these examples may take a few seconds to a few minutes each to run

ex4 &lt;- gowdis(tussock$trait)

ex5 &lt;- functcomp(tussock$trait, tussock$abun)

# 'lingoes' correction used because 'sqrt' does not work in that case
ex6 &lt;- dbFD(tussock$trait, tussock$abun, corr = "lingoes")

## Not run: 
# ward clustering to compute FGR, cailliez correction
ex7 &lt;- dbFD(tussock$trait, tussock$abun, corr = "cailliez",
calc.FGR = TRUE, clust.type = "ward")
# choose 'g' for number of groups
# 6 groups seems to make good ecological sense
ex7

# however, calinksi criterion in 'kmeans' suggests
# that 6 groups may not be optimal
ex8 &lt;- dbFD(tussock$trait, tussock$abun, corr = "cailliez",
calc.FGR = TRUE, clust.type = "kmeans", km.sup.gr = 10)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbFD'>Distance-Based Functional Diversity Indices</h2><span id='topic+dbFD'></span>

<h3>Description</h3>

<p><code>dbFD</code> implements a flexible distance-based framework to compute multidimensional functional diversity (FD) indices. <code>dbFD</code> returns the three FD indices of Villéger et al. (2008): functional richness (FRic), functional evenness (FEve), and functional divergence (FDiv), as well functional dispersion (FDis; Laliberté and Legendre 2010), Rao's quadratic entropy (Q) (Botta-Dukát 2005), a posteriori functional group richness (FGR) (Petchey and Gaston 2006), and the community-level weighted means of trait values (CWM; e.g. Lavorel et al. 2008). Some of these FD indices consider species abundances. <code>dbFD</code> includes several options for flexibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbFD(x, a, w, w.abun = TRUE, stand.x = TRUE,
    ord = c("podani", "metric"), asym.bin = NULL,
    corr = c("sqrt", "cailliez", "lingoes", "none"),
    calc.FRic = TRUE, m = "max", stand.FRic = FALSE,
    scale.RaoQ = FALSE, calc.FGR = FALSE, clust.type = "ward",
    km.inf.gr = 2, km.sup.gr = nrow(x) - 1, km.iter = 100,
    km.crit = c("calinski", "ssi"), calc.CWM = TRUE,
    CWM.type = c("dom", "all"), calc.FDiv = TRUE, dist.bin = 2, 
    print.pco = FALSE, messages = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbFD_+3A_x">x</code></td>
<td>
<p>matrix or data frame of functional traits. Traits can be <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+ordered">ordered</a></code>, or <code><a href="base.html#topic+factor">factor</a></code>. Binary traits should be <code><a href="base.html#topic+numeric">numeric</a></code> and only contain 0 and 1. <code><a href="base.html#topic+character">character</a></code> traits will be converted to <code><a href="base.html#topic+factor">factor</a></code>. <code><a href="base.html#topic+NA">NA</a></code>s are tolerated.
</p>
<p><code>x</code> can also be a species-by-species distance matrix of class <code><a href="stats.html#topic+dist">dist</a></code>, in which case <code><a href="base.html#topic+NA">NA</a>s</code> are not allowed.
</p>
<p>When there is only one trait, <code>x</code> can be also be a <code><a href="base.html#topic+numeric">numeric</a></code> vector, an <code><a href="base.html#topic+ordered">ordered</a></code> factor, or a unordered <code><a href="base.html#topic+factor">factor</a></code>.
</p>
<p>In all cases, species labels are required.
</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="dbFD_+3A_a">a</code></td>
<td>
<p>matrix containing the abundances of the species in <code>x</code> (or presence-absence, i.e. 0 or 1). Rows are sites and species are columns. Can be missing, in which case <code>dbFD</code> assumes that there is only one community with equal abundances of all species. <code><a href="base.html#topic+NA">NA</a>s</code> will be replaced by 0.
The number of species (columns) in <code>a</code> must match the number of species (rows) in <code>x</code>. In addition, the species labels in <code>a</code> and <code>x</code> must be identical and in the same order. 
</p>
</td></tr>
<tr><td><code id="dbFD_+3A_w">w</code></td>
<td>
<p>vector listing the weights for the traits in <code>x</code>. Can be missing, in which case all traits have equal weights.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_w.abun">w.abun</code></td>
<td>
<p>logical; should FDis, Rao's Q, FEve, FDiv, and CWM be weighted by the relative abundances of the species?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_stand.x">stand.x</code></td>
<td>
<p>logical; if all traits are <code><a href="base.html#topic+numeric">numeric</a></code>, should they be standardized to mean 0 and unit variance? If not all traits are <code>numeric</code>, Gower's (1971) standardization by the range is automatically used; see <code><a href="#topic+gowdis">gowdis</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_ord">ord</code></td>
<td>
<p>character string specifying the method to be used for ordinal traits (i.e. <code><a href="base.html#topic+ordered">ordered</a></code>). <code>"podani"</code> refers to Eqs. 2a-b of Podani (1999), while <code>"metric"</code> refers to his Eq. 3. Can be abbreviated. See <code><a href="#topic+gowdis">gowdis</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_asym.bin">asym.bin</code></td>
<td>
<p>vector listing the asymmetric binary variables in <code>x</code>. See <code><a href="#topic+gowdis">gowdis</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_corr">corr</code></td>
<td>
<p>character string specifying the correction method to use when the species-by-species distance matrix cannot be represented in a Euclidean space. Options are <code>"sqrt"</code>, <code>"cailliez"</code>, <code>"lingoes"</code>, or <code>"none"</code>. Can be abbreviated. Default is <code>"sqrt"</code>. See &lsquo;details&rsquo; section.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_calc.fric">calc.FRic</code></td>
<td>
<p>logical; should FRic be computed?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_m">m</code></td>
<td>
<p>the number of PCoA axes to keep as &lsquo;traits&rsquo; for calculating FRic (when FRic is measured as the convex hull volume) and FDiv. Options are: any integer <code class="reqn">&gt;1</code>, <code>"min"</code> (maximum number of traits that allows the <code class="reqn">s \geq 2^t</code> condition to be met, where <code class="reqn">s</code> is the number of species and <code class="reqn">t</code> the number of traits), or <code>"max"</code> (maximum number of axes that allows the <code class="reqn">s &gt; t</code> condition to be met). See &lsquo;details&rsquo; section.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_stand.fric">stand.FRic</code></td>
<td>
<p>logical; should FRic be standardized by the &lsquo;global&rsquo; FRic that include all species, so that FRic is constrained between 0 and 1?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_scale.raoq">scale.RaoQ</code></td>
<td>
<p>logical; should Rao's Q be scaled by its maximal value over all frequency distributions? See <code><a href="ade4.html#topic+divc">divc</a></code>.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_calc.fgr">calc.FGR</code></td>
<td>
<p>logical; should FGR be computed?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_clust.type">clust.type</code></td>
<td>
<p>character string specifying the clustering method to be used to create the dendrogram of species for FGR. Options are <code>"ward"</code>, <code>"single"</code>, <code>"complete"</code>, <code>"average"</code>, <code>"mcquitty"</code>, <code>"median"</code>, <code>"centroid"</code>, and <code>"kmeans"</code>. For <code>"kmeans"</code>, other arguments also apply (<code>km.inf.fr</code>, <code>km.sup.gr</code>, <code>km.iter</code>, and <code>km.crit</code>). See <code><a href="stats.html#topic+hclust">hclust</a></code> and <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_km.inf.gr">km.inf.gr</code></td>
<td>
<p>the number of groups for the partition with the smallest number of groups of the cascade (min). Only applies if <code>calc.FGR</code> is <code>TRUE</code> and <code>clust.type</code> is <code>"kmeans"</code>. See <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_km.sup.gr">km.sup.gr</code></td>
<td>
<p>the number of groups for the partition with the largest number of groups of the cascade (max). Only applies if <code>calc.FGR</code> is <code>TRUE</code> and <code>clust.type</code> is <code>"kmeans"</code>. See <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_km.iter">km.iter</code></td>
<td>
<p>the number of random starting configurations for each value of <code class="reqn">K</code>. Only applies if <code>calc.FGR</code> is <code>TRUE</code> and <code>clust.type</code> is <code>"kmeans"</code>. See <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_km.crit">km.crit</code></td>
<td>
<p>criterion used to select the best partition. The default value is <code>"calinski"</code> (Calinski-Harabasz 1974). The simple structure index <code>"ssi"</code> is also available. Only applies if <code>calc.FGR</code> is <code>TRUE</code> and <code>clust.type</code> is <code>"kmeans"</code>. Can be abbreviated. See <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_calc.cwm">calc.CWM</code></td>
<td>
<p>logical; should the community-level weighted means of trait values (CWM) be calculated? Can be abbreviated. See <code><a href="#topic+functcomp">functcomp</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_cwm.type">CWM.type</code></td>
<td>
<p>character string indicating how nominal, binary and ordinal traits should be handled for CWM. See <code><a href="#topic+functcomp">functcomp</a></code> for more details.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_calc.fdiv">calc.FDiv</code></td>
<td>
<p>logical; should FDiv be computed?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_dist.bin">dist.bin</code></td>
<td>
<p>only applies when <code>x</code> is a single unordered <code><a href="base.html#topic+factor">factor</a></code>, in which case <code>x</code> is coded using dummy variables. <code>dist.bin</code> is an integer between 1 and 10 specifying the appropriate distance measure for binary data. 2 (the default) refers to the simple matching coefficient (Sokal and Michener 1958). See <code><a href="ade4.html#topic+dist.binary">dist.binary</a></code> for the other options.</p>
</td></tr>
<tr><td><code id="dbFD_+3A_print.pco">print.pco</code></td>
<td>
<p>logical; should the eigenvalues and PCoA axes be returned?</p>
</td></tr>
<tr><td><code id="dbFD_+3A_messages">messages</code></td>
<td>
<p>logical; should warning messages be printed in the console?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typical usage is
</p>
<pre>
dbFD(x, a, \dots)
</pre>
<p>If <code>x</code> is a matrix or a data frame that contains only continuous traits, no <code><a href="base.html#topic+NA">NA</a>s</code>, and that no weights are specified (i.e. <code>w</code> is missing), a species-species Euclidean distance matrix is computed via <code><a href="stats.html#topic+dist">dist</a></code>. Otherwise, a Gower dissimilarity matrix is computed via <code><a href="#topic+gowdis">gowdis</a></code>. If <code>x</code> is a distance matrix, it is taken as is.
</p>
<p>When <code>x</code> is a single trait, species with <code><a href="base.html#topic+NA">NA</a>s</code> are first excluded to avoid <code><a href="base.html#topic+NA">NA</a>s</code> in the distance matrix. If <code>x</code> is a single continuous trait (i.e. of class <code><a href="base.html#topic+numeric">numeric</a></code>), a species-species Euclidean distance matrix is computed via <code><a href="stats.html#topic+dist">dist</a></code>. If <code>x</code> is a single ordinal trait (i.e. of class <code><a href="base.html#topic+ordered">ordered</a></code>), <code><a href="#topic+gowdis">gowdis</a></code> is used and argument <code>ord</code> applies. If <code>x</code> is a single nominal trait (i.e. an unordered <code><a href="base.html#topic+factor">factor</a></code>), the trait is converted to dummy variables and a distance matrix is computed via <code><a href="ade4.html#topic+dist.binary">dist.binary</a></code>, following argument <code>dist.bin</code>.
</p>
<p>Once the species-species distance matrix is obtained, <code>dbFD</code> checks whether it is Euclidean. This is done via <code><a href="ade4.html#topic+is.euclid">is.euclid</a></code>. PCoA axes corresponding to negative eigenvalues are imaginary axes that cannot be represented in a Euclidean space, but simply ignoring these axes would lead to biased estimations of FD. Hence in <code>dbFD</code> one of four correction methods are used, following argument <code>corr</code>. <code>"sqrt"</code> simply takes the square root of the distances. However, this approach does not always work for all coefficients, in which case <code>dbFD</code> will stop and tell the user to select another correction method. <code>"cailliez"</code> refers to the approach described by Cailliez (1983) and is implemented via <code><a href="ade4.html#topic+cailliez">cailliez</a></code>. <code>"lingoes"</code> refers to the approach described by Lingoes (1971) and is implemented via <code><a href="ade4.html#topic+lingoes">lingoes</a></code>. <code>"none"</code> creates a distance matrix with only the positive eigenvalues of the Euclidean representation via <code><a href="ade4.html#topic+quasieuclid">quasieuclid</a></code>. See Legendre and Legendre (1998) and Legendre and Anderson (1999) for more details on these corrections.
</p>
<p>Principal coordinates analysis (PCoA) is then performed (via <code><a href="ade4.html#topic+dudi.pco">dudi.pco</a></code>) on the <em>corrected</em> species-species distance matrix. The resulting PCoA axes are used as the new &lsquo;traits&rsquo; to compute the three indices of Villéger et al. (2008): FRic, FEve, and FDiv. For FEve, there is no limit on the number of traits that can be used, so all PCoA axes are used. On the other hand, FRic and FDiv both rely on finding the minimum convex hull that includes all species (Villéger et al. 2008). This requires more species than traits. To circumvent this problem, <code>dbFD</code> takes only a subset of the PCoA axes as traits via argument <code>m</code>. This, however, comes at a cost of loss of information. The quality of the resulting reduced-space representation is returned by <code>qual.FRic</code>, which is computed as described by Legendre and Legendre (1998) and can be interpreted as a <code class="reqn">R^2</code>-like ratio.
</p>
<p>In <code>dbFD</code>, FRic is generally measured as the convex hull volume, but when there is only one continuous trait it is measured as the range (or the range of the ranks for an ordinal trait). Conversely, when only nominal and ordinal traits are present, FRic is measured as the number of unique trait value combinations in a community. FEve and FDiv, but not FRic, can account for species relative abundances, as described by Villéger et al. (2008).
</p>
<p>Functional dispersion (FDis; Laliberté and Legendre 2010) is computed from the <em>uncorrected</em> species-species distance matrix via <code><a href="#topic+fdisp">fdisp</a></code>. Axes with negatives eigenvalues are corrected following the approach of Anderson (2006). When all species have equal abundances (i.e. presence-absence data), FDis is simply the average distance to the centroid (i.e. multivariate dispersion) as originally described by Anderson (2006). Multivariate dispersion has been proposed as an index of beta diversity (Anderson et al. 2006). However, Laliberté and Legendre (2010) have extended it to a FD index. FDis can account for relative abundances by shifting the position of the centroid towards the most abundant species, and then computing a weighted average distance to this new centroid, using again the relative abundances as weights (Laliberté and Legendre 2010). FDis has no upper limit and requires at least two species to be computed. For communities composed of only one species, <code>dbFD</code> returns a FDis value of 0. FDis is by construction unaffected by species richness, it can be computed from any distance or dissimilarity measure (Anderson et al. 2006), it can handle any number and type of traits (including more traits than species), and it is not strongly influenced by outliers.
</p>
<p>Rao's quadratic entropy (Q) is computed from the <em>uncorrected</em> species-species distance matrix via <code><a href="ade4.html#topic+divc">divc</a></code>. See Botta-Dukát (2005) for details. Rao's Q is conceptually similar to FDis, and simulations (via <code><a href="#topic+simul.dbFD">simul.dbFD</a></code>) have shown high positive correlations between the two indices (Laliberté and Legendre 2010). Still, one potential advantage of FDis over Rao's Q is that in the unweighted case (i.e. with presence-absence data), it opens possibilities for formal statistical tests for differences in FD between two or more communities through a distance-based test for homogeneity of multivariate dispersions (Anderson 2006); see  <code><a href="vegan.html#topic+betadisper">betadisper</a></code> for more details.
</p>
<p>Functional group richness (FGR) is based on the classification of the species by the user from visual inspection of a dengrogram. Method <code>"kmeans"</code> is also available by calling <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code>. In that case, the Calinski-Harabasz (1974) criterion or the simple structure index (SSI) can be used to estimate the number of functional groups; see <code><a href="vegan.html#topic+cascadeKM">cascadeKM</a></code> for more details. FGR returns the number of functional groups per community, as well as the abundance of each group in each community. 
</p>
<p>The community-level means of trait values (CWM) is an index of functional composition (Lavorel et al. 2008), and is computed via <code><a href="#topic+functcomp">functcomp</a></code>. Species with <code><a href="base.html#topic+NA">NA</a>s</code> for a given trait are excluded for that trait.
</p>


<h3>Value</h3>

<table>
<tr><td><code>nbsp</code></td>
<td>
<p>vector listing the number of species in each community</p>
</td></tr>
<tr><td><code>sing.sp</code></td>
<td>
<p>vector listing the number of functionally singular species in each community. If all species are functionally different, <code>sing.sp</code> will be identical to <code>nbsp</code>.</p>
</td></tr>
<tr><td><code>FRic</code></td>
<td>
<p>vector listing the FRic of each community</p>
</td></tr>
<tr><td><code>qual.FRic</code></td>
<td>
<p>quality of the reduced-space representation required to compute FRic and FDiv.</p>
</td></tr>
<tr><td><code>FEve</code></td>
<td>
<p>vector listing the FEve of each community</p>
</td></tr>
<tr><td><code>FDiv</code></td>
<td>
<p>vector listing the FDiv of each community. Only returned if <code>calc.FDiv</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>FDis</code></td>
<td>
<p>vector listing the FDis of each community</p>
</td></tr>
<tr><td><code>RaoQ</code></td>
<td>
<p>vector listing the Rao's quadratic entropy (Q) of each community</p>
</td></tr>
<tr><td><code>FGR</code></td>
<td>
<p>vector listing the FGR of each community. Only returned if <code>calc.FGR</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>spfgr</code></td>
<td>
<p>vector specifying functional group membership for each species. Only returned if <code>calc.FGR</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>gr.abun</code></td>
<td>
<p>matrix containing the abundances of each functional group in each community. Only returned if <code>calc.FGR</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>CWM</code></td>
<td>
<p>data frame containing the community-level weighted trait means (CWM). Only returned if <code>calc.CWM</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>x.values</code></td>
<td>
<p>eigenvalues from the PCoA. Only returned if <code>print.pco</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>x.axes</code></td>
<td>
<p>PCoA axes. Only returned if <code>print.pco</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Users often report that <code>dbFD</code> crashed during their analysis. Generally this occurs under Windows, and is almost always due to the computation of convex hull volumes. Possible solutions are to choose <code>calc.FRic = "FALSE"</code>, or to reduce the dimensionality of the trait matrix using the <code>"m"</code> argument.</p>


<h3>Note</h3>

<p><code>dbFD</code> borrows code from the <code>F_RED</code> function of Villéger et al. (2008).</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a> <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a></p>


<h3>References</h3>

<p>Anderson, M. J. (2006) Distance-based tests for homogeneity of multivariate dispersions. <em>Biometrics</em> <b>62</b>:245-253.
</p>
<p>Anderson, M. J., K. E. Ellingsen and B. H. McArdle (2006) Multivariate dispersion as a measure of beta diversity. <em>Ecology Letters</em> <b>9</b>:683-693.
</p>
<p>Botta-Dukát, Z. (2005) Rao's quadratic entropy as a measure of functional diversity based on multiple traits. <em>Journal of Vegetation Science</em> <b>16</b>:533-540.
</p>
<p>Cailliez, F. (1983) The analytical solution of the additive constant problem. <em>Psychometrika</em> <b>48</b>:305-310.
</p>
<p>Calinski, T. and J. Harabasz (1974) A dendrite method for cluster analysis. <em>Communications in Statistics</em> <b>3</b>:1-27.
</p>
<p>Gower, J. C. (1971) A general coefficient of similarity and some of its properties. <em>Biometrics</em> <b>27</b>:857-871.
</p>
<p>Laliberté, E. and P. Legendre (2010) A distance-based framework for measuring functional diversity from multiple traits. <em>Ecology</em> <b>91</b>:299-305.
</p>
<p>Lavorel, S., K. Grigulis, S. McIntyre, N. S. G. Williams, D. Garden, J. Dorrough, S. Berman, F. Quétier, A. Thebault and A. Bonis (2008) Assessing functional diversity in the field - methodology matters! <em>Functional Ecology</em> <b>22</b>:134-147.
</p>
<p>Legendre, P. and M. J. Anderson (1999) Distance-based redundancy analysis: testing multispecies responses in multifactorial ecological experiments. <em>Ecological Monographs</em> <b>69</b>:1-24.
</p>
<p>Legendre, P. and L. Legendre (1998) <em>Numerical Ecology</em>. 2nd English edition. Amsterdam: Elsevier.
</p>
<p>Lingoes, J. C. (1971) Some boundary conditions for a monotone analysis of symmetric matrices. <em>Psychometrika</em> <b>36</b>:195-203.
</p>
<p>Podani, J. (1999) Extending Gower's general coefficient of similarity to ordinal characters. <em>Taxon</em> <b>48</b>:331-340.
</p>
<p>Sokal, R. R. and C. D. Michener (1958) A statistical method for evaluating systematic relationships. <em>The University of Kansas Scientific Bulletin</em> <b>38</b>:1409-1438.
</p>
<p>Villéger, S., N. W. H. Mason and D. Mouillot (2008) New multidimensional functional diversity indices for a multifaceted framework in functional ecology. <em>Ecology</em> <b>89</b>:2290-2301.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gowdis">gowdis</a></code>, <code><a href="#topic+functcomp">functcomp</a></code>, <code><a href="#topic+fdisp">fdisp</a></code>, <code><a href="#topic+simul.dbFD">simul.dbFD</a></code>, <code><a href="ade4.html#topic+divc">divc</a></code>, <code><a href="vegan.html#topic+treedive">treedive</a></code>, <code><a href="vegan.html#topic+betadisper">betadisper</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># mixed trait types, NA's
ex1 &lt;- dbFD(dummy$trait, dummy$abun)
ex1

# add variable weights
# 'cailliez' correction is used because 'sqrt' does not work
w&lt;-c(1, 5, 3, 2, 5, 2, 6, 1)
ex2 &lt;- dbFD(dummy$trait, dummy$abun, w, corr="cailliez")

# if 'x' is a distance matrix
trait.d &lt;- gowdis(dummy$trait)
ex3 &lt;- dbFD(trait.d, dummy$abun)
ex3

# one numeric trait, one NA
num1 &lt;- dummy$trait[,1] ; names(num1) &lt;- rownames(dummy$trait)
ex4 &lt;- dbFD(num1, dummy$abun)
ex4

# one ordered trait, one NA
ord1 &lt;- dummy$trait[,5] ; names(ord1) &lt;- rownames(dummy$trait)
ex5 &lt;- dbFD(ord1, dummy$abun)
ex5

# one nominal trait, one NA
fac1 &lt;- dummy$trait[,3] ; names(fac1) &lt;- rownames(dummy$trait)
ex6 &lt;- dbFD(fac1, dummy$abun)
ex6

# example with real data from New Zealand short-tussock grasslands
# 'lingoes' correction used because 'sqrt' does not work in that case
ex7 &lt;- dbFD(tussock$trait, tussock$abun, corr = "lingoes")


## Not run: 
# calc.FGR = T, 'ward'
ex7 &lt;- dbFD(dummy$trait, dummy$abun, calc.FGR = T)
ex7

# calc.FGR = T, 'kmeans'
ex8 &lt;- dbFD(dummy$trait, dummy$abun, calc.FGR = T,
clust.type = "kmeans")
ex8

# ward clustering to compute FGR
ex9 &lt;- dbFD(tussock$trait, tussock$abun,
corr = "cailliez", calc.FGR = TRUE, clust.type = "ward")
# choose 'g' for number of groups
# 6 groups seems to make good ecological sense
ex9

# however, calinksi criterion in 'kmeans' suggests
# that 6 groups may not be optimal
ex10 &lt;- dbFD(tussock$trait, tussock$abun, corr = "cailliez",
calc.FGR = TRUE, clust.type = "kmeans", km.sup.gr = 10)

## End(Not run)
</code></pre>

<hr>
<h2 id='dummy'>Dummy Functional Trait Dataset</h2><span id='topic+dummy'></span>

<h3>Description</h3>

<p>A dummy dataset containing 8 species and 8 functional traits (2 continuous, 2 nominal, 2 ordinal, and 2 binary), with some missing values. Also includes a matrix of species abundances from 10 communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dummy</code></pre>


<h3>Format</h3>


<dl>
<dt>trait</dt><dd><p>data frame of 8 functional traits on 8 species</p>
</dd>
<dt>abun</dt><dd><p>matrix of abundances of the 8 species from 10 communities</p>
</dd>
</dl>



<h3>Source</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>
</p>

<hr>
<h2 id='fdisp'>Functional Dispersion</h2><span id='topic+fdisp'></span>

<h3>Description</h3>

<p><code>fdisp</code> measures the functional dispersion (FDis) of a set of communities, as described by Laliberté and Legendre (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdisp(d, a, tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdisp_+3A_d">d</code></td>
<td>
<p>a species-by- species distance matrix computed from functional traits, such as that returned by <code><a href="stats.html#topic+dist">dist</a></code> or <code><a href="#topic+gowdis">gowdis</a></code>. <code><a href="base.html#topic+NA">NA</a>s</code> are not allowed.</p>
</td></tr>
<tr><td><code id="fdisp_+3A_a">a</code></td>
<td>
<p>matrix containing the abundances of the species in <code>d</code> (or presence-absence, i.e. 0 or 1). Rows are sites and species are columns. Can be missing, in which case <code>fdisp</code> assumes that there is only one community with equal abundances of all species. <code><a href="base.html#topic+NA">NA</a>s</code> will be replaced by 0.
The number of species (columns) in <code>a</code> must match the number of species in <code>d</code>. In addition, the species labels in <code>a</code> and <code>d</code> must be identical and in the same order.</p>
</td></tr>
<tr><td><code id="fdisp_+3A_tol">tol</code></td>
<td>
<p>tolerance threshold to test whether the distance matrix is Euclidean : an eigenvalue is considered positive if it is larger than -tol*<code class="reqn">{\lambda}_1</code>, where <code class="reqn">{\lambda}_1</code> is the largest eigenvalue.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fdisp</code> computes, for a set of communities, the average distance of individual objects (species) in PCoA space from any distance or dissimilarity measure, as described by Anderson (2006). The average distance to the centroid is a measure of multivariate dispersion and as been suggested as an index of beta diversity (Anderson et al. 2006). However, in <code>fdisp</code> both the centroid and the average distance to this centroid can be weighted by individual objects. In other words, <code>fdisp</code> returns the weighted average distance to the weighted centroid. This was suggested so that multivariate dispersion could be used as a multidimensional functional diversity (FD) index that can be weighted by species abundances. This FD index has been called functional dispersion (FDis) and is described by Laliberté and Legendre (2010).
</p>
<p>In sum, FDis can account for relative abundances by shifting the position of the centroid towards the most abundant species, and then computing a weighted average distance to this new centroid, using again the relative abundances as weights (Laliberté and Legendre 2010). FDis has no upper limit and requires at least two species to be computed. For communities composed of only one species, <code>dbFD</code> returns a FDis value of 0. FDis is by construction unaffected by species richness, it can be computed from any distance or dissimilarity measure (Anderson et al. 2006), it can handle any number and type of traits (including more traits than species), and it is not strongly influenced by outliers.
</p>
<p>FDis is conceptually similar to Rao's quadratic entropy Q (Botta-Dukát 2005), and simulations (via <code><a href="#topic+simul.dbFD">simul.dbFD</a></code>) have shown high positive correlations between the two indices (Laliberté and Legendre 2010). Still, one potential advantage of FDis over Rao's Q is that in the unweighted case (i.e. with presence-absence data), it opens possibilities for formal statistical tests for differences in FD between two or more communities through a distance-based test for homogeneity of multivariate dispersions (Anderson 2006); see <code><a href="vegan.html#topic+betadisper">betadisper</a></code> for more details.
</p>
<p>Corrections for PCoA axes corresponding to negative eigenvalues are applied following Anderson (2006); see also <code><a href="vegan.html#topic+betadisper">betadisper</a></code> for more details on these corrections.
</p>


<h3>Value</h3>

<table>
<tr><td><code>FDis</code></td>
<td>
<p>vector listing the FDis of each community</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>vector listing the eigenvalues of the PCoA</p>
</td></tr>
<tr><td><code>vectors</code></td>
<td>
<p>matrix containing the PCoA axes</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code>fdisp</code> is implemented in <code><a href="#topic+dbFD">dbFD</a></code> and is used to compute the functional dispersion (FDis) index.
</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a> <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a></p>


<h3>References</h3>

<p>Anderson, M. J. (2006) Distance-based tests for homogeneity of multivariate dispersions. <em>Biometrics</em> <b>62</b>:245-253.
</p>
<p>Anderson, M. J., K. E. Ellingsen and B. H. McArdle (2006) Multivariate dispersion as a measure of beta diversity. <em>Ecology Letters</em> <b>9</b>:683-693.
</p>
<p>Botta-Dukát, Z. (2005) Rao's quadratic entropy as a measure of functional diversity based on multiple traits. <em>Journal of Vegetation Science</em> <b>16</b>:533-540.
</p>
<p>Laliberté, E. and P. Legendre (2010) A distance-based framework for measuring functional diversity from multiple traits. <em>Ecology</em> <b>91</b>299:305.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbFD">dbFD</a></code> for computing multidimensional FD indices and <code><a href="vegan.html#topic+betadisper">betadisper</a></code> from which <code>fdisp</code> borrows some code.</p>


<h3>Examples</h3>

<pre><code class='language-R'># dummy dataset
dummy.dist &lt;- gowdis(dummy$trait)
ex1 &lt;- fdisp(dummy.dist, dummy$abun)
ex1

# example with real data from New Zealand short-tussock grasslands
ex2 &lt;- fdisp(gowdis(tussock$trait), tussock$abun)
ex2
</code></pre>

<hr>
<h2 id='functcomp'>Functional Composition</h2><span id='topic+functcomp'></span>

<h3>Description</h3>

<p><code>functcomp</code> returns the functional composition of a set of communities, as measured by the community-level weighted means of trait values (CWM; e.g. Lavorel et al. 2008).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>functcomp(x, a, CWM.type = c("dom", "all"), bin.num = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="functcomp_+3A_x">x</code></td>
<td>
<p>matrix or data frame containing the functional traits. Traits can be <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+ordered">ordered</a></code>, or <code><a href="base.html#topic+factor">factor</a></code>. Binary traits should be <code><a href="base.html#topic+numeric">numeric</a></code> and only contain 0 and 1. <code><a href="base.html#topic+character">character</a></code> traits will be converted to <code><a href="base.html#topic+factor">factor</a></code>. For a given trait, species with <code><a href="base.html#topic+NA">NA</a></code> are excluded.</p>
</td></tr>
<tr><td><code id="functcomp_+3A_a">a</code></td>
<td>
<p>matrix containing the abundances of the species in <code>x</code> (or presence-absence, i.e. 0 or 1). Rows are sites and species are columns. The number of species (columns) in <code>a</code> must match the number of species (rows) in <code>x</code>. In addition, the species labels in <code>a</code> and <code>x</code> must be identical and in the same order. <code><a href="base.html#topic+NA">NA</a>s</code> will be replaced by 0.</p>
</td></tr>
<tr><td><code id="functcomp_+3A_cwm.type">CWM.type</code></td>
<td>
<p>character string indicating how nominal, binary and ordinal traits should be handled. See &lsquo;details&rsquo;.</p>
</td></tr>
<tr><td><code id="functcomp_+3A_bin.num">bin.num</code></td>
<td>
<p>vector indicating binary traits to be treated as continuous.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>functcomp</code> computes the community-level weighted means of trait values for a set of communities (i.e. sites). For a continuous trait, CWM is the mean trait value of all species present in the community (after excluding species with <code><a href="base.html#topic+NA">NA</a>s</code>), weighted by their relative abundances.
</p>
<p>For ordinal, nominal and binary traits, either the dominant class is returned (when <code>CWM.type</code> is <code>"dom"</code>), or the abundance of each individual class is returned (when <code>CWM.type</code> is <code>"all"</code>).
</p>
<p>The default behaviour of binary traits being treated as nominal traits can be over-ridden by specifying <code>bin.num</code>, in which case they are treated as numeric traits.
</p>
<p>When <code>CWM.type = "dom"</code>, if the maximum abundance value is shared between two or more classes, then one of these classes is randomly selected for CWM. Because species with <code><a href="base.html#topic+NA">NA</a>s</code> for a given trait are excluded for that trait, it is possible that when <code>CWM.type</code> is set to <code>"all"</code>, the sum of the abundances of all classes for a given ordinal/nominal/binary trait does not equal the sum of the species abundances. Thus, it is definitely not recommended to have <code><a href="base.html#topic+NA">NA</a>s</code> for very abundant species, as this will lead to biased estimates of functional composition.  
</p>


<h3>Value</h3>

<p>a data frame containing the CWM values of each trait for each community.
</p>


<h3>Note</h3>

<p><code>functcomp</code> is implemented in <code><a href="#topic+dbFD">dbFD</a></code> and will be returned if <code>calc.CWM</code> is <code>TRUE</code>. 
</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a> <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a></p>


<h3>References</h3>

<p>Lavorel, S., K. Grigulis, S. McIntyre, N. S. G. Williams, D. Garden, J. Dorrough, S. Berman, F. Quétier, A. Thébault and A. Bonis (2008) Assessing functional diversity in the field - methodology matters! <em>Functional Ecology</em> <b>22</b>:134-147.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbFD">dbFD</a></code> for measuring distance-based multidimensional functional diversity indices, including CWM.</p>


<h3>Examples</h3>

<pre><code class='language-R'># for ordinal, nominal and binary variables
# returns only the most frequent class
ex1 &lt;- functcomp(dummy$trait, dummy$abun)
ex1

# returns the frequencies of each class
ex2 &lt;- functcomp(dummy$trait, dummy$abun, CWM.type = "all")
ex2

# example with real data from New Zealand short-tussock grasslands
ex3 &lt;- functcomp(tussock$trait, tussock$abun)
ex3
</code></pre>

<hr>
<h2 id='gowdis'>Gower Dissimilarity</h2><span id='topic+gowdis'></span>

<h3>Description</h3>

<p><code>gowdis</code> measures the Gower (1971) dissimilarity for mixed variables, including asymmetric binary variables. Variable weights can be specified. <code>gowdis</code> implements Podani's (1999) extension to ordinal variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gowdis(x, w, asym.bin = NULL, ord = c("podani", "metric", "classic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gowdis_+3A_x">x</code></td>
<td>
<p>matrix or data frame containing the variables. Variables can be <code><a href="base.html#topic+numeric">numeric</a></code>, <code><a href="base.html#topic+ordered">ordered</a></code>, or <code><a href="base.html#topic+factor">factor</a></code>. Symmetric or asymmetric binary variables should be <code><a href="base.html#topic+numeric">numeric</a></code> and only contain 0 and 1. <code><a href="base.html#topic+character">character</a></code> variables will be converted to <code><a href="base.html#topic+factor">factor</a></code>. <code><a href="base.html#topic+NA">NA</a></code>s are tolerated.</p>
</td></tr>
<tr><td><code id="gowdis_+3A_w">w</code></td>
<td>
<p>vector listing the weights for the variables in <code>x</code>. Can be missing, in which case all variables have equal weights.</p>
</td></tr>
<tr><td><code id="gowdis_+3A_asym.bin">asym.bin</code></td>
<td>
<p>vector listing the asymmetric binary variables in <code>x</code>.</p>
</td></tr>
<tr><td><code id="gowdis_+3A_ord">ord</code></td>
<td>
<p>character string specifying the method to be used for ordinal variables (i.e. <code><a href="base.html#topic+ordered">ordered</a></code>). <code>"podani"</code> refers to Eqs. 2a-b of Podani (1999), while <code>"metric"</code> refers to his Eq. 3 (see &lsquo;details&rsquo;); both options convert ordinal variables to ranks. <code>"classic"</code> simply treats ordinal variables as continuous variables. Can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gowdis</code> computes the Gower (1971) similarity coefficient exactly as described by Podani (1999), then converts it to a dissimilarity coefficient by using <code class="reqn">D = 1 - S</code>. It integrates variable weights as described by Legendre and Legendre (1998).
</p>
<p>Let <code class="reqn">\mathbf{X} = \{x_{ij}\} </code> be a matrix containing <code class="reqn">n</code> objects (rows) and <code class="reqn">m</code> columns (variables). The similarity <code class="reqn">G_{jk}</code> between objects <code class="reqn">j</code> and <code class="reqn">k</code> is computed as
</p>
<p style="text-align: center;"><code class="reqn">G_{jk} = \frac{\sum_{i=1}^{n} w_{ijk} s_{ijk}}{\sum_{i=1}^{n} w_{ijk}}</code>
</p>
<p>,
</p>
<p>where <code class="reqn">w_{ijk}</code> is the weight of variable <code class="reqn">i</code> for the <code class="reqn">j</code>-<code class="reqn">k</code> pair, and <code class="reqn">s_{ijk}</code> is the partial similarity of variable <code class="reqn">i</code> for the <code class="reqn">j</code>-<code class="reqn">k</code> pair,
</p>
<p>and where <code class="reqn">w_{ijk} = 0</code> if objects <code class="reqn">j</code> and <code class="reqn">k</code> cannot be compared because <code class="reqn">x_{ij}</code> or <code class="reqn">x_{ik}</code> is unknown (i.e. <code><a href="base.html#topic+NA">NA</a></code>).
</p>
<p>For binary variables, <code class="reqn">s_{ijk} = 0</code> if <code class="reqn">x_{ij} \neq x_{ik}</code>, and  <code class="reqn">s_{ijk} = 1</code> if <code class="reqn">x_{ij} = x_{ik} = 1</code> or if <code class="reqn">x_{ij} = x_{ik} = 0</code>.
</p>
<p>For asymmetric binary variables, same as above except that <code class="reqn">w_{ijk} = 0</code> if <code class="reqn">x_{ij} = x_{ik} = 0</code>.
</p>
<p>For nominal variables, <code class="reqn">s_{ijk} = 0</code> if <code class="reqn">x_{ij} \neq x_{ik}</code> and <code class="reqn">s_{ijk} = 1</code> if <code class="reqn">x_{ij} = x_{ik}</code>.
</p>
<p>For continuous variables,
</p>
<p style="text-align: center;"><code class="reqn">s_{ijk} = 1 - \frac{|x_{ij} - x_{ik}|} {x_{i.max} - x_{i.min}} </code>
</p>

<p>where <code class="reqn">x_{i.max}</code> and <code class="reqn">x_{i.min}</code> are the maximum and minimum values of variable <code class="reqn">i</code>, respectively.
</p>
<p>For ordinal variables, when <code>ord = "podani"</code> or <code>ord = "metric"</code>, all <code class="reqn">x_{ij}</code> are replaced by their ranks <code class="reqn">r_{ij}</code> determined over all objects (such that ties are also considered), and then
</p>
<p>if <code>ord = "podani"</code>
</p>
<p><code class="reqn">s_{ijk} = 1</code> if <code class="reqn">r_{ij} = r_{ik}</code>, otherwise
</p>
<p style="text-align: center;"><code class="reqn"> s_{ijk} = 1 - \frac{|r_{ij} - r_{ik}| - (T_{ij} - 1)/2 - (T_{ik} - 1)/2 }{r_{i.max} - r_{i.min} - (T_{i.max} - 1)/2 - (T_{i.min}-1)/2 }</code>
</p>

<p>where <code class="reqn">T_{ij}</code> is the number of objects which have the same rank score for variable <code class="reqn">i</code> as object <code class="reqn">j</code> (including <code class="reqn">j</code> itself), <code class="reqn">T_{ik}</code> is the number of objects which have the same rank score for variable <code class="reqn">i</code> as object <code class="reqn">k</code> (including <code class="reqn">k</code> itself), <code class="reqn">r_{i.max}</code> and <code class="reqn">r_{i.min}</code> are the maximum and minimum ranks for variable <code class="reqn">i</code>, respectively, <code class="reqn">T_{i,max}</code> is the number of objects with the maximum rank, and <code class="reqn">T_{i.min}</code> is the number of objects with the minimum rank.
</p>
<p>if <code>ord = "metric"</code>
</p>
<p style="text-align: center;"><code class="reqn">s_{ijk} = 1 - \frac{|r_{ij} - r_{ik}|}{r_{i.max} - r_{i.min}} </code>
</p>

<p>When <code>ord = "classic"</code>, ordinal variables are simply treated as continuous variables.
</p>


<h3>Value</h3>

<p>an object of class <code><a href="stats.html#topic+dist">dist</a></code> with the following attributes: <code>Labels</code>, <code>Types</code> (the variable types, where 'C' is continuous/numeric, 'O' is ordinal, 'B' is symmetric binary, 'A' is asymmetric binary, and 'N' is nominal), <code>Size</code>, <code>Metric</code>.
</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a> <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a>, with some help from Philippe Casgrain for the C interface.</p>


<h3>References</h3>

<p>Gower, J. C. (1971) A general coefficient of similarity and some of its properties. <em>Biometrics</em> <b>27</b>:857-871.
</p>
<p>Legendre, P. and L. Legendre (1998) <em>Numerical Ecology</em>. 2nd English edition. Amsterdam: Elsevier.
</p>
<p>Podani, J. (1999) Extending Gower's general coefficient of similarity to ordinal characters. <em>Taxon</em> <b>48</b>:331-340.
</p>


<h3>See Also</h3>

<p><code><a href="cluster.html#topic+daisy">daisy</a></code> is similar but less flexible, since it does not include variable weights and does not treat ordinal variables as described by Podani (1999). Using <code>ord = "classic"</code> reproduces the behaviour of <code><a href="cluster.html#topic+daisy">daisy</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>ex1 &lt;- gowdis(dummy$trait)
ex1

# check attributes
attributes(ex1)

# to include weights
w &lt;- c(4,3,5,1,2,8,3,6)
ex2 &lt;- gowdis(dummy$trait, w)
ex2

# variable 7 as asymmetric binary
ex3 &lt;- gowdis(dummy$trait, asym.bin = 7)
ex3

# example with trait data from New Zealand vascular plant species
ex4 &lt;- gowdis(tussock$trait)
</code></pre>

<hr>
<h2 id='mahaldis'>Mahalanobis Distance</h2><span id='topic+mahaldis'></span>

<h3>Description</h3>

<p><code>mahaldis</code> measures the pairwise Mahalanobis (1936) distances between individual objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahaldis(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mahaldis_+3A_x">x</code></td>
<td>
<p>matrix containing the variables. <code><a href="base.html#topic+NA">NA</a></code>s are not tolerated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mahaldis</code> computes the Mahalanobis (1936) distances between individual objects. The Mahalanobis distance takes into account correlations among variables and does not depend on the scales of the variables.
</p>
<p><code>mahaldis</code> builds on the fact that type-II principal component analysis (PCA) preserves the Mahalanobis distance among objects (Legendre and Legendre 2012). Therefore, <code>mahaldis</code> first performs a type-II PCA on standardized variables, and then computes the Euclidean distances among (repositioned) objects whose positions are given in the matrix <code class="reqn">\mathbf{G}</code>. This is equivalent to the Mahalanobis distances in the space of the original variables (Legendre and Legendre 2012). 
</p>


<h3>Value</h3>

<p>an object of class <code><a href="stats.html#topic+dist">dist</a></code>.
</p>


<h3>Author(s)</h3>

<p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>
</p>
<p><a href="http://adn.biol.umontreal.ca/~numericalecology/">http://adn.biol.umontreal.ca/~numericalecology/</a>
</p>
<p>Ported to <span class="pkg">FD</span> by Etienne Laliberté.
</p>


<h3>References</h3>

<p>Legendre, P. and L. Legendre (2012) <em>Numerical Ecology</em>. 3nd English edition. Amsterdam: Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+mahalanobis">mahalanobis</a></code> computes the Mahalanobis distances among groups of objects, not individual objects.</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat &lt;- matrix(rnorm(100), 50, 20)

ex1 &lt;- mahaldis(mat)

# check attributes
attributes(ex1)
</code></pre>

<hr>
<h2 id='maxent'>
Estimating Probabilities via Maximum Entropy: Improved Iterative Scaling
</h2><span id='topic+maxent'></span>

<h3>Description</h3>

<p><code>maxent</code> returns the probabilities that maximize the entropy conditional on a series of constraints that are linear in the features. It relies on the Improved Iterative Scaling algorithm of Della Pietra et al. (1997). It has been used to predict the relative abundances of a set of species given the trait values of each species and the community-aggregated trait values at a site (Shipley et al. 2006; Shipley 2009; Sonnier et al. 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxent(constr, states, prior, tol = 1e-07, lambda = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxent_+3A_constr">constr</code></td>
<td>

<p>vector of macroscopical constraints (e.g. community-aggregated trait values). Can also be a matrix or data frame, with constraints as columns and data sets (e.g. sites) as rows.
</p>
</td></tr>
<tr><td><code id="maxent_+3A_states">states</code></td>
<td>

<p>vector, matrix or data frame of states (columns) and their attributes (rows).
</p>
</td></tr>
<tr><td><code id="maxent_+3A_prior">prior</code></td>
<td>

<p>vector, matrix or data frame of prior probabilities of states (columns). Can be missing, in which case a maximally uninformative prior is assumed (i.e. uniform distribution).
</p>
</td></tr>
<tr><td><code id="maxent_+3A_tol">tol</code></td>
<td>

<p>tolerance threshold to determine convergence. See &lsquo;details&rsquo; section. 
</p>
</td></tr>
<tr><td><code id="maxent_+3A_lambda">lambda</code></td>
<td>

<p>Logical. Should <code class="reqn">\lambda</code>-values be returned? 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The biological model of community assembly through trait-based habitat
filtering (Keddy 1992) has been translated mathematically
via a maximum entropy (maxent) model by Shipley et al. (2006) and
Shipley (2009). A maxent model contains three components: (i) a set
of possible states and their attributes, (ii) a set of macroscopic empirical constraints,
and (iii) a prior probability distribution <code class="reqn">\mathbf{q}=[q_j]</code>.
</p>
<p>In the context of community assembly, states are species, macroscopic
empirical constraints are community-aggregated traits, and prior probabilities
<code class="reqn">\mathbf{q}</code> are the relative abundances of species of the regional
pool (Shipley et al. 2006, Shipley 2009). By default, these prior
probabilities <code class="reqn">\mathbf{q}</code> are maximally uninformative (i.e. a uniform distribution),
but can be specificied otherwise (Shipley 2009, Sonnier et al. 2009).
</p>
<p>To facilitate the link between the biological model and the mathematical
model, in the following description of the algorithm states are species and constraints are traits.
</p>
<p>Note that if <code>constr</code> is a matrix or data frame containing several sets (rows),
a maxent model is run on each individual set. In this case if <code>prior</code> is a vector,
the same prior is used for each set. A different prior can also be specified for each set.
In this case, the number of rows in <code>prior</code> must be equal to the number of rows in <code>constr</code>. 
</p>
<p>If <code class="reqn">\mathbf{q}</code> is not specified, set <code class="reqn">p_{j}=1/S</code> for each of the
<code class="reqn">S</code> species (i.e. a uniform distribution), where <code class="reqn">p_{j}</code> is the
probability of species <code class="reqn">j</code>, otherwise <code class="reqn">p_{j}=q_{j}</code>.
</p>
<p>Calulate a vector <code class="reqn">\mathbf{c=\left[\mathrm{\mathit{c_{i}}}\right]}=\{c_{1},\; c_{2},\;\ldots,\; c_{T}\}</code>,
where <code class="reqn">c_{i}={\displaystyle \sum_{j=1}^{S}t_{ij}}</code>; i.e. each <code class="reqn">c_{i}</code>
is the sum of the values of trait <code class="reqn">i</code> over all species, and <code class="reqn">T</code>
is the number of traits.
</p>
<p>Repeat for each iteration <code class="reqn">k</code> until convergence:
</p>
<p>1. For each trait <code class="reqn">t_{i}</code> (i.e. row of the constraint matrix) calculate:
</p>
<p style="text-align: center;"><code class="reqn">
\gamma_{i}(k)=ln\left(\frac{\bar{t}_{i}}{{\displaystyle \sum_{j=1}^{S}\left(p_{j}(k)\; t_{ij}\right)}}\right)\left(\frac{1}{c_{i}}\right)</code>
</p>

<p>This is simply the natural log of the known community-aggregated
trait value to the calculated community-aggregated trait value at
this step in the iteration, given the current values of the probabilities.
The whole thing is divided by the sum of the known values of the trait
over all species.
</p>
<p>2. Calculate the normalization term <code class="reqn">Z</code>:
</p>
<p style="text-align: center;"><code class="reqn">Z(k)=\left({\displaystyle \sum_{j=1}^{S}p_{j}(k)\; e^{\left({\displaystyle \sum_{i=1}^{T}\gamma_{i}(k)}\; t_{ij}\right)}}\right)</code>
</p>

<p>3. Calculate the new probabilities <code class="reqn">p_{j}</code> of each species at iteration <code class="reqn">k+1</code>:
</p>
<p style="text-align: center;"><code class="reqn">p_{j}(k+1)=\frac{{\displaystyle p_{j}(k)\; e^{\left({\displaystyle \sum_{i=1}^{T}\gamma_{i}(k)}\; t_{ij}\right)}}}{Z(k)}</code>
</p>

<p>4. If <code class="reqn">|max\left(p\left(k+1\right)-p\left(k\right)\right)|\leq</code> tolerance threshold (i.e. argument <code>tol</code>) then stop, else repeat steps 1 to 3.
</p>
<p>When convergence is achieved then the resulting probabilities (<code class="reqn">\hat{p}_{j}</code>)
are those that are as close as possible to <code class="reqn">q_j</code> while simultaneously maximize
the entropy conditional on the community-aggregated traits. The solution to this problem is
the Gibbs distribution:
</p>
<p style="text-align: center;"><code class="reqn">\hat{p}_{j}=\frac{q_{j}e^{\left({\displaystyle -}{\displaystyle \sum_{i=1}^{T}\lambda_{i}t_{ij}}\right)}}{{\displaystyle \sum_{j=1}^{S}q_{j}}e^{\left({\displaystyle -}{\displaystyle \sum_{i=1}^{T}\lambda_{i}t_{ij}}\right)}}=\frac{q_{j}e^{\left({\displaystyle -}{\displaystyle \sum_{i=1}^{T}\lambda_{i}t_{ij}}\right)}}{Z}</code>
</p>

<p>This means that one can solve for the Langrange multipliers (i.e.
weights on the traits, <code class="reqn">\lambda_{i}</code>) by solving the linear system
of equations:
</p>
<p style="text-align: center;"><code class="reqn">\left(\begin{array}{c}
ln\left(\hat{p}_{1}\right)\\
ln\left(\hat{p}_{2}\right)\\
\vdots\\
ln\left(\hat{p}_{S}\right)\end{array}\right)=\left(\lambda_{1},\;\lambda_{2},\;\ldots,\;\lambda_{T}\right)\left[\begin{array}{cccc}
t_{11} &amp; t_{12} &amp; \ldots &amp; t_{1S}-ln(Z)\\
t_{21} &amp; t_{22} &amp; \vdots &amp; t_{2S}-ln(Z)\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
t_{T1} &amp; t_{T2} &amp; \ldots &amp; t_{TS}-ln(Z)\end{array}\right]-ln(Z)</code>
</p>

<p>This system of linear equations has <code class="reqn">T+1</code> unknowns (the <code class="reqn">T</code> values
of <code class="reqn">\lambda</code> plus <code class="reqn">ln(Z)</code>) and <code class="reqn">S</code> equations. So long as the number
of traits is less than <code class="reqn">S-1</code>, this system is soluble. In fact, the
solution is the well-known least squares regression: simply regress
the values <code class="reqn">ln(\hat{p}_{j})</code> of each species on the trait values
of each species in a multiple regression.
</p>
<p>The intercept is the value of <code class="reqn">ln(Z)</code> and the slopes are the values
of <code class="reqn">\lambda_{i}</code> and these slopes (Lagrange multipliers) measure
by how much the <code class="reqn">ln(\hat{p}_{j})</code>, i.e. the <code class="reqn">ln</code>(relative abundances),
changes as the value of the trait changes.
</p>
<p><code><a href="#topic+maxent.test">maxent.test</a></code> provides permutation tests for maxent models (Shipley 2010).
</p>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p>vector of predicted probabilities</p>
</td></tr>
<tr><td><code>moments</code></td>
<td>
<p>vector of final moments</p>
</td></tr>
<tr><td><code>entropy</code></td>
<td>
<p>Shannon entropy of <code>prob</code></p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations required to reach convergence</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p><code class="reqn">\lambda</code>-values, only returned if <code>lambda = T</code></p>
</td></tr>
<tr><td><code>constr</code></td>
<td>
<p>macroscopical constraints</p>
</td></tr>
<tr><td><code>states</code></td>
<td>
<p>states and their attributes</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>prior probabilities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bill Shipley <a href="mailto:bill.shipley@usherbrooke.ca">bill.shipley@usherbrooke.ca</a>
</p>
<p><a href="http://www.billshipley.recherche.usherbrooke.ca/">http://www.billshipley.recherche.usherbrooke.ca/</a>
</p>
<p>Ported to <span class="pkg">FD</span> by Etienne Laliberté.
</p>


<h3>References</h3>

<p>Della Pietra, S., V. Della Pietra, and J. Lafferty (1997) Inducing features of random fields. <em>IEEE Transactions Pattern Analysis and Machine Intelligence</em> <b>19</b>:1-13.
</p>
<p>Keddy, P. A. (1992) Assembly and response rules: two goals for predictive community ecology. <em>Journal of Vegetation Science</em> <b>3</b>:157-164.
</p>
<p>Shipley, B., D. Vile, and É. Garnier (2006) From plant traits to plant communities: a statistical mechanistic approach to biodiversity. <em>Science</em> <b>314</b>: 812&ndash;814.
</p>
<p>Shipley, B. (2009) From Plant Traits to Vegetation Structure: Chance and Selection in the Assembly of Ecological Communities. Cambridge University Press, Cambridge, UK. 290 pages.
</p>
<p>Shipley, B. (2010) Inferential permutation tests for maximum entropy models in ecology. <em>Ecology</em> <b>in press</b>.
</p>
<p>Sonnier, G., Shipley, B., and M. L. Navas. 2009. Plant traits, species pools and the prediction of relative abundance in plant communities: a maximum entropy approach. <em>Journal of Vegetation Science</em> <b>in press</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+functcomp">functcomp</a></code> to compute community-aggregated traits,
and <code><a href="#topic+maxent.test">maxent.test</a></code> for the permutation tests proposed by Shipley (2010).
</p>
<p>Another faster version of <code>maxent</code> for multicore processors called <code>maxentMC</code> is available from Etienne Laliberté (<a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>). It's exactly the same as <code>maxent</code> but makes use of the <span class="pkg">multicore</span>, <span class="pkg">doMC</span>, and <span class="pkg">foreach</span> packages. Because of this, <code>maxentMC</code> only works on POSIX-compliant OS's (essentially anything but Windows).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># an unbiased 6-sided dice, with mean = 3.5
# what is the probability associated with each side,
# given this constraint?
maxent(3.5, 1:6)

# a biased 6-sided dice, with mean = 4
maxent(4, 1:6)

# example with tussock dataset
traits &lt;- tussock$trait[, c(2:7, 11)] # use only continuous traits
traits &lt;- na.omit(traits) # remove 2 species with NA's
abun &lt;- tussock$abun[, rownames(traits)] # abundance matrix
abun &lt;- t(apply(abun, 1, function(x) x / sum(x) )) # relative abundances
agg &lt;- functcomp(traits, abun) # community-aggregated traits
traits &lt;- t(traits) # transpose matrix

# run maxent on site 1 (first row of abun), all species
pred.abun &lt;- maxent(agg[1,], traits)

## Not run: 
# do the constraints give predictive ability?
maxent.test(pred.abun, obs = abun[1,], nperm = 49)

## End(Not run)
</code></pre>

<hr>
<h2 id='maxent.test'>
Inferential Permutation Tests for Maximum Entropy Models
</h2><span id='topic+maxent.test'></span>

<h3>Description</h3>

<p><code>maxent.test</code> performs the permutation tests proposed by Shipley (2010) for maximum entropy models.
Two different null hypotheses can be tested:
1) the information encoded in the <em>entire set</em> of constraints <code class="reqn">\mathbf{C}</code> is irrelevant for predicting the probabilities, and
2) the information encoded in <em>subset</em> <code class="reqn">\mathbf{B}</code> of the entire set of constraints <code class="reqn">\mathbf{C}=\mathbf{A}\cup{}\mathbf{B}</code> is irrelevant for predicting the probabilities.
A plot can be returned to facilitate interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxent.test(model, obs, sub.c, nperm = 99, quick = TRUE,
alpha = 0.05, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxent.test_+3A_model">model</code></td>
<td>

<p>list returned by <code><a href="#topic+maxent">maxent</a></code>.
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_obs">obs</code></td>
<td>

<p>vector, matrix or data frame of observed probabilities of the states (columns).
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_sub.c">sub.c</code></td>
<td>

<p>character or numeric vector specifying the subset of constraints <code class="reqn">\mathbf{B}</code> associated with null hypothesis 2.
If missing, null hypothesis 1 is tested.
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_nperm">nperm</code></td>
<td>

<p>number of permutations for the test.
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_quick">quick</code></td>
<td>

<p>if <code>TRUE</code>, the algorithm stops when <code>alpha</code> is outside the confidence interval of the <em>P</em>-value.
Can be useful to speed up the routine.
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_alpha">alpha</code></td>
<td>

<p>desired alpha-level for the test. Only relevant if <code>quick</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="maxent.test_+3A_plot">plot</code></td>
<td>

<p>if <code>TRUE</code>, a plot is returned to facilitate interpretation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>maxent.test</code> is a direct translation of the permutation tests described by Shipley (2010). Please refer to this article for details.
</p>
<p>Using <code>quick = FALSE</code> will return the true null probability for a given <code>nperm</code>. However, if <code>nperm</code> is large (a rule-of-thumb is <code class="reqn">&gt;=999</code> permutations for allowing inference at <code class="reqn">\alpha</code> = 0.05), this can take a very long time. Using <code>quick = TRUE</code> is a much faster and highly recommended alternative if one is only interested in accepting/rejecting the null hypothesis at the specified <code class="reqn">\alpha</code>-level given by argument <code>alpha</code>.
</p>
<p>If <code><a href="#topic+maxent">maxent</a></code> was run with multiple data sets (i.e. if <code>constr</code> had more than one row), then  <code>maxent.test</code> performs the test for all sets simultaneously, following the &lsquo;omnibus&rsquo; procedure described by Shipley (2010).
</p>
<p>The following measure of fit between observed and predicted probabilities is returned:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{fit}=1-\frac{{\displaystyle \sum_{j=1}^{D} \sum_{i=1}^{S}\left(o_{ij}-p_{ij}\right)^{2}}}{\displaystyle \sum_{j=1}^{D} \sum_{i=1}^{S}\left(o_{ij}-q_{ij}\right)^{2}}</code>
</p>

<p>where <code class="reqn">o_{ij}</code>, <code class="reqn">p_{ij}</code>, and <code class="reqn">q_{ij}</code> are the observed, predicted
and prior probabilities of state <code class="reqn">i</code> from data set <code class="reqn">j</code>, respectively, <code class="reqn">S</code> is
the number of states, and <code class="reqn">D</code> the number of data sets (i.e. rows in <code>obs</code>). A value of 1 indicates perfect predictive capacity, while a value near zero
indicates that the constraints provide no additional information beyond what is already contained in the
prior <code class="reqn">\mathbf{q}</code> (Sonnier et al. 2009).
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>measure of fit giving the predictive ability of the entire set of constraints <code class="reqn">\mathbf{C}</code>,
beyond that already provided by the prior distribution. 
</p>
</td></tr>
<tr><td><code>fit.a</code></td>
<td>
<p>measure of fit giving the predictive ability of the subset of constraints <code class="reqn">\mathbf{A}</code>,
beyond that already provided by the prior distribution;  only returned if <code>sub.c</code> is specified</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and predicted probabilities, using
the entire set of constraints <code class="reqn">\mathbf{C}</code></p>
</td></tr>
<tr><td><code>r2.a</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and predicted probabilities, using
the subset of constraints <code class="reqn">\mathbf{A}</code>; only returned if <code>sub.c</code> is specified</p>
</td></tr>
<tr><td><code>r2.q</code></td>
<td>
<p>Pearson <code class="reqn">r^2</code> between observed and prior probabilities;
only returned when <code>sub.c</code> is missing</p>
</td></tr>
<tr><td><code>obs.stat</code></td>
<td>
<p>observed statistic used for the permutation test; see Shipley (2010)</p>
</td></tr>
<tr><td><code>nperm</code></td>
<td>
<p>number of permutations; can be smaller than the specified <code>nperm</code> when <code>quick</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p><em>P</em>-value</p>
</td></tr>
<tr><td><code>ci.pval</code></td>
<td>
<p>approximate confidence intervals of the <em>P</em>-value</p>
</td></tr>
</table>


<h3>Warning</h3>

<p><code>maxent.test</code> is a computationally intensive function. The tests can take a very long time when <code>nperm</code> is large and <code>quick = FALSE</code>. It is highly recommended to use <code>quick = TRUE</code> because of this, unless you are interested in obtaining the true null probability.</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>
</p>
<p><a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a>
</p>


<h3>References</h3>

<p>Sonnier, G., Shipley, B., and M. L. Navas. 2009. Plant traits, species pools and the prediction of relative abundance in plant communities: a maximum entropy approach. <em>Journal of Vegetation Science</em> <b>in press</b>.
</p>
<p>Shipley, B. (2010) Inferential permutation tests for maximum entropy models in ecology. <em>Ecology</em> <b>in press</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxent">maxent</a></code> to run the maximum entropy model that is required by <code>maxent.test</code>.
</p>
<p>Another faster version of <code>maxent.test</code> for multicore processors called <code>maxent.testMC</code> is available from Etienne Laliberté (<a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>). It's exactly the same as <code>maxent.test</code> but makes use of the <span class="pkg">multicore</span>, <span class="pkg">doMC</span>, and <span class="pkg">foreach</span> packages. Because of this, <code>maxentMC</code> only works on POSIX-compliant OS's (essentially anything but Windows).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example with tussock dataset
traits &lt;- tussock$trait[, c(2:7, 11)] # use only continuous traits
traits &lt;- na.omit(traits) # remove 2 species with NA's
abun &lt;- tussock$abun[, rownames(traits)] # abundance matrix
abun &lt;- t(apply(abun, 1, function(x) x / sum(x) )) # relative abundances
agg &lt;- functcomp(traits, abun) # community-aggregated traits
traits &lt;- t(traits) # transpose matrix

# run maxent on site 1 (first row of abun), all species
pred.abun &lt;- maxent(agg[1,], traits)

## Not run: 
# do the constraints give predictive ability?
maxent.test(pred.abun, obs = abun[1,], nperm = 49)

# are height, LDMC, and leaf [N] important constraints?
maxent.test(pred.abun, obs = abun[1,], sub.c = c("height",
"LDMC", "leafN"), nperm = 49)

## End(Not run)
</code></pre>

<hr>
<h2 id='simul.dbFD'>Simulations to Explore Relationships Between Functional Diversity Indices</h2><span id='topic+simul.dbFD'></span>

<h3>Description</h3>

<p><code>simul.dbFD</code> generates artificial communities of species with artificial functional traits. Different functional diversity (FD) indices are computed from these communities using <code><a href="#topic+dbFD">dbFD</a></code> to explore their inter-relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simul.dbFD(s = c(5, 10, 15, 20, 25, 30, 35, 40), t = 3, 
          r = 10, p = 100, tr.method = c("unif", "norm", "lnorm"),
          abun.method = c("lnorm", "norm", "unif"), w.abun = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simul.dbFD_+3A_s">s</code></td>
<td>
<p>vector listing the different levels of species richness used in the simulations</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_t">t</code></td>
<td>
<p>number of traits</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_r">r</code></td>
<td>
<p>number of replicates per species richness level</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_p">p</code></td>
<td>
<p>number of species in the common species pool</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_tr.method">tr.method</code></td>
<td>
<p>character string indicating the sampling distribution for the traits. <code>"unif"</code> is a uniform distribution, <code>"norm"</code> is a normal distribution, and <code>"lnorm"</code> is a lognormal distribution.</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_abun.method">abun.method</code></td>
<td>
<p>character string indicating the sampling distribution for the species abundances. Same as for <code>tr.method</code>.</p>
</td></tr>
<tr><td><code id="simul.dbFD_+3A_w.abun">w.abun</code></td>
<td>
<p>logical; should FDis, FEve, FDiv, and Rao's quadratic entropy (Q) be weighted by species abundances?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contaning the following elements:
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p>data frame containing the results of the simulations</p>
</td></tr>
<tr><td><code>traits</code></td>
<td>
<p>matrix containing the traits</p>
</td></tr>
<tr><td><code>abun</code></td>
<td>
<p>matrix containing the abundances</p>
</td></tr>
<tr><td><code>abun.gamma</code></td>
<td>
<p>species abundances from the pooled set of communities</p>
</td></tr>
<tr><td><code>FDis.gamma</code></td>
<td>
<p>FDis of the pooled set of communities</p>
</td></tr>
<tr><td><code>FDis.mean</code></td>
<td>
<p>mean FDis from all communities</p>
</td></tr>
</table>
<p><code>FDis.gamma</code> and <code>FDis.mean</code> can be used to explore the set concavity criterion (Ricotta 2005) for FDis.
</p>
<p>A graph plotting the results of the simulations is also returned.
</p>


<h3>Warning</h3>

<p>The simulations performed by <code>simul.dbFD</code> can take several hours if <code>length(s)</code> and/or <code>r</code> is large. Run a test with the default parameters first.</p>


<h3>Author(s)</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a> <a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a></p>


<h3>References</h3>

<p>Laliberté, E. and P. Legendre (2010) A distance-based framework for measuring functional diversity from multiple traits. <em>Ecology</em> <b>91</b>299:305.
</p>
<p>Ricotta, C. (2005) A note on functional diversity measures. <em>Basic and Applied Ecology</em> <b>6</b>:479-486.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dbFD">dbFD</a></code>, the function called in <code>simul.dbFD</code></p>


<h3>Examples</h3>

<pre><code class='language-R'># this should take just a few minutes
## Not run: 
ex1 &lt;- simul.dbFD(s = c(10, 20, 30, 40, 50), r = 5)
ex1

## End(Not run)
</code></pre>

<hr>
<h2 id='tussock'>Functional Composition of Short-Tussock Grasslands</h2><span id='topic+tussock'></span>

<h3>Description</h3>

<p><code>tussock</code> contains data on 16 functional traits measured on 53 vascular plant species from New Zealand short-tussock grasslands. It also contains the relative abundances (percent cover) of these 53 species from 30 8x50-m plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tussock</code></pre>


<h3>Format</h3>

<p><code>tussock</code> is a list of 2 components:
</p>

<dl>
<dt>trait</dt><dd><p>data frame of 16 functional traits measured on 53 plant species: growth form (sensu Cornelissen et al. 2003), reproductive plant height (<code class="reqn">\mathrm{m}</code>), leaf dry matter content (<code class="reqn">\mathrm{mg} \; \mathrm{g}^{-1}</code>), leaf nitrogen concentration (<code class="reqn">\mathrm{mg} \; \mathrm{g}^{-1}</code>), leaf phosphorous concentration (<code class="reqn">\mathrm{mg} \; \mathrm{g}^{-1}</code>), leaf sulphur concentration (<code class="reqn">\mathrm{mg} \; \mathrm{g}^{-1}</code>), specific leaf area (<code class="reqn">\mathrm{m}^2 \; \mathrm{kg}^{-1}</code>), nutrient uptake strategy (sensu Cornelissen et al. 2003), Raunkiaer life form, clonality, leaf size (<code class="reqn">\mathrm{mm}^2</code>), primary dispersal mode, seed mass (<code class="reqn">\mathrm{mg}</code>), resprouting capacity, pollination syndrome, and lifespan (an ordinal variable stored as <code><a href="base.html#topic+ordered">ordered</a></code>).</p>
</dd>
<dt>abun</dt><dd><p>matrix containing the relative abundances (percent cover) of the 53 species in 30 plots</p>
</dd>
</dl>



<h3>Details</h3>

<p>The functional traits were measured using standardized methodologies (Cornelissen et al. 2003). Each of the 30 experimental plots from which species cover was estimated is 8x50 m. Relative abundances of all vascular plant species were estimated in November 2007. To do so, 20 1x1-m quadrats per plot were randomly positioned along two longitudinal transects and cover of each species was estimated using a modified Braun-Blanquet scale. This data was pooled at the plot scale to yield the percent cover data.
</p>


<h3>Source</h3>

<p>Etienne Laliberté <a href="mailto:etiennelaliberte@gmail.com">etiennelaliberte@gmail.com</a>
</p>
<p><a href="https://www.elaliberte.info/">https://www.elaliberte.info/</a>
</p>


<h3>References</h3>

<p>Cornelissen, J. H. C., S. Lavorel, E. Garnier, S. Diaz, N. Buchmann, D. E. Gurvich, P. B. Reich, H. ter Steege, H. D. Morgan, M. G. A. van der Heijden, J. G. Pausas and H. Poorter. (2003) A handbook of protocols for standardised and easy measurement of plant functional traits worldwide. <em>Australian Journal of Botany</em> <b>51</b>:335-380.
</p>
<p>Laliberté, E., Norton, D. A. and D. Scott. (2008) Impacts of rangeland development on plant functional diversity, ecosystem processes and services, and resilience. <em>Global Land Project (GLP) Newsletter</em> <b>4</b>:4-6.
</p>
<p>Scott, D. (1999) Sustainability of New Zealand high-country pastures under contrasting development inputs. 1. Site, and shoot nutrients. <em>New Zealand Journal of Agricultural Research</em> <b>42</b>:365-383.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
