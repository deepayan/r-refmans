<!DOCTYPE html><html><head><title>Help for package NiLeDAM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NiLeDAM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ages-class'><p>Class <code>"ages"</code></p></a></li>
<li><a href='#ageTests-class'><p>Class <code>"ageTests"</code></p></a></li>
<li><a href='#calculateAges'><p>Calculate the ages from electron microprobe measurements.</p></a></li>
<li><a href='#liveNiLeDAM'><p>Graphical Web User Interface for 'NiLeDAM'</p></a></li>
<li><a href='#NiLeDAM'><p>Monazite Dating for the 'NiLeDAM' Team</p></a></li>
<li><a href='#oneAgeTest-class'><p>Class <code>"oneAgeTest"</code></p></a></li>
<li><a href='#plot-methods'><p>Method <code>"plot"</code> for Classes <code>"oneAgeTest"</code> and <code>"ageTests"</code></p></a></li>
<li><a href='#popline-methods'><p>Method <code>"popline"</code> for Classes <code>"oneAgeTest"</code> and <code>"ageTests"</code></p></a></li>
<li><a href='#srilanka'><p>An example data set: electron microprobe data.</p></a></li>
<li><a href='#tests-methods'><p>Method <code>"tests"</code> for Class <code>"ages"</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Monazite Dating for the NiLeDAM Team</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-17</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nathalie Vialaneix &lt;nathalie.vialaneix@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Th-U-Pb electron microprobe age dating of monazite, as originally 
             described in &lt;<a href="https://doi.org/10.1016%2F0009-2541%2896%2900024-1">doi:10.1016/0009-2541(96)00024-1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, magrittr, methods, nleqslv, rlang, scales,
shiny, shinyjs, shinythemes, stats, thematic, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'init.R' 'describeNiLeDAM.R' 'describeSrilanka.R' 'ages.R'
'calculate.R' 'oneAgeTest.R' 'ageTests.R' 'tests.R'
'ages-oneAgeTest-ageTests.R' 'liveNILEDAM.R'</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-18 05:41:52 UTC; nathalie</td>
</tr>
<tr>
<td>Author:</td>
<td>Nathalie Vialaneix [aut, trl, cre],
  Aurélie Mercadié [aut],
  Jean-Marc Montel [aut],
  Anne-Magali Seydoux-Guillaume [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-18 06:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ages-class'>Class <code>"ages"</code></h2><span id='topic+ages-class'></span><span id='topic+ages'></span><span id='topic+print+2Cages-method'></span><span id='topic+print.ages'></span><span id='topic+show+2Cages-method'></span><span id='topic+show.ages'></span><span id='topic+summary+2Cages-method'></span><span id='topic+summary.ages'></span>

<h3>Description</h3>

<p>A class for the results of the <code><a href="#topic+calculateAges">calculateAges</a></code> function. It contains
the ages calculated for each analytic point from triplets (U,Th,Pb) and
corresponding errors.
</p>


<h3>Fields</h3>


<dl>
<dt><code>data</code></dt><dd><p>Object of class <code>"data.frame"</code> that contains the
original triplets (U,Th,Pb) and corresponding errors.</p>
</dd>
<dt><code>ages</code></dt><dd><p>Object of class <code>"vector"</code> that contains the
ages calculated for each analytic point.</p>
</dd>
<dt><code>ci</code></dt><dd><p>Object of class <code>"matrix"</code>, which is a two-column
matrix that contains the bounds of the confidence intervals for each age of the
slot <code>ages</code>. These are estimated from a MC simulation method as described
in <code><a href="#topic+calculateAges">calculateAges</a>()</code>.</p>
</dd>
<dt><code>sd</code></dt><dd><p>Object of class <code>"vector"</code> that contains the standard
deviations for each age of the slot <code>ages</code>. These are estimated from a MC
simulation method as described in <code><a href="#topic+calculateAges">calculateAges</a>()</code>.</p>
</dd>
<dt><code>nloops</code></dt><dd><p>Object of class <code>"numeric"</code> that stores the
number of MC simulations used to estimate the confidence intervals and the
standard deviations.</p>
</dd>
<dt><code>level</code></dt><dd><p>Object of class <code>"numeric"</code> that stores the level
of the confidence intervals.</p>
</dd>
</dl>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the function <code><a href="#topic+calculateAges">calculateAges</a>()</code>.
</p>


<h3>Methods</h3>


<ul>
<li><p> print(<code>signature(x = "ages")</code>): display a summary of the results
of the ages calculation.
</p>
</li>
<li><p> show(<code>signature(object = "ages")</code>): display a summary of the
results of the ages calculation (same as <code>print.ages</code>).
</p>
</li>
<li><p> summary(<code>signature(object = "ages")</code>): display a summary of the
results of the ages calculation (same as <code>print.ages</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculateAges">calculateAges</a>()</code>, <code><a href="#topic+tests">tests</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("ages")

## Example on the srilanka dataset

data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops = 10)
calculated.ages

</code></pre>

<hr>
<h2 id='ageTests-class'>Class <code>"ageTests"</code></h2><span id='topic+ageTests-class'></span><span id='topic+ageTests'></span><span id='topic+print+2CageTests-method'></span><span id='topic+print.ageTests'></span><span id='topic+show+2CageTests-method'></span><span id='topic+show.ageTests'></span><span id='topic+summary+2CageTests-method'></span><span id='topic+summary.ageTests'></span>

<h3>Description</h3>

<p>Results of <code class="reqn">\chi^2</code>-tests testing to which number of populations the
ages calculated by the function <code><a href="#topic+calculateAges">calculateAges</a>()</code> are the most likely
to come from. The test is the one described in the article Montel <em>et al.</em>
(1996).
</p>


<h3>Fields</h3>


<dl>
<dt><code>nb.pop</code></dt><dd><p>Object of class <code>"vector"</code> that contains the
tested numbers of populations.</p>
</dd>
<dt><code>best.nb</code></dt><dd><p>Object of class <code>"numeric"</code> that contains the
most probable number of populations, which is the smallest number for which the
<code class="reqn">\chi^2</code>-test is accepted.</p>
</dd>
<dt><code>best.res</code></dt><dd><p>Object of class <code>"<a href="#topic+oneAgeTest-class">oneAgeTest</a>"</code>
that contains the result of the test for <code>best.nb</code> populations.</p>
</dd>
</dl>


<h3>Objects from the Class</h3>

<p>Objects from this class are created by the function <code><a href="#topic+tests">tests</a>()</code> applied
to an object of class <code><a href="#topic+ages">ages</a></code> when the option <span class="option">nbmax</span> is not
set to <code>NULL</code> but to an integer larger than <span class="option">nbmin</span>.
</p>


<h3>Methods</h3>


<ul>
<li><p> print(<code>signature(x = "ageTests")</code>): displays a summary of the test's results.
</p>
</li>
<li><p> show(<code>signature(object = "ageTests")</code>): displays a summary of the test's results.
</p>
</li>
<li><p> summary(<code>signature(object = "ageTests")</code>): displays a summary of the test's results.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ages-class">ages</a></code>, <code><a href="#topic+tests">tests</a>()</code>, <code><a href="#topic+plot.ageTests">plot.ageTests</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("ageTests")

## Example
data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops = 10)
tests(calculated.ages, nbmax = 3)

</code></pre>

<hr>
<h2 id='calculateAges'>Calculate the ages from electron microprobe measurements.</h2><span id='topic+calculateAges'></span>

<h3>Description</h3>

<p>This function calculates the ages, confidence intervals and standard
deviations from triplets (U,Th,Ph), obtained by electron microprobe, given
together with corresponding errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateAges(measures, nloops = 1000, level = 0.05, verbose = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateAges_+3A_measures">measures</code></td>
<td>
<p>a data.frame object with one electron microprobe measurement
by row and with columns U, corresponding error for U, Th, corresponding error
for Th, Pb, corresponding error for Pb, all expressed in ppm. See an example
with <code>data(srilanka)</code>.</p>
</td></tr>
<tr><td><code id="calculateAges_+3A_nloops">nloops</code></td>
<td>
<p>the number of Monte Carlo (MC) simulations used to estimate the
confidence intervals for the ages. Default is <code>1000</code>.</p>
</td></tr>
<tr><td><code id="calculateAges_+3A_level">level</code></td>
<td>
<p>the level of significance of the confidence intervals for the
ages. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="calculateAges_+3A_verbose">verbose</code></td>
<td>
<p>logical; activates the verbose mode. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="calculateAges_+3A_seed">seed</code></td>
<td>
<p>if supplied, initialize the random seed. Default is <code>NULL</code>
(the random seed is not initialized).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ages are calculated by solving the Equation (1) of Montel <em>et al.</em>
(1996). The equation is solved by the Broyden method implemented in the
<code><a href="nleqslv.html#topic+nleqslv">nleqslv</a>()</code> function.
</p>
<p>The standard deviations and the confidence intervals are calculated using a MC
approach: randomized observations of the triplets are generated from normal
distributions with standard deviations equal to
<code class="reqn">\frac{\textrm{error}}{2}</code> where 'error' denotes the error in the
measurement of Th, U or Pb, passed in <span class="option">measures</span>. Standard deviations
are estimated by the empirical standard deviations and confidence intervals by
quantiles for probabilities <code class="reqn">\frac{\textrm{\texttt{level}}}{2}</code>
and <code class="reqn">1-\frac{\textrm{\texttt{level}}}{2}</code>, respectively.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+ages-class">ages</a></code>.
</p>


<h3>Note</h3>

<p>You should use at least 1000 MC simulations otherwise the estimated confidence
intervals and standard deviations will not be reliable. Such simulations can
take a few seconds/minutes for fifty or so triplets and corresponding errors.
</p>


<h3>Author(s)</h3>

<p>Jean-Marc Montel, <a href="mailto:jean-marc.montel@ensg.inpl-nancy.fr">jean-marc.montel@ensg.inpl-nancy.fr</a>
</p>
<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ages-class">ages</a></code> <code><a href="#topic+tests">tests</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load the data
data(srilanka)

## Calculate the ages
calculateAges(srilanka, nloops=10)

</code></pre>

<hr>
<h2 id='liveNiLeDAM'>Graphical Web User Interface for 'NiLeDAM'</h2><span id='topic+liveNiLeDAM'></span>

<h3>Description</h3>

<p>This function starts the graphical user interface with the default 
system browser. This interface is more likely to work properly with Firefox
<a href="https://www.mozilla.org/fr/firefox/new/">https://www.mozilla.org/fr/firefox/new/</a>. In case Firefox is not your 
default browser, copy/paste http://localhost:8100 into the address bar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liveNiLeDAM()
</code></pre>


<h3>Value</h3>

<p>Starts the 'NiLeDAM' GUI.
</p>


<h3>Author(s)</h3>

<p>Aurélie Mercadié, <a href="mailto:aurelie.mercadie@inrae.fr">aurelie.mercadie@inrae.fr</a>
</p>
<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>

<hr>
<h2 id='NiLeDAM'>Monazite Dating for the 'NiLeDAM' Team</h2><span id='topic+NiLeDAM'></span><span id='topic+NiLeDAM-package'></span>

<h3>Description</h3>

<p>The aim here is to provide facilities to date monazite using electron microprobe
analysis (EPMA). More precisely, the 'NiLeDAM' package has three main features:
</p>

<ul>
<li> <p><strong>ages calculation</strong> from a set of analyses of the triplets (U,Th,Pb)
contents and corresponding errors, it calculates the age of each analytic
point by solving Equation (1) of Montel <em>et al.</em> (1996)
</p>
</li>
<li> <p><strong>common age(s) estimation</strong> from these results, it estimates the common
age(s) under the assumption that the analyses come from a given number of age
populations and test for this assumption (<code class="reqn">\chi^2</code>-test) 
</p>
</li>
<li> <p><strong>number of populations estimation</strong> from the calculated ages, it estimates
the most probable number of age populations from which the analyses come.
</p>
</li></ul>

<p>The package contains two main functions: <code><a href="#topic+calculateAges">calculateAges</a>()</code>, that 
calculate the ages and <code><a href="#topic+tests">tests</a>()</code>, that test for the number of age
populations.
</p>
<p>An example is provided with the data <code><a href="#topic+srilanka">srilanka</a></code>, which can be run
using <code>demo(srilanka)</code>.
</p>


<h3>Author(s)</h3>

<p>Aurélie Mercadié, <a href="mailto:aurelie.mercadie@inrae.fr">aurelie.mercadie@inrae.fr</a>
</p>
<p>Jean-Marc Montel, <a href="mailto:jean-marc.montel@ensg.inpl-nancy.fr">jean-marc.montel@ensg.inpl-nancy.fr</a>
</p>
<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>
<p><strong>Maintainer</strong>: Nathalie Vialaneix
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: demo(srilanka)

</code></pre>

<hr>
<h2 id='oneAgeTest-class'>Class <code>"oneAgeTest"</code></h2><span id='topic+oneAgeTest-class'></span><span id='topic+oneAgeTest'></span><span id='topic+print+2ConeAgeTest-method'></span><span id='topic+print.oneAgeTest'></span><span id='topic+show+2ConeAgeTest-method'></span><span id='topic+show.oneAgeTest'></span><span id='topic+summary+2ConeAgeTest-method'></span><span id='topic+summary.oneAgeTest'></span>

<h3>Description</h3>

<p>Results of a <code class="reqn">\chi^2</code>-test testing if the ages calculated by the 
function <code><a href="#topic+calculateAges">calculateAges</a>()</code> come from a given number of populations.
The test is the one described in the article Montel <em>et al.</em> (1996).
</p>


<h3>Fields</h3>


<dl>
<dt><code>data</code></dt><dd><p>Object of class <code>"<a href="#topic+ages">ages</a>"</code> as created by the
function <code><a href="#topic+calculateAges">calculateAges</a>()</code>. This is the object passed as an argument
to the function <code><a href="#topic+tests">tests</a>()</code>.</p>
</dd>
<dt><code>ages</code></dt><dd><p>Object of class <code>"vector"</code> that contains the
estimated common age(s) of the population(s). Its size is equal to the argument
<span class="option">nbmin</span> passed to the function <code><a href="#topic+tests">tests</a>()</code>.</p>
</dd>
<dt><code>sd</code></dt><dd><p>Object of class <code>"vector"</code> that contains the
estimated standard deviations of the common age(s) of the population(s). Its
size is equal to the argument <span class="option">nbmin</span> passed to the function
<code><a href="#topic+tests">tests</a>()</code>.</p>
</dd>
<dt><code>ic</code></dt><dd><p>Object of class <code>"matrix"</code> having <span class="option">nbmin</span> rows
and two columns corresponding to the confidence intervals at level
<span class="option">level</span> as passed as an argument to the function <code><a href="#topic+tests">tests</a>()</code>.</p>
</dd>
<dt><code>S</code></dt><dd><p>Object of class <code>"numeric"</code> <code class="reqn">\chi^2</code> test statistic of the test.</p>
</dd>
<dt><code>thres</code></dt><dd><p>Object of class <code>"numeric"</code> probability threshold of the test.</p>
</dd>
<dt><code>df</code></dt><dd><p>Object of class <code>"numeric"</code> degree of freedom of the test.</p>
</dd>
<dt><code>level</code></dt><dd><p>Object of class <code>"numeric"</code> confidence level of
the test. Passed as an argument to the function <code><a href="#topic+tests">tests</a>()</code>.</p>
</dd>
<dt><code>h0</code></dt><dd><p>Object of class <code>"logical"</code> result of the test: if
<code>h0</code> is <code>TRUE</code>, the test is accepted at level <span class="option">level</span> and if
<code>h0</code> is <code>FALSE</code>, the test is rejected at level <span class="option">level</span>.</p>
</dd>
<dt><code>which.pop</code></dt><dd><p>Object of class <code>"vector"</code> that contains the
population number for each analytic point. <code>1</code> corresponds to the
population with the first age in <code>ages</code>, <code>2</code> to the population with
the second age in <code>ages</code>...</p>
</dd>
</dl>


<h3>Objects from the Class</h3>

<p>Objects from this class are created by the function <code><a href="#topic+tests">tests</a>()</code> applied
to an object of class <code><a href="#topic+ages">ages</a></code> when the option <span class="option">nbmax</span> is set
to <code>NULL</code>.
</p>


<h3>Methods</h3>


<ul>
<li><p> print(<code>signature(x = "oneAgeTest")</code>): displays a summary of the test's result.
</p>
</li>
<li><p> show(<code>signature(object = "oneAgeTest")</code>): displays a summary of the test's result.
</p>
</li>
<li><p> summary(<code>signature(object = "oneAgeTest")</code>): displays a summary of the test' results.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ages-class">ages</a></code>, <code><a href="#topic+tests">tests</a>()</code>, <code><a href="#topic+plot.oneAgeTest">plot.oneAgeTest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("oneAgeTest")

## Example

data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops=10)
tests(calculated.ages)

</code></pre>

<hr>
<h2 id='plot-methods'>Method <code>"plot"</code> for Classes <code>"<a href="#topic+oneAgeTest-class">oneAgeTest</a>"</code> and <code>"<a href="#topic+ageTests-class">ageTests</a>"</code></h2><span id='topic+plot-methods'></span><span id='topic+plot+2ConeAgeTest-method'></span><span id='topic+plot.oneAgeTest'></span><span id='topic+plot+2CageTests-method'></span><span id='topic+plot.ageTests'></span>

<h3>Description</h3>

<p>Display densities of the ages calculated by the function
<code><a href="#topic+calculateAges">calculateAges</a>()</code>, as well as the common age(s) density(ies) as 
returned by the function <code><a href="#topic+tests">tests</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'oneAgeTest'
plot(x, y = NULL, main = "", col = "red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p>an object of class &quot;oneAgeTest&quot; or &quot;ageTests&quot; (see section Methods)</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_y">y</code></td>
<td>
<p>NUll</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_main">main</code></td>
<td>
<p>a character string, title of the plot</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_col">col</code></td>
<td>
<p>a character string, color of the common age(s) density(ies)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated densities are Gaussian, as supposed by the model 
described in Montel <em>et al.</em> (1996). Each density is referenced by its 
number to help identify outliers or invalid measurements.
</p>
<p>Also note that if an object of class <code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code> is passed
to the function, the common age(s) densities is displayed even if the test of
the function <code><a href="#topic+tests">tests</a>()</code> is rejected.
</p>
<p>If argument <span class="option">col</span> is supplied, it is used to display 
the density(ies) of the common age(s).
</p>


<h3>Usage</h3>

<p>plot(x, ...)
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>signature(object = "oneAgeTest")</code>: an object of type
<code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code> as produced by the function
<code><a href="#topic+tests">tests</a>()</code>.
</p>
</li>
<li> <p><code>...</code>: further arguments passed to the function <code><a href="graphics.html#topic+plot">plot</a>()</code>.
</p>
</li></ul>


<ul>
<li> <p><code>signature(object = "ageTests")</code>: an object of type
<code><a href="#topic+ageTests-class">ageTests</a></code> as produced by the function
<code><a href="#topic+tests">tests</a>()</code>.
</p>
</li>
<li> <p><code>...</code>: further arguments passed to the function <code><a href="graphics.html#topic+plot">plot</a>()</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tests">tests</a>()</code>, <code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code>, <code><a href="#topic+ageTests-class">ageTests</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops = 10)
res.tests &lt;- tests(calculated.ages, 1, 3)
plot(res.tests, main = "Densities", col = "lightseagreen")

</code></pre>

<hr>
<h2 id='popline-methods'>Method <code>"popline"</code> for Classes <code>"<a href="#topic+oneAgeTest-class">oneAgeTest</a>"</code> and <code>"<a href="#topic+ageTests-class">ageTests</a>"</code></h2><span id='topic+popline-methods'></span><span id='topic+popline'></span><span id='topic+popline+2ConeAgeTest-method'></span><span id='topic+popline.oneAgeTest'></span><span id='topic+popline+2CageTests-method'></span><span id='topic+popline.ageTests'></span>

<h3>Description</h3>

<p>Display observations as well as their reference's population as calculated 
by the function <code><a href="#topic+tests">tests</a>()</code> given their value of Pb (ppm) 
and Th*(ppm), where Th* is a function of Th and U variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'oneAgeTest'
popline(x, main2 = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popline-methods_+3A_x">x</code></td>
<td>
<p>an object of class &quot;oneAgeTest&quot; or &quot;ageTests&quot; (see section Methods)</p>
</td></tr>
<tr><td><code id="popline-methods_+3A_main2">main2</code></td>
<td>
<p>a character string, title of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Th* is computed thanks to the following formula: 
<code class="reqn">Th + 232*U * [238(exp(4.9475*10^{-5}*Age) - 1)]^{-1} * [[exp(9.8485*10^{-4}*Age + 138*exp(1.55125*10^{-4}*Age))][139] - 1]</code>
</p>
<p>Slopes, depending directly of the ages computed with the function <code><a href="#topic+tests">tests</a>()</code>, 
are obtained through the following equation: <code class="reqn">[exp(4.9475*10^{-5}*Age) - 1] * 207.3/232</code>.
</p>


<h3>Usage</h3>

<p>popline(x, main2)
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>signature(object = "oneAgeTest")</code>: an object of type
<code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code> as produced by the function
<code><a href="#topic+tests">tests</a>()</code>.
</p>
</li>
<li> <p><code>main2</code>: a character string to entitle the plot
</p>
</li></ul>


<ul>
<li> <p><code>signature(object = "ageTests")</code>: an object of type
<code><a href="#topic+ageTests-class">ageTests</a></code> as produced by the function
<code><a href="#topic+tests">tests</a>()</code>.
</p>
</li>
<li> <p><code>main2</code>: a character string to entitle the plot
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Aurélie Mercadié, <a href="mailto:aurelie.mercadie@inrae.fr">aurelie.mercadie@inrae.fr</a>
</p>
<p>Jean-Marc Montel, <a href="mailto:jean-marc.montel@ensg.inpl-nancy.fr">jean-marc.montel@ensg.inpl-nancy.fr</a>
</p>
<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tests">tests</a>()</code>, <code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code>, <code><a href="#topic+ageTests-class">ageTests</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops = 10)
res.tests &lt;- tests(calculated.ages, 1, 3)
popline(res.tests, main2 = "Populations")

</code></pre>

<hr>
<h2 id='srilanka'>An example data set: electron microprobe data.</h2><span id='topic+srilanka'></span>

<h3>Description</h3>

<p>This dataset is kindly provided by Anne-Magali Seydoux-Guillaume
<a href="mailto:anne.magali.seydoux@univ-st-etienne.fr">anne.magali.seydoux@univ-st-etienne.fr</a> and has been published in 
Seydoux-Guillaume <em>et al.</em> (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(srilanka)
</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 6 variables:
</p>

<ul>
<li> <p><strong>U</strong>: U concentration (ppm)
</p>
</li>
<li> <p><strong>errU</strong>: error on the measurement of U concentration
</p>
</li>
<li> <p><strong>Th</strong>: Th concentration (ppm)
</p>
</li>
<li> <p><strong>ErrTh</strong>: error on the measurement of Th concentration
</p>
</li>
<li> <p><strong>Pb</strong>: Pb concentration (ppm)
</p>
</li>
<li> <p><strong>ErrPb</strong>: error on the measurement of Pb concentration
</p>
</li></ul>



<h3>Details</h3>

<p>The first 8 observations are group control data (more precisely, they correspond
to standard reference analyses). When testing if all the observations are issued
from a single population, the assumption is thus rejected. Removing the first 8
observations leads to obtain a positive answer when testing if the observations
come from the same population. See <code>demo(srilanka)</code>.
</p>


<h3>References</h3>

<p>Seydoux-Guillaume A.M., Montel J.M., Bingen B., Bosse V., de Parseval P.,
Paquette J.L., Janots E., Wirth R. (2012) Low-temperature alteration of
monazite: fluid mediated coupled dissolution-precipitation, irradiation damage
and disturbance of the U-Pb and Th-Pb chronometers. <em>Chemical Geology</em>, 
<b>330&ndash;331</b>, 140&ndash;158.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(srilanka)

# With control group data
summary(srilanka)

# Without control group data
summary(srilanka[9:32,])

</code></pre>

<hr>
<h2 id='tests-methods'>Method <code>"tests"</code> for Class <code>"<a href="#topic+ages-class">ages</a>"</code></h2><span id='topic+tests-methods'></span><span id='topic+tests+2Cages-method'></span><span id='topic+tests'></span>

<h3>Description</h3>

<p>Test if a set of ages belongs to a given number of populations or
alternatively find out the most probable number of populations within a range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'ages'
tests(object, nbmin = 1, nbmax = NULL, level = object@level, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tests-methods_+3A_object">object</code></td>
<td>
<p>an object of type <code><a href="#topic+ages-class">ages</a></code> as produced by the function <code><a href="#topic+calculateAges">calculateAges</a>()</code></p>
</td></tr>
<tr><td><code id="tests-methods_+3A_nbmin">nbmin</code></td>
<td>
<p>a numeric. Minimum tested number of populations.</p>
</td></tr>
<tr><td><code id="tests-methods_+3A_nbmax">nbmax</code></td>
<td>
<p>a numeric. Maximum tested number of populations.</p>
</td></tr>
<tr><td><code id="tests-methods_+3A_level">level</code></td>
<td>
<p>a numeric. Confidence interval level. Default is equal to <code>object@level</code>, 
i.e., to the level of confidence used to calculate the ages.</p>
</td></tr>
<tr><td><code id="tests-methods_+3A_verbose">verbose</code></td>
<td>
<p>logical. Activates the verbose mode.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function successively tests all values from <code>nbmin</code> to
<code>nbmax</code> and keeps the smallest accepted one (returns an error if all
supplied values are rejected). In this case, the output value is an object of
class <code><a href="#topic+ageTests-class">ageTests</a></code>.
</p>
<p>If <code>nbmax</code> is <code>NULL</code>, the results are kept even if the test is
rejected. In this case, the output value is an object of class
<code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code>.
</p>
<p>The performed tests are those described in Montel <em>et al.</em> (1996).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+ageTests-class">ageTests</a></code> or
<code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code> depending on the value of <code>nbmax</code> (see section &quot;Details&quot;).
</p>


<h3>Usage</h3>

<p><code>tests(object, nbmin=1, nbmax=NULL, level=object@level, verbose=TRUE)</code>
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>signature(object = "ages")</code>: an object of type
<code><a href="#topic+ages-class">ages</a></code> as produced by the function
<code><a href="#topic+calculateAges">calculateAges</a>()</code>.
</p>
</li>
<li><p> ...: other arguments passed to the method's function (see section Usage)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jean-Marc Montel, <a href="mailto:jean-marc.montel@ensg.inpl-nancy.fr">jean-marc.montel@ensg.inpl-nancy.fr</a>
</p>
<p>Nathalie Vialaneix, <a href="mailto:nathalie.vialaneix@inrae.fr">nathalie.vialaneix@inrae.fr</a>
</p>


<h3>References</h3>

<p>Montel J.M., Foret S., Veschambre M., Nicollet C., Provost A. (1996) Electron
microprobe dating of monazite. <em>Chemical Geology</em>, <b>131</b>, 37&ndash;53.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculateAges">calculateAges</a>()</code>, <code><a href="#topic+oneAgeTest-class">oneAgeTest</a></code>, <code><a href="#topic+ageTests-class">ageTests</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(srilanka)
calculated.ages &lt;- calculateAges(srilanka, nloops = 10)
tests(calculated.ages)
tests(calculated.ages, 1, 3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
