<!DOCTYPE html><html><head><title>Help for package pwlmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pwlmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#datamultv'><p>datamultv data</p></a></li>
<li><a href='#dataw1'><p>dataw1 data</p></a></li>
<li><a href='#pwigls2'><p>Fit Weighted Linear Multilevel Model</p></a></li>
<li><a href='#wmlmm'><p>Fit Weighted Multivariate Linear Multilevel Model to Longitudinal Data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>PWIGLS for Two-Level Multivariate and Multilevel Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alinne Veiga &lt;alinne.veiga@ibge.gov.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates two-level multilevel linear model and two-level multivariate linear multilevel model with weights following Probability Weighted Iterative Generalised Least Squares approach. For details see Veiga et al.(2014) &lt;<a href="https://doi.org/10.1111%2Frssc.12020">doi:10.1111/rssc.12020</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, Matrix, Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-13 16:00:48 UTC; alinn</td>
</tr>
<tr>
<td>Author:</td>
<td>Alinne Veiga <a href="https://orcid.org/0000-0002-1611-2918"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jo√£o Messa [aut, trl, com]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-13 22:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='datamultv'>datamultv data</h2><span id='topic+datamultv'></span>

<h3>Description</h3>

<p>Longitudinal data set with the five occasions for each reference person. Generated from the Continuous PNAD (IBGE/Brazil) from the first quarter of 2018 until the first quarter of 2019 following households included in the sample at the first quarter of 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datamultv)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 1685 observations and the following 13 variables.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>the logarithm of the monthly income in the main job for people aged 14 and over (only for people who received cash, products or goods in the main job) plus 1</p>
</dd>
<dt><code>X1</code></dt><dd><p>age of the resident in the reference date centered around 40</p>
</dd>
<dt><code>X2</code></dt><dd><p>indicator variable for male residents</p>
</dd>
<dt><code>X3</code></dt><dd><p>indicator variable for residents of white color or race</p>
</dd>
<dt><code>X4</code></dt><dd><p>the logarithm of hours actually worked in the reference week in all jobs for people aged 14 and over plus 1</p>
</dd>
<dt><code>X5</code></dt><dd><p>years of study (people aged 5 or over) standardized for elementary school 9 YEARS SYSTEM</p>
</dd>
<dt><code>PSU</code></dt><dd><p>level 2 identifiers, is the group identifier for this data</p>
</dd>
<dt><code>STRAT</code></dt><dd><p>variable that identifies the strata (not needed in the command functions)</p>
</dd>
<dt><code>wave</code></dt><dd><p>time-dummies for level 1 units</p>
</dd>
<dt><code>idd</code></dt><dd><p>level 1 identifiers</p>
</dd>
<dt><code>wj</code></dt><dd><p>weights corresponding to level 2 units</p>
</dd>
<dt><code>w_ij</code></dt><dd><p>vector of weights corresponding to level 1 units, conditional to their respective level 2 unit (also longitudinal weights in the multivariate data)</p>
</dd>
<dt><code>wi_j</code></dt><dd><p>weights corresponding to level 1 and 2 units (not needed in the command functions)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(datamultv)
summary(datamultv)
</code></pre>

<hr>
<h2 id='dataw1'>dataw1 data</h2><span id='topic+dataw1'></span>

<h3>Description</h3>

<p>Crosssectional data set. A two-level data containing  wave one from <code>datamultv</code> data. Generated from the first quarter of 2018 data of the Continuous PNAD (IBGE/Brazil).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataw1)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 337 observations and the following 13 variables.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>the logarithm of the monthly income in the main job for people aged 14 and over (only for people who received cash, products or goods in the main job) plus 1</p>
</dd>
<dt><code>X1</code></dt><dd><p>age of the resident in the reference date centered around 40</p>
</dd>
<dt><code>X2</code></dt><dd><p>indicator variable for male residents</p>
</dd>
<dt><code>X3</code></dt><dd><p>indicator variable for residents of white color or race</p>
</dd>
<dt><code>X4</code></dt><dd><p>the logarithm of hours actually worked in the reference week in all jobs for people aged 14 and over plus 1</p>
</dd>
<dt><code>X5</code></dt><dd><p>years of study (people aged 5 or over) standardized for elementary school 9 YEARS SYSTEM</p>
</dd>
<dt><code>PSU</code></dt><dd><p>level 2 identifiers, is the group identifier for this data</p>
</dd>
<dt><code>STRAT</code></dt><dd><p>variable that identifies the strata (not needed in the command functions)</p>
</dd>
<dt><code>wave</code></dt><dd><p>time-dummies for level 1 units</p>
</dd>
<dt><code>idd</code></dt><dd><p>level 1 identifiers</p>
</dd>
<dt><code>wj</code></dt><dd><p>weights corresponding to level 2 units</p>
</dd>
<dt><code>w_ij</code></dt><dd><p>vector of weights corresponding to level 1 units, conditional to their respective level 2 unit (also longitudinal weights in the multivariate data)</p>
</dd>
<dt><code>wi_j</code></dt><dd><p>weights corresponding to level 1 and 2 units (not needed in the command functions)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(dataw1)
summary(dataw1)
</code></pre>

<hr>
<h2 id='pwigls2'>Fit Weighted Linear Multilevel Model</h2><span id='topic+pwigls2'></span>

<h3>Description</h3>

<p>Fit a probability-weighted two-level linear model with unequal selection probabilities at each level, via IGLS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwigls2(formula, data = NULL, wj, wij)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwigls2_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed-effects and random-effects part of the model, with the response on the left of a ~ operator and the terms, separated by + operators, on the right. Random-effects terms are distinguished by vertical bars (|) separating expressions for design matrices from grouping factors.</p>
</td></tr>
<tr><td><code id="pwigls2_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in <code>formula</code>. If not found in data, the variables are taken from the environment of <code>formula</code> (if specified as a formula) or from the parent frame (if specified as a character vector).</p>
</td></tr>
<tr><td><code id="pwigls2_+3A_wj">wj</code></td>
<td>
<p>a vector of sampling weights for level two units. Level two units are selected with inclusion probabilities. Then, sampling weights for the level two units are defined as the inverse of these probabilities.</p>
</td></tr>
<tr><td><code id="pwigls2_+3A_wij">wij</code></td>
<td>
<p>a vector of sampling weights for level one units. After selecting a level two unit, level one units belonging to them are selected with inclusion probabilities. Then, sampling weights for the level one units are defined as the inverse of these probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Follows estimation process described in Pfeffermann et al. (1998). Uses probability-weighted IGLS with scaled weights.
</p>


<h3>Value</h3>

<p>Estimated list of estimators
</p>


<h3>References</h3>

<p>D. Pfeffermann; C. J. Skinner; D. J. Holmes; H. Goldstein; J. Rasbash, 2008,
Weighting for Unequal Selection Probabilities in Multilevel Models
Journal of the Royal Statistical Society. Series B (Statistical Methodology),
Vol. 60, No. 1. (1998), pp. 23-40.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataw1)
pwigls2( Y ~ X1 + X2 + (1 | PSU), data = dataw1, wj, wi_j)

</code></pre>

<hr>
<h2 id='wmlmm'>Fit Weighted Multivariate Linear Multilevel Model to Longitudinal Data.</h2><span id='topic+wmlmm'></span>

<h3>Description</h3>

<p>Fit a two-level probability-weighted multivariate linear model with a linear error covariance matrix structure, via IGLS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wmlmm(formula, data = NULL, ID3, ID2, ID1, wj, wij, type, rot = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wmlmm_+3A_formula">formula</code></td>
<td>
<p>a linear formula object with the response on the left of a ~ operator and the terms, separated by + operators, on the right.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in <code>formula</code>. If not found in data, the variables are taken from the environment of <code>formula</code> (if specified as a formula) or from the parent frame (if specified as a character vector).</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_id3">ID3</code></td>
<td>
<p>vector of indexes for level two units</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_id2">ID2</code></td>
<td>
<p>vector of indexes for level one units.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_id1">ID1</code></td>
<td>
<p>vector of successive measurements within the same level one unit, for all units.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_wj">wj</code></td>
<td>
<p>a vector of sampling weights for level two units. Level two units are selected with inclusion probabilities. Then, sampling weights for the level two units are defined as the inverse of these probabilities.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_wij">wij</code></td>
<td>
<p>a vector of sampling weights for level one units. After selecting a level two unit, level one units belonging to them are selected with inclusion probabilities. Then, sampling weights for the level one units are defined as the inverse of these probabilities.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_type">type</code></td>
<td>
<p>type of structure imposed in the error covariance matrix; &quot;toep&quot; refers to the toeplitz, &quot;uns&quot; refers to the unestructured and &quot;genlin&quot; refers to the general linear.</p>
</td></tr>
<tr><td><code id="wmlmm_+3A_rot">rot</code></td>
<td>
<p>vector of 0's and 1's related to the measurements in time when <code>"genlin"</code> is passed to the <code>type</code> argument. Use 1 if the data were collected in that specific time unit, and 0 otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Follows estimation process described in Veiga et al. (2014). Uses probability-weighted IGLS with scaled weights.
</p>


<h3>Value</h3>

<p>Estimated list of estimators
</p>


<h3>References</h3>

<p>A. Veiga, P. W. F. Smith and J. J. Brown (2014),
The use of sample weights in multivariate multilevel models with an application to income data collected by using a rotating panel survey
Journal of the Royal Statistical Society. Series C (Applied Statistics)
Vol. 63, No. 1 (JANUARY 2014), pp. 65-84 (20 pages)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datamultv)
 wmlmm ( Y ~ X1 + X2, data = datamultv, PSU, idd, wave, wj, wi_j, "toep")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
