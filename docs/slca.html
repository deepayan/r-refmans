<!DOCTYPE html><html lang="en"><head><title>Help for package slca</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {slca}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#slca-package'><p>slca: An R Package for Structural Modeling for Multiple Latent Class Variables</p></a></li>
<li><a href='#addhealth'><p>Adolescent Depression Data from the Add Health Study</p></a></li>
<li><a href='#compare'><p>Compare Two Fitted <code>slca</code> Models</p></a></li>
<li><a href='#confint.slcafit'><p>Confidence Intervals for Model Parameters</p></a></li>
<li><a href='#estimate'><p>Estimate Parameters of an <code>slca</code> Object</p></a></li>
<li><a href='#gof'><p>Goodness-of-Fit Test for Fitted <code>slca</code> Model</p></a></li>
<li><a href='#gss7677'><p>GSS 1976-1977 Data on Social Status and Tolerance towards Minorities</p></a></li>
<li><a href='#nlsy_jlcpa'><p>JLCPA Model Estimated with NLSY97 Data</p></a></li>
<li><a href='#nlsy97'><p>NLSY97 Substance Use Data</p></a></li>
<li><a href='#param'><p>Print Estimated Parameters of an <code>slcafit</code> Object</p></a></li>
<li><a href='#predict.slcafit'><p>Model Predictions for Estimated <code>slca</code> Object</p></a></li>
<li><a href='#regress'><p>Regress Exogenous Variables on Latent Variables</p></a></li>
<li><a href='#reorder.slcafit'><p>Reorder Latent Class Membership of Latent Class Variables</p></a></li>
<li><a href='#simulate.slca'><p>Simulate Data from an <code>slca</code> Model</p></a></li>
<li><a href='#slca'><p>Construct Structural Latent Class Model</p></a></li>
<li><a href='#slcaControl'><p>Control Parameters for <code>slca</code> Estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Structural Modeling for Multiple Latent Class Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Youngsun Kim &lt;yskstat@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides comprehensive tools for the implementation of Structural Latent Class Models (SLCM), including
    Latent Transition Analysis (LTA; Linda M. Collins and Stephanie T. Lanza, 2009) &lt;<a href="https://doi.org/10.1002%2F9780470567333">doi:10.1002/9780470567333</a>&gt;,
    Latent Class Profile Analysis (LCPA; Hwan Chung et al., 2010) &lt;<a href="https://doi.org/10.1111%2Fj.1467-985x.2010.00674.x">doi:10.1111/j.1467-985x.2010.00674.x</a>&gt;, and
    Joint Latent Class Analysis (JLCA; Saebom Jeon et al., 2017) &lt;<a href="https://doi.org/10.1080%2F10705511.2017.1340844">doi:10.1080/10705511.2017.1340844</a>&gt;, and 
    any other extended models involving multiple latent class variables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>DiagrammeR, magrittr, MASS, Rcpp, stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://kim0sun.github.io/slca/">https://kim0sun.github.io/slca/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kim0sun/slca/issues">https://github.com/kim0sun/slca/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 18:18:21 UTC; kim0sun</td>
</tr>
<tr>
<td>Author:</td>
<td>Youngsun Kim <a href="https://orcid.org/0000-0001-8003-1939"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hwan Chung <a href="https://orcid.org/0000-0002-8969-9086"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-13 03:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='slca-package'>slca: An R Package for Structural Modeling for Multiple Latent Class Variables</h2><span id='topic+slca-package'></span>

<h3>Description</h3>

<p>The <code>slca</code> package provides a comprehensive toolkit for the implementation of Structural Latent Class Models (SLCM). This includes tools for conducting Latent Transition Analysis (LTA), Latent Class Profile Analysis (LCPA), and Joint Latent Class Analysis (JLCA), facilitating the analysis of complex latent structures in statistical data.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Youngsun Kim <a href="mailto:yskstat@gmail.com">yskstat@gmail.com</a> (<a href="https://orcid.org/0000-0001-8003-1939">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Hwan Chung <a href="mailto:hwanch@korea.ac.kr">hwanch@korea.ac.kr</a> (<a href="https://orcid.org/0000-0002-8969-9086">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://kim0sun.github.io/slca/">https://kim0sun.github.io/slca/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/kim0sun/slca/issues">https://github.com/kim0sun/slca/issues</a>
</p>
</li></ul>


<hr>
<h2 id='addhealth'>Adolescent Depression Data from the Add Health Study</h2><span id='topic+addhealth'></span>

<h3>Description</h3>

<p>This dataset contains responses from the National Longitudinal Study of Adolescent Health (Add Health), focusing on adolescents' experiences with depression. The subjects, who were in Grades 10 and 11 during the 1994â€“1995 academic year, provided data on at least one measure of adolescent delinquency in Wave I. <br />
These data can be used to replicate the latent class analysis conducted by Collins and Lanza (2009).<br />
The dataset includes five covariates, notably grade level and sex of respondents, along with variables capturing depressive emotions: sadness (<code>S1-S4</code>), feeling disliked (<code>D1-D2</code>), and feelings of failure (<code>F1-F2</code>). <br />
Responses for these variables were initially categorized as &quot;Never,&quot; &quot;Sometimes,&quot; &quot;Often,&quot; or &quot;Most or All of the Time.&quot; In this dataset, responses have been recoded as &quot;No&quot; for &quot;Never&quot; and &quot;Yes&quot; for all other responses, providing  a longitudinal perspective on adolescent depression across Waves I and II. Variables with the suffix <code>"w1"</code> are from Wave I, while those with the suffix <code>"w2"</code> are from Wave II.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addhealth
</code></pre>


<h3>Format</h3>

<p>A data frame with 2061 rows and 18 variables:
</p>

<dl>
<dt><code>GRADE</code></dt><dd><p>Respondent's grade level at Wave I.</p>
</dd>
<dt><code>SEX</code></dt><dd><p>Respondent's sex <br /> levels: (1)<code>Male</code>, (2)<code>Female</code>.</p>
</dd>
<dt><code>S1w1</code>, <code>S1w2</code></dt><dd><p>I felt that I could not shake off the blues even with help from my family and friends.</p>
</dd>
<dt><code>S2w1</code>, <code>S2w2</code></dt><dd><p>I felt depressed.</p>
</dd>
<dt><code>S3w1</code>, <code>S3w2</code></dt><dd><p>I felt lonely.</p>
</dd>
<dt><code>S4w1</code>, <code>S4w2</code></dt><dd><p>I felt sad.</p>
</dd>
<dt><code>D1w1</code>, <code>D1w2</code></dt><dd><p>People were unfriendly to me.</p>
</dd>
<dt><code>D2w1</code>, <code>D2w2</code></dt><dd><p>I felt that people disliked me</p>
</dd>
<dt><code>F1w1</code>, <code>F1w2</code></dt><dd><p>I thought my life had been a failure.</p>
</dd>
<dt><code>F2w1</code>, <code>F2w2</code></dt><dd><p>I felt life was not worth living</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://addhealth.cpc.unc.edu/data/#public-use">https://addhealth.cpc.unc.edu/data/#public-use</a>
</p>


<h3>References</h3>

<p>Collins, L.M., &amp; Lanza, S.T. (2009). Latent Class and Latent Transition Analysis: With Applications in the Social, Behavioral, and Health Sciences.
</p>
<p>J.R. Udry. The National Longitudinal Study of Adolescent Health (Add Health), Waves I &amp; II, 1994-1996. Carolina Population Center, University of North Carolina at Chapel Hill, Chapel Hill, NC, 2003.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
data &lt;- addhealth[1:300,]
lta5 &lt;- slca(
   DEP1(5) ~ S1w1 + S2w1 + S3w1 + S4w1 + D1w1 + D2w1 + F1w1 + F2w1,
   DEP2(5) ~ S1w2 + S2w2 + S3w2 + S4w2 + D1w2 + D2w2 + F1w2 + F2w2,
   DEP1 ~ DEP2
) %&gt;% estimate(data, control = list(em.tol = 1e-6))
lta5inv &lt;- slca(
   DEP1(5) ~ S1w1 + S2w1 + S3w1 + S4w1 + D1w1 + D2w1 + F1w1 + F2w1,
   DEP2(5) ~ S1w2 + S2w2 + S3w2 + S4w2 + D1w2 + D2w2 + F1w2 + F2w2,
   DEP1 ~ DEP2,
   constraints = c("DEP1", "DEP2")
) %&gt;% estimate(data, control = list(em.tol = 1e-6))

compare(lta5inv, lta5, test = "chisq")
lta5inv %&gt;% param()
</code></pre>

<hr>
<h2 id='compare'>Compare Two Fitted <code>slca</code> Models</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>Conducts a relative model fit test between two fitted SLCM models using the deviance statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(
  model1,
  model2,
  test = c("none", "chisq", "boot"),
  nboot = 50,
  method = c("hybrid", "em", "nlm"),
  plot = FALSE,
  maxiter = 1000,
  tol = 1e-08,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_model1">model1</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_model2">model2</code></td>
<td>
<p>another object of class <code>slcafit</code> to be compared with <code>model1</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of test to be conducted. If <code>"chisq"</code>, a chi-squared test is conducted. If <code>"boot"</code>, a bootstrap test is conducted.</p>
</td></tr>
<tr><td><code id="compare_+3A_nboot">nboot</code></td>
<td>
<p>an integer specifying the number of bootstrap iterations to perform (used only when <code>test = "boot"</code>). The default is 100.</p>
</td></tr>
<tr><td><code id="compare_+3A_method">method</code></td>
<td>
<p>a character string specifying the estimation method for bootstrapping.</p>
</td></tr>
<tr><td><code id="compare_+3A_plot">plot</code></td>
<td>
<p>a logical value indicating whether to display a histogram of G-squared statistics for the bootstrap samples (applicable only for <code>test = "boot"</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_maxiter">maxiter</code></td>
<td>
<p>an integer specifying the maximum number of iterations allowed during each bootstrap estimation round. The default is 100.</p>
</td></tr>
<tr><td><code id="compare_+3A_tol">tol</code></td>
<td>
<p>numeric value setting the convergence tolerance for each bootstrap iteration. The default is <code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_verbose">verbose</code></td>
<td>
<p>a logical value indicating whether to print progress updates on completed bootstrap iterations. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the number of parameters (Df), loglikelihood, AIC, BIC, G-squared statistics, and the residual degree of freedom for each object.
If a statistical test is conducted (via <code>test</code>), the resulting p-value for the comparison is also included.
</p>


<h3>See Also</h3>

<p><a href="#topic+gof">gof</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
data &lt;- gss7677[gss7677$COHORT == "YOUNG", ]
stat2 &lt;- slca(status(2) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))
stat3 &lt;- slca(status(3) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))
stat4 &lt;- slca(status(4) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))

gof(stat2, stat3, stat4)
gof(stat2, stat3, stat4, test = "chisq")

gof(stat2, stat3, stat4, test = "boot")


compare(stat3, stat4)
compare(stat3, stat4, test = "chisq")

compare(stat3, stat4, test = "boot")

</code></pre>

<hr>
<h2 id='confint.slcafit'>Confidence Intervals for Model Parameters</h2><span id='topic+confint.slcafit'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters of a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slcafit'
confint(object, parm, level = 0.95, type = c("param", "logit"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.slcafit_+3A_object">object</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="confint.slcafit_+3A_parm">parm</code></td>
<td>
<p>an integer or string specifying the parameters for which confidence intervals are to be computed.</p>
</td></tr>
<tr><td><code id="confint.slcafit_+3A_level">level</code></td>
<td>
<p>a numeric value representing the confidence level for the intervals. The default is <code>0.95</code> (95% confidence level).</p>
</td></tr>
<tr><td><code id="confint.slcafit_+3A_type">type</code></td>
<td>
<p>a character string specifying the format in which the results should be returned. Options include <code>"probs"</code> for probability format and <code>"logit"</code> for log-odds (logit) format, with the default being <code>"probs"</code>.</p>
</td></tr>
<tr><td><code id="confint.slcafit_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> with two columns representing the confidence intervals for the selected parameters. The column names correspond to the specified confidence level:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;100 * (level / 2)%&#8288;</code>: The lower bound of the confidence interval.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;100 * (1 - level / 2)%&#8288;</code>: The upper bound of the confidence interval.
</p>
</li></ul>

<p>The <code>level</code> argument determines the confidence level, with common values being <code>0.95</code> for a 95% confidence interval and <code>0.99</code> for a 99% confidence interval.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param(nlsy_jlcpa, index = TRUE)
confint(nlsy_jlcpa)
confint(nlsy_jlcpa, 1:4)
</code></pre>

<hr>
<h2 id='estimate'>Estimate Parameters of an <code>slca</code> Object</h2><span id='topic+estimate'></span><span id='topic+estimate.slca'></span>

<h3>Description</h3>

<p>Estimates the parameters of a model created using the <code>slca</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(x, ...)

## S3 method for class 'slca'
estimate(x,
   data,
   method = c("em", "hybrid", "nlm"),
   fix2zero = NULL,
   control = slcaControl(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_+3A_x">x</code></td>
<td>
<p>an <code>slca</code> object defining the <code>slca</code> model to be estimated.</p>
</td></tr>
<tr><td><code id="estimate_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the estimation process.</p>
</td></tr>
<tr><td><code id="estimate_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> containing the observed categorical variables included in the model.</p>
</td></tr>
<tr><td><code id="estimate_+3A_method">method</code></td>
<td>
<p>a character string specifying the estimation method for SLCM parameters. The default is <code>"em"</code>, which uses the expectation-maximization (EM) algorithm. The alternative <code>"nlm"</code> employs the Newton-Raphson algorithm via the <code>nlm</code> function, while <code>"hybrid"</code> combines both approaches, starting with EM and finishing with <code>nlm</code> for refined estimates.</p>
</td></tr>
<tr><td><code id="estimate_+3A_fix2zero">fix2zero</code></td>
<td>
<p>a <code>vector</code> specifying parameters to be constrained to zero. See the 'Details' section for further information.</p>
</td></tr>
<tr><td><code id="estimate_+3A_control">control</code></td>
<td>
<p>a <code>list</code> of control parameters for the estimation procedure. Modify default values using <code><a href="#topic+slcaControl">slcaControl()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>fix2zero</code> argument allows you to constrain specific parameters to zero. Each parameter is associated with a unique index, which can be identified using the <a href="#topic+param">param</a> function with the argument <code>index = TRUE</code>. To apply constraints, provide the relevant parameter indices in the <code>fix2zero</code> arguments with vector.
</p>


<h3>Value</h3>

<p>An object of class <code>slcafit</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>a <code>list</code> describing of the model structure.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the estimation method used.</p>
</td></tr>
<tr><td><code>arg</code></td>
<td>
<p>a brief description of the model used during estimation.</p>
</td></tr>
<tr><td><code>mf</code></td>
<td>
<p>the <code>data.frame</code> used for estimation.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the log of the estimated paramters.</p>
</td></tr>
<tr><td><code>logit</code></td>
<td>
<p>the log-odds of the estimated parameters.</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>the score function for the estimated parameters.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a <code>list</code> of posterior probablities for each latent class variable.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>a logical indicator of whether convergence was achieved.</p>
</td></tr>
<tr><td><code>loglikelihood</code></td>
<td>
<p>the loglikelihood value of the estimated model.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>the control settings used during the estimation process.</p>
</td></tr>
</table>
<p>The returned object can be further processed using the <a href="#topic+param">param</a> function to extract the estimated parameters or their standard errors. The <a href="#topic+regress">regress</a> function allows for logistic regression analysis using a three-step approach to evaluate the effects of external variables on latent class variables. Additionally, several other methods are available, including <a href="#topic+predict.slcafit">predict.slcafit</a>, <a href="#topic+reorder.slcafit">reorder.slcafit</a>, <a href="#topic+gof">gof</a>, and others.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slca">slca()</a></code> <code><a href="#topic+param">param()</a></code> <code><a href="#topic+slcaControl">slcaControl()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m &lt;- slca(lc[3] ~ y1 + y2 + y3 + y4)
pi &lt;- rep(1 / 3, 3)
rho &lt;- c(.9, .1, .9, .1, .9, .1, .9, .1, # class 1
         .9, .1, .9, .1, .1, .9, .1, .9, # class 2
         .1, .9, .1, .9, .1, .9, .1, .9) # class 3
dt &lt;- simulate(m, 200, parm = c(pi, rho))
estimate(m, dt$response)

# Several estimation methods
estimate(m, dt$response, method = "em",
         control = slcaControl(verbose = TRUE)) # default
estimate(m, dt$response, method = "nlm",
         control = slcaControl(verbose = TRUE))
estimate(m, dt$response, method = "hybrid",
         control = slcaControl(verbose = TRUE))

# Parameter restriction
mf &lt;- estimate(m, dt$response)
param(mf, index = TRUE)
mf0 &lt;- estimate(mf, fix2zero = c(4, 6, 8, 10))
param(mf0)

# Estimation control
estimate(m, dt$response, control = slcaControl(nrep = 3, verbose = TRUE))
estimate(m, dt$response, control = slcaControl(init.param = c(pi, rho)))
</code></pre>

<hr>
<h2 id='gof'>Goodness-of-Fit Test for Fitted <code>slca</code> Model</h2><span id='topic+gof'></span><span id='topic+gof.slcafit'></span>

<h3>Description</h3>

<p>Computes the AIC, BIC, and deviance statistic (G-squared) for assessing the goodness-of-fit of a fitted <code>slca</code> model. If the <code>test</code> argument is specified, absolute model fit can be evaluated using deviance statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof(object, ...)

## S3 method for class 'slcafit'
gof(
   object, ..., test = c("none", "chisq", "boot"),
   nboot = 100, plot = FALSE,
   maxiter = 100, tol = 1e-6, verbose = FALSE
)

## S3 method for class 'slcafit'
gof(
  object,
  ...,
  test = c("none", "chisq", "boot"),
  nboot = 100,
  plot = FALSE,
  maxiter = 100,
  tol = 1e-06,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_+3A_object">object</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_...">...</code></td>
<td>
<p>additional objects of class <code>slcafit</code> for comparison.</p>
</td></tr>
<tr><td><code id="gof_+3A_test">test</code></td>
<td>
<p>a character string specifying the type of test to be conducted. If <code>"chisq"</code>, a chi-squared test is conducted. If <code>"boot"</code>, a bootstrap test is conducted.</p>
</td></tr>
<tr><td><code id="gof_+3A_nboot">nboot</code></td>
<td>
<p>an integer specifying the number of bootstrap rounds to be performed.</p>
</td></tr>
<tr><td><code id="gof_+3A_plot">plot</code></td>
<td>
<p>a logical value indicating whether to print histogram of G-squared statistics for boostrap samples, only for <code>test = "boot"</code>. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_maxiter">maxiter</code></td>
<td>
<p>an integer specifying the maximum number of iterations allowed for the estimation process during each bootstrap iteration. The default is 100.</p>
</td></tr>
<tr><td><code id="gof_+3A_tol">tol</code></td>
<td>
<p>a numeric value specifying the convergence tolerance for each bootstrap iteration. The default is <code>1e-6</code>.</p>
</td></tr>
<tr><td><code id="gof_+3A_verbose">verbose</code></td>
<td>
<p>a logical value indicating whether to print progress updates on the number of bootstrapping rounds completed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the number of parameters (Df), loglikelihood, AIC, BIC, G-squared statistics, and the residual degree of freedom for each object.
If a statistical test is performed (using <code>test</code>), the result includes the corresponding p-value.
</p>


<h3>See Also</h3>

<p><a href="#topic+compare">compare</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
data &lt;- gss7677[gss7677$COHORT == "YOUNG", ]
stat2 &lt;- slca(status(2) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))
stat3 &lt;- slca(status(3) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))
stat4 &lt;- slca(status(4) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = data, control = list(verbose = FALSE))

gof(stat2, stat3, stat4)
gof(stat2, stat3, stat4, test = "chisq")

gof(stat2, stat3, stat4, test = "boot")


compare(stat3, stat4)
compare(stat3, stat4, test = "chisq")

compare(stat3, stat4, test = "boot")

</code></pre>

<hr>
<h2 id='gss7677'>GSS 1976-1977 Data on Social Status and Tolerance towards Minorities</h2><span id='topic+gss7677'></span>

<h3>Description</h3>

<p>This dataset contains responses from the General Social Survey (GSS) for the years 1976 and 1977, focusing on social status and tolerance towards minorities.
The dataset can be used to replicate the analyses conducted in McCutcheon (1985) and Bakk et al. (2014). <br />
It includes covariates such as interview year, age, sex, race, education level, and income. Social status-related variables include father's occupation and education level, as well as mother's education level. Tolerance towards minorities is measured by agreement with three questions: (1) allowing public speaking, (2) allowing teaching, and (3) allowing literature publication.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gss7677
</code></pre>


<h3>Format</h3>

<p>A data frame with 2942 rows and 14 variables:
</p>

<dl>
<dt><code>YEAR</code></dt><dd><p>Interview year (1976, 1977).</p>
</dd>
<dt><code>COHORT</code></dt><dd><p>Respondent's age cohort.<br /> Levels: (1) <code>YOUNG</code>, (2) <code>YOUNG-MIDDLE</code>, (4) <code>MIDDLE</code>, (5) <code>OLD</code>.</p>
</dd>
<dt><code>SEX</code></dt><dd><p>Respondent's sex.<br /> Levels: (1) <code>MALE</code>, (2) <code>FEMALE</code>.</p>
</dd>
<dt><code>RACE</code></dt><dd><p>Respondent's race.<br /> Levels: (1) <code>WHITE</code>, (2) <code>BLACK</code>, (3) <code>OTHER</code>.</p>
</dd>
<dt><code>DEGREE</code></dt><dd><p>Respondent's education level.<br /> Levels: (1) <code>LT HS</code>, (2) <code>HIGH-SCH</code>, (3) <code>HIGHER</code>.</p>
</dd>
<dt><code>REALRINC</code></dt><dd><p>Respondent's income.</p>
</dd>
<dt><code>PAPRES</code></dt><dd><p>Father's occupational prestige.<br /> Levels: (1) <code>LOW</code>, (2) <code>MEDIUM</code>, (3) <code>HIGH</code>.</p>
</dd>
<dt><code>PADEG</code></dt><dd><p>Father's education level.<br /> Levels: (1) <code>LT HS</code>, (2) <code>HIGH-SCH</code>, (3) <code>COLLEGE</code>, (4) <code>BACHELOR</code>, (5) <code>GRADUATE</code>.</p>
</dd>
<dt><code>MADEG</code></dt><dd><p>Mother's education level.<br /> Levels: (1) <code>LT HS</code>, (2) <code>HIGH-SCH</code>, (3) <code>COLLEGE</code>, (4) <code>BACHELOR</code>, (5) <code>GRADUATE</code>.</p>
</dd>
<dt><code>TOLRAC</code></dt><dd><p>Tolerance towards racists.</p>
</dd>
<dt><code>TOLCOM</code></dt><dd><p>Tolerance towards communists.</p>
</dd>
<dt><code>TOLHOMO</code></dt><dd><p>Tolerance towards homosexuals.</p>
</dd>
<dt><code>TOLATH</code></dt><dd><p>Tolerance towards atheists.</p>
</dd>
<dt><code>TOLMIL</code></dt><dd><p>Tolerance towards militarists.</p>
</dd>
</dl>



<h3>Source</h3>

<p>General Social Survey (GSS) 1976, 1977
</p>


<h3>References</h3>

<p>Bakk Z, Kuha J. (2021) Relating latent class membership to external variables: An overview. Br J Math Stat Psychol. 74(2):340-362.
</p>
<p>McCutcheon, A. L. (1985). A latent class analysis of tolerance for nonconformity in the American public. Public Opinion Quarterly, 49, 474â€“488.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
gss500 &lt;- gss7677[1:500,] %&gt;% na.omit
model_stat &lt;- slca(status(3) ~ PAPRES + PADEG + MADEG) %&gt;%
   estimate(data = gss500, control = list(em.tol = 1e-6))
summary(model_stat)
param(model_stat)

model_tol &lt;- slca(tol(4) ~ TOLRAC + TOLCOM + TOLHOMO + TOLATH + TOLMIL) %&gt;%
   estimate(data = gss500, control = list(em.tol = 1e-6))
summary(model_tol)
param(model_tol)

model_lta &lt;- slca(
   status(3) ~ PAPRES + PADEG + MADEG,
   tol(4) ~ TOLRAC + TOLCOM + TOLHOMO + TOLATH + TOLMIL,
   status ~ tol
) %&gt;% estimate(data = gss500, control = list(em.tol = 1e-6))
summary(model_lta)
param(model_lta)


regress(model_lta, status ~ SEX, gss500)
regress(model_lta, status ~ SEX, gss500, method = "BCH")
regress(model_lta, status ~ SEX, gss500, method = "ML")

</code></pre>

<hr>
<h2 id='nlsy_jlcpa'>JLCPA Model Estimated with NLSY97 Data</h2><span id='topic+nlsy_jlcpa'></span><span id='topic+nlsy_jlta'></span>

<h3>Description</h3>

<p>An <code>slca</code> model estimated using the NLSY97 dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlsy_jlcpa
</code></pre>


<h3>Format</h3>

<p>An <code>slcafit</code> object estimated for JLCPA model using <code>nlsy97</code> dataset.
</p>


<h3>References</h3>

<p>Bureau of Labor Statistics, U.S. Department of Labor. National Longitudinal Survey of Youth 1997 cohort, 1997-2017 (rounds 1-18). Produced and distributed by the Center for Human Resource Research (CHRR), The Ohio State University. Columbus, OH: 2019.
</p>
<p>Jeon, S., Seo, T. S., Anthony, J. C., &amp; Chung, H. (2022). Latent Class Analysis for Repeatedly Measured Multiple Latent Class Variables. Multivariate Behavioral Research, 57(2â€“3), 341â€“355.
</p>


<h3>See Also</h3>

<p><a href="#topic+reorder.slcafit">reorder.slcafit</a>
</p>

<hr>
<h2 id='nlsy97'>NLSY97 Substance Use Data</h2><span id='topic+nlsy97'></span>

<h3>Description</h3>

<p>This dataset contains substance use behavior data from the National Longitudinal Survey of Youth 1997 (NLSY97) for three years: 1998, 2003, and 2008.
The dataset focuses on youth born in 1984 and tracks three types of substance use behaviors: tobacco/cigarette smoking, alcohol drinking, and marijuana use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlsy97
</code></pre>


<h3>Format</h3>

<p>A data frame with 1004 rows and 38 columns:
</p>

<dl>
<dt><code>SEX</code></dt><dd><p>Respondent's sex</p>
</dd>
<dt><code>RACE</code></dt><dd><p>Respondent's race</p>
</dd>
<dt><code>ESMK_98</code>, <code>ESMK_03</code>, <code>ESMK_08</code></dt><dd><p>(Ever smoked) Ever smoked in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>FSMK_98</code>, <code>FSMK_03</code>, <code>FSMK_08</code></dt><dd><p>(Frequent smoke) Monthly smoking in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>DSMK_98</code>, <code>DSMK_03</code>, <code>DSMK_08</code></dt><dd><p>(Daily smoke) Daily smoking in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>HSMK_98</code>, <code>HSMK_03</code>, <code>HSMK_08</code></dt><dd><p>(Heavy smoke) 10+ cigarettes per day in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>EDRK_98</code>, <code>EDRK_03</code>, <code>EDRK_08</code></dt><dd><p>(Ever drunk) Ever drunk in 1998, 2003, and 2008? (0: No, 1: Yes)</p>
</dd>
<dt><code>CDRK_98</code>, <code>CDRK_03</code>, <code>CDRK_08</code></dt><dd><p>(Current drinker) Monthly drinking in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>WDRK_98</code>, <code>WDRK_03</code>, <code>WDRK_08</code></dt><dd><p>(Weakly drinker) 5+ days drinking in a month in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>BDRK_98</code>, <code>BDRK_03</code>, <code>BDRK_08</code></dt><dd><p>(Binge drinker) 5+ drinks on the same day at least one time in the last 30 day (0: No, 1: Yes)</p>
</dd>
<dt><code>EMRJ_98</code>, <code>EMRJ_03</code>, <code>EMRJ_08</code></dt><dd><p>(Ever marijuana used) Have you ever used marijuana in 1998, 2003, and 2008? (0: No, 1: Yes)</p>
</dd>
<dt><code>CMRJ_98</code>, <code>CMRJ_03</code>, <code>CMRJ_08</code></dt><dd><p>(Current marijuana user) Monthly marijuana use in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>OMRJ_98</code>, <code>OMRJ_03</code>, <code>OMRJ_08</code></dt><dd><p>(Occasional marijuana user) 10+ days marijuana use in a month in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
<dt><code>SMRJ_98</code>, <code>SMRJ_03</code>, <code>SMRJ_08</code></dt><dd><p>(School/work marijuana user) Marijuana use before/during school or work in 1998, 2003, and 2008 (0: No, 1: Yes)</p>
</dd>
</dl>



<h3>Source</h3>

<p>National Longitudinal Survey of Youth 1997 (NLSY97)
</p>


<h3>References</h3>

<p>Bureau of Labor Statistics, U.S. Department of Labor. National Longitudinal Survey of Youth 1997 cohort, 1997-2017 (rounds 1-18). Produced and distributed by the Center for Human Resource Research (CHRR), The Ohio State University. Columbus, OH: 2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
nlsy_smoke &lt;- slca(SMK_98(3) ~ ESMK_98 + FSMK_98 + DSMK_98 + HSMK_98) %&gt;%
   estimate(data = nlsy97, control = list(verbose = FALSE))
summary(nlsy_smoke)


# JLCA
model_jlca &lt;- slca(
   SMK_98(3) ~ ESMK_98 + FSMK_98 + DSMK_98 + HSMK_98,
   DRK_98(3) ~ EDRK_98 + CDRK_98 + WDRK_98 + BDRK_98,
   MRJ_98(3) ~ EMRJ_98 + CMRJ_98 + OMRJ_98 + SMRJ_98,
   SUB_98(4) ~ SMK_98 + DRK_98 + MRJ_98
) %&gt;% estimate(data = nlsy97, control = list(verbose = FALSE))
summary(model_jlca)
param(model_jlca)

# JLCPA
nlsy_jlcpa &lt;- slca(
   SMK_98(3) ~ ESMK_98 + FSMK_98 + DSMK_98 + HSMK_98,
   DRK_98(3) ~ EDRK_98 + CDRK_98 + WDRK_98 + BDRK_98,
   MRJ_98(3) ~ EMRJ_98 + CMRJ_98 + OMRJ_98 + SMRJ_98,
   SUB_98(5) ~ SMK_98 + DRK_98 + MRJ_98,
   SMK_03(3) ~ ESMK_03 + FSMK_03 + DSMK_03 + HSMK_03,
   DRK_03(3) ~ EDRK_03 + CDRK_03 + WDRK_03 + BDRK_03,
   MRJ_03(3) ~ EMRJ_03 + CMRJ_03 + OMRJ_03 + SMRJ_03,
   SUB_03(5) ~ SMK_03 + DRK_03 + MRJ_03,
   SMK_08(3) ~ ESMK_08 + FSMK_08 + DSMK_08 + HSMK_08,
   DRK_08(3) ~ EDRK_08 + CDRK_08 + WDRK_08 + BDRK_08,
   MRJ_08(3) ~ EMRJ_08 + CMRJ_08 + OMRJ_08 + SMRJ_08,
   SUB_08(5) ~ SMK_08 + DRK_08 + MRJ_08,
   PROF(4) ~ SUB_98 + SUB_03 + SUB_08,
   constraints = list(
      c("SMK_98", "SMK_03", "SMK_08"),
      c("DRK_98", "DRK_03", "DRK_08"),
      c("MRJ_98", "MRJ_03", "MRJ_08"),
      c("SUB_98 ~ SMK_98", "SUB_03 ~ SMK_03", "SUB_08 ~ SMK_08"),
      c("SUB_98 ~ DRK_98", "SUB_03 ~ DRK_03", "SUB_08 ~ DRK_08"),
      c("SUB_98 ~ MRJ_98", "SUB_03 ~ MRJ_03", "SUB_08 ~ MRJ_08")
   )
) %&gt;% estimate(nlsy97, control = list(verbose = FALSE))

</code></pre>

<hr>
<h2 id='param'>Print Estimated Parameters of an <code>slcafit</code> Object</h2><span id='topic+param'></span><span id='topic+param.slcafit'></span>

<h3>Description</h3>

<p>Prints the estimated parameters of an <code>slca</code> model using an <code>slcafit</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param(object, ...)

## S3 method for class 'slcafit'
param(
   object, type = c("probs", "logit"),
   se = FALSE, index = FALSE, ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="param_+3A_object">object</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="param_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="param_+3A_type">type</code></td>
<td>
<p>a character string specifying the format in which the estimated parameters should be displayed. The options are <code>"probs"</code> for probability format or <code>"logit"</code> for log-odds (logit) format. The default setting is <code>"probs"</code>.</p>
</td></tr>
<tr><td><code id="param_+3A_se">se</code></td>
<td>
<p>a logical value indicating whether to display standard errors (<code>TRUE</code>) or parameter estimates (<code>FALSE</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="param_+3A_index">index</code></td>
<td>
<p>a logical value indicating whether to include (<code>TRUE</code>) or exclude (<code>FALSE</code>) the indices of the estimated parameters in the output. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing the requested estimated parameters or their standard errors (if <code>se = TRUE</code>). The components of the list include:
</p>
<table role = "presentation">
<tr><td><code>pi</code></td>
<td>
<p>Membership probabilities for the root latent variable.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Conditional probabilities between latent class variables, represented with uppercase letters to account for measurement invariance.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>Item response probabilities for each measurement model, represented with lowercase letters to account for measurement invariance.</p>
</td></tr>
</table>

<hr>
<h2 id='predict.slcafit'>Model Predictions for Estimated <code>slca</code> Object</h2><span id='topic+predict.slcafit'></span>

<h3>Description</h3>

<p>Provides predicted class memberships or posterior probabilities for new data based on a fitted <code>slca</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slcafit'
predict(object, newdata, type = c("class", "posterior"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.slcafit_+3A_object">object</code></td>
<td>
<p>An object of class <code>slcafit</code>, representing a fitted <code>slca</code> model.</p>
</td></tr>
<tr><td><code id="predict.slcafit_+3A_newdata">newdata</code></td>
<td>
<p>A <code>data.frame</code> containing the same variables as those used to estimate the <code>object</code>.</p>
</td></tr>
<tr><td><code id="predict.slcafit_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of prediction. Use <code>"class"</code> to obtain the predicted class membership for each observation and latent class variable, or <code>"posterior"</code> to retrieve posterior probabilities for each class. The default is <code>"class"</code>.</p>
</td></tr>
<tr><td><code id="predict.slcafit_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> or <code>list</code> depending on the <code>type</code>:
</p>

<ul>
<li><p> For <code>type = "class"</code>, a <code>data.frame</code> is returned where rows represent observations and columns correspond to latent class variables.
</p>
</li>
<li><p> For <code>type = "posterior"</code>, a <code>list</code> is returned containing <code>data.frame</code>s with posterior probabilities for each latent class variable.
</p>
</li></ul>


<hr>
<h2 id='regress'>Regress Exogenous Variables on Latent Variables</h2><span id='topic+regress'></span><span id='topic+regress.slcafit'></span>

<h3>Description</h3>

<p>Performs regression analysis to examine the influence of exogenous (external) variables on latent class variables in an estimated <code>slca</code> model. The function uses logistic regression with a three-step approach to account for measurement error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regress(object, ...)

## S3 method for class 'slcafit'
regress(
   object, formula, data = parent.frame(),
   imputation = c("modal", "prob"),
   method = c("naive", "BCH", "ML"), ...
)

## S3 method for class 'slcafit'
regress(
  object,
  formula,
  data = parent.frame(),
  imputation = c("modal", "prob"),
  method = c("naive", "BCH", "ML"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regress_+3A_object">object</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="regress_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="regress_+3A_formula">formula</code></td>
<td>
<p>a formula specifying the regression model, including both latent class variables (from the estimated model) and exogenous variables.</p>
</td></tr>
<tr><td><code id="regress_+3A_data">data</code></td>
<td>
<p>an optional <code>data.frame</code> containing the exogenous variables of interest. If omitted, the variables are taken from the parent environment.</p>
</td></tr>
<tr><td><code id="regress_+3A_imputation">imputation</code></td>
<td>
<p>a character string specifying the imputation method for latent class assignment. Options include:
</p>

<ul>
<li> <p><code>"modal"</code>: Assigns each individual to the latent class with the highest posterior probability.
</p>
</li>
<li> <p><code>"prob"</code>: Assigns classes probabilistically based on the posterior probability distribution.
</p>
</li></ul>
</td></tr>
<tr><td><code id="regress_+3A_method">method</code></td>
<td>
<p>a character string specifying the method to adjust for bias in the three-step approach. Options include:
</p>

<ul>
<li> <p><code>"naive"</code>: A simple approach without correction for classification error.
</p>
</li>
<li> <p><code>"BCH"</code>: The bias-adjusted Bolck, Croon, and Hagenaars method.
</p>
</li>
<li> <p><code>"ML"</code>: A maximum likelihood approach that accounts for classification error.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of class <code>reg.slca</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>A matrix of regression coefficients representing the odds ratios for each latent class against the baseline class (the last class).</p>
</td></tr>
<tr><td><code>std.err</code></td>
<td>
<p>A matrix of standard errors corresponding to the regression coefficients.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>The variance-covariance matrix of the regression coefficients.</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>The dimensions of the coefficients matrix.</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>The log-likelihood of the regression model.</p>
</td></tr>
</table>
<p>The <code>summary</code> function can be used to display the regression coefficients, standard errors, Wald statistics, and p-values.
</p>


<h3>References</h3>

<p>Vermunt, J. K. (2010). Latent Class Modeling with Covariates: Two Improved Three-Step Approaches. Political Analysis, 18(4), 450â€“469. http://www.jstor.org/stable/25792024
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
names(nlsy97)
nlsy_jlcpa %&gt;% regress(SMK_98 ~ SEX, nlsy97)

nlsy_jlcpa %&gt;% regress(PROF ~ SEX, nlsy97)

</code></pre>

<hr>
<h2 id='reorder.slcafit'>Reorder Latent Class Membership of Latent Class Variables</h2><span id='topic+reorder.slcafit'></span>

<h3>Description</h3>

<p>Reorders the latent class membership for specified latent class variables in an <code>slcafit</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slcafit'
reorder(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reorder.slcafit_+3A_x">x</code></td>
<td>
<p>an object of class <code>slcafit</code>.</p>
</td></tr>
<tr><td><code id="reorder.slcafit_+3A_...">...</code></td>
<td>
<p>additional arguments specifying the new order for the latent class variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified <code>slcafit</code> object with the latent classes reordered according to the specified order.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(magrittr)
nlsy_jlcpa %&gt;% param

# Reorder the RHO parameters as ascending order
reordered1 &lt;- nlsy_jlcpa %&gt;%
   reorder(SMK_98 = c(1, 3, 2),
           DRK_98 = c(3, 2, 1),
           MRJ_98 = c(3, 1, 2))
reordered1 %&gt;% param
# Label class1: nonuse
#       class2: lifetime use
#       class3: current use

# Reorder the TAU parameters for joint classes as ascending order
reordered2 &lt;- reordered1 %&gt;%
   reorder(SUB_98 = c(3, 4, 5, 1, 2))
reordered2 %&gt;% param
# Label class1: nonuse
#       class2: heavy drinking only
#       class3: not heavy use
#       class4: heavy drinking &amp; smoking
#       class5: heavy use

# Reorder the TAU paramters for profiles as ascending order
reordered3 &lt;- reordered2 %&gt;%
   reorder(PROF = c(4, 1, 3, 2))
reordered3 %&gt;% param
# Label class1: nonuse stayer
#       class2: heavy drinking advancer
#       class3: heavy drk &amp; smk advancer
#       class4: heavy use advancer
</code></pre>

<hr>
<h2 id='simulate.slca'>Simulate Data from an <code>slca</code> Model</h2><span id='topic+simulate.slca'></span>

<h3>Description</h3>

<p>Simulates data based on a specified <code>slca</code> model. If the model parameters are not already estimated, they can either be provided by the user or generated randomly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slca'
simulate(object, nsim = 500, seed = NULL, parm, nlevel, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate.slca_+3A_object">object</code></td>
<td>
<p>an <code>slca</code> object representing the model from which data will be simulated.</p>
</td></tr>
<tr><td><code id="simulate.slca_+3A_nsim">nsim</code></td>
<td>
<p>an integer specifying the number of response observations to simulate. The default is 500.</p>
</td></tr>
<tr><td><code id="simulate.slca_+3A_seed">seed</code></td>
<td>
<p>an integer specifying the random seed for reproducibility. If not provided, results will vary across runs.</p>
</td></tr>
<tr><td><code id="simulate.slca_+3A_parm">parm</code></td>
<td>
<p>a user-specified set of parameters to guide the simulation. This is required if the model has not been previously estimated.</p>
</td></tr>
<tr><td><code id="simulate.slca_+3A_nlevel">nlevel</code></td>
<td>
<p>an integer or integer vector specifying the number of levels for each manifest item in the model. If a single integer is provided, all manifest items will have the same number of levels. The default is 2.</p>
</td></tr>
<tr><td><code id="simulate.slca_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>class</code></td>
<td>
<p>A <code>data.frame</code> containing the assigned latent class for each individual across all latent class variables.</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>A <code>data.frame</code> containing the simulated manifest item responses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- slca(lc1[3] ~ x1 + x2 + x3 + x4 + x5,
              lc2[4] ~ y1 + y2 + y3 + y4 + y5)
sim &lt;- simulate(m1, 1000)
sapply(sim$class, table)

# simulate data with defined number of levels of manifest items
m2 &lt;- slca(lc1[3] ~ x1 + x2 + x3 + x4)
sim &lt;- simulate(m2, nlevel = c(3, 3, 3, 3))
d &lt;- sim$response
sapply(d, table)

sim &lt;- simulate(m2, nlevel = c(x1 = 2, x3 = 3, x4 = 4, x5 = 5))
d &lt;- sim$response
sapply(d, table)

# simulate data with user-defined parameters
pi &lt;- rep(1 / 3, 3)
rho &lt;- c(.9, .1, .9, .1, .9, .1, .9, .1,
         .9, .1, .9, .1, .1, .9, .1, .9,
         .1, .9, .1, .9, .1, .9, .1, .9)
par &lt;- c(pi, rho)
m3 &lt;- slca(lc[3] ~ y1 + y2 + y3 + y4)
sim &lt;- simulate(m3, parm = par)
mf &lt;- estimate(m3, sim$response)
param(mf)
</code></pre>

<hr>
<h2 id='slca'>Construct Structural Latent Class Model</h2><span id='topic+slca'></span>

<h3>Description</h3>

<p>Constructs a latent structure with multiple latent class variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slca(formula = NULL, ..., constraints = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slca_+3A_formula">formula</code></td>
<td>
<p>a formula specifying the latent structure. Detailed model specifications are provided under 'Details'.</p>
</td></tr>
<tr><td><code id="slca_+3A_...">...</code></td>
<td>
<p>additional formulae for defining the model structure.</p>
</td></tr>
<tr><td><code id="slca_+3A_constraints">constraints</code></td>
<td>
<p>a list of constraints to enforce measurement invariance. Detailed explanations of applying constraints are available under 'Details'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <strong><code>formula</code></strong> can be categorized into three types, each serving a distinct purpose:
</p>

<ol>
<li> <p><strong>Defining Latent Class Variables with Manifest Indicators</strong>:
Specify the relationship between a latent class variable and its manifest indicators. The latent class variable is on the left-hand side (lhs), denoted with square brackets <code>[]</code> or parentheses <code>()</code> to indicate the number of classes, and manifest indicators are listed on the right-hand side (rhs). For example:
</p>
<pre>
LC1[k] ~ x1 + x2 + x3
LC2[k] ~ y1 + y2 + y3
LC3(k) ~ z1 + z2 + z3
   </pre>
<p>Here, <code>k</code> denotes the number of latent classes for the variable.
</p>
</li>
<li> <p><strong>Relating Latent Class Variables to Each Other</strong>:
Define relationships where one latent class variable influences another. For example:
</p>
<pre>
LC2 ~ LC1
   </pre>
<p>This formula implies that <code>LC2</code> is conditionally dependent on <code>LC1</code>.
</p>
</li>
<li> <p><strong>Defining Higher-Level Latent Class Variables</strong>:
Specify relationships where a latent class variable is measured by other latent class variables instead of manifest indicators. For example:
</p>
<pre>
P[k] ~ LC1 + LC2 + LC3
   </pre>
<p>This indicates that the latent variable <code>P</code> is measured by the latent class variables <code>LC1</code>, <code>LC2</code>, and <code>LC3</code>.
</p>
</li></ol>

<p>In all formulas, variables on the lhs influence those on the rhs.
</p>
<p>The <code>constraints</code> argument enforces specific conditions to ensure precise inference, such as measurement invariance. This is particularly useful for longitudinal analysis (eg. LTA or LCPA), where consistent meanings of latent classes across time are essential.
</p>

<ol>
<li> <p><strong>Measurement Invariance for the Measurement Model</strong>:
Ensures probabilities associated with latent class variables remain consistent. For example:
</p>
<pre>
c("LC1", "LC2", "LC3")
   </pre>
<p>This ensures that <code>LC1</code>, <code>LC2</code>, and <code>LC3</code> have semantically consistent measurement probabilities.
</p>
</li></ol>

<p>' 2. <strong>Measurement Invariance for the Structural Model</strong>:
Applies constraints to ensure consistent interpretations of transition probabilities between latent class variables. For example:
</p>
<pre>
c("P ~ LC1", "P -&gt; LC2")
   </pre>
<p>This ensures that the transitions from <code>P</code> to <code>LC1</code> and <code>P</code> to <code>LC2</code> are consistent.
</p>


<h3>Value</h3>

<p>An object of class <code>slca</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>tree</code></td>
<td>
<p>A <code>data.frame</code> describing the parent-child relationships among latent class and manifest variables.</p>
</td></tr>
<tr><td><code>latent</code></td>
<td>
<p>A <code>data.frame</code> listing all latent class variables with details such as the number of classes.</p>
</td></tr>
<tr><td><code>measure</code></td>
<td>
<p>A <code>data.frame</code> describing the measurement model.</p>
</td></tr>
<tr><td><code>struct</code></td>
<td>
<p>A <code>data.frame</code> detailing the structural model.</p>
</td></tr>
</table>
<p>The printed model description is divided into four parts:
</p>

<ol>
<li> <p><strong>Latent variables</strong>: Lists the latent class variables and the number of classes for each variable. The root variable is marked with an asterisk (<code>*</code>).
</p>
</li>
<li> <p><strong>Measurement model</strong>: Displays manifest indicators for each latent class variable and any applied measurement constraints (lowercase letters indicate consistency).
</p>
</li>
<li> <p><strong>Structural model</strong>: Describes the conditional relationships between latent class variables.
</p>
</li>
<li> <p><strong>Dependency constraints</strong>: Outlines constraints applied to conditional dependencies, where uppercase letters represent consistent dependency structures.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># Standard LCA
slca(lc[3] ~ y1 + y2 + y3 + y4)
# Latent transition analysis (LTA)
slca(lx[3] ~ x1 + x2 + x3 + x4,
     ly[2] ~ y1 + y2 + y3 + y4,
     lx ~ ly)
# LTA with measurement invariance
slca(l1[3] ~ y11 + y21 + y31 + y41,
     l2[3] ~ y12 + y22 + y32 + y42,
     l1 ~ l2, constraints = c("l1", "l2"))
# Joint latent class analysis
slca(lx[2] ~ x1 + x2 + x3 + x4,
     ly[3] ~ y1 + y2 + y3 + y4,
     lz[2] ~ z1 + z2 + z3 + z4,
     jc[3] ~ lx + ly + lz)
# Latent class profile analysis (with measurement invariance)
slca(l1[3] ~ x1 + x2 + x3 + x4,
     l2[3] ~ y1 + y2 + y3 + y4,
     l3[3] ~ z1 + z2 + z3 + z4,
     pf[4] ~ l1 + l2 + l3,
     constraints = c("l1", "l2", "l3"))
</code></pre>

<hr>
<h2 id='slcaControl'>Control Parameters for <code>slca</code> Estimation</h2><span id='topic+slcaControl'></span>

<h3>Description</h3>

<p>Specifies control parameters for estimating <code>slca</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slcaControl(
  em.iterlim = 5000,
  em.tol = 1e-08,
  nlm.iterlim = 1000,
  nlm.tol = 1e-10,
  init.param = NULL,
  nrep = 1,
  test.iter = 500,
  na.rm = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slcaControl_+3A_em.iterlim">em.iterlim</code></td>
<td>
<p>an integer specifying the maximum number of iterations allowed for the EM algorithm. The default is <code>5000</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_em.tol">em.tol</code></td>
<td>
<p>a numeric value setting the tolerance for convergence of the EM algorithm. The default is <code>1e-8</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_nlm.iterlim">nlm.iterlim</code></td>
<td>
<p>an integer specifying the maximum number of iterations allowed when using the <code>nlm</code> function for estimation. The default is <code>1000</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_nlm.tol">nlm.tol</code></td>
<td>
<p>a numeric value setting the tolerance for convergence of the <code>nlm</code> function. The default is <code>1e-10</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_init.param">init.param</code></td>
<td>
<p>a numeric vector specifying the initial parameter values for estimation.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_nrep">nrep</code></td>
<td>
<p>an integer specifying the number of estimation trials. The default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_test.iter">test.iter</code></td>
<td>
<p>an integer specifying the maximum number of iterations allowed for parameter testing. The default is <code>500</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether to remove observations containing missing values (<code>NA</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="slcaControl_+3A_verbose">verbose</code></td>
<td>
<p>a logical value indicating whether to display progress updates during the estimation process. The default is <code>FALSE</code>.
</p>
<p>A <code>list</code> containing control parameters for <code>slca</code> estimation, including the specified iteration limits, tolerances, and additional options.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+slca">slca</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
