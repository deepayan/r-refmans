<!DOCTYPE html><html><head><title>Help for package elo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {elo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#elo'><p>The Elo Package</p></a></li>
<li><a href='#auc.elo'><p>Calculate AUC on an <code>elo.run</code> object</p></a></li>
<li><a href='#elo.calc'><p>Post-update Elo values</p></a></li>
<li><a href='#elo.colley'><p>Compute a Colley matrix model for a matchup.</p></a></li>
<li><a href='#elo.glm'><p>Compute a (usually logistic) regression model for a series of matches.</p></a></li>
<li><a href='#elo.markovchain'><p>Compute a Markov chain model for a series of matches.</p></a></li>
<li><a href='#elo.model.frame'><p>Interpret formulas in <code>elo</code> functions</p></a></li>
<li><a href='#elo.mov'><p>Create a &quot;margin of victory&quot; column</p></a></li>
<li><a href='#elo.mse'><p>Calculate the mean square error</p></a></li>
<li><a href='#elo.prob'><p>Elo probability</p></a></li>
<li><a href='#elo.run'><p>Calculate running Elos for a series of matches.</p></a></li>
<li><a href='#elo.run.helpers'><p>Helper functions for <code>elo.run</code></p></a></li>
<li><a href='#elo.run.multiteam'><p>Calculate running Elos for a series of multi-team matches.</p></a></li>
<li><a href='#elo.update'><p>Elo updates</p></a></li>
<li><a href='#elo.winpct'><p>Compute a (usually logistic) regression based on win percentage for a series of matches.</p></a></li>
<li><a href='#favored.elo'><p>Classify teams that are favored to win</p></a></li>
<li><a href='#fitted.elo'><p>Extract model values</p></a></li>
<li><a href='#players'><p>Details on <code>elo</code> formulas and the specials therein</p></a></li>
<li><a href='#predict.elo'><p>Make Predictions on an <code>elo</code> Object</p></a></li>
<li><a href='#rank.teams'><p>Rank teams</p></a></li>
<li><a href='#score'><p>Create a 1/0/0.5 win &quot;indicator&quot;</p></a></li>
<li><a href='#summary.elo'><p>Summarize an <code>elo</code> Object</p></a></li>
<li><a href='#tournament'><p><code>tournament</code>: Mock data for examples</p></a></li>
<li><a href='#tournament.multiteam'><p><code>tournament.multiteam</code>: Mock data for examples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.0.2</td>
</tr>
<tr>
<td>Title:</td>
<td>Ranking Teams by Elo Rating and Comparable Methods</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-22</td>
</tr>
<tr>
<td>Description:</td>
<td>A flexible framework for calculating Elo ratings and resulting
    rankings of any two-team-per-matchup system (chess, sports leagues, 'Go',
    etc.). This implementation is capable of evaluating a variety of matchups,
    Elo rating updates, and win probabilities, all based on the basic Elo
    rating system. It also includes methods to benchmark performance,
    including logistic regression and Markov chain models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, pROC</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/eheinzen/elo">https://github.com/eheinzen/elo</a>,
<a href="https://cran.r-project.org/package=elo">https://cran.r-project.org/package=elo</a>,
<a href="https://eheinzen.github.io/elo/">https://eheinzen.github.io/elo/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/eheinzen/elo/issues">https://github.com/eheinzen/elo/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-22 17:04:50 UTC; m144326</td>
</tr>
<tr>
<td>Author:</td>
<td>Ethan Heinzen [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ethan Heinzen &lt;heinzen.ethan@mayo.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 16:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='elo'>The Elo Package</h2><span id='topic+elo'></span><span id='topic+elo-package'></span>

<h3>Description</h3>

<p>An implementation of Elo ratings for general use in 'R'.
</p>


<h3>Functions</h3>

<p>Listed below are the most useful functions available in <code>elo</code>:
</p>
<p><code><a href="#topic+elo.prob">elo.prob</a></code>: Calculate the probability that team A beats team B.
</p>
<p><code><a href="#topic+elo.update">elo.update</a></code>: Calculate the update value for a given Elo matchup.
</p>
<p><code><a href="#topic+elo.calc">elo.calc</a></code>: Calculate post-update Elo values.
</p>
<p><code><a href="#topic+elo.run">elo.run</a></code>: Calculate Elos for a series of matches.
</p>
<p><code><a href="#topic+score">score</a></code>: Create a 1/0/0.5 win &quot;indicator&quot; based on two teams' scores.
</p>


<h3>Data</h3>

<p><code><a href="#topic+tournament">tournament</a></code>: Mock data for examples.
</p>


<h3>References</h3>

<p>Elo, A. E. 1978. The Rating of Chess Players, Past and Present. New York: Arco.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(elo)
</code></pre>

<hr>
<h2 id='auc.elo'>Calculate AUC on an <code>elo.run</code> object</h2><span id='topic+auc.elo'></span><span id='topic+auc.elo.run'></span><span id='topic+auc.elo.glm'></span><span id='topic+auc.elo.running'></span><span id='topic+auc.elo.markovchain'></span><span id='topic+auc.elo.winpct'></span><span id='topic+auc.elo.colley'></span>

<h3>Description</h3>

<p>Calculate AUC on an <code>elo.run</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elo.run'
auc(object, ..., subset = TRUE)

## S3 method for class 'elo.glm'
auc(object, ..., subset = TRUE)

## S3 method for class 'elo.running'
auc(object, running = TRUE, discard.skipped = FALSE, ..., subset = TRUE)

## S3 method for class 'elo.markovchain'
auc(object, ..., subset = TRUE)

## S3 method for class 'elo.winpct'
auc(object, ..., subset = TRUE)

## S3 method for class 'elo.colley'
auc(object, ..., subset = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auc.elo_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+elo.run">elo.run</a></code>.</p>
</td></tr>
<tr><td><code id="auc.elo_+3A_...">...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td></tr>
<tr><td><code id="auc.elo_+3A_subset">subset</code></td>
<td>
<p>(optional) A vector of indices on which to calculate</p>
</td></tr>
<tr><td><code id="auc.elo_+3A_running">running</code></td>
<td>
<p>logical, denoting whether to use the running predicted values.</p>
</td></tr>
<tr><td><code id="auc.elo_+3A_discard.skipped">discard.skipped</code></td>
<td>
<p>Logical, denoting whether to ignore the skipped observations in the calculation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The AUC of the predicted Elo probabilities and the actual win results.
</p>


<h3>References</h3>

<p>Adapted from code here:
<a href="https://stat.ethz.ch/pipermail/r-help/2005-September/079872.html">https://stat.ethz.ch/pipermail/r-help/2005-September/079872.html</a>
</p>


<h3>See Also</h3>

<p><code>pROC::<a href="pROC.html#topic+auc">auc</a></code>, <code><a href="#topic+elo.run">elo.run</a></code>.
</p>

<hr>
<h2 id='elo.calc'>Post-update Elo values</h2><span id='topic+elo.calc'></span><span id='topic+elo.calc.default'></span><span id='topic+elo.calc.formula'></span>

<h3>Description</h3>

<p>Calculate post-update Elo values. This is vectorized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.calc(wins.A, ...)

## Default S3 method:
elo.calc(wins.A, elo.A, elo.B, k, ..., adjust.A = 0, adjust.B = 0)

## S3 method for class 'formula'
elo.calc(formula, data, na.action, subset, k = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.calc_+3A_wins.a">wins.A</code></td>
<td>
<p>Numeric vector of wins by team A.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_...">...</code></td>
<td>
<p>Other arguments (not in use at this time).</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_elo.a">elo.A</code>, <code id="elo.calc_+3A_elo.b">elo.B</code></td>
<td>
<p>Numeric vectors of elo scores.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_k">k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_adjust.a">adjust.A</code>, <code id="elo.calc_+3A_adjust.b">adjust.B</code></td>
<td>
<p>Numeric vectors to adjust <code>elo.A</code> and <code>elo.B</code> by.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.calc_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with two columns, giving the new Elo values after each update.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo.prob">elo.prob</a></code>, <code><a href="#topic+elo.update">elo.update</a></code>,
<code>elo.model.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.calc(c(1, 0), c(1500, 1500), c(1500, 1600), k = 20)

dat &lt;- data.frame(wins.A = c(1, 0), elo.A = c(1500, 1500),
                  elo.B = c(1500, 1600), k = c(20, 20))
elo.calc(wins.A ~ elo.A + elo.B + k(k), data = dat)
</code></pre>

<hr>
<h2 id='elo.colley'>Compute a Colley matrix model for a matchup.</h2><span id='topic+elo.colley'></span>

<h3>Description</h3>

<p>Compute a Colley matrix model for a matchup.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.colley(
  formula,
  data,
  family = "binomial",
  weights,
  na.action,
  subset,
  k = 1,
  ...,
  running = FALSE,
  skip = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.colley_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_family">family</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_weights">weights</code></td>
<td>
<p>A vector of weights. Note that these weights are used in the Colley matrix creation,
but not the regression.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_k">k</code></td>
<td>
<p>The fraction of a win to be assigned to the winning team. See &quot;details&quot;.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_...">...</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_running">running</code></td>
<td>
<p>Logical, denoting whether to calculate &quot;running&quot; projected probabilities. If true, a model is fit for
group 1 on its own to predict group 2, then groups 1 and 2 to predict 3, then groups 1 through 3 to predict 4, etc.
Groups are determined in <code>formula</code>. Omitting a group term re-runs a glm model to predict each
observation (a potentially time-consuming operation!)</p>
</td></tr>
<tr><td><code id="elo.colley_+3A_skip">skip</code></td>
<td>
<p>Integer, denoting how many groups to skip before fitting the running models. This is helpful if
groups are small, where glm would have trouble converging for the first few groups. The predicted values are then
set to 0.5 for the skipped groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the vignette for details on this method.
The differences in assigned scores (from the coefficients of the Colley matrix regression) are fed into a logistic
regression model to predict wins or (usually) a linear model to predict margin of victory.
In this setting, 'k' indicates the fraction of a win to be assigned to the winning team
(and the fraction of a loss to be assigned to the losing team); setting <code>k = 1</code> (the default)
emits the &quot;Bias Free&quot; ranking method presented by Colley.
It is also possible to adjust the regression by setting the second argument of
<code><a href="#topic+adjust">adjust</a>()</code>. As in <code><a href="#topic+elo.glm">elo.glm</a></code>,
the intercept represents the home-field advantage. Neutral fields can be indicated
using the <code><a href="#topic+neutral">neutral</a>()</code> function, which sets the intercept to 0.
</p>


<h3>References</h3>

<p>Colley W.N. Colley's Bias Free College Football Ranking Method: The Colley Matrix Explained. 2002.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+summary.elo.colley">summary.elo.colley</a></code>, <code><a href="#topic+score">score</a></code>,
<code><a href="#topic+mov">mov</a></code>, <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.colley(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  subset = points.Home != points.Visitor)
</code></pre>

<hr>
<h2 id='elo.glm'>Compute a (usually logistic) regression model for a series of matches.</h2><span id='topic+elo.glm'></span>

<h3>Description</h3>

<p>Compute a (usually logistic) regression model for a series of matches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.glm(
  formula,
  data,
  family = "binomial",
  weights,
  na.action,
  subset,
  ...,
  running = FALSE,
  skip = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.glm_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_family">family</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_weights">weights</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_...">...</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_running">running</code></td>
<td>
<p>Logical, denoting whether to calculate &quot;running&quot; projected probabilities. If true, a model is fit for
group 1 on its own to predict group 2, then groups 1 and 2 to predict 3, then groups 1 through 3 to predict 4, etc.
Groups are determined in <code>formula</code>. Omitting a group term re-runs a glm model to predict each
observation (a potentially time-consuming operation!)</p>
</td></tr>
<tr><td><code id="elo.glm_+3A_skip">skip</code></td>
<td>
<p>Integer, denoting how many groups to skip before fitting the running models. This is helpful if
groups are small, where glm would have trouble converging for the first few groups. The predicted values are then
set to 0.5 for the skipped groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula syntax is the same as other <code>elo</code> functions. A data.frame
of indicator variables is built, where an entry is 1 if a team is home, 0 if
a team didn't play, and -1 if a team is a visitor. Anything passed to <code><a href="#topic+adjust">adjust</a>()</code> in
<code>formula</code> is also put in the data.frame. A <code><a href="stats.html#topic+glm">glm</a></code> model is then
run to predict wins or margin of victory.
</p>
<p>With this setup, the intercept represents the home-field advantage. Neutral fields can be indicated
using the <code><a href="#topic+neutral">neutral</a>()</code> function, which sets the intercept to 0.
</p>
<p>Note that any weights specified in <code>players()</code> will be ignored.
</p>
<p>This is essentially the Bradley-Terry model.
</p>


<h3>Value</h3>

<p>An object of class <code>c("elo.glm", "glm")</code>. If <code>running==TRUE</code>, the class <code>"elo.glm.running"</code>
is prepended.
</p>


<h3>References</h3>

<p>https://en.wikipedia.org/wiki/Bradley
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+summary.elo.glm">summary.elo.glm</a></code>, <code><a href="#topic+score">score</a></code>,
<code><a href="#topic+mov">mov</a></code>, <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tournament)
elo.glm(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  subset = points.Home != points.Visitor)
elo.glm(mov(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  family = "gaussian")
</code></pre>

<hr>
<h2 id='elo.markovchain'>Compute a Markov chain model for a series of matches.</h2><span id='topic+elo.markovchain'></span>

<h3>Description</h3>

<p>Compute a Markov chain model for a series of matches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.markovchain(
  formula,
  data,
  family = "binomial",
  weights,
  na.action,
  subset,
  k = NULL,
  ...,
  running = FALSE,
  skip = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.markovchain_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_family">family</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_weights">weights</code></td>
<td>
<p>A vector of weights. Note that these weights are used in the Markov Chain model,
but not the regression.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_k">k</code></td>
<td>
<p>The probability that the winning team is better given that they won. See details.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_...">...</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_running">running</code></td>
<td>
<p>Logical, denoting whether to calculate &quot;running&quot; projected probabilities. If true, a model is fit for
group 1 on its own to predict group 2, then groups 1 and 2 to predict 3, then groups 1 through 3 to predict 4, etc.
Groups are determined in <code>formula</code>. Omitting a group term re-runs a glm model to predict each
observation (a potentially time-consuming operation!)</p>
</td></tr>
<tr><td><code id="elo.markovchain_+3A_skip">skip</code></td>
<td>
<p>Integer, denoting how many groups to skip before fitting the running models. This is helpful if
groups are small, where glm would have trouble converging for the first few groups. The predicted values are then
set to 0.5 for the skipped groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the vignette for details on this method. The probabilities we call 'k' purely for convenience.
The differences in assigned scores (from the stationary distribution pi) are fed into a logistic
regression model to predict wins or (usually) a linear model to predict margin of victory.
It is also possible to adjust the regression by setting the second argument of
<code><a href="#topic+adjust">adjust</a>()</code>. As in <code><a href="#topic+elo.glm">elo.glm</a></code>,
the intercept represents the home-field advantage. Neutral fields can be indicated
using the <code><a href="#topic+neutral">neutral</a>()</code> function, which sets the intercept to 0.
</p>
<p>Note that by assigning probabilities in the right way, this function emits the
Logistic Regression Markov Chain model (LRMC).
</p>


<h3>References</h3>

<p>Kvam, P. and Sokol, J.S. A logistic regression/Markov chain model for NCAA basketball.
Naval Research Logistics. 2006. 53; 788-803.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+summary.elo.markovchain">summary.elo.markovchain</a></code>, <code><a href="#topic+score">score</a></code>,
<code><a href="#topic+mov">mov</a></code>, <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.markovchain(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  subset = points.Home != points.Visitor, k = 0.7)

elo.markovchain(mov(points.Home, points.Visitor) ~ team.Home + team.Visitor, family = "gaussian",
  data = tournament, k = 0.7)
</code></pre>

<hr>
<h2 id='elo.model.frame'>Interpret formulas in <code>elo</code> functions</h2><span id='topic+elo.model.frame'></span>

<h3>Description</h3>

<p>A helper function to create the <code>model.frame</code> for many <code>elo</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.model.frame(
  formula,
  data,
  na.action,
  subset,
  k = NULL,
  ...,
  required.vars = "elos",
  warn.k = TRUE,
  ncol.k = 1,
  ncol.elos = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.model.frame_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_k">k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_...">...</code></td>
<td>
<p>Other arguments (not in use at this time).</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_required.vars">required.vars</code></td>
<td>
<p>One or more of <code>c("wins", "elos", "k", "group", "regress")</code>,
denoting which variables are required to appear in the final model.frame.</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_warn.k">warn.k</code></td>
<td>
<p>Should a warning be issued if <code>k</code> is specified as an argument and in <code>formula</code>?</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_ncol.k">ncol.k</code></td>
<td>
<p>How many columns (<code>NCOL</code>) should <code>k</code> have?</p>
</td></tr>
<tr><td><code id="elo.model.frame_+3A_ncol.elos">ncol.elos</code></td>
<td>
<p>How many Elo columns are expected?</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+elo.run">elo.run</a></code>, <code><a href="#topic+elo.calc">elo.calc</a></code>, <code><a href="#topic+elo.update">elo.update</a></code>, <code><a href="#topic+elo.prob">elo.prob</a></code>
</p>

<hr>
<h2 id='elo.mov'>Create a &quot;margin of victory&quot; column</h2><span id='topic+elo.mov'></span><span id='topic+mov'></span>

<h3>Description</h3>

<p>Create a &quot;margin of victory&quot; based on two teams' scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mov(score.A, score.B = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.mov_+3A_score.a">score.A</code></td>
<td>
<p>Numeric; the score of the first team. Alternatively, this can
be a pre-computed margin of victory which will get compared to 0.</p>
</td></tr>
<tr><td><code id="elo.mov_+3A_score.b">score.B</code></td>
<td>
<p>Numeric; the score of the second team; default is 0, in case
<code>score.A</code> is already a margin of victory..</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with class <code>"elo.mov"</code>, denoting <code>score.A</code> = <code>score.B</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score">score</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mov(12, 10)
mov(10, 10)
mov(10, 12)
</code></pre>

<hr>
<h2 id='elo.mse'>Calculate the mean square error</h2><span id='topic+elo.mse'></span><span id='topic+mse'></span><span id='topic+brier'></span><span id='topic+mse.elo.run'></span><span id='topic+mse.elo.glm'></span><span id='topic+mse.elo.running'></span><span id='topic+mse.elo.markovchain'></span><span id='topic+mse.elo.winpct'></span><span id='topic+mse.elo.colley'></span>

<h3>Description</h3>

<p>Calculate the mean square error (Brier score) for a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mse(object, ..., subset = TRUE)

brier(object, ..., subset = TRUE)

## S3 method for class 'elo.run'
mse(object, ..., subset = TRUE)

## S3 method for class 'elo.glm'
mse(object, ..., subset = TRUE)

## S3 method for class 'elo.running'
mse(object, running = TRUE, discard.skipped = FALSE, ..., subset = TRUE)

## S3 method for class 'elo.markovchain'
mse(object, ..., subset = TRUE)

## S3 method for class 'elo.winpct'
mse(object, ..., subset = TRUE)

## S3 method for class 'elo.colley'
mse(object, ..., subset = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.mse_+3A_object">object</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="elo.mse_+3A_...">...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td></tr>
<tr><td><code id="elo.mse_+3A_subset">subset</code></td>
<td>
<p>(optional) A vector of indices on which to calculate</p>
</td></tr>
<tr><td><code id="elo.mse_+3A_running">running</code></td>
<td>
<p>logical, denoting whether to use the running predicted values.</p>
</td></tr>
<tr><td><code id="elo.mse_+3A_discard.skipped">discard.skipped</code></td>
<td>
<p>Logical, denoting whether to ignore the skipped observations in the calculation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Even though logistic regressions don't use the MSE on the y=0/1 scale, it can still be informative.
Note that the S3 method is <code>mse</code>.
</p>

<hr>
<h2 id='elo.prob'>Elo probability</h2><span id='topic+elo.prob'></span><span id='topic+elo.prob.default'></span><span id='topic+elo.prob.formula'></span><span id='topic+elo.prob.elo.multiteam.matrix'></span>

<h3>Description</h3>

<p>Calculate the probability that team A beats team B. This is vectorized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.prob(elo.A, ...)

## Default S3 method:
elo.prob(elo.A, elo.B, ..., elos = NULL, adjust.A = 0, adjust.B = 0)

## S3 method for class 'formula'
elo.prob(formula, data, na.action, subset, ..., elos = NULL)

## S3 method for class 'elo.multiteam.matrix'
elo.prob(elo.A, ..., elos = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.prob_+3A_elo.a">elo.A</code>, <code id="elo.prob_+3A_elo.b">elo.B</code></td>
<td>
<p>Numeric vectors of elo scores, or else vectors of teams.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_...">...</code></td>
<td>
<p>Other arguments (not in use at this time).</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_elos">elos</code></td>
<td>
<p>An optional named vector containing Elo ratings for all teams in <code>formula</code>
or <code>elo.A</code> and <code>elo.B</code>.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_adjust.a">adjust.A</code>, <code id="elo.prob_+3A_adjust.b">adjust.B</code></td>
<td>
<p>Numeric vectors to adjust <code>elo.A</code> and <code>elo.B</code> by.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.prob_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>formula</code> can be missing the <code>wins.A</code> component. If
present, it's ignored by <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>.
</p>


<h3>Value</h3>

<p>A vector of Elo probabilities.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo.update">elo.update</a></code>, <code><a href="#topic+elo.calc">elo.calc</a></code>,
<code>elo.model.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.prob(1500, 1500)
elo.prob(c(1500, 1500), c(1500, 1600))

dat &lt;- data.frame(wins.A = c(1, 0), elo.A = c(1500, 1500),
                  elo.B = c(1500, 1600), k = c(20, 20))
elo.prob(~ elo.A + elo.B, data = dat)

## Also works to include the wins and k:
elo.prob(wins.A ~ elo.A + elo.B + k(k), data = dat)

## Also allows teams
elo.prob(c("A", "B"), c("C", "C"), elos = c(A = 1500, B = 1600, C = 1500))

</code></pre>

<hr>
<h2 id='elo.run'>Calculate running Elos for a series of matches.</h2><span id='topic+elo.run'></span>

<h3>Description</h3>

<p>Calculate running Elos for a series of matches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.run(
  formula,
  data,
  na.action,
  subset,
  k = NULL,
  initial.elos = NULL,
  ...,
  prob.fun = elo.prob,
  update.fun = elo.update,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.run_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_k">k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td></tr>
<tr><td><code id="elo.run_+3A_initial.elos">initial.elos</code></td>
<td>
<p>An optional named vector containing initial Elo ratings for all teams in <code>formula</code>.
If a single (unnamed) value is supplied, that value is applied to all teams. <code>NULL</code> (the default)
sets all Elos to 1500.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_...">...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td></tr>
<tr><td><code id="elo.run_+3A_prob.fun">prob.fun</code></td>
<td>
<p>A function with at least 4 arguments: elo.A, elo.B, adjust.A, and adjust.B. It should return a predicted probability
that team A wins. The values passed in will be scalars, and a scalar is expected as output.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_update.fun">update.fun</code></td>
<td>
<p>A function with at least 6 arguments: the same as <code><a href="#topic+elo.update.default">elo.update.default</a></code>. The function takes
in the Elos, the win indicator, k, and any adjustments, and returns a value by which to update the Elos. The values passed in
will be scalars, and a scalar is expected as output.</p>
</td></tr>
<tr><td><code id="elo.run_+3A_verbose">verbose</code></td>
<td>
<p>Should a message be issued when R is used (over C++)?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>elo.run</code> is run two different ways: the first (default) uses C++ and may be up to 50 times faster,
while the second (when <code>prob.fun</code> or <code>update.fun</code> are specified) uses R but also supports custom update functions.
Prefer the first unless you really need a custom update function.
</p>


<h3>Value</h3>

<p>An object of class <code>"elo.run"</code> or class <code>"elo.run.regressed"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score">score</a></code>, <a href="#topic+elo.run.helpers">elo.run.helpers</a>elo.run helpers, <code><a href="#topic+elo.calc">elo.calc</a></code>,
<code><a href="#topic+elo.update">elo.update</a></code>, <code><a href="#topic+elo.prob">elo.prob</a></code>, <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tournament)
elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
        data = tournament, k = 20)

# Create non-constant 'k'
elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor +
        k(20*log(abs(points.Home - points.Visitor) + 1)), data = tournament)

# Adjust Elo for, e.g., home-field advantage
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, 30) + team.Visitor,
        data = tournament, k = 20)

tournament$home.field &lt;- 30
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, home.field) + team.Visitor,
        data = tournament, k = 20)

# Regress the Elos back toward 1500 at the end of the half-season
elo.run(score(points.Home, points.Visitor) ~ adjust(team.Home, 30) +
        team.Visitor + regress(half, 1500, 0.2), data = tournament, k = 20)

</code></pre>

<hr>
<h2 id='elo.run.helpers'>Helper functions for <code>elo.run</code></h2><span id='topic+elo.run.helpers'></span><span id='topic+as.matrix.elo.run'></span><span id='topic+as.matrix.elo.run.regressed'></span><span id='topic+as.data.frame.elo.run'></span><span id='topic+final.elos'></span><span id='topic+final.elos.elo.run'></span><span id='topic+final.elos.elo.run.regressed'></span>

<h3>Description</h3>

<p><code>as.matrix</code> converts an Elo object into a matrix of running Elos. These are the Elos at the time of grouping,
but before any regression takes place.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elo.run'
as.matrix(x, ...)

## S3 method for class 'elo.run.regressed'
as.matrix(x, ...)

## S3 method for class 'elo.run'
as.data.frame(x, ...)

final.elos(x, ...)

## S3 method for class 'elo.run'
final.elos(x, ...)

## S3 method for class 'elo.run.regressed'
final.elos(x, regressed = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.run.helpers_+3A_x">x</code></td>
<td>
<p>An object of class <code>"elo.run"</code> or class <code>"elo.run.regressed"</code>.</p>
</td></tr>
<tr><td><code id="elo.run.helpers_+3A_...">...</code></td>
<td>
<p>Other arguments (Not in use at this time).</p>
</td></tr>
<tr><td><code id="elo.run.helpers_+3A_regressed">regressed</code></td>
<td>
<p>Logical, denoting whether to use the post-regressed (<code>TRUE</code>) or
pre-regressed (<code>FALSE</code>) final Elos. Note that <code>TRUE</code> only makes sense when the
final Elos were regressed one last time (i.e., if the last element of the <code>regress()</code>)
vector yields <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.data.frame</code> converts the <code>"elos"</code> component of an object
from <code><a href="#topic+elo.run">elo.run</a></code> into a data.frame.
</p>
<p><code>final.elos</code> is a generic function to extract the last Elo per team.
</p>


<h3>Value</h3>

<p>A matrix, a data.frame, or a named vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo.run">elo.run</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e &lt;- elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor + group(week),
             data = tournament, k = 20)
head(as.matrix(e))
str(as.data.frame(e))
final.elos(e)
</code></pre>

<hr>
<h2 id='elo.run.multiteam'>Calculate running Elos for a series of multi-team matches.</h2><span id='topic+elo.run.multiteam'></span>

<h3>Description</h3>

<p>Calculate running Elos for a series of multi-team matches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.run.multiteam(
  formula,
  data,
  na.action,
  subset,
  k = NULL,
  initial.elos = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.run.multiteam_+3A_formula">formula</code></td>
<td>
<p>A one-sided formula with a <code><a href="#topic+multiteam">multiteam</a>()</code> object.
See also the <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_k">k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_initial.elos">initial.elos</code></td>
<td>
<p>An optional named vector containing initial Elo ratings for all teams in <code>formula</code>.
If a single (unnamed) value is supplied, that value is applied to all teams. <code>NULL</code> (the default)
sets all Elos to 1500.</p>
</td></tr>
<tr><td><code id="elo.run.multiteam_+3A_...">...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is like <code><a href="#topic+elo.run">elo.run</a></code> (and in fact it runs <code><a href="#topic+elo.run">elo.run</a></code> in the background).
The formula takes a <code><a href="#topic+multiteam">multiteam</a>()</code> object, which assumes that teams &quot;win&quot;
in a well-ordered ranking. It assumes that the first place team beats all other teams,
that the second place team loses to the first but beats the others, etc. In that regard,
<code>elo.run.multiteam</code> reduces to <code>elo.run</code> when the number of teams (<code>ncol(multiteam())</code>) is 2
</p>
<p>However, this is less flexible than <code>elo.run</code>, because (1) there cannot be ties; (2) it does not accept
adjustments; and (3) k is constant within a &quot;game&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tournament.multiteam)
elo.run.multiteam(~ multiteam(Place_1, Place_2, Place_3, Place_4),
                  data = tournament.multiteam, subset = -28, k = 20)
</code></pre>

<hr>
<h2 id='elo.update'>Elo updates</h2><span id='topic+elo.update'></span><span id='topic+elo.update.default'></span><span id='topic+elo.update.formula'></span>

<h3>Description</h3>

<p>Calculate the update value for a given Elo matchup. This is used in
<code><a href="#topic+elo.calc">elo.calc</a></code>, which reports the post-update Elo values. This is vectorized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.update(wins.A, ...)

## Default S3 method:
elo.update(wins.A, elo.A, elo.B, k, ..., adjust.A = 0, adjust.B = 0)

## S3 method for class 'formula'
elo.update(formula, data, na.action, subset, k = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.update_+3A_wins.a">wins.A</code></td>
<td>
<p>Numeric vector of wins by team A.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_...">...</code></td>
<td>
<p>Other arguments (not in use at this time).</p>
</td></tr>
<tr><td><code id="elo.update_+3A_elo.a">elo.A</code>, <code id="elo.update_+3A_elo.b">elo.B</code></td>
<td>
<p>Numeric vectors of elo scores.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_k">k</code></td>
<td>
<p>A constant k-value (or a vector, where appropriate).</p>
</td></tr>
<tr><td><code id="elo.update_+3A_adjust.a">adjust.A</code>, <code id="elo.update_+3A_adjust.b">adjust.B</code></td>
<td>
<p>Numeric vectors to adjust <code>elo.A</code> and <code>elo.B</code> by.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.update_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of Elo updates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elo.prob">elo.prob</a></code>, <code><a href="#topic+elo.calc">elo.calc</a></code>,
<code>elo.model.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.update(c(1, 0), c(1500, 1500), c(1500, 1600), k = 20)

dat &lt;- data.frame(wins.A = c(1, 0), elo.A = c(1500, 1500),
                  elo.B = c(1500, 1600), k = c(20, 20))
elo.update(wins.A ~ elo.A + elo.B + k(k), data = dat)
</code></pre>

<hr>
<h2 id='elo.winpct'>Compute a (usually logistic) regression based on win percentage for a series of matches.</h2><span id='topic+elo.winpct'></span>

<h3>Description</h3>

<p>Compute a (usually logistic) regression based on win percentage for a series of matches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elo.winpct(
  formula,
  data,
  family = "binomial",
  weights,
  na.action,
  subset,
  ...,
  running = FALSE,
  skip = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elo.winpct_+3A_formula">formula</code></td>
<td>
<p>A formula. See <a href="#topic+formula.specials">the help page for formulas</a> for details.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> in which to look for objects in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_family">family</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_weights">weights</code></td>
<td>
<p>A vector of weights. Note that these are used in calculating wins and losses but
not in the regression.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_...">...</code></td>
<td>
<p>Argument passed to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_running">running</code></td>
<td>
<p>Logical, denoting whether to calculate &quot;running&quot; projected probabilities. If true, a model is fit for
group 1 on its own to predict group 2, then groups 1 and 2 to predict 3, then groups 1 through 3 to predict 4, etc.
Groups are determined in <code>formula</code>. Omitting a group term re-runs a glm model to predict each
observation (a potentially time-consuming operation!)</p>
</td></tr>
<tr><td><code id="elo.winpct_+3A_skip">skip</code></td>
<td>
<p>Integer, denoting how many groups to skip before fitting the running models. This is helpful if
groups are small, where glm would have trouble converging for the first few groups. The predicted values are then
set to 0.5 for the skipped groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Win percentages are first calculated. Anything passed to <code><a href="#topic+adjust">adjust</a>()</code> in
<code>formula</code> is also put in the data.frame. A <code><a href="stats.html#topic+glm">glm</a></code> model is then
run to predict wins or margin of victory.
</p>
<p>With this setup, the intercept represents the home-field advantage. Neutral fields can be indicated
using the <code><a href="#topic+neutral">neutral</a>()</code> function, which sets the intercept to 0.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+summary.elo.winpct">summary.elo.winpct</a></code>, <code><a href="#topic+score">score</a></code>,
<code><a href="#topic+mov">mov</a></code>, <code><a href="#topic+elo.model.frame">elo.model.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elo.winpct(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  subset = points.Home != points.Visitor)

elo.winpct(mov(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = tournament,
  family = "gaussian")
</code></pre>

<hr>
<h2 id='favored.elo'>Classify teams that are favored to win</h2><span id='topic+favored.elo'></span><span id='topic+favored'></span><span id='topic+favored.elo.run'></span><span id='topic+favored.elo.glm'></span><span id='topic+favored.elo.running'></span><span id='topic+favored.elo.markovchain'></span><span id='topic+favored.elo.winpct'></span><span id='topic+favored.elo.colley'></span><span id='topic+favored.default'></span>

<h3>Description</h3>

<p>Classify teams that are favored to win
</p>


<h3>Usage</h3>

<pre><code class='language-R'>favored(x, ..., subset = TRUE)

## S3 method for class 'elo.run'
favored(x, ..., subset = TRUE)

## S3 method for class 'elo.glm'
favored(x, ..., subset = TRUE)

## S3 method for class 'elo.running'
favored(x, running = TRUE, discard.skipped = FALSE, ..., subset = TRUE)

## S3 method for class 'elo.markovchain'
favored(x, ..., subset = TRUE)

## S3 method for class 'elo.winpct'
favored(x, ..., subset = TRUE)

## S3 method for class 'elo.colley'
favored(x, ..., subset = TRUE)

## Default S3 method:
favored(x, p.A, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="favored.elo_+3A_x">x</code></td>
<td>
<p>An object from <code><a href="#topic+elo.run">elo.run</a></code> or <code><a href="#topic+elo.glm">elo.glm</a></code>, or for the default method
a vector representing wins.A.</p>
</td></tr>
<tr><td><code id="favored.elo_+3A_...">...</code></td>
<td>
<p>Other arguments (not used at this time).</p>
</td></tr>
<tr><td><code id="favored.elo_+3A_subset">subset</code></td>
<td>
<p>(optional) A vector of indices on which to calculate</p>
</td></tr>
<tr><td><code id="favored.elo_+3A_running">running</code></td>
<td>
<p>logical, denoting whether to use the running predicted values.</p>
</td></tr>
<tr><td><code id="favored.elo_+3A_discard.skipped">discard.skipped</code></td>
<td>
<p>Logical, denoting whether to ignore the skipped observations in the calculation</p>
</td></tr>
<tr><td><code id="favored.elo_+3A_p.a">p.A</code></td>
<td>
<p>A vector of predicted win probabilities.</p>
</td></tr>
</table>

<hr>
<h2 id='fitted.elo'>Extract model values</h2><span id='topic+fitted.elo'></span><span id='topic+fitted.elo.run'></span><span id='topic+residuals.elo.run'></span><span id='topic+fitted.elo.running'></span><span id='topic+fitted.elo.glm'></span><span id='topic+fitted.elo.markovchain'></span><span id='topic+fitted.elo.winpct'></span><span id='topic+fitted.elo.colley'></span>

<h3>Description</h3>

<p>Extract model values from <code>elo</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elo.run'
fitted(object, ...)

## S3 method for class 'elo.run'
residuals(object, ...)

## S3 method for class 'elo.running'
fitted(object, running = TRUE, ...)

## S3 method for class 'elo.glm'
fitted(object, ...)

## S3 method for class 'elo.markovchain'
fitted(object, ...)

## S3 method for class 'elo.winpct'
fitted(object, ...)

## S3 method for class 'elo.colley'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.elo_+3A_object">object</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="fitted.elo_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
<tr><td><code id="fitted.elo_+3A_running">running</code></td>
<td>
<p>logical, denoting whether to use the running predicted values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of fitted values. For running values, it has an additional attribute denoting to which
group (i.e., which model) the prediction belongs
</p>

<hr>
<h2 id='players'>Details on <code>elo</code> formulas and the specials therein</h2><span id='topic+players'></span><span id='topic+multiteam'></span><span id='topic+formula.specials'></span><span id='topic+k'></span><span id='topic+adjust'></span><span id='topic+regress'></span><span id='topic+group'></span><span id='topic+neutral'></span>

<h3>Description</h3>

<p>Details on <code>elo</code> functions and the special functions allowed in them to change functions' behaviors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>players(..., weights = NULL)

multiteam(...)

k(x, y = NULL)

adjust(x, adjustment)

regress(x, to, by, regress.unused = TRUE)

group(x)

neutral(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="players_+3A_...">...</code></td>
<td>
<p>Vectors to be coerced to character, which comprise of the players of a team.</p>
</td></tr>
<tr><td><code id="players_+3A_weights">weights</code></td>
<td>
<p>A vector giving the weights of Elo updates for the players in <code>...</code>. Ignored for
<code><a href="#topic+elo.glm">elo.glm</a></code>.</p>
</td></tr>
<tr><td><code id="players_+3A_x">x</code>, <code id="players_+3A_y">y</code></td>
<td>
<p>A vector.</p>
</td></tr>
<tr><td><code id="players_+3A_adjustment">adjustment</code></td>
<td>
<p>A single value or a vector of the same length as <code>x</code>: how much to adjust the Elos in <code>x</code>.</p>
</td></tr>
<tr><td><code id="players_+3A_to">to</code></td>
<td>
<p>Numeric: what Elo to regress to. Can be a single value or named vector the same length
as the number of teams.</p>
</td></tr>
<tr><td><code id="players_+3A_by">by</code></td>
<td>
<p>Numeric: by how much should Elos be regressed toward <code>to</code>.</p>
</td></tr>
<tr><td><code id="players_+3A_regress.unused">regress.unused</code></td>
<td>
<p>Logical: whether to continue regressing teams which have stopped playing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the functions in this package, <code>formula</code> is usually of the form <code>wins.A ~ elo.A + elo.B</code>,
where <code>elo.A</code> and <code>elo.B</code> are vectors of Elos, and <code>wins.A</code> is between 0 and 1,
denoting whether team A (Elo A) won or lost (or something between). <code>elo.prob</code> also allows
<code>elo.A</code> and <code>elo.B</code> to be character or factors, denoting which team(s) played. <code>elo.run</code>
requires <code>elo.A</code> to be a vector of teams or a players matrix from <code>players()</code>
(sometimes denoted by <code>"team.A"</code>), but <code>elo.B</code> can be either a vector of teams or
players matrix (<code>"team.B"</code>) or else a numeric column (denoting a fixed-Elo opponent).
<code>elo.glm</code> requires both to be a vector of teams or players matrix. <code><a href="#topic+elo.markovchain">elo.markovchain</a></code>
requires both to be a vector of teams.
</p>
<p><code>formula</code> accepts six special functions in it:
</p>
<p><code>k()</code> allows for complicated Elo updates. For
constant Elo updates, use the <code>k = </code> argument instead of this special function.
Note that <code><a href="#topic+elo.markovchain">elo.markovchain</a></code> uses this function (or argument) as a convenient
way of specifying transition probabilities. <code><a href="#topic+elo.colley">elo.colley</a></code> uses this to indicate
the fraction of a win to be assigned to the winning team.
</p>
<p><code>adjust()</code> allows for Elos to be adjusted for, e.g., home-field advantage. The second argument
to this function can be a scalar or vector of appropriate length. This can also be used in
<code><a href="#topic+elo.glm">elo.glm</a></code> and <code><a href="#topic+elo.markovchain">elo.markovchain</a></code> as an adjuster to the logistic regressions.
</p>
<p><code>regress()</code> can be used to regress Elos back to a fixed value
after certain matches. Giving a logical vector identifies these matches after which to
regress back to the mean. Giving any other kind of vector regresses after the appropriate
groupings (see, e.g., <code><a href="base.html#topic+duplicated">duplicated</a>(..., fromLast = TRUE)</code>). The other three arguments determine
what Elo to regress to (<code>to = </code>), by how much to regress toward that value
(<code>by = </code>), and whether to continue regressing teams which have stopped playing (<code>regress.unused</code>,
default = <code>TRUE</code>).
</p>
<p><code>group()</code> is used to group matches (by, e.g., week). For <code><a href="#topic+elo.run">elo.run</a></code>, Elos are not updated until
the group changes. It is also fed to <code><a href="#topic+as.matrix.elo.run">as.matrix.elo.run</a></code>, giving the number of rows to return.
to produce only certain rows of matrix output. It also determines how many models to run (and on what data)
for <code><a href="#topic+elo.glm">elo.glm</a></code> and <code><a href="#topic+elo.markovchain">elo.markovchain</a></code> when <code>running=TRUE</code>.
</p>
<p><code>neutral()</code> is used in <code><a href="#topic+elo.glm">elo.glm</a></code> and <code><a href="#topic+elo.markovchain">elo.markovchain</a></code> to determine the intercept.
In short, the intercept is <code>1 - neutral()</code>, denoting home-field advantage. Therefore, the column
passed should be 0 (denoting home-field advantange) or 1 (denoting a neutral game). If omitted, all matches
are assumed to have home field advantage.
</p>
<p><code>players()</code> is used for multiple players on a team contributing to an overall Elo. The Elo updates
are then assigned based on the specified weights. The weights are ignored in <code><a href="#topic+elo.glm">elo.glm</a></code>.
</p>
<p><code>multiteam()</code> is used for matchups consisting of multiple teams and is only valid in <code><a href="#topic+elo.run.multiteam">elo.run.multiteam</a></code>.
</p>

<hr>
<h2 id='predict.elo'>Make Predictions on an <code>elo</code> Object</h2><span id='topic+predict.elo'></span><span id='topic+predict.elo.run'></span><span id='topic+predict.elo.run.regressed'></span><span id='topic+predict.elo.run.multiteam'></span><span id='topic+predict.elo.glm'></span><span id='topic+predict.elo.running'></span><span id='topic+predict.elo.markovchain'></span><span id='topic+predict.elo.colley'></span><span id='topic+predict.elo.winpct'></span>

<h3>Description</h3>

<p>Make Predictions on an <code>elo</code> Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elo.run'
predict(object, newdata, ...)

## S3 method for class 'elo.run.regressed'
predict(object, newdata, regressed = FALSE, ...)

## S3 method for class 'elo.run.multiteam'
predict(object, newdata, ...)

## S3 method for class 'elo.glm'
predict(object, newdata, type = "response", ...)

## S3 method for class 'elo.running'
predict(object, newdata, running = TRUE, ...)

## S3 method for class 'elo.markovchain'
predict(object, newdata, ...)

## S3 method for class 'elo.colley'
predict(object, newdata, ...)

## S3 method for class 'elo.winpct'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.elo_+3A_object">object</code></td>
<td>
<p>An model from which to get predictions.</p>
</td></tr>
<tr><td><code id="predict.elo_+3A_newdata">newdata</code></td>
<td>
<p>A new dataset containing the same variables as the call
that made <code>object</code>. If missing, the predicted win probabilities from
<code>object</code> will be returned.</p>
</td></tr>
<tr><td><code id="predict.elo_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
<tr><td><code id="predict.elo_+3A_regressed">regressed</code></td>
<td>
<p>See the note on <code><a href="#topic+final.elos">final.elos</a></code>.</p>
</td></tr>
<tr><td><code id="predict.elo_+3A_type">type</code></td>
<td>
<p>See <code><a href="stats.html#topic+predict.glm">predict.glm</a></code></p>
</td></tr>
<tr><td><code id="predict.elo_+3A_running">running</code></td>
<td>
<p>logical, denoting whether to use the running predicted values. Only makes
sense if <code>newdata</code> is missing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the <code>"elo.glm.running"</code> objects will use a model fit on all the data to predict.
</p>


<h3>Value</h3>

<p>A vector of win probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tournament)
t1 &lt;- head(tournament, -3)
t2 &lt;- tail(tournament, 3)
results &lt;- elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
                   data = t1, k = 20)
predict(results)
predict(results, newdata = t2)

results &lt;- elo.glm(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = t1,
  subset = points.Home != points.Visitor)
predict(results)
predict(results, newdata = t2)

results &lt;- elo.markovchain(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = t1,
  subset = points.Home != points.Visitor, k = 0.7)
predict(results)
predict(results, newdata = t2)

results &lt;- elo.colley(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = t1,
  subset = points.Home != points.Visitor)
predict(results)
predict(results, newdata = t2)

results &lt;- elo.winpct(score(points.Home, points.Visitor) ~ team.Home + team.Visitor, data = t1,
  subset = points.Home != points.Visitor, k = 0.7)
predict(results)
predict(results, newdata = t2)
</code></pre>

<hr>
<h2 id='rank.teams'>Rank teams</h2><span id='topic+rank.teams'></span><span id='topic+rank.teams.elo.run'></span><span id='topic+rank.teams.elo.run.regressed'></span><span id='topic+rank.teams.elo.glm'></span><span id='topic+rank.teams.elo.markovchain'></span><span id='topic+rank.teams.elo.winpct'></span><span id='topic+rank.teams.elo.colley'></span>

<h3>Description</h3>

<p>Extract the rankings from Elo objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank.teams(object, ties.method = "min", ...)

## S3 method for class 'elo.run'
rank.teams(object, ties.method = "min", ...)

## S3 method for class 'elo.run.regressed'
rank.teams(object, ties.method = "min", regressed = FALSE, ...)

## S3 method for class 'elo.glm'
rank.teams(object, ties.method = "min", ...)

## S3 method for class 'elo.markovchain'
rank.teams(object, ties.method = "min", ...)

## S3 method for class 'elo.winpct'
rank.teams(object, ties.method = "min", ...)

## S3 method for class 'elo.colley'
rank.teams(object, ties.method = "min", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rank.teams_+3A_object">object</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="rank.teams_+3A_ties.method">ties.method</code></td>
<td>
<p>Passed to <code><a href="base.html#topic+rank">rank</a></code>.</p>
</td></tr>
<tr><td><code id="rank.teams_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
<tr><td><code id="rank.teams_+3A_regressed">regressed</code></td>
<td>
<p>Passed to <code><a href="#topic+final.elos">final.elos</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='score'>Create a 1/0/0.5 win &quot;indicator&quot;</h2><span id='topic+score'></span><span id='topic+is.score'></span>

<h3>Description</h3>

<p>Create a 1/0/0.5 win &quot;indicator&quot; based on two teams' scores, and test for &quot;score-ness&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score(score.A, score.B)

is.score(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_+3A_score.a">score.A</code></td>
<td>
<p>Numeric; the score of the first team (whose wins are to be denoted by 1).</p>
</td></tr>
<tr><td><code id="score_+3A_score.b">score.B</code></td>
<td>
<p>Numeric; the score of the second team (whose wins are to be denoted by 0).</p>
</td></tr>
<tr><td><code id="score_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>score</code>, a vector containing 0, 1, and 0.5 (for ties). For
<code>is.score</code>, <code>TRUE</code> or <code>FALSE</code> depending on whether all values of
<code>x</code> are between 0 and 1 (inclusive).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+score">score</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>score(12, 10)
score(10, 10)
score(10, 12)
</code></pre>

<hr>
<h2 id='summary.elo'>Summarize an <code>elo</code> Object</h2><span id='topic+summary.elo'></span><span id='topic+summary.elo.run'></span><span id='topic+summary.elo.glm'></span><span id='topic+summary.elo.markovchain'></span><span id='topic+summary.elo.colley'></span><span id='topic+summary.elo.winpct'></span>

<h3>Description</h3>

<p>Summarize an <code>elo</code> Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'elo.run'
summary(object, ...)

## S3 method for class 'elo.glm'
summary(object, ...)

## S3 method for class 'elo.markovchain'
summary(object, ...)

## S3 method for class 'elo.colley'
summary(object, ...)

## S3 method for class 'elo.winpct'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.elo_+3A_object">object</code></td>
<td>
<p>An object to summarize.</p>
</td></tr>
<tr><td><code id="summary.elo_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of <code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+favored">favored</a></code>, <code><a href="#topic+auc.elo.run">auc.elo.run</a></code>, <code><a href="#topic+mse">mse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(elo.run(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
  data = tournament, k = 20))
summary(elo.glm(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
  data = tournament))
mc &lt;- elo.markovchain(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
  data = tournament, subset = points.Home != points.Visitor, k = 0.7)
summary(mc)
co &lt;- elo.colley(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
  data = tournament, subset = points.Home != points.Visitor)
summary(co)
wp &lt;- elo.winpct(score(points.Home, points.Visitor) ~ team.Home + team.Visitor,
  data = tournament, subset = points.Home != points.Visitor, k = 0.7)
summary(wp)
</code></pre>

<hr>
<h2 id='tournament'><code>tournament</code>: Mock data for examples</h2><span id='topic+tournament'></span>

<h3>Description</h3>

<p>A fake dataset containing results from &quot;animal-ball&quot; matches.
</p>


<h3>Format</h3>

<p>A data frame with 56 observations on the following 4 variables:
</p>

<dl>
<dt><code>team.Home</code></dt><dd><p>The home team for the match</p>
</dd>
<dt><code>team.Visitor</code></dt><dd><p>The visiting team for the match</p>
</dd>
<dt><code>points.Home</code></dt><dd><p>Number of points scored by the home team</p>
</dd>
<dt><code>points.Visitor</code></dt><dd><p>Number of points scored by the visiting team</p>
</dd>
<dt><code>week</code></dt><dd><p>Week Number</p>
</dd>
<dt><code>half</code></dt><dd><p>The half of the season in which the match was played</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(tournament)
str(tournament)
</code></pre>

<hr>
<h2 id='tournament.multiteam'><code>tournament.multiteam</code>: Mock data for examples</h2><span id='topic+tournament.multiteam'></span>

<h3>Description</h3>

<p>A fake dataset containing results from &quot;animal-ball&quot; matches.
</p>


<h3>Format</h3>

<p>A data frame with 56 observations on the following 4 variables:
</p>

<dl>
<dt><code>week</code></dt><dd><p>Week Number</p>
</dd>
<dt><code>half</code></dt><dd><p>The half of the season in which the match was played</p>
</dd>
<dt><code>Place_1</code></dt><dd><p>The first-place team</p>
</dd>
<dt><code>Place_2</code></dt><dd><p>The second-place team</p>
</dd>
<dt><code>Place_3</code></dt><dd><p>The third-place team</p>
</dd>
<dt><code>Place_4</code></dt><dd><p>The fourth-place team</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
