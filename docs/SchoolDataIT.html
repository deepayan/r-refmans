<!DOCTYPE html><html><head><title>Help for package SchoolDataIT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SchoolDataIT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SchoolDataIT-package'><p>SchoolDataIT: Retrieve, Harmonise and Map Open Data Regarding the Italian School System</p></a></li>
<li><a href='#example_AdmUnNames20220630'><p>Subset of the administrative codes of municipalities</p></a></li>
<li><a href='#example_InnerAreas'><p>Subset of the school registry in school year 2022/23</p></a></li>
<li><a href='#example_input_DB23_MIUR'><p>Subset of the school buildings database in school year 2022/23</p></a></li>
<li><a href='#example_input_nstud23'><p>Subset of the students and classes counts in school year 2022/23</p></a></li>
<li><a href='#example_input_Registry23'><p>Subset of the school registry in school year 2022/23</p></a></li>
<li><a href='#example_Invalsi23_prov'><p>Subset of the Invalsi scores in school year 2022/23</p></a></li>
<li><a href='#example_Prov22_shp'><p>Subset of Italian provinces shapefile</p></a></li>
<li><a href='#example_School2mun23'><p>Association of the municipality code to a subset of public schools 2022/23</p></a></li>
<li><a href='#Get_AdmUnNames'><p>Download the names and codes of Italian LAU and NUTS-3 administrative units</p></a></li>
<li><a href='#Get_BroadBand'><p>Download the data regarding the broad band connection activation in Italian schools</p></a></li>
<li><a href='#Get_DB_MIUR'><p>Download the database of Italian public schools buildings</p></a></li>
<li><a href='#Get_InnerAreas'><p>Download the classification of peripheral municipalities</p></a></li>
<li><a href='#Get_Invalsi_IS'><p>Download the Invalsi census survey data</p></a></li>
<li><a href='#Get_nstud'><p>Download students' number data</p></a></li>
<li><a href='#Get_nteachers_prov'><p>Download the number of teachers in Italian schools by province</p></a></li>
<li><a href='#Get_Registry'><p>Download the registry of Italian public schools from the school registry section</p></a></li>
<li><a href='#Get_RiskMap'><p>Download the Map of Risks of Italian Municipality</p></a></li>
<li><a href='#Get_School2mun'><p>Associate a Municipality (LAU) code to each school</p></a></li>
<li><a href='#Get_Shapefile'><p>Download the boundaries of NUTS-3 (Provinces) and LAU (Municipalities) Italian administrative units from the ISTAT website</p></a></li>
<li><a href='#Group_DB_MIUR'><p>Aggregate the database of Italian public schools buildings at the municipality and province level</p></a></li>
<li><a href='#Group_nstud'><p>Aggregate the students number data by class at the municipality and province level</p></a></li>
<li><a href='#Group_teachers4stud'><p>Arrange the number of teachers per students in public Italian schools at the province level</p></a></li>
<li><a href='#Map_DB'><p>Map school data</p></a></li>
<li><a href='#Map_Invalsi'><p>Display a map of Invalsi scores</p></a></li>
<li><a href='#Map_School_Buildings'><p>Display data fom the school buildings database</p></a></li>
<li><a href='#Set_DB'><p>Build up a comprehensive database regarding the school system</p></a></li>
<li><a href='#Util_Check_nstud_availability'><p>Check how many schools in the school registries are included in the students count dataframe</p></a></li>
<li><a href='#Util_DB_MIUR_bool'><p>Clean and convert the raw school buildings data to Boolean variables</p></a></li>
<li><a href='#Util_DB_MIUR_num'><p>Convert the raw school buildings data to numeric or Boolean variables</p></a></li>
<li><a href='#Util_Invalsi_filter'><p>Filter the Invalsi data by subject, school grade and year.</p></a></li>
<li><a href='#Util_nstud_wide'><p>Clean the raw dataframe of the number of students and arrange it in a wide format</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Retrieve, Harmonise and Map Open Data Regarding the Italian
School System</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Leonardo Cefalo <a href="https://orcid.org/0009-0001-7776-723X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Alessio Pollice <a href="https://orcid.org/0000-0002-2818-9373"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, ths],
  Paolo Maranzano <a href="https://orcid.org/0000-0002-9228-2759"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leonardo Cefalo &lt;leonardo.cefalo@uniba.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Compiles and displays the available data sets regarding the Italian school system, with a focus on the infrastructural aspects.
    Input datasets are downloaded from the web, with the aim of updating everything to real time.  
    The functions are divided in four main modules, namely 
    'Get', to scrape raw data from the web
    'Util', various utilities needed to process raw data
    'Group', to aggregate data at the municipality or province level
    'Map', to visualize the output datasets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, dplyr, ggplot2, grDevices, httr, leafpop, magrittr,
mapview, readr, readxl, rlang, rvest, sf, stringr, tidyr,
utils, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), tidyverse</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 16:27:49 UTC; Leonardo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 16:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='SchoolDataIT-package'>SchoolDataIT: Retrieve, Harmonise and Map Open Data Regarding the Italian School System</h2><span id='topic+SchoolDataIT'></span><span id='topic+SchoolDataIT-package'></span>

<h3>Description</h3>

<p>Compiles and displays the available data sets regarding the Italian school system, with a focus on the infrastructural aspects. Input datasets are downloaded from the web, with the aim of updating everything to real time. The functions are divided in four main modules, namely 'Get', to scrape raw data from the web 'Util', various utilities needed to process raw data 'Group', to aggregate data at the municipality or province level 'Map', to visualize the output datasets.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Leonardo Cefalo <a href="mailto:leonardo.cefalo@uniba.it">leonardo.cefalo@uniba.it</a> (<a href="https://orcid.org/0009-0001-7776-723X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Alessio Pollice <a href="mailto:alessio.pollice@uniba.it">alessio.pollice@uniba.it</a> (<a href="https://orcid.org/0000-0002-2818-9373">ORCID</a>) [contributor, thesis advisor]
</p>
</li>
<li><p> Paolo Maranzano <a href="mailto:pmaranzano.ricercastatistica@gmail.com">pmaranzano.ricercastatistica@gmail.com</a> (<a href="https://orcid.org/0000-0002-9228-2759">ORCID</a>) [contributor]
</p>
</li></ul>


<hr>
<h2 id='example_AdmUnNames20220630'>Subset of the administrative codes of municipalities</h2><span id='topic+example_AdmUnNames20220630'></span>

<h3>Description</h3>

<p>This table includes the administrative codes of the municipalities from four regions: Molise, Campania, Apulia and Basilicata,
as of June 30th 2022; some strings in field <code>Municipality_description</code> including accents have been forced to ASCII.
The whole dataset can be retrieved with the command <code>Get_AdmUnNames(Year = 2022, date = "30_06_")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_AdmUnNames20220630
</code></pre>


<h3>Format</h3>

<p>## 'example_AdmUnNames20220630'
A data frame with 1,074 rows and 5 columns:
</p>

<ul>
<li> <p><code>Province_code</code> Numeric; the NUTS-3 administrative code
</p>
</li>
<li> <p><code>Province_initials</code> Character;abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>Municipality_code</code> Character; the ISTAT LAU (municipality) ID.
</p>
</li>
<li> <p><code>Municipality_description</code> Character; the municipality name.
</p>
</li>
<li> <p><code>Cadastral_code</code> Character; a LAU - level ID code, different from the official ISTAT municipality code.
It is used in the school registry (see <code><a href="#topic+example_input_Registry23">example_input_Registry23</a></code>)
</p>
</li></ul>



<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/6789&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>
</p>

<hr>
<h2 id='example_InnerAreas'>Subset of the school registry in school year 2022/23</h2><span id='topic+example_InnerAreas'></span>

<h3>Description</h3>

<p>This dataframe includes the classification of municipalities , from four regions: Molise, Campania, Apulia and Basilicata.
Only the first 10 columns are included;
some strings in field <code>Municipality_description</code> including accents have been forced to ASCII.
The whole dataset can be retrieved with the command <code>Get_InnerAreas()</code>.
For the definition of ISTAT inner areas class, see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_InnerAreas
</code></pre>


<h3>Format</h3>

<p>## 'example_InnerAreas'
A data frame with 1074 rows and 10 columns:
</p>

<ul>
<li> <p><code>Municipality_code</code> Character; the ISTAT LAU (municipality) ID.
</p>
</li>
<li> <p><code>Municipality_code_numeric</code> Numeric; the ISTAT LAU (municipality) ID in numeric format.
</p>
</li>
<li> <p><code>Cadastral_code</code> Character; a LAU - level ID code, different from the official ISTAT municipality code.
</p>
</li>
<li> <p><code>Region_code</code> Numeric; the region (NUTS-2 administrative level) ID
</p>
</li>
<li> <p><code>Region_description</code> Character; the region (NUTS-2 administrative level) name.
</p>
</li>
<li> <p><code>Province_code</code> Numeric; the NUTS-3 administrative code.
</p>
</li>
<li> <p><code>Province_initials</code> Character; abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>Province_description</code> Character; the province (NUTS-3 administrative level) denomination.
</p>
</li>
<li> <p><code>Municipality_description</code> Character; the municipality name.
</p>
</li>
<li> <p><code>Inner_area_code_2014_2020</code> Character; the ISTAT inner areas classification between 2014 and 2020.
</p>
</li>
<li> <p><code>Inner_area_description_2014_2020</code> Character; the description of the classes identified in the previous column
</p>
</li>
<li> <p><code>Inner_area_code_2021_2027</code> Character; the ISTAT inner areas classification between 2021 and 2027.
</p>
</li>
<li> <p><code>Inner_area_description_2021_2027</code> Character; the description of the classes identified in the previous column
</p>
</li>
<li> <p><code>Destination_municipality_code</code> Character; For non-central municipalities (classes C, D, E, F), the ID of the closest pole municipality according to the 2021-2027 classification
</p>
</li>
<li> <p><code>Destination_municipality_code</code> Character; The denomination of the municipalities in the previous column
</p>
</li>
<li> <p><code>Destination_pole_code</code> Character; An internal ID convention for the destination poles; it includes a letter
(the class of the destination pole, either A or B); a number of two digits (the region code of the destination pole) and the progressive number of poles within a region.
</p>
</li></ul>



<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/273176&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code>
</p>

<hr>
<h2 id='example_input_DB23_MIUR'>Subset of the school buildings database in school year 2022/23</h2><span id='topic+example_input_DB23_MIUR'></span>

<h3>Description</h3>

<p>This dataframe includes the schools directly identifiable as primary, middle or high school, from four regions: Molise, Campania, Apulia and Basilicata.
Only the first 35 columns are included. Some strings including accents in fields <code>Other_disturbances_proximity</code>,
<code>Other_specific_criticalities</code> and <code>Other</code> have been forced to ASCII.
The whole dataset can be retrieved with the command <code>Get_DB_MIUR(2023)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_input_DB23_MIUR
</code></pre>


<h3>Format</h3>

<p>## 'example_input_DB23_MIUR'
A data frame with 7479 rows and 35 columns:
</p>

<ul>
<li> <p><code>Year</code> Numeric; the school year.
</p>
</li>
<li> <p><code>School_code</code> Character; the school ID.
</p>
</li>
<li> <p><code>Order</code> Character; the school order, either primary, middle or high school.
</p>
</li>
<li> <p><code>Reference_institute_code</code> Character; the ID of the reference institute.
</p>
</li>
<li> <p><code>Building_code</code> Character; the building ID; the first 6 digits usually identify the municipality.
</p>
</li>
<li> <p><code>Municipality_code</code> Character; the ISTAT LAU (municipality) ID.
</p>
</li>
<li> <p><code>Municipality_description</code> Character; the municipality name.
</p>
</li>
<li> <p><code>Province_initials</code> Character; abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>Postal_code</code> Character; the ZIP code; slightly finer than municipality boundaries. for big municipalities.
</p>
</li>
<li> <p><code>Context_without_disturbances</code> Character; whether the school belongs to an environment devoid of disturbances; otherwise, the types of disturbances are listed in columns 11 - 18.
</p>
</li>
<li> <p><code>Dumps_proximity</code> Character; whether the school is close to dumps (disturbance element).
</p>
</li>
<li> <p><code>Pollutant_industries_proximity</code> Character; whether the school is close to pollutant industries (disturbance element).
</p>
</li>
<li> <p><code>Pollutant_waters_proximity</code> Character; whether the school is close to pollutant or stagnant streams or ponds (disturbance element).
</p>
</li>
<li> <p><code>Air_pollution_sourcer_proximity</code> Character; whether the school is close to sources of air pollution (disturbance element).
</p>
</li>
<li> <p><code>Acoustic_pollution_sourcer_proximity</code> Character; whether the school is close to sources of acoustic pollution (disturbance element).
</p>
</li>
<li> <p><code>Electromagnetic_radiation_sources_proximity</code> Character; whether the school is close to sources of electromagnetic radiation (disturbance element).
</p>
</li>
<li> <p><code>Graveyards_proximity</code> Character; whether the school is close to a graveyard (disturbance element).
</p>
</li>
<li> <p><code>Other_disturbances_proximity</code> Character; other disturbance elements to which the school is close, other than those already listed.
</p>
</li>
<li> <p><code>School_area_specific_criticalities</code> Character; whether any specific criticality element occurs inside the school area; specified in columns 20 - 27.
</p>
</li>
<li> <p><code>Layby absence</code> Character; whether the access to the area pertaining to the school building lacks a lay-by or pitch (school area criticality element).
</p>
</li>
<li> <p><code>Unfenced area</code> Character; whether the school building area lacks fences or enclosures (school area criticality element).
</p>
</li>
<li> <p><code>Large_traffic</code> Character; whether the school area is close to large traffic streams (school area criticality element).
</p>
</li>
<li> <p><code>Railway_traffic</code> Character; whether the school area is close to railway traffic streams (school area criticality element).
</p>
</li>
<li> <p><code>Abandoned_industries</code> Character; whether the school area is located in pre-existences of abandoned industries (school area criticality element).
</p>
</li>
<li> <p><code>Decayed_urban_area</code> Character; whether the school belongs or is close to a decayed area (school area criticality element).
</p>
</li>
<li> <p><code>Risky_industries_proximity</code> Character; whether the school is close to perilous industrial areas  (school area criticality element).
</p>
</li>
<li> <p><code>Other_specific_criticalities</code> Character; specific criticality elements regarding the school area, other than those already listed.
</p>
</li>
<li> <p><code>School_bus</code> Character; whether the school is reached by school-bus service.
</p>
</li>
<li> <p><code>Urban_public_transport</code> Character; whether the school is served by a urban public transport station in the range of 250 meters.
</p>
</li>
<li> <p><code>Interurban_public_transport</code> Character; whether the school is served by a inter-urban public transport station in the range of 500 meters.
</p>
</li>
<li> <p><code>Railway_transport</code> Character; whether the school ranges 500 meters or less from a train station.
</p>
</li>
<li> <p><code>Private_transport</code> Character; whether the school can be reached by private transport.
</p>
</li>
<li> <p><code>Disabled_people_transport</code> Character; whether the school is provided with disabled people specific transport.
</p>
</li>
<li> <p><code>Bicycle_lane</code> Character; whether the building is in proximity of a bicycle/bike lane.
</p>
</li>
<li> <p><code>Other</code> Character; whether the building can be reached in any other specific way.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Edilizia+Scolastica">Homepage</a>; more in detail, the dataset blocks are downloaded respectively from:
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0111EDIAMBIENTESTA2021">cols 10-18</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0121EDICOLLEGAMENTISTA2021">cols 20-27</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0121EDICOLLEGAMENTISTA2021">cols 28-35</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code>
</p>

<hr>
<h2 id='example_input_nstud23'>Subset of the students and classes counts in school year 2022/23</h2><span id='topic+example_input_nstud23'></span>

<h3>Description</h3>

<p>This dataframe includes students and classes counts for the schools from four regions: Molise, Campania, Apulia and Basilicata.
The whole dataset can be retrieved with the command <code>Get_nstud(2023, filename = "ALUCORSOINDCLASTA")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_input_nstud23
</code></pre>


<h3>Format</h3>

<p>## 'example_input_nstud23'
A data frame with 21208 rows and 7 columns:
</p>

<ul>
<li> <p><code>Year</code> Numeric; the school year.
</p>
</li>
<li> <p><code>School_code</code> Character; the school ID.
</p>
</li>
<li> <p><code>Order</code> Character; the school order, either primary, middle or high school.
</p>
</li>
<li> <p><code>Grade</code> Numeric; the school grade.
</p>
</li>
<li> <p><code>Classes</code> Numeric; the count of classes of a given grade in each school
</p>
</li>
<li> <p><code>Male_students</code> Numeric; the count of male students in all classes of a given educational grade in each school
</p>
</li>
<li> <p><code>Female_students</code> Numeric; the count of female students in all classes of a given educational grade in each school
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Studenti&amp;datasetId=DS0030ALUCORSOINDCLASTA">Specific link</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_nstud">Get_nstud</a></code>
</p>

<hr>
<h2 id='example_input_Registry23'>Subset of the school registry in school year 2022/23</h2><span id='topic+example_input_Registry23'></span>

<h3>Description</h3>

<p>This dataframe includes the schools directly identifiable as primary, middle or high school, from four regions: Molise, Campania, Apulia and Basilicata.
Only the first 10 columns are included.
The whole dataset can be retrieved with the command <code>Get_Registry(2023)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_input_Registry23
</code></pre>


<h3>Format</h3>

<p>## 'example_input_Registry23'
A data frame with 5929 rows and 10 columns:
</p>

<ul>
<li> <p><code>Year</code> Numeric; the school year.
</p>
</li>
<li> <p><code>Area</code> Character; the macro-area of the municipality, i.e. North, Center or South.
</p>
</li>
<li> <p><code>Region_description</code> Character; the region (NUTS-2 administrative level) name.
</p>
</li>
<li> <p><code>Province_description</code> Character; the province (NUTS-3 administrative level) name.
</p>
</li>
<li> <p><code>Reference_institute_code</code> Character; the ID of the reference institute.
</p>
</li>
<li> <p><code>School_code</code> Character; the school ID.
</p>
</li>
<li> <p><code>Cadastral_code</code> Character; a LAU - level ID code, different from the official LAU municipality code.
The Italian Ministry of Education does provide this code in the place of the LAU code for both the Schools registry and the early school buildings DBs.
</p>
</li>
<li> <p><code>Municipality_description</code> Character; the municipality name.
</p>
</li>
<li> <p><code>School_address</code> Character; the school physical address.
</p>
</li>
<li> <p><code>Postal_code</code> Character; the ZIP code, slightly finer than municipality boundaries for big municipalities.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Scuole&amp;datasetId=DS0400SCUANAGRAFESTAT">Source link</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_Registry">Get_Registry</a></code>
</p>

<hr>
<h2 id='example_Invalsi23_prov'>Subset of the Invalsi scores in school year 2022/23</h2><span id='topic+example_Invalsi23_prov'></span>

<h3>Description</h3>

<p>This dataframe includes the Invalsi scores of the schools from four regions: Molise, Campania, Apulia and Basilicata, for the school year 2022/23.
The whole dataset can be retrieved with the command <code>Get_Invalsi_IS(level = "NUTS-3")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_Invalsi23_prov
</code></pre>


<h3>Format</h3>

<p>## 'example_Invalsi23_prov'
A data frame with 240 rows and 11 columns:
</p>

<ul>
<li> <p><code>Year</code> Character; the school year.
</p>
</li>
<li> <p><code>Grade</code> Numeric; the school grade; only includes the school grades subjected to the Invalsi survey. Either 2, 5, 8, 10 or 13.
</p>
</li>
<li> <p><code>Subject</code> Character; the school subject in which the test is taken; either Italian, Mathematics, English reading or English listening.
</p>
</li>
<li> <p><code>Province_code</code> Numeric; the NUTS-3 administrative code.
</p>
</li>
<li> <p><code>Province_initials</code> Character; abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>Province_description</code> Character; the province (NUTS-3 administrative level) denomination.
</p>
</li>
<li> <p><code>Average_percentage_score</code> Numeric; the province-level percentage of sufficient tests, only for primary schools; ranges 0-100.
</p>
</li>
<li> <p><code>Std_dev_percentage_score</code> Numeric; the standard deviation of the percentage of sufficient tests, only for primary schools.
</p>
</li>
<li> <p><code>WLE_average_score</code> Numeric; the province-level average WLE (Weighted Likelihood Estimator) score.
</p>
</li>
<li> <p><code>Std_dev_WLE_score</code> Numeric; the standard deviation of WLE scores.
</p>
</li>
<li> <p><code>Students_coverage</code> Numeric; the percentage of students for which the Invalsi tests are reported.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://serviziostatistico.invalsi.it/invalsi_ss_data/dati-provinciali-di-popolazione/">Source page</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code>
</p>

<hr>
<h2 id='example_Prov22_shp'>Subset of Italian provinces shapefile</h2><span id='topic+example_Prov22_shp'></span>

<h3>Description</h3>

<p>This is the shapefile for the provinces belonging to four regions: Molise, Campania, Apulia and Basilicata,
as of January 1st 2022. These are the latest administrative units boundaries relevant at the beginning of the school year 2022/23.
The whole shapefile can be retrieved with the command <code>Get_Shapefile(Year = 2022, level = "NUTS-3")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_Prov22_shp
</code></pre>


<h3>Format</h3>

<p>## 'example_Prov22_shp'
A Spatial polygon data frame with 13 rows/polygons and 15 columns:
</p>

<ul>
<li> <p><code>COD_RIP</code> Numeric; the code for the macroarea (1 for Northwest, 2 for Northeast, 3 for Center, 4 for South and 5 for Isles)
</p>
</li>
<li> <p><code>COD_REG</code> Numeric; the region (NUTS-2 administrative level) ID
</p>
</li>
<li> <p><code>COD_PROV</code> Numeric; the NUTS-3 administrative code
</p>
</li>
<li> <p><code>COD_CM</code> Numeric; the administrative code for Metropolitan Cities (which are always at the NUTS-3 level), obtained as 200 + NUTS-3 code, if the unit is a Metropolitan city; 0 otherwise.
</p>
</li>
<li> <p><code>COD_UTS</code> Numeric; the administrative code for Metropolitan cities if the unit is a Metropolitan City; the province code otherwise.
</p>
</li>
<li> <p><code>DEN_PROV</code> Character; the province (NUTS-3 administrative level) name, if the unit is not a Metropolitan City; blank otherwise.
</p>
</li>
<li> <p><code>DEN_CM</code> Character; the Metropolitan City (NUTS-3 administrative level) name, if the unit is a Metropolitan City; blank otherwise.
</p>
</li>
<li> <p><code>DEN_UTS</code> Character; the province or Metropolitan City (NUTS-3 administrative level) name.
</p>
</li>
<li> <p><code>SIGLA</code> Character; abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>TIPO_UTS</code> Character; the NUTS-3 type of the unit; either &quot;Provincia&quot; (Province) or &quot;Citta metropolitana&quot; (Metropolitan City)
</p>
</li>
<li> <p><code>Shape_Leng</code> Numeric; the polygon perimeter.
</p>
</li>
<li> <p><code>Shape_Area</code> Numeric; the polygon area.
</p>
</li>
<li> <p><code>geometry</code> the polygon geometry.
</p>
</li></ul>



<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/222527&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_Shapefile">Get_Shapefile</a></code>
</p>

<hr>
<h2 id='example_School2mun23'>Association of the municipality code to a subset of public schools 2022/23</h2><span id='topic+example_School2mun23'></span>

<h3>Description</h3>

<p>This list maps the IDs of the schools from four regions (Molise, Campania, Apulia and Basilicata) to the corresponding LAU codes.
The whole dataset can be retrieved with the command <code>Get_School2mun(2023)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_School2mun23
</code></pre>


<h3>Format</h3>

<p>## 'example_School2mun23'
A list of four elements
</p>

<ul>
<li> <p><code>Registry_from_buildings</code> A data frame of 5527 rows and 5 columns, including the schools listed in the buildings registry.
</p>
</li>
<li> <p><code>Registry_from_registry</code> A data frame of 5929 rows and 5 columns, including the schools listed in the schools registry.
</p>
</li>
<li> <p><code>Any</code> A data frame of 5954 rows and 5 columns, including schools listed in any of the registryes
</p>
</li>
<li> <p><code>Both</code> A data frame of 5510 rows and 5 columns, including schools listed in both registries
</p>
</li></ul>

<p>For each element, rows correspond to school IDs; the columns are:
</p>

<ul>
<li> <p><code>School_code</code> Character; the school ID.
</p>
</li>
<li> <p><code>Province_code</code> Numeric; the NUTS-3 administrative code.
</p>
</li>
<li> <p><code>Province_initials</code> Character; abbreviated NUTS-3 denomination.
</p>
</li>
<li> <p><code>Municipality_code</code> Character; the ISTAT LAU (municipality) ID.
</p>
</li>
<li> <p><code>Municipality_description</code> Character; the municipality name.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0101EDIANAGRAFESTA2021">Buildings registry (2021 onwards)</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0200EDIANAGRAFESTA">Buindings registry(until 2019)</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Scuole">Schools registry</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get_School2mun">Get_School2mun</a></code>
</p>

<hr>
<h2 id='Get_AdmUnNames'>Download the names and codes of Italian LAU and NUTS-3 administrative units</h2><span id='topic+Get_AdmUnNames'></span>

<h3>Description</h3>

<p>This function downloads a file provided by the Italian National Institute of Statistics including all the codes of administrative units in Italy. As of today, it is the easiest way to map directly cadastral codes to municipality codes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_AdmUnNames(Year = 2023, date = "01_01_", autoAbort = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_AdmUnNames_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Last available is 2024.
For coherence with school data, it is also in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>. <code>2023</code> by default.</p>
</td></tr>
<tr><td><code id="Get_AdmUnNames_+3A_date">date</code></td>
<td>
<p>Character. The reference date, in format <code>"dd_mm_"</code>. Usually, the administrative codes are available at 01/01, at 06/30 and 12/31 of every year. <code>"01_01_"</code> by default.</p>
</td></tr>
<tr><td><code id="Get_AdmUnNames_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, including: NUTS-3 code, NUTS-3 abbreviation,
LAU code, LAU name (description) and cadastral code. All variables are characters except for the NUTS-3 code.
</p>


<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/6789&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


  Get_AdmUnNames(2024, autoAbort = TRUE)


</code></pre>

<hr>
<h2 id='Get_BroadBand'>Download the data regarding the broad band connection activation in Italian schools</h2><span id='topic+Get_BroadBand'></span>

<h3>Description</h3>

<p>Retrieves the data regarding the activation date of the broad band connection in schools. It also indicates whether the connection was activated or not at a certain date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_BroadBand(
  Date = Sys.Date(),
  verbose = TRUE,
  show_col_types = FALSE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_BroadBand_+3A_date">Date</code></td>
<td>
<p>Object of class <code>Date</code>. The date at which it is required to determine if the broad band connection has been activated or not. By default it is the current date.</p>
</td></tr>
<tr><td><code id="Get_BroadBand_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_BroadBand_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_BroadBand_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ultra - Broadband is defined as everlasting internet connection with a
maximum speed of 1 gigabit per second, with a minimum guaranteed speed of
100 megabits/second both on the uploading and downloading operations, until
the peering point is reached, as declared on the data provider's <a href="https://bandaultralarga.italia.it/scuole-voucher/progetto-scuole/">website</a>.
In the example the broadband availability at the beginning of school  year 2022/23 (1st september 2022) is shown.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. The variables <code>BB_Activation_date</code> and <code>BB_Activation_staus</code> indicate the activation date and activation status of the broadband connection at the selected date.
</p>


<h3>Source</h3>

<p><a href="https://bandaultralarga.italia.it/scuole-voucher/dashboard-scuole/">Broadband dashboard</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Broadband_220901 &lt;- Get_BroadBand(Date = as.Date("2022-09-01"), autoAbort = TRUE)

Broadband_220901

Broadband_220901[, c(9,6,13,14)]





</code></pre>

<hr>
<h2 id='Get_DB_MIUR'>Download the database of Italian public schools buildings</h2><span id='topic+Get_DB_MIUR'></span>

<h3>Description</h3>

<p>This function downloads the School Buildings Open Database provided by the Italian Ministry of Education, University and Research.
</p>
<p>It is one of the main sources of information regarding the infrastructure system of public schools in Italy.
For a given year, all available data are downloaded (except for the structural units section, which has a different level of detail) and gathered into a unique dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_DB_MIUR(
  Year = 2023,
  verbose = TRUE,
  input_Registry = NULL,
  input_AdmUnNames = NULL,
  show_col_types = FALSE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_DB_MIUR_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year (last available is 2023).
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>. <code>2022</code> by default (other databases are not currently available for 2023).</p>
</td></tr>
<tr><td><code id="Get_DB_MIUR_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_DB_MIUR_+3A_input_registry">input_Registry</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The school registry corresonding to the year in scope, obtained as output of the  function <code><a href="#topic+Get_Registry">Get_Registry</a></code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Get_DB_MIUR_+3A_input_admunnames">input_AdmUnNames</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The ISTAT file including all the codes and all the names of the administrative units for the year in scope, obtained as output of the function <code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>.
Only  necessary for school years 2015/16, 2017/18 and 2018/19.
If <code>NULL</code> and required, it will be downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Get_DB_MIUR_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_DB_MIUR_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function downloads the raw data; missing observations are not edited; all variables are characters. To edit the output of this function and convert the relevant variables to numeric or Boolean, please <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>.
Schools different from primary, middle or high schools are classified as <code>"NR"</code>. In the example, the data for school year 2022/23 are retrieved.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. All variables are characters.
</p>


<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Edilizia+Scolastica">Homepage</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  input_DB23_MIUR &lt;- Get_DB_MIUR(2023, autoAbort = TRUE)

  input_DB23_MIUR[-c(1,4,6,9)]




</code></pre>

<hr>
<h2 id='Get_InnerAreas'>Download the classification of peripheral municipalities</h2><span id='topic+Get_InnerAreas'></span>

<h3>Description</h3>

<p>Retrieves the classification of Italian municipalities into six categories; classes D, E, and F are the so-called internal/inner areas; classes A, B and C are the central areas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_InnerAreas(autoAbort = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_InnerAreas_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Classes are defined according to these criteria; see the methodological note (in Italian) for more detail:
</p>

<ul>
<li><p> A - Standalone pole municipalities, the highest degree of centrality;
they are characterised by a thorough and self-sufficient combined endowment of school, health and transport infrastructure,
i.e. there are at least a lyceum and a technical high school; a railway station of medium dimensions and a hospital provided with an emergency ward.
</p>
</li>
<li><p> B - Intermunicipality poles; the endowment of such infrastructures is complete if a small set of contiguous municipalities is considered
</p>
</li></ul>

<p>The remaining classes are defined in terms of the national distribution of the road distances from a municipality to the closest pole:
</p>

<ul>
<li><p> C - Belt municipalities, travel time below the median (&lt; 27'42&rdquo;) .
</p>
</li>
<li><p> D - Intermediate municipalities, travel time between the median and the third quartile (27'42&rdquo; - 40'54&rdquo;).
</p>
</li>
<li><p> E - Peripheral municipalities, travel time between the third quartile and 97.5th percentile (40'54&rdquo; - 1h 6' 54&rdquo;).
</p>
</li>
<li><p> F - Ultra-peripheral municipalities, travel time over the 97.5th percentile (&gt;1h 6' 54&rdquo;).
</p>
</li></ul>

<p>For more information regarding the dataset, it is possible to check the ISTAT methodological note (in Italian) available at &lt;https://www.istat.it/it/files//2022/07/FOCUS-AREE-INTERNE-2021.pdf&gt;
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
</p>


<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/273176&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

InnerAreas &lt;- Get_InnerAreas(autoAbort = TRUE)

InnerAreas[, c(1,9,13)]

</code></pre>

<hr>
<h2 id='Get_Invalsi_IS'>Download the Invalsi census survey data</h2><span id='topic+Get_Invalsi_IS'></span>

<h3>Description</h3>

<p>Downloads the full database of the Invalsi scores, detailed either at the municipality or province level.
The format is intermediate between long and short, since the numeric variables are:
</p>

<ul>
<li> <p><code>Average_percentage_score</code> Average direct score (percentage of sufficient tests)
</p>
</li>
<li> <p><code>Std_dev_percentage_score</code> Standard deviation of the direct score
</p>
</li>
<li> <p><code>WLE_average_score</code> Average WLE score. The WLE score is calculated through the Rasch's psychometric model and is suitable for middle and high schools in that it is cleaned from the effect of cheating  (which would affect both the average score and the score variability). By construction it has a mean around 200 points.
</p>
</li>
<li> <p><code>Std_dev_WLE_score</code> Standard deviation of the WLE score. By construction it ranges around 40 points at the school level.
</p>
</li>
<li> <p><code>Students_coverage</code> Students coverage percentage
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Get_Invalsi_IS(
  level = "LAU",
  verbose = TRUE,
  show_col_types = FALSE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_Invalsi_IS_+3A_level">level</code></td>
<td>
<p>Character. The level of aggregation of Invalsi census data. Either <code>"NUTS-3"</code>, <code>"Province"</code>, <code>"LAU"</code>, <code>"Municipality"</code>. <code>"LAU"</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Invalsi_IS_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Invalsi_IS_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Invalsi_IS_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>
</p>


<h3>Source</h3>

<p><a href="https://serviziostatistico.invalsi.it/invalsi_ss_data/dati-comunali-di-popolazione-comune-del-plesso/">Municipality data</a>;
<a href="https://serviziostatistico.invalsi.it/invalsi_ss_data/dati-provinciali-di-popolazione/">Province data</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Get_Invalsi_IS(level = "NUTS-3", autoAbort = TRUE)



</code></pre>

<hr>
<h2 id='Get_nstud'>Download students' number data</h2><span id='topic+Get_nstud'></span>

<h3>Description</h3>

<p>This functions downloads the data regarding the number of students, from the open website of the Italian Ministry of Education, University and Research
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_nstud(
  Year = 2023,
  filename = c("ALUCORSOETASTA", "ALUCORSOINDCLASTA"),
  verbose = TRUE,
  show_col_types = FALSE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_nstud_+3A_year">Year</code></td>
<td>
<p>Numeric or character. Reference school year  (last available is 2023).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022</code>. <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Get_nstud_+3A_filename">filename</code></td>
<td>
<p>Character. A string included in the name of the file to download.
By default it is <code>c("ALUCORSOETASTA", "ALUCORSOINDCLASTA")</code>, which are the file names used so far for the number of students by age and the number of studentsin public schools  by age and class.
</p>
<p>Other file names are the following. The output is not currently supported by the remainder of the functions involving the number of students.
</p>
<p><code>"ALUITASTRACITSTA"</code> for the number of Italian and foreing students in public schools
</p>
<p><code>"ALUSECGRADOINDSTA"</code> for the number of students of public schools by high school address
</p>
<p><code>"ALUTEMPOSCUOLASTA"</code> for the number of students of public schools by school running time
</p>
<p><code>"ALUCORSOETAPAR"</code>, <code>"ALUCORSOINDCLAPAR"</code>, <code>"ALUITASTRACITPAR"</code>, <code>"ALUSECGRADOINDPAR"</code>, <code>"ALUTEMPOSCUOLAPAR"</code> for the data of the previous file but referring to private schools.</p>
</td></tr>
<tr><td><code id="Get_nstud_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_nstud_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_nstud_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default, a list of two <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code> objects:
</p>

<ul>
<li> <p><code>$ALUCORSOETASTA</code>: The number of students by school, school grade and age. It provides a higher number of school than the other element
</p>
</li>
<li> <p><code>$ALUCORSOINDCLASTA</code>: The number of students and classes by school and school grade. This is a long-format dataframe.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Studenti">Homepage</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  Get_nstud(2023, filename = "ALUCORSOINDCLASTA", autoAbort = TRUE)




</code></pre>

<hr>
<h2 id='Get_nteachers_prov'>Download the number of teachers in Italian schools by province</h2><span id='topic+Get_nteachers_prov'></span>

<h3>Description</h3>

<p>This functions downloads the number of teachers by province from the open website of the Italian Ministry of Education, University and Research.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_nteachers_prov(
  Year = 2023,
  verbose = TRUE,
  show_col_types = FALSE,
  filename = c("DOCTIT", "DOCSUP"),
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_nteachers_prov_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year for the school registry data (last available is 2023).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022.</code> <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Get_nteachers_prov_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_nteachers_prov_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the 'verbose' argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_nteachers_prov_+3A_filename">filename</code></td>
<td>
<p>Character. Which data to retrieve among the province counts of teachers/school personnel.
By default it is <code>c("DOCTIT", "DOCSUP")</code>, which are the file names used so far for the number of tenured and temporary teachers respectively.
Other file names are the following:
</p>
<p><code>"ATATIT"</code> for the number of tenured non-teaching personnel
</p>
<p><code>"ATASUP"</code> for the number of temporary non-teaching personnel</p>
</td></tr>
<tr><td><code id="Get_nteachers_prov_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please notice that by default, the function returns the count of the number of tenured and temporary teachers.
If either the count of non-teaching personnel or the count of a single category of teaching personnel is needed, please adapt
the <code>filename</code> argument accordingly.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
</p>


<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Personale+Scuola">Homepage</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

nteachers23 &lt;- Get_nteachers_prov(2023, filename = "DOCTIT", autoAbort = TRUE)
nteachers23[, c(3,4,5)]


</code></pre>

<hr>
<h2 id='Get_Registry'>Download the registry of Italian public schools from the school registry section</h2><span id='topic+Get_Registry'></span>

<h3>Description</h3>

<p>This function returns two main pieces of information regarding Italian schools, namely:
</p>

<ul>
<li><p> The denomination of the region, province and municipality to which the school belongs.
</p>
</li>
<li><p> The mechanographical code to the reference institute of each school.
</p>
</li></ul>

<p>It is possible to access schools in all the national territory, including the autonomous provinces of Aosta, Trento and Bozen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Registry(
  Year = 2023,
  filename = c("SCUANAGRAFESTAT", "SCUANAAUTSTAT"),
  show_col_types = FALSE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_Registry_+3A_year">Year</code></td>
<td>
<p>Numeric or character. Reference school year (last available is 2024).
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>. <code>2023</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Registry_+3A_filename">filename</code></td>
<td>
<p>Character. A string included in the name of the file to download, identifying the schools included.
By default it is <code>c("SCUANAGRAFESTAT", "SCUANAAUTSTAT")</code>, i.e. the file names used for public school registries,
respectively across all the national territory except for the autonomous provinces of Aosta, Trento or Bozen, and only in the three
If instead the registry of the private schools is needed, please insert <code>"SCUANAGRAFEPAR"</code> and/or <code>"SCUANAAUTPAR"</code>.
</p>
<p>For the registry of private schools, either in all the national territory except for the aforementioned provinces, and for these provinces, please use <code>"SCUANAGRAFEPAR"</code> and <code>"SCUANAAUTPAR"</code> respectively. Please notice that data regarding private schools are not available for most functions in this package.</p>
</td></tr>
<tr><td><code id="Get_Registry_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Registry_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Schools different from primary, middle or high schools are classified as <code>"NR"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
</p>


<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Scuole">Homepage</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  Get_Registry(2024, filename = "SCUANAGRAFESTAT", autoAbort = TRUE)





</code></pre>

<hr>
<h2 id='Get_RiskMap'>Download the Map of Risks of Italian Municipality</h2><span id='topic+Get_RiskMap'></span>

<h3>Description</h3>

<p>This functions downloads a broad set of indicators covering several categories of risks to which Italian municipalities are exposed. It includes mostly geographical, demographic and urbanistic information. The dataset is static and it dates back to Jan 1st 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_RiskMap(verbose = TRUE, metadata = FALSE, autoAbort = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_RiskMap_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_RiskMap_+3A_metadata">metadata</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function returns also the list of variables with the relevant explanations. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_RiskMap_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>By default, an object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
</p>


<h3>Source</h3>

<p>&lt;https://www.istat.it/mappa-rischi/getReport.php&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



  Get_RiskMap(autoAbort = TRUE)[-c(1:5)]


</code></pre>

<hr>
<h2 id='Get_School2mun'>Associate a Municipality (LAU) code to each school</h2><span id='topic+Get_School2mun'></span>

<h3>Description</h3>

<p>This function associates the relevant municipality codes to all the schools listed in the two main registries provided by the Italian Ministry of Education, University and Research, namely:
</p>

<ul>
<li><p> The registry of school buildings, here referred to as <code>Registry1</code> (<code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code>)
</p>
</li>
<li><p> The official schools registry, here referred to as <code>Registry2</code> (see <code><a href="#topic+Get_Registry">Get_Registry</a></code>)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Get_School2mun(
  Year = 2023,
  show_col_types = FALSE,
  verbose = TRUE,
  input_AdmUnNames = NULL,
  input_Registry2 = NULL,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_School2mun_+3A_year">Year</code></td>
<td>
<p>Numeric or character value (last available is 2023).
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023.</code> <code>2023</code> by default.</p>
</td></tr>
<tr><td><code id="Get_School2mun_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_School2mun_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_School2mun_+3A_input_admunnames">input_AdmUnNames</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>
The ISTAT file including all the administrative units codes for the year in scope.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Get_School2mun_+3A_input_registry2">input_Registry2</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_Registry">Get_Registry</a></code>
The school registry corresonding to the year in scope.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Get_School2mun_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>list</code>, including 4 elements:
</p>

<ul>
<li> <p><code>$Registry1</code>: Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the schools listed in the buildings registry
</p>
</li>
<li> <p><code>$Registry2</code>: Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the schools listed in the schools registry
</p>
</li>
<li> <p><code>$Any</code>: Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: schools listed anywhere
</p>
</li>
<li> <p><code>$Both</code>: Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: schools listed in both the sections
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0101EDIANAGRAFESTA2021">Buildings registry (2021 onwards)</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0200EDIANAGRAFESTA">Buindings registry(until 2019)</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/?area=Scuole">Schools registry</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Get_School2mun(Year = 2023, autoAbort = TRUE)



</code></pre>

<hr>
<h2 id='Get_Shapefile'>Download the boundaries of NUTS-3 (Provinces) and LAU (Municipalities) Italian administrative units from the ISTAT website</h2><span id='topic+Get_Shapefile'></span>

<h3>Description</h3>

<p>'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_Shapefile(Year, level = "LAU", lightShp = TRUE, autoAbort = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get_Shapefile_+3A_year">Year</code></td>
<td>
<p>Numeric value. Reference year for the administrative units.</p>
</td></tr>
<tr><td><code id="Get_Shapefile_+3A_level">level</code></td>
<td>
<p>Character. Either <code>"NUTS-3"</code>, <code>"Province"</code>, <code>"LAU"</code>, <code>"Municipality"</code>. <code>"LAU"</code> by default</p>
</td></tr>
<tr><td><code id="Get_Shapefile_+3A_lightshp">lightShp</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function downloads a generalised, i.e.less detailed, and lighter version of the shapefiles.
<code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Get_Shapefile_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. Whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A spatial data frame of class <code>data.frame</code> and <code>sf</code>.
</p>


<h3>Source</h3>

<p>&lt;https://www.istat.it/it/archivio/222527&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  library(magrittr)


  Prov23_shp &lt;- Get_Shapefile(2023, lightShp = TRUE, level = "NUTS-3", autoAbort = TRUE)
  ggplot2::ggplot() + ggplot2::geom_sf(data = Prov23_shp) +
    ggplot2::ggtitle("Italian provinces in 2023/01/01")
 


</code></pre>

<hr>
<h2 id='Group_DB_MIUR'>Aggregate the database of Italian public schools buildings at the municipality and province level</h2><span id='topic+Group_DB_MIUR'></span>

<h3>Description</h3>

<p>This function transforms the output of the <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code> function (which is detailed at the level of single school buildings) at the municipality/LAU and province/NUTS-3 level.
It also allows the user to classify the grade of centrality of municipalities through the variable  <code>Inner_area</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Group_DB_MIUR(
  data = NULL,
  Year = 2023,
  count_units = TRUE,
  countname = "nbuildings",
  count_missing = TRUE,
  verbose = TRUE,
  track_deleted = TRUE,
  InnerAreas = TRUE,
  ord_InnerAreas = FALSE,
  input_InnerAreas = NULL,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Group_DB_MIUR_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. The database of school buildings, preferably already converted to numeric, obtained via <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code></p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_year">Year</code></td>
<td>
<p>Numeric or Character. The reference school year, if either <code>data</code> or <code>input_InnerAreas</code> must be retrieved.
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>.
Important: use the same <code>Year</code> argument used to retrieve the input school buildings data if they are provided as input. <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_count_units">count_units</code></td>
<td>
<p>Logical. Whether the rows to aggregate at each level must be counted or not. True by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_countname">countname</code></td>
<td>
<p>character. The name of the variable indicating the number of schools included in each municipality of province,
if the argument 'count' is <code>TRUE</code>. <code>"nbuildings"</code>  by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_count_missing">count_missing</code></td>
<td>
<p>Logical. Whether the function should return two dataframes including the percentage of NAs in the <code>data</code> object at the territorial level. <code>TRUE</code> by default</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_track_deleted">track_deleted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function returns the IDs of schools not included. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_innerareas">InnerAreas</code></td>
<td>
<p>Logical. Whether an indicator of the percentage of schools belonging to peripheral (Inner) areas mus be included or not.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_ord_innerareas">ord_InnerAreas</code></td>
<td>
<p>Logical. Whether the Inner areas classification should be treated as an ordinal variable rather than as a binary one (see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> for the classification).
Please notice than the function creates a column for each class, and if this database must be used in a statistical model, one of the 6 resulting columns must be dropped.
False by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_input_innerareas">input_InnerAreas</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The classification of peripheral municipalities, needed only if <code>InnerAreas == TRUE</code>, obtained as output of the <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> function.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_DB_MIUR_+3A_...">...</code></td>
<td>
<p>Additional arguments to the function <code>Util_DB_MIUR_num</code> in case no data are provided or data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical variables are summarised by the mean; Boolean variables are summarised by the mean as well, thus they become frequency indicators.
Qualitative values, if included, are summarised by the mode. Summary measures do not include NAs.
The output dataframes are also detailed at the school order level (i.e. Primary, Midde, High school, or different orders). This means that rows are unique combinations of territorial unities and school order.
</p>


<h3>Value</h3>

<p>An object of class <code>list</code> including:
</p>

<ul>
<li> <p><code>$Municipality_data</code>:
object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, the output dataframe detailed at the municipality level;
all variables besides the first 5 (which identify the record) are numeric
</p>
</li>
<li> <p><code>$Province_data</code>: object of class 'tbl_df', 'tbl' and 'data.frame', the output dataframe detailad at the province level;
all variables besides the first 3 (which identify the record) are numeric
</p>
</li>
<li> <p><code>$Municipality_missing</code> (Only if <code>count_missing == TRUE</code>); object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, the percentage of NAs in each variable at the municipality level.
</p>
</li>
<li> <p><code>$Province_missing</code>: (Only if <code>count_missing == TRUE</code>); object of class 'tbl_df', 'tbl' and 'data.frame', the percentage of NAs in each variable at the province level.
</p>
</li>
<li> <p><code>$deleted</code>: character vector. The schools removed from the original dataframe for data quality reasons. This object is returned only if <code>track_deleted == TRUE</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

library(magrittr)
DB23_MIUR &lt;- example_input_DB23_MIUR %&gt;% Util_DB_MIUR_num(verbose = FALSE) %&gt;%
    Group_DB_MIUR(InnerAreas = FALSE)



DB23_MIUR$Municipality_data[, -c(1,2,4)]
summary(DB23_MIUR$Municipality_data)

DB23_MIUR$Province_data[, -c(1,3)]
summary(DB23_MIUR$Province_data)





</code></pre>

<hr>
<h2 id='Group_nstud'>Aggregate the students number data by class at the municipality and province level</h2><span id='topic+Group_nstud'></span>

<h3>Description</h3>

<p>This function creates two dataframes with the number of students, classes and students by class, aggregated at the province and municipality level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Group_nstud(
  data = NULL,
  Year = 2023,
  check = TRUE,
  verbose = TRUE,
  check_registry = "Any",
  InnerAreas = TRUE,
  ord_InnerAreas = FALSE,
  check_ggplot = FALSE,
  missing_to_1 = FALSE,
  input_Registry2 = NULL,
  input_InnerAreas = NULL,
  input_Prov_shp = NULL,
  input_School2mun = NULL,
  input_AdmUnNames = NULL,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Group_nstud_+3A_data">data</code></td>
<td>
<p>Either an object of class <code>list</code>, obtained as output of the <code><a href="#topic+Get_nstud">Get_nstud</a></code> function,
or an object of class class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code> function,
if <code>NULL</code>, the function will download it automatically but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. The reference school year, if either of the <code>input_</code> arguments must be retrieved.
Available in the formats: <code>2022</code>, <code>"2022/2023"</code>, <code>"202223"</code>, <code>"20222023"</code>. <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_check">check</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function runs the test of the students number availability across all school included in the school registries (see <code><a href="#topic+Util_Check_nstud_availability">Util_Check_nstud_availability</a></code>). <code>TRUE</code> by default</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_check_registry">check_registry</code></td>
<td>
<p>Character. If <code>check == TRUE</code>, the school registries included in the <code>input_School2mun</code> object (see <code><a href="#topic+Get_School2mun">Get_School2mun</a></code>) whose availability has to be checked. Either <code>"Registry1"</code> (buildings section), <code>"Registry2"</code> (registry section), <code>"Any"</code> or <code>"Both"</code>. <code>"Any"</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_innerareas">InnerAreas</code></td>
<td>
<p>Logical. If <code>check == TRUE</code>, Whether it must be checked if municipalities belong to Inner areas or not. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_ord_innerareas">ord_InnerAreas</code></td>
<td>
<p>Logical. If <code>check == TRUE</code> and <code>InnerAreas == TRUE</code>, whether the Inner areas classification should be treated as an ordinal variable rather than as a categorical one (see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> for the classification).
<code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_check_ggplot">check_ggplot</code></td>
<td>
<p>Logical. If <code>check == TRUE</code>, whether to display or not a static map of the availability of the students number by province; see also <code><a href="#topic+Util_Check_nstud_availability">Util_Check_nstud_availability</a></code>. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_missing_to_1">missing_to_1</code></td>
<td>
<p>Logical. Only needed if <code>data</code> is not provided in wide format. Whether the number of classes should be imputed to 1 when it is missing; see <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code>. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_input_registry2">input_Registry2</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_Registry">Get_Registry</a></code>
If <code>check == TRUE</code>, the school registry from the registry section.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_input_innerareas">input_InnerAreas</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The classification of peripheral municipalities, obtained as output of the <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> function.
Needed only if <code>check == TRUE</code> and <code>InnerAreas == TRUE</code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_input_prov_shp">input_Prov_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>. The relevant shapefile of Italian municipalities, if both the <code>check</code> and <code>check_ggplot</code> options are chosen.
If <code>NULL</code> it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_input_school2mun">input_School2mun</code></td>
<td>
<p>Object of class <code>list</code> with elements of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_School2mun">Get_School2mun</a></code>.
The mapping from school codes to municipality (and province) codes. Needed only if 'check == TRUE'.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_input_admunnames">input_AdmUnNames</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>
The ISTAT file including all the codes and the names of the administrative units for the year in scope.
Only needed if <code>check == TRUE</code> and the argument <code>input_School2mun</code> is <code>NULL</code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_nstud_+3A_...">...</code></td>
<td>
<p>Additional arguments to the function <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code> if <code>data</code> is not provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical variables are summarised by the mean; Boolean variables are summarised by the mean as well, thus they become frequency indicators.
Qualitative values, if included, are summarised by the mode. Summary measures do not include NAs.
</p>


<h3>Value</h3>

<p>An object of class <code>list</code> including:
</p>

<ul>
<li> <p><code>$Municipality_data</code>:
object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, the output dataframe detailed at the municipality level
</p>
</li>
<li> <p><code>$Province_data</code>: object of class 'tbl_df', 'tbl' and 'data.frame', the output dataframe detailad at the province level
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>Year &lt;- 2023

nstud23_aggr &lt;- Group_nstud(data = example_input_nstud23, Year = Year,
                           input_Registry2 = example_input_Registry23,
                           InnerAreas = FALSE,  input_School2mun = example_School2mun23)

summary(nstud23_aggr$Municipality_data[,c(46,47,48)])

summary(nstud23_aggr$Province_data[,c(44,45,46)])


</code></pre>

<hr>
<h2 id='Group_teachers4stud'>Arrange the number of teachers per students in public Italian schools at the province level</h2><span id='topic+Group_teachers4stud'></span>

<h3>Description</h3>

<p>This function provides the average number of teachers per students in Italian public schools at the province level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Group_teachers4stud(
  Year = 2023,
  input_nteachers = NULL,
  nteachers_filename = c("DOCTIT", "DOCSUP"),
  verbose = TRUE,
  input_nstud_raw = NULL,
  input_nstud_aggr = NULL,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Group_teachers4stud_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year for the school registry data (last available is 2022).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022</code>. <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_input_nteachers">input_nteachers</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. The number of teachers by province, obtained as output of the function <code><a href="#topic+Get_nteachers_prov">Get_nteachers_prov</a></code>. If <code>NULL</code>, the function will download it automatically but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_nteachers_filename">nteachers_filename</code></td>
<td>
<p>Character. If <code>input_nteachers</code> is not provided, which data to retrieve regarding the number of teachers/personnel; see <code><a href="#topic+Get_nteachers_prov">Get_nteachers_prov</a></code>
<code>c("DOCTIT", "DOCSUP")</code> by default, i.e. tenured theachers and temporary teachers.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. TRUE by default.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_input_nstud_raw">input_nstud_raw</code></td>
<td>
<p>Object of class 'list', including two objects of class <code>tbl_df</code>', <code>tbl</code> and <code>data.frame</code>, obtainded as output of the <code><a href="#topic+Get_nstud">Get_nstud</a></code> function with the default <code>filename</code> parameter.
Not necessary if the argument <code>input_nstud_aggr</code> is provided. If <code>NULL</code>, the function will download it automatically but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_input_nstud_aggr">input_nstud_aggr</code></td>
<td>
<p>Object of class <code>list</code>, including two objects of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Group_nstud">Group_nstud</a></code>. If <code>NULL</code>, the function will compute it manually but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Group_teachers4stud_+3A_...">...</code></td>
<td>
<p>Arguments to <code><a href="#topic+Group_nstud">Group_nstud</a></code> if argument <code>input_nstud_aggr</code> is not provided</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


  input_nstud23 &lt;- Get_nstud(2023, filename ="ALUCORSOINDCLASTA", autoAbort = TRUE)
  Registry23 &lt;- Get_Registry(2023, autoAbort = TRUE)
  School2mun23 &lt;- Get_School2mun(2023, input_Registry = Registry23, autoAbort = TRUE)


  nstud23.aggr &lt;- Group_nstud(Year = 2023, data = input_nstud23,
    input_Registry2 = Registry23, input_School2mun = School2mun23,
    autoAbort = TRUE)

  input_nteachers23 &lt;- Get_nteachers_prov(2023, autoAbort = TRUE)

  teachers4stud &lt;- Group_teachers4stud(Year = 2023,
                   input_nteachers = input_nteachers23,
                   input_nstud_aggr = nstud23.aggr, autoAbort = TRUE)

  teachers4stud[, -c(1, 2, 10, 11)]

  summary(teachers4stud)


</code></pre>

<hr>
<h2 id='Map_DB'>Map school data</h2><span id='topic+Map_DB'></span>

<h3>Description</h3>

<p>This function displays a map of the data arranged trough the function <code><a href="#topic+Set_DB">Set_DB</a></code>.
It supports two kinds of map:
</p>

<ul>
<li><p> Interactive map (default option), which allows the user to visualize all the data in scope through the interactive popup, and
</p>
</li>
<li><p> Static map (ggplot), which can be easily exported in <code>.pdf</code> objects.
</p>
</li></ul>

<p>The user must select a variable to display.
It is possible to insert either a readily-downloaded database obtained through the function <code><a href="#topic+Set_DB">Set_DB</a></code> or the basic inputs to plug in that function, other than an input shapefile. Relevant arguments not provided by the user will be download automatically, but not saved into the global environment. However we suggest to plug in at least some inputs, as otherwise the running time may be long.
This function generalises the functionalities of the more data-specific functions <code><a href="#topic+Map_School_Buildings">Map_School_Buildings</a></code> and <code><a href="#topic+Map_Invalsi">Map_Invalsi</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Map_DB(
  data = NULL,
  Year = 2023,
  field,
  level = "LAU",
  plot = "mapview",
  popup_height = 200,
  col_rev = FALSE,
  pal = "Blues",
  input_shp = NULL,
  region_code = c(1:20),
  main_pos = "top",
  main = "",
  order = NULL,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Map_DB_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl.df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the <code><a href="#topic+Set_DB">Set_DB</a></code> function. If NULL, it will be arranged automatically but not saved into the global environment. NULL by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_year">Year</code></td>
<td>
<p>Numeric or Character. The reference school year, needed if either <code>data</code> or <code>input_shp</code> are not provided.
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>.  <code>2023</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_field">field</code></td>
<td>
<p>Character. The variable to display in the map.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_level">level</code></td>
<td>
<p>Character. The administrative level of detailed at which the target variable must be displayed. Either <code>"LAU"</code>/<code>"Municipality"</code> or <code>"NUTS-3"</code>/<code>"Province"</code>. If the <code>"data"</code> argument is plugged in, please select the same level. <code>"LAU"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_plot">plot</code></td>
<td>
<p>Character. The type of map to display; either <code>"mapview"</code> for interactive maps, or <code>"ggplot"</code> for static maps. <code>"mapview"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_popup_height">popup_height</code></td>
<td>
<p>Numeric. The height of the popup table in terms of pixels if the <code>"mapview"</code> mode is chosen. <code>200</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_col_rev">col_rev</code></td>
<td>
<p>Logical. Whether the scale of the colour palette should be reverted or not. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_pal">pal</code></td>
<td>
<p>Character. The palette to use if the <code>"mapview"</code> mode is chose. <code>"Blues"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_input_shp">input_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl.df</code>, <code>tbl</code> and <code>data.frame</code>. The relevant shapefiles of Italian administrative boundaries,
at the selected level of detail (LAU or NUTS-3). If <code>NULL</code>, it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_region_code">region_code</code></td>
<td>
<p>Numeric. The NUTS-2 codes of the units that must be displayed.
If the level is set to <code>"LAU"</code>, choosing a limited number of regions is recommended.
By default, <code>c(1,3,5:20)</code>, i.e. all Italian regions except the provinces of Aosta, Trento and Bozen which have data availability issues.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_main_pos">main_pos</code></td>
<td>
<p>Character.Where the header should be placed if the <code>ggplot</code> mode is chosen.
The header is located on the top if <code>"top"</code> is given as input, and above the legend scale otherwise. <code>"top"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_main">main</code></td>
<td>
<p>Character. The title to display in the <code>"ggplot"</code> rendering options.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_order">order</code></td>
<td>
<p>Character. The educational level. Either <code>"Primary"</code> (primary school), <code>"Middle"</code> (middle school), or <code>"High"</code> (high school).
If the data include the Invalsi census survey, please select a level consistent with the chosen educational grade. <code>"Media"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Map_DB_+3A_...">...</code></td>
<td>
<p>Additional arguments for the input database, if not provided; see <code><a href="#topic+Set_DB">Set_DB</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>plot == "mapview"</code>, an object of class <code>mapview</code>. Otherwise, if <code>plot == "ggplot"</code>, an object of class <code>gg</code> and <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


DB23 &lt;- Set_DB(Year = 2023, level = "NUTS-3",
       Invalsi_grade = c(10,13), NA_autoRM = TRUE,
       input_Invalsi_IS = example_Invalsi23_prov, input_nstud = example_input_nstud23,
       input_InnerAreas = example_InnerAreas,
       input_School2mun = example_School2mun23,
       input_AdmUnNames = example_AdmUnNames20220630,
       nteachers = FALSE, BroadBand = FALSE, SchoolBuildings = FALSE)




Map_DB(DB23, field = "Students_per_class_13", input_shp = example_Prov22_shp, level = "NUTS-3",
 col_rev = TRUE, plot = "ggplot")

Map_DB(DB23, field = "Inner_area", input_shp = example_Prov22_shp, order = "High",
 level = "NUTS-3",col_rev = TRUE, plot = "ggplot")

Map_DB(DB23, field = "M_Mathematics_10", input_shp = example_Prov22_shp, level = "NUTS-3",
 plot = "ggplot")


</code></pre>

<hr>
<h2 id='Map_Invalsi'>Display a map of Invalsi scores</h2><span id='topic+Map_Invalsi'></span>

<h3>Description</h3>

<p>This function displays either a static or interactive map of the Invalsi scores, either at the municipality or province level.
It supports two kinds of map:
</p>

<ul>
<li><p> Interactive map (default option), which allows the user to visualize all the data in scope through the interactive popup, and
</p>
</li>
<li><p> Static map (ggplot), which can be easily exported in <code>.pdf</code> objects.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Map_Invalsi(
  Year = 2023,
  data = NULL,
  subj_toplot = "ITA",
  grade = 8,
  level = "LAU",
  main = "",
  main_pos = "top",
  region_code = c(1:20),
  plot = "mapview",
  pal = "Blues",
  WLE = FALSE,
  col.rev = FALSE,
  popup_height = 200,
  verbose = TRUE,
  input_shp = NULL,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Map_Invalsi_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year for the data (last available is 2022/23).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022</code>. <code>2022</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The raw Invalsi survey data that has to be filtered, obtained as output of the <code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code> function.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_subj_toplot">subj_toplot</code></td>
<td>
<p>Character. The school subject to display in the map,
The school subject to include, one among:
<code>"Englis_listening"</code>/<code>"ELI"</code>, <code>"English_reading"</code>/<code>"ERE"</code>, <code>"Italian"</code>/<code>"ITA"</code> and <code>"Mathematics"</code>/<code>"MAT"</code>. <code>"ITA"</code> (Italian) by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_grade">grade</code></td>
<td>
<p>Numeric. The school grade to chose. Either <code>2</code> (2nd year of primary school), <code>5</code> (last year of primary school), <code>8</code> (last year of middle shcool), <code>10</code> (2nd year of high school) or <code>13</code> (last year of school). <code>8</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_level">level</code></td>
<td>
<p>Character. The level of aggregation of Invalsi census data. Either <code>"NUTS-3"</code>, <code>"Province"</code>, <code>"LAU"</code>, <code>"Municipality"</code>.
If an input dataframe is provided, please select the same level of aggregation.
<code>"LAU"</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_main">main</code></td>
<td>
<p>Character. A customary title to the map. If <code>NULL</code>, the title will mention: subject, year and school grade. Empty by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_main_pos">main_pos</code></td>
<td>
<p>Character.Where the header should be placed if the <code>ggplot</code> mode is chosen.
The header is located on the top if <code>"top"</code> is given as input, and above the legend scale otherwise. <code>"top"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_region_code">region_code</code></td>
<td>
<p>Numeric. The NUTS-2 codes of the units that must be displayed.
If the level is set to <code>"LAU"</code>, choosing a limited number of regions is recommended.
By default, <code>c(1,3,5:20)</code>, i.e. all Italian regions except the provinces of Aosta, Trento and Bozen which have data availability issues.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_plot">plot</code></td>
<td>
<p>Character. The type of map to display; either <code>"mapview"</code> for interactive maps, or <code>"ggplot"</code> for static maps. <code>"mapview"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_pal">pal</code></td>
<td>
<p>Character. The palette to use if the <code>"mapview"</code> mode is chose. <code>"Blues"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_wle">WLE</code></td>
<td>
<p>Logical. Whether the variable to chose should be the average WLE score rather that the percentage of sufficient tests, if both are available. <code>FALSE</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_col.rev">col.rev</code></td>
<td>
<p>Logical. Whether the scale of the colour palette should be reverted or not, if the <code>mapview</code> mode is chosen. <code>FALSE</code> by default</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_popup_height">popup_height</code></td>
<td>
<p>Numeric. The height of the popup table in terms of pixels if the <code>"mapview"</code> mode is chosen. <code>200</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_input_shp">input_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>. The relevant shapefiles of Italian administrative boudaries,
at the selected level of detail (LAU or NUTS-3). If <code>NULL</code>, it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Map_Invalsi_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>plot == "mapview"</code>, an object of class <code>mapview</code>. Otherwise, if <code>plot == "ggplot"</code>, an object of class <code>gg</code> and <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



 Map_Invalsi(subj = "Italian", grade = 13, level = "NUTS-3", Year = 2023, WLE = FALSE,
  data = example_Invalsi23_prov, input_shp = example_Prov22_shp, plot = "ggplot")

 Map_Invalsi(subj = "Italian", grade = 5, level = "NUTS-3", Year = 2023, WLE = TRUE,
  data = example_Invalsi23_prov, input_shp = example_Prov22_shp, plot = "ggplot")





</code></pre>

<hr>
<h2 id='Map_School_Buildings'>Display data fom the school buildings database</h2><span id='topic+Map_School_Buildings'></span>

<h3>Description</h3>

<p>This function displays a map of the data downloaded trough the <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code> function.
It supports two kinds of map:
</p>

<ul>
<li><p> Interactive map (default option), which allows the user to visualize all the data in scope through the interactive popup, and
</p>
</li>
<li><p> Static map (ggplot), which can be easily exported in <code>.pdf</code> objects.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Map_School_Buildings(
  data = NULL,
  field,
  order = NULL,
  level = "LAU",
  region_code = c(1:20),
  plot = "mapview",
  pal = "Blues",
  col_rev = FALSE,
  popup_height = 200,
  main_pos = "top",
  main = "",
  verbose = TRUE,
  input_shp = NULL,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Map_School_Buildings_+3A_data">data</code></td>
<td>
<p>Object of class <code>list</code> or <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. Input data obtained as output of the function <code><a href="#topic+Group_DB_MIUR">Group_DB_MIUR</a></code>
If NULL, it will be downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_field">field</code></td>
<td>
<p>Character. The variable to display in the map.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_order">order</code></td>
<td>
<p>Character. The school order. Either <code>"Primary"</code>, <code>"Middle"</code>, or <code>"High"</code> (high school).
If <code>NULL</code>, an average of the three school orders will be displayed for the target variable. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_level">level</code></td>
<td>
<p>Character. The administrative level of detailed at which the target variable must be displayed.
Either <code>"LAU"</code>/<code>"Municipality"</code> or <code>"NUTS-3"</code>/<code>"Province"</code>. <code>"LAU"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_region_code">region_code</code></td>
<td>
<p>Numeric. The NUTS-2 codes of the units that must be displayed.
If the level is set to <code>"LAU"</code>, choosing a limited number of regions is recommended.
By default, <code>c(1:20)</code>, i.e. all Italian regions.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_plot">plot</code></td>
<td>
<p>Character. The type of map to display; either <code>"mapview"</code> for interactive maps, or <code>"ggplot"</code> for static maps. <code>"mapview"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_pal">pal</code></td>
<td>
<p>Character. The palette to use if the <code>"mapview"</code> mode is chose. <code>"Blues"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_col_rev">col_rev</code></td>
<td>
<p>Logical. Whether the scale of the colour palette should be reverted or not, if the <code>"mapview"</code> mode is chosen. <code>FALSE</code> by default</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_popup_height">popup_height</code></td>
<td>
<p>Numeric. The height of the popup table in terms of pixels if the <code>"mapview"</code> mode is chosen. <code>200</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_main_pos">main_pos</code></td>
<td>
<p>Character. Where the header should be placed if the <code>ggplot</code> mode is chosen.
The header is located on the top if <code>"top"</code> is given as input, and above the legend scale otherwise. <code>"top"</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_main">main</code></td>
<td>
<p>Character. The customary title to display in the <code>"ggplot"</code> rendering options</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.s</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_input_shp">input_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>. The relevant shapefiles of Italian administrative boudaries,
at the selected level of detail (LAU or NUTS-3). If <code>NULL</code> it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Map_School_Buildings_+3A_...">...</code></td>
<td>
<p>If <code>data</code> is not provided, the arguments to <code><a href="#topic+Group_DB_MIUR">Group_DB_MIUR</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>plot == "mapview"</code>, an object of class <code>mapview</code>. Otherwise, if <code>plot == "ggplot"</code>, an object of class <code>gg</code> and <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>




  library(magrittr)

  DB23_MIUR &lt;- example_input_DB23_MIUR %&gt;%
    Util_DB_MIUR_num(track.deleted = FALSE) %&gt;%
    Group_DB_MIUR(InnerAreas = FALSE, count_missing = FALSE)

  DB23_MIUR %&gt;% Map_School_Buildings(field = "School_bus",
     order = "Primary",level = "NUTS-3",  plot = "ggplot",
     input_shp = example_Prov22_shp)

  DB23_MIUR %&gt;% Map_School_Buildings(field = "Railway_transport",
     order = "High",level = "NUTS-3", plot = "ggplot",
     input_shp = example_Prov22_shp)

  DB23_MIUR %&gt;% Map_School_Buildings(field = "Context_without_disturbances",
     order = "Middle",level = "NUTS-3", plot = "ggplot",
     input_shp = example_Prov22_shp, col_rev = TRUE)





</code></pre>

<hr>
<h2 id='Set_DB'>Build up a comprehensive database regarding the school system</h2><span id='topic+Set_DB'></span>

<h3>Description</h3>

<p>This function generates a unique dataframe of the school system data including a customary choice of available datasets. This function allows the user to aggregate the desired datasets, when available, among these:
</p>

<ul>
<li><p> Invalsi census survey
</p>
</li>
<li><p> School buildings
</p>
</li>
<li><p> Number of students and school classes
</p>
</li>
<li><p> Number of teachers
</p>
</li>
<li><p> Broadband connection availability
</p>
</li></ul>

<p>In addition to these, it is possible to download also the Map of Risks of Italian municipalities, which is a static dataset updated to 2018/01/01 and including several social, geographic and demographic variables (see <code><a href="#topic+Get_RiskMap">Get_RiskMap</a></code>.
To save as much time as possible it is possible to plug in ready-made input data; otherwise they will be downloaded automatically but not saved in the global environment
When a new dataset is joined to the existing ones, it is possible that some observations in this datasets are missing. In this case, by default, the choice of keeping as much observational units as possible, or to remove units with missing variables is left to the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Set_DB(
  Year = 2023,
  level = "LAU",
  conservative = TRUE,
  Invalsi = TRUE,
  SchoolBuildings = TRUE,
  nstud = TRUE,
  nteachers = TRUE,
  BroadBand = TRUE,
  RiskMap = FALSE,
  verbose = TRUE,
  show_col_types = FALSE,
  Invalsi_subj = c("ELI", "ERE", "ITA", "MAT"),
  Invalsi_grade = c(2, 5, 8, 10, 13),
  Invalsi_WLE = FALSE,
  SchoolBuildings_include_numerics = TRUE,
  SchoolBuildings_include_qualitatives = FALSE,
  SchoolBuildings_row_cutout = FALSE,
  SchoolBuildings_col_cut_thresh = 20000,
  SchoolBuildings_flag_outliers = TRUE,
  SchoolBuildings_count_missing = FALSE,
  nstud_imputation_thresh = 19,
  nstud_missing_to_1 = FALSE,
  UB_nstud_byclass = 99,
  LB_nstud_byclass = 1,
  InnerAreas = TRUE,
  ord_InnerAreas = FALSE,
  nstud_check = TRUE,
  nstud_check_registry = "Any",
  BroadBand_impute_missing = TRUE,
  Date = as.Date(paste0(substr(year.patternA(Year), 1, 4), "-09-01")),
  NA_autoRM = NULL,
  input_Invalsi_IS = NULL,
  input_Registry = NULL,
  input_SchoolBuildings = NULL,
  input_nstud = NULL,
  input_School2mun = NULL,
  input_AdmUnNames = NULL,
  input_InnerAreas = NULL,
  input_teachers4student = NULL,
  input_nteachers = NULL,
  input_BroadBand = NULL,
  input_RiskMap = NULL,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Set_DB_+3A_year">Year</code></td>
<td>
<p>Numeric or Character. The relevant school year. Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>.
Important: if input datasets are plugged in, please select the same <code>Year</code> argument used to download the input data. <code>2023</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_level">level</code></td>
<td>
<p>Character. The administrative level of detail at which data must be aggregated.
Either <code>"LAU"</code>/<code>"Municipality"</code> or <code>"NUTS-3"</code>/<code>"Province"</code>. <code>"LAU"</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_conservative">conservative</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only the schools included in all the datasets are taken as input. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_invalsi">Invalsi</code></td>
<td>
<p>Logical. Whether the Invalsi census data must be included (see <code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code>. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings">SchoolBuildings</code></td>
<td>
<p>Logical. Whether the school buildings dataset must be included (see <code>link{Get_DB_MIUR}</code>, <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nstud">nstud</code></td>
<td>
<p>Logical. Whether the students number per class must be included (see <code><a href="#topic+Get_nstud">Get_nstud</a></code>. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nteachers">nteachers</code></td>
<td>
<p>Logical. Whether the number of teachers by province must be included (see <code>link{Get_nteachers_prov}</code>). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_broadband">BroadBand</code></td>
<td>
<p>Logical. Whether the broadband availability in schools must be included (see <code><a href="#topic+Get_BroadBand">Get_BroadBand</a></code>). <code>TRUE</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_riskmap">RiskMap</code></td>
<td>
<p>Logical. Whether the map of risk of Italian municipalities must be included (<code><a href="#topic+Get_RiskMap">Get_RiskMap</a></code>). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_show_col_types">show_col_types</code></td>
<td>
<p>Logical. If <code>TRUE</code>, if the <code>verbose</code> argument is also <code>TRUE</code>, the columns of the raw dataset are shown during the download. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_invalsi_subj">Invalsi_subj</code></td>
<td>
<p>Character. If <code>Invalsi == TRUE</code>, the school subject(s) to include, among <code>"Englis_listening"</code>/<code>"ELI"</code>, <code>"English_reading"</code>/<code>"ERE"</code>, <code>"Italian"</code>/<code>"Ita"</code> and <code>"Mathematics"</code>/<code>"MAT"</code>. All four by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_invalsi_grade">Invalsi_grade</code></td>
<td>
<p>Numeric. If <code>Invalsi == TRUE</code>, the educational grade to choose. Either <code>2</code> (2nd year of primary school), <code>5</code> (last year of primary school), <code>8</code> (last year of middle shcool), <code>10</code> (2nd year of high school) or <code>13</code> (last year of school). All by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_invalsi_wle">Invalsi_WLE</code></td>
<td>
<p>Logical. Whether to express Invalsi scores as averagev WLE score rather that the percentage of sufficient tests, if both are Invalsi_grade is either or <code>2</code> <code>5</code>. <code>FALSE</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_include_numerics">SchoolBuildings_include_numerics</code></td>
<td>
<p>Logical. Whether to include strictly numeric variables alongside with Boolean ones in the school buildings database (see <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_include_qualitatives">SchoolBuildings_include_qualitatives</code></td>
<td>
<p>Logical. Whether to include qualitative variables alongside with Boolean ones in the school buildings database (see <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_row_cutout">SchoolBuildings_row_cutout</code></td>
<td>
<p>Logical. Whether to filter out rows including missing fields in the school buildings database (see <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_col_cut_thresh">SchoolBuildings_col_cut_thresh</code></td>
<td>
<p>Numeric. The threshold of missing values allowed for each variable in the school buildings database (see <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>).
If a variable as a higher number of missing observations, then it is cut out. <code>20.000</code> by default.
Warning: if the option <code>SchoolBuildings_row_cutout</code> is active, please select a lower threshold (e.g. <code>1000</code>)</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_flag_outliers">SchoolBuildings_flag_outliers</code></td>
<td>
<p>Logical. Whether to assign NA to outliers in numeric variables; see <code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code> for more details. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_schoolbuildings_count_missing">SchoolBuildings_count_missing</code></td>
<td>
<p>Logical. Whether the function should return the percentage of NAs in the input school buildings database (see also <code><a href="#topic+Group_DB_MIUR">Group_DB_MIUR</a></code>). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nstud_imputation_thresh">nstud_imputation_thresh</code></td>
<td>
<p>Numeric. If <code>nstud_missing_to_1 == TRUE</code>, the minimum threshold below which the number of classes is imputed to 1 if missing;
see also <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code>. <code>19</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nstud_missing_to_1">nstud_missing_to_1</code></td>
<td>
<p>Numeric. If <code>nstud == TRUE</code>, whether the number of classes should be imputed to 1 when it is missing and the number of students is below a threshold (argument <code>nstud_imputation_thresh</code>, see <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code>). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_ub_nstud_byclass">UB_nstud_byclass</code></td>
<td>
<p>Numeric. The upper limit of the acceptable school-level average of the number of students by class if <code>nstud == TRUE</code>; see also <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code>.  <code>99</code> by default, i.e. no restriction is made. Please notice that boundaries are included in the acceptance interval.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_lb_nstud_byclass">LB_nstud_byclass</code></td>
<td>
<p>Numeric. The lower limit of the acceptable school-level average of the number of students by class if <code>nstud == TRUE</code>; see also <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code>. <code>1</code> by default. Please notice that boundaries are included in the acceptance interval.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_innerareas">InnerAreas</code></td>
<td>
<p>Logical. Whether the percentage of schools belonging to inner/internal areas must be included (see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code>). TRUE by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_ord_innerareas">ord_InnerAreas</code></td>
<td>
<p>Logical. If <code>check == TRUE</code> and <code>InnerAreas == TRUE</code>, whether the Inner areas classification should be treated as an ordinal variable rather than as a categorical one (see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> for the classification). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nstud_check">nstud_check</code></td>
<td>
<p>Logical. If <code>nstud == TRUE</code>, whether to check the students number availability across all school included in the school registries (see <code><a href="#topic+Util_Check_nstud_availability">Util_Check_nstud_availability</a></code>). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_nstud_check_registry">nstud_check_registry</code></td>
<td>
<p>Character. If <code>nstud == TRUE</code> and <code>nstud_check == TRUE</code>, the school registries whose availability has to be checked. Either <code>"Registry1"</code> (buildings registry), <code>"Registry 2"</code> (proper registry), <code>"Any"</code> or <code>"Both"</code>. <code>"Any"</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_broadband_impute_missing">BroadBand_impute_missing</code></td>
<td>
<p>Whether the schools not included in the Broadband dataset must be considered in the total of schools (i.e. the denominator to the Broadband availability indicator). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_date">Date</code></td>
<td>
<p>Character or Date. The threshold date to broadband activation to consider it activated for a school, i.e. the date before which the works of broadband activation must be finished in order to consider a school as provided with the broadband. By default, September 1st at the beginning of the school year.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_na_autorm">NA_autoRM</code></td>
<td>
<p>Logical. Either <code>TRUE</code>, <code>FALSE</code> or <code>NULL</code>. If <code>TRUE</code>, the values missing in a single dataset are automatically deleted from the final DB. If <code>FALSE</code>, the missing observations are kept automatically. If <code>NULL</code>, the choice is left to the user by an interactive menu. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_invalsi_is">input_Invalsi_IS</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
If <code>INVALSI == TRUE</code>, the raw Invalsi survey data, obtained as output of the <code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code> function.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_registry">input_Registry</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The school registry corresponding to the year in scope, obtained as output of the function <code><a href="#topic+Get_Registry">Get_Registry</a></code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_schoolbuildings">input_SchoolBuildings</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. If <code>SchoolBuildings == TRUE</code>, the raw school buildings dataset obtained as output of the function <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code>.
If <code>NULL</code>, it will be downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_nstud">input_nstud</code></td>
<td>
<p>Object of class <code>list</code>, including two objects of class<code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
If <code>nstud == TRUE</code>, the students and classes counts, obtained as output of the function <code><a href="#topic+Get_nstud">Get_nstud</a></code> with default <code>filename</code> parameter.
If <code>NULL</code>, the function will download it automatically but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_school2mun">input_School2mun</code></td>
<td>
<p>Object of class <code>list</code> with elements of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>
If <code>nstud == TRUE</code>, the mapping from school codes to municipality (and province) codes. Needed only if <code>check == TRUE</code>, obtained as output of the function <code><a href="#topic+Get_School2mun">Get_School2mun</a></code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_admunnames">input_AdmUnNames</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>
If necessary,the ISTAT file including all the codes and the names of the administrative units for the year in scope. Required either if <code>nstud == TRUE &amp; nstud_check == TRUE</code>, or if <code>SchoolBuildings == TRUE</code>, <code>input_DB_MIUR</code> is not provided, and the school year is one of 2015/16, 2017/18 or 1018/19
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_innerareas">input_InnerAreas</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
If <code>InnerAreas == TRUE</code>, the classification of peripheral municipalities, obtained as output of the function <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code>
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_teachers4student">input_teachers4student</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. If <code>nteachers == TRUE</code> and <code>nstud = TRUE</code>, the number of teachers for studets by province. Please notice that
this object cannot be considered a substitute for the number of students by class since it provides no information on the number of schools in single educational grades but only at the school order level.
Obtained as output of the function <code><a href="#topic+Group_teachers4stud">Group_teachers4stud</a></code>.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_nteachers">input_nteachers</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. If <code>nteachers == TRUE</code>, the number of teachers by province, obtained as output of the function <code><a href="#topic+Get_nteachers_prov">Get_nteachers_prov</a></code>. If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_broadband">input_BroadBand</code></td>
<td>
<p>Object of classs <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. If BroadBand == TRUE, the raw Broadband connection dataset obtaned as output of the function <code><a href="#topic+Get_BroadBand">Get_BroadBand</a></code>
If <code>NULL</code>, it will be downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_input_riskmap">input_RiskMap</code></td>
<td>
<p>Object of classs <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. If <code>RiskMap == TRUE</code> and <code>level == "LAU"</code> (or <code>"Municipality"</code>), the map of risks of Italian municipalities, obtaned as output of the function <code><a href="#topic+Get_RiskMap">Get_RiskMap</a></code>.
If <code>NULL</code>, it will be downloaded automatically but not saved in the global environment. <code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Set_DB_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of  class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Util_DB_MIUR_num">Util_DB_MIUR_num</a></code>, <code><a href="#topic+Group_DB_MIUR">Group_DB_MIUR</a></code>, <code><a href="#topic+Group_nstud">Group_nstud</a></code>, <code><a href="#topic+Util_Check_nstud_availability">Util_Check_nstud_availability</a></code>, <code><a href="#topic+Get_School2mun">Get_School2mun</a></code>
for similar arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


DB23_prov &lt;- Set_DB(Year = 2023, level = "NUTS-3",Invalsi_grade = c(5, 8, 13),
      Invalsi_subj = "Italian",nteachers = FALSE, BroadBand = FALSE,
      SchoolBuildings_count_missing = FALSE,NA_autoRM= TRUE,
      input_SchoolBuildings = example_input_DB23_MIUR[, -c(11:18, 10:27)],
      input_Invalsi_IS = example_Invalsi23_prov,
      input_nstud = example_input_nstud23,
      input_InnerAreas = example_InnerAreas,
      input_School2mun = example_School2mun23,
      input_AdmUnNames = example_AdmUnNames20220630)


DB23_prov

summary(DB23_prov[, -c(22:62)])





</code></pre>

<hr>
<h2 id='Util_Check_nstud_availability'>Check how many schools in the school registries are included in the students count dataframe</h2><span id='topic+Util_Check_nstud_availability'></span>

<h3>Description</h3>

<p>This function checks for which schools listed in the two registries (the buildings registry and the schools registry)
the count of students is available. The first registry is referred to as as <code>Registry1</code> and the second one as <code>Registry2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Util_Check_nstud_availability(
  data,
  Year,
  cutout = c("IC", "IS", "NR"),
  verbose = TRUE,
  ggplot = TRUE,
  toplot_registry = "Any",
  InnerAreas = TRUE,
  ord_InnerAreas = FALSE,
  input_Registry2 = NULL,
  input_InnerAreas = NULL,
  input_Prov_shp = NULL,
  input_AdmUnNames = NULL,
  input_School2mun = NULL,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Util_Check_nstud_availability_+3A_data">data</code></td>
<td>
<p>Object of class  <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the <code><a href="#topic+Util_nstud_wide">Util_nstud_wide</a></code> function</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year.
Available in the formats: <code>2023</code>, <code>"2022/2023"</code>, <code>202223</code>, <code>20222023</code>.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_cutout">cutout</code></td>
<td>
<p>Character. The types of schools not to be taken into account (because not relevant or because they are out of scope in the students number section). By default <code>c("IC", "IS", "NR")</code> , i.e. the check does not regard comprehensive institutes, superior institutes, and all the schools that cannot be classified either as primary, middle or high schools.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_ggplot">ggplot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function displays a static map of the availability of the students number by province (but it does not save the ggplot object into the global environment). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_toplot_registry">toplot_registry</code></td>
<td>
<p>Character. If the <code>ggplot</code> option is chosen, the students number availability of which registry must be plotted; either <code>"Registry1"</code>, <code>"Registry2"</code>, <code>"Any"</code> or <code>"Both"</code>. <code>"Any"</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_innerareas">InnerAreas</code></td>
<td>
<p>Logical. Whether it must be checked if municipalities belong to inner areas or not. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_ord_innerareas">ord_InnerAreas</code></td>
<td>
<p>Logical. Whether the inner areas classification should be treated as an ordinal variable rather than as a categorical one (see <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> for the classification).
<code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_input_registry2">input_Registry2</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_Registry">Get_Registry</a></code>
The school registry from the registry section.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_input_innerareas">input_InnerAreas</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The classification of peripheral municipalities, obtained as output of the <code><a href="#topic+Get_InnerAreas">Get_InnerAreas</a></code> function.
Needed only if the <code>InnerAreas</code> option is chosen.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_input_prov_shp">input_Prov_shp</code></td>
<td>
<p>Object of class <code>sf</code>, <code>tbl_df</code>, <code>tbl</code>, <code>data.frame</code>. The relevant shapefile of Italian municipalities, if the <code>ggplot</code> option is chosen.
If <code>NULL</code> it is downloaded automatically but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_input_admunnames">input_AdmUnNames</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_AdmUnNames">Get_AdmUnNames</a></code>
The ISTAT file including all the codes and the names of the administrative units for the year in scope.
Only needed if the argument input_School2mun is <code>NULL</code> and has to be computed.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_input_school2mun">input_School2mun</code></td>
<td>
<p>Object of class <code>list</code> with elements of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, obtained as output of the function <code><a href="#topic+Get_School2mun">Get_School2mun</a></code>.
The mapping from school codes to municipality (and province) codes. If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Check_nstud_availability_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>list</code> including two elements:
</p>

<ul>
<li> <p><code>$Municipality_data</code>
</p>
</li>
<li> <p><code>$Province_data</code>
</p>
</li></ul>

<p>Both the elements are objects of class <code>list</code> including four elements:
</p>

<ul>
<li> <p><code>$Registry1</code>: object of class of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the availability of the number of students in the schools listed in the buildings section.
</p>
</li>
<li> <p><code>$Registry2</code>: object of class of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the availability of the number of students in the schools listed in the registry section.
</p>
</li>
<li> <p><code>$Any</code>: object of class of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the availability of the number of students in the schools listed anywhere.
</p>
</li>
<li> <p><code>$Both</code>: object of class of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>: the availability of the number of students in the schools listed in both sections.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Edilizia+Scolastica&amp;datasetId=DS0101EDIANAGRAFESTA2021">Buildings Registry</a>;
<a href="https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Scuole&amp;datasetId=DS0400SCUANAGRAFESTAT">Schools Registry</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nstud23 &lt;- Util_nstud_wide(example_input_nstud23, verbose = FALSE)

Util_Check_nstud_availability(nstud23, Year = 2023,
  input_Registry2 = example_input_Registry23, InnerAreas = FALSE,
  input_School2mun = example_School2mun23, input_Prov_shp = example_Prov22_shp)





</code></pre>

<hr>
<h2 id='Util_DB_MIUR_bool'>Clean and convert the raw school buildings data to Boolean variables</h2><span id='topic+Util_DB_MIUR_bool'></span>

<h3>Description</h3>

<p>This function cleans the output of the <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code> function from missing values in two steps:
</p>

<ul>
<li><p> First, it deletes both the columns exceeding a threshold of missing values (1000 by default) and the columns that cannot be converted into Boolean variables
</p>
</li>
<li><p> Then, it deletes the rows in which missing values remain
</p>
</li></ul>

<p>Finally, the remaining data are converted into Boolean variables.
It is possible to keep track of the deleted rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Util_DB_MIUR_bool(
  data = NULL,
  cutout = NULL,
  col_cut_thresh = 10^3,
  verbose = TRUE,
  track_deleted = TRUE,
  autoAbort = autoAbort,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Util_DB_MIUR_bool_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. Input data obtaned through the function <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code>.
If <code>NULL</code> it will be downloaded automatically with the appropriate arguments, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_bool_+3A_cutout">cutout</code></td>
<td>
<p>Character. The columns to cut out. If <code>NULL</code>, it will be determined automatically.
<code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_bool_+3A_col_cut_thresh">col_cut_thresh</code></td>
<td>
<p>Numeric. The threshold of missing values allowed for each variable.
If a variable as a higher number of missing observations, then it is cut out. <code>1000</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_bool_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. TRUE by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_bool_+3A_track_deleted">track_deleted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function returns the names of the school not included in the output dataframe. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_bool_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>track_deleted == TRUE</code>, An object of class <code>list</code> including two objects:
</p>

<ul>
<li> <p><code>$data</code>: object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, the output dataframe. All variables besides the first 8 ones (which identify the record) are numeric.
</p>
</li>
<li> <p><code>$deleted</code>: character. The school codes corresponding to deleted rows
</p>
</li></ul>

<p>If <code>track_deleted == FALSE</code>, the output is only the first element of the list.
</p>

<hr>
<h2 id='Util_DB_MIUR_num'>Convert the raw school buildings data to numeric or Boolean variables</h2><span id='topic+Util_DB_MIUR_num'></span>

<h3>Description</h3>

<p>This function transforms the output variables of the <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code> into Boolean or Numeric.
Additionally, it removes the columns with an excessive number of missing observations (20.000 by default), and if required it may also delete the rows including missing fields.
In this case, it is possible to keep track of the deleted rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Util_DB_MIUR_num(
  data = NULL,
  include_numerics = TRUE,
  include_qualitatives = FALSE,
  row_cutout = FALSE,
  track_deleted = TRUE,
  verbose = TRUE,
  col_cut_thresh = 20000,
  flag_outliers = TRUE,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Util_DB_MIUR_num_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. Input data obtaned through the function <code><a href="#topic+Get_DB_MIUR">Get_DB_MIUR</a></code>.
If <code>NULL</code> it will be downloaded automatically with the appropriate arguments, but not saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_include_numerics">include_numerics</code></td>
<td>
<p>Logical. Whether to include strictly numeric variables alongside with Boolean ones. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_include_qualitatives">include_qualitatives</code></td>
<td>
<p>Logical. Whether to include qualitative variables alongside with Boolean ones. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_row_cutout">row_cutout</code></td>
<td>
<p>Logical. Whether to filter out rows including missing fields. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_track_deleted">track_deleted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function returns the names of the school not included in the output dataframe. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. TRUE by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_col_cut_thresh">col_cut_thresh</code></td>
<td>
<p>Numeric. The threshold of missing values allowed for each variable.
If a variable as a higher number of missing observations, then it is cut out. <code>20.000</code> by default.
Warning: if the option <code>row_cutout</code> is active, please select a lower threshold (e.g. <code>1000</code>)</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_flag_outliers">flag_outliers</code></td>
<td>
<p>Logical. Whether to assign NA to outliers in numeric variables. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_DB_MIUR_num_+3A_...">...</code></td>
<td>
<p>Additional arguments to the function <code>Get_DB_MIUR</code> if <code>data</code> is not provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outliers to be set to <code>NA</code> if <code>flag_outliers</code> is active are defined as follows: School area or free area surface of less than 50 squared meters,
building volume of less than 150 cubic meters, 0 floors in the building.
</p>


<h3>Value</h3>

<p>If <code>track_deleted == TRUE</code>, An object of class <code>list</code> including two objects:
</p>

<ul>
<li> <p><code>$data</code>: object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>, the output dataframe.
</p>
</li>
<li> <p><code>$deleted</code>: object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. The school IDs of the deleted units.
</p>
</li></ul>

<p>If <code>track_deleted == FALSE</code>, the output is only the first element of the list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(magrittr)

DB23_MIUR_num &lt;- example_input_DB23_MIUR %&gt;% Util_DB_MIUR_num(track_deleted = FALSE)


DB23_MIUR_num[, -c(1,4,6,8,9,10)]
summary(DB23_MIUR_num)


</code></pre>

<hr>
<h2 id='Util_Invalsi_filter'>Filter the Invalsi data by subject, school grade and year.</h2><span id='topic+Util_Invalsi_filter'></span>

<h3>Description</h3>

<p>This function filters the database of Invalsi scores (see <code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code>) by school year, education grade and subject and returns a dataframe in wide format.
Each row corresponds to one territorial unit (either municipality or province); the numerical variables are three (the mean score, the score's standard deviation and the students coverage percentage) for each selected subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Util_Invalsi_filter(
  data = NULL,
  subj = c("ELI", "ERE", "ITA", "MAT"),
  grade = 8,
  level = "LAU",
  WLE = FALSE,
  Year = 2023,
  verbose = TRUE,
  autoAbort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Util_Invalsi_filter_+3A_data">data</code></td>
<td>
<p>Object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>.
The raw Invalsi survey data that has to be filtered, obtained as output of the <code><a href="#topic+Get_Invalsi_IS">Get_Invalsi_IS</a></code> function.
If <code>NULL</code>, it will be downloaded automatically, but not saved in the global environment.
<code>NULL</code> by default</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_subj">subj</code></td>
<td>
<p>Character. The school subject(s) to include, among <code>"Englis_listening"</code>/<code>"ELI"</code>, <code>"English_reading"</code>/<code>"ERE"</code>, <code>"Italian"</code>/<code>"ITA"</code> and <code>"Mathematics"</code>/<code>"MAT"</code>. All four by default.</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_grade">grade</code></td>
<td>
<p>Numeric. The school grade to chose. Either <code>2</code> (2nd year of primary school), <code>5</code> (last year of primary school), <code>8</code> (last year of middle shcool), <code>10</code> (2nd year of high school) or <code>13</code> (last year of school). <code>8</code> by default</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_level">level</code></td>
<td>
<p>Character. The level of aggregation of Invalsi census data. Either <code>"NUTS-3"</code>, <code>"Province"</code>, <code>"LAU"</code>, <code>"Municipality"</code>.
If an input dataframe is provided, please select the same level of aggregation. <code>"LAU"</code> by default</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_wle">WLE</code></td>
<td>
<p>Logical. Whether the variable to choose should be the average WLE score rather that the percentage of sufficient tests, if both are available. <code>FALSE</code> by default</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_year">Year</code></td>
<td>
<p>Numeric or character value. Reference school year for the data (last available is 2022/23).
Available in the formats: <code>2022</code>, <code>"2021/2022"</code>, <code>202122</code>, <code>20212022</code>. <code>2023</code> by default</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the function informs about the time needed. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_Invalsi_filter_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>. For all subjects and school grades, the variables indicate:
</p>

<ul>
<li> <p><code>M</code> The mean score, either WLE or percentage of sufficient tests
</p>
</li>
<li> <p><code>S</code> The standard deviation of the score
</p>
</li>
<li> <p><code>C</code> The students coverage percentage (expressed in the scale 1 - 100)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>


Util_Invalsi_filter(subj = c("Italian", "Mathematics"), grade = 5, level = "NUTS-3", Year = 2023,
                   WLE = FALSE, data = example_Invalsi23_prov)

Util_Invalsi_filter(subj = c("Italian", "Mathematics"), grade = 5, level = "NUTS-3", Year = 2023,
                    WLE = TRUE, data = example_Invalsi23_prov)

Invalsi23_high &lt;- Util_Invalsi_filter(subj = "Italian", grade = c(10,13), level = "NUTS-3",
                                      Year = 2023, data = example_Invalsi23_prov)


 summary(Invalsi23_high)

</code></pre>

<hr>
<h2 id='Util_nstud_wide'>Clean the raw dataframe of the number of students and arrange it in a wide format</h2><span id='topic+Util_nstud_wide'></span>

<h3>Description</h3>

<p>This function firstly cleans the output of the <code><a href="#topic+Get_nstud">Get_nstud</a></code> function from the outliers in terms of average number of students by class at the school level and imputates the number of classes to 1 when missing,
then it rearranges the data into a wide format, in such a way to represent the number of students, the number of classes and the average number of students by class at each school grade in a unique observation for each school.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Util_nstud_wide(
  data = NULL,
  missing_to_1 = FALSE,
  nstud_imputation_thresh = 19,
  UB_nstud_byclass = 99,
  LB_nstud_byclass = 1,
  verbose = TRUE,
  autoAbort = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Util_nstud_wide_+3A_data">data</code></td>
<td>
<p>Object of class <code>list</code>, including two objects of class <code>tbl_df</code>,  <code>tbl</code> and <code>data.frame</code>, obtainded as output of the <code><a href="#topic+Get_nstud">Get_nstud</a></code> function with the default <code>filename</code> parameter.
If <code>NULL</code>, the function will download it automatically but it will not be saved in the global environment. <code>NULL</code> by default.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_missing_to_1">missing_to_1</code></td>
<td>
<p>Logical. Whether the number of classes should be imputed to 1 when it is missing and the number of students is below a threshold (argument <code>nstud_imputation_thresh</code>). <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_nstud_imputation_thresh">nstud_imputation_thresh</code></td>
<td>
<p>Numeric. The minimum threshold below which the number of classes is imputed to 1 if missing, if <code>missing_to_1 == TRUE</code>.
E.g. if the threshold is 19, for all the schools in which there are 19 or less students in a given grade but the number of classes for that grade is missing, the number of classes is imputated to 1. <code>19</code> by default.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_ub_nstud_byclass">UB_nstud_byclass</code></td>
<td>
<p>Numeric. The upper limit of the acceptable school-level average of the number of students by class. If a school has, on average, a higher number of students by class, the record is considered an outlier and filtered out. <code>99</code> by default, i.e. no restriction is made. Please notice that boundaries are included in the acceptance interval.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_lb_nstud_byclass">LB_nstud_byclass</code></td>
<td>
<p>Numeric. The lower limit of the acceptable school-level average of the number of students by class. If a school has, on average, a smaller number of students by class, the record is considered an outlier and filtered out. <code>1</code> by default. Please notice that boundaries are included in the acceptance interval.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user keeps track of the main underlying operations. <code>TRUE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_autoabort">autoAbort</code></td>
<td>
<p>Logical. In case any data must be retrieved, whether to automatically abort the operation and return NULL in case of missing internet connection or server response errors. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="Util_nstud_wide_+3A_...">...</code></td>
<td>
<p>Arguments to <code><a href="#topic+Get_nstud">Get_nstud</a></code>, needed if <code>data</code> is not provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the example, we compare the dataframe obtained with the default settings
and the one imposed setting narrow inclusion criteria
</p>


<h3>Value</h3>

<p>An object of class  <code>tbl_df</code>, <code>tbl</code> and <code>data.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

nstud.default &lt;- Util_nstud_wide(example_input_nstud23)


nstud.narrow &lt;- Util_nstud_wide(example_input_nstud23,
  UB_nstud_byclass = 35, LB_nstud_byclass = 5 )

nrow(nstud.default)
nrow(nstud.narrow)

nstud.default

summary(nstud.default)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
