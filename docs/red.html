<!DOCTYPE html><html><head><title>Help for package red</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {red}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aoo'><p>Area of Occupancy (AOO).</p></a></li>
<li><a href='#countries'><p>Countries of occurrence.</p></a></li>
<li><a href='#elevation'><p>Elevation limits.</p></a></li>
<li><a href='#eoo'><p>Extent of Occurrence (EOO).</p></a></li>
<li><a href='#kml'><p>Output kml files.</p></a></li>
<li><a href='#map.draw'><p>Map creation.</p></a></li>
<li><a href='#map.easy'><p>Species distributions made easy (multiple species).</p></a></li>
<li><a href='#map.habitat'><p>Map species distribution of habitat specialist.</p></a></li>
<li><a href='#map.points'><p>Map recorded distribution of species.</p></a></li>
<li><a href='#map.sdm'><p>Predict species distributions.</p></a></li>
<li><a href='#move'><p>Move records to closest non-NA cell.</p></a></li>
<li><a href='#outliers'><p>Visual detection of outliers.</p></a></li>
<li><a href='#raster.clean'><p>Uniformize raster layers.</p></a></li>
<li><a href='#raster.distance'><p>Create distance layer.</p></a></li>
<li><a href='#raster.east'><p>Create eastness layer.</p></a></li>
<li><a href='#raster.lat'><p>Create latitude layer.</p></a></li>
<li><a href='#raster.long'><p>Create longitude layer.</p></a></li>
<li><a href='#raster.north'><p>Create northness layer.</p></a></li>
<li><a href='#raster.read'><p>Read and buffer raster layers.</p></a></li>
<li><a href='#raster.reduce'><p>Reduce dimensionality of raster layers.</p></a></li>
<li><a href='#records'><p>Download taxon records from GBIF.</p></a></li>
<li><a href='#red.examples'><p>Example data packaged with *red*</p></a></li>
<li><a href='#red.getDir'><p>Read GIS directory.</p></a></li>
<li><a href='#red.setDir'><p>Setup GIS directory.</p></a></li>
<li><a href='#red.setup'><p>Download and setup GIS files.</p></a></li>
<li><a href='#rli'><p>Red List Index.</p></a></li>
<li><a href='#rli.map'><p>Mapping the Red List Index.</p></a></li>
<li><a href='#rli.multi'><p>Red List Index for multiple groups.</p></a></li>
<li><a href='#rli.predict'><p>Prediction of Red List Index.</p></a></li>
<li><a href='#rli.sampled'><p>Sampled Red List Index.</p></a></li>
<li><a href='#thin'><p>Spatial thinning of occurrence records.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>IUCN Redlisting Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro Cardoso <a href="https://orcid.org/0000-0001-8119-9960"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Vasco V. Branco <a href="https://orcid.org/0000-0001-7797-3183"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vasco V. Branco &lt;vasco.branco@helsinki.fi&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Includes algorithms to facilitate the assessment of extinction risk of species according to the IUCN (International Union for Conservation of Nature, see <a href="https://www.iucn.org/">https://www.iucn.org/</a> for more information) red list criteria.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>BAT, dismo, gdistance, geosphere, graphics, grDevices,
jsonlite, methods, sp, stats, utils, terra, predicts</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-08 12:25:31 UTC; witch-king-of-angmar</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-08 21:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='aoo'>Area of Occupancy (AOO).</h2><span id='topic+aoo'></span>

<h3>Description</h3>

<p>Calculates the Area of Occupancy of a species based on either known records or predicted distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aoo(spData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aoo_+3A_spdata">spData</code></td>
<td>
<p>One of three options: 1) matrix of longitude and latitude (two columns) of each occurrence record; 2) matrix of easting and northing (two columns, e.g. UTM) of each occurrence record in meters;  3) RasterLayer object of predicted distribution (either 0/1 or probabilistic values).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>AOO is calculated as the area of all known or predicted cells for the species. The resolution will be 2x2km as required by IUCN.
</p>


<h3>Value</h3>

<p>A single value in km2 or a vector with lower confidence limit, consensus and upper confidence limit (probabilities 0.975, 0.5 and 0.025 respectively).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>range = red.examples("red.range")
aoo(range)
</code></pre>

<hr>
<h2 id='countries'>Countries of occurrence.</h2><span id='topic+countries'></span>

<h3>Description</h3>

<p>Extracts the names or ISO codes of countries of occurrence of a species based on either records or predicted distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countries(spData, zone = NULL, ISO = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="countries_+3A_spdata">spData</code></td>
<td>
<p>One of three options: 1) matrix of longitude and latitude (two columns) of each occurrence record; 2) matrix of easting and northing (two columns, e.g. UTM) of each occurrence record in meters;  3) RasterLayer object of predicted distribution (0/1 values).</p>
</td></tr>
<tr><td><code id="countries_+3A_zone">zone</code></td>
<td>
<p>UTM zone if data is in metric units.</p>
</td></tr>
<tr><td><code id="countries_+3A_iso">ISO</code></td>
<td>
<p>Outputs either country names (FALSE) or ISO codes (TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Country boundaries and designations are based on data(worldborders) from package maptools.
</p>


<h3>Value</h3>

<p>A vector with country names or codes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
range = red.examples("red.range")
countries(records)
countries(range, ISO = TRUE)
</code></pre>

<hr>
<h2 id='elevation'>Elevation limits.</h2><span id='topic+elevation'></span>

<h3>Description</h3>

<p>Calculates the elevation (or depth) limits (range) of a species based on either known records or predicted distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elevation(spData, dem = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elevation_+3A_spdata">spData</code></td>
<td>
<p>One of three options: 1) matrix of longitude and latitude (two columns) of each occurrence record; 2) matrix of easting and northing (two columns, e.g. UTM) of each occurrence record in meters;  3) RasterLayer object of predicted distribution (0/1 values).</p>
</td></tr>
<tr><td><code id="elevation_+3A_dem">dem</code></td>
<td>
<p>RasterLayer object. Should be a digital elevation model (DEM) of the relevant area. If not given the function will try to read it from base data, only works with longlat data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Maximum and minimum elevation are calculated based on the DEM.
</p>


<h3>Value</h3>

<p>A vector with two values (min and max) in meters above (or below) sea level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
range = red.examples("red.range")
layers = red.examples("red.layers")
dem = layers[[3]]
elevation(records, dem)
elevation(range, dem)
</code></pre>

<hr>
<h2 id='eoo'>Extent of Occurrence (EOO).</h2><span id='topic+eoo'></span>

<h3>Description</h3>

<p>Calculates the Extent of Occurrence of a species based on either records or predicted distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eoo(spData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eoo_+3A_spdata">spData</code></td>
<td>
<p>spData One of three options: 1) matrix of longitude and latitude (two columns) of each occurrence record; 2) matrix of easting and northing (two columns, e.g. UTM) of each occurrence record in meters;  3) RasterLayer object of predicted distribution (either 0/1 or probabilistic values).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>EOO is calculated as the minimum convex polygon covering all known or predicted sites for the species.
</p>


<h3>Value</h3>

<p>A single value in km2 or a vector with lower confidence limit, consensus and upper confidence limit (probabilities 0.975, 0.5 and 0.025 respectively).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
range = red.examples("red.range")
eoo(records)
eoo(range)
</code></pre>

<hr>
<h2 id='kml'>Output kml files.</h2><span id='topic+kml'></span>

<h3>Description</h3>

<p>Creates kml files for Google Maps as required by IUCN guidelines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kml(spData, zone = NULL, filename, mapoption = "aoo", smooth = 0, rad = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kml_+3A_spdata">spData</code></td>
<td>
<p>One of three options: 1) matrix of longitude and latitude (two columns) of each occurrence record; 2) matrix of easting and northing (two columns, e.g. UTM) of each occurrence record in meters;  3) RasterLayer object of predicted distribution (0/1 values).</p>
</td></tr>
<tr><td><code id="kml_+3A_zone">zone</code></td>
<td>
<p>UTM zone if data is in metric units.</p>
</td></tr>
<tr><td><code id="kml_+3A_filename">filename</code></td>
<td>
<p>The name of file to save, should end with .kml.</p>
</td></tr>
<tr><td><code id="kml_+3A_mapoption">mapoption</code></td>
<td>
<p>Type of representation, any of &quot;points&quot;, &quot;eoo&quot; or &quot;aoo&quot;.</p>
</td></tr>
<tr><td><code id="kml_+3A_smooth">smooth</code></td>
<td>
<p>Smooths the kml lines as per IUCN guidelines. Higher values represent smoother polygons.</p>
</td></tr>
<tr><td><code id="kml_+3A_rad">rad</code></td>
<td>
<p>radius of circles in degrees if mapoption is &quot;points&quot;. It can be the same value for all points or a vector with length equal to number of records in spData representing associated error. The default is about 10km (0.1 degrees) as per IUCN guidelines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A kml with polygon or circles around records.
</p>

<hr>
<h2 id='map.draw'>Map creation.</h2><span id='topic+map.draw'></span>

<h3>Description</h3>

<p>Creates maps ready to print in pdf or other formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.draw(
  longlat = NULL,
  layer,
  spName,
  borders = FALSE,
  scale = TRUE,
  legend = FALSE,
  sites = TRUE,
  mcp = FALSE,
  print = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.draw_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of each occurrence record.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_layer">layer</code></td>
<td>
<p>RasterLayer object representing the presence/absence map for the species.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_spname">spName</code></td>
<td>
<p>String of species name.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_borders">borders</code></td>
<td>
<p>If TRUE country borders are drawn.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_scale">scale</code></td>
<td>
<p>If TRUE a distance scale in km is drawn.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_legend">legend</code></td>
<td>
<p>If TRUE the legend for the map is drawn.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_sites">sites</code></td>
<td>
<p>If TRUE the record locations are drawn.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_mcp">mcp</code></td>
<td>
<p>If TRUE the minimum convex polygon representing the Extent of Occurrence is drawn.</p>
</td></tr>
<tr><td><code id="map.draw_+3A_print">print</code></td>
<td>
<p>If TRUE a pdf is saved instead of the output to the console.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
range = red.examples("red.range")
par(mfrow = c(1,2))
map.draw(records, layer = range, mcp = TRUE)
</code></pre>

<hr>
<h2 id='map.easy'>Species distributions made easy (multiple species).</h2><span id='topic+map.easy'></span>

<h3>Description</h3>

<p>Single step for prediction of multiple species distributions. Output of maps (in pdf format), klms (for Google Earth) and relevant data (in csv format).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.easy(
  longlat,
  layers = NULL,
  habitat = NULL,
  zone = NULL,
  thin = TRUE,
  error = NULL,
  move = TRUE,
  dem = NULL,
  pca = 0,
  filename = NULL,
  mapoption = NULL,
  testpercentage = 0,
  mintest = 20,
  points = FALSE,
  runs = 0,
  subset = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.easy_+3A_longlat">longlat</code></td>
<td>
<p>data.frame of taxon names, longitude and latitude or eastness and northness (three columns in this order) of each occurrence record.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_layers">layers</code></td>
<td>
<p>If NULL analyses are done with environmental layers read from data files of red.setup(). If a Raster* object as defined by package raster, analyses use these.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_habitat">habitat</code></td>
<td>
<p>Raster* object as defined by package raster. Habitat extent layer (0/1) used instead of layers if any species is an habitat specialist.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_zone">zone</code></td>
<td>
<p>UTM zone if data is in metric units. Used only for correct placement of kmls and countries.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_thin">thin</code></td>
<td>
<p>boolean defining if species data should be thinned before modeling (only for SDMs).</p>
</td></tr>
<tr><td><code id="map.easy_+3A_error">error</code></td>
<td>
<p>Vector of spatial error in longlat (one element per row of longlat) in the same unit as longlat. Used to move any point randomly within the error radius.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_move">move</code></td>
<td>
<p>If TRUE, identifies and moves presence records to closest cells with environmental data. Use when spatial error might put records outside such data.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_dem">dem</code></td>
<td>
<p>RasterLayer object. It should be a digital elevation model for calculation of elevation limits of the species. If NULL, dem from red.setup() is used if possible, otherwise it will be 0.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_pca">pca</code></td>
<td>
<p>Number of pca axes for environmental data reduction. If 0 (default) no pca is made.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_filename">filename</code></td>
<td>
<p>Name of output csv file with all results. If NULL it is named &quot;Results_All.csv&quot;.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_mapoption">mapoption</code></td>
<td>
<p>Vector of values within options: points, habitat and sdm; each value corresponding to the function to be used for each species (map.points, map.habitat, map.sdm). If a single value, all species will be modelled according to it. If NULL, the function will perform analyses using map.points. Species values must be in same order as latlong.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_testpercentage">testpercentage</code></td>
<td>
<p>Percentage of records used for testing only. If 0 all records will be used for both training and testing.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_mintest">mintest</code></td>
<td>
<p>Minimim number of total occurrence records of any species to set aside a test set. Only used if testpercentage &gt; 0.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_points">points</code></td>
<td>
<p>If TRUE, force map to include cells with presence records even if suitable habitat was not identified.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_runs">runs</code></td>
<td>
<p>If &lt;= 0 no ensemble modelling is performed. If &gt; 0, ensemble modelling with n runs is made. For each run, a new random sample of occurrence records (if testpercentage &gt; 0), background points and predictive variables (if subset &gt; 0) are chosen. In the ensemble model, each run is weighted as max(0, (runAUC - 0.5)) ^ 2.</p>
</td></tr>
<tr><td><code id="map.easy_+3A_subset">subset</code></td>
<td>
<p>Number of predictive variables to be randomly selected from layers for each run if runs &gt; 0. If &lt;= 0 all layers are used on all runs. Using a small number of layers is usually better than using many variables for rare species, with few occurrence records (Lomba et al. 2010, Breiner et al. 2015).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Outputs maps in asc, pdf and kml format, plus a file with EOO, AOO and a list of countries where the species is predicted to be present if possible to extract.
</p>


<h3>References</h3>

<p>Breiner, F.T., Guisan, A., Bergamini, A., Nobis, M.P. (2015) Overcoming limitations of modelling rare species by using ensembles of small models. Methods in Ecology and Evolution, 6: 1210-1218.
</p>
<p>Lomba, A., Pellissier, L., Randin, C.F., Vicente, J., Moreira, F., Honrado, J., Guisan, A. (2010) Overcoming the rare species modelling paradox: a novel hierarchical framework applied to an Iberian endemic plant. Biological Conservation, 143: 2647-2657.
</p>

<hr>
<h2 id='map.habitat'>Map species distribution of habitat specialist.</h2><span id='topic+map.habitat'></span>

<h3>Description</h3>

<p>Mapping of all habitat patches where the species is known to occur.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.habitat(
  longlat,
  layer,
  move = TRUE,
  mcp = FALSE,
  points = FALSE,
  eval = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.habitat_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of each occurrence record.</p>
</td></tr>
<tr><td><code id="map.habitat_+3A_layer">layer</code></td>
<td>
<p>RasterLayer object representing the presence/absence (1/0) of a single habitat type.</p>
</td></tr>
<tr><td><code id="map.habitat_+3A_move">move</code></td>
<td>
<p>If TRUE, identifies and moves presence records to closest cells with suitable habitat. Use when spatial error might put records outside the correct patch.</p>
</td></tr>
<tr><td><code id="map.habitat_+3A_mcp">mcp</code></td>
<td>
<p>If TRUE, all habitat patches inside the minimum convex hull polygon encompassing all occurrence records are converted to presence.</p>
</td></tr>
<tr><td><code id="map.habitat_+3A_points">points</code></td>
<td>
<p>If TRUE, force map to include cells with presence records even if suitable habitat was not identified.</p>
</td></tr>
<tr><td><code id="map.habitat_+3A_eval">eval</code></td>
<td>
<p>If TRUE, build a matrix with EOO (from raw data), EOO (from model), AOO (from raw data) and AOO (from model).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In many cases a species has a very restricted habitat and we generally know where it occurs. In such cases using the distribution of the known habitat patches may be enough to map the species.
</p>


<h3>Value</h3>

<p>One raster object and, if eval = TRUE, a matrix with EOO (from raw data), EOO (from model), AOO (from raw data) and AOO (from model).
</p>

<hr>
<h2 id='map.points'>Map recorded distribution of species.</h2><span id='topic+map.points'></span>

<h3>Description</h3>

<p>Mapping of all cells where the species is known to occur.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.points(longlat, layers, eval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.points_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of each occurrence record.</p>
</td></tr>
<tr><td><code id="map.points_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster. Any raster with the relevant extent and cell size can be used.</p>
</td></tr>
<tr><td><code id="map.points_+3A_eval">eval</code></td>
<td>
<p>If TRUE, build a matrix with EOO and AOO calculated from occurrence records only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be used if either information on the species is very scarce (and it is not possible to model the species distribution) or, on the contrary, complete (and there is no need to model the distribution).
</p>


<h3>Value</h3>

<p>One raster object and, if EVAL = TRUE, a matrix with EOO and AOO.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
layers = red.examples("red.layers")
terra::plot(map.points(records, layers, eval = FALSE))
points(records)
</code></pre>

<hr>
<h2 id='map.sdm'>Predict species distributions.</h2><span id='topic+map.sdm'></span>

<h3>Description</h3>

<p>Prediction of potential species distributions using maximum entropy (maxent).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.sdm(
  longlat,
  layers,
  error = NULL,
  year = NULL,
  idconf = NULL,
  categorical = NULL,
  thres = 0,
  testpercentage = 0,
  mcp = TRUE,
  points = FALSE,
  eval = TRUE,
  runs = 0,
  subset = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.sdm_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of each occurrence record.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_layers">layers</code></td>
<td>
<p>Predictor variables, a Raster* object as defined by package raster.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_error">error</code></td>
<td>
<p>Vector of spatial error in longlat (one element per row of longlat) in the same unit as longlat. Used to move any point randomly within the error radius.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_year">year</code></td>
<td>
<p>Vector of sampling years in longlat (one element per row of longlat). Used to exclude old records with a given probability proportional to time passed since sampling (never excluded only for current year).</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_idconf">idconf</code></td>
<td>
<p>Vector of identification confidence in longlat (one element per row of longlat). Used to exclude uncertain records with a given probability. Can be on any scale where max values are certain (e.g. from 1 - very uncertain to 10 - holotype).</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_categorical">categorical</code></td>
<td>
<p>Vector of layer indices of categorical (as opposed to quantitative) data. If NULL the package will try to find them automatically based on the data.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_thres">thres</code></td>
<td>
<p>Threshold of logistic output used for conversion of probabilistic to binary (presence/absence) maps. If 0 this will be the value that maximizes the sum of sensitivity and specificity.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_testpercentage">testpercentage</code></td>
<td>
<p>Percentage of records used for testing only. If 0 all records will be used for both training and testing.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_mcp">mcp</code></td>
<td>
<p>Used for a precautionary approach. If TRUE, all areas predicted as present but outside the minimum convex hull polygon encompassing all occurrence records are converted to absence. Exceptions are cells connected to other areas inside the polygon.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_points">points</code></td>
<td>
<p>If TRUE, force map to include cells with presence records even if suitable habitat was not identified.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_eval">eval</code></td>
<td>
<p>If TRUE, build a matrix with AUC, Kappa, TSS, EOO (from raw data), EOO (from model), AOO (from raw data) and AOO (from model).</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_runs">runs</code></td>
<td>
<p>If &lt;= 0 no ensemble modelling is performed. If &gt; 0, ensemble modelling with n runs is made. For each run, a new random sample of occurrence records (if testpercentage &gt; 0), background points and predictive variables (if subset &gt; 0) are chosen. In the ensemble model, each run is weighted as max(0, (runAUC - 0.5)) ^ 2.</p>
</td></tr>
<tr><td><code id="map.sdm_+3A_subset">subset</code></td>
<td>
<p>Number of predictive variables to be randomly selected from layers for each run if runs &gt; 0. If &lt;= 0 all layers are used on all runs. Using a small number of layers is usually better than using many variables for rare species, with few occurrence records (Lomba et al. 2010, Breiner et al. 2015).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Builds maxent (maximum entropy) species distribution models (Phillips et al. 2004, 2006; Elith et al. 2011) using function maxent from R package dismo (Hijmans et al. 2017). Dismo requires the MaxEnt species distribution model software, a java program that can be downloaded from http://biodiversityinformatics.amnh.org/open_source/maxent. Copy the file 'maxent.jar' into the 'java' folder of the dismo package. That is the folder returned by system.file(&quot;java&quot;, package=&quot;dismo&quot;). You need MaxEnt version 3.3.3b or higher. Please note that this program (maxent.jar) cannot be redistributed or used for commercial or for-profit purposes.
</p>


<h3>Value</h3>

<p>List with either one or two raster objects (depending if ensemble modelling is performed, in which case the second is a probabilistic map from all the runs) and, if eval = TRUE, a matrix with AUC, Kappa, TSS, EOO (from raw data), EOO (from model), AOO (from raw data) and AOO (from model). Aggregate values are taken from maps after transformation of probabilities to incidence, with presence predicted for cells with ensemble values &gt; 0.5.
</p>


<h3>References</h3>

<p>Breiner, F.T., Guisan, A., Bergamini, A., Nobis, M.P. (2015) Overcoming limitations of modelling rare species by using ensembles of small models. Methods in Ecology and Evolution, 6: 1210-1218.
</p>
<p>Hijmans, R.J., Phillips, S., Leathwick, J., Elith, J. (2017) dismo: Species Distribution Modeling. R package version 1.1-4. https://CRAN.R-project.org/package=dismo
</p>
<p>Lomba, A., Pellissier, L., Randin, C.F., Vicente, J., Moreira, F., Honrado, J., Guisan, A. (2010) Overcoming the rare species modelling paradox: a novel hierarchical framework applied to an Iberian endemic plant. Biological Conservation, 143: 2647-2657.
</p>
<p>Phillips, S.J., Dudik, M., Schapire, R.E. (2004) A maximum entropy approach to species distribution modeling. Proceedings of the Twenty-First International Conference on Machine Learning. p. 655-662.
</p>
<p>Phillips, S.J., Anderson, R.P., Schapire, R.E. (2006) Maximum entropy modeling of species geographic distributions. Ecological Modelling, 190: 231-259.
</p>
<p>Elith, J., Phillips, S.J., Hastie, T., Dudik, M., Chee, Y.E., Yates, C.J. (2011) A statistical explanation of MaxEnt for ecologists. Diversity and Distributions, 17: 43-57.
</p>

<hr>
<h2 id='move'>Move records to closest non-NA cell.</h2><span id='topic+move'></span>

<h3>Description</h3>

<p>Identifies and moves presence records to cells with environmental values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>move(longlat, layers, buffer = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="move_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of species occurrence records.</p>
</td></tr>
<tr><td><code id="move_+3A_layers">layers</code></td>
<td>
<p>SpatRaster* object as defined by package raster.</p>
</td></tr>
<tr><td><code id="move_+3A_buffer">buffer</code></td>
<td>
<p>Maximum distance in map units that a record will move. If 0 all NA records will be changed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often records are in coastal or other areas for which no environmental data is available. This function moves such records to the closest cells with data so that no information is lost during modelling.
</p>


<h3>Value</h3>

<p>A matrix with new coordinate values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rast &lt;- terra::rast(matrix(c(rep(NA,100), rep(1,100), rep(NA,100)), ncol = 15))
pts &lt;- cbind(runif(100, 0, 5), runif(100, 0, 15))
terra::plot(rast)
points(pts)

pts &lt;- move(pts, rast)
terra::plot(rast)
points(pts)
</code></pre>

<hr>
<h2 id='outliers'>Visual detection of outliers.</h2><span id='topic+outliers'></span>

<h3>Description</h3>

<p>Draws plots of sites in geographical (longlat) and environmental (2-axis PCA) space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outliers(longlat, layers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outliers_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of species occurrence records.</p>
</td></tr>
<tr><td><code id="outliers_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster. It can be any set of environmental layers thought to allow the identification of environmental outliers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Erroneous data sources or errors in transcriptions may introduce outliers that can be easily detected by looking at simple graphs of geographical or environmental space.
</p>


<h3>Value</h3>

<p>A data.frame with coordinate values and distance to centroid in pca is returned. Two plots are drawn for visual inspection. The environmental plot includes row numbers for easy identification of possible outliers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records = red.examples("red.records")
layers = red.examples("red.layers")
outliers(records, layers[[1:3]])
</code></pre>

<hr>
<h2 id='raster.clean'>Uniformize raster layers.</h2><span id='topic+raster.clean'></span>

<h3>Description</h3>

<p>Crop raster layers to minimum size possible and uniformize NA values across layers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.clean(layers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.clean_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Excludes all marginal rows and columns with only NA values and change values to NA if they are NA in any of the layers.
</p>


<h3>Value</h3>

<p>A Raster* object, same class as layers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
terra::plot(raster.clean(layers))
</code></pre>

<hr>
<h2 id='raster.distance'>Create distance layer.</h2><span id='topic+raster.distance'></span>

<h3>Description</h3>

<p>Creates a layer depicting distances to records using the minimum, average, distance to the minimum convex polygon or distance taking into account a cost surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.distance(longlat, layers, type = "minimum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.distance_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of species occurrence records.</p>
</td></tr>
<tr><td><code id="raster.distance_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster to serve as model to create distance layer. Cost surface in case of param =&quot;cost&quot;.</p>
</td></tr>
<tr><td><code id="raster.distance_+3A_type">type</code></td>
<td>
<p>text string indicating whether the output should be the &quot;minimum&quot;, &quot;average&quot;, or &quot;mcp&quot; distance to all records. &quot;mcp&quot; means the distance to the minimum convex polygon encompassing all records.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using distance to records in models may help limiting the extrapolation of the predicted area much beyond known areas.
</p>


<h3>Value</h3>

<p>A RasterLayer object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
alt = layers[[3]]
records = red.examples("red.records")
par(mfrow=c(3,2))
terra::plot(alt)
points(records)

terra::plot(raster.distance(records, alt))
terra::plot(raster.distance(records, alt, type = "average"))
terra::plot(raster.distance(records, alt, type = "mcp"))
</code></pre>

<hr>
<h2 id='raster.east'>Create eastness layer.</h2><span id='topic+raster.east'></span>

<h3>Description</h3>

<p>Create a layer depicting eastness based on an elevation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.east(dem)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.east_+3A_dem">dem</code></td>
<td>
<p>RasterLayer object of elevation (a digital elevation model - DEM) as defined by package raster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using elevation, aspect can be calculated. Yet, it is a circular variable (0 = 360) and has to be converted to northness and eastness to be useful for modelling.
</p>


<h3>Value</h3>

<p>A RasterLayer object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
terra::plot(raster.east(layers[[3]]))
</code></pre>

<hr>
<h2 id='raster.lat'>Create latitude layer.</h2><span id='topic+raster.lat'></span>

<h3>Description</h3>

<p>Create a layer depicting latitude based on any other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.lat(layers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.lat_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using latitude (and longitude) in models may help limiting the extrapolation of the predicted area much beyond known areas.
</p>


<h3>Value</h3>

<p>A RasterLayer object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
terra::plot(raster.lat(layers[[1]]))
</code></pre>

<hr>
<h2 id='raster.long'>Create longitude layer.</h2><span id='topic+raster.long'></span>

<h3>Description</h3>

<p>Create a layer depicting longitude based on any other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.long(layers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.long_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using longitude (and latitude) in models may help limiting the extrapolation of the predicted area much beyond known areas.
</p>


<h3>Value</h3>

<p>A RasterLayer object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
terra::plot(raster.long(layers))
</code></pre>

<hr>
<h2 id='raster.north'>Create northness layer.</h2><span id='topic+raster.north'></span>

<h3>Description</h3>

<p>Create a layer depicting northness based on an elevation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.north(dem)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.north_+3A_dem">dem</code></td>
<td>
<p>RasterLayer object of elevation (a digital elevation model - DEM) as defined by package raster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using elevation, aspect can be calculated. Yet, it is a circular variable (0 = 360) and has to be converted to northness and eastness to be useful for modelling.
</p>


<h3>Value</h3>

<p>A RasterLayer object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
terra::plot(raster.north(layers[[3]]))
</code></pre>

<hr>
<h2 id='raster.read'>Read and buffer raster layers.</h2><span id='topic+raster.read'></span>

<h3>Description</h3>

<p>Read raster layers of environmental or other variables and crop them to a given extent around the known occurrences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.read(longlat, layers = NULL, ext = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.read_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of species occurrence records.</p>
</td></tr>
<tr><td><code id="raster.read_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster.</p>
</td></tr>
<tr><td><code id="raster.read_+3A_ext">ext</code></td>
<td>
<p>Either extent of map or buffer around the known records used to crop layers. If buffer, it is relative to the maximum distance between any two records.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If layers are not given, the function will read either 30 arc-second (approx. 1km) or 5 arc-minutes (approx. 10km) resolution rasters from worldclim (Fick &amp; Hijmans 2017) and landcover (Tuanmu &amp; Jetz 2014) if red.setup() is run previously.
</p>


<h3>Value</h3>

<p>A RasterStack object (If no layers are given: Variables 1-19 = bioclim, 20 = elevation, 21-32 = proportion landcover, 33 = most common landcover).
</p>


<h3>References</h3>

<p>Fick, S.E. &amp; Hijmans, R.J. (2017) Worldclim 2: new 1-km spatial resolution climate surfaces for global land areas. International Journal of Climatology, in press.
</p>
<p>Tuanmu, M.-N. &amp; Jetz, W. (2014) A global 1-km consensus land-cover product for biodiversity and ecosystem modeling. Global Ecology and Biogeography, 23: 1031-1045.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>layers = red.examples("red.layers")
records = red.examples("red.records")
par(mfrow=c(1,2))

terra::plot(layers[[1]])
points(records)

croppedLayers &lt;- raster.read(records, layers, 0.1)
terra::plot(croppedLayers[[1]])
points(records)
</code></pre>

<hr>
<h2 id='raster.reduce'>Reduce dimensionality of raster layers.</h2><span id='topic+raster.reduce'></span>

<h3>Description</h3>

<p>Reduce the number of layers by either performing a PCA on them or by eliminating highly correlated ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raster.reduce(layers, method = "pca", n = NULL, thres = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raster.reduce_+3A_layers">layers</code></td>
<td>
<p>Raster* object as defined by package raster.</p>
</td></tr>
<tr><td><code id="raster.reduce_+3A_method">method</code></td>
<td>
<p>Either Principal Components Analysis (&quot;pca&quot;, default) or Pearson's correlation (&quot;cor&quot;).</p>
</td></tr>
<tr><td><code id="raster.reduce_+3A_n">n</code></td>
<td>
<p>Number of layers to reduce to.</p>
</td></tr>
<tr><td><code id="raster.reduce_+3A_thres">thres</code></td>
<td>
<p>Value for pairwise Pearson's correlation above which one of the layers (randomly selected) is eliminated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using a large number of explanatory variables in models with few records may lead to overfitting. This function allows to avoid it as much as possible.
If both n and thres are given, n has priority. If method is not recognized and layers come from raster.read function, only landcover is reduced by using only the dominating landuse of each cell.
</p>


<h3>Value</h3>

<p>A RasterStack object.
</p>

<hr>
<h2 id='records'>Download taxon records from GBIF.</h2><span id='topic+records'></span>

<h3>Description</h3>

<p>Downloads species or higher taxon data from GBIF and outputs non-duplicate records with geographical coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>records(taxon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="records_+3A_taxon">taxon</code></td>
<td>
<p>Taxon name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As always when using data from multiple sources the user should be careful and check if records &quot;make sense&quot;. This can be done by either ploting them in a map (e.g. using red::map.draw()) or using red::outliers().
</p>


<h3>Value</h3>

<p>A data.frame with longitude and latitude, plus species names if taxon is above species.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rec = records("Nephila senegalensis")
plot(rec)
</code></pre>

<hr>
<h2 id='red.examples'>Example data packaged with *red*</h2><span id='topic+red.examples'></span>

<h3>Description</h3>

<p>Load data included in the package. This includes *red.records*,
a matrix of longitude and latitude (two columns) occurrence records for
Hogna maderiana (Walckenaer, 1837); *red.range*, a SpatRaster object, as
defined by package terra, of the geographic range of Hogna maderiana
(Walckenaer, 1837); *red.layers*, a SpatRaster object with layers 
representing the average annual temperature, total annual precipitation,
altitude and landcover for Madeira Island
(Fick &amp; Hijmans 2017, Tuanmu &amp; Jetz 2014); and *worldborders* is a small vector
of global country borders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>red.examples(data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="red.examples_+3A_data">data</code></td>
<td>
<p>Name of data in quotes. E.g.: '&quot;red.records&quot;'
If 'NULL', the example files will be listed.</p>
</td></tr>
</table>


<h3>Source</h3>

<p>This function is inspired by 'palmerpanguins::path_to_file()'
which in turn is based on 'readxl::readxl_example()'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>red.examples()
red.examples("red.range")
</code></pre>

<hr>
<h2 id='red.getDir'>Read GIS directory.</h2><span id='topic+red.getDir'></span>

<h3>Description</h3>

<p>Read directory where GIS files are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>red.getDir()
</code></pre>


<h3>Details</h3>

<p>Reads a txt file pointing to where the world GIS files are stored.
</p>

<hr>
<h2 id='red.setDir'>Setup GIS directory.</h2><span id='topic+red.setDir'></span>

<h3>Description</h3>

<p>Setup directory where GIS files are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>red.setDir(gisPath = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="red.setDir_+3A_gispath">gisPath</code></td>
<td>
<p>Path to the directory where the gis files are stored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writes a txt file in the red directory allowing the package to always access the world GIS files directory.
</p>

<hr>
<h2 id='red.setup'>Download and setup GIS files.</h2><span id='topic+red.setup'></span>

<h3>Description</h3>

<p>Setup red to work with species distribution modelling and layers available online.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>red.setup()
</code></pre>


<h3>Details</h3>

<p>Please check that you have at least 50Gb free in your disk (and a fast internet connection) to download all files. In the end of the process &quot;only&quot; 17.4Gb will be left though. This function will:
1. Check if maxent.jar is available in the dismo package directory.
2. Ask user input for GIS directory.
3. Download global bioclim and elevation files (20) from http://biogeo.ucdavis.edu/data/worldclim/v2.0/tif/base/wc2.0_30s_bio.zip.
4. Download landcover files (12) from http://data.earthenv.org/consensus_landcover/without_DISCover/.
5. Unzip all files and delete the originals.
6. Create a new layer (1) with the dominant land cover at each cell.
7. Resample all files (33) to approximately 10x10km (for use with widespread species) grid cells.
Sit back and enjoy, this should take a while.
</p>

<hr>
<h2 id='rli'>Red List Index.</h2><span id='topic+rli'></span>

<h3>Description</h3>

<p>Calculates the Red List Index (RLI) for a group of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rli(spData, tree = NULL, boot = FALSE, dd = FALSE, runs = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rli_+3A_spdata">spData</code></td>
<td>
<p>Either a vector with species assessment categories for a single point in time or a matrix with two points in time in different columns (species x date). Values can be text (EX, EW, RE, CR, EN, VU, NT, DD, LC) or numeric (0 for LC, 1 for NT, 2 for VU, 3 for EN, 4 for CR, 5 for RE/EW/EX).</p>
</td></tr>
<tr><td><code id="rli_+3A_tree">tree</code></td>
<td>
<p>An hclust or phylo object (used when species are weighted by their unique contribution to phylogenetic or functional diversity).</p>
</td></tr>
<tr><td><code id="rli_+3A_boot">boot</code></td>
<td>
<p>If TRUE bootstrapping for statistical significance is performed on both values per date and the trend between dates.</p>
</td></tr>
<tr><td><code id="rli_+3A_dd">dd</code></td>
<td>
<p>bootstrap among all species (FALSE) or Data Deficient species only (TRUE).</p>
</td></tr>
<tr><td><code id="rli_+3A_runs">runs</code></td>
<td>
<p>Number of runs for bootstrapping</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IUCN Red List Index (RLI) (Butchart et al. 2004, 2007) reflects overall changes in IUCN Red List status over time of a group of taxa.
The RLI uses weight scores based on the Red List status of each of the assessed species. These scores range from 0 (Least Concern) to Extinct/Extinct in the Wild (5).
Summing these scores across all species and relating them to the worst-case scenario, i.e. all species extinct, gives us an indication of how biodiversity is doing.
Each species weight can further be influenced by how much it uniquely contributes to the phylogenetic or functional diversity of the group (Cardoso et al. in prep.).
To incorporate Importantly, the RLI is based on true improvements or deteriorations in the status of species, i.e. genuine changes. It excludes category changes resulting from, e.g., new knowledge (Butchart et al. 2007).
The RLI approach helps to develop a better understanding of which taxa, regions or ecosystems are declining or improving.
Juslen et al. (2016a, b) suggested the use of bootstrapping to search for statistical significance when comparing taxa or for trends in time of the index and this approach is here implemented.
</p>


<h3>Value</h3>

<p>Either a vector (if no two dates are given) or a matrix with the RLI values and, if bootstrap is performed, their confidence limits and significance.
</p>


<h3>References</h3>

<p>Butchart, S.H.M., Stattersfield, A.J., Bennun, L.A., Shutes, S.M., Akcakaya, H.R., Baillie, J.E.M., Stuart, S.N., Hilton-Taylor, C. &amp; Mace, G.M. (2004) Measuring global trends in the status of biodiversity: Red List Indices for birds. PloS Biology, 2: 2294-2304.
</p>
<p>Butchart, S.H.M., Akcakaya, H.R., Chanson, J., Baillie, J.E.M., Collen, B., Quader, S., Turner, W.R., Amin, R., Stuart, S.N. &amp; Hilton-Taylor, C. (2007) Improvements to the Red List index. PloS One, 2: e140.
</p>
<p>Juslen, A., Cardoso, P., Kullberg, J., Saari, S. &amp; Kaila, L. (2016a) Trends of extinction risk for Lepidoptera in Finland: the first national Red List Index of butterflies and moths. Insect Conservation and Diversity, 9: 118-123.
</p>
<p>Juslen, A., Pykala, J., Kuusela, S., Kaila, L., Kullberg, J., Mattila, J., Muona, J., Saari, S. &amp; Cardoso, P. (2016b) Application of the Red List Index as an indicator of habitat change. Biodiversity and Conservation, 25: 569-585.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rliData &lt;- matrix(c("LC","LC","EN","EN","EX","EX","LC","CR","DD","DD"), ncol = 2, byrow = TRUE)
colnames(rliData) &lt;- c("2000", "2010")
rli(rliData[,1])
rli(rliData[,1], boot = TRUE)
rli(rliData)
rli(rliData, boot = TRUE, dd = TRUE)
</code></pre>

<hr>
<h2 id='rli.map'>Mapping the Red List Index.</h2><span id='topic+rli.map'></span>

<h3>Description</h3>

<p>Creates a map for the red list index according to species distribution and threat status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rli.map(spData, layers, layers2 = NULL, tree = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rli.map_+3A_spdata">spData</code></td>
<td>
<p>Either a vector with species assessment categories for a single point in time or a matrix with two points in time in different columns (species x date). Values can be text (EX, EW, RE, CR, EN, VU, NT, DD, LC) or numeric (0 for LC, 1 for NT, 2 for VU, 3 for EN, 4 for CR, 5 for RE/EW/EX).</p>
</td></tr>
<tr><td><code id="rli.map_+3A_layers">layers</code></td>
<td>
<p>Species distributions (0/1), a Raster* object as defined by package raster.</p>
</td></tr>
<tr><td><code id="rli.map_+3A_layers2">layers2</code></td>
<td>
<p>Species distributions (0/1) on the second point in time, a Raster* object as defined by package raster. If there are two dates but no layers2, the distributions are assumed to be kept constant in time.</p>
</td></tr>
<tr><td><code id="rli.map_+3A_tree">tree</code></td>
<td>
<p>An hclust or phylo object (used when species are weighted by their unique contribution to phylogenetic or functional diversity).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IUCN Red List Index (RLI) (Butchart et al. 2004, 2007) reflects overall changes in IUCN Red List status over time of a group of taxa.
The RLI uses weight scores based on the Red List status of each of the assessed species. These scores range from 0 (Least Concern) to Extinct/Extinct in the Wild (5).
Summing these scores across all species and relating them to the worst-case scenario, i.e. all species extinct, gives us an indication of how biodiversity is doing.
Each species weight can further be influenced by how much it uniquely contributes to the phylogenetic or functional diversity of the group (Cardoso et al. in prep.).
</p>


<h3>Value</h3>

<p>A RasterLayer with point values  (if a single date is given) or change per cell (if two dates are given).
</p>


<h3>References</h3>

<p>Butchart, S.H.M., Stattersfield, A.J., Bennun, L.A., Shutes, S.M., Akcakaya, H.R., Baillie, J.E.M., Stuart, S.N., Hilton-Taylor, C. &amp; Mace, G.M. (2004) Measuring global trends in the status of biodiversity: Red List Indices for birds. PloS Biology, 2: 2294-2304.
</p>
<p>Butchart, S.H.M., Akcakaya, H.R., Chanson, J., Baillie, J.E.M., Collen, B., Quader, S., Turner, W.R., Amin, R., Stuart, S.N. &amp; Hilton-Taylor, C. (2007) Improvements to the Red List index. PloS One, 2: e140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sp1 &lt;- terra::rast(matrix(c(1,1,1,0,0,0,0,0,NA), ncol = 3))
sp2 &lt;- terra::rast(matrix(c(1,0,0,1,0,0,1,0,NA), ncol = 3))
sp3 &lt;- terra::rast(matrix(c(1,0,0,0,0,0,0,0,NA), ncol = 3))
sp4 &lt;- terra::rast(matrix(c(0,1,1,1,1,1,1,1,NA), ncol = 3))
layers &lt;- c(sp1, sp2, sp3, sp4)
spData &lt;- c("CR","EN","VU","LC")
terra::plot(rli.map(spData, layers))
</code></pre>

<hr>
<h2 id='rli.multi'>Red List Index for multiple groups.</h2><span id='topic+rli.multi'></span>

<h3>Description</h3>

<p>Calculates the Red List Index (RLI) for multiple groups of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rli.multi(spData, tree = NULL, boot = FALSE, dd = FALSE, runs = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rli.multi_+3A_spdata">spData</code></td>
<td>
<p>A matrix with group names (first column) and species assessment categories for one or two points in time (remaining columns). Values can be text (EX, EW, RE, CR, EN, VU, NT, DD, LC) or numeric (0 for LC, 1 for NT, 2 for VU, 3 for EN, 4 for CR, 5 for RE/EW/EX).</p>
</td></tr>
<tr><td><code id="rli.multi_+3A_tree">tree</code></td>
<td>
<p>A list of hclust or phylo objects, each corresponding to a tree per group (used when species are weighted by their unique contribution to phylogenetic or functional diversity).</p>
</td></tr>
<tr><td><code id="rli.multi_+3A_boot">boot</code></td>
<td>
<p>If TRUE bootstrapping for statistical significance is performed on both values per date and the trend between dates.</p>
</td></tr>
<tr><td><code id="rli.multi_+3A_dd">dd</code></td>
<td>
<p>bootstrap among all species (FALSE) or Data Deficient species only (TRUE).</p>
</td></tr>
<tr><td><code id="rli.multi_+3A_runs">runs</code></td>
<td>
<p>Number of runs for bootstrapping</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IUCN Red List Index (RLI) (Butchart et al. 2004, 2007) reflects overall changes in IUCN Red List status over time of a group of taxa.
The RLI uses weight scores based on the Red List status of each of the assessed species. These scores range from 0 (Least Concern) to 5 (Extinct/Extinct in the Wild).
Summing these scores across all species and relating them to the worst-case scenario, i.e. all species extinct, gives us an indication of how biodiversity is doing.
Each species weight can further be influenced by how much it uniquely contributes to the phylogenetic or functional diversity of the group (Cardoso et al. in prep.).
Importantly, the RLI is based on true improvements or deteriorations in the status of species, i.e. genuine changes. It excludes category changes resulting from, e.g., new knowledge (Butchart et al. 2007).
The RLI approach helps to develop a better understanding of which taxa, regions or ecosystems are declining or improving.
Juslen et al. (2016a, b) suggested the use of bootstrapping to search for statistical significance when comparing taxa or for trends in time of the index and this approach is here implemented.
</p>


<h3>Value</h3>

<p>A matrix with the RLI values and, if bootstrap is performed, their confidence limits and significance.
</p>


<h3>References</h3>

<p>Butchart, S.H.M., Stattersfield, A.J., Bennun, L.A., Shutes, S.M., Akcakaya, H.R., Baillie, J.E.M., Stuart, S.N., Hilton-Taylor, C. &amp; Mace, G.M. (2004) Measuring global trends in the status of biodiversity: Red List Indices for birds. PloS Biology, 2: 2294-2304.
</p>
<p>Butchart, S.H.M., Akcakaya, H.R., Chanson, J., Baillie, J.E.M., Collen, B., Quader, S., Turner, W.R., Amin, R., Stuart, S.N. &amp; Hilton-Taylor, C. (2007) Improvements to the Red List index. PloS One, 2: e140.
</p>
<p>Juslen, A., Cardoso, P., Kullberg, J., Saari, S. &amp; Kaila, L. (2016a) Trends of extinction risk for Lepidoptera in Finland: the first national Red List Index of butterflies and moths. Insect Conservation and Diversity, 9: 118-123.
</p>
<p>Juslen, A., Pykala, J., Kuusela, S., Kaila, L., Kullberg, J., Mattila, J., Muona, J., Saari, S. &amp; Cardoso, P. (2016b) Application of the Red List Index as an indicator of habitat change. Biodiversity and Conservation, 25: 569-585.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rliData &lt;- matrix(c("LC","LC","EN","EN","EX","EX","LC","CR","CR","EX"), ncol = 2, byrow = TRUE)
colnames(rliData) &lt;- c("2000", "2010")
rliData &lt;- cbind(c("Arthropods","Arthropods","Birds","Birds","Birds"), rliData)
rli.multi(rliData[,1:2])
rli.multi(rliData[,1:2], boot = TRUE)
rli.multi(rliData)
rli.multi(rliData, boot = TRUE)
</code></pre>

<hr>
<h2 id='rli.predict'>Prediction of Red List Index.</h2><span id='topic+rli.predict'></span>

<h3>Description</h3>

<p>Linearly interpolates and extrapolates RLI values to any years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rli.predict(rliValue, from = NA, to = NA, rliPlot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rli.predict_+3A_rlivalue">rliValue</code></td>
<td>
<p>Should be a vector with RLI values and names as the corresponding year numbers.</p>
</td></tr>
<tr><td><code id="rli.predict_+3A_from">from</code></td>
<td>
<p>Starting year of the sequence to predict.</p>
</td></tr>
<tr><td><code id="rli.predict_+3A_to">to</code></td>
<td>
<p>Ending year of the sequence to predict.</p>
</td></tr>
<tr><td><code id="rli.predict_+3A_rliplot">rliPlot</code></td>
<td>
<p>Plots the result</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IUCN Red List Index (RLI) (Butchart et al. 2004, 2007) reflects overall changes in IUCN Red List status over time of a group of taxa.
</p>


<h3>Value</h3>

<p>A matrix with the RLI values and confidence limits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rliValue &lt;- c(4.5, 4.3, 4.4, 4.2, 4.0)
names(rliValue) &lt;- c(2000, 2004, 2008, 2011, 2017)
rli.predict(rliValue, 1990, 2020)
</code></pre>

<hr>
<h2 id='rli.sampled'>Sampled Red List Index.</h2><span id='topic+rli.sampled'></span>

<h3>Description</h3>

<p>Calculates accumulation curve of confidence limits in sampled RLI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rli.sampled(spData, tree = NULL, p = 0.05, runs = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rli.sampled_+3A_spdata">spData</code></td>
<td>
<p>A vector with species assessment categories for a single point in time. Values can be text (EX, EW, RE, CR, EN, VU, NT, DD, LC) or numeric (0 for LC, 1 for NT, 2 for VU, 3 for EN, 4 for CR, 5 for RE/EW/EX).</p>
</td></tr>
<tr><td><code id="rli.sampled_+3A_tree">tree</code></td>
<td>
<p>An hclust or phylo object (used when species are weighted by their unique contribution to phylogenetic or functional diversity).</p>
</td></tr>
<tr><td><code id="rli.sampled_+3A_p">p</code></td>
<td>
<p>p-value of confidence limits (in a two-tailed test).</p>
</td></tr>
<tr><td><code id="rli.sampled_+3A_runs">runs</code></td>
<td>
<p>Number of runs for smoothing accumulation curves.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IUCN Red List Index (RLI) (Butchart et al. 2004, 2007) reflects overall changes in IUCN Red List status over time of a group of taxa.
The RLI uses weight scores based on the Red List status of each of the assessed species. These scores range from 0 (Least Concern) to Extinct/Extinct in the Wild (5).
Summing these scores across all species and relating them to the worst-case scenario, i.e. all species extinct, gives us an indication of how biodiversity is doing.
Yet, in many groups, it is not possible to assess all species due to huge diversity and/or lack of resources. In such case, the RLI is estimated from a randomly selected sample of species - the Sampled Red List Index (SRLI; Stuart et al. 2010).
This function allows to calculate how many species are needed to reach a given maximum error of the SRLI around the true value of the RLI (with all species included) for future assessments of the group.
</p>


<h3>Value</h3>

<p>A vector with the accumulation of the error of the SRLI around the true value of the RLI (with all species included).
</p>


<h3>References</h3>

<p>Butchart, S.H.M., Stattersfield, A.J., Bennun, L.A., Shutes, S.M., Akcakaya, H.R., Baillie, J.E.M., Stuart, S.N., Hilton-Taylor, C. &amp; Mace, G.M. (2004) Measuring global trends in the status of biodiversity: Red List Indices for birds. PLoS Biology, 2: 2294-2304.
</p>
<p>Butchart, S.H.M., Akcakaya, H.R., Chanson, J., Baillie, J.E.M., Collen, B., Quader, S., Turner, W.R., Amin, R., Stuart, S.N. &amp; Hilton-Taylor, C. (2007) Improvements to the Red List index. PLoS One, 2: e140.
</p>
<p>Stuart, S.N., Wilson, E.O., McNeely, J.A., Mittermeier, R.A. &amp; Rodriguez, J.P. (2010) The barometer of Life. Science 328, 117.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rliData &lt;- c("LC","LC","EN","EN","EX","EX","LC","CR","CR","EX")
rli.sampled(rliData)
</code></pre>

<hr>
<h2 id='thin'>Spatial thinning of occurrence records.</h2><span id='topic+thin'></span>

<h3>Description</h3>

<p>Thinning of records with minimum distances either absolute or relative to the species range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thin(longlat, distance = 0.01, relative = TRUE, runs = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thin_+3A_longlat">longlat</code></td>
<td>
<p>Matrix of longitude and latitude or eastness and northness (two columns in this order) of species occurrence records.</p>
</td></tr>
<tr><td><code id="thin_+3A_distance">distance</code></td>
<td>
<p>Distance either in relative terms (proportion of maximum distance between any two records) or in raster units.</p>
</td></tr>
<tr><td><code id="thin_+3A_relative">relative</code></td>
<td>
<p>If TRUE, represents the proportion of maximum distance between any two records. If FALSE, is in raster units.</p>
</td></tr>
<tr><td><code id="thin_+3A_runs">runs</code></td>
<td>
<p>Number of runs</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Clumped distribution records due to ease of accessibility of sites, emphasis of sampling on certain areas in the past, etc. may bias species distribution models.
The algorithm used here eliminates records closer than a given distance to any other record. The choice of records to eliminate is random, so a number of runs are made and the one keeping more of the original records is chosen.
</p>


<h3>Value</h3>

<p>A matrix of species occurrence records separated by at least the given distance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>records &lt;- matrix(sample(100), ncol = 2)
par(mfrow=c(1,2))
graphics::plot(records)
records &lt;- thin(records, 0.1)
graphics::plot(records)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
