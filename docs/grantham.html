<!DOCTYPE html><html><head><title>Help for package grantham</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {grantham}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#grantham-package'><p>grantham: Calculate the 'Grantham' Distance</p></a></li>
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#amino_acid_pairs'><p>Generate amino acid pairs</p></a></li>
<li><a href='#amino_acids'><p>The 20 standard amino acids</p></a></li>
<li><a href='#amino_acids_properties'><p>Amino acid side chain property values</p></a></li>
<li><a href='#as_one_letter'><p>Convert three-letter amino acid codes to one-letter codes</p></a></li>
<li><a href='#as_three_letter'><p>Convert one-letter amino acid codes to three-letter codes</p></a></li>
<li><a href='#grantham_distance'><p>Grantham distance</p></a></li>
<li><a href='#grantham_distance_exact'><p>Grantham's distance (exact)</p></a></li>
<li><a href='#grantham_distance_original'><p>Grantham's distance (original)</p></a></li>
<li><a href='#grantham_distances_matrix'><p>Grantham distance matrix</p></a></li>
<li><a href='#grantham_equation'><p>Grantham distance</p></a></li>
<li><a href='#ij2k'><p>Convert an (i, j) index to a linear index.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate the 'Grantham' Distance</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A minimal set of routines to calculate the 'Grantham' distance
    &lt;<a href="https://doi.org/10.1126%2Fscience.185.4154.862">doi:10.1126/science.185.4154.862</a>&gt;. The 'Grantham' distance attempts to
    provide a proxy for the evolutionary distance between two amino acids
    based on three key chemical properties: composition, polarity and
    molecular volume. In turn, evolutionary distance is used as a proxy for
    the impact of missense mutations. The higher the distance, the more
    deleterious the substitution is expected to be.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tibble, magrittr, vctrs, dplyr, tidyr, rlang, stringr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://maialab.org/grantham/">https://maialab.org/grantham/</a>, <a href="https://github.com/maialab/grantham">https://github.com/maialab/grantham</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/maialab/grantham/issues">https://github.com/maialab/grantham/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-07 02:12:22 UTC; rmagno</td>
</tr>
<tr>
<td>Author:</td>
<td>Ramiro Magno <a href="https://orcid.org/0000-0001-5226-3441"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Isabel Duarte <a href="https://orcid.org/0000-0003-0060-2936"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ana-Teresa Maia <a href="https://orcid.org/0000-0002-0454-9207"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  CINTESIS [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ramiro Magno &lt;ramiro.magno@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-07 03:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='grantham-package'>grantham: Calculate the 'Grantham' Distance</h2><span id='topic+grantham'></span><span id='topic+grantham-package'></span>

<h3>Description</h3>

<p>A minimal set of routines to calculate the 'Grantham' distance &lt;doi:10.1126/science.185.4154.862&gt;. The 'Grantham' distance attempts to provide a proxy for the evolutionary distance between two amino acids based on three key chemical properties: composition, polarity and molecular volume. In turn, evolutionary distance is used as a proxy for the impact of missense mutations. The higher the distance, the more deleterious the substitution is expected to be.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ramiro Magno <a href="mailto:ramiro.magno@gmail.com">ramiro.magno@gmail.com</a> (<a href="https://orcid.org/0000-0001-5226-3441">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Isabel Duarte <a href="mailto:iduarte.scientist@gmail.com">iduarte.scientist@gmail.com</a> (<a href="https://orcid.org/0000-0003-0060-2936">ORCID</a>)
</p>
</li>
<li><p> Ana-Teresa Maia <a href="mailto:maia.anateresa@gmail.com">maia.anateresa@gmail.com</a> (<a href="https://orcid.org/0000-0002-0454-9207">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> CINTESIS [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://maialab.org/grantham/">https://maialab.org/grantham/</a>
</p>
</li>
<li> <p><a href="https://github.com/maialab/grantham">https://github.com/maialab/grantham</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/maialab/grantham/issues">https://github.com/maialab/grantham/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='amino_acid_pairs'>Generate amino acid pairs</h2><span id='topic+amino_acid_pairs'></span>

<h3>Description</h3>

<p>This function generates combinations of amino acids in pairs. By default, it
generates all pair combinations of the 20 standard amino acids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amino_acid_pairs(
  x = amino_acids(),
  y = amino_acids(),
  keep_self = TRUE,
  keep_duplicates = TRUE,
  keep_reverses = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amino_acid_pairs_+3A_x">x</code></td>
<td>
<p>A character vector of amino acids (three-letter codes).</p>
</td></tr>
<tr><td><code id="amino_acid_pairs_+3A_y">y</code></td>
<td>
<p>Another character vector of amino acids (three-letter codes).</p>
</td></tr>
<tr><td><code id="amino_acid_pairs_+3A_keep_self">keep_self</code></td>
<td>
<p>Whether to keep pairs involving the same amino acid.</p>
</td></tr>
<tr><td><code id="amino_acid_pairs_+3A_keep_duplicates">keep_duplicates</code></td>
<td>
<p>Whether to keep duplicated pairs.</p>
</td></tr>
<tr><td><code id="amino_acid_pairs_+3A_keep_reverses">keep_reverses</code></td>
<td>
<p>Whether to keep pairs that are reversed versions of
others. E.g. if <code>keep_reverses</code> is <code>TRUE</code> the pairs <code>"Ser"</code>-<code>"Arg"</code> and
<code>"Arg"</code>-<code>"Ser"</code> will be kept in the returned tibble; however, if
<code>keep_reverses</code> is <code>FALSE</code>, only the first pair is preserved in the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> of amino acid pairs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate all pairs of the 20 standard amino acids
amino_acid_pairs()

# Remove the self-to-self pairs
amino_acid_pairs(keep_self = FALSE)

# Generate specific combinations of Ser against Ala and Trp.
amino_acid_pairs(x = 'Ser', y = c('Ala', 'Trp'))
</code></pre>

<hr>
<h2 id='amino_acids'>The 20 standard amino acids</h2><span id='topic+amino_acids'></span>

<h3>Description</h3>

<p>The 20 amino acids that are encoded directly by the codons of the universal
genetic code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amino_acids()
</code></pre>


<h3>Value</h3>

<p>Three-letter codes of the standard amino acids.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>amino_acids()

</code></pre>

<hr>
<h2 id='amino_acids_properties'>Amino acid side chain property values</h2><span id='topic+amino_acids_properties'></span>

<h3>Description</h3>

<p>A dataset containing the amino acid side chain property values
&mdash;composition, polarity and molecular volume. These values were obtained
from Table 1,  Grantham (1974), doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amino_acids_properties
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 20 rows and 4 columns.
</p>


<h3>Source</h3>

<p>Table 1,  Grantham (1974), doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>amino_acids_properties

</code></pre>

<hr>
<h2 id='as_one_letter'>Convert three-letter amino acid codes to one-letter codes</h2><span id='topic+as_one_letter'></span>

<h3>Description</h3>

<p>Converts three-letter amino acid abbreviations to one-letter codes, e.g., Leu
to L. The accepted codes in the input include the 20
standard amino acids and also Asx (Asparagine or Aspartic acid), converted
to B, and Glx (Glutamine or Glutamic acid) converted to Z.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_one_letter(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_one_letter_+3A_x">x</code></td>
<td>
<p>A character vector of three-letter amino acid codes, e.g. <code>"Ser"</code>,
<code>"Arg"</code>, <code>"Leu"</code>, or <code>"Asx"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of one-letter amino acid codes, e.g. <code>"S"</code>, <code>"R"</code>,
<code>"L"</code>, or <code>"B"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert Ser to S, Arg to R and Pro to P.
as_one_letter(c('Ser', 'Arg', 'Pro'))

# The function `as_one_letter()` is case insensitive on the input but will
# always return the one-letter codes in uppercase.
as_one_letter(c('ser', 'ArG', 'PRO'))

# Convert the codes of the 20 standard amino acids. Note that the function
# `amino_acids()` returns the three-letter codes of the 20 standard amino
# acids.
as_one_letter(amino_acids())

# Convert also special case codes Asx (Asparagine or Aspartic acid) and Glx
# (Glutamine or Glutamic acid)
as_one_letter(c('Asx', 'Glx'))

# Invalid codes in the input are converted to NA.
# "Ser" is correctly mapped to "S" but "Serine" is not as it is not a
# three-letter amino acid code (the same applies to "Glucose").
as_one_letter(c('Ser', 'Serine', 'Glucose'))

</code></pre>

<hr>
<h2 id='as_three_letter'>Convert one-letter amino acid codes to three-letter codes</h2><span id='topic+as_three_letter'></span>

<h3>Description</h3>

<p>Converts amino acid one-letter abbreviations to three-letter codes, e.g., L
to Leu. The accepted codes in the input include the 20
standard amino acids and also B (Asparagine or Aspartic acid), converted
to Asx, and Z (Glutamine or Glutamic acid) converted to Glx.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_three_letter(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_three_letter_+3A_x">x</code></td>
<td>
<p>A character vector of one-letter amino acid codes, e.g. <code>"S"</code>,
<code>"R"</code>, <code>"L"</code>, or <code>"P"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of three-letter amino acid codes, e.g. <code>"Ser"</code>,
<code>"Arg"</code>, <code>"Leu"</code>, or <code>"Pro"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert S to Ser, R to Arg and P to Pro.
as_three_letter(c('S', 'R', 'P'))

# The function `as_three_letter()` is case insensitive on the input but will
# always return the three-letter codes with the first letter in uppercase.
as_three_letter(c('S', 's', 'p', 'P'))

# Convert also special case codes B (Asparagine or Aspartic acid) and Z
# (Glutamine or Glutamic acid)
as_three_letter(c('B', 'Z'))

# Invalid codes in the input are converted to NA.
# "S" is correctly mapped to "Ser" but "Ser" and "Serine" are not
# one-letter amino acid codes and are therefore converted to NA.
as_three_letter(c('S', 's', 'Ser', 'Serine'))

</code></pre>

<hr>
<h2 id='grantham_distance'>Grantham distance</h2><span id='topic+grantham_distance'></span>

<h3>Description</h3>

<p>This function calculates the Grantham distance for pairs of amino acids.
Amino acid identities should be provided as three-letter codes in <code>x</code> and
<code>y</code>. Amino acids identified in <code>x</code> and <code>y</code> are matched element-wise, i.e. the
first element of <code>x</code> is paired with the first element of <code>y</code>, and so on.
</p>
<p>The Grantham distance attempts to provide a proxy for the evolutionary
distance between two amino acids based on three key chemical properties:
composition, polarity and molecular volume. In turn, evolutionary distance is
used as a proxy for the impact of missense substitutions. The higher the
distance, the more deleterious the substitution is.
</p>
<p>The distance calculation is provided by two methods. The so-called <em>original</em>
method, meaning that the amino acid distances used are the ones provided by
Grantham in his original publication in Table 2. This is the default method.
In addition, you may choose the <em>exact</em> method, which uses the chemical
properties provided in Grantham's Table 1 to compute the amino acid
differences anew. The distances calculated with the <em>exact</em> method are not
rounded to the nearest integer and will differ by ~1 unit for some amino acid
pairs from the <em>original</em> method.
</p>
<p>If you want to calculate Grantham's distance by providing the values of the
amino acid properties explicitly, then use <code><a href="#topic+grantham_equation">grantham_equation()</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grantham_distance(
  x,
  y,
  method = c("original", "exact"),
  alpha = 1.833,
  beta = 0.1018,
  gamma = 0.000399,
  rho = 50.723
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grantham_distance_+3A_x">x</code></td>
<td>
<p>A character vector of amino acid three-letter codes.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_y">y</code></td>
<td>
<p>A character vector of amino acid three-letter codes.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_method">method</code></td>
<td>
<p>Either <code>"original"</code> (default) or <code>"exact"</code>, see description for
more details.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_alpha">alpha</code></td>
<td>
<p>The constant <code class="reqn">\alpha</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_beta">beta</code></td>
<td>
<p>The constant <code class="reqn">\beta</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_gamma">gamma</code></td>
<td>
<p>The constant <code class="reqn">\gamma</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_+3A_rho">rho</code></td>
<td>
<p>Grantham's distances reported in Table 2, Science (1974).
185(4154): 862&ndash;4 by R. Grantham, are scaled by a factor (here named
<code class="reqn">\rho</code>) such that the mean value of all distances are 100. The <code>rho</code>
parameter allows this factor <code class="reqn">\rho</code> to be changed. By default
<code class="reqn">\rho=50.723</code>, the same value used by Grantham. This value is
originally mentioned in the caption of Table 2 of the aforementioned paper.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> of Grantham's distances for each
amino acid pair.
</p>


<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Grantham's distance between Serine (Ser) and Glutamate (Glu)
grantham_distance('Ser', 'Glu')

# Grantham's distance between Serine (Ser) and Glutamate (Glu)
# with the "exact" method
grantham_distance('Ser', 'Glu', method = 'exact')

# `grantham_distance()` is vectorised
# amino acids are paired element-wise between `x` and `y`
grantham_distance(x = c('Pro', 'Gly'), y = c('Glu', 'Arg'))

# Use `amino_acid_pairs()` to generate pairs (by default generates all pairs)
aa_pairs &lt;- amino_acid_pairs()
grantham_distance(x = aa_pairs$x, y = aa_pairs$y)

</code></pre>

<hr>
<h2 id='grantham_distance_exact'>Grantham's distance (exact)</h2><span id='topic+grantham_distance_exact'></span>

<h3>Description</h3>

<p>This function calculates the Grantham's distance for pairs of amino acids. It
uses the values for the amino acid properties as published in Table 1 of
Science (1974). 185(4154): 862&ndash;4 by R. Grantham.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grantham_distance_exact(
  x,
  y,
  alpha = 1.833,
  beta = 0.1018,
  gamma = 0.000399,
  rho = 50.723
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grantham_distance_exact_+3A_x">x</code></td>
<td>
<p>A character vector of amino acid three-letter codes, e.g. <code>"Ala"</code>
(Alanine).</p>
</td></tr>
<tr><td><code id="grantham_distance_exact_+3A_y">y</code></td>
<td>
<p>A character vector of amino acid three-letter codes.</p>
</td></tr>
<tr><td><code id="grantham_distance_exact_+3A_alpha">alpha</code></td>
<td>
<p>The constant <code class="reqn">\alpha</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_exact_+3A_beta">beta</code></td>
<td>
<p>The constant <code class="reqn">\beta</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_exact_+3A_gamma">gamma</code></td>
<td>
<p>The constant <code class="reqn">\gamma</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_distance_exact_+3A_rho">rho</code></td>
<td>
<p>Grantham's distances reported in Table 2, Science (1974).
185(4154): 862&ndash;4 by R. Grantham, are scaled by a factor (here named
<code class="reqn">\rho</code>) such that the mean value of all distances are 100. The <code>rho</code>
parameter allows this factor <code class="reqn">\rho</code> to be changed. By default
<code class="reqn">\rho=50.723</code>, the same value used by Grantham. This value is
originally mentioned in the caption of Table 2 of the aforementioned paper.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Contrary to Grantham's distances presented in Table 2 of Grantham's paper, the
distances returned by this function are calculated anew starting from the
amino acid properties (composition, polarity and molecular volume). No
rounding to nearest integer is performed.
</p>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> of Grantham's distances for each
amino acid pair.
</p>


<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grantham_equation">grantham_equation()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grantham_distance_exact(c('Ser', 'Ser'), c('Pro', 'Trp'))

</code></pre>

<hr>
<h2 id='grantham_distance_original'>Grantham's distance (original)</h2><span id='topic+grantham_distance_original'></span>

<h3>Description</h3>

<p>This function calculates the Grantham's distance for pairs of amino acids. It
uses the pre-calculated distances for each amino acid pair as published in
Table 2 of Science (1974). 185(4154): 862&ndash;4 by R. Grantham.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grantham_distance_original(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grantham_distance_original_+3A_x">x</code></td>
<td>
<p>A character vector of amino acid three-letter codes.</p>
</td></tr>
<tr><td><code id="grantham_distance_original_+3A_y">y</code></td>
<td>
<p>A character vector of amino acid three-letter codes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> of Grantham's distances for each
amino acid pair.
</p>


<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>

<hr>
<h2 id='grantham_distances_matrix'>Grantham distance matrix</h2><span id='topic+grantham_distances_matrix'></span>

<h3>Description</h3>

<p>A dataset containing Grantham distances in the format of a matrix. These
values were obtained from Table 2,  Grantham (1974),
doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grantham_distances_matrix
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> (inherits from <code>array</code>) with 20 rows and 20 columns.
</p>


<h3>Source</h3>

<p>Table 2,  Grantham (1974), doi: <a href="https://doi.org/10.1126/science.185.4154.862">10.1126/science.185.4154.862</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grantham_distances_matrix

</code></pre>

<hr>
<h2 id='grantham_equation'>Grantham distance</h2><span id='topic+grantham_equation'></span>

<h3>Description</h3>

<p>This function calculates Grantham's distance <code class="reqn">d_{i,j}</code> between two
amino acids (<code class="reqn">i</code> and <code class="reqn">j</code>) based on their chemical properties:
</p>
<p style="text-align: center;"><code class="reqn">d_{i,j} = \rho ((\alpha (c_i-c_j)^2 + \beta (p_i-p_j)^2 + \gamma (v_i-v_j)^2)^\frac{1}{2}</code>
</p>

<p>This calculation is based on three amino acid side chain properties that were
found to be the three strongest correlators with the relative substitution
frequency (RSF) (references cited in Grantham (1974)), namely:
</p>

<ul>
<li><p> composition <code class="reqn">c</code>, meaning the atomic weight ratio of hetero (noncarbon)
elements in end groups or rings to carbons in the side chain.
</p>
</li>
<li><p> polarity <code class="reqn">p</code>;
</p>
</li>
<li><p> molecular volume <code class="reqn">v</code>.
</p>
</li></ul>

<p>Each property difference is weighted by dividing by the mean distance found
with it alone in the formula. The constants <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and
<code class="reqn">\gamma</code> are squares of the inverses of mean distances of each property,
respectively.
</p>
<p>The distances reported by Grantham (1974) are further scaled by a factor
&mdash;here coined <code class="reqn">\rho</code>&mdash; such that the mean of all distances is 100.
Although this factor is not explicitly included in Grantham's distance
formula, it is actually used for calculating the amino acid pair distances
reported in Table 2 of Grantham's paper. So, for all intents and purposes,
this factor should be regarded as part of the formula used to calculate
Grantham distance, and therefore we include it explicitly in the equation
above.
</p>
<p>If you want to calculate Grantham's distance right off from the identity of
the amino acids, instead of using their chemical properties, then use
<code><a href="#topic+grantham_distance">grantham_distance()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grantham_equation(
  c_i,
  c_j,
  p_i,
  p_j,
  v_i,
  v_j,
  alpha = 1.833,
  beta = 0.1018,
  gamma = 0.000399,
  rho = 50.723
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grantham_equation_+3A_c_i">c_i</code></td>
<td>
<p>composition value for the <em>ith</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_c_j">c_j</code></td>
<td>
<p>composition value for the <em>jth</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_p_i">p_i</code></td>
<td>
<p>polarity value for the <em>ith</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_p_j">p_j</code></td>
<td>
<p>polarity value for the <em>jth</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_v_i">v_i</code></td>
<td>
<p>molecular volume value for the <em>ith</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_v_j">v_j</code></td>
<td>
<p>molecular volume value for the <em>jth</em> amino acid.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_alpha">alpha</code></td>
<td>
<p>The constant <code class="reqn">\alpha</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_beta">beta</code></td>
<td>
<p>The constant <code class="reqn">\beta</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_gamma">gamma</code></td>
<td>
<p>The constant <code class="reqn">\gamma</code> in the equation of Grantham's
paper, in page 863.</p>
</td></tr>
<tr><td><code id="grantham_equation_+3A_rho">rho</code></td>
<td>
<p>Grantham's distances reported in Table 2, Science (1974).
185(4154): 862&ndash;4 by R. Grantham, are scaled by a factor (here named
<code class="reqn">\rho</code>) such that the mean value of all distances are 100. The <code>rho</code>
parameter allows this factor <code class="reqn">\rho</code> to be changed. By default
<code class="reqn">\rho=50.723</code>, the same value used by Grantham. This value is
originally mentioned in the caption of Table 2 of the aforementioned paper.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A double vector of Grantham's distances.
</p>


<h3>See Also</h3>

<p>Check <a href="#topic+amino_acids_properties">amino_acids_properties</a> for a table of the three property
values that can be used with this formula. This data set is from Table 1,
Science (1974). 185(4154): 862&ndash;4 by R. Grantham.
</p>

<hr>
<h2 id='ij2k'>Convert an (i, j) index to a linear index.</h2><span id='topic+ij2k'></span>

<h3>Description</h3>

<p>Converts an (i, j) index to a linear index. Converts the double index of
a square matrix to the corresponding linear one. This is column-major
as it is default in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ij2k(i, j, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ij2k_+3A_i">i</code></td>
<td>
<p>i index, i.e. row position; indexing starts at 1.</p>
</td></tr>
<tr><td><code id="ij2k_+3A_j">j</code></td>
<td>
<p>j index, i.e. column position; indexing starts at 1.</p>
</td></tr>
<tr><td><code id="ij2k_+3A_n">n</code></td>
<td>
<p>size of the square matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Linear position.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
