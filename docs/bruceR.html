<!DOCTYPE html><html><head><title>Help for package bruceR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bruceR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%%COMPUTE%%'><p>Multivariate computation.</p></a></li>
<li><a href='#%^%'><p>Paste strings together.</p></a></li>
<li><a href='#%allin%'><p>A simple extension of <code>%in%</code>.</p></a></li>
<li><a href='#%anyin%'><p>A simple extension of <code>%in%</code>.</p></a></li>
<li><a href='#%nonein%'><p>A simple extension of <code>%in%</code>.</p></a></li>
<li><a href='#%notin%'><p>The opposite of <code>%in%</code>.</p></a></li>
<li><a href='#%partin%'><p>A simple extension of <code>%in%</code>.</p></a></li>
<li><a href='#add'><p>Create, modify, and delete variables.</p></a></li>
<li><a href='#Alpha'><p>Reliability analysis (Cronbach's <code class="reqn">\alpha</code> and McDonald's <code class="reqn">\omega</code>).</p></a></li>
<li><a href='#bruceR-demodata'><p>Demo data.</p></a></li>
<li><a href='#bruceR-package'><p>bruceR: <strong>BR</strong>oadly <strong>U</strong>seful <strong>C</strong>onvenient and <strong>E</strong>fficient <strong>R</strong> functions</p></a></li>
<li><a href='#cc'><p>Split up a string (with separators) into a character vector.</p></a></li>
<li><a href='#ccf_plot'><p>Cross-correlation analysis.</p></a></li>
<li><a href='#CFA'><p>Confirmatory Factor Analysis (CFA).</p></a></li>
<li><a href='#cor_diff'><p>Test the difference between two correlations.</p></a></li>
<li><a href='#cor_multilevel'><p>Multilevel correlations (within-level and between-level).</p></a></li>
<li><a href='#Corr'><p>Correlation analysis.</p></a></li>
<li><a href='#Describe'><p>Descriptive statistics.</p></a></li>
<li><a href='#dtime'><p>Timer (compute time difference).</p></a></li>
<li><a href='#EFA'><p>Principal Component Analysis (PCA) and Exploratory Factor analysis (EFA).</p></a></li>
<li><a href='#EMMEANS'><p>Simple-effect analysis and post-hoc multiple comparison.</p></a></li>
<li><a href='#export'><p>Export data to a file (TXT, CSV, Excel, SPSS, Stata, ...) or clipboard.</p></a></li>
<li><a href='#formatF'><p>Format numeric values.</p></a></li>
<li><a href='#formatN'><p>Format &quot;1234&quot; to &quot;1,234&quot;.</p></a></li>
<li><a href='#formula_expand'><p>Expand all interaction terms in a formula.</p></a></li>
<li><a href='#formula_paste'><p>Paste a formula into a string.</p></a></li>
<li><a href='#Freq'><p>Frequency statistics.</p></a></li>
<li><a href='#GLM_summary'><p>Tidy report of GLM (<code>lm</code> and <code>glm</code> models).</p></a></li>
<li><a href='#grand_mean_center'><p>Grand-mean centering.</p></a></li>
<li><a href='#granger_causality'><p>Granger causality test (multivariate).</p></a></li>
<li><a href='#granger_test'><p>Granger causality test (bivariate).</p></a></li>
<li><a href='#group_mean_center'><p>Group-mean centering.</p></a></li>
<li><a href='#HLM_ICC_rWG'><p>Tidy report of HLM indices: ICC(1), ICC(2), and rWG/rWG(J).</p></a></li>
<li><a href='#HLM_summary'><p>Tidy report of HLM (<code>lmer</code> and <code>glmer</code> models).</p></a></li>
<li><a href='#import'><p>Import data from a file (TXT, CSV, Excel, SPSS, Stata, ...) or clipboard.</p></a></li>
<li><a href='#lavaan_summary'><p>Tidy report of lavaan model.</p></a></li>
<li><a href='#LOOKUP'><p>Search, match, and look up values (like Excel's functions <code>INDEX + MATCH</code>).</p></a></li>
<li><a href='#MANOVA'><p>Multi-factor ANOVA.</p></a></li>
<li><a href='#med_summary'><p>Tidy report of mediation analysis.</p></a></li>
<li><a href='#model_summary'><p>Tidy report of regression models.</p></a></li>
<li><a href='#p'><p>Compute <em>p</em> value.</p></a></li>
<li><a href='#pkg_depend'><p>Check dependencies of R packages.</p></a></li>
<li><a href='#pkg_install_suggested'><p>Install suggested R packages.</p></a></li>
<li><a href='#Print'><p>Print strings with rich formats and colors.</p></a></li>
<li><a href='#print_table'><p>Print a three-line table (to R Console and Microsoft Word).</p></a></li>
<li><a href='#PROCESS'><p>PROCESS for mediation and/or moderation analyses.</p></a></li>
<li><a href='#RECODE'><p>Recode a variable.</p></a></li>
<li><a href='#regress'><p>Regression analysis.</p></a></li>
<li><a href='#rep_char'><p>Repeat a character string for many times and paste them up.</p></a></li>
<li><a href='#RESCALE'><p>Rescale a variable (e.g., from 5-point to 7-point).</p></a></li>
<li><a href='#RGB'><p>A simple extension of <code>rgb()</code>.</p></a></li>
<li><a href='#Run'><p>Run code parsed from text.</p></a></li>
<li><a href='#scaler'><p>Min-max scaling (min-max normalization).</p></a></li>
<li><a href='#set.wd'><p>Set working directory to the path of currently opened file.</p></a></li>
<li><a href='#show_colors'><p>Show colors.</p></a></li>
<li><a href='#theme_bruce'><p>A nice <code>ggplot2</code> theme that enables Markdown/HTML rich text.</p></a></li>
<li><a href='#TTEST'><p>One-sample, independent-samples, and paired-samples t-test.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Broadly Useful Convenient and Efficient R Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>2023.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-27</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Han-Wu-Shuang Bao &lt;baohws@foxmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Broadly useful convenient and efficient R functions
    that bring users concise and elegant R data analyses.
    This package includes easy-to-use functions for
    (1) basic R programming
    (e.g., set working directory to the path of currently opened file;
    import/export data from/to files in any format;
    print tables to Microsoft Word);
    (2) multivariate computation
    (e.g., compute scale sums/means/... with reverse scoring);
    (3) reliability analyses and factor analyses;
    (4) descriptive statistics and correlation analyses;
    (5) t-test, multi-factor analysis of variance (ANOVA),
    simple-effect analysis, and post-hoc multiple comparison;
    (6) tidy report of statistical models
    (to R Console and Microsoft Word);
    (7) mediation and moderation analyses (PROCESS);
    and (8) additional toolbox for statistics and graphics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://psychbruce.github.io/bruceR/">https://psychbruce.github.io/bruceR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/psychbruce/bruceR/issues">https://github.com/psychbruce/bruceR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rstudioapi, data.table, rio, plyr, dplyr, tidyr, stringr,
ggplot2, psych, afex, emmeans, effectsize, performance,
mediation, interactions, lavaan, jtools, texreg, lmerTest,
MuMIn</td>
</tr>
<tr>
<td>Suggests:</td>
<td>pacman, glue, crayon, tibble, forcats, haven, foreign,
readxl, openxlsx, clipr, cowplot, ggtext, see, car, lmtest,
lme4, nnet, vars, phia, MASS, BayesFactor, GGally, GPArotation</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-27 14:41:55 UTC; Bruce</td>
</tr>
<tr>
<td>Author:</td>
<td>Han-Wu-Shuang Bao <a href="https://orcid.org/0000-0003-3043-710X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-27 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+25COMPUTE+25+25'>Multivariate computation.</h2><span id='topic++25+25COMPUTE+25+25'></span><span id='topic+COUNT'></span><span id='topic+MODE'></span><span id='topic+SUM'></span><span id='topic+.sum'></span><span id='topic+MEAN'></span><span id='topic+.mean'></span><span id='topic+STD'></span><span id='topic+CONSEC'></span>

<h3>Description</h3>

<p>Easily compute multivariate sum, mean, and other scores.
Reverse scoring can also be easily implemented without saving extra variables.
<code><a href="#topic+Alpha">Alpha</a></code> function uses a similar method to deal with reverse scoring.
</p>
<p>Three ways to specify variables:
</p>

<ol>
<li> <p><strong><code>var + items</code></strong>: common and unique parts of variable names (suggested).
</p>
</li>
<li> <p><strong><code>vars</code></strong>: a character vector of variable names (suggested).
</p>
</li>
<li> <p><strong><code>varrange</code></strong>: starting and stopping positions of variables (NOT suggested).
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>COUNT(data, var = NULL, items = NULL, vars = NULL, varrange = NULL, value = NA)

MODE(data, var = NULL, items = NULL, vars = NULL, varrange = NULL)

SUM(
  data,
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  range = likert,
  likert = NULL,
  na.rm = TRUE
)

.sum(
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  range = likert,
  likert = NULL,
  na.rm = TRUE
)

MEAN(
  data,
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  range = likert,
  likert = NULL,
  na.rm = TRUE
)

.mean(
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  range = likert,
  likert = NULL,
  na.rm = TRUE
)

STD(
  data,
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  range = likert,
  likert = NULL,
  na.rm = TRUE
)

CONSEC(
  data,
  var = NULL,
  items = NULL,
  vars = NULL,
  varrange = NULL,
  values = 0:9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_var">var</code></td>
<td>
<p><strong>[Option 1]</strong>
Common part across variables: e.g., <code>"RSES"</code>, <code>"XX.{i}.pre"</code>
(if <code>var</code> string has any placeholder in braces <code>{...}</code>,
then <code>items</code> will be pasted into the braces, see examples)</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_items">items</code></td>
<td>
<p><strong>[Option 1]</strong>
Unique part across variables: e.g., <code>1:10</code>, <code>c("a", "b", "c")</code></p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_vars">vars</code></td>
<td>
<p><strong>[Option 2]</strong>
Character vector specifying variables: e.g., <code>c("X1", "X2", "X3", "X4", "X5")</code></p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_varrange">varrange</code></td>
<td>
<p><strong>[Option 3]</strong>
Character string specifying positions (&quot;start:stop&quot;) of variables: e.g., <code>"A1:E5"</code></p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_value">value</code></td>
<td>
<p>[Only for <code>COUNT</code>] The value to be counted.</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_rev">rev</code></td>
<td>
<p>[Optional] Variables that need to be reversed. It can be
(1) a character vector specifying the reverse-scoring variables (recommended), or
(2) a numeric vector specifying the item number of reverse-scoring variables (not recommended).</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_range">range</code>, <code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_likert">likert</code></td>
<td>
<p>[Optional] Range of likert scale: e.g., <code>1:5</code>, <code>c(1, 5)</code>.
If not provided, it will be automatically estimated from the given data (BUT you should use this carefully).</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_na.rm">na.rm</code></td>
<td>
<p>Ignore missing values. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="+2B25+2B25COMPUTE+2B25+2B25_+3A_values">values</code></td>
<td>
<p>[Only for <code>CONSEC</code>] Values to be counted as consecutive identical values. Defaults to all numbers (<code>0:9</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of computed values.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>COUNT()</code>: <strong>Count</strong> a certain value across variables.
</p>
</li>
<li> <p><code>MODE()</code>: Compute <strong>mode</strong> across variables.
</p>
</li>
<li> <p><code>SUM()</code>: Compute <strong>sum</strong> across variables.
</p>
</li>
<li> <p><code>.sum()</code>: Tidy version of <code>SUM</code>,
only can be used in <code><a href="#topic+add">add()/added()</a></code>
</p>
</li>
<li> <p><code>MEAN()</code>: Compute <strong>mean</strong> across variables.
</p>
</li>
<li> <p><code>.mean()</code>: Tidy version of <code>MEAN</code>,
only can be used in <code><a href="#topic+add">add()/added()</a></code>
</p>
</li>
<li> <p><code>STD()</code>: Compute <strong>standard deviation</strong> across variables.
</p>
</li>
<li> <p><code>CONSEC()</code>: Compute <strong>consecutive identical digits</strong> across variables (especially useful in detecting careless responding).
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>d = data.table(
  x1 = 1:5,
  x4 = c(2,2,5,4,5),
  x3 = c(3,2,NA,NA,5),
  x2 = c(4,4,NA,2,5),
  x5 = c(5,4,1,4,5)
)
d
## I deliberately set this order to show you
## the difference between "vars" and "varrange".

## ====== Usage 1: data.table `:=` ====== ##
d[, `:=`(
  na = COUNT(d, "x", 1:5, value=NA),
  n.2 = COUNT(d, "x", 1:5, value=2),
  sum = SUM(d, "x", 1:5),
  m1 = MEAN(d, "x", 1:5),
  m2 = MEAN(d, vars=c("x1", "x4")),
  m3 = MEAN(d, varrange="x1:x2", rev="x2", range=1:5),
  cons1 = CONSEC(d, "x", 1:5),
  cons2 = CONSEC(d, varrange="x1:x5")
)]
d

## ====== Usage 2: `add()` &amp; `added()` ====== ##
data = as.data.table(psych::bfi)
added(data, {
  gender = as.factor(gender)
  education = as.factor(education)
  E = .mean("E", 1:5, rev=c(1,2), range=1:6)
  A = .mean("A", 1:5, rev=1, range=1:6)
  C = .mean("C", 1:5, rev=c(4,5), range=1:6)
  N = .mean("N", 1:5, range=1:6)
  O = .mean("O", 1:5, rev=c(2,5), range=1:6)
}, drop=TRUE)
data

## ====== New Feature for `var` &amp; `items` ====== ##
d = data.table(
  XX.1.pre = 1:5,
  XX.2.pre = 6:10,
  XX.3.pre = 11:15
)
add(d, { XX.mean = .mean("XX.{i}.pre", 1:3) })
add(d, { XX.mean = .mean("XX.{items}.pre", 1:3) })  # the same
add(d, { XX.mean = .mean("XX.{#$%^&amp;}.pre", 1:3) })  # the same

</code></pre>

<hr>
<h2 id='+25+5E+25'>Paste strings together.</h2><span id='topic++25+5E+25'></span>

<h3>Description</h3>

<p>Paste strings together. A wrapper of <code>paste0()</code>.
Why <code>%^%</code>? Because typing <code>%</code> and <code>^</code> is pretty easy by
pressing <strong>Shift + 5 + 6 + 5</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %^% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B5E+2B25_+3A_x">x</code>, <code id="+2B25+2B5E+2B25_+3A_y">y</code></td>
<td>
<p>Any objects, usually a numeric or character string or vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string/vector of the pasted values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>"He" %^% "llo"
"X" %^% 1:10
"Q" %^% 1:5 %^% letters[1:5]

</code></pre>

<hr>
<h2 id='+25allin+25'>A simple extension of <code>%in%</code>.</h2><span id='topic++25allin+25'></span>

<h3>Description</h3>

<p>A simple extension of <code>%in%</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %allin% vector
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25allin+2B25_+3A_x">x</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
<tr><td><code id="+2B25allin+2B25_+3A_vector">vector</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">%in%</a></code>,
<code><a href="#topic++25anyin+25">%anyin%</a></code>,
<code><a href="#topic++25nonein+25">%nonein%</a></code>,
<code><a href="#topic++25partin+25">%partin%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>1:2 %allin% 1:3  # TRUE
3:4 %allin% 1:3  # FALSE

</code></pre>

<hr>
<h2 id='+25anyin+25'>A simple extension of <code>%in%</code>.</h2><span id='topic++25anyin+25'></span>

<h3>Description</h3>

<p>A simple extension of <code>%in%</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %anyin% vector
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25anyin+2B25_+3A_x">x</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
<tr><td><code id="+2B25anyin+2B25_+3A_vector">vector</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">%in%</a></code>,
<code><a href="#topic++25allin+25">%allin%</a></code>,
<code><a href="#topic++25nonein+25">%nonein%</a></code>,
<code><a href="#topic++25partin+25">%partin%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>3:4 %anyin% 1:3  # TRUE
4:5 %anyin% 1:3  # FALSE

</code></pre>

<hr>
<h2 id='+25nonein+25'>A simple extension of <code>%in%</code>.</h2><span id='topic++25nonein+25'></span>

<h3>Description</h3>

<p>A simple extension of <code>%in%</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %nonein% vector
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25nonein+2B25_+3A_x">x</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
<tr><td><code id="+2B25nonein+2B25_+3A_vector">vector</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">%in%</a></code>,
<code><a href="#topic++25allin+25">%allin%</a></code>,
<code><a href="#topic++25anyin+25">%anyin%</a></code>,
<code><a href="#topic++25partin+25">%partin%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>3:4 %nonein% 1:3  # FALSE
4:5 %nonein% 1:3  # TRUE

</code></pre>

<hr>
<h2 id='+25notin+25'>The opposite of <code>%in%</code>.</h2><span id='topic++25notin+25'></span>

<h3>Description</h3>

<p>The opposite of <code>%in%</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %notin% vector
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25notin+2B25_+3A_x">x</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
<tr><td><code id="+2B25notin+2B25_+3A_vector">vector</code></td>
<td>
<p>Numeric or character vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">%in%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data = data.table(ID=1:10, X=sample(1:10, 10))
data
data[ID %notin% c(1, 3, 5, 7, 9)]

</code></pre>

<hr>
<h2 id='+25partin+25'>A simple extension of <code>%in%</code>.</h2><span id='topic++25partin+25'></span>

<h3>Description</h3>

<p>A simple extension of <code>%in%</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattern %partin% vector
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25partin+2B25_+3A_pattern">pattern</code></td>
<td>
<p>Character string containing <strong>regular expressions</strong> to be matched.</p>
</td></tr>
<tr><td><code id="+2B25partin+2B25_+3A_vector">vector</code></td>
<td>
<p>Character vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">%in%</a></code>,
<code><a href="#topic++25allin+25">%allin%</a></code>,
<code><a href="#topic++25anyin+25">%anyin%</a></code>,
<code><a href="#topic++25nonein+25">%nonein%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>"Bei" %partin% c("Beijing", "Shanghai")  # TRUE
"bei" %partin% c("Beijing", "Shanghai")  # FALSE
"[aeiou]ng" %partin% c("Beijing", "Shanghai")  # TRUE

</code></pre>

<hr>
<h2 id='add'>Create, modify, and delete variables.</h2><span id='topic+add'></span><span id='topic+added'></span>

<h3>Description</h3>

<p>Enhanced functions to create, modify, and/or delete variables.
The functions <strong>combine</strong> the advantages of
<code><a href="base.html#topic+within">within</a></code> (base),
<code><a href="dplyr.html#topic+mutate">mutate</a></code> (dplyr),
<code><a href="dplyr.html#topic+transmute">transmute</a></code> (dplyr), and
<code><a href="data.table.html#topic+data.table">:=</a></code> (data.table).
See examples below for the usage and convenience.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add(data, expr, when, by, drop = FALSE)

added(data, expr, when, by, drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_+3A_data">data</code></td>
<td>
<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code>
(preferred).</p>
</td></tr>
<tr><td><code id="add_+3A_expr">expr</code></td>
<td>
<p>R expression(s) enclosed in <code>{...}</code> to compute variables.
</p>
<p>Passing to <code><a href="data.table.html#topic+data.table">data.table</a></code>:
<code>DT[ , `:=`(expr), ]</code>
</p>
<p>Execute each line of expression in <code>{...}</code> <em>one by one</em>,
such that newly created variables are available immediately.
This is an advantage of <code><a href="dplyr.html#topic+mutate">mutate</a></code> and
has been implemented here for <code><a href="data.table.html#topic+data.table">data.table</a></code>.</p>
</td></tr>
<tr><td><code id="add_+3A_when">when</code></td>
<td>
<p>[Optional] Compute for which rows or rows meeting what condition(s)?
</p>
<p>Passing to <code><a href="data.table.html#topic+data.table">data.table</a></code>:
<code>DT[when, , ]</code></p>
</td></tr>
<tr><td><code id="add_+3A_by">by</code></td>
<td>
<p>[Optional] Compute by what group(s)?
</p>
<p>Passing to <code><a href="data.table.html#topic+data.table">data.table</a></code>:
<code>DT[ , , by]</code></p>
</td></tr>
<tr><td><code id="add_+3A_drop">drop</code></td>
<td>
<p>Drop existing variables and return only new variables?
Defaults to <code>FALSE</code>, which returns all variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>add()</code> returns a new
<code><a href="data.table.html#topic+data.table">data.table</a></code>,
with the raw data unchanged.
</p>
<p><code>added()</code> returns nothing and has already changed the raw data.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>add()</code>: Return the <em>new data</em>.
</p>
<p>You need to assign the new data to an object:
</p>
<pre>data = add(data, {...})</pre>
</li>
<li> <p><code>added()</code>: Return nothing and <em>change the raw data immediately</em>.
</p>
<p>NO need to assign the new data:
</p>
<pre>added(data, {...})</pre>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>## ====== Usage 1: add() ====== ##

d = as.data.table(within.1)
d$XYZ = 1:8
d

# add() does not change the raw data:
add(d, {B = 1; C = 2})
d

# new data should be assigned to an object:
d = d %&gt;% add({
  ID = str_extract(ID, "\\d")  # modify a variable
  XYZ = NULL                   # delete a variable
  A = .mean("A", 1:4)          # create a new variable
  B = A * 4    # new variable is immediately available
  C = 1        # never need ,/; at the end of any line
})
d


## ====== Usage 2: added() ====== ##

d = as.data.table(within.1)
d$XYZ = 1:8
d

# added() has already changed the raw data:
added(d, {B = 1; C = 2})
d

# raw data has already become the new data:
added(d, {
  ID = str_extract(ID, "\\d")
  XYZ = NULL
  A = .mean("A", 1:4)
  B = A * 4
  C = 1
})
d


## ====== Using `when` and `by` ====== ##

d = as.data.table(between.2)
d

added(d, {SCORE2 = SCORE - mean(SCORE)},
      A == 1 &amp; B %in% 1:2,  # `when`: for what conditions
      by=B)                 # `by`: by what groups
d
na.omit(d)


## ====== Return Only New Variables ====== ##

newvars = add(within.1, {
  ID = str_extract(ID, "\\d")
  A = .mean("A", 1:4)
}, drop=TRUE)
newvars


## ====== Better Than `base::within()` ====== ##

d = as.data.table(within.1)

# wrong order: C B A
within(d, {
  A = 4
  B = A + 1
  C = 6
})

# correct order: A B C
add(d, {
  A = 4
  B = A + 1
  C = 6
})

</code></pre>

<hr>
<h2 id='Alpha'>Reliability analysis (Cronbach's <code class="reqn">\alpha</code> and McDonald's <code class="reqn">\omega</code>).</h2><span id='topic+Alpha'></span>

<h3>Description</h3>

<p>An extension of <code><a href="psych.html#topic+alpha">psych::alpha()</a></code> and <code><a href="psych.html#topic+omega">psych::omega()</a></code>,
reporting (1) scale statistics
(Cronbach's <code class="reqn">\alpha</code> and McDonald's <code class="reqn">\omega</code>) and
(2) item statistics
(item-rest correlation [i.e., corrected item-total correlation]
and Cronbach's <code class="reqn">\alpha</code> if item deleted).
</p>
<p>Three options to specify variables:
</p>

<ol>
<li> <p><strong><code>var + items</code></strong>: common and unique parts of variable names (suggested).
</p>
</li>
<li> <p><strong><code>vars</code></strong>: a character vector of variable names (suggested).
</p>
</li>
<li> <p><strong><code>varrange</code></strong>: starting and stopping positions of variables (NOT suggested).
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>Alpha(data, var, items, vars = NULL, varrange = NULL, rev = NULL, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Alpha_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="Alpha_+3A_var">var</code></td>
<td>
<p><strong>[Option 1]</strong>
Common part across variables: e.g., <code>"RSES"</code>, <code>"XX.{i}.pre"</code>
(if <code>var</code> string has any placeholder in braces <code>{...}</code>,
then <code>items</code> will be pasted into the braces, see examples)</p>
</td></tr>
<tr><td><code id="Alpha_+3A_items">items</code></td>
<td>
<p><strong>[Option 1]</strong>
Unique part across variables: e.g., <code>1:10</code>, <code>c("a", "b", "c")</code></p>
</td></tr>
<tr><td><code id="Alpha_+3A_vars">vars</code></td>
<td>
<p><strong>[Option 2]</strong>
Character vector specifying variables: e.g., <code>c("X1", "X2", "X3", "X4", "X5")</code></p>
</td></tr>
<tr><td><code id="Alpha_+3A_varrange">varrange</code></td>
<td>
<p><strong>[Option 3]</strong>
Character string specifying positions (&quot;start:stop&quot;) of variables: e.g., <code>"A1:E5"</code></p>
</td></tr>
<tr><td><code id="Alpha_+3A_rev">rev</code></td>
<td>
<p>[Optional] Variables that need to be reversed. It can be
(1) a character vector specifying the reverse-scoring variables (recommended), or
(2) a numeric vector specifying the item number of reverse-scoring variables (not recommended).</p>
</td></tr>
<tr><td><code id="Alpha_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results obtained from
<code><a href="psych.html#topic+alpha">psych::alpha()</a></code> and <code><a href="psych.html#topic+omega">psych::omega()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEAN">MEAN</a></code>, <code><a href="#topic+EFA">EFA</a></code>, <code><a href="#topic+CFA">CFA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ?psych::bfi
data = psych::bfi
Alpha(data, "E", 1:5)   # "E1" &amp; "E2" should be reversed
Alpha(data, "E", 1:5, rev=1:2)            # correct
Alpha(data, "E", 1:5, rev=cc("E1, E2"))   # also correct
Alpha(data, vars=cc("E1, E2, E3, E4, E5"), rev=cc("E1, E2"))
Alpha(data, varrange="E1:E5", rev=cc("E1, E2"))

# using dplyr::select()
data %&gt;% select(E1, E2, E3, E4, E5) %&gt;%
  Alpha(vars=names(.), rev=cc("E1, E2"))

</code></pre>

<hr>
<h2 id='bruceR-demodata'>Demo data.</h2><span id='topic+bruceR-demodata'></span><span id='topic+between.1'></span><span id='topic+between.2'></span><span id='topic+between.3'></span><span id='topic+mixed.2_1b1w'></span><span id='topic+mixed.3_1b2w'></span><span id='topic+mixed.3_2b1w'></span><span id='topic+within.1'></span><span id='topic+within.2'></span><span id='topic+within.3'></span>

<h3>Description</h3>

<p>Demo datasets of multi-factor ANOVA as examples to show how the functions
<code><a href="#topic+MANOVA">MANOVA</a></code> and <code><a href="#topic+EMMEANS">EMMEANS</a></code> work.
</p>


<h3>Format</h3>


<dl>
<dt><strong>1. Between-Subjects Design</strong></dt><dd>

<ul>
<li> <p><code>between.1</code> - A(4)
</p>
</li>
<li> <p><code>between.2</code> - A(2) * B(3)
</p>
</li>
<li> <p><code>between.3</code> - A(2) * B(2) * C(2)
</p>
</li></ul>

</dd>
<dt><strong>2. Within-Subjects Design</strong></dt><dd>

<ul>
<li> <p><code>within.1</code> - A(4)
</p>
</li>
<li> <p><code>within.2</code> - A(2) * B(3)
</p>
</li>
<li> <p><code>within.3</code> - A(2) * B(2) * C(2)
</p>
</li></ul>

</dd>
<dt><strong>3. Mixed Design</strong></dt><dd>

<ul>
<li> <p><code>mixed.2_1b1w</code> - A(2, between) * B(3, within)
</p>
</li>
<li> <p><code>mixed.3_1b2w</code> - A(2, between) * B(2, within) * C(2, within)
</p>
</li>
<li> <p><code>mixed.3_2b1w</code> - A(2, between) * B(2, within) * C(2, between)
</p>
</li></ul>

</dd>
</dl>



<h3>Source</h3>

<p><a href="https://book.douban.com/subject/1195181/">Multi-Factor Experimental Design in Psychology and Education</a>
</p>

<hr>
<h2 id='bruceR-package'>bruceR: <strong>BR</strong>oadly <strong>U</strong>seful <strong>C</strong>onvenient and <strong>E</strong>fficient <strong>R</strong> functions</h2><span id='topic+bruceR'></span><span id='topic+bruceR-package'></span>

<h3>Description</h3>

<p><strong>BR</strong>oadly
<strong>U</strong>seful
<strong>C</strong>onvenient
and
<strong>E</strong>fficient
<strong>R</strong>
functions that
<strong>BR</strong>ing
<strong>U</strong>sers
<strong>C</strong>oncise
and
<strong>E</strong>legant
<strong>R</strong>
data analyses.
</p>
<p>Package homepage: <a href="https://psychbruce.github.io/bruceR/">https://psychbruce.github.io/bruceR/</a>
</p>
<p>Install the latest <a href="https://github.com/psychbruce/bruceR">development version</a>
from GitHub:
<code>devtools::install_github("psychbruce/bruceR")</code>
</p>
<p>Report bugs at <a href="https://github.com/psychbruce/bruceR/issues">GitHub Issues</a>.
</p>


<h3>Main Functions in <code>bruceR</code></h3>


<dl>
<dt><strong>(1) Basic R Programming</strong></dt><dd>
<p><code><a href="#topic+set.wd">set.wd</a></code> (alias: <code><a href="#topic+set_wd">set_wd</a></code>)
</p>
<p><code><a href="#topic+import">import</a></code>,
<code><a href="#topic+export">export</a></code>
</p>
<p><code><a href="#topic+cc">cc</a></code>
</p>
<p><code><a href="#topic+pkg_depend">pkg_depend</a></code>,
<code><a href="#topic+pkg_install_suggested">pkg_install_suggested</a></code>
</p>
<p><code><a href="#topic+formatF">formatF</a></code>,
<code><a href="#topic+formatN">formatN</a></code>
</p>
<p><code><a href="#topic+print_table">print_table</a></code>
</p>
<p><code><a href="#topic+Print">Print</a></code>,
<code><a href="#topic+Glue">Glue</a></code>,
<code><a href="#topic+Run">Run</a></code>
</p>
<p><code><a href="#topic++25+5E+25">%^%</a></code>
</p>
<p><code><a href="#topic++25notin+25">%notin%</a></code>
</p>
<p><code><a href="#topic++25allin+25">%allin%</a></code>,
<code><a href="#topic++25anyin+25">%anyin%</a></code>,
<code><a href="#topic++25nonein+25">%nonein%</a></code>,
<code><a href="#topic++25partin+25">%partin%</a></code>
</p>
</dd>
<dt><strong>(2) Multivariate Computation</strong></dt><dd>
<p><code><a href="#topic+add">add</a></code>,
<code><a href="#topic+added">added</a></code>
</p>
<p><code><a href="#topic+.sum">.sum</a></code>,
<code><a href="#topic+.mean">.mean</a></code>
</p>
<p><code><a href="#topic+SUM">SUM</a></code>,
<code><a href="#topic+MEAN">MEAN</a></code>,
<code><a href="#topic+STD">STD</a></code>,
<code><a href="#topic+MODE">MODE</a></code>,
<code><a href="#topic+COUNT">COUNT</a></code>,
<code><a href="#topic+CONSEC">CONSEC</a></code>
</p>
<p><code><a href="#topic+RECODE">RECODE</a></code>,
<code><a href="#topic+RESCALE">RESCALE</a></code>
</p>
<p><code><a href="#topic+LOOKUP">LOOKUP</a></code>
</p>
</dd>
<dt><strong>(3) Reliability and Factor Analyses</strong></dt><dd>
<p><code><a href="#topic+Alpha">Alpha</a></code>
</p>
<p><code><a href="#topic+EFA">EFA</a></code> / <code><a href="#topic+PCA">PCA</a></code>
</p>
<p><code><a href="#topic+CFA">CFA</a></code>
</p>
</dd>
<dt><strong>(4) Descriptive Statistics and Correlation Analyses</strong></dt><dd>
<p><code><a href="#topic+Describe">Describe</a></code>
</p>
<p><code><a href="#topic+Freq">Freq</a></code>
</p>
<p><code><a href="#topic+Corr">Corr</a></code>
</p>
<p><code><a href="#topic+cor_diff">cor_diff</a></code>
</p>
<p><code><a href="#topic+cor_multilevel">cor_multilevel</a></code>
</p>
</dd>
<dt><strong>(5) T-Test, Multi-Factor ANOVA, Simple-Effect Analysis, and Post-Hoc Multiple Comparison</strong></dt><dd>
<p><code><a href="#topic+TTEST">TTEST</a></code>
</p>
<p><code><a href="#topic+MANOVA">MANOVA</a></code>
</p>
<p><code><a href="#topic+EMMEANS">EMMEANS</a></code>
</p>
</dd>
<dt><strong>(6) Tidy Report of Regression Models</strong></dt><dd>
<p><code><a href="#topic+model_summary">model_summary</a></code>
</p>
<p><code><a href="#topic+lavaan_summary">lavaan_summary</a></code>
</p>
<p><code><a href="#topic+GLM_summary">GLM_summary</a></code>
</p>
<p><code><a href="#topic+HLM_summary">HLM_summary</a></code>
</p>
<p><code><a href="#topic+HLM_ICC_rWG">HLM_ICC_rWG</a></code>
</p>
<p><code><a href="#topic+regress">regress</a></code>
</p>
</dd>
<dt><strong>(7) Mediation and Moderation Analyses</strong></dt><dd>
<p><code><a href="#topic+PROCESS">PROCESS</a></code>
</p>
<p><code><a href="#topic+med_summary">med_summary</a></code>
</p>
</dd>
<dt><strong>(8) Additional Toolbox for Statistics and Graphics</strong></dt><dd>
<p><code><a href="#topic+grand_mean_center">grand_mean_center</a></code>
</p>
<p><code><a href="#topic+group_mean_center">group_mean_center</a></code>
</p>
<p><code><a href="#topic+ccf_plot">ccf_plot</a></code>
</p>
<p><code><a href="#topic+granger_test">granger_test</a></code>
</p>
<p><code><a href="#topic+granger_causality">granger_causality</a></code>
</p>
<p><code><a href="#topic+theme_bruce">theme_bruce</a></code>
</p>
<p><code><a href="#topic+show_colors">show_colors</a></code>
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Han-Wu-Shuang Bao <a href="mailto:baohws@foxmail.com">baohws@foxmail.com</a> (<a href="https://orcid.org/0000-0003-3043-710X">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://psychbruce.github.io/bruceR/">https://psychbruce.github.io/bruceR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/psychbruce/bruceR/issues">https://github.com/psychbruce/bruceR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='cc'>Split up a string (with separators) into a character vector.</h2><span id='topic+cc'></span>

<h3>Description</h3>

<p>Split up a string (with separators) into a character vector
(whitespace around separator is trimmed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cc(..., sep = "auto", trim = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cc_+3A_...">...</code></td>
<td>
<p>Character string(s).</p>
</td></tr>
<tr><td><code id="cc_+3A_sep">sep</code></td>
<td>
<p>Pattern for separation.
Defaults to <code>"auto"</code>:
<code>,</code> <code>;</code> <code>|</code> <code>\n</code> <code>\t</code></p>
</td></tr>
<tr><td><code id="cc_+3A_trim">trim</code></td>
<td>
<p>Remove whitespace from start and end of string(s)?
Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cc("a,b,c,d,e")

cc(" a , b , c , d , e ")

cc(" a , b , c , d , e ", trim=FALSE)

cc("1, 2, 3, 4, 5")

cc("A 1 , B 2 ; C 3 | D 4 \t E 5")

cc("A, B, C",
   " D | E ",
   c("F", "G"))

cc("
American
British
Chinese
")

</code></pre>

<hr>
<h2 id='ccf_plot'>Cross-correlation analysis.</h2><span id='topic+ccf_plot'></span>

<h3>Description</h3>

<p>Plot the results of cross-correlation analysis using <code>ggplot2</code>
(rather than R base plot) for more flexible modification of the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccf_plot(
  formula,
  data,
  lag.max = 30,
  sig.level = 0.05,
  xbreaks = seq(-100, 100, 10),
  ybreaks = seq(-1, 1, 0.2),
  ylim = NULL,
  alpha.ns = 1,
  pos.color = "black",
  neg.color = "black",
  ci.color = "blue",
  title = NULL,
  subtitle = NULL,
  xlab = "Lag",
  ylab = "Cross-Correlation"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ccf_plot_+3A_formula">formula</code></td>
<td>
<p>Model formula like <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_lag.max">lag.max</code></td>
<td>
<p>Maximum time lag. Defaults to <code>30</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level. Defaults to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_xbreaks">xbreaks</code></td>
<td>
<p>X-axis breaks.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_ybreaks">ybreaks</code></td>
<td>
<p>Y-axis breaks.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_ylim">ylim</code></td>
<td>
<p>Y-axis limits. Defaults to <code>NULL</code> to automatically estimate.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_alpha.ns">alpha.ns</code></td>
<td>
<p>Color transparency (opacity: 0~1) for non-significant values.
Defaults to <code>1</code> for no transparency (i.e., opaque color).</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_pos.color">pos.color</code></td>
<td>
<p>Color for positive values. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_neg.color">neg.color</code></td>
<td>
<p>Color for negative values. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_ci.color">ci.color</code></td>
<td>
<p>Color for upper and lower bounds of significant values.
Defaults to <code>"blue"</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_title">title</code></td>
<td>
<p>Plot title. Defaults to an illustration of the formula.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_subtitle">subtitle</code></td>
<td>
<p>Plot subtitle.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_xlab">xlab</code></td>
<td>
<p>X-axis title. Defaults to <code>"Lag"</code>.</p>
</td></tr>
<tr><td><code id="ccf_plot_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis title. Defaults to <code>"Cross-Correlation"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Significant correlations with <em>negative time lags</em> suggest
shifts in a predictor <em>precede</em> shifts in an outcome.
</p>


<h3>Value</h3>

<p>A <code>gg</code> object, which you can further modify using
<code>ggplot2</code> syntax and save using <code>ggsave()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granger_test">granger_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># resemble the default plot output by `ccf()`
p1 = ccf_plot(chicken ~ egg, data=lmtest::ChickEgg)
p1

# a more colorful plot
p2 = ccf_plot(chicken ~ egg, data=lmtest::ChickEgg, alpha.ns=0.3,
              pos.color="#CD201F",
              neg.color="#21759B",
              ci.color="black")
p2

</code></pre>

<hr>
<h2 id='CFA'>Confirmatory Factor Analysis (CFA).</h2><span id='topic+CFA'></span>

<h3>Description</h3>

<p>An extension of <code><a href="lavaan.html#topic+cfa">lavaan::cfa()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFA(
  data,
  model = "A =~ a[1:5]; B =~ b[c(1,3,5)]; C =~ c1 + c2 + c3",
  estimator = "ML",
  highorder = "",
  orthogonal = FALSE,
  missing = "listwise",
  digits = 3,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFA_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="CFA_+3A_model">model</code></td>
<td>
<p>Model formula. See examples.</p>
</td></tr>
<tr><td><code id="CFA_+3A_estimator">estimator</code></td>
<td>
<p>The estimator to be used
(for details, see <a href="lavaan.html#topic+lavOptions">lavaan options</a>).
Defaults to <code>"ML"</code>.
Can be one of the following:
</p>

<dl>
<dt><code>"ML"</code></dt><dd><p>Maximum Likelihood (can be extended to
<code>"MLM"</code>, <code>"MLMV"</code>, <code>"MLMVS"</code>, <code>"MLF"</code>, or <code>"MLR"</code>
for robust standard errors and robust test statistics)</p>
</dd>
<dt><code>"GLS"</code></dt><dd><p>Generalized Least Squares</p>
</dd>
<dt><code>"WLS"</code></dt><dd><p>Weighted Least Squares</p>
</dd>
<dt><code>"ULS"</code></dt><dd><p>Unweighted Least Squares</p>
</dd>
<dt><code>"DWLS"</code></dt><dd><p>Diagonally Weighted Least Squares</p>
</dd>
<dt><code>"DLS"</code></dt><dd><p>Distributionally-weighted Least Squares</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="CFA_+3A_highorder">highorder</code></td>
<td>
<p>High-order factor. Defaults to <code>""</code>.</p>
</td></tr>
<tr><td><code id="CFA_+3A_orthogonal">orthogonal</code></td>
<td>
<p>Defaults to <code>FALSE</code>. If <code>TRUE</code>, all covariances among latent variables are set to zero.</p>
</td></tr>
<tr><td><code id="CFA_+3A_missing">missing</code></td>
<td>
<p>Defaults to <code>"listwise"</code>. Alternative is <code>"fiml"</code> (&quot;Full Information Maximum Likelihood&quot;).</p>
</td></tr>
<tr><td><code id="CFA_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="CFA_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results returned by <code><a href="lavaan.html#topic+cfa">lavaan::cfa()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Alpha">Alpha</a></code>, <code><a href="#topic+EFA">EFA</a></code>, <code><a href="#topic+lavaan_summary">lavaan_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.cfa=lavaan::HolzingerSwineford1939
CFA(data.cfa, "Visual =~ x[1:3]; Textual =~ x[c(4,5,6)]; Speed =~ x7 + x8 + x9")
CFA(data.cfa, model="
    Visual =~ x[1:3]
    Textual =~ x[c(4,5,6)]
    Speed =~ x7 + x8 + x9
    ", highorder="Ability")

data.bfi = na.omit(psych::bfi)
CFA(data.bfi, "E =~ E[1:5]; A =~ A[1:5]; C =~ C[1:5]; N =~ N[1:5]; O =~ O[1:5]")

</code></pre>

<hr>
<h2 id='cor_diff'>Test the difference between two correlations.</h2><span id='topic+cor_diff'></span>

<h3>Description</h3>

<p>Test the difference between two correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_diff(r1, n1, r2, n2, n = NULL, rcov = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_diff_+3A_r1">r1</code>, <code id="cor_diff_+3A_r2">r2</code></td>
<td>
<p>Correlation coefficients (Pearson's <em>r</em>).</p>
</td></tr>
<tr><td><code id="cor_diff_+3A_n">n</code>, <code id="cor_diff_+3A_n1">n1</code>, <code id="cor_diff_+3A_n2">n2</code></td>
<td>
<p>Sample sizes.</p>
</td></tr>
<tr><td><code id="cor_diff_+3A_rcov">rcov</code></td>
<td>
<p>[Optional] Only for nonindependent <em>r</em>s:
</p>
<p><code>r1</code> is r(X,Y),
</p>
<p><code>r2</code> is r(X,Z),
</p>
<p>then, as Y and Z are also correlated,
</p>
<p>we should also consider <code>rcov</code>: r(Y,Z)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return the <em>p</em> value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># two independent rs (X~Y vs. Z~W)
cor_diff(r1=0.20, n1=100, r2=0.45, n2=100)

# two nonindependent rs (X~Y vs. X~Z, with Y and Z also correlated [rcov])
cor_diff(r1=0.20, r2=0.45, n=100, rcov=0.80)

</code></pre>

<hr>
<h2 id='cor_multilevel'>Multilevel correlations (within-level and between-level).</h2><span id='topic+cor_multilevel'></span>

<h3>Description</h3>

<p>Multilevel correlations (within-level and between-level).
For details, see description in <code><a href="#topic+HLM_ICC_rWG">HLM_ICC_rWG</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_multilevel(data, group, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_multilevel_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="cor_multilevel_+3A_group">group</code></td>
<td>
<p>Grouping variable.</p>
</td></tr>
<tr><td><code id="cor_multilevel_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a list of results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Corr">Corr</a></code>
</p>
<p><code><a href="#topic+HLM_ICC_rWG">HLM_ICC_rWG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see https://psychbruce.github.io/supp/CEM

</code></pre>

<hr>
<h2 id='Corr'>Correlation analysis.</h2><span id='topic+Corr'></span>

<h3>Description</h3>

<p>Correlation analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Corr(
  data,
  method = "pearson",
  p.adjust = "none",
  all.as.numeric = TRUE,
  digits = 2,
  file = NULL,
  plot = TRUE,
  plot.r.size = 4,
  plot.colors = NULL,
  plot.file = NULL,
  plot.width = 8,
  plot.height = 6,
  plot.dpi = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Corr_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="Corr_+3A_method">method</code></td>
<td>
<p><code>"pearson"</code> (default), <code>"spearman"</code>, or <code>"kendall"</code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_p.adjust">p.adjust</code></td>
<td>
<p>Adjustment of <em>p</em> values for multiple tests:
<code>"none"</code>, <code>"fdr"</code>, <code>"holm"</code>, <code>"bonferroni"</code>, ...
For details, see <code><a href="stats.html#topic+p.adjust">stats::p.adjust()</a></code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_all.as.numeric">all.as.numeric</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>.
Transform all variables into numeric (continuous).</p>
</td></tr>
<tr><td><code id="Corr_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot">plot</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>. Plot the correlation matrix.</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.r.size">plot.r.size</code></td>
<td>
<p>Font size of correlation text label. Defaults to <code>4</code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.colors">plot.colors</code></td>
<td>
<p>Plot colors (character vector). Defaults to &quot;RdBu&quot; of the Color Brewer Palette.</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.file">plot.file</code></td>
<td>
<p><code>NULL</code> (default, plot in RStudio) or a file name (<code>"xxx.png"</code>).</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.width">plot.width</code></td>
<td>
<p>Width (in &quot;inch&quot;) of the saved plot. Defaults to <code>8</code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.height">plot.height</code></td>
<td>
<p>Height (in &quot;inch&quot;) of the saved plot. Defaults to <code>6</code>.</p>
</td></tr>
<tr><td><code id="Corr_+3A_plot.dpi">plot.dpi</code></td>
<td>
<p>DPI (dots per inch) of the saved plot. Defaults to <code>500</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a list with
(1) correlation results from
<code><a href="psych.html#topic+corr.test">psych::corr.test()</a></code> and
(2) a <code>ggplot2</code> object if <code>plot=TRUE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Describe">Describe</a></code>
</p>
<p><code><a href="#topic+cor_multilevel">cor_multilevel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Corr(airquality)
Corr(airquality, p.adjust="bonferroni",
     plot.colors=c("#b2182b", "white", "#2166ac"))

d = as.data.table(psych::bfi)
added(d, {
  gender = as.factor(gender)
  education = as.factor(education)
  E = .mean("E", 1:5, rev=c(1,2), range=1:6)
  A = .mean("A", 1:5, rev=1, range=1:6)
  C = .mean("C", 1:5, rev=c(4,5), range=1:6)
  N = .mean("N", 1:5, range=1:6)
  O = .mean("O", 1:5, rev=c(2,5), range=1:6)
})
Corr(d[, .(age, gender, education, E, A, C, N, O)])

</code></pre>

<hr>
<h2 id='Describe'>Descriptive statistics.</h2><span id='topic+Describe'></span>

<h3>Description</h3>

<p>Descriptive statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Describe(
  data,
  all.as.numeric = TRUE,
  digits = 2,
  file = NULL,
  plot = FALSE,
  upper.triangle = FALSE,
  upper.smooth = "none",
  plot.file = NULL,
  plot.width = 8,
  plot.height = 6,
  plot.dpi = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Describe_+3A_data">data</code></td>
<td>
<p>Data frame or numeric vector.</p>
</td></tr>
<tr><td><code id="Describe_+3A_all.as.numeric">all.as.numeric</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>.
Transform all variables into numeric (continuous).</p>
</td></tr>
<tr><td><code id="Describe_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="Describe_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="Describe_+3A_plot">plot</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default).
Visualize the descriptive statistics using <code><a href="GGally.html#topic+ggpairs">GGally::ggpairs()</a></code>.</p>
</td></tr>
<tr><td><code id="Describe_+3A_upper.triangle">upper.triangle</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default).
Add (scatter) plots to upper triangle (time consuming when sample size is large).</p>
</td></tr>
<tr><td><code id="Describe_+3A_upper.smooth">upper.smooth</code></td>
<td>
<p><code>"none"</code> (default), <code>"lm"</code>, or <code>"loess"</code>.
Add fitting lines to scatter plots (if any).</p>
</td></tr>
<tr><td><code id="Describe_+3A_plot.file">plot.file</code></td>
<td>
<p><code>NULL</code> (default, plot in RStudio) or a file name (<code>"xxx.png"</code>).</p>
</td></tr>
<tr><td><code id="Describe_+3A_plot.width">plot.width</code></td>
<td>
<p>Width (in &quot;inch&quot;) of the saved plot. Defaults to <code>8</code>.</p>
</td></tr>
<tr><td><code id="Describe_+3A_plot.height">plot.height</code></td>
<td>
<p>Height (in &quot;inch&quot;) of the saved plot. Defaults to <code>6</code>.</p>
</td></tr>
<tr><td><code id="Describe_+3A_plot.dpi">plot.dpi</code></td>
<td>
<p>DPI (dots per inch) of the saved plot. Defaults to <code>500</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a list with
(1) a data frame of descriptive statistics and
(2) a <code>ggplot2</code> object if <code>plot=TRUE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Corr">Corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
Describe(rnorm(1000000), plot=TRUE)

Describe(airquality)
Describe(airquality, plot=TRUE, upper.triangle=TRUE, upper.smooth="lm")

# ?psych::bfi
Describe(psych::bfi[c("age", "gender", "education")])

d = as.data.table(psych::bfi)
added(d, {
  gender = as.factor(gender)
  education = as.factor(education)
  E = .mean("E", 1:5, rev=c(1,2), range=1:6)
  A = .mean("A", 1:5, rev=1, range=1:6)
  C = .mean("C", 1:5, rev=c(4,5), range=1:6)
  N = .mean("N", 1:5, range=1:6)
  O = .mean("O", 1:5, rev=c(2,5), range=1:6)
})
Describe(d[, .(age, gender, education)], plot=TRUE, all.as.numeric=FALSE)
Describe(d[, .(age, gender, education, E, A, C, N, O)], plot=TRUE)

</code></pre>

<hr>
<h2 id='dtime'>Timer (compute time difference).</h2><span id='topic+dtime'></span>

<h3>Description</h3>

<p>Timer (compute time difference).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtime(t0, unit = "secs", digits = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtime_+3A_t0">t0</code></td>
<td>
<p>Time at the beginning.</p>
</td></tr>
<tr><td><code id="dtime_+3A_unit">unit</code></td>
<td>
<p>Options: <code>"auto", "secs", "mins", "hours", "days", "weeks"</code>. Defaults to <code>"secs"</code>.</p>
</td></tr>
<tr><td><code id="dtime_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string of time difference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

t0 = Sys.time()
dtime(t0)

## End(Not run)

</code></pre>

<hr>
<h2 id='EFA'>Principal Component Analysis (PCA) and Exploratory Factor analysis (EFA).</h2><span id='topic+EFA'></span><span id='topic+PCA'></span>

<h3>Description</h3>

<p>An extension of <code><a href="psych.html#topic+principal">psych::principal()</a></code> and <code><a href="psych.html#topic+fa">psych::fa()</a></code>,
performing either Principal Component Analysis (PCA) or Exploratory Factor Analysis (EFA).
</p>
<p>Three options to specify variables:
</p>

<ol>
<li> <p><strong><code>var + items</code></strong>: use the common and unique parts of variable names.
</p>
</li>
<li> <p><strong><code>vars</code></strong>: directly define a character vector of variables.
</p>
</li>
<li> <p><strong><code>varrange</code></strong>: use the starting and stopping positions of variables.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>EFA(
  data,
  var,
  items,
  vars = NULL,
  varrange = NULL,
  rev = NULL,
  method = c("pca", "pa", "ml", "minres", "uls", "ols", "wls", "gls", "alpha"),
  rotation = c("none", "varimax", "oblimin", "promax", "quartimax", "equamax"),
  nfactors = c("eigen", "parallel", "(any number &gt;= 1)"),
  sort.loadings = TRUE,
  hide.loadings = 0,
  plot.scree = TRUE,
  kaiser = TRUE,
  max.iter = 25,
  min.eigen = 1,
  digits = 3,
  file = NULL
)

PCA(..., method = "pca")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EFA_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="EFA_+3A_var">var</code></td>
<td>
<p><strong>[Option 1]</strong>
Common part across variables: e.g., <code>"RSES"</code>, <code>"XX.{i}.pre"</code>
(if <code>var</code> string has any placeholder in braces <code>{...}</code>,
then <code>items</code> will be pasted into the braces, see examples)</p>
</td></tr>
<tr><td><code id="EFA_+3A_items">items</code></td>
<td>
<p><strong>[Option 1]</strong>
Unique part across variables: e.g., <code>1:10</code>, <code>c("a", "b", "c")</code></p>
</td></tr>
<tr><td><code id="EFA_+3A_vars">vars</code></td>
<td>
<p><strong>[Option 2]</strong>
Character vector specifying variables: e.g., <code>c("X1", "X2", "X3", "X4", "X5")</code></p>
</td></tr>
<tr><td><code id="EFA_+3A_varrange">varrange</code></td>
<td>
<p><strong>[Option 3]</strong>
Character string specifying positions (&quot;start:stop&quot;) of variables: e.g., <code>"A1:E5"</code></p>
</td></tr>
<tr><td><code id="EFA_+3A_rev">rev</code></td>
<td>
<p>[Optional] Variables that need to be reversed. It can be
(1) a character vector specifying the reverse-scoring variables (recommended), or
(2) a numeric vector specifying the item number of reverse-scoring variables (not recommended).</p>
</td></tr>
<tr><td><code id="EFA_+3A_method">method</code></td>
<td>
<p>Extraction method.
</p>

<ul>
<li> <p><code>"pca"</code> - Principal Component Analysis (default)
</p>
</li>
<li> <p><code>"pa"</code> - Principal Axis Factor Analysis
</p>
</li>
<li> <p><code>"ml"</code> - Maximum Likelihood Factor Analysis
</p>
</li>
<li> <p><code>"minres"</code> - Minimum Residual Factor Analysis
</p>
</li>
<li> <p><code>"uls"</code> - Unweighted Least Squares Factor Analysis
</p>
</li>
<li> <p><code>"ols"</code> - Ordinary Least Squares Factor Analysis
</p>
</li>
<li> <p><code>"wls"</code> - Weighted Least Squares Factor Analysis
</p>
</li>
<li> <p><code>"gls"</code> - Generalized Least Squares Factor Analysis
</p>
</li>
<li> <p><code>"alpha"</code> - Alpha Factor Analysis (Kaiser &amp; Coffey, 1965)
</p>
</li></ul>
</td></tr>
<tr><td><code id="EFA_+3A_rotation">rotation</code></td>
<td>
<p>Rotation method.
</p>

<ul>
<li> <p><code>"none"</code> - None (not suggested)
</p>
</li>
<li> <p><code>"varimax"</code> - Varimax (default)
</p>
</li>
<li> <p><code>"oblimin"</code> - Direct Oblimin
</p>
</li>
<li> <p><code>"promax"</code> - Promax
</p>
</li>
<li> <p><code>"quartimax"</code> - Quartimax
</p>
</li>
<li> <p><code>"equamax"</code> - Equamax
</p>
</li></ul>
</td></tr>
<tr><td><code id="EFA_+3A_nfactors">nfactors</code></td>
<td>
<p>How to determine the number of factors/components?
</p>

<ul>
<li> <p><code>"eigen"</code> - based on eigenvalue (&gt; minimum eigenvalue) (default)
</p>
</li>
<li> <p><code>"parallel"</code> - based on parallel analysis
</p>
</li>
<li><p> (any number &gt;= 1) - user-defined fixed number
</p>
</li></ul>
</td></tr>
<tr><td><code id="EFA_+3A_sort.loadings">sort.loadings</code></td>
<td>
<p>Sort factor/component loadings by size? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="EFA_+3A_hide.loadings">hide.loadings</code></td>
<td>
<p>A number (0~1) for hiding absolute factor/component loadings below this value.
Defaults to <code>0</code> (does not hide any loading).</p>
</td></tr>
<tr><td><code id="EFA_+3A_plot.scree">plot.scree</code></td>
<td>
<p>Display the scree plot? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="EFA_+3A_kaiser">kaiser</code></td>
<td>
<p>Do the Kaiser normalization (as in SPSS)? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="EFA_+3A_max.iter">max.iter</code></td>
<td>
<p>Maximum number of iterations for convergence. Defaults to <code>25</code> (the same as in SPSS).</p>
</td></tr>
<tr><td><code id="EFA_+3A_min.eigen">min.eigen</code></td>
<td>
<p>Minimum eigenvalue (used if <code>nfactors="eigen"</code>). Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="EFA_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="EFA_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="EFA_+3A_...">...</code></td>
<td>
<p>Arguments passed from <code>PCA()</code> to <code>EFA()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results:
</p>

<dl>
<dt><code>result</code></dt><dd><p>The R object returned from <code><a href="psych.html#topic+principal">psych::principal()</a></code> or <code><a href="psych.html#topic+fa">psych::fa()</a></code></p>
</dd>
<dt><code>result.kaiser</code></dt><dd><p>The R object returned from <code><a href="psych.html#topic+kaiser">psych::kaiser()</a></code> (if any)</p>
</dd>
<dt><code>extraction.method</code></dt><dd><p>Extraction method</p>
</dd>
<dt><code>rotation.method</code></dt><dd><p>Rotation method</p>
</dd>
<dt><code>eigenvalues</code></dt><dd><p>A <code>data.frame</code> of eigenvalues and sum of squared (SS) loadings</p>
</dd>
<dt><code>loadings</code></dt><dd><p>A <code>data.frame</code> of factor/component loadings and communalities</p>
</dd>
<dt><code>scree.plot</code></dt><dd><p>A <code>ggplot2</code> object of the scree plot</p>
</dd>
</dl>



<h3>Functions</h3>


<ul>
<li> <p><code>EFA()</code>: Exploratory Factor Analysis
</p>
</li>
<li> <p><code>PCA()</code>: Principal Component Analysis - a wrapper of <code>EFA(..., method="pca")</code>
</p>
</li></ul>


<h3>Note</h3>

<p>Results based on the <code>varimax</code> rotation method are identical to SPSS.
The other rotation methods may produce results slightly different from SPSS.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEAN">MEAN</a></code>, <code><a href="#topic+Alpha">Alpha</a></code>, <code><a href="#topic+CFA">CFA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data = psych::bfi
EFA(data, "E", 1:5)              # var + items
EFA(data, "E", 1:5, nfactors=2)  # var + items

EFA(data, varrange="A1:O5",
    nfactors="parallel",
    hide.loadings=0.45)

# the same as above:
# using dplyr::select() and dplyr::matches()
# to select variables whose names end with numbers
# (regexp: \d matches all numbers, $ matches the end of a string)
data %&gt;% select(matches("\\d$")) %&gt;%
  EFA(vars=names(.),       # all selected variables
      method="pca",        # default
      rotation="varimax",  # default
      nfactors="parallel", # parallel analysis
      hide.loadings=0.45)  # hide loadings &lt; 0.45

</code></pre>

<hr>
<h2 id='EMMEANS'>Simple-effect analysis and post-hoc multiple comparison.</h2><span id='topic+EMMEANS'></span>

<h3>Description</h3>

<p>Perform (1) simple-effect (and simple-simple-effect) analyses,
including both simple main effects and simple interaction effects,
and (2) post-hoc multiple comparisons (e.g., pairwise, sequential, polynomial),
with <em>p</em> values adjusted for factors with &gt;= 3 levels.
</p>
<p>This function is based on and extends
(1) <code><a href="emmeans.html#topic+joint_tests">emmeans::joint_tests()</a></code>,
(2) <code><a href="emmeans.html#topic+emmeans">emmeans::emmeans()</a></code>, and
(3) <code><a href="emmeans.html#topic+contrast">emmeans::contrast()</a></code>.
You only need to specify the model object, to-be-tested effect(s), and moderator(s).
Almost all results you need will be displayed together,
including effect sizes (partial <code class="reqn">\eta^2</code> and Cohen's <em>d</em>) and their confidence intervals (CIs).
90% CIs for partial <code class="reqn">\eta^2</code> and 95% CIs for Cohen's <em>d</em> are reported.
</p>
<p>By default, the <em>root mean square error</em> (RMSE) is used to compute the pooled <em>SD</em> for Cohen's <em>d</em>.
Specifically, it uses:
</p>

<ol>
<li><p> the square root of <em>mean square error</em> (MSE) for between-subjects designs;
</p>
</li>
<li><p> the square root of <em>mean variance of all paired differences of the residuals of repeated measures</em> for within-subjects and mixed designs.
</p>
</li></ol>

<p><strong><em>Disclaimer</em>:</strong>
There is substantial disagreement on the appropriate pooled <em>SD</em> to use in computing the effect size.
For alternative methods, see <code><a href="emmeans.html#topic+eff_size">emmeans::eff_size()</a></code> and <code><a href="effectsize.html#topic+t_to_r">effectsize::t_to_d()</a></code>.
Users should <em>not</em> take the default output as the only right results and are completely responsible for specifying <code>sd.pooled</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMMEANS(
  model,
  effect = NULL,
  by = NULL,
  contrast = "pairwise",
  reverse = TRUE,
  p.adjust = "bonferroni",
  sd.pooled = NULL,
  model.type = "multivariate",
  digits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMMEANS_+3A_model">model</code></td>
<td>
<p>The model object returned by <code><a href="#topic+MANOVA">MANOVA</a></code>.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_effect">effect</code></td>
<td>
<p>Effect(s) you want to test.
If set to a character string (e.g., <code>"A"</code>),
it reports the results of omnibus test or simple main effect.
If set to a character vector (e.g., <code>c("A", "B")</code>),
it also reports the results of simple interaction effect.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_by">by</code></td>
<td>
<p>Moderator variable(s). Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_contrast">contrast</code></td>
<td>
<p>Contrast method for multiple comparisons.
Defaults to <code>"pairwise"</code>.
</p>
<p>Alternatives can be <code>"pairwise"</code> (<code>"revpairwise"</code>),
<code>"seq"</code> (<code>"consec"</code>), <code>"poly"</code>, <code>"eff"</code>.
For details, see <code>?emmeans::`contrast-methods`</code>.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_reverse">reverse</code></td>
<td>
<p>The order of levels to be contrasted.
Defaults to <code>TRUE</code> (higher level vs. lower level).</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_p.adjust">p.adjust</code></td>
<td>
<p>Adjustment method of <em>p</em> values for multiple comparisons.
Defaults to <code>"bonferroni"</code>.
For polynomial contrasts, defaults to <code>"none"</code>.
</p>
<p>Alternatives can be <code>"none"</code>, <code>"fdr"</code>, <code>"hochberg"</code>,
<code>"hommel"</code>, <code>"holm"</code>, <code>"tukey"</code>, <code>"mvt"</code>,
<code>"dunnettx"</code>, <code>"sidak"</code>, <code>"scheffe"</code>, <code>"bonferroni"</code>.
For details, see <code><a href="stats.html#topic+p.adjust">stats::p.adjust()</a></code> and
<code><a href="emmeans.html#topic+summary.emmGrid">emmeans::summary()</a></code>.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_sd.pooled">sd.pooled</code></td>
<td>
<p>By default, it uses <strong><code>sqrt(MSE)</code></strong> (root mean square error, RMSE)
as the pooled <em>SD</em> to compute Cohen's <em>d</em>.
Users may specify this argument as the <em>SD</em> of a reference group,
or use <code><a href="effectsize.html#topic+sd_pooled">effectsize::sd_pooled()</a></code> to obtain a pooled <em>SD</em>.
For an issue about the computation method of Cohen's <em>d</em>, see <em>Disclaimer</em> above.</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_model.type">model.type</code></td>
<td>
<p><code>"multivariate"</code> returns the results of pairwise comparisons identical to SPSS,
which uses the <code>lm</code> (rather than <code>aov</code>) object of the <code>model</code>
for <code><a href="emmeans.html#topic+joint_tests">emmeans::joint_tests()</a></code> and <code><a href="emmeans.html#topic+emmeans">emmeans::emmeans()</a></code>.
</p>
<p><code>"univariate"</code> requires also specifying <code>aov.include=TRUE</code> in <code><a href="#topic+MANOVA">MANOVA</a></code>
(not recommended by the <code>afex</code> package; for details, see <code><a href="afex.html#topic+aov_car">afex::aov_ez()</a></code>).</p>
</td></tr>
<tr><td><code id="EMMEANS_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same model object as returned by
<code><a href="#topic+MANOVA">MANOVA</a></code> (for recursive use),
along with a list of tables:
<code>sim</code> (simple effects),
<code>emm</code> (estimated marginal means),
<code>con</code> (contrasts).
</p>
<p>Each <code>EMMEANS(...)</code> appends one list to the returned object.
</p>


<h3>Interaction Plot (See Examples Below)</h3>

<p>You can save the returned object and use the <code><a href="emmeans.html#topic+emmip">emmeans::emmip()</a></code> function
to create an interaction plot (based on the fitted model and a formula).
See examples below for the usage.
</p>
<p>Note: <code><a href="emmeans.html#topic+emmip">emmeans::emmip()</a></code> returns a <code>ggplot</code> object,
which can be modified and saved with <code>ggplot2</code> syntax.
</p>


<h3>Statistical Details</h3>

<p>Some may confuse the statistical terms &quot;simple effects&quot;, &quot;post-hoc tests&quot;, and &quot;multiple comparisons&quot;.
Such a confusion is not uncommon. Here I explain what these terms actually refer to.
</p>

<dl>
<dt><strong>1. Simple Effect</strong></dt><dd>
<p>When we speak of &quot;simple effect&quot;, we are referring to ...
</p>

<ul>
<li><p> simple main effect
</p>
</li>
<li><p> simple interaction effect (only for designs with 3 or more factors)
</p>
</li>
<li><p> simple simple effect (only for designs with 3 or more factors)
</p>
</li></ul>

<p>When the interaction effect in ANOVA is significant,
we should then perform a &quot;simple-effect analysis&quot;.
In regression, we call this &quot;simple-slope analysis&quot;.
They are identical in statistical principles.
</p>
<p>In a two-factors design, we only test <strong>&quot;simple main effect&quot;</strong>.
That is, at different levels of a factor &quot;B&quot;, the main effects of &quot;A&quot; would be different.
However, in a three-factors (or more) design, we may also test <strong>&quot;simple interaction effect&quot;</strong> and <strong>&quot;simple simple effect&quot;</strong>.
That is, at different combinations of levels of factors &quot;B&quot; and &quot;C&quot;, the main effects of &quot;A&quot; would be different.
</p>
<p>To note, simple effects <em>per se</em> never require <em>p</em>-value adjustment, because what we test in simple-effect analyses are still &quot;omnibus <em>F</em>-tests&quot;.
</p>
</dd>
<dt><strong>2. Post-Hoc Test</strong></dt><dd>
<p>The term &quot;post-hoc&quot; means that the tests are performed after ANOVA. Given this, some may (wrongly) regard simple-effect analyses also as a kind of post-hoc tests.
However, these two terms should be distinguished. In many situations,
&quot;post-hoc tests&quot; only refer to <strong>&quot;post-hoc comparisons&quot;</strong> using <em>t</em>-tests and some <em>p</em>-value adjustment techniques.
We need post-hoc comparisons <strong>only when there are factors with 3 or more levels</strong>.
</p>
<p>Post-hoc tests are totally <strong>independent of</strong> whether there is a significant interaction effect. <strong>It only deals with factors with multiple levels.</strong>
In most cases, we use pairwise comparisons to do post-hoc tests. See the next part for details.
</p>
</dd>
<dt><strong>3. Multiple Comparison</strong></dt><dd>
<p>As mentioned above, multiple comparisons are indeed post-hoc tests but have no relationship with simple-effect analyses.
Post-hoc multiple comparisons are <strong>independent of</strong> interaction effects and simple effects.
Furthermore, if a simple main effect contains 3 or more levels, we also need to do multiple comparisons <em>within</em> the simple-effect analysis.
In this situation, we also need <em>p</em>-value adjustment with methods such as Bonferroni, Tukey's HSD (honest significant difference), FDR (false discovery rate), and so forth.
</p>
<p>Options for multiple comparison:
</p>

<ul>
<li> <p><code>"pairwise"</code> - Pairwise comparisons (default is &quot;higher level - lower level&quot;)
</p>
</li>
<li> <p><code>"seq"</code> or <code>"consec"</code> - Consecutive (sequential) comparisons
</p>
</li>
<li> <p><code>"poly"</code> - Polynomial contrasts (linear, quadratic, cubic, quartic, ...)
</p>
</li>
<li> <p><code>"eff"</code> - Effect contrasts (vs. the grand mean)
</p>
</li></ul>

</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+TTEST">TTEST</a></code>, <code><a href="#topic+MANOVA">MANOVA</a></code>, <code><a href="#topic+bruceR-demodata">bruceR-demodata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Between-Subjects Design ####

between.1
MANOVA(between.1, dv="SCORE", between="A") %&gt;%
  EMMEANS("A")
MANOVA(between.1, dv="SCORE", between="A") %&gt;%
  EMMEANS("A", p.adjust="tukey")
MANOVA(between.1, dv="SCORE", between="A") %&gt;%
  EMMEANS("A", contrast="seq")
MANOVA(between.1, dv="SCORE", between="A") %&gt;%
  EMMEANS("A", contrast="poly")

between.2
MANOVA(between.2, dv="SCORE", between=c("A", "B")) %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS("B", by="A")
## How to create an interaction plot using `emmeans::emmip()`?
## See help page: ?emmeans::emmip()
m = MANOVA(between.2, dv="SCORE", between=c("A", "B"))
emmip(m, ~ A | B, CIs=TRUE)
emmip(m, ~ B | A, CIs=TRUE)
emmip(m, B ~ A, CIs=TRUE)
emmip(m, A ~ B, CIs=TRUE)

between.3
MANOVA(between.3, dv="SCORE", between=c("A", "B", "C")) %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS(c("A", "B"), by="C") %&gt;%
  EMMEANS("A", by=c("B", "C"))
## Just to name a few...
## You may test other combinations...


#### Within-Subjects Design ####

within.1
MANOVA(within.1, dvs="A1:A4", dvs.pattern="A(.)",
       within="A") %&gt;%
  EMMEANS("A")

within.2
MANOVA(within.2, dvs="A1B1:A2B3", dvs.pattern="A(.)B(.)",
       within=c("A", "B")) %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS("B", by="A")  # singular error matrix
# :::::::::::::::::::::::::::::::::::::::
# This would produce a WARNING because of
# the linear dependence of A2B2 and A2B3.
# See: Corr(within.2[c("A2B2", "A2B3")])

within.3
MANOVA(within.3, dvs="A1B1C1:A2B2C2", dvs.pattern="A(.)B(.)C(.)",
       within=c("A", "B", "C")) %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS(c("A", "B"), by="C") %&gt;%
  EMMEANS("A", by=c("B", "C"))
## Just to name a few...
## You may test other combinations...


#### Mixed Design ####

mixed.2_1b1w
MANOVA(mixed.2_1b1w, dvs="B1:B3", dvs.pattern="B(.)",
       between="A", within="B", sph.correction="GG") %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS("B", by="A")

mixed.3_1b2w
MANOVA(mixed.3_1b2w, dvs="B1C1:B2C2", dvs.pattern="B(.)C(.)",
       between="A", within=c("B", "C")) %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS(c("A", "B"), by="C") %&gt;%
  EMMEANS("A", by=c("B", "C"))
## Just to name a few...
## You may test other combinations...

mixed.3_2b1w
MANOVA(mixed.3_2b1w, dvs="B1:B2", dvs.pattern="B(.)",
       between=c("A", "C"), within="B") %&gt;%
  EMMEANS("A", by="B") %&gt;%
  EMMEANS("A", by="C") %&gt;%
  EMMEANS(c("A", "B"), by="C") %&gt;%
  EMMEANS("B", by=c("A", "C"))
## Just to name a few...
## You may test other combinations...


#### Other Examples ####

air = airquality
air$Day.1or2 = ifelse(air$Day %% 2 == 1, 1, 2) %&gt;%
  factor(levels=1:2, labels=c("odd", "even"))
MANOVA(air, dv="Temp", between=c("Month", "Day.1or2"),
       covariate=c("Solar.R", "Wind")) %&gt;%
  EMMEANS("Month", contrast="seq") %&gt;%
  EMMEANS("Month", by="Day.1or2", contrast="poly")

</code></pre>

<hr>
<h2 id='export'>Export data to a file (TXT, CSV, Excel, SPSS, Stata, ...) or clipboard.</h2><span id='topic+export'></span>

<h3>Description</h3>

<p>Export data to a file, with format automatically judged from file extension.
This function is inspired by <code><a href="rio.html#topic+export">rio::export()</a></code>
and has several modifications.
Its purpose is to avoid using lots of <code>write_xxx()</code> functions in your code
and to provide one tidy function for data export.
</p>
<p>It supports many file formats and uses corresponding R functions:
</p>

<ul>
<li><p> Plain text (.txt, .csv, .csv2, .tsv, .psv), using <code><a href="data.table.html#topic+fwrite">data.table::fwrite()</a></code>;
if the <code>encoding</code> argument is specified, using <code><a href="utils.html#topic+write.table">utils::write.table()</a></code> instead
</p>
</li>
<li><p> Excel (.xls, .xlsx), using <code><a href="openxlsx.html#topic+write.xlsx">openxlsx::write.xlsx()</a></code>
</p>
</li>
<li><p> SPSS (.sav), using <code><a href="haven.html#topic+read_spss">haven::write_sav()</a></code>
</p>
</li>
<li><p> Stata (.dta), using <code><a href="haven.html#topic+read_dta">haven::write_dta()</a></code>
</p>
</li>
<li><p> R objects (.rda, .rdata, .RData), using <code><a href="base.html#topic+save">base::save()</a></code>
</p>
</li>
<li><p> R serialized objects (.rds), using <code><a href="base.html#topic+readRDS">base::saveRDS()</a></code>
</p>
</li>
<li><p> Clipboard (on Windows and Mac OS), using <code><a href="clipr.html#topic+write_clip">clipr::write_clip()</a></code>
</p>
</li>
<li><p> Other formats, using <code><a href="rio.html#topic+export">rio::export()</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>export(
  x,
  file,
  encoding = NULL,
  header = "auto",
  sheet = NULL,
  overwrite = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_+3A_x">x</code></td>
<td>
<p>Any R object, usually a data frame (<code>data.frame</code>, <code>data.table</code>, <code>tbl_df</code>).
Multiple R objects should be included in a <em>named</em> <code>list</code> (see examples).
</p>
<p>If you want to save R objects other than a data frame (e.g., model results),
you'd better specify <code>file</code> with extensions .rda, .rdata, or .RData.</p>
</td></tr>
<tr><td><code id="export_+3A_file">file</code></td>
<td>
<p>File name (with extension).
If unspecified, then data will be exported to clipboard.</p>
</td></tr>
<tr><td><code id="export_+3A_encoding">encoding</code></td>
<td>
<p>File encoding. Defaults to <code>NULL</code>.
Options: <code>"UTF-8"</code>, <code>"GBK"</code>, <code>"CP936"</code>, etc.
</p>
<p>If you find messy code for Chinese text in the exported data (often in CSV when opened with Excel),
it is usually useful to set <code>encoding="GBK"</code> or <code>encoding="CP936"</code>.</p>
</td></tr>
<tr><td><code id="export_+3A_header">header</code></td>
<td>
<p>Does the first row contain column names (<code>TRUE</code> or <code>FALSE</code>)? Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="export_+3A_sheet">sheet</code></td>
<td>
<p>[Only for Excel] Excel sheet name(s).
Defaults to &quot;Sheet1&quot;, &quot;Sheet2&quot;, ...
You may specify multiple sheet names in a character vector
<code>c()</code> with the <em>same length</em> as <code>x</code> (see examples).</p>
</td></tr>
<tr><td><code id="export_+3A_overwrite">overwrite</code></td>
<td>
<p>Overwrite the existing file (if any)? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="export_+3A_verbose">verbose</code></td>
<td>
<p>Print output information? Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+import">import</a></code>, <code><a href="#topic+print_table">print_table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

  export(airquality)  # paste to clipboard
  export(airquality, file="mydata.csv")
  export(airquality, file="mydata.sav")

  export(list(airquality, npk), file="mydata.xlsx")  # Sheet1, Sheet2
  export(list(air=airquality, npk=npk), file="mydata.xlsx")  # a named list
  export(list(airquality, npk), sheet=c("air", "npk"), file="mydata.xlsx")

  export(list(a=1, b=npk, c="character"), file="abc.Rdata")  # .rda, .rdata
  d = import("abc.Rdata")  # load only the first object and rename it to `d`
  load("abc.Rdata")  # load all objects with original names to environment

  export(lm(yield ~ N*P*K, data=npk), file="lm_npk.Rdata")
  model = import("lm_npk.Rdata")
  load("lm_npk.Rdata")  # because x is unnamed, the object has a name "List1"

  export(list(m1=lm(yield ~ N*P*K, data=npk)), file="lm_npk.Rdata")
  model = import("lm_npk.Rdata")
  load("lm_npk.Rdata")  # because x is named, the object has a name "m1"

## End(Not run)

</code></pre>

<hr>
<h2 id='formatF'>Format numeric values.</h2><span id='topic+formatF'></span>

<h3>Description</h3>

<p>Format numeric values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatF(x, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatF_+3A_x">x</code></td>
<td>
<p>A number or numeric vector.</p>
</td></tr>
<tr><td><code id="formatF_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted character string.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format">format</a></code>, <code><a href="#topic+formatN">formatN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formatF(pi, 20)

</code></pre>

<hr>
<h2 id='formatN'>Format &quot;1234&quot; to &quot;1,234&quot;.</h2><span id='topic+formatN'></span>

<h3>Description</h3>

<p>Format &quot;1234&quot; to &quot;1,234&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatN(x, mark = ",")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatN_+3A_x">x</code></td>
<td>
<p>A number or numeric vector.</p>
</td></tr>
<tr><td><code id="formatN_+3A_mark">mark</code></td>
<td>
<p>Usually <code>","</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted character string.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format">format</a></code>, <code><a href="#topic+formatF">formatF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formatN(1234)

</code></pre>

<hr>
<h2 id='formula_expand'>Expand all interaction terms in a formula.</h2><span id='topic+formula_expand'></span>

<h3>Description</h3>

<p>Expand all interaction terms in a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_expand(formula, as.char = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_expand_+3A_formula">formula</code></td>
<td>
<p>R formula or a character string indicating the formula.</p>
</td></tr>
<tr><td><code id="formula_expand_+3A_as.char">as.char</code></td>
<td>
<p>Return character? Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formula/character object including all expanded terms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formula_expand(y ~ a*b*c)
formula_expand("y ~ a*b*c")

</code></pre>

<hr>
<h2 id='formula_paste'>Paste a formula into a string.</h2><span id='topic+formula_paste'></span>

<h3>Description</h3>

<p>Paste a formula into a string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_paste(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_paste_+3A_formula">formula</code></td>
<td>
<p>R formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string indicating the formula.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formula_paste(y ~ x)
formula_paste(y ~ x + (1 | g))

</code></pre>

<hr>
<h2 id='Freq'>Frequency statistics.</h2><span id='topic+Freq'></span>

<h3>Description</h3>

<p>Frequency statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Freq(x, varname, labels, sort = "", digits = 1, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Freq_+3A_x">x</code></td>
<td>
<p>A vector of values (or a data frame).</p>
</td></tr>
<tr><td><code id="Freq_+3A_varname">varname</code></td>
<td>
<p>[Optional] Variable name, if <code>x</code> is a data frame.</p>
</td></tr>
<tr><td><code id="Freq_+3A_labels">labels</code></td>
<td>
<p>[Optional] A vector re-defining the labels of values.</p>
</td></tr>
<tr><td><code id="Freq_+3A_sort">sort</code></td>
<td>
<p><code>""</code> (default, sorted by the order of variable values/labels),
<code>"-"</code> (decreasing by N), or <code>"+"</code> (increasing by N).</p>
</td></tr>
<tr><td><code id="Freq_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="Freq_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of frequency statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data = psych::bfi

## Input `data$variable`
Freq(data$education)
Freq(data$gender, labels=c("Male", "Female"))
Freq(data$age)

## Input one data frame and one variable name
Freq(data, "education")
Freq(data, "gender", labels=c("Male", "Female"))
Freq(data, "age")

</code></pre>

<hr>
<h2 id='GLM_summary'>Tidy report of GLM (<code>lm</code> and <code>glm</code> models).</h2><span id='topic+GLM_summary'></span>

<h3>Description</h3>

<p>NOTE: <code><a href="#topic+model_summary">model_summary</a></code> is preferred.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLM_summary(model, robust = FALSE, cluster = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GLM_summary_+3A_model">model</code></td>
<td>
<p>A model fitted with <code>lm</code> or <code>glm</code> function.</p>
</td></tr>
<tr><td><code id="GLM_summary_+3A_robust">robust</code></td>
<td>
<p>[Only for <code>lm</code> and <code>glm</code>]
<code>FALSE</code> (default), <code>TRUE</code> (then the default is <code>"HC1"</code>),
<code>"HC0"</code>, <code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, or <code>"HC5"</code>.
It will add a table with heteroskedasticity-robust standard errors (aka. Huber-White standard errors).
For details, see <code>?sandwich::vcovHC</code> and <code>?jtools::summ.lm</code>.
</p>
<p>*** <code>"HC1"</code> is the default of Stata, whereas <code>"HC3"</code> is the default suggested by the <code>sandwich</code> package.</p>
</td></tr>
<tr><td><code id="GLM_summary_+3A_cluster">cluster</code></td>
<td>
<p>[Only for <code>lm</code> and <code>glm</code>]
Cluster-robust standard errors are computed if cluster is set to the name of the input data's cluster variable or is a vector of clusters.</p>
</td></tr>
<tr><td><code id="GLM_summary_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="GLM_summary_+3A_...">...</code></td>
<td>
<p>Other arguments. You may re-define <code>formula</code>, <code>data</code>, or <code>family</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print_table">print_table</a></code> (print simple table)
</p>
<p><code><a href="#topic+model_summary">model_summary</a></code> (highly suggested)
</p>
<p><code><a href="#topic+HLM_summary">HLM_summary</a></code>
</p>
<p><code><a href="#topic+regress">regress</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: OLS regression
lm = lm(Temp ~ Month + Day + Wind + Solar.R, data=airquality)
GLM_summary(lm)
GLM_summary(lm, robust="HC1")
# Stata's default is "HC1"
# R package &lt;sandwich&gt;'s default is "HC3"

## Example 2: Logistic regression
glm = glm(case ~ age + parity + education + spontaneous + induced,
          data=infert, family=binomial)
GLM_summary(glm)
GLM_summary(glm, robust="HC1", cluster="stratum")

</code></pre>

<hr>
<h2 id='grand_mean_center'>Grand-mean centering.</h2><span id='topic+grand_mean_center'></span>

<h3>Description</h3>

<p>Compute grand-mean centered variables.
Usually used for GLM interaction-term predictors and HLM level-2 predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grand_mean_center(data, vars = names(data), std = FALSE, add.suffix = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grand_mean_center_+3A_data">data</code></td>
<td>
<p>Data object.</p>
</td></tr>
<tr><td><code id="grand_mean_center_+3A_vars">vars</code></td>
<td>
<p>Variable(s) to be centered.</p>
</td></tr>
<tr><td><code id="grand_mean_center_+3A_std">std</code></td>
<td>
<p>Standardized or not. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="grand_mean_center_+3A_add.suffix">add.suffix</code></td>
<td>
<p>The suffix of the centered variable(s).
Defaults to <code>""</code>. You may set it to <code>"_c"</code>, <code>"_center"</code>, etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new data object containing the centered variable(s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+group_mean_center">group_mean_center</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = data.table(a=1:5, b=6:10)

d.c = grand_mean_center(d, "a")
d.c

d.c = grand_mean_center(d, c("a", "b"), add.suffix="_center")
d.c

</code></pre>

<hr>
<h2 id='granger_causality'>Granger causality test (multivariate).</h2><span id='topic+granger_causality'></span>

<h3>Description</h3>

<p>Granger test of predictive causality (between multivariate time series)
based on vector autoregression (<code><a href="vars.html#topic+VAR">VAR</a></code>) model.
Its output resembles the output of the <code>vargranger</code>
command in Stata (but here using an <em>F</em> test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granger_causality(
  varmodel,
  var.y = NULL,
  var.x = NULL,
  test = c("F", "Chisq"),
  file = NULL,
  check.dropped = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="granger_causality_+3A_varmodel">varmodel</code></td>
<td>
<p>VAR model fitted using the <code><a href="vars.html#topic+VAR">vars::VAR()</a></code> function.</p>
</td></tr>
<tr><td><code id="granger_causality_+3A_var.y">var.y</code>, <code id="granger_causality_+3A_var.x">var.x</code></td>
<td>
<p>[Optional] Defaults to <code>NULL</code> (all variables).
If specified, then perform tests for specific variables.
Values can be a single variable (e.g., <code>"X"</code>),
a vector of variables (e.g., <code>c("X1", "X2")</code>),
or a string containing regular expression (e.g., <code>"X1|X2"</code>).</p>
</td></tr>
<tr><td><code id="granger_causality_+3A_test">test</code></td>
<td>
<p><em>F</em> test and/or Wald <code class="reqn">\chi</code>^2 test. Defaults to both: <code>c("F", "Chisq")</code>.</p>
</td></tr>
<tr><td><code id="granger_causality_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="granger_causality_+3A_check.dropped">check.dropped</code></td>
<td>
<p>Check dropped variables. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Granger causality test (based on VAR model) examines whether
the lagged values of a predictor (or predictors)
help to predict an outcome when controlling for
the lagged values of the outcome itself.
</p>
<p>Granger causality does not necessarily constitute a true causal effect.
</p>


<h3>Value</h3>

<p>A data frame of results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccf_plot">ccf_plot</a></code>,
<code><a href="#topic+granger_test">granger_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># R package "vars" should be installed
library(vars)
data(Canada)
VARselect(Canada)
vm = VAR(Canada, p=3)
model_summary(vm)
granger_causality(vm)

</code></pre>

<hr>
<h2 id='granger_test'>Granger causality test (bivariate).</h2><span id='topic+granger_test'></span>

<h3>Description</h3>

<p>Granger test of predictive causality (between two time series)
using the <code><a href="lmtest.html#topic+grangertest">lmtest::grangertest()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granger_test(formula, data, lags = 1:5, test.reverse = TRUE, file = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="granger_test_+3A_formula">formula</code></td>
<td>
<p>Model formula like <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="granger_test_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="granger_test_+3A_lags">lags</code></td>
<td>
<p>Time lags. Defaults to <code>1:5</code>.</p>
</td></tr>
<tr><td><code id="granger_test_+3A_test.reverse">test.reverse</code></td>
<td>
<p>Whether to test reverse causality. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="granger_test_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="granger_test_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="lmtest.html#topic+grangertest">lmtest::grangertest()</a></code>.
For example, you may use <em>robust</em> standard errors by specifying
the <code>vcov</code> argument (see <a href="https://github.com/psychbruce/bruceR/issues/23">GitHub Issue #23</a>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Granger causality test examines whether
the lagged values of a predictor
have an incremental role in predicting (i.e., help to predict)
an outcome when controlling for the lagged values of the outcome.
</p>
<p>Granger causality does not necessarily constitute a true causal effect.
</p>


<h3>Value</h3>

<p>A data frame of results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccf_plot">ccf_plot</a></code>,
<code><a href="#topic+granger_causality">granger_causality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>granger_test(chicken ~ egg, data=lmtest::ChickEgg)
granger_test(chicken ~ egg, data=lmtest::ChickEgg, lags=1:10, file="Granger.doc")
unlink("Granger.doc")  # delete file for code check

</code></pre>

<hr>
<h2 id='group_mean_center'>Group-mean centering.</h2><span id='topic+group_mean_center'></span>

<h3>Description</h3>

<p>Compute group-mean centered variables.
Usually used for HLM level-1 predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_mean_center(
  data,
  vars = setdiff(names(data), by),
  by,
  std = FALSE,
  add.suffix = "",
  add.group.mean = "_mean"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_mean_center_+3A_data">data</code></td>
<td>
<p>Data object.</p>
</td></tr>
<tr><td><code id="group_mean_center_+3A_vars">vars</code></td>
<td>
<p>Variable(s) to be centered.</p>
</td></tr>
<tr><td><code id="group_mean_center_+3A_by">by</code></td>
<td>
<p>Grouping variable.</p>
</td></tr>
<tr><td><code id="group_mean_center_+3A_std">std</code></td>
<td>
<p>Standardized or not. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="group_mean_center_+3A_add.suffix">add.suffix</code></td>
<td>
<p>The suffix of the centered variable(s).
Defaults to <code>""</code>. You may set it to <code>"_c"</code>, <code>"_center"</code>, etc.</p>
</td></tr>
<tr><td><code id="group_mean_center_+3A_add.group.mean">add.group.mean</code></td>
<td>
<p>The suffix of the variable name(s) of group means.
Defaults to <code>"_mean"</code> (see Examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new data object containing the centered variable(s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grand_mean_center">grand_mean_center</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = data.table(x=1:9, g=rep(1:3, each=3))

d.c = group_mean_center(d, "x", by="g")
d.c

d.c = group_mean_center(d, "x", by="g", add.suffix="_c")
d.c

</code></pre>

<hr>
<h2 id='HLM_ICC_rWG'>Tidy report of HLM indices: ICC(1), ICC(2), and rWG/rWG(J).</h2><span id='topic+HLM_ICC_rWG'></span>

<h3>Description</h3>

<p>Compute ICC(1) (non-independence of data),
ICC(2) (reliability of group means),
and <code class="reqn">r_{WG}</code>/<code class="reqn">r_{WG(J)}</code> (within-group agreement for single-item/multi-item measures)
in multilevel analysis (HLM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HLM_ICC_rWG(
  data,
  group,
  icc.var,
  rwg.vars = icc.var,
  rwg.levels = 0,
  digits = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HLM_ICC_rWG_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="HLM_ICC_rWG_+3A_group">group</code></td>
<td>
<p>Grouping variable.</p>
</td></tr>
<tr><td><code id="HLM_ICC_rWG_+3A_icc.var">icc.var</code></td>
<td>
<p>Key variable for analysis (usually the dependent variable).</p>
</td></tr>
<tr><td><code id="HLM_ICC_rWG_+3A_rwg.vars">rwg.vars</code></td>
<td>
<p>Defaults to <code>icc.var</code>. It can be:
</p>

<ul>
<li><p> A single variable (<em>single-item</em> measure), then computing rWG.
</p>
</li>
<li><p> Multiple variables (<em>multi-item</em> measure), then computing rWG(J), where J = the number of items.
</p>
</li></ul>
</td></tr>
<tr><td><code id="HLM_ICC_rWG_+3A_rwg.levels">rwg.levels</code></td>
<td>
<p>As <code class="reqn">r_{WG}</code>/<code class="reqn">r_{WG(J)}</code> compares the actual group variance to the expected random variance (i.e., the variance of uniform distribution, <code class="reqn">\sigma_{EU}^2</code>),
it is required to specify which type of uniform distribution is.
</p>

<ul>
<li><p> For <em>continuous</em> uniform distribution, <code class="reqn">\sigma_{EU}^2 = (max - min)^2 / 12</code>.
Then <code>rwg.levels</code> is not useful and will be set to <code>0</code> (the default).
</p>
</li>
<li><p> For <em>discrete</em> uniform distribution, <code class="reqn">\sigma_{EU}^2 = (A^2 - 1) / 12</code>,
where A is the number of response options (levels).
Then <code>rwg.levels</code> should be provided (= A in the above formula).
For example, if the measure is a 5-point Likert scale, you should set <code>rwg.levels=5</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="HLM_ICC_rWG_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><strong>ICC(1) (intra-class correlation, or non-independence of data)</strong></dt><dd>
<p>ICC(1) = var.u0 / (var.u0 + var.e) = <code class="reqn">\sigma_{u0}^2 / (\sigma_{u0}^2 + \sigma_{e}^2)</code>
</p>
<p>ICC(1) is the ICC we often compute and report in multilevel analysis
(usually in the Null Model, where only the random intercept of group is included).
It can be interpreted as either <strong>&quot;the proportion of variance explained by groups&quot;</strong> (i.e., <em>heterogeneity</em> between groups)
or <strong>&quot;the expectation of correlation coefficient between any two observations within any group&quot;</strong> (i.e., <em>homogeneity</em> within groups).
</p>
</dd>
<dt><strong>ICC(2) (reliability of group means)</strong></dt><dd>
<p>ICC(2) = mean(var.u0 / (var.u0 + var.e / n.k)) = <code class="reqn">\Sigma[\sigma_{u0}^2 / (\sigma_{u0}^2 + \sigma_{e}^2 / n_k)] / K</code>
</p>
<p>ICC(2) is a measure of <strong>&quot;the representativeness of group-level aggregated means for within-group individual values&quot;</strong>
or <strong>&quot;the degree to which an individual score can be considered a reliable assessment of a group-level construct&quot;</strong>.
</p>
</dd>
<dt><strong><code class="reqn">r_{WG}</code>/<code class="reqn">r_{WG(J)}</code> (within-group agreement for single-item/multi-item measures)</strong></dt><dd>
<p><code class="reqn">r_{WG} = 1 - \sigma^2 / \sigma_{EU}^2</code>
</p>
<p><code class="reqn">r_{WG(J)} = 1 - (\sigma_{MJ}^2 / \sigma_{EU}^2) / [J * (1 - \sigma_{MJ}^2 / \sigma_{EU}^2) + \sigma_{MJ}^2 / \sigma_{EU}^2]</code>
</p>
<p><code class="reqn">r_{WG}</code>/<code class="reqn">r_{WG(J)}</code> is a measure of within-group agreement or consensus. Each group has an <code class="reqn">r_{WG}</code>/<code class="reqn">r_{WG(J)}</code>.
</p>
</dd>
<dt>* Note for the above formulas</dt><dd>

<ul>
<li> <p><code class="reqn">\sigma_{u0}^2</code>: between-group variance (i.e., tau00)
</p>
</li>
<li> <p><code class="reqn">\sigma_{e}^2</code>: within-group variance (i.e., residual variance)
</p>
</li>
<li> <p><code class="reqn">n_k</code>: group size of the k-th group
</p>
</li>
<li> <p><code class="reqn">K</code>: number of groups
</p>
</li>
<li> <p><code class="reqn">\sigma^2</code>: actual group variance of the k-th group
</p>
</li>
<li> <p><code class="reqn">\sigma_{MJ}^2</code>: mean value of actual group variance of the k-th group across all J items
</p>
</li>
<li> <p><code class="reqn">\sigma_{EU}^2</code>: expected random variance (i.e., the variance of uniform distribution)
</p>
</li>
<li> <p><code class="reqn">J</code>: number of items
</p>
</li></ul>

</dd>
</dl>



<h3>Value</h3>

<p>Invisibly return a list of results.
</p>


<h3>References</h3>

<p>Bliese, P. D. (2000).
Within-group agreement, non-independence, and reliability:
Implications for data aggregation and Analysis.
In K. J. Klein &amp; S. W. Kozlowski (Eds.),
<em>Multilevel theory, research, and methods in organizations</em> (pp. 349&ndash;381).
San Francisco, CA: Jossey-Bass, Inc.
</p>
<p>James, L.R., Demaree, R.G., &amp; Wolf, G. (1984).
Estimating within-group interrater reliability with and without response bias.
<em>Journal of Applied Psychology, 69</em>, 85&ndash;98.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cor_multilevel">cor_multilevel</a></code>
</p>
<p><a href="https://CRAN.R-project.org/package=multilevel">R package &quot;multilevel&quot;</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data = lme4::sleepstudy  # continuous variable
HLM_ICC_rWG(data, group="Subject", icc.var="Reaction")

data = lmerTest::carrots  # 7-point scale
HLM_ICC_rWG(data, group="Consumer", icc.var="Preference",
            rwg.vars="Preference",
            rwg.levels=7)
HLM_ICC_rWG(data, group="Consumer", icc.var="Preference",
            rwg.vars=c("Sweetness", "Bitter", "Crisp"),
            rwg.levels=7)

</code></pre>

<hr>
<h2 id='HLM_summary'>Tidy report of HLM (<code>lmer</code> and <code>glmer</code> models).</h2><span id='topic+HLM_summary'></span>

<h3>Description</h3>

<p>NOTE: <code><a href="#topic+model_summary">model_summary</a></code> is preferred.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HLM_summary(model = NULL, test.rand = FALSE, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HLM_summary_+3A_model">model</code></td>
<td>
<p>A model fitted with <code>lmer</code> or <code>glmer</code> function using the <code>lmerTest</code> package.</p>
</td></tr>
<tr><td><code id="HLM_summary_+3A_test.rand">test.rand</code></td>
<td>
<p>[Only for <code>lmer</code> and <code>glmer</code>]
<code>TRUE</code> or <code>FALSE</code> (default).
Test random effects (i.e., variance components) by using the likelihood-ratio test (LRT),
which is asymptotically chi-square distributed.
For large datasets, it is much time-consuming.</p>
</td></tr>
<tr><td><code id="HLM_summary_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="HLM_summary_+3A_...">...</code></td>
<td>
<p>Other arguments. You may re-define <code>formula</code>, <code>data</code>, or <code>family</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>References</h3>

<p>Hox, J. J. (2010).
<em>Multilevel analysis: Techniques and applications</em> (2nd ed.).
New York, NY: Routledge.
</p>
<p>Nakagawa, S., &amp; Schielzeth, H. (2013).
A general and simple method for obtaining <em>R</em>^2 from generalized linear mixed-effects models.
<em>Methods in Ecology and Evolution, 4,</em> 133&ndash;142.
</p>
<p>Xu, R. (2003).
Measuring explained variation in linear mixed effects models.
<em>Statistics in Medicine, 22,</em> 3527&ndash;3541.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print_table">print_table</a></code> (print simple table)
</p>
<p><code><a href="#topic+model_summary">model_summary</a></code> (highly suggested)
</p>
<p><code><a href="#topic+GLM_summary">GLM_summary</a></code>
</p>
<p><code><a href="#topic+regress">regress</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lmerTest)

## Example 1: data from lme4::sleepstudy
# (1) 'Subject' is a grouping/clustering variable
# (2) 'Days' is a level-1 predictor nested within 'Subject'
# (3) No level-2 predictors
m1 = lmer(Reaction ~ (1 | Subject), data=sleepstudy)
m2 = lmer(Reaction ~ Days + (1 | Subject), data=sleepstudy)
m3 = lmer(Reaction ~ Days + (Days | Subject), data=sleepstudy)
HLM_summary(m1)
HLM_summary(m2)
HLM_summary(m3)

## Example 2: data from lmerTest::carrots
# (1) 'Consumer' is a grouping/clustering variable
# (2) 'Sweetness' is a level-1 predictor
# (3) 'Age' and 'Frequency' are level-2 predictors
hlm.1 = lmer(Preference ~ Sweetness + Age + Frequency +
               (1 | Consumer), data=carrots)
hlm.2 = lmer(Preference ~ Sweetness + Age + Frequency +
               (Sweetness | Consumer) + (1 | Product), data=carrots)
HLM_summary(hlm.1)
HLM_summary(hlm.2)

</code></pre>

<hr>
<h2 id='import'>Import data from a file (TXT, CSV, Excel, SPSS, Stata, ...) or clipboard.</h2><span id='topic+import'></span>

<h3>Description</h3>

<p>Import data from a file, with format automatically judged from file extension.
This function is inspired by <code><a href="rio.html#topic+import">rio::import()</a></code>
and has several modifications.
Its purpose is to avoid using lots of <code>read_xxx()</code> functions in your code
and to provide one tidy function for data import.
</p>
<p>It supports many file formats (local or URL) and
uses the corresponding R functions:
</p>

<ul>
<li><p> Plain text (.txt, .csv, .csv2, .tsv, .psv), using <code><a href="data.table.html#topic+fread">data.table::fread()</a></code>
</p>
</li>
<li><p> Excel (.xls, .xlsx), using <code><a href="readxl.html#topic+read_excel">readxl::read_excel()</a></code>
</p>
</li>
<li><p> SPSS (.sav), using <code><a href="haven.html#topic+read_spss">haven::read_sav()</a></code>
or <code><a href="foreign.html#topic+read.spss">foreign::read.spss()</a></code>
</p>
</li>
<li><p> Stata (.dta), using <code><a href="haven.html#topic+read_dta">haven::read_dta()</a></code>
or <code><a href="foreign.html#topic+read.dta">foreign::read.dta()</a></code>
</p>
</li>
<li><p> R objects (.rda, .rdata, .RData), using <code><a href="base.html#topic+load">base::load()</a></code>
</p>
</li>
<li><p> R serialized objects (.rds), using <code><a href="base.html#topic+readRDS">base::readRDS()</a></code>
</p>
</li>
<li><p> Clipboard (on Windows and Mac OS), using <code><a href="clipr.html#topic+read_clip_tbl">clipr::read_clip_tbl()</a></code>
</p>
</li>
<li><p> Other formats, using <code><a href="rio.html#topic+import">rio::import()</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>import(
  file,
  encoding = NULL,
  header = "auto",
  sheet = NULL,
  range = NULL,
  pkg = c("haven", "foreign"),
  value.labels = FALSE,
  as = "data.frame",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import_+3A_file">file</code></td>
<td>
<p>File name (with extension).
If unspecified, then data will be imported from clipboard.</p>
</td></tr>
<tr><td><code id="import_+3A_encoding">encoding</code></td>
<td>
<p>File encoding. Defaults to <code>NULL</code>.
Options: <code>"UTF-8"</code>, <code>"GBK"</code>, <code>"CP936"</code>, etc.
</p>
<p>If you find messy code for Chinese text in the imported data,
it is usually effective to set <code>encoding="UTF-8"</code>.</p>
</td></tr>
<tr><td><code id="import_+3A_header">header</code></td>
<td>
<p>Does the first row contain column names (<code>TRUE</code> or <code>FALSE</code>)?
Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="import_+3A_sheet">sheet</code></td>
<td>
<p>[Only for Excel] Excel sheet name (or sheet number).
Defaults to the first sheet.
Ignored if the sheet is specified via <code>range</code>.</p>
</td></tr>
<tr><td><code id="import_+3A_range">range</code></td>
<td>
<p>[Only for Excel] Excel cell range.
Defaults to all cells in a sheet.
You may specify it as <code>range="A1:E100"</code> or <code>range="Sheet1!A1:E100"</code>.</p>
</td></tr>
<tr><td><code id="import_+3A_pkg">pkg</code></td>
<td>
<p>[Only for SPSS &amp; Stata] Use which R package to read
SPSS (.sav) or Stata (.dta) data file?
Defaults to <code>"haven"</code>. You may also use <code>"foreign"</code>.
</p>
<p>Notably, <code>"haven"</code> may be preferred because it is more robust to
non-English characters and can also keep variable labels (descriptions)
from SPSS.</p>
</td></tr>
<tr><td><code id="import_+3A_value.labels">value.labels</code></td>
<td>
<p>[Only for SPSS &amp; Stata] Convert variables with value labels
into R factors with those levels? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="import_+3A_as">as</code></td>
<td>
<p>Class of the imported data.
Defaults to <code>"data.frame"</code>.
Ignored if the file is an R data object (.rds, .rda, .rdata, .RData).
</p>
<p>Options:
</p>

<ul>
<li><p> data.frame: <code>"data.frame"</code>, <code>"df"</code>, <code>"DF"</code>
</p>
</li>
<li><p> data.table: <code>"data.table"</code>, <code>"dt"</code>, <code>"DT"</code>
</p>
</li>
<li><p> tbl_df: <code>"tibble"</code>, <code>"tbl_df"</code>, <code>"tbl"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="import_+3A_verbose">verbose</code></td>
<td>
<p>Print data information? Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data object (default class is <code>data.frame</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+export">export</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

  # Import data from system clipboard
  data = import()  # read from clipboard (on Windows and Mac OS)

  # If you have an Excel file named "mydata.xlsx"
  export(airquality, file="mydata.xlsx")

  # Import data from a file
  data = import("mydata.xlsx")  # default: data.frame
  data = import("mydata.xlsx", as="data.table")

## End(Not run)

</code></pre>

<hr>
<h2 id='lavaan_summary'>Tidy report of lavaan model.</h2><span id='topic+lavaan_summary'></span>

<h3>Description</h3>

<p>Tidy report of lavaan model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lavaan_summary(
  lavaan,
  ci = c("raw", "boot", "bc.boot", "bca.boot"),
  nsim = 100,
  seed = NULL,
  digits = 3,
  print = TRUE,
  covariance = FALSE,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lavaan_summary_+3A_lavaan">lavaan</code></td>
<td>
<p>Model object fitted by <code><a href="lavaan.html#topic+lavaan-class">lavaan</a></code>.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_ci">ci</code></td>
<td>
<p>Method for estimating standard error (SE) and
95% confidence interval (CI).
</p>
<p>Defaults to <code>"raw"</code> (the standard approach of <code>lavaan</code>).
Other options:
</p>

<dl>
<dt><code>"boot"</code></dt><dd><p>Percentile Bootstrap</p>
</dd>
<dt><code>"bc.boot"</code></dt><dd><p>Bias-Corrected Percentile Bootstrap</p>
</dd>
<dt><code>"bca.boot"</code></dt><dd><p>Bias-Corrected and Accelerated (BCa) Percentile Bootstrap</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulation samples (bootstrap resampling)
for estimating SE and 95% CI.
In formal analyses, <strong><code>nsim=1000</code> (or larger)</strong> is strongly suggested.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_seed">seed</code></td>
<td>
<p>Random seed for obtaining reproducible results. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_print">print</code></td>
<td>
<p>Print results. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_covariance">covariance</code></td>
<td>
<p>Print (co)variances. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="lavaan_summary_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a list of results:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>Model fit indices.</p>
</dd>
<dt><code>measure</code></dt><dd><p>Latent variable measures.</p>
</dd>
<dt><code>regression</code></dt><dd><p>Regression paths.</p>
</dd>
<dt><code>covariance</code></dt><dd><p>Variances and/or covariances.</p>
</dd>
<dt><code>effect</code></dt><dd><p>Defined effect estimates.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+PROCESS">PROCESS</a></code>, <code><a href="#topic+CFA">CFA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simple Mediation:
## Solar.R (X) =&gt; Ozone (M) =&gt; Temp (Y)

# PROCESS(airquality, y="Temp", x="Solar.R",
#         meds="Ozone", ci="boot", nsim=1000, seed=1)

model = "
Ozone ~ a*Solar.R
Temp ~ c.*Solar.R + b*Ozone
Indirect := a*b
Direct := c.
Total := c. + a*b
"
lv = lavaan::sem(model=model, data=airquality)
lavaan::summary(lv, fit.measure=TRUE, ci=TRUE, nd=3)  # raw output
lavaan_summary(lv)
# lavaan_summary(lv, ci="boot", nsim=1000, seed=1)


## Serial Multiple Mediation:
## Solar.R (X) =&gt; Ozone (M1) =&gt; Wind(M2) =&gt; Temp (Y)

# PROCESS(airquality, y="Temp", x="Solar.R",
#         meds=c("Ozone", "Wind"),
#         med.type="serial", ci="boot", nsim=1000, seed=1)

model0 = "
Ozone ~ a1*Solar.R
Wind ~ a2*Solar.R + d12*Ozone
Temp ~ c.*Solar.R + b1*Ozone + b2*Wind
Indirect_All := a1*b1 + a2*b2 + a1*d12*b2
Ind_X_M1_Y := a1*b1
Ind_X_M2_Y := a2*b2
Ind_X_M1_M2_Y := a1*d12*b2
Direct := c.
Total := c. + a1*b1 + a2*b2 + a1*d12*b2
"
lv0 = lavaan::sem(model=model0, data=airquality)
lavaan::summary(lv0, fit.measure=TRUE, ci=TRUE, nd=3)  # raw output
lavaan_summary(lv0)
# lavaan_summary(lv0, ci="boot", nsim=1000, seed=1)

model1 = "
Ozone ~ a1*Solar.R
Wind ~ d12*Ozone
Temp ~ c.*Solar.R + b1*Ozone + b2*Wind
Indirect_All := a1*b1 + a1*d12*b2
Ind_X_M1_Y := a1*b1
Ind_X_M1_M2_Y := a1*d12*b2
Direct := c.
Total := c. + a1*b1 + a1*d12*b2
"
lv1 = lavaan::sem(model=model1, data=airquality)
lavaan::summary(lv1, fit.measure=TRUE, ci=TRUE, nd=3)  # raw output
lavaan_summary(lv1)
# lavaan_summary(lv1, ci="boot", nsim=1000, seed=1)

</code></pre>

<hr>
<h2 id='LOOKUP'>Search, match, and look up values (like Excel's functions <code>INDEX + MATCH</code>).</h2><span id='topic+LOOKUP'></span>

<h3>Description</h3>

<p>In Excel, we can use <code>VLOOKUP</code>, <code>HLOOKUP</code>, <code>XLOOKUP</code> (a new function released in 2019),
or the combination of <code>INDEX</code> and <code>MATCH</code> to search, match, and look up values.
Here I provide a similar function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LOOKUP(
  data,
  vars,
  data.ref,
  vars.ref,
  vars.lookup,
  return = c("new.data", "new.var", "new.value")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LOOKUP_+3A_data">data</code></td>
<td>
<p>Main data.</p>
</td></tr>
<tr><td><code id="LOOKUP_+3A_vars">vars</code></td>
<td>
<p>Character (vector), specifying the variable(s) to be searched in <code>data</code>.</p>
</td></tr>
<tr><td><code id="LOOKUP_+3A_data.ref">data.ref</code></td>
<td>
<p>Reference data containing both the reference variable(s) and the lookup variable(s).</p>
</td></tr>
<tr><td><code id="LOOKUP_+3A_vars.ref">vars.ref</code></td>
<td>
<p>Character (vector), with the <strong>same length and order</strong> as <code>vars</code>,
specifying the reference variable(s) to be matched in <code>data.ref</code>.</p>
</td></tr>
<tr><td><code id="LOOKUP_+3A_vars.lookup">vars.lookup</code></td>
<td>
<p>Character (vector), specifying the variable(s) to be looked up and returned from <code>data.ref</code>.</p>
</td></tr>
<tr><td><code id="LOOKUP_+3A_return">return</code></td>
<td>
<p>What to return. Default (<code>"new.data"</code>) is to return a data frame with the lookup values added.
You may also set it to <code>"new.var"</code> or <code>"new.value"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If multiple values were simultaneously matched, a warning message would be printed.
</p>


<h3>Value</h3>

<p>New data object, new variable, or new value (see the argument <code>return</code>).
</p>


<h3>See Also</h3>

<p><code><a href="dplyr.html#topic+mutate-joins">dplyr::left_join()</a></code>
</p>
<p><a href="https://www.excel-university.com/xlookup/">XLOOKUP: Excel University</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ref = data.table(City=rep(c("A", "B", "C"), each=5),
                 Year=rep(2013:2017, times=3),
                 GDP=sample(1000:2000, 15),
                 PM2.5=sample(10:300, 15))
ref

data = data.table(sub=1:5,
                  city=c("A", "A", "B", "C", "C"),
                  year=c(2013, 2014, 2015, 2016, 2017))
data

LOOKUP(data, c("city", "year"), ref, c("City", "Year"), "GDP")
LOOKUP(data, c("city", "year"), ref, c("City", "Year"), c("GDP", "PM2.5"))

</code></pre>

<hr>
<h2 id='MANOVA'>Multi-factor ANOVA.</h2><span id='topic+MANOVA'></span>

<h3>Description</h3>

<p>Multi-factor ANOVA (between-subjects, within-subjects, and mixed designs),
with and without covariates (ANCOVA).
</p>
<p>This function is based on and extends <code><a href="afex.html#topic+aov_car">afex::aov_ez()</a></code>.
You only need to specify the data, dependent variable(s), and factors
(between-subjects and/or within-subjects).
Almost all results you need will be displayed together,
including effect sizes (partial <code class="reqn">\eta^2</code>) and their confidence intervals (CIs).
90% CIs for partial <code class="reqn">\eta^2</code> (two-sided) are reported, following Steiger (2004).
In addition to partial <code class="reqn">\eta^2</code>, it also reports generalized <code class="reqn">\eta^2</code>, following Olejnik &amp; Algina (2003).
</p>
<p>How to prepare your data and specify the arguments of <code>MANOVA</code>?
</p>

<ul>
<li> <p><strong>Wide-format data</strong> (one person in one row, and repeated measures in multiple columns):
</p>

<dl>
<dt>Betweem-subjects design</dt><dd><p><code>MANOVA(data=, dv=, between=, ...)</code></p>
</dd>
<dt>Within-subjects design</dt><dd><p><code>MANOVA(data=, dvs=, dvs.pattern=, within=, ...)</code></p>
</dd>
<dt>Mixed design</dt><dd><p><code>MANOVA(data=, dvs=, dvs.pattern=, between=, within=, ...)</code></p>
</dd>
</dl>

</li>
<li> <p><strong>Long-format data</strong> (one person in multiple rows, and repeated measures in one column):
</p>

<dl>
<dt>Betweem-subjects design</dt><dd><p>(not applicable)</p>
</dd>
<dt>Within-subjects design</dt><dd><p><code>MANOVA(data=, subID=, dv=, within=, ...)</code></p>
</dd>
<dt>Mixed design</dt><dd><p><code>MANOVA(data=, subID=, dv=, between=, within=, ...)</code></p>
</dd>
</dl>

</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>MANOVA(
  data,
  subID = NULL,
  dv = NULL,
  dvs = NULL,
  dvs.pattern = NULL,
  between = NULL,
  within = NULL,
  covariate = NULL,
  ss.type = "III",
  sph.correction = "none",
  aov.include = FALSE,
  digits = 3,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MANOVA_+3A_data">data</code></td>
<td>
<p>Data frame. Both <strong>wide-format</strong> and <strong>long-format</strong> are supported.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_subid">subID</code></td>
<td>
<p>Subject ID (the column name). Only necessary for <strong>long-format</strong> data.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_dv">dv</code></td>
<td>
<p>Dependent variable.
</p>

<ul>
<li><p> For <strong>wide-format</strong> data, <code>dv</code> only can be used for between-subjects designs.
For within-subjects and mixed designs, please use <code>dvs</code> and <code>dvs.pattern</code>.
</p>
</li>
<li><p> For <strong>long-format</strong> data, <code>dv</code> is the outcome variable.
</p>
</li></ul>
</td></tr>
<tr><td><code id="MANOVA_+3A_dvs">dvs</code></td>
<td>
<p>Repeated measures. Only for <strong>wide-format</strong> data (within-subjects or mixed designs).
</p>
<p>Can be:
</p>

<ul>
<li> <p><code>"start:stop"</code> to specify the range of variables
(sensitive to the order of variables):
</p>
<p>e.g., <code>"A1B1:A2B3"</code> is matched to all variables in the data
between <code>"A1B1"</code> and <code>"A2B3"</code>
</p>
</li>
<li><p> a character vector to directly specify variables
(insensitive to the order of variables):
</p>
<p>e.g., <code>c("Cond1", "Cond2", "Cond3")</code> or <code>cc("Cond1, Cond2, Cond3")</code>
</p>
<p>See <code><a href="#topic+cc">cc</a></code> for its usage.
</p>
</li></ul>
</td></tr>
<tr><td><code id="MANOVA_+3A_dvs.pattern">dvs.pattern</code></td>
<td>
<p>If you use <code>dvs</code>, you should also specify the pattern of variable names
using <em>regular expression</em>.
</p>
<p>Examples:
</p>

<ul>
<li> <p><code>"Cond(.)"</code> extracts levels from <code>"Cond1", "Cond2", "Cond3", ...</code>
You may rename the factor using the <code>within</code> argument (e.g., <code>within="Condition"</code>)
</p>
</li>
<li> <p><code>"X(..)Y(..)"</code> extracts levels from <code>"X01Y01", "X02Y02", "XaaYbc", ...</code>
</p>
</li>
<li> <p><code>"X(.+)Y(.+)"</code> extracts levels from <code>"X1Y1", "XaYb", "XaY002", ...</code>
</p>
</li></ul>

<p>Tips on regular expression:
</p>

<ul>
<li> <p><code>"(.)"</code> extracts any single character (number, letter, and other symbols)
</p>
</li>
<li> <p><code>"(.+)"</code> extracts &gt;= 1 character(s)
</p>
</li>
<li> <p><code>"(.*)"</code> extracts &gt;= 0 character(s)
</p>
</li>
<li> <p><code>"([0-9])"</code> extracts any single number
</p>
</li>
<li> <p><code>"([a-z])"</code> extracts any single letter
</p>
</li>
<li><p> More information: <a href="https://regexr.com/">Link 1 (in English)</a> and
<a href="https://www.jb51.net/shouce/jquery1.82/regexp.html">Link 2 (in Chinese)</a>
</p>
</li></ul>
</td></tr>
<tr><td><code id="MANOVA_+3A_between">between</code></td>
<td>
<p>Between-subjects factor(s). Multiple variables should be included in a character vector <code>c()</code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_within">within</code></td>
<td>
<p>Within-subjects factor(s). Multiple variables should be included in a character vector <code>c()</code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_covariate">covariate</code></td>
<td>
<p>Covariates. Multiple variables should be included in a character vector <code>c()</code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_ss.type">ss.type</code></td>
<td>
<p>Type of sums of squares (SS) for ANOVA. Defaults to <code>"III"</code>.
Possible values are <code>"II"</code>, <code>"III"</code>, <code>2</code>, or <code>3</code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_sph.correction">sph.correction</code></td>
<td>
<p>[Only for repeated measures with &gt;= 3 levels]
</p>
<p>Sphericity correction method for adjusting the degrees of freedom (<em>df</em>) when the sphericity assumption is violated. Defaults to <code>"none"</code>.
If Mauchly's test of sphericity is significant, you may set it to <code>"GG"</code> (Greenhouse-Geisser) or <code>"HF"</code> (Huynh-Feldt).</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_aov.include">aov.include</code></td>
<td>
<p>Include the <code>aov</code> object in the returned object?
Defaults to <code>FALSE</code>, as suggested by <code><a href="afex.html#topic+aov_car">afex::aov_ez()</a></code>
(please see the <code>include_aov</code> argument in this help page, which provides a detailed explanation).
If <code>TRUE</code>, you should also specify <code>model.type="univariate"</code> in <code><a href="#topic+EMMEANS">EMMEANS</a></code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="MANOVA_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If observations are not uniquely identified in user-defined long-format data,
the function takes averages across those multiple observations for each case.
In technical details, it specifies <code>fun_aggregate=mean</code> in <code><a href="afex.html#topic+aov_car">afex::aov_ez()</a></code>
and <code>values_fn=mean</code> in <code><a href="tidyr.html#topic+pivot_wider">tidyr::pivot_wider()</a></code>.
</p>


<h3>Value</h3>

<p>A result object (list) returned by
<code><a href="afex.html#topic+aov_car">afex::aov_ez()</a></code>,
along with several other elements:
<code>between</code>, <code>within</code>,
<code>data.wide</code>, <code>data.long</code>.
</p>


<h3>Interaction Plot</h3>

<p>You can save the returned object and use the <code><a href="emmeans.html#topic+emmip">emmeans::emmip()</a></code> function
to create an interaction plot (based on the fitted model and a formula specification).
For usage, please see the help page of <code><a href="emmeans.html#topic+emmip">emmeans::emmip()</a></code>.
It returns an object of class <code>ggplot</code>, which can be easily modified and saved using <code>ggplot2</code> syntax.
</p>


<h3>References</h3>

<p>Olejnik, S., &amp; Algina, J. (2003). Generalized eta and omega squared statistics: Measures of effect size for some common research designs.
<em>Psychological Methods, 8</em>(4), 434&ndash;447.
</p>
<p>Steiger, J. H. (2004). Beyond the F test: Effect size confidence intervals and tests of close fit in the analysis of variance and contrast analysis.
<em>Psychological Methods, 9</em>(2), 164&ndash;182.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TTEST">TTEST</a></code>, <code><a href="#topic+EMMEANS">EMMEANS</a></code>, <code><a href="#topic+bruceR-demodata">bruceR-demodata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Between-Subjects Design ####

between.1
MANOVA(between.1, dv="SCORE", between="A")

between.2
MANOVA(between.2, dv="SCORE", between=c("A", "B"))

between.3
MANOVA(between.3, dv="SCORE", between=c("A", "B", "C"))

## How to create an interaction plot using `emmeans::emmip()`?
## See help page for its usage: ?emmeans::emmip()
m = MANOVA(between.2, dv="SCORE", between=c("A", "B"))
emmip(m, ~ A | B, CIs=TRUE)
emmip(m, ~ B | A, CIs=TRUE)
emmip(m, B ~ A, CIs=TRUE)
emmip(m, A ~ B, CIs=TRUE)


#### Within-Subjects Design ####

within.1
MANOVA(within.1, dvs="A1:A4", dvs.pattern="A(.)",
       within="A")
## the same:
MANOVA(within.1, dvs=c("A1", "A2", "A3", "A4"), dvs.pattern="A(.)",
       within="MyFactor")  # renamed the within-subjects factor

within.2
MANOVA(within.2, dvs="A1B1:A2B3", dvs.pattern="A(.)B(.)",
       within=c("A", "B"))

within.3
MANOVA(within.3, dvs="A1B1C1:A2B2C2", dvs.pattern="A(.)B(.)C(.)",
       within=c("A", "B", "C"))


#### Mixed Design ####

mixed.2_1b1w
MANOVA(mixed.2_1b1w, dvs="B1:B3", dvs.pattern="B(.)",
       between="A", within="B")
MANOVA(mixed.2_1b1w, dvs="B1:B3", dvs.pattern="B(.)",
       between="A", within="B", sph.correction="GG")

mixed.3_1b2w
MANOVA(mixed.3_1b2w, dvs="B1C1:B2C2", dvs.pattern="B(.)C(.)",
       between="A", within=c("B", "C"))

mixed.3_2b1w
MANOVA(mixed.3_2b1w, dvs="B1:B2", dvs.pattern="B(.)",
       between=c("A", "C"), within="B")


#### Other Examples ####

data.new = mixed.3_1b2w
names(data.new) = c("Group", "Cond_01", "Cond_02", "Cond_03", "Cond_04")
MANOVA(data.new,
       dvs="Cond_01:Cond_04",
       dvs.pattern="Cond_(..)",
       between="Group",
       within="Condition")  # rename the factor

# ?afex::obk.long
MANOVA(afex::obk.long,
       subID="id",
       dv="value",
       between=c("treatment", "gender"),
       within=c("phase", "hour"),
       cov="age",
       sph.correction="GG")

</code></pre>

<hr>
<h2 id='med_summary'>Tidy report of mediation analysis.</h2><span id='topic+med_summary'></span>

<h3>Description</h3>

<p>Tidy report of mediation analysis,
which is performed using the <code><a href="mediation.html#topic+mediation">mediation</a></code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>med_summary(model, digits = 3, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="med_summary_+3A_model">model</code></td>
<td>
<p>Mediation model built using <code><a href="mediation.html#topic+mediate">mediation::mediate()</a></code>.</p>
</td></tr>
<tr><td><code id="med_summary_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="med_summary_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a data frame containing the results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PROCESS">PROCESS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

library(mediation)
# ?mediation::mediate

## Example 1: OLS Regression
## Bias-corrected and accelerated (BCa) bootstrap confidence intervals

## Hypothesis: Solar radiation -&gt; Ozone -&gt; Daily temperature
lm.m = lm(Ozone ~ Solar.R + Month + Wind, data=airquality)
lm.y = lm(Temp ~ Ozone + Solar.R + Month + Wind, data=airquality)
set.seed(123)  # set a random seed for reproduction
med = mediate(lm.m, lm.y,
            treat="Solar.R", mediator="Ozone",
            sims=1000, boot=TRUE, boot.ci.type="bca")
med_summary(med)

## Example 2: Multilevel Linear Model (Linear Mixed Model)
## (models must be fit using "lme4::lmer" rather than "lmerTest::lmer")
## Monte Carlo simulation (quasi-Bayesian approximation)
## (bootstrap method is not applicable to "lmer" models)

## Hypothesis: Crips -&gt; Sweetness -&gt; Preference (for carrots)
data = lmerTest::carrots  # long-format data
data = na.omit(data)  # omit missing values
lmm.m = lme4::lmer(Sweetness ~ Crisp + Gender + Age + (1 | Consumer), data=data)
lmm.y = lme4::lmer(Preference ~ Sweetness + Crisp + Gender + Age + (1 | Consumer), data=data)
set.seed(123)  # set a random seed for reproduction
med.lmm = mediate(lmm.m, lmm.y,
                  treat="Crisp", mediator="Sweetness",
                  sims=1000)
med_summary(med.lmm)

## End(Not run)

</code></pre>

<hr>
<h2 id='model_summary'>Tidy report of regression models.</h2><span id='topic+model_summary'></span>

<h3>Description</h3>

<p>Tidy report of regression models (most model types are supported).
This function uses:
</p>

<ul>
<li> <p><code><a href="texreg.html#topic+screenreg">texreg::screenreg()</a></code>
</p>
</li>
<li> <p><code><a href="texreg.html#topic+htmlreg">texreg::htmlreg()</a></code>
</p>
</li>
<li> <p><code><a href="MuMIn.html#topic+std.coef">MuMIn::std.coef()</a></code>
</p>
</li>
<li> <p><code><a href="MuMIn.html#topic+r.squaredGLMM">MuMIn::r.squaredGLMM()</a></code>
</p>
</li>
<li> <p><code><a href="performance.html#topic+r2_mcfadden">performance::r2_mcfadden()</a></code>
</p>
</li>
<li> <p><code><a href="performance.html#topic+r2_nagelkerke">performance::r2_nagelkerke()</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>model_summary(
  model.list,
  std = FALSE,
  digits = 3,
  file = NULL,
  check = TRUE,
  zero = ifelse(std, FALSE, TRUE),
  modify.se = NULL,
  modify.head = NULL,
  line = TRUE,
  bold = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_summary_+3A_model.list">model.list</code></td>
<td>
<p>A single model or a list of (various types of) models.
Most types of regression models are supported!</p>
</td></tr>
<tr><td><code id="model_summary_+3A_std">std</code></td>
<td>
<p>Standardized coefficients? Defaults to <code>FALSE</code>.
Only applicable to linear models and linear mixed models.
Not applicable to generalized linear (mixed) models.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="model_summary_+3A_check">check</code></td>
<td>
<p>If there is only one model in <code>model.list</code>, it checks for multicollinearity
using <code><a href="performance.html#topic+check_collinearity">performance::check_collinearity()</a></code>.
You may turn it off by setting <code>check=FALSE</code>.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_zero">zero</code></td>
<td>
<p>Display &quot;0&quot; before &quot;.&quot;? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_modify.se">modify.se</code></td>
<td>
<p>Replace standard errors.
Useful if you need to replace raw SEs with robust SEs.
New SEs should be provided as a list of numeric vectors.
See usage in <code><a href="texreg.html#topic+screenreg">texreg::screenreg()</a></code>.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_modify.head">modify.head</code></td>
<td>
<p>Replace model names.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_line">line</code></td>
<td>
<p>Lines look like true line (<code>TRUE</code>) or <code>=== --- ===</code> (<code>FALSE</code>).
Only relevant to R Console output.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_bold">bold</code></td>
<td>
<p>The <em>p</em>-value threshold below which the coefficients will be formatted in bold.</p>
</td></tr>
<tr><td><code id="model_summary_+3A_...">...</code></td>
<td>
<p>Other arguments passed to
<code><a href="texreg.html#topic+screenreg">texreg::screenreg()</a></code> or
<code><a href="texreg.html#topic+htmlreg">texreg::htmlreg()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return the output (character string).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print_table">print_table</a></code> (print simple table)
</p>
<p><code><a href="#topic+GLM_summary">GLM_summary</a></code>
</p>
<p><code><a href="#topic+HLM_summary">HLM_summary</a></code>
</p>
<p><code><a href="#topic+med_summary">med_summary</a></code>
</p>
<p><code><a href="#topic+lavaan_summary">lavaan_summary</a></code>
</p>
<p><code><a href="#topic+PROCESS">PROCESS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Example 1: Linear Model ####
lm1 = lm(Temp ~ Month + Day, data=airquality)
lm2 = lm(Temp ~ Month + Day + Wind + Solar.R, data=airquality)
model_summary(lm1)
model_summary(lm2)
model_summary(list(lm1, lm2))
model_summary(list(lm1, lm2), std=TRUE, digits=2)
model_summary(list(lm1, lm2), file="OLS Models.doc")
unlink("OLS Models.doc")  # delete file for code check

#### Example 2: Generalized Linear Model ####
glm1 = glm(case ~ age + parity,
           data=infert, family=binomial)
glm2 = glm(case ~ age + parity + education + spontaneous + induced,
           data=infert, family=binomial)
model_summary(list(glm1, glm2))  # "std" is not applicable to glm
model_summary(list(glm1, glm2), file="GLM Models.doc")
unlink("GLM Models.doc")  # delete file for code check

#### Example 3: Linear Mixed Model ####
library(lmerTest)
hlm1 = lmer(Reaction ~ (1 | Subject), data=sleepstudy)
hlm2 = lmer(Reaction ~ Days + (1 | Subject), data=sleepstudy)
hlm3 = lmer(Reaction ~ Days + (Days | Subject), data=sleepstudy)
model_summary(list(hlm1, hlm2, hlm3))
model_summary(list(hlm1, hlm2, hlm3), std=TRUE)
model_summary(list(hlm1, hlm2, hlm3), file="HLM Models.doc")
unlink("HLM Models.doc")  # delete file for code check

#### Example 4: Generalized Linear Mixed Model ####
library(lmerTest)
data.glmm = MASS::bacteria
glmm1 = glmer(y ~ trt + week + (1 | ID), data=data.glmm, family=binomial)
glmm2 = glmer(y ~ trt + week + hilo + (1 | ID), data=data.glmm, family=binomial)
model_summary(list(glmm1, glmm2))  # "std" is not applicable to glmm
model_summary(list(glmm1, glmm2), file="GLMM Models.doc")
unlink("GLMM Models.doc")  # delete file for code check

#### Example 5: Multinomial Logistic Model ####
library(nnet)
d = airquality
d$Month = as.factor(d$Month)  # Factor levels: 5, 6, 7, 8, 9
mn1 = multinom(Month ~ Temp, data=d, Hess=TRUE)
mn2 = multinom(Month ~ Temp + Wind + Ozone, data=d, Hess=TRUE)
model_summary(mn1)
model_summary(mn2)
model_summary(mn2, file="Multinomial Logistic Model.doc")
unlink("Multinomial Logistic Model.doc")  # delete file for code check

</code></pre>

<hr>
<h2 id='p'>Compute <em>p</em> value.</h2><span id='topic+p'></span><span id='topic+p.z'></span><span id='topic+p.t'></span><span id='topic+p.f'></span><span id='topic+p.r'></span><span id='topic+p.chi2'></span>

<h3>Description</h3>

<p>Compute <em>p</em> value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p(
  z = NULL,
  t = NULL,
  f = NULL,
  r = NULL,
  chi2 = NULL,
  n = NULL,
  df = NULL,
  df1 = NULL,
  df2 = NULL,
  digits = 2
)

p.z(z)

p.t(t, df)

p.f(f, df1, df2)

p.r(r, n)

p.chi2(chi2, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p_+3A_z">z</code>, <code id="p_+3A_t">t</code>, <code id="p_+3A_f">f</code>, <code id="p_+3A_r">r</code>, <code id="p_+3A_chi2">chi2</code></td>
<td>
<p><em>z</em>, <em>t</em>, <em>F</em>, <em>r</em>, <code class="reqn">\chi</code>^2 value.</p>
</td></tr>
<tr><td><code id="p_+3A_n">n</code>, <code id="p_+3A_df">df</code>, <code id="p_+3A_df1">df1</code>, <code id="p_+3A_df2">df2</code></td>
<td>
<p>Sample size or degree of freedom.</p>
</td></tr>
<tr><td><code id="p_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><em>p</em> value statistics.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>p.z()</code>: Two-tailed <em>p</em> value of <em>z</em>.
</p>
</li>
<li> <p><code>p.t()</code>: Two-tailed <em>p</em> value of <em>t</em>.
</p>
</li>
<li> <p><code>p.f()</code>: One-tailed <em>p</em> value of <em>F</em>. (Note: <em>F</em> test is one-tailed only.)
</p>
</li>
<li> <p><code>p.r()</code>: Two-tailed <em>p</em> value of <em>r</em>.
</p>
</li>
<li> <p><code>p.chi2()</code>: One-tailed <em>p</em> value of <code class="reqn">\chi</code>^2. (Note: <code class="reqn">\chi</code>^2 test is one-tailed only.)
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>p.z(1.96)
p.t(2, 100)
p.f(4, 1, 100)
p.r(0.2, 100)
p.chi2(3.84, 1)

p(z=1.96)
p(t=2, df=100)
p(f=4, df1=1, df2=100)
p(r=0.2, n=100)
p(chi2=3.84, df=1)

</code></pre>

<hr>
<h2 id='pkg_depend'>Check dependencies of R packages.</h2><span id='topic+pkg_depend'></span>

<h3>Description</h3>

<p>Check dependencies of R packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_depend(pkgs, excludes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkg_depend_+3A_pkgs">pkgs</code></td>
<td>
<p>Package(s).</p>
</td></tr>
<tr><td><code id="pkg_depend_+3A_excludes">excludes</code></td>
<td>
<p>[Optional] Package(s) and their dependencies excluded from the dependencies of <code>pkgs</code>.
Useful if you want to see the unique dependencies of <code>pkgs</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of package names.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pkg_install_suggested">pkg_install_suggested</a></code>
</p>

<hr>
<h2 id='pkg_install_suggested'>Install suggested R packages.</h2><span id='topic+pkg_install_suggested'></span>

<h3>Description</h3>

<p>Install suggested R packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg_install_suggested(by)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkg_install_suggested_+3A_by">by</code></td>
<td>
<p>Suggested by which package?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pkg_depend">pkg_depend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

pkg_install_suggested()  # install all packages suggested by me

## End(Not run)

</code></pre>

<hr>
<h2 id='Print'>Print strings with rich formats and colors.</h2><span id='topic+Print'></span><span id='topic+Glue'></span>

<h3>Description</h3>

<p>Be frustrated with <code>print()</code> and <code>cat()</code>? Try <code>Print()</code>!
Run examples to see what it can do.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Print(...)

Glue(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Print_+3A_...">...</code></td>
<td>
<p>Character strings enclosed by <code>"{ }"</code> will be evaluated as R code.
</p>
<p>Character strings enclosed by <code>"&lt;&lt; &gt;&gt;"</code> will be printed as formatted and colored text.
</p>
<p>Long strings are broken by line and concatenated together.
</p>
<p>Leading whitespace and blank lines from the first and last lines are automatically trimmed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible formats/colors that can be used in <code>"&lt;&lt; &gt;&gt;"</code> include:
</p>
<p>(1) bold, italic, underline, reset, blurred, inverse, hidden, strikethrough;
</p>
<p>(2) black, white, silver, red, green, blue, yellow, cyan, magenta;
</p>
<p>(3) bgBlack, bgWhite, bgRed, bgGreen, bgBlue, bgYellow, bgCyan, bgMagenta.
</p>
<p>See more details in <code><a href="glue.html#topic+glue">glue::glue()</a></code> and <code><a href="glue.html#topic+glue">glue::glue_col()</a></code>.
</p>


<h3>Value</h3>

<p>Formatted text.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>Print()</code>: Paste and print strings.
</p>
</li>
<li> <p><code>Glue()</code>: Paste strings.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>name = "Bruce"
Print("My name is &lt;&lt;underline &lt;&lt;bold {name}&gt;&gt;&gt;&gt;.
       &lt;&lt;bold &lt;&lt;blue Pi = {pi:.15}.&gt;&gt;&gt;&gt;
       &lt;&lt;italic &lt;&lt;green 1 + 1 = {1 + 1}.&gt;&gt;&gt;&gt;
       sqrt({x}) = &lt;&lt;red {sqrt(x):.3}&gt;&gt;", x=10)

</code></pre>

<hr>
<h2 id='print_table'>Print a three-line table (to R Console and Microsoft Word).</h2><span id='topic+print_table'></span>

<h3>Description</h3>

<p>This basic function prints any data frame as a three-line table
to either R Console or Microsoft Word (.doc).
It has been used in many other functions of <code>bruceR</code> (see below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_table(
  x,
  digits = 3,
  nspaces = 1,
  row.names = TRUE,
  col.names = TRUE,
  title = "",
  note = "",
  append = "",
  line = TRUE,
  file = NULL,
  file.align.head = "auto",
  file.align.text = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_table_+3A_x">x</code></td>
<td>
<p>Matrix, data.frame (or data.table), or any model object (e.g., <code>lm, glm, lmer, glmer, ...</code>).</p>
</td></tr>
<tr><td><code id="print_table_+3A_digits">digits</code></td>
<td>
<p>Numeric vector specifying the number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="print_table_+3A_nspaces">nspaces</code></td>
<td>
<p>Number of whitespaces between columns. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="print_table_+3A_row.names">row.names</code>, <code id="print_table_+3A_col.names">col.names</code></td>
<td>
<p>Print row/column names. Defaults to <code>TRUE</code> (column names are always printed).
To modify the names, you can use a character vector with the same length as the raw names.</p>
</td></tr>
<tr><td><code id="print_table_+3A_title">title</code></td>
<td>
<p>Title text, which will be inserted in &lt;p&gt;&lt;/p&gt; (HTML code).</p>
</td></tr>
<tr><td><code id="print_table_+3A_note">note</code></td>
<td>
<p>Note text, which will be inserted in &lt;p&gt;&lt;/p&gt; (HTML code).</p>
</td></tr>
<tr><td><code id="print_table_+3A_append">append</code></td>
<td>
<p>Other contents, which will be appended in the end (HTML code).</p>
</td></tr>
<tr><td><code id="print_table_+3A_line">line</code></td>
<td>
<p>Lines looks like true line (<code>TRUE</code>) or <code>=== --- ===</code> (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="print_table_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
<tr><td><code id="print_table_+3A_file.align.head">file.align.head</code>, <code id="print_table_+3A_file.align.text">file.align.text</code></td>
<td>
<p>Alignment of table head or table text:
<code>"left"</code>, <code>"right"</code>, <code>"center"</code>.
Either one value of them OR a character vector of mixed values
with the same length as the table columns.
Default alignment (if set as <code>"auto"</code>):
left, right, right, ..., right.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return a list of data frame and HTML code.
</p>


<h3>See Also</h3>

<p>These functions have implemented MS Word file output using this function:
</p>

<ul>
<li> <p><code><a href="#topic+Describe">Describe</a></code>
</p>
</li>
<li> <p><code><a href="#topic+Freq">Freq</a></code>
</p>
</li>
<li> <p><code><a href="#topic+Corr">Corr</a></code>
</p>
</li>
<li> <p><code><a href="#topic+EFA">EFA</a></code> / <code><a href="#topic+PCA">PCA</a></code>
</p>
</li>
<li> <p><code><a href="#topic+CFA">CFA</a></code>
</p>
</li>
<li> <p><code><a href="#topic+TTEST">TTEST</a></code>
</p>
</li>
<li> <p><code><a href="#topic+MANOVA">MANOVA</a></code>
</p>
</li>
<li> <p><code><a href="#topic+model_summary">model_summary</a></code>
</p>
</li>
<li> <p><code><a href="#topic+med_summary">med_summary</a></code>
</p>
</li>
<li> <p><code><a href="#topic+lavaan_summary">lavaan_summary</a></code>
</p>
</li>
<li> <p><code><a href="#topic+PROCESS">PROCESS</a></code>
</p>
</li>
<li> <p><code><a href="#topic+granger_test">granger_test</a></code>
</p>
</li>
<li> <p><code><a href="#topic+granger_causality">granger_causality</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>print_table(data.frame(x=1))

print_table(airquality, file="airquality.doc")
unlink("airquality.doc")  # delete file for code check

model = lm(Temp ~ Month + Day + Wind + Solar.R, data=airquality)
print_table(model)
print_table(model, file="model.doc")
unlink("model.doc")  # delete file for code check

</code></pre>

<hr>
<h2 id='PROCESS'>PROCESS for mediation and/or moderation analyses.</h2><span id='topic+PROCESS'></span>

<h3>Description</h3>

<p>To perform mediation, moderation, and conditional process (moderated mediation) analyses,
people may use software like
<a href="http://www.statmodel.com/index.shtml">Mplus</a>,
<a href="https://www.processmacro.org/index.html">SPSS &quot;PROCESS&quot; macro</a>,
and <a href="https://njrockwood.com/mlmed/">SPSS &quot;MLmed&quot; macro</a>.
Some R packages can also perform such analyses separately and in a complex way, including
<a href="mediation.html#topic+mediate">R package &quot;mediation&quot;</a>,
<a href="interactions.html#topic+sim_slopes">R package &quot;interactions&quot;</a>,
and <a href="lavaan.html#topic+lavaan-class">R package &quot;lavaan&quot;</a>.
Some other R packages or scripts/modules have been further developed to improve the convenience, including
<a href="https://jamovi-amm.github.io/">jamovi module &quot;jAMM&quot;</a> (by <em>Marcello Gallucci</em>, based on the <code>lavaan</code> package),
<a href="https://CRAN.R-project.org/package=processR">R package &quot;processR&quot;</a> (by <em>Keon-Woong Moon</em>, not official, also based on the <code>lavaan</code> package),
and <a href="https://www.processmacro.org/download.html">R script file &quot;process.R&quot;</a>
(the official PROCESS R code by <em>Andrew F. Hayes</em>, but it is not yet an R package and has some bugs and limitations).
</p>
<p>Here, the <code><a href="#topic+PROCESS">bruceR::PROCESS()</a></code> function provides
an alternative to performing mediation/moderation analyses in R.
This function supports a total of <strong>24</strong> kinds of SPSS PROCESS models (Hayes, 2018)
and also supports multilevel mediation/moderation analyses.
Overall, it supports the most frequently used types of mediation, moderation,
moderated moderation (3-way interaction), and moderated mediation (conditional indirect effect) analyses
for <strong>(generalized) linear or linear mixed models</strong>.
</p>
<p>Specifically, the <code><a href="#topic+PROCESS">bruceR::PROCESS()</a></code> function
fits regression models based on the data, variable names, and a few other arguments
that users input (with <strong>no need to</strong> specify the PROCESS model number and <strong>no need to</strong> manually mean-center the variables).
The function can automatically judge the model number/type and also conduct grand-mean centering before model building
(using the <code><a href="#topic+grand_mean_center">bruceR::grand_mean_center()</a></code> function).
</p>
<p>This automatic grand-mean centering can be turned off by setting <code>center=FALSE</code>.
</p>
<p>Note that this automatic grand-mean centering
(1) makes the results of main effects accurate for interpretation;
(2) does not change any results of model fit (it only affects the interpretation of main effects);
(3) is only conducted in &quot;PART 1&quot; (for an accurate estimate of main effects) but not in &quot;PART 2&quot; because
it is more intuitive and interpretable to use the raw values of variables for the simple-slope tests in &quot;PART 2&quot;;
(4) is not optional to users because mean-centering should always be done when there is an interaction;
(5) is not conflicted with group-mean centering because after group-mean centering the grand mean of a variable will also be 0,
such that the automatic grand-mean centering (with mean = 0) will not change any values of the variable.
</p>
<p>If you need to do group-mean centering, please do this before using PROCESS.
<code><a href="#topic+group_mean_center">bruceR::group_mean_center()</a></code> is a useful function of group-mean centering.
Remember that the automatic grand-mean centering in PROCESS never affects the values of a group-mean centered variable, which already has a grand mean of 0.
</p>
<p>The <code><a href="#topic+PROCESS">bruceR::PROCESS()</a></code> function uses:
</p>

<ol>
<li><p> the <code><a href="interactions.html#topic+sim_slopes">interactions::sim_slopes()</a></code> function to
estimate simple slopes (and conditional direct effects) in moderation, moderated moderation, and moderated mediation models
(PROCESS Models 1, 2, 3, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 58, 59, 72, 73, 75, 76).
</p>
</li>
<li><p> the <code><a href="mediation.html#topic+mediate">mediation::mediate()</a></code> function to
estimate (conditional) indirect effects in (moderated) mediation models
(PROCESS Models 4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 58, 59, 72, 73, 75, 76).
</p>
</li>
<li><p> the <code><a href="lavaan.html#topic+sem">lavaan::sem()</a></code> function to perform serial multiple mediation analysis (PROCESS Model 6).
</p>
</li></ol>

<p>If you use this function in your research and report its results in your paper, please cite not only <code>bruceR</code> but also
the other R packages it uses internally (<code>mediation</code>, <code>interactions</code>, and/or <code>lavaan</code>).
</p>
<p>Two parts of results are printed:
</p>
<p>PART 1. Regression model summary (using <code><a href="#topic+model_summary">bruceR::model_summary()</a></code> to summarize the models)
</p>
<p>PART 2. Mediation/moderation effect estimates (using one or a combination of the above packages and functions to estimate the effects)
</p>
<p>To organize the PART 2 output, the results of <strong>Simple Slopes</strong> are titled in <strong>green</strong>,
whereas the results of <strong>Indirect Path</strong> are titled in <strong>blue</strong>.
</p>
<p><strong><em>Disclaimer</em>:</strong>
Although this function is named after <code>PROCESS</code>, Andrew F. Hayes has no role in its design, and
its development is independent from the official SPSS PROCESS macro and &quot;process.R&quot; script.
Any error or limitation should be attributed to the three R packages/functions that <code>bruceR::PROCESS()</code> uses internally.
Moreover, as mediation analyses include <em>random processes</em> (i.e., bootstrap resampling or Monte Carlo simulation),
the results of mediation analyses are <em>unlikely</em> to be exactly the same across different software
(even if you set the same random seed in different software).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PROCESS(
  data,
  y = "",
  x = "",
  meds = c(),
  mods = c(),
  covs = c(),
  clusters = c(),
  hlm.re.m = "",
  hlm.re.y = "",
  hlm.type = c("1-1-1", "2-1-1", "2-2-1"),
  med.type = c("parallel", "serial"),
  mod.type = c("2-way", "3-way"),
  mod.path = c("x-y", "x-m", "m-y", "all"),
  cov.path = c("y", "m", "both"),
  mod1.val = NULL,
  mod2.val = NULL,
  ci = c("boot", "bc.boot", "bca.boot", "mcmc"),
  nsim = 100,
  seed = NULL,
  center = TRUE,
  std = FALSE,
  digits = 3,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PROCESS_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_y">y</code>, <code id="PROCESS_+3A_x">x</code></td>
<td>
<p>Variable name of outcome (Y) and predictor (X).
</p>
<p>It supports both continuous (numeric) and dichotomous (factor) variables.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_meds">meds</code></td>
<td>
<p>Variable name(s) of mediator(s) (M).
Use <code>c()</code> to combine multiple mediators.
</p>
<p>It supports both continuous (numeric) and dichotomous (factor) variables.
</p>
<p>It allows an infinite number of mediators in parallel
or 2~4 mediators in serial.
</p>
<p>* Order matters when <code>med.type="serial"</code>
(PROCESS Model 6: serial mediation).</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_mods">mods</code></td>
<td>
<p>Variable name(s) of 0~2 moderator(s) (W).
Use <code>c()</code> to combine multiple moderators.
</p>
<p>It supports all types of variables:
continuous (numeric), dichotomous (factor), and multicategorical (factor).
</p>
<p>* Order matters when <code>mod.type="3-way"</code>
(PROCESS Models 3, 5.3, 11, 12, 18, 19, 72, and 73).
</p>
<p>** Do not set this argument when <code>med.type="serial"</code>
(PROCESS Model 6).</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_covs">covs</code></td>
<td>
<p>Variable name(s) of covariate(s) (i.e., control variables).
Use <code>c()</code> to combine multiple covariates.
It supports all types of (and an infinite number of) variables.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_clusters">clusters</code></td>
<td>
<p>HLM (multilevel) cluster(s):
e.g., <code>"School"</code>, <code>c("Prov", "City")</code>, <code>c("Sub", "Item")</code>.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_hlm.re.m">hlm.re.m</code>, <code id="PROCESS_+3A_hlm.re.y">hlm.re.y</code></td>
<td>
<p>HLM (multilevel) random effect term of M model and Y model.
By default, it converts <code>clusters</code> to <code><a href="lme4.html#topic+lme4-package">lme4</a></code> syntax of random intercepts:
e.g., <code>"(1 | School)"</code> or <code>"(1 | Sub) + (1 | Item)"</code>.
</p>
<p>You may specify these arguments to include more complex terms:
e.g., random slopes <code>"(X | School)"</code>, or 3-level random effects <code>"(1 | Prov/City)"</code>.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_hlm.type">hlm.type</code></td>
<td>
<p>HLM (multilevel) mediation type (levels of &quot;X-M-Y&quot;):
<code>"1-1-1"</code> (default),
<code>"2-1-1"</code> (indeed the same as <code>"1-1-1"</code> in a mixed model),
or <code>"2-2-1"</code> (currently <em>not fully supported</em>, as limited by the <code><a href="mediation.html#topic+mediate">mediation</a></code> package).
In most cases, no need to set this argument.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_med.type">med.type</code></td>
<td>
<p>Type of mediator:
<code>"parallel"</code> (default) or <code>"serial"</code>
(only relevant to PROCESS Model 6).
Partial matches of <code>"p"</code> or <code>"s"</code> also work.
In most cases, no need to set this argument.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_mod.type">mod.type</code></td>
<td>
<p>Type of moderator:
<code>"2-way"</code> (default) or <code>"3-way"</code>
(relevant to PROCESS Models 3, 5.3, 11, 12, 18, 19, 72, and 73).
Partial matches of <code>"2"</code> or <code>"3"</code> also work.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_mod.path">mod.path</code></td>
<td>
<p>Which path(s) do the moderator(s) influence?
<code>"x-y"</code>, <code>"x-m"</code>, <code>"m-y"</code>, or any combination of them
(use <code>c()</code> to combine), or <code>"all"</code> (i.e., all of them).
No default value.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_cov.path">cov.path</code></td>
<td>
<p>Which path(s) do the control variable(s) influence?
<code>"y"</code>, <code>"m"</code>, or <code>"both"</code> (default).</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_mod1.val">mod1.val</code>, <code id="PROCESS_+3A_mod2.val">mod2.val</code></td>
<td>
<p>By default (<code>NULL</code>), it uses
<strong>Mean +/- SD</strong> of a continuous moderator (numeric) or
<strong>all levels</strong> of a dichotomous/multicategorical moderator (factor) to
perform simple slope analyses and/or conditional mediation analyses.
You may manually specify a vector of certain values: e.g.,
<code>mod1.val=c(1, 3, 5)</code> or <code>mod1.val=c("A", "B", "C")</code>.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_ci">ci</code></td>
<td>
<p>Method for estimating the standard error (SE) and
95% confidence interval (CI) of indirect effect(s).
Defaults to <code>"boot"</code> for (generalized) linear models or
<code>"mcmc"</code> for (generalized) linear mixed models (i.e., multilevel models).
</p>

<dl>
<dt><code>"boot"</code></dt><dd><p>Percentile Bootstrap</p>
</dd>
<dt><code>"bc.boot"</code></dt><dd><p>Bias-Corrected Percentile Bootstrap</p>
</dd>
<dt><code>"bca.boot"</code></dt><dd><p>Bias-Corrected and Accelerated (BCa) Percentile Bootstrap</p>
</dd>
<dt><code>"mcmc"</code></dt><dd><p>Markov Chain Monte Carlo (Quasi-Bayesian)</p>
</dd>
</dl>

<p>* Note that these methods <em>never</em> apply to the estimates of simple slopes.
You <em>should not</em> report the 95% CIs of simple slopes as Bootstrap or Monte Carlo CIs,
because they are just standard CIs without any resampling method.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulation samples (bootstrap resampling or Monte Carlo simulation)
for estimating SE and 95% CI. Defaults to <code>100</code> for running examples faster.
In formal analyses, however, <strong><code>nsim=1000</code> (or larger)</strong> is strongly suggested!</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_seed">seed</code></td>
<td>
<p>Random seed for obtaining reproducible results.
Defaults to <code>NULL</code>.
You may set to any number you prefer
(e.g., <code>seed=1234</code>, just an uncountable number).
</p>
<p>* Note that all mediation models include random processes
(i.e., bootstrap resampling or Monte Carlo simulation).
To get exactly the same results between runs, you need to set a random seed.
However, even if you set the same seed number, it is unlikely to
get exactly the same results across different R packages
(e.g., <code><a href="lavaan.html#topic+lavaan-class">lavaan</a></code> vs. <code><a href="mediation.html#topic+mediate">mediation</a></code>)
and software (e.g., SPSS, Mplus, R, jamovi).</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_center">center</code></td>
<td>
<p>Centering numeric (continuous) predictors? Defaults to <code>TRUE</code> (suggested).</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_std">std</code></td>
<td>
<p>Standardizing variables to get standardized coefficients? Defaults to <code>FALSE</code>.
If <code>TRUE</code>, it will standardize all numeric (continuous) variables
before building regression models.
However, it is <em>not suggested</em> to set <code>std=TRUE</code> for <em>generalized</em> linear (mixed) models.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="PROCESS_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).
Currently, only regression model summary can be saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details and illustrations, see
<a href="https://github.com/psychbruce/bruceR/tree/master/note">PROCESS-bruceR-SPSS</a> (PDF and Markdown files).
</p>


<h3>Value</h3>

<p>Invisibly return a list of results:
</p>

<dl>
<dt><code>process.id</code></dt><dd><p>PROCESS model number.</p>
</dd>
<dt><code>process.type</code></dt><dd><p>PROCESS model type.</p>
</dd>
<dt><code>model.m</code></dt><dd><p>&quot;Mediator&quot; (M) models (a list of multiple models).</p>
</dd>
<dt><code>model.y</code></dt><dd><p>&quot;Outcome&quot; (Y) model.</p>
</dd>
<dt><code>results</code></dt><dd><p>Effect estimates and other results (unnamed list object).</p>
</dd>
</dl>



<h3>References</h3>

<p>Hayes, A. F. (2018). <em>Introduction to mediation, moderation,
and conditional process analysis (second edition):
A regression-based approach</em>. Guilford Press.
</p>
<p>Yzerbyt, V., Muller, D., Batailler, C., &amp; Judd, C. M. (2018).
New recommendations for testing indirect effects in mediational models:
The need to report and test component paths.
<em>Journal of Personality and Social Psychology, 115</em>(6), 929&ndash;943.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lavaan_summary">lavaan_summary</a></code>
</p>
<p><code><a href="#topic+model_summary">model_summary</a></code>
</p>
<p><code><a href="#topic+med_summary">med_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### NOTE ####
## In the following examples, I set nsim=100 to save time.
## In formal analyses, nsim=1000 (or larger) is suggested!

#### Demo Data ####
# ?mediation::student
data = mediation::student %&gt;%
  dplyr::select(SCH_ID, free, smorale, pared, income,
                gender, work, attachment, fight, late, score)
names(data)[2:3] = c("SCH_free", "SCH_morale")
names(data)[4:7] = c("parent_edu", "family_inc", "gender", "partjob")
data$gender01 = 1 - data$gender  # 0 = female, 1 = male
# dichotomous X: as.factor()
data$gender = factor(data$gender01, levels=0:1, labels=c("Female", "Male"))
# dichotomous Y: as.factor()
data$pass = as.factor(ifelse(data$score&gt;=50, 1, 0))

#### Descriptive Statistics and Correlation Analyses ####
Freq(data$gender)
Freq(data$pass)
Describe(data)     # file="xxx.doc"
Corr(data[,4:11])  # file="xxx.doc"

#### PROCESS Analyses ####

## Model 1 ##
PROCESS(data, y="score", x="late", mods="gender")  # continuous Y
PROCESS(data, y="pass", x="late", mods="gender")   # dichotomous Y

# (multilevel moderation)
PROCESS(data, y="score", x="late", mods="gender",  # continuous Y (LMM)
        clusters="SCH_ID")
PROCESS(data, y="pass", x="late", mods="gender",   # dichotomous Y (GLMM)
        clusters="SCH_ID")

# (Johnson-Neyman (J-N) interval and plot)
PROCESS(data, y="score", x="gender", mods="late") -&gt; P
P$results[[1]]$jn[[1]]       # Johnson-Neyman interval
P$results[[1]]$jn[[1]]$plot  # Johnson-Neyman plot (ggplot object)
GLM_summary(P$model.y)       # detailed results of regression

# (allows multicategorical moderator)
d = airquality
d$Month = as.factor(d$Month)  # moderator: factor with levels "5"~"9"
PROCESS(d, y="Temp", x="Solar.R", mods="Month")

## Model 2 ##
PROCESS(data, y="score", x="late",
        mods=c("gender", "family_inc"),
        mod.type="2-way")  # or omit "mod.type", default is "2-way"

## Model 3 ##
PROCESS(data, y="score", x="late",
        mods=c("gender", "family_inc"),
        mod.type="3-way")
PROCESS(data, y="pass", x="gender",
        mods=c("late", "family_inc"),
        mod1.val=c(1, 3, 5),     # moderator 1: late
        mod2.val=seq(1, 15, 2),  # moderator 2: family_inc
        mod.type="3-way")

## Model 4 ##
PROCESS(data, y="score", x="parent_edu",
        meds="family_inc", covs="gender",
        ci="boot", nsim=100, seed=1)

# (allows an infinite number of multiple mediators in parallel)
PROCESS(data, y="score", x="parent_edu",
        meds=c("family_inc", "late"),
        covs=c("gender", "partjob"),
        ci="boot", nsim=100, seed=1)

# (multilevel mediation)
PROCESS(data, y="score", x="SCH_free",
        meds="late", clusters="SCH_ID",
        ci="mcmc", nsim=100, seed=1)

## Model 6 ##
PROCESS(data, y="score", x="parent_edu",
        meds=c("family_inc", "late"),
        covs=c("gender", "partjob"),
        med.type="serial",
        ci="boot", nsim=100, seed=1)

## Model 8 ##
PROCESS(data, y="score", x="fight",
        meds="late",
        mods="gender",
        mod.path=c("x-m", "x-y"),
        ci="boot", nsim=100, seed=1)

## For more examples and details, see the "note" subfolder at:
## https://github.com/psychbruce/bruceR/tree/main/note

</code></pre>

<hr>
<h2 id='RECODE'>Recode a variable.</h2><span id='topic+RECODE'></span>

<h3>Description</h3>

<p>A wrapper of <code><a href="car.html#topic+recode">car::recode()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RECODE(var, recodes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RECODE_+3A_var">var</code></td>
<td>
<p>Variable (numeric, character, or factor).</p>
</td></tr>
<tr><td><code id="RECODE_+3A_recodes">recodes</code></td>
<td>
<p>A character string definine the rule of recoding. e.g., <code>"lo:1=0; c(2,3)=1; 4=2; 5:hi=3; else=999"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of recoded variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = data.table(var=c(NA, 0, 1, 2, 3, 4, 5, 6))
added(d, {
  var.new = RECODE(var, "lo:1=0; c(2,3)=1; 4=2; 5:hi=3; else=999")
})
d

</code></pre>

<hr>
<h2 id='regress'>Regression analysis.</h2><span id='topic+regress'></span>

<h3>Description</h3>

<p>NOTE: <code><a href="#topic+model_summary">model_summary</a></code> is preferred.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regress(
  formula,
  data,
  family = NULL,
  digits = 3,
  robust = FALSE,
  cluster = NULL,
  test.rand = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regress_+3A_formula">formula</code></td>
<td>
<p>Model formula.</p>
</td></tr>
<tr><td><code id="regress_+3A_data">data</code></td>
<td>
<p>Data frame.</p>
</td></tr>
<tr><td><code id="regress_+3A_family">family</code></td>
<td>
<p>[Optional] The same as in <code>glm</code> and <code>glmer</code>
(e.g., <code>family=binomial</code> fits a logistic regression model).</p>
</td></tr>
<tr><td><code id="regress_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="regress_+3A_robust">robust</code></td>
<td>
<p>[Only for <code>lm</code> and <code>glm</code>]
<code>FALSE</code> (default), <code>TRUE</code> (then the default is <code>"HC1"</code>),
<code>"HC0"</code>, <code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, <code>"HC4m"</code>, or <code>"HC5"</code>.
It will add a table with heteroskedasticity-robust standard errors (aka. Huber-White standard errors).
For details, see <code>?sandwich::vcovHC</code> and <code>?jtools::summ.lm</code>.
</p>
<p>*** <code>"HC1"</code> is the default of Stata, whereas <code>"HC3"</code> is the default suggested by the <code>sandwich</code> package.</p>
</td></tr>
<tr><td><code id="regress_+3A_cluster">cluster</code></td>
<td>
<p>[Only for <code>lm</code> and <code>glm</code>]
Cluster-robust standard errors are computed if cluster is set to the name of the input data's cluster variable or is a vector of clusters.</p>
</td></tr>
<tr><td><code id="regress_+3A_test.rand">test.rand</code></td>
<td>
<p>[Only for <code>lmer</code> and <code>glmer</code>]
<code>TRUE</code> or <code>FALSE</code> (default).
Test random effects (i.e., variance components) by using the likelihood-ratio test (LRT),
which is asymptotically chi-square distributed.
For large datasets, it is much time-consuming.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print_table">print_table</a></code> (print simple table)
</p>
<p><code><a href="#topic+model_summary">model_summary</a></code> (highly suggested)
</p>
<p><code><a href="#topic+GLM_summary">GLM_summary</a></code>
</p>
<p><code><a href="#topic+HLM_summary">HLM_summary</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

  ## lm
  regress(Temp ~ Month + Day + Wind + Solar.R, data=airquality, robust=TRUE)

  ## glm
  regress(case ~ age + parity + education + spontaneous + induced,
          data=infert, family=binomial, robust="HC1", cluster="stratum")

  ## lmer
  library(lmerTest)
  regress(Reaction ~ Days + (Days | Subject), data=sleepstudy)
  regress(Preference ~ Sweetness + Gender + Age + Frequency +
            (1 | Consumer), data=carrots)

  ## glmer
  library(lmerTest)
  data.glmm = MASS::bacteria
  regress(y ~ trt + week + (1 | ID), data=data.glmm, family=binomial)
  regress(y ~ trt + week + hilo + (1 | ID), data=data.glmm, family=binomial)

## End(Not run)

</code></pre>

<hr>
<h2 id='rep_char'>Repeat a character string for many times and paste them up.</h2><span id='topic+rep_char'></span>

<h3>Description</h3>

<p>Repeat a character string for many times and paste them up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep_char(char, rep.times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rep_char_+3A_char">char</code></td>
<td>
<p>Character string.</p>
</td></tr>
<tr><td><code id="rep_char_+3A_rep.times">rep.times</code></td>
<td>
<p>Times for repeat.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep_char("a", 5)

</code></pre>

<hr>
<h2 id='RESCALE'>Rescale a variable (e.g., from 5-point to 7-point).</h2><span id='topic+RESCALE'></span>

<h3>Description</h3>

<p>Rescale a variable (e.g., from 5-point to 7-point).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RESCALE(var, from = range(var, na.rm = T), to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RESCALE_+3A_var">var</code></td>
<td>
<p>Variable (numeric).</p>
</td></tr>
<tr><td><code id="RESCALE_+3A_from">from</code></td>
<td>
<p>Numeric vector, the range of old scale (e.g., <code>1:5</code>).
If not defined, it will compute the range of <code>var</code>.</p>
</td></tr>
<tr><td><code id="RESCALE_+3A_to">to</code></td>
<td>
<p>Numeric vector, the range of new scale (e.g., <code>1:7</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of rescaled variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = data.table(var=rep(1:5, 2))
added(d, {
  var1 = RESCALE(var, to=1:7)
  var2 = RESCALE(var, from=1:5, to=1:7)
})
d  # var1 is equal to var2

</code></pre>

<hr>
<h2 id='RGB'>A simple extension of <code>rgb()</code>.</h2><span id='topic+RGB'></span>

<h3>Description</h3>

<p>A simple extension of <code>rgb()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RGB(r, g, b, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RGB_+3A_r">r</code>, <code id="RGB_+3A_g">g</code>, <code id="RGB_+3A_b">b</code></td>
<td>
<p>Red, Green, Blue: 0~255.</p>
</td></tr>
<tr><td><code id="RGB_+3A_alpha">alpha</code></td>
<td>
<p>Color transparency (opacity): 0~1.
If not specified, an opaque color will be generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>"#rrggbb"</code> or <code>"#rrggbbaa"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RGB(255, 0, 0)  # red: "#FF0000"
RGB(255, 0, 0, 0.8)  # red with 80\% opacity: "#FF0000CC"

</code></pre>

<hr>
<h2 id='Run'>Run code parsed from text.</h2><span id='topic+Run'></span>

<h3>Description</h3>

<p>Run code parsed from text.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Run(..., silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Run_+3A_...">...</code></td>
<td>
<p>Character string(s) to run.
You can use <code>"{ }"</code> to insert any R object in the environment.</p>
</td></tr>
<tr><td><code id="Run_+3A_silent">silent</code></td>
<td>
<p>Suppress error/warning messages. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return the running expression(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Run("a=1", "b=2")
Run("print({a+b})")

</code></pre>

<hr>
<h2 id='scaler'>Min-max scaling (min-max normalization).</h2><span id='topic+scaler'></span>

<h3>Description</h3>

<p>This function resembles <code><a href="#topic+RESCALE">RESCALE()</a></code>
and it is just equivalent to <code>RESCALE(var, to=0:1)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaler(v, min = 0, max = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaler_+3A_v">v</code></td>
<td>
<p>Variable (numeric vector).</p>
</td></tr>
<tr><td><code id="scaler_+3A_min">min</code></td>
<td>
<p>Minimum value (defaults to 0).</p>
</td></tr>
<tr><td><code id="scaler_+3A_max">max</code></td>
<td>
<p>Maximum value (defaults to 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of rescaled variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scaler(1:5)
# the same: RESCALE(1:5, to=0:1)

</code></pre>

<hr>
<h2 id='set.wd'>Set working directory to the path of currently opened file.</h2><span id='topic+set.wd'></span><span id='topic+set_wd'></span>

<h3>Description</h3>

<p>Set working directory to the path of currently opened file (usually an R script).
You can use this function in both <strong>.R/.Rmd files and R Console</strong>.
<a href="https://posit.co/download/rstudio-desktop/">RStudio</a>
(version &gt;= 1.2) is required for running this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.wd(path = NULL, ask = FALSE)

set_wd(path = NULL, ask = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.wd_+3A_path">path</code></td>
<td>
<p><code>NULL</code> (default) or a specific path.
Defaults to extract the path of the currently opened file
(usually .R or .Rmd) using the <code>rstudioapi::getSourceEditorContext</code> function.</p>
</td></tr>
<tr><td><code id="set.wd_+3A_ask">ask</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default).
If <code>TRUE</code>, you can select a folder with the prompt of a dialog.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly return the path.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>set.wd()</code>: Main function
</p>
</li>
<li> <p><code>set_wd()</code>: The alias of <code>set.wd</code> (the same)
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="base.html#topic+getwd">setwd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

  # RStudio (version &gt;= 1.2) is required for running this function.
  set.wd()  # set working directory to the path of the currently opened file
  set.wd("~/")  # set working directory to the home path
  set.wd("../")  # set working directory to the parent path
  set.wd(ask=TRUE)  # select a folder with the prompt of a dialog

## End(Not run)

</code></pre>

<hr>
<h2 id='show_colors'>Show colors.</h2><span id='topic+show_colors'></span>

<h3>Description</h3>

<p>Show colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_colors(colors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_colors_+3A_colors">colors</code></td>
<td>
<p>Color names.
</p>
<p>e.g.,
</p>

<ul>
<li> <p><code>"red"</code> (R base color names)
</p>
</li>
<li> <p><code>"#FF0000"</code> (hex color names)
</p>
</li>
<li> <p><code>see::social_colors()</code>
</p>
</li>
<li> <p><code>viridis::viridis_pal()(10)</code>
</p>
</li>
<li> <p><code>RColorBrewer::brewer.pal(name="Set1", n=9)</code>
</p>
</li>
<li> <p><code>RColorBrewer::brewer.pal(name="Set2", n=8)</code>
</p>
</li>
<li> <p><code>RColorBrewer::brewer.pal(name="Spectral", n=11)</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gg</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>show_colors("blue")
show_colors("#0000FF")  # blue (hex name)
show_colors(RGB(0, 0, 255))  # blue (RGB)
show_colors(see::social_colors())
show_colors(see::pizza_colors())

</code></pre>

<hr>
<h2 id='theme_bruce'>A nice <code>ggplot2</code> theme that enables Markdown/HTML rich text.</h2><span id='topic+theme_bruce'></span>

<h3>Description</h3>

<p>A nice <code>ggplot2</code> theme for scientific publication.
It uses <code><a href="ggtext.html#topic+element_markdown">ggtext::element_markdown()</a></code>
to render Markdown/HTML formatted rich text.
You can use a combination of Markdown and/or HTML syntax
(e.g., <code>"*y* = *x*&lt;sup&gt;2&lt;/sup&gt;"</code>) in plot text or title,
and this function draws text elements with rich text format.
</p>
<p>For more usage, see:
</p>

<ul>
<li> <p><code><a href="ggtext.html#topic+geom_richtext">ggtext::geom_richtext()</a></code>
</p>
</li>
<li> <p><code><a href="ggtext.html#topic+geom_textbox">ggtext::geom_textbox()</a></code>
</p>
</li>
<li> <p><code><a href="ggtext.html#topic+element_markdown">ggtext::element_markdown()</a></code>
</p>
</li>
<li> <p><code><a href="ggtext.html#topic+element_textbox">ggtext::element_textbox()</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>theme_bruce(
  markdown = FALSE,
  base.size = 12,
  line.size = 0.5,
  border = "black",
  bg = "white",
  panel.bg = "white",
  tag = "bold",
  plot.title = "bold",
  axis.title = "plain",
  title.pos = 0.5,
  subtitle.pos = 0.5,
  caption.pos = 1,
  font = NULL,
  grid.x = "",
  grid.y = "",
  line.x = TRUE,
  line.y = TRUE,
  tick.x = TRUE,
  tick.y = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_bruce_+3A_markdown">markdown</code></td>
<td>
<p>Use <code>element_markdown()</code> instead of <code>element_text()</code>. Defaults to <code>FALSE</code>.
If set to <code>TRUE</code>, then you should also use <code>element_markdown()</code> in <code>theme()</code> (if any).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_base.size">base.size</code></td>
<td>
<p>Basic font size. Defaults to <code>12</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_line.size">line.size</code></td>
<td>
<p>Line width. Defaults to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_border">border</code></td>
<td>
<p><code>TRUE</code>, <code>FALSE</code>, or <code>"black"</code> (default).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_bg">bg</code></td>
<td>
<p>Background color of whole plot. Defaults to <code>"white"</code>.
You can use any colors or choose from some pre-set color palettes:
<code>"stata", "stata.grey", "solar", "wsj", "light", "dust"</code>.
</p>
<p>To see these colors, you can type:
</p>
<p><code>ggthemr::colour_plot(c(stata="#EAF2F3", stata.grey="#E8E8E8",
solar="#FDF6E3", wsj="#F8F2E4", light="#F6F1EB", dust="#FAF7F2"))</code></p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_panel.bg">panel.bg</code></td>
<td>
<p>Background color of panel. Defaults to <code>"white"</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_tag">tag</code></td>
<td>
<p>Font face of tag. Choose from <code>"plain", "italic", "bold", "bold.italic"</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_plot.title">plot.title</code></td>
<td>
<p>Font face of title. Choose from <code>"plain", "italic", "bold", "bold.italic"</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_axis.title">axis.title</code></td>
<td>
<p>Font face of axis text. Choose from <code>"plain", "italic", "bold", "bold.italic"</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_title.pos">title.pos</code></td>
<td>
<p>Title position (0~1).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_subtitle.pos">subtitle.pos</code></td>
<td>
<p>Subtitle position (0~1).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_caption.pos">caption.pos</code></td>
<td>
<p>Caption position (0~1).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_font">font</code></td>
<td>
<p>Text font. Only applicable to Windows system.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_grid.x">grid.x</code></td>
<td>
<p><code>FALSE</code>, <code>""</code> (default), or a color (e.g., <code>"grey90"</code>) to set the color of panel grid (x).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_grid.y">grid.y</code></td>
<td>
<p><code>FALSE</code>, <code>""</code> (default), or a color (e.g., <code>"grey90"</code>) to set the color of panel grid (y).</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_line.x">line.x</code></td>
<td>
<p>Draw the x-axis line. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_line.y">line.y</code></td>
<td>
<p>Draw the y-axis line. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_tick.x">tick.x</code></td>
<td>
<p>Draw the x-axis ticks. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="theme_bruce_+3A_tick.y">tick.y</code></td>
<td>
<p>Draw the y-axis ticks. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A theme object that should be used for <code>ggplot2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1 (bivariate correlation)
d = as.data.table(psych::bfi)
added(d, {
  E = .mean("E", 1:5, rev=c(1,2), range=1:6)
  O = .mean("O", 1:5, rev=c(2,5), range=1:6)
})
ggplot(data=d, aes(x=E, y=O)) +
  geom_point(alpha=0.1) +
  geom_smooth(method="loess") +
  labs(x="Extraversion&lt;sub&gt;Big 5&lt;/sub&gt;",
       y="Openness&lt;sub&gt;Big 5&lt;/sub&gt;") +
  theme_bruce(markdown=TRUE)

## Example 2 (2x2 ANOVA)
d = data.frame(X1 = factor(rep(1:3, each=2)),
               X2 = factor(rep(1:2, 3)),
               Y.mean = c(5, 3, 2, 7, 3, 6),
               Y.se = rep(c(0.1, 0.2, 0.1), each=2))
ggplot(data=d, aes(x=X1, y=Y.mean, fill=X2)) +
  geom_bar(position="dodge", stat="identity", width=0.6, show.legend=FALSE) +
  geom_errorbar(aes(x=X1, ymin=Y.mean-Y.se, ymax=Y.mean+Y.se),
                width=0.1, color="black", position=position_dodge(0.6)) +
  scale_y_continuous(expand=expansion(add=0),
                     limits=c(0,8), breaks=0:8) +
  scale_fill_brewer(palette="Set1") +
  labs(x="Independent Variable (*X*)",  # italic X
       y="Dependent Variable (*Y*)",  # italic Y
       title="Demo Plot&lt;sup&gt;bruceR&lt;/sup&gt;") +
  theme_bruce(markdown=TRUE, border="")

</code></pre>

<hr>
<h2 id='TTEST'>One-sample, independent-samples, and paired-samples t-test.</h2><span id='topic+TTEST'></span>

<h3>Description</h3>

<p>One-sample, independent-samples, and paired-samples <em>t</em>-test,
with both Frequentist and Bayesian approaches.
The output includes descriptives, <em>t</em> statistics,
mean difference with 95% CI, Cohen's <em>d</em> with 95% CI,
and Bayes factor (BF10; <code>BayesFactor</code> package needs to be installed).
It also tests the assumption of homogeneity of variance
and allows users to determine whether variances are equal or not.
</p>
<p>Users can simultaneously test multiple dependent and/or independent variables.
The results of one pair of Y-X would be summarized in one row in the output.
Key results can be saved in APA format to MS Word.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTEST(
  data,
  y,
  x = NULL,
  paired = FALSE,
  paired.d.type = "dz",
  var.equal = TRUE,
  mean.diff = TRUE,
  test.value = 0,
  test.sided = c("=", "&lt;", "&gt;"),
  factor.rev = TRUE,
  bayes.prior = "medium",
  digits = 2,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTEST_+3A_data">data</code></td>
<td>
<p>Data frame (wide-format only, i.e., one case in one row).</p>
</td></tr>
<tr><td><code id="TTEST_+3A_y">y</code></td>
<td>
<p>Dependent variable(s).
Multiple variables should be included in a character vector <code>c()</code>.
</p>
<p>For paired-samples <em>t</em>-test, the number of variables should be 2, 4, 6, etc.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_x">x</code></td>
<td>
<p>Independent variable(s).
Multiple variables should be included in a character vector <code>c()</code>.
</p>
<p>Only necessary for independent-samples <em>t</em>-test.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_paired">paired</code></td>
<td>
<p>For paired-samples <em>t</em>-test, set it as <code>TRUE</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_paired.d.type">paired.d.type</code></td>
<td>
<p>Type of Cohen's <em>d</em> for paired-samples <em>t</em>-test (see Lakens, 2013).
</p>
<p>Defaults to <code>"dz"</code>. Options include:
</p>

<dl>
<dt><code>"dz"</code> (<em>d</em> for standardized difference)</dt><dd>
<p>Cohen's <code class="reqn">d_{z} = \frac{M_{diff}}{SD_{diff}}</code>
</p>
</dd>
<dt><code>"dav"</code> (<em>d</em> for average standard deviation)</dt><dd>
<p>Cohen's <code class="reqn">d_{av} = \frac{M_{diff}}{ \frac{SD_{1} + SD_{2}}{2} }</code>
</p>
</dd>
<dt><code>"drm"</code> (<em>d</em> for repeated measures, corrected for correlation)</dt><dd>
<p>Cohen's <code class="reqn">d_{rm} = \frac{M_{diff} \times \sqrt{2(1 - r_{1,2})}}{
      \sqrt{SD_{1}^2 + SD_{2}^2 - 2 \times r_{1,2} \times SD_{1} \times SD_{2}} }</code>
</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="TTEST_+3A_var.equal">var.equal</code></td>
<td>
<p>If Levene's test indicates a violation of the homogeneity of variance,
then you should better set this argument as <code>FALSE</code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_mean.diff">mean.diff</code></td>
<td>
<p>Whether to display results of mean difference and its 95% CI. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_test.value">test.value</code></td>
<td>
<p>The true value of the mean (or difference in means for a two-samples test). Defaults to <code>0</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_test.sided">test.sided</code></td>
<td>
<p>Any of <code>"="</code> (two-sided, the default), <code>"&lt;"</code> (one-sided), or <code>"&gt;"</code> (one-sided).</p>
</td></tr>
<tr><td><code id="TTEST_+3A_factor.rev">factor.rev</code></td>
<td>
<p>Whether to reverse the levels of factor (X)
such that the test compares higher vs. lower level. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_bayes.prior">bayes.prior</code></td>
<td>
<p>Prior scale in Bayesian <em>t</em>-test. Defaults to 0.707.
See details in <code><a href="BayesFactor.html#topic+ttestBF">BayesFactor::ttestBF()</a></code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places of output. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="TTEST_+3A_file">file</code></td>
<td>
<p>File name of MS Word (<code>.doc</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the point estimate of Cohen's <em>d</em> is computed using
the common method &quot;Cohen's <em>d</em> = mean difference / (pooled) standard deviation&quot;, which is
consistent with results from other R packages (e.g., <code>effectsize</code>) and software (e.g., <code>jamovi</code>).
The 95% CI of Cohen's <em>d</em> is estimated based on the 95% CI of mean difference
(i.e., also divided by the pooled standard deviation).
</p>
<p>However, different packages and software diverge greatly on the estimate of the 95% CI of Cohen's <em>d</em>.
R packages such as <code>psych</code> and <code>effectsize</code>, R software <code>jamovi</code>,
and several online statistical tools for estimating effect sizes
indeed produce surprisingly inconsistent results on the 95% CI of Cohen's <em>d</em>.
</p>
<p>See an illustration of this issue in the section &quot;Examples&quot;.
</p>


<h3>References</h3>

<p>Lakens, D. (2013). Calculating and reporting effect sizes to facilitate cumulative science:
A practical primer for <em>t</em>-tests and ANOVAs. <em>Frontiers in Psychology, 4</em>, Article 863.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MANOVA">MANOVA</a></code>, <code><a href="#topic+EMMEANS">EMMEANS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Demo data ##
d1 = between.3
d1$Y1 = d1$SCORE  # shorter name for convenience
d1$Y2 = rnorm(32)  # random variable
d1$B = factor(d1$B, levels=1:2, labels=c("Low", "High"))
d1$C = factor(d1$C, levels=1:2, labels=c("M", "F"))
d2 = within.1

## One-sample t-test ##
TTEST(d1, "SCORE")
TTEST(d1, "SCORE", test.value=5)

## Independent-samples t-test ##
TTEST(d1, "SCORE", x="A")
TTEST(d1, "SCORE", x="A", var.equal=FALSE)
TTEST(d1, y="Y1", x=c("A", "B", "C"))
TTEST(d1, y=c("Y1", "Y2"), x=c("A", "B", "C"),
      mean.diff=FALSE,  # remove to save space
      file="t-result.doc")
unlink("t-result.doc")  # delete file for code check

## Paired-samples t-test ##
TTEST(d2, y=c("A1", "A2"), paired=TRUE)
TTEST(d2, y=c("A1", "A2", "A3", "A4"), paired=TRUE)


## Not run: 

  ## Illustration for the issue stated in "Details"

  # Inconsistency in the 95% CI of Cohen's d between R packages:
  # In this example, the true point estimate of Cohen's d = 3.00
  # and its 95% CI should be equal to 95% CI of mean difference.

  data = data.frame(X=rep(1:2, each=3), Y=1:6)
  data  # simple demo data

  TTEST(data, y="Y", x="X")
  # d = 3.00 [0.73, 5.27] (estimated based on 95% CI of mean difference)

  MANOVA(data, dv="Y", between="X") %&gt;%
    EMMEANS("X")
  # d = 3.00 [0.73, 5.27] (the same as TTEST)

  psych::cohen.d(x=data, group="X")
  # d = 3.67 [0.04, 7.35] (strange)

  psych::d.ci(d=3.00, n1=3, n2=3)
  # d = 3.00 [-0.15, 6.12] (significance inconsistent with t-test)

  # jamovi uses psych::d.ci() to compute 95% CI
  # so its results are also: 3.00 [-0.15, 6.12]

  effectsize::cohens_d(Y ~ rev(X), data=data)
  # d = 3.00 [0.38, 5.50] (using the noncentrality parameter method)

  effectsize::t_to_d(t=t.test(Y ~ rev(X), data=data, var.equal=TRUE)$statistic,
                     df_error=4)
  # d = 3.67 [0.47, 6.74] (merely an approximate estimate, often overestimated)
  # see ?effectsize::t_to_d

  # https://www.psychometrica.de/effect_size.html
  # d = 3.00 [0.67, 5.33] (slightly different from TTEST)

  # https://www.campbellcollaboration.org/escalc/
  # d = 3.00 [0.67, 5.33] (slightly different from TTEST)

  # Conclusion:
  # TTEST() provides a reasonable estimate of Cohen's d and its 95% CI,
  # and effectsize::cohens_d() offers another method to compute the CI.

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
