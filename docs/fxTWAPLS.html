<!DOCTYPE html><html><head><title>Help for package fxTWAPLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fxTWAPLS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cv.pr.w'><p>Pseudo-removed leave-out cross-validation</p></a></li>
<li><a href='#cv.w'><p>Leave-one-out cross-validation</p></a></li>
<li><a href='#fx'><p>Get frequency of the climate value</p></a></li>
<li><a href='#fx_pspline'><p>Get frequency of the climate value with p-spline smoothing</p></a></li>
<li><a href='#fxTWAPLS-package'><p>fxTWAPLS: An Improved Version of WA-PLS</p></a></li>
<li><a href='#get_distance'><p>Get the distance between points</p></a></li>
<li><a href='#get_pseudo'><p>Get geographically and climatically close sites</p></a></li>
<li><a href='#pb'><p>Show progress bar</p></a></li>
<li><a href='#plot_residuals'><p>Plot the residuals</p></a></li>
<li><a href='#plot_train'><p>Plot the training results</p></a></li>
<li><a href='#rand.t.test.w'><p>Random t-test</p></a></li>
<li><a href='#sse.sample'><p>Calculate Sample Specific Errors</p></a></li>
<li><a href='#TWAPLS.predict.w'><p>TWA-PLS predict function</p></a></li>
<li><a href='#TWAPLS.w'><p>TWA-PLS training function</p></a></li>
<li><a href='#TWAPLS.w2'><p>TWA-PLS training function v2</p></a></li>
<li><a href='#WAPLS.predict.w'><p>WA-PLS predict function</p></a></li>
<li><a href='#WAPLS.w'><p>WA-PLS training function</p></a></li>
<li><a href='#WAPLS.w2'><p>WA-PLS training function v2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An Improved Version of WA-PLS</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The goal of this package is to provide an improved version of 
    WA-PLS (Weighted Averaging Partial Least Squares) by including the 
    tolerances of taxa and the frequency of the sampled climate variable. 
    This package also provides a way of leave-out cross-validation that 
    removes both the test site and sites that are both geographically 
    close and climatically close for each cycle, to avoid the risk of 
    pseudo-replication.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/special-uor/fxTWAPLS/">https://github.com/special-uor/fxTWAPLS/</a>,
<a href="https://special-uor.github.io/fxTWAPLS/">https://special-uor.github.io/fxTWAPLS/</a>,
<a href="https://research.reading.ac.uk/palaeoclimate/">https://research.reading.ac.uk/palaeoclimate/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/special-uor/fxTWAPLS/issues/">https://github.com/special-uor/fxTWAPLS/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>doFuture, foreach, future, geosphere, ggplot2, JOPS, MASS,
parallel, progressr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lintr (&ge; 3.0.0), magrittr, progress, scales, spelling,
styler, tictoc</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-25 16:26:05 UTC; robertovillegas-diaz</td>
</tr>
<tr>
<td>Author:</td>
<td>Mengmeng Liu <a href="https://orcid.org/0000-0001-6250-0148"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Iain Colin Prentice
    <a href="https://orcid.org/0000-0002-1296-6764"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Cajo J. F. ter Braak
    <a href="https://orcid.org/0000-0002-0414-8745"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Sandy P. Harrison <a href="https://orcid.org/0000-0001-5687-1903"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Roberto Villegas-Diaz
    <a href="https://orcid.org/0000-0001-5036-8661"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  SPECIAL Research Group @ University of Reading [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Roberto Villegas-Diaz &lt;r.villegas-diaz@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-25 16:40:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='cv.pr.w'>Pseudo-removed leave-out cross-validation</h2><span id='topic+cv.pr.w'></span>

<h3>Description</h3>

<p>Pseudo-removed leave-out cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.pr.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  trainfun,
  predictfun,
  pseudo,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA,
  cpus = 4,
  test_mode = TRUE,
  test_it = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.pr.w_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_trainfun">trainfun</code></td>
<td>
<p>Training function you want to use, either
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code> or <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_predictfun">predictfun</code></td>
<td>
<p>Predict function you want to use: if <code>trainfun</code> is
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, then this should be <code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>;
if <code>trainfun</code> is <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>, then this should be
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_pseudo">pseudo</code></td>
<td>
<p>The geographically and climatically close sites to each test
site, obtained from <code><a href="#topic+get_pseudo">get_pseudo</a></code> function.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_cpus">cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_test_mode">test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td></tr>
<tr><td><code id="cv.pr.w_+3A_test_it">test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Leave-one-out cross validation results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>,
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>, <code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, and
<code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

point &lt;- modern_pollen[, c("Long", "Lat")]
test_mode &lt;- TRUE # It should be set to FALSE before running
dist &lt;- fxTWAPLS::get_distance(
  point,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)
pseudo_Tmin &lt;- fxTWAPLS::get_pseudo(
  dist,
  modern_pollen$Tmin,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)

cv_pr_tf_Tmin2 &lt;- fxTWAPLS::cv.pr.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  pseudo_Tmin,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)

# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
cv_pr_tf_Tmin2 &lt;- fxTWAPLS::cv.pr.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  pseudo_Tmin,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
) %&gt;%
  fxTWAPLS::pb()

## End(Not run)

</code></pre>

<hr>
<h2 id='cv.w'>Leave-one-out cross-validation</h2><span id='topic+cv.w'></span>

<h3>Description</h3>

<p>Leave-one-out cross-validation as
<code>rioja</code> (<a href="https://cran.r-project.org/package=rioja">https://cran.r-project.org/package=rioja</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  trainfun,
  predictfun,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA,
  cpus = 4,
  test_mode = FALSE,
  test_it = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.w_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_trainfun">trainfun</code></td>
<td>
<p>Training function you want to use, either
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code> or <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_predictfun">predictfun</code></td>
<td>
<p>Predict function you want to use: if <code>trainfun</code> is
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, then this should be <code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>;
if <code>trainfun</code> is <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>, then this should be
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
<tr><td><code id="cv.w_+3A_cpus">cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_test_mode">test_mode</code></td>
<td>
<p>boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td></tr>
<tr><td><code id="cv.w_+3A_test_it">test_it</code></td>
<td>
<p>number of iterations to use in the test mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>leave-one-out cross validation results
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>,
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>, <code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, and
<code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

## LOOCV
test_mode &lt;- TRUE # It should be set to FALSE before running
cv_tf_Tmin2 &lt;- fxTWAPLS::cv.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)

# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
cv_tf_Tmin2 &lt;- fxTWAPLS::cv.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  fxTWAPLS::TWAPLS.w2,
  fxTWAPLS::TWAPLS.predict.w,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2, # Remove the following line
  test_mode = test_mode
) %&gt;% fxTWAPLS::pb()

## End(Not run)
</code></pre>

<hr>
<h2 id='fx'>Get frequency of the climate value</h2><span id='topic+fx'></span>

<h3>Description</h3>

<p>Function to get the frequency of the climate value, which will be used to
provide <code>fx</code> correction for WA-PLS and TWA-PLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fx(x, bin, show_plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fx_+3A_x">x</code></td>
<td>
<p>Numeric vector with the modern climate values.</p>
</td></tr>
<tr><td><code id="fx_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get the frequency of the modern climate values.</p>
</td></tr>
<tr><td><code id="fx_+3A_show_plot">show_plot</code></td>
<td>
<p>Boolean flag to show a plot of <code>fx ~ x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the frequency of the modern climate values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.w">cv.w</a></code>, <code><a href="#topic+cv.pr.w">cv.pr.w</a></code>, and
<code><a href="#topic+sse.sample">sse.sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Get the frequency of each climate variable fx
fx_Tmin &lt;- fxTWAPLS::fx(modern_pollen$Tmin, bin = 0.02, show_plot = TRUE)
fx_gdd &lt;- fxTWAPLS::fx(modern_pollen$gdd, bin = 20, show_plot = TRUE)
fx_alpha &lt;- fxTWAPLS::fx(modern_pollen$alpha, bin = 0.002, show_plot = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='fx_pspline'>Get frequency of the climate value with p-spline smoothing</h2><span id='topic+fx_pspline'></span>

<h3>Description</h3>

<p>Function to get the frequency of the climate value, which will be used to
provide <code>fx</code> correction for WA-PLS and TWA-PLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fx_pspline(x, bin, show_plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fx_pspline_+3A_x">x</code></td>
<td>
<p>Numeric vector with the modern climate values.</p>
</td></tr>
<tr><td><code id="fx_pspline_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get the frequency of the modern climate values, the
curve will be p-spline smoothed later</p>
</td></tr>
<tr><td><code id="fx_pspline_+3A_show_plot">show_plot</code></td>
<td>
<p>Boolean flag to show a plot of <code>fx ~ x</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the frequency of the modern climate values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.w">cv.w</a></code>, <code><a href="#topic+cv.pr.w">cv.pr.w</a></code>, and
<code><a href="#topic+sse.sample">sse.sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Get the frequency of each climate variable fx
fx_pspline_Tmin &lt;- fxTWAPLS::fx_pspline(
  modern_pollen$Tmin,
  bin = 0.02,
  show_plot = TRUE
)
fx_pspline_gdd &lt;- fxTWAPLS::fx_pspline(
  modern_pollen$gdd,
  bin = 20,
  show_plot = TRUE
)
fx_pspline_alpha &lt;- fxTWAPLS::fx_pspline(
  modern_pollen$alpha,
  bin = 0.002,
  show_plot = TRUE
)

## End(Not run)

</code></pre>

<hr>
<h2 id='fxTWAPLS-package'>fxTWAPLS: An Improved Version of WA-PLS</h2><span id='topic+fxTWAPLS'></span><span id='topic+fxTWAPLS-package'></span>

<h3>Description</h3>

<p>The goal of this package is to provide an improved version of WA-PLS (Weighted Averaging Partial Least Squares) by including the tolerances of taxa and the frequency of the sampled climate variable. This package also provides a way of leave-out cross-validation that removes both the test site and sites that are both geographically close and climatically close for each cycle, to avoid the risk of pseudo-replication.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Roberto Villegas-Diaz <a href="mailto:r.villegas-diaz@outlook.com">r.villegas-diaz@outlook.com</a> (<a href="https://orcid.org/0000-0001-5036-8661">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Mengmeng Liu <a href="mailto:m.liu18@imperial.ac.uk">m.liu18@imperial.ac.uk</a> (<a href="https://orcid.org/0000-0001-6250-0148">ORCID</a>)
</p>
</li>
<li><p> Iain Colin Prentice <a href="mailto:c.prentice@imperial.ac.uk">c.prentice@imperial.ac.uk</a> (<a href="https://orcid.org/0000-0002-1296-6764">ORCID</a>)
</p>
</li>
<li><p> Cajo J. F. ter Braak <a href="mailto:cajo.terbraak@wur.nl">cajo.terbraak@wur.nl</a> (<a href="https://orcid.org/0000-0002-0414-8745">ORCID</a>)
</p>
</li>
<li><p> Sandy P. Harrison <a href="mailto:s.p.harrison@reading.ac.uk">s.p.harrison@reading.ac.uk</a> (<a href="https://orcid.org/0000-0001-5687-1903">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> SPECIAL Research Group @ University of Reading [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/special-uor/fxTWAPLS/">https://github.com/special-uor/fxTWAPLS/</a>
</p>
</li>
<li> <p><a href="https://special-uor.github.io/fxTWAPLS/">https://special-uor.github.io/fxTWAPLS/</a>
</p>
</li>
<li> <p><a href="https://research.reading.ac.uk/palaeoclimate/">https://research.reading.ac.uk/palaeoclimate/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/special-uor/fxTWAPLS/issues/">https://github.com/special-uor/fxTWAPLS/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='get_distance'>Get the distance between points</h2><span id='topic+get_distance'></span>

<h3>Description</h3>

<p>Get the distance between points, the output will be used in
<code><a href="#topic+get_pseudo">get_pseudo</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_distance(point, cpus = 4, test_mode = FALSE, test_it = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_distance_+3A_point">point</code></td>
<td>
<p>Each row represents a sampling site, the first column is
longitude and the second column is latitude, both in decimal format.</p>
</td></tr>
<tr><td><code id="get_distance_+3A_cpus">cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td></tr>
<tr><td><code id="get_distance_+3A_test_mode">test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td></tr>
<tr><td><code id="get_distance_+3A_test_it">test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Distance matrix, the value at the <code>i-th</code> row, means the distance
between the <code>i-th</code> sampling site and the whole sampling sites.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_pseudo">get_pseudo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

point &lt;- modern_pollen[, c("Long", "Lat")]
test_mode &lt;- TRUE # It should be set to FALSE before running
dist &lt;- fxTWAPLS::get_distance(
  point,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)
# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
dist &lt;- fxTWAPLS::get_distance(
  point,
  cpus = 2, # Remove the following line
  test_mode = test_mode
) %&gt;%
  fxTWAPLS::pb()

## End(Not run)

</code></pre>

<hr>
<h2 id='get_pseudo'>Get geographically and climatically close sites</h2><span id='topic+get_pseudo'></span>

<h3>Description</h3>

<p>Get the sites which are both geographically and climatically close to the
test site, which could result in pseudo-replication and inflate the
cross-validation statistics. The output will be used in
<code><a href="#topic+cv.pr.w">cv.pr.w</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pseudo(dist, x, cpus = 4, test_mode = FALSE, test_it = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pseudo_+3A_dist">dist</code></td>
<td>
<p>Distance matrix which contains the distance from other sites.</p>
</td></tr>
<tr><td><code id="get_pseudo_+3A_x">x</code></td>
<td>
<p>The modern climate values.</p>
</td></tr>
<tr><td><code id="get_pseudo_+3A_cpus">cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td></tr>
<tr><td><code id="get_pseudo_+3A_test_mode">test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td></tr>
<tr><td><code id="get_pseudo_+3A_test_it">test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The geographically and climatically close sites to each test site.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_distance">get_distance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

point &lt;- modern_pollen[, c("Long", "Lat")]
test_mode &lt;- TRUE # It should be set to FALSE before running
dist &lt;- fxTWAPLS::get_distance(
  point,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)
pseudo_Tmin &lt;- fxTWAPLS::get_pseudo(
  dist,
  modern_pollen$Tmin,
  cpus = 2, # Remove the following line
  test_mode = test_mode
)
# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
pseudo_Tmin &lt;- fxTWAPLS::get_pseudo(
  dist,
  modern_pollen$Tmin,
  cpus = 2, # Remove the following line
  test_mode = test_mode
) %&gt;%
  fxTWAPLS::pb()

## End(Not run)
</code></pre>

<hr>
<h2 id='pb'>Show progress bar</h2><span id='topic+pb'></span>

<h3>Description</h3>

<p>Show progress bar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pb(expr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pb_+3A_expr">expr</code></td>
<td>
<p>R expression.</p>
</td></tr>
<tr><td><code id="pb_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="progressr.html#topic+with_progress">progressr::with_progress</a></code>
</p>

<dl>
<dt><code>cleanup</code></dt><dd><p>If TRUE, all progression handlers will be shutdown
at the end regardless of the progression is complete or not.</p>
</dd>
<dt><code>delay_terminal</code></dt><dd><p>If TRUE, output and conditions that may end up in
the terminal will delayed.</p>
</dd>
<dt><code>delay_stdout</code></dt><dd><p>If TRUE, standard output is captured and relayed
at the end just before any captured conditions are relayed.</p>
</dd>
<dt><code>delay_conditions</code></dt><dd><p>A character vector specifying <a href="base.html#topic+conditions">base::condition</a>
classes to be captured and relayed at the end after any captured
standard output is relayed.</p>
</dd>
<dt><code>interrupts</code></dt><dd><p>Controls whether interrupts should be detected or not.
If TRUE and a interrupt is signaled, progress handlers are asked to
report on the current amount progress when the evaluation was terminated
by the interrupt, e.g. when a user pressed Ctrl-C in an interactive session,
or a batch process was interrupted because it ran out of time.</p>
</dd>
<dt><code>interval</code></dt><dd><p>(numeric) The minimum time (in seconds) between
successive progression updates from handlers.</p>
</dd>
<dt><code>enable</code></dt><dd><p>(logical) If FALSE, then progress is not reported.  The
default is to report progress in interactive mode but not batch mode.
See below for more details.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>Return data from the function called.
</p>

<hr>
<h2 id='plot_residuals'>Plot the residuals</h2><span id='topic+plot_residuals'></span>

<h3>Description</h3>

<p>Plot the residuals, the black line is 0 line, the red line is the locally
estimated scatterplot smoothing, which shows the degree of local
compression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_residuals(train_output, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_residuals_+3A_train_output">train_output</code></td>
<td>
<p>Training output, can be the output of WA-PLS, WA-PLS with
<code>fx</code> correction, TWA-PLS, or TWA-PLS with <code>fx</code> correction</p>
</td></tr>
<tr><td><code id="plot_residuals_+3A_col">col</code></td>
<td>
<p>Choose which column of the fitted value to plot, in other words,
how many number of components you want to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plotting status.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code> and <code><a href="#topic+WAPLS.w">WAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

fit_tf_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

nsig &lt;- 3 # This should be got from the random t-test of the cross validation
fxTWAPLS::plot_residuals(fit_tf_Tmin2, nsig)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot_train'>Plot the training results</h2><span id='topic+plot_train'></span>

<h3>Description</h3>

<p>Plot the training results, the black line is the 1:1 line, the red line is
the linear regression line to fitted and <code>x</code>, which shows the degree
of overall compression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_train(train_output, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_train_+3A_train_output">train_output</code></td>
<td>
<p>Training output, can be the output of WA-PLS, WA-PLS with
<code>fx</code> correction, TWA-PLS, or TWA-PLS with <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="plot_train_+3A_col">col</code></td>
<td>
<p>Choose which column of the fitted value to plot, in other words,
how many number of components you want to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plotting status.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code> and <code><a href="#topic+WAPLS.w">WAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

fit_tf_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

nsig &lt;- 3 # This should be got from the random t-test of the cross validation
fxTWAPLS::plot_train(fit_tf_Tmin2, nsig)

## End(Not run)

</code></pre>

<hr>
<h2 id='rand.t.test.w'>Random t-test</h2><span id='topic+rand.t.test.w'></span>

<h3>Description</h3>

<p>Do a random t-test to the cross-validation results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand.t.test.w(cvoutput, n.perm = 999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand.t.test.w_+3A_cvoutput">cvoutput</code></td>
<td>
<p>Cross-validation output either from <code><a href="#topic+cv.w">cv.w</a></code> or
<code><a href="#topic+cv.pr.w">cv.pr.w</a></code>.</p>
</td></tr>
<tr><td><code id="rand.t.test.w_+3A_n.perm">n.perm</code></td>
<td>
<p>The number of permutation times to get the p value, which
assesses whether using the current number of components is significantly
different from using one less.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the statistics of the cross-validation results. Each
component is described below:
</p>

<dl>
<dt><code>R2</code></dt><dd><p>the coefficient of determination (the larger, the
better the fit).</p>
</dd>
<dt><code>Avg.Bias</code></dt><dd><p>average bias.</p>
</dd>
<dt><code>Max.Bias</code></dt><dd><p>maximum bias.</p>
</dd>
<dt><code>Min.Bias</code></dt><dd><p>minimum bias.</p>
</dd>
<dt><code>RMSEP</code></dt><dd><p>root-mean-square error of prediction (the smaller,
the better the fit).</p>
</dd>
<dt><code>delta.RMSEP</code></dt><dd><p>the percent change of RMSEP using the current
number of components than using one component less.</p>
</dd>
<dt><code>p</code></dt><dd><p>assesses whether using the current number of components
is significantly different from using one component less, which is used
to choose the last significant number of components to avoid
over-fitting.</p>
</dd>
<dt><code>-</code></dt><dd><p>The degree of overall compression is assessed by doing
linear regression to the cross-validation result and the observed
climate values.
</p>

<ul>
<li> <p><code>Compre.b0</code>: the intercept.
</p>
</li>
<li> <p><code>Compre.b1</code>: the slope (the closer to 1, the less the
overall compression).
</p>
</li>
<li> <p><code>Compre.b0.se</code>: the standard error of the intercept.
</p>
</li>
<li> <p><code>Compre.b1.se</code>: the standard error of the slope.
</p>
</li></ul>

</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+cv.w">cv.w</a></code> and <code><a href="#topic+cv.pr.w">cv.pr.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Random t-test
rand_pr_tf_Tmin2 &lt;- fxTWAPLS::rand.t.test.w(cv_pr_tf_Tmin2, n.perm = 999)

# note: choose the last significant number of components based on the p-value,
# see details at Liu Mengmeng, Prentice Iain Colin, ter Braak Cajo J. F.,
# Harrison Sandy P.. 2020 An improved statistical approach for reconstructing
# past climates from biotic assemblages. Proc. R. Soc. A. 476: 20200346.
# &lt;https://doi.org/10.1098/rspa.2020.0346&gt;

## End(Not run)

</code></pre>

<hr>
<h2 id='sse.sample'>Calculate Sample Specific Errors</h2><span id='topic+sse.sample'></span>

<h3>Description</h3>

<p>Calculate Sample Specific Errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sse.sample(
  modern_taxa,
  modern_climate,
  fossil_taxa,
  trainfun,
  predictfun,
  nboot,
  nPLS,
  nsig,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA,
  cpus = 4,
  seed = NULL,
  test_mode = FALSE,
  test_it = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sse.sample_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_fossil_taxa">fossil_taxa</code></td>
<td>
<p>Fossil taxa abundance data to reconstruct past climates,
each row represents a site to be reconstructed, each column represents a
taxon.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_trainfun">trainfun</code></td>
<td>
<p>Training function you want to use, either
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code> or <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_predictfun">predictfun</code></td>
<td>
<p>Predict function you want to use: if <code>trainfun</code> is
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, then this should be <code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>;
if <code>trainfun</code> is <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>, then this should be
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_nboot">nboot</code></td>
<td>
<p>The number of bootstrap cycles you want to use.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_nsig">nsig</code></td>
<td>
<p>The significant number of components to use to reconstruct past
climates, this can be obtained from the cross-validation results.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_cpus">cpus</code></td>
<td>
<p>Number of CPUs for simultaneous iterations to execute, check
<code>parallel::detectCores()</code> for available CPUs on your machine.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_seed">seed</code></td>
<td>
<p>Seed for reproducibility.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_test_mode">test_mode</code></td>
<td>
<p>Boolean flag to execute the function with a limited number
of iterations, <code>test_it</code>, for testing purposes only.</p>
</td></tr>
<tr><td><code id="sse.sample_+3A_test_it">test_it</code></td>
<td>
<p>Number of iterations to use in the test mode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The bootstrapped standard error for each site.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>,
<code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>, <code><a href="#topic+WAPLS.w">WAPLS.w</a></code>, and
<code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Load reconstruction data
Holocene &lt;- read.csv("/path/to/Holocene.csv")
taxaColMin &lt;- which(colnames(Holocene) == "taxa0")
taxaColMax &lt;- which(colnames(Holocene) == "taxaN")
core &lt;- Holocene[, taxaColMin:taxaColMax]

## SSE
nboot &lt;- 5 # Recommended 1000
nsig &lt;- 3 # This should be got from the random t-test of the cross validation

sse_tf_Tmin2 &lt;- fxTWAPLS::sse.sample(
  modern_taxa = taxa,
  modern_climate = modern_pollen$Tmin,
  fossil_taxa = core,
  trainfun = fxTWAPLS::TWAPLS.w2,
  predictfun = fxTWAPLS::TWAPLS.predict.w,
  nboot = nboot,
  nPLS = 5,
  nsig = nsig,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2,
  seed = 1
)

# Run with progress bar
`%&gt;%` &lt;- magrittr::`%&gt;%`
sse_tf_Tmin2 &lt;- fxTWAPLS::sse.sample(
  modern_taxa = taxa,
  modern_climate = modern_pollen$Tmin,
  fossil_taxa = core,
  trainfun = fxTWAPLS::TWAPLS.w2,
  predictfun = fxTWAPLS::TWAPLS.predict.w,
  nboot = nboot,
  nPLS = 5,
  nsig = nsig,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02,
  cpus = 2,
  seed = 1
) %&gt;% fxTWAPLS::pb()

## End(Not run)

</code></pre>

<hr>
<h2 id='TWAPLS.predict.w'>TWA-PLS predict function</h2><span id='topic+TWAPLS.predict.w'></span>

<h3>Description</h3>

<p>TWA-PLS predict function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TWAPLS.predict.w(TWAPLSoutput, fossil_taxa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TWAPLS.predict.w_+3A_twaplsoutput">TWAPLSoutput</code></td>
<td>
<p>The output of the <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code> training
function, either with or without <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="TWAPLS.predict.w_+3A_fossil_taxa">fossil_taxa</code></td>
<td>
<p>Fossil taxa abundance data to reconstruct past climates,
each row represents a site to be reconstructed, each column represents
a taxon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the reconstruction results. Each element in the list is
described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>the fitted values using each number of components.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>the total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Load reconstruction data
Holocene &lt;- read.csv("/path/to/Holocene.csv")
taxaColMin &lt;- which(colnames(Holocene) == "taxa0")
taxaColMax &lt;- which(colnames(Holocene) == "taxaN")
core &lt;- Holocene[, taxaColMin:taxaColMax]

## Train
fit_t_Tmin &lt;- fxTWAPLS::TWAPLS.w(taxa, modern_pollen$Tmin, nPLS = 5)
fit_tf_Tmin &lt;- fxTWAPLS::TWAPLS.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)
fit_t_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(taxa, modern_pollen$Tmin, nPLS = 5)
fit_tf_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## Predict
fossil_t_Tmin &lt;- fxTWAPLS::TWAPLS.predict.w(fit_t_Tmin, core)
fossil_tf_Tmin &lt;- fxTWAPLS::TWAPLS.predict.w(fit_tf_Tmin, core)
fossil_t_Tmin2 &lt;- fxTWAPLS::TWAPLS.predict.w(fit_t_Tmin2, core)
fossil_tf_Tmin2 &lt;- fxTWAPLS::TWAPLS.predict.w(fit_tf_Tmin2, core)

## End(Not run)

</code></pre>

<hr>
<h2 id='TWAPLS.w'>TWA-PLS training function</h2><span id='topic+TWAPLS.w'></span>

<h3>Description</h3>

<p>TWA-PLS training function, which can perform <code>fx</code> correction.
<code>1/fx^2</code> correction will be applied at step 7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TWAPLS.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TWAPLS.w_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="TWAPLS.w_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="TWAPLS.w_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="TWAPLS.w_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="TWAPLS.w_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="TWAPLS.w_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the training results, which will be used by the predict
function. Each element in the list is described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>the fitted values using each number of components.</p>
</dd>
<dt><code>x</code></dt><dd><p>the observed modern climate values.</p>
</dd>
<dt><code>taxon_name</code></dt><dd><p>the name of each taxon.</p>
</dd>
<dt><code>optimum</code></dt><dd><p>the updated taxon optimum</p>
</dd>
<dt><code>comp</code></dt><dd><p>each component extracted (will be used in step 7
regression).</p>
</dd>
<dt><code>u</code></dt><dd><p>taxon optimum for each component (step 2).</p>
</dd>
<dt><code>t</code></dt><dd><p>taxon tolerance for each component (step 2).</p>
</dd>
<dt><code>z</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>s</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>orth</code></dt><dd><p>a list that stores orthogonalization parameters
(step 4).</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a list that stores regression coefficients (step 7).</p>
</dd>
<dt><code>meanx</code></dt><dd><p>mean value of the observed modern climate values.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>the total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>, and
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Training
fit_t_Tmin &lt;- fxTWAPLS::TWAPLS.w(taxa, modern_pollen$Tmin, nPLS = 5)
fit_tf_Tmin &lt;- fxTWAPLS::TWAPLS.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## End(Not run)

</code></pre>

<hr>
<h2 id='TWAPLS.w2'>TWA-PLS training function v2</h2><span id='topic+TWAPLS.w2'></span>

<h3>Description</h3>

<p>TWA-PLS training function, which can perform <code>fx</code> correction.
<code>1/fx</code> correction will be applied at step 2 and step 7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TWAPLS.w2(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TWAPLS.w2_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="TWAPLS.w2_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="TWAPLS.w2_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="TWAPLS.w2_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="TWAPLS.w2_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="TWAPLS.w2_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the training results, which will be used by the predict
function. Each element in the list is described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>the fitted values using each number of components.</p>
</dd>
<dt><code>x</code></dt><dd><p>the observed modern climate values.</p>
</dd>
<dt><code>taxon_name</code></dt><dd><p>the name of each taxon.</p>
</dd>
<dt><code>optimum</code></dt><dd><p>the updated taxon optimum</p>
</dd>
<dt><code>comp</code></dt><dd><p>each component extracted (will be used in step 7
regression).</p>
</dd>
<dt><code>u</code></dt><dd><p>taxon optimum for each component (step 2).</p>
</dd>
<dt><code>t</code></dt><dd><p>taxon tolerance for each component (step 2).</p>
</dd>
<dt><code>z</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>s</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>orth</code></dt><dd><p>a list that stores orthogonalization parameters
(step 4).</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a list that stores regression coefficients (step 7).</p>
</dd>
<dt><code>meanx</code></dt><dd><p>mean value of the observed modern climate values.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>the total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.predict.w">TWAPLS.predict.w</a></code>, and
<code><a href="#topic+WAPLS.w">WAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Training
fit_t_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(taxa, modern_pollen$Tmin, nPLS = 5)
fit_tf_Tmin2 &lt;- fxTWAPLS::TWAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## End(Not run)

</code></pre>

<hr>
<h2 id='WAPLS.predict.w'>WA-PLS predict function</h2><span id='topic+WAPLS.predict.w'></span>

<h3>Description</h3>

<p>WA-PLS predict function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WAPLS.predict.w(WAPLSoutput, fossil_taxa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WAPLS.predict.w_+3A_waplsoutput">WAPLSoutput</code></td>
<td>
<p>The output of the <code><a href="#topic+WAPLS.w">WAPLS.w</a></code> training function,
either with or without <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="WAPLS.predict.w_+3A_fossil_taxa">fossil_taxa</code></td>
<td>
<p>Fossil taxa abundance data to reconstruct past climates,
each row represents a site to be reconstructed, each column represents a
taxon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the reconstruction results. Each element in the list is
described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>The fitted values using each number of components.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>The total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+WAPLS.w">WAPLS.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Load reconstruction data
Holocene &lt;- read.csv("/path/to/Holocene.csv")
taxaColMin &lt;- which(colnames(Holocene) == "taxa0")
taxaColMax &lt;- which(colnames(Holocene) == "taxaN")
core &lt;- Holocene[, taxaColMin:taxaColMax]

## Train
fit_Tmin &lt;- fxTWAPLS::WAPLS.w(taxa, modern_pollen$Tmin, nPLS = 5)
fit_f_Tmin &lt;- fxTWAPLS::WAPLS.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)
fit_Tmin2 &lt;- fxTWAPLS::WAPLS.w2(taxa, modern_pollen$Tmin, nPLS = 5)
fit_f_Tmin2 &lt;- fxTWAPLS::WAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)
## Predict
fossil_Tmin &lt;- fxTWAPLS::WAPLS.predict.w(fit_Tmin, core)
fossil_f_Tmin &lt;- fxTWAPLS::WAPLS.predict.w(fit_f_Tmin, core)
fossil_Tmin2 &lt;- fxTWAPLS::WAPLS.predict.w(fit_Tmin2, core)
fossil_f_Tmin2 &lt;- fxTWAPLS::WAPLS.predict.w(fit_f_Tmin2, core)

## End(Not run)

</code></pre>

<hr>
<h2 id='WAPLS.w'>WA-PLS training function</h2><span id='topic+WAPLS.w'></span>

<h3>Description</h3>

<p>WA-PLS training function, which can perform <code>fx</code> correction.
<code>1/fx^2</code> correction will be applied at step 7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WAPLS.w(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WAPLS.w_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="WAPLS.w_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="WAPLS.w_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="WAPLS.w_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="WAPLS.w_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="WAPLS.w_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the training results, which will be used by the predict
function. Each element in the list is described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>the fitted values using each number of components.</p>
</dd>
<dt><code>x</code></dt><dd><p>the observed modern climate values.</p>
</dd>
<dt><code>taxon_name</code></dt><dd><p>the name of each taxon.</p>
</dd>
<dt><code>optimum</code></dt><dd><p>the updated taxon optimum (u* in the WA-PLS
paper).</p>
</dd>
<dt><code>comp</code></dt><dd><p>each component extracted (will be used in step 7
regression).</p>
</dd>
<dt><code>u</code></dt><dd><p>taxon optimum for each component (step 2).</p>
</dd>
<dt><code>z</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>s</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>orth</code></dt><dd><p>a list that stores orthogonalization parameters
(step 4).</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a list that stores regression coefficients (step 7).</p>
</dd>
<dt><code>meanx</code></dt><dd><p>mean value of the observed modern climate values.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>the total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>, and
<code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Training
fit_Tmin &lt;- fxTWAPLS::WAPLS.w(taxa, modern_pollen$Tmin, nPLS = 5)
fit_f_Tmin &lt;- fxTWAPLS::WAPLS.w(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## End(Not run)

</code></pre>

<hr>
<h2 id='WAPLS.w2'>WA-PLS training function v2</h2><span id='topic+WAPLS.w2'></span>

<h3>Description</h3>

<p>WA-PLS training function, which can perform <code>fx</code> correction.
<code>1/fx</code> correction will be applied at step 2 and step 7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WAPLS.w2(
  modern_taxa,
  modern_climate,
  nPLS = 5,
  usefx = FALSE,
  fx_method = "bin",
  bin = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WAPLS.w2_+3A_modern_taxa">modern_taxa</code></td>
<td>
<p>The modern taxa abundance data, each row represents a
sampling site, each column represents a taxon.</p>
</td></tr>
<tr><td><code id="WAPLS.w2_+3A_modern_climate">modern_climate</code></td>
<td>
<p>The modern climate value at each sampling site.</p>
</td></tr>
<tr><td><code id="WAPLS.w2_+3A_npls">nPLS</code></td>
<td>
<p>The number of components to be extracted.</p>
</td></tr>
<tr><td><code id="WAPLS.w2_+3A_usefx">usefx</code></td>
<td>
<p>Boolean flag on whether or not use <code>fx</code> correction.</p>
</td></tr>
<tr><td><code id="WAPLS.w2_+3A_fx_method">fx_method</code></td>
<td>
<p>Binned or p-spline smoothed <code>fx</code> correction: if
<code>usefx = FALSE</code>, this should be <code>NA</code>; otherwise,
<code><a href="#topic+fx">fx</a></code> function will be used when choosing &quot;bin&quot;;
<code><a href="#topic+fx_pspline">fx_pspline</a></code> function will be used when choosing &quot;pspline&quot;.</p>
</td></tr>
<tr><td><code id="WAPLS.w2_+3A_bin">bin</code></td>
<td>
<p>Binwidth to get fx, needed for both binned and p-splined method.
if <code>usefx = FALSE</code>, this should be <code>NA</code>;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the training results, which will be used by the predict
function. Each element in the list is described below:
</p>

<dl>
<dt><code>fit</code></dt><dd><p>the fitted values using each number of components.</p>
</dd>
<dt><code>x</code></dt><dd><p>the observed modern climate values.</p>
</dd>
<dt><code>taxon_name</code></dt><dd><p>the name of each taxon.</p>
</dd>
<dt><code>optimum</code></dt><dd><p>the updated taxon optimum (u* in the WA-PLS
paper).</p>
</dd>
<dt><code>comp</code></dt><dd><p>each component extracted (will be used in step 7
regression).</p>
</dd>
<dt><code>u</code></dt><dd><p>taxon optimum for each component (step 2).</p>
</dd>
<dt><code>z</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>s</code></dt><dd><p>a parameter used in standardization for each component
(step 5).</p>
</dd>
<dt><code>orth</code></dt><dd><p>a list that stores orthogonalization parameters
(step 4).</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a list that stores regression coefficients (step 7).</p>
</dd>
<dt><code>meanx</code></dt><dd><p>mean value of the observed modern climate values.</p>
</dd>
<dt><code>nPLS</code></dt><dd><p>the total number of components extracted.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+fx">fx</a></code>, <code><a href="#topic+TWAPLS.w">TWAPLS.w</a></code>, and
<code><a href="#topic+WAPLS.predict.w">WAPLS.predict.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load modern pollen data
modern_pollen &lt;- read.csv("/path/to/modern_pollen.csv")

# Extract taxa
taxaColMin &lt;- which(colnames(modern_pollen) == "taxa0")
taxaColMax &lt;- which(colnames(modern_pollen) == "taxaN")
taxa &lt;- modern_pollen[, taxaColMin:taxaColMax]

# Training
fit_Tmin2 &lt;- fxTWAPLS::WAPLS.w2(taxa, modern_pollen$Tmin, nPLS = 5)
fit_f_Tmin2 &lt;- fxTWAPLS::WAPLS.w2(
  taxa,
  modern_pollen$Tmin,
  nPLS = 5,
  usefx = TRUE,
  fx_method = "bin",
  bin = 0.02
)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
