<!DOCTYPE html><html lang="en"><head><title>Help for package QuICSeedR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QuICSeedR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BulkProcessing'><p>Processing and analyzing Multiple Experiments</p></a></li>
<li><a href='#BulkReadMARS'><p>Bulk Read MARS data</p></a></li>
<li><a href='#CleanMeta'><p>Get Clean Metadata</p></a></li>
<li><a href='#CleanRaw'><p>Generate Clean Raw Data</p></a></li>
<li><a href='#ConvertTime'><p>Extract and Convert Time Data to Decimal Hours</p></a></li>
<li><a href='#GetAnalysis'><p>Perform Statistical Analysis on Calculations</p></a></li>
<li><a href='#GetCalculation'><p>Perform Calculations</p></a></li>
<li><a href='#GetReplicate'><p>Generate Replicate Numbers for Plate Data</p></a></li>
<li><a href='#PlotMetric'><p>Create a customizable ggplot for metrics</p></a></li>
<li><a href='#PlotPlate'><p>Plot Time Series Data</p></a></li>
<li><a href='#PlotRawMulti'><p>Plot Multiple Samples from the Cleaned Raw Data</p></a></li>
<li><a href='#PlotRawSingle'><p>Plot a Single Sample from the Cleaned Raw Data</p></a></li>
<li><a href='#SpreadCalculation'><p>Spread Calculation Data</p></a></li>
<li><a href='#SummarizeResult'><p>Summarize Analysis Results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analyze Data for Fluorophore-Assisted Seed Amplification Assays</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-27</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Manci Li</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolkit for analysis and visualization of data from fluorophore-assisted seed amplification assays, such as Real-Time Quaking-Induced Conversion (RT-QuIC) and Fluorophore-Assisted Protein Misfolding Cyclic Amplification (PMCA). 'QuICSeedR' addresses limitations in existing software by automating data processing, supporting large-scale analysis, and enabling comparative studies of analysis methods. It incorporates methods described in Henderson et al. (2015) &lt;<a href="https://doi.org/10.1099%2Fvir.0.069906-0">doi:10.1099/vir.0.069906-0</a>&gt;, Li et al. (2020) &lt;<a href="https://doi.org/10.1038%2Fs41598-021-96127-8">doi:10.1038/s41598-021-96127-8</a>&gt;, Rowden et al. (2023) &lt;<a href="https://doi.org/10.3390%2Fpathogens12020309">doi:10.3390/pathogens12020309</a>&gt;, Haley et al. (2013) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0081488">doi:10.1371/journal.pone.0081488</a>&gt;, and Mair and Wilcox (2020) &lt;<a href="https://doi.org/10.3758%2Fs13428-019-01246-w">doi:10.3758/s13428-019-01246-w</a>&gt;. Please refer to the original publications for details.</td>
</tr>
<tr>
<td>Imports:</td>
<td>WRS2, magrittr, graphics, stats, ggplot2, methods, dplyr,
tidyr, tidyselect, rlang, readxl</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-27 15:09:24 UTC; manci</td>
</tr>
<tr>
<td>Author:</td>
<td>Manci Li <a href="https://orcid.org/0000-0003-3930-7117"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manci Li &lt;li000021@umn.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-02 12:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='BulkProcessing'>Processing and analyzing Multiple Experiments</h2><span id='topic+BulkProcessing'></span>

<h3>Description</h3>

<p>This function processes multiple experiments in parallel, performing a series of operations
including time conversion, metadata cleaning, raw data cleaning, calculations, analysis,
and result summarization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BulkProcessing(data, do_analysis = TRUE, params = list(), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BulkProcessing_+3A_data">data</code></td>
<td>
<p>Compiled data of experiments.</p>
</td></tr>
<tr><td><code id="BulkProcessing_+3A_do_analysis">do_analysis</code></td>
<td>
<p>Logical. Whether statistic analysis is included. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="BulkProcessing_+3A_params">params</code></td>
<td>
<p>A list of parameters for various processing steps. If a parameter is not
provided, default values will be used. <code>control</code> used in <code>GetAnalysis()</code> is required.
parameters can be provided for the following functions:
</p>

<ul>
<li> <p><code>ConvertTime</code>
</p>
</li>
<li> <p><code>CleanMeta</code>
</p>
</li>
<li> <p><code>CleanRaw</code>
</p>
</li>
<li> <p><code>GetCalculation</code>
</p>
</li>
<li> <p><code>SpreadCalculation</code>
</p>
</li>
<li> <p><code>GetAnalysis</code>
</p>
</li>
<li> <p><code>SummarizeResult</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="BulkProcessing_+3A_verbose">verbose</code></td>
<td>
<p>Logical; if TRUE, prints detailed processing information for troubleshooting.
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing three elements:
</p>

<ul>
<li><p> combined_calculation: A data frame of combined calculations from all experiments
</p>
</li>
<li><p> combined_cleanraw: Cleaned raw data for each experiment
</p>
</li>
<li><p> combined_result: A data frame of combined results from all experiments
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#Get path for example data
path = system.file("extdata", package = "QuICSeedR")

#Helper function
add_underscore &lt;- function(text) {
  gsub("([a-zA-Z])(\\d)", "\\1_\\2", text)
  }
  
#Read in data
elkear = BulkReadMARS(path = path, 
                      plate_subfix = 'plate',
                      raw_subfix = 'raw', 
                      helper_func = add_underscore)
                      
#Set up parameters for batch analysis
params = list(
  CleanMeta = list(split_content = TRUE, split_into = c('region', 'sample')),
  GetCalculation = list(cycle_background = 5, norm = TRUE, norm_ct = 'Pos',
                       sd_fold = 10, time_skip = 5),
  GetAnalysis = list(control = "Neg")
  )
  
#Get results     
results = BulkProcessing(data =elkear, params = params)

str(results)


</code></pre>

<hr>
<h2 id='BulkReadMARS'>Bulk Read MARS data</h2><span id='topic+BulkReadMARS'></span>

<h3>Description</h3>

<p>Bulk Read MARS data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BulkReadMARS(path, plate_subfix, raw_subfix, helper_func = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BulkReadMARS_+3A_path">path</code></td>
<td>
<p>Character string specifying the path to the parent directory containing the data folders.</p>
</td></tr>
<tr><td><code id="BulkReadMARS_+3A_plate_subfix">plate_subfix</code></td>
<td>
<p>Character string used to identify plate data files.</p>
</td></tr>
<tr><td><code id="BulkReadMARS_+3A_raw_subfix">raw_subfix</code></td>
<td>
<p>Character string used to identify raw data files.</p>
</td></tr>
<tr><td><code id="BulkReadMARS_+3A_helper_func">helper_func</code></td>
<td>
<p>Optional function to be applied to each column of the plate data (default: NULL).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The example dataset, located in <code style="white-space: pre;">&#8288;inst/extdata/&#8288;</code>, consists of folders representing
individual experimental runs. This dataset is a subset of the data used in a
publication led by Dr. Stuart Lichtenberg. For detailed information about the experiments, please
contact Dr. Stuart Lichtenberg at <code>licht213@umn.edu</code>.
</p>
<p>Each folder contains two Excel files:
</p>

<ul>
<li><p> A file with the suffix <code>plate</code>: Contains the plate setup and experimental information.
</p>
</li>
<li><p> A file with the suffix <code>raw</code>: Contains fluorescence data exported from MARS software.
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing data from each folder, including plate, raw, and replicate data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path = system.file("extdata", package = "QuICSeedR")
data &lt;- BulkReadMARS(path = path,
                     plate_subfix = 'plate',
                     raw_subfix = 'raw')
str(data)

</code></pre>

<hr>
<h2 id='CleanMeta'>Get Clean Metadata</h2><span id='topic+CleanMeta'></span>

<h3>Description</h3>

<p>This function processes raw data (raw), plate layout (plate), and replicate information (replicate) to create a clean metadata dataframe.
It can optionally split the content column into additional columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CleanMeta(
  raw,
  plate,
  replicate,
  split_content = FALSE,
  split_by = "_",
  split_into = c(),
  del_na = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CleanMeta_+3A_raw">raw</code></td>
<td>
<p>A dataframe containing the raw data.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_plate">plate</code></td>
<td>
<p>A dataframe containing the plate layout information.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_replicate">replicate</code></td>
<td>
<p>A dataframe containing the replicate information. Output of <code>GetReplicate()</code>.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_split_content">split_content</code></td>
<td>
<p>Logical, whether to split the content. Default is FALSE.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_split_by">split_by</code></td>
<td>
<p>A character string to split the content by. Default is &quot;_&quot;.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_split_into">split_into</code></td>
<td>
<p>A character vector specifying names for the split columns. Required if split_content is TRUE.</p>
</td></tr>
<tr><td><code id="CleanMeta_+3A_del_na">del_na</code></td>
<td>
<p>Logical, whether to drop rows containing NA. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the cleaned metadata.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)
head(meta)

</code></pre>

<hr>
<h2 id='CleanRaw'>Generate Clean Raw Data</h2><span id='topic+CleanRaw'></span>

<h3>Description</h3>

<p>This function takes metadata, raw data, and total cycle information to generate clean raw fluorescence data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CleanRaw(meta, raw, plate_time, cycle_total)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CleanRaw_+3A_meta">meta</code></td>
<td>
<p>A data frame containing the metadata. Output from CleanMeta function.</p>
</td></tr>
<tr><td><code id="CleanRaw_+3A_raw">raw</code></td>
<td>
<p>Raw fluorescence readings from MARS software.</p>
</td></tr>
<tr><td><code id="CleanRaw_+3A_plate_time">plate_time</code></td>
<td>
<p>Output of <code>ConvertTime()</code>.</p>
</td></tr>
<tr><td><code id="CleanRaw_+3A_cycle_total">cycle_total</code></td>
<td>
<p>The total number of cycles (rows) to include in the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the cleaned raw fluorescence data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleaned_data &lt;- CleanRaw(meta, raw, plate_time)

cleaned_data[1:5, 1:5]

</code></pre>

<hr>
<h2 id='ConvertTime'>Extract and Convert Time Data to Decimal Hours</h2><span id='topic+ConvertTime'></span>

<h3>Description</h3>

<p>The function extracts and converts run time information from MARS output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ConvertTime(raw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ConvertTime_+3A_raw">raw</code></td>
<td>
<p>Output from MARS.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the time information in decimal hours.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with "hours and minutes" format
raw_data &lt;- data.frame(
  V1 = c("Header", "Row1", "Row2"),
  V2 = c("Time", "1 h 30 min", "2 h 45 min")
)
plate_time &lt;- ConvertTime(raw_data)
print(plate_time)

# Example with decimal hours format
raw_data2 &lt;- data.frame(
  V1 = c("Header", "Row1", "Row2"),
  V2 = c("Time", "1.5", "2.75")
)
plate_time2 &lt;- ConvertTime(raw_data2)
print(plate_time2)

</code></pre>

<hr>
<h2 id='GetAnalysis'>Perform Statistical Analysis on Calculations</h2><span id='topic+GetAnalysis'></span>

<h3>Description</h3>

<p>This function performs statistical analysis on a list of calculation spreads,
comparing each column to a control column using various statistical tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetAnalysis(
  calculation_spread,
  control,
  test = "wilcox",
  alternative = "two.sided",
  adjust_p = FALSE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetAnalysis_+3A_calculation_spread">calculation_spread</code></td>
<td>
<p>A list of data frames, each representing a calculation spread.
</p>
<p>Output of <code>SpreadCaculation()</code>.</p>
</td></tr>
<tr><td><code id="GetAnalysis_+3A_control">control</code></td>
<td>
<p>The name or pattern of the control column in each data frame.</p>
</td></tr>
<tr><td><code id="GetAnalysis_+3A_test">test</code></td>
<td>
<p>The statistical test to use. Options are:
</p>

<ul>
<li><p> &quot;t-test&quot;: Student's t-test, suitable for normally distributed data.
For more information, run: <code>?stats::t.test</code>
</p>
</li>
<li><p> &quot;wilcox&quot;: Wilcoxon rank-sum test (also known as Mann-Whitney U test), a non-parametric test.
For more information, run: <code>?stats::wilcox.test</code>
</p>
</li>
<li><p> &quot;yuen&quot;: Yuen's test for trimmed means, robust against outliers and non-normality.
For more information, run: <code>?WRS2::yuen</code>
</p>
</li></ul>

<p>Default is &quot;wilcox&quot;.</p>
</td></tr>
<tr><td><code id="GetAnalysis_+3A_alternative">alternative</code></td>
<td>
<p>Options are &quot;two.sided&quot;, &quot;less&quot;, or &quot;greater&quot;. Default is &quot;two.sided&quot;.</p>
</td></tr>
<tr><td><code id="GetAnalysis_+3A_adjust_p">adjust_p</code></td>
<td>
<p>Logical. Whether to adjust p-values for multiple comparisons. Default is FALSE.</p>
</td></tr>
<tr><td><code id="GetAnalysis_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for determining significance stars. Default is 0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames containing the results of the statistical analysis for selected metrics.
</p>


<h3>References</h3>

<p>Mair, P., &amp; Wilcox, R. (2020). WRS2: A Collection of Robust Statistical Methods.
https://CRAN.R-project.org/package=WRS2
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Get calculations using positive controls to normalize values. 
calculation = GetCalculation(raw = cleanraw, meta, sd_fold = 10)

#Formatting calculations for analysis (also compatible with graphing 
#softwares used in F-SAA research)
calculation_spread = SpreadCalculation(calculation)

analysis &lt;- GetAnalysis(calculation_spread, control = "Neg", test = "wilcox", 
                        alternative = 'greater')
head(analysis)

</code></pre>

<hr>
<h2 id='GetCalculation'>Perform Calculations</h2><span id='topic+GetCalculation'></span>

<h3>Description</h3>

<p>This function takes cleaned raw data and performs various analyses,
including calculating the time to threshold, Rate of Amyloid Formation (RAF), Max Point Ratio (MPR),
Max Slope (MS), and whether the reaction crosses the threshold (XTH).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetCalculation(
  raw,
  meta,
  norm = FALSE,
  norm_ct,
  threshold_method = "stdv",
  time_skip = 5,
  sd_fold = 3,
  bg_fold = 3,
  rfu = 5000,
  cycle_background = 4,
  binw = 6
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetCalculation_+3A_raw">raw</code></td>
<td>
<p>Cleaned raw data matrix. Output from <code>CleanRaw()</code>.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_meta">meta</code></td>
<td>
<p>Cleaned meta data. Output from <code>CleanMeta()</code>.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_norm">norm</code></td>
<td>
<p>Logical. If TRUE, normalization will be performed. Default is FALSE.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_norm_ct">norm_ct</code></td>
<td>
<p>Sample name used to normalize calculation.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_threshold_method">threshold_method</code></td>
<td>
<p>Method for calculating threshold ('stdv', 'rfu_val', or 'bg_ratio').</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_time_skip">time_skip</code></td>
<td>
<p>Number of initial time points to skip when checking for threshold crossing.
This helps ignore early crossings that may be due to reasons unrelated to seeding activity.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_sd_fold">sd_fold</code></td>
<td>
<p>Fold of standard deviation to calculate the threshold for RAF (for 'stdv' method).</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_bg_fold">bg_fold</code></td>
<td>
<p>Background fold for threshold calculation (for 'bg_ratio' method).</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_rfu">rfu</code></td>
<td>
<p>Relative fluorescence unit values used for threshold (for 'rfu_val' method).</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_cycle_background">cycle_background</code></td>
<td>
<p>The cycle number chosen as the background for RAF and MPR calculations.</p>
</td></tr>
<tr><td><code id="GetCalculation_+3A_binw">binw</code></td>
<td>
<p>Bin width for the MS calculation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the results of the calculation.
</p>


<h3>References</h3>

<p>Henderson DM, Davenport KA, Haley NJ, Denkers ND, Mathiason CK, Hoover EA.
Quantitative assessment of prion infectivity in tissues and body fluids by real-time quaking-induced conversion.
J Gen Virol. 2015;96(Pt 1):210-219. doi:10.1099/vir.0.069906-0
</p>
<p>Li M, Schwabenlander MD, Rowden GR, Schefers JM, Jennelle CS, Carstensen M, Seelig D, Larsen PA. RT-QuIC detection
of CWD prion seeding activity in white-tailed deer muscle tissues. Sci Rep. 2021;11(1):16759.
doi: 10.1038/s41598-021-96127-8. PMID: 34408204; PMCID: PMC8373970.
</p>
<p>Rowden GR, Picasso-Risso C, Li M, Schwabenlander MD, Wolf TM, Larsen PA.
Standardization of Data Analysis for RT-QuIC-Based Detection of Chronic Wasting Disease. Pathogens.
2023;12(2):309. doi:10.3390/pathogens12020309
</p>
<p>Haley NJ, Van de Motter A, Carver S, et al. Prion-seeding activity in cerebrospinal fluid of deer with chronic
wasting disease. PLoS One. 2013;8(11):e81488. doi:10.1371/journal.pone.0081488
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Get calculations using positive controls to normalize values. 
calculation = GetCalculation(raw = cleanraw, meta, norm = TRUE, norm_ct = 'Pos')

head(calculation)

</code></pre>

<hr>
<h2 id='GetReplicate'>Generate Replicate Numbers for Plate Data</h2><span id='topic+GetReplicate'></span>

<h3>Description</h3>

<p>This function takes a plate layout and generates a corresponding matrix of
replicate numbers for each sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetReplicate(plate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetReplicate_+3A_plate">plate</code></td>
<td>
<p>A matrix or data frame representing the plate layout, where each
cell contains a sample identifier or NA for empty wells.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the same dimensions as the input plate, where each
cell contains the replicate number for the corresponding sample in the
input plate.
</p>


<h3>Note</h3>


<ul>
<li><p> Sample identifiers are converted to character type before processing.
</p>
</li>
<li><p> The function assumes that the input plate is organized such that replicate
samples are encountered sequentially.
</p>
</li>
<li><p> The output maintains the column names from the input plate.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>plate &lt;- matrix(
  c("A", "B", "C",
    "A", "B", NA,
    "A", "C", "D"),
  nrow = 3, byrow = TRUE
)

replicates &lt;- GetReplicate(plate)
print(replicates)


</code></pre>

<hr>
<h2 id='PlotMetric'>Create a customizable ggplot for metrics</h2><span id='topic+PlotMetric'></span>

<h3>Description</h3>

<p>This is wrapper function to generate a ggplot object with default options for boxplot and jittered points.
Additional ggplot2 functions can be applied to the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotMetric(
  calculation,
  x = "content",
  y = "RAF",
  fill_var = NULL,
  point = TRUE,
  box = TRUE,
  base_theme = theme_bw(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotMetric_+3A_calculation">calculation</code></td>
<td>
<p>A data frame containing the data to be plotted. Output of <code>GetCalculation</code></p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_x">x</code></td>
<td>
<p>Character string specifying the column name for the x-axis. Default is &quot;content&quot;.</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_y">y</code></td>
<td>
<p>Character string specifying the column name for the y-axis. Default is &quot;RAF&quot;.</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_fill_var">fill_var</code></td>
<td>
<p>The name of the column to be used for fill color, or a vector of colors.
If NULL, no fill color is applied. Default is NULL.</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_point">point</code></td>
<td>
<p>Logical. If TRUE (default), adds jittered points to the plot.</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_box">box</code></td>
<td>
<p>Logical. If TRUE (default), adds a boxplot to the plot.</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_base_theme">base_theme</code></td>
<td>
<p>A ggplot2 theme object. Default is theme_bw().</p>
</td></tr>
<tr><td><code id="PlotMetric_+3A_...">...</code></td>
<td>
<p>Additional ggplot2 functions to be applied to the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Get calculations using positive controls to normalize values. 
calculation = GetCalculation(raw = cleanraw, meta, norm = TRUE, norm_ct = 'Pos')

#Default plot
PlotMetric(calculation)
           
</code></pre>

<hr>
<h2 id='PlotPlate'>Plot Time Series Data</h2><span id='topic+PlotPlate'></span>

<h3>Description</h3>

<p>This function creates a faceted plot of time series data for each well in a plate layout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotPlate(raw, plate_time, format = 96, f_size = 5, fill = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotPlate_+3A_raw">raw</code></td>
<td>
<p>A data frame containing the raw plate data. The first row and
first two columns are assumed to be metadata and are removed.</p>
</td></tr>
<tr><td><code id="PlotPlate_+3A_plate_time">plate_time</code></td>
<td>
<p>Output from <code>ConvertTime()</code>.</p>
</td></tr>
<tr><td><code id="PlotPlate_+3A_format">format</code></td>
<td>
<p>Format of plates used in the experiment. 96 or 384.</p>
</td></tr>
<tr><td><code id="PlotPlate_+3A_f_size">f_size</code></td>
<td>
<p>font size for subtitles.</p>
</td></tr>
<tr><td><code id="PlotPlate_+3A_fill">fill</code></td>
<td>
<p>Logical, whether to fill in missing wells with 0. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object representing the plate data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Plot time series data for each well in a plate layout
PlotPlate(raw = raw, plate_time = plate_time, fill = TRUE)

</code></pre>

<hr>
<h2 id='PlotRawMulti'>Plot Multiple Samples from the Cleaned Raw Data</h2><span id='topic+PlotRawMulti'></span>

<h3>Description</h3>

<p>The function visualizes the fluorescence over time for selected samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotRawMulti(
  raw,
  samples,
  legend_position = "topleft",
  xlim = NULL,
  ylim = NULL,
  custom_colors = NULL,
  xlab = "Time (h)",
  ylab = "Fluorescence",
  linetypes = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotRawMulti_+3A_raw">raw</code></td>
<td>
<p>Cleaned raw data. Output from <code>GetCleanRaw</code>.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_samples">samples</code></td>
<td>
<p>The names of the samples to plot.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_legend_position">legend_position</code></td>
<td>
<p>Position of legend. Default is &quot;topleft&quot;.
Choose from &quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot; and &quot;center&quot;.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector giving the x coordinate range (hours). If NULL (default), limits are computed from the data.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector giving the y coordinate range (relative fluorescence units). If NULL (default), limits are computed from the data.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_custom_colors">custom_colors</code></td>
<td>
<p>An optional vector of colors to be used for plotting.
If NULL (default), the function will use the original color scheme.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis.</p>
</td></tr>
<tr><td><code id="PlotRawMulti_+3A_linetypes">linetypes</code></td>
<td>
<p>Vector of line types to use for each line. Can be integer codes (1:6)
or character codes (&quot;solid&quot;, &quot;dashed&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, &quot;twodash&quot;).
All lines will be solid by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the fluorescence of the selected samples over time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Plot fluorescence curves from negative and positive controls
PlotRawMulti(cleanraw, c("Neg", "Pos"))

</code></pre>

<hr>
<h2 id='PlotRawSingle'>Plot a Single Sample from the Cleaned Raw Data</h2><span id='topic+PlotRawSingle'></span>

<h3>Description</h3>

<p>The function plots fluorescence for selected sample over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotRawSingle(
  raw,
  sample,
  legend_position = "topleft",
  xlim = NULL,
  ylim = NULL,
  custom_colors = NULL,
  xlab = "Time (h)",
  ylab = "Fluorescence",
  linetypes = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotRawSingle_+3A_raw">raw</code></td>
<td>
<p>Cleaned raw data. Output from <code>GetCleanRaw</code></p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_sample">sample</code></td>
<td>
<p>The name of the sample to plot.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_legend_position">legend_position</code></td>
<td>
<p>Position of legend. Default is &quot;topleft&quot;.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_xlim">xlim</code></td>
<td>
<p>Numeric vector giving the x coordinate range (hours). If NULL (default), limits are computed from the data.
Choose from &quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot; and &quot;center&quot;.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vector giving the y coordinate range (relative fluorescence units). If NULL (default), limits are computed from the data.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_custom_colors">custom_colors</code></td>
<td>
<p>An optional vector of colors to be used for plotting.
If NULL (default), the function will use the original color scheme.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis.</p>
</td></tr>
<tr><td><code id="PlotRawSingle_+3A_linetypes">linetypes</code></td>
<td>
<p>Vector of line types to use for each line. Can be integer codes (1:6)
or character codes (&quot;solid&quot;, &quot;dashed&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, &quot;twodash&quot;).
All lines will be solid by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the fluorescence of the selected sample over time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Plot fluorescence curves from positive controls
PlotRawSingle(cleanraw, "Pos")

</code></pre>

<hr>
<h2 id='SpreadCalculation'>Spread Calculation Data</h2><span id='topic+SpreadCalculation'></span>

<h3>Description</h3>

<p>This function takes a data frame containing metadata and calculation results,
and spreads the results into a list of data frames for selected calculation term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpreadCalculation(
  calculation,
  id_col = "content",
  rep_col = "replicate",
  terms = c("RAF", "MPR", "MS")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpreadCalculation_+3A_calculation">calculation</code></td>
<td>
<p>A data frame containing the metadata and results of the calculation. Output from <code>GetCalculation()</code>.</p>
</td></tr>
<tr><td><code id="SpreadCalculation_+3A_id_col">id_col</code></td>
<td>
<p>The name of the column in calculation that identifies the content. Default is 'content'.</p>
</td></tr>
<tr><td><code id="SpreadCalculation_+3A_rep_col">rep_col</code></td>
<td>
<p>The name of the column in calculation that identifies the replicate. Default is 'replicate'.</p>
</td></tr>
<tr><td><code id="SpreadCalculation_+3A_terms">terms</code></td>
<td>
<p>A vector of column names to spread.  Defaults to 'RAF', 'MPR', and 'MS'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames containing the spread results of the calculation. Each data frame is compatible with
various graphing software, particularly GraphPad Prism, which is the most commonly used graphing tool in F-SAA research.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculation &lt;- data.frame(
  content = rep(c("A", "B", "C"), each = 2),
  replicate = rep(1:2, 3),
  time_to_threshold = rnorm(6),
  RAF = rnorm(6),
  MPR = rnorm(6),
  MS = rnorm(6)
  )

calculation_spread = SpreadCalculation(calculation)
print(calculation_spread)

</code></pre>

<hr>
<h2 id='SummarizeResult'>Summarize Analysis Results</h2><span id='topic+SummarizeResult'></span>

<h3>Description</h3>

<p>This function combines analysis results from multiple tests with metadata,
and determines overall significance based on a specified method. By default, it
evaluates sample-level result by calculating the percentage of technical replicates
that exceed the pre-defined threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SummarizeResult(
  analysis = NULL,
  calculation,
  sig_method = "xth_percent",
  method_threshold = 50
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SummarizeResult_+3A_analysis">analysis</code></td>
<td>
<p>Output of <code>GetAnalysis()</code>.</p>
</td></tr>
<tr><td><code id="SummarizeResult_+3A_calculation">calculation</code></td>
<td>
<p>Output of <code>GetCalculation()</code>.</p>
</td></tr>
<tr><td><code id="SummarizeResult_+3A_sig_method">sig_method</code></td>
<td>
<p>Specifies the approach for determining sample-level result.
Available options include &quot;xth_percent&quot;, &quot;metric_count&quot;, &quot;xth_count&quot;,
or any metric name present in the analysis list. The default is &quot;xth_percent&quot;.</p>
</td></tr>
<tr><td><code id="SummarizeResult_+3A_method_threshold">method_threshold</code></td>
<td>
<p>Defines the threshold value for the &quot;metric_count&quot;,
&quot;xth_count&quot;, and &quot;xth_percent&quot; methods. This parameter defaults to 50.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame summarizing results of the analysis and calculation, with columns:
</p>

<ul>
<li><p> result: Overall result based on the chosen method
</p>
</li>
<li><p> position: Location of the sample replications based on plate layout
</p>
</li>
<li><p> method: Method chosen for determination of the result
</p>
</li>
<li><p> *_sig: Significance indicator for each metric
</p>
</li>
<li><p> *_p: P-value or adjusted p-value for each metric
</p>
</li>
<li><p> metric_count: Count of significant results across all analyses
</p>
</li>
<li><p> xth_count: The number of reactions crossing the fluorescent threshold
</p>
</li>
<li><p> total_rep: Total number of replicates
</p>
</li>
<li><p> xth_percent: Percentage of replicates crossing the fluorescent threshold
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Define the path to the plate data file
plate_path &lt;- system.file("extdata/20240716_p3", 
                          file = '20240716_p3_plate.xlsx', 
                          package = "QuICSeedR")
  
# Read the plate data
plate &lt;- readxl::read_xlsx(plate_path)

# Define the path to the raw data file
raw_path &lt;- system.file("extdata/20240716_p3", 
                        file = '20240716_p3_raw.xlsx', 
                        package = "QuICSeedR")
# Read the raw data
raw &lt;- readxl::read_xlsx(raw_path)

# Get replicate data
replicate &lt;- GetReplicate(plate)

# Ensure time displayed as decimal hours
plate_time = ConvertTime(raw)

#Get metadata and display the few rows 
meta = CleanMeta(raw, plate, replicate)

#Clean data 
cleanraw &lt;- CleanRaw(meta, raw, plate_time)

#Get calculations using positive controls to normalize values. 
calculation = GetCalculation(raw = cleanraw, meta, sd_fold = 10)

#Formatting calculations for analysis (also compatible with graphing softwares used in F-SAA 
#research)
calculation_spread = SpreadCalculation(calculation)

#Get analysis comparing samples to negative control using the one-tailed Wilcox Rank-Sum test.
analysis &lt;- GetAnalysis(calculation_spread, control = "Neg", test = "wilcox", 
                        alternative = 'greater')
                        
#Summarization of results. Default method is rate of amyloid formation.
result &lt;- SummarizeResult(analysis, calculation)

head(result)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
