<!DOCTYPE html><html lang="en"><head><title>Help for package rTPC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rTPC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bacteria_tpc'><p>Example thermal performance curves of bacterial growth</p></a></li>
<li><a href='#beta_2012'><p>Beta model for fitting thermal performance curves</p></a></li>
<li><a href='#boatman_2017'><p>Boatman model for fitting thermal performance curves</p></a></li>
<li><a href='#briere2_1999'><p>Briere2 model for fitting thermal performance curves</p></a></li>
<li><a href='#calc_params'><p>Calculate extra parameters of a thermal performance curve</p></a></li>
<li><a href='#chlorella_tpc'><p>Example metabolic thermal performance curves</p></a></li>
<li><a href='#delong_2017'><p>DeLong enzyme-assisted Arrhenius model for fitting thermal performance curves</p></a></li>
<li><a href='#deutsch_2008'><p>Modified deutsch model for fitting thermal performance curves</p></a></li>
<li><a href='#flinn_1991'><p>Flinn model for fitting thermal performance curves</p></a></li>
<li><a href='#gaussian_1987'><p>Gaussian model for fitting thermal performance curves</p></a></li>
<li><a href='#get_breadth'><p>Estimate thermal performance breadth of a thermal performance curve</p></a></li>
<li><a href='#get_ctmax'><p>Estimate the critical thermal maximum of a thermal performance curve</p></a></li>
<li><a href='#get_ctmin'><p>Estimate the critical thermal minimum of a thermal performance curve</p></a></li>
<li><a href='#get_e'><p>Estimate the activation energy of a thermal performance curve</p></a></li>
<li><a href='#get_eh'><p>Estimate the deactivation energy of a thermal performance curve</p></a></li>
<li><a href='#get_lower_lims'><p>Set broad lower limits on parameter values</p></a></li>
<li><a href='#get_model_names'><p>Lists the models available in rTPC</p></a></li>
<li><a href='#get_q10'><p>Estimate the q10 value of a thermal performance curve</p></a></li>
<li><a href='#get_rmax'><p>Estimate maximum rate of a thermal performance curve</p></a></li>
<li><a href='#get_skewness'><p>Estimates skewness of a thermal performance curve</p></a></li>
<li><a href='#get_start_vals'><p>Estimate start values for TPC fitting</p></a></li>
<li><a href='#get_thermalsafetymargin'><p>Estimate thermal safety margin of a thermal performance curve</p></a></li>
<li><a href='#get_thermaltolerance'><p>Estimate thermal tolerance of a thermal performance curve</p></a></li>
<li><a href='#get_topt'><p>Estimate optimum temperature of a thermal performance curve</p></a></li>
<li><a href='#get_upper_lims'><p>Set broad upper limits on parameter values</p></a></li>
<li><a href='#hinshelwood_1947'><p>Hinshelwood model for fitting thermal performance curves</p></a></li>
<li><a href='#joehnk_2008'><p>Jöhnk model for fitting thermal performance curves</p></a></li>
<li><a href='#johnsonlewin_1946'><p>Johnson-Lewin model for fitting thermal performance curves</p></a></li>
<li><a href='#kamykowski_1985'><p>Kamykowski model for fitting thermal performance curves</p></a></li>
<li><a href='#lactin2_1995'><p>Lactin2 model for fitting thermal performance curves</p></a></li>
<li><a href='#lrf_1991'><p>Lobry-Rosso-Flandros (LRF) model for fitting thermal performance curves</p></a></li>
<li><a href='#modifiedgaussian_2006'><p>Modified gaussian model for fitting thermal performance curves</p></a></li>
<li><a href='#oneill_1972'><p>O'Neill model for fitting thermal performance curves</p></a></li>
<li><a href='#pawar_2018'><p>Pawar model for fitting thermal performance curves</p></a></li>
<li><a href='#quadratic_2008'><p>Quadratic model for fitting thermal performance curves</p></a></li>
<li><a href='#ratkowsky_1983'><p>Ratkowsky model for fitting thermal performance curves</p></a></li>
<li><a href='#rezende_2019'><p>Rezende model for fitting thermal performance curves</p></a></li>
<li><a href='#sharpeschoolfull_1981'><p>Full Sharpe-Schoolfield model for fitting thermal performance curves</p></a></li>
<li><a href='#sharpeschoolhigh_1981'><p>Sharpe-Schoolfield model (high temperature inactivation only) for fitting thermal performance curves</p></a></li>
<li><a href='#sharpeschoollow_1981'><p>Sharpe-Schoolfield model (low temperature inactivation only) for fitting thermal performance curves</p></a></li>
<li><a href='#spain_1982'><p>Spain model for fitting thermal performance curves</p></a></li>
<li><a href='#thomas_2012'><p>Thomas model (2012) for fitting thermal performance curves</p></a></li>
<li><a href='#thomas_2017'><p>Thomas model (2017) for fitting thermal performance curves</p></a></li>
<li><a href='#weibull_1995'><p>Weibull model for fitting thermal performance curves</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting and Analysing Thermal Performance Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Padfield &lt;d.padfield@exeter.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Helps to fit thermal performance curves (TPCs). 'rTPC' contains 26 model formulations previously used to fit TPCs and has helper functions to set sensible start parameters, upper and lower parameter limits and estimate parameters useful in downstream analyses, such as cardinal temperatures, maximum rate and optimum temperature. See Padfield et al. (2021) &lt;<a href="https://doi.org/10.1111%2F2041-210X.13585">doi:10.1111/2041-210X.13585</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/padpadpadpad/rTPC">https://github.com/padpadpadpad/rTPC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/padpadpadpad/rTPC/issues">https://github.com/padpadpadpad/rTPC/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>boot, broom, car, forcats, ggplot2, ggrepel, knitr,
minpack.lm, MuMIn, nls.multstart, nlstools, patchwork,
progress, RColorBrewer, rmarkdown, stringr, testthat, tidyverse</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-16 11:41:10 UTC; dp415</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Padfield [aut, cre],
  Hannah O'Sullivan [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-17 06:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='bacteria_tpc'>Example thermal performance curves of bacterial growth</h2><span id='topic+bacteria_tpc'></span>

<h3>Description</h3>

<p>A dataset containing example data of growth rates of the bacteria Pseudomonas fluorescens in the presence and absence of its phage, phi2. Growth rates were measured across a range of assay temperatures to incorporate the entire thermal performance of the bacteria The dataset is the cleaned version so some data points have been omitted. There are multiple independent measurements per temperature for each treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bacteria_tpc")
</code></pre>


<h3>Format</h3>

<p>A data frame with 649 rows and 7 variables:
</p>

<dl>
<dt>phage</dt><dd><p>whether the bacteria was grown with or without phage</p>
</dd>
<dt>temp</dt><dd><p>the assay temperature at which the growth rate was measured (degrees centigrade)</p>
</dd>
<dt>rate</dt><dd><p>estimated growth rate per hour</p>
</dd>
</dl>



<h3>Source</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Padfield, D., Castledine, M., &amp; Buckling, A. (2020). Temperature-dependent changes to host–parasite interactions alter the thermal performance of a bacterial host. The ISME Journal, 14(2), 389-398.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bacteria_tpc")
library(ggplot2)
ggplot(bacteria_tpc) +
 geom_point(aes(temp, rate, col = phage))
</code></pre>

<hr>
<h2 id='beta_2012'>Beta model for fitting thermal performance curves</h2><span id='topic+beta_2012'></span>

<h3>Description</h3>

<p>Beta model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta_2012(temp, a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beta_2012_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="beta_2012_+3A_a">a</code></td>
<td>
<p>dimensionless parameter</p>
</td></tr>
<tr><td><code id="beta_2012_+3A_b">b</code></td>
<td>
<p>dimensionless parameter</p>
</td></tr>
<tr><td><code id="beta_2012_+3A_c">c</code></td>
<td>
<p>dimensionless parameter</p>
</td></tr>
<tr><td><code id="beta_2012_+3A_d">d</code></td>
<td>
<p>dimensionless parameter</p>
</td></tr>
<tr><td><code id="beta_2012_+3A_e">e</code></td>
<td>
<p>dimensionless parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate=\frac{a\left(\frac{temp-b+\frac{c(d-1)}{d+e-2}}{c}\right)^{d-1}  \cdot \left(1-\frac{temp-b+\frac{c(d-1)}{d+e-2}}{c}\right)^{e-1}}{{\left(\frac{d-1}{d+e-2}\right)}^{d-1}\cdot \left(\frac{e-1}{d+e-2}\right)^{e-1}}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model difficult to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Niehaus, Amanda C., et al. Predicting the physiological performance of ectotherms in fluctuating thermal environments. Journal of Experimental Biology 215.4: 694-701 (2012)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'beta_2012')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~beta_2012(temp = temp, a, b, c, d, e),
data = d,
iter = c(7,7,7,7,7),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'beta_2012'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'beta_2012'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='boatman_2017'>Boatman model for fitting thermal performance curves</h2><span id='topic+boatman_2017'></span>

<h3>Description</h3>

<p>Boatman model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boatman_2017(temp, rmax, tmin, tmax, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boatman_2017_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="boatman_2017_+3A_rmax">rmax</code></td>
<td>
<p>the rate at optimum temperature</p>
</td></tr>
<tr><td><code id="boatman_2017_+3A_tmin">tmin</code></td>
<td>
<p>low temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="boatman_2017_+3A_tmax">tmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="boatman_2017_+3A_a">a</code></td>
<td>
<p>shape parameter to adjust the skewness of the curve</p>
</td></tr>
<tr><td><code id="boatman_2017_+3A_b">b</code></td>
<td>
<p>shape  parameter to adjust the kurtosis of the curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= r_{max} \cdot \left(sin\bigg(\pi\left(\frac{temp-t_{min}}{t_{max} - t_{min}}\right)^{a}\bigg)\right)^{b}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Boatman, T. G., Lawson, T., &amp; Geider, R. J. A key marine diazotroph in a changing ocean: The interacting effects of temperature, CO2 and light on the growth of Trichodesmium erythraeum IMS101. PLoS ONE, 12, e0168796 (2017)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'boatman_2017')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~boatman_2017(temp = temp, rmax, tmin, tmax, a, b),
data = d,
iter = c(4,4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'boatman_2017'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'boatman_2017'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()
</code></pre>

<hr>
<h2 id='briere2_1999'>Briere2 model for fitting thermal performance curves</h2><span id='topic+briere2_1999'></span>

<h3>Description</h3>

<p>Briere2 model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>briere2_1999(temp, tmin, tmax, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="briere2_1999_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="briere2_1999_+3A_tmin">tmin</code></td>
<td>
<p>low temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="briere2_1999_+3A_tmax">tmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="briere2_1999_+3A_a">a</code></td>
<td>
<p>scale parameter to adjust maximum rate of the curve</p>
</td></tr>
<tr><td><code id="briere2_1999_+3A_b">b</code></td>
<td>
<p>shape parameter to adjust the asymmetry of the curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate=a\cdot temp \cdot(temp - t_{min}) \cdot (t_{max} - temp)^{\frac{1}{b}}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Brière, J.F., Pracros, P., Le Roux, A.Y., Pierre, J.S.,  A novel rate model of temperature-dependent development for arthropods. Environmental Entomololgy, 28, 22–29 (1999)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'briere2_1999')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~briere2_1999(temp = temp, tmin, tmax, a, b),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'briere2_1999'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'briere2_1999'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()
</code></pre>

<hr>
<h2 id='calc_params'>Calculate extra parameters of a thermal performance curve</h2><span id='topic+calc_params'></span>

<h3>Description</h3>

<p>Calculate extra parameters of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_params(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_params_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently estimates:
</p>

<ul>
<li><p> maximum rate (rmax) using <code><a href="#topic+get_rmax">get_rmax()</a></code>
</p>
</li>
<li><p> optimum temperature (topt) using <code><a href="#topic+get_topt">get_topt()</a></code>
</p>
</li>
<li><p> critical thermal maximum (ctmax) using <code><a href="#topic+get_ctmax">get_ctmax()</a></code>
</p>
</li>
<li><p> critical thermal minimum (ctmin) using <code><a href="#topic+get_ctmin">get_ctmin()</a></code>
</p>
</li>
<li><p> activation energy (e) using <code><a href="#topic+get_e">get_e()</a></code>
</p>
</li>
<li><p> deactivation energy (eh) using <code><a href="#topic+get_eh">get_eh()</a></code>
</p>
</li>
<li><p> q10 value using <code><a href="#topic+get_q10">get_q10()</a></code>
</p>
</li>
<li><p> thermal safety margin using <code><a href="#topic+get_thermalsafetymargin">get_thermalsafetymargin()</a></code>
</p>
</li>
<li><p> thermal tolerance using <code><a href="#topic+get_thermaltolerance">get_thermaltolerance()</a></code>
</p>
</li>
<li><p> thermal performance breadth using <code><a href="#topic+get_breadth">get_breadth()</a></code>
</p>
</li>
<li><p> skewness using <code><a href="#topic+get_skewness">get_skewness()</a></code>
</p>
</li></ul>



<h3>Value</h3>

<p>a dataframe containing the estimates of key TPC traits for a given model object. If any parameters cannot be calculated for a thermal performance curve, they will return <code>NA</code>.
</p>

<hr>
<h2 id='chlorella_tpc'>Example metabolic thermal performance curves</h2><span id='topic+chlorella_tpc'></span>

<h3>Description</h3>

<p>A dataset containing example data of rates of photosynthesis and respiration of the phytoplankton Chlorella vulgaris. Instantaneous rates of metabolism were made across a range of assay temperatures to incorporate the entire thermal performance of the populations. The dataset is the cleaned version so some datapoints have been omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chlorella_tpc")
</code></pre>


<h3>Format</h3>

<p>A data frame with 649 rows and 7 variables:
</p>

<dl>
<dt>curve_id</dt><dd><p>a unique value for each separate curve</p>
</dd>
<dt>growth_temp</dt><dd><p>the growth temperature that the culture was maintained at before measurements were taken (degrees centigrade)</p>
</dd>
<dt>process</dt><dd><p>whether the cultures had been kept for a long time at their growth temperature (adaptation/~100 generations) or a short time (a measure of acclimation/~10 generations)</p>
</dd>
<dt>flux</dt><dd><p>whether the curve depicts respiration or gross photosynthesis</p>
</dd>
<dt>temp</dt><dd><p>the assay temperature at which the metabolic rate was measured (degrees centigrade)</p>
</dd>
<dt>rate</dt><dd><p>the metabolic rate measured (micro mol O2 micro gram C-1 hr-1)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Padfield, D., Yvon-durocher, G., Buckling, A., Jennings, S. &amp; Yvon-durocher, G. (2015). Rapid evolution of metabolic traits explains thermal adaptation in phytoplankton, Ecology Letters, 19, 133-142.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("chlorella_tpc")
library(ggplot2)
ggplot(chlorella_tpc) +
 geom_point(aes(temp, rate, col = process)) +
 facet_wrap(~ growth_temp + flux)
</code></pre>

<hr>
<h2 id='delong_2017'>DeLong enzyme-assisted Arrhenius model for fitting thermal performance curves</h2><span id='topic+delong_2017'></span>

<h3>Description</h3>

<p>DeLong enzyme-assisted Arrhenius model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delong_2017(temp, c, eb, ef, tm, ehc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delong_2017_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="delong_2017_+3A_c">c</code></td>
<td>
<p>potential reaction rate</p>
</td></tr>
<tr><td><code id="delong_2017_+3A_eb">eb</code></td>
<td>
<p>baseline energy needed for the reaction to occur (eV)</p>
</td></tr>
<tr><td><code id="delong_2017_+3A_ef">ef</code></td>
<td>
<p>temperature dependence of folding the enzymes used in the metabolic reaction, relative to the melting temperature (eV)</p>
</td></tr>
<tr><td><code id="delong_2017_+3A_tm">tm</code></td>
<td>
<p>melting temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="delong_2017_+3A_ehc">ehc</code></td>
<td>
<p>temperature dependence of the heat capacity between the folded and unfolded state of the enzymes, relative to the melting temperature (eV)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = c \cdot exp\frac{-(e_b-(e_f(1-\frac{temp + 273.15}{t_m})+e_{hc} \cdot ((temp + 273.15) - t_m - (temp + 273.15) \cdot ln(\frac{temp + 273.15}{t_m}))))}{k \cdot (temp + 273.15)}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05 and <code>tm</code> is actually <code>tm - 273.15</code>
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>DeLong, John P., et al. The combined effects of reactant kinetics and enzyme stability explain the temperature dependence of metabolic rates. Ecology and evolution 7.11 (2017): 3940-3950.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'delong_2017')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~delong_2017(temp = temp, c, eb, ef, tm,ehc),
data = d,
iter = c(4,4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'delong_2017'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'delong_2017'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()
</code></pre>

<hr>
<h2 id='deutsch_2008'>Modified deutsch model for fitting thermal performance curves</h2><span id='topic+deutsch_2008'></span>

<h3>Description</h3>

<p>Modified deutsch model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deutsch_2008(temp, rmax, topt, ctmax, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deutsch_2008_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="deutsch_2008_+3A_rmax">rmax</code></td>
<td>
<p>maximum rate at optimum temperature</p>
</td></tr>
<tr><td><code id="deutsch_2008_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
<tr><td><code id="deutsch_2008_+3A_ctmax">ctmax</code></td>
<td>
<p>critical thermal maximum (ºC)</p>
</td></tr>
<tr><td><code id="deutsch_2008_+3A_a">a</code></td>
<td>
<p>related to the full curve width</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{if} \quad temp &lt; t_{opt}: rate = r_{max} \cdot exp^{-\bigg(\frac{temp-t_{opt}}{2a}\bigg)^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{if} \quad temp &gt; t_{opt}: rate = r_{max} \cdot \left(1 - \bigg(\frac{temp - t_{opt}}{t_{opt} - ct_{max}}\bigg)^2\right)</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Deutsch, C. A., Tewksbury, J. J., Huey, R. B., Sheldon, K. S., Ghalambor, C. K., Haak, D. C., &amp; Martin, P. R. Impacts of climate warming on terrestrial ectotherms across latitude. Proceedings of the National Academy of Sciences, 105(18), 6668-6672. (2008)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'deutsch_2008')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~deutsch_2008(temp = temp, rmax, topt, ctmax, a),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'deutsch_2008'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'deutsch_2008'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='flinn_1991'>Flinn model for fitting thermal performance curves</h2><span id='topic+flinn_1991'></span>

<h3>Description</h3>

<p>Flinn model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flinn_1991(temp, a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flinn_1991_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="flinn_1991_+3A_a">a</code></td>
<td>
<p>parameter that controls the height of the curve</p>
</td></tr>
<tr><td><code id="flinn_1991_+3A_b">b</code></td>
<td>
<p>parameter that controls the slope of the initial increase of the curve</p>
</td></tr>
<tr><td><code id="flinn_1991_+3A_c">c</code></td>
<td>
<p>parameter that controls the position and steepness of the decline of the curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{1}{1+a+b \cdot temp+c \cdot temp^2}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from previous methods from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Flinn PW Temperature-dependent functional response of the parasitoid Cephalonomia waterstoni (Gahan) (Hymenoptera, Bethylidae) attacking rusty grain beetle larvae (Coleoptera, Cucujidae). Environmental Entomology, 20, 872–876, (1991)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'flinn_1991')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~flinn_1991(temp = temp, a, b, c),
data = d,
iter = c(4,4,4),
start_lower = start_vals - 1,
start_upper = start_vals + 1,
lower = get_lower_lims(d$temp, d$rate, model_name = 'flinn_1991'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'flinn_1991'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()
</code></pre>

<hr>
<h2 id='gaussian_1987'>Gaussian model for fitting thermal performance curves</h2><span id='topic+gaussian_1987'></span>

<h3>Description</h3>

<p>Gaussian model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gaussian_1987(temp, rmax, topt, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gaussian_1987_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="gaussian_1987_+3A_rmax">rmax</code></td>
<td>
<p>maximum rate at optimum temperature</p>
</td></tr>
<tr><td><code id="gaussian_1987_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
<tr><td><code id="gaussian_1987_+3A_a">a</code></td>
<td>
<p>related to the full curve width</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = r_{max} \cdot exp^{\bigg(-0.5 \left(\frac{|temp-t_{opt}|}{a}\right)^2\bigg)}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Lynch, M., Gabriel, W., Environmental tolerance. The American Naturalist. 129, 283–303. (1987)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'gaussian_1987')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~gaussian_1987(temp = temp,rmax, topt,a),
data = d,
iter = c(4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'gaussian_1987'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'gaussian_1987'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='get_breadth'>Estimate thermal performance breadth of a thermal performance curve</h2><span id='topic+get_breadth'></span>

<h3>Description</h3>

<p>Estimate thermal performance breadth of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_breadth(model, level = 0.8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_breadth_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
<tr><td><code id="get_breadth_+3A_level">level</code></td>
<td>
<p>proportion of maximum rate over which thermal performance breadth is calculated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thermal performance breadth is calculated as the range of temperatures over which a curve's rate is at least 0.8 of peak. This defaults to a proportion of 0.8 but can be changed using the <code>level</code> argument.
</p>


<h3>Value</h3>

<p>Numeric estimate of thermal performance breadth (in ºC)
</p>

<hr>
<h2 id='get_ctmax'>Estimate the critical thermal maximum of a thermal performance curve</h2><span id='topic+get_ctmax'></span>

<h3>Description</h3>

<p>Estimate the critical thermal maximum of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ctmax(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ctmax_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Critical thermal maximum is calculated by predicting over a temperature range 50 ºC beyond the maximum value in the dataset. The predicted rate value closest to 0 is then extracted. When this is impossible due to the curve formula (i.e the Sharpe-Schoolfield model), the temperature where the rate is 5 percent of the maximum rate is estimated. Predictions are done every 0.001 ºC so the estimate of the critical thermal maximum should be accurate up to 0.001 ºC.
</p>


<h3>Value</h3>

<p>Numeric estimate of critical thermal maximum (ºC)
</p>

<hr>
<h2 id='get_ctmin'>Estimate the critical thermal minimum of a thermal performance curve</h2><span id='topic+get_ctmin'></span>

<h3>Description</h3>

<p>Estimate the critical thermal minimum of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ctmin(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ctmin_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optimum temperature is calculated by predicting over a temperature range 50 degrees lower than the minimum value in the dataset. The predicted rate value closest to 0 is then extracted. When this is impossible due to the curve formula (i.e the Sharpe-Schoolfield model), the temperature where the rate is 5 percent of the maximum rate is estimated. Predictions are done every 0.001 ºC value so the estimate of the critical thermal minimum should be accurate up to 0.001 ºC.
</p>


<h3>Value</h3>

<p>Numeric estimate of critical thermal minimum (ºC)
</p>

<hr>
<h2 id='get_e'>Estimate the activation energy of a thermal performance curve</h2><span id='topic+get_e'></span>

<h3>Description</h3>

<p>Estimate the activation energy of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_e(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_e_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a modified-Boltzmann equation to all raw data below the optimum temperature (ºC; as estimated by <code>get_topt</code>).
</p>


<h3>Value</h3>

<p>Numeric estimate of activation energy (eV)
</p>

<hr>
<h2 id='get_eh'>Estimate the deactivation energy of a thermal performance curve</h2><span id='topic+get_eh'></span>

<h3>Description</h3>

<p>Estimate the deactivation energy of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eh(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_eh_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a modified-Boltzmann equation to all raw data beyond the optimum temperature (ºC; as estimated by <code>get_topt</code>).
</p>


<h3>Value</h3>

<p>Numeric estimate of activation energy (eV)
</p>

<hr>
<h2 id='get_lower_lims'>Set broad lower limits on parameter values</h2><span id='topic+get_lower_lims'></span>

<h3>Description</h3>

<p>Sets wide lower limits on parameter values for each TPC model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lower_lims(x, y, model_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_lower_lims_+3A_x">x</code></td>
<td>
<p>vector of temperature values</p>
</td></tr>
<tr><td><code id="get_lower_lims_+3A_y">y</code></td>
<td>
<p>vector of rate values</p>
</td></tr>
<tr><td><code id="get_lower_lims_+3A_model_name">model_name</code></td>
<td>
<p>the name of the model being fitted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of lower limits given the data and model being fitted
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>

<hr>
<h2 id='get_model_names'>Lists the models available in rTPC</h2><span id='topic+get_model_names'></span>

<h3>Description</h3>

<p>Lists the models available in rTPC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_model_names()
</code></pre>


<h3>Value</h3>

<p>character vector of thermal performance curves available in rTPC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_model_names()
</code></pre>

<hr>
<h2 id='get_q10'>Estimate the q10 value of a thermal performance curve</h2><span id='topic+get_q10'></span>

<h3>Description</h3>

<p>Estimate the q10 value of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_q10(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_q10_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits the q10 portion of <code>rezende_2019</code> to all raw data below the optimum temperature (ºC; as estimated by <code>get_topt</code>).
</p>


<h3>Value</h3>

<p>Numeric estimate of q10 value
</p>

<hr>
<h2 id='get_rmax'>Estimate maximum rate of a thermal performance curve</h2><span id='topic+get_rmax'></span>

<h3>Description</h3>

<p>Estimate maximum rate of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rmax(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rmax_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Maximum rate is calculated by predicting over the temperature range using the previously estimated parameters and picking the maximum rate value. Predictions are done every 0.001 ºC.
</p>


<h3>Value</h3>

<p>Numeric estimate of maximum rate
</p>

<hr>
<h2 id='get_skewness'>Estimates skewness of a thermal performance curve</h2><span id='topic+get_skewness'></span>

<h3>Description</h3>

<p>Estimates skewness of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_skewness(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_skewness_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Skewness is calculated from the values of activation energy (e) and deactivation energy (eh) as: skewness = e - eh. A negative skewness indicates the TPC is left skewed, the drop after the optimum is steeper than the rise up to the optimum. A positive skewness means that the TPC is right skewed and a value of 0 would mean the curve is symmetrical around the optimum.
</p>


<h3>Value</h3>

<p>Numeric estimate of skewness
</p>

<hr>
<h2 id='get_start_vals'>Estimate start values for TPC fitting</h2><span id='topic+get_start_vals'></span>

<h3>Description</h3>

<p>Estimates sensible start values for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_start_vals(x, y, model_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_start_vals_+3A_x">x</code></td>
<td>
<p>vector of temperature values</p>
</td></tr>
<tr><td><code id="get_start_vals_+3A_y">y</code></td>
<td>
<p>vector of rate values</p>
</td></tr>
<tr><td><code id="get_start_vals_+3A_model_name">model_name</code></td>
<td>
<p>the name of the model being fitted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of start parameters given the data and model being fitted
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>

<hr>
<h2 id='get_thermalsafetymargin'>Estimate thermal safety margin of a thermal performance curve</h2><span id='topic+get_thermalsafetymargin'></span>

<h3>Description</h3>

<p>Estimate thermal safety margin of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_thermalsafetymargin(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_thermalsafetymargin_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thermal safety margin is calculated as: CTmax - Topt. This is calculated using the functions <code>get_ctmax</code> and <code>get_topt</code>.
</p>


<h3>Value</h3>

<p>Numeric estimate of thermal safety margin (in ºC)
</p>

<hr>
<h2 id='get_thermaltolerance'>Estimate thermal tolerance of a thermal performance curve</h2><span id='topic+get_thermaltolerance'></span>

<h3>Description</h3>

<p>Estimate thermal tolerance of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_thermaltolerance(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_thermaltolerance_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Thermal tolerance is calculated as: CTmax - CTmin. This is calculated using the functions <code>get_ctmax</code> and <code>get_ctmin</code>.
</p>


<h3>Value</h3>

<p>Thermal tolerance (in ºC)
</p>

<hr>
<h2 id='get_topt'>Estimate optimum temperature of a thermal performance curve</h2><span id='topic+get_topt'></span>

<h3>Description</h3>

<p>Estimate optimum temperature of a thermal performance curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_topt(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_topt_+3A_model">model</code></td>
<td>
<p>nls model object that contains a model of a thermal performance curve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optimum temperature (ºC) is calculated by predicting over the temperature range using the previously estimated parameters and keeping the temperature where the largest rate value occurs. Predictions are done every 0.001 ºC so the estimate of optimum temperature should be accurate up to 0.001 ºC.
</p>


<h3>Value</h3>

<p>Numeric estimate of optimum temperature (in ºC)
</p>

<hr>
<h2 id='get_upper_lims'>Set broad upper limits on parameter values</h2><span id='topic+get_upper_lims'></span>

<h3>Description</h3>

<p>Sets wide upper limits on parameter values for each TPC model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_upper_lims(x, y, model_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_upper_lims_+3A_x">x</code></td>
<td>
<p>vector of temperature values</p>
</td></tr>
<tr><td><code id="get_upper_lims_+3A_y">y</code></td>
<td>
<p>vector of rate values</p>
</td></tr>
<tr><td><code id="get_upper_lims_+3A_model_name">model_name</code></td>
<td>
<p>the name of the model being fitted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of upper limits given the data and model being fitted
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>

<hr>
<h2 id='hinshelwood_1947'>Hinshelwood model for fitting thermal performance curves</h2><span id='topic+hinshelwood_1947'></span>

<h3>Description</h3>

<p>Hinshelwood model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hinshelwood_1947(temp, a, e, b, eh)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hinshelwood_1947_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="hinshelwood_1947_+3A_a">a</code></td>
<td>
<p>pre-exponential constant for the activation energy</p>
</td></tr>
<tr><td><code id="hinshelwood_1947_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="hinshelwood_1947_+3A_b">b</code></td>
<td>
<p>pre-exponential constant for the deactivation energy</p>
</td></tr>
<tr><td><code id="hinshelwood_1947_+3A_eh">eh</code></td>
<td>
<p>de-activation energy (eV)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate=a \cdot exp^{\frac{-e}{k \cdot (temp + 273.15)}} - b \cdot exp^\frac{-e_h}{k \cdot (temp + 273.15)}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05
</p>
<p>Start values in <code>get_start_vals</code> are taken from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model difficult to fit.
</p>


<h3>References</h3>

<p>Hinshelwood C.N. The Chemical Kinetics of the Bacterial Cell. Oxford University Press. (1947)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'hinshelwood_1947')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~hinshelwood_1947(temp = temp,a, e, b, eh),
data = d,
iter = c(5,5,5,5),
start_lower = start_vals - 1,
start_upper = start_vals + 1,
lower = get_lower_lims(d$temp, d$rate, model_name = 'hinshelwood_1947'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'hinshelwood_1947'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='joehnk_2008'>Jöhnk model for fitting thermal performance curves</h2><span id='topic+joehnk_2008'></span>

<h3>Description</h3>

<p>Jöhnk model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joehnk_2008(temp, rmax, topt, a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="joehnk_2008_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="joehnk_2008_+3A_rmax">rmax</code></td>
<td>
<p>the rate at optimum temperature</p>
</td></tr>
<tr><td><code id="joehnk_2008_+3A_topt">topt</code></td>
<td>
<p>optimum temperatute (ºC)</p>
</td></tr>
<tr><td><code id="joehnk_2008_+3A_a">a</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
<tr><td><code id="joehnk_2008_+3A_b">b</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
<tr><td><code id="joehnk_2008_+3A_c">c</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate=r_{max} \bigg(1 + a \bigg(\bigg(b^{temp-t_{opt}} -1\bigg) - \frac{ln(b)}{ln(c)}(c^{temp-t_{opt}} -1)\bigg)\bigg)</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Joehnk, Klaus D., et al. Summer heatwaves promote blooms of harmful cyanobacteria. Global change biology 14.3: 495-512 (2008)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'joehnk_2008')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~joehnk_2008(temp = temp, rmax, topt, a, b, c),
data = d,
iter = c(3,3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'joehnk_2008'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'joehnk_2008'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='johnsonlewin_1946'>Johnson-Lewin model for fitting thermal performance curves</h2><span id='topic+johnsonlewin_1946'></span>

<h3>Description</h3>

<p>Johnson-Lewin model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>johnsonlewin_1946(temp, r0, e, eh, topt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="johnsonlewin_1946_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="johnsonlewin_1946_+3A_r0">r0</code></td>
<td>
<p>scaling parameter</p>
</td></tr>
<tr><td><code id="johnsonlewin_1946_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="johnsonlewin_1946_+3A_eh">eh</code></td>
<td>
<p>high temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="johnsonlewin_1946_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{r_0 \cdot exp^{\frac{-e}{k\cdot (temp + 273.15)}}}{1 + exp^{-\frac{e_h -\big(\frac{e_h}{(t_{opt} + 273.15)} + k \cdot ln\big(\frac{e}{e_h - e}\big) \big) \cdot (temp + 273.15)}{k \cdot (temp + 273.15)}}}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05.
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model difficult to fit.
</p>


<h3>References</h3>

<p>Johnson, Frank H., and Isaac Lewin. The growth rate of E. coli in relation to temperature, quinine and coenzyme. Journal of Cellular and Comparative Physiology 28.1 (1946): 47-75.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'johnsonlewin_1946')
# fit model
mod &lt;- suppressWarnings(
nls.multstart::nls_multstart(rate~johnsonlewin_1946(temp = temp, r0, e, eh, topt),
data = d,
iter = c(5,5,5,5),
start_lower = start_vals - 1,
start_upper = start_vals + 1,
lower = get_lower_lims(d$temp, d$rate, model_name = 'johnsonlewin_1946'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'johnsonlewin_1946'),
supp_errors = 'Y',
convergence_count = FALSE)
)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='kamykowski_1985'>Kamykowski model for fitting thermal performance curves</h2><span id='topic+kamykowski_1985'></span>

<h3>Description</h3>

<p>Kamykowski model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kamykowski_1985(temp, tmin, tmax, a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kamykowski_1985_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="kamykowski_1985_+3A_tmin">tmin</code></td>
<td>
<p>low temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="kamykowski_1985_+3A_tmax">tmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="kamykowski_1985_+3A_a">a</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
<tr><td><code id="kamykowski_1985_+3A_b">b</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
<tr><td><code id="kamykowski_1985_+3A_c">c</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= a \cdot \big( 1 - exp^{-b\cdot \big(temp-t_{min}\big)}\big) \cdot \big( 1-exp^{-c \cdot \big(t_{max}-temp\big)}\big)</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Kamykowski, Daniel. A survey of protozoan laboratory temperature studies applied to marine dinoflagellate behaviour from a field perspective. Contributions in Marine Science. (1985).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'kamykowski_1985')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~kamykowski_1985(temp = temp, tmin, tmax, a, b, c),
data = d,
iter = c(3,3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'kamykowski_1985'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'kamykowski_1985'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='lactin2_1995'>Lactin2 model for fitting thermal performance curves</h2><span id='topic+lactin2_1995'></span>

<h3>Description</h3>

<p>Lactin2 model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lactin2_1995(temp, a, b, tmax, delta_t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lactin2_1995_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="lactin2_1995_+3A_a">a</code></td>
<td>
<p>constant that determines the steepness of the rising portion of the curve</p>
</td></tr>
<tr><td><code id="lactin2_1995_+3A_b">b</code></td>
<td>
<p>constant that determines the height of the overall curve</p>
</td></tr>
<tr><td><code id="lactin2_1995_+3A_tmax">tmax</code></td>
<td>
<p>the temperature at which the curve begins to decelerate beyond the optimum (ºC)</p>
</td></tr>
<tr><td><code id="lactin2_1995_+3A_delta_t">delta_t</code></td>
<td>
<p>thermal safety margin (ºC)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= = exp^{a \cdot temp} - exp^{a \cdot t_{max} - \bigg(\frac{t_{max} - temp}{\delta _{t}}\bigg)} + b</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or sensible values from the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Lactin, D.J., Holliday, N.J., Johnson, D.L. &amp; Craigen, R. Improved rate models of temperature-dependent development by arthropods. Environmental Entomology 24, 69-75 (1995)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'lactin2_1995')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~lactin2_1995(temp = temp, a, b, tmax, delta_t),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'lactin2_1995'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'lactin2_1995'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='lrf_1991'>Lobry-Rosso-Flandros (LRF) model for fitting thermal performance curves</h2><span id='topic+lrf_1991'></span>

<h3>Description</h3>

<p>Lobry-Rosso-Flandros (LRF) model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrf_1991(temp, rmax, topt, tmin, tmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrf_1991_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="lrf_1991_+3A_rmax">rmax</code></td>
<td>
<p>maximum rate at optimum temperature</p>
</td></tr>
<tr><td><code id="lrf_1991_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
<tr><td><code id="lrf_1991_+3A_tmin">tmin</code></td>
<td>
<p>low temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="lrf_1991_+3A_tmax">tmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate=  rmax \cdot \frac{(temp - t_{max}) \cdot (temp - t_{min})^2}{(t_{opt} - t_{min}) \cdot ((t_{opt} - t_{min}) \cdot (temp - t_{opt}) - (t_{opt} - t_{max}) \cdot (t_{opt} + t_{min} - 2 \cdot temp))}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Rosso, L., Lobry, J. R., &amp; Flandrois, J. P.  An unexpected correlation between cardinal temperatures of microbial growth highlighted by a new model. Journal of Theoretical Biology, 162(4), 447-463. (1993)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)
library(nls.multstart)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981')
# fit model
mod &lt;- nls_multstart(rate~lrf_1991(temp = temp, rmax, topt, tmin, tmax),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'lrf_1991'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'lrf_1991'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='modifiedgaussian_2006'>Modified gaussian model for fitting thermal performance curves</h2><span id='topic+modifiedgaussian_2006'></span>

<h3>Description</h3>

<p>Modified gaussian model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modifiedgaussian_2006(temp, rmax, topt, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modifiedgaussian_2006_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="modifiedgaussian_2006_+3A_rmax">rmax</code></td>
<td>
<p>maximum rate at optimum temperature</p>
</td></tr>
<tr><td><code id="modifiedgaussian_2006_+3A_topt">topt</code></td>
<td>
<p>optimum temperature</p>
</td></tr>
<tr><td><code id="modifiedgaussian_2006_+3A_a">a</code></td>
<td>
<p>related to full curve width</p>
</td></tr>
<tr><td><code id="modifiedgaussian_2006_+3A_b">b</code></td>
<td>
<p>allows for asymmetry in the curve fit</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = r_{max} \cdot exp^{\bigg[-0.5 \left(\frac{|temp-t_{opt}|}{a}\right)^b\bigg]}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data and <code>gaussian_1987</code>
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model difficult to fit.
</p>


<h3>References</h3>

<p>Angilletta Jr, M. J. (2006). Estimating and comparing thermal performance curves. Journal of Thermal Biology, 31(7), 541-545.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'modifiedgaussian_2006')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~modifiedgaussian_2006(temp = temp, rmax, topt, a, b),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'modifiedgaussian_2006'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'modifiedgaussian_2006'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='oneill_1972'>O'Neill model for fitting thermal performance curves</h2><span id='topic+oneill_1972'></span>

<h3>Description</h3>

<p>O'Neill model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneill_1972(temp, rmax, ctmax, topt, q10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneill_1972_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="oneill_1972_+3A_rmax">rmax</code></td>
<td>
<p>maximum rate at optimum temperature</p>
</td></tr>
<tr><td><code id="oneill_1972_+3A_ctmax">ctmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="oneill_1972_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
<tr><td><code id="oneill_1972_+3A_q10">q10</code></td>
<td>
<p>defines the fold change in performance as a result of increasing the temperature by 10 ºC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = r_{max} \cdot \bigg(\frac{ct_{max} - temp}{ct_{max} - t_{opt}}\bigg)^{x} \cdot exp^{x \cdot \frac{temp - t_{opt}}{ct_{max} - t_{opt}}}</code>
</p>

<p style="text-align: center;"><code class="reqn">where: x = \frac{w^{2}}{400}\cdot\bigg(1 + \sqrt{1 + \frac{40}{w}}\bigg)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">and:\ w = (q_{10} - 1)\cdot (ct_{max} - t_{opt})</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data and previous values in the literature
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>O’Neill, R.V., Goldstein, R.A., Shugart, H.H., Mankin, J.B. Terrestrial Ecosystem Energy Model. Eastern Deciduous Forest Biome Memo Report Oak Ridge. The Environmental Sciences Division of the Oak Ridge National Laboratory. (1972)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'oneill_1972')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~oneill_1972(temp = temp, rmax, ctmax, topt, q10),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'oneill_1972'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'oneill_1972'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='pawar_2018'>Pawar model for fitting thermal performance curves</h2><span id='topic+pawar_2018'></span>

<h3>Description</h3>

<p>Pawar model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pawar_2018(temp, r_tref, e, eh, topt, tref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pawar_2018_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="pawar_2018_+3A_r_tref">r_tref</code></td>
<td>
<p>rate at the standardised temperature, tref</p>
</td></tr>
<tr><td><code id="pawar_2018_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="pawar_2018_+3A_eh">eh</code></td>
<td>
<p>high temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="pawar_2018_+3A_topt">topt</code></td>
<td>
<p>optimum temperature (ºC)</p>
</td></tr>
<tr><td><code id="pawar_2018_+3A_tref">tref</code></td>
<td>
<p>standardisation temperature in degrees centigrade. Temperature at which rates are not inactivated by high temperatures</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model is a modified version of <code>sharpeschoolhigh_1981</code> that explicitly models the optimum temperature.
Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{r_{tref} \cdot exp^{\frac{-e}{k} (\frac{1}{temp + 273.15}-\frac{1}{t_{ref} + 273.15})}}{1 + (\frac{e}{eh - e}) \cdot exp^{\frac{e_h}{k}(\frac{1}{t_opt + 273.15}-\frac{1}{temp + 273.15})}}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05.
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Kontopoulos, Dimitrios - Georgios, Bernardo García-Carreras, Sofía Sal, Thomas P. Smith, and Samraat Pawar. Use and Misuse of Temperature Normalisation in Meta-Analyses of Thermal Responses of Biological Traits. PeerJ. 6 (2018),
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)
library(nls.multstart)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'pawar_2018')
# fit model
mod &lt;- nls_multstart(rate~pawar_2018(temp = temp, r_tref, e, eh, topt, tref = 20),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'pawar_2018'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'pawar_2018'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='quadratic_2008'>Quadratic model for fitting thermal performance curves</h2><span id='topic+quadratic_2008'></span>

<h3>Description</h3>

<p>Quadratic model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadratic_2008(temp, a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quadratic_2008_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="quadratic_2008_+3A_a">a</code></td>
<td>
<p>parameter that defines the rate at 0 ºC</p>
</td></tr>
<tr><td><code id="quadratic_2008_+3A_b">b</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
<tr><td><code id="quadratic_2008_+3A_c">c</code></td>
<td>
<p>parameter with no biological meaning</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = a + b \cdot temp + c \cdot temp^2</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data using previous methods in the literature
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Montagnes, David JS, et al. Short‐term temperature change may impact freshwater carbon flux: a microbial perspective. Global Change Biology 14.12: 2823-2838. (2008)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'quadratic_2008')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~quadratic_2008(temp = temp, a, b, c),
data = d,
iter = c(4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'quadratic_2008'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'quadratic_2008'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='ratkowsky_1983'>Ratkowsky model for fitting thermal performance curves</h2><span id='topic+ratkowsky_1983'></span>

<h3>Description</h3>

<p>Ratkowsky model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ratkowsky_1983(temp, tmin, tmax, a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ratkowsky_1983_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="ratkowsky_1983_+3A_tmin">tmin</code></td>
<td>
<p>low temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="ratkowsky_1983_+3A_tmax">tmax</code></td>
<td>
<p>high temperature (ºC) at which rates become negative</p>
</td></tr>
<tr><td><code id="ratkowsky_1983_+3A_a">a</code></td>
<td>
<p>parameter defined as sqrt(rate)/(temp - tmin)</p>
</td></tr>
<tr><td><code id="ratkowsky_1983_+3A_b">b</code></td>
<td>
<p>empirical parameter needed to fit the data for temperatures beyond the optimum temperature</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = (a \cdot (temp-t_{min}))^2 \cdot (1-exp(b \cdot (temp-t_{max})))^2</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data and previous values in the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Ratkowsky, D.A., Lowry, R.K., McMeekin, T.A., Stokes, A.N., Chandler, R.E., Model for bacterial growth rate throughout the entire biokinetic temperature range. J. Bacteriol. 154: 1222–1226 (1983)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'ratkowsky_1983')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~ratkowsky_1983(temp = temp, tmin, tmax, a, b),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'ratkowsky_1983'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'ratkowsky_1983'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='rezende_2019'>Rezende model for fitting thermal performance curves</h2><span id='topic+rezende_2019'></span>

<h3>Description</h3>

<p>Rezende model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rezende_2019(temp, q10, a, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rezende_2019_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="rezende_2019_+3A_q10">q10</code></td>
<td>
<p>defines the fold change in performance as a result of increasing the temperature by 10 ºC</p>
</td></tr>
<tr><td><code id="rezende_2019_+3A_a">a</code></td>
<td>
<p>parameter describing shifts in rate</p>
</td></tr>
<tr><td><code id="rezende_2019_+3A_b">b</code></td>
<td>
<p>parameter threshold temperature (ºC) beyond which the downward curve starts</p>
</td></tr>
<tr><td><code id="rezende_2019_+3A_c">c</code></td>
<td>
<p>parameter controlling the rate of decline beyond the threshold temperature, b</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{if} \quad temp &lt; b: rate = a \cdot 10 ^{\frac{\log_{10} (q_{10})}{(\frac{10}{temp})}}</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{if} \quad temp &gt; b: rate = a \cdot 10 ^{\frac{\log_{10} (q_{10})}{(\frac{10}{temp})}} \cdot \bigg(1-c \cdot (b-temp)^2 \bigg)</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data and previous values in the literature.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Rezende, Enrico L., and Francisco Bozinovic. Thermal performance across levels of biological organization. Philosophical Transactions of the Royal Society B 374.1778 (2019): 20180549.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'rezende_2019')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~rezende_2019(temp = temp, q10, a, b, c),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'rezende_2019'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'rezende_2019'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='sharpeschoolfull_1981'>Full Sharpe-Schoolfield model for fitting thermal performance curves</h2><span id='topic+sharpeschoolfull_1981'></span>

<h3>Description</h3>

<p>Full Sharpe-Schoolfield model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sharpeschoolfull_1981(temp, r_tref, e, el, tl, eh, th, tref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sharpeschoolfull_1981_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_r_tref">r_tref</code></td>
<td>
<p>rate at the standardised temperature, tref</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_el">el</code></td>
<td>
<p>low temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_tl">tl</code></td>
<td>
<p>temperature (ºC) at which enzyme is 1/2 active and 1/2 suppressed due to low temperatures</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_eh">eh</code></td>
<td>
<p>high temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_th">th</code></td>
<td>
<p>temperature (ºC) at which enzyme is 1/2 active and 1/2 suppressed due to high temperatures</p>
</td></tr>
<tr><td><code id="sharpeschoolfull_1981_+3A_tref">tref</code></td>
<td>
<p>standardisation temperature in degrees centigrade. Temperature at which rates are not inactivated by either high or low temperatures</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{r_{tref} \cdot exp^{\frac{-e}{k} (\frac{1}{temp + 273.15}-\frac{1}{t_{ref} + 273.15})}}{1+ exp^{\frac{e_l}{k}(\frac{1}{t_l} - \frac{1}{temp + 273.15})} + exp^{\frac{e_h}{k}(\frac{1}{t_h}-\frac{1}{temp + 273.15})}}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05.
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Schoolfield, R. M., Sharpe, P. J. &amp; Magnuson, C. E. Non-linear regression of biological temperature-dependent rate models based on absolute reaction-rate theory. Journal of Theoretical Biology 88, 719-731 (1981)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)
library(nls.multstart)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'sharpeschoolfull_1981')
# fit model
mod &lt;- nls_multstart(rate~sharpeschoolfull_1981(temp = temp, r_tref, e, el, tl, eh, th, tref = 20),
data = d,
iter = c(3,3,3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'sharpeschoolfull_1981'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'sharpeschoolfull_1981'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='sharpeschoolhigh_1981'>Sharpe-Schoolfield model (high temperature inactivation only) for fitting thermal performance curves</h2><span id='topic+sharpeschoolhigh_1981'></span>

<h3>Description</h3>

<p>Sharpe-Schoolfield model (high temperature inactivation only) for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sharpeschoolhigh_1981_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="sharpeschoolhigh_1981_+3A_r_tref">r_tref</code></td>
<td>
<p>rate at the standardised temperature, tref</p>
</td></tr>
<tr><td><code id="sharpeschoolhigh_1981_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoolhigh_1981_+3A_eh">eh</code></td>
<td>
<p>high temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoolhigh_1981_+3A_th">th</code></td>
<td>
<p>temperature (ºC) at which enzyme is 1/2 active and 1/2 suppressed due to high temperatures</p>
</td></tr>
<tr><td><code id="sharpeschoolhigh_1981_+3A_tref">tref</code></td>
<td>
<p>standardisation temperature in degrees centigrade. Temperature at which rates are not inactivated by high temperatures</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{r_{tref} \cdot exp^{\frac{-e}{k} (\frac{1}{temp + 273.15}-\frac{1}{t_{ref} + 273.15})}}{1 + exp^{\frac{e_h}{k}(\frac{1}{t_h}-\frac{1}{temp + 273.15})}}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05.
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Schoolfield, R. M., Sharpe, P. J. &amp; Magnuson, C. E. Non-linear regression of biological temperature-dependent rate models based on absolute reaction-rate theory. J. Theor. Biol. 88, 719-731 (1981)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)
library(nls.multstart)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981')
# fit model
mod &lt;- nls_multstart(rate~sharpeschoolhigh_1981(temp = temp, r_tref, e, eh, th, tref = 20),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'sharpeschoolhigh_1981'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='sharpeschoollow_1981'>Sharpe-Schoolfield model (low temperature inactivation only) for fitting thermal performance curves</h2><span id='topic+sharpeschoollow_1981'></span>

<h3>Description</h3>

<p>Sharpe-Schoolfield model (low temperature inactivation only) for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sharpeschoollow_1981(temp, r_tref, e, el, tl, tref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sharpeschoollow_1981_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="sharpeschoollow_1981_+3A_r_tref">r_tref</code></td>
<td>
<p>rate at the standardised temperature, tref</p>
</td></tr>
<tr><td><code id="sharpeschoollow_1981_+3A_e">e</code></td>
<td>
<p>activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoollow_1981_+3A_el">el</code></td>
<td>
<p>low temperature de-activation energy (eV)</p>
</td></tr>
<tr><td><code id="sharpeschoollow_1981_+3A_tl">tl</code></td>
<td>
<p>temperature (ºC) at which enzyme is 1/2 active and 1/2 suppressed due to low temperatures</p>
</td></tr>
<tr><td><code id="sharpeschoollow_1981_+3A_tref">tref</code></td>
<td>
<p>standardisation temperature in degrees centigrade. Temperature at which rates are not inactivated by high temperatures</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate= \frac{r_{tref} \cdot exp^{\frac{-e}{k} (\frac{1}{temp + 273.15}-\frac{1}{t_{ref} + 273.15})}}{1 + exp^{\frac{e_l}{k}(\frac{1}{t_l} - \frac{1}{temp + 273.15})}}</code>
</p>

<p>where <code>k</code> is Boltzmann's constant with a value of 8.62e-05.
</p>
<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>Author(s)</h3>

<p>Daniel Padfield
</p>


<h3>References</h3>

<p>Schoolfield, R. M., Sharpe, P. J. &amp; Magnuson, C. E. Non-linear regression of biological temperature-dependent rate models based on absolute reaction-rate theory. J. Theor. Biol. 88, 719-731 (1981)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)
library(nls.multstart)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'sharpeschoollow_1981')
# fit model
mod &lt;- nls_multstart(rate~sharpeschoollow_1981(temp = temp, r_tref, e, el, tl, tref = 20),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'sharpeschoollow_1981'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'sharpeschoollow_1981'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='spain_1982'>Spain model for fitting thermal performance curves</h2><span id='topic+spain_1982'></span>

<h3>Description</h3>

<p>Spain model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spain_1982(temp, a, b, c, r0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spain_1982_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="spain_1982_+3A_a">a</code></td>
<td>
<p>constant that determines the steepness of the rising portion of the curve</p>
</td></tr>
<tr><td><code id="spain_1982_+3A_b">b</code></td>
<td>
<p>constant that determines the position of topt</p>
</td></tr>
<tr><td><code id="spain_1982_+3A_c">c</code></td>
<td>
<p>constant that determines the steepness of the decreasing part of the curve</p>
</td></tr>
<tr><td><code id="spain_1982_+3A_r0">r0</code></td>
<td>
<p>the apparent rate at 0 ºC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = r_0 \cdot exp^{a \cdot temp} \cdot (1-b \cdot exp^{c \cdot temp})</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data or plucked from thin air.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or plucked from thin air.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>BASIC Microcomputer Models in Biology. Addison-Wesley, Reading, MA. 1982
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'spain_1982')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~spain_1982(temp = temp, a, b, c, r0),
data = d,
iter = c(3,3,3,3),
start_lower = start_vals - 1,
start_upper = start_vals + 1,
lower = get_lower_lims(d$temp, d$rate, model_name = 'spain_1982'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'spain_1982'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='thomas_2012'>Thomas model (2012) for fitting thermal performance curves</h2><span id='topic+thomas_2012'></span>

<h3>Description</h3>

<p>Thomas model (2012) for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thomas_2012(temp, a, b, c, topt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thomas_2012_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="thomas_2012_+3A_a">a</code></td>
<td>
<p>arbitrary constant</p>
</td></tr>
<tr><td><code id="thomas_2012_+3A_b">b</code></td>
<td>
<p>arbitrary constant</p>
</td></tr>
<tr><td><code id="thomas_2012_+3A_c">c</code></td>
<td>
<p>the range of temperatures over which growth rate is positive, or the thermal niche width (ºC)</p>
</td></tr>
<tr><td><code id="thomas_2012_+3A_topt">topt</code></td>
<td>
<p>determines the location of the maximum of the quadratic portion of this function. When b = 0, tref would equal topt</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = a \cdot exp^{b \cdot temp} \bigg(1-\bigg(\frac{temp - t_{opt}}{c}\bigg)^2\bigg)</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Thomas, Mridul K., et al. A global pattern of thermal adaptation in marine phytoplankton. Science 338.6110, 1085-1088 (2012)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'thomas_2012')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~thomas_2012(temp = temp, a, b, c, topt),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 1,
start_upper = start_vals + 2,
lower = get_lower_lims(d$temp, d$rate, model_name = 'thomas_2012'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'thomas_2012'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='thomas_2017'>Thomas model (2017) for fitting thermal performance curves</h2><span id='topic+thomas_2017'></span>

<h3>Description</h3>

<p>Thomas model (2017) for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thomas_2017(temp, a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thomas_2017_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="thomas_2017_+3A_a">a</code></td>
<td>
<p>birth rate at 0 ºC</p>
</td></tr>
<tr><td><code id="thomas_2017_+3A_b">b</code></td>
<td>
<p>describes the exponential increase in birth rate with increasing temperature</p>
</td></tr>
<tr><td><code id="thomas_2017_+3A_c">c</code></td>
<td>
<p>temperature-independent mortality term</p>
</td></tr>
<tr><td><code id="thomas_2017_+3A_d">d</code></td>
<td>
<p>along with e controls the exponential increase in mortality rates with temperature</p>
</td></tr>
<tr><td><code id="thomas_2017_+3A_e">e</code></td>
<td>
<p>along with d controls the exponential increase in mortality rates with temperature</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = a \cdot exp^{b \cdot temp} - (c + d \cdot exp^{e \cdot temp})</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based on extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Thomas, Mridul K., et al. Temperature–nutrient interactions exacerbate sensitivity to warming in phytoplankton. Global change biology 23.8 (2017): 3269-3280.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'thomas_2017')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~thomas_2017(temp = temp, a, b, c, d, e),
data = d,
iter = c(3,3,3,3,3),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'thomas_2017'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'thomas_2017'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

<hr>
<h2 id='weibull_1995'>Weibull model for fitting thermal performance curves</h2><span id='topic+weibull_1995'></span>

<h3>Description</h3>

<p>Weibull model for fitting thermal performance curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull_1995(temp, a, topt, b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weibull_1995_+3A_temp">temp</code></td>
<td>
<p>temperature in degrees centigrade</p>
</td></tr>
<tr><td><code id="weibull_1995_+3A_a">a</code></td>
<td>
<p>scale the height of the curve</p>
</td></tr>
<tr><td><code id="weibull_1995_+3A_topt">topt</code></td>
<td>
<p>optimum temperature</p>
</td></tr>
<tr><td><code id="weibull_1995_+3A_b">b</code></td>
<td>
<p>defines the breadth of the curve</p>
</td></tr>
<tr><td><code id="weibull_1995_+3A_c">c</code></td>
<td>
<p>defines the curve shape</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Equation:
</p>
<p style="text-align: center;"><code class="reqn">rate = a \cdot \bigg( \frac{c-1}{c}\bigg)^{\frac{1-c}{c}}\bigg(\frac{temp-t_{opt}}{b}+\bigg(\frac{c-1}{c}\bigg)^{\frac{1}{c}}\bigg)^{c-1}exp^{-\big(\frac{temp-t_{opt}}{b}+\big( \frac{c-1}{c}\big)^{\frac{1}{c}}\big)^c} + \frac{c-1}{c}</code>
</p>

<p>Start values in <code>get_start_vals</code> are derived from the data.
</p>
<p>Limits in <code>get_lower_lims</code> and <code>get_upper_lims</code> are derived from the data or based  extreme values that are unlikely to occur in ecological settings.
</p>


<h3>Value</h3>

<p>a numeric vector of rate values based on the temperatures and parameter values provided to the function
</p>


<h3>Note</h3>

<p>Generally we found this model easy to fit.
</p>


<h3>References</h3>

<p>Angilletta Jr, Michael J. Estimating and comparing thermal performance curves. Journal of Thermal Biology 31.7 (2006): 541-545.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load in ggplot
library(ggplot2)

# subset for the first TPC curve
data('chlorella_tpc')
d &lt;- subset(chlorella_tpc, curve_id == 1)

# get start values and fit model
start_vals &lt;- get_start_vals(d$temp, d$rate, model_name = 'weibull_1995')
# fit model
mod &lt;- nls.multstart::nls_multstart(rate~weibull_1995(temp = temp, a, topt, b, c),
data = d,
iter = c(4,4,4,4),
start_lower = start_vals - 10,
start_upper = start_vals + 10,
lower = get_lower_lims(d$temp, d$rate, model_name = 'weibull_1995'),
upper = get_upper_lims(d$temp, d$rate, model_name = 'weibull_1995'),
supp_errors = 'Y',
convergence_count = FALSE)

# look at model fit
summary(mod)

# get predictions
preds &lt;- data.frame(temp = seq(min(d$temp), max(d$temp), length.out = 100))
preds &lt;- broom::augment(mod, newdata = preds)

# plot
ggplot(preds) +
geom_point(aes(temp, rate), d) +
geom_line(aes(temp, .fitted), col = 'blue') +
theme_bw()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
