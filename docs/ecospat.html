<!DOCTYPE html><html><head><title>Help for package ecospat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecospat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecospat-package'><p>Spatial Ecology Miscellaneous Methods</p></a></li>
<li><a href='#ecospat.adj.D2.glm'><p>Calculate An Adjusted D2</p></a></li>
<li><a href='#ecospat.binary.model'><p>Generate Binary Models</p></a></li>
<li><a href='#ecospat.boyce'><p>Calculate Boyce Index</p></a></li>
<li><a href='#ecospat.calculate.pd'><p>Calculate Phylogenetic Diversity Measures</p></a></li>
<li><a href='#ecospat.caleval'><p>Calibration And Evaluation Dataset</p></a></li>
<li><a href='#ecospat.CCV.communityEvaluation.bin'>
<p>Calculates a range of community evaluation metrics based on different thresholding techniques.</p></a></li>
<li><a href='#ecospat.CCV.communityEvaluation.prob'>
<p>Evaluates community predictions directly on the probabilities (i.e., threshold independent)</p></a></li>
<li><a href='#ecospat.CCV.createDataSplitTable'>
<p>Creates a DataSplitTable for usage in ecospat.ccv.modeling.</p></a></li>
<li><a href='#ecospat.CCV.modeling'>
<p>Runs indivudual species distribuion models with SDMs or ESMs</p></a></li>
<li><a href='#ecospat.climan'><p>A climate analogy setection tool for the modeling of species distributions</p></a></li>
<li><a href='#ecospat.co_occurrences'><p>Species Co-Occurrences</p></a></li>
<li><a href='#ecospat.cohen.kappa'><p>Cohen's Kappa</p></a></li>
<li><a href='#ecospat.CommunityEval'><p>Community Evaluation</p></a></li>
<li><a href='#ecospat.cons_Cscore'><p>Constrained Co-Occurrence Analysis.</p></a></li>
<li><a href='#ecospat.cor.plot'><p>Correlation Plot</p></a></li>
<li><a href='#ecospat.Cscore'>
<p>Pairwise co-occurrence Analysis with calculation of the C-score index.</p></a></li>
<li><a href='#ecospat.cv.gbm'><p>GBM Cross Validation</p></a></li>
<li><a href='#ecospat.cv.glm'><p>GLM Cross Validation</p></a></li>
<li><a href='#ecospat.cv.me'><p>Maxent Cross Validation</p></a></li>
<li><a href='#ecospat.cv.rf'><p>RandomForest Cross Validation</p></a></li>
<li><a href='#ecospat.Epred'><p>Prediction Mean</p></a></li>
<li><a href='#ecospat.ESM.EnsembleEvaluation'>
<p>Ensemble of Small Models: Evaluation via the Pooling procedure</p></a></li>
<li><a href='#ecospat.ESM.EnsembleModeling'>
<p>Ensemble of Small Models: Evaluates and Averages Simple Bivariate Models To ESMs</p></a></li>
<li><a href='#ecospat.ESM.EnsembleProjection'>
<p>Ensemble of Small Models: Projects Calibrated ESMs Into New Space Or Time.</p></a></li>
<li><a href='#ecospat.ESM.Modeling'>
<p>Ensemble of Small Models: Calibration of Simple Bivariate Models</p></a></li>
<li><a href='#ecospat.ESM.Projection'>
<p>Ensemble of Small Models: Projects Simple Bivariate Models Into New Space Or Time</p></a></li>
<li><a href='#ecospat.ESM.responsePlot'>
<p>Produce response plots for ESMs</p></a></li>
<li><a href='#ecospat.ESM.threshold'>
<p>Thresholds for Ensemble of Small Models</p></a></li>
<li><a href='#ecospat.ESM.VarContrib'>
<p>Variable contribution in ESM</p></a></li>
<li><a href='#ecospat.grid.clim.dyn'><p>Dynamic Occurrence Densities Grid</p></a></li>
<li><a href='#ecospat.mantel.correlogram'><p>Mantel Correlogram</p></a></li>
<li><a href='#ecospat.margin'><p>Delineation of the distribution's margin and its uncertainty</p></a></li>
<li><a href='#ecospat.max.kappa'>
<p>Maximum Kappa</p></a></li>
<li><a href='#ecospat.max.tss'>
<p>Maximum TSS</p></a></li>
<li><a href='#ecospat.maxentvarimport'><p>Maxent Variable Importance</p></a></li>
<li><a href='#ecospat.mdr'>
<p>Minimum Dispersal Routes)</p></a></li>
<li><a href='#ecospat.mess'><p>MESS</p></a></li>
<li><a href='#ecospat.meva.table'>
<p>Model Evaluation For A Given Threshold Value</p></a></li>
<li><a href='#ecospat.mpa'><p>Minimal Predicted Area</p></a></li>
<li><a href='#ecospat.niche.dyn.index'><p>Niche Expansion, Stability, and Unfilling</p></a></li>
<li><a href='#ecospat.niche.dynIndexProjGeo'><p>Projection of niche dynamic indices to the Geography</p></a></li>
<li><a href='#ecospat.niche.equivalency.test'><p>Niche Equivalency Test</p></a></li>
<li><a href='#ecospat.niche.overlap'><p>Calculate Niche Overlap</p></a></li>
<li><a href='#ecospat.niche.similarity.test'><p>Niche Similarity Test</p></a></li>
<li><a href='#ecospat.niche.zProjGeo'><p>Projection of Occurrence Densities to the Geography</p></a></li>
<li><a href='#ecospat.nicheNBmean'>
<p>Niche position and niche breadth)</p></a></li>
<li><a href='#ecospat.nichePOSNB'>
<p>Niche position and niche breadth)</p></a></li>
<li><a href='#ecospat.npred'><p>Number Of Predictors</p></a></li>
<li><a href='#ecospat.occ.desaggregation'><p>Species Occurrences Desaggregation</p></a></li>
<li><a href='#ecospat.occupied.patch'>
<p>Extract occupied patches of a species in geographic space.)</p></a></li>
<li><a href='#ecospat.permut.glm'><p>GLM Permutation Function</p></a></li>
<li><a href='#ecospat.plot.contrib'><p>Plot Variables Contribution</p></a></li>
<li><a href='#ecospat.plot.kappa'>
<p>Plot Kappa</p></a></li>
<li><a href='#ecospat.plot.mess'><p>Plot MESS</p></a></li>
<li><a href='#ecospat.plot.niche'><p>Plot Niche</p></a></li>
<li><a href='#ecospat.plot.niche.dyn'><p>Niche Categories and Species Density</p></a></li>
<li><a href='#ecospat.plot.overlap.test'><p>Plot Overlap Test</p></a></li>
<li><a href='#ecospat.plot.tss'>
<p>Plot True skill statistic (TSS)</p></a></li>
<li><a href='#ecospat.poolingEvaluation'>
<p>Evaluation of species distribution models using the pooling procedure</p></a></li>
<li><a href='#ecospat.rand.pseudoabsences'><p>Sample Pseudo-Absences</p></a></li>
<li><a href='#ecospat.rangesize'>
<p>Quantification of the range size of a species using habitat suitability maps and IUCN criteria)</p></a></li>
<li><a href='#ecospat.rcls.grd'><p>Reclassifying grids function</p></a></li>
<li><a href='#ecospat.recstrat_prop'>
<p>Random Ecologically Stratified Sampling of propotional numbers</p></a></li>
<li><a href='#ecospat.recstrat_regl'>
<p>Random Ecologically Stratified Sampling of equal numbers</p></a></li>
<li><a href='#ecospat.sample.envar'><p>Sample Environmental Variables</p></a></li>
<li><a href='#ecospat.SESAM.prr'><p>SESAM Probability Ranking Rule</p></a></li>
<li><a href='#ecospat.shift.centroids'><p>Draw Centroid Arrows</p></a></li>
<li><a href='#ecospat.testData'><p>Test Data For The Ecospat package</p></a></li>
<li><a href='#ecospat.testEnv'><p>Test Environmental SpatRasters for The Ecospat package</p></a></li>
<li><a href='#ecospat.testMdr'><p>Test Data For The ecospat.mdr function</p></a></li>
<li><a href='#ecospat.testNiche'><p>Test Data For The Niche Overlap Analysis</p></a></li>
<li><a href='#ecospat.testNiche.inv'><p>Test Data For The Niche Dynamics Analysis In The Invaded Range Of A Hypothetical Species</p></a></li>
<li><a href='#ecospat.testNiche.nat'><p>Test Data For The Niche Dynamics Analysis In The Native Range Of A Hypothetical Species</p></a></li>
<li><a href='#ecospat.testNichePOSNB'><p>Test AVS Dataset For The Ecospat package</p></a></li>
<li><a href='#ecospat.testTree'><p>Test Tree For The Ecospat package</p></a></li>
<li><a href='#ecospat.varpart'><p>Variation Partitioning For GLM Or GAM</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>4.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatial Ecology Miscellaneous Methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Broennimann [cre, aut, ctb],
  Valeria Di Cola [aut, ctb],
  Blaise Petitpierre [ctb],
  Frank Breiner [ctb],
  Daniel Scherrer [ctb],
  Manuela D`Amen [ctb],
  Christophe Randin [ctb],
  Robin Engler [ctb],
  Wim Hordijk [ctb],
  Heidi Mod [ctb],
  Julien Pottier [ctb],
  Mirko Di Febbraro [ctb],
  Loic Pellissier [ctb],
  Dorothea Pio [ctb],
  Ruben Garcia Mateo [ctb],
  Anne Dubuis [ctb],
  Luigi Maiorano [ctb],
  Achilleas Psomas [ctb],
  Charlotte Ndiribe [ctb],
  Nicolas Salamin [ctb],
  Niklaus Zimmermann [ctb],
  Flavien Collart [ctb],
  Tyler Smith [ctb],
  Antoine Guisan [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivier Broennimann &lt;olivier.broennimann@unil.ch&gt;</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ade4 (&ge; 1.6-2), gbm (&ge; 2.1.1), foreach (&ge;
1.4.3),adehabitatHR (&ge; 0.4.11), adehabitatMA (&ge; 0.3.8),
biomod2 (&ge; 4.2-3), dismo (&ge; 0.9-3), ecodist (&ge; 1.2.9), terra
(&ge; 1.2-5), gtools (&ge; 3.4.1), PresenceAbsence (&ge; 1.1.9),
methods (&ge; 3.1.1), parallel, classInt (&ge; 0.1-23), vegan (&ge;
2.4-1), poibin (&ge; 1.3), matrixStats (&ge; 0.53.1), ks (&ge;
1.12.0), nabor (&ge; 0.5.0), Hmisc (&ge; 4.4-2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rJava (&ge; 0.9-6), knitr (&ge; 1.14), alphahull (&ge; 2.1),
snowfall (&ge; 1.61), dplyr(&ge; 0.3.0.1), maps (&ge; 3.0.0), rms,
sp(&ge; 2.0-0), ape (&ge; 3.2),randomForest (&ge; 4.6-7)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html">http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of R functions and data sets for the support of spatial ecology analyses with a focus on pre, core and post modelling analyses of species distribution, niche quantification and community assembly. Written by current and former members and collaborators of the ecospat group of Antoine Guisan, Department of Ecology and Evolution (DEE) and Institute of Earth Surface Dynamics (IDYST), University of Lausanne, Switzerland. Read Di Cola et al. (2016) &lt;<a href="https://doi.org/10.1111%2Fecog.02671">doi:10.1111/ecog.02671</a>&gt; for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ecospat/ecospat">https://github.com/ecospat/ecospat</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-16 08:24:51 UTC; obroenni</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-17 23:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ecospat-package'>Spatial Ecology Miscellaneous Methods</h2><span id='topic+ecospat-package'></span><span id='topic+ecospat'></span>

<h3>Description</h3>

<p>Collection of methods, utilities and data sets for the support of spatial ecology analyses with a focus on pre-, core and post- modelling analyses of species distribution, niche quantification and community assembly. The <code>ecospat</code> package was written by current and former members and collaborators of the ecospat group of Antoine Guisan, Department of Ecology and Evolution (DEE) &amp; Institute of Earth Surface Dynamics (IDYST), University of Lausanne, Switzerland. 
</p>
<p><b>Pre-modelling:</b>
</p>

<ul>
<li><p> Spatial autocorrelation:<code><a href="#topic+ecospat.mantel.correlogram">ecospat.mantel.correlogram</a></code>
</p>
</li>
<li><p> Variable selection: <code><a href="#topic+ecospat.npred">ecospat.npred</a></code>
</p>
</li>
<li><p> Climate Analalogy: <code><a href="#topic+ecospat.climan">ecospat.climan</a>, <a href="#topic+ecospat.mess">ecospat.mess</a>, <a href="#topic+ecospat.plot.mess">ecospat.plot.mess</a></code>
</p>
</li>
<li><p> Phylogenetic diversity measures: <code><a href="#topic+ecospat.calculate.pd">ecospat.calculate.pd</a></code>
</p>
</li>
<li><p> Biotic Interactions: <code><a href="#topic+ecospat.cons_Cscore">ecospat.cons_Cscore</a>, <a href="#topic+ecospat.Cscore">ecospat.Cscore</a>, <a href="#topic+ecospat.co_occurrences">ecospat.co_occurrences</a></code> 
</p>
</li>
<li><p> Minimum Dispersal routes: <code><a href="#topic+ecospat.mdr">ecospat.mdr</a></code>
</p>
</li>
<li><p> Niche Quantification: <code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a>, <a href="#topic+ecospat.niche.equivalency.test">ecospat.niche.equivalency.test</a>, <a href="#topic+ecospat.niche.similarity.test">ecospat.niche.similarity.test</a>, <a href="#topic+ecospat.plot.niche">ecospat.plot.niche</a>, <a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a>, <a href="#topic+ecospat.plot.contrib">ecospat.plot.contrib</a>, <a href="#topic+ecospat.niche.overlap">ecospat.niche.overlap</a>, <a href="#topic+ecospat.plot.overlap.test">ecospat.plot.overlap.test</a>, <a href="#topic+ecospat.niche.dyn.index">ecospat.niche.dyn.index</a>, <a href="#topic+ecospat.shift.centroids">ecospat.shift.centroids</a>, <a href="#topic+ecospat.niche.dynIndexProjGeo">ecospat.niche.dynIndexProjGeo</a>, <a href="#topic+ecospat.niche.zProjGeo">ecospat.niche.zProjGeo</a>, <a href="#topic+ecospat.margin">ecospat.margin</a></code>
</p>
</li>
<li><p> Data Preparation: <code><a href="#topic+ecospat.caleval">ecospat.caleval</a>, <a href="#topic+ecospat.cor.plot">ecospat.cor.plot</a>, <a href="#topic+ecospat.occ.desaggregation">ecospat.occ.desaggregation</a>, <a href="#topic+ecospat.rand.pseudoabsences">ecospat.rand.pseudoabsences</a>, <a href="#topic+ecospat.rcls.grd">ecospat.rcls.grd</a>, <a href="#topic+ecospat.recstrat_prop">ecospat.recstrat_prop</a>, <a href="#topic+ecospat.recstrat_regl">ecospat.recstrat_regl</a>, <a href="#topic+ecospat.sample.envar">ecospat.sample.envar</a></code>
</p>
</li></ul>

<p><b>Core Niche Modelling:</b>
</p>

<ul>
<li><p> Model evaluation: <code><a href="#topic+ecospat.cv.glm">ecospat.cv.glm</a>, <a href="#topic+ecospat.permut.glm">ecospat.permut.glm</a>, <a href="#topic+ecospat.cv.gbm">ecospat.cv.gbm</a>, <a href="#topic+ecospat.cv.me">ecospat.cv.me</a>, <a href="#topic+ecospat.cv.rf">ecospat.cv.rf</a>, <a href="#topic+ecospat.boyce">ecospat.boyce</a>, <a href="#topic+ecospat.CommunityEval">ecospat.CommunityEval</a>, <a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a>, <a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a>, <a href="#topic+ecospat.max.tss">ecospat.max.tss</a>, <a href="#topic+ecospat.meva.table">ecospat.meva.table</a>, <a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a>, <a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a>, <a href="#topic+ecospat.adj.D2.glm">ecospat.adj.D2.glm</a>, <a href="#topic+ecospat.CCV.createDataSplitTable">ecospat.CCV.createDataSplitTable</a>, <a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a>, <a href="#topic+ecospat.CCV.communityEvaluation.bin">ecospat.CCV.communityEvaluation.bin</a>, <a href="#topic+ecospat.CCV.communityEvaluation.prob">ecospat.CCV.communityEvaluation.prob</a></code>
</p>
</li>
<li><p> Spatial predictions and projections: <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a>, <a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a>, <a href="#topic+ecospat.ESM.Projection">ecospat.ESM.Projection</a>, <a href="#topic+ecospat.ESM.EnsembleProjection">ecospat.ESM.EnsembleProjection</a>, <a href="#topic+ecospat.SESAM.prr">ecospat.SESAM.prr</a>, <a href="#topic+ecospat.binary.model">ecospat.binary.model</a>, <a href="#topic+ecospat.Epred">ecospat.Epred</a>, <a href="#topic+ecospat.mpa">ecospat.mpa</a></code>
</p>
</li>
<li><p> Variable Importance: <code><a href="#topic+ecospat.maxentvarimport">ecospat.maxentvarimport</a>, <a href="#topic+ecospat.ESM.VarContrib">ecospat.ESM.VarContrib</a></code>
</p>
</li></ul>

<p><b>Post Modelling:</b>
</p>

<ul>
<li><p> Variance Partition: <code><a href="#topic+ecospat.varpart">ecospat.varpart</a></code>
</p>
</li>
<li><p> Spatial predictions of species assemblages: <code><a href="#topic+ecospat.cons_Cscore">ecospat.cons_Cscore</a></code>
</p>
</li>
<li><p> Range size quantification: <code><a href="#topic+ecospat.rangesize">ecospat.rangesize</a>, <a href="#topic+ecospat.occupied.patch">ecospat.occupied.patch</a></code>
</p>
</li></ul>


<hr>
<h2 id='ecospat.adj.D2.glm'>Calculate An Adjusted D2</h2><span id='topic+ecospat.adj.D2.glm'></span>

<h3>Description</h3>

<p>This function is used for calculating an adjusted D2 from a calibrated GLM object</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.adj.D2.glm(glm.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.adj.D2.glm_+3A_glm.obj">glm.obj</code></td>
<td>
<p>Any calibrated GLM object with a binomial error distribution</p>
</td></tr></table>


<h3>Details</h3>

<p>This function takes a calibrated GLM object with a binomial error distribution and returns an evaluation of the model fit.
The measure of the fit of the models is expressed as the percentage of explained deviance adjusted by the number of degrees
of freedom used (similar to the adjusted-R2 in the case of Least-Square regression; see Weisberg 1980) and is called the adjusted-D2
(see guisan and Zimmermann 2000 for details on its calculation).
</p>


<h3>Value</h3>

<p>Returns an adjusted D square value (proportion of deviance accounted for by the model).</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a>
</p>


<h3>References</h3>

<p>Weisberg, S. 1980. Applied linear regression. Wiley.
</p>
<p>Guisan, A., S.B. Weiss and A.D. Weiss. 1999. GLM versus CCA spatial modeling of plant species distribution. <em>Plant Ecology</em>, <b>143</b>, 107-122.
</p>
<p>Guisan, A. and N.E. Zimmermann. 2000. Predictive habitat distribution models in ecology. <em>Ecol. Model.</em>, <b>135</b>, 147-186.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ecospat.testData)
glm.obj&lt;-glm(Achillea_millefolium~ddeg+mind+srad+slp+topo, 
family = binomial, data=ecospat.testData)

ecospat.adj.D2.glm(glm.obj)

</code></pre>

<hr>
<h2 id='ecospat.binary.model'>Generate Binary Models</h2><span id='topic+ecospat.binary.model'></span>

<h3>Description</h3>

<p>Generate a binary map from a continuous model prediction.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.binary.model (Pred, Threshold)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.binary.model_+3A_pred">Pred</code></td>
<td>
<p>a <code>SpatRaster</code> object predicted suitabilities from a SDM prediction.</p>
</td></tr>
<tr><td><code id="ecospat.binary.model_+3A_threshold">Threshold</code></td>
<td>
<p>A threshold to convert continous maps into binary maps (e.g. the output of the function <code>ecospat.mpa</code>() or use the <code>optimal.thresholds</code> from PresenceAbsence R package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a binary model prediction (presence/absence) from an original model applying a threshold. The threshold could be arbitrary, or be based on the maximum acceptable error of false negatives (i.e. percentage of the presence predicted as absences, omission error).</p>


<h3>Value</h3>

<p>The binary model prediction (presence/absence).</p>


<h3>Author(s)</h3>

<p>Ruben G. Mateo <a href="mailto:rubeng.mateo@gmail.com">rubeng.mateo@gmail.com</a> with contributions of Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> and Flavien Collart</p>


<h3>References</h3>

<p>Fielding, A.H. and J.F. Bell. 1997. A review of methods for the assessment of prediction errors in conservation presence/absence models. <em>Environmental Conservation</em>, <b>24</b>: 38-49.
</p>
<p>Engler, R., A Guisan and L. Rechsteiner. 2004. An improved approach for predicting the distribution of rare and endangered species from occurrence and pseudo-absence data. <em>Journal of Applied Ecology</em>, <b>41</b>, 263-274.
</p>
<p>Liu, C., Berry, P. M., Dawson, T. P. and R. G. Pearson. 2005. Selecting thresholds of occurrence in the prediction of species distributions. <em>Ecography</em>, <b>28</b>, 385-393.
</p>
<p>Jimenez-Valverde, A. and J.M.Lobo. 2007. Threshold criteria for conversion of probability of species presence to either-or presence-absence. <em>Acta oecologica</em>, <b>31</b>, 361-369.
</p>
<p>Liu, C., White, M. and G. Newell. 2013. Selecting thresholds for the prediction of species occurrence with presence-only data. <em>J. Biogeogr.</em>, <b>40</b>, 778-789.
</p>
<p>Freeman, E.A. and G.G. Moisen. 2008. A comparison of the performance of threshold criteria for binary classification in terms of predicted prevalence and kappa. <em>Ecological Modelling</em>, <b>217</b>, 48-58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.mpa">ecospat.mpa</a></code>, <code><a href="PresenceAbsence.html#topic+optimal.thresholds">optimal.thresholds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(terra)
# coordinates of the plots
xy &lt;- ecospat.testData[,2:3]

# environmental data
predictors &lt;- terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))

env &lt;- terra::extract(predictors,xy,ID=FALSE)  
spData &lt;- cbind.data.frame(occ=ecospat.testData$Veronica_alpina,env)
mod &lt;- glm(occ~ddeg0+I(ddeg0^2)+srad68+I(srad68^2),data=spData,family = binomial())

# predict to entire dataset
pred &lt;- terra::predict(predictors,mod,type="response") 
  
### make binary maps
# use MPA to convert suitability to binary map

mpa.cutoff &lt;- ecospat.mpa(pred,xy[spData$occ==1,],perc = 0.9) # 90% presences encompassed
pred.bin.mpa &lt;- ecospat.binary.model(pred,mpa.cutoff)

plot(pred.bin.mpa)
points(xy[spData$occ==1,])

</code></pre>

<hr>
<h2 id='ecospat.boyce'>Calculate Boyce Index</h2><span id='topic+ecospat.boyce'></span>

<h3>Description</h3>

<p>Calculate the Boyce index as in Hirzel et al. (2006). The Boyce index is used to assess model performance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.boyce (fit, obs, nclass=0, window.w="default", res=100, PEplot = TRUE, 
rm.duplicate = TRUE, method = 'spearman')</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.boyce_+3A_fit">fit</code></td>
<td>
<p>A vector or a SpatRaster containing the predicted suitability values</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_obs">obs</code></td>
<td>
<p>A vector containing the predicted suitability values or xy-coordinates (if &quot;fit&quot; is a SpatRaster) of the validation points (presence records)</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_nclass">nclass</code></td>
<td>
<p>The number of classes or vector with class thresholds. If <code>nclass=0</code>, the Boyce index is calculated with a moving window (see next parameters)</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_window.w">window.w</code></td>
<td>
<p>The width of the moving window (by default 1/10 of the suitability range)</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_res">res</code></td>
<td>
<p>The resolution of the moving window (by default 100 focals)</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_peplot">PEplot</code></td>
<td>
<p>If <code>TRUE</code>, plot the predicted to expected ratio along the suitability class</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_rm.duplicate">rm.duplicate</code></td>
<td>
<p>If <code>TRUE</code>, only one of the successive duplicated P/E values are used to compute the correlation. See Details</p>
</td></tr>
<tr><td><code id="ecospat.boyce_+3A_method">method</code></td>
<td>
<p>Method used to compute the correlation. The default is <code>'spearman'</code> but <code>'pearson'</code> and <code>'kendall'</code> can also be used. See Details</p>
</td></tr>
</table>
<p>rm.duplicate = TRUE, method = 'spearman'
</p>


<h3>Details</h3>

<p>The Boyce index only requires presences and measures how much model predictions differ from random distribution of the observed presences across the prediction gradients (Boyce et al. 2002). It is thus an appropriate metric in the case of presence-only models. It is continuous and varies between -1 and +1. Positive values indicate a model which present predictions are consistent with the distribution of presences in the evaluation dataset, values close to zero mean that the model is not different from a random model, negative values indicate counter predictions, i.e., predicting poor quality areas where presences are more frequent (Hirzel et al. 2006).
</p>
<p>Removing the successive duplicated P/E values (<code>rm.duplicate = TRUE</code>) focuses more on the discriminative aspect of the predictions, lowering the assessment of the evaluation of the model resolution (sensu Hirzel et al. 2006 p. 150). However, it seems that in the initial version, dupplicated values were not removed.
</p>
<p>In the initial publication on the continuous Boyce index, the correlation was set to <code>method = 'spearman'</code>. However, using <code>method = 'kendall'</code> or <code>method = 'pearson'</code> might be more informative about the accuracy of the predictions.</p>


<h3>Value</h3>

<p>The function returns a list that contains a vector F.ratio (the predicted-to-expected ratio for each class-interval) and a numeric Spearman.cor (the Boyce index value)</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a> and Frank Breiner <a href="mailto:frank.breiner@unil.ch">frank.breiner@unil.ch</a> with the updates of Flavien Collart</p>


<h3>References</h3>

<p>Boyce, M.S., P.R. Vernier, S.E. Nielsen and F.K.A. Schmiegelow. 2002. Evaluating resource selection functions. <em>Ecol. Model.</em>, <b>157</b>, 281-300.
</p>
<p>Hirzel, A.H., G. Le Lay, V. Helfer, C. Randin and A. Guisan. 2006. Evaluating the ability of habitat suitability models to predict species presences. <em>Ecol. Model.</em>, <b>199</b>, 142-152.</p>


<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- (ecospat.testData$glm_Saxifraga_oppositifolia
[which(ecospat.testData$Saxifraga_oppositifolia==1)])

ecospat.boyce (fit = ecospat.testData$glm_Saxifraga_oppositifolia , obs, nclass=0, 
window.w="default", res=100, PEplot = TRUE)
</code></pre>

<hr>
<h2 id='ecospat.calculate.pd'>Calculate Phylogenetic Diversity Measures</h2><span id='topic+ecospat.calculate.pd'></span>

<h3>Description</h3>

<p>Calculate all phylogenetic diversity measures listed in Schweiger et al., 2008 (see full reference below).</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.calculate.pd (tree, data, method="spanning", type="clade", root=FALSE, 
average=FALSE, verbose=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.calculate.pd_+3A_tree">tree</code></td>
<td>
<p>The phylogenetic tree</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_data">data</code></td>
<td>
<p>A presence or absence (binary) matrix for each species (columns) in each location or grid cell (rows)</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_method">method</code></td>
<td>
<p>The method to use. Options are &quot;pairwise&quot;, &quot;topology&quot;, and &quot;spanning&quot;. Default is &quot;spanning&quot;.</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_type">type</code></td>
<td>
<p>Phylogenetic measure from those listed in Schweiger et al 2008. Options are &quot;Q&quot;, &quot;P&quot;, &quot;W&quot;, &quot;clade&quot;, &quot;species&quot;, &quot;J&quot;, &quot;F&quot;, &quot;AvTD&quot;,&quot;TTD&quot;, &quot;Dd&quot;. Default is &quot;clade&quot;.</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_root">root</code></td>
<td>
<p>Phylogenetic diversity can either be rooted or unrooted. Details in Schweiger et al 2008. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_average">average</code></td>
<td>
<p>Phylogenetic diversity can either be averaged or not averaged. Details in Schweiger et al 2008. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ecospat.calculate.pd_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a phylogenetic tree and a presence/absence matrix this script calculates phylogenetic diversity of a group of species across a given set of grid cells or locations. The library &quot;ape&quot; is required to read the tree in R. Command is &quot;read.tree&quot; or &quot;read.nexus&quot;.
Options of type:
&quot;P&quot; is a normalized mearure of &quot;Q&quot;.
&quot;clade&quot; is &quot;PDnode&quot; when root= FALSE, and is &quot;PDroot&quot; ehn root =TRUE.
&quot;species&quot; is &quot;AvPD&quot;.
</p>


<h3>Value</h3>

<p>This function returns a list of phylogenetic diversity values for each of the grid cells in the presence/absence matrix</p>


<h3>Author(s)</h3>

<p>Nicolas Salamin <a href="mailto:nicolas.salamin@unil.ch">nicolas.salamin@unil.ch</a> and Dorothea Pio <a href="mailto:Dorothea.Pio@fauna-flora.org">Dorothea.Pio@fauna-flora.org</a></p>


<h3>References</h3>

<p>Schweiger, O., S. Klotz, W. Durka and I. Kuhn. 2008. A comparative test of phylogenetic diversity indices. <em>Oecologia</em>, <b>157</b>, 485-495.
</p>
<p>Pio, D.V., O. Broennimann, T.G. Barraclough, G. Reeves, A.G. Rebelo, W. Thuiller, A. Guisan and N. Salamin. 2011. Spatial predictions of phylogenetic diversity in conservation decision making. <em>Conservation Biology</em>, <b>25</b>, 1229-1239.
</p>
<p>Pio, D.V., R. Engler, H.P. Linder, A. Monadjem, F.P.D. Cotterill, P.J. Taylor, M.C. Schoeman, B.W. Price, M.H. Villet, G. Eick, N. Salamin and A. Guisan. 2014. Climate change effects on animal and plant phylogenetic diversity in southern Africa. <em>Global Change Biology</em>, <b>20</b>, 1538-1549.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fpath &lt;- system.file("extdata", "ecospat.testTree.tre", package="ecospat")
library(ape)
tree &lt;-ape::read.tree(fpath)
data &lt;- ecospat.testData[9:52] 

pd &lt;- ecospat.calculate.pd(tree, data, method = "spanning", type = "species", root = FALSE, 
average = FALSE, verbose = TRUE )

plot(pd)
</code></pre>

<hr>
<h2 id='ecospat.caleval'>Calibration And Evaluation Dataset</h2><span id='topic+ecospat.caleval'></span>

<h3>Description</h3>

<p>Generate an evaluation and calibration dataset with a desired ratio of disaggregation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.caleval (data, xy, row.num=1:nrow(data), nrep=1, ratio=0.7, 
disaggregate=0, pseudoabs=0, npres=0, replace=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.caleval_+3A_data">data</code></td>
<td>
<p>A vector with presence-absence (0-1) data for one species.</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_xy">xy</code></td>
<td>
<p>The x and y coordinates of the projection dataset.</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_row.num">row.num</code></td>
<td>
<p>Row original number</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_nrep">nrep</code></td>
<td>
<p>Number of repetitions</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_ratio">ratio</code></td>
<td>
<p>Ratio of disaggregation</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_disaggregate">disaggregate</code></td>
<td>
<p>Minimum distance of disaggregation (has to be in the same scale as xy)</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_pseudoabs">pseudoabs</code></td>
<td>
<p>Number of pseudoabsences</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_npres">npres</code></td>
<td>
<p>To select a smaller number of presences from the dataset to be subsetted. The maximum number is the total number of presences</p>
</td></tr>
<tr><td><code id="ecospat.caleval_+3A_replace">replace</code></td>
<td>
<p>F to replace de pseudoabsences</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions generates two list, one with the calibration or training dataset and other list with the evaluation or testing dataset disaggregated with a minimum distance.</p>


<h3>Value</h3>

<p>list(&quot;eval&quot;=eval,&quot;cal&quot;=cal))</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- ecospat.testData
caleval &lt;- ecospat.caleval (data = ecospat.testData[53], xy = data[2:3], row.num = 1:nrow(data), 
nrep = 2, ratio = 0.7, disaggregate = 0.2, pseudoabs = 100, npres = 10, replace = FALSE)
caleval
</code></pre>

<hr>
<h2 id='ecospat.CCV.communityEvaluation.bin'>
Calculates a range of community evaluation metrics based on different thresholding techniques.
</h2><span id='topic+ecospat.CCV.communityEvaluation.bin'></span>

<h3>Description</h3>

<p>The function uses the output of <code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code> to calculate a range of community evaluation metrics based on a selection of thresholding techniques both for the calibration data and independent evaluation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.CCV.communityEvaluation.bin(ccv.modeling.data,
                                    thresholds= c('MAX.KAPPA', 'MAX.ROC','PS_SDM'),
                                    community.metrics=c('SR.deviation','Sorensen'),
                                    parallel=FALSE,
                                    cpus=4,
                                    fix.threshold=0.5,
                                    MCE=5,
                                    MEM=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_ccv.modeling.data">ccv.modeling.data</code></td>
<td>
<p>a <code>'ccv.modeling.data'</code> object returned by <code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_thresholds">thresholds</code></td>
<td>
<p>a selection of thresholds (<code>'FIXED', 'MAX.KAPPA', 'MAX.ACCURACY', 'MAX.TSS', 'SENS_SPEC', 'MAX.ROC', 'OBS.PREVALENCE', 'AVG.PROBABILITY', 'MCE', 'PS_SDM, MEM'</code>) to be calculated and applied for the model evaluation.</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_community.metrics">community.metrics</code></td>
<td>
<p>a selection of community evaluation metrics (<code>'SR.deviation', 'community.AUC', 'community.overprediction' ,'community.underprediction',' community.accuracy', 'community.sensitivity', 'community.specificity', 'community.kappa', 'community.tss', 'Sorensen', 'Jaccard', 'Simpson'</code>) to be calculated for each seleted thresholding technique.</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_parallel">parallel</code></td>
<td>
<p>should parallel computing be allowed (<code>TRUE/FALSE</code>)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_cpus">cpus</code></td>
<td>
<p>number of cpus to use in parallel computing</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_fix.threshold">fix.threshold</code></td>
<td>
<p>fixed threshold to be used. Only gets used if thresholding technique <code>FIXED</code> is selected.</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_mce">MCE</code></td>
<td>
<p>maximum omission error (%) allowed for the thresholding. Only gets used if thresholding technique <code>MCE</code> is selected.</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.bin_+3A_mem">MEM</code></td>
<td>
<p>a vetor with the species richness prediction of a MEM for each site. Only needed if <code>MEM</code> is selected.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the probability output of the <code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code> function and creates binary maps based on the selected thresholding methods. These binary maps are then used to calculate the selected community evaluation metrics both for the calibration and evaluation data of each modeling run.
</p>


<h3>Value</h3>

<table>
<tr><td><code>DataSplitTable</code></td>
<td>
<p>a matrix with <code>TRUE/FALSE</code> for each model run (<code>TRUE</code>=Calibration point, <code>FALSE</code>=Evaluation point)</p>
</td></tr>
<tr><td><code>CommunityEvaluationMetrics.CalibrationSites</code></td>
<td>
<p>a 4-dimensional array containing the community evaluation metrics for the calibartion sites of each run (<code>NA</code> means that the site was used for evaluation)</p>
</td></tr>
<tr><td><code>CommunityEvaluationMetrics.EvaluationSites</code></td>
<td>
<p>a 4-dimensional array containing the community evaluation metrics for the evaluation sites of each run (<code>NA</code> means that the site was used for calibaration)</p>
</td></tr>
<tr><td><code>PA.allSites</code></td>
<td>
<p>a 4-dimensional array of the binary prediction for all sites and runs under the different thresholding appraoches.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Scherrer &lt;daniel.j.a.scherrer@gmail.com&gt;
</p>


<h3>References</h3>

<p>Scherrer, D., D'Amen, M., Mateo, M.R.G., Fernandes, R.F. &amp; Guisan , A. (2018) How to best threshold and validate stacked species assemblages? Community optimisation might hold the answer. Methods in Ecology and Evolution, in review
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code>; <code><a href="#topic+ecospat.CCV.createDataSplitTable">ecospat.CCV.createDataSplitTable</a></code>; <code><a href="#topic+ecospat.CCV.communityEvaluation.prob">ecospat.CCV.communityEvaluation.prob</a></code>
</p>

<hr>
<h2 id='ecospat.CCV.communityEvaluation.prob'>
Evaluates community predictions directly on the probabilities (i.e., threshold independent)
</h2><span id='topic+ecospat.CCV.communityEvaluation.prob'></span>

<h3>Description</h3>

<p>This function generates a number of community evaluation metrics directly based on the probability returned by the individual models. Instead of thresholding the predictions (<code><a href="#topic+ecospat.CCV.communityEvaluation.bin">ecospat.CCV.communityEvaluation.bin</a></code> this function directly uses the probability and compares its outcome to null models or average expectations.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.CCV.communityEvaluation.prob(ccv.modeling.data,
    community.metrics=c('SR.deviation','community.AUC','Max.Sorensen',
                         'Max.Jaccard','probabilistic.Sorensen',
                         'probabilistic.Jaccard'),
    parallel = FALSE, 
    cpus = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.CCV.communityEvaluation.prob_+3A_ccv.modeling.data">ccv.modeling.data</code></td>
<td>
<p>a <code>'ccv.modeling.data'</code> object returned by <code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.prob_+3A_community.metrics">community.metrics</code></td>
<td>
<p>a selection of community metrics to calculate (<code>'SR.deviation','community.AUC','Max.Sorensen','Max.Jaccard',
  'probabilistic.Sorensen','probabilistic.Jaccard')</code>)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.prob_+3A_parallel">parallel</code></td>
<td>
<p>should parallel computing be allowed (<code>TRUE/FALSE</code>)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.communityEvaluation.prob_+3A_cpus">cpus</code></td>
<td>
<p>number of cpus to use in parallel computing</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>DataSplitTable</code></td>
<td>
<p>a matrix with <code>TRUE/FALSE</code> for each model run (<code>TRUE</code>=Calibration point, <code>FALSE</code>=Evaluation point)</p>
</td></tr>
<tr><td><code>CommunityEvaluationMetrics.CalibrationSites</code></td>
<td>
<p>a 3-dimensional array containing the community evaluation metrics for the calibartion sites of each run (<code>NA</code> means that the site was used for evaluation)</p>
</td></tr>
<tr><td><code>CommunityEvaluationMetrics.EvaluationSites</code></td>
<td>
<p>a 3-dimensional array containing the community evaluation metrics for the evaluation sites of each run (<code>NA</code> means that the site was used for calibaration)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the community evaluation metric <code>'SR.deviation'</code> is selected the returned tables will have the following columns: 
</p>

<ul>
<li> <p><code>SR.obs</code> = observed species richness, 
</p>
</li>
<li> <p><code>SR.mean</code> = the predicted species richness (based on the probabilities assuming poission binomial distribution), 
</p>
</li>
<li> <p><code>SR.dev</code> = the deviation of observed and predicted species richness, 
</p>
</li>
<li> <p><code>SR.sd</code> = the standard deviation of the predicted species richness (based on the probabilities assuming poission binomial distribution), 
</p>
</li>
<li> <p><code>SR.prob</code> = the probability that the observed species richness falls within the predicted species richness (based on the probabilities assuming poission binomial distribution), 
</p>
</li>
<li> <p><code>SR.imp.05</code> = improvement of species richness prediction over null-model 0.5, 
</p>
</li>
<li> <p><code>SR.imp.average.SR</code> = improvement of species richness prediction over null-model average.SR and 
</p>
</li>
<li> <p><code>SR.imp.prevalence</code> = improvement of species richness prediction over null-model prevalence.
</p>
</li></ul>

<p>If the community evalation metric <code>community.AUC</code> is selected the returned tables will have the following colums: 
</p>

<ul>
<li> <p><code>Community.AUC</code> = The AUC of ROC of a given site (in this case the ROC plot is community sensitiviy [percentage species predicted corretly present] vs 1 - community specificity [percentage of species predicted correctly absent])
</p>
</li></ul>

<p>If the community evaluation metrics (<code>'Max.Sorensen', 'Max.Jaccard'</code>) is selected the returned tables will have the follwing colums:
</p>

<ul>
<li> <p><code>Max.Jaccard</code> = The maximum possible Jaccard similarity based on an optimal site specific threshold.
</p>
</li>
<li> <p><code>Max.Sorensen</code> = The maximum possible Sorensen similarity based on an optimal site specific threshold.
</p>
</li></ul>

<p>If the community evaluation metrics (<code>'probabilistic.Sorensen', 'probabilistic.Jaccard'</code>) is selected the returned tables will have the follwing colums:
</p>

<ul>
<li> <p><code>probabilistic.Jaccard</code> = The probabilistic Jaccard similarity index based on Scherrer et al. 2019, Methods in Ecology and Evolution
</p>
</li>
<li> <p><code>probabilistic.Sorensen</code> = The probabilistic Sorensen similarity index based on Scherrer et al. 2019, Methods in Ecology and Evolution
</p>
</li>
<li><p>composition.imp.05 = improvement of species compostion prediction over the null-model 0.5.
</p>
</li>
<li><p>composition.imp.average.SR = improvement of the species composition prediction over the null-model average.SR.
</p>
</li>
<li><p>composition.imp.prevalence = improvement of the species composition prediction over the null-model prevalence.
</p>
</li></ul>

<p>For detailed descriptions of the null models see Scherrer et al. 2019
</p>


<h3>Author(s)</h3>

<p>Daniel Scherrer &lt;daniel.j.a.scherrer@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code>; <code><a href="#topic+ecospat.CCV.createDataSplitTable">ecospat.CCV.createDataSplitTable</a></code>; <code><a href="#topic+ecospat.CCV.communityEvaluation.bin">ecospat.CCV.communityEvaluation.bin</a></code>;
</p>

<hr>
<h2 id='ecospat.CCV.createDataSplitTable'>
Creates a DataSplitTable for usage in ecospat.ccv.modeling.
</h2><span id='topic+ecospat.CCV.createDataSplitTable'></span>

<h3>Description</h3>

<p>Creates a DataSplitTable with calibration and evaluation data either for cross-validation or repeated split sampling at the community level (i.e., across all species).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.CCV.createDataSplitTable(NbRunEval, 
                                 DataSplit,
                                 validation.method,
                                 NbSites,
                                 sp.data=NULL,
                                 minNbPresences=NULL,
                                 minNbAbsences=NULL,
                                 maxNbTry=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_nbruneval">NbRunEval</code></td>
<td>
<p>number of cross-validation or split sample runs</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_datasplit">DataSplit</code></td>
<td>
<p>proportion (%) of sites used for model calibration</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_validation.method">validation.method</code></td>
<td>
<p>the type of <code>DataSplitTable</code> that should be created. Must be either <code>'cross-validation'</code> or <code>'split-sample'</code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_nbsites">NbSites</code></td>
<td>
<p>number of total sites available. Is ignored if sp.data is provided.</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_sp.data">sp.data</code></td>
<td>
<p>a data.frame where the rows are sites and the columns are species (values 1,0)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_minnbpresences">minNbPresences</code></td>
<td>
<p>the desired minimum number of Presences required in each run</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_minnbabsences">minNbAbsences</code></td>
<td>
<p>the desired minimum number of Absences required in each run</p>
</td></tr>
<tr><td><code id="ecospat.CCV.createDataSplitTable_+3A_maxnbtry">maxNbTry</code></td>
<td>
<p>number of random tries allowed to create a fitting DataSplitTable</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a <code>sp.data</code> data.frame with species presences and absences is provided the function tries to create a <code>DataSplitTable</code> which ensures that the maximum possible number of species can be modelled (according to the specified minimum presences and absences.)
</p>


<h3>Value</h3>

<table>
<tr><td><code>DataSplitTable</code></td>
<td>
<p>a matrix with <code>TRUE/FALSE</code> for each model run (<code>TRUE</code>=Calibration point, <code>FALSE</code>=Evaluation point)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Scherrer &lt;daniel.j.a.scherrer@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.CCV.modeling">ecospat.CCV.modeling</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a DataSplitTable for 200 sites, 25 runs with an 
#80/20 calibration/evaluation cross-validation

DataSplitTable &lt;- ecospat.CCV.createDataSplitTable(NbSites = 200, 
                                                   NbRunEval=25, 
                                                   DataSplit=80, 
                                                   validation.method='cross-validation')
                                                   
#Loading species occurence data and remove empty communities
testData &lt;- ecospat.testData[,c(24,34,43,45,48,53,55:58,60:63,65:66,68:71)]
sp.data &lt;- testData[which(rowSums(testData)&gt;0), sort(colnames(testData))]

#Creating a DataSplitTable based on species data directly
DataSplitTable &lt;- ecospat.CCV.createDataSplitTable(NbRunEval = 20,
                                                   DataSplit = 70,
                                                   validation.method = "cross-validation",
                                                   NbSites = NULL,
                                                   sp.data = sp.data, 
                                                   minNbPresence = 15, 
                                                   minNbAbsences = 15, 
                                                   maxNbTry = 250)


</code></pre>

<hr>
<h2 id='ecospat.CCV.modeling'>
Runs indivudual species distribuion models with SDMs or ESMs
</h2><span id='topic+ecospat.CCV.modeling'></span>

<h3>Description</h3>

<p>Creates probabilistic prediction for all species based on SDMs or ESMs and returns their evaluation metrics and variable importances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.CCV.modeling(sp.data, 
                     env.data, 
                     xy,
                     DataSplitTable=NULL,
                     DataSplit = 70, 
                     NbRunEval = 25,
                     minNbPredictors =5,
                     validation.method = "cross-validation",
                     models.sdm = c("GLM","RF"), 
                     models.esm = "CTA", 
                     modeling.options.sdm = NULL, 
                     modeling.options.esm = NULL, 
                     ensemble.metric = "AUC", 
                     ESM = "YES",
                     parallel = FALSE, 
                     cpus = 4,
                     VarImport = 10,
                     modeling.id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.CCV.modeling_+3A_sp.data">sp.data</code></td>
<td>
<p>a data.frame where the rows are sites and the columns are species (values 1,0)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_env.data">env.data</code></td>
<td>
<p>either a data.frame where rows are sites and colums are environmental variables or a SpatRaster of the envrionmental variables</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_xy">xy</code></td>
<td>
<p>two column data.frame with X and Y coordinates of the sites (most be same coordinate system as <code>env.data</code>)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_datasplittable">DataSplitTable</code></td>
<td>
<p>a table providing <code>TRUE/FALSE</code> to indicate what points are used for calibration and evaluation. As returned by <code><a href="#topic+ecospat.CCV.createDataSplitTable">ecospat.CCV.createDataSplitTable</a></code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_datasplit">DataSplit</code></td>
<td>
<p>percentage of dataset observations retained for the model training  (only needed if no <code>DataSplitTable</code> provided)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_nbruneval">NbRunEval</code></td>
<td>
<p>number of cross-validatio/split sample runs (only needed if no <code>DataSplitTable</code> provided)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_minnbpredictors">minNbPredictors</code></td>
<td>
<p>minimum number of occurences [min(presences/Absences] per predicotors needed to calibrate the models</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_validation.method">validation.method</code></td>
<td>
<p>either &quot;cross-validation&quot; or &quot;split-sample&quot; used to validate the communtiy predictions (only needed if no <code>DataSplitTable</code> provided)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_models.sdm">models.sdm</code></td>
<td>
<p>modeling techniques used for the normal SDMs. Vector of models names choosen among <code>'GLM', 'GBM', 'GAM', 'CTA', 'ANN', 'SRE', 'FDA', 'MARS', 'RF', 'MAXENT' and 'MAXNET'</code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_models.esm">models.esm</code></td>
<td>
<p>modeling techniques used for the ESMs. Vector of models names choosen among <code>'GLM', 'GBM', 'GAM', 'CTA', 'ANN', 'SRE', 'FDA', 'MARS', 'RF', 'MAXENT' and 'MAXNET'</code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_modeling.options.sdm">modeling.options.sdm</code></td>
<td>
<p>modeling options for the normal SDMs. <code>"BIOMOD.models.options"</code>&quot; object returned by <code><a href="biomod2.html#topic+BIOMOD_ModelingOptions">BIOMOD_ModelingOptions</a></code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_modeling.options.esm">modeling.options.esm</code></td>
<td>
<p>modeling options for the ESMs. <code>"BIOMOD.models.options"</code> object returned by <code><a href="biomod2.html#topic+BIOMOD_ModelingOptions">BIOMOD_ModelingOptions</a></code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_ensemble.metric">ensemble.metric</code></td>
<td>
<p>evaluation score used to weight single models to build ensembles: <code>'AUC', 'Kappa' or 'TSS'</code></p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_esm">ESM</code></td>
<td>
<p>either <code>'YES'</code> (ESMs allowed), <code>'NO'</code> (ESMs not allowed) or <code>'ALL'</code> (ESMs used in any case)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_parallel">parallel</code></td>
<td>
<p>should parallel computing be allowed (<code>TRUE/FALSE</code>)</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_cpus">cpus</code></td>
<td>
<p>number of cpus to use in parallel computing</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_varimport">VarImport</code></td>
<td>
<p>number of permutation runs to evaluate variable importance</p>
</td></tr>
<tr><td><code id="ecospat.CCV.modeling_+3A_modeling.id">modeling.id</code></td>
<td>
<p>character, the ID (=name) of modeling procedure. A random number by default</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of the community cross-validation (CCV) is to use the same data (sites) for the model calibration/evaluation of all species. This ensures that there is &quot;independent&quot; cross-validation/split-sample data available not only at the individual species level but also at the community level. This is key to allow an unbiased estimation of the ability to predict species assemblages (Scherrer et al. 2018). 
The output of the ecospat.CCV.modeling function can then be used to evaluate the species assemblage predictions with the <code><a href="#topic+ecospat.CCV.communityEvaluation.bin">ecospat.CCV.communityEvaluation.bin</a></code> or <code><a href="#topic+ecospat.CCV.communityEvaluation.prob">ecospat.CCV.communityEvaluation.prob</a></code> functions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>modelling.id</code></td>
<td>
<p>character, the ID (=name) of modeling procedure</p>
</td></tr>
<tr><td><code>output.files</code></td>
<td>
<p>vector with the names of the files written to the hard drive</p>
</td></tr>
<tr><td><code>speciesData.calibration</code></td>
<td>
<p>a 3-dimensional array of presence/absence data of all species for the calibration plots used for each run</p>
</td></tr>
<tr><td><code>speciesData.evaluation</code></td>
<td>
<p>a 3-dimensional array of presence/absence data of all species for the evaluation plots used for each run</p>
</td></tr>
<tr><td><code>speciesData.full</code></td>
<td>
<p>a data.frame of presence/absence data of all species (same as <code>sp.data</code> input)</p>
</td></tr>
<tr><td><code>DataSplitTable</code></td>
<td>
<p>a matrix with <code>TRUE/FALSE</code> for each model run (<code>TRUE</code>=Calibration point, <code>FALSE</code>=Evaluation point)</p>
</td></tr>
<tr><td><code>singleSpecies.ensembleEvaluationScore</code></td>
<td>
<p>a 3-dimensional array of single species evaluation metrics (<code>'Max.KAPPA', 'Max.TSS', 'AUC of ROC'</code>)</p>
</td></tr>
<tr><td><code>singleSpecies.ensembleVariableImportance</code></td>
<td>
<p>a 3-dimensional array of single species variable importance for all predictors</p>
</td></tr>
<tr><td><code>singleSpecies.calibrationSites.ensemblePredictions</code></td>
<td>
<p>a 3-dimensional array of the predictions for each species and run at the calibration sites</p>
</td></tr>
<tr><td><code>singleSpecies.evaluationSites.ensemblePredictions</code></td>
<td>
<p>a 3-dimensional array of the predictions for each species and run at the evaluation sites</p>
</td></tr>
<tr><td><code>allSites.averagePredictions.cali</code></td>
<td>
<p>a matrix with the average predicted probabilities for each site across all the runs the sites were used for model calibration</p>
</td></tr>
<tr><td><code>allSites.averagePredictions.eval</code></td>
<td>
<p>a matrix with the average predicted probabilities for each site across all the runs the sites were used as independent evaluation sites</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Scherrer &lt;daniel.j.a.scherrer@gmail.com&gt; with the updates from Flavien Collart and Olivier Broennimann
</p>


<h3>References</h3>

<p>Scherrer, D., D'Amen, M., Mateo, M.R.G., Fernandes, R.F. &amp; Guisan , A. (2018) How to best threshold and validate stacked species assemblages? Community optimisation might hold the answer. Methods in Ecology and Evolution, in review
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.CCV.createDataSplitTable">ecospat.CCV.createDataSplitTable</a></code>; <code><a href="#topic+ecospat.CCV.communityEvaluation.bin">ecospat.CCV.communityEvaluation.bin</a></code>; <code><a href="#topic+ecospat.CCV.communityEvaluation.prob">ecospat.CCV.communityEvaluation.prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  #Loading species occurence data and remove empty communities
  data(ecospat.testData)
  testData &lt;- ecospat.testData[,c(24,34,43,45,48,53,55:58)]
  sp.data &lt;- testData[which(rowSums(testData)&gt;2), sort(colnames(testData))]
  
  #Loading environmental data
  env.data &lt;- ecospat.testData[which(rowSums(testData)&gt;2),4:8]
  
  #Coordinates for all sites
  xy &lt;- ecospat.testData[which(rowSums(testData)&gt;2),2:3]
  
  #Running all the models for all species
  myCCV.Models &lt;- ecospat.CCV.modeling(sp.data = sp.data,
                                       env.data = env.data,
                                       xy = xy,
                                       NbRunEval = 2,
                                       minNbPredictors = 10,
                                       VarImport = 3)
                                       
  #Calculating the probabilistic community metrics
  metrics = c('SR.deviation','community.AUC','probabilistic.Sorensen','Max.Sorensen')
  myCCV.Eval.prob &lt;- ecospat.CCV.communityEvaluation.prob(
          ccv.modeling.data = myCCV.Models, 
          community.metrics = metrics)
          
  #Thresholding all the predictions and calculating the community evaluation metrics
  myCCV.communityEvaluation.bin &lt;- ecospat.CCV.communityEvaluation.bin(
        ccv.modeling.data = myCCV.Models, 
        thresholds = c('MAX.KAPPA', 'MAX.ROC','PS_SDM'),
        community.metrics= c('SR.deviation','Sorensen'),
        parallel = FALSE,
        cpus = 4)
          

</code></pre>

<hr>
<h2 id='ecospat.climan'>A climate analogy setection tool for the modeling of species distributions</h2><span id='topic+ecospat.climan'></span>

<h3>Description</h3>

<p>Assess climate analogy between a projection extent (p) and a reference extent (ref, used in general as the background to calibrate SDMs)</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.climan (ref, p)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.climan_+3A_ref">ref</code></td>
<td>
<p>A dataframe with the value of the variables (i.e columns) for each point of the reference exent.</p>
</td></tr>
<tr><td><code id="ecospat.climan_+3A_p">p</code></td>
<td>
<p>A dataframe with the value of the variables (i.e columns) for each point of the projection exent.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector. Values below 0 are novel conditions at the univariate level (similar to the MESS), values between 0 and 1 are analog and values above 1 are novel covariate condtions. 
For more information see Mesgeran et al. (2014)
</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Mesgaran, M.B., R.D. Cousens and B.L. Webber. 2014. Here be dragons: a tool for quantifying novelty due to covariate range and correlation change when projecting species distribution models. <em>Diversity &amp; Distributions</em>, <b>20</b>, 1147-1159.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ecospat.testData[c(4:8)]
p&lt;- x[1:90,] #A projection dataset.
ref&lt;- x[91:300,] #A reference dataset
ecospat.climan(ref,p)

</code></pre>

<hr>
<h2 id='ecospat.co_occurrences'>Species Co-Occurrences</h2><span id='topic+ecospat.co_occurrences'></span>

<h3>Description</h3>

<p>Calculate an index of species co-occurrences.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.co_occurrences (data)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.co_occurrences_+3A_data">data</code></td>
<td>
<p>A presence-absence matrix for each species (columns) in each location or grid cell (rows) or a matrix with predicted suitability values. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes an index of co-occurrences ranging from 0 (never co-occurring) to 1 (always co-occuring).</p>


<h3>Value</h3>

<p>The species co-occurrence matrix and box-plot of the co-occurrence indices</p>


<h3>Author(s)</h3>

<p>Loic Pellissier <a href="mailto:loic.pellissier@unifr.ch">loic.pellissier@unifr.ch</a></p>


<h3>References</h3>

<p>Pellissier, L., K.A. Brathen, J. Pottier, C.F. Randin, P. Vittoz, A. Dubuis, N.G. Yoccoz, T. Alm, N.E. Zimmermann and A. Guisan. 2010. Species distribution models reveal apparent competitive and facilitative effects of a dominant species on the distribution of tundra plants. <em>Ecography</em>, <b>33</b>, 1004-1014.
</p>
<p>Guisan, A. and N. Zimmermann. 2000. Predictive habitat distribution models in ecology. <em>Ecological Modelling</em>, <b>135</b>:147-186
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
matrix &lt;- ecospat.testData[c(9:16,54:57)]
ecospat.co_occurrences (data=matrix)
</code></pre>

<hr>
<h2 id='ecospat.cohen.kappa'>Cohen's Kappa
</h2><span id='topic+ecospat.cohen.kappa'></span>

<h3>Description</h3>

<p>Calculates Cohen's kappa and variance estimates, within a 95 percent confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.cohen.kappa(xtab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cohen.kappa_+3A_xtab">xtab</code></td>
<td>

<p>A symmetric agreement table.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument xtab is a contingency table.
xtab &lt;- table(Pred &gt;= th, Sp.occ)
</p>


<h3>Value</h3>

<p>A list with elements 'kap', 'vark', 'totn' and 'ci' is returned. 
'kap' is the cohen's kappa, 'vark' is the variance estimate within a 95 percent confidence interval, 'totn' is the number of plots and 'ci' is the confidence interval. 
</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@wsl.ch">christophe.randin@wsl.ch</a> with contributions of Niklaus. E. Zimmermann <a href="mailto:niklaus.zimmermann@wsl.ch">niklaus.zimmermann@wsl.ch</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>
</p>


<h3>References</h3>

<p>Bishop, Y.M.M., S.E. Fienberg and P.W. Holland. 1975. Discrete multivariate analysis: Theory and Practice. Cambridge, MA: MIT Press. pp. 395-397.
</p>
<p>Pearce, J. and S. Ferrier. 2000. Evaluating the predictive performance of habitat models developed using logistic regression. <em>Ecol. Model.</em>, <b>133</b>, 225-245.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.meva.table">ecospat.meva.table</a></code>, <code><a href="#topic+ecospat.max.tss">ecospat.max.tss</a></code>, <code><a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a></code>, <code><a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a></code>, <code><a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris
th &lt;- 0.39 # threshold
xtab &lt;- table(Pred &gt;= th, Sp.occ)

ecospat.cohen.kappa(xtab)
</code></pre>

<hr>
<h2 id='ecospat.CommunityEval'>Community Evaluation</h2><span id='topic+ecospat.CommunityEval'></span>

<h3>Description</h3>

<p>Calculate several indices of accuracy of community predictions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.CommunityEval (eval, pred, proba, ntir, verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.CommunityEval_+3A_eval">eval</code></td>
<td>
<p>A matrix of observed presence-absence (ideally independent from the dataset used to fit species distribution models) of the species with n rows for the sites and s columns for the species.</p>
</td></tr>
<tr><td><code id="ecospat.CommunityEval_+3A_pred">pred</code></td>
<td>
<p>A matrix of predictions for the s species in the n sites. Should have the same dimension as eval.</p>
</td></tr>
<tr><td><code id="ecospat.CommunityEval_+3A_proba">proba</code></td>
<td>
<p>Logical variable indicating whether the prediction matrix contains presences-absences (FALSE) or probabilities (TRUE).</p>
</td></tr>
<tr><td><code id="ecospat.CommunityEval_+3A_ntir">ntir</code></td>
<td>
<p>Number of trials of presence-absence predictions if pred is a probability matrix.</p>
</td></tr>
<tr><td><code id="ecospat.CommunityEval_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates several indices of accuracy of community predictions based on stacked predictions of species ditribution models. In case proba is set to FALSE the function returns one value per index and per site. In case proba is set to TRUE the function generates presences-absences based on the predicted probabilities and returns one value per index, per site and per trial.</p>


<h3>Value</h3>

<p>A list of evaluation metrics calculated for each site (+ each trial if proba is set to TRUE):
</p>
<p>deviance.rich.pred: the deviation of the predicted species richness to the observed
</p>
<p>overprediction: the proportion of species predicted as present but not observed among the species predicted as present
</p>
<p>underprediction: the proportion of species predicted as absent but observed among the species observed as present
</p>
<p>prediction.success: the proportion of species correctly predicted as present or absent
</p>
<p>sensitivity: the proportion of species correctly predicted as present among the species observed as present
</p>
<p>specificity : the proportion of species correctly predicted as absent among the species observed as absent
</p>
<p>kappa: the proportion of specific agreement
</p>
<p>TSS: sensitivity+specificity-1
</p>
<p>similarity: the similarity of community composition between the observation and the prediction. The calculation is based on the Sorenses index.
</p>
<p>Jaccard: this index is a widely used metric of community similarity.</p>


<h3>Author(s)</h3>

<p>Julien Pottier <a href="mailto:julien.pottier@clermont.inra.fr">julien.pottier@clermont.inra.fr</a> 
</p>
<p>with contribution of Daniel Scherrer <a href="mailto:daniel.scherrer@unil.ch">daniel.scherrer@unil.ch</a>, Anne Dubuis <a href="mailto:anne.dubuis@gmail.com">anne.dubuis@gmail.com</a> 
and Manuela D'Amen <a href="mailto:manuela.damen@unil.ch">manuela.damen@unil.ch</a></p>


<h3>References</h3>

<p>Pottier, J., A. Dubuis, L. Pellissier, L. Maiorano, L. Rossier, C.F. Randin, P. Vittoz and A. Guisan. 2013. The accuracy of plant assemblage prediction from species distribution models varies along environmental gradients. <em>Global Ecology and Biogeography</em>, <b>22</b>, 52-63.</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(ecospat.testData)
eval &lt;- ecospat.testData[c(53,62,58,70,61,66,65,71,69,43,63,56,68,57,55,60,54,67,59,64)]
pred &lt;- ecospat.testData[c(73:92)]

ecospat.CommunityEval (eval, pred, proba=TRUE, ntir=10)
</code></pre>

<hr>
<h2 id='ecospat.cons_Cscore'>Constrained Co-Occurrence Analysis.</h2><span id='topic+ecospat.cons_Cscore'></span>

<h3>Description</h3>

<p>Co-occurrence Analysis &amp; Environmentally Constrained Null Models. The function tests for non-random patterns of species co-occurrence in a presence-absence matrix. It calculates the C-score index for the whole community and for each species pair. An environmental constraint is applied during the generation of the null communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cons_Cscore(presence,pred,nperm,outpath,verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cons_Cscore_+3A_presence">presence</code></td>
<td>
<p>A presence-absence dataframe for each species (columns) in each location or grid cell (rows) Column names (species names) and row names (sampling plots).</p>
</td></tr>
<tr><td><code id="ecospat.cons_Cscore_+3A_pred">pred</code></td>
<td>
<p>A dataframe object with SDM predictions. Column names (species names SDM) and row names (sampling plots).</p>
</td></tr>
<tr><td><code id="ecospat.cons_Cscore_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutation in the null model.</p>
</td></tr>
<tr><td><code id="ecospat.cons_Cscore_+3A_outpath">outpath</code></td>
<td>
<p>Path to specify where to save the results.</p>
</td></tr>
<tr><td><code id="ecospat.cons_Cscore_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An environmentally constrained approach to null models will provide a more robust evaluation of species associations by facilitating the distinction between mutually exclusive processes that may shape species distributions and community assembly.
The format required for input databases: a plots (rows) x species (columns) matrix. Input matrices should have column names (species names) and row names (sampling plots).
NOTE: a SES that is greater than 2 or less than -2 is statistically significant with a tail probability of less than 0.05 (Gotelli &amp; McCabe 2002 - Ecology)</p>


<h3>Value</h3>

<p>Returns the C-score index for the observed community (ObsCscoreTot), the mean of C-score for the simulated communities (SimCscoreTot), p.value (PValTot) and standardized effect size (SES.Tot). It also saves a table in the specified path where the same 
metrics are calculated for each species pair (only the table with species pairs with significant p.values is saved in this version). </p>


<h3>Author(s)</h3>

<p>Anne Dubuis <a href="mailto:anne.dubuis@gmail.com">anne.dubuis@gmail.com</a> and Manuela D'Amen <a href="mailto:manuela.damen@unil.ch">manuela.damen@unil.ch</a></p>


<h3>References</h3>

<p>Gotelli, N.J. and D.J. McCabe. 2002. Species co-occurrence: a meta-analysis of JM Diamond's assembly rules model. <em>Ecology</em>, <b>83</b>, 2091-2096.
</p>
<p>Peres-Neto, P.R., J.D. Olden and D.A. Jackson. 2001. Environmentally constrained null models: site suitability as occupancy criterion. <em>Oikos</em>, <b>93</b>, 110-120.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
presence &lt;- ecospat.testData[c(53,62,58,70,61,66,65,71,69,43,63,56,68,57,55,60,54,67,59,64)]
pred &lt;- ecospat.testData[c(73:92)]
nperm &lt;- 10000
outpath &lt;- getwd()
cons_Cscore&lt;-ecospat.cons_Cscore(presence, pred, nperm, outpath)
</code></pre>

<hr>
<h2 id='ecospat.cor.plot'>Correlation Plot</h2><span id='topic+ecospat.cor.plot'></span>

<h3>Description</h3>

<p>A scatter plot of matrices, with bivariate scatter plots below the diagonal, histograms on the diagonal, and the Pearson correlation above the diagonal. Useful for descriptive statistics of small data sets (better with less than 10 variables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cor.plot(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cor.plot_+3A_data">data</code></td>
<td>
<p>A dataframe object with environmental variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adapted from the pairs help page. Uses panel.cor, and panel.hist, all taken from the help pages for pairs. It is a simplifies version of <code> pairs.panels</code>() function of the package <code>psych</code>.
</p>


<h3>Value</h3>

<p>A scatter plot matrix is drawn in the graphic window. The lower off diagonal draws scatter plots, the diagonal histograms, the upper off diagonal reports the Pearson correlation.</p>


<h3>Author(s)</h3>

<p>Adjusted by L. Mathys, 2006, modified by N.E. Zimmermann</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- ecospat.testData[,4:8]
ecospat.cor.plot(data)
</code></pre>

<hr>
<h2 id='ecospat.Cscore'>
Pairwise co-occurrence Analysis with calculation of the C-score index.
</h2><span id='topic+ecospat.Cscore'></span>

<h3>Description</h3>

<p>The function tests for nonrandom patterns of species co-occurrence in a presence-absence matrix. It calculates the C-score index for the whole community and for each species pair. Null communities have column sum fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.Cscore (data, nperm, outpath, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.Cscore_+3A_data">data</code></td>
<td>
<p>A presence-absence dataframe for each species (columns) in each location or grid cell (rows). Column names (species names) and row names (sampling plots).</p>
</td></tr>
<tr><td><code id="ecospat.Cscore_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutation in the null model.</p>
</td></tr>
<tr><td><code id="ecospat.Cscore_+3A_outpath">outpath</code></td>
<td>
<p>Path to specify where to save the results.</p>
</td></tr>
<tr><td><code id="ecospat.Cscore_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows to apply a pairwise null model analysis (Gotelli and Ulrich 2010) to a presence-absence community matrix to determine which species associations are significant across the study area. The strength of associations is quantified by the C-score index (Stone and Roberts 1990) and a 'fixed-equiprobable' null model algorithm is applied.
The format required for input databases: a plots (rows) x species (columns) matrix. Input matrices should have column names (species names) and row names (sampling plots). 
NOTE: a SES that is greater than 2 or less than -2 is statistically significant with a tail probability of less than 0.05 (Gotelli &amp; McCabe 2002). 
</p>


<h3>Value</h3>

<p>The function returns the C-score index for the observed community (ObsCscoreTot), p.value (PValTot) and standardized effect size (SES.Tot). It saves also a table in the working directory where the same metrics are calculated for each species pair (only the table with species pairs with significant p-values is saved in this version)
</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@wsl.ch">christophe.randin@wsl.ch</a> and Manuela D'Amen &lt;manuela.damen@msn.com&gt;
</p>


<h3>References</h3>

<p>Gotelli, N.J. and D.J. McCabe. 2002. Species co-occurrence: a meta-analysis of JM Diamond's
assembly rules model. <em>Ecology</em>, <b>83</b>, 2091-2096.
</p>
<p>Gotelli, N.J. and W. Ulrich. 2010. The empirical Bayes approach as a tool to identify non-random species associations. <em>Oecologia</em>, <b>162</b>, 463-477
</p>
<p>Stone, L. and A. Roberts, A. 1990. The checkerboard score and species distributions. <em>Oecologia</em>, <b>85</b>, 74-79
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.co_occurrences">ecospat.co_occurrences</a></code> and <code><a href="#topic+ecospat.cons_Cscore">ecospat.cons_Cscore</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data&lt;- ecospat.testData[c(53,62,58,70,61,66,65,71,69,43,63,56,68,57,55,60,54,67,59,64)]
nperm &lt;- 10000
outpath &lt;- getwd()
Cscore&lt;-ecospat.Cscore(data, nperm, outpath)


## End(Not run)</code></pre>

<hr>
<h2 id='ecospat.cv.gbm'>GBM Cross Validation</h2><span id='topic+ecospat.cv.gbm'></span>

<h3>Description</h3>

<p>K-fold and leave-one-out cross validation for GBM.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cv.gbm (gbm.obj, data.cv, K=10, cv.lim=10, jack.knife=FALSE, verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cv.gbm_+3A_gbm.obj">gbm.obj</code></td>
<td>
<p>A calibrated GBM object with a binomial error distribution. Attention: users have to tune model input parameters according to their study!</p>
</td></tr>
<tr><td><code id="ecospat.cv.gbm_+3A_data.cv">data.cv</code></td>
<td>
<p>A dataframe object containing the calibration data set with the same names for response and predictor variables.</p>
</td></tr>
<tr><td><code id="ecospat.cv.gbm_+3A_k">K</code></td>
<td>
<p>Number of folds. 10 is recommended; 5 for small data sets.</p>
</td></tr>
<tr><td><code id="ecospat.cv.gbm_+3A_cv.lim">cv.lim</code></td>
<td>
<p>Minimum number of presences required to perform the K-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.gbm_+3A_jack.knife">jack.knife</code></td>
<td>
<p>If TRUE, then the leave-one-out / jacknife cross-validation is performed instead of the 10-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.gbm_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a calibrated GBM object with a binomial error distribution and returns predictions from a stratified 10-fold cross-validation or a leave-one-out / jack-knived cross-validation. Stratified means that the original prevalence of the presences and absences in the full dataset is conserved in each fold.</p>


<h3>Value</h3>

<p>Returns a dataframe with the observations (obs) and the corresponding predictions by cross-validation or jacknife.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a></p>


<h3>References</h3>

<p>Randin, C.F., T. Dirnbock, S. Dullinger, N.E. Zimmermann, M. Zappa and A. Guisan. 2006. Are niche-based species distribution models transferable in space? <em>Journal of Biogeography</em>, <b>33</b>, 1689-1703.
</p>
<p>Pearman, P.B., C.F. Randin, O. Broennimann, P. Vittoz, W.O. van der Knaap, R. Engler, G. Le Lay, N.E. Zimmermann and A. Guisan. 2008. Prediction of plant species distributions across six millennia. <em>Ecology Letters</em>, <b>11</b>, 357-369.</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gbm)
data('ecospat.testData')

# data for Soldanella alpina
data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")] 

# gbm model for Soldanella alpina
gbm.Solalp &lt;- gbm::gbm(Soldanella_alpina ~ ., data = data.Solalp,
                  distribution = "bernoulli", cv.folds = 10, n.cores=2)

# cross-validated predictions
gbm.pred &lt;- ecospat.cv.gbm (gbm.obj= gbm.Solalp,data.Solalp, 
                            K=10, cv.lim=10, jack.knife=FALSE)
</code></pre>

<hr>
<h2 id='ecospat.cv.glm'>GLM Cross Validation</h2><span id='topic+ecospat.cv.glm'></span>

<h3>Description</h3>

<p>K-fold and leave-one-out cross validation for GLM.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cv.glm (glm.obj, K=10, cv.lim=10, jack.knife = FALSE, verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cv.glm_+3A_glm.obj">glm.obj</code></td>
<td>
<p>Any calibrated GLM object with a binomial error distribution.</p>
</td></tr>
<tr><td><code id="ecospat.cv.glm_+3A_k">K</code></td>
<td>
<p>Number of folds. 10 is recommended; 5 for small data sets.</p>
</td></tr>
<tr><td><code id="ecospat.cv.glm_+3A_cv.lim">cv.lim</code></td>
<td>
<p>Minimum number of presences required to perform the K-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.glm_+3A_jack.knife">jack.knife</code></td>
<td>
<p>If TRUE, then the leave-one-out / jacknife cross-validation is performed instead of the 10-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.glm_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a calibrated GLM object with a binomial error distribution and returns predictions from a stratified 10-fold cross-validation or a leave-one-out / jack-knived cross-validation. Stratified means that the original prevalence of the presences and absences in the full dataset is conserved in each fold.</p>


<h3>Value</h3>

<p>Returns a dataframe with the observations (obs) and the corresponding predictions by cross-validation or jacknife.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a></p>


<h3>References</h3>

<p>Randin, C.F., T. Dirnbock, S. Dullinger, N.E. Zimmermann, M. Zappa and A. Guisan. 2006. Are niche-based species distribution models transferable in space? <em>Journal of Biogeography</em>, <b>33</b>, 1689-1703.
</p>
<p>Pearman, P.B., C.F. Randin, O. Broennimann, P. Vittoz, W.O. van der Knaap, R. Engler, G. Le Lay, N.E. Zimmermann and A. Guisan. 2008. Prediction of plant species distributions across six millennia. <em>Ecology Letters</em>, <b>11</b>, 357-369.</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if(require("rms",quietly=TRUE)){
  data('ecospat.testData')

  # data for Soldanella alpina
  data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")] 

  # glm model for Soldanella alpina

  glm.Solalp &lt;- glm(Soldanella_alpina ~ pol(ddeg,2) + pol(mind,2) + pol(srad,2) + pol(slp,2) 
      + pol(topo,2), data = data.Solalp, family = binomial)

  # cross-validated predictions
  glm.pred &lt;- ecospat.cv.glm (glm.obj=glm.Solalp , K=10, cv.lim=10, jack.knife=FALSE)
}

</code></pre>

<hr>
<h2 id='ecospat.cv.me'>Maxent Cross Validation</h2><span id='topic+ecospat.cv.me'></span>

<h3>Description</h3>

<p>K-fold and leave-one-out cross validation for Maxent.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cv.me(data.cv.me, name.sp, names.pred, K=10, cv.lim=10, 
              jack.knife=FALSE, verbose=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cv.me_+3A_data.cv.me">data.cv.me</code></td>
<td>
<p>A dataframe object containing the calibration data set of a Maxent object to validate with the same names for response and predictor variables.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_name.sp">name.sp</code></td>
<td>
<p>Name of the species / response variable.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_names.pred">names.pred</code></td>
<td>
<p>Names of the predicting variables.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_k">K</code></td>
<td>
<p>Number of folds. 10 is recommended; 5 for small data sets.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_cv.lim">cv.lim</code></td>
<td>
<p>Minimum number of presences required to perform the K-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_jack.knife">jack.knife</code></td>
<td>
<p>If TRUE, then the leave-one-out / jacknife cross-validation is performed instead of the 10-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.me_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a calibrated Maxent object with a binomial error distribution and returns predictions from a stratified 10-fold cross-validation or a leave-one-out / jack-knived cross-validation. Stratified means that the original prevalence of the presences and absences in the full dataset is conserved in each fold.</p>


<h3>Value</h3>

<p>Returns a dataframe with the observations (obs) and the corresponding predictions by cross-validation or jacknife.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a></p>


<h3>References</h3>

<p>Randin, C.F., T. Dirnbock, S. Dullinger, N.E. Zimmermann, M. Zappa and A. Guisan. 2006. Are niche-based species distribution models transferable in space? <em>Journal of Biogeography</em>, <b>33</b>, 1689-1703.
</p>
<p>Pearman, P.B., C.F. Randin, O. Broennimann, P. Vittoz, W.O. van der Knaap, R. Engler, G. Le Lay, N.E. Zimmermann and A. Guisan. 2008. Prediction of plant species distributions across six millennia. <em>Ecology Letters</em>, <b>11</b>, 357-369.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data('ecospat.testData')

# data for Soldanella alpina
data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")] 

# maxent modelling and cross-validated predictions

# path to maxent.jar file
path&lt;- paste0(system.file(package="dismo"), "/java/maxent.jar")

if (file.exists(path) &amp; require(rJava)) {
  me.pred &lt;- ecospat.cv.me(data.Solalp, names(data.Solalp)[1],
             names(data.Solalp)[-1], K = 10, cv.lim = 10, jack.knife = FALSE)
  }

</code></pre>

<hr>
<h2 id='ecospat.cv.rf'>RandomForest Cross Validation</h2><span id='topic+ecospat.cv.rf'></span>

<h3>Description</h3>

<p>K-fold and leave-one-out cross validation for randomForest.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.cv.rf (rf.obj, data.cv, K=10, cv.lim=10, jack.knife=FALSE, verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.cv.rf_+3A_rf.obj">rf.obj</code></td>
<td>
<p>Any calibrated randomForest object with a binomial error distribution.</p>
</td></tr>
<tr><td><code id="ecospat.cv.rf_+3A_data.cv">data.cv</code></td>
<td>
<p>A dataframe object containing the calibration data set with the same names for response and predictor variables.</p>
</td></tr>
<tr><td><code id="ecospat.cv.rf_+3A_k">K</code></td>
<td>
<p>Number of folds. 10 is recommended; 5 for small data sets.</p>
</td></tr>
<tr><td><code id="ecospat.cv.rf_+3A_cv.lim">cv.lim</code></td>
<td>
<p>Minimum number of presences required to perform the K-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.rf_+3A_jack.knife">jack.knife</code></td>
<td>
<p>If TRUE, then the leave-one-out / jacknife cross-validation is performed instead of the 10-fold cross-validation.</p>
</td></tr>
<tr><td><code id="ecospat.cv.rf_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a calibrated randomForest object with a binomial error distribution and returns predictions from a stratified 10-fold cross-validation or a leave-one-out / jack-knived cross-validation. Stratified means that the original prevalence of the presences and absences in the full dataset is conserved in each fold.</p>


<h3>Value</h3>

<p>Returns a dataframe with the observations (obs) and the corresponding predictions by cross-validation or jacknife.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@wsl.ch">christophe.randin@wsl.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a></p>


<h3>References</h3>

<p>Randin, C.F., T. Dirnbock, S. Dullinger, N.E. Zimmermann, M. Zappa and A. Guisan. 2006. Are niche-based species distribution models transferable in space? <em>Journal of Biogeography</em>, <b>33</b>, 1689-1703.
</p>
<p>Pearman, P.B., C.F. Randin, O. Broennimann, P. Vittoz, W.O. van der Knaap, R. Engler, G. Le Lay, N.E. Zimmermann and A. Guisan. 2008. Prediction of plant species distributions across six millennia. <em>Ecology Letters</em>, <b>11</b>, 357-369.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ecospat.testData')

# data for Soldanella alpina
data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")] 

library(randomForest)
rf.Solalp &lt;- randomForest(x = data.Solalp[,-1], y = as.factor(data.Solalp[,1]))
rf.pred &lt;- ecospat.cv.rf(rf.Solalp, data.Solalp, K = 10, cv.lim = 10, 
                         jack.knife = FALSE, verbose = FALSE)
</code></pre>

<hr>
<h2 id='ecospat.Epred'>Prediction Mean</h2><span id='topic+ecospat.Epred'></span>

<h3>Description</h3>

<p>Calculate the mean (or weighted mean) of several predictions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.Epred (x, w=rep(1,ncol(x)), th=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.Epred_+3A_x">x</code></td>
<td>
<p>A dataframe object with SDM predictions.</p>
</td></tr>
<tr><td><code id="ecospat.Epred_+3A_w">w</code></td>
<td>
<p>Weight of the model, e.g. AUC. The default is 1.</p>
</td></tr>
<tr><td><code id="ecospat.Epred_+3A_th">th</code></td>
<td>
<p>Threshold used to binarize.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weighted Average consensus method utilizes pre-evaluation of the predictive performance of the single-models. In this approach, half (i.e. four) of the eight single-models with highest accuracy are selected first, and then a WA is calculated based on the pre-evaluated AUC of the single-models</p>


<h3>Value</h3>

<p>A weighted mean binary transformation of the models.</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Boyce, M.S.,  P.R. Vernier, S.E. Nielsen and  F.K.A. Schmiegelow. 2002. Evaluating resource selection functions. <em>Ecol. Model.</em>, <b>157</b>, 281-300.
</p>
<p>Marmion, M., M. Parviainen, M. Luoto, R.K. Heikkinen andW.  Thuiller. 2009. Evaluation of consensus methods in predictive species distribution modelling.  <em>Diversity and Distributions</em>, <b>15</b>, 59-69.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ecospat.testData[c(92,96)]
mean &lt;- ecospat.Epred (x, w=rep(1,ncol(x)), th=0.5)
</code></pre>

<hr>
<h2 id='ecospat.ESM.EnsembleEvaluation'>
Ensemble of Small Models: Evaluation via the Pooling procedure
</h2><span id='topic+ecospat.ESM.EnsembleEvaluation'></span>

<h3>Description</h3>

<p>This function evaluates the Ensemble of Small Models by pooling the different runs of the cross validation as in Collart et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.ESM.EnsembleEvaluation(ESM.modeling.output,
                               ESM.EnsembleModeling.output,
                               metrics = c("SomersD","AUC","MaxTSS","MaxKappa","Boyce"), 
                               EachSmallModels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.EnsembleEvaluation_+3A_esm.modeling.output">ESM.modeling.output</code></td>
<td>
<p>a <code>list</code> returned by <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleEvaluation_+3A_esm.ensemblemodeling.output">ESM.EnsembleModeling.output</code></td>
<td>
<p>a <code>list</code> returned by <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleEvaluation_+3A_metrics">metrics</code></td>
<td>
<p>a vector of evaluation metrics chosen among &quot;SomersD&quot;, &quot;AUC&quot;, &quot;MaxTSS&quot;, &quot;MaxKappa&quot;, &quot;Boyce&quot;</p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleEvaluation_+3A_eachsmallmodels">EachSmallModels</code></td>
<td>
<p>should the individual bivariate models be evaluated by the pooling procedure?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because a minimum sample size is needed to evaluate models (see Collart &amp; Guisan, 2023), this function uses the approach from Collart et al.(2021), which consists to pool the suitability values of the hold-out data (evaluation dataset) across replicates. As the same data point (presence or absence or background point) is presumably sampled in several replicates, the suitability values for each data point is consequently averaged across replicates where they were sampled. This procedure generates a series of independent suitability values with a size approximately equal (as some data points may not have been sampled by chance in any of the <em>n</em> replicates) to that of the number of data point.
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr><td><code>ESM.evaluations</code></td>
<td>
<p>a matrix with the evaluation scores for the ESMs based on the different modelling algorithms and based on the consensus across the modelling algorithms (called here &quot;ensemble&quot;)</p>
</td></tr>
<tr><td><code>ESM.fit</code></td>
<td>
<p>a matrix of predicted values resulting from the pooling procedure and used to compute the evaluation scores. The column <em>resp</em> is where the species occurs or not</p>
</td></tr>
<tr><td><code>ESM.evaluations.bivariate.models</code></td>
<td>
<p>a list containing a matrix of evaluation scores for each bivariate models (generated only if EachSmallModels = T)</p>
</td></tr>
<tr><td><code>ESM.fit.bivariate.models</code></td>
<td>
<p>a list containing a matrix of of predicted values resulting from the pooling procedure for each bivariate models (generated only if EachSmallModels = T)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Flavien Collart <a href="mailto:flavien.collart@unil.ch">flavien.collart@unil.ch</a>
</p>
<p>with contributions of Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Collart, F., &amp; Guisan, A. (2023). Small to train, small to test: Dealing with low sample size in model evaluation. <em>Ecological Informatics</em>. <b>75</b>, 102106. <a href="https://doi.org/10.1016/j.ecoinf.2023.102106">doi:10.1016/j.ecoinf.2023.102106</a>
</p>
<p>Collart, F., Hedenas, L., Broennimann, O., Guisan, A. and Vanderpoorten, A. 2021. Intraspecific differentiation: Implications for niche and distribution modelling. <em>Journal of Biogeography</em>. <b>48</b>, 415-426. <a href="https://doi.org/10.1111/jbi.14009">doi:10.1111/jbi.14009</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.EnsembleModeling'>
Ensemble of Small Models: Evaluates and Averages Simple Bivariate Models To ESMs
</h2><span id='topic+ecospat.ESM.EnsembleModeling'></span>

<h3>Description</h3>

<p>This function evaluates and averages simple bivariate models by weighted means to Ensemble Small Models as in Lomba et al. 2010 and Breiner et al. 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.EnsembleModeling( ESM.modeling.output, 
                                  weighting.score, 
                                  threshold=NULL, 
                                  models)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.EnsembleModeling_+3A_esm.modeling.output">ESM.modeling.output</code></td>
<td>
<p>a <code>list</code> returned by <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleModeling_+3A_weighting.score">weighting.score</code></td>
<td>
<p>an evaluation score used to weight single models to build ensembles:&quot;AUC&quot;,&quot;TSS&quot;,
</p>
<p>&quot;Boyce&quot;,&quot;Kappa&quot;,&quot;SomersD&quot; #the evaluation methods used to evaluate ensemble models 
</p>
<p>( see <code>"<a href="biomod2.html#topic+BIOMOD_Modeling">BIOMOD_Modeling</a>"</code>  <b>models.eval.meth</b> section for more detailed informations )
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleModeling_+3A_threshold">threshold</code></td>
<td>

<p>threshold value of an evaluation score to select the bivariate model(s) included for building the ESMs
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleModeling_+3A_models">models</code></td>
<td>

<p>vector of models names choosen among 'GLM', 'GBM', 'GAM', 'CTA', 'ANN', 'SRE', 'FDA', 'MARS', 'RF','MAXENT', &quot;MAXNET&quot; (same as in <code>biomod2</code>)
</p>
<p>#a character vector (either 'all' or a sub-selection of model names) that defines the models kept for building the ensemble models (might be useful for removing some non-preferred models)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of ensemble of small models (ESMs) is to model a species distribution based on small, simple models, for example all possible bivariate models (i.e. models that contain only two predictors at a time out of a larger set of predictors), and then combine all possible bivariate models into an ensemble (Lomba et al. 2010; Breiner et al. 2015).
</p>
<p>The ESM set of functions could be used to build ESMs using simple bivariate models which are averaged using weights based on model performances (e.g. AUC) according to Breiner et al. (2015). They provide full functionality of the approach described in Breiner et al. (2015).
</p>


<h3>Value</h3>

<p>species:          species name
ESM.fit:          data.frame of the predicted values for the data used to build the models.
ESM.evaluations:  data.frame with evaluations scores for the ESMs
weights:          weighting scores used to weight the bivariate models to build the single ESM
weights.EF:       weighting scores used to weight the single ESM to build the ensemble of ESMs from different modelling techniques (only available if &gt;1 modelling techniques were selected).
failed:           bivariate models which failed because they could not be calibrated.
</p>
<p>A <code>"<a href="biomod2.html#topic+BIOMOD.ensemble.models.out-class">BIOMOD.ensemble.models.out</a>"</code> object. This object will be later given to <code><a href="#topic+ecospat.ESM.EnsembleProjection">ecospat.ESM.EnsembleProjection</a></code> if you want to make some projections of this ensemble-models.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> 
</p>
<p>with contributions of Olivier Broennimann and Flavien Collart <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Lomba, A., L. Pellissier, C.F. Randin, J. Vicente, F. Moreira, J. Honrado and A. Guisan. 2010. Overcoming the rare species modelling paradox: A novel hierarchical framework applied to an Iberian endemic plant. <em>Biological Conservation</em>, <b>143</b>,2647-2657.
</p>
<p>Breiner F.T., A. Guisan, A. Bergamini and M.P. Nobis. 2015. Overcoming limitations of modelling rare species by using ensembles of small models. <em>Methods in Ecology and Evolution</em>, <b>6</b>,1210-1218.
</p>
<p>Breiner F.T., Nobis M.P., Bergamini A., Guisan A. 2018. Optimizing ensembles of small models for predicting the distribution of species with few occurrences. <em>Methods in Ecology and Evolution</em>. <a href="https://doi.org/10.1111/2041-210X.12957">doi:10.1111/2041-210X.12957</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.EnsembleProjection'>
Ensemble of Small Models: Projects Calibrated ESMs Into New Space Or Time.
</h2><span id='topic+ecospat.ESM.EnsembleProjection'></span>

<h3>Description</h3>

<p>This function projects calibrated ESMs into new space or time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.EnsembleProjection( ESM.prediction.output, 
                                    ESM.EnsembleModeling.output,
                                    chosen.models = 'all')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.EnsembleProjection_+3A_esm.prediction.output">ESM.prediction.output</code></td>
<td>
<p>a list object returned by <code><a href="#topic+ecospat.ESM.Projection">ecospat.ESM.Projection</a></code>
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleProjection_+3A_esm.ensemblemodeling.output">ESM.EnsembleModeling.output</code></td>
<td>

<p>a list object returned by <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.EnsembleProjection_+3A_chosen.models">chosen.models</code></td>
<td>
<p>a character vector (either 'all' or a sub-selection of model names, e.g. c(GLM, GBM)) to remove models from the ensemble. Default is 'all'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of ensemble of small models (ESMs) is to model a species distribution based on small, simple models, for example all possible bivariate models (i.e. models that contain only two predictors at a time out of a larger set of predictors), and then combine all possible bivariate models into an ensemble (Lomba et al. 2010; Breiner et al. 2015).
</p>
<p>The ESM set of functions could be used to build ESMs using simple bivariate models which are averaged using weights based on model performances (e.g. AUC) according to Breiner et al. (2015). They provide full functionality of the approach described in Breiner et al. (2015).
For projections only the full models (100
</p>
<p>For further details please refer to <code><a href="biomod2.html#topic+BIOMOD_EnsembleForecasting">BIOMOD_EnsembleForecasting</a></code>.
</p>


<h3>Value</h3>

<p>Returns the projections of ESMs for the selected single models and their ensemble (data frame or SpatRaster). ESM.projections &lsquo;projection files&rsquo; are saved on the hard drive projection folder. This files are either an <code>array</code> or a <code>SpatRaster</code> depending the original projections data type.
Load these created files to plot and work with them.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner with the contributions of Flavien Collart <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a>
</p>


<h3>References</h3>

<p>Lomba, A., L. Pellissier, C.F. Randin, J. Vicente, F. Moreira, J. Honrado and A. Guisan. 2010. Overcoming the rare species modelling paradox: A novel hierarchical framework applied to an Iberian endemic plant. <em>Biological Conservation</em>, <b>143</b>,2647-2657.
</p>
<p>Breiner F.T., A. Guisan, A. Bergamini and M.P. Nobis. 2015. Overcoming limitations of modelling rare species by using ensembles of small models. <em>Methods in Ecology and Evolution</em>, <b>6</b>,1210-1218.
</p>
<p>Breiner F.T., Nobis M.P., Bergamini A., Guisan A. 2018. Optimizing ensembles of small models for predicting the distribution of species with few occurrences. <em>Methods in Ecology and Evolution</em>. <a href="https://doi.org/10.1111/2041-210X.12957">doi:10.1111/2041-210X.12957</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.Modeling'>
Ensemble of Small Models: Calibration of Simple Bivariate Models
</h2><span id='topic+ecospat.ESM.Modeling'></span>

<h3>Description</h3>

<p>This function calibrates simple bivariate models as in Lomba et al. 2010 and Breiner et al. 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.Modeling( data, 
                          NbRunEval, 
                          DataSplit, 
                          DataSplitTable, 
                          Prevalence,
                          weighting.score, 
                          models, 
                          tune,
                          modeling.id, 
                          models.options, 
                          which.biva, 
                          parallel, 
                          cleanup,
                          Yweights)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.Modeling_+3A_data">data</code></td>
<td>
<p><code>BIOMOD.formated.data</code> object returned by <code><a href="biomod2.html#topic+BIOMOD_FormatingData">BIOMOD_FormatingData</a></code>
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_nbruneval">NbRunEval</code></td>
<td>

<p>number of dataset splitting replicates for the model evaluation (same as in <code>biomod2</code>)
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_datasplit">DataSplit</code></td>
<td>

<p>percentage of dataset observations retained for the model training (same as in <code>biomod2</code>)
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_datasplittable">DataSplitTable</code></td>
<td>

<p>a matrix or data.frame filled with TRUE/FALSE to specify which part of data must be used for models calibration (TRUE) and for models validation (FALSE). Each column corresponds to a 'RUN'. For a presence-absence dataset, column names must be formatted as: _allData_RUNx with x an integer. For a presence-only dataset, column names must be formatted as: _PA1_RUNx with x an integer. If filled, arguments NbRunEval and DataSplit  will be ignored.
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_prevalence">Prevalence</code></td>
<td>

<p>either NULL or a 0-1 numeric used to build 'weighted response weights'. In contrast to Biomod the default is 0.5 (weighting presences equally to the absences). If NULL each observation (presence or absence) has the same weight (independent of the number of presences and absences).
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_weighting.score">weighting.score</code></td>
<td>

<p>evaluation score used to weight single models to build ensembles: 'AUC', 'SomersD' (2xAUC-1), 'Kappa', 'TSS' or 'Boyce'
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_models">models</code></td>
<td>

<p>vector of models names choosen among 'GLM', 'GBM', 'GAM', 'CTA', 'ANN', 'SRE', 'FDA', 'MARS', 'RF','MAXENT', 'MAXNET' (same as in <code>biomod2</code>)
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_tune">tune</code></td>
<td>

<p>logical. if true model tuning will be used to estimate optimal parameters for the models (Default: False).
</p>
</td></tr>    
<tr><td><code id="ecospat.ESM.Modeling_+3A_modeling.id">modeling.id</code></td>
<td>

<p>character, the ID (=name) of modeling procedure. A random number by default.
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_models.options">models.options</code></td>
<td>

<p>BIOMOD.models.options object returned by BIOMOD_ModelingOptions (same as in <code>biomod2</code>)
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_yweights">Yweights</code></td>
<td>

<p>response points weights. This argument will only affect models that allow case weights. 
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_which.biva">which.biva</code></td>
<td>

<p>integer. which bivariate combinations should be used for modeling? Default: all
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_parallel">parallel</code></td>
<td>

<p>logical. If TRUE, the parallel computing is enabled (highly recommended)
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Modeling_+3A_cleanup">cleanup</code></td>
<td>

<p><b>No more available</b>. Please use terra::TmpFiles instead 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of ensemble of small models (ESMs) is to model a species distribution based on small, simple models, for example all possible bivariate models (i.e. models that contain only two predictors at a time out of a larger set of predictors), and then combine all possible bivariate models into an ensemble (Lomba et al. 2010; Breiner et al. 2015).
</p>
<p>The ESM set of functions could be used to build ESMs using simple bivariate models which are averaged using weights based on model performances (e.g. AUC) according to Breiner et al. (2015). They provide full functionality of the approach described in Breiner et al. (2015).
</p>
<p>The argument <code>which.biva</code> allows to split model runs, e.g. if <code>which.biva</code> is 1:3, only the three first bivariate variable combinations will be modeled. This allows to run different biva splits on different computers. However, it is better not to use this option if all models are run on a single computer.
Default: running all biva models. 
NOTE: Make sure to give each of your biva runs a unique <code>modeling.id</code>. Please avoid space characters in your working directory path if you are using MAXENT because this can cause an error.
</p>


<h3>Value</h3>

<p>A BIOMOD.models.out object (same as in <code>biomod2</code>)
See <code>"<a href="biomod2.html#topic+BIOMOD.models.out-class">BIOMOD.models.out</a>"</code> for details.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> and Mirko Di Febbraro <a href="mailto:mirkodifebbraro@gmail.com">mirkodifebbraro@gmail.com</a> with contributions of Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a> and Flavien Collart
</p>


<h3>References</h3>

<p>Lomba, A., L. Pellissier, C.F. Randin, J. Vicente, F. Moreira, J. Honrado and A. Guisan. 2010. Overcoming the rare species modelling paradox: A novel hierarchical framework applied to an Iberian endemic plant. 
<em>Biological Conservation</em>, <b>143</b>,2647-2657.
</p>
<p>Breiner F.T., A. Guisan, A. Bergamini and M.P. Nobis. 2015. Overcoming limitations of modelling rare species by using ensembles of small models. <em>Methods in Ecology and Evolution</em>, <b>6</b>,1210-1218.
</p>
<p>Breiner F.T., Nobis M.P., Bergamini A., Guisan A. 2018. Optimizing ensembles of small models for predicting the distribution of species with few occurrences. <em>Methods in Ecology and Evolution</em>. <a href="https://doi.org/10.1111/2041-210X.12957">doi:10.1111/2041-210X.12957</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Projection">ecospat.ESM.Projection</a></code>, <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code>,   <code><a href="#topic+ecospat.ESM.EnsembleProjection">ecospat.ESM.EnsembleProjection</a></code>, <code><a href="#topic+ecospat.ESM.EnsembleEvaluation">ecospat.ESM.EnsembleEvaluation</a></code>,
<code><a href="#topic+ecospat.ESM.threshold">ecospat.ESM.threshold</a></code>,<code><a href="#topic+ecospat.ESM.VarContrib">ecospat.ESM.VarContrib</a></code>,
<code><a href="#topic+ecospat.ESM.responsePlot">ecospat.ESM.responsePlot</a></code>
</p>
<p><code><a href="biomod2.html#topic+BIOMOD_FormatingData">BIOMOD_FormatingData</a></code>, <code><a href="biomod2.html#topic+BIOMOD_ModelingOptions">BIOMOD_ModelingOptions</a></code>, <code><a href="biomod2.html#topic+BIOMOD_Modeling">BIOMOD_Modeling</a></code>,<code><a href="biomod2.html#topic+BIOMOD_Projection">BIOMOD_Projection</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
   
library(biomod2)

# Loading test data
data(ecospat.testNiche.inv)
inv &lt;- ecospat.testNiche.inv

# species occurrences
xy &lt;- inv[,1:2]
sp_occ &lt;- inv[11]

# env data
current &lt;- inv[3:8]

### Formating the data with the BIOMOD_FormatingData() function from the package biomod2
sp &lt;- 1
myBiomodData &lt;- biomod2::BIOMOD_FormatingData( resp.var = as.numeric(sp_occ[,sp]),
                                      expl.var = current,
                                      resp.xy = xy,
                                      resp.name = colnames(sp_occ)[sp])

### Calibration of simple bivariate models
my.ESM &lt;- ecospat.ESM.Modeling( data=myBiomodData,
                                models=c('GLM'),
                                NbRunEval=2,
                                DataSplit=70,
                                weighting.score=c("AUC"),
                                parallel=FALSE)  

### Ensemble models
my.ESM_EF &lt;- ecospat.ESM.EnsembleModeling(my.ESM,weighting.score=c("SomersD"),threshold=0)

### thresholds to produce binary maps
my.ESM_thresholds &lt;- ecospat.ESM.threshold(my.ESM_EF)

### Evaluation of bivariate and ensemble models based on standard cross-validation
my.ESM_EF$ESM.evaluations
my.ESM_thresholds

### Evaluation of the ensemble models based on the pooling procedure 
my.ESM_evaluations &lt;- ecospat.ESM.EnsembleEvaluation(ESM.modeling.output= my.ESM,
                                                     ESM.EnsembleModeling.output = my.ESM_EF,
                                                     metrics= c("AUC","MaxTSS"),
                                                     EachSmallModels = FALSE)
my.ESM_evaluations$ESM.evaluations

### Projection of simple bivariate models into new space 
my.ESM_proj_current&lt;-ecospat.ESM.Projection(ESM.modeling.output=my.ESM,
                                            new.env=current)
### Projection of calibrated ESMs into new space 
my.ESM_EFproj_current &lt;- ecospat.ESM.EnsembleProjection(ESM.prediction.output=my.ESM_proj_current,
                                                        ESM.EnsembleModeling.output=my.ESM_EF)
### Binary Projection based on max TSS of calibrated ESMs into new space                                                
my.ESM_EFproj_current_binary &lt;- (my.ESM_EFproj_current &gt; (my.ESM_thresholds$TSS.th*1000))*1

## get the variable contributions of ESMs
ecospat.ESM.VarContrib(my.ESM,my.ESM_EF)                                                      

## get the response plots of ESMs
my.ESM_responsePlot&lt;-ecospat.ESM.responsePlot(my.ESM_EF,my.ESM,fixed.var.metric = 'mean')

</code></pre>

<hr>
<h2 id='ecospat.ESM.Projection'>
Ensemble of Small Models: Projects Simple Bivariate Models Into New Space Or Time
</h2><span id='topic+ecospat.ESM.Projection'></span>

<h3>Description</h3>

<p>This function projects simple bivariate models on new.env
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.Projection(ESM.modeling.output, 
                           new.env,
                           name.env,
                           parallel,
                           cleanup)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.Projection_+3A_esm.modeling.output">ESM.modeling.output</code></td>
<td>

<p><code>list</code> object returned by <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Projection_+3A_new.env">new.env</code></td>
<td>

<p>A set of explanatory variables onto which models will be projected. It could be a <code>data.frame</code>, a <code>matrix</code>, or a <code>SpatRaster</code> object. Make sure the column names (<code>data.frame</code> or <code>matrix</code>) or layer Names (<code>SpatRaster</code>) perfectly match with the names of variables used to build the models in the previous steps.
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Projection_+3A_name.env">name.env</code></td>
<td>

<p>A name for the new.env object. If not specified (default) the name of the new.env object will be used. It is necessary to specify a unique name when projecting various new.env objects in a loop. 
</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Projection_+3A_parallel">parallel</code></td>
<td>

<p>Logical. If TRUE, the parallel computing is enabled</p>
</td></tr>
<tr><td><code id="ecospat.ESM.Projection_+3A_cleanup">cleanup</code></td>
<td>

<p><b>No more available</b>. Please use terra::TmpFiles instead </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea of ensemble of small models (ESMs) is to model a species distribution based on small, simple models, for example all possible bivariate models (i.e. models that contain only two predictors at a time out of a larger set of predictors), and then combine all possible bivariate models into an ensemble (Lomba et al. 2010; Breiner et al. 2015).
</p>
<p>The ESM set of functions could be used to build ESMs using simple bivariate models which are averaged using weights based on model performances (e.g. AUC) accoring to Breiner et al (2015). They provide full functionality of the approach described in Breiner et al. (2015).
</p>
<p>The name of <code>new.env</code> must be a regular expression (see ?regex)
</p>


<h3>Value</h3>

<p>Returns the projections for all selected models (same as in <code>biomod2</code>)
See <code>"<a href="biomod2.html#topic+BIOMOD.projection.out-class">BIOMOD.projection.out</a>"</code> for details.
</p>


<h3>Author(s)</h3>

<p> Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> 
</p>
<p>with contributions of Olivier Broennimann and Flavien Collart <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Lomba, A., L. Pellissier, C.F. Randin, J. Vicente, F. Moreira, J. Honrado and A. Guisan. 2010. Overcoming the rare species modelling paradox: A novel hierarchical framework applied to an Iberian endemic plant. <em>Biological Conservation</em>, <b>143</b>,2647-2657.
</p>
<p>Breiner F.T., A. Guisan, A. Bergamini and M.P. Nobis. 2015. Overcoming limitations of modelling rare species by using ensembles of small models. <em>Methods in Ecology and Evolution</em>, <b>6</b>,1210-1218.
</p>
<p>Breiner F.T., Nobis M.P., Bergamini A., Guisan A. 2018. Optimizing ensembles of small models for predicting the distribution of species with few occurrences. <em>Methods in Ecology and Evolution</em>. <a href="https://doi.org/10.1111/2041-210X.12957">doi:10.1111/2041-210X.12957</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.responsePlot'>
Produce response plots for ESMs
</h2><span id='topic+ecospat.ESM.responsePlot'></span>

<h3>Description</h3>

<p>This function creates response plots (evaluation strips) for Ensmebles of Small Models (ESMs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.responsePlot( ESM.EnsembleModeling.output,
                              ESM.modeling.output,
                              fixed.var.metric = 'median')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.responsePlot_+3A_esm.modeling.output">ESM.modeling.output</code></td>
<td>
<p>a list object returned by <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.responsePlot_+3A_esm.ensemblemodeling.output">ESM.EnsembleModeling.output</code></td>
<td>
<p>a list object returned by <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.responsePlot_+3A_fixed.var.metric">fixed.var.metric</code></td>
<td>
<p>either 'median' (default), 'mean', 'min' or 'max' specifying the statistic used to fix as constant the remaining variables when the predicted response is estimated for one of the variables. (same as in <code><a href="biomod2.html#topic+response.plot2">response.plot2</a></code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function plots the response curves of a model for each variable, while keeping the remianing variables constant. This is an adaptation of the Evaluation Strip method proposed by Elith et al.(2005)
</p>


<h3>Value</h3>

<p>A plot of the response curves is produced (red line Ensemble, grey lines single algorithms) and a list with the output is provided.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@unil.ch">frank.breiner@unil.ch</a>
</p>


<h3>References</h3>

<p>Elith, J., Ferrier, S., Huettmann, FALSE. &amp; Leathwick, J. R. 2005 The evaluation strip: A new and robust method for plotting predicted responses from species distribution models. Ecological Modelling 186, 280-289.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.threshold'>
Thresholds for Ensemble of Small Models
</h2><span id='topic+ecospat.ESM.threshold'></span>

<h3>Description</h3>

<p>This function evaluates the full model which is used for projections and provides thresholds to produce binary maps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.threshold( ESM.EnsembleModeling.output, 
                           PEplot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.threshold_+3A_esm.ensemblemodeling.output">ESM.EnsembleModeling.output</code></td>
<td>
<p>a list object returned by <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.threshold_+3A_peplot">PEplot</code></td>
<td>
<p>logical. Should the predicted to expected ratio along the suitability class from the boyce index be plotted. Default FALSE (see <code><a href="#topic+ecospat.boyce">ecospat.boyce</a></code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function provides evaluation scores of the full model (no split sampling) and thresholds which can be used to convert suitability maps into binary maps. Various thresholds are provided: TSS (where sensitivity and specificity are maximised), MPA 1.0 (where all presences are prdicted positive), MPA 0.95 (where 95% of all presences are predicted positive), MPA 0.90 (where 90% of all presences are predicted positive), Boyce.th.min (the lowest suitability value where the predicted/expected ratio is &gt;1) and Boyce.th.max (the highest suitability value where the predicted/expected ratio is =1). 
</p>


<h3>Value</h3>

<p>A data.frame with evluation scores and thresholds.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@unil.ch">frank.breiner@unil.ch</a>
</p>


<h3>References</h3>

<p>Hirzel, Alexandre H., et al. Evaluating the ability of habitat suitability models to predict species presences. <em>Ecological modelling</em>, <b>199.2</b> (2006): 142-152.
</p>
<p>Engler, Robin, Antoine Guisan, and Luca Rechsteiner. An improved approach for predicting the distribution of rare and endangered species from occurrence and pseudo-absence data. <em>Journal of applied ecology</em>, <b>41.2</b> (2004): 263-274.
</p>
<p>Fielding, Alan H., and John F. Bell. A review of methods for the assessment of prediction errors in conservation presence/absence models.&quot; <em>Environmental conservation</em>, <b>24.1</b> (1997): 38-49.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>

<hr>
<h2 id='ecospat.ESM.VarContrib'>
Variable contribution in ESM
</h2><span id='topic+ecospat.ESM.VarContrib'></span>

<h3>Description</h3>

<p>calculates the variable contribution of each variable and method in an ESM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.ESM.VarContrib(ESM.modeling.output,
                           ESM_EF.output)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.ESM.VarContrib_+3A_esm.modeling.output">ESM.modeling.output</code></td>
<td>
<p><code>BIOMOD.formated.data</code> object returned by <code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code></p>
</td></tr>
<tr><td><code id="ecospat.ESM.VarContrib_+3A_esm_ef.output">ESM_EF.output</code></td>
<td>
<p><code>BIOMOD.formated.data</code> object returned by <code><a href="#topic+ecospat.ESM.EnsembleModeling">ecospat.ESM.EnsembleModeling</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the ratio between sum of weights of bivariate models where a focal variable was used and sum of weights of bivariate models where the focal variable was not used. The ratio is corrected for the number of models with or without the focal variable. This ratio gives an indication on the proportional contribution of the variable in the final ensemble model. A value of higher than 1 indicate that the focal variable has a higher contribution than average.
In the case of multiple methods (e.g., GLM, GAM...), the contributions are counted per method. For ensemble model, the contributions are then weighted means (based on the weighting score as chosen in ecospat.ESM.EnsembleModeling()) of single methods
</p>


<h3>Value</h3>

<p>Returns a dataframe with contribution values (i.e. proportional contribution) by variable and model
</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann &lt;Olivier.Broennimann@unil.ch&gt; with contributions of Heidi Mod <a href="mailto:Heidi.mod1@gmail.com">Heidi.mod1@gmail.com</a> and Daniel Scherrer <a href="mailto:daniel.j.a.scherrer@gmail.com">daniel.j.a.scherrer@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.Modeling">ecospat.ESM.Modeling</a></code>
</p>

<hr>
<h2 id='ecospat.grid.clim.dyn'>Dynamic Occurrence Densities Grid</h2><span id='topic+ecospat.grid.clim.dyn'></span>

<h3>Description</h3>

<p>Create a grid with occurrence densities along one or two gridded environmental gradients.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.grid.clim.dyn (glob, glob1, sp, R, th.sp, th.env, geomask, 
  kernel.method, extend.extent)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_glob">glob</code></td>
<td>
<p>A two-column dataframe (or a vector) of the environmental values (in column) for background pixels of the whole study area (in row).</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_glob1">glob1</code></td>
<td>
<p>A two-column dataframe (or a vector) of the environmental values (in column) for the background pixels of the species (in row).</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_sp">sp</code></td>
<td>
<p>A two-column dataframe (or a vector) of the environmental values (in column) for the occurrences of the species (in row).</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_r">R</code></td>
<td>
<p>The resolution of the grid.</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_th.sp">th.sp</code></td>
<td>
<p>The quantile used to delimit a threshold to exclude low species density values.</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_th.env">th.env</code></td>
<td>
<p>The quantile used to delimit a threshold to exclude low environmental density values of the study area.</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_geomask">geomask</code></td>
<td>
<p>A geographical mask to delimit the background extent if the analysis takes place in the geographical space.It can be a SpatialPolygon or a SpatRaster object. Note that the CRS should be the same as the one used for the points.</p>
</td></tr>
<tr><td><code id="ecospat.grid.clim.dyn_+3A_kernel.method">kernel.method</code></td>
<td>
<p>Method used to estimate the the kernel density. Currently, there are two methods: by default, it is the methode from 'adehabitat'. Method from the library 'ks' is also available.</p>
</td></tr> 
<tr><td><code id="ecospat.grid.clim.dyn_+3A_extend.extent">extend.extent</code></td>
<td>
<p>Vector with extention values of the window size (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the scores of an ordination (or SDM prediction), create a grid z of RxR pixels (or a vector of R pixels when using scores of dimension 1 or SDM predictions) with occurrence densities. Only scores of one, or two dimensions can be used.
<code>th.sp</code> is the quantile of the distribution of species density at occurrence sites. 
For example, if <code>th.sp</code> is set to 0.05, the species niche is drawn by including 95 percent of the species occurrences, removing the more marginal populations. 
Similarly, <code>th.env</code> is the quantile of the distribution of the environmental density at all sites of the study area. 
If <code>th.env</code> is set to 0.05, the delineation of the study area in the environmental space includes 95 percent  of the study area, removing the more marginal sites of the study area. 
By default, these thresholds are set to 0 but can be modified, depending on the importance of some marginal sites in the delineation of the species niche and/or the study area in the environmnental space. It is recommended to check if the shape of the delineated niche and study area corresponds to the shape of the plot of the PCA scores (or any other ordination techniques used to set the environmental space). 
Visualisation of the gridded environmental space can be done through the functions <code><a href="#topic+ecospat.plot.niche">ecospat.plot.niche</a></code> or <code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code>
If you encounter a problem during your analyses, please first read the FAQ section of &quot;Niche overlap&quot; in http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html
The argument <code>geomask</code> can be a SpatialPolygon or a SpatRaster object. 
Note that the CRS should be the same as the one used for the points.
</p>
<p>The parameter <code>extend.extent</code> allows modifying the extent of the grid. By default, the window covers from the minimum to the maximum value of the environmental values present in the study area. The vector <code>extend.extent</code> indicates how much you want to shift the x-minimal, x-maximal, y-minimal and y-maximal values respectively.
</p>


<h3>Value</h3>

<p>A grid z of RxR pixels (or a vector of R pixels) with z.uncor being the density of occurrence of the species, and z.cor the occupancy of the environment by the species (density of occurrences divided by the desinty of environment in the study area.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a> and Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>:481-497.
</p>
<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and A. Guisan. 2012. Climatic niche shifts are rare among terrestrial plant invaders. <em>Science</em>, <b>335</b>:1344-1348.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(ade4)
library(terra)

data(ecospat.testNiche)
data(ecospat.testData)

spp &lt;- ecospat.testNiche
clim &lt;- ecospat.testData[2:8]

occ.sp_test &lt;- na.exclude(ecospat.sample.envar(
  dfsp = spp, colspxy = 2:3, colspkept = 1:3, dfvar = clim,
  colvarxy = 1:2, colvar = "all", resolution = 25
))

occ.sp &lt;- cbind(occ.sp_test, spp[, 4]) # add species names

# list of species
sp.list &lt;- levels(occ.sp[, 1])
sp.nbocc &lt;- c()

for (i in 1:length(sp.list)) {
  sp.nbocc &lt;- c(sp.nbocc, length(which(occ.sp[, 1] == sp.list[i])))
}
# calculate the nb of occurences per species

sp.list &lt;- sp.list[sp.nbocc &gt; 4] # remove species with less than 5 occurences
nb.sp &lt;- length(sp.list) # nb of species
ls()
# selection of variables to include in the analyses
# try with all and then try only worldclim Variables
Xvar &lt;- c(3:7)
nvar &lt;- length(Xvar)

# number of interation for the tests of equivalency and similarity
iterations &lt;- 100
# resolution of the gridding of the climate space
R &lt;- 100
#################################### PCA-ENVIRONMENT ##################################
data &lt;- rbind(occ.sp[, Xvar + 1], clim[, Xvar])
w &lt;- c(rep(0, nrow(occ.sp)), rep(1, nrow(clim)))
library(ade4)
pca.cal &lt;- ade4::dudi.pca(data, row.w = w, center = TRUE, scale = TRUE, scannf = FALSE, nf = 2)

####### selection of species ######
sp.list
sp.combn &lt;- combn(1:2, 2)

for (i in 1:ncol(sp.combn)) {
  row.sp1 &lt;- which(occ.sp[, 1] == sp.list[sp.combn[1, i]]) # rows in data corresponding to sp1
  row.sp2 &lt;- which(occ.sp[, 1] == sp.list[sp.combn[2, i]]) # rows in data corresponding to sp2
  name.sp1 &lt;- sp.list[sp.combn[1, i]]
  name.sp2 &lt;- sp.list[sp.combn[2, i]]
  # predict the scores on the axes
  scores.clim &lt;- pca.cal$li[(nrow(occ.sp) + 1):nrow(data), ] # scores for global climate
  scores.sp1 &lt;- pca.cal$li[row.sp1, ] # scores for sp1
  scores.sp2 &lt;- pca.cal$li[row.sp2, ] # scores for sp2
}
# calculation of occurence density and test of niche equivalency and similarity
# with the default kernel method
z1 &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp1, R = 100)
z2 &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp2, R = 100)

# calculation of occurence density and test of niche equivalency and similarity
# with the ks kernel method
z1.kde &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp1, R = 100, kernel.method = "ks")
z2.kde &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp2, R = 100, kernel.method = "ks")

par(mfrow = c(2, 2))
plot(z1$z.uncor, main = "Sp1 with default kernel")
plot(z1.kde$z.uncor, main = "Sp1 with KS kernel")
plot(z2$z.uncor, main = "Sp2 with default kernel")
plot(z2.kde$z.uncor, main = "Sp2 with KS kernel")

z1.ext &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp1, R = 100,
  extend.extent = c(0,1,0,0)) 

par(mfrow = c(1, 2))
plot(z1$z.uncor, main = "Sp1 with default extent")
plot(z1.ext$z.uncor, main = "Sp1 with extended extent")
</code></pre>

<hr>
<h2 id='ecospat.mantel.correlogram'>Mantel Correlogram</h2><span id='topic+ecospat.mantel.correlogram'></span>

<h3>Description</h3>

<p>Investigate spatial autocorrelation of environmental covariables within a set of occurrences as a function of distance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.mantel.correlogram (dfvar, colxy, n, colvar, max, nclass, nperm)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.mantel.correlogram_+3A_dfvar">dfvar</code></td>
<td>
<p>A dataframe object with the environmental variables.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_colxy">colxy</code></td>
<td>
<p>The range of columns for x and y in df.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_n">n</code></td>
<td>
<p>The number of random occurrences used for the test.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_colvar">colvar</code></td>
<td>
<p>The range of columns for variables in df.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_max">max</code></td>
<td>
<p>The maximum distance to be computed in the correlogram.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_nclass">nclass</code></td>
<td>
<p>The number of classes of distances to be computed in the correlogram.</p>
</td></tr>
<tr><td><code id="ecospat.mantel.correlogram_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations in the randomization process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires ecodist library. Note that computation time increase tremendously when using more than 500 occurrences (n&gt;500)</p>


<h3>Value</h3>

<p>Draws a plot with distance vs. the mantel r  value. Black circles indicate that the values are significative different from zero. White circles indicate non significant autocorrelation. The selected distance is at the first white circle where values are non significative different from cero. 
</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Legendre, P. and M.J. Fortin. 1989. Spatial pattern and ecological analysis. <em>Vegetatio</em>, <b>80</b>, 107-138.</p>


<h3>See Also</h3>

<p><code><a href="ecodist.html#topic+mgram">mgram</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>ecospat.mantel.correlogram(dfvar=ecospat.testData[c(2:16)],colxy=1:2, n=100, colvar=3:7, 
max=1000, nclass=10, nperm=100)
</code></pre>

<hr>
<h2 id='ecospat.margin'>Delineation of the distribution's margin and its uncertainty</h2><span id='topic+ecospat.margin'></span>

<h3>Description</h3>

<p>Estimate the margin of the distribution in the bi-dimensional environmental space based on bootstrapped kernel density estimation the percentage of the distribution included within the margin.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.margin (z, th.quant, kern.method, bootstrap, bootstrap.rep, bootstrap.ncore)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.margin_+3A_z">z</code></td>
<td>
<p>object (list) resulting from the function <code>ecospat.grid.clim.dyn</code></p>
</td></tr>
<tr><td><code id="ecospat.margin_+3A_th.quant">th.quant</code></td>
<td>
<p>The quantile (between 0 and 1) used to delimit a threshold to exclude low species density values (see details)</p>
</td></tr>
<tr><td><code id="ecospat.margin_+3A_kern.method">kern.method</code></td>
<td>
<p>Method used to draw the kernel density estimation. it can be &quot;adehabitat&quot; (default) or &quot;ks&quot;</p>
</td></tr>
<tr><td><code id="ecospat.margin_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Boolean. If <code>TRUE</code>, a confidence interval based on bootstrap is estimated for the margin of the distribution</p>
</td></tr>
<tr><td><code id="ecospat.margin_+3A_bootstrap.rep">bootstrap.rep</code></td>
<td>
<p>Number of resamplings if the boostrap is selected.</p>
</td></tr>
<tr><td><code id="ecospat.margin_+3A_bootstrap.ncore">bootstrap.ncore</code></td>
<td>
<p>Number of cores to use for parallelization if the boostrap estimation is selected.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>th.quant</code> is the quantile of the distribution of species density at occurrence sites. 
For example, if <code>th.quant</code> is set to 0.05, the margin of the distribution is drawn by including 95 percent of the species occurrences, removing the more marginal populations. If <code>th.quant</code> is set to 0, the margin of the distribution is the minimal envelope including 100 percent of the species occurrences.
The bootstrap estimation of the margin allows representing the uncertainty around this margin. By default it returns a contour covering a 95 percents confidence interval (CI), but you can easily choose a custom CI.</p>


<h3>Value</h3>

<p> a list with $niche.envelope = a SpatRaster of the niche envelope including the distribution, $niche.contour = a SpatiaLine object of the margin, $niche.density = a SpatRaster of the niche density within the niche envelope.</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(ade4)
library(terra)

data(ecospat.testData)

sp1 &lt;- ecospat.testData[ecospat.testData$Bromus_erectus == 1, 1:8] # species occurences
clim &lt;- ecospat.testData[4:8] # environment of the study area

#################################### PCA-ENVIRONMENT ##################################
library(ade4)
pca.cal &lt;- ade4::dudi.pca(clim, center = TRUE, scale = TRUE, scannf = FALSE, nf = 2)

####### projection of the species distribution into the environmental space ######
# predict the scores on the axes
scores.clim &lt;- pca.cal$li # scores for global climate
scores.sp1 &lt;- ade4::suprow(pca.cal, sp1[, 4:8])$li # scores for sp1

z1 &lt;- ecospat.grid.clim.dyn(scores.clim, scores.clim, scores.sp1, R = 100, 
  extend.extent = c(0, 1, 0, 0))

####### estimate the margin ######
z1.margin &lt;- ecospat.margin(z1, th.quant = 0, bootstrap = FALSE) # including all occurrences
z1.95margin &lt;- ecospat.margin(z1, th.quant = 0.05, 
  bootstrap = FALSE) # including 95 percent of the occurrences
z1.bootstrap.margin &lt;- ecospat.margin(z1,th.quant = 0,
  bootstrap = TRUE, bootstrap.rep = 100) # bootstrap estimation of the niche limit

####### plot the margin and its uncertainty ######
plot(z1.margin$niche.density) # plot of the niche density
points(z1$sp) # with species occurences
lines(z1.margin$niche.contour) # limit of the margin if you include all the distribution
lines(z1.95margin$niche.contour, col = 2) # limit of the margin if you exclude the 
                                                  # 5 percents of the most marginal distribution
lines(z1.bootstrap.margin$niche.contour, col = 2, lty = "dotted") 
      # limit of the niche based on the 95 percent CI of the bootstrap

par(mfrow=c(1,2))
plot(z1.bootstrap.margin$niche.envelope, main = "Margin uncertainty", 
  legend.args=list(text="CI", cex = 0.8)) # shows uncertainty of niche margin in SpatRaster mode
points(z1$sp) # with species occurences
# shows the uncertainty of the niche limit in vector mode
boot&lt;-terra::as.contour(z1.bootstrap.margin$niche.envelope)
plot(boot, col = gray(10:1 / 10), main = "Margin uncertainty") 
# select a customized confidence interval (here for example 80 percent)
confInt80 &lt;- terra::as.polygons(z1.bootstrap.margin$niche.envelope &gt;= 50, dissolve = TRUE) 
lines(confInt80, lty = "dotted", col = 2)
</code></pre>

<hr>
<h2 id='ecospat.max.kappa'>
Maximum Kappa
</h2><span id='topic+ecospat.max.kappa'></span>

<h3>Description</h3>

<p>Calculates values for Cohen's Kappa along different thresholds, considering this time 0.01 increments (i.e. 99 thresholds).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.max.kappa(Pred, Sp.occ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.max.kappa_+3A_pred">Pred</code></td>
<td>

<p>A vector of predicted probabilities
</p>
</td></tr>
<tr><td><code id="ecospat.max.kappa_+3A_sp.occ">Sp.occ</code></td>
<td>

<p>A vector of binary observations of the species occurrence
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return values for Cohen's Kappa for 99 thresholds at 0.01 increments. 
</p>


<h3>Author(s)</h3>

<p>Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a> with contributions of Luigi Maiorano <a href="mailto:luigi.maiorano@gmail.com">luigi.maiorano@gmail.com</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>.
</p>


<h3>References</h3>

<p>Liu, C., P.M. Berry, T.P. Dawson, and R.G. Pearson. 2005. Selecting thresholds of occurrence in the prediction of species distributions. <em>Ecography</em>, <b>28</b>, 385-393.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.meva.table">ecospat.meva.table</a></code>, <code><a href="#topic+ecospat.max.tss">ecospat.max.tss</a></code>, <code><a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a></code>, <code><a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a></code>, <code><a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
   
Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris
kappa100 &lt;- ecospat.max.kappa(Pred, Sp.occ)
   

</code></pre>

<hr>
<h2 id='ecospat.max.tss'>
Maximum TSS
</h2><span id='topic+ecospat.max.tss'></span>

<h3>Description</h3>

<p>Calculates values for True skill statistic (TSS) along different thresholds, considering this time 0.01 increments (i.e. 99 thresholds).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.max.tss(Pred, Sp.occ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.max.tss_+3A_pred">Pred</code></td>
<td>

<p>A vector of predicted probabilities
</p>
</td></tr>
<tr><td><code id="ecospat.max.tss_+3A_sp.occ">Sp.occ</code></td>
<td>

<p>A vector of binary observations of the species occurrence
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return values for TSS for 99 thresholds at 0.01 increments. 
</p>


<h3>Author(s)</h3>

<p>Luigi Maiorano <a href="mailto:luigi.maiorano@gmail.com">luigi.maiorano@gmail.com</a> with contributions of Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a>
</p>


<h3>References</h3>

<p>Liu, C., P.M. Berry, T.P. Dawson, and R.G. Pearson. 2005. Selecting thresholds of occurrence in the prediction of species distributions. <em>Ecography</em>, <b>28</b>, 385-393.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.meva.table">ecospat.meva.table</a></code>, <code><a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a></code>, <code><a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a></code>, <code><a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a></code>, <code><a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ecospat.testData)
Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris
TSS100 &lt;- ecospat.max.tss(Pred, Sp.occ)
</code></pre>

<hr>
<h2 id='ecospat.maxentvarimport'>Maxent Variable Importance</h2><span id='topic+ecospat.maxentvarimport'></span>

<h3>Description</h3>

<p>Calculate the importance of variables for Maxent in the same way Biomod does, by randomly permuting each predictor variable independently, and computing the associated reduction in predictive performance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.maxentvarimport (model, dfvar, nperm)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.maxentvarimport_+3A_model">model</code></td>
<td>
<p>The name of the maxent model.</p>
</td></tr>
<tr><td><code id="ecospat.maxentvarimport_+3A_dfvar">dfvar</code></td>
<td>
<p>A dataframe object with the environmental variables.</p>
</td></tr>
<tr><td><code id="ecospat.maxentvarimport_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations in the randomization process. The default is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation is made as biomod2 &quot;variables_importance&quot; function. It's more or less base on the same principle than randomForest variables importance algorithm. The principle is to shuffle a single variable of the given data. Make model prediction with this 'shuffled' data.set. Then we compute a simple correlation (Pearson's by default) between references predictions and the 'shuffled' one. The return score is 1-cor(pred_ref,pred_shuffled). The highest the value, the more influence the variable has on the model. A value of this 0 assumes no influence of that variable on the model. Note that this technique does not account for interactions between the variables.</p>


<h3>Value</h3>

<p>a <code>list</code> which contains a <code>data.frame</code> containing variables importance scores for each permutation run. </p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dismo)
data('ecospat.testData')

# data for Soldanella alpina
data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")]

# path to maxent.jar file
path&lt;- paste0(system.file(package="dismo"), "/java/maxent.jar")

if (file.exists(path) &amp; require(rJava)) {
  me &lt;- maxent(data.Solalp[,-1],data.Solalp[,1])
  ecospat.maxentvarimport (model=me, dfvar=data.Solalp[,-1], nperm=5)
  }

</code></pre>

<hr>
<h2 id='ecospat.mdr'>
Minimum Dispersal Routes)
</h2><span id='topic+ecospat.mdr'></span>

<h3>Description</h3>

<p><code>ecospat.mdr</code> is a function that implement a minimum cost arborescence approach to analyse the invasion routes of a species from dates occurrence data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.mdr (data, xcol, ycol, datecol, mode, rep, mean.date.error, fixed.sources.rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.mdr_+3A_data">data</code></td>
<td>
<p>dataframe with occurence data. Each row correspond to an occurrence.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_xcol">xcol</code></td>
<td>
<p>The column in data containing x coordinates.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_ycol">ycol</code></td>
<td>
<p>The column in data containing y coordinates.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_datecol">datecol</code></td>
<td>
<p>The column in data containing dates.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_mode">mode</code></td>
<td>
<p>&quot;observed&quot;, &quot;min&quot; or &quot;random&quot;. &quot;observed&quot; calculate routes using real dates. &quot;min&quot; reorder dates so the the total length of the routes are minimal. &quot;random&quot; reatribute dates randomly.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_rep">rep</code></td>
<td>
<p>number of iteration of the analyse. if &gt; 1, boostrap support for each route is provided.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_mean.date.error">mean.date.error</code></td>
<td>
<p>mean number of years to substract to observed dates. It is the mean of the truncated negative exponential distribution from which the time to be substracted is randomly sampled.</p>
</td></tr>
<tr><td><code id="ecospat.mdr_+3A_fixed.sources.rows">fixed.sources.rows</code></td>
<td>
<p>the rows in data (as a vector) corresponding to source occurrence(s) that initiated the invasion(s). No incoming routes are not calculated for sources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function draws an incoming route to each occurence from the closest occurrence already occupied (with a previous date) and allows to substract a random number of time (years) to the observed dates from a truncated negative exponential distribution. It is possible to run several iterations and to get boostrap support for each route.
<code>itexp</code> and <code>rtexp</code> functions are small internal functions to set a truncated negative exponential distribution.
</p>


<h3>Value</h3>

<p>A list is returned by the function with in positon [[1]], a datafame with each row corresponding to a route (with new/old coordinates, new/old dates, length of the route, timespan, dispersal rate), in position [[2]] the total route length, in position [[3]] the median dispersal rate and in position [[4]] the number of outgoing nodes (index of clustering of the network)
</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Hordijk, W. and O. Broennimann. 2012. Dispersal routes reconstruction and the minimum cost arborescence problem. <em>Journal of theoretical biology</em>, <b>308</b>, 115-122.
</p>
<p>Broennimann, O., P. Mraz, B. Petitpierre, A. Guisan, and H. Muller-Scharer. 2014. Contrasting spatio-temporal climatic niche dynamics during the eastern and western invasions of spotted knapweed in North America.<em>Journal of biogeography</em>, <b>41</b>, 1126-1136.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("maps",quietly=TRUE)){

data(ecospat.testMdr)
data&lt;- ecospat.testMdr
intros&lt;-order(data$date)[1:2] # rows corresponding to first introductions

# plot observed situation

plot(data[,2:1],pch=15,cex=0.5)
points(data[intros,2:1],pch=19,col="red")
text(data[,2]+0.5,data[,1]+0.5,data[,3],cex=0.5)
map(add=TRUE)

# calculate minimum cost arborescence (MCA) of dispersal routes

obs&lt;-ecospat.mdr(data=data,xcol=2,ycol=1,datecol=3,mode="min",rep=100,
                  mean.date.error=1,fixed.sources.rows=intros)

# plot MCA results
# arrows' thickness indicate support for the routes

mca&lt;-obs[[1]]
plot(mca[,3:4],type="n",xlab="longitude",ylab="latitude")
arrows(mca[,1],mca[,2],mca[,3],mca[,4],length = 0.05,lwd=mca$bootstrap.value*2)
map(add=TRUE)

# plot intros

points(data[intros,2:1],pch=19,col="red")
text(data[intros,2]+0.5,data[intros,1]+0.5,data[intros,3],cex=1,col="red")

# dispersal routes statistics

obs[[2]] # total routes length in DD
obs[[3]] # median dispersal rate in DD/yr
obs[[4]] # number of outcoming nodes
}
</code></pre>

<hr>
<h2 id='ecospat.mess'>MESS</h2><span id='topic+ecospat.mess'></span>

<h3>Description</h3>

<p>Calculate the MESS (i.e. extrapolation) as in Maxent.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.mess (proj, cal, w="default")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.mess_+3A_proj">proj</code></td>
<td>
<p>A dataframe object with x, y and environmental variables, used as projection dataset.</p>
</td></tr>
<tr><td><code id="ecospat.mess_+3A_cal">cal</code></td>
<td>
<p>A dataframe object with x, y and environmental variables, used as calibration dataset.</p>
</td></tr>
<tr><td><code id="ecospat.mess_+3A_w">w</code></td>
<td>
<p>The weight for each predictor (e.g. variables importance in SDM).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shows the variable that drives the multivariate environmental similarity surface (MESS) value in each grid cell.</p>


<h3>Value</h3>

<table>
<tr><td><code>MESS</code></td>
<td>
<p>The mess as calculated in Maxent, i.e. the minimal extrapolation values.</p>
</td></tr>
<tr><td><code>MESSw</code></td>
<td>
<p>The sum of negative MESS values corrected by the total number of predictors. If there are no negative values, MESSw is the mean MESS.</p>
</td></tr>
<tr><td><code>MESSneg</code></td>
<td>
<p>The number of predictors on which there is extrapolation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a>. Modified by Daniel Scherrer <a href="mailto:daniel.j.a.scherrer@gmail.com">daniel.j.a.scherrer@gmail.com</a></p>


<h3>References</h3>

<p>Elith, J., M. Kearney and S. Phillips. 2010. The art of modelling range-shifting species. <em>Methods in ecology and evolution</em>, <b>1</b>, 330-342.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.mess">ecospat.plot.mess</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ecospat.testData[c(2,3,4:8)]
proj &lt;- x[1:90,] #A projection dataset.
cal &lt;- x[91:300,] #A calibration dataset

#Create a MESS object 
mess.object &lt;- ecospat.mess (proj, cal, w="default")

#Plot MESS 
ecospat.plot.mess (mess.object, cex=1, pch=15)
</code></pre>

<hr>
<h2 id='ecospat.meva.table'>
Model Evaluation For A Given Threshold Value
</h2><span id='topic+ecospat.meva.table'></span>

<h3>Description</h3>

<p>Calculates values of a series of different evaluations metrics for a model and for a given threshold value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.meva.table(Pred, Sp.occ, th)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.meva.table_+3A_pred">Pred</code></td>
<td>

<p>A vector of predicted probabilities
</p>
</td></tr>
<tr><td><code id="ecospat.meva.table_+3A_sp.occ">Sp.occ</code></td>
<td>

<p>A vector of binary observations of the species occurrence
</p>
</td></tr>
<tr><td><code id="ecospat.meva.table_+3A_th">th</code></td>
<td>

<p>Threshold used to cut the probability to binary values
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A contingency table of observations and predicted probabilities of presence values, and a list of evaluation metrics for the selected threshold.
</p>


<h3>Author(s)</h3>

<p>Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a> with contributions of Luigi Maiorano <a href="mailto:luigi.maiorano@gmail.com">luigi.maiorano@gmail.com</a>
</p>


<h3>References</h3>

<p>Pearce, J. and S. Ferrier. 2000. Evaluating the predictive performance of habitat models developed using logistic regression. <em>Ecol. Model.</em>, <b>133</b>, 225-245.
Wunderlich, R.F. et al. 2019. Two alternative evaluation metrics to replace the true skill statistic in the assessment of species distribution models. <em>Nature Conservation</em>, <b>35</b>, 97-116. <a href="https://doi.org/10.3897/natureconservation.35.33918">doi:10.3897/natureconservation.35.33918</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a></code>, <code><a href="#topic+ecospat.max.tss">ecospat.max.tss</a></code>, <code><a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a></code>, <code><a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a></code>, <code><a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris

meva &lt;- ecospat.meva.table (Pred, Sp.occ, 0.39)
</code></pre>

<hr>
<h2 id='ecospat.mpa'>Minimal Predicted Area</h2><span id='topic+ecospat.mpa'></span>

<h3>Description</h3>

<p>Calculate the minimal predicted area.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.mpa (Pred, Sp.occ.xy, perc)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.mpa_+3A_pred">Pred</code></td>
<td>
<p>Numeric or, SpatRaster predicted suitabilities from a SDM prediction.</p>
</td></tr>
<tr><td><code id="ecospat.mpa_+3A_sp.occ.xy">Sp.occ.xy</code></td>
<td>
<p>xy-coordinates of the species (if Pred is a RasterLayer or a SpatRaster).</p>
</td></tr>
<tr><td><code id="ecospat.mpa_+3A_perc">perc</code></td>
<td>
<p>Percentage of Sp.occ.xy that should be encompassed by the binary map.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The minimal predicted area (MPA) is the minimal surface obtained by considering all pixels with predictions above a defined probability threshold (e.g. 0.7) that still encompasses 90 percent of the species' occurrences (Engler et al. 2004).</p>


<h3>Value</h3>

<p>Returns the minimal predicted area.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> with the contribution of Flavien Collart</p>


<h3>References</h3>

<p>Engler, R., A. Guisan and L. Rechsteiner. 2004. An improved approach for predicting the distribution of rare and endangered species from occurrence and pseudo-absence data. <em>Journal of Applied Ecology</em>, <b>41</b>, 263-274.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testData)
obs &lt;- (ecospat.testData$glm_Saxifraga_oppositifolia
[which(ecospat.testData$Saxifraga_oppositifolia==1)])

ecospat.mpa(obs)
ecospat.mpa(obs,perc=1) ## 100 percent of the presences encompassed
</code></pre>

<hr>
<h2 id='ecospat.niche.dyn.index'>Niche Expansion, Stability, and Unfilling</h2><span id='topic+ecospat.niche.dyn.index'></span>

<h3>Description</h3>

<p>Calculate niche expansion, stability and unfilling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.dyn.index (z1, z2, intersection=NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.dyn.index_+3A_z1">z1</code></td>
<td>
<p>A gridclim object for the native distribution.</p>
</td></tr>
<tr><td><code id="ecospat.niche.dyn.index_+3A_z2">z2</code></td>
<td>
<p>A gridclim object for the invaded range.</p>
</td></tr>
<tr><td><code id="ecospat.niche.dyn.index_+3A_intersection">intersection</code></td>
<td>

<p>The quantile of the environmental density used to remove marginal climates. 
If <code>intersection=NA</code>, the analysis is performed on the whole environmental extent (native and invaded). 
If <code>intersection=0</code>, the analysis is performed at the intersection between native and invaded range. 
If <code>intersection=0.05</code>, the analysis is performed at the intersection of the 5th quantile of both native and invaded environmental densities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you encounter a problem during your analyses, please first read the FAQ section of &quot;Niche overlap&quot; in http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html</p>


<h3>Value</h3>

<p>A list of dynamic indices: dynamic.index.w [expansion.index.w, stability.index.w, restriction.index.w]</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a></code></p>

<hr>
<h2 id='ecospat.niche.dynIndexProjGeo'>Projection of niche dynamic indices to the Geography</h2><span id='topic+ecospat.niche.dynIndexProjGeo'></span>

<h3>Description</h3>

<p>Creates a SpatRaster in geography with each pixel containing a
niche dynamic index (stability, expansion, or unfilling) extracted
from 2 niches generated with <code>ecospat.grid.clim.dyn</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.dynIndexProjGeo(z1, z2, proj, env)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.dynIndexProjGeo_+3A_z1">z1</code></td>
<td>
<p>Species 1 occurrence density grid created
by <code>ecospat.grid.clim.dyn</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.dynIndexProjGeo_+3A_z2">z2</code></td>
<td>
<p>Species 2 occurrence density grid created
by <code>ecospat.grid.clim.dyn</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.dynIndexProjGeo_+3A_proj">proj</code></td>
<td>
<p>type of projection (0,1 or 2)</p>
</td></tr>
<tr><td><code id="ecospat.niche.dynIndexProjGeo_+3A_env">env</code></td>
<td>
<p>A SpatRaster of environmental variables
corresponding to the background (<code>glob</code>
in <code>ecospat.grid.clim.dyn</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the niche dynamic index of objects created
by <code>ecospat.niche.dyn.index</code> for each background point
(<code>glob</code>) using <code>extract</code> from the terra package. The values
are projected to the geographic coordinates of <code>env</code> and returned
as a SpatRaster layer. If proj=0, the common background for z1 and z2 (<code>glob</code>)
is used. If proj=1, the background (<code>glob1</code>) of z1 is used. If proj=2, 
the background (<code>glob1</code>) of z2 is used.
</p>


<h3>Value</h3>

<p>a SpatRaster with cell values 0-3. 1: unfilling
(habitat occupied by species 1); 2: expansion (habitat occupied only
by species 2); 3: stability (habitat occupied by both species); and 0
(unoccupied habitat).</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>, Tyler
Smith <a href="mailto:tyler@plantarum.ca">tyler@plantarum.ca</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B.
Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C.
Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring
ecological niche overlap from occurrence and spatial environmental
data. <em>Global Ecology and Biogeography</em>, <b>21</b>:481-497.
</p>
<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and
A. Guisan. 2012. Climatic niche shifts are rare among terrestrial
plant invaders. <em>Science</em>, <b>335</b>:1344-1348.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code>,
<code><a href="#topic+ecospat.niche.dyn.index">ecospat.niche.dyn.index</a></code>,
<code><a href="#topic+ecospat.niche.zProjGeo">ecospat.niche.zProjGeo</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(ade4)
library(terra)

data(ecospat.testNiche)
spp &lt;- ecospat.testNiche
xy.sp1 &lt;- subset(spp, species=="sp1")[2:3] #Bromus_erectus
xy.sp2 &lt;- subset(spp, species=="sp4")[2:3] #Pritzelago_alpina

env&lt;-terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))

env.sp1 &lt;- terra::extract(env, xy.sp1)[,-1]
env.sp2 &lt;- terra::extract(env, xy.sp2)[,-1]
env.bkg &lt;- na.exclude(terra::values(env))

#####################
## PCA-ENVIRONMENT ##
#####################

library(ade4)
pca.cal &lt;- ade4::dudi.pca(env.bkg, center = TRUE, scale = TRUE,
                    scannf = FALSE, nf = 2)

# predict the scores on the axes
scores.bkg &lt;- pca.cal$li  #scores for background climate
scores.sp1 &lt;- ade4::suprow(pca.cal,env.sp1)$lisup  #scores for sp1
scores.sp2 &lt;- ade4::suprow(pca.cal,env.sp2)$lisup  #scores for sp2

# calculation of occurence density (niche z)
  
z1 &lt;- ecospat.grid.clim.dyn(scores.bkg, scores.bkg,
                            scores.sp1, R = 100)
z2 &lt;- ecospat.grid.clim.dyn(scores.bkg, scores.bkg,
                            scores.sp2, R = 100)

plot(z1$z.uncor)
points(scores.sp1, pch = 21, bg = "green")

plot(z2$z.uncor)
points(scores.sp2, pch = 21, bg = "red")

ecospat.plot.niche.dyn(z1, z2)
points(scores.sp1, pch = 21, bg = "green")
points(scores.sp2, pch = 21, bg = "red")
ecospat.niche.overlap(z1,z2 ,cor = TRUE)

##############################
## dynamic indices in space ##
##############################

geozS &lt;- ecospat.niche.dynIndexProjGeo(z1, z2, proj=0, env)

plot(geozS, col = c("grey", "green", "red", "blue"),
     legend = FALSE)
points(xy.sp1, bg = "green", pch = 21)
points(xy.sp2, bg = "red", pch = 21)
</code></pre>

<hr>
<h2 id='ecospat.niche.equivalency.test'>Niche Equivalency Test</h2><span id='topic+ecospat.niche.equivalency.test'></span>

<h3>Description</h3>

<p>Run a niche equivalency test (see Warren et al 2008) based on two species occurrence density grids.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.equivalency.test (z1, z2, rep, intersection = NA, 
overlap.alternative = "higher", expansion.alternative = "lower", 
stability.alternative = "higher", unfilling.alternative = "lower", ncores = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_z1">z1</code></td>
<td>
<p>Species 1 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_z2">z2</code></td>
<td>
<p>Species 2 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_rep">rep</code></td>
<td>
<p>The number of replications to perform.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_intersection">intersection</code></td>
<td>
<p>The quantile of the environmental density used to remove marginal climates. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_overlap.alternative">overlap.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_expansion.alternative">expansion.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_stability.alternative">stability.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_unfilling.alternative">unfilling.alternative</code></td>
<td>
<p>To indicate the alternative hypothesis of the test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.equivalency.test_+3A_ncores">ncores</code></td>
<td>
<p>The number of cores used for parallelisation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compares the observed niche overlap, expansion, stability and unfilling between z1 and z2 to simulated values between random niches z1.sim and z2.sim, which are built from random reallocations of occurences of z1 and z2.
</p>
<p><code>intersection</code> allows setting if the niche dynamic indices (expansion, stability and unfilling) are measured across the full extent pooling the two study areas or not. If <code>intersection = NA</code>, the analysis is performed on the whole environmental extent (native and invaded). If <code>instersection = 0</code>, the analysis is performed at the intersection between native and invaded range. If <code>instersection = 0.05</code>, the analysis is performed at the intersection of the 5th quantile of both native and invaded environmental densities. Etc...
</p>
<p><code>overlap.alternative</code> specifies if you want to test for niche conservatism (<code>overlap.alternative = "higher"</code>, i.e. the niche overlap is more equivalent/similar than random) or for niche divergence (<code>overlap.alternative = "lower"</code>, i.e. the niche overlap is less equivalent/similar than random). You can also specifiy if you want to test if you have more, less or different observed niche dynamics than random niches(with <code>expansion.alternative</code>, <code>stability.alternative</code> and <code>unfilling.alternative</code>). If you want to test for niche conservatism, we recommande to set these niche dynamic hypotheses to <code>"lower"</code>, <code>"higher"</code> and <code>"lower"</code> respectively for expansion, stability and unfilling.
</p>
<p>If you encounter a problem during your analyses, please first read the FAQ section of &quot;Niche overlap&quot; in <a href="http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html">http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html</a>
</p>
<p>The arguments <code>ncores</code> allows choosing the number of cores used to parallelize the computation.  The default value is 1. On multicore computers, the optimal would be <code>ncores = detectCores() - 1</code>.
</p>


<h3>Value</h3>

<p>a list with $obs = observed overlap and dynamic indices, $sim = simulated overlap and dynamic indices, $p.D = p-value of the test on D, $p.I = p-value of the test on I, $p.expansion = p-value for the test on expansion, $p.stability = p-value for the test on stability, $p.unfilling = p-value for the test on unfilling.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a> with contributions of Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman,B.  Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.
</p>
<p>Warren, D.L., R.E. Glor and M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>, <b>62</b>, 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a></code>, <code><a href="#topic+ecospat.niche.similarity.test">ecospat.niche.similarity.test</a></code></p>

<hr>
<h2 id='ecospat.niche.overlap'>Calculate Niche Overlap</h2><span id='topic+ecospat.niche.overlap'></span>

<h3>Description</h3>

<p>Calculate the overlap metrics D and I based on two species occurrence density grids z1 and z2 created by <code>ecospat.grid.clim</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.overlap (z1, z2, cor)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.overlap_+3A_z1">z1</code></td>
<td>
<p>Species 1 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.overlap_+3A_z2">z2</code></td>
<td>
<p>Species 2 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.overlap_+3A_cor">cor</code></td>
<td>
<p>Correct the occurrence densities of each species by the prevalence of the environments in their range (TRUE = yes, FALSE = no).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if cor=FALSE, the z$uncor objects created by <code>ecospat.grid.clim</code> are used to calculate the overlap. if cor=TRUE, the z$cor objects are used.
</p>
<p>If you encounter a problem during your analyses, please first read the FAQ section of &quot;Niche overlap&quot; in http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html
</p>


<h3>Value</h3>

<p>Overlap values D and I. D is Schoener's overlap metric (Schoener 1970). I is a modified Hellinger metric(Warren et al. 2008)</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.
</p>
<p>Schoener, T.W. 1968. Anolis lizards of Bimini: resource partitioning in a complex fauna. <em>Ecology</em>, <b>49</b>, 704-726.
</p>
<p>Warren, D.L., R.E. Glor and M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>, <b>62</b>, 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a></code></p>

<hr>
<h2 id='ecospat.niche.similarity.test'>Niche Similarity Test</h2><span id='topic+ecospat.niche.similarity.test'></span>

<h3>Description</h3>

<p>Run a niche similarity test (see Warren et al 2008) based on two species occurrence density grids.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.similarity.test (z1, z2, rep, intersection = NA, 
  rand.type = 1, ncores= 1, overlap.alternative = "higher", 
  expansion.alternative = "lower", stability.alternative = "higher", 
  unfilling.alternative = "lower")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.similarity.test_+3A_z1">z1</code></td>
<td>
<p>Species 1 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_z2">z2</code></td>
<td>
<p>Species 2 occurrence density grid created by <code>ecospat.grid.clim</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_rep">rep</code></td>
<td>
<p>Number of replications to perform.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_intersection">intersection</code></td>
<td>
<p>Quantile of the environmental density used to remove marginal climates. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_rand.type">rand.type</code></td>
<td>
<p>Type of randomization on the density grids (1 or 2).</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used for parallelisation.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_overlap.alternative">overlap.alternative</code></td>
<td>
<p>Alternative hypothesis of the test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_expansion.alternative">expansion.alternative</code></td>
<td>
<p>Alternative hypothesis of the expansion test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_stability.alternative">stability.alternative</code></td>
<td>
<p>Alternative hypothesis of the stability test. See Details.</p>
</td></tr>
<tr><td><code id="ecospat.niche.similarity.test_+3A_unfilling.alternative">unfilling.alternative</code></td>
<td>
<p>Alternative hypothesis of the unfilling test. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compares the observed niche overlap between z1 and z2 to overlaps between z1 and random niches (z2.sim) as available in the range of z2 (z2$Z). z2.sim has the same pattern as z2 but the center is randomly translatated in the availabe z2$Z space and weighted by z2$Z densities.
</p>
<p><code>intersection</code> allows setting if the niche dynamic indices (expansion, stability and unfilling) are measured across the full extent pooling the two study areas or not. If <code>intersection = NA</code>, the analysis is performed on the whole environmental extent (native and invaded). If <code>instersection = 0</code>, the analysis is performed at the intersection between native and invaded range. If <code>instersection = 0.05</code>, the analysis is performed at the intersection of the 5th quantile of both native and invaded environmental densities. Etc...
</p>
<p>If <code>rand.type = 1</code>, both z1 and z2 are randomly shifted, if <code>rand.type = 2</code>, only z2 is randomly shifted.
</p>
<p><code>overlap.alternative</code> specifies if you want to test for niche conservatism (<code>overlap.alternative = "higher"</code>, i.e. the niche overlap is more equivalent/similar than random) or for niche divergence (<code>overlap.alternative = "lower"</code>, i.e. the niche overlap is less equivalent/similar than random). You can also specifiy if you want to test if you have more, less or different observed niche dynamics than random niches(with <code>expansion.alternative</code>, <code>stabilty.alternative</code> and <code>unfilling.alternative</code>). If you want to test for niche conservatism, we recommande to set these niche dynamic hypotheses to <code>"lower"</code>, <code>"higher"</code> and <code>"lower"</code> respectively for expansion, stability and unfilling.
</p>
<p>If you encounter a problem during your analyses, please first read the FAQ section of &quot;Niche overlap&quot; in http://www.unil.ch/ecospat/home/menuguid/ecospat-resources/tools.html
</p>
<p>The arguments <code>ncores</code> allows choosing the number of cores used to parallelize the computation. The default value is 1. On multicore computers, the optimal would be <code>ncores = detectCores() - 1</code>. 
</p>


<h3>Value</h3>

<p>a list with $obs = observed overlap and dynamic indices, $sim = simulated overlap and dynamic indices, $p.D = p-value of the test on D, $p.I = p-value of the test on I, $p.expansion = p-value for the test on expansion, $p.stability = p-value for the test on stability, $p.unfilling = p-value for the test on unfilling.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a> with contributions of Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.
</p>
<p>Warren, D.L., R.E. Glor and M. Turelli. 2008. Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. <em>Evolution</em>, <b>62</b>, 2868-2883.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a></code>, <code><a href="#topic+ecospat.niche.equivalency.test">ecospat.niche.equivalency.test</a></code></p>

<hr>
<h2 id='ecospat.niche.zProjGeo'>Projection of Occurrence Densities to the Geography</h2><span id='topic+ecospat.niche.zProjGeo'></span>

<h3>Description</h3>

<p>Creates a raster in geography with each pixel containing the occurrence densities extracted from a z object generated with <code>ecospat.grid.clim.dyn</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.niche.zProjGeo(z,zproj,env,cor)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.niche.zProjGeo_+3A_z">z</code></td>
<td>
<p>occurrence density grid created by <code>ecospat.grid.clim.dyn</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.zProjGeo_+3A_zproj">zproj</code></td>
<td>
<p>NULL or occurrence density grid created by <code>ecospat.grid.clim.dyn</code>.</p>
</td></tr>
<tr><td><code id="ecospat.niche.zProjGeo_+3A_env">env</code></td>
<td>
<p>A SpatRaster of environmental variables corresponding to the background (<code>glob1</code> in <code>ecospat.grid.clim.dyn</code>).</p>
</td></tr>
<tr><td><code id="ecospat.niche.zProjGeo_+3A_cor">cor</code></td>
<td>
<p>FALSE by default. If TRUE corrects the occurrence densities of each species by the prevalence of the environments in their range</p>
</td></tr>
</table>


<h3>Details</h3>

<p>extracts the occurrence density of z and project them in geography. If zproj=NULL, the occurrence density of z is extracted for each point of the background of z (<code>glob1</code>) using <code>extract</code> (package terra). The values are binded to the geographic coordinates of <code>env</code> and a raster is then recreated using <code>rast</code> with the argument type=&quot;xyz&quot;.If zproj is a occurrence density object, the background <code>glob1</code> of this object is chosen and the projection is made on this background.<code>env</code> must then must be the same as used to create zproj.  
</p>


<h3>Value</h3>

<p>raster of class RasterLayer</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>:481-497.
</p>
<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and A. Guisan. 2012. Climatic niche shifts are rare among terrestrial plant invaders. <em>Science</em>, <b>335</b>:1344-1348.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code>, <code><a href="#topic+ecospat.niche.dynIndexProjGeo">ecospat.niche.dynIndexProjGeo</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(ade4)
library(terra)

data("ecospat.testNiche")
spp &lt;- ecospat.testNiche
xy.sp1&lt;-subset(spp,species=="sp1")[2:3] #Bromus_erectus

env&lt;-terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))
#plot(env)

env.sp1&lt;-terra::extract(env,xy.sp1)[,-1]
env.bkg&lt;-na.exclude(terra::values(env))

#################################### PCA-ENVIRONMENT ##################################

pca.cal &lt;- ade4::dudi.pca(env.bkg, center = TRUE, scale = TRUE, scannf = FALSE, nf = 2)

# predict the scores on the axes
scores.bkg &lt;- pca.cal$li  #scores for background climate
scores.sp1 &lt;- ade4::suprow(pca.cal,env.sp1)$lisup				#scores for sp1

# calculation of occurence density (niche z)
  
z1 &lt;- ecospat.grid.clim.dyn(scores.bkg, scores.bkg, scores.sp1,R=100)

plot(z1$z.uncor)
points(scores.sp1)

#################################### occurrence density in space ##################################

# sp1
geoz1&lt;-ecospat.niche.zProjGeo(z1,zproj=NULL,env=env)
plot(geoz1,main="z1")
points(xy.sp1)
</code></pre>

<hr>
<h2 id='ecospat.nicheNBmean'>
Niche position and niche breadth)
</h2><span id='topic+ecospat.nicheNBmean'></span>

<h3>Description</h3>

<p>ecospat.nicheNBmean calculates the weighted mean niche breadth accross several axes from a nichePOSNB object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.nicheNBmean(POSNB,w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.nicheNBmean_+3A_posnb">POSNB</code></td>
<td>
<p>an object created by the function ecospat.nichePOSNB</p>
</td></tr>
<tr><td><code id="ecospat.nicheNBmean_+3A_w">w</code></td>
<td>
<p>a vector with a weight for each environmental axes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the weighted mean niche breadth. The weights w are rescaled so that their sum equals 1.
</p>


<h3>Value</h3>

<p>The function returns a 1 column dataframe with the weighted mean niche breadth for each taxa.
</p>


<h3>Author(s)</h3>

<p>Lucie Malard <a href="mailto:lucie.malard@unil.ch">lucie.malard@unil.ch</a> and Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>L.A. Malard, H.K. Mod, N. Guex, O. Broennimann, E. Yashiro, E. Lara, E.D.A. Mitchell, H. Niculita-Hirzel &amp; A. Guisan. The ecological niche of soil bacterial, archaeal, fungal and protist communities along environmental gradients in the Alps. 2021. Accepted in Soil Biology and Biochemistry.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ecospat.testNichePOSNB)
df&lt;-ecospat.testNichePOSNB

# 1 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2),colfreq = 6:17) 

# 2 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2:3),colfreq = 6:17) 
ecospat.nicheNBmean(POSNB,w=c(2,1))

# 4 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2:5),colfreq = 6:17) 
ecospat.nicheNBmean(POSNB,w=c(1,0.8,0.2,0.1))

</code></pre>

<hr>
<h2 id='ecospat.nichePOSNB'>
Niche position and niche breadth)
</h2><span id='topic+ecospat.nichePOSNB'></span>

<h3>Description</h3>

<p>ecospat.nichePOSNB calculates the niche breadth and niche position of taxa along environmental gradients from abundance data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.nichePOSNB (df,colvar,colfreq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.nichePOSNB_+3A_df">df</code></td>
<td>
<p>dataframe with (relative) abundance data. Each row correspond to an abundance.</p>
</td></tr>
<tr><td><code id="ecospat.nichePOSNB_+3A_colvar">colvar</code></td>
<td>
<p>The column(s) in df corresponding to environmental axe(s).</p>
</td></tr>
<tr><td><code id="ecospat.nichePOSNB_+3A_colfreq">colfreq</code></td>
<td>
<p>The columns in df corresponding to taxa frequencies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates niche position and niche breadth of taxa along one or multiple environmental axes. Niche position is calculated as the mean of the variable, weighted by the relative abundance of the species. Niche breadth is calculated as the standard deviation of each variable, weighted by the relative abundance of the species at each sampling site.
</p>


<h3>Value</h3>

<p>The function returns a matrix containing the average niche position and niche breadth of each taxa along each environmental axi.
</p>


<h3>Author(s)</h3>

<p>Lucie Malard <a href="mailto:lucie.malard@unil.ch">lucie.malard@unil.ch</a> and Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>L.A. Malard, H.K. Mod, N. Guex, O. Broennimann, E. Yashiro, E. Lara, E.D.A. Mitchell, H. Niculita-Hirzel &amp; A. Guisan. The ecological niche of soil bacterial, archaeal, fungal and protist communities along environmental gradients in the Alps. 2021. Accepted in Soil Biology and Biochemistry.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ecospat.testNichePOSNB)
df&lt;-ecospat.testNichePOSNB

# 1 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2),colfreq = 6:17) 

# 2 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2:3),colfreq = 6:17) 
ecospat.nicheNBmean(POSNB,w=c(2,1))

# 4 axes
POSNB&lt;-ecospat.nichePOSNB(df,colvar=c(2:5),colfreq = 6:17) 
ecospat.nicheNBmean(POSNB,w=c(1,0.8,0.2,0.1))

</code></pre>

<hr>
<h2 id='ecospat.npred'>Number Of Predictors</h2><span id='topic+ecospat.npred'></span>

<h3>Description</h3>

<p>Calculate the maximum number of predictors to include in the model with a desired correlation between predictors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.npred (x, th)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.npred_+3A_x">x</code></td>
<td>
<p>Correlation matrix of the predictors.</p>
</td></tr>
<tr><td><code id="ecospat.npred_+3A_th">th</code></td>
<td>
<p>Desired threshold of correlation between predictors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the number of predictors to use.</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>colvar &lt;- ecospat.testData[c(4:8)]
x &lt;- cor(colvar, method="pearson")
ecospat.npred (x, th=0.75)
</code></pre>

<hr>
<h2 id='ecospat.occ.desaggregation'>Species Occurrences Desaggregation</h2><span id='topic+ecospat.occ.desaggregation'></span>

<h3>Description</h3>

<p>Remove species occurrences in a dataframe which are closer to each other than a specified distance threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.occ.desaggregation (xy, min.dist, by)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.occ.desaggregation_+3A_xy">xy</code></td>
<td>
<p>A dataframe with xy-coordinates (x-column must be named 'x' and y-column 'y')</p>
</td></tr>
<tr><td><code id="ecospat.occ.desaggregation_+3A_min.dist">min.dist</code></td>
<td>
<p>The minimun distance between points in the sub-dataframe.</p>
</td></tr>
<tr><td><code id="ecospat.occ.desaggregation_+3A_by">by</code></td>
<td>
<p>Grouping element in the dataframe (e.g. species, NULL)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will desaggregate the original number of occurrences, according to a specified distance.</p>


<h3>Value</h3>

<p>A subset of the initial dataframe. The number of points is printed as &quot;initial&quot;, &quot;kept&quot; and &quot;out&quot;.</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@unil.ch">frank.breiner@unil.ch</a> 
</p>
<p>with contributions of Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>

spp &lt;- ecospat.testNiche
colnames(spp)[2:3] &lt;- c('x','y')
sp1 &lt;- spp[1:32,2:3]

occ.sp1 &lt;- ecospat.occ.desaggregation(xy=sp1, min.dist=500, by=NULL)
occ.all.sp &lt;- ecospat.occ.desaggregation(xy=spp, min.dist=500, by='Spp')

</code></pre>

<hr>
<h2 id='ecospat.occupied.patch'>
Extract occupied patches of a species in geographic space.)
</h2><span id='topic+ecospat.occupied.patch'></span>

<h3>Description</h3>

<p>This function determines the occupied patch of a species using standard IUCN criteria (AOO, EOO) or predictive binary maps from Species Distribution Models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.occupied.patch (bin.map, Sp.occ.xy, buffer = 0)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="ecospat.occupied.patch_+3A_bin.map">bin.map</code></td>
<td>
<p>Binary map (a SpatRaster) from a Species Distribution Model.</p>
</td></tr>
<tr><td><code id="ecospat.occupied.patch_+3A_sp.occ.xy">Sp.occ.xy</code></td>
<td>
<p>xy-coordinates of the species presence.</p>
</td></tr>
<tr><td><code id="ecospat.occupied.patch_+3A_buffer">buffer</code></td>
<td>
<p>numeric. Calculate occupied patch models from the binary map using a buffer (predicted area occupied by the species or within a buffer around the species, for details see ?extract).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictive maps derived from SDMs inform about the potential distribution (or habitat suitability) of a species. Often it is useful to get information about the area of the potential distribution which is occupied by a species, e.g. for Red List assessments.
</p>


<h3>Value</h3>

<p>a SpatRaster with value 1.
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> with the contribution of Flavien Collart
</p>


<h3>References</h3>

<p>IUCN Standards and Petitions Subcommittee. 2016. Guidelines for Using the IUCN Red List Categories and Criteria. Version 12. Prepared by the Standards and Petitions Subcommittee. Downloadable from http://www.iucnredlist.org/documents/RedListGuidelines.pdf
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.rangesize">ecospat.rangesize</a></code>, <code><a href="#topic+ecospat.mpa">ecospat.mpa</a></code>, <code><a href="#topic+ecospat.binary.model">ecospat.binary.model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(terra)
library(dismo)

# coordinates of the plots
xy &lt;- ecospat.testData[,2:3]

# environmental data
predictors &lt;- terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))
env &lt;- terra::extract(predictors,xy,ID=FALSE)  
spData &lt;- cbind.data.frame(occ=ecospat.testData$Veronica_alpina,env)
mod &lt;- glm(occ~ddeg0+I(ddeg0^2)+srad68+I(srad68^2),data=spData,family = binomial())

# predict to entire dataset
pred &lt;- terra::predict(predictors,mod,type="response") 
plot(pred)
points(xy[spData$occ==1,])
  
### make binary maps
#arbitratry threshold
pred.bin.arbitrary &lt;- ecospat.binary.model(pred,0.3)
names(pred.bin.arbitrary) &lt;- "me.arbitrary"
# use MPA to convert suitability to binary map
mpa.cutoff &lt;- ecospat.mpa(pred,xy[spData$occ==1,])
pred.bin.mpa &lt;- ecospat.binary.model(pred,mpa.cutoff)
names(pred.bin.mpa) &lt;- "me.mpa"

mpa.ocp  &lt;- ecospat.occupied.patch(pred.bin.mpa,xy[spData$occ==1,])
arbitrary.ocp  &lt;- ecospat.occupied.patch(pred.bin.arbitrary,xy[spData$occ==1,])
par(mfrow=c(1,2))
plot(mpa.ocp) ## occupied patches: green area
points(xy[spData$occ==1,],col="red",cex=0.5,pch=19)
plot(arbitrary.ocp)
points(xy[spData$occ==1,],col="red",cex=0.5,pch=19)


## with buffer:
mpa.ocp  &lt;- ecospat.occupied.patch(pred.bin.mpa,xy[spData$occ==1,], buffer=5000)
arbitrary.ocp  &lt;- ecospat.occupied.patch(pred.bin.arbitrary,xy[spData$occ==1,], buffer=5000)

plot(mpa.ocp) ## occupied patches: green area
points(xy[spData$occ==1,],col="red",cex=0.5,pch=19)
plot(arbitrary.ocp)
points(xy[spData$occ==1,],col="red",cex=0.5,pch=19)

</code></pre>

<hr>
<h2 id='ecospat.permut.glm'>GLM Permutation Function</h2><span id='topic+ecospat.permut.glm'></span>

<h3>Description</h3>

<p>A permutation function to get p-values on GLM coefficients and deviance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.permut.glm (glm.obj, nperm, verbose = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.permut.glm_+3A_glm.obj">glm.obj</code></td>
<td>
<p>Any calibrated GLM or GAM object with a binomial error distribution.</p>
</td></tr>
<tr><td><code id="ecospat.permut.glm_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations in the randomization process.</p>
</td></tr>
<tr><td><code id="ecospat.permut.glm_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rows of the response variable are permuted and a new GLM is calibrated as well as deviance, adjusted deviance and coefficients are calculated. These random parameters are compared to the true parameters in order to derive p-values.</p>


<h3>Value</h3>

<p>Return p-values that are how the true parameters of the original model deviate from the disribution of the random parameters. A p-value of zero means that the true parameter is completely outside the random distribution.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a>, Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a> and Trevor Hastie</p>


<h3>References</h3>

<p>Hastie, T., R. Tibshirani and J. Friedman. 2001. <em>Elements of Statistical Learning; Data Mining, Inference, and Prediction</em>, Springer-Verlag, New York.
</p>
<p>Legendre, P. and L. Legendre. 1998. <em>Numerical Ecology</em>, 2nd English edition. Elsevier Science BV, Amsterdam.</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if(require("rms",quietly=TRUE)){
  data('ecospat.testData')

  # data for Soldanella alpina
  data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")] 

  # glm model for Soldanella alpina

  glm.Solalp &lt;- glm(Soldanella_alpina ~ pol(ddeg,2) + pol(mind,2) + pol(srad,2) + pol(slp,2) 
      + pol(topo,2), data = data.Solalp, family = binomial)
                  
  # p-values
  ecospat.permut.glm (glm.Solalp, 1000)
}

</code></pre>

<hr>
<h2 id='ecospat.plot.contrib'>Plot Variables Contribution</h2><span id='topic+ecospat.plot.contrib'></span>

<h3>Description</h3>

<p>Plot the contribution of the initial variables to the analysis (i.e. correlation circle). Typically these are the eigen vectors and eigen values in ordinations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.plot.contrib (contrib, eigen)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.contrib_+3A_contrib">contrib</code></td>
<td>
<p>A dataframe of the contribution of each original variable on each axis of the analysis, i.e. the eigen vectors. </p>
</td></tr>
<tr><td><code id="ecospat.plot.contrib_+3A_eigen">eigen</code></td>
<td>
<p>A vector of the importance of the axes in the ordination, i.e. a vector of eigen values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires ade4 library. If using <code><a href="stats.html#topic+princomp">princomp</a></code> , use $loadings and $sdev of the princomp object. if using <code><a href="ade4.html#topic+dudi.pca">dudi.pca</a></code>, use $li and $eig of the dudi.pca object.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.plot.niche.dyn">ecospat.plot.niche.dyn</a></code>,<code><a href="#topic+ecospat.plot.overlap.test">ecospat.plot.overlap.test</a></code>,
<code><a href="#topic+ecospat.niche.similarity.test">ecospat.niche.similarity.test</a></code>,<code>princomp</code></p>

<hr>
<h2 id='ecospat.plot.kappa'>
Plot Kappa
</h2><span id='topic+ecospat.plot.kappa'></span>

<h3>Description</h3>

<p>Plots the values for Cohen's Kappa along different thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.plot.kappa(Pred, Sp.occ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.kappa_+3A_pred">Pred</code></td>
<td>

<p>A vector of predicted probabilities
</p>
</td></tr>
<tr><td><code id="ecospat.plot.kappa_+3A_sp.occ">Sp.occ</code></td>
<td>

<p>A vector of binary observations of the species occurrence
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the Cohen's Kappa values along different thresholds.
</p>


<h3>Author(s)</h3>

<p>Luigi Maiorano <a href="mailto:luigi.maiorano@gmail.com">luigi.maiorano@gmail.com</a> with contributions of Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>.
</p>


<h3>References</h3>

<p>Liu, C., P.M. Berry, T.P. Dawson, and R.G. Pearson. 2005. Selecting thresholds of occurrence in the prediction of species distributions. <em>Ecography</em>, <b>28</b>, 385-393.
</p>
<p>Landis, J.R. and G.G. Koch. 1977. The measurement of observer agreement for categorical data. <em>biometrics</em>, <b>33</b>,159-174.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.meva.table">ecospat.meva.table</a></code>, <code><a href="#topic+ecospat.max.tss">ecospat.max.tss</a></code>, <code><a href="#topic+ecospat.plot.tss">ecospat.plot.tss</a></code>, <code><a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a></code>, <code><a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris
ecospat.plot.kappa(Pred, Sp.occ)
</code></pre>

<hr>
<h2 id='ecospat.plot.mess'>Plot MESS</h2><span id='topic+ecospat.plot.mess'></span>

<h3>Description</h3>

<p>Plot the MESS extrapolation index onto the geographical space.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.plot.mess (mess.object, cex=1, pch=15)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.mess_+3A_mess.object">mess.object</code></td>
<td>
<p>A dataframe as returned by the <code>ecospat.mess</code> function.</p>
</td></tr>
<tr><td><code id="ecospat.plot.mess_+3A_cex">cex</code></td>
<td>
<p>Specify the size of the symbol.</p>
</td></tr>
<tr><td><code id="ecospat.plot.mess_+3A_pch">pch</code></td>
<td>
<p>Specify the point symbols.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a plot of the the MESS extrapolation index onto the geographical space.</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>


<h3>References</h3>

<p>Elith, J., M. Kearney and S. Phillips. 2010. The art of modelling range-shifting species. <em>Methods in ecology and evolution</em>, <b>1</b>, 330-342.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.mess">ecospat.mess</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- ecospat.testData[c(2,3,4:8)]
proj &lt;- x[1:90,] #A projection dataset.
cal &lt;- x[91:300,] #A calibration dataset

#Create a MESS object 
mess.object &lt;- ecospat.mess (proj, cal, w="default")

#Plot MESS 
ecospat.plot.mess (mess.object, cex=1, pch=15)

</code></pre>

<hr>
<h2 id='ecospat.plot.niche'>Plot Niche</h2><span id='topic+ecospat.plot.niche'></span>

<h3>Description</h3>

<p>Plot a niche z created by <code>ecospat.grid.clim.dyn</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.plot.niche (z, title, name.axis1, name.axis2, cor=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.niche_+3A_z">z</code></td>
<td>
<p>A gridclim object for the species distribution created by <code>ecospat.grid.clim.dyn</code>.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche_+3A_title">title</code></td>
<td>
<p>A title for the plot.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche_+3A_name.axis1">name.axis1</code></td>
<td>
<p>A label for the first axis.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche_+3A_name.axis2">name.axis2</code></td>
<td>
<p>A label for the second axis.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche_+3A_cor">cor</code></td>
<td>
<p>Correct the occurrence densities of the species by the prevalence of the environments in its range (TRUE = yes, FALSE = no).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if z is bivariate, a bivariate plot of the niche of the species. if z is univariate, a histogram of the niche of the species</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.grid.clim.dyn">ecospat.grid.clim.dyn</a></code></p>

<hr>
<h2 id='ecospat.plot.niche.dyn'>Niche Categories and Species Density</h2><span id='topic+ecospat.plot.niche.dyn'></span>

<h3>Description</h3>

<p>Plot niche categories and species density created by <code>ecospat.grid.clim.dyn</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.plot.niche.dyn(z1, z2, quant = 0, title = "", name.axis1 = "Axis 1",
                    name.axis2 = "Axis 2", interest = 1, col.unf =
                    "green", col.exp = "red", col.stab = "blue", colZ1 =
                    "green3", colZ2 = "red3", transparency = 70,...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_z1">z1</code></td>
<td>
<p>A gridclim object for the native distribution.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_z2">z2</code></td>
<td>
<p>A gridclim object for the invaded range.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_quant">quant</code></td>
<td>
<p>The quantile of the environmental density used to delimit marginal climates.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_name.axis1">name.axis1</code></td>
<td>
<p>A label for the first axis.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_name.axis2">name.axis2</code></td>
<td>
<p>A label for the second axis</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_interest">interest</code></td>
<td>
<p>Choose which density to plot: if <code>interest=1</code>, plot native density, if <code>interest=2</code>, plot invasive density.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_col.unf">col.unf</code></td>
<td>
<p>The color used to depict unfilling area.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_col.exp">col.exp</code></td>
<td>
<p>The color used to depict expansion area.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_col.stab">col.stab</code></td>
<td>
<p>The color used to depict stability area.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_colz1">colZ1</code></td>
<td>
<p>The color used to delimit the native extent.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_colz2">colZ2</code></td>
<td>
<p>The color used to delimit the invaded extent.</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_transparency">transparency</code></td>
<td>
<p>A value between 0 and 100 to set the transparency level of the niche categories</p>
</td></tr>
<tr><td><code id="ecospat.plot.niche.dyn_+3A_...">...</code></td>
<td>
<p>Other graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the default colors, the plot will show the niche stability in blue, niche expansion in red, and niche unfilling in green. 
The solid contour line indicates the extent of environmental conditions that exists in the native and invaded ranges; 
the dotted contour line indicates the quantile indicated by the <code>quant</code> argument.
The densities of occurrences are displayed using gray shading. This shading shows occurences in the native or
invaded range only, as determined by the value of the <code>interest</code> argument. 
</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>

<hr>
<h2 id='ecospat.plot.overlap.test'>Plot Overlap Test</h2><span id='topic+ecospat.plot.overlap.test'></span>

<h3>Description</h3>

<p>Plot a histogram of observed and randomly simulated overlaps, with p-values of equivalency or similarity tests.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.plot.overlap.test (x, type, title)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.overlap.test_+3A_x">x</code></td>
<td>
<p>Object created by 
</p>
<p><code>ecospat.niche.similarity.test</code> or <code>ecospat.niche.equivalency.test</code>.</p>
</td></tr>
<tr><td><code id="ecospat.plot.overlap.test_+3A_type">type</code></td>
<td>
<p>Select the tested index. Must be &ldquo;D&rdquo;, &ldquo;I&rdquo;, &ldquo;expansion&rdquo;, &ldquo;stability&rdquo;, &ldquo;unfilling&rdquo;.</p>
</td></tr>
<tr><td><code id="ecospat.plot.overlap.test_+3A_title">title</code></td>
<td>
<p>The title for the plot.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>Broennimann, O., M.C. Fitzpatrick, P.B. Pearman, B. Petitpierre, L. Pellissier, N.G. Yoccoz, W. Thuiller, M.J. Fortin, C. Randin, N.E. Zimmermann, C.H. Graham and A. Guisan. 2012. Measuring ecological niche overlap from occurrence and spatial environmental data. <em>Global Ecology and Biogeography</em>, <b>21</b>, 481-497.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.niche.similarity.test">ecospat.niche.similarity.test</a></code>, <code><a href="#topic+ecospat.niche.equivalency.test">ecospat.niche.equivalency.test</a></code></p>

<hr>
<h2 id='ecospat.plot.tss'>
Plot True skill statistic (TSS)
</h2><span id='topic+ecospat.plot.tss'></span>

<h3>Description</h3>

<p>Plots the values for True skill statistic (TSS) along different thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ecospat.plot.tss(Pred, Sp.occ)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.plot.tss_+3A_pred">Pred</code></td>
<td>

<p>A vector of predicted probabilities
</p>
</td></tr>
<tr><td><code id="ecospat.plot.tss_+3A_sp.occ">Sp.occ</code></td>
<td>

<p>A vector of binary observations of the species occurrence
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the TSS values along different thresholds.
</p>


<h3>Author(s)</h3>

<p>Luigi Maiorano <a href="mailto:luigi.maiorano@gmail.com">luigi.maiorano@gmail.com</a>
</p>


<h3>References</h3>

<p>Liu, C., P.M. Berry, T.P. Dawson, and R.G. Pearson. 2005. Selecting thresholds of occurrence in the prediction of species distributions. <em>Ecography</em>, <b>28</b>, 385-393.
</p>
<p>Liu, C., M. White and G. Newell. 2013. Selecting thresholds for the prediction of species occurrence with presence-only data. <em>Journal of Biogeography</em>, <em>40</em>, 778-789.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.meva.table">ecospat.meva.table</a></code>, <code><a href="#topic+ecospat.max.tss">ecospat.max.tss</a></code>, <code><a href="#topic+ecospat.plot.kappa">ecospat.plot.kappa</a></code>, <code><a href="#topic+ecospat.cohen.kappa">ecospat.cohen.kappa</a></code>, <code><a href="#topic+ecospat.max.kappa">ecospat.max.kappa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Pred &lt;- ecospat.testData$glm_Agrostis_capillaris
Sp.occ &lt;- ecospat.testData$Agrostis_capillaris
ecospat.plot.tss(Pred, Sp.occ)
</code></pre>

<hr>
<h2 id='ecospat.poolingEvaluation'>
Evaluation of species distribution models using the pooling procedure
</h2><span id='topic+ecospat.poolingEvaluation'></span>

<h3>Description</h3>

<p>This function evaluates species distribution models using 100% of the dataset by pooling the different runs of the cross validation as in Collart et al. 2021
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ecospat.poolingEvaluation(fit,
                            calib,
                            resp,
                            AlgoName = NULL,
                            metrics = c("SomersD","AUC","MaxTSS","MaxKappa","Boyce"),
                            ensembleEvaluation=FALSE,
                            w=NULL,
                            metricToEnsemble = "MaxTSS")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.poolingEvaluation_+3A_fit">fit</code></td>
<td>

<p>a list containing <em>n</em> data.frame or matrix, where <em>n</em> corresponds to the number of algorithm you want to evaluate. The data.frames (matrices) need to contain the model predictions (ranging between 0 and 1) resulting from the different runs of cross-validation. These data.frame need to have the same number of rows as in the full dataset (100% of the occurrences and 100% of the absences or background points) and a number of column equal to the number of cross-validation runs
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_calib">calib</code></td>
<td>

<p>a logical matrix with a number of rows equal to the full dataset and a number of column corresponding to the number of cross-validation runs. The value TRUE is to mention the elements that where used to calibrate the models whereas FALSE corresponds to the one that will be used for the evaluation (<em>NB</em> the points used to calibrate the models during a cross-validation run should be the same across algoritms)
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_resp">resp</code></td>
<td>

<p>a numeric vector where 1 corresponds to a species response and 0 to an absence (or background point) with a length corresponding to number of rows in calib
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_algoname">AlgoName</code></td>
<td>

<p>a character vector for giving a name to each elements of fit. If NULL, the position in the list will be used instead.
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_metrics">metrics</code></td>
<td>
<p>a vector of evaluation metrics chosen among &quot;SomersD&quot;, &quot;AUC&quot;, &quot;MaxTSS&quot;, &quot;MaxKappa&quot;, &quot;Boyce&quot;</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_ensembleevaluation">ensembleEvaluation</code></td>
<td>

<p>logical. If TRUE, the ensemble model will be evaluated applying a weighted mean across algorithms.  
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_w">w</code></td>
<td>

<p>a numeric vector of the weights used to realize the ensemble model. The length should match the number of algorithms.
</p>
</td></tr>
<tr><td><code id="ecospat.poolingEvaluation_+3A_metrictoensemble">metricToEnsemble</code></td>
<td>

<p>character. Metric to use to ensemble the models with a weighted mean when w is not given. The metric should be one in metrics</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because a minimum sample size is needed to evaluate models (see Jiménez-Valverde, 2020), this function uses the approach from Collart et al.(2021), which consists to pool the suitability values of the hold-out data (evaluation dataset) across replicates. As the same data point (presence or absence or background point) is presumably sampled in several replicates, the suitability values for each data point is consequently averaged across replicates where they were sampled. This procedure generates a series of independent suitability values with a size approximately equal (as some data points may not have been sampled by chance in any of the <em>n</em> replicates) to that of the number of data point.
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table>
<tr><td><code>evaluations</code></td>
<td>

<p>a matrix with the evaluation scores based on the different modelling algorithms and based on the consensus across the modelling algorithms (called here &quot;ensemble&quot;)
</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>

<p>a matrix of predicted values resulting from the pooling procedure and used to compute the evaluation scores. The column <em>resp</em> is where the species occurs or not
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Flavien Collart <a href="mailto:flavien.collart@unil.ch">flavien.collart@unil.ch</a>
</p>
<p>with contributions of Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Collart, F., Hedenäs, L., Broennimann, O., Guisan, A. and Vanderpoorten, A. 2021. Intraspecific differentiation: Implications for niche and distribution modelling. <em>Journal of Biogeography</em>. <b>48</b>, 415-426. <a href="https://doi.org/10.1111/jbi.14009">doi:10.1111/jbi.14009</a>
</p>
<p>Jiménez-Valverde, A. 2020. Sample size for the evaluation of presence-absence models. <em>Ecological Indicators</em>. <b>114</b>, 106289. <a href="https://doi.org/10.1016/j.ecolind.2020.106289">doi:10.1016/j.ecolind.2020.106289</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.ESM.EnsembleEvaluation">ecospat.ESM.EnsembleEvaluation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(42)
  resp &lt;- c(rep(1,15),rep(0,85)) #15 presences and 85 absences
  #Generating a fake fit object whith two algorithms and 3 cross-vaidation
  fit &lt;- list(matrix(0,nc=3,nr=100),
              matrix(0,nc=3,nr=100))
  fit[[1]][1:15,] = sample(seq(0,1, by=0.01),15*3,prob=c(rep(1,51),rep(10,50)),replace=TRUE)
  fit[[2]][1:15,] = sample(seq(0,1, by=0.01),15*3,prob=c(rep(1,51),rep(10,50)),replace=TRUE)
  fit[[1]][16:100,] = sample(seq(0,1, by=0.01),85*3,prob=c(rep(10,51),rep(1,50)),replace=TRUE)
  fit[[2]][16:100,] = sample(seq(0,1, by=0.01),85*3,prob=c(rep(10,51),rep(1,50)),replace=TRUE)
  
  # Generating a calib object where 80% of the dataset is used to calibrate the model 
  # and 20% to evaluate it
  calib &lt;- matrix(TRUE,nc=3,nr=100)
  calib[c(sample(1:15,3),sample(16:100,17)),1]=FALSE 
  calib[c(sample(1:15,3),sample(16:100,17)),2]=FALSE 
  calib[c(sample(1:15,3),sample(16:100,17)),3]=FALSE 
  
  # Evaluation via the pooling procedure
  eval &lt;- ecospat.poolingEvaluation(fit=fit,calib=calib,resp=resp,metrics=c("AUC","MaxTSS"))
  eval$evaluations
  
  # Evaluation including the ensemble model based on a weighted mean using MaxTSS
  evalEns &lt;- ecospat.poolingEvaluation(fit=fit,calib=calib,resp=resp,ensembleEvaluation=TRUE,
                                       metrics=c("AUC","MaxTSS"))
  evalEns$evaluations
  
  # Evaluation including the ensemble model based on a mean by giving the same weight for 
  # each algorithm
  evalEns &lt;- ecospat.poolingEvaluation(fit=fit,calib=calib,resp=resp,ensembleEvaluation=TRUE,
                                       metrics=c("AUC","MaxTSS"),w=c(1,1))
  evalEns$evaluations
</code></pre>

<hr>
<h2 id='ecospat.rand.pseudoabsences'>Sample Pseudo-Absences</h2><span id='topic+ecospat.rand.pseudoabsences'></span>

<h3>Description</h3>

<p>Randomly sample pseudoabsences from an environmental dataframe covering the study area.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.rand.pseudoabsences (nbabsences, glob, colxyglob, colvar="all", 
presence, colxypresence, mindist)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_nbabsences">nbabsences</code></td>
<td>
<p>The number of pseudoabsences desired.</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_glob">glob</code></td>
<td>
<p>A two-column dataframe (or a vector) of the environmental values (in column) for background pixels of the whole study area (in row).</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_colxyglob">colxyglob</code></td>
<td>
<p>The range of columns for x and y in glob.</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_colvar">colvar</code></td>
<td>
<p>The range of columns for the environmental variables in glob. colvar=&quot;all&quot; keeps all the variables in glob in the final dataframe. colvar=NULL keeps only x and y.</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_presence">presence</code></td>
<td>
<p>A presence-absence dataframe for each species (columns) in each location or grid cell (rows).</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_colxypresence">colxypresence</code></td>
<td>
<p>The range of columns for x and y in presence.</p>
</td></tr>
<tr><td><code id="ecospat.rand.pseudoabsences_+3A_mindist">mindist</code></td>
<td>
<p>The minimum distance from presences within wich pseudoabsences should not be drawn (buffer distance around presences).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of random absences.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>glob &lt;- ecospat.testData[2:8]
presence &lt;- ecospat.testData[c(2:3,9)]
presence &lt;- presence[presence[,3]==1,1:2]
ecospat.rand.pseudoabsences (nbabsences=10, glob=glob, colxyglob=1:2, colvar = "all", 
presence= presence, colxypresence=1:2, mindist=20)
</code></pre>

<hr>
<h2 id='ecospat.rangesize'>
Quantification of the range size of a species using habitat suitability maps and IUCN criteria)
</h2><span id='topic+ecospat.rangesize'></span>

<h3>Description</h3>

<p>This function quantifies the range size of a species using standard IUCN criteria (Area of Occupancy AOO, Extent of Occurence EOO) or binary maps derived from Species Distribution Models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.rangesize (bin.map, ocp, buffer, eoo.around.model, eoo.around.modelocp, 
xy, EOO, Model.within.eoo, AOO, resol, AOO.circles, d, lonlat, return.obj, 
save.obj, save.rangesize, directory)

ecospat.rangesize (bin.map = NULL,
                   ocp = TRUE,
                   buffer = 0,
                   eoo.around.model = TRUE,
                   eoo.around.modelocp = FALSE,
                   xy = NULL,
                   EOO = TRUE,
                   Model.within.eoo = TRUE,
                   AOO = TRUE,
                   resol = c(2000, 2000),
                   AOO.circles = FALSE,
                   d = sqrt((2000 * 2)/pi),
                   lonlat = FALSE,
                   return.obj = TRUE,
                   save.obj = FALSE,
                   save.rangesize = FALSE,
                   directory = getwd())



</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.rangesize_+3A_bin.map">bin.map</code></td>
<td>
<p>Binary map (a SpatRaster) from a Species Distribution Model.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_ocp">ocp</code></td>
<td>
<p>logical. Calculate occupied patch models from the binary map (predicted area occupied by the species)</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_buffer">buffer</code></td>
<td>
<p>numeric. Calculate occupied patch models from the binary map using a buffer (predicted area occupied by the species or within a buffer around the species, for details see ?extract).</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_eoo.around.model">eoo.around.model</code></td>
<td>
<p>logical. The EOO around all positive predicted values from the binary map.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_eoo.around.modelocp">eoo.around.modelocp</code></td>
<td>
<p>logical. EOO around all positive predicted values of occupied patches.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_xy">xy</code></td>
<td>
<p>xy-coordinates of the species presence</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_eoo">EOO</code></td>
<td>
<p>logical. Extent of Occurrence. Convex Polygon around occurrences.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_model.within.eoo">Model.within.eoo</code></td>
<td>
<p>logical. Area predicted as suitable by the model within EOO.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_aoo">AOO</code></td>
<td>
<p>logical. Area of Occupancy ddervied by the occurrences.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_resol">resol</code></td>
<td>
<p>Resolution of the grid frame at which AOO should be calculated.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_aoo.circles">AOO.circles</code></td>
<td>
<p>logical. AOO calculated by circles around the occurrences instead of using a grid frame.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_d">d</code></td>
<td>
<p>Radius of the AOO.circles around the occurrences.</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_lonlat">lonlat</code></td>
<td>
<p>Are these longitude/latidue coordinates? (Default = FALSE).</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_return.obj">return.obj</code></td>
<td>
<p>logical. should the objects created to estimate range size be returned (SpatRaster and spatial polygons). Default: TRUE</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_save.obj">save.obj</code></td>
<td>
<p>logical. should objects be saved on hard drive?</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_save.rangesize">save.rangesize</code></td>
<td>
<p>logical. should range size estimations be saved on hard drive .</p>
</td></tr>
<tr><td><code id="ecospat.rangesize_+3A_directory">directory</code></td>
<td>
<p>directory in which objects should be saved (Default = getwd())</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The range size of a species is important for many conservation purposes, e.g. to assess the status of threat for IUCN Red Lists. This function quantifies the range size using different IUCN measures, i.e. the Area Of Occupancy (AOO), the Extent Of Occurrence (EOO) and from binary maps derived from Species Distribution Models (SDMs). Different ways to extract range size from SDMs are available, e.g. using occupied patches, the suitable habitat within EOO or a convex hull around the suitable habitat.
</p>


<h3>Value</h3>

<p>A list with the values of range size quantification and the stored objects used for quantification (of class SpatRaster, ahull, ConvexHull).
</p>


<h3>Author(s)</h3>

<p>Frank Breiner <a href="mailto:frank.breiner@wsl.ch">frank.breiner@wsl.ch</a> with the contributions of Flavien Collart
</p>


<h3>References</h3>

<p>IUCN. 2012. IUCN Red List Categories and Criteria: Version 3.1. Second edition. Gland, Switzerland and Cambridge, UK: IUCN. iv + 32pp.
</p>
<p>IUCN Standards and Petitions Subcommittee. 2016. Guidelines for Using the IUCN Red List Categories and Criteria. Version 12. Prepared by the Standards and Petitions Subcommittee. Downloadable from http://www.iucnredlist.org/documents/RedListGuidelines.pdf
</p>
<p>Pateiro-Lopez, B., and A. Rodriguez-Casal. 2010. Generalizing the Convex Hull of a Sample: The R Package alphahull. <em>Journal of Statistical software</em>, <b>34</b>, 1-28.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.occupied.patch">ecospat.occupied.patch</a></code>, <code><a href="#topic+ecospat.mpa">ecospat.mpa</a></code>, <code><a href="#topic+ecospat.binary.model">ecospat.binary.model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(dismo)

# coordinates of the plots
xy &lt;- ecospat.testData[,2:3]

# environmental data
predictors &lt;- terra::rast(system.file("extdata","ecospat.testEnv.tif",package="ecospat"))
env &lt;- terra::extract(predictors,xy,ID=FALSE)  
spData &lt;- cbind.data.frame(occ=ecospat.testData$Veronica_alpina,env)
mod &lt;- glm(occ~ddeg0+I(ddeg0^2)+srad68+I(srad68^2),data=spData,family = binomial())

# predict to entire dataset
pred &lt;- terra::predict(predictors,mod,type="response") 
plot(pred)
points(xy[spData$occ==1,])
  
### make binary maps
#arbitratry threshold
pred.bin.arbitrary &lt;- ecospat.binary.model(pred,0.3)
names(pred.bin.arbitrary) &lt;- "me.arbitrary"
# use MPA to convert suitability to binary map
mpa.cutoff &lt;- ecospat.mpa(pred,xy[spData$occ==1,])
pred.bin.mpa &lt;- ecospat.binary.model(pred,mpa.cutoff)
names(pred.bin.mpa) &lt;- "me.mpa"

### rangesize calculations

if(require(alphahull,quietly=TRUE)){

  rangesize2 &lt;- ecospat.rangesize(c(pred.bin.mpa,pred.bin.arbitrary),
                                   xy=xy[spData$occ==1,],
                                   AOO.circles = TRUE,
                                   lonlat =FALSE)
  rangesize2$RangeSize
    
  names(rangesize2$RangeObjects)
    
  par(mfrow=c(1,3))
    
  plot(ecospat.binary.model(pred,0),legend=FALSE, main="IUCN criteria")
    
  ### IUCN criteria &amp; derivates
    
  # plot AOO
  plot(rangesize2$RangeObjects$AOO,add=TRUE, col="red",legend=FALSE)
    
  # plot EOO
  plot(rangesize2$RangeObjects$EOO@polygons,add=TRUE, border="red", lwd=2)
    
  # plot circles around occurrences
  plot(rangesize2$RangeObjects$AOO.circle@polygons,add=TRUE,border="blue")
    
  for(i in 1:2){
    ## plot the occupied patches of the model
    plot(rangesize2$RangeObjects$models.ocp[[i]],col=c("grey","blue","darkgreen"),
          main=names(rangesize2$RangeObjects$models.ocp[[i]]),legend=FALSE)
    points(xy[spData$occ==1,],col="red",cex=0.5,pch=19)
    ## plot EOO around model
    plot(rangesize2$RangeObjects$eoo.around.model[[i]]@polygons,add=TRUE,border="blue",lwd=2)
    ## plot the modeled area within EOO
    #plot(rangesize$RangeObjects$model.within.eoo[[i]],col=c("grey","blue","darkgreen"))
    #points(occ,col="red",cex=0.5,pch=19)
    #plot(rangesize$RangeObjects$EOO@polygons,add=TRUE, border="red", lwd=2)
    }
  par(mfrow=c(1,1))
    
  ### Alpha-hulls are not included in the function yet because of Licence limitations.
  ### However, alpha-hulls can easily be included manually (see also the help file of 
  ### the alpha hull package):
    
  alpha = 2 # alpha value of 2 recommended by IUCN
    
  del&lt;-alphahull::delvor(xy[spData$occ==1,])
  dv&lt;-del$mesh
  mn &lt;- mean(sqrt(abs(del$mesh[,3]-del$mesh[,5])^2+abs(del$mesh[,4]-del$mesh[,6])^2))*alpha
  alpha.hull&lt;-alphahull::ahull(del,alpha=mn) 
    
  #Size of alpha-hulls
  #areaahull(alpha.hull) #works but uses a deprecated function in alphahull 2.1
    
  #plot alphahulls
  plot(rangesize2$RangeObjects$models.ocp[[1]],col=c("grey","blue","darkgreen"),
        main=names(rangesize2$RangeObjects$models.ocp[[1]]),legend=FALSE)
  plot(alpha.hull,add=TRUE,lwd=1)
}

</code></pre>

<hr>
<h2 id='ecospat.rcls.grd'>Reclassifying grids function</h2><span id='topic+ecospat.rcls.grd'></span>

<h3>Description</h3>

<p>Function for reclassifying grid files to get a combined statification from more than one grid</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.rcls.grd(in_grid,no.classes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.rcls.grd_+3A_in_grid">in_grid</code></td>
<td>
<p>A SpatRaster to be reclassified.</p>
</td></tr>
<tr><td><code id="ecospat.rcls.grd_+3A_no.classes">no.classes</code></td>
<td>
<p>The number of desired new classes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reclassifies the input grid into a number of new classes that the user defines. The boundaries of each class are decided automatically by splitting the range of values of the input grid into the user defined number of classes.
</p>


<h3>Value</h3>

<p>Returns a reclassified SpatRaster object
</p>


<h3>Author(s)</h3>

<p>Achilleas Psomas <a href="mailto:achilleas.psomas@wsl.ch">achilleas.psomas@wsl.ch</a> and Niklaus E. Zimmermann <a href="mailto:niklaus.zimmermann@wsl.ch">niklaus.zimmermann@wsl.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(terra)
library(classInt)
library(biomod2)

data("bioclim_current")
bioclim_current &lt;- terra::rast(bioclim_current)
bio3 &lt;- bioclim_current[["bio3"]]
bio12 &lt;- bioclim_current[["bio12"]]

B3.rcl&lt;-ecospat.rcls.grd(bio3,9) 
B12.rcl&lt;-ecospat.rcls.grd(bio12,9)
B3B12.comb &lt;- B12.rcl+B3.rcl*10

# Plotting a histogram of the classes
hist(B3B12.comb,breaks=100,col=heat.colors(88)) 
# Plotting the new SpatRaster (9x9 classes)
plot(B3B12.comb,col=rev(rainbow(88)),main="Stratified map") 

</code></pre>

<hr>
<h2 id='ecospat.recstrat_prop'>
Random Ecologically Stratified Sampling of propotional numbers
</h2><span id='topic+ecospat.recstrat_prop'></span>

<h3>Description</h3>

<p>This function randomly collects a user-defined total number of samples from the stratification layer. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ecospat.recstrat_prop(in_grid, sample_no)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.recstrat_prop_+3A_in_grid">in_grid</code></td>
<td>

<p>The stratification grid (SpatRaster) to be sampled.
</p>
</td></tr>
<tr><td><code id="ecospat.recstrat_prop_+3A_sample_no">sample_no</code></td>
<td>

<p>The total number of pixels to be sampled.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of samples per class are determined proportional to the abundance of each class.
The number of classes in the stratification layer are determined automatically from the integer input map.
If the proportion of samples for a certain class is below one then no samples are collected for this class.
</p>


<h3>Value</h3>

<p>Returns a dataframe with the selected sampling locations their coordinates and the strata they belong in.
</p>


<h3>Author(s)</h3>

<p>Achilleas Psomas <a href="mailto:achilleas.psomas@wsl.ch">achilleas.psomas@wsl.ch</a> and Niklaus E. Zimmermann <a href="mailto:niklaus.zimmermann@wsl.ch">niklaus.zimmermann@wsl.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.recstrat_regl">ecospat.recstrat_regl</a></code>
<code><a href="#topic+ecospat.rcls.grd">ecospat.rcls.grd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
    library(terra)
    library(classInt)
    library(biomod2)
    
    data("bioclim_current")
    bioclim_current &lt;- terra::rast(bioclim_current)
    bio3 &lt;- bioclim_current[["bio3"]]
    bio12 &lt;- bioclim_current[["bio12"]]

    
    B3.rcl&lt;-ecospat.rcls.grd(bio3,9) 
    B12.rcl&lt;-ecospat.rcls.grd(bio12,9)
    B3B12.comb &lt;- B12.rcl+B3.rcl*10
    
    B3B12.prop_samples &lt;- ecospat.recstrat_prop(B3B12.comb,100)
    
    plot(B3B12.comb)
    points(B3B12.prop_samples$x,B3B12.prop_samples$y,pch=16,cex=0.6,col=B3B12.prop_samples$class)
</code></pre>

<hr>
<h2 id='ecospat.recstrat_regl'>
Random Ecologically Stratified Sampling of equal numbers
</h2><span id='topic+ecospat.recstrat_regl'></span>

<h3>Description</h3>

<p>This function randomly takes an equal number of samples per class in the stratification layer. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ecospat.recstrat_regl(in_grid, sample_no)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.recstrat_regl_+3A_in_grid">in_grid</code></td>
<td>

<p>The stratification grid (SpatRaster) to be sampled.
</p>
</td></tr>
<tr><td><code id="ecospat.recstrat_regl_+3A_sample_no">sample_no</code></td>
<td>

<p>The total number of pixels to be sampled.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of classes in the stratification layer is determined automatically from the integer input map. 
If the number of pixels in a class is higher than the number of samples, 
then a random selection without re-substitution is performed, 
otherwise all pixels of that class are selected.
</p>


<h3>Value</h3>

<p>Returns a dataframe with the selected sampling locations their coordinates and the strata they belong in.
</p>


<h3>Author(s)</h3>

<p>Achilleas Psomas <a href="mailto:achilleas.psomas@wsl.ch">achilleas.psomas@wsl.ch</a> and Niklaus E. Zimmermann <a href="mailto:niklaus.zimmermann@wsl.ch">niklaus.zimmermann@wsl.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.recstrat_prop">ecospat.recstrat_prop</a></code>
<code><a href="#topic+ecospat.rcls.grd">ecospat.rcls.grd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  library(terra)
  library(classInt)
  library(biomod2)
  
  data("bioclim_current")
  bioclim_current &lt;- terra::rast(bioclim_current)
  bio3 &lt;- bioclim_current[["bio3"]]
  bio12 &lt;- bioclim_current[["bio12"]]

    
  B3.rcl&lt;-ecospat.rcls.grd(bio3,9) 
  B12.rcl&lt;-ecospat.rcls.grd(bio12,9)
  B3B12.comb &lt;- B12.rcl+B3.rcl*10
    
  B3B12.regl_samples &lt;- ecospat.recstrat_prop(B3B12.comb,100)
  
  plot(B3B12.comb)
  points(B3B12.regl_samples$x,B3B12.regl_samples$y,pch=16,cex=0.6,col=B3B12.regl_samples$class)
</code></pre>

<hr>
<h2 id='ecospat.sample.envar'>Sample Environmental Variables</h2><span id='topic+ecospat.sample.envar'></span>

<h3>Description</h3>

<p>Add environmental values to a species dataframe.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.sample.envar (dfsp, colspxy, colspkept = "xy", dfvar, 
colvarxy, colvar = "all", resolution)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.sample.envar_+3A_dfsp">dfsp</code></td>
<td>
<p>A species dataframe with x (long), y (lat) and optional other variables.</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_colspxy">colspxy</code></td>
<td>
<p>The range of columns for x (long) and y (lat) in dfsp.</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_colspkept">colspkept</code></td>
<td>
<p>The columns of dfsp that should be kept in the final dataframe (default: xy).</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_dfvar">dfvar</code></td>
<td>
<p>A dataframe object with x, y and environmental variables.</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_colvarxy">colvarxy</code></td>
<td>
<p>The range of columns for x and y in dfvar.</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_colvar">colvar</code></td>
<td>
<p>The range of enviromental variable columns in dfvar (default: all except xy).</p>
</td></tr>
<tr><td><code id="ecospat.sample.envar_+3A_resolution">resolution</code></td>
<td>
<p>The distance between x,y of species and environmental datafreme beyond which values shouldn't be added.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The xy (lat/long) coordinates of the species occurrences are compared to those of the environment dataframe and the value of the closest pixel is added to the species dataframe. When the closest environment pixel is more distant than the given resolution, NA is added instead of the value. This function is similar to sample() in ArcGIS.</p>


<h3>Value</h3>

<p>A Dataframe with the same rows as dfsp, with environmental values from dfvar in column.</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("ecospat.testNiche")
spp &lt;- ecospat.testNiche
sp1 &lt;- spp[1:32,2:3]
names(sp1)&lt;-c("x","y")
occ.sp1 &lt;- ecospat.occ.desaggregation(xy=sp1,min.dist=500)
clim &lt;- ecospat.testData[2:8]

occ_sp1 &lt;- na.exclude(ecospat.sample.envar(dfsp=occ.sp1,colspxy=1:2,colspkept=1:2,
                                            dfvar=clim,colvarxy=1:2,colvar="all",resolution=25))

</code></pre>

<hr>
<h2 id='ecospat.SESAM.prr'>SESAM Probability Ranking Rule
</h2><span id='topic+ecospat.SESAM.prr'></span>

<h3>Description</h3>

<p>Implement the SESAM framework to predict community composition using a 'probability ranking' rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.SESAM.prr(proba, sr, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.SESAM.prr_+3A_proba">proba</code></td>
<td>
<p>A data frame object of SDMs probabilities (or other sources) for all species. Column names (species names SDM) and row name (sampling sites) (need to have defined row names).</p>
</td></tr>
<tr><td><code id="ecospat.SESAM.prr_+3A_sr">sr</code></td>
<td>

<p>A data frame object with species richness value in the first column. Sites should be arranged in the same order as in the 'prob' argument. 
</p>
</td></tr>
<tr><td><code id="ecospat.SESAM.prr_+3A_verbose">verbose</code></td>
<td>
<p>Boolean indicating whether to print progress output during calculation. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The SESAM framework implemented in ecospat is based on 1) probabilities of individual species presence for each site - these can be obtained for example by fitting SDMs. This step represents the application of an environmental filter to the community assembly, 2) richness predictions for each site - the richness prediction can be derived in different ways, for instance by summing probabilities from individual species presence for each site  or by fitting direct richness models. This step represents the application of a macroecological constraint to the number of species that can coexist in the considered unit, 3) a biotic rule to decide which species potentially present in the site are retained in the final prediction to match the richness value predicted. The biotic rule applied here is called 'probability ranking' rule: the community composition in each site is determined by ranking the species in decreasing order of their predicted probability of presence from SDMs up to a richness prediction.
</p>


<h3>Value</h3>

<p>Returns a '.txt' file saved in the working directory that contains the community prediction by the SESAM framework, i.e. binary predictions for all species (columns) for each site (rows).
</p>


<h3>Author(s)</h3>

<p>Manuela D'Amen <a href="mailto:manuela.damen@unil.ch">manuela.damen@unil.ch</a> and Anne Dubuis <a href="mailto:anne.dubuis@gmail.com">anne.dubuis@gmail.com</a>
</p>


<h3>References</h3>

<p>D'Amen, M., A. Dubuis, R.F. Fernandes, J. Pottier, L. Pellissier and A. Guisan. 2015. Using species richness and functional traits predictions to constrain assemblage predictions from stacked species distribution models. <em>J. Biogeogr.</em>, <b>42</b>, 1255-1266.
</p>
<p>Guisan, A. and C. Rahbek. 2011. SESAM - a new framework integrating macroecological and species distribution models for predicting spatio-temporal patterns of species assemblages. <em>J. Biogeogr.</em>, <b>38</b>, 1433-1444.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>proba &lt;- ecospat.testData[,73:92]
sr &lt;- as.data.frame(rowSums(proba))
ppr&lt;-ecospat.SESAM.prr(proba, sr)
head(ppr)

</code></pre>

<hr>
<h2 id='ecospat.shift.centroids'>Draw Centroid Arrows</h2><span id='topic+ecospat.shift.centroids'></span>

<h3>Description</h3>

<p>Draw arrows linking the centroid of the native and exotic (non-native) distribution (continuous line) and between native and invaded extent (dashed line).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.shift.centroids(sp1, sp2, clim1, clim2,col)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.shift.centroids_+3A_sp1">sp1</code></td>
<td>
<p>The scores of the species native distribution along the the two first axes of the PCA.</p>
</td></tr>
<tr><td><code id="ecospat.shift.centroids_+3A_sp2">sp2</code></td>
<td>
<p>The scores of the species invasive distribution along the the two first axes of the PCA.</p>
</td></tr>
<tr><td><code id="ecospat.shift.centroids_+3A_clim1">clim1</code></td>
<td>
<p>The scores of the entire native extent along the the two first axes of the PCA.</p>
</td></tr>
<tr><td><code id="ecospat.shift.centroids_+3A_clim2">clim2</code></td>
<td>
<p>The scores of the entire invaded extent along the the two first axes of the PCA.</p>
</td></tr>
<tr><td><code id="ecospat.shift.centroids_+3A_col">col</code></td>
<td>
<p>Colour of the arrow.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Allows to visualize the shift of the niche centroids of the species and the centroids of the climatic conditions in the study area. To compare invasive species niche, the arrow links the centroid of the native and inasive distribution (continuous line) and between native and invaded extent (dashed line). </p>


<h3>Value</h3>

<p>Arrow on the overlap test plot</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a></p>

<hr>
<h2 id='ecospat.testData'>Test Data For The Ecospat package</h2><span id='topic+ecospat.testData'></span>

<h3>Description</h3>

<p>Data frame that contains vegetation plots data: presence records of 50 species, a set of environmental variables (topo-climatic) and SDM predictions for some species in the Western Swiss Alps (Canton de Vaud, Switzerland).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ecospat.testData")</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 96 variables.
</p>

<dl>
<dt><code>numplots</code></dt><dd><p>Number of the vegetation plot.</p>
</dd>
<dt><code>long</code></dt><dd><p>Longitude, in Swiss plane coordinate system of the vegetation plot.</p>
</dd>
<dt><code>lat</code></dt><dd><p>Latitude, in Swiss plane coordinate system of the vegetation plot.</p>
</dd>
<dt><code>ddeg</code></dt><dd><p>Growing degree days (with a 0 degrees Celsius threshold).</p>
</dd>
<dt><code>mind</code></dt><dd><p>Moisture index over the growing season (average values for June to August in mm day-1).</p>
</dd>
<dt><code>srad</code></dt><dd><p>The annual sum of radiation (in kJ m-2 year-1).</p>
</dd>
<dt><code>slp</code></dt><dd><p>Slope (in degrees) calculated from the DEM25.</p>
</dd>
<dt><code>topo</code></dt><dd><p>Topographic position (an integrated and unitless measure of topographic exposure.</p>
</dd>
<dt><code>Achillea_atrata</code></dt><dd></dd>
<dt><code>Achillea_millefolium</code></dt><dd></dd>
<dt><code>Acinos_alpinus</code></dt><dd></dd>
<dt><code>Adenostyles_glabra</code></dt><dd></dd>
<dt><code>Aposeris_foetida</code></dt><dd></dd>
<dt><code>Arnica_montana</code></dt><dd></dd>
<dt><code>Aster_bellidiastrum</code></dt><dd></dd>
<dt><code>Bartsia_alpina</code></dt><dd></dd>
<dt><code>Bellis_perennis</code></dt><dd></dd>
<dt><code>Campanula_rotundifolia</code></dt><dd></dd>
<dt><code>Centaurea_montana</code></dt><dd></dd>
<dt><code>Cerastium_latifolium</code></dt><dd></dd>
<dt><code>Cruciata_laevipes</code></dt><dd></dd>
<dt><code>Doronicum_grandiflorum</code></dt><dd></dd>
<dt><code>Galium_album</code></dt><dd></dd>
<dt><code>Galium_anisophyllon</code></dt><dd></dd>
<dt><code>Galium_megalospermum</code></dt><dd></dd>
<dt><code>Gentiana_bavarica</code></dt><dd></dd>
<dt><code>Gentiana_lutea</code></dt><dd></dd>
<dt><code>Gentiana_purpurea</code></dt><dd></dd>
<dt><code>Gentiana_verna</code></dt><dd></dd>
<dt><code>Globularia_cordifolia</code></dt><dd></dd>
<dt><code>Globularia_nudicaulis</code></dt><dd></dd>
<dt><code>Gypsophila_repens</code></dt><dd></dd>
<dt><code>Hieracium_lactucella</code></dt><dd></dd>
<dt><code>Homogyne_alpina</code></dt><dd></dd>
<dt><code>Hypochaeris_radicata</code></dt><dd></dd>
<dt><code>Leontodon_autumnalis</code></dt><dd></dd>
<dt><code>Leontodon_helveticus</code></dt><dd></dd>
<dt><code>Myosotis_alpestris</code></dt><dd></dd>
<dt><code>Myosotis_arvensis</code></dt><dd></dd>
<dt><code>Phyteuma_orbiculare</code></dt><dd></dd>
<dt><code>Phyteuma_spicatum</code></dt><dd></dd>
<dt><code>Plantago_alpina</code></dt><dd></dd>
<dt><code>Plantago_lanceolata</code></dt><dd></dd>
<dt><code>Polygonum_bistorta</code></dt><dd></dd>
<dt><code>Polygonum_viviparum</code></dt><dd></dd>
<dt><code>Prunella_grandiflora</code></dt><dd></dd>
<dt><code>Rhinanthus_alectorolophus</code></dt><dd></dd>
<dt><code>Rumex_acetosa</code></dt><dd></dd>
<dt><code>Rumex_crispus</code></dt><dd></dd> 
<dt><code>Vaccinium_gaultherioides</code></dt><dd></dd>
<dt><code>Veronica_alpina</code></dt><dd></dd>
<dt><code>Veronica_aphylla</code></dt><dd></dd>
<dt><code>Agrostis_capillaris</code></dt><dd></dd>
<dt><code>Bromus_erectus_sstr</code></dt><dd></dd>
<dt><code>Campanula_scheuchzeri</code></dt><dd></dd>
<dt><code>Carex_sempervirens</code></dt><dd></dd>
<dt><code>Cynosurus_cristatus</code></dt><dd></dd>
<dt><code>Dactylis_glomerata</code></dt><dd></dd>
<dt><code>Daucus_carota</code></dt><dd></dd>
<dt><code>Festuca_pratensis_sl</code></dt><dd></dd>
<dt><code>Geranium_sylvaticum</code></dt><dd></dd>
<dt><code>Leontodon_hispidus_sl</code></dt><dd></dd>
<dt><code>Potentilla_erecta</code></dt><dd></dd>
<dt><code>Pritzelago_alpina_sstr</code></dt><dd></dd>
<dt><code>Prunella_vulgaris</code></dt><dd></dd>
<dt><code>Ranunculus_acris_sl</code></dt><dd></dd>
<dt><code>Saxifraga_oppositifolia</code></dt><dd></dd>
<dt><code>Soldanella_alpina</code></dt><dd></dd>
<dt><code>Taraxacum_officinale_aggr</code></dt><dd></dd>
<dt><code>Trifolium_repens_sstr</code></dt><dd></dd>
<dt><code>Veronica_chamaedrys</code></dt><dd></dd>
<dt><code>Parnassia_palustris</code></dt><dd></dd>
<dt><code>glm_Agrostis_capillaris</code></dt><dd><p>GLM model for the species Agrostis_capillaris.</p>
</dd>
<dt><code>glm_Leontodon_hispidus_sl</code></dt><dd><p>GLM model for the species Leontodon_hispidus_sl.</p>
</dd>
<dt><code>glm_Dactylis_glomerata</code></dt><dd><p>GLM model for the species Dactylis_glomerata.</p>
</dd>
<dt><code>glm_Trifolium_repens_sstr</code></dt><dd><p>GLM model for the species Trifolium_repens_sstr.</p>
</dd>
<dt><code>glm_Geranium_sylvaticum</code></dt><dd><p>GLM model for the species Geranium_sylvaticum.</p>
</dd>
<dt><code>glm_Ranunculus_acris_sl</code></dt><dd><p>GLM model for the species Ranunculus_acris_sl.</p>
</dd>
<dt><code>glm_Prunella_vulgaris</code></dt><dd><p>GLM model for the species Prunella_vulgaris.</p>
</dd>
<dt><code>glm_Veronica_chamaedrys</code></dt><dd><p>GLM model for the species Veronica_chamaedrys.</p>
</dd>
<dt><code>glm_Taraxacum_officinale_aggr</code></dt><dd><p>GLM model for the species Taraxacum_officinale_aggr.</p>
</dd>
<dt><code>glm_Plantago_lanceolata</code></dt><dd><p>GLM model for the species Plantago_lanceolata.</p>
</dd>
<dt><code>glm_Potentilla_erecta</code></dt><dd><p>GLM model for the species Potentilla_erecta.</p>
</dd>
<dt><code>glm_Carex_sempervirens</code></dt><dd><p>GLM model for the species Carex_sempervirens.</p>
</dd>
<dt><code>glm_Soldanella_alpina</code></dt><dd><p>GLM model for the species Soldanella_alpina.</p>
</dd>
<dt><code>glm_Cynosurus_cristatus</code></dt><dd><p>GLM model for the species Cynosurus_cristatus.</p>
</dd>
<dt><code>glm_Campanula_scheuchzeri</code></dt><dd><p>GLM model for the species Campanula_scheuchzeri.</p>
</dd>
<dt><code>glm_Festuca_pratensis_sl</code></dt><dd><p>GLM model for the species Festuca_pratensis_sl.</p>
</dd>
<dt><code>gbm_Bromus_erectus_sstr</code></dt><dd><p>GBM model for the species Bromus_erectus_sstr.</p>
</dd>
<dt><code>glm_Saxifraga_oppositifolia</code></dt><dd><p>GLM model for the species Saxifraga_oppositifolia.</p>
</dd>
<dt><code>glm_Daucus_carota</code></dt><dd><p>GLM model for the species Daucus_carota.</p>
</dd>
<dt><code>glm_Pritzelago_alpina_sstr</code></dt><dd><p>GLM model for the species Pritzelago_alpina_sstr.</p>
</dd>
<dt><code>glm_Bromus_erectus_sstr</code></dt><dd><p>GLM model for the species Bromus_erectus_sstr.</p>
</dd>
<dt><code>gbm_Saxifraga_oppositifolia</code></dt><dd><p>GBM model for the species Saxifraga_oppositifolia.</p>
</dd>
<dt><code>gbm_Daucus_carota</code></dt><dd><p>GBM model for the species Daucus_carota.</p>
</dd>
<dt><code>gbm_Pritzelago_alpina_sstr</code></dt><dd><p>GBM model for the species Pritzelago_alpina_sstr.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The study area is the Western Swiss Alps of Canton de Vaud, Switzerland.
</p>
<p>Five topo-climatic explanatory variables to calibrate the SDMs: growing degree days (with a 0 degrees Celsius threshold); moisture index over the growing season (average values for June to August in mm day-1); slope (in degrees); topographic position (an integrated and unitless measure of topographic exposure; Zimmermann et al., 2007); and the annual sum of radiation (in kJ m-2 year-1). The spatial resolution of the predictor is 25 m x 25 m so that the models could capture most of the small-scale variations of the climatic factors in the mountainous areas.
</p>
<p>Two modelling techniques were used to produce the SDMs: generalized linear models (GLM; McCullagh &amp; Nelder, 1989; R library 'glm') and generalized boosted models (GBM; Friedman, 2001; R library 'gbm'). The SDMs correpond to 20 species: Agrostis_capillaris, Leontodon_hispidus_sl, Dactylis_glomerata, Trifolium_repens_sstr, Geranium_sylvaticum, Ranunculus_acris_sl, Prunella_vulgaris, Veronica_chamaedrys, Taraxacum_officinale_aggr, Plantago_lanceolata, Potentilla_erecta, Carex_sempervirens, Soldanella_alpina, Cynosurus_cristatus, Campanula_scheuchzeri, Festuca_pratensis_sl, Daucus_carota, Pritzelago_alpina_sstr, Bromus_erectus_sstr and Saxifraga_oppositifolia.</p>


<h3>Author(s)</h3>

<p>Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a>, Anne Dubuis <a href="mailto:anne.dubuis@gmail.com">anne.dubuis@gmail.com</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>
</p>


<h3>References</h3>

<p>Guisan, A. 1997. Distribution de taxons vegetaux dans un environnement alpin: Application de modelisations statistiques dans un systeme d'information geographique. PhD Thesis, University of Geneva, Switzerland.
</p>
<p>Guisan, A., J.P. Theurillat. and F. Kienast. 1998. Predicting the potential distribution of plant species in an alpine environment. <em>Journal of Vegetation Science</em>, <b>9</b>, 65-74.
</p>
<p>Guisan, A. and J.P. Theurillat. 2000. Assessing alpine plant vulnerability to climate change: A modeling perspective. <em>Integrated Assessment</em>, <b>1</b>, 307-320.
</p>
<p>Guisan, A. and J.P. Theurillat. 2000. Equilibrium modeling of alpine plant distribution and climate change : How far can we go? <em>Phytocoenologia</em>, <b>30</b>(3-4), 353-384.
</p>
<p>Dubuis A., J. Pottier, V. Rion, L. Pellissier, J.P. Theurillat and A. Guisan. 2011. Predicting spatial patterns of plant species richness: A comparison of direct macroecological and species stacking approaches. <em>Diversity and Distributions</em>, <b>17</b>, 1122-1131.
</p>
<p>Zimmermann, N.E., T.C. Edwards, G.G Moisen, T.S. Frescino and J.A. Blackard. 2007. Remote sensing-based predictors improve distribution models of rare, early successional and broadleaf tree species in Utah. <em>Journal of Applied Ecology</em> <b>44</b>, 1057-1067.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testData)
str(ecospat.testData)
dim(ecospat.testData)
names(ecospat.testData)
</code></pre>

<hr>
<h2 id='ecospat.testEnv'>Test Environmental SpatRasters for The Ecospat package</h2><span id='topic+ecospat.testEnv'></span>

<h3>Description</h3>

<p>A stack of 5 topoclimatic SpatRasters at 250m resolution for the Western Swiss Alps. It includes &quot;ddeg0&quot; (growing degree-days above 0C), &quot;mind68&quot; (moisture index for month June to August),  &quot;srad68&quot; (solar radiation for month June to August), &quot;slope25&quot; (average of slopes at 25m resolution) and &quot;topos25&quot; (average of topographic positions at 25m resolution)</p>


<h3>Format</h3>

<p>ecospat.testEnv is a tif file that contains the following SpatRasters:
</p>
<p>[1] &quot;ddeg0&quot;       
[2] &quot;mind68&quot;      
[3] &quot;srad68&quot;      
[4] &quot;slope25&quot;            
[5] &quot;topos25&quot;
</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Zimmermann, N.E., F. Kienast. 2009. Predictive mapping of alpine grasslands in Switzerland: Species versus community approach. <em>Journal of Vegetation Science</em>, <b>10</b>, 469-482.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(terra)
fpath &lt;- system.file("extdata", "ecospat.testEnv.tif", package="ecospat")
env&lt;-terra::rast(fpath)
plot(env)

## End(Not run)

</code></pre>

<hr>
<h2 id='ecospat.testMdr'>Test Data For The ecospat.mdr function</h2><span id='topic+ecospat.testMdr'></span>

<h3>Description</h3>

<p>Data frame that contains presence records the species <code>Centaurea stoebe</code> along years in North America.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ecospat.testMdr")</code></pre>


<h3>Format</h3>

<p>A data frame with 102 observations of <code>Centaurea stoebe</code>.
</p>

<dl>
<dt><code>latitude</code></dt><dd><p>Latitude, in WGS coordinate system.</p>
</dd>
<dt><code>longitude</code></dt><dd><p>Longitude, in WGS coordinate system.</p>
</dd>
<dt><code>date</code></dt><dd><p>Year of the presence record.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Simplified dataset to exemplify the use of the ecospat.mdr function to calculate minimum dispersal routes.
</p>


<h3>Author(s)</h3>

<p>Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a>
</p>


<h3>References</h3>

<p>Broennimann, O., P. Mraz, B. Petitpierre, A. Guisan, and H. Muller-Scharer. 2014. Contrasting spatio-temporal climatic niche dynamics during the eastern and western invasions of spotted knapweed in North America.<em>Journal of biogeography</em>, <b>41</b>, 1126-1136.
</p>
<p>Hordijk, W. and O. Broennimann. 2012. Dispersal routes reconstruction and the minimum cost arborescence problem. <em>Journal of theoretical biology</em>, <b>308</b>, 115-122.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testMdr)
str(ecospat.testMdr)
dim(ecospat.testMdr)
</code></pre>

<hr>
<h2 id='ecospat.testNiche'>Test Data For The Niche Overlap Analysis</h2><span id='topic+ecospat.testNiche'></span>

<h3>Description</h3>

<p>Data frame that contains occurrence sites for each species, long, lat and the name of the species at each site.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecospat.testNiche)</code></pre>


<h3>Format</h3>

<p>ecospat.testNiche is a data frame with the following columns:
</p>

<dl>
<dt><code>species</code></dt><dd><p>sp1, sp2, sp3 and sp4.</p>
</dd>
<dt><code>long</code></dt><dd><p>Longitude, in Swiss plane coordinate system of the vegetation plot.</p>
</dd>
<dt><code>lat</code></dt><dd><p>Latitude, in Swiss plane coordinate system of the vegetation plot.</p>
</dd>
<dt><code>Spp</code></dt><dd><p>Scientific name of the species used in the exmaple: Bromus_erectus_sstr, Saxifraga_oppositifolia, Daucus_carota and Pritzelago_alpina_sstr.</p>
</dd>
</dl>



<h3>Details</h3>

<p>List of occurence sites for the species.
</p>


<h3>Author(s)</h3>

<p>Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a>, Anne Dubuis <a href="mailto:anne.dubuis@gmail.com">anne.dubuis@gmail.com</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.testData">ecospat.testData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testNiche)
dim(ecospat.testNiche)
names(ecospat.testNiche)
</code></pre>

<hr>
<h2 id='ecospat.testNiche.inv'>Test Data For The Niche Dynamics Analysis In The Invaded Range Of A Hypothetical Species</h2><span id='topic+ecospat.testNiche.inv'></span>

<h3>Description</h3>

<p>Data frame that contains geographical coordinates, environmental variables, occurrence sites for the studied species and the prediction of its distribution in the invaded range. These predictions are provided by SDM calibrated on the native range.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecospat.testNiche.inv)</code></pre>


<h3>Format</h3>

<p>ecospat.testNiche.inv is a data frame with the following columns:
</p>

<dl>
<dt><code>x</code></dt><dd><p>Longitude, in WGS84 coordinate system of the species occurrence.</p>
</dd>
<dt><code>y</code></dt><dd><p>Latitude, in WGS84 coordinate system of the species occurrence.</p>
</dd>
<dt><code>aetpet</code></dt><dd><p>Ratio of actual to potential evapotranspiration.</p>
</dd>
<dt><code>gdd</code></dt><dd><p>Growing degree-days above 5 degrees C.</p>
</dd>
<dt><code>p</code></dt><dd><p>Annual amount of precipitations.</p>
</dd>
<dt><code>pet</code></dt><dd><p>Potential evapotranspiration.</p>
</dd>
<dt><code>stdp</code></dt><dd><p>Annual variation of precipitations.</p>
</dd>
<dt><code>tmax</code></dt><dd><p>Maximum temperature of the warmest month.</p>
</dd>
<dt><code>tmin</code></dt><dd><p>Minimum temperature of the coldest month.</p>
</dd>
<dt><code>tmp</code></dt><dd><p>Annual mean temperature.</p>
</dd>
<dt><code>species_occ</code></dt><dd><p>Presence records of the species occurrence.</p>
</dd>
<dt><code>predictions</code></dt><dd><p>Species Distribution Model predictions of the studied species.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The study area is Australia, which is the invaded range of the hypothetical species.
</p>
<p>Eight topo-climatic explanatory variables to quantify niche differences: ratio of the actual potential evapotranspiration; growing degree days; precipitation; potential evapotranspiration; annual variation of precipitations; maximum temperature of the warmest month; minimum temperature of the coldest month; and annual mean temperature.
</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>
</p>


<h3>References</h3>

<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and A. Guisan. 2012. Climatic niche shifts are rare among terrestrial plant invaders. <em>Science</em>, <b>335</b>, 1344-1348.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.testNiche.nat">ecospat.testNiche.nat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testNiche.inv)
str(ecospat.testNiche.inv)
dim(ecospat.testNiche.inv)
names(ecospat.testNiche.inv)
</code></pre>

<hr>
<h2 id='ecospat.testNiche.nat'>Test Data For The Niche Dynamics Analysis In The Native Range Of A Hypothetical Species</h2><span id='topic+ecospat.testNiche.nat'></span>

<h3>Description</h3>

<p>Data frame that contains geographical coordinates, environmental variables, occurrence sites for the studied species and the prediction of its distribution in the native range. These predictions are provided by SDM calibrated on the native range.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecospat.testNiche.nat)</code></pre>


<h3>Format</h3>

<p>ecospat.testNiche.nat is a data frame with the following columns:
</p>

<dl>
<dt><code>x</code></dt><dd><p>Longitude, in WGS84 coordinate system of the species occurrence.</p>
</dd>
<dt><code>y</code></dt><dd><p>Latitude, in WGS84 coordinate system of the species occurrence.</p>
</dd>
<dt><code>aetpet</code></dt><dd><p>Ratio of actual to potential evapotranspiration.</p>
</dd>
<dt><code>gdd</code></dt><dd><p>Growing degree-days above 5 degrees C.</p>
</dd>
<dt><code>p</code></dt><dd><p>Annual amount of precipitations.</p>
</dd>
<dt><code>pet</code></dt><dd><p>Potential evapotranspiration.</p>
</dd>
<dt><code>stdp</code></dt><dd><p>Annual variation of precipitations.</p>
</dd>
<dt><code>tmax</code></dt><dd><p>Maximum temperature of the warmest month.</p>
</dd>
<dt><code>tmin</code></dt><dd><p>Minimum temperature of the coldest month.</p>
</dd>
<dt><code>tmp</code></dt><dd><p>Annual mean temperature.</p>
</dd>
<dt><code>species_occ</code></dt><dd><p>Presence records of the species occurrence.</p>
</dd>
<dt><code>predictions</code></dt><dd><p>Species Distribution Model predictions of the studied species.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The study area is North America, which is the native range of the hypothetical species.
</p>
<p>Eight topo-climatic explanatory variables to quantify niche differences: ratio of the actual potential evapotranspiration; growing degree days; precipitation; potential evapotranspiration; annual variation of precipitations; maximum temperature of the warmest month; minimum temperature of the coldest month; and annual mean temperature.
</p>


<h3>Author(s)</h3>

<p>Blaise Petitpierre <a href="mailto:bpetitpierre@gmail.com">bpetitpierre@gmail.com</a> and Valeria Di Cola <a href="mailto:valeria.dicola@unil.ch">valeria.dicola@unil.ch</a>
</p>


<h3>References</h3>

<p>Petitpierre, B., C. Kueffer, O. Broennimann, C. Randin, C. Daehler and A. Guisan. 2012. Climatic niche shifts are rare among terrestrial plant invaders. <em>Science</em>, <b>335</b>, 1344-1348.</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecospat.testNiche.inv">ecospat.testNiche.inv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testNiche.nat)
str(ecospat.testNiche.nat)
dim(ecospat.testNiche.nat)
names(ecospat.testNiche.nat)
</code></pre>

<hr>
<h2 id='ecospat.testNichePOSNB'>Test AVS Dataset For The Ecospat package</h2><span id='topic+ecospat.testNichePOSNB'></span>

<h3>Description</h3>

<p>The dataset is contains frequencies of 15 bacterial consortium AVS for 16s site in the Western Swiss Alps along with 4 PCA scores representing environmental axes.</p>


<h3>Format</h3>

<p>ecospat.testTree is a  16 rows (sites) x 18 collumns (14 AVS + 4 PCA axes) dataframe </p>


<h3>Author(s)</h3>

<p>Lucie Malard <a href="mailto:lucie.malard@unil.ch">lucie.malard@unil.ch</a> and Olivier Broennimann <a href="mailto:olivier.broennimann@unil.ch">olivier.broennimann@unil.ch</a></p>


<h3>References</h3>

<p>L.A. Malard, H.K. Mod, N. Guex, O. Broennimann, E. Yashiro, E. Lara, E.D.A. Mitchell, H. Niculita-Hirzel &amp; A. Guisan. The ecological niche of soil bacterial, archaeal, fungal and protist communities along environmental gradients in the Alps. 2021. Accepted in Soil Biology and Biochemistry.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ecospat.testNichePOSNB)
df&lt;-ecospat.testNichePOSNB
ecospat.nichePOSNB(df,colvar=c(2),colfreq = 6:17) # 1 axes
ecospat.nichePOSNB(df,colvar=c(2:3),colfreq = 6:17) # 2 axes
ecospat.nichePOSNB(df,colvar=c(2:5),colfreq = 6:17) # 4 axes #
</code></pre>

<hr>
<h2 id='ecospat.testTree'>Test Tree For The Ecospat package</h2><span id='topic+ecospat.testTree'></span>

<h3>Description</h3>

<p>The tree object is a phylogenetic tree of class 'phylo' (see read.tree) that contains data of 50 angiosperm species from the Western Swiss Alps.</p>


<h3>Format</h3>

<p>ecospat.testTree is a tree contains the following species:
</p>
<p>[1] &quot;Rumex_acetosa&quot;            
[2] &quot;Polygonum_bistorta&quot;       
[3] &quot;Polygonum_viviparum&quot;      
[4] &quot;Rumex_crispus&quot;            
[5] &quot;Cerastium_latifolium&quot;     
[6] &quot;Silene_acaulis&quot;           
[7] &quot;Gypsophila_repens&quot;        
[8] &quot;Vaccinium_gaultherioides&quot; 
[9] &quot;Soldanella_alpina&quot;        
[10] &quot;Cruciata_laevipes&quot;        
[11] &quot;Galium_album&quot;             
[12] &quot;Galium_anisophyllon&quot;      
[13] &quot;Galium_megalospermum&quot;     
[14] &quot;Gentiana_verna&quot;           
[15] &quot;Gentiana_bavarica&quot;        
[16] &quot;Gentiana_purpurea&quot;        
[17] &quot;Gentiana_lutea&quot;           
[18] &quot;Bartsia_alpina&quot;           
[19] &quot;Rhinanthus_alectorolophus&quot;
[20] &quot;Prunella_grandiflora&quot;     
[21] &quot;Acinos_alpinus&quot;           
[22] &quot;Plantago_alpina&quot;          
[23] &quot;Plantago_lanceolata&quot;      
[24] &quot;Veronica_officinalis&quot;     
[25] &quot;Veronica_aphylla&quot;         
[26] &quot;Veronica_alpina&quot;          
[27] &quot;Veronica_chamaedrys&quot;      
[28] &quot;Veronica_persica&quot;         
[29] &quot;Globularia_cordifolia&quot;    
[30] &quot;Globularia_nudicaulis&quot;    
[31] &quot;Myosotis_alpestris&quot;       
[32] &quot;Myosotis_arvensis&quot;        
[33] &quot;Aposeris_foetida&quot;         
[34] &quot;Centaurea_montana&quot;        
[35] &quot;Hieracium_lactucella&quot;     
[36] &quot;Leontodon_helveticus&quot;     
[37] &quot;Leontodon_autumnalis&quot;     
[38] &quot;Hypochaeris_radicata&quot;     
[39] &quot;Achillea_atrata&quot;          
[40] &quot;Achillea_millefolium&quot;     
[41] &quot;Homogyne_alpina&quot;          
[42] &quot;Senecio_doronicum&quot;        
[43] &quot;Adenostyles_glabra&quot;       
[44] &quot;Arnica_montana&quot;           
[45] &quot;Aster_bellidiastrum&quot;      
[46] &quot;Bellis_perennis&quot;          
[47] &quot;Doronicum_grandiflorum&quot;   
[48] &quot;Phyteuma_orbiculare&quot;      
[49] &quot;Phyteuma_spicatum&quot;        
[50] &quot;Campanula_rotundifolia&quot; 
</p>


<h3>Author(s)</h3>

<p>Charlotte Ndiribe <a href="mailto:charlotte.ndiribe@unil.ch">charlotte.ndiribe@unil.ch</a>, Nicolas Salamin <a href="mailto:nicolas.salamin@unil.ch">nicolas.salamin@unil.ch</a> and Antoine Guisan <a href="mailto:antoine.guisan@unil.ch">antoine.guisan@unil.ch</a>
</p>


<h3>References</h3>

<p>Ndiribe, C., L. Pellissier, S. Antonelli, A. Dubuis, J. Pottier, P. Vittoz, A. Guisan and N. Salamin. 2013. Phylogenetic plant community structure along elevation is lineage specific. <em>Ecology and Evolution</em>, <b>3</b>, 4925-4939.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("ape",quietly=TRUE)){
  fpath &lt;- system.file("extdata", "ecospat.testTree.tre", package="ecospat")
  tree &lt;- ape::read.tree(fpath)
  plot(tree)
}

</code></pre>

<hr>
<h2 id='ecospat.varpart'>Variation Partitioning For GLM Or GAM</h2><span id='topic+ecospat.varpart'></span>

<h3>Description</h3>

<p>Perform variance partitioning for binomial GLM or GAM based on the deviance of two groups or predicting variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecospat.varpart (model.1, model.2, model.12)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecospat.varpart_+3A_model.1">model.1</code></td>
<td>
<p>GLM / GAM calibrated on the first group of variables.</p>
</td></tr>
<tr><td><code id="ecospat.varpart_+3A_model.2">model.2</code></td>
<td>
<p>GLM / GAM calibrated on the second group of variables.</p>
</td></tr>
<tr><td><code id="ecospat.varpart_+3A_model.12">model.12</code></td>
<td>
<p>GLM / GAM calibrated on all variables from the two groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deviance is calculated with the adjusted geometric mean squared improvement rescaled for a maximum of 1.</p>


<h3>Value</h3>

<p>Return the four fractions of deviance as in Randin et al. 2009: partial deviance of model 1 and 2, joined deviance and unexplained deviance.</p>


<h3>Author(s)</h3>

<p>Christophe Randin <a href="mailto:christophe.randin@unibas.ch">christophe.randin@unibas.ch</a>, Helene Jaccard and Nigel Gilles Yoccoz</p>


<h3>References</h3>

<p>Randin, C.F., H. Jaccard, P. Vittoz, N.G. Yoccoz and A. Guisan. 2009. Land use improves spatial predictions of mountain plant abundance but not presence-absence. <em>Journal of Vegetation Science</em>, <b>20</b>, 996-1008.</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("rms",quietly=TRUE)){
  data('ecospat.testData')

  # data for Soldanella alpina and Achillea millefolium
  data.Solalp&lt;- ecospat.testData[c("Soldanella_alpina","ddeg","mind","srad","slp","topo")]

  # glm models for Soldanella alpina

  glm.Solalp1 &lt;- glm("Soldanella_alpina ~ pol(ddeg,2) + pol(mind,2) + pol(srad,2)", 
                  data = data.Solalp, family = binomial)
  glm.Solalp2 &lt;- glm("Soldanella_alpina ~ pol(slp,2) + pol(topo,2)", 
                  data = data.Solalp, family = binomial)
                  
  ecospat.varpart (model.1= glm.Solalp1, model.2= glm.Solalp2, model.12= glm.Solalp2)
}


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
