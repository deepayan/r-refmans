<!DOCTYPE html><html><head><title>Help for package REDCapTidieR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REDCapTidieR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_event_mapping'><p>Supplement a supertibble from a longitudinal database with information about</p>
the events associated with each instrument</a></li>
<li><a href='#add_labelled_xlsx_features'><p>Add labelled features to write_redcap_xlsx</p></a></li>
<li><a href='#add_metadata'><p>Supplement a supertibble with additional metadata fields</p></a></li>
<li><a href='#add_metadata_sheet'><p>Add the metadata sheet</p></a></li>
<li><a href='#add_partial_keys'><p>Add partial key helper variables to dataframes</p></a></li>
<li><a href='#add_skimr_metadata'><p>Add skimr metrics to a supertibble's metadata</p></a></li>
<li><a href='#add_supertbl_toc'><p>Add the supertbl table of contents sheet</p></a></li>
<li><a href='#apply_labs_factor'><p>Apply factor labels to a vector</p></a></li>
<li><a href='#apply_labs_haven'><p>Apply haven value labels to a vector</p></a></li>
<li><a href='#as_supertbl'><p>Add supertbl S3 class</p></a></li>
<li><a href='#bind_supertbl_metadata'><p>Bind supertbl metadata</p></a></li>
<li><a href='#bind_tibbles'><p>Extract data tibbles from a REDCapTidieR supertibble and bind them to an</p>
environment</a></li>
<li><a href='#calc_metadata_stats'><p>Utility function to calculate summary for each tibble in a supertibble</p></a></li>
<li><a href='#check_data_arg_exists'><p>Check requested data argument exists in REDCap data</p></a></li>
<li><a href='#check_extra_field_values'><p>Check data field for field values not in metadata</p></a></li>
<li><a href='#check_field_is_logical'><p>Parse logical field and compile data for warning if parsing errors occurred</p></a></li>
<li><a href='#check_file_exists'><p>Check if file already exists</p></a></li>
<li><a href='#check_forms_exist'><p>Check that all requested instruments are in REDCap project metadata</p></a></li>
<li><a href='#check_labelled'><p>Check if labelled</p></a></li>
<li><a href='#check_parsed_labels'><p>Check that parsed labels are not duplicated</p></a></li>
<li><a href='#check_redcap_populated'><p>Check that a supplied REDCap database is populated</p></a></li>
<li><a href='#check_repeat_and_nonrepeat'><p>Check for instruments that have both repeating and non-repeating structure</p></a></li>
<li><a href='#check_req_labelled_metadata_fields'><p>Check that all metadata tibbles within a supertibble contain</p>
<code>field_name</code> and <code>field_label</code> columns</a></li>
<li><a href='#check_user_rights'><p>Check for possible API user privilege issues</p></a></li>
<li><a href='#checkmate'><p>Check an argument with checkmate</p></a></li>
<li><a href='#clean_redcap'><p>Extract non-longitudinal REDCap databases into tidy tibbles</p></a></li>
<li><a href='#clean_redcap_long'><p>Extract longitudinal REDCap databases into tidy tibbles</p></a></li>
<li><a href='#convert_mixed_instrument'><p>Convert Mixed Structure Instruments to Repeating Instruments</p></a></li>
<li><a href='#create_repeat_instance_vars'><p>Utility function to convert redcap repeat instance columns into appropriate</p>
form and event columns</a></li>
<li><a href='#db_has_repeat_forms'><p>Check whether a REDCap database has repeat forms</p></a></li>
<li><a href='#distill_nonrepeat_table'><p>Extract non-repeat tables from non-longitudinal REDCap databases</p></a></li>
<li><a href='#distill_nonrepeat_table_long'><p>Extract non-repeat tables from longitudinal REDCap databases</p></a></li>
<li><a href='#distill_repeat_table'><p>Extract repeat tables from non-longitudinal REDCap databases</p></a></li>
<li><a href='#distill_repeat_table_long'><p>Extract repeat tables from longitudinal REDCap databases</p></a></li>
<li><a href='#extract_tibble'><p>Extract a single data tibble from a REDCapTidieR supertibble</p></a></li>
<li><a href='#extract_tibbles'><p>Extract data tibbles from a REDCapTidieR supertibble into a list</p></a></li>
<li><a href='#format_error_val'><p>Format value for error message</p></a></li>
<li><a href='#format-helpers'><p>Format REDCap variable labels</p></a></li>
<li><a href='#get_fields_to_drop'><p>Determine fields included in <code>REDCapR::redcap_read_oneshot</code> output</p>
that should be dropped from results of <code>read_redcap</code></a></li>
<li><a href='#get_mixed_structure_fields'><p>Get Mixed Structure Instrument List</p></a></li>
<li><a href='#get_record_id_field'><p>Utility function to extract the name of the project identifier field for</p>
a tibble of REDCap data</a></li>
<li><a href='#invert_vec'><p>Swap vector names for values</p></a></li>
<li><a href='#is_labelled'><p>Determine if an object is labelled</p></a></li>
<li><a href='#link_arms'><p>Link longitudinal REDCap instruments with their events/arms</p></a></li>
<li><a href='#make_labelled'><p>Apply variable labels to a REDCapTidieR supertibble</p></a></li>
<li><a href='#make_skimr_labels'><p>Make skimr labels from default skimr outputs</p></a></li>
<li><a href='#multi_choice_to_labels'><p>Update multiple choice fields with label data</p></a></li>
<li><a href='#parse_labels'><p>Parse labels from REDCap metadata into usable formats</p></a></li>
<li><a href='#parse_logical_cols'><p>Convert yesno, truefalse, and checkbox fields to logical</p></a></li>
<li><a href='#read_redcap'><p>Import a REDCap database into a tidy supertibble</p></a></li>
<li><a href='#REDCapTidieR-package'><p>REDCapTidieR: Extract 'REDCap' Databases into Tidy 'Tibble's</p></a></li>
<li><a href='#release_questions'><p>Additional release questions</p></a></li>
<li><a href='#remove_empty_rows'><p>Remove rows with empty data</p></a></li>
<li><a href='#resolve_formatter'><p>Convert user input into label formatting function</p></a></li>
<li><a href='#safe_set_variable_labels'><p>Safely set variable labels</p></a></li>
<li><a href='#skim_data'><p>Apply applicable skimmers to data</p></a></li>
<li><a href='#strip_html_field_embedding'><p>Remove html tags and field embedding logic from a string</p></a></li>
<li><a href='#superheroes_supertbl'><p>Superheroes Data</p></a></li>
<li><a href='#supertbl_recode'><p>Recode fields using supertbl metadata</p></a></li>
<li><a href='#tbl_sum.redcap_supertbl'><p>Provide a succinct summary of an object</p></a></li>
<li><a href='#try_redcapr'><p>Make a <code>REDCapR</code> API call with custom error handling</p></a></li>
<li><a href='#update_data_col_names'><p>Correctly label variables belonging to checkboxes with minus signs</p></a></li>
<li><a href='#update_field_names'><p>Update metadata field names for checkbox handling</p></a></li>
<li><a href='#vec_ptype_abbr.redcap_supertbl'><p>Vector type as a string</p></a></li>
<li><a href='#write_redcap_xlsx'><p>Write Supertibbles to XLSX</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extract 'REDCap' Databases into Tidy 'Tibble's</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Convert 'REDCap' exports into tidy tables for easy handling of 'REDCap' repeat instruments and event arms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://chop-cgtinformatics.github.io/REDCapTidieR/">https://chop-cgtinformatics.github.io/REDCapTidieR/</a>,
<a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR">https://github.com/CHOP-CGTInformatics/REDCapTidieR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/issues">https://github.com/CHOP-CGTInformatics/REDCapTidieR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cli, dplyr, lobstr, lubridate, purrr, REDCapR (&ge;
1.1.0), rlang, stringi, stringr, tibble, tidyr, tidyselect,
formattable, pillar, vctrs, readr, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, labelled, lintr, openxlsx2 (&ge; 0.8),
prettyunits, rmarkdown, skimr, testthat (&ge; 3.0.0), withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-27 15:59:30 UTC; hannar1</td>
</tr>
<tr>
<td>Author:</td>
<td>Richard Hanna <a href="https://orcid.org/0009-0005-6496-8154"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Stephan Kadauke <a href="https://orcid.org/0000-0003-2996-8034"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Ezra Porter <a href="https://orcid.org/0000-0002-4690-8343"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Richard Hanna &lt;richardshanna91@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 08:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_event_mapping'>Supplement a supertibble from a longitudinal database with information about
the events associated with each instrument</h2><span id='topic+add_event_mapping'></span>

<h3>Description</h3>

<p>Supplement a supertibble from a longitudinal database with information about
the events associated with each instrument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_event_mapping(supertbl, linked_arms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_event_mapping_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble object to supplement with metadata</p>
</td></tr>
<tr><td><code id="add_event_mapping_+3A_linked_arms">linked_arms</code></td>
<td>
<p>the tibble with event mappings created by
<code>link_arms()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original supertibble with an events <code>redcap_events</code> list column
containing arms and events associated with each instrument
</p>

<hr>
<h2 id='add_labelled_xlsx_features'>Add labelled features to write_redcap_xlsx</h2><span id='topic+add_labelled_xlsx_features'></span>

<h3>Description</h3>

<p>Helper function to support <code>labelled</code> aesthetics to XLSX supertibble output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_labelled_xlsx_features(
  supertbl,
  supertbl_meta,
  wb,
  sheet_vals,
  include_toc_sheet = TRUE,
  include_metadata_sheet = TRUE,
  supertbl_toc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_labelled_xlsx_features_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_supertbl_meta">supertbl_meta</code></td>
<td>
<p>supertibble metadata generated by <code>bind_supertbl_metadata()</code></p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_wb">wb</code></td>
<td>
<p>An <code>openxlsx2</code> workbook object</p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_sheet_vals">sheet_vals</code></td>
<td>
<p>Helper argument passed from <code>write_redcap_xlsx</code> to
determine and assign sheet values.</p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_include_toc_sheet">include_toc_sheet</code></td>
<td>
<p>Include a sheet capturing the supertibble output.
Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_include_metadata_sheet">include_metadata_sheet</code></td>
<td>
<p>Include a sheet capturing the combined output of the
supertibble <code>redcap_metadata</code>. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="add_labelled_xlsx_features_+3A_supertbl_toc">supertbl_toc</code></td>
<td>
<p>The table of contents supertibble defined in the parent
function. Default <code>NULL</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='add_metadata'>Supplement a supertibble with additional metadata fields</h2><span id='topic+add_metadata'></span>

<h3>Description</h3>

<p>Supplement a supertibble with additional metadata fields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_metadata(
  supertbl,
  db_metadata,
  redcap_uri,
  token,
  suppress_redcapr_messages
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_metadata_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble object to supplement with metadata</p>
</td></tr>
<tr><td><code id="add_metadata_+3A_db_metadata">db_metadata</code></td>
<td>
<p>a REDCap metadata tibble</p>
</td></tr>
<tr><td><code id="add_metadata_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The
URI/URL of the REDCap server (e.g.,
&quot;https://server.org/apps/redcap/api/&quot;). Required.</p>
</td></tr>
<tr><td><code id="add_metadata_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project. Required.</p>
</td></tr>
<tr><td><code id="add_metadata_+3A_suppress_redcapr_messages">suppress_redcapr_messages</code></td>
<td>
<p>A logical to control whether to suppress messages
from REDCapR API calls. Default <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that <code>db_metadata</code> has been processed to
include a row for each option of each multiselection field, i.e. with
<code>update_field_names()</code>
</p>


<h3>Value</h3>

<p>The original supertibble with additional fields:
</p>

<ul>
<li> <p><code>instrument_label</code> containing labels for each instrument
</p>
</li>
<li> <p><code>redcap_metadata</code> containing metadata for the fields in each
instrument as a list column
</p>
</li></ul>


<hr>
<h2 id='add_metadata_sheet'>Add the metadata sheet</h2><span id='topic+add_metadata_sheet'></span>

<h3>Description</h3>

<p>Internal helper function. Adds appropriate elements to <code>wb</code> object. Returns
a dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_metadata_sheet(
  supertbl,
  supertbl_meta,
  wb,
  add_labelled_column_headers,
  table_style,
  column_width,
  na_replace
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_metadata_sheet_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_supertbl_meta">supertbl_meta</code></td>
<td>
<p>an <code>unnest</code>-ed metadata tibble from the supertibble</p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_wb">wb</code></td>
<td>
<p>An <code>openxlsx2</code> workbook object</p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_add_labelled_column_headers">add_labelled_column_headers</code></td>
<td>
<p>Whether or not to include labelled outputs.</p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_table_style">table_style</code></td>
<td>
<p>Any excel table style name or &quot;none&quot; (see &quot;formatting&quot;
vignette in <a href="openxlsx2.html#topic+wb_add_data_table">wb_add_data_table</a>). Default &quot;tableStyleLight8&quot;.</p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_column_width">column_width</code></td>
<td>
<p>Width to set columns across the workbook. Default
&quot;auto&quot;, otherwise a numeric value. Standard Excel is 8.43.</p>
</td></tr>
<tr><td><code id="add_metadata_sheet_+3A_na_replace">na_replace</code></td>
<td>
<p>The value used to replace <code>NA</code> values in <code>supertbl</code>. The default is &quot;&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe
</p>

<hr>
<h2 id='add_partial_keys'>Add partial key helper variables to dataframes</h2><span id='topic+add_partial_keys'></span>

<h3>Description</h3>

<p>Make helper variables <code>redcap_event</code> and <code>redcap_arm</code> available as
branches from <code>var</code> for later use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_partial_keys(db_data, var = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_partial_keys_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="add_partial_keys_+3A_var">var</code></td>
<td>
<p>The unquoted name of the field containing event and arm
identifiers. Default <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two appended columns, <code>redcap_event</code> and <code>redcap_arm</code>
to the end of <code>read_redcap</code> output <code>tibble</code>s.
</p>

<hr>
<h2 id='add_skimr_metadata'>Add <a href="skimr.html#topic+skimr">skimr</a> metrics to a supertibble's metadata</h2><span id='topic+add_skimr_metadata'></span>

<h3>Description</h3>

<p>Add default <a href="skimr.html#topic+skim">skim</a> metrics to the <code>redcap_data</code> list elements of
a supertibble output from <code>read_readcap</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_skimr_metadata(supertbl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_skimr_metadata_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information on the default metrics provided, check the
<a href="skimr.html#topic+get_default_skimmer_names">get_default_skimmer_names</a>
documentation.
</p>


<h3>Value</h3>

<p>A supertibble with <a href="skimr.html#topic+skimr">skimr</a> metadata metrics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>superheroes_supertbl

add_skimr_metadata(superheroes_supertbl)

## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

supertbl &lt;- read_redcap(redcap_uri, token)
add_skimr_metadata(supertbl)

## End(Not run)

</code></pre>

<hr>
<h2 id='add_supertbl_toc'>Add the supertbl table of contents sheet</h2><span id='topic+add_supertbl_toc'></span>

<h3>Description</h3>

<p>Internal helper function. Adds appropriate elements to <code>wb</code> object. Returns
a dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_supertbl_toc(
  wb,
  supertbl,
  include_metadata_sheet,
  add_labelled_column_headers,
  table_style,
  column_width,
  na_replace
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_supertbl_toc_+3A_wb">wb</code></td>
<td>
<p>An <code>openxlsx2</code> workbook object</p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_include_metadata_sheet">include_metadata_sheet</code></td>
<td>
<p>Include a sheet capturing the combined output of the
supertibble <code>redcap_metadata</code>.</p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_add_labelled_column_headers">add_labelled_column_headers</code></td>
<td>
<p>Whether or not to include labelled outputs.</p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_table_style">table_style</code></td>
<td>
<p>Any excel table style name or &quot;none&quot; (see &quot;formatting&quot;
vignette in <a href="openxlsx2.html#topic+wb_add_data_table">wb_add_data_table</a>). Default &quot;tableStyleLight8&quot;.</p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_column_width">column_width</code></td>
<td>
<p>Width to set columns across the workbook. Default
&quot;auto&quot;, otherwise a numeric value. Standard Excel is 8.43.</p>
</td></tr>
<tr><td><code id="add_supertbl_toc_+3A_na_replace">na_replace</code></td>
<td>
<p>The value used to replace <code>NA</code> values in <code>supertbl</code>. The default is &quot;&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe
</p>

<hr>
<h2 id='apply_labs_factor'>Apply factor labels to a vector</h2><span id='topic+apply_labs_factor'></span>

<h3>Description</h3>

<p>Apply factor labels to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_labs_factor(x, labels, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_labs_factor_+3A_x">x</code></td>
<td>
<p>a vector to label</p>
</td></tr>
<tr><td><code id="apply_labs_factor_+3A_labels">labels</code></td>
<td>
<p>a named vector of labels in the format <code>c(value = label)</code></p>
</td></tr>
<tr><td><code id="apply_labs_factor_+3A_...">...</code></td>
<td>
<p>unused, needed to ignore extra arguments that may be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dots are needed to ignore <code>ptype</code> argument that may be passed to <code>apply_labs_haven</code>
</p>


<h3>Value</h3>

<p>factor
</p>

<hr>
<h2 id='apply_labs_haven'>Apply haven value labels to a vector</h2><span id='topic+apply_labs_haven'></span>

<h3>Description</h3>

<p>Apply haven value labels to a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_labs_haven(x, labels, ptype, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_labs_haven_+3A_x">x</code></td>
<td>
<p>a vector to label</p>
</td></tr>
<tr><td><code id="apply_labs_haven_+3A_labels">labels</code></td>
<td>
<p>a named vector of labels in the format <code>c(value = label)</code></p>
</td></tr>
<tr><td><code id="apply_labs_haven_+3A_ptype">ptype</code></td>
<td>
<p>vector to serve as prototype for label values</p>
</td></tr>
<tr><td><code id="apply_labs_haven_+3A_...">...</code></td>
<td>
<p>unused, needed to ignore extra arguments that may be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes a check_installed() has been run for <code>labelled</code>. Since <code>haven</code> preserves the
underlying data values we need to make sure the data type of the value options in the metadata matches
the data type of the values in the actual data. This function accepts a prototype, usually a column
from db_data, and uses <code>force_cast()</code> to do a best-effort casting of the value options in the metadata
to the same data type as <code>ptype</code>. The fallback is to convert <code>x</code> and the value labels to character.
</p>


<h3>Value</h3>

<p><code>haven_labelled</code> vector
</p>

<hr>
<h2 id='as_supertbl'>Add supertbl S3 class</h2><span id='topic+as_supertbl'></span>

<h3>Description</h3>

<p>Add supertbl S3 class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_supertbl(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_supertbl_+3A_x">x</code></td>
<td>
<p>an object to class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The object with <code>redcaptidier_supertbl</code> S3 class
</p>

<hr>
<h2 id='bind_supertbl_metadata'>Bind supertbl metadata</h2><span id='topic+bind_supertbl_metadata'></span>

<h3>Description</h3>

<p>Simple helper function for binding supertbl metadata into one table. This
supports creating the metadata XLSX sheet as well as <code>supertbl_recode</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_supertbl_metadata(supertbl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind_supertbl_metadata_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated using <code>read_redcap()</code></p>
</td></tr>
</table>

<hr>
<h2 id='bind_tibbles'>Extract data tibbles from a REDCapTidieR supertibble and bind them to an
environment</h2><span id='topic+bind_tibbles'></span>

<h3>Description</h3>

<p>Take a supertibble generated with <code>read_redcap()</code>
and bind its data tibbles (i.e. the tibbles in the <code>redcap_data</code> column) to
an environment. The default is the global environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_tibbles(supertbl, environment = global_env(), tbls = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind_tibbles_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated by <code>read_redcap()</code>. Required.</p>
</td></tr>
<tr><td><code id="bind_tibbles_+3A_environment">environment</code></td>
<td>
<p>The environment to bind the tibbles to. Default is
<code>rlang::global_env()</code>.</p>
</td></tr>
<tr><td><code id="bind_tibbles_+3A_tbls">tbls</code></td>
<td>
<p>A vector of the <code>redcap_form_name</code>s of the data tibbles to bind to
the environment. Default is <code>NULL</code> which binds all data tibbles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns nothing as it's used solely for its side effect of
modifying an environment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create an empty environment
my_env &lt;- new.env()

ls(my_env)

superheroes_supertbl

bind_tibbles(superheroes_supertbl, my_env)

ls(my_env)

## End(Not run)
</code></pre>

<hr>
<h2 id='calc_metadata_stats'>Utility function to calculate summary for each tibble in a supertibble</h2><span id='topic+calc_metadata_stats'></span>

<h3>Description</h3>

<p>Utility function to calculate summary for each tibble in a supertibble
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_metadata_stats(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_metadata_stats_+3A_data">data</code></td>
<td>
<p>a tibble of redcap data stored in the <code>redcap_data</code> column
of a supertibble</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>data_rows</code>, the number of rows in the data
</p>
</li>
<li> <p><code>data_cols</code>, the number of columns in the data
</p>
</li>
<li> <p><code>data_size</code>, the size of the data in bytes
</p>
</li>
<li> <p><code>data_na_pct</code>, the percentage of cells that are NA excluding
identifiers and form completion fields
</p>
</li></ul>


<hr>
<h2 id='check_data_arg_exists'>Check requested data argument exists in REDCap data</h2><span id='topic+check_data_arg_exists'></span>

<h3>Description</h3>

<p>Provide an error message when an argument is requested, but is not found in
any <code>read_redcap()</code> <code>redcap_data</code> output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_data_arg_exists(db_data, col, arg, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_data_arg_exists_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="check_data_arg_exists_+3A_col">col</code></td>
<td>
<p>The column to check for in <code>redcap_data</code></p>
</td></tr>
<tr><td><code id="check_data_arg_exists_+3A_arg">arg</code></td>
<td>
<p>The argument used for the column check</p>
</td></tr>
<tr><td><code id="check_data_arg_exists_+3A_call">call</code></td>
<td>
<p>The calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently used for the following arguments:
</p>

<ul>
<li><p><code>export_survey_fields</code>: <code style="white-space: pre;">&#8288;*_timestamp&#8288;</code>
</p>
</li>
<li><p><code>export_data_access_groups</code>: <code>redcap_data_access_group</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An error message saying the requested data does not exist
</p>

<hr>
<h2 id='check_extra_field_values'>Check data field for field values not in metadata</h2><span id='topic+check_extra_field_values'></span>

<h3>Description</h3>

<p>Check data field for field values not in metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_extra_field_values(x, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_extra_field_values_+3A_x">x</code></td>
<td>
<p>data field</p>
</td></tr>
<tr><td><code id="check_extra_field_values_+3A_values">values</code></td>
<td>
<p>expected field values</p>
</td></tr>
</table>

<hr>
<h2 id='check_field_is_logical'>Parse logical field and compile data for warning if parsing errors occurred</h2><span id='topic+check_field_is_logical'></span>

<h3>Description</h3>

<p>Parse logical field and compile data for warning if parsing errors occurred
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_field_is_logical(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_field_is_logical_+3A_x">x</code></td>
<td>
<p>vector to parse</p>
</td></tr>
</table>

<hr>
<h2 id='check_file_exists'>Check if file already exists</h2><span id='topic+check_file_exists'></span>

<h3>Description</h3>

<p>Provide an error message when a file is declared for writing that already
exists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_file_exists(file, overwrite, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_file_exists_+3A_file">file</code></td>
<td>
<p>The file that is being checked</p>
</td></tr>
<tr><td><code id="check_file_exists_+3A_overwrite">overwrite</code></td>
<td>
<p>Whether the file was declared to be overwritten</p>
</td></tr>
<tr><td><code id="check_file_exists_+3A_call">call</code></td>
<td>
<p>The calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the case of <code>write_redcap_xlsx()</code>, this should only error when a file
already exists and is not declared for <code>overwite</code>.
</p>


<h3>Value</h3>

<p>An error message saying the requested file already exists
</p>

<hr>
<h2 id='check_forms_exist'>Check that all requested instruments are in REDCap project metadata</h2><span id='topic+check_forms_exist'></span>

<h3>Description</h3>

<p>Provide an error message when any instrument names are passed to
<code>read_redcap()</code> that do not exist in the project metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_forms_exist(db_metadata, forms, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_forms_exist_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The metadata file read by
<code>REDCapR::redcap_metadata_read()</code></p>
</td></tr>
<tr><td><code id="check_forms_exist_+3A_forms">forms</code></td>
<td>
<p>The character vector of instrument names passed to
<code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="check_forms_exist_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error message listing the requested instruments that don't exist
</p>

<hr>
<h2 id='check_labelled'>Check if labelled</h2><span id='topic+check_labelled'></span>

<h3>Description</h3>

<p>Checks if a supplied supertibble is labelled and throws an error if it is not
but <code>labelled</code> is set to <code>TRUE</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_labelled(supertbl, add_labelled_column_headers, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_labelled_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="check_labelled_+3A_add_labelled_column_headers">add_labelled_column_headers</code></td>
<td>
<p>Whether or not to include labelled outputs</p>
</td></tr>
<tr><td><code id="check_labelled_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the warning message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean
</p>

<hr>
<h2 id='check_parsed_labels'>Check that parsed labels are not duplicated</h2><span id='topic+check_parsed_labels'></span>

<h3>Description</h3>

<p>Check that parsed labels are not duplicated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_parsed_labels(
  parsed_labels_output,
  field_name,
  warn_stripped_text = FALSE,
  call = caller_env(n = 2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_parsed_labels_+3A_parsed_labels_output">parsed_labels_output</code></td>
<td>
<p>a vector of parsed labels produced by <code>parse_labels()</code></p>
</td></tr>
<tr><td><code id="check_parsed_labels_+3A_field_name">field_name</code></td>
<td>
<p>the name of the field associated with the labels to use in the warning message</p>
</td></tr>
<tr><td><code id="check_parsed_labels_+3A_warn_stripped_text">warn_stripped_text</code></td>
<td>
<p>logical for whether to include a note about HTML tag stripping in the message</p>
</td></tr>
<tr><td><code id="check_parsed_labels_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message. The parent of calling environment
by default because this check usually occurs 2 frames below the relevant context for the user</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a warning message alerting specifying the duplicate labels and REDCap field affected
</p>

<hr>
<h2 id='check_redcap_populated'>Check that a supplied REDCap database is populated</h2><span id='topic+check_redcap_populated'></span>

<h3>Description</h3>

<p>Check for potential outputs where metadata is present, but <code>nrow</code> and
<code>ncol</code> equal <code>0</code>. This causes <code>multi_choice_to_labels</code> to fail, but
a helpful error message should be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_redcap_populated(db_data, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_redcap_populated_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="check_redcap_populated_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A helpful error message alerting the user to check their API privileges.
</p>

<hr>
<h2 id='check_repeat_and_nonrepeat'>Check for instruments that have both repeating and non-repeating structure</h2><span id='topic+check_repeat_and_nonrepeat'></span>

<h3>Description</h3>

<p>Check for potential instruments that are given both repeating and
nonrepeating structure. <code>REDCapTidieR</code> does not support database
structures built this way.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_repeat_and_nonrepeat(db_data, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_repeat_and_nonrepeat_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="check_repeat_and_nonrepeat_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A helpful error message alerting the user to existence of an instrument
that was designated both as repeating and non-repeating.
</p>

<hr>
<h2 id='check_req_labelled_metadata_fields'>Check that all metadata tibbles within a supertibble contain
<code>field_name</code> and <code>field_label</code> columns</h2><span id='topic+check_req_labelled_metadata_fields'></span>

<h3>Description</h3>

<p>Check that all metadata tibbles within a supertibble contain
<code>field_name</code> and <code>field_label</code> columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_req_labelled_metadata_fields(supertbl, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_req_labelled_metadata_fields_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble containing a <code>redcap_metadata</code> column</p>
</td></tr>
<tr><td><code id="check_req_labelled_metadata_fields_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an error message alerting that instrument metadata is incomplete
</p>

<hr>
<h2 id='check_user_rights'>Check for possible API user privilege issues</h2><span id='topic+check_user_rights'></span>

<h3>Description</h3>

<p>Check for potential user access privilege issues and provide an appropriate
warning message. This can occur when metadata forms/field names do not appear
in a database export.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_user_rights(db_data, db_metadata, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_user_rights_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="check_user_rights_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The REDCap metadata output generated by <code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
<tr><td><code id="check_user_rights_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the warning message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A helpful error message alerting the user to check their API privileges.
</p>

<hr>
<h2 id='checkmate'>Check an argument with checkmate</h2><span id='topic+checkmate'></span><span id='topic+check_arg_is_supertbl'></span><span id='topic+check_arg_is_env'></span><span id='topic+check_arg_is_character'></span><span id='topic+check_arg_is_logical'></span><span id='topic+check_arg_choices'></span><span id='topic+check_arg_is_valid_token'></span><span id='topic+check_arg_is_valid_extension'></span>

<h3>Description</h3>

<p>Check an argument with checkmate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_arg_is_supertbl(
  x,
  req_cols = c("redcap_data", "redcap_metadata"),
  arg = caller_arg(x),
  call = caller_env()
)

check_arg_is_env(x, ..., arg = caller_arg(x), call = caller_env())

check_arg_is_character(x, ..., arg = caller_arg(x), call = caller_env())

check_arg_is_logical(x, ..., arg = caller_arg(x), call = caller_env())

check_arg_choices(x, ..., arg = caller_arg(x), call = caller_env())

check_arg_is_valid_token(x, arg = caller_arg(x), call = caller_env())

check_arg_is_valid_extension(
  x,
  valid_extensions,
  arg = caller_arg(x),
  call = caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkmate_+3A_x">x</code></td>
<td>
<p>An object to check</p>
</td></tr>
<tr><td><code id="checkmate_+3A_req_cols">req_cols</code></td>
<td>
<p>required fields for <code>check_arg_is_supertbl()</code></p>
</td></tr>
<tr><td><code id="checkmate_+3A_arg">arg</code></td>
<td>
<p>The name of the argument to include in an error message. Captured
by <code>rlang::caller_arg()</code> by default</p>
</td></tr>
<tr><td><code id="checkmate_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
<tr><td><code id="checkmate_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to checkmate</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if <code>x</code> passes the checkmate check. An error otherwise with the name of
the checkmate function as a <code>class</code>
</p>

<hr>
<h2 id='clean_redcap'>Extract non-longitudinal REDCap databases into tidy tibbles</h2><span id='topic+clean_redcap'></span>

<h3>Description</h3>

<p>Helper function internal to <code>read_redcap</code> responsible for
extraction and final processing of a tidy <code>tibble</code> to the user from
a non-longitudinal REDCap database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_redcap(db_data, db_metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_redcap_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="clean_redcap_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>tibble</code> with list elements containing tidy dataframes. Users
can access dataframes under the <code>redcap_data</code> column with reference to
<code>form_name</code> and <code>structure</code> column details.
</p>

<hr>
<h2 id='clean_redcap_long'>Extract longitudinal REDCap databases into tidy tibbles</h2><span id='topic+clean_redcap_long'></span>

<h3>Description</h3>

<p>Helper function internal to <code>read_redcap</code> responsible for
extraction and final processing of a tidy <code>tibble</code> to the user from
a longitudinal REDCap database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_redcap_long(
  db_data_long,
  db_metadata_long,
  linked_arms,
  allow_mixed_structure = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_redcap_long_+3A_db_data_long">db_data_long</code></td>
<td>
<p>The longitudinal REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="clean_redcap_long_+3A_db_metadata_long">db_metadata_long</code></td>
<td>
<p>The longitudinal REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
<tr><td><code id="clean_redcap_long_+3A_linked_arms">linked_arms</code></td>
<td>
<p>Output of <code>link_arms</code>, linking instruments to REDCap
events/arms</p>
</td></tr>
<tr><td><code id="clean_redcap_long_+3A_allow_mixed_structure">allow_mixed_structure</code></td>
<td>
<p>A logical to allow for support of mixed repeating/non-repeating
instruments. Setting to <code>TRUE</code> will treat the mixed instrument's non-repeating versions
as repeating instruments with a single instance. Applies to longitudinal projects
only. Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>tibble</code> with list elements containing tidy dataframes. Users
can access dataframes under the <code>redcap_data</code> column with reference to
<code>form_name</code> and <code>structure</code> column details.
</p>

<hr>
<h2 id='convert_mixed_instrument'>Convert Mixed Structure Instruments to Repeating Instruments</h2><span id='topic+convert_mixed_instrument'></span>

<h3>Description</h3>

<p>For longitudinal projects where users set <code>allow_mixed_structure</code> to <code>TRUE</code>,
this function will handle the process of setting the nonrepeating parts of the
instrument to repeating ones with a single instance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_mixed_instrument(db_data_long, mixed_structure_ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_mixed_instrument_+3A_db_data_long">db_data_long</code></td>
<td>
<p>The longitudinal REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="convert_mixed_instrument_+3A_mixed_structure_ref">mixed_structure_ref</code></td>
<td>
<p>Reference dataframe containing mixed structure
fields and forms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>tibble</code> with list elements containing tidy dataframes. Users
can access dataframes under the <code>redcap_data</code> column with reference to
<code>form_name</code> and <code>structure</code> column details.
</p>

<hr>
<h2 id='create_repeat_instance_vars'>Utility function to convert redcap repeat instance columns into appropriate
form and event columns</h2><span id='topic+create_repeat_instance_vars'></span>

<h3>Description</h3>

<p>Utility function to convert redcap repeat instance columns into appropriate
form and event columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_repeat_instance_vars(db_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_repeat_instance_vars_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of a standard REDCap export with repeating forms and/or events
makes use of <code>redcap_repeat_instance</code> in combination with
<code>redcap_repeat_instrument</code> and whether or not data exists in both. Instead,
rename and separate <code>redcap_repeat_instance</code> into <code>redcap_form_instance</code> and
<code>redcap_event_instance</code>.
</p>


<h3>Value</h3>

<p>A dataframe.
</p>

<hr>
<h2 id='db_has_repeat_forms'>Check whether a REDCap database has repeat forms</h2><span id='topic+db_has_repeat_forms'></span>

<h3>Description</h3>

<p>Simple utility function checking for the existence of repeat forms in a REDCap
database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>db_has_repeat_forms(db_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="db_has_repeat_forms_+3A_db_data">db_data</code></td>
<td>
<p>A REDCap dataframe.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A boolean.
</p>

<hr>
<h2 id='distill_nonrepeat_table'>Extract non-repeat tables from non-longitudinal REDCap databases</h2><span id='topic+distill_nonrepeat_table'></span>

<h3>Description</h3>

<p>Sub-helper function to <code>clean_redcap</code> for single nonrepeat table
extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distill_nonrepeat_table(form_name, db_data, db_metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distill_nonrepeat_table_+3A_form_name">form_name</code></td>
<td>
<p>The <code>form_name</code> described in the named column from the
REDCap metadata.</p>
</td></tr>
<tr><td><code id="distill_nonrepeat_table_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="distill_nonrepeat_table_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset <code>tibble</code> of all data related to a specified <code>form_name</code>
</p>

<hr>
<h2 id='distill_nonrepeat_table_long'>Extract non-repeat tables from longitudinal REDCap databases</h2><span id='topic+distill_nonrepeat_table_long'></span>

<h3>Description</h3>

<p>Sub-helper function to <code>clean_redcap_long</code> for single nonrepeat table
extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distill_nonrepeat_table_long(
  form_name,
  db_data_long,
  db_metadata_long,
  linked_arms
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distill_nonrepeat_table_long_+3A_form_name">form_name</code></td>
<td>
<p>The <code>form_name</code> described in the named column from the
REDCap metadata.</p>
</td></tr>
<tr><td><code id="distill_nonrepeat_table_long_+3A_db_data_long">db_data_long</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="distill_nonrepeat_table_long_+3A_db_metadata_long">db_metadata_long</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
<tr><td><code id="distill_nonrepeat_table_long_+3A_linked_arms">linked_arms</code></td>
<td>
<p>Output of <code>link_arms</code>, linking instruments to REDCap
events/arms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> of all data related to a specified <code>form_name</code>
</p>

<hr>
<h2 id='distill_repeat_table'>Extract repeat tables from non-longitudinal REDCap databases</h2><span id='topic+distill_repeat_table'></span>

<h3>Description</h3>

<p>Sub-helper function to <code>clean_redcap</code> for single repeat table
extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distill_repeat_table(form_name, db_data, db_metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distill_repeat_table_+3A_form_name">form_name</code></td>
<td>
<p>The <code>form_name</code> described in the named column from the
REDCap metadata.</p>
</td></tr>
<tr><td><code id="distill_repeat_table_+3A_db_data">db_data</code></td>
<td>
<p>The non-longitudinal REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="distill_repeat_table_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The non-longitudinal REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset <code>tibble</code> of all data related to a specified <code>form_name</code>
</p>

<hr>
<h2 id='distill_repeat_table_long'>Extract repeat tables from longitudinal REDCap databases</h2><span id='topic+distill_repeat_table_long'></span>

<h3>Description</h3>

<p>Sub-helper function to <code>clean_redcap_long</code> for single repeat table
extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distill_repeat_table_long(
  form_name,
  db_data_long,
  db_metadata_long,
  linked_arms,
  has_mixed_structure_forms = FALSE,
  mixed_structure_ref = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distill_repeat_table_long_+3A_form_name">form_name</code></td>
<td>
<p>The <code>form_name</code> described in the named column from the
REDCap metadata.</p>
</td></tr>
<tr><td><code id="distill_repeat_table_long_+3A_db_data_long">db_data_long</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="distill_repeat_table_long_+3A_db_metadata_long">db_metadata_long</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
<tr><td><code id="distill_repeat_table_long_+3A_linked_arms">linked_arms</code></td>
<td>
<p>Output of <code>link_arms</code>, linking instruments to REDCap
events/arms</p>
</td></tr>
<tr><td><code id="distill_repeat_table_long_+3A_has_mixed_structure_forms">has_mixed_structure_forms</code></td>
<td>
<p>Whether the instrument under evaluation has a mixed
structure. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="distill_repeat_table_long_+3A_mixed_structure_ref">mixed_structure_ref</code></td>
<td>
<p>A mixed structure reference dataframe supplied
by <code>get_mixed_structure_fields()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> of all data related to a specified <code>form_name</code>
</p>

<hr>
<h2 id='extract_tibble'>Extract a single data tibble from a REDCapTidieR supertibble</h2><span id='topic+extract_tibble'></span>

<h3>Description</h3>

<p>Take a supertibble generated with <code>read_redcap()</code>
and return one of its data tibbles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_tibble(supertbl, tbl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_tibble_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated by <code>read_redcap()</code>. Required.</p>
</td></tr>
<tr><td><code id="extract_tibble_+3A_tbl">tbl</code></td>
<td>
<p>The <code>redcap_form_name</code> of the data tibble to extract. Required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function makes it easy to extract a single instrument's data from a
REDCapTidieR supertibble.
</p>


<h3>Value</h3>

<p>A <code>tibble</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>superheroes_supertbl

extract_tibble(superheroes_supertbl, "heroes_information")

</code></pre>

<hr>
<h2 id='extract_tibbles'>Extract data tibbles from a REDCapTidieR supertibble into a list</h2><span id='topic+extract_tibbles'></span>

<h3>Description</h3>

<p>Take a supertibble generated with <code>read_redcap()</code>
and return a named list of data tibbles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_tibbles(supertbl, tbls = everything())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_tibbles_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated by <code>read_redcap()</code>. Required.</p>
</td></tr>
<tr><td><code id="extract_tibbles_+3A_tbls">tbls</code></td>
<td>
<p>A vector of <code>form_name</code>s or a tidyselect helper. Default is
<code>dplyr::everything()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function makes it easy to extract a multiple instrument's data from a
REDCapTidieR supertibble into a named list. Specifying instruments using
tidyselect helper functions such as <code>dplyr::starts_with()</code>
or <code>dplyr::ends_with()</code> is supported.
</p>


<h3>Value</h3>

<p>A named list of <code>tibble</code>s
</p>


<h3>Examples</h3>

<pre><code class='language-R'>superheroes_supertbl

# Extract all data tibbles
extract_tibbles(superheroes_supertbl)

# Only extract data tibbles starting with "heroes"
extract_tibbles(superheroes_supertbl, starts_with("heroes"))

</code></pre>

<hr>
<h2 id='format_error_val'>Format value for error message</h2><span id='topic+format_error_val'></span>

<h3>Description</h3>

<p>Format value for error message
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_error_val(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_error_val_+3A_x">x</code></td>
<td>
<p>value to format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If x is atomic, x with cli formatting to truncate to 5 values. Otherwise,
a string summarizing x produced by as_label
</p>

<hr>
<h2 id='format-helpers'>Format REDCap variable labels</h2><span id='topic+format-helpers'></span><span id='topic+fmt_strip_whitespace'></span><span id='topic+fmt_strip_trailing_colon'></span><span id='topic+fmt_strip_trailing_punct'></span><span id='topic+fmt_strip_html'></span><span id='topic+fmt_strip_field_embedding'></span>

<h3>Description</h3>

<p>Use these functions with the <code>format_labels</code> argument of
<code>make_labelled()</code> to define how variable labels should be formatted before
being applied to the data columns of <code>redcap_data</code>. These functions are
helpful to create pretty variable labels from REDCap field labels.
</p>

<ul>
<li> <p><code>fmt_strip_whitespace()</code> removes extra white space inside and at the start
and end of a string. It is a thin wrapper of <code>stringr::str_trim()</code> and
<code>stringr::str_squish()</code>.
</p>
</li>
<li> <p><code>fmt_strip_trailing_colon()</code> removes a colon character at the end of a string.
</p>
</li>
<li> <p><code>fmt_strip_trailing_punct()</code> removes punctuation at the end of a string.
</p>
</li>
<li> <p><code>fmt_strip_html()</code> removes html tags from a string.
</p>
</li>
<li> <p><code>fmt_strip_field_embedding()</code> removes text between curly braces <code>{}</code> which
REDCap uses for special &quot;field embedding&quot; logic. Note that <code>read_redcap()</code>
removes html tags and field embedding logic from field labels in the metadata
by default.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>fmt_strip_whitespace(x)

fmt_strip_trailing_colon(x)

fmt_strip_trailing_punct(x)

fmt_strip_html(x)

fmt_strip_field_embedding(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format-helpers_+3A_x">x</code></td>
<td>
<p>a character vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified character vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fmt_strip_whitespace("Poorly Spaced   Label ")

fmt_strip_trailing_colon("Label:")

fmt_strip_trailing_punct("Label-")

fmt_strip_html("&lt;b&gt;Bold Label&lt;/b&gt;")

fmt_strip_field_embedding("Label{another_field}")

superheroes_supertbl

make_labelled(superheroes_supertbl, format_labels = fmt_strip_trailing_colon)

</code></pre>

<hr>
<h2 id='get_fields_to_drop'>Determine fields included in <code>REDCapR::redcap_read_oneshot</code> output
that should be dropped from results of <code>read_redcap</code></h2><span id='topic+get_fields_to_drop'></span>

<h3>Description</h3>

<p>Determine fields included in <code>REDCapR::redcap_read_oneshot</code> output
that should be dropped from results of <code>read_redcap</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fields_to_drop(db_metadata, form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fields_to_drop_+3A_db_metadata">db_metadata</code></td>
<td>
<p>metadata tibble created by
<code>REDCapR::redcap_metadata_read</code></p>
</td></tr>
<tr><td><code id="get_fields_to_drop_+3A_form">form</code></td>
<td>
<p>the name of the instrument containing identifiers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies rules to determine which fields are included in the
results of <code>REDCapR::redcap_read_oneshot</code> because the user didn't
request the instrument containing identifiers
</p>


<h3>Value</h3>

<p>A character vector of extra field names that can be used to filter the
results of <code>REDCapR::redcap_read_oneshot</code>
</p>

<hr>
<h2 id='get_mixed_structure_fields'>Get Mixed Structure Instrument List</h2><span id='topic+get_mixed_structure_fields'></span>

<h3>Description</h3>

<p>Define fields in a given project that are used in both a repeating and
nonrepeating manner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mixed_structure_fields(db_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mixed_structure_fields_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output generated by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe
</p>

<hr>
<h2 id='get_record_id_field'>Utility function to extract the name of the project identifier field for
a tibble of REDCap data</h2><span id='topic+get_record_id_field'></span>

<h3>Description</h3>

<p>Utility function to extract the name of the project identifier field for
a tibble of REDCap data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_record_id_field(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_record_id_field_+3A_data">data</code></td>
<td>
<p>a tibble of REDCap data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current implementation assumes that the first field in the data is the
project identifier
</p>


<h3>Value</h3>

<p>The name of the identifier field in the data
</p>

<hr>
<h2 id='invert_vec'>Swap vector names for values</h2><span id='topic+invert_vec'></span>

<h3>Description</h3>

<p>Swap vector names for values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invert_vec(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invert_vec_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with names and values reversed
</p>

<hr>
<h2 id='is_labelled'>Determine if an object is labelled</h2><span id='topic+is_labelled'></span>

<h3>Description</h3>

<p>An internal utility function used to inform other processes of whether or
not a given object has been labelled (i.e. with <code>make_labelled()</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_labelled(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_labelled_+3A_obj">obj</code></td>
<td>
<p>An object to be tested for &quot;label&quot; attributes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An object is considered labelled if it has &quot;label&quot; attributes.
</p>


<h3>Value</h3>

<p>A boolean
</p>

<hr>
<h2 id='link_arms'>Link longitudinal REDCap instruments with their events/arms</h2><span id='topic+link_arms'></span>

<h3>Description</h3>

<p>For REDCap databases containing arms and events, it is necessary to determine
how these are linked and what variables belong to them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>link_arms(redcap_uri, token, suppress_redcapr_messages = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="link_arms_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The REDCap URI</p>
</td></tr>
<tr><td><code id="link_arms_+3A_token">token</code></td>
<td>
<p>The REDCap API token</p>
</td></tr>
<tr><td><code id="link_arms_+3A_suppress_redcapr_messages">suppress_redcapr_messages</code></td>
<td>
<p>A logical to control whether to suppress messages
from REDCapR API calls. Default <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>tibble</code> of <code>redcap_event_name</code>s with list elements
containing a vector of associated instruments.
</p>

<hr>
<h2 id='make_labelled'>Apply variable labels to a REDCapTidieR supertibble</h2><span id='topic+make_labelled'></span>

<h3>Description</h3>

<p>Take a supertibble and use the <code>labelled</code> package to apply variable labels to
the columns of the supertibble as well as to each tibble in the
<code>redcap_data</code>, <code>redcap_metadata</code>, and <code>redcap_events</code> columns
of that supertibble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_labelled(supertbl, format_labels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_labelled_+3A_supertbl">supertbl</code></td>
<td>
<p>a supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="make_labelled_+3A_format_labels">format_labels</code></td>
<td>
<p>one or multiple optional label formatting functions.
A label formatting function is a function that takes a character vector and
returns a modified character vector of the same length. This function is
applied to field labels before attaching them to variables. One of:
</p>

<ul>
<li> <p><code>NULL</code> to apply no additional formatting. Default.
</p>
</li>
<li><p> A label formatting function.
</p>
</li>
<li><p> A character with the name of a label formatting function.
</p>
</li>
<li><p> A vector or list of label formatting functions or function names to be applied
in order. Note that ordering may affect results.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>The variable labels for the data tibbles are derived from the <code>field_label</code>
column of the metadata tibble.
</p>


<h3>Value</h3>

<p>A labelled supertibble.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>superheroes_supertbl

make_labelled(superheroes_supertbl)

make_labelled(superheroes_supertbl, format_labels = tolower)

## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

supertbl &lt;- read_redcap(redcap_uri, token)
make_labelled(supertbl)

## End(Not run)
</code></pre>

<hr>
<h2 id='make_skimr_labels'>Make skimr labels from default skimr outputs</h2><span id='topic+make_skimr_labels'></span>

<h3>Description</h3>

<p>A simple helper function that returns all default <code>skimr</code> names as formatted
character vector for use in <code>make_lablled</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_skimr_labels()
</code></pre>


<h3>Details</h3>

<p>All labels supplied are manually created and agreed upon as human-readable
</p>


<h3>Value</h3>

<p>A character vector
</p>

<hr>
<h2 id='multi_choice_to_labels'>Update multiple choice fields with label data</h2><span id='topic+multi_choice_to_labels'></span>

<h3>Description</h3>

<p>Update REDCap variables with multi-choice types to standard form labels taken
from REDCap metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_choice_to_labels(
  db_data,
  db_metadata,
  raw_or_label = "label",
  call = caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_choice_to_labels_+3A_db_data">db_data</code></td>
<td>
<p>A REDCap database object</p>
</td></tr>
<tr><td><code id="multi_choice_to_labels_+3A_db_metadata">db_metadata</code></td>
<td>
<p>A REDCap metadata object</p>
</td></tr>
<tr><td><code id="multi_choice_to_labels_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either 'raw', 'label', or 'haven') that specifies whether
to export the raw coded values or the labels for the options of categorical
fields. Default is 'label'. If 'haven' is supplied, categorical fields are converted
to <code>haven_labelled</code> vectors.</p>
</td></tr>
<tr><td><code id="multi_choice_to_labels_+3A_call">call</code></td>
<td>
<p>call for conditions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coerce variables of <code>field_type</code> &quot;truefalse&quot;, &quot;yesno&quot;, and &quot;checkbox&quot; to
logical. Introduce <code>form_status_complete</code> column and append to end of
<code>tibble</code> outputs. Ensure <code>field_type</code>s &quot;dropdown&quot; and &quot;radio&quot; are
converted appropriately since label appendings are important and unique to
these.
</p>

<hr>
<h2 id='parse_labels'>Parse labels from REDCap metadata into usable formats</h2><span id='topic+parse_labels'></span>

<h3>Description</h3>

<p>Takes a string separated by <code>,</code>s and/or <code>|</code>s (i.e. comma/tab
separated values) containing key value pairs (<code>raw</code> and <code>label</code>)
and returns a tidy <code>tibble</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_labels(string, return_vector = FALSE, return_stripped_text_flag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_labels_+3A_string">string</code></td>
<td>
<p>A <code>db_metadata$select_choices_or_calculations</code> field
pre-filtered for checkbox <code>field_type</code></p>
</td></tr>
<tr><td><code id="parse_labels_+3A_return_vector">return_vector</code></td>
<td>
<p>logical for whether to return result as a vector</p>
</td></tr>
<tr><td><code id="parse_labels_+3A_return_stripped_text_flag">return_stripped_text_flag</code></td>
<td>
<p>logical for whether to return a flag indicating whether or not
text was stripped from labels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The associated <code>string</code> comes from metadata outputs.
</p>


<h3>Value</h3>

<p>A tidy <code>tibble</code> from a matrix giving raw and label outputs to
be used in later functions if <code>return_vector = FALSE</code>, the default.
Otherwise a vector result in a c(raw = label) format to use with
dplyr::recode
</p>

<hr>
<h2 id='parse_logical_cols'>Convert yesno, truefalse, and checkbox fields to logical</h2><span id='topic+parse_logical_cols'></span>

<h3>Description</h3>

<p>Convert yesno, truefalse, and checkbox fields to logical
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_logical_cols(db_data, db_metadata, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_logical_cols_+3A_db_data">db_data</code></td>
<td>
<p>A REDCap database object</p>
</td></tr>
<tr><td><code id="parse_logical_cols_+3A_db_metadata">db_metadata</code></td>
<td>
<p>A REDCap metadata object</p>
</td></tr>
<tr><td><code id="parse_logical_cols_+3A_call">call</code></td>
<td>
<p>call for conditions</p>
</td></tr>
</table>

<hr>
<h2 id='read_redcap'>Import a REDCap database into a tidy supertibble</h2><span id='topic+read_redcap'></span>

<h3>Description</h3>

<p>Query the REDCap API to retrieve data and metadata about a project,
and transform the output into a &quot;supertibble&quot; that contains data
and metadata organized into tibbles, broken down by instrument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_redcap(
  redcap_uri,
  token,
  raw_or_label = "label",
  forms = NULL,
  export_survey_fields = NULL,
  export_data_access_groups = NULL,
  suppress_redcapr_messages = TRUE,
  guess_max = .Machine$integer.max,
  allow_mixed_structure = getOption("redcaptidier.allow.mixed.structure", FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_redcap_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The
URI/URL of the REDCap server (e.g.,
&quot;https://server.org/apps/redcap/api/&quot;). Required.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project. Required.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either 'raw', 'label', or 'haven') that specifies whether
to export the raw coded values or the labels for the options of categorical
fields. Default is 'label'. If 'haven' is supplied, categorical fields are converted
to <code>haven_labelled</code> vectors.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_forms">forms</code></td>
<td>
<p>A character vector of REDCap instrument names that specifies
which instruments to import. Default is <code>NULL</code> which imports all instruments
in the project.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_export_survey_fields">export_survey_fields</code></td>
<td>
<p>A logical that specifies whether to export
survey identifier and timestamp fields. The default, <code>NULL</code>,
tries to determine if survey fields exist and returns them if available.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_export_data_access_groups">export_data_access_groups</code></td>
<td>
<p>A logical that specifies whether to export
the data access group field. The default, <code>NULL</code>, tries to determine if a data
access group field exists and returns it if available.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_suppress_redcapr_messages">suppress_redcapr_messages</code></td>
<td>
<p>A logical to control whether to suppress messages
from REDCapR API calls. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_guess_max">guess_max</code></td>
<td>
<p>A positive <a href="base.html#topic+numeric">base::numeric</a> value
passed to <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> that specifies the maximum number of records to
use for guessing column types. Default <code>.Machine$integer.max</code>.</p>
</td></tr>
<tr><td><code id="read_redcap_+3A_allow_mixed_structure">allow_mixed_structure</code></td>
<td>
<p>A logical to allow for support of mixed repeating/non-repeating
instruments. Setting to <code>TRUE</code> will treat the mixed instrument's non-repeating versions
as repeating instruments with a single instance. Applies to longitudinal projects
only. Default <code>FALSE</code>. Can be set globally with <code>options(redcaptidier.allow.mixed.structure = TRUE)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the <a href="https://ouhscbbmc.github.io/REDCapR/index.html">REDCapR</a>
package to query the REDCap API. The REDCap API returns a
<a href="https://en.wikipedia.org/wiki/Block_matrix">block matrix</a> that mashes
data from all data collection instruments
together. The <code>read_redcap()</code> function
deconstructs the block matrix and splices the data into individual tibbles,
where one tibble represents the data from one instrument.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> in which each row represents a REDCap instrument. It
contains the following columns:
</p>

<ul>
<li> <p><code>redcap_form_name</code>, the name of the instrument
</p>
</li>
<li> <p><code>redcap_form_label</code>, the label for the instrument
</p>
</li>
<li> <p><code>redcap_data</code>, a tibble with the data for the instrument
</p>
</li>
<li> <p><code>redcap_metadata</code>, a tibble of data dictionary entries for each field in the instrument
</p>
</li>
<li> <p><code>redcap_events</code>, a tibble with information about the arms and longitudinal events represented in the instrument.
Only if the project has longitudinal events enabled
</p>
</li>
<li> <p><code>structure</code>, the instrument structure, either &quot;repeating&quot; or &quot;nonrepeating&quot;
</p>
</li>
<li> <p><code>data_rows</code>, the number of rows in the instrument's data tibble
</p>
</li>
<li> <p><code>data_cols</code>, the number of columns in the instrument's data tibble
</p>
</li>
<li> <p><code>data_size</code>, the size in memory of the instrument's data tibble computed by <code>lobstr::obj_size()</code>
</p>
</li>
<li> <p><code>data_na_pct</code>, the percentage of cells in the instrument's data columns that are <code>NA</code> excluding identifier and
form completion columns
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

read_redcap(
  redcap_uri,
  token,
  raw_or_label = "label"
)

## End(Not run)

</code></pre>

<hr>
<h2 id='REDCapTidieR-package'>REDCapTidieR: Extract 'REDCap' Databases into Tidy 'Tibble's</h2><span id='topic+REDCapTidieR'></span><span id='topic+REDCapTidieR-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Convert 'REDCap' exports into tidy tables for easy handling of 'REDCap' repeat instruments and event arms.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Richard Hanna <a href="mailto:richardshanna91@gmail.com">richardshanna91@gmail.com</a> (<a href="https://orcid.org/0009-0005-6496-8154">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Stephan Kadauke <a href="mailto:kadaukes@chop.edu">kadaukes@chop.edu</a> (<a href="https://orcid.org/0000-0003-2996-8034">ORCID</a>)
</p>
</li>
<li><p> Ezra Porter <a href="mailto:ezrajporter@gmail.com">ezrajporter@gmail.com</a> (<a href="https://orcid.org/0000-0002-4690-8343">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://chop-cgtinformatics.github.io/REDCapTidieR/">https://chop-cgtinformatics.github.io/REDCapTidieR/</a>
</p>
</li>
<li> <p><a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR">https://github.com/CHOP-CGTInformatics/REDCapTidieR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/CHOP-CGTInformatics/REDCapTidieR/issues">https://github.com/CHOP-CGTInformatics/REDCapTidieR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='release_questions'>Additional release questions</h2><span id='topic+release_questions'></span>

<h3>Description</h3>

<p>Additional release questions to be added when using <code>devtools::release()</code>
during CRAN submissions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>release_questions()
</code></pre>


<h3>Details</h3>

<p>This follows the documentation provided in <code>devtools::release()</code>.
</p>


<h3>Value</h3>

<p>A series of character string questions
</p>

<hr>
<h2 id='remove_empty_rows'>Remove rows with empty data</h2><span id='topic+remove_empty_rows'></span>

<h3>Description</h3>

<p>Remove rows that are empty in all associated data columns (those derived from
fields in REDCap). This occurs when a form is filled out in an event, but
other forms are not. Regardless of a form's status, all forms in an event are
included in the output so long as any form in the event contains data.
</p>
<p>This only applies to longitudinal REDCap databases containing events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_empty_rows(data, my_record_id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_empty_rows_+3A_data">data</code></td>
<td>
<p>A REDCap dataframe from a longitudinal database,
pre-processed within a <code style="white-space: pre;">&#8288;distill_*&#8288;</code> function.</p>
</td></tr>
<tr><td><code id="remove_empty_rows_+3A_my_record_id">my_record_id</code></td>
<td>
<p>The record ID defined in the project.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe.
</p>

<hr>
<h2 id='resolve_formatter'>Convert user input into label formatting function</h2><span id='topic+resolve_formatter'></span>

<h3>Description</h3>

<p>Convert user input into label formatting function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resolve_formatter(format_labels, env = caller_env(n = 2), call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resolve_formatter_+3A_format_labels">format_labels</code></td>
<td>
<p>argument passed to <code>make_labelled</code></p>
</td></tr>
<tr><td><code id="resolve_formatter_+3A_env">env</code></td>
<td>
<p>the environment in which to look up functions if
<code>format_labels</code> contains character elements. The default,
<code>caller_env(n = 2)</code>, uses the environment from which the user called
<code>make_labelled()</code></p>
</td></tr>
<tr><td><code id="resolve_formatter_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the error message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function
</p>

<hr>
<h2 id='safe_set_variable_labels'>Safely set variable labels</h2><span id='topic+safe_set_variable_labels'></span>

<h3>Description</h3>

<p>A utility function for setting labels of a tibble from a named vector while
accounting for labels that may not be present in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safe_set_variable_labels(data, labs)
</code></pre>


<h3>Value</h3>

<p>A tibble
</p>

<hr>
<h2 id='skim_data'>Apply applicable skimmers to data</h2><span id='topic+skim_data'></span>

<h3>Description</h3>

<p>A helper function for <code>add_skimr_metadata()</code> which applies applicable
skimmers to a given dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skim_data(redcap_data, redcap_metadata, is_labelled)
</code></pre>


<h3>Value</h3>

<p>A dataframe
</p>

<hr>
<h2 id='strip_html_field_embedding'>Remove html tags and field embedding logic from a string</h2><span id='topic+strip_html_field_embedding'></span>

<h3>Description</h3>

<p>Remove html tags and field embedding logic from a string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip_html_field_embedding(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strip_html_field_embedding_+3A_x">x</code></td>
<td>
<p>vector of strings to format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of strings with html tags, field embedding logic, and extra whitespace
removed
</p>

<hr>
<h2 id='superheroes_supertbl'>Superheroes Data</h2><span id='topic+superheroes_supertbl'></span>

<h3>Description</h3>

<p>A dataset of superheroes in a REDCapTidieR <code>supertbl</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>superheroes_supertbl
</code></pre>


<h3>Format</h3>



<h4><code>heroes_information</code></h4>

<p>A <code>tibble</code> with 734 rows and 12 columns:
</p>

<dl>
<dt>record_id</dt><dd><p>REDCap record ID</p>
</dd>
<dt>name</dt><dd><p>Hero name</p>
</dd>
<dt>gender</dt><dd><p>Gender</p>
</dd>
<dt>eye_color</dt><dd><p>Eye color</p>
</dd>
<dt>race</dt><dd><p>Race</p>
</dd>
<dt>hair_color</dt><dd><p>Hair color</p>
</dd>
<dt>height</dt><dd><p>Height</p>
</dd>
<dt>weight</dt><dd><p>Weight</p>
</dd>
<dt>publisher</dt><dd><p>Publisher</p>
</dd>
<dt>skin_color</dt><dd><p>Skin color</p>
</dd>
<dt>alignment</dt><dd><p>Alignment</p>
</dd>
<dt>form_status_complete</dt><dd><p>REDCap instrument completed?</p>
</dd>
</dl>




<h4><code>super_hero_powers</code></h4>

<p>A <code>tibble</code> with 5,966 rows and 4 columns:
</p>

<dl>
<dt>record_id</dt><dd><p>REDCap record ID</p>
</dd>
<dt>redcap_form_instance</dt><dd><p>REDCap repeat instance</p>
</dd>
<dt>power</dt><dd><p>Super power</p>
</dd>
<dt>form_status_complete</dt><dd><p>REDCap instrument completed?</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://www.superherodb.com/">https://www.superherodb.com/</a>
</p>

<hr>
<h2 id='supertbl_recode'>Recode fields using supertbl metadata</h2><span id='topic+supertbl_recode'></span>

<h3>Description</h3>

<p>This utility function helps to map metadata field types in order to apply
changes in supertbl tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supertbl_recode(supertbl, supertbl_meta, add_labelled_column_headers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="supertbl_recode_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated using <code>read_redcap()</code></p>
</td></tr>
<tr><td><code id="supertbl_recode_+3A_supertbl_meta">supertbl_meta</code></td>
<td>
<p>an <code>unnest</code>-ed metadata tibble from the supertibble</p>
</td></tr>
<tr><td><code id="supertbl_recode_+3A_add_labelled_column_headers">add_labelled_column_headers</code></td>
<td>
<p>Whether or not to include labelled outputs</p>
</td></tr>
</table>

<hr>
<h2 id='tbl_sum.redcap_supertbl'>Provide a succinct summary of an object</h2><span id='topic+tbl_sum.redcap_supertbl'></span>

<h3>Description</h3>

<p><code>tbl_sum()</code> gives a brief textual description of a table-like object,
which should include the dimensions and the data source in the first element,
and additional information in the other elements (such as grouping for <span class="pkg">dplyr</span>).
The default implementation forwards to <code><a href="pillar.html#topic+obj_sum">obj_sum()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'redcap_supertbl'
tbl_sum(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tbl_sum.redcap_supertbl_+3A_x">x</code></td>
<td>
<p>Object to summarise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named character vector, describing the dimensions in the first element
and the data source in the name of the first element.
</p>

<hr>
<h2 id='try_redcapr'>Make a <code>REDCapR</code> API call with custom error handling</h2><span id='topic+try_redcapr'></span>

<h3>Description</h3>

<p>Make a <code>REDCapR</code> API call with custom error handling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try_redcapr(expr, call = caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="try_redcapr_+3A_expr">expr</code></td>
<td>
<p>an expression making a <code>REDCapR</code> API call</p>
</td></tr>
<tr><td><code id="try_redcapr_+3A_call">call</code></td>
<td>
<p>the calling environment to use in the warning message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If successful, the <code>data</code> element of the <code>REDCapR</code> result. Otherwise an error
</p>

<hr>
<h2 id='update_data_col_names'>Correctly label variables belonging to checkboxes with minus signs</h2><span id='topic+update_data_col_names'></span>

<h3>Description</h3>

<p>Using <code>db_data</code> and <code>db_metadata</code>, temporarily create a conversion
column that reverts automatic REDCap behavior where database column names
have &quot;-&quot;s converted to &quot;_&quot;s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_data_col_names(db_data, db_metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_data_col_names_+3A_db_data">db_data</code></td>
<td>
<p>The REDCap database output defined by
<code>REDCapR::redcap_read_oneshot()$data</code></p>
</td></tr>
<tr><td><code id="update_data_col_names_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an issue with checkbox fields since analysts should be able to verify
checkbox variable suffices with their label counterparts.
</p>


<h3>Value</h3>

<p>Updated <code>db_data</code> column names for checkboxes where &quot;-&quot;s were
replaced by &quot;_&quot;s.
</p>

<hr>
<h2 id='update_field_names'>Update metadata field names for checkbox handling</h2><span id='topic+update_field_names'></span>

<h3>Description</h3>

<p>Takes a <code>db_metadata</code> object and:
</p>

<ul>
<li><p> replaces checkbox field rows with a set of rows, one for each
checkbox option
</p>
</li>
<li><p> appends a <code>field_name_updated</code> field to the end for checkbox
variable handling
</p>
</li>
<li><p> updates <code>field_label</code> for any new checkbox rows to include the
specific option in &quot;field_label: option label&quot; format
</p>
</li>
<li><p> strips html and field embedding logic from <code>field_label</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>update_field_names(db_metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_field_names_+3A_db_metadata">db_metadata</code></td>
<td>
<p>The REDCap metadata output defined by
<code>REDCapR::redcap_metadata_read()$data</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes <code>db_metadata</code>:
</p>

<ul>
<li><p> has non-zero number of rows
</p>
</li>
<li><p> contains <code>field_name</code> and <code>field_label</code> columns
</p>
</li></ul>



<h3>Value</h3>

<p>Column <code>db_metadata</code> with <code>field_name_updated</code> appended
and <code>field_label</code> updated for new rows corresponding to checkbox options
</p>

<hr>
<h2 id='vec_ptype_abbr.redcap_supertbl'>Vector type as a string</h2><span id='topic+vec_ptype_abbr.redcap_supertbl'></span>

<h3>Description</h3>

<p><code>vec_ptype_full()</code> displays the full type of the vector. <code>vec_ptype_abbr()</code>
provides an abbreviated summary suitable for use in a column heading.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'redcap_supertbl'
vec_ptype_abbr(x, ..., prefix_named, suffix_shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vec_ptype_abbr.redcap_supertbl_+3A_x">x</code></td>
<td>
<p>A vector.</p>
</td></tr>
<tr><td><code id="vec_ptype_abbr.redcap_supertbl_+3A_...">...</code></td>
<td>
<p>These dots are for future extensions and must be empty.</p>
</td></tr>
<tr><td><code id="vec_ptype_abbr.redcap_supertbl_+3A_prefix_named">prefix_named</code></td>
<td>
<p>If <code>TRUE</code>, add a prefix for named vectors.</p>
</td></tr>
<tr><td><code id="vec_ptype_abbr.redcap_supertbl_+3A_suffix_shape">suffix_shape</code></td>
<td>
<p>If <code>TRUE</code> (the default), append the shape of
the vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string.
</p>

<hr>
<h2 id='write_redcap_xlsx'>Write Supertibbles to XLSX</h2><span id='topic+write_redcap_xlsx'></span>

<h3>Description</h3>

<p>Transform a supertibble into an XLSX file, with each REDCap data tibble in a separate sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_redcap_xlsx(
  supertbl,
  file,
  add_labelled_column_headers = NULL,
  use_labels_for_sheet_names = TRUE,
  include_toc_sheet = TRUE,
  include_metadata_sheet = TRUE,
  table_style = "tableStyleLight8",
  column_width = "auto",
  recode_logical = TRUE,
  na_replace = "",
  overwrite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_redcap_xlsx_+3A_supertbl">supertbl</code></td>
<td>
<p>A supertibble generated using <code>read_redcap()</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_file">file</code></td>
<td>
<p>The name of the file to which the output will be written.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_add_labelled_column_headers">add_labelled_column_headers</code></td>
<td>
<p>If <code>TRUE</code>, the first row of each sheet will contain variable labels,
with variable names in the second row. If <code>FALSE</code>, variable names will be in the first row.
The default value, <code>NULL</code>, tries to determine if <code>supertbl</code> contains variable labels and,
if present, includes them in the first row. The <code>labelled</code> package must be installed
if <code>add_labelled_column_headers</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_use_labels_for_sheet_names">use_labels_for_sheet_names</code></td>
<td>
<p>If <code>FALSE</code>, sheet names will come from the REDCap instrument names.
If <code>TRUE</code>, sheet names will come from instrument labels. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_include_toc_sheet">include_toc_sheet</code></td>
<td>
<p>If <code>TRUE</code>, the first sheet in the XLSX output will be a table of contents,
providing information about each data tibble in the workbook. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_include_metadata_sheet">include_metadata_sheet</code></td>
<td>
<p>If <code>TRUE</code>, the final sheet in the XLSX output will contain metadata
about each variable, combining the content of <code>supertbl$redcap_metadata</code>. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_table_style">table_style</code></td>
<td>
<p>Any Excel table style name or &quot;none&quot;. For more details, see
the
<a href="https://ycphs.github.io/openxlsx/articles/Formatting.html#use-of-pre-defined-table-styles">&quot;formatting&quot; vignette</a>
of the <code>openxlsx</code> package. The default is &quot;tableStyleLight8&quot;.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_column_width">column_width</code></td>
<td>
<p>Sets the width of columns throughout the workbook.
The default is &quot;auto&quot;, but you can specify a numeric value.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_recode_logical">recode_logical</code></td>
<td>
<p>If <code>TRUE</code>, fields with &quot;yesno&quot; field type are recoded to &quot;yes&quot;/&quot;no&quot; and fields
with a &quot;checkbox&quot; field type are recoded to &quot;Checked&quot;/&quot;Unchecked&quot;. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_na_replace">na_replace</code></td>
<td>
<p>The value used to replace <code>NA</code> values in <code>supertbl</code>. The default is &quot;&quot;.</p>
</td></tr>
<tr><td><code id="write_redcap_xlsx_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>FALSE</code>, will not overwrite <code>file</code> when it exists. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>openxlsx2</code> workbook object, invisibly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
redcap_uri &lt;- Sys.getenv("REDCAP_URI")
token &lt;- Sys.getenv("REDCAP_TOKEN")

supertbl &lt;- read_redcap(redcap_uri, token)

supertbl %&gt;%
  write_redcap_xlsx(file = "supertibble.xlsx")

# Add variable labels

library(labelled)

supertbl %&gt;%
  make_labelled() %&gt;%
  write_redcap_xlsx(file = "supertibble.xlsx", add_labelled_column_headers = TRUE)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
