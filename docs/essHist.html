<!DOCTYPE html><html lang="en"><head><title>Help for package essHist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {essHist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#essHist-package'>
<p>The Essential Histogram</p></a></li>
<li><a href='#checkHistogram'>
<p>Check any histogram estimator by means of the multiscale confidence set</p></a></li>
<li><a href='#Essential+20Histogram'>
<p>The Essential Histogram</p></a></li>
<li><a href='#Generate+20Intervals'>
<p>Generate the system of intervals</p></a></li>
<li><a href='#Mixed+20normals'>
<p>The mixture of normal distributions</p></a></li>
<li><a href='#Multiscale+20Quantiles'>
<p>Quantile of the multiscale statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Essential Histogram</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Housen Li [aut, cre],
  Hannes Sieling [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Housen Li &lt;housen.li@outlook.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide an optimal histogram, in the sense of probability density estimation and features detection, by means of multiscale variational inference. In other words, the resulting histogram servers as an optimal density estimator, and meanwhile recovers the features, such as increases or modes, with both false positive and false negative controls. Moreover, it provides a parsimonious representation in terms of the number of blocks, which simplifies data interpretation. The only assumption for the method is that data points are independent and identically distributed, so it applies to fairly general situations, including continuous distributions, discrete distributions, and mixtures of both. For details see Li, Munk, Sieling and Walther (2016) &lt;<a href="https://doi.org/10.48550/arXiv.1612.07216">doi:10.48550/arXiv.1612.07216</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.5), graphics, stats, grDevices, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-10 09:04:51 UTC; hli</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-10 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='essHist-package'>
The Essential Histogram
</h2><span id='topic+essHist-package'></span><span id='topic+essHist'></span>

<h3>Description</h3>

<p>Provide an optimal histogram, in the sense of probability density estimation and features detection, by means of multiscale variational inference. In other words, the resulting histogram servers as an optimal density estimator, and meanwhile recovers the features, such as increases or modes, with both false positive and false negative controls. Moreover, it provides a parsimonious representation in terms of the number of blocks, which simplifies data interpretation. The only assumption for the method is that data points are independent and identically distributed, so it applies to fairly general situations, including continuous distributions, discrete distributions, and mixtures of both. For details see Li, Munk, Sieling and Walther (2016) &lt;arXiv:1612.07216&gt;. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> essHist</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-05-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
essHistogram    Compute the essential histogram
checkHistogram  Check any estimator by the multiscale confidence set

genIntv         Generate the system of intervals
msQuantile      Simulate the quantile of multiscale statistics

dmixnorm        Compute density function of Gaussian mixtures
pmixnorm        Compute distribution function of Gaussian mixtures
rmixnorm        Generate random number of Gaussian mixtures
paramExample    Output detailed parameters for some famous examples
</pre>


<h3>Author(s)</h3>

<p>Housen Li [aut, cre], 
Hannes Sieling [aut]
</p>
<p>Maintainer: Housen Li &lt;housen.li@outlook.com&gt;
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate data
set.seed(123)
type = 'skewed_unimodal'
n = 500
y = rmixnorm(n, type = type)

# Compute the essential histogram
eh = essHistogram(y, plot = FALSE)

# Plot results
#     compute oracle density
x  = sort(y)
od = dmixnorm(x, type = type)
#     compare with orcle density
plot(x, od, type = "l", xlab = NA, ylab = NA, col = "red", main = type)
lines(eh)
legend("topleft", c("Oracle density", "Essential histogram"), 
       lty = c(1,1), col = c("red", "black"))



##### Evaluate other method
set.seed(123)
# Data: mixture of Gaussians "harp"
n = 500
y = rmixnorm(n, type = 'harp')

# Oracle density
x = sort(y)
ho = dmixnorm(x, type = 'harp')

# R default histogram
h  = hist(y, plot = FALSE)

# Check R default histogram to local multiscale constraints
b = checkHistogram(h, y, ylim=c(-0.1,0.16))
lines(x, ho, col = "red")
rug(x, col = 'blue')
legend("topright", c("R-Histogram", "Truth"), col = c("black", "red"), lty = c(1,1))
</code></pre>

<hr>
<h2 id='checkHistogram'>
Check any histogram estimator by means of the multiscale confidence set
</h2><span id='topic+checkHistogram'></span>

<h3>Description</h3>

<p>Provide the locations, i.e., intervals, where features are potentially missing (a.k.a. false negatives), and the break-points that are potentially redundant (a.k.a. false positives), by means of the multiscale confidence set. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkHistogram(h, x, alpha = 0.1, q = NULL, intv = NULL, 
                mode = ifelse(anyDuplicated(x),"Gen","Con"), 
                plot = TRUE, xlim = NULL, ylim = NULL, 
                xlab = "", ylab = "", yaxt = "n", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkHistogram_+3A_h">h</code></td>
<td>

<p>a numeric vector specifying values of a histogram at sample points; or a <code>hitogram</code> class object (i.e. the return value of <code><a href="graphics.html#topic+hist">hist</a></code>).
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_x">x</code></td>
<td>

<p>a numeric vector containing the data.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_alpha">alpha</code></td>
<td>

<p>significance level, default as 0.1, see also <code><a href="#topic+essHistogram">essHistogram</a></code>.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_q">q</code></td>
<td>

<p>threshold of the multiscale constraint; by default, <code>q</code> is chosen as the (1-<code>alpha</code>)-quantile of the null distribution of the multiscale statistic via Monte Carlo simulation, see also <code><a href="#topic+msQuantile">msQuantile</a></code>.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_intv">intv</code></td>
<td>

<p>a data frame provides the system of intervals on which the multiscale statistic is defined. The data frame constains the following two columns   
</p>
<p><code>left</code> left index of an interval
</p>
<p><code>right</code> right index of an interval
</p>
<p>By default, it is set to the sparse interval system proposed by Rivera and Walther (2013), see also Li et al. (2016).
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_mode">mode</code></td>
<td>

<p><code>"Con"</code> for continuous distribution functions
</p>
<p><code>"Gen"</code> for general (possibly with discontinuous) distribution functions
</p>
<p>By default, <code>"Con"</code> is chosen if there is no tied observations; otherwise, <code>"Gen"</code> is chosen; see Li et al. (2016) for further details.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_plot">plot</code></td>
<td>

<p>logical. If <code>TRUE</code>, the input estimator is potted, together with evaluation information. More precisely, at the very bottom, intervals where local constaints are violated are plotted. In the middle short vertical lines that indicate possibly removable change-points are drawn above a light blue horizontal line. Right below the light blue line, it plots a horizontal gray scale strap, the darkness of which reflects the number of violation intervals covering a given location, as a summary of violation information.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_xlim">xlim</code>, <code id="checkHistogram_+3A_ylim">ylim</code></td>
<td>

<p>numeric vectors of length 2 (default <code>xlim = range(y), ylim = NULL</code>): see <code><a href="base.html#topic+plot">plot</a></code>.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_xlab">xlab</code></td>
<td>

<p>a title for the <code>x</code> axis (default empty string): see <code><a href="graphics.html#topic+title">title</a></code> and <code><a href="base.html#topic+plot">plot</a></code>.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_ylab">ylab</code></td>
<td>

<p>a title for the <code>y</code> axis (default empty string): see <code><a href="graphics.html#topic+title">title</a></code> and <code><a href="base.html#topic+plot">plot</a></code>.
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_yaxt">yaxt</code></td>
<td>

<p>A character which specifies the <code>y</code> axis type (default <code>"n"</code>): see <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="checkHistogram_+3A_...">...</code></td>
<td>

<p>further arguments and <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> passed to <code><a href="base.html#topic+plot">plot</a></code> (if <code>plot</code> = <code>TRUE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function presents a visualization: the upper part plots the given histogram; in the middle part short vertical lines mark all removable break-points; in the lower part intervals of violation are shown, and a graybar below the middle horizontal line (blue) sumarizes such violations with the darkness scaling with the number of violation intervals covering a location. See Examples below and Li et al. (2016) for further details. 
</p>


<h3>Value</h3>

<p>A list consists of one data frame, and one numeric vector: 
</p>
<table role = "presentation">
<tr><td><code>violatedIntervals</code></td>
<td>
<p>A data frame provides the intervals where the corresponding local side constraint is violated; an empty data frame if there is no violation. It constains the following four columns
</p>
<p><code>leftIndex</code> left index of an interval
</p>
<p><code>rightIndex</code> right index of an interval
</p>
<p><code>leftEnd</code> left end point of an interval
</p>
<p><code>rightEnd</code> right end point of an interval
</p>
<p>An empty <code>data.frame</code> is returned if there is no violation. 
</p>
</td></tr>
<tr><td><code>removableBreakpoints</code></td>
<td>
<p>A numeric vector contains all removable breakpoints, with zero length if there is no removable breakpoint. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The argument <code>intv</code> is internally adjusted ensure it contains no empty intervals in case of tied observations. Only the intervals on which the input histogram is constant will be checked! All the printing messages can be disabled by calling <code><a href="base.html#topic+suppressMessages">suppressMessages</a></code>.
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+essHistogram">essHistogram</a></code>,
<code><a href="#topic+genIntv">genIntv</a></code>,
<code><a href="#topic+msQuantile">msQuantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
# Data: mixture of Gaussians "harp"
n = 500
y = rmixnorm(n, type = 'harp')

# Oracle density
x = sort(y)
ho = dmixnorm(x, type = 'harp')

# R default histogram
h  = hist(y, plot = FALSE)

# Check R default histogram to local multiscale constriants
b = checkHistogram(h, y, ylim=c(-0.1,0.16))
lines(x, ho, col = "red")
rug(x, col = 'blue')
legend("topright", c("R-Histogram", "Truth"), col = c("black", "red"), lty = c(1,1))
</code></pre>

<hr>
<h2 id='Essential+20Histogram'>
The Essential Histogram
</h2><span id='topic+essHistogram'></span>

<h3>Description</h3>

<p>Compute the essential histogram via (pruned) dynamic programming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>essHistogram(x, alpha = 0.5, q = NULL, intv = NULL, plot = TRUE, 
              mode = ifelse(anyDuplicated(x),"Gen","Con"), 
              xname = deparse(substitute(x)), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Essential+2B20Histogram_+3A_x">x</code></td>
<td>

<p>a numeric vector containing the data.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_alpha">alpha</code></td>
<td>

<p>significance level; default as 0.5. One should set <code>alpha = 0.1</code> or even smaller if   confidence statements have to be made, while one can set <code>alpha = 0.9</code> if the goal is to explore the data for potential features with tolerance to false positives. The default value is only a trade-off.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_q">q</code></td>
<td>

<p>threshold value; by default, <code>q</code> is chosen as the (1-<code>alpha</code>)-quantile of the null distribution of the multiscale statistic via Monte Carlo simulation, see also <code><a href="#topic+msQuantile">msQuantile</a></code>.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_intv">intv</code></td>
<td>

<p>a data frame provides the system of intervals on which the multiscale statistic is defined. The data frame constains the following two columns   
</p>
<p><code>left</code> left index of an interval
</p>
<p><code>right</code> right index of an interval
</p>
<p>By default, it is set to the sparse interval system proposed by Rivera and Walther (2013), see also Li et al. (2016).
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_plot">plot</code></td>
<td>

<p>logical. If <code>TRUE</code> (default), a histogram is plotted, otherwise a list of breaks and counts is returned. In the latter case, a warning is used if (typically graphical) arguments are specified that only apply to the <code>plot = TRUE</code> case.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_mode">mode</code></td>
<td>

<p><code>"Con"</code> for continuous distribution functions
</p>
<p><code>"Gen"</code> for general (possibly with discontinuous) distribution functions
</p>
<p>By default, <code>"Con"</code> is chosen if there is no tied observations; otherwise, <code>"Gen"</code> is chosen; see Li et al. (2016) for further details.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_xname">xname</code></td>
<td>

<p>a character string with the actual <code>x</code> argument name.
</p>
</td></tr>
<tr><td><code id="Essential+2B20Histogram_+3A_...">...</code></td>
<td>

<p>further arguments and <code><a href="graphics.html#topic+graphical+20parameters">graphical parameters</a></code> passed to <code><a href="graphics.html#topic+plot.histogram">plot.histogram</a></code> and thence to <code><a href="graphics.html#topic+title">title</a></code> and <code><a href="graphics.html#topic+axis">axis</a></code> (if <code>plot = TRUE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The essential histogram is defined as the histogram with least blocks within the multiscale constraint. The one with highest likelihood is picked if there are more than one solutions. The essential histogram involves only one parameter <code>q</code>, the threshold of the multiscale constraint. Such a parameter can be chosen by means of the significance level <code>alpha</code>, which leads to nature statistical significance statements for the multiscale constraint. The computational complexity is often linear in terms of sample size, although the worst complexity bound is quadratic up to a log-factor in case of the sparse interval system. See Li et al. (2016) for further details.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>histogram</code>&quot;, which is of the same class as returned by function <code><a href="graphics.html#topic+hist">hist</a></code>. 
</p>


<h3>Note</h3>

<p>The argument <code>intv</code> is internally adjusted to ensure it contains no empty intervals, especially in case of tied observations. The first block of the returned histogram is a closed interval, and the rest blocks are left open right closed intervals. All the printing messages can be disabled by calling <code><a href="base.html#topic+suppressMessages">suppressMessages</a></code>.
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>
<p>Rivera, C., &amp; Walther, G. (2013). Optimal detection of a jump in the intensity of a Poisson process or in a density with likelihood ratio statistics. Scand. J. Stat. 40, 752&ndash;769.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+checkHistogram">checkHistogram</a></code>,
<code><a href="#topic+genIntv">genIntv</a></code>, 
<code><a href="graphics.html#topic+hist">hist</a></code>, 
<code><a href="#topic+msQuantile">msQuantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate data
set.seed(123)
type = 'skewed_unimodal'
n = 500
y = rmixnorm(n, type = type)

# Compute the essential histogram
eh = essHistogram(y, plot = FALSE)

# Plot results
#     compute oracle density
x  = sort(y)
od = dmixnorm(x, type = type)
#     compare with orcle density
plot(x, od, type = "l", xlab = NA, ylab = NA, col = "red", main = type)
lines(eh)
legend("topleft", c("Oracle density", "Essential histogram"), 
       lty = c(1,1), col = c("red", "black"))
</code></pre>

<hr>
<h2 id='Generate+20Intervals'>
Generate the system of intervals
</h2><span id='topic+genIntv'></span>

<h3>Description</h3>

<p>Generate the system of intervals on which the multiscale statistic is defined, see Li et al. (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genIntv(n, type = c("Sparse", "Full"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Generate+2B20Intervals_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="Generate+2B20Intervals_+3A_type">type</code></td>
<td>

<p>type of interval system. <code>type = "Sparse"</code> (default) is the sparse system proposed by Rivera and Walther (2013), see also Li et al. (2016). <code>type = "Full"</code> is the system of all possible intervals with end-index ranging from <code>1</code> to <code>n</code>.   
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame provides the system of intervals, and consists two columns
</p>
<table role = "presentation">
<tr><td><code>left</code></td>
<td>
<p>left index of an interval</p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p>right index of an interval</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>
<p>Rivera, C., &amp; Walther, G. (2013). Optimal detection of a jump in the intensity of a Poisson process or in a density with likelihood ratio statistics. Scand. J. Stat. 40, 752&ndash;769.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+checkHistogram">checkHistogram</a></code>,
<code><a href="#topic+essHistogram">essHistogram</a></code>,
<code><a href="#topic+msQuantile">msQuantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n    = 5
intv = genIntv(n,"Full")
print(intv)
</code></pre>

<hr>
<h2 id='Mixed+20normals'>
The mixture of normal distributions
</h2><span id='topic+rmixnorm'></span><span id='topic+pmixnorm'></span><span id='topic+dmixnorm'></span><span id='topic+paramExample'></span><span id='topic+mixnormal'></span>

<h3>Description</h3>

<p>Density, distribution function and random generation for the mixture of normals with each component specified by <code>mean</code> and <code>sd</code>, and mixture weights by <code>prob</code>. <code>paramExample</code> gives detailed parameters for some examples specified by <code>type</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmixnorm(x, mean = c(0), sd = rep(1,length(mean)), 
          prob = rep(1,length(mean)), type = NULL, ...)
pmixnorm(x, mean = c(0), sd = rep(1,length(mean)), 
          prob = rep(1,length(mean)), type = NULL, ...)
rmixnorm(n, mean = c(0), sd = rep(1,length(mean)), 
          prob = rep(1,length(mean)), type = NULL)
paramExample(type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Mixed+2B20normals_+3A_x">x</code></td>
<td>

<p>vector of locations.
</p>
</td></tr> 
<tr><td><code id="Mixed+2B20normals_+3A_n">n</code></td>
<td>

<p>integer; number of observations.
</p>
</td></tr> 
<tr><td><code id="Mixed+2B20normals_+3A_mean">mean</code></td>
<td>

<p>vector of means for each mixture component. 
</p>
</td></tr> 
<tr><td><code id="Mixed+2B20normals_+3A_sd">sd</code></td>
<td>

<p>vector of standard deviations for each mixture component. Default is of unit variance for each component.
</p>
</td></tr>
<tr><td><code id="Mixed+2B20normals_+3A_prob">prob</code></td>
<td>

<p>vector of prior probability for each mixture component (i.e. mixture weights). All nonnegative values are allowed, and automatically recaled to ensure their sum equal to 1. Default is of equal probability for each component.   
</p>
</td></tr>
<tr><td><code id="Mixed+2B20normals_+3A_type">type</code></td>
<td>

<p>a (case insensitive) character string of example name; It includes examples from Marron &amp; Wand (1992): &quot;MW1&quot;, ..., &quot;MW15&quot;, or equivalently &quot;gauss&quot;, &quot;skewed_unimodal&quot;, &quot;strong_skewed&quot;, &quot;kurtotic_unimodal&quot;, &quot;outlier&quot;, &quot;bimodal&quot;, &quot;separated_bimodal&quot;, &quot;skewed_bimodal&quot;, &quot;trimodal&quot;, &quot;claw&quot;, &quot;double_claw&quot;, &quot;asymmetric_claw&quot;, &quot;asymmetric_double_claw&quot;, &quot;smooth_comb&quot;, &quot;discrete_comb&quot;; It also includes &quot;harp&quot; example from Li et al. (2016).
</p>
</td></tr>
<tr><td><code id="Mixed+2B20normals_+3A_...">...</code></td>
<td>

<p>further arguments passed to <code><a href="stats.html#topic+dnorm">dnorm</a></code> and <code><a href="stats.html#topic+pnorm">pnorm</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users either provide, optionally, <code>mean</code>, <code>sd</code> and <code>prob</code>; or <code>type</code>. In case of providing <code>type</code>, the values of <code>mean</code>, <code>sd</code> and <code>prob</code> are ignored.  
</p>
<p>The default case is standard normal, the same as <code><a href="stats.html#topic+dnorm">dnorm</a></code>, <code><a href="stats.html#topic+pnorm">pnorm</a></code> and <code><a href="stats.html#topic+rnorm">rnorm</a></code>.
</p>


<h3>Value</h3>

<p><code>dmixnorm</code> gives the density, <code>pmixnorm</code> gives the distribution function, and <code>rmixnorm</code> generates random deviates.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rmixnorm</code>, and is the length of <code>x</code> for <code>dmixnorm</code> and <code>pmixnorm</code>.
</p>
<p><code>paramExample</code> gives a data frame with components <code>mean</code>, <code>sd</code> and <code>prob</code>. 
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>
<p>Marron, J. S., &amp; Wand, M. P. (1992). Exact mean integrated squred error. Ann. Statist., 20(2), 712&ndash;736.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+Normal">Normal</a> for standard normal distributions; <a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example harp 
type = "harp" 
#     generate random numbers
n = 500
Y = rmixnorm(n, type = type)
#     compute the density
x = seq(min(Y), max(Y), length.out = n)
f = dmixnorm(x, type = type)
#     compute the distribution
F = pmixnorm(x, type = type)
#     plots
op = par(mfrow = c(1,2))
plot(x, f, type = "l", main = "Harp Density")
rug(Y, col = 'red')
plot(x, F, type = "l", main = "Harp Distribution")
rug(Y, col = 'red')
par(op)
</code></pre>

<hr>
<h2 id='Multiscale+20Quantiles'>
Quantile of the multiscale statistics
</h2><span id='topic+msQuantile'></span>

<h3>Description</h3>

<p>Simulate quantiles of the multiscale statistics under any continuous distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msQuantile(n, alpha = c(0.5), nsim = 5e3, is.sim = (n &lt; 1e4), 
            intv = genIntv(n), mode = c("Con", "Gen"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Multiscale+2B20Quantiles_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="Multiscale+2B20Quantiles_+3A_alpha">alpha</code></td>
<td>

<p>significance level; default as 0.5, see also <code><a href="#topic+essHistogram">essHistogram</a></code>. Like <code><a href="stats.html#topic+quantile">quantile</a></code>, it can also be a vector. 
</p>
</td></tr>
<tr><td><code id="Multiscale+2B20Quantiles_+3A_nsim">nsim</code></td>
<td>

<p>numer of Monte Carlo simulations.
</p>
</td></tr> 
<tr><td><code id="Multiscale+2B20Quantiles_+3A_is.sim">is.sim</code></td>
<td>

<p>logical. If <code>TRUE</code> (default if <code>n</code> &lt; 10,000) the quantile is determined via Monte Carlo simulations, which might take a long time; otherwise (default if <code>n</code> &gt;= 10,000) it uses the quantile with <code>n</code> = 10,000, which has been precomputed and stored.
</p>
</td></tr>
<tr><td><code id="Multiscale+2B20Quantiles_+3A_intv">intv</code></td>
<td>

<p>a data frame provides the system of intervals on which the multiscale statistic is defined. The data frame constains the following two columns   
</p>
<p><code>left</code> left index of an interval
</p>
<p><code>right</code> right index of an interval
</p>
<p>By default, it is set to the sparse interval system proposed by Rivera and Walther (2013), see <code><a href="#topic+genIntv">genIntv</a></code> and also Li et al. (2016).
</p>
</td></tr>
<tr><td><code id="Multiscale+2B20Quantiles_+3A_mode">mode</code></td>
<td>

<p><code>"Con"</code> for continuous distribution functions (default)
</p>
<p><code>"Gen"</code> for general (possibly with discontinuous) distribution functions
</p>
<p>See Li et al. (2016) for further details.
</p>
</td></tr>
<tr><td><code id="Multiscale+2B20Quantiles_+3A_...">...</code></td>
<td>

<p>further arguments passed to function <code><a href="stats.html#topic+quantile">quantile</a></code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Empirically, it turns out that the quantile of the multiscale statistic converges fast to that of the limit distribution as the number of observations <code>n</code> increases. Thus, for the sake of computational efficiency, the quantile with <code>n</code> = 10,000 are used by default for that with <code>n</code> &gt; 10,000, which has already been precomputed and stored. Of course, for arbitrary sample size <code>n</code>, one can always simulate the quantile by setting  <code>is.sim = TRUE</code>, and use the precomputed value by setting <code>is.sim = FALSE</code>. For a given sample size <code>n</code>, simulations are once computed, and then automatically recorded in the R memory for later usage. For memory efficiency, only the last simulation is stored.  
</p>


<h3>Value</h3>

<p>A vector of length <code>length(alpha)</code> is returned, the same structure as returned by funtion <code><a href="stats.html#topic+quantile">quantile</a></code> with option <code><a href="base.html#topic+names">names</a> = FALSE</code>; The values are the (1-<code>alpha</code>)-quantile(s) of the null distribution of the multiscale statistic via Monte Carlo simulation, corresponding to (1-<code>alpha</code>)-confidence level(s). See Li et al. (2016) for further details.
</p>


<h3>Note</h3>

<p>All the printing messages can be disabled by calling <code><a href="base.html#topic+suppressMessages">suppressMessages</a></code>.
</p>


<h3>References</h3>

<p>Li, H., Munk, A., Sieling, H., and Walther, G. (2016). The essential histogram. arXiv:1612.07216.
</p>
<p>Rivera, C., &amp; Walther, G. (2013). Optimal detection of a jump in the intensity of a Poisson process or in a density with likelihood ratio statistics. Scand. J. Stat. 40, 752&ndash;769.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+checkHistogram">checkHistogram</a></code>,
<code><a href="#topic+essHistogram">essHistogram</a></code>,
<code><a href="#topic+genIntv">genIntv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n    = 100 # number of observations
nsim = 100 # number of simulations

alpha = c(0.1, 0.9) # significance level
q     = msQuantile(n, alpha, nsim)

print(q)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
