<!DOCTYPE html><html lang="en"><head><title>Help for package bcrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bcrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bcrm-package'><p>Bayesian Continual Reassessment Method for Phase I Dose-Escalation Trials</p></a></li>
<li><a href='#bcrm'><p>Bayesian Continual Reassessment Method for Phase I Dose-Escalation Trials</p></a></li>
<li><a href='#find.x'><p>Obtain samples from the maximum tolerated dose (MTD) distribution.</p></a></li>
<li><a href='#getprior'><p>Samples from the specified prior distribution.</p></a></li>
<li><a href='#plot.bcrm'><p>Plot the estimated dose-toxicity curve</p></a></li>
<li><a href='#plot.bcrm.sim'><p>Plot the operating characteristics from the simulated trials</p></a></li>
<li><a href='#plot.threep3'><p>Plot the operating characteristics from a standard 3+3 trial</p></a></li>
<li><a href='#Posterior.BRugs'><p>Returns samples from the posterior distributions of each model parameter using OpenBUGS.</p></a></li>
<li><a href='#Posterior.exact'><p>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level</p></a></li>
<li><a href='#Posterior.exact.sim'><p>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level</p></a></li>
<li><a href='#Posterior.R2WinBUGS'><p>Returns samples from the posterior distributions of each model parameter using WinBUGS</p></a></li>
<li><a href='#Posterior.rjags'><p>Returns samples from the posterior distributions of each model parameter using JAGS.</p></a></li>
<li><a href='#print.bcrm'><p>Print information regarding a trial conducted using the Bayesian continuous</p>
reassessment method</a></li>
<li><a href='#print.threep3'><p>Print information regarding the operating characteristics of a standard 3+3</p>
design</a></li>
<li><a href='#threep3'><p>Calculate all possible trial pathways for the standard 3+3 design,  together</p>
with their probability of occurring</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Continual Reassessment Method for Phase I
Dose-Escalation Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-07-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Graham Wheeler &lt;graham.wheeler@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a wide variety of one- and two-parameter Bayesian CRM
    designs. The program can run interactively, allowing the user to enter outcomes
    after each cohort has been recruited, or via simulation to assess operating
    characteristics. See Sweeting et al. (2013): &lt;<a href="https://doi.org/10.18637%2Fjss.v054.i13">doi:10.18637/jss.v054.i13</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, mvtnorm, rlang, ggplot2 (&ge; 1.0.1), grid,
knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BRugs, R2WinBUGS, rjags</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mikesweeting/bcrm">https://github.com/mikesweeting/bcrm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mikesweeting/bcrm/issues">https://github.com/mikesweeting/bcrm/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-19 09:43:22 UTC; wheel</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Sweeting [aut],
  Graham Wheeler [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-23 13:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='bcrm-package'>Bayesian Continual Reassessment Method for Phase I Dose-Escalation Trials</h2><span id='topic+bcrm-package'></span>

<h3>Description</h3>

<p>Implements a wide variety of Bayesian CRM designs. The program can run
interactively, allowing the user to enter outcomes after each cohort has
been recruited, or via simulation to assess operating characteristics.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> bcrm</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.5.1</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2019-04-03</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad:
</td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:michael.sweeting@leicester.ac.uk">michael.sweeting@leicester.ac.uk</a>
</p>
<p>Graham Wheeler <a href="mailto:graham.wheeler@ucl.ac.uk">graham.wheeler@ucl.ac.uk</a>
</p>
<p>Maintainer: Graham Wheeler <a href="mailto:graham.wheeler@ucl.ac.uk">graham.wheeler@ucl.ac.uk</a>
</p>


<h3>References</h3>

<p>Sweeting M., Mander A., Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>

<hr>
<h2 id='bcrm'>Bayesian Continual Reassessment Method for Phase I Dose-Escalation Trials</h2><span id='topic+bcrm'></span>

<h3>Description</h3>

<p>Implements a wide variety of Bayesian CRM designs,  including 1-parameter, 
2-parameter and Escalation With Overdose Control (EWOC) designs. The program
can run interactively,  allowing the user to enter outcomes after each cohort
has been recruited,  or via simulation to assess operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcrm(stop = list(nmax = NULL, nmtd = NULL, precision = NULL, nmin = NULL,
  safety = NULL), data = NULL, p.tox0 = NULL, sdose = NULL,
  dose = NULL, ff, prior.alpha, cohort = 3, target.tox,
  constrain = TRUE, only.below = FALSE, sdose.calculate = "mean",
  pointest = "plugin", tox.cutpoints = NULL, loss = NULL,
  start = NULL, simulate = FALSE, nsims = 1, truep = NULL,
  threep3 = FALSE, threep3.start = 1, threep3.esc.only = FALSE,
  method = "exact", burnin.itr = 2000, production.itr = 2000,
  bugs.directory = "c:/Program Files/WinBUGS14/", plot = FALSE,
  seed = NULL, quietly = 10, file = NULL, N, tox, notox)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcrm_+3A_stop">stop</code></td>
<td>
<p>A list of stopping rules for the trial. One or more of the
following options should be specified </p>
 <dl>
<dt>list(&quot;nmax&quot;)</dt><dd><p> The
maximum sample size of the trial</p>
</dd> <dt>list(&quot;safety&quot;)</dt><dd><p>Stops the trial if
the posterior probability of the lowest dose being above the target toxicity
level is greater than this number</p>
</dd> <dt>list(&quot;nmtd&quot;)</dt><dd><p> The maximum number
to be treated at final maximum tolerated dose (MTD) estimate,  <em>i.e.</em> if
the next recommended dose has already been administered to <code>nmtd</code>
patients then the trial will stop</p>
</dd> <dt>list(&quot;precision&quot;)</dt><dd><p> A vector of the
lower and upper percentage points that the MTD 95% credible intervals for
the risk of toxicity should lie within</p>
</dd> <dt>list(&quot;nmin&quot;)</dt><dd><p> The minimum
sample size of the trial. To be used in conjunction with <code>nmtd</code> or
<code>precision</code></p>
</dd> </dl>
</td></tr>
<tr><td><code id="bcrm_+3A_data">data</code></td>
<td>
<p>A named data frame giving information about dose and toxicity
from previously recruited patients. If missing,  then it is assumed that no
data have thus far been collected. Contains the following variables:
</p>
 <dl>
<dt>list(&quot;patient&quot;)</dt><dd><p> Recruited patient numbers, 
<code>1, ..., n</code></p>
</dd> <dt>list(&quot;dose&quot;)</dt><dd><p> Dose levels of recruited patients, 
ranging from <code>1, ..., k</code></p>
</dd> <dt>list(&quot;tox&quot;)</dt><dd><p> An indicator variable for
each patient (1=toxicity,  0=no toxicity)</p>
</dd> </dl>
</td></tr>
<tr><td><code id="bcrm_+3A_p.tox0">p.tox0</code></td>
<td>
<p>A vector of length <code>k</code> listing the prior probabilities of
experiencing the outcome at each dose level <code>1, ...k</code> (CRM &quot;skeleton&quot;).
The standardised dose levels are formed from these probabilities using the
inverse of the functional form,  with a plug-in estimate for the prior mean
or median of alpha,  as specified in <code>ff</code>,  <code>prior.alpha</code> and
<code>sdose.calculate</code>. Alternatively standardised dose levels can be given
directly using <code>sdose</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model. Only required if <code>p.tox0</code> is missing.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_dose">dose</code></td>
<td>
<p>Optional vector of length <code>k</code> of actual doses for plotting
purposes</p>
</td></tr>
<tr><td><code id="bcrm_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="bcrm_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_cohort">cohort</code></td>
<td>
<p>The size of each cohort of patients that are sequentially
recruited to the trial. Defaults to 3</p>
</td></tr>
<tr><td><code id="bcrm_+3A_target.tox">target.tox</code></td>
<td>
<p>The target toxicity probability. Defaults to 1/3.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_constrain">constrain</code></td>
<td>
<p>Should a dose-skipping constraint be placed on the
escalation procedure, as imposed by a modified CRM? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_only.below">only.below</code></td>
<td>
<p>Should the dose chosen for the next patient be that with
the largest risk of DLT that is not greater than the target (TRUE), or the
dose that is closest to the target (FALSE); defaults to FALSE. If TRUE, and no
dose has risk of DLT below or equal to target, the dose chosen will be the lowest
dose level UNLESS one of the pre-defined stopping criteria is satisfied.
NOTE: <code>only.below</code> applies when <code>loss = NULL</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_sdose.calculate">sdose.calculate</code></td>
<td>
<p>What plug-in estimate of the prior alpha should be
used to calculate the standardised doses? Options are <code>"mean"</code>
(default) or <code>"median"</code>. Only required if <code>sdose</code> is missing.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_pointest">pointest</code></td>
<td>
<p>Which summary estimate of the posterior distribution should
be used to choose the next dose. Options are <code>"plugin"</code> (default) where
the posterior mean of the model parameter(s) is plugged into the function
form to obtain estimates of toxicity,  or <code>"mean"</code> where the posterior
mean probabilities of toxicity are directly used. Alternatively,  a number
between 0 and 1 can be specified representing the quantile of the maximum
tolerated dose (MTD) posterior distribution (e.g. 0.5 specifies the
posterior median). This produces an Escalation With Overdose Control (EWOC)
design if the quantile is less than 0.5 (see details). Currently,  EWOC
designs must be fit using MCMC methods.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_tox.cutpoints">tox.cutpoints</code></td>
<td>
<p>A vector of cutpoints for toxicity intervals if these
are to be used to choose next dose. Defaults to NULL. For example
Underdosing [0, 0.2],  Target dosing (0.2,  0.35],  Excessive toxicity (0.35, 
0.60],  Unacceptable toxicity (0.60,  1.00] set
<code>tox.cutpoints=c(0.2, 0.35, 0.60)</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_loss">loss</code></td>
<td>
<p>A vector of length <code>length(tox.cutpoints)+1</code> specifying the
losses associated with each toxicity interval,  e.g. Underdosing = 1,  Target
dosing = 0,  Excessive toxicity = 1,  Unacceptable toxicity = 2.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_start">start</code></td>
<td>
<p>Dose level to be used at the beginning of the trial. Required if
<code>constrain=TRUE</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_simulate">simulate</code></td>
<td>
<p>Should a simulation be conducted to assess operating
characteristics? Defaults to <code>TRUE</code>. If <code>FALSE</code>,  a single CRM
trial is run interactively,  allowing the user to input outcomes after each
cohort is recruited.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_nsims">nsims</code></td>
<td>
<p>Number of simulations to perform if <code>simulate==TRUE</code>
(defaults to 1).</p>
</td></tr>
<tr><td><code id="bcrm_+3A_truep">truep</code></td>
<td>
<p>A vector of length k giving the true probabilities of the
outcome (toxicity) at each dose level <code>1, ..., k</code> in order to simulate
data. Only required if <code>simulate=TRUE</code></p>
</td></tr>
<tr><td><code id="bcrm_+3A_threep3">threep3</code></td>
<td>
<p>Should operating characteristics of a standard 3+3 rule-based
design be calculated,  for comparison with <code>bcrm</code> design? Defaults to
<code>FALSE</code>. Only used in a simulation study,  i.e. when
<code>simulate=TRUE</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_threep3.start">threep3.start</code></td>
<td>
<p>Starting dose level for when <code>threep3 = TRUE</code>. Defaults to 1, i.e. the lowest dose level</p>
</td></tr>
<tr><td><code id="bcrm_+3A_threep3.esc.only">threep3.esc.only</code></td>
<td>
<p>Whether to forbid de-escalation of doses when <code>threep3 = TRUE</code>. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="bcrm_+3A_method">method</code></td>
<td>
<p>Optimisation method: options are <code>"exact"</code> (the default), 
<code>"rjags"</code>,  <code>"BRugs"</code>,  or <code>"R2WinBUGS"</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_burnin.itr">burnin.itr</code></td>
<td>
<p>Number of burn-in iterations (default 2000).</p>
</td></tr>
<tr><td><code id="bcrm_+3A_production.itr">production.itr</code></td>
<td>
<p>Number of production iterations (default 2000).</p>
</td></tr>
<tr><td><code id="bcrm_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>Directory that contains the WinBUGS executable if
<code>method="R2WinBUGS"</code>. Defaults to &quot;C:/Program Files/WinBUGS14/&quot;.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_plot">plot</code></td>
<td>
<p>Should the dose-response curve be plotted after each cohort has
been entered? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_seed">seed</code></td>
<td>
<p>Integer defining the state of the random number generator to
allow reproducible results. The default is to not specify a seed.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_quietly">quietly</code></td>
<td>
<p>How often to send a message back indicating how many
simulated trials have been performed. Defaults to <code>quietly = 10</code>
and the function reports back after every 10th simulation.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_file">file</code></td>
<td>
<p>File name where the dose-response plots are stored,  in a pdf
format. The program will amend the current sample size to the end of the
file name.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_n">N</code></td>
<td>
<p>Final sample size (deprecated). To be replaced with <code>stop</code> in
future versions.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_tox">tox</code></td>
<td>
<p>(Deprecated). A vector of length <code>k</code> listing the number of
patients who have experienced the outcome (toxicity) at each dose level
<code>1, ..., k</code>.</p>
</td></tr>
<tr><td><code id="bcrm_+3A_notox">notox</code></td>
<td>
<p>(Deprecated). A vector of length <code>k</code> listing the number of
patients who have not experienced the outcome (toxicity) at each dose level
<code>1, ..., k</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bcrm</code> implements a Bayesian continual reassessment method (CRM)
(O'Quigley <em>et al.</em>,  1990); an adaptive design in which cohorts of
patients are sequentially recruited into a Phase I trial. A binary toxicity
outcome is assumed (e.g. Dose Limiting Toxicity / No Dose Limiting
Toxicity). The current cohort are given a dose &quot;closest&quot; to the specified
target toxicity level,  as estimated from the posterior distributions of
toxicity at each dose level from the patients thus far recruited. If
<code>pointest="mean"</code> then the posterior mean probability of toxicity is
used to choose the next dose. If <code>pointest="plugin"</code>,  however,  the
posterior mean of the model parameter(s) is plugged-into the functional form
of the dose-toxicity model. To implement an EWOC design (Babb <em>et al.</em>, 
1998),  <code>pointest</code> should be a quantile,  <em>q</em>,  between 0 and 0.5.
The posterior distribution of the MTD (the dose in which the probability of
toxicity is equal to the target toxicity) is then calculated and the next
patient is given dose closest to the <em>q</em>th quantile of the MTD
distribution.
</p>
<p>Alternatively,  escalation can be based on intervals of toxicity from the
posterior distribution using a loss function,  see Neuenschwander <em>et
al.</em>,  2008. To implement this approach,  the user should specify the
cutpoints of the toxicity intervals using <code>tox.cutpoints</code> and the
associated losses using <code>loss</code>.
</p>
<p>The possible choice of dose-toxicity model can be specified using <code>ff</code>, 
and includes the 1-parameter hyperbolic tangent,  logistic or power &quot;working
models&quot;,  and the 2-parameter logistic model as follows: </p>

<dl>
<dt>Hyperbolic
Tangent</dt><dd><p style="text-align: center;"><code class="reqn">p(Tox|d^*)=\left[(tanh(d^*)+1)/2\right]^\alpha</code>
</p>
</dd>
<dt>Logistic (1-parameter)</dt><dd><p style="text-align: center;"><code class="reqn">p(Tox|d^*)=\frac{\exp(3+\alpha
d^*)}{1+\exp(3+\alpha d^*)}</code>
</p>
</dd> <dt>Power</dt><dd><p style="text-align: center;"><code class="reqn">p(Tox|d^*)={d^*}^\alpha</code>
</p>
</dd>
<dt>Logistic
(2-parameter)</dt><dd><p style="text-align: center;"><code class="reqn">p(Tox|d^*)=\frac{\exp(\log(\alpha_1)+\alpha_2
d^*)}{1+\exp(\log(\alpha_1)+\alpha_2 d^*)}</code>
</p>
</dd> </dl>
<p> where <code class="reqn">\alpha&gt;0</code> is the single positive-valued parameter for
the 1-parameter models,  and <code class="reqn">\log(\alpha_1)</code> and
<code class="reqn">\alpha_2&gt;0</code> are the intercept and slope parameters of the 2-parameter
model.
</p>
<p>The standardised doses,  <code class="reqn">d^*</code>,  are specified by the user using
<code>sdose</code>,  or alternatively the prior probability of toxicity at each
dose level is specified using <code>p.tox0</code>. If the latter is used,  then the
standardised doses are calculated using the inverse of the functional form
and a plug-in estimate of the prior mean or median,  as specified in
<code>sdose.calculate</code>,  as follows </p>
<p style="text-align: center;"><code class="reqn">d^* = f^{-1}(\code{p.tox0}, \alpha=
a)</code>
</p>
<p> where <code class="reqn">f^{-1}</code> is the the inverse of
the chosen functional form,  and the parameter(s) of the model are set equal
to <code class="reqn">a</code>,  either the prior mean or median of <code class="reqn">\alpha</code>.
</p>
<p>Data that have already been accrued can be entered using the <code>data</code>
argument. A constrained CRM design can be implemented using
<code>constrain=TRUE</code>,  in which case dose-skipping is prohibited (i.e. the
next cohort can only be dosed up to one dose level above the current
cohort). If a constrained model is used then the starting dose must be
specified using <code>start</code>. Alternatively, if data have already been
accrued,  then the dose level of the last recruited patient determines the
constraint for the next patient.
</p>
<p>The prior is set using <code>prior.alpha</code>. For example
<code>prior.alpha=list(1, 1, 1)</code> specifies a Gamma prior with shape and scale
parameters both equal to one (<em>i.e.</em> an Exponential(1) distribution), 
whilst <code>prior.alpha=list(2, 0, 10)</code> specifies a Uniform(0, 10) prior.
</p>
<p>To specify a fixed maximum sample size of size <code>m</code> use
<code>stop=list(nmax=m)</code>. Alternatively,  the trial can stop after <code>m2</code>
patients have been treated at the current MTD estimate,  by setting
<code>stop=list(nmtd=m2)</code>.
</p>
<p>To implement a safety constraint as specified in Zohar and Chevret (2001)
specify <code>stop=list(safety=p)</code>,  where the trial is stopped if the
posterior probability that the lowest dose is greater than the target
toxicity probability is greater than <code>p</code>.
</p>
<p>To stop the trial when the MTD estimate is within a certain level of
precision,  use <code>stop=list(precision=c(l, u))</code>,  where <code>l</code> and
<code>u</code> are the lower and upper percentage points that the MTD 95%
credible intervals for the risk of toxicity should lie within. Finally,  to
prevent the trial stopping too early using these rules,  the argument
<code>stop=list(nmin=m3)</code> can be used to ensure the sample size is greater
than or equal to <code>m3</code>. Stopping rules can be used on their own or in
combination.
</p>
<p>The trial can be run interactively using <code>simulate=FALSE</code>,  where the
user enters the outcomes for each new cohort,  or as a simulation study when
<code>simulate=TRUE</code>.
</p>
<p>The default calculations use exact methods (<code>method="exact"</code>) to
calculate the mean and quantiles for the posterior distributions. There are
three choices for MCMC calculations: <code>method="rjags"</code>, 
<code>method="BRugs"</code> or <code>method="R2WinBUGS"</code>. The first uses the JAGS
software,  the second uses OpenBUGS,  whilst the latter uses WinBUGS. To
implement these methods,  users require one or more of these packages to be
installed on their system.
</p>
<p>A simulated <code>bcrm</code> design can be compared with the standard 3+3
rule-based method,  see <code><a href="#topic+threep3">threep3</a></code> for more details.
</p>


<h3>Value</h3>

<p><code>bcrm</code> returns an object of class &quot;bcrm&quot; or &quot;bcrm.sim&quot;; the
latter occurring when a simulation has been conducted
(<code>simulate=TRUE</code>). The function <code><a href="base.html#topic+print">print</a></code> (i.e.
<code><a href="#topic+print.bcrm">print.bcrm</a></code> or <code><a href="#topic+print.bcrm.sim">print.bcrm.sim</a></code>) can be used to
obtain summary information about the design used,  the data observed,  current
posterior estimates of toxicity,  and the next recommended dose level.
</p>
<p>An object of class &quot;bcrm&quot; is a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>dose</code></td>
<td>
<p>Range of doses</p>
</td></tr> <tr><td><code>sdose</code></td>
<td>
<p>Standardised doses</p>
</td></tr> <tr><td><code>tox</code></td>
<td>
<p>A
vector of length <code>k</code> listing the number of patients who have
experienced the outcome (toxicity) at each dose level <code>1, ..., k</code></p>
</td></tr>
<tr><td><code>notox</code></td>
<td>
<p>A vector of length <code>k</code> listing the number of patients who
have not experienced the outcome (toxicity) at each dose level
<code>1, ..., k</code></p>
</td></tr> <tr><td><code>ndose</code></td>
<td>
<p>A list of lists containing for each cohort the
components <code>ndose</code>,  the dose level recommended for the next patient, 
<code>est</code>,  the estimated probabilities of toxicity using the chosen metric
(e.g. plugin,  mean,  quantile),  <code>mean</code>,  the posterior mean probability
of toxicity at each dose,  <code>sd</code>,  the posterior standard deviation for
probability of toxicity at each dose,  <code>quantiles</code>,  the posterior
quantiles for probability of toxicity at each dose. This information is only
provided for cohorts recruited subsequent to any data given using <code>tox</code>
and <code>notox</code>. The first component relates to the prior information.</p>
</td></tr>
<tr><td><code>constrain</code></td>
<td>
<p>Whether a constrained CRM design was used</p>
</td></tr> <tr><td><code>start</code></td>
<td>
<p>The
starting dose for the latest run of the model if <code>constrain=TRUE</code></p>
</td></tr>
<tr><td><code>target.tox</code></td>
<td>
<p>The target toxicity level</p>
</td></tr> <tr><td><code>ff</code></td>
<td>
<p>The functional form of
the dose-toxicity model;  &quot;ht&quot; = Hyperbolic tangent,  &quot;logit1&quot; = 1-parameter
logistic,  &quot;power&quot; = Power,  &quot;logit2&quot; = 2-parameter logistic</p>
</td></tr> <tr><td><code>method</code></td>
<td>
<p>The calculation
method used</p>
</td></tr> <tr><td><code>pointest</code></td>
<td>
<p>The summary estimate used to choose the next
dose,  see <code>pointest</code></p>
</td></tr> <tr><td><code>prior.alpha</code></td>
<td>
<p>Information about the prior
used for <code class="reqn">alpha</code>,  see <code>prior.alpha</code></p>
</td></tr> <tr><td><code>data</code></td>
<td>
<p>A data frame with
variables &lsquo;patient&rsquo;,  &lsquo;dose&rsquo; and &lsquo;tox&rsquo; listing the dose levels and outcomes
of all patients in the trial</p>
</td></tr>
</table>
<p>An object of class &quot;bcrm.sim&quot; is a list of length <code>nsims</code>. Each
component is itself a list with components similar to those obtained from a
&quot;bcrm&quot; object. The print function,  <code><a href="#topic+print.bcrm.sim">print.bcrm.sim</a></code> should be
used to obtain operating characteristics from the simulation.
</p>


<h3>Note</h3>

<p>Currently,  the re-parameterisation of the two-parameter model proposed
by (Babb <em>et al.</em>,  1998) is not implemented. Therefore,  users wishing
to implement an EWOC design should check whether their choice of prior for
the model parameter(s) translates to a sensible prior for the MTD
distribution before they implement the design. For example </p>
<pre>
prior.alpha &lt;- list(1, 1, 1); ff &lt;- "ht"; target.tox &lt;- 0.2
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha) hist(mtd) </pre>
<p>One-parameter models are designed as working models only,  and should not be
used with an escalation strategy based on intervals of the posterior
probabilities of toxicity.
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting (University of Leicester, UK; <a href="mailto:michael.sweeting@leicester.ac.uk">michael.sweeting@leicester.ac.uk</a>)
and Graham Wheeler (University College London, UK; <a href="mailto:graham.wheeler@ucl.ac.uk">graham.wheeler@ucl.ac.uk</a>),
drawing on code originally developed by J. Jack Lee and Nan Chen,
Department of Biostatistics, University of Texas M.D. Anderson Cancer Center.
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>
<p>O'Quigley J.,  Pepe M.,  Fisher L. Continual reassessment method: a practical
design for phase I clinical trials in cancer. <em>Biometrics</em> (1990) 46:
33&ndash;48.
</p>
<p>Babb J.,  Rogatko A.,  Zacks S. Cancer phase I clinical trials: efficient dose
escalation with overdose control. <em>Statistics in Medicine</em> (1998) 17:
1103&ndash;1120.
</p>
<p>Neuenschwander B.,  Branson M.,  Gsponer T. Critical aspects of the Bayesian
approach to phase I cancer trials. <em>Statistics in Medicine</em> (2008) 27:
2420&ndash;2439.
</p>
<p>Zohar S.,  Chevret S. The continual reassessment method: comparison of
Bayesian stopping rules for dose-ranging studies. <em>Statistics in
Medicine</em> (2001) 20: 2827&ndash;2843.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.bcrm">print.bcrm</a></code>,  <code><a href="#topic+print.bcrm.sim">print.bcrm.sim</a></code>, 
<code><a href="#topic+plot.bcrm">plot.bcrm</a></code>,  <code><a href="#topic+plot.bcrm.sim">plot.bcrm.sim</a></code>,  <code><a href="#topic+threep3">threep3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
data &lt;- data.frame(patient=1:18, dose=rep(c(1:4, 7), c(3, 4, 5, 4, 2)), tox=rep(0:1, c(16, 2)))
## Target toxicity level
target.tox &lt;- 0.30

## A 1-parameter power model is used,  with standardised doses calculated using 
## the plug-in prior median
## Prior for alpha is lognormal with mean 0 (on log scale) 
## and standard deviation 1.34 (on log scale)
## The recommended dose for the next cohort if posterior mean is used
## Not run: 
Power.LN.bcrm &lt;- bcrm(stop=list(nmax=18), data=data, p.tox0=p.tox0, dose=dose
  , ff="power", prior.alpha=list(3, 0, 1.34^2), target.tox=target.tox, constrain=FALSE
  , sdose.calculate="median", pointest="mean")
print(Power.LN.bcrm)
plot(Power.LN.bcrm)

## End(Not run)

## Simulate 10 replicate trials of size 36 (cohort size 3) using this design 
## with constraint (i.e. no dose-skipping) and starting at lowest dose
## True probabilities of toxicity are set to pre-specified probabilities (p.tox0) 
## Not run: 
Power.LN.bcrm.sim &lt;- bcrm(stop=list(nmax=36), p.tox0=p.tox0, dose=dose, ff="power"
  , prior.alpha=list(3, 0, 1.34^2), target.tox=target.tox, constrain=TRUE
  , sdose.calculate="median", pointest="mean", start=1, simulate=TRUE, nsims=10, truep=p.tox0)
print(Power.LN.bcrm.sim)
plot(Power.LN.bcrm.sim)

## End(Not run)

## Comparing this CRM design with the standard 3+3 design 
## (only considering the first 12 dose levels)
## Not run: 
Power.LN.bcrm.compare.sim &lt;- bcrm(stop=list(nmax=36), p.tox0=p.tox0[1:12], dose=dose[1:12]
  , ff="power", prior.alpha=list(3, 0, 1.34^2), target.tox=target.tox, constrain=TRUE
  , sdose.calculate="median", pointest="mean", start=1, simulate=TRUE, nsims=50
  , truep=p.tox0[1:12], threep3=TRUE)
print(Power.LN.bcrm.compare.sim, threep3=TRUE)
plot(Power.LN.bcrm.compare.sim, threep3=TRUE)

## End(Not run)

## A 2-parameter model,  using priors as specified in Neuenschwander et al 2008.
## Posterior mean used to choose the next dose
## Standardised doses using reference dose,  250mg
sdose &lt;- log(dose/250)
## Bivariate lognormal prior for two parameters
mu &lt;- c(2.15, 0.52)
Sigma &lt;- rbind(c(0.84^2, 0.134), c(0.134, 0.80^2))
## Using rjags (requires JAGS to be installed)
## Not run: 
TwoPLogistic.mean.bcrm &lt;- bcrm(stop=list(nmax=18), data=data, sdose=sdose
  , dose=dose, ff="logit2", prior.alpha=list(4, mu, Sigma), target.tox=target.tox
  , constrain=FALSE, pointest="mean", method="rjags")
print(TwoPLogistic.mean.bcrm)
plot(TwoPLogistic.mean.bcrm)

## End(Not run)

## A 2-parameter model,  using an EWOC design with feasibility bound (MTD quantile) 
## of 0.25 to choose the next dose
## Using rjags (requires JAGS to be installed)
## Not run: 
TwoPLogistic.EWOC0.25.bcrm &lt;- bcrm(stop=list(nmax=18), data=data, sdose=sdose, dose=dose
    , ff="logit2", prior.alpha=list(4, mu, Sigma), target.tox=target.tox, constrain=FALSE
    , pointest=0.25, method="rjags")
print(TwoPLogistic.EWOC0.25.bcrm)
plot(TwoPLogistic.EWOC0.25.bcrm)

## End(Not run)

## A 2-parameter model,  using a loss function based on intervals of toxicity to choose
## the next dose
## Using rjags (requires JAGS to be installed)
## Not run: 
## Toxicity cut-points
tox.cutpoints &lt;- c(0.2, 0.35, 0.6)
## Losses associated with toxicity intervals 
## [0, 0.2]=1,  (0.2, 0.35]=0,  (0.35, 0.6]=1,  (0.6, 1]=2
loss &lt;- c(1, 0, 1, 2)
TwoPLogistic.tox.intervals.bcrm &lt;- bcrm(stop=list(nmax=18), data=data, sdose=sdose
  , dose=dose, ff="logit2", prior.alpha=list(4, mu, Sigma), target.tox=target.tox
  , constrain=FALSE, tox.cutpoints=tox.cutpoints, loss=loss, method="rjags")
print(TwoPLogistic.tox.intervals.bcrm)
plot(TwoPLogistic.tox.intervals.bcrm)
## Greater loss associated with overdosing and unacceptable toxicity
## [0, 0.2]=1,  (0.2, 0.35]=0,  (0.35, 0.6]=2,  (0.6, 1]=4
loss2 &lt;- c(1, 0, 2, 4)
TwoPLogistic.tox.intervals.2.bcrm &lt;- bcrm(stop=list(nmax=18), data=data, sdose=sdose
  , dose=dose, ff="logit2", prior.alpha=list(4, mu, Sigma), target.tox=target.tox
  , constrain=FALSE, tox.cutpoints=tox.cutpoints, loss=loss2, method="rjags")
print(TwoPLogistic.tox.intervals.2.bcrm)
plot(TwoPLogistic.tox.intervals.2.bcrm)

## End(Not run)


</code></pre>

<hr>
<h2 id='find.x'>Obtain samples from the maximum tolerated dose (MTD) distribution.</h2><span id='topic+find.x'></span>

<h3>Description</h3>

<p>Given a posterior (or prior) sample of the parameters,  this function inverts
the given functional form to obtain samples from the MTD distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.x(ff, ptox, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find.x_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="find.x_+3A_ptox">ptox</code></td>
<td>
<p>The required probability of DLT. For example,  if the MTD
distribution is sought then set <code>ptox</code> to the target toxicity level.</p>
</td></tr>
<tr><td><code id="find.x_+3A_alpha">alpha</code></td>
<td>
<p>A sample from the posterior (or prior) distribution of the
parameter(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a posterior (or prior) sample of the parameters,  this function inverts
the given functional form to obtain samples from the MTD distribution or any
other targeted quantile.
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+getprior">getprior</a></code>,  <code><a href="#topic+Posterior.exact">Posterior.exact</a></code>,  <code><a href="#topic+Posterior.BRugs">Posterior.BRugs</a></code>,  <code><a href="#topic+Posterior.R2WinBUGS">Posterior.R2WinBUGS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)

## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
## Using rjags
## Not run: 
posterior.samples &lt;- Posterior.rjags(tox, notox, sdose, ff, prior.alpha
  , burnin.itr=2000, production.itr=2000)
posterior.mtd &lt;- find.x(ff, target.tox, alpha=posterior.samples)
hist(posterior.mtd)

## End(Not run)


</code></pre>

<hr>
<h2 id='getprior'>Samples from the specified prior distribution.</h2><span id='topic+getprior'></span>

<h3>Description</h3>

<p>A sample of specified size is obtained from the prior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getprior(prior.alpha, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getprior_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="getprior_+3A_n">n</code></td>
<td>
<p>The number of samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A vector of size <code>n</code> is returned from the specified prior distribution.
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
prior.alpha &lt;- list(1, 1, 1)
samples.alpha &lt;- getprior(prior.alpha, 2000)
hist(samples.alpha)

</code></pre>

<hr>
<h2 id='plot.bcrm'>Plot the estimated dose-toxicity curve</h2><span id='topic+plot.bcrm'></span>

<h3>Description</h3>

<p>The estimated dose-toxicity curve using the Bayesian continuous reassessment
method is plotted for the patients thus far recruited into the trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcrm'
plot(x, file = NULL, each = FALSE, trajectory = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bcrm_+3A_x">x</code></td>
<td>
<p>An object of class &quot;bcrm&quot;,  as returned by <code><a href="#topic+bcrm">bcrm</a></code></p>
</td></tr>
<tr><td><code id="plot.bcrm_+3A_file">file</code></td>
<td>
<p>File name where the dose-response plots are stored,  in a pdf
format. The program will amend the current sample size to the end of the
file name.</p>
</td></tr>
<tr><td><code id="plot.bcrm_+3A_each">each</code></td>
<td>
<p>Should posterior summaries be plotted after each recruited
cohort? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.bcrm_+3A_trajectory">trajectory</code></td>
<td>
<p>Should the sequential dose trajectory of the recruited
patients be plotted,  along with the observed toxicities? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.bcrm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated 2.5%,  25%,  50%,  75%,  97.5% quantiles of the probability
of toxicity are plotted for each dose. Additionally,  a histogram of the
number of toxicities and non-toxicities is plotted at each experimented
dose.
</p>
<p>If <code>trajectory = TRUE</code> then the sequential dose trajectory and observed
toxicities are plotted.
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>
</p>

<hr>
<h2 id='plot.bcrm.sim'>Plot the operating characteristics from the simulated trials</h2><span id='topic+plot.bcrm.sim'></span>

<h3>Description</h3>

<p>Plots of the operating characteristics obtained from a CRM simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcrm.sim'
plot(x, trajectories = FALSE, file = NULL,
  threep3 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bcrm.sim_+3A_x">x</code></td>
<td>
<p>An object of class &quot;bcrm.sim&quot;,  as returned by <code><a href="#topic+bcrm">bcrm</a></code>
when conducting a simulation.</p>
</td></tr>
<tr><td><code id="plot.bcrm.sim_+3A_trajectories">trajectories</code></td>
<td>
<p>Should a summary plot of the trajectories of
administered dose levels be plotted? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.bcrm.sim_+3A_file">file</code></td>
<td>
<p>File name where the operating characteristic plot is stored,  in
a pdf format.</p>
</td></tr>
<tr><td><code id="plot.bcrm.sim_+3A_threep3">threep3</code></td>
<td>
<p>Should operating characteristics of a standard 3+3 rule-based
design be plotted alongside the <code>bcrm</code> design? Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.bcrm.sim_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the sample size distribution (if variable),  the
experimentation distribution,  the recommended dose distribution and the
percentage of subjects who experience the toxicity outcome (dose-limiting
toxicity). If <code>trajectories = TRUE</code> then summary statistics of
administered dose levels for each patient are plotted instead. If
<code>threep3 = TRUE</code> then the operating characteristics of the standard 3+3
design are plotted alongside those of the <code>bcrm</code> design (see
<code><a href="#topic+threep3">threep3</a></code> for more details).
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.bcrm.sim">print.bcrm.sim</a></code>,  <code><a href="#topic+bcrm">bcrm</a></code>, 
<code><a href="#topic+threep3">threep3</a></code>
</p>

<hr>
<h2 id='plot.threep3'>Plot the operating characteristics from a standard 3+3 trial</h2><span id='topic+plot.threep3'></span>

<h3>Description</h3>

<p>Plots of the operating characteristics obtained from a standard 3+3 trial, 
using <code><a href="#topic+threep3">threep3</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'threep3'
plot(x, file = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.threep3_+3A_x">x</code></td>
<td>
<p>An object of class &quot;threep3&quot;,  as returned by <code><a href="#topic+threep3">threep3</a></code>.</p>
</td></tr>
<tr><td><code id="plot.threep3_+3A_file">file</code></td>
<td>
<p>File name where the operating characteristic plot is stored,  in
a pdf format.</p>
</td></tr>
<tr><td><code id="plot.threep3_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the sample size distribution,  the experimentation
distribution,  the recommended dose distribution and the percentage of
subjects who experience the toxicity outcome (dose-limiting toxicity) for
the standard 3+3 trial.
</p>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+threep3">threep3</a></code>
</p>

<hr>
<h2 id='Posterior.BRugs'>Returns samples from the posterior distributions of each model parameter using OpenBUGS.</h2><span id='topic+Posterior.BRugs'></span>

<h3>Description</h3>

<p>If <code>ff = "logit2"</code> (i.e. a two-parameter logistic model is used), a matrix of dimensions
<code>production.itr</code>-by-2 is returned (the first and second columns containing the posterior samples for the
intercept and slope parameters respectively). Otherwise, a vector of length <code>production.itr</code>
is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Posterior.BRugs(tox, notox, sdose, ff, prior.alpha, burnin.itr,
  production.itr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Posterior.BRugs_+3A_tox">tox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patient who had toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_notox">notox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patients who did not have toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model.</p>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_burnin.itr">burnin.itr</code></td>
<td>
<p>Number of burn-in iterations (default 2000).</p>
</td></tr>
<tr><td><code id="Posterior.BRugs_+3A_production.itr">production.itr</code></td>
<td>
<p>Number of production iterations (default 2000).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)

## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
## Using BRugs
## Not run: 
posterior.samples &lt;- Posterior.BRugs(tox, notox, sdose, ff, prior.alpha
  , burnin.itr=2000, production.itr=2000)
  
## End(Not run)

</code></pre>

<hr>
<h2 id='Posterior.exact'>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level</h2><span id='topic+Posterior.exact'></span>

<h3>Description</h3>

<p>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Posterior.exact(tox, notox, sdose, ff, prior.alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Posterior.exact_+3A_tox">tox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patient who had toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.exact_+3A_notox">notox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patients who did not have toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.exact_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model.</p>
</td></tr>
<tr><td><code id="Posterior.exact_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="Posterior.exact_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)

## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
posterior.samples &lt;- Posterior.exact(tox, notox, sdose, ff, prior.alpha)

</code></pre>

<hr>
<h2 id='Posterior.exact.sim'>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level</h2><span id='topic+Posterior.exact.sim'></span>

<h3>Description</h3>

<p>Returns posterior mean parameter value and summaries of distributions for probability of DLT at each dose level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Posterior.exact.sim(tox, notox, sdose, ff, prior.alpha, pointest)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Posterior.exact.sim_+3A_tox">tox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patient who had toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.exact.sim_+3A_notox">notox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patients who did not have toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.exact.sim_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model.</p>
</td></tr>
<tr><td><code id="Posterior.exact.sim_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="Posterior.exact.sim_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="Posterior.exact.sim_+3A_pointest">pointest</code></td>
<td>
<p>Which summary estimate of the posterior distribution should
be used to choose the next dose. Options are <code>"plugin"</code> (default) where
the posterior mean of the model parameter(s) is plugged into the function
form to obtain estimates of toxicity,  or <code>"mean"</code> where the posterior
mean probabilities of toxicity are directly used. Alternatively,  a number
between 0 and 1 can be specified representing the quantile of the maximum
tolerated dose (MTD) posterior distribution (e.g. 0.5 specifies the
posterior median). This produces an Escalation With Overdose Control (EWOC)
design if the quantile is less than 0.5 (see details). Currently,  EWOC
designs must be fit using MCMC methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)
point.est &lt;- "plugin"
## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
posterior.samples &lt;- Posterior.exact.sim(tox, notox, sdose, ff, prior.alpha, point.est)

</code></pre>

<hr>
<h2 id='Posterior.R2WinBUGS'>Returns samples from the posterior distributions of each model parameter using WinBUGS</h2><span id='topic+Posterior.R2WinBUGS'></span>

<h3>Description</h3>

<p>If <code>ff = "logit2"</code> (i.e. a two-parameter logistic model is used), a matrix of dimensions
<code>production.itr</code>-by-2 is returned (the first and second columns containing the posterior samples for the
intercept and slope parameters respectively). Otherwise, a vector of length <code>production.itr</code>
is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Posterior.R2WinBUGS(tox, notox, sdose, ff, prior.alpha, burnin.itr,
  production.itr, bugs.directory)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Posterior.R2WinBUGS_+3A_tox">tox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patient who had toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_notox">notox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patients who did not have toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model.</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_burnin.itr">burnin.itr</code></td>
<td>
<p>Number of burn-in iterations (default 2000).</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_production.itr">production.itr</code></td>
<td>
<p>Number of production iterations (default 2000).</p>
</td></tr>
<tr><td><code id="Posterior.R2WinBUGS_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>directory that contains the WinBUGS executable,  defaults to C:/Program Files/WinBUGS14/</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)

## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
## Using R2WinBUGS
## Not run: 
posterior.samples &lt;- Posterior.R2WinBUGS(tox, notox, sdose, ff, prior.alpha
  , burnin.itr=2000, production.itr=2000, bugs.directory = "C:/Program Files/WinBUGS14/")
  
## End(Not run)

</code></pre>

<hr>
<h2 id='Posterior.rjags'>Returns samples from the posterior distributions of each model parameter using JAGS.</h2><span id='topic+Posterior.rjags'></span>

<h3>Description</h3>

<p>If <code>ff = "logit2"</code> (i.e. a two-parameter logistic model is used), a matrix of dimensions
<code>production.itr</code>-by-2 is returned (the first and second columns containing the posterior samples for the
intercept and slope parameters respectively). Otherwise, a vector of length <code>production.itr</code>
is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Posterior.rjags(tox, notox, sdose, ff, prior.alpha, burnin.itr,
  production.itr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Posterior.rjags_+3A_tox">tox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patient who had toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_notox">notox</code></td>
<td>
<p>A vector of length <code>k</code> showing the number of patients who did not have toxicities at each dose level</p>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_sdose">sdose</code></td>
<td>
<p>A vector of length <code>k</code> listing the standardised doses to
be used in the CRM model.</p>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_ff">ff</code></td>
<td>
<p>A string indicating the functional form of the dose-response
curve. Options are </p>
 <dl>
<dt>ht</dt><dd><p> 1-parameter hyperbolic tangent</p>
</dd>
<dt>logit1</dt><dd><p> 1-parameter logistic</p>
</dd> <dt>power</dt><dd><p> 1-parameter power</p>
</dd>
<dt>logit2</dt><dd><p> 2-parameter logistic</p>
</dd> </dl>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_prior.alpha">prior.alpha</code></td>
<td>
<p>A list of length 3 containing the distributional
information for the prior. The first element is a number from 1-4 specifying
the type of distribution. Options are </p>
 <ol>
<li><p> Gamma(a, b),  where
a=shape,  b=scale: mean=a*b,  variance=a*b*b </p>
</li>
<li><p> Uniform(a, b),  where a=min, 
b=max </p>
</li>
<li><p> Lognormal(a, b),  where a=mean on the log scale,  b=variance on the
log scale </p>
</li>
<li><p> Bivariate Lognormal(a, b),  where a=mean vector on the log
scale,  b=Variance-covariance matrix on the log scale. This prior should be
used only in conjunction with a two-parameter logistic model.  </p>
</li></ol>
<p> The second
and third elements of the list are the parameters a and b,  respectively.</p>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_burnin.itr">burnin.itr</code></td>
<td>
<p>Number of burn-in iterations (default 2000).</p>
</td></tr>
<tr><td><code id="Posterior.rjags_+3A_production.itr">production.itr</code></td>
<td>
<p>Number of production iterations (default 2000).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK),  drawing on code originally developed by J. Jack Lee and Nan
Chen,  Department of Biostatistics,  the University of Texas M. D. Anderson
Cancer Center
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+find.x">find.x</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
## Pre-specified probabilities of toxicity
## [dose levels 11-15 not specified in the paper,  and are for illustration only]
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050,
  0.100, 0.170, 0.300, 0.400, 0.500, 0.650, 0.800, 0.900)
## Data from the first 5 cohorts of 18 patients
tox &lt;- c(0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0)
notox &lt;- c(3, 4, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
## Target toxicity level
target.tox &lt;- 0.30

## Prior distribution for the MTD given a lognormal(0, 1.34^2) distribution for alpha
## and a power model functional form
prior.alpha &lt;- list(3, 0, 1.34^2)
ff &lt;- "power"
samples.alpha &lt;- getprior(prior.alpha, 2000)
mtd &lt;- find.x(ff, target.tox, alpha=samples.alpha)
hist(mtd)

## Standardised doses
sdose &lt;- find.x(ff, p.tox0, alpha=1)

## Posterior distribution of the MTD (on standardised dose scale) using data 
## from the cancer trial described in Neuenschwander et al 2008.
## Using rjags
## Not run: 
posterior.samples &lt;- Posterior.rjags(tox, notox, sdose, ff, prior.alpha
  , burnin.itr=2000, production.itr=2000)
  
## End(Not run)

</code></pre>

<hr>
<h2 id='print.bcrm'>Print information regarding a trial conducted using the Bayesian continuous
reassessment method</h2><span id='topic+print.bcrm'></span><span id='topic+print.bcrm.sim'></span>

<h3>Description</h3>

<p>Print method for a trial or series of trials conducted using a
<code><a href="#topic+bcrm">bcrm</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcrm'
print(x, tox.cutpoints = NULL, trajectories = FALSE,
  threep3 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcrm_+3A_x">x</code></td>
<td>
<p>An object of class &quot;bcrm&quot; or &quot;bcrm.sim&quot; as returned by
<code><a href="#topic+bcrm">bcrm</a></code></p>
</td></tr>
<tr><td><code id="print.bcrm_+3A_tox.cutpoints">tox.cutpoints</code></td>
<td>
<p>An optional argument passed to <code>print.bcrm.sim</code>
specifying the cutpoints of toxicity for which the operating characteristics
are to be categorised. Defaults to <code>seq(from=0, to=1, by=0.2)</code></p>
</td></tr>
<tr><td><code id="print.bcrm_+3A_trajectories">trajectories</code></td>
<td>
<p>Should the individual simulation dose and outcome
trajectories be returned? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="print.bcrm_+3A_threep3">threep3</code></td>
<td>
<p>Should operating characteristics of a standard 3+3 rule-based
design be displayed alongside those from the <code>bcrm</code> design? Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="print.bcrm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a single trial is conducted,  then the <code><a href="base.html#topic+print">print</a></code> function
currently produces summary information about the design used,  the data
observed,  current posterior estimates of toxicity,  and the next recommended
dose level.  If a simulation study is conducted,  then the following
operating characteristics are printed: </p>
 <dl>
<dt>Experimentation
proportion</dt><dd><p>Proportion of patients recruited to each dose,  and to each true
region of toxicity,  across the simulated trials</p>
</dd> <dt>Recommendation
proportion</dt><dd><p>Proportion of trials that recommend each of the dose levels as
the final maximum tolerated dose (i.e. with toxicity &quot;closest&quot; to the target
toxicity level),  and the associated regions of true toxicity for the
recommended MTDs</p>
</dd> </dl>
<p> If <code>trajectories = TRUE</code> then the dose level
administered and outcome observed are returned as matrices for every patient
(column) in every simulation (row).  If <code>threep3 = TRUE</code> then the
operating characteristics of the standard 3+3 design are displayed alongside
those of the <code>bcrm</code> design (see <code><a href="#topic+threep3">threep3</a></code> for more
details).
</p>


<h3>Value</h3>

<p>The following two components are returned from
<code>print.bcrm.sim</code>: </p>
<table role = "presentation">
<tr><td><code>exp</code></td>
<td>
<p>A matrix with number of rows equal to the
number of doses,  and number of columns equal to the number of simulations.
Gives the experimentation proportions for each dose within each simulation.</p>
</td></tr>
<tr><td><code>rec</code></td>
<td>
<p>A vector with length equal to the number of simulations,  giving
the recommended MTD for each simulation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcrm">bcrm</a></code>,  <code><a href="#topic+threep3">threep3</a></code>
</p>

<hr>
<h2 id='print.threep3'>Print information regarding the operating characteristics of a standard 3+3
design</h2><span id='topic+print.threep3'></span>

<h3>Description</h3>

<p>Print method for a 3+3 design specified using a <code><a href="#topic+threep3">threep3</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'threep3'
print(x, tox.cutpoints = NULL, dose = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.threep3_+3A_x">x</code></td>
<td>
<p>An object of class &quot;threep3&quot; as returned by <code><a href="#topic+threep3">threep3</a></code></p>
</td></tr>
<tr><td><code id="print.threep3_+3A_tox.cutpoints">tox.cutpoints</code></td>
<td>
<p>An optional argument passed to <code>print.threep3</code>
specifying the cutpoints of toxicity for which the operating characteristics
are to be categorised. Defaults to <code>seq(from=0, to=1, by=0.2)</code></p>
</td></tr>
<tr><td><code id="print.threep3_+3A_dose">dose</code></td>
<td>
<p>Optional vector of length <code>k</code> of actual doses for
presentation purposes</p>
</td></tr>
<tr><td><code id="print.threep3_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following operating characteristics are printed for the standard 3+3
design: </p>
 <dl>
<dt>Sample size</dt><dd><p>Mean,  minimum and maximum sample size
of the design</p>
</dd> <dt>Experimentation proportion</dt><dd><p>Proportion of patients
recruited to each dose,  and to each true region of toxicity,  on average</p>
</dd>
<dt>Recommendation proportion</dt><dd><p>Proportion of 3+3 trials that would
recommend each of the dose levels as the final maximum tolerated dose (see
<code><a href="#topic+threep3">threep3</a></code> for definition of the MTD),  and the associated regions
of true toxicity for the recommended MTDs</p>
</dd> <dt>Average number of
patients</dt><dd><p>The average number of patients dosed at each level</p>
</dd> <dt>Average
number of DLTs</dt><dd><p>The average number of DLTs seen at each level</p>
</dd> </dl>



<h3>Author(s)</h3>

<p>Michael Sweeting <a href="mailto:mjs212@medschl.cam.ac.uk">mjs212@medschl.cam.ac.uk</a> (University of
Cambridge,  UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+threep3">threep3</a></code>
</p>

<hr>
<h2 id='threep3'>Calculate all possible trial pathways for the standard 3+3 design,  together
with their probability of occurring</h2><span id='topic+threep3'></span>

<h3>Description</h3>

<p>All possible pathways of a standard 3+3 design (may be escalation-only
(see Storer 1989, Reiner et al. 1999) or permit dose de-escalation (see Chang et al.
(2006))) are calculated and assigned a probability of 
occurring. This facilitates the calculation of operating 
characteristics, using <code><a href="#topic+print.threep3">print.threep3</a></code> and
<code><a href="#topic+plot.threep3">plot.threep3</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threep3(truep, threep3.start = 1, threep3.esc.only = FALSE,
  dose = NULL, quietly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threep3_+3A_truep">truep</code></td>
<td>
<p>A vector of length <code>k</code> (the number of doses being
considered in the trial),  with values equal to the true probabilities of
toxicity at the dose levels.</p>
</td></tr>
<tr><td><code id="threep3_+3A_threep3.start">threep3.start</code></td>
<td>
<p>Starting dose level. Defaults to 1,  i.e. the lowest dose level</p>
</td></tr>
<tr><td><code id="threep3_+3A_threep3.esc.only">threep3.esc.only</code></td>
<td>
<p>Whether to forbid de-escalation of doses. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="threep3_+3A_dose">dose</code></td>
<td>
<p>Optional vector of length <code>k</code> of actual doses for
presentation purposes</p>
</td></tr>
<tr><td><code id="threep3_+3A_quietly">quietly</code></td>
<td>
<p>Whether to report progress. Defaults to <code>quietly = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first cohort of three patients are administered the starting dose
(usually the lowest dose). The trial then proceeds as follows: </p>

<ul>
<li><p> If none of the three patients experience a DLT,  then dose the next
three patients at the next highest dose level; </p>
</li>
<li><p> If one of the three
patients last treated experiences a DLT,  then dose the next three patients
at the current dose level; </p>
</li>
<li><p> If at least two patients in the first dose
level experience a DLT the trial is stopped for safety and no dose is
recommended; </p>
</li></ul>
<p> Escalation / de-escalation rules to the next dose level for
subsequent cohorts proceed as follows: </p>
 <ul>
<li><p> Escalate: If 0/3 or
at most 1/6 DLTs are observed in the current cohort AND the next highest
dose has not yet been tested; </p>
</li>
<li><p> Stay at current dose level: If 1/3 DLTs
have been observed at this level. Dose a further three patients at the same
level; </p>
</li>
<li><p> De-Escalate (if de-escalation permitted): If at least two out of three to six patients
experience DLTs at the current dose level AND fewer than six patients have
been dosed at the next lowest level </p>
</li></ul>

<p>If none of the rules above are satisfied then the trial stops. If the
current dose level has at most one DLT observed then this is claimed to be
the MTD,  otherwise the dose level below is deemed to be the MTD.
</p>
<p>If dose-escalation extends to doses outside of that defined by <code>dose</code>, 
the MTD is determined to be the largest dose in <code>dose</code>.
</p>


<h3>Value</h3>

<p><code>threep3</code> returns an object of class &quot;threep3&quot;. The function
<code><a href="base.html#topic+print">print</a></code> (i.e. <code><a href="#topic+print.threep3">print.threep3</a></code>) can be used to obtain
operating characteristics of the design used.
</p>
<p>An object of class &quot;threep3&quot; is a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>prob</code></td>
<td>
<p>A vector with the probabilities of each design occurring. As all
possible designs are calculated,  this vector sums to one</p>
</td></tr> <tr><td><code>ssize</code></td>
<td>
<p>A
vector with the sample size of each design</p>
</td></tr> <tr><td><code>mtd</code></td>
<td>
<p>A vector of dose
levels giving the recommended maximum tolerated dose (MTD) at the end of the
trial</p>
</td></tr> <tr><td><code>exp</code></td>
<td>
<p>A vector of length <code>k</code> giving the average trial
experimentation proportions at each dose level</p>
</td></tr> <tr><td><code>dlt.no</code></td>
<td>
<p>A vector with
the number of toxicities (DLTs) that occur in each trial</p>
</td></tr> <tr><td><code>truep</code></td>
<td>
<p>The
true probabilities of toxicity at each dose level,  specified by the user</p>
</td></tr>
<tr><td><code>dose</code></td>
<td>
<p>The actual doses as supplied in the function arguments</p>
</td></tr>
<tr><td><code>n.average</code></td>
<td>
<p>The average number of patients dosed at each level</p>
</td></tr>
<tr><td><code>dlt.average</code></td>
<td>
<p>The average number of DLTs experienced at each dose
level</p>
</td></tr> <tr><td><code>all.designs</code></td>
<td>
<p>A matrix containing all possible 3+3 designs,  with
each row representing a different design. Columns labelled &quot;d k&quot; and &quot;tox k&quot;
represent the dose level and number of toxicities for the kth cohort, 
respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Graham Wheeler <a href="mailto:graham.wheeler@ucl.ac.uk">graham.wheeler@ucl.ac.uk</a> (University College London, UK) and
</p>
<p>Michael Sweeting <a href="mailto:michael.sweeting@leicester.ac.uk">michael.sweeting@leicester.ac.uk</a> (University of Leicester, 
UK)
</p>


<h3>References</h3>

<p>Sweeting M.,  Mander A.,  Sabin T. <span class="pkg">bcrm</span>: Bayesian Continual
Reassessment Method Designs for Phase I Dose-Finding Trials. <em>Journal
of Statistical Software</em> (2013) 54: 1&ndash;26.
<a href="http://www.jstatsoft.org/article/view/v054i13">http://www.jstatsoft.org/article/view/v054i13</a>
</p>
<p>Chang A.,  Ganz P.,  Hayes D.,  Kinsella T.,  Pass H.,  Schiller J.,  Stone R., 
Strecher V. <em>Oncology: An Evidence-Based Approach</em>. Springer (2006).
</p>
<p>Storer B. Design and Analysis of Phase I Clinical Trials. <em>Biometrics</em>
(1989) 45: 925&ndash;937.
</p>
<p>Reiner E.,  Paoletti X.,  O'Quigley J. Operating characteristics of the
standard phase I clinical trial design. <em>Computational Statistics &amp;
Data Analysis</em> (1999) 30: 303&ndash;315.
</p>
<p>Neuenschwander B.,  Branson M.,  Gsponer T. Critical aspects of the Bayesian
approach to phase I cancer trials. <em>Statistics in Medicine</em> (2008) 27:
2420&ndash;2439.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+threep3">threep3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## What are the operating characteristics of a standard 3+3 design if we conside only the first 
## 12 doses of the dose-escalation cancer trial example as described in Neuenschwander et al 2008.
## Pre-defined doses
dose &lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100)
## Pre-specified probabilities of toxicity
p.tox0 &lt;- c(0.010, 0.015, 0.020, 0.025, 0.030, 0.040, 0.050, 0.100, 0.170, 0.300, 0.400, 0.500)

## Not run: 
design.threep3 &lt;- threep3(truep=p.tox0, threep3.start=1, threep3.esc.only=TRUE, dose=dose)
print(design.threep3)
plot(design.threep3)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
