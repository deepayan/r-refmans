<!DOCTYPE html><html><head><title>Help for package openxlsx2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {openxlsx2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#openxlsx2-package'><p>xlsx reading, writing and editing.</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#active_sheet-wb'><p>Modify the state of active and selected sheets in a workbook</p></a></li>
<li><a href='#as_xml'><p>loads character string to pugixml and returns an externalptr</p></a></li>
<li><a href='#base_font-wb'><p>Set the default font in a workbook</p></a></li>
<li><a href='#clean_worksheet_name'><p>Clean worksheet name</p></a></li>
<li><a href='#col_widths-wb'><p>Modify column widths of a worksheet</p></a></li>
<li><a href='#col2int'><p>Convert Excel column to integer</p></a></li>
<li><a href='#comment_internal'><p>Internal comment functions</p></a></li>
<li><a href='#convert_date'><p>Convert from Excel date, datetime or hms number to R Date type</p></a></li>
<li><a href='#convert_to_excel_date'><p>convert back to an Excel Date</p></a></li>
<li><a href='#convertToExcelDate'><p>Convert to Excel data</p></a></li>
<li><a href='#create_border'><p>Helper to create a border</p></a></li>
<li><a href='#create_cell_style'><p>Helper to create a cell style</p></a></li>
<li><a href='#create_colors_xml'><p>Create custom color xml schemes</p></a></li>
<li><a href='#create_comment'><p>Create a comment</p></a></li>
<li><a href='#create_dxfs_style'><p>Create a custom formatting style</p></a></li>
<li><a href='#create_fill'><p>Create fill pattern</p></a></li>
<li><a href='#create_font'><p>Create font format</p></a></li>
<li><a href='#create_hyperlink'><p>Create Excel hyperlink string</p></a></li>
<li><a href='#create_numfmt'><p>Create number format</p></a></li>
<li><a href='#create_sparklines'><p>Create sparklines object</p></a></li>
<li><a href='#create_tablestyle'><p>Create custom (pivot) table styles</p></a></li>
<li><a href='#creators-wb'><p>Modify creators of a workbook</p></a></li>
<li><a href='#dataframe_to_dims'><p>Create dimensions from dataframe</p></a></li>
<li><a href='#delete_data'><p>Delete data</p></a></li>
<li><a href='#dims_helper'><p>Helper functions to work with <code>dims</code></p></a></li>
<li><a href='#dims_to_dataframe'><p>Create dataframe from dimensions</p></a></li>
<li><a href='#filter-wb'><p>Add/remove column filters in a worksheet</p></a></li>
<li><a href='#fmt_txt'><p>format strings independent of the cell style.</p></a></li>
<li><a href='#grouping-wb'><p>Group rows and columns in a worksheet</p></a></li>
<li><a href='#int2col'><p>Convert integer to Excel column</p></a></li>
<li><a href='#named_region-wb'><p>Modify named regions in a worksheet</p></a></li>
<li><a href='#openxlsx2_options'><p>Options consulted by openxlsx2</p></a></li>
<li><a href='#openxlsx2-deprecated'><p>Deprecated functions in package <em>openxlsx2</em></p></a></li>
<li><a href='#person-wb'><p>Helper for adding threaded comments</p></a></li>
<li><a href='#print.pugi_xml'><p>print pugi_xml</p></a></li>
<li><a href='#properties-wb'><p>Modify workbook properties</p></a></li>
<li><a href='#pugixml'><p>xml_node</p></a></li>
<li><a href='#read_xml'><p>read xml file</p></a></li>
<li><a href='#row_heights-wb'><p>Modify row heights of a worksheet</p></a></li>
<li><a href='#sheet_names-wb'><p>Get / Set worksheet names for a workbook</p></a></li>
<li><a href='#sheet_visibility-wb'><p>Get/set worksheet visible state in a workbook</p></a></li>
<li><a href='#styles_on_sheet'><p>Get all styles on a sheet</p></a></li>
<li><a href='#temp_xlsx'><p>helper function to create temporary directory for testing purpose</p></a></li>
<li><a href='#waivers'><p><code>openxlsx2</code> waivers</p></a></li>
<li><a href='#wb_add_border'><p>Modify borders in a cell region of a worksheet</p></a></li>
<li><a href='#wb_add_cell_style'><p>Modify the style in a cell region</p></a></li>
<li><a href='#wb_add_chart_xml'><p>Add a chart XML to a worksheet</p></a></li>
<li><a href='#wb_add_chartsheet'><p>Add a chartsheet to a workbook</p></a></li>
<li><a href='#wb_add_comment'><p>Add comment to worksheet</p></a></li>
<li><a href='#wb_add_conditional_formatting'><p>Add conditional formatting to cells in a worksheet</p></a></li>
<li><a href='#wb_add_data'><p>Add data to a worksheet</p></a></li>
<li><a href='#wb_add_data_table'><p>Add a data table to a worksheet</p></a></li>
<li><a href='#wb_add_data_validation'><p>Add data validation to cells in a worksheet</p></a></li>
<li><a href='#wb_add_drawing'><p>Add drawings to a worksheet</p></a></li>
<li><a href='#wb_add_dxfs_style'><p>Set a dxfs styling for the workbook</p></a></li>
<li><a href='#wb_add_fill'><p>Modify the background fill color in a cell region</p></a></li>
<li><a href='#wb_add_font'><p>Modify font in a cell region</p></a></li>
<li><a href='#wb_add_form_control'><p>Add a checkbox, radio button or drop menu to a cell in a worksheet</p></a></li>
<li><a href='#wb_add_formula'><p>Add a formula to a cell range in a worksheet</p></a></li>
<li><a href='#wb_add_ignore_error'><p>Ignore error types on worksheet</p></a></li>
<li><a href='#wb_add_image'><p>Insert an image into a worksheet</p></a></li>
<li><a href='#wb_add_mschart'><p>Add mschart object to a worksheet</p></a></li>
<li><a href='#wb_add_named_style'><p>Apply styling to a cell region with a named style</p></a></li>
<li><a href='#wb_add_numfmt'><p>Modify number formatting in a cell region</p></a></li>
<li><a href='#wb_add_page_break'><p>Add a page break to a worksheet</p></a></li>
<li><a href='#wb_add_pivot_table'><p>Add a pivot table to a worksheet</p></a></li>
<li><a href='#wb_add_plot'><p>Insert the current plot into a worksheet</p></a></li>
<li><a href='#wb_add_slicer'><p>Add a slicer to a pivot table</p></a></li>
<li><a href='#wb_add_sparklines'><p>Add sparklines to a worksheet</p></a></li>
<li><a href='#wb_add_style'><p>Set the default style in a workbook</p></a></li>
<li><a href='#wb_add_thread'><p>Add threaded comments to a cell in a worksheet</p></a></li>
<li><a href='#wb_add_worksheet'><p>Add a worksheet to a workbook</p></a></li>
<li><a href='#wb_base_colors'><p>Set the default colors in a workbook</p></a></li>
<li><a href='#wb_cell_style'><p>Apply styling to a cell region</p></a></li>
<li><a href='#wb_clean_sheet'><p>Remove all values in a worksheet</p></a></li>
<li><a href='#wb_clone_sheet_style'><p>Apply styling from a sheet to another within a workbook</p></a></li>
<li><a href='#wb_clone_worksheet'><p>Create copies of a worksheet within a workbook</p></a></li>
<li><a href='#wb_color'><p>Helper to create a color</p></a></li>
<li><a href='#wb_comment'><p>Helper to create a comment object</p></a></li>
<li><a href='#wb_copy_cells'><p>Copy cells around within a worksheet</p></a></li>
<li><a href='#wb_data'><p>Add the <code>wb_data</code> attribute to a data frame in a worksheet</p></a></li>
<li><a href='#wb_dims'><p>Helper to specify the <code>dims</code> argument</p></a></li>
<li><a href='#wb_freeze_pane'><p>Freeze pane of a worksheet</p></a></li>
<li><a href='#wb_get_tables'><p>List Excel tables in a worksheet</p></a></li>
<li><a href='#wb_load'><p>Load an existing .xlsx, .xlsm or .xlsb file</p></a></li>
<li><a href='#wb_merge_cells'><p>Merge cells within a worksheet</p></a></li>
<li><a href='#wb_open'><p>Preview a workbook in a spreadsheet software</p></a></li>
<li><a href='#wb_order'><p>Order worksheets in a workbook</p></a></li>
<li><a href='#wb_page_setup'><p>Set page margins, orientation and print scaling of a worksheet</p></a></li>
<li><a href='#wb_protect'><p>Protect a workbook from modifications</p></a></li>
<li><a href='#wb_protect_worksheet'><p>Protect a worksheet from modifications</p></a></li>
<li><a href='#wb_remove_tables'><p>Remove a data table from a worksheet</p></a></li>
<li><a href='#wb_remove_worksheet'><p>Remove a worksheet from a workbook</p></a></li>
<li><a href='#wb_save'><p>Save a workbook to file</p></a></li>
<li><a href='#wb_set_bookview'><p>Set the workbook position, size and filter</p></a></li>
<li><a href='#wb_set_grid_lines'><p>Modify grid lines visibility in a worksheet</p></a></li>
<li><a href='#wb_set_header_footer'><p>Set headers and footers of a worksheet</p></a></li>
<li><a href='#wb_set_last_modified_by'><p>Modify author in the metadata of a workbook</p></a></li>
<li><a href='#wb_set_sheetview'><p>Modify the default view of a worksheet</p></a></li>
<li><a href='#wb_to_df'><p>Create a data frame from a Workbook</p></a></li>
<li><a href='#wb_update_table'><p>Update a data table position in a worksheet</p></a></li>
<li><a href='#wb_workbook'><p>Create a new Workbook object</p></a></li>
<li><a href='#wbWorkbook'><p>Workbook class</p></a></li>
<li><a href='#write_data'><p>Write an object to a worksheet</p></a></li>
<li><a href='#write_datatable'><p>Write to a worksheet as an Excel table</p></a></li>
<li><a href='#write_formula'><p>Write a character vector as an Excel Formula</p></a></li>
<li><a href='#write_xlsx'><p>Write data to an xlsx file</p></a></li>
<li><a href='#xl_open'><p>Open an xlsx file or a <code>wbWorkbook</code> object</p></a></li>
<li><a href='#xml_add_child'><p>append xml child to node</p></a></li>
<li><a href='#xml_attr_mod'><p>adds or updates attribute(s) in existing xml node</p></a></li>
<li><a href='#xml_node_create'><p>create xml_node from R objects</p></a></li>
<li><a href='#xml_rm_child'><p>remove xml child to node</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read, Write and Edit 'xlsx' Files</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplifies the creation of 'xlsx' files by
    providing a high level interface to writing, styling and editing
    worksheets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://janmarvin.github.io/openxlsx2/">https://janmarvin.github.io/openxlsx2/</a>,
<a href="https://github.com/JanMarvin/openxlsx2">https://github.com/JanMarvin/openxlsx2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/JanMarvin/openxlsx2/issues">https://github.com/JanMarvin/openxlsx2/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6, Rcpp, grDevices, magrittr, stringi, utils, zip</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, mschart (&ge; 0.4), rmarkdown, rvg, testthat
(&ge; 3.0.0), waldo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-26 10:13:13 UTC; janmarvingarbuszus</td>
</tr>
<tr>
<td>Author:</td>
<td>Jordan Mark Barbone
    <a href="https://orcid.org/0000-0001-9788-3628"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Jan Marvin Garbuszus [aut, cre],
  Oliver Roy [ctb],
  openxlsx authors [cph] (openxlsx package),
  Arseny Kapoulkine [ctb, cph] (Author of included pugixml code)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Marvin Garbuszus &lt;jan.garbuszus@ruhr-uni-bochum.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-26 12:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='openxlsx2-package'>xlsx reading, writing and editing.</h2><span id='topic+openxlsx2'></span><span id='topic+openxlsx2-package'></span>

<h3>Description</h3>

<p>This R package is a modern reinterpretation of the widely used popular
<code>openxlsx</code> package. Similar to its predecessor, it simplifies the creation of xlsx
files by providing a clean interface for writing, designing and editing worksheets.
Based on a powerful XML library and focusing on modern programming flows in pipes
or chains, <code>openxlsx2</code> allows to break many new ground.
</p>


<h3>Details</h3>

<p>The <code>openxlsx2</code> package provides comprehensive functionality for interacting
with Office Open XML spreadsheet files. Users can read data using <code><a href="#topic+read_xlsx">read_xlsx()</a></code>
and write data to spreadsheets via <code><a href="#topic+write_xlsx">write_xlsx()</a></code>, with options to specify
sheet names and cell ranges for targeted operations. Beyond basic read/write
capabilities, <code>openxlsx2</code> facilitates extensive workbook (<code><a href="#topic+wb_workbook">wb_workbook()</a></code>)
manipulations, including:
</p>

<ul>
<li><p> Loading a workbook into R with <code><a href="#topic+wb_load">wb_load()</a></code> and saving it with <code><a href="#topic+wb_save">wb_save()</a></code>
</p>
</li>
<li><p> Adding/removing and modifying worksheets and data with <code><a href="#topic+wb_add_worksheet">wb_add_worksheet()</a></code>,
<code><a href="#topic+wb_remove_worksheet">wb_remove_worksheet()</a></code>, and <code><a href="#topic+wb_add_data">wb_add_data()</a></code>.
</p>
</li>
<li><p> Enhancing spreadsheets with comments (<code><a href="#topic+wb_add_comment">wb_add_comment()</a></code>),
images (<code><a href="#topic+wb_add_image">wb_add_image()</a></code>), plots (<code><a href="#topic+wb_add_plot">wb_add_plot()</a></code>), charts (<code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code>),
and pivot tables (<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table()</a></code>).
Customizing cell styles using fonts (<code><a href="#topic+wb_add_font">wb_add_font()</a></code>),
number formats (<code><a href="#topic+wb_add_numfmt">wb_add_numfmt()</a></code>), backgrounds (<code><a href="#topic+wb_add_fill">wb_add_fill()</a></code>),
and alignments (<code><a href="#topic+wb_add_cell_style">wb_add_cell_style()</a></code>). Inserting custom text strings with
<code><a href="#topic+fmt_txt">fmt_txt()</a></code> and creating comprehensive table styles with <code><a href="#topic+create_tablestyle">create_tablestyle()</a></code>.
</p>
</li></ul>



<h4>Interaction</h4>

<p>Interaction with <code>openxlsx2</code> objects can occur through two primary methods:
</p>
<p><em>Wrapper Function Method</em>: Utilizes the <code>wb</code> family of functions that support
piping to streamline operations.
</p>
<div class="sourceCode r"><pre>wb &lt;- wb_workbook(creator = "My name here") %&gt;%
  wb_add_worksheet(sheet = "Expenditure", grid_lines = FALSE) %&gt;%
  wb_add_data(x = USPersonalExpenditure, row_names = TRUE)
</pre></div>
<p><em>Chaining Method</em>: Directly modifies the object through a series of chained
function calls.
</p>
<div class="sourceCode r"><pre>wb &lt;- wb_workbook(creator = "My name here")$
  add_worksheet(sheet = "Expenditure", grid_lines = FALSE)$
  add_data(x = USPersonalExpenditure, row_names = TRUE)
</pre></div>
<p>While wrapper functions require explicit assignment of their output to reflect
changes, chained functions inherently modify the input object. Both approaches
are equally supported, offering flexibility to suit user preferences. The
documentation mainly highlights the use of wrapper functions. To find information,
users should look up the wb function name e.g. <code>?wb_add_data_table</code> rather than
searching for <code>?wbWorkbook</code>.
</p>
<p>Function arguments follow the snake_case convention, but for backward compatibility,
camelCase is also supported at the moment. The API aims to maintain consistency
in its arguments, with a special focus on <code>sheet</code> (<code><a href="#topic+wb_get_sheet_names">wb_get_sheet_names()</a></code>) and
<code>dims</code> (<a href="#topic+wb_dims">wb_dims</a>), which are of particular importance to users.
</p>



<h4>Locale</h4>

<p>By default, <code>openxlsx2</code> uses the American English word for color (written with
'o' instead of the British English 'ou'). However, both spellings are supported.
So where the documentation uses a 'color', the function should also accept a 'colour'.
However, this is not indicated by the autocompletion.
</p>



<h4>Authors and contributions</h4>

<p>For a full list of all authors that have made this package possible and for whom we are grateful, please see:
</p>
<div class="sourceCode r"><pre>system.file("AUTHORS", package = "openxlsx2")
</pre></div>
<p>If you feel like you should be included on this list, please let us know.
If you have something to contribute, you are welcome.
If something is not working as expected, open issues or if you have solved an issue, open a pull request.
Please be respectful and be aware that we are volunteers doing this for fun in our unpaid free time.
We will work on problems when we have time or need.
</p>



<h4>License</h4>

<p>This package is licensed under the MIT license and
is based on <a href="https://github.com/ycphs/openxlsx"><code>openxlsx</code></a> (by Alexander Walker and Philipp Schauberger; COPYRIGHT 2014-2022)
and <a href="https://github.com/zeux/pugixml"><code>pugixml</code></a> (by Arseny Kapoulkine; COPYRIGHT 2006-2023). Both released under the MIT license.
</p>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jan Marvin Garbuszus <a href="mailto:jan.garbuszus@ruhr-uni-bochum.de">jan.garbuszus@ruhr-uni-bochum.de</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Jordan Mark Barbone <a href="mailto:jmbarbone@gmail.com">jmbarbone@gmail.com</a> (<a href="https://orcid.org/0000-0001-9788-3628">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Oliver Roy [contributor]
</p>
</li>
<li><p>  openxlsx authors (openxlsx package) [copyright holder]
</p>
</li>
<li><p> Arseny Kapoulkine (Author of included pugixml code) [contributor, copyright holder]
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><code>browseVignettes("openxlsx2")</code>
</p>
</li>
<li> <p><a href="https://janmarvin.github.io/openxlsx2/">https://janmarvin.github.io/openxlsx2/</a>
</p>
</li>
<li> <p><a href="https://janmarvin.github.io/ox2-book/">https://janmarvin.github.io/ox2-book/</a>
for examples
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># read xlsx or xlsm files
path &lt;- system.file("extdata/openxlsx2_example.xlsx", package = "openxlsx2")
read_xlsx(path)

# or import workbooks
wb &lt;- wb_load(path)

# read a data frame
wb_to_df(wb)

# and save
temp &lt;- temp_xlsx()
if (interactive()) wb_save(wb, temp)

## or create one yourself
wb &lt;- wb_workbook()
# add a worksheet
wb$add_worksheet("sheet")
# add some data
wb$add_data("sheet", cars)
# open it in your default spreadsheet software
if (interactive()) wb$open()
</code></pre>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='active_sheet-wb'>Modify the state of active and selected sheets in a workbook</h2><span id='topic+active_sheet-wb'></span><span id='topic+wb_get_active_sheet'></span><span id='topic+wb_set_active_sheet'></span><span id='topic+wb_get_selected'></span><span id='topic+wb_set_selected'></span>

<h3>Description</h3>

<p>Get and set table of sheets and their state as selected and active in a workbook
</p>
<p>Multiple sheets can be selected, but only a single one can be active (visible).
The visible sheet, must not necessarily be a selected sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_active_sheet(wb)

wb_set_active_sheet(wb, sheet)

wb_get_selected(wb)

wb_set_selected(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="active_sheet-wb_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="active_sheet-wb_+3A_sheet">sheet</code></td>
<td>
<p>a sheet name of the workbook</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with tabSelected and names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_load(file = system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2"))
# testing is the selected sheet
wb_get_selected(wb)
# change the selected sheet to Sheet2
wb &lt;- wb_set_selected(wb, "Sheet2")
# get the active sheet
wb_get_active_sheet(wb)
# change the selected sheet to Sheet2
wb &lt;- wb_set_active_sheet(wb, sheet = "Sheet2")
</code></pre>

<hr>
<h2 id='as_xml'>loads character string to pugixml and returns an externalptr</h2><span id='topic+as_xml'></span>

<h3>Description</h3>

<p>loads character string to pugixml and returns an externalptr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_xml(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_xml_+3A_x">x</code></td>
<td>
<p>input as xml</p>
</td></tr>
<tr><td><code id="as_xml_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>read_xml()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>might be useful for larger documents where single nodes are shortened
and otherwise the full tree has to be reimported. unsure where we have
such a case.
is useful, for printing nodes from a larger tree, that have been exported
as characters (at some point in time we have to convert the xml to R)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp_xlsx &lt;- tempfile()
xlsxFile &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
unzip(xlsxFile, exdir = tmp_xlsx)

wb &lt;- wb_load(xlsxFile)
styles_xml &lt;- sprintf("%s/xl/styles.xml", tmp_xlsx)

# is external pointer
sxml &lt;- read_xml(styles_xml)

# is character
font &lt;- xml_node(sxml, "styleSheet", "fonts", "font")

# is again external pointer
as_xml(font)
</code></pre>

<hr>
<h2 id='base_font-wb'>Set the default font in a workbook</h2><span id='topic+base_font-wb'></span><span id='topic+wb_set_base_font'></span><span id='topic+wb_get_base_font'></span>

<h3>Description</h3>

<p>Modify / get the default font for the workbook. This will alter the latin
major and minor font in the workbooks theme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_base_font(
  wb,
  font_size = 11,
  font_color = wb_color(theme = "1"),
  font_name = "Aptos Narrow",
  ...
)

wb_get_base_font(wb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base_font-wb_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="base_font-wb_+3A_font_size">font_size</code></td>
<td>
<p>Font size</p>
</td></tr>
<tr><td><code id="base_font-wb_+3A_font_color">font_color</code></td>
<td>
<p>Font color</p>
</td></tr>
<tr><td><code id="base_font-wb_+3A_font_name">font_name</code></td>
<td>
<p>Name of a font</p>
</td></tr>
<tr><td><code id="base_font-wb_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The font name is not validated in anyway. Spreadsheet software replaces
unknown font names with system defaults.
</p>
<p>The default base font is Aptos Narrow, black, size 11. If <code>font_name</code> differs
from the name in <code><a href="#topic+wb_get_base_font">wb_get_base_font()</a></code>, the theme is updated to use the newly
selected font name.
</p>


<h3>See Also</h3>

<p>Other workbook styling functions: 
<code><a href="#topic+wb_add_dxfs_style">wb_add_dxfs_style</a>()</code>,
<code><a href="#topic+wb_add_style">wb_add_style</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create a workbook
wb &lt;- wb_workbook(theme = "Office 2013 - 2022 Theme")
wb$add_worksheet("S1")
## modify base font to size 10 Aptos Narrow in red
wb$set_base_font(font_size = 10, font_color = wb_color("red"), font_name = "Aptos Narrow")

wb$add_data(x = iris)

## font color does not affect tables
wb$add_data_table(x = iris, dims = wb_dims(from_col = 10))

## get the base font
wb_get_base_font(wb)

</code></pre>

<hr>
<h2 id='clean_worksheet_name'>Clean worksheet name</h2><span id='topic+clean_worksheet_name'></span>

<h3>Description</h3>

<p>Cleans a worksheet name by removing legal characters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_worksheet_name(x, replacement = " ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_worksheet_name_+3A_x">x</code></td>
<td>
<p>A vector, coerced to <code>character</code></p>
</td></tr>
<tr><td><code id="clean_worksheet_name_+3A_replacement">replacement</code></td>
<td>
<p>A single value to replace illegal characters by.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Illegal characters are considered <code style="white-space: pre;">&#8288;\&#8288;</code>, <code>/</code>, <code style="white-space: pre;">&#8288;?&#8288;</code>, <code>*</code>, <code>:</code>, <code>[</code>, and
<code style="white-space: pre;">&#8288;]&#8288;</code>.  These must be intentionally removed from worksheet names prior to
creating a new worksheet.
</p>


<h3>Value</h3>

<p>x with bad characters removed
</p>

<hr>
<h2 id='col_widths-wb'>Modify column widths of a worksheet</h2><span id='topic+col_widths-wb'></span><span id='topic+wb_set_col_widths'></span><span id='topic+wb_remove_col_widths'></span>

<h3>Description</h3>

<p>Remove / set worksheet column widths to specified width or &quot;auto&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_col_widths(
  wb,
  sheet = current_sheet(),
  cols,
  widths = 8.43,
  hidden = FALSE
)

wb_remove_col_widths(wb, sheet = current_sheet(), cols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col_widths-wb_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object.</p>
</td></tr>
<tr><td><code id="col_widths-wb_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet, a vector in the case of <code>remove_</code></p>
</td></tr>
<tr><td><code id="col_widths-wb_+3A_cols">cols</code></td>
<td>
<p>Indices of cols to set/remove column widths.</p>
</td></tr>
<tr><td><code id="col_widths-wb_+3A_widths">widths</code></td>
<td>
<p>Width to set <code>cols</code> to specified column width or <code>"auto"</code> for
automatic sizing. <code>widths</code> is recycled to the length of <code>cols</code>. openxlsx2
sets the default width is 8.43, as this is the standard in some spreadsheet
software. See <strong>Details</strong> for general information on column widths.</p>
</td></tr>
<tr><td><code id="col_widths-wb_+3A_hidden">hidden</code></td>
<td>
<p>Logical vector recycled to the length of <code>cols</code>.
If <code>TRUE</code>, the columns are hidden.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The global min and max column width for &quot;auto&quot; columns is set by (default values show):
</p>

<ul>
<li> <p><code>options("openxlsx2.minWidth" = 3)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.maxWidth" = 250)</code> Maximum width allowed in Excel
</p>
</li></ul>

<p>NOTE: The calculation of column widths can be slow for large worksheets.
</p>
<p>NOTE: The <code>hidden</code> parameter may conflict with the one set in <code><a href="#topic+wb_group_cols">wb_group_cols()</a></code>;
changing one will update the other.
</p>
<p>NOTE: The default column width varies by spreadsheet software, operating system,
and DPI settings used. Setting <code>widths</code> to specific value also is no guarantee
that the output will have consistent column widths.
</p>
<p>For automatic text wrapping of columns use
<a href="#topic+wb_add_cell_style">wb_add_cell_style(wrap_text = TRUE)</a>
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- wb_workbook()

## Add a worksheet
wb$add_worksheet("Sheet 1")

## set col widths
wb$set_col_widths(cols = c(1, 4, 6, 7, 9), widths = c(16, 15, 12, 18, 33))

## auto columns
wb$add_worksheet("Sheet 2")
wb$add_data(sheet = 2, x = iris)
wb$set_col_widths(sheet = 2, cols = 1:5, widths = "auto")

## removing column widths
## Create a new workbook
wb &lt;- wb_load(file = system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2"))

## remove column widths in columns 1 to 20
wb_remove_col_widths(wb, 1, cols = 1:20)
</code></pre>

<hr>
<h2 id='col2int'>Convert Excel column to integer</h2><span id='topic+col2int'></span>

<h3>Description</h3>

<p>Converts an Excel column label to an integer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2int(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col2int_+3A_x">x</code></td>
<td>
<p>A character vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer column label (or <code>NULL</code> if <code>x</code> is <code>NULL</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>col2int(LETTERS)
</code></pre>

<hr>
<h2 id='comment_internal'>Internal comment functions</h2><span id='topic+comment_internal'></span><span id='topic+write_comment'></span><span id='topic+remove_comment'></span>

<h3>Description</h3>

<p>Users are advised to use <code><a href="#topic+wb_add_comment">wb_add_comment()</a></code> and <code><a href="#topic+wb_remove_comment">wb_remove_comment()</a></code>.
This function is used internally by openxlsx2. It will stop exporting it at
some point in the future. Use the replacement function at your earliest convenience.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_comment(
  wb,
  sheet,
  col = NULL,
  row = NULL,
  comment,
  dims = rowcol_to_dim(row, col),
  color = NULL,
  file = NULL
)

remove_comment(
  wb,
  sheet,
  col = NULL,
  row = NULL,
  gridExpand = TRUE,
  dims = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comment_internal_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet of the workbook</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_row">row</code>, <code id="comment_internal_+3A_col">col</code></td>
<td>
<p>Row and column of the cell</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_comment">comment</code></td>
<td>
<p>An object created by <code><a href="#topic+create_comment">create_comment()</a></code></p>
</td></tr>
<tr><td><code id="comment_internal_+3A_dims">dims</code></td>
<td>
<p>Optional row and column as spreadsheet dimension, e.g. &quot;A1&quot;</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_color">color</code></td>
<td>
<p>optional background color</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_file">file</code></td>
<td>
<p>optional background image (file extension must be png or jpeg)</p>
</td></tr>
<tr><td><code id="comment_internal_+3A_gridexpand">gridExpand</code></td>
<td>
<p>If <code>TRUE</code>, all data in rectangle min(rows):max(rows) X min(cols):max(cols)
will be removed.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
# add a comment without author
c1 &lt;- wb_comment(text = "this is a comment", author = "")
wb$add_comment(dims = "B10", comment = c1)
#' # Remove comment
wb$remove_comment(sheet = "Sheet 1", dims = "B10")
# Write another comment with author information
c2 &lt;- wb_comment(text = "this is another comment", author = "Marco Polo", visible = TRUE)
wb$add_comment(sheet = 1, dims = "C10", comment = c2)
# Works with formatted text also.
formatted_text &lt;- fmt_txt("bar", underline = TRUE)
wb$add_comment(dims = "B5", comment = formatted_text)
# With background color
wb$add_comment(dims = "B7", comment = formatted_text, color = wb_color("green"))
# With background image. File extension must be png or jpeg, not jpg?
tmp &lt;- tempfile(fileext = ".png")
png(file = tmp, bg = "transparent")
plot(1:10)
rect(1, 5, 3, 7, col = "white")
dev.off()

c1 &lt;- wb_comment(text = "this is a comment", author = "", visible = TRUE)
wb$add_comment(dims = "B12", comment = c1, file = tmp)
</code></pre>

<hr>
<h2 id='convert_date'>Convert from Excel date, datetime or hms number to R Date type</h2><span id='topic+convert_date'></span><span id='topic+convert_datetime'></span><span id='topic+convert_hms'></span>

<h3>Description</h3>

<p>Convert from Excel date number to R Date type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_date(x, origin = "1900-01-01", ...)

convert_datetime(x, origin = "1900-01-01", ...)

convert_hms(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_date_+3A_x">x</code></td>
<td>
<p>A vector of integers</p>
</td></tr>
<tr><td><code id="convert_date_+3A_origin">origin</code></td>
<td>
<p>date. Default value is for Windows Excel 2010</p>
</td></tr>
<tr><td><code id="convert_date_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="base.html#topic+as.Date">base::as.Date.character</a></code>
</p>

<dl>
<dt><code>format</code></dt><dd><p><code><a href="base.html#topic+character">character</a></code> string.  If not specified, it will try
<code>tryFormats</code> one by one on the first non-<code>NA</code> element, and
give an error if none works.  Otherwise, the processing is via
<code><a href="base.html#topic+strptime">strptime</a>()</code> whose help page describes available
conversion specifications.</p>
</dd>
<dt><code>tryFormats</code></dt><dd><p><code><a href="base.html#topic+character">character</a></code> vector of <code>format</code>
strings to try if <code>format</code> is not specified.</p>
</dd>
<dt><code>optional</code></dt><dd><p><code><a href="base.html#topic+logical">logical</a></code> indicating to return <code>NA</code>
(instead of signalling an error) if the format guessing does not succeed.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>Excel stores dates as number of days from some origin day
</p>


<h3>Value</h3>

<p>A date, datetime, or hms.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_data">wb_add_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># date --
## 2014 April 21st to 25th
convert_date(c(41750, 41751, 41752, 41753, 41754, NA))
convert_date(c(41750.2, 41751.99, NA, 41753))

# datetime --
##  2014-07-01, 2014-06-30, 2014-06-29
x &lt;- c(41821.8127314815, 41820.8127314815, NA, 41819, NaN)
convert_datetime(x)
convert_datetime(x, tz = "Australia/Perth")
convert_datetime(x, tz = "UTC")

# hms ---
## 12:13:14
x &lt;- 0.50918982
convert_hms(x)
</code></pre>

<hr>
<h2 id='convert_to_excel_date'>convert back to an Excel Date</h2><span id='topic+convert_to_excel_date'></span>

<h3>Description</h3>

<p>convert back to an Excel Date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_excel_date(df, date1904 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_to_excel_date_+3A_df">df</code></td>
<td>
<p>dataframe</p>
</td></tr>
<tr><td><code id="convert_to_excel_date_+3A_date1904">date1904</code></td>
<td>
<p>take different origin</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> xlsxFile &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
 wb1 &lt;- wb_load(xlsxFile)
 df &lt;- wb_to_df(wb1)
 # conversion is done on dataframes only
 convert_to_excel_date(df = df["Var5"], date1904 = FALSE)
</code></pre>

<hr>
<h2 id='convertToExcelDate'>Convert to Excel data</h2><span id='topic+convertToExcelDate'></span>

<h3>Description</h3>

<p>Use <code><a href="#topic+convert_to_excel_date">convert_to_excel_date()</a></code> in new code
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertToExcelDate_+3A_df">df</code></td>
<td>
<p>dataframe</p>
</td></tr>
<tr><td><code id="convertToExcelDate_+3A_date1904">date1904</code></td>
<td>
<p>take different origin</p>
</td></tr>
</table>

<hr>
<h2 id='create_border'>Helper to create a border</h2><span id='topic+create_border'></span>

<h3>Description</h3>

<p>Border styles can any of the following: &quot;thin&quot;, &quot;thick&quot;, &quot;slantDashDot&quot;, &quot;none&quot;, &quot;mediumDashed&quot;, &quot;mediumDashDot&quot;, &quot;medium&quot;, &quot;hair&quot;, &quot;double&quot;, &quot;dotted&quot;, &quot;dashed&quot;, &quot;dashedDotDot&quot;, &quot;dashDot&quot;
Border colors can be created with <code><a href="#topic+wb_color">wb_color()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_border(
  diagonal_down = "",
  diagonal_up = "",
  outline = "",
  bottom = NULL,
  bottom_color = NULL,
  diagonal = NULL,
  diagonal_color = NULL,
  end = "",
  horizontal = "",
  left = NULL,
  left_color = NULL,
  right = NULL,
  right_color = NULL,
  start = "",
  top = NULL,
  top_color = NULL,
  vertical = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_border_+3A_diagonal_down">diagonal_down</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_diagonal_up">diagonal_up</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_outline">outline</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_bottom">bottom</code></td>
<td>
<p>X</p>
</td></tr>
<tr><td><code id="create_border_+3A_bottom_color">bottom_color</code>, <code id="create_border_+3A_diagonal_color">diagonal_color</code>, <code id="create_border_+3A_left_color">left_color</code>, <code id="create_border_+3A_right_color">right_color</code>, <code id="create_border_+3A_top_color">top_color</code></td>
<td>
<p>a color created with <code><a href="#topic+wb_color">wb_color()</a></code></p>
</td></tr>
<tr><td><code id="create_border_+3A_diagonal">diagonal</code></td>
<td>
<p>X</p>
</td></tr>
<tr><td><code id="create_border_+3A_end">end</code></td>
<td>
<p>x,</p>
</td></tr>
<tr><td><code id="create_border_+3A_horizontal">horizontal</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_left">left</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_right">right</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_start">start</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_top">top</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_vertical">vertical</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="create_border_+3A_...">...</code></td>
<td>
<p>x</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_border">wb_add_border()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>

<hr>
<h2 id='create_cell_style'>Helper to create a cell style</h2><span id='topic+create_cell_style'></span>

<h3>Description</h3>

<p>Helper to create a cell style
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_cell_style(
  border_id = "",
  fill_id = "",
  font_id = "",
  num_fmt_id = "",
  pivot_button = "",
  quote_prefix = "",
  xf_id = "",
  horizontal = "",
  indent = "",
  justify_last_line = "",
  reading_order = "",
  relative_indent = "",
  shrink_to_fit = "",
  text_rotation = "",
  vertical = "",
  wrap_text = "",
  ext_lst = "",
  hidden = "",
  locked = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_cell_style_+3A_border_id">border_id</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_fill_id">fill_id</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_font_id">font_id</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_num_fmt_id">num_fmt_id</code></td>
<td>
<p>a numFmt ID for a builtin style</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_pivot_button">pivot_button</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_quote_prefix">quote_prefix</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_xf_id">xf_id</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_horizontal">horizontal</code></td>
<td>
<p>alignment can be &quot;&quot;, &quot;center&quot;, &quot;right&quot;</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_indent">indent</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_justify_last_line">justify_last_line</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_reading_order">reading_order</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_relative_indent">relative_indent</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_shrink_to_fit">shrink_to_fit</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_text_rotation">text_rotation</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_vertical">vertical</code></td>
<td>
<p>alignment can be &quot;&quot;, &quot;center&quot;, &quot;right&quot;</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_wrap_text">wrap_text</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_ext_lst">ext_lst</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_hidden">hidden</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_locked">locked</code></td>
<td>
<p>dummy</p>
</td></tr>
<tr><td><code id="create_cell_style_+3A_...">...</code></td>
<td>
<p>reserved for additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
   "ID" </td><td style="text-align: left;"> "numFmt" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "0" </td><td style="text-align: left;"> "General" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "1" </td><td style="text-align: left;"> "0" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "2" </td><td style="text-align: left;"> "0.00" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "3" </td><td style="text-align: left;"> "#,##0" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "4" </td><td style="text-align: left;"> "#,##0.00" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "9" </td><td style="text-align: left;"> "0%" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "10" </td><td style="text-align: left;"> "0.00%" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "11" </td><td style="text-align: left;"> "0.00E+00" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "12" </td><td style="text-align: left;"> "# ?/?" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "13" </td><td style="text-align: left;"> "# ??/??" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "14" </td><td style="text-align: left;"> "mm-dd-yy" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "15" </td><td style="text-align: left;"> "d-mmm-yy" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "16" </td><td style="text-align: left;"> "d-mmm" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "17" </td><td style="text-align: left;"> "mmm-yy" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "18" </td><td style="text-align: left;"> "h:mm AM/PM" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "19" </td><td style="text-align: left;"> "h:mm:ss AM/PM" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "20" </td><td style="text-align: left;"> "h:mm" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "21" </td><td style="text-align: left;"> "h:mm:ss" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "22" </td><td style="text-align: left;"> "m/d/yy h:mm" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "37" </td><td style="text-align: left;"> "#,##0 ;(#,##0)" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "38" </td><td style="text-align: left;"> "#,##0 ;[Red](#,##0)" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "39" </td><td style="text-align: left;"> "#,##0.00;(#,##0.00)" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "40" </td><td style="text-align: left;"> "#,##0.00;[Red](#,##0.00)" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "45" </td><td style="text-align: left;"> "mm:ss" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "46" </td><td style="text-align: left;"> "[h]:mm:ss" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "47" </td><td style="text-align: left;"> "mmss.0" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "48" </td><td style="text-align: left;"> "##0.0E+0" </td>
</tr>
<tr>
 <td style="text-align: left;">
   "49" </td><td style="text-align: left;"> "@" </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+wb_add_cell_style">wb_add_cell_style()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>

<hr>
<h2 id='create_colors_xml'>Create custom color xml schemes</h2><span id='topic+create_colors_xml'></span><span id='topic+create_colours_xml'></span>

<h3>Description</h3>

<p>Create custom color themes that can be used with <code><a href="#topic+wb_set_base_colors">wb_set_base_colors()</a></code>. The color input will be checked with <code><a href="#topic+wb_color">wb_color()</a></code>, so it must be either a color R from <code><a href="grDevices.html#topic+colors">grDevices::colors()</a></code> or a hex value.
Default values for the dark argument are: <code>black</code>, <code>white</code>, <code>darkblue</code> and <code>lightgray</code>. For the accent argument, the six inner values of <code><a href="grDevices.html#topic+palette">grDevices::palette()</a></code>. The link argument uses <code>blue</code> and <code>purple</code> by default for active and visited links.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_colors_xml(name = "Base R", dark = NULL, accent = NULL, link = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_colors_xml_+3A_name">name</code></td>
<td>
<p>the color name</p>
</td></tr>
<tr><td><code id="create_colors_xml_+3A_dark">dark</code></td>
<td>
<p>four colors: dark, light, brighter dark, darker light</p>
</td></tr>
<tr><td><code id="create_colors_xml_+3A_accent">accent</code></td>
<td>
<p>six accent colors</p>
</td></tr>
<tr><td><code id="create_colors_xml_+3A_link">link</code></td>
<td>
<p>two link colors: link and visited link</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>colors &lt;- create_colors_xml()
wb &lt;- wb_workbook()$add_worksheet()$set_base_colors(xml = colors)
</code></pre>

<hr>
<h2 id='create_comment'>Create a comment</h2><span id='topic+create_comment'></span>

<h3>Description</h3>

<p>Use <code><a href="#topic+wb_comment">wb_comment()</a></code> in new code. See <a href="#topic+openxlsx2-deprecated">openxlsx2-deprecated</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_comment(
  text,
  author = Sys.info()[["user"]],
  style = NULL,
  visible = TRUE,
  width = 2,
  height = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_comment_+3A_text">text</code></td>
<td>
<p>Comment text. Character vector. or a <code><a href="#topic+fmt_txt">fmt_txt()</a></code> string.</p>
</td></tr>
<tr><td><code id="create_comment_+3A_author">author</code></td>
<td>
<p>A string, by default, will use &quot;user&quot;</p>
</td></tr>
<tr><td><code id="create_comment_+3A_style">style</code></td>
<td>
<p>A Style object or list of style objects the same length as comment vector.</p>
</td></tr>
<tr><td><code id="create_comment_+3A_visible">visible</code></td>
<td>
<p>Default: <code>TRUE</code>. Is the comment visible by default?</p>
</td></tr>
<tr><td><code id="create_comment_+3A_width">width</code></td>
<td>
<p>Textbox integer width in number of cells</p>
</td></tr>
<tr><td><code id="create_comment_+3A_height">height</code></td>
<td>
<p>Textbox integer height in number of cells</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>wbComment</code> object
</p>

<hr>
<h2 id='create_dxfs_style'>Create a custom formatting style</h2><span id='topic+create_dxfs_style'></span>

<h3>Description</h3>

<p>Create a new style to apply to worksheet cells. Created styles have to be
assigned to a workbook to use them
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_dxfs_style(
  font_name = NULL,
  font_size = NULL,
  font_color = NULL,
  num_fmt = NULL,
  border = NULL,
  border_color = wb_color(getOption("openxlsx2.borderColor", "black")),
  border_style = getOption("openxlsx2.borderStyle", "thin"),
  bg_fill = NULL,
  fg_color = NULL,
  gradient_fill = NULL,
  text_bold = NULL,
  text_strike = NULL,
  text_italic = NULL,
  text_underline = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_dxfs_style_+3A_font_name">font_name</code></td>
<td>
<p>A name of a font. Note the font name is not validated.
If <code>font_name</code> is <code>NULL</code>, the workbook <code>base_font</code> is used. (Defaults to Calibri), see <code><a href="#topic+wb_get_base_font">wb_get_base_font()</a></code></p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_font_size">font_size</code></td>
<td>
<p>Font size. A numeric greater than 0.
By default, the workbook base font size is used. (Defaults to 11)</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_font_color">font_color</code></td>
<td>
<p>Color of text in cell.  A valid hex color beginning with &quot;#&quot;
or one of colors(). If <code>font_color</code> is NULL, the workbook base font colors is used.
(Defaults to black)</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_num_fmt">num_fmt</code></td>
<td>
<p>Cell formatting. Some custom openxml format</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_border">border</code></td>
<td>
<p><code>NULL</code> or <code>TRUE</code></p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_border_color">border_color</code></td>
<td>
<p>&quot;black&quot;</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_border_style">border_style</code></td>
<td>
<p>&quot;thin&quot;</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_bg_fill">bg_fill</code></td>
<td>
<p>Cell background fill color.</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_fg_color">fg_color</code></td>
<td>
<p>Cell foreground fill color.</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_gradient_fill">gradient_fill</code></td>
<td>
<p>An xml string beginning with <code style="white-space: pre;">&#8288;&lt;gradientFill&gt;&#8288;</code> ...</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_text_bold">text_bold</code></td>
<td>
<p>bold</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_text_strike">text_strike</code></td>
<td>
<p>strikeout</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_text_italic">text_italic</code></td>
<td>
<p>italic</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_text_underline">text_underline</code></td>
<td>
<p>underline 1, true, single or double</p>
</td></tr>
<tr><td><code id="create_dxfs_style_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is possible to override border_color and border_style with {left, right, top, bottom}_color, {left, right, top, bottom}_style.
</p>


<h3>Value</h3>

<p>A dxfs style node
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_style">wb_add_style()</a></code> <code><a href="#topic+wb_add_dxfs_style">wb_add_dxfs_style()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># do not apply anything
style1 &lt;- create_dxfs_style()

# change font color and background color
style2 &lt;- create_dxfs_style(
  font_color = wb_color(hex = "FF9C0006"),
  bgFill = wb_color(hex = "FFFFC7CE")
)

# change font (type, size and color) and background
# the old default in openxlsx and openxlsx2 &lt;= 0.3
style3 &lt;- create_dxfs_style(
  font_name = "Aptos Narrow",
  font_size = 11,
  font_color = wb_color(hex = "FF9C0006"),
  bgFill = wb_color(hex = "FFFFC7CE")
)

## See package vignettes for further examples
</code></pre>

<hr>
<h2 id='create_fill'>Create fill pattern</h2><span id='topic+create_fill'></span>

<h3>Description</h3>

<p>Create fill pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_fill(
  gradientFill = "",
  patternType = "",
  bgColor = NULL,
  fgColor = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_fill_+3A_gradientfill">gradientFill</code></td>
<td>
<p>complex fills</p>
</td></tr>
<tr><td><code id="create_fill_+3A_patterntype">patternType</code></td>
<td>
<p>various: default is &quot;none&quot;, but also &quot;solid&quot;, or a color like &quot;gray125&quot;</p>
</td></tr>
<tr><td><code id="create_fill_+3A_bgcolor">bgColor</code></td>
<td>
<p>hex8 color with alpha, red, green, blue only for patternFill</p>
</td></tr>
<tr><td><code id="create_fill_+3A_fgcolor">fgColor</code></td>
<td>
<p>hex8 color with alpha, red, green, blue only for patternFill</p>
</td></tr>
<tr><td><code id="create_fill_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_fill">wb_add_fill()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>

<hr>
<h2 id='create_font'>Create font format</h2><span id='topic+create_font'></span>

<h3>Description</h3>

<p>Create font format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_font(
  b = "",
  charset = "",
  color = wb_color(hex = "FF000000"),
  condense = "",
  extend = "",
  family = "2",
  i = "",
  name = "Aptos Narrow",
  outline = "",
  scheme = "minor",
  shadow = "",
  strike = "",
  sz = "11",
  u = "",
  vert_align = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_font_+3A_b">b</code></td>
<td>
<p>bold</p>
</td></tr>
<tr><td><code id="create_font_+3A_charset">charset</code></td>
<td>
<p>charset</p>
</td></tr>
<tr><td><code id="create_font_+3A_color">color</code></td>
<td>
<p>rgb color: default &quot;FF000000&quot;</p>
</td></tr>
<tr><td><code id="create_font_+3A_condense">condense</code></td>
<td>
<p>condense</p>
</td></tr>
<tr><td><code id="create_font_+3A_extend">extend</code></td>
<td>
<p>extend</p>
</td></tr>
<tr><td><code id="create_font_+3A_family">family</code></td>
<td>
<p>font family: default &quot;2&quot;</p>
</td></tr>
<tr><td><code id="create_font_+3A_i">i</code></td>
<td>
<p>italic</p>
</td></tr>
<tr><td><code id="create_font_+3A_name">name</code></td>
<td>
<p>font name: default &quot;Aptos Narrow&quot;</p>
</td></tr>
<tr><td><code id="create_font_+3A_outline">outline</code></td>
<td>
<p>outline</p>
</td></tr>
<tr><td><code id="create_font_+3A_scheme">scheme</code></td>
<td>
<p>font scheme: default &quot;minor&quot;</p>
</td></tr>
<tr><td><code id="create_font_+3A_shadow">shadow</code></td>
<td>
<p>shadow</p>
</td></tr>
<tr><td><code id="create_font_+3A_strike">strike</code></td>
<td>
<p>strike</p>
</td></tr>
<tr><td><code id="create_font_+3A_sz">sz</code></td>
<td>
<p>font size: default &quot;11&quot;,</p>
</td></tr>
<tr><td><code id="create_font_+3A_u">u</code></td>
<td>
<p>underline</p>
</td></tr>
<tr><td><code id="create_font_+3A_vert_align">vert_align</code></td>
<td>
<p>vertical alignment</p>
</td></tr>
<tr><td><code id="create_font_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_font">wb_add_font()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>font &lt;- create_font()
# openxml has the alpha value leading
hex8 &lt;- unlist(xml_attr(read_xml(font), "font", "color"))
hex8 &lt;- paste0("#", substr(hex8, 3, 8), substr(hex8, 1, 2))

# # write test color
# col &lt;- crayon::make_style(col2rgb(hex8, alpha = TRUE))
# cat(col("Test"))
</code></pre>

<hr>
<h2 id='create_hyperlink'>Create Excel hyperlink string</h2><span id='topic+create_hyperlink'></span>

<h3>Description</h3>

<p>Wrapper to create internal hyperlink string to pass to <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code>.
Either link to external URLs or local files or straight to cells of local Excel sheets.
</p>
<p>Note that for an external URL, only <code>file</code> and <code>text</code> should be supplied.
You can supply <code>dims</code> to <code>wb_add_formula()</code> to control the location of the link.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_hyperlink(sheet, row = 1, col = 1, text = NULL, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_hyperlink_+3A_sheet">sheet</code></td>
<td>
<p>Name of a worksheet</p>
</td></tr>
<tr><td><code id="create_hyperlink_+3A_row">row</code></td>
<td>
<p>integer row number for hyperlink to link to</p>
</td></tr>
<tr><td><code id="create_hyperlink_+3A_col">col</code></td>
<td>
<p>column number of letter for hyperlink to link to</p>
</td></tr>
<tr><td><code id="create_hyperlink_+3A_text">text</code></td>
<td>
<p>Display text</p>
</td></tr>
<tr><td><code id="create_hyperlink_+3A_file">file</code></td>
<td>
<p>Hyperlink or Excel file name to point to. If <code>NULL</code>, hyperlink is internal.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$
  add_worksheet("Sheet1")$add_worksheet("Sheet2")$add_worksheet("Sheet3")

## Internal Hyperlink - create hyperlink formula manually
x &lt;- '=HYPERLINK(\"#Sheet2!B3\", "Text to Display - Link to Sheet2")'
wb$add_formula(sheet = "Sheet1", x = x, dims = "A1")

## Internal - No text to display using create_hyperlink() function
x &lt;- create_hyperlink(sheet = "Sheet3", row = 1, col = 2)
wb$add_formula(sheet = "Sheet1", x = x, dims = "A2")

## Internal - Text to display
x &lt;- create_hyperlink(sheet = "Sheet3", row = 1, col = 2,text = "Link to Sheet 3")
wb$add_formula(sheet = "Sheet1", x = x, dims = "A3")

## Link to file - No text to display
fl &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
x &lt;- create_hyperlink(sheet = "Sheet1", row = 3, col = 10, file = fl)
wb$add_formula(sheet = "Sheet1", x = x, dims = "A4")

## Link to file - Text to display
fl &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
x &lt;- create_hyperlink(sheet = "Sheet2", row = 3, col = 10, file = fl, text = "Link to File.")
wb$add_formula(sheet = "Sheet1", x = x, dims = "A5")

## Link to external file - Text to display
x &lt;- '=HYPERLINK("[C:/Users]", "Link to an external file")'
wb$add_formula(sheet = "Sheet1", x = x, dims = "A6")

x &lt;- create_hyperlink(text = "test.png", file = "D:/somepath/somepicture.png")
wb$add_formula(x = x, dims = "A7")


## Link to an URL.
x &lt;- create_hyperlink(text = "openxlsx2 website", file = "https://janmarvin.github.io/openxlsx2/")

wb$add_formula(x = x, dims = "A8")
# if (interactive()) wb$open()

</code></pre>

<hr>
<h2 id='create_numfmt'>Create number format</h2><span id='topic+create_numfmt'></span>

<h3>Description</h3>

<p>Create number format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_numfmt(numFmtId, formatCode)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_numfmt_+3A_numfmtid">numFmtId</code></td>
<td>
<p>an id, the list can be found in the <strong>Details</strong> of <code><a href="#topic+create_cell_style">create_cell_style()</a></code></p>
</td></tr>
<tr><td><code id="create_numfmt_+3A_formatcode">formatCode</code></td>
<td>
<p>a format code</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_numfmt">wb_add_numfmt()</a></code>
</p>
<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_tablestyle">create_tablestyle</a>()</code>
</p>

<hr>
<h2 id='create_sparklines'>Create sparklines object</h2><span id='topic+create_sparklines'></span>

<h3>Description</h3>

<p>Create a sparkline to be added a workbook with <code><a href="#topic+wb_add_sparklines">wb_add_sparklines()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_sparklines(
  sheet = current_sheet(),
  dims,
  sqref,
  type = NULL,
  negative = NULL,
  display_empty_cells_as = "gap",
  markers = NULL,
  high = NULL,
  low = NULL,
  first = NULL,
  last = NULL,
  color_series = wb_color(hex = "FF376092"),
  color_negative = wb_color(hex = "FFD00000"),
  color_axis = wb_color(hex = "FFD00000"),
  color_markers = wb_color(hex = "FFD00000"),
  color_first = wb_color(hex = "FFD00000"),
  color_last = wb_color(hex = "FFD00000"),
  color_high = wb_color(hex = "FFD00000"),
  color_low = wb_color(hex = "FFD00000"),
  manual_max = NULL,
  manual_min = NULL,
  line_weight = NULL,
  date_axis = NULL,
  display_x_axis = NULL,
  display_hidden = NULL,
  min_axis_type = NULL,
  max_axis_type = NULL,
  right_to_left = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_sparklines_+3A_sheet">sheet</code></td>
<td>
<p>sheet</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_dims">dims</code></td>
<td>
<p>Cell range of cells used to create the sparklines</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_sqref">sqref</code></td>
<td>
<p>Cell range of the destination of the sparklines.</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_type">type</code></td>
<td>
<p>Either <code>NULL</code>, <code>stacked</code> or <code>column</code></p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_negative">negative</code></td>
<td>
<p>negative</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_display_empty_cells_as">display_empty_cells_as</code></td>
<td>
<p>Either <code>gap</code>, <code>span</code> or <code>zero</code></p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_markers">markers</code></td>
<td>
<p>markers add marker to line</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_high">high</code></td>
<td>
<p>highlight highest value</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_low">low</code></td>
<td>
<p>highlight lowest value</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_first">first</code></td>
<td>
<p>highlight first value</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_last">last</code></td>
<td>
<p>highlight last value</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_series">color_series</code></td>
<td>
<p>colorSeries</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_negative">color_negative</code></td>
<td>
<p>colorNegative</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_axis">color_axis</code></td>
<td>
<p>colorAxis</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_markers">color_markers</code></td>
<td>
<p>colorMarkers</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_first">color_first</code></td>
<td>
<p>colorFirst</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_last">color_last</code></td>
<td>
<p>colorLast</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_high">color_high</code></td>
<td>
<p>colorHigh</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_color_low">color_low</code></td>
<td>
<p>colorLow</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_manual_max">manual_max</code></td>
<td>
<p>manualMax</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_manual_min">manual_min</code></td>
<td>
<p>manualMin</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_line_weight">line_weight</code></td>
<td>
<p>lineWeight</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_date_axis">date_axis</code></td>
<td>
<p>dateAxis</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_display_x_axis">display_x_axis</code></td>
<td>
<p>displayXAxis</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_display_hidden">display_hidden</code></td>
<td>
<p>displayHidden</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_min_axis_type">min_axis_type</code></td>
<td>
<p>minAxisType</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_max_axis_type">max_axis_type</code></td>
<td>
<p>maxAxisType</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_right_to_left">right_to_left</code></td>
<td>
<p>rightToLeft</p>
</td></tr>
<tr><td><code id="create_sparklines_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Colors are all predefined to be rgb. Maybe theme colors can be
used too.
</p>


<h3>Value</h3>

<p>A string containing XML code
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create sparklineGroup
sparklines &lt;- c(
  create_sparklines("Sheet 1", "A3:L3", "M3", type = "column", first = "1"),
  create_sparklines("Sheet 1", "A2:L2", "M2", markers = "1"),
  create_sparklines("Sheet 1", "A4:L4", "M4", type = "stacked", negative = "1")
)

t1 &lt;- AirPassengers
t2 &lt;- do.call(cbind, split(t1, cycle(t1)))
dimnames(t2) &lt;- dimnames(.preformat.ts(t1))

wb &lt;- wb_workbook()$
  add_worksheet("Sheet 1")$
  add_data(x = t2)$
  add_sparklines(sparklines = sparklines)

</code></pre>

<hr>
<h2 id='create_tablestyle'>Create custom (pivot) table styles</h2><span id='topic+create_tablestyle'></span><span id='topic+create_pivottablestyle'></span>

<h3>Description</h3>

<p>Create a custom (pivot) table style.
These functions are for expert use only. Use other styling functions instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_tablestyle(
  name,
  whole_table = NULL,
  header_row = NULL,
  total_row = NULL,
  first_column = NULL,
  last_column = NULL,
  first_row_stripe = NULL,
  second_row_stripe = NULL,
  first_column_stripe = NULL,
  second_column_stripe = NULL,
  first_header_cell = NULL,
  last_header_cell = NULL,
  first_total_cell = NULL,
  last_total_cell = NULL,
  ...
)

create_pivottablestyle(
  name,
  whole_table = NULL,
  header_row = NULL,
  grand_total_row = NULL,
  first_column = NULL,
  grand_total_column = NULL,
  first_row_stripe = NULL,
  second_row_stripe = NULL,
  first_column_stripe = NULL,
  second_column_stripe = NULL,
  first_header_cell = NULL,
  first_subtotal_column = NULL,
  second_subtotal_column = NULL,
  third_subtotal_column = NULL,
  first_subtotal_row = NULL,
  second_subtotal_row = NULL,
  third_subtotal_row = NULL,
  blank_row = NULL,
  first_column_subheading = NULL,
  second_column_subheading = NULL,
  third_column_subheading = NULL,
  first_row_subheading = NULL,
  second_row_subheading = NULL,
  third_row_subheading = NULL,
  page_field_labels = NULL,
  page_field_values = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_tablestyle_+3A_name">name</code></td>
<td>
<p>name</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_whole_table">whole_table</code></td>
<td>
<p>wholeTable</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_header_row">header_row</code>, <code id="create_tablestyle_+3A_total_row">total_row</code></td>
<td>
<p>...Row</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_column">first_column</code>, <code id="create_tablestyle_+3A_last_column">last_column</code></td>
<td>
<p>...Column</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_row_stripe">first_row_stripe</code>, <code id="create_tablestyle_+3A_second_row_stripe">second_row_stripe</code></td>
<td>
<p>...RowStripe</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_column_stripe">first_column_stripe</code>, <code id="create_tablestyle_+3A_second_column_stripe">second_column_stripe</code></td>
<td>
<p>...ColumnStripe</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_header_cell">first_header_cell</code>, <code id="create_tablestyle_+3A_last_header_cell">last_header_cell</code></td>
<td>
<p>...HeaderCell</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_total_cell">first_total_cell</code>, <code id="create_tablestyle_+3A_last_total_cell">last_total_cell</code></td>
<td>
<p>...TotalCell</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_grand_total_row">grand_total_row</code></td>
<td>
<p>totalRow</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_grand_total_column">grand_total_column</code></td>
<td>
<p>lastColumn</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_subtotal_column">first_subtotal_column</code>, <code id="create_tablestyle_+3A_second_subtotal_column">second_subtotal_column</code>, <code id="create_tablestyle_+3A_third_subtotal_column">third_subtotal_column</code></td>
<td>
<p>...SubtotalColumn</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_subtotal_row">first_subtotal_row</code>, <code id="create_tablestyle_+3A_second_subtotal_row">second_subtotal_row</code>, <code id="create_tablestyle_+3A_third_subtotal_row">third_subtotal_row</code></td>
<td>
<p>...SubtotalRow</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_blank_row">blank_row</code></td>
<td>
<p>blankRow</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_column_subheading">first_column_subheading</code>, <code id="create_tablestyle_+3A_second_column_subheading">second_column_subheading</code>, <code id="create_tablestyle_+3A_third_column_subheading">third_column_subheading</code></td>
<td>
<p>...ColumnSubheading</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_first_row_subheading">first_row_subheading</code>, <code id="create_tablestyle_+3A_second_row_subheading">second_row_subheading</code>, <code id="create_tablestyle_+3A_third_row_subheading">third_row_subheading</code></td>
<td>
<p>...RowSubheading</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_page_field_labels">page_field_labels</code></td>
<td>
<p>pageFieldLabels</p>
</td></tr>
<tr><td><code id="create_tablestyle_+3A_page_field_values">page_field_values</code></td>
<td>
<p>pageFieldValues</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other style creating functions: 
<code><a href="#topic+create_border">create_border</a>()</code>,
<code><a href="#topic+create_cell_style">create_cell_style</a>()</code>,
<code><a href="#topic+create_colors_xml">create_colors_xml</a>()</code>,
<code><a href="#topic+create_dxfs_style">create_dxfs_style</a>()</code>,
<code><a href="#topic+create_fill">create_fill</a>()</code>,
<code><a href="#topic+create_font">create_font</a>()</code>,
<code><a href="#topic+create_numfmt">create_numfmt</a>()</code>
</p>

<hr>
<h2 id='creators-wb'>Modify creators of a workbook</h2><span id='topic+creators-wb'></span><span id='topic+wb_add_creators'></span><span id='topic+wb_set_creators'></span><span id='topic+wb_remove_creators'></span><span id='topic+wb_get_creators'></span>

<h3>Description</h3>

<p>Modify and get workbook creators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_creators(wb, creators)

wb_set_creators(wb, creators)

wb_remove_creators(wb, creators)

wb_get_creators(wb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="creators-wb_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="creators-wb_+3A_creators">creators</code></td>
<td>
<p>A character vector of names</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>wb_set_creators()</code>, <code>wb_add_creators()</code>, and <code>wb_remove_creators()</code> return
the <code>wbWorkbook</code> object
</p>
</li>
<li> <p><code>wb_get_creators()</code> returns a <code>character</code> vector of creators
</p>
</li></ul>



<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# workbook made with default creator (see [wbWorkbook])
wb &lt;- wb_workbook()
wb_get_creators(wb)

# add a new creator (assuming "test" isn't your default creator)
wb &lt;- wb_add_creators(wb, "test")
wb_get_creators(wb)

# remove the creator (should be the same as before)
wb &lt;- wb_remove_creators(wb, "test")
wb_get_creators(wb)

</code></pre>

<hr>
<h2 id='dataframe_to_dims'>Create dimensions from dataframe</h2><span id='topic+dataframe_to_dims'></span>

<h3>Description</h3>

<p>Use <code><a href="#topic+wb_dims">wb_dims()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataframe_to_dims(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataframe_to_dims_+3A_df">df</code></td>
<td>
<p>dataframe with spreadsheet columns and rows</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> df &lt;- dims_to_dataframe("A1:D5;F1:F6;D8", fill = TRUE)
 dataframe_to_dims(df)
</code></pre>

<hr>
<h2 id='delete_data'>Delete data</h2><span id='topic+delete_data'></span>

<h3>Description</h3>

<p>This function is deprecated. Use <code><a href="#topic+wb_clean_sheet">wb_clean_sheet()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_data(wb, sheet, cols, rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delete_data_+3A_wb">wb</code></td>
<td>
<p>workbook</p>
</td></tr>
<tr><td><code id="delete_data_+3A_sheet">sheet</code></td>
<td>
<p>sheet to clean</p>
</td></tr>
<tr><td><code id="delete_data_+3A_cols">cols</code></td>
<td>
<p>numeric column vector</p>
</td></tr>
<tr><td><code id="delete_data_+3A_rows">rows</code></td>
<td>
<p>numeric row vector</p>
</td></tr>
</table>

<hr>
<h2 id='dims_helper'>Helper functions to work with <code>dims</code></h2><span id='topic+dims_helper'></span><span id='topic+dims_to_rowcol'></span><span id='topic+rowcol_to_dims'></span>

<h3>Description</h3>

<p>Internal helpers to (de)construct a dims argument from/to a row and column
vector. Exported for user convenience.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dims_to_rowcol(x, as_integer = FALSE)

rowcol_to_dims(row, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dims_helper_+3A_x">x</code></td>
<td>
<p>a dimension object &quot;A1&quot; or &quot;A1:A1&quot;</p>
</td></tr>
<tr><td><code id="dims_helper_+3A_as_integer">as_integer</code></td>
<td>
<p>If the output should be returned as integer, (defaults to string)</p>
</td></tr>
<tr><td><code id="dims_helper_+3A_row">row</code></td>
<td>
<p>a numeric vector of rows</p>
</td></tr>
<tr><td><code id="dims_helper_+3A_col">col</code></td>
<td>
<p>a numeric or character vector of cols</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> A <code>dims</code> string for <code style="white-space: pre;">&#8288;_to_dim&#8288;</code> i.e  &quot;A1:A1&quot;
</p>
</li>
<li><p> A list of rows and columns for <code>to_rowcol</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+wb_dims">wb_dims()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dims_to_rowcol("A1:J10")
wb_dims(1:10, 1:10)

</code></pre>

<hr>
<h2 id='dims_to_dataframe'>Create dataframe from dimensions</h2><span id='topic+dims_to_dataframe'></span>

<h3>Description</h3>

<p>Create dataframe from dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dims_to_dataframe(dims, fill = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dims_to_dataframe_+3A_dims">dims</code></td>
<td>
<p>Character vector of expected dimension.</p>
</td></tr>
<tr><td><code id="dims_to_dataframe_+3A_fill">fill</code></td>
<td>
<p>If <code>TRUE</code>, fills the dataframe with variables</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dims_to_dataframe("A1:B2")
</code></pre>

<hr>
<h2 id='filter-wb'>Add/remove column filters in a worksheet</h2><span id='topic+filter-wb'></span><span id='topic+wb_add_filter'></span><span id='topic+wb_remove_filter'></span>

<h3>Description</h3>

<p>Add or remove excel column filters to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_filter(wb, sheet = current_sheet(), rows, cols)

wb_remove_filter(wb, sheet = current_sheet())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter-wb_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="filter-wb_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet name or index.
In <code>wb_remove_filter()</code>, you may supply a vector of worksheets.</p>
</td></tr>
<tr><td><code id="filter-wb_+3A_rows">rows</code></td>
<td>
<p>A row number.</p>
</td></tr>
<tr><td><code id="filter-wb_+3A_cols">cols</code></td>
<td>
<p>columns to add filter to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adds filters to worksheet columns, same as <code>with_filter = TRUE</code> in <code><a href="#topic+wb_add_data">wb_add_data()</a></code>
<code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code> automatically adds filters to first row of a table.
</p>
<p>NOTE Can only have a single filter per worksheet unless using tables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_data">wb_add_data()</a></code>, <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
wb$add_worksheet("Sheet 2")
wb$add_worksheet("Sheet 3")

wb$add_data(1, iris)
wb$add_filter(1, row = 1, cols = seq_along(iris))

## Equivalently
wb$add_data(2, x = iris, with_filter = TRUE)

## Similarly
wb$add_data_table(3, iris)
wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
wb$add_worksheet("Sheet 2")
wb$add_worksheet("Sheet 3")

wb$add_data(1, iris)
wb_add_filter(wb, 1, row = 1, cols = seq_along(iris))

## Equivalently
wb$add_data(2, x = iris, with_filter = TRUE)

## Similarly
wb$add_data_table(3, iris)

## remove filters
wb_remove_filter(wb, 1:2) ## remove filters
wb_remove_filter(wb, 3) ## Does not affect tables!
</code></pre>

<hr>
<h2 id='fmt_txt'>format strings independent of the cell style.</h2><span id='topic+fmt_txt'></span><span id='topic++2B.fmt_txt'></span><span id='topic+as.character.fmt_txt'></span><span id='topic+print.fmt_txt'></span>

<h3>Description</h3>

<p>format strings independent of the cell style.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmt_txt(
  x,
  bold = FALSE,
  italic = FALSE,
  underline = FALSE,
  strike = FALSE,
  size = NULL,
  color = NULL,
  font = NULL,
  charset = NULL,
  outline = NULL,
  vert_align = NULL
)

## S3 method for class 'fmt_txt'
x + y

## S3 method for class 'fmt_txt'
as.character(x, ...)

## S3 method for class 'fmt_txt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmt_txt_+3A_x">x</code>, <code id="fmt_txt_+3A_y">y</code></td>
<td>
<p>an openxlsx2 fmt_txt string</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_bold">bold</code></td>
<td>
<p>bold</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_italic">italic</code></td>
<td>
<p>italic</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_underline">underline</code></td>
<td>
<p>underline</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_strike">strike</code></td>
<td>
<p>strike</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_size">size</code></td>
<td>
<p>the font size</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_color">color</code></td>
<td>
<p>a wbColor color for the font</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_font">font</code></td>
<td>
<p>the font name</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_charset">charset</code></td>
<td>
<p>integer value from the table below</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_outline">outline</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_vert_align">vert_align</code></td>
<td>
<p>baseline, superscript, or subscript</p>
</td></tr>
<tr><td><code id="fmt_txt_+3A_...">...</code></td>
<td>
<p>additional arguments for default print</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result is an xml string. It is possible to paste multiple <code>fmt_txt()</code>
strings together to create a string with differing styles.
</p>
<p>Using <code>fmt_txt(charset = 161)</code> will give the Greek Character Set</p>

<table>
<tr>
 <td style="text-align: left;">
   charset </td><td style="text-align: left;"> "Character Set" </td>
</tr>
<tr>
 <td style="text-align: left;">
   0 </td><td style="text-align: left;"> "ANSI_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> "DEFAULT_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   2 </td><td style="text-align: left;"> "SYMBOL_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   77 </td><td style="text-align: left;"> "MAC_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   128 </td><td style="text-align: left;"> "SHIFTJIS_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   129 </td><td style="text-align: left;"> "HANGUL_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   130 </td><td style="text-align: left;"> "JOHAB_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   134 </td><td style="text-align: left;"> "GB2312_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   136 </td><td style="text-align: left;"> "CHINESEBIG5_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   161 </td><td style="text-align: left;"> "GREEK_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   162 </td><td style="text-align: left;"> "TURKISH_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   163 </td><td style="text-align: left;"> "VIETNAMESE_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   177 </td><td style="text-align: left;"> "HEBREW_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   178 </td><td style="text-align: left;"> "ARABIC_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   186 </td><td style="text-align: left;"> "BALTIC_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   204 </td><td style="text-align: left;"> "RUSSIAN_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   222 </td><td style="text-align: left;"> "THAI_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   238 </td><td style="text-align: left;"> "EASTEUROPE_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
   255 </td><td style="text-align: left;"> "OEM_CHARSET" </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>You can join additional objects into fmt_txt() objects using &quot;+&quot;.
Though be aware that <code>fmt_txt("sum:") + (2 + 2)</code> is different to <code>fmt_txt("sum:") + 2 + 2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fmt_txt("bar", underline = TRUE)
fmt_txt("foo ", bold = TRUE) + fmt_txt("bar")
as.character(fmt_txt(2))
</code></pre>

<hr>
<h2 id='grouping-wb'>Group rows and columns in a worksheet</h2><span id='topic+grouping-wb'></span><span id='topic+wb_group_cols'></span><span id='topic+wb_ungroup_cols'></span><span id='topic+wb_group_rows'></span><span id='topic+wb_ungroup_rows'></span>

<h3>Description</h3>

<p>Group a selection of rows or cols
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_group_cols(
  wb,
  sheet = current_sheet(),
  cols,
  collapsed = FALSE,
  levels = NULL
)

wb_ungroup_cols(wb, sheet = current_sheet(), cols)

wb_group_rows(
  wb,
  sheet = current_sheet(),
  rows,
  collapsed = FALSE,
  levels = NULL
)

wb_ungroup_rows(wb, sheet = current_sheet(), rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grouping-wb_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="grouping-wb_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="grouping-wb_+3A_collapsed">collapsed</code></td>
<td>
<p>If <code>TRUE</code> the grouped columns are collapsed</p>
</td></tr>
<tr><td><code id="grouping-wb_+3A_levels">levels</code></td>
<td>
<p>levels</p>
</td></tr>
<tr><td><code id="grouping-wb_+3A_rows">rows</code>, <code id="grouping-wb_+3A_cols">cols</code></td>
<td>
<p>Indices of rows and columns to group</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If row was previously hidden, it will now be shown.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create matrix
t1 &lt;- AirPassengers
t2 &lt;- do.call(cbind, split(t1, cycle(t1)))
dimnames(t2) &lt;- dimnames(.preformat.ts(t1))

wb &lt;- wb_workbook()
wb$add_worksheet("AirPass")
wb$add_data("AirPass", t2, row_names = TRUE)

# groups will always end on/show the last row. in the example 1950, 1955, and 1960
wb &lt;- wb_group_rows(wb, "AirPass", 2:3, collapsed = TRUE) # group years &lt; 1950
wb &lt;- wb_group_rows(wb, "AirPass", 4:8, collapsed = TRUE) # group years 1951-1955
wb &lt;- wb_group_rows(wb, "AirPass", 9:13)                  # group years 1956-1960

wb &lt;- wb_group_cols(wb, "AirPass", 2:4, collapsed = TRUE)
wb &lt;- wb_group_cols(wb, "AirPass", 5:7, collapsed = TRUE)
wb &lt;- wb_group_cols(wb, "AirPass", 8:10, collapsed = TRUE)
wb &lt;- wb_group_cols(wb, "AirPass", 11:13)

### create grouping levels
grp_rows &lt;- list(
  "1" = seq(2, 3),
  "2" = seq(4, 8),
  "3" = seq(9, 13)
)

grp_cols &lt;- list(
  "1" = seq(2, 4),
  "2" = seq(5, 7),
  "3" = seq(8, 10),
  "4" = seq(11, 13)
)

wb &lt;- wb_workbook()
wb$add_worksheet("AirPass")
wb$add_data("AirPass", t2, row_names = TRUE)

wb$group_cols("AirPass", cols = grp_cols)
wb$group_rows("AirPass", rows = grp_rows)
</code></pre>

<hr>
<h2 id='int2col'>Convert integer to Excel column</h2><span id='topic+int2col'></span>

<h3>Description</h3>

<p>Converts an integer to an Excel column label.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>int2col(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="int2col_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>int2col(1:10)
</code></pre>

<hr>
<h2 id='named_region-wb'>Modify named regions in a worksheet</h2><span id='topic+named_region-wb'></span><span id='topic+wb_add_named_region'></span><span id='topic+wb_remove_named_region'></span><span id='topic+wb_get_named_regions'></span>

<h3>Description</h3>

<p>Create / delete a named region. You can also specify a named region by using
the <code>name</code> argument in <code>wb_add_data(x = iris, name = "my-region")</code>.
It is important to note that named regions are not case-sensitive and must be unique.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_named_region(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  name,
  local_sheet = FALSE,
  overwrite = FALSE,
  comment = NULL,
  hidden = NULL,
  custom_menu = NULL,
  description = NULL,
  is_function = NULL,
  function_group_id = NULL,
  help = NULL,
  local_name = NULL,
  publish_to_server = NULL,
  status_bar = NULL,
  vb_procedure = NULL,
  workbook_parameter = NULL,
  xml = NULL,
  ...
)

wb_remove_named_region(wb, sheet = current_sheet(), name = NULL)

wb_get_named_regions(wb, tables = FALSE, x = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="named_region-wb_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_dims">dims</code></td>
<td>
<p>Worksheet cell range of the region (&quot;A1:D4&quot;).</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_name">name</code></td>
<td>
<p>Name for region. A character vector of length 1. Note that region
names must be case-insensitive unique.</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_local_sheet">local_sheet</code></td>
<td>
<p>If <code>TRUE</code> the named region will be local for this sheet</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_overwrite">overwrite</code></td>
<td>
<p>Boolean. Overwrite if exists? Default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_comment">comment</code></td>
<td>
<p>description text for named region</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_hidden">hidden</code></td>
<td>
<p>Should the named region be hidden?</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_custom_menu">custom_menu</code>, <code id="named_region-wb_+3A_description">description</code>, <code id="named_region-wb_+3A_is_function">is_function</code>, <code id="named_region-wb_+3A_function_group_id">function_group_id</code>, <code id="named_region-wb_+3A_help">help</code>, <code id="named_region-wb_+3A_local_name">local_name</code>, <code id="named_region-wb_+3A_publish_to_server">publish_to_server</code>, <code id="named_region-wb_+3A_status_bar">status_bar</code>, <code id="named_region-wb_+3A_vb_procedure">vb_procedure</code>, <code id="named_region-wb_+3A_workbook_parameter">workbook_parameter</code>, <code id="named_region-wb_+3A_xml">xml</code></td>
<td>
<p>Unknown XML feature</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_tables">tables</code></td>
<td>
<p>Should included both data tables and named regions in the result?</p>
</td></tr>
<tr><td><code id="named_region-wb_+3A_x">x</code></td>
<td>
<p>Deprecated. Use <code>wb</code>. For Excel input use <code><a href="#topic+wb_load">wb_load()</a></code> to first load
the xlsx file as a workbook.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You can use the <code><a href="#topic+wb_dims">wb_dims()</a></code> helper to specify the cell range of the named region
</p>


<h3>Value</h3>

<p>A workbook, invisibly.
</p>
<p>A data frame with the all named regions in <code>wb</code>. Or <code>NULL</code>, if none are found.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_get_tables">wb_get_tables()</a></code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create named regions
wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")

## specify region
wb$add_data(x = iris, start_col = 1, start_row = 1)
wb$add_named_region(
  name = "iris",
  dims = wb_dims(x = iris)
)

## using add_data 'name' argument
wb$add_data(sheet = 1, x = iris, name = "iris2", start_col = 10)

## delete one
wb$remove_named_region(name = "iris2")
wb$get_named_regions()
## read named regions
df &lt;- wb_to_df(wb, named_region = "iris")
head(df)


# Extract named regions from a file
out_file &lt;- temp_xlsx()
wb_save(wb, out_file, overwrite = TRUE)

# Load the file as a workbook first, then get named regions.
wb1 &lt;- wb_load(out_file)
wb1$get_named_regions()

</code></pre>

<hr>
<h2 id='openxlsx2_options'>Options consulted by openxlsx2</h2><span id='topic+openxlsx2_options'></span>

<h3>Description</h3>

<p>The openxlsx2 package allows the user to set global options to simplify formatting:
</p>
<p>If the built-in defaults don't suit you, set one or more of these options.
Typically, this is done in the <code>.Rprofile</code> startup file
</p>

<ul>
<li> <p><code>options("openxlsx2.borderColor" = "black")</code>
</p>
</li>
<li> <p><code>options("openxlsx2.borderStyle" = "thin")</code>
</p>
</li>
<li> <p><code>options("openxlsx2.dateFormat" = "mm/dd/yyyy")</code>
</p>
</li>
<li> <p><code>options("openxlsx2.datetimeFormat" = "yyyy-mm-dd hh:mm:ss")</code>
</p>
</li>
<li> <p><code>options("openxlsx2.maxWidth" = NULL)</code> (Maximum width allowed in Excel is 250)
</p>
</li>
<li> <p><code>options("openxlsx2.minWidth" = NULL)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.numFmt" = NULL)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.paperSize" = 9)</code> corresponds to a A4 paper size
</p>
</li>
<li> <p><code>options("openxlsx2.orientation" = "portrait")</code> page orientation
</p>
</li>
<li> <p><code>options("openxlsx2.sheet.default_name" = "Sheet")</code>
</p>
</li>
<li> <p><code>options("openxlsx2.rightToLeft" = NULL)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.soon_deprecated" = FALSE)</code> Set to <code>TRUE</code> if you want a
warning if using some functions deprecated recently in openxlsx2
</p>
</li>
<li> <p><code>options("openxlsx2.creator")</code> A default name for the creator of new
<code>wbWorkbook</code> object with <code><a href="#topic+wb_workbook">wb_workbook()</a></code> or new comments with <code><a href="#topic+wb_add_comment">wb_add_comment()</a></code>
</p>
</li>
<li> <p><code>options("openxlsx2.thread_id")</code> the default person id when adding a threaded comment
to a cell with <code><a href="#topic+wb_add_thread">wb_add_thread()</a></code>
</p>
</li>
<li> <p><code>options("openxlsx2.accountingFormat" = 4)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.currencyFormat" = 4)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.commaFormat" = 3)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.percentageFormat" = 10)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.scientificFormat" = 48)</code>
</p>
</li>
<li> <p><code>options("openxlsx2.string_nums" = TRUE)</code> numerics in character columns
will be converted. <code>"1"</code> will be written as <code>1</code>
</p>
</li>
<li> <p><code>options("openxlsx2.na.strings" = "#N/A")</code> consulted by <code>write_xlsx()</code>,
<code>wb_add_data()</code> and <code>wb_add_data_table()</code>.
</p>
</li></ul>


<hr>
<h2 id='openxlsx2-deprecated'>Deprecated functions in package <em>openxlsx2</em></h2><span id='topic+openxlsx2-deprecated'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older versions of <code>openxlsx2</code>,
and may be defunct as soon as the next release. This guide helps you update your
code to the latest standards.
</p>
<p>As of openxlsx2 v1.0, API change should be minimal.
</p>


<h3>Internal functions</h3>

<p>These functions are used internally by openxlsx2. It is no longer advertised
to use them in scripts. They originate from openxlsx, but do not fit openxlsx2's API.
</p>
<p>You should be able to modify
</p>

<ul>
<li> <p><code><a href="#topic+delete_data">delete_data()</a></code> -&gt; <code><a href="#topic+wb_clean_sheet">wb_clean_sheet()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+write_data">write_data()</a></code> -&gt; <code><a href="#topic+wb_add_data">wb_add_data()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+write_datatable">write_datatable()</a></code> -&gt; <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+write_comment">write_comment()</a></code> -&gt; <code><a href="#topic+wb_add_comment">wb_add_comment()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+remove_comment">remove_comment()</a></code> -&gt; <code><a href="#topic+wb_remove_comment">wb_remove_comment()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+write_formula">write_formula()</a></code> -&gt; <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code>
</p>
</li></ul>

<p>You should be able to change those with minimal changes
</p>


<h3>Deprecated functions</h3>

<p>First of all, you can set an option that will add warnings when using deprecated
functions.
</p>
<div class="sourceCode"><pre>options("openxlsx2.soon_deprecated" = TRUE)
</pre></div>


<h3>Argument changes</h3>

<p>For consistency, arguments were renamed to snake_case for the 0.8 release.
It is now recommended to use <code>dims</code> (the cell range) in favor of <code>row</code>, <code>col</code>, <code>start_row</code>, <code>start_col</code>
</p>
<p>See <code><a href="#topic+wb_dims">wb_dims()</a></code> as it provides many options on how to provide cell range
</p>


<h3>Functions with a new name</h3>

<p>These functions were renamed for consistency.
</p>

<ul>
<li> <p><code><a href="#topic+convertToExcelDate">convertToExcelDate()</a></code> -&gt; <code><a href="#topic+convert_to_excel_date">convert_to_excel_date()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+wb_grid_lines">wb_grid_lines()</a></code> -&gt; <code><a href="#topic+wb_set_grid_lines">wb_set_grid_lines()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_comment">create_comment()</a></code> -&gt; <code><a href="#topic+wb_comment">wb_comment()</a></code>
</p>
</li></ul>



<h3>Deprecated usage</h3>


<ul>
<li> <p><code>wb_get_named_regions()</code> will no longer allow providing a file.
</p>
</li></ul>

<div class="sourceCode"><pre>## Before
wb_get_named_regions(file)

## Now
wb &lt;- wb_load(file)
wb_get_named_regions(wb)
# also possible
wb_load(file)$get_named_regions()`
</pre></div>


<h3>See Also</h3>

<p><a href="base.html#topic+.Deprecated">.Deprecated</a>
</p>

<hr>
<h2 id='person-wb'>Helper for adding threaded comments</h2><span id='topic+person-wb'></span><span id='topic+wb_add_person'></span><span id='topic+wb_get_person'></span>

<h3>Description</h3>

<p>Adds a person to a workbook, so that they can be the author of threaded
comments in a workbook with <code><a href="#topic+wb_add_thread">wb_add_thread()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_person(wb, name = NULL, id = NULL, user_id = NULL, provider_id = "None")

wb_get_person(wb, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="person-wb_+3A_wb">wb</code></td>
<td>
<p>a Workbook</p>
</td></tr>
<tr><td><code id="person-wb_+3A_name">name</code></td>
<td>
<p>the name of the person to display.</p>
</td></tr>
<tr><td><code id="person-wb_+3A_id">id</code></td>
<td>
<p>(optional) the display id</p>
</td></tr>
<tr><td><code id="person-wb_+3A_user_id">user_id</code></td>
<td>
<p>(optional) the user id</p>
</td></tr>
<tr><td><code id="person-wb_+3A_provider_id">provider_id</code></td>
<td>
<p>(optional) the provider id</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_thread">wb_add_thread()</a></code>
</p>

<hr>
<h2 id='print.pugi_xml'>print pugi_xml</h2><span id='topic+print.pugi_xml'></span>

<h3>Description</h3>

<p>print pugi_xml
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pugi_xml'
print(x, indent = " ", raw = FALSE, attr_indent = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pugi_xml_+3A_x">x</code></td>
<td>
<p>something to print</p>
</td></tr>
<tr><td><code id="print.pugi_xml_+3A_indent">indent</code></td>
<td>
<p>indent used default is &quot; &quot;</p>
</td></tr>
<tr><td><code id="print.pugi_xml_+3A_raw">raw</code></td>
<td>
<p>print as raw text</p>
</td></tr>
<tr><td><code id="print.pugi_xml_+3A_attr_indent">attr_indent</code></td>
<td>
<p>print attributes indented on new line</p>
</td></tr>
<tr><td><code id="print.pugi_xml_+3A_...">...</code></td>
<td>
<p>to please check</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  # a pointer
  x &lt;- read_xml("&lt;a&gt;&lt;b/&gt;&lt;/a&gt;")
  print(x)
  print(x, raw = TRUE)
</code></pre>

<hr>
<h2 id='properties-wb'>Modify workbook properties</h2><span id='topic+properties-wb'></span><span id='topic+wb_get_properties'></span><span id='topic+wb_set_properties'></span>

<h3>Description</h3>

<p>This function is useful for workbooks that are loaded. It can be used to set the
workbook <code>title</code>, <code>subject</code> and <code>category</code> field. Use <code><a href="#topic+wb_workbook">wb_workbook()</a></code>
to easily set these properties with a new workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_properties(wb)

wb_set_properties(
  wb,
  creator = NULL,
  title = NULL,
  subject = NULL,
  category = NULL,
  datetime_created = Sys.time(),
  modifier = NULL,
  keywords = NULL,
  comments = NULL,
  manager = NULL,
  company = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="properties-wb_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="properties-wb_+3A_creator">creator</code></td>
<td>
<p>Creator of the workbook (your name). Defaults to login username or <code>options("openxlsx2.creator")</code> if set.</p>
</td></tr>
<tr><td><code id="properties-wb_+3A_title">title</code>, <code id="properties-wb_+3A_subject">subject</code>, <code id="properties-wb_+3A_category">category</code>, <code id="properties-wb_+3A_keywords">keywords</code>, <code id="properties-wb_+3A_comments">comments</code>, <code id="properties-wb_+3A_manager">manager</code>, <code id="properties-wb_+3A_company">company</code></td>
<td>
<p>Workbook property, a string.</p>
</td></tr>
<tr><td><code id="properties-wb_+3A_datetime_created">datetime_created</code></td>
<td>
<p>The time of the workbook is created</p>
</td></tr>
<tr><td><code id="properties-wb_+3A_modifier">modifier</code></td>
<td>
<p>A character string indicating who was the last person to modify the workbook</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To set properties, the following XML core properties are used.
</p>

<ul>
<li><p> title = dc:title
</p>
</li>
<li><p> subject = dc:subject
</p>
</li>
<li><p> creator = dc:creator
</p>
</li>
<li><p> keywords = cp:keywords
</p>
</li>
<li><p> comments = dc:description
</p>
</li>
<li><p> modifier = cp:lastModifiedBy
</p>
</li>
<li><p> datetime_created = dcterms:created
</p>
</li>
<li><p> datetime_modified = dcterms:modified
</p>
</li>
<li><p> category = cp:category
</p>
</li></ul>

<p>In addition, manager and company are used.
</p>


<h3>Value</h3>

<p>A wbWorkbook object, invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_workbook">wb_workbook()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
wb &lt;- wb_load(file)
wb$get_properties()

# Add a title to properties
wb$set_properties(title = "my title")
wb$get_properties()
</code></pre>

<hr>
<h2 id='pugixml'>xml_node</h2><span id='topic+pugixml'></span><span id='topic+xml_node'></span><span id='topic+xml_node_name'></span><span id='topic+xml_value'></span><span id='topic+xml_attr'></span>

<h3>Description</h3>

<p>returns xml values as character
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_node(xml, level1 = NULL, level2 = NULL, level3 = NULL, ...)

xml_node_name(xml, level1 = NULL, level2 = NULL, ...)

xml_value(xml, level1 = NULL, level2 = NULL, level3 = NULL, ...)

xml_attr(xml, level1 = NULL, level2 = NULL, level3 = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pugixml_+3A_xml">xml</code></td>
<td>
<p>something xml</p>
</td></tr>
<tr><td><code id="pugixml_+3A_level1">level1</code></td>
<td>
<p>to please check</p>
</td></tr>
<tr><td><code id="pugixml_+3A_level2">level2</code></td>
<td>
<p>to please check</p>
</td></tr>
<tr><td><code id="pugixml_+3A_level3">level3</code></td>
<td>
<p>to please check</p>
</td></tr>
<tr><td><code id="pugixml_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>read_xml()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns XML nodes as used in openxlsx2. In theory they
could be returned as pointers as well, but this has not yet been implemented.
If no level is provided, the nodes on level1 are returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- read_xml("&lt;a&gt;&lt;b/&gt;&lt;/a&gt;")
  # return a
  xml_node(x, "a")
  # return b. requires the path to the node
  xml_node(x, "a", "b")
  xml_node_name("&lt;a/&gt;")
  xml_node_name("&lt;a&gt;&lt;b/&gt;&lt;/a&gt;", "a")
  x &lt;- read_xml("&lt;a&gt;1&lt;/a&gt;")
  xml_value(x, "a")

  x &lt;- read_xml("&lt;a&gt;&lt;b r=\"1\"&gt;2&lt;/b&gt;&lt;/a&gt;")
  xml_value(x, "a", "b")

  x &lt;- read_xml("&lt;a a=\"1\" b=\"2\"&gt;1&lt;/a&gt;")
  xml_attr(x, "a")

  x &lt;- read_xml("&lt;a&gt;&lt;b r=\"1\"&gt;2&lt;/b&gt;&lt;/a&gt;")
  xml_attr(x, "a", "b")
  x &lt;- read_xml("&lt;a a=\"1\" b=\"2\"&gt;1&lt;/a&gt;")
  xml_attr(x, "a")

  x &lt;- read_xml("&lt;b&gt;&lt;a a=\"1\" b=\"2\"/&gt;&lt;/b&gt;")
  xml_attr(x, "b", "a")
</code></pre>

<hr>
<h2 id='read_xml'>read xml file</h2><span id='topic+read_xml'></span>

<h3>Description</h3>

<p>read xml file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_xml(
  xml,
  pointer = TRUE,
  escapes = FALSE,
  declaration = FALSE,
  whitespace = TRUE,
  empty_tags = FALSE,
  skip_control = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_xml_+3A_xml">xml</code></td>
<td>
<p>something to read character string or file</p>
</td></tr>
<tr><td><code id="read_xml_+3A_pointer">pointer</code></td>
<td>
<p>should a pointer be returned?</p>
</td></tr>
<tr><td><code id="read_xml_+3A_escapes">escapes</code></td>
<td>
<p>bool if characters like &quot;&amp;&quot; should be escaped. The default is
no escapes. Assuming that the input already provides valid information.</p>
</td></tr>
<tr><td><code id="read_xml_+3A_declaration">declaration</code></td>
<td>
<p>should the declaration be imported</p>
</td></tr>
<tr><td><code id="read_xml_+3A_whitespace">whitespace</code></td>
<td>
<p>should whitespace pcdata be imported</p>
</td></tr>
<tr><td><code id="read_xml_+3A_empty_tags">empty_tags</code></td>
<td>
<p>should <code style="white-space: pre;">&#8288;&lt;b/&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;b&gt;&lt;/b&gt;&#8288;</code> be returned</p>
</td></tr>
<tr><td><code id="read_xml_+3A_skip_control">skip_control</code></td>
<td>
<p>should whitespace character be exported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Read xml files or strings to pointer and checks if the input is
valid XML.
If the input is read into a character object, it will be reevaluated every
time it is called. A pointer is evaluated once, but lives only for the
lifetime of the R session or once it is gc().
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # a pointer
  x &lt;- read_xml("&lt;a&gt;&lt;b/&gt;&lt;/a&gt;")
  print(x)
  print(x, raw = TRUE)
  str(x)

  # a character
  y &lt;- read_xml("&lt;a&gt;&lt;b/&gt;&lt;/a&gt;", pointer = FALSE)
  print(y)
  print(y, raw = TRUE)
  str(y)

  # Errors if the import was unsuccessful
  try(z &lt;- read_xml("&lt;a&gt;&lt;b/&gt;"))

  xml &lt;- '&lt;?xml test="yay" ?&gt;&lt;a&gt;A &amp; B&lt;/a&gt;'
  # difference in escapes
  read_xml(xml, escapes = TRUE, pointer = FALSE)
  read_xml(xml, escapes = FALSE, pointer = FALSE)
  read_xml(xml, escapes = TRUE)
  read_xml(xml, escapes = FALSE)

  # read declaration
  read_xml(xml, declaration = TRUE)

</code></pre>

<hr>
<h2 id='row_heights-wb'>Modify row heights of a worksheet</h2><span id='topic+row_heights-wb'></span><span id='topic+wb_set_row_heights'></span><span id='topic+wb_remove_row_heights'></span>

<h3>Description</h3>

<p>Set / remove custom worksheet row heights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_row_heights(
  wb,
  sheet = current_sheet(),
  rows,
  heights = NULL,
  hidden = FALSE
)

wb_remove_row_heights(wb, sheet = current_sheet(), rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="row_heights-wb_+3A_wb">wb</code></td>
<td>
<p>A <a href="#topic+wbWorkbook">wbWorkbook</a> object</p>
</td></tr>
<tr><td><code id="row_heights-wb_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet. (A vector is accepted for <code>remove_row_heights()</code>)</p>
</td></tr>
<tr><td><code id="row_heights-wb_+3A_rows">rows</code></td>
<td>
<p>Indices of rows to set / remove (if any) custom height.</p>
</td></tr>
<tr><td><code id="row_heights-wb_+3A_heights">heights</code></td>
<td>
<p>Heights to set <code>rows</code> to specified in a spreadsheet column height units.</p>
</td></tr>
<tr><td><code id="row_heights-wb_+3A_hidden">hidden</code></td>
<td>
<p>Option to hide rows. A logical vector of length 1 or length of <code>rows</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- wb_workbook()

## Add a worksheet
wb$add_worksheet("Sheet 1")

## set row heights
wb &lt;- wb_set_row_heights(
  wb, 1,
  rows = c(1, 4, 22, 2, 19),
  heights = c(24, 28, 32, 42, 33)
)

## overwrite row 1 height
wb &lt;- wb_set_row_heights(wb, 1, rows = 1, heights = 40)
## remove any custom row heights in row 1
wb$remove_row_heights(sheet = 1, rows = 1)
</code></pre>

<hr>
<h2 id='sheet_names-wb'>Get / Set worksheet names for a workbook</h2><span id='topic+sheet_names-wb'></span><span id='topic+wb_set_sheet_names'></span><span id='topic+wb_get_sheet_names'></span>

<h3>Description</h3>

<p>Gets / Sets the worksheet names for a <a href="#topic+wbWorkbook">wbWorkbook</a> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_sheet_names(wb, old = NULL, new)

wb_get_sheet_names(wb, escape = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sheet_names-wb_+3A_wb">wb</code></td>
<td>
<p>A <a href="#topic+wbWorkbook">wbWorkbook</a> object</p>
</td></tr>
<tr><td><code id="sheet_names-wb_+3A_old">old</code></td>
<td>
<p>The name (or index) of the old sheet name. If <code>NULL</code> will assume
all worksheets are to be renamed.</p>
</td></tr>
<tr><td><code id="sheet_names-wb_+3A_new">new</code></td>
<td>
<p>The name of the new sheet</p>
</td></tr>
<tr><td><code id="sheet_names-wb_+3A_escape">escape</code></td>
<td>
<p>Should the xml special characters be escaped?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This only changes the sheet name as shown in spreadsheet software
and will not alter it elsewhere. Not in formulas, chart references,
named regions, pivot tables or anywhere else.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>set_</code>: The <code>wbWorkbook</code> object.
</p>
</li>
<li> <p><code>get_</code>: A named character vector of sheet names in order. The
names represent the original value of the worksheet prior to any character
substitutions.
</p>
</li></ul>


<hr>
<h2 id='sheet_visibility-wb'>Get/set worksheet visible state in a workbook</h2><span id='topic+sheet_visibility-wb'></span><span id='topic+wb_get_sheet_visibility'></span><span id='topic+wb_set_sheet_visibility'></span>

<h3>Description</h3>

<p>Get and set worksheet visible state. This allows to hide worksheets from the workbook.
The visibility of a worksheet can either be  &quot;visible&quot;, &quot;hidden&quot;, or &quot;veryHidden&quot;.
You can set this when creating a worksheet with <code>wb_add_worksheet(visible = FALSE)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_sheet_visibility(wb)

wb_set_sheet_visibility(wb, sheet = current_sheet(), value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sheet_visibility-wb_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="sheet_visibility-wb_+3A_sheet">sheet</code></td>
<td>
<p>Worksheet identifier</p>
</td></tr>
<tr><td><code id="sheet_visibility-wb_+3A_value">value</code></td>
<td>
<p>a logical/character vector the same length as sheet,
if providing a character vector, you can provide any of &quot;hidden&quot;, &quot;visible&quot;, or &quot;veryHidden&quot;</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>wb_set_sheet_visibility</code>: The Workbook object, invisibly.
</p>
</li>
<li> <p><code>wb_get_sheet_visibility()</code>: A character vector of the worksheet visibility value
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- wb_workbook()
wb$add_worksheet(sheet = "S1", visible = FALSE)
wb$add_worksheet(sheet = "S2", visible = TRUE)
wb$add_worksheet(sheet = "S3", visible = FALSE)

wb$get_sheet_visibility()
wb$set_sheet_visibility(1, TRUE)         ## show sheet 1
wb$set_sheet_visibility(2, FALSE)        ## hide sheet 2
wb$set_sheet_visibility(3, "hidden")     ## hide sheet 3
wb$set_sheet_visibility(3, "veryHidden") ## hide sheet 3 from UI
</code></pre>

<hr>
<h2 id='styles_on_sheet'>Get all styles on a sheet</h2><span id='topic+styles_on_sheet'></span>

<h3>Description</h3>

<p>Get all styles on a sheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>styles_on_sheet(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="styles_on_sheet_+3A_wb">wb</code></td>
<td>
<p>workbook</p>
</td></tr>
<tr><td><code id="styles_on_sheet_+3A_sheet">sheet</code></td>
<td>
<p>worksheet</p>
</td></tr>
</table>

<hr>
<h2 id='temp_xlsx'>helper function to create temporary directory for testing purpose</h2><span id='topic+temp_xlsx'></span>

<h3>Description</h3>

<p>helper function to create temporary directory for testing purpose
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp_xlsx(name = "temp_xlsx", macros = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temp_xlsx_+3A_name">name</code></td>
<td>
<p>for the temp file</p>
</td></tr>
<tr><td><code id="temp_xlsx_+3A_macros">macros</code></td>
<td>
<p>logical if the file extension is xlsm or xlsx</p>
</td></tr>
</table>

<hr>
<h2 id='waivers'><code>openxlsx2</code> waivers</h2><span id='topic+waivers'></span><span id='topic+current_sheet'></span><span id='topic+next_sheet'></span><span id='topic+na_strings'></span>

<h3>Description</h3>

<p>Waiver functions for <code>openxlsx2</code> functions.
</p>

<ul>
<li> <p><code>current_sheet()</code> uses <code><a href="#topic+wb_get_active_sheet">wb_get_active_sheet()</a></code> by default if performing
actions on a worksheet, for example when you add data.
</p>
</li>
<li> <p><code>next_sheet()</code> is used when you add a new worksheet, a new chartsheet or
when you add a pivot table
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>current_sheet()

next_sheet()

na_strings()
</code></pre>


<h3>Value</h3>

<p>An object of class <code>openxlsx2_waiver</code>
</p>

<hr>
<h2 id='wb_add_border'>Modify borders in a cell region of a worksheet</h2><span id='topic+wb_add_border'></span>

<h3>Description</h3>

<p>wb wrapper to create borders for cell regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_border(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  bottom_color = wb_color(hex = "FF000000"),
  left_color = wb_color(hex = "FF000000"),
  right_color = wb_color(hex = "FF000000"),
  top_color = wb_color(hex = "FF000000"),
  bottom_border = "thin",
  left_border = "thin",
  right_border = "thin",
  top_border = "thin",
  inner_hgrid = NULL,
  inner_hcolor = NULL,
  inner_vgrid = NULL,
  inner_vcolor = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_border_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code></p>
</td></tr>
<tr><td><code id="wb_add_border_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet</p>
</td></tr>
<tr><td><code id="wb_add_border_+3A_dims">dims</code></td>
<td>
<p>Cell range in the worksheet e.g. &quot;A1&quot;, &quot;A1:A5&quot;, &quot;A1:H5&quot;</p>
</td></tr>
<tr><td><code id="wb_add_border_+3A_bottom_color">bottom_color</code>, <code id="wb_add_border_+3A_left_color">left_color</code>, <code id="wb_add_border_+3A_right_color">right_color</code>, <code id="wb_add_border_+3A_top_color">top_color</code>, <code id="wb_add_border_+3A_inner_hcolor">inner_hcolor</code>, <code id="wb_add_border_+3A_inner_vcolor">inner_vcolor</code></td>
<td>
<p>a color, either something openxml knows or some RGB color</p>
</td></tr>
<tr><td><code id="wb_add_border_+3A_left_border">left_border</code>, <code id="wb_add_border_+3A_right_border">right_border</code>, <code id="wb_add_border_+3A_top_border">top_border</code>, <code id="wb_add_border_+3A_bottom_border">bottom_border</code>, <code id="wb_add_border_+3A_inner_hgrid">inner_hgrid</code>, <code id="wb_add_border_+3A_inner_vgrid">inner_vgrid</code></td>
<td>
<p>the border style, if <code>NULL</code> no border is drawn.
See <code><a href="#topic+create_border">create_border()</a></code> for possible border styles</p>
</td></tr>
<tr><td><code id="wb_add_border_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+create_border">create_border()</a></code>
</p>
<p>Other styles: 
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;% wb_add_worksheet("S1") %&gt;%  wb_add_data("S1", mtcars)
wb &lt;- wb_add_border(wb, 1, dims = "A1:K1",
 left_border = NULL, right_border = NULL,
 top_border = NULL, bottom_border = "double")
wb &lt;- wb_add_border(wb, 1, dims = "A5",
 left_border = "dotted", right_border = "dotted",
 top_border = "hair", bottom_border = "thick")
wb &lt;- wb_add_border(wb, 1, dims = "C2:C5")
wb &lt;- wb_add_border(wb, 1, dims = "G2:H3")

wb &lt;- wb_add_border(wb, 1, dims = "G12:H13",
 left_color = wb_color(hex = "FF9400D3"), right_color = wb_color(hex = "FF4B0082"),
 top_color = wb_color(hex = "FF0000FF"), bottom_color = wb_color(hex = "FF00FF00"))
wb &lt;- wb_add_border(wb, 1, dims = "A20:C23")
wb &lt;- wb_add_border(wb, 1, dims = "B12:D14",
 left_color = wb_color(hex = "FFFFFF00"), right_color = wb_color(hex = "FFFF7F00"),
 bottom_color = wb_color(hex = "FFFF0000"))
wb &lt;- wb_add_border(wb, 1, dims = "D28:E28")

# With chaining

wb &lt;- wb_workbook()
wb$add_worksheet("S1")$add_data("S1", mtcars)
wb$add_border(1, dims = "A1:K1",
 left_border = NULL, right_border = NULL,
 top_border = NULL, bottom_border = "double")
wb$add_border(1, dims = "A5",
 left_border = "dotted", right_border = "dotted",
 top_border = "hair", bottom_border = "thick")
wb$add_border(1, dims = "C2:C5")
wb$add_border(1, dims = "G2:H3")
wb$add_border(1, dims = "G12:H13",
 left_color = wb_color(hex = "FF9400D3"), right_color = wb_color(hex = "FF4B0082"),
 top_color = wb_color(hex = "FF0000FF"), bottom_color = wb_color(hex = "FF00FF00"))
wb$add_border(1, dims = "A20:C23")
wb$add_border(1, dims = "B12:D14",
 left_color = wb_color(hex = "FFFFFF00"), right_color = wb_color(hex = "FFFF7F00"),
 bottom_color = wb_color(hex = "FFFF0000"))
wb$add_border(1, dims = "D28:E28")
# if (interactive()) wb$open()

wb &lt;- wb_workbook()
wb$add_worksheet("S1")$add_data("S1", mtcars)
wb$add_border(1, dims = "A2:K33", inner_vgrid = "thin", inner_vcolor = c(rgb="FF808080"))
</code></pre>

<hr>
<h2 id='wb_add_cell_style'>Modify the style in a cell region</h2><span id='topic+wb_add_cell_style'></span>

<h3>Description</h3>

<p>Add cell style to a cell region
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_cell_style(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  apply_alignment = NULL,
  apply_border = NULL,
  apply_fill = NULL,
  apply_font = NULL,
  apply_number_format = NULL,
  apply_protection = NULL,
  border_id = NULL,
  ext_lst = NULL,
  fill_id = NULL,
  font_id = NULL,
  hidden = NULL,
  horizontal = NULL,
  indent = NULL,
  justify_last_line = NULL,
  locked = NULL,
  num_fmt_id = NULL,
  pivot_button = NULL,
  quote_prefix = NULL,
  reading_order = NULL,
  relative_indent = NULL,
  shrink_to_fit = NULL,
  text_rotation = NULL,
  vertical = NULL,
  wrap_text = NULL,
  xf_id = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_cell_style_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_sheet">sheet</code></td>
<td>
<p>the worksheet</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_dims">dims</code></td>
<td>
<p>the cell range</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_alignment">apply_alignment</code></td>
<td>
<p>logical apply alignment</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_border">apply_border</code></td>
<td>
<p>logical apply border</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_fill">apply_fill</code></td>
<td>
<p>logical apply fill</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_font">apply_font</code></td>
<td>
<p>logical apply font</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_number_format">apply_number_format</code></td>
<td>
<p>logical apply number format</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_apply_protection">apply_protection</code></td>
<td>
<p>logical apply protection</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_border_id">border_id</code></td>
<td>
<p>border ID to apply</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_ext_lst">ext_lst</code></td>
<td>
<p>extension list something like <code style="white-space: pre;">&#8288;&lt;extLst&gt;...&lt;/extLst&gt;&#8288;</code></p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_fill_id">fill_id</code></td>
<td>
<p>fill ID to apply</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_font_id">font_id</code></td>
<td>
<p>font ID to apply</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_hidden">hidden</code></td>
<td>
<p>logical cell is hidden</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_horizontal">horizontal</code></td>
<td>
<p>align content horizontal ('left', 'center', 'right')</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_indent">indent</code></td>
<td>
<p>logical indent content</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_justify_last_line">justify_last_line</code></td>
<td>
<p>logical justify last line</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_locked">locked</code></td>
<td>
<p>logical cell is locked</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_num_fmt_id">num_fmt_id</code></td>
<td>
<p>number format ID to apply</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_pivot_button">pivot_button</code></td>
<td>
<p>unknown</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_quote_prefix">quote_prefix</code></td>
<td>
<p>unknown</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_reading_order">reading_order</code></td>
<td>
<p>reading order left to right</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_relative_indent">relative_indent</code></td>
<td>
<p>relative indentation</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_shrink_to_fit">shrink_to_fit</code></td>
<td>
<p>logical shrink to fit</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_text_rotation">text_rotation</code></td>
<td>
<p>degrees of text rotation</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_vertical">vertical</code></td>
<td>
<p>vertical alignment of content ('top', 'center', 'bottom')</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_wrap_text">wrap_text</code></td>
<td>
<p>wrap text in cell</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_xf_id">xf_id</code></td>
<td>
<p>xf ID to apply</p>
</td></tr>
<tr><td><code id="wb_add_cell_style_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;%
  wb_add_worksheet("S1") %&gt;%
  wb_add_data("S1", x = mtcars)

wb %&gt;%
  wb_add_cell_style(
    dims = "A1:K1",
    text_rotation = "45",
    horizontal = "center",
    vertical = "center",
    wrap_text = "1"
)
# Chaining
wb &lt;- wb_workbook()$add_worksheet("S1")$add_data(x = mtcars)
wb$add_cell_style(dims = "A1:K1",
                  text_rotation = "45",
                  horizontal = "center",
                  vertical = "center",
                  wrap_text = "1")
</code></pre>

<hr>
<h2 id='wb_add_chart_xml'>Add a chart XML to a worksheet</h2><span id='topic+wb_add_chart_xml'></span>

<h3>Description</h3>

<p>Add a chart XML to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_chart_xml(
  wb,
  sheet = current_sheet(),
  dims = NULL,
  xml,
  col_offset = 0,
  row_offset = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_chart_xml_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="wb_add_chart_xml_+3A_sheet">sheet</code></td>
<td>
<p>the sheet on which the graph will appear</p>
</td></tr>
<tr><td><code id="wb_add_chart_xml_+3A_dims">dims</code></td>
<td>
<p>the dimensions where the sheet will appear</p>
</td></tr>
<tr><td><code id="wb_add_chart_xml_+3A_xml">xml</code></td>
<td>
<p>chart xml</p>
</td></tr>
<tr><td><code id="wb_add_chart_xml_+3A_col_offset">col_offset</code>, <code id="wb_add_chart_xml_+3A_row_offset">row_offset</code></td>
<td>
<p>positioning</p>
</td></tr>
<tr><td><code id="wb_add_chart_xml_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_drawing">wb_add_drawing()</a></code> <code><a href="#topic+wb_add_image">wb_add_image()</a></code> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code> <code><a href="#topic+wb_add_plot">wb_add_plot()</a></code>
</p>

<hr>
<h2 id='wb_add_chartsheet'>Add a chartsheet to a workbook</h2><span id='topic+wb_add_chartsheet'></span>

<h3>Description</h3>

<p>A chartsheet is a special type of sheet that handles charts output. You must
add a chart to the sheet. Otherwise, this will break the workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_chartsheet(
  wb,
  sheet = next_sheet(),
  tab_color = NULL,
  zoom = 100,
  visible = c("true", "false", "hidden", "visible", "veryhidden"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_chartsheet_+3A_wb">wb</code></td>
<td>
<p>A Workbook object to attach the new chartsheet</p>
</td></tr>
<tr><td><code id="wb_add_chartsheet_+3A_sheet">sheet</code></td>
<td>
<p>A name for the new chartsheet</p>
</td></tr>
<tr><td><code id="wb_add_chartsheet_+3A_tab_color">tab_color</code></td>
<td>
<p>Color of the sheet tab. A  <code><a href="#topic+wb_color">wb_color()</a></code>,  a valid color (belonging to
<code>grDevices::colors()</code>) or a valid hex color beginning with &quot;#&quot;.</p>
</td></tr>
<tr><td><code id="wb_add_chartsheet_+3A_zoom">zoom</code></td>
<td>
<p>The sheet zoom level, a numeric between 10 and 400 as a
percentage. (A zoom value smaller than 10 will default to 10.)</p>
</td></tr>
<tr><td><code id="wb_add_chartsheet_+3A_visible">visible</code></td>
<td>
<p>If <code>FALSE</code>, sheet is hidden else visible.</p>
</td></tr>
<tr><td><code id="wb_add_chartsheet_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>

<hr>
<h2 id='wb_add_comment'>Add comment to worksheet</h2><span id='topic+wb_add_comment'></span><span id='topic+wb_get_comment'></span><span id='topic+wb_remove_comment'></span>

<h3>Description</h3>

<p>Add comment to worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_comment(wb, sheet = current_sheet(), dims = "A1", comment, ...)

wb_get_comment(wb, sheet = current_sheet(), dims = NULL)

wb_remove_comment(wb, sheet = current_sheet(), dims = "A1", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_comment_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_add_comment_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet of the workbook</p>
</td></tr>
<tr><td><code id="wb_add_comment_+3A_dims">dims</code></td>
<td>
<p>Optional row and column as spreadsheet dimension, e.g. &quot;A1&quot;</p>
</td></tr>
<tr><td><code id="wb_add_comment_+3A_comment">comment</code></td>
<td>
<p>A comment to apply to <code>dims</code> created by <code><a href="#topic+wb_comment">wb_comment()</a></code>, a string or a <code><a href="#topic+fmt_txt">fmt_txt()</a></code> object</p>
</td></tr>
<tr><td><code id="wb_add_comment_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If applying a <code>comment</code> with a string, it will use <code><a href="#topic+wb_comment">wb_comment()</a></code> default values. If additional background colors are applied, RGB colors should be provided, either as hex code or with builtin R colors. The alpha channel is ignored.
</p>


<h3>Value</h3>

<p>The Workbook object, invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_comment">wb_comment()</a></code>, <code><a href="#topic+wb_add_thread">wb_add_thread()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
# add a comment without author
c1 &lt;- wb_comment(text = "this is a comment", author = "")
wb$add_comment(dims = "B10", comment = c1)
#' # Remove comment
wb$remove_comment(sheet = "Sheet 1", dims = "B10")
# Write another comment with author information
c2 &lt;- wb_comment(text = "this is another comment", author = "Marco Polo", visible = TRUE)
wb$add_comment(sheet = 1, dims = "C10", comment = c2)
# Works with formatted text also.
formatted_text &lt;- fmt_txt("bar", underline = TRUE)
wb$add_comment(dims = "B5", comment = formatted_text)
# With background color
wb$add_comment(dims = "B7", comment = formatted_text, color = wb_color("green"))
# With background image. File extension must be png or jpeg, not jpg?
tmp &lt;- tempfile(fileext = ".png")
png(file = tmp, bg = "transparent")
plot(1:10)
rect(1, 5, 3, 7, col = "white")
dev.off()

c1 &lt;- wb_comment(text = "this is a comment", author = "", visible = TRUE)
wb$add_comment(dims = "B12", comment = c1, file = tmp)
</code></pre>

<hr>
<h2 id='wb_add_conditional_formatting'>Add conditional formatting to cells in a worksheet</h2><span id='topic+wb_add_conditional_formatting'></span>

<h3>Description</h3>

<p>Add conditional formatting to cells.
You can find more details in <code>vignette("conditional-formatting")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_conditional_formatting(
  wb,
  sheet = current_sheet(),
  dims = NULL,
  rule = NULL,
  style = NULL,
  type = c("expression", "colorScale", "dataBar", "iconSet", "duplicatedValues",
    "uniqueValues", "containsErrors", "notContainsErrors", "containsBlanks",
    "notContainsBlanks", "containsText", "notContainsText", "beginsWith", "endsWith",
    "between", "topN", "bottomN"),
  params = list(showValue = TRUE, gradient = TRUE, border = TRUE, percent = FALSE, rank =
    5L),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_conditional_formatting_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_dims">dims</code></td>
<td>
<p>A cell or cell range like &quot;A1&quot; or &quot;A1:B2&quot;</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_rule">rule</code></td>
<td>
<p>The condition under which to apply the formatting. See <strong>Examples</strong>.</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_style">style</code></td>
<td>
<p>A style to apply to those cells that satisfy the rule.
Default is <code>font_color = "FF9C0006"</code> and <code>bg_fill = "FFFFC7CE"</code></p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_type">type</code></td>
<td>
<p>The type of conditional formatting rule to apply. One of <code>"expression"</code>, <code>"colorScale"</code> or others mentioned in <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_params">params</code></td>
<td>
<p>A list of additional parameters passed.  See <strong>Details</strong> for more.</p>
</td></tr>
<tr><td><code id="wb_add_conditional_formatting_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>openxml uses the alpha channel first then RGB, whereas the usual default is RGBA.
</p>
<p>Conditional formatting <code>type</code> accept different parameters. Unless noted,
unlisted parameters are ignored.
</p>

<dl>
<dt><code>expression</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object<br /><br />
<code style="white-space: pre;">&#8288;[rule]&#8288;</code><br /> An Excel expression (as a character). Valid operators are: <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>
</p>
</dd>
<dt><code>colorScale</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>character</code> vector of valid colors with length <code>2</code> or <code>3</code><br /><br />
<code style="white-space: pre;">&#8288;[rule]&#8288;</code><br /> <code>NULL</code> or a <code>character</code> vector of valid colors of equal length to <code>styles</code>
</p>
</dd>
<dt><code>dataBar</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>character</code> vector of valid colors with length <code>2</code> or <code>3</code><br /><br />
<code style="white-space: pre;">&#8288;[rule]&#8288;</code><br /> A <code>numeric</code> vector specifying the range of the databar colors. Must be equal length to <code>style</code><br /><br />
<code style="white-space: pre;">&#8288;[params$showValue]&#8288;</code><br /> If <code>FALSE</code> the cell value is hidden. Default <code>TRUE</code><br /><br />
<code style="white-space: pre;">&#8288;[params$gradient]&#8288;</code><br /> If <code>FALSE</code> color gradient is removed. Default <code>TRUE</code><br /><br />
<code style="white-space: pre;">&#8288;[params$border]&#8288;</code><br /> If <code>FALSE</code> the border around the database is hidden. Default <code>TRUE</code>
</p>
</dd>
<dt><code>duplicatedValues</code> / <code>uniqueValues</code> / <code>containsErrors</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object
</p>
</dd>
<dt><code>contains</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object<br /><br />
<code style="white-space: pre;">&#8288;[rule]&#8288;</code><br /> The text to look for within cells
</p>
</dd>
<dt><code>between</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object.<br /><br />
<code style="white-space: pre;">&#8288;[rule]&#8288;</code><br /> A <code>numeric</code> vector of length <code>2</code> specifying lower and upper bound (Inclusive)
</p>
</dd>
<dt><code>topN</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object<br /><br />
<code style="white-space: pre;">&#8288;[params$rank]&#8288;</code><br /> A <code>numeric</code> vector of length <code>1</code> indicating number of highest values. Default <code>5L</code><br /><br />
<code style="white-space: pre;">&#8288;[params$percent]&#8288;</code> If <code>TRUE</code>, uses percentage
</p>
</dd>
<dt><code>bottomN</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[style]&#8288;</code><br /> A <code>Style</code> object<br /><br />
<code style="white-space: pre;">&#8288;[params$rank]&#8288;</code><br /> A <code>numeric</code> vector of length <code>1</code> indicating number of lowest values. Default <code>5L</code><br /><br />
<code style="white-space: pre;">&#8288;[params$percent]&#8288;</code><br /> If <code>TRUE</code>, uses percentage
</p>
</dd>
<dt><code>iconSet</code></dt><dd>
<p><code style="white-space: pre;">&#8288;[params$showValue]&#8288;</code><br /> If <code>FALSE</code>, the cell value is hidden. Default <code>TRUE</code><br /><br />
<code style="white-space: pre;">&#8288;[params$reverse]&#8288;</code><br /> If <code>TRUE</code>, the order is reversed. Default <code>FALSE</code><br /><br />
<code style="white-space: pre;">&#8288;[params$percent]&#8288;</code><br /> If <code>TRUE</code>, uses percentage<br /><br />
<code style="white-space: pre;">&#8288;[params$iconSet]&#8288;</code><br /> Uses one of the implemented icon sets. Values must match the length of the icons
in the set 3Arrows, 3ArrowsGray, 3Flags, 3Signs, 3Symbols, 3Symbols2, 3TrafficLights1, 3TrafficLights2,
4Arrows, 4ArrowsGray, 4Rating, 4RedToBlack, 4TrafficLights, 5Arrows, 5ArrowsGray, 5Quarters, 5Rating. The
default is 3TrafficLights1.
</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("a")
wb$add_data(x = 1:4, col_names = FALSE)
wb$add_conditional_formatting(dims = wb_dims(cols = "A", rows = 1:4), rule = "&gt;2")
</code></pre>

<hr>
<h2 id='wb_add_data'>Add data to a worksheet</h2><span id='topic+wb_add_data'></span>

<h3>Description</h3>

<p>Add data to worksheet with optional styling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_data(
  wb,
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  col_names = TRUE,
  row_names = FALSE,
  with_filter = FALSE,
  name = NULL,
  sep = ", ",
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_data_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_x">x</code></td>
<td>
<p>Object to be written. For classes supported look at the examples.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet cell range that will determine <code>start_col</code> and <code>start_row</code>: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_col_names">col_names</code></td>
<td>
<p>If <code>TRUE</code>, column names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_row_names">row_names</code></td>
<td>
<p>If <code>TRUE</code>, the row names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_with_filter">with_filter</code></td>
<td>
<p>If <code>TRUE</code>, add filters to the column name row.
NOTE: can only have one filter per worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_name">name</code></td>
<td>
<p>The name of a named region if specified.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list
columns to a character vector e.g. <code>sapply(x$list_column, paste, collapse = sep)</code>.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>keep the cell style?</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_na.strings">na.strings</code></td>
<td>
<p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
looks if <code>options(openxlsx2.na.strings)</code> is set. Otherwise <code><a href="#topic+na_strings">na_strings()</a></code>
uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_inline_strings">inline_strings</code></td>
<td>
<p>write characters as inline strings</p>
</td></tr>
<tr><td><code id="wb_add_data_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulae written using <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code> to a Workbook object will
not get picked up by <code>read_xlsx()</code>. This is because only the formula is written
and left to Excel to evaluate the formula when the file is opened in Excel.
The string <code>"_openxlsx_NA"</code> is reserved for <code>openxlsx2</code>.
If the data frame contains this string, the output will be broken.
</p>
<p>Supported classes are data frames, matrices and vectors of various types and
everything that can be converted into a data frame with <code>as.data.frame()</code>.
Everything else that the user wants to write should either be converted into
a vector or data frame or written in vector or data frame segments. This
includes base classes such as <code>table</code>, which were coerced internally in the
predecessor of this package.
</p>
<p>Even vectors and data frames can consist of different classes. Many base
classes are covered, though not all and far from all third-party classes.
When data of an unknown class is written, it is handled with <code>as.character()</code>.
It is not possible to write character nodes beginning with <code style="white-space: pre;">&#8288;&lt;r&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;r/&gt;&#8288;</code>. Both
are reserved for internal functions. If you need these. You have to wrap
the input string in <code>fmt_txt()</code>.
</p>
<p>The columns of <code>x</code> with class Date/POSIXt, currency, accounting, hyperlink,
percentage are automatically styled as dates, currency, accounting,
hyperlinks, percentages respectively.
</p>
<p>Functions <code><a href="#topic+wb_add_data">wb_add_data()</a></code> and <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code> behave quite similar. The
distinction is that the latter creates a table in the worksheet that can be
used for different kind of formulas and can be sorted independently, though
is less flexible than basic cell regions.
</p>


<h3>Value</h3>

<p>A <code>wbWorkbook</code>, invisibly.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See formatting vignette for further examples.

## Options for default styling (These are the defaults)
options("openxlsx2.dateFormat" = "mm/dd/yyyy")
options("openxlsx2.datetimeFormat" = "yyyy-mm-dd hh:mm:ss")
options("openxlsx2.numFmt" = NULL)

#############################################################################
## Create Workbook object and add worksheets
wb &lt;- wb_workbook()

## Add worksheets
wb$add_worksheet("Cars")
wb$add_worksheet("Formula")

x &lt;- mtcars[1:6, ]
wb$add_data("Cars", x, start_col = 2, start_row = 3, row_names = TRUE)

#############################################################################
## Hyperlinks
## - vectors/columns with class 'hyperlink' are written as hyperlinks'

v &lt;- rep("https://CRAN.R-project.org/", 4)
names(v) &lt;- paste0("Hyperlink", 1:4) # Optional: names will be used as display text
class(v) &lt;- "hyperlink"
wb$add_data("Cars", x = v, dims = "B32")

#############################################################################
## Formulas
## - vectors/columns with class 'formula' are written as formulas'

df &lt;- data.frame(
  x = 1:3, y = 1:3,
  z = paste(paste0("A", 1:3 + 1L), paste0("B", 1:3 + 1L), sep = "+"),
  stringsAsFactors = FALSE
)

class(df$z) &lt;- c(class(df$z), "formula")

wb$add_data(sheet = "Formula", x = df)

#############################################################################
# update cell range and add mtcars
xlsxFile &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
wb2 &lt;- wb_load(xlsxFile)

# read dataset with inlinestr
wb_to_df(wb2)
wb2 &lt;- wb2 %&gt;% wb_add_data(sheet = 1, mtcars, dims = wb_dims(4, 4))
wb_to_df(wb2)
</code></pre>

<hr>
<h2 id='wb_add_data_table'>Add a data table to a worksheet</h2><span id='topic+wb_add_data_table'></span>

<h3>Description</h3>

<p>Add data to a worksheet and format as an Excel table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_data_table(
  wb,
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  col_names = TRUE,
  row_names = FALSE,
  table_style = "TableStyleLight9",
  table_name = NULL,
  with_filter = TRUE,
  sep = ", ",
  first_column = FALSE,
  last_column = FALSE,
  banded_rows = TRUE,
  banded_cols = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  total_row = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_data_table_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_x">x</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet cell range that will determine <code>start_col</code> and <code>start_row</code>: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_col_names">col_names</code></td>
<td>
<p>If <code>TRUE</code>, column names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_row_names">row_names</code></td>
<td>
<p>If <code>TRUE</code>, the row names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_table_style">table_style</code></td>
<td>
<p>Any table style name or &quot;none&quot; (see <code>vignette("openxlsx2_style_manual")</code>)</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_table_name">table_name</code></td>
<td>
<p>Name of table in workbook. The table name must be unique.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_with_filter">with_filter</code></td>
<td>
<p>If <code>TRUE</code>, columns with have filters in the first row.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list
columns to a character vector e.g.
<code>sapply(x$list_column, paste, collapse = sep)</code>.
<br /><br />
<br /><strong>The below options correspond to Excel table options:</strong>
<br />
<img src="../help/figures/tableoptions.png" width="40%" alt="Figure: table\_options.png" />
</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_first_column">first_column</code></td>
<td>
<p>logical. If <code>TRUE</code>, the first column is bold.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_last_column">last_column</code></td>
<td>
<p>logical. If <code>TRUE</code>, the last column is bold.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_banded_rows">banded_rows</code></td>
<td>
<p>logical. If <code>TRUE</code>, rows are color banded.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_banded_cols">banded_cols</code></td>
<td>
<p>logical. If <code>TRUE</code>, the columns are color banded.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>keep the cell style?</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_na.strings">na.strings</code></td>
<td>
<p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
looks if <code>options(openxlsx2.na.strings)</code> is set. Otherwise <code><a href="#topic+na_strings">na_strings()</a></code>
uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_inline_strings">inline_strings</code></td>
<td>
<p>write characters as inline strings</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_total_row">total_row</code></td>
<td>
<p>logical. With the default <code>FALSE</code> no total row is added.</p>
</td></tr>
<tr><td><code id="wb_add_data_table_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulae written using <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code> to a Workbook object will
not get picked up by <code>read_xlsx()</code>. This is because only the formula is written
and left to Excel to evaluate the formula when the file is opened in Excel.
The string <code>"_openxlsx_NA"</code> is reserved for <code>openxlsx2</code>.
If the data frame contains this string, the output will be broken.
</p>
<p>Supported classes are data frames, matrices and vectors of various types and
everything that can be converted into a data frame with <code>as.data.frame()</code>.
Everything else that the user wants to write should either be converted into
a vector or data frame or written in vector or data frame segments. This
includes base classes such as <code>table</code>, which were coerced internally in the
predecessor of this package.
</p>
<p>Even vectors and data frames can consist of different classes. Many base
classes are covered, though not all and far from all third-party classes.
When data of an unknown class is written, it is handled with <code>as.character()</code>.
It is not possible to write character nodes beginning with <code style="white-space: pre;">&#8288;&lt;r&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;r/&gt;&#8288;</code>. Both
are reserved for internal functions. If you need these. You have to wrap
the input string in <code>fmt_txt()</code>.
</p>
<p>The columns of <code>x</code> with class Date/POSIXt, currency, accounting, hyperlink,
percentage are automatically styled as dates, currency, accounting,
hyperlinks, percentages respectively.
</p>
<p>Functions <code><a href="#topic+wb_add_data">wb_add_data()</a></code> and <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code> behave quite similar. The
distinction is that the latter creates a table in the worksheet that can be
used for different kind of formulas and can be sorted independently, though
is less flexible than basic cell regions.
</p>


<h3>Modify total row argument</h3>

<p>It is possible to further tweak the total row. In addition to the default
<code>FALSE</code> possible values are <code>TRUE</code> (the xlsx file will create column sums
each variable).
</p>
<p>In addition it is possible to tweak this further using a character string
with one of the following functions for each variable: <code>"average"</code>,
<code>"count"</code>, <code>"countNums"</code>, <code>"max"</code>, <code>"min"</code>, <code>"stdDev"</code>, <code>"sum"</code>, <code>"var"</code>.
It is possible to leave the cell empty <code>"none"</code> or to create a text input
using a named character with name <code>text</code> like: <code>c(text = "Total")</code>.
It's also possible to pass other spreadsheet software functions if they
return a single value and hence <code>"SUM"</code> would work too.
</p>


<h3>See Also</h3>

<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()$
  add_data_table(
    x = as.data.frame(USPersonalExpenditure),
    row_names = TRUE,
    total_row = c(text = "Total", "none", "sum", "sum", "sum", "SUM")
  )
</code></pre>

<hr>
<h2 id='wb_add_data_validation'>Add data validation to cells in a worksheet</h2><span id='topic+wb_add_data_validation'></span>

<h3>Description</h3>

<p>Add Excel data validation to cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_data_validation(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  type,
  operator,
  value,
  allow_blank = TRUE,
  show_input_msg = TRUE,
  show_error_msg = TRUE,
  error_style = NULL,
  error_title = NULL,
  error = NULL,
  prompt_title = NULL,
  prompt = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_data_validation_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_dims">dims</code></td>
<td>
<p>A cell dimension (&quot;A1&quot; or &quot;A1:B2&quot;)</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_type">type</code></td>
<td>
<p>One of 'whole', 'decimal', 'date', 'time', 'textLength', 'list'
(see examples)</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_operator">operator</code></td>
<td>
<p>One of 'between', 'notBetween', 'equal',
'notEqual', 'greaterThan', 'lessThan', 'greaterThanOrEqual', 'lessThanOrEqual'</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_value">value</code></td>
<td>
<p>a vector of length 1 or 2 depending on operator (see examples)</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_allow_blank">allow_blank</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_show_input_msg">show_input_msg</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_show_error_msg">show_error_msg</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_error_style">error_style</code></td>
<td>
<p>The icon shown and the options how to deal with such inputs.
Default &quot;stop&quot; (cancel), else &quot;information&quot; (prompt popup) or
&quot;warning&quot; (prompt accept or change input)</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_error_title">error_title</code></td>
<td>
<p>The error title</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_error">error</code></td>
<td>
<p>The error text</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_prompt_title">prompt_title</code></td>
<td>
<p>The prompt title</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_prompt">prompt</code></td>
<td>
<p>The prompt text</p>
</td></tr>
<tr><td><code id="wb_add_data_validation_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
wb$add_worksheet("Sheet 2")

wb$add_data_table(1, x = iris[1:30, ])
wb$add_data_validation(1,
  dims = "A2:C31", type = "whole",
  operator = "between", value = c(1, 9)
)
wb$add_data_validation(1,
  dims = "E2:E31", type = "textLength",
  operator = "between", value = c(4, 6)
)

## Date and Time cell validation
df &lt;- data.frame(
  "d" = as.Date("2016-01-01") + -5:5,
  "t" = as.POSIXct("2016-01-01") + -5:5 * 10000
)
wb$add_data_table(2, x = df)
wb$add_data_validation(2, dims = "A2:A12", type = "date",
  operator = "greaterThanOrEqual", value = as.Date("2016-01-01")
)
wb$add_data_validation(2,
  dims = "B2:B12", type = "time",
  operator = "between", value = df$t[c(4, 8)]
)


######################################################################
## If type == 'list'
# operator argument is ignored.

wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
wb$add_worksheet("Sheet 2")

wb$add_data_table(sheet = 1, x = iris[1:30, ])
wb$add_data(sheet = 2, x = sample(iris$Sepal.Length, 10))

wb$add_data_validation(1, dims = "A2:A31", type = "list", value = "'Sheet 2'!$A$1:$A$10")
</code></pre>

<hr>
<h2 id='wb_add_drawing'>Add drawings to a worksheet</h2><span id='topic+wb_add_drawing'></span>

<h3>Description</h3>

<p>Add drawings to a worksheet. This requires the <code>rvg</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_drawing(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  xml,
  col_offset = 0,
  row_offset = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_drawing_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code></p>
</td></tr>
<tr><td><code id="wb_add_drawing_+3A_sheet">sheet</code></td>
<td>
<p>A sheet in the workbook</p>
</td></tr>
<tr><td><code id="wb_add_drawing_+3A_dims">dims</code></td>
<td>
<p>The dimension where the drawing is added.</p>
</td></tr>
<tr><td><code id="wb_add_drawing_+3A_xml">xml</code></td>
<td>
<p>the drawing xml as character or file</p>
</td></tr>
<tr><td><code id="wb_add_drawing_+3A_col_offset">col_offset</code>, <code id="wb_add_drawing_+3A_row_offset">row_offset</code></td>
<td>
<p>offsets for column and row</p>
</td></tr>
<tr><td><code id="wb_add_drawing_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_chart_xml">wb_add_chart_xml()</a></code> <code><a href="#topic+wb_add_image">wb_add_image()</a></code> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code> <code><a href="#topic+wb_add_plot">wb_add_plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("rvg") &amp;&amp; interactive()) {

## rvg example
require(rvg)
tmp &lt;- tempfile(fileext = ".xml")
dml_xlsx(file =  tmp)
plot(1,1)
dev.off()

wb &lt;- wb_workbook()$
  add_worksheet()$
  add_drawing(xml = tmp)$
  add_drawing(xml = tmp, dims = NULL)
}
</code></pre>

<hr>
<h2 id='wb_add_dxfs_style'>Set a dxfs styling for the workbook</h2><span id='topic+wb_add_dxfs_style'></span>

<h3>Description</h3>

<p>These styles are used with conditional formatting and custom table styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_dxfs_style(
  wb,
  name,
  font_name = NULL,
  font_size = NULL,
  font_color = NULL,
  num_fmt = NULL,
  border = NULL,
  border_color = wb_color(getOption("openxlsx2.borderColor", "black")),
  border_style = getOption("openxlsx2.borderStyle", "thin"),
  bg_fill = NULL,
  gradient_fill = NULL,
  text_bold = NULL,
  text_italic = NULL,
  text_underline = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_dxfs_style_+3A_wb">wb</code></td>
<td>
<p>A Workbook object.</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_name">name</code></td>
<td>
<p>the style name</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_font_name">font_name</code></td>
<td>
<p>the font name</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_font_size">font_size</code></td>
<td>
<p>the font size</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_font_color">font_color</code></td>
<td>
<p>the font color (a <code>wb_color()</code> object)</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_num_fmt">num_fmt</code></td>
<td>
<p>the number format</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_border">border</code></td>
<td>
<p>logical if borders are applied</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_border_color">border_color</code></td>
<td>
<p>the border color</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_border_style">border_style</code></td>
<td>
<p>the border style</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_bg_fill">bg_fill</code></td>
<td>
<p>any background fill</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_gradient_fill">gradient_fill</code></td>
<td>
<p>any gradient fill</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_text_bold">text_bold</code></td>
<td>
<p>logical if text is bold</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_text_italic">text_italic</code></td>
<td>
<p>logical if text is italic</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_text_underline">text_underline</code></td>
<td>
<p>logical if text is underlined</p>
</td></tr>
<tr><td><code id="wb_add_dxfs_style_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+create_dxfs_style">create_dxfs_style()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Workbook object, invisibly
</p>


<h3>See Also</h3>

<p>Other workbook styling functions: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+wb_add_style">wb_add_style</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;%
  wb_add_worksheet() %&gt;%
  wb_add_dxfs_style(
   name = "nay",
   font_color = wb_color(hex = "FF9C0006"),
   bg_fill = wb_color(hex = "FFFFC7CE")
  )
</code></pre>

<hr>
<h2 id='wb_add_fill'>Modify the background fill color in a cell region</h2><span id='topic+wb_add_fill'></span>

<h3>Description</h3>

<p>Add fill to a cell region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_fill(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  color = wb_color(hex = "FFFFFF00"),
  pattern = "solid",
  gradient_fill = "",
  every_nth_col = 1,
  every_nth_row = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_fill_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_sheet">sheet</code></td>
<td>
<p>the worksheet</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_dims">dims</code></td>
<td>
<p>the cell range</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_color">color</code></td>
<td>
<p>the colors to apply, e.g. yellow: wb_color(hex = &quot;FFFFFF00&quot;)</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_pattern">pattern</code></td>
<td>
<p>various default &quot;none&quot; but others are possible:
&quot;solid&quot;, &quot;mediumGray&quot;, &quot;darkGray&quot;, &quot;lightGray&quot;, &quot;darkHorizontal&quot;,
&quot;darkVertical&quot;, &quot;darkDown&quot;, &quot;darkUp&quot;, &quot;darkGrid&quot;, &quot;darkTrellis&quot;,
&quot;lightHorizontal&quot;, &quot;lightVertical&quot;, &quot;lightDown&quot;, &quot;lightUp&quot;, &quot;lightGrid&quot;,
&quot;lightTrellis&quot;, &quot;gray125&quot;, &quot;gray0625&quot;</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_gradient_fill">gradient_fill</code></td>
<td>
<p>a gradient fill xml pattern.</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_every_nth_col">every_nth_col</code></td>
<td>
<p>which col should be filled</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_every_nth_row">every_nth_row</code></td>
<td>
<p>which row should be filled</p>
</td></tr>
<tr><td><code id="wb_add_fill_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;% wb_add_worksheet("S1") %&gt;% wb_add_data("S1", mtcars)
wb &lt;- wb %&gt;% wb_add_fill("S1", dims = "D5:J23", color = wb_color(hex = "FFFFFF00"))
wb &lt;- wb %&gt;% wb_add_fill("S1", dims = "B22:D27", color = wb_color(hex = "FF00FF00"))

wb &lt;- wb %&gt;%  wb_add_worksheet("S2") %&gt;% wb_add_data("S2", mtcars)

gradient_fill1 &lt;- '&lt;gradientFill degree="90"&gt;
&lt;stop position="0"&gt;&lt;color rgb="FF92D050"/&gt;&lt;/stop&gt;
&lt;stop position="1"&gt;&lt;color rgb="FF0070C0"/&gt;&lt;/stop&gt;
&lt;/gradientFill&gt;'
wb &lt;- wb %&gt;% wb_add_fill("S2", dims = "A2:K5", gradient_fill = gradient_fill1)

gradient_fill2 &lt;- '&lt;gradientFill type="path" left="0.2" right="0.8" top="0.2" bottom="0.8"&gt;
&lt;stop position="0"&gt;&lt;color theme="0"/&gt;&lt;/stop&gt;
&lt;stop position="1"&gt;&lt;color theme="4"/&gt;&lt;/stop&gt;
&lt;/gradientFill&gt;'
wb &lt;- wb %&gt;% wb_add_fill("S2", dims = "A7:K10", gradient_fill = gradient_fill2)
</code></pre>

<hr>
<h2 id='wb_add_font'>Modify font in a cell region</h2><span id='topic+wb_add_font'></span>

<h3>Description</h3>

<p>Modify the font in a cell region with more precision
You can specify the font in a cell with other cell styling functions,
but <code>wb_add_font()</code> gives you more control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_font(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  name = "Aptos Narrow",
  color = wb_color(hex = "FF000000"),
  size = "11",
  bold = "",
  italic = "",
  outline = "",
  strike = "",
  underline = "",
  charset = "",
  condense = "",
  extend = "",
  family = "",
  scheme = "",
  shadow = "",
  vert_align = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_font_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_sheet">sheet</code></td>
<td>
<p>the worksheet</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_dims">dims</code></td>
<td>
<p>the cell range</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_name">name</code></td>
<td>
<p>Font name: default &quot;Aptos Narrow&quot;</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_color">color</code></td>
<td>
<p>An object created by <code><a href="#topic+wb_color">wb_color()</a></code></p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_size">size</code></td>
<td>
<p>Font size: default &quot;11&quot;,</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_bold">bold</code></td>
<td>
<p>bold, &quot;single&quot; or &quot;double&quot;, default: &quot;&quot;</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_italic">italic</code></td>
<td>
<p>italic</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_outline">outline</code></td>
<td>
<p>outline</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_strike">strike</code></td>
<td>
<p>strike</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_underline">underline</code></td>
<td>
<p>underline</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_charset">charset</code></td>
<td>
<p>charset</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_condense">condense</code></td>
<td>
<p>condense</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_extend">extend</code></td>
<td>
<p>extend</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_family">family</code></td>
<td>
<p>font family</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_scheme">scheme</code></td>
<td>
<p>font scheme</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_shadow">shadow</code></td>
<td>
<p>shadow</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_vert_align">vert_align</code></td>
<td>
<p>vertical alignment</p>
</td></tr>
<tr><td><code id="wb_add_font_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>wb_add_font()</code> provides all the options openxml accepts for a font node,
not all have to be set. Usually <code>name</code>, <code>size</code> and <code>color</code> should be what the user wants.
</p>


<h3>Value</h3>

<p>A <code>wbWorkbook</code>, invisibly
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> wb &lt;- wb_workbook() %&gt;% wb_add_worksheet("S1") %&gt;% wb_add_data("S1", mtcars)
 wb %&gt;% wb_add_font("S1", "A1:K1", name = "Arial", color = wb_color(theme = "4"))
# With chaining
 wb &lt;- wb_workbook()$add_worksheet("S1")$add_data("S1", mtcars)
 wb$add_font("S1", "A1:K1", name = "Arial", color = wb_color(theme = "4"))
</code></pre>

<hr>
<h2 id='wb_add_form_control'>Add a checkbox, radio button or drop menu to a cell in a worksheet</h2><span id='topic+wb_add_form_control'></span>

<h3>Description</h3>

<p>You can add Form Control to a cell. The three supported types are a Checkbox,
a Radio button, or a Drop menu.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_form_control(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  type = c("Checkbox", "Radio", "Drop"),
  text = NULL,
  link = NULL,
  range = NULL,
  checked = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_form_control_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet of the workbook</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_dims">dims</code></td>
<td>
<p>A single cell as spreadsheet dimension, e.g. &quot;A1&quot;.</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_type">type</code></td>
<td>
<p>A type &quot;Checkbox&quot; (the default), &quot;Radio&quot; a radio button or &quot;Drop&quot; a drop down menu</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_text">text</code></td>
<td>
<p>A text to be shown next to the Checkbox or radio button (optional)</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_link">link</code></td>
<td>
<p>A cell range to link to</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_range">range</code></td>
<td>
<p>A cell range used as input</p>
</td></tr>
<tr><td><code id="wb_add_form_control_+3A_checked">checked</code></td>
<td>
<p>A logical indicating if the Checkbox or Radio button is checked</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;% wb_add_worksheet() %&gt;%
  wb_add_form_control()
# Add
wb$add_form_control(dims = "C5", type = "Radio", checked = TRUE)
</code></pre>

<hr>
<h2 id='wb_add_formula'>Add a formula to a cell range in a worksheet</h2><span id='topic+wb_add_formula'></span>

<h3>Description</h3>

<p>This function can be used to add a formula to a worksheet.
In <code>wb_add_formula()</code>, you can provide the formula as a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_formula(
  wb,
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  cm = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_formula_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. (either as index or name)</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_x">x</code></td>
<td>
<p>A formula as character vector.</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet dimensions that will determine where <code>x</code> spans: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write to.</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write to.</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_cm">cm</code></td>
<td>
<p>A special kind of array function that hides the curly braces in the cell.
Add this, if you see &quot;@&quot; inserted into your formulas.</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook?</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>Should we keep the cell style?</p>
</td></tr>
<tr><td><code id="wb_add_formula_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the local translations of formulas are not supported.
Only the English functions work.
</p>
<p>The examples below show a small list of possible formulas:
</p>

<ul>
<li><p> SUM(B2:B4)
</p>
</li>
<li><p> AVERAGE(B2:B4)
</p>
</li>
<li><p> MIN(B2:B4)
</p>
</li>
<li><p> MAX(B2:B4)
</p>
</li>
<li><p> ...
</p>
</li></ul>

<p>It is possible to pass vectors to <code>x</code>. If <code>x</code> is an array formula, it will
take <code>dims</code> as a reference. For some formulas, the result will span multiple
cells (see the <code>MMULT()</code> example below). For this type of formula, the
output range must be known a priori and passed to <code>dims</code>, otherwise only the
value of the first cell will be returned. This type of formula, whose result
extends over several cells, is only possible with single strings. If a vector
is passed, it is only possible to return individual cells.
</p>


<h3>Value</h3>

<p>The workbook, invisibly.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()
wb$add_data(dims = wb_dims(rows = 1, cols = 1:3), x = c(4, 5, 8))

# calculate the sum of elements.
wb$add_formula(dims = "D1", x = "SUM(A1:C1)")

# array formula with result spanning over multiple cells
mm &lt;- matrix(1:4, 2, 2)

wb$add_worksheet()$
 add_data(x = mm, dims = "A1:B2", col_names = FALSE)$
 add_data(x = mm, dims = "A4:B5", col_names = FALSE)$
 add_formula(x = "MMULT(A1:B2, A4:B5)", dims = "A7:B8", array = TRUE)

</code></pre>

<hr>
<h2 id='wb_add_ignore_error'>Ignore error types on worksheet</h2><span id='topic+wb_add_ignore_error'></span>

<h3>Description</h3>

<p>This function allows to hide / ignore certain types of errors shown in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_ignore_error(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  calculated_column = FALSE,
  empty_cell_reference = FALSE,
  eval_error = FALSE,
  formula = FALSE,
  formula_range = FALSE,
  list_data_validation = FALSE,
  number_stored_as_text = FALSE,
  two_digit_text_year = FALSE,
  unlocked_formula = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_ignore_error_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_sheet">sheet</code></td>
<td>
<p>A sheet name or index.</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_dims">dims</code></td>
<td>
<p>Cell range to ignore the error</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_calculated_column">calculated_column</code></td>
<td>
<p>calculatedColumn</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_empty_cell_reference">empty_cell_reference</code></td>
<td>
<p>emptyCellReference</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_eval_error">eval_error</code></td>
<td>
<p>evalError</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_formula">formula</code></td>
<td>
<p>formula</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_formula_range">formula_range</code></td>
<td>
<p>formulaRange</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_list_data_validation">list_data_validation</code></td>
<td>
<p>listDataValidation</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_number_stored_as_text">number_stored_as_text</code></td>
<td>
<p>If <code>TRUE</code>, will not display the error if numbers are stored as text.</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_two_digit_text_year">two_digit_text_year</code></td>
<td>
<p>twoDigitTextYear</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_unlocked_formula">unlocked_formula</code></td>
<td>
<p>unlockedFormula</p>
</td></tr>
<tr><td><code id="wb_add_ignore_error_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>

<hr>
<h2 id='wb_add_image'>Insert an image into a worksheet</h2><span id='topic+wb_add_image'></span>

<h3>Description</h3>

<p>Insert an image into a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_image(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  file,
  width = 6,
  height = 3,
  row_offset = 0,
  col_offset = 0,
  units = "in",
  dpi = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_image_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_dims">dims</code></td>
<td>
<p>Dimensions where to plot. Default absolute anchor, single cell (eg. &quot;A1&quot;)
oneCellAnchor, cell range (eg. &quot;A1:D4&quot;) twoCellAnchor</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_file">file</code></td>
<td>
<p>An image file. Valid file types are:<code> "jpeg"</code>, <code>"png"</code>, <code>"bmp"</code></p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_width">width</code></td>
<td>
<p>Width of figure.</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_height">height</code></td>
<td>
<p>Height of figure.</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_row_offset">row_offset</code></td>
<td>
<p>offset vector for one or two cell anchor within cell (row)</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_col_offset">col_offset</code></td>
<td>
<p>offset vector for one or two cell anchor within cell (column)</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_units">units</code></td>
<td>
<p>Units of width and height. Can be <code>"in"</code>, <code>"cm"</code> or <code>"px"</code></p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_dpi">dpi</code></td>
<td>
<p>Image resolution used for conversion between units.</p>
</td></tr>
<tr><td><code id="wb_add_image_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_chart_xml">wb_add_chart_xml()</a></code> <code><a href="#topic+wb_add_drawing">wb_add_drawing()</a></code> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code> <code><a href="#topic+wb_add_plot">wb_add_plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img &lt;- system.file("extdata", "einstein.jpg", package = "openxlsx2")

wb &lt;- wb_workbook()$
  add_worksheet()$
  add_image("Sheet 1", dims = "C5", file = img, width = 6, height = 5)$
  add_worksheet()$
  add_image(dims = "B2", file = img)$
  add_worksheet()$
  add_image(dims = "G3", file = img, width = 15, height = 12, units = "cm")
</code></pre>

<hr>
<h2 id='wb_add_mschart'>Add mschart object to a worksheet</h2><span id='topic+wb_add_mschart'></span>

<h3>Description</h3>

<p>Add mschart object to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_mschart(
  wb,
  sheet = current_sheet(),
  dims = NULL,
  graph,
  col_offset = 0,
  row_offset = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_mschart_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="wb_add_mschart_+3A_sheet">sheet</code></td>
<td>
<p>the sheet on which the graph will appear</p>
</td></tr>
<tr><td><code id="wb_add_mschart_+3A_dims">dims</code></td>
<td>
<p>the dimensions where the sheet will appear</p>
</td></tr>
<tr><td><code id="wb_add_mschart_+3A_graph">graph</code></td>
<td>
<p>mschart object</p>
</td></tr>
<tr><td><code id="wb_add_mschart_+3A_col_offset">col_offset</code>, <code id="wb_add_mschart_+3A_row_offset">row_offset</code></td>
<td>
<p>offsets for column and row</p>
</td></tr>
<tr><td><code id="wb_add_mschart_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_data">wb_data()</a></code> <code><a href="#topic+wb_add_chart_xml">wb_add_chart_xml()</a></code> <a href="#topic+wb_add_image">wb_add_image</a> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code> <a href="#topic+wb_add_plot">wb_add_plot</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("mschart")) {
require(mschart)

## Add mschart to worksheet (adds data and chart)
scatter &lt;- ms_scatterchart(data = iris, x = "Sepal.Length", y = "Sepal.Width", group = "Species")
scatter &lt;- chart_settings(scatter, scatterstyle = "marker")

wb &lt;- wb_workbook() %&gt;%
 wb_add_worksheet() %&gt;%
 wb_add_mschart(dims = "F4:L20", graph = scatter)

## Add mschart to worksheet and use available data
wb &lt;- wb_workbook() %&gt;%
  wb_add_worksheet() %&gt;%
  wb_add_data(x = mtcars, dims = "B2")

# create wb_data object
dat &lt;- wb_data(wb, 1, dims = "B2:E6")

# call ms_scatterplot
data_plot &lt;- ms_scatterchart(
  data = dat,
  x = "mpg",
  y = c("disp", "hp"),
  labels = c("disp", "hp")
)

# add the scatterplot to the data
wb &lt;- wb %&gt;%
  wb_add_mschart(dims = "F4:L20", graph = data_plot)
}
</code></pre>

<hr>
<h2 id='wb_add_named_style'>Apply styling to a cell region with a named style</h2><span id='topic+wb_add_named_style'></span>

<h3>Description</h3>

<p>Set the styling to a named style for a cell region. Use <code><a href="#topic+wb_add_cell_style">wb_add_cell_style()</a></code>
to style a cell region with custom parameters.
A named style is the one in spreadsheet software, like &quot;Normal&quot;, &quot;Warning&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_named_style(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  name = "Normal",
  font_name = NULL,
  font_size = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_named_style_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="wb_add_named_style_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet</p>
</td></tr>
<tr><td><code id="wb_add_named_style_+3A_dims">dims</code></td>
<td>
<p>A cell range</p>
</td></tr>
<tr><td><code id="wb_add_named_style_+3A_name">name</code></td>
<td>
<p>The named style name.</p>
</td></tr>
<tr><td><code id="wb_add_named_style_+3A_font_name">font_name</code>, <code id="wb_add_named_style_+3A_font_size">font_size</code></td>
<td>
<p>optional else the default of the theme</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>

<hr>
<h2 id='wb_add_numfmt'>Modify number formatting in a cell region</h2><span id='topic+wb_add_numfmt'></span>

<h3>Description</h3>

<p>Add number formatting to a cell region. You can use a number format created
by <code><a href="#topic+create_numfmt">create_numfmt()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_numfmt(wb, sheet = current_sheet(), dims = "A1", numfmt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_numfmt_+3A_wb">wb</code></td>
<td>
<p>A Workbook</p>
</td></tr>
<tr><td><code id="wb_add_numfmt_+3A_sheet">sheet</code></td>
<td>
<p>the worksheet</p>
</td></tr>
<tr><td><code id="wb_add_numfmt_+3A_dims">dims</code></td>
<td>
<p>the cell range</p>
</td></tr>
<tr><td><code id="wb_add_numfmt_+3A_numfmt">numfmt</code></td>
<td>
<p>either an id or a character</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The list of number formats ID is located in the <strong>Details</strong> section of <code><a href="#topic+create_cell_style">create_cell_style()</a></code>.
</p>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_cell_style">wb_cell_style</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;% wb_add_worksheet("S1") %&gt;% wb_add_data("S1", mtcars)
wb %&gt;% wb_add_numfmt("S1", dims = "F1:F33", numfmt = "#.0")
# Chaining
wb &lt;- wb_workbook()$add_worksheet("S1")$add_data("S1", mtcars)
wb$add_numfmt("S1", "A1:A33", numfmt = 1)
</code></pre>

<hr>
<h2 id='wb_add_page_break'>Add a page break to a worksheet</h2><span id='topic+wb_add_page_break'></span>

<h3>Description</h3>

<p>Insert page breaks into a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_page_break(wb, sheet = current_sheet(), row = NULL, col = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_page_break_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_add_page_break_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_add_page_break_+3A_row">row</code>, <code id="wb_add_page_break_+3A_col">col</code></td>
<td>
<p>Either a row number of column number.  One must be <code>NULL</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_worksheet">wb_add_worksheet()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")
wb$add_data(sheet = 1, x = iris)

wb$add_page_break(sheet = 1, row = 10)
wb$add_page_break(sheet = 1, row = 20)
wb$add_page_break(sheet = 1, col = 2)

## In Excel: View tab -&gt; Page Break Preview
</code></pre>

<hr>
<h2 id='wb_add_pivot_table'>Add a pivot table to a worksheet</h2><span id='topic+wb_add_pivot_table'></span>

<h3>Description</h3>

<p>The data must be specified using <code><a href="#topic+wb_data">wb_data()</a></code> to ensure the function works.
The sheet will be empty unless it is opened in spreadsheet software. Find
more details in the <a href="https://janmarvin.github.io/ox2-book/chapters/openxlsx2_pivot_tables.html">section about pivot tables</a>
in the openxlsx2 book.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_pivot_table(
  wb,
  x,
  sheet = next_sheet(),
  dims = "A3",
  filter,
  rows,
  cols,
  data,
  fun,
  params,
  pivot_table,
  slicer
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_pivot_table_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a #' worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> that inherits the <code><a href="#topic+wb_data">wb_data</a></code> class.</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet containing a #'</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_dims">dims</code></td>
<td>
<p>The worksheet cell where the pivot table is placed</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_filter">filter</code></td>
<td>
<p>The column name(s) of <code>x</code> used for filter.</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_rows">rows</code></td>
<td>
<p>The column name(s) of <code>x</code> used as rows</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_cols">cols</code></td>
<td>
<p>The column names(s) of <code>x</code> used as cols</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_data">data</code></td>
<td>
<p>The column name(s) of <code>x</code> used as data</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_fun">fun</code></td>
<td>
<p>A vector of functions to be used with <code>data</code>. See <strong>Details</strong> for the list of available options.</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_params">params</code></td>
<td>
<p>A list of parameters to modify pivot table creation. See <strong>Details</strong> for available options.</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_pivot_table">pivot_table</code></td>
<td>
<p>An optional name for the pivot table</p>
</td></tr>
<tr><td><code id="wb_add_pivot_table_+3A_slicer">slicer</code></td>
<td>
<p>Any additional column name(s) of <code>x</code> used as slicer</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pivot table is not actually written to the worksheet, therefore the cell
region has to remain empty. What is written to the workbook is something
like a recipe how the spreadsheet software has to construct the pivot table
when opening the file.
</p>
<p>It is possible to add slicers to the pivot table. For this the pivot
table has to be named and the variable used as slicer, must be part
of the selected pivot table names (<code>cols</code>, <code>rows</code>, <code>filter</code>, or
<code>slicer</code>). If these criteria are matched, a slicer can be added
using <code><a href="#topic+wb_add_slicer">wb_add_slicer()</a></code>.
</p>
<p>Be aware that you should always test on a copy if a <code>param</code> argument works
with a pivot table. Not only to check if the desired effect appears, but
first and foremost if the file loads. Wildly mixing params might brick the
output file and cause spreadsheet software to crash.
</p>
<p><code>fun</code> can be any of <code>AVERAGE</code>, <code>COUNT</code>, <code>COUNTA</code>, <code>MAX</code>, <code>MIN</code>,
<code>PRODUCT</code>, <code>STDEV</code>, <code>STDEVP</code>, <code>SUM</code>, <code>VAR</code>, <code>VARP</code>.
</p>
<p><code>show_data_as</code> can be any of <code>normal</code>, <code>difference</code>, <code>percent</code>, <code>percentDiff</code>,
<code>runTotal</code>, <code>percentOfRow</code>, <code>percentOfCol</code>, <code>percentOfTotal</code>, <code>index</code>.
</p>
<p>It is possible to calculate data fields if the formula is assigned as a
variable name for the field to calculate. This would look like this:
<code>data = c("am", "disp/cyl" = "New")</code>
</p>
<p>Possible <code>params</code> arguments are listed below. Pivot tables accepts more
parameters, but they were either not tested or misbehaved (probably because
we misunderstood how the parameter should be used).
</p>
<p>Boolean arguments:
</p>

<ul>
<li><p> apply_alignment_formats
</p>
</li>
<li><p> apply_number_formats
</p>
</li>
<li><p> apply_border_formats
</p>
</li>
<li><p> apply_font_formats
</p>
</li>
<li><p> apply_pattern_formats
</p>
</li>
<li><p> apply_width_height_formats
</p>
</li>
<li><p> no_style
</p>
</li>
<li><p> compact
</p>
</li>
<li><p> outline
</p>
</li>
<li><p> compact_data
</p>
</li>
<li><p> row_grand_totals
</p>
</li>
<li><p> col_grand_totals
</p>
</li></ul>

<p>Table styles accepting character strings:
</p>

<ul>
<li><p> auto_format_id: style id as character in the range of 4096 to 4117
</p>
</li>
<li><p> table_style: a predefined (pivot) table style <code>"TableStyleMedium23"</code>
</p>
</li>
<li><p> show_data_as: accepts character strings as listed above
</p>
</li></ul>

<p>Miscellaneous:
</p>

<ul>
<li><p> numfmt: accepts vectors of the form <code>c(formatCode = "0.0%")</code>
</p>
</li>
<li><p> choose: select variables in the form of a named logical vector like
<code>c(agegp = 'x &gt; "25-34"')</code> for the <code>esoph</code> dataset.
</p>
</li>
<li><p> sort_item: named list of index or character vectors
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+wb_data">wb_data()</a></code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;% wb_add_worksheet() %&gt;% wb_add_data(x = mtcars)

df &lt;- wb_data(wb, sheet = 1)

wb &lt;- wb %&gt;%
  # default pivot table
  wb_add_pivot_table(df, dims = "A3",
    filter = "am", rows = "cyl", cols = "gear", data = "disp"
  ) %&gt;%
  # with parameters
  wb_add_pivot_table(df,
    filter = "am", rows = "cyl", cols = "gear", data = "disp",
    params = list(no_style = TRUE, numfmt = c(formatCode = "##0.0"))
  )
</code></pre>

<hr>
<h2 id='wb_add_plot'>Insert the current plot into a worksheet</h2><span id='topic+wb_add_plot'></span>

<h3>Description</h3>

<p>The current plot is saved to a temporary image file using
<code><a href="grDevices.html#topic+dev2">grDevices::dev.copy()</a></code> This file is then written to the workbook using
<code><a href="#topic+wb_add_image">wb_add_image()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_plot(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  width = 6,
  height = 4,
  row_offset = 0,
  col_offset = 0,
  file_type = "png",
  units = "in",
  dpi = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_plot_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_dims">dims</code></td>
<td>
<p>Worksheet dimension, single cell (&quot;A1&quot;) or cell range (&quot;A1:D4&quot;)</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_width">width</code></td>
<td>
<p>Width of figure. Defaults to <code>6</code> in.</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_height">height</code></td>
<td>
<p>Height of figure . Defaults to <code>4</code> in.</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_row_offset">row_offset</code>, <code id="wb_add_plot_+3A_col_offset">col_offset</code></td>
<td>
<p>Offset for column and row</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_file_type">file_type</code></td>
<td>
<p>File type of image</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_units">units</code></td>
<td>
<p>Units of width and height. Can be <code>"in"</code>, <code>"cm"</code> or <code>"px"</code></p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_dpi">dpi</code></td>
<td>
<p>Image resolution</p>
</td></tr>
<tr><td><code id="wb_add_plot_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_chart_xml">wb_add_chart_xml()</a></code> <code><a href="#topic+wb_add_drawing">wb_add_drawing()</a></code> <code><a href="#topic+wb_add_image">wb_add_image()</a></code> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("ggplot2") &amp;&amp; interactive()) {
## Create a new workbook
wb &lt;- wb_workbook()

## Add a worksheet
wb$add_worksheet("Sheet 1", grid_lines = FALSE)

## create plot objects
require(ggplot2)
p1 &lt;- ggplot(mtcars, aes(x = mpg, fill = as.factor(gear))) +
  ggtitle("Distribution of Gas Mileage") +
  geom_density(alpha = 0.5)
p2 &lt;- ggplot(Orange, aes(x = age, y = circumference, color = Tree)) +
  geom_point() + geom_line()

## Insert currently displayed plot to sheet 1, row 1, column 1
print(p1) # plot needs to be showing
wb$add_plot(1, width = 5, height = 3.5, file_type = "png", units = "in")

## Insert plot 2
print(p2)
wb$add_plot(1, dims = "J2", width = 16, height = 10, file_type = "png", units = "cm")

}
</code></pre>

<hr>
<h2 id='wb_add_slicer'>Add a slicer to a pivot table</h2><span id='topic+wb_add_slicer'></span>

<h3>Description</h3>

<p>Add a slicer to a previously created pivot table. This function is still experimental and might be changed/improved in upcoming releases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_slicer(
  wb,
  x,
  dims = "A1",
  sheet = current_sheet(),
  pivot_table,
  slicer,
  params
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_slicer_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a #' worksheet.</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> that inherits the <code><a href="#topic+wb_data">wb_data</a></code> class.</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_dims">dims</code></td>
<td>
<p>The worksheet cell where the pivot table is placed</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet containing a #'</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_pivot_table">pivot_table</code></td>
<td>
<p>The name of a pivot table on the selected sheet</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_slicer">slicer</code></td>
<td>
<p>A variable used as slicer for the pivot table</p>
</td></tr>
<tr><td><code id="wb_add_slicer_+3A_params">params</code></td>
<td>
<p>A list of parameters to modify pivot table creation. See <strong>Details</strong> for available options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This assumes that the slicer variable initialization has happened before. Unfortunately, it is unlikely that we can guarantee this for loaded workbooks, and we <em>strictly</em> discourage users from attempting this. If the variable has not been initialized properly, this may cause the spreadsheet software to crash.
</p>
<p>Possible <code>params</code> arguments are listed below.
</p>

<ul>
<li><p> edit_as: &quot;twoCell&quot; to place the slicer into the cells
</p>
</li>
<li><p> style: &quot;SlicerStyleLight2&quot;
</p>
</li>
<li><p> column_count: integer used as column count
</p>
</li>
<li><p> caption: string used for a caption
</p>
</li>
<li><p> sort_order: &quot;descending&quot; / &quot;ascending&quot;
</p>
</li>
<li><p> choose: select variables in the form of a named logical vector like
<code>c(agegp = 'x &gt; "25-34"')</code> for the <code>esoph</code> dataset.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook() %&gt;%
  wb_add_worksheet() %&gt;% wb_add_data(x = mtcars)

df &lt;- wb_data(wb, sheet = 1)

wb &lt;- wb %&gt;%
  wb_add_pivot_table(
    df, dims = "A3", slicer = "vs", rows = "cyl", cols = "gear", data = "disp",
    pivot_table = "mtcars"
  ) %&gt;%
  wb_add_slicer(x = df, slicer = "vs", pivot_table = "mtcars")
</code></pre>

<hr>
<h2 id='wb_add_sparklines'>Add sparklines to a worksheet</h2><span id='topic+wb_add_sparklines'></span>

<h3>Description</h3>

<p>Add sparklines to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_sparklines(wb, sheet = current_sheet(), sparklines)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_sparklines_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code></p>
</td></tr>
<tr><td><code id="wb_add_sparklines_+3A_sheet">sheet</code></td>
<td>
<p>sheet to add the sparklines to</p>
</td></tr>
<tr><td><code id="wb_add_sparklines_+3A_sparklines">sparklines</code></td>
<td>
<p>sparklines object created with <code><a href="#topic+create_sparklines">create_sparklines()</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+create_sparklines">create_sparklines()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> sl &lt;- create_sparklines("Sheet 1", dims = "A3:K3", sqref = "L3")
 wb &lt;- wb_workbook() %&gt;%
   wb_add_worksheet() %&gt;%
   wb_add_data(x = mtcars) %&gt;%
   wb_add_sparklines(sparklines = sl)
</code></pre>

<hr>
<h2 id='wb_add_style'>Set the default style in a workbook</h2><span id='topic+wb_add_style'></span>

<h3>Description</h3>

<p>wb wrapper to add style to workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_style(wb, style = NULL, style_name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_style_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_add_style_+3A_style">style</code></td>
<td>
<p>style xml character, created by a <code style="white-space: pre;">&#8288;create_*()&#8288;</code> function.</p>
</td></tr>
<tr><td><code id="wb_add_style_+3A_style_name">style_name</code></td>
<td>
<p>style name used optional argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+create_border">create_border()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_cell_style">create_cell_style()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_dxfs_style">create_dxfs_style()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_fill">create_fill()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_font">create_font()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+create_numfmt">create_numfmt()</a></code>
</p>
</li></ul>

<p>Other workbook styling functions: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+wb_add_dxfs_style">wb_add_dxfs_style</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yellow_f &lt;- wb_color(hex = "FF9C6500")
yellow_b &lt;- wb_color(hex = "FFFFEB9C")

yellow &lt;- create_dxfs_style(font_color = yellow_f, bg_fill = yellow_b)
wb &lt;- wb_workbook() %&gt;% wb_add_style(yellow)
</code></pre>

<hr>
<h2 id='wb_add_thread'>Add threaded comments to a cell in a worksheet</h2><span id='topic+wb_add_thread'></span><span id='topic+wb_get_thread'></span>

<h3>Description</h3>

<p>These functions allow adding thread comments to spreadsheets.
This is not yet supported by all spreadsheet software. A threaded comment must
be tied to a person created by <code><a href="#topic+wb_add_person">wb_add_person()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_thread(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  comment = NULL,
  person_id,
  reply = FALSE,
  resolve = FALSE
)

wb_get_thread(wb, sheet = current_sheet(), dims = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_thread_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_dims">dims</code></td>
<td>
<p>A cell</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_comment">comment</code></td>
<td>
<p>The text to add, a character vector.</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_person_id">person_id</code></td>
<td>
<p>the person Id this should be added. The default is
<code>getOption("openxlsx2.thread_id")</code> if set.</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_reply">reply</code></td>
<td>
<p>Is the comment a reply? (default <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="wb_add_thread_+3A_resolve">resolve</code></td>
<td>
<p>Should the comment be resolved? (default <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a threaded comment is added, it needs a person attached to it.
The default is to create a person with provider id <code>"None"</code>.
Other providers are possible with specific values for <code>id</code> and <code>user_id</code>.
If you require the following, create a workbook via spreadsheet software load
it and get the values with <code><a href="#topic+wb_get_person">wb_get_person()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_add_comment">wb_add_comment()</a></code> <code><a href="#topic+person-wb">person-wb</a></code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()
# Add a person to the workbook.
wb$add_person(name = "someone who likes to edit workbooks")

pid &lt;- wb$get_person(name = "someone who likes to edit workbooks")$id

# write a comment to a thread, reply to one and solve some
wb &lt;- wb %&gt;%
  wb_add_thread(dims = "A1", comment = "wow it works!", person_id = pid) %&gt;%
  wb_add_thread(dims = "A2", comment = "indeed", person_id = pid, resolve = TRUE) %&gt;%
  wb_add_thread(dims = "A1", comment = "so cool", person_id = pid, reply = TRUE)
</code></pre>

<hr>
<h2 id='wb_add_worksheet'>Add a worksheet to a workbook</h2><span id='topic+wb_add_worksheet'></span>

<h3>Description</h3>

<p>Add a worksheet to a <a href="#topic+wbWorkbook">wbWorkbook</a> is the first step to build a workbook.
With the function, you can also set the sheet view with <code>zoom</code>, set headers
and footers as well as other features. See the function arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_add_worksheet(
  wb,
  sheet = next_sheet(),
  grid_lines = TRUE,
  row_col_headers = TRUE,
  tab_color = NULL,
  zoom = 100,
  header = NULL,
  footer = NULL,
  odd_header = header,
  odd_footer = footer,
  even_header = header,
  even_footer = footer,
  first_header = header,
  first_footer = footer,
  visible = c("true", "false", "hidden", "visible", "veryhidden"),
  has_drawing = FALSE,
  paper_size = getOption("openxlsx2.paperSize", default = 9),
  orientation = getOption("openxlsx2.orientation", default = "portrait"),
  hdpi = getOption("openxlsx2.hdpi", default = getOption("openxlsx2.dpi", default = 300)),
  vdpi = getOption("openxlsx2.vdpi", default = getOption("openxlsx2.dpi", default = 300)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_add_worksheet_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object to attach the new worksheet</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_sheet">sheet</code></td>
<td>
<p>A name for the new worksheet</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_grid_lines">grid_lines</code></td>
<td>
<p>A logical. If <code>FALSE</code>, the worksheet grid lines will be
hidden.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_row_col_headers">row_col_headers</code></td>
<td>
<p>A logical. If <code>FALSE</code>, the worksheet colname and rowname will be
hidden.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_tab_color">tab_color</code></td>
<td>
<p>Color of the sheet tab. A  <code><a href="#topic+wb_color">wb_color()</a></code>,  a valid color (belonging to
<code>grDevices::colors()</code>) or a valid hex color beginning with &quot;#&quot;.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_zoom">zoom</code></td>
<td>
<p>The sheet zoom level, a numeric between 10 and 400 as a
percentage. (A zoom value smaller than 10 will default to 10.)</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_header">header</code>, <code id="wb_add_worksheet_+3A_odd_header">odd_header</code>, <code id="wb_add_worksheet_+3A_even_header">even_header</code>, <code id="wb_add_worksheet_+3A_first_header">first_header</code>, <code id="wb_add_worksheet_+3A_footer">footer</code>, <code id="wb_add_worksheet_+3A_odd_footer">odd_footer</code>, <code id="wb_add_worksheet_+3A_even_footer">even_footer</code>, <code id="wb_add_worksheet_+3A_first_footer">first_footer</code></td>
<td>
<p>Character vector of length 3 corresponding to positions left, center,
right.  <code>header</code> and <code>footer</code> are used to default additional arguments.
Setting <code>even</code>, <code>odd</code>, or <code>first</code>, overrides <code>header</code>/<code>footer</code>. Use <code>NA</code> to
skip a position.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_visible">visible</code></td>
<td>
<p>If <code>FALSE</code>, sheet is hidden else visible.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_has_drawing">has_drawing</code></td>
<td>
<p>If <code>TRUE</code> prepare a drawing output (TODO does this work?)</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_paper_size">paper_size</code></td>
<td>
<p>An integer corresponding to a paper size. See <code><a href="#topic+wb_page_setup">wb_page_setup()</a></code> for
details.</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_orientation">orientation</code></td>
<td>
<p>One of &quot;portrait&quot; or &quot;landscape&quot;</p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_hdpi">hdpi</code>, <code id="wb_add_worksheet_+3A_vdpi">vdpi</code></td>
<td>
<p>Horizontal and vertical DPI. Can be set with <code>options("openxlsx2.dpi" = X)</code>,
<code>options("openxlsx2.hdpi" = X)</code> or <code>options("openxlsx2.vdpi" = X)</code></p>
</td></tr>
<tr><td><code id="wb_add_worksheet_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Headers and footers can contain special tags
</p>

<ul>
<li> <p><strong>&amp;[Page]</strong> Page number
</p>
</li>
<li> <p><strong>&amp;[Pages]</strong> Number of pages
</p>
</li>
<li> <p><strong>&amp;[Date]</strong> Current date
</p>
</li>
<li> <p><strong>&amp;[Time]</strong> Current time
</p>
</li>
<li> <p><strong>&amp;[Path]</strong> File path
</p>
</li>
<li> <p><strong>&amp;[File]</strong> File name
</p>
</li>
<li> <p><strong>&amp;[Tab]</strong> Worksheet name
</p>
</li></ul>



<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- wb_workbook()

## Add a worksheet
wb$add_worksheet("Sheet 1")
## No grid lines
wb$add_worksheet("Sheet 2", grid_lines = FALSE)
## A red tab color
wb$add_worksheet("Sheet 3", tab_color = wb_color("red"))
## All options combined with a zoom of 40%
wb$add_worksheet("Sheet 4", grid_lines = FALSE, tab_color = wb_color(hex = "#4F81BD"), zoom = 40)

## Headers and Footers
wb$add_worksheet("Sheet 5",
  header = c("ODD HEAD LEFT", "ODD HEAD CENTER", "ODD HEAD RIGHT"),
  footer = c("ODD FOOT RIGHT", "ODD FOOT CENTER", "ODD FOOT RIGHT"),
  even_header = c("EVEN HEAD LEFT", "EVEN HEAD CENTER", "EVEN HEAD RIGHT"),
  even_footer = c("EVEN FOOT RIGHT", "EVEN FOOT CENTER", "EVEN FOOT RIGHT"),
  first_header = c("TOP", "OF FIRST", "PAGE"),
  first_footer = c("BOTTOM", "OF FIRST", "PAGE")
)

wb$add_worksheet("Sheet 6",
  header = c("&amp;[Date]", "ALL HEAD CENTER 2", "&amp;[Page] / &amp;[Pages]"),
  footer = c("&amp;[Path]&amp;[File]", NA, "&amp;[Tab]"),
  first_header = c(NA, "Center Header of First Page", NA),
  first_footer = c(NA, "Center Footer of First Page", NA)
)

wb$add_worksheet("Sheet 7",
  header = c("ALL HEAD LEFT 2", "ALL HEAD CENTER 2", "ALL HEAD RIGHT 2"),
  footer = c("ALL FOOT RIGHT 2", "ALL FOOT CENTER 2", "ALL FOOT RIGHT 2")
)

wb$add_worksheet("Sheet 8",
  first_header = c("FIRST ONLY L", NA, "FIRST ONLY R"),
  first_footer = c("FIRST ONLY L", NA, "FIRST ONLY R")
)

## Need data on worksheet to see all headers and footers
wb$add_data(sheet = 5, 1:400)
wb$add_data(sheet = 6, 1:400)
wb$add_data(sheet = 7, 1:400)
wb$add_data(sheet = 8, 1:400)
</code></pre>

<hr>
<h2 id='wb_base_colors'>Set the default colors in a workbook</h2><span id='topic+wb_base_colors'></span><span id='topic+wb_set_base_colors'></span><span id='topic+wb_get_base_colors'></span><span id='topic+wb_set_base_colours'></span><span id='topic+wb_get_base_colours'></span>

<h3>Description</h3>

<p>Modify / get the default colors of the workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_base_colors(wb, theme = "Office", ...)

wb_get_base_colors(wb, xml = FALSE, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_base_colors_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_base_colors_+3A_theme">theme</code></td>
<td>
<p>a predefined color theme</p>
</td></tr>
<tr><td><code id="wb_base_colors_+3A_...">...</code></td>
<td>
<p>optional parameters</p>
</td></tr>
<tr><td><code id="wb_base_colors_+3A_xml">xml</code></td>
<td>
<p>Logical if xml string should be returned</p>
</td></tr>
<tr><td><code id="wb_base_colors_+3A_plot">plot</code></td>
<td>
<p>Logical if a barplot of the colors should be returned</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Theme must be any of the following:
&quot;Aspect&quot;, &quot;Blue&quot;, &quot;Blue II&quot;, &quot;Blue Green&quot;, &quot;Blue Warm&quot;, &quot;Greyscale&quot;,
&quot;Green&quot;, &quot;Green Yellow&quot;, &quot;Marquee&quot;, &quot;Median&quot;, &quot;Office&quot;, &quot;Office 2007 - 2010&quot;,
&quot;Office 2013 - 2022&quot;, &quot;Orange&quot;, &quot;Orange Red&quot;, &quot;Paper&quot;, &quot;Red&quot;,
&quot;Red Orange&quot;, &quot;Red Violet&quot;, &quot;Slipstream&quot;, &quot;Violet&quot;, &quot;Violet II&quot;,
&quot;Yellow&quot;, &quot;Yellow Orange&quot;
</p>


<h3>See Also</h3>

<p>Other workbook styling functions: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+wb_add_dxfs_style">wb_add_dxfs_style</a>()</code>,
<code><a href="#topic+wb_add_style">wb_add_style</a>()</code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$get_base_colors()
wb$set_base_colors(theme = 3)
wb$set_base_colors(theme = "Violet II")
wb$get_base_colours()
</code></pre>

<hr>
<h2 id='wb_cell_style'>Apply styling to a cell region</h2><span id='topic+wb_cell_style'></span><span id='topic+wb_get_cell_style'></span><span id='topic+wb_set_cell_style'></span><span id='topic+wb_set_cell_style_across'></span>

<h3>Description</h3>

<p>Setting a style across only impacts cells that are not yet part of a workbook. The effect is similar to setting the cell style for all cells in a row independently, though much quicker and less memory consuming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_cell_style(wb, sheet = current_sheet(), dims)

wb_set_cell_style(wb, sheet = current_sheet(), dims, style)

wb_set_cell_style_across(
  wb,
  sheet = current_sheet(),
  style,
  cols = NULL,
  rows = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_cell_style_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="wb_cell_style_+3A_sheet">sheet</code></td>
<td>
<p>sheet</p>
</td></tr>
<tr><td><code id="wb_cell_style_+3A_dims">dims</code></td>
<td>
<p>A cell range in the worksheet</p>
</td></tr>
<tr><td><code id="wb_cell_style_+3A_style">style</code></td>
<td>
<p>A style or a cell with a certain style</p>
</td></tr>
<tr><td><code id="wb_cell_style_+3A_cols">cols</code></td>
<td>
<p>The columns the style will be applied to, either &quot;A:D&quot; or 1:4</p>
</td></tr>
<tr><td><code id="wb_cell_style_+3A_rows">rows</code></td>
<td>
<p>The rows the style will be applied to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Workbook object
</p>


<h3>See Also</h3>

<p>Other styles: 
<code><a href="#topic+wb_add_border">wb_add_border</a>()</code>,
<code><a href="#topic+wb_add_cell_style">wb_add_cell_style</a>()</code>,
<code><a href="#topic+wb_add_fill">wb_add_fill</a>()</code>,
<code><a href="#topic+wb_add_font">wb_add_font</a>()</code>,
<code><a href="#topic+wb_add_named_style">wb_add_named_style</a>()</code>,
<code><a href="#topic+wb_add_numfmt">wb_add_numfmt</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set a style in b1
wb &lt;- wb_workbook()$add_worksheet()$
  add_numfmt(dims = "B1", numfmt = "#,0")

# get style from b1 to assign it to a1
numfmt &lt;- wb$get_cell_style(dims = "B1")

# assign style to a1
wb$set_cell_style(dims = "A1", style = numfmt)
wb &lt;- wb_workbook() %&gt;%
  wb_add_worksheet() %&gt;%
  wb_add_fill(dims = "C3", color = wb_color("yellow")) %&gt;%
  wb_set_cell_style_across(style = "C3", cols = "C:D", rows = 3:4)
</code></pre>

<hr>
<h2 id='wb_clean_sheet'>Remove all values in a worksheet</h2><span id='topic+wb_clean_sheet'></span>

<h3>Description</h3>

<p>Remove content of a worksheet completely, or a region if specifying <code>dims</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_clean_sheet(
  wb,
  sheet = current_sheet(),
  dims = NULL,
  numbers = TRUE,
  characters = TRUE,
  styles = TRUE,
  merged_cells = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_clean_sheet_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_sheet">sheet</code></td>
<td>
<p>sheet to clean</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_dims">dims</code></td>
<td>
<p>spreadsheet dimensions (optional)</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_numbers">numbers</code></td>
<td>
<p>remove all numbers</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_characters">characters</code></td>
<td>
<p>remove all characters</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_styles">styles</code></td>
<td>
<p>remove all styles</p>
</td></tr>
<tr><td><code id="wb_clean_sheet_+3A_merged_cells">merged_cells</code></td>
<td>
<p>remove all merged_cells</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Workbook object
</p>

<hr>
<h2 id='wb_clone_sheet_style'>Apply styling from a sheet to another within a workbook</h2><span id='topic+wb_clone_sheet_style'></span>

<h3>Description</h3>

<p>This function can be used to apply styling from a cell range, and apply it
to another cell range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_clone_sheet_style(wb, from = current_sheet(), to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_clone_sheet_style_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_clone_sheet_style_+3A_from">from</code></td>
<td>
<p>sheet we select the style from</p>
</td></tr>
<tr><td><code id="wb_clone_sheet_style_+3A_to">to</code></td>
<td>
<p>sheet to apply the style to</p>
</td></tr>
</table>

<hr>
<h2 id='wb_clone_worksheet'>Create copies of a worksheet within a workbook</h2><span id='topic+wb_clone_worksheet'></span>

<h3>Description</h3>

<p>Create a copy of a worksheet in the same <code>wbWorkbook</code> object.
</p>
<p>Cloning is possible only to a limited extent. References to sheet names in
formulas, charts, pivot tables, etc. may not be updated. Some elements like
named ranges and slicers cannot be cloned yet.
</p>
<p>Cloning from another workbook is still an experimental feature and might not
work reliably. Cloning data, media, charts and tables should work. Slicers
and pivot tables as well as everything everything relying on dxfs styles
(e.g. custom table styles and conditional formatting) is currently not
implemented.
Formula references are not updated to reflect interactions between workbooks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_clone_worksheet(wb, old = current_sheet(), new = next_sheet(), from = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_clone_worksheet_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="wb_clone_worksheet_+3A_old">old</code></td>
<td>
<p>Name of existing worksheet to copy</p>
</td></tr>
<tr><td><code id="wb_clone_worksheet_+3A_new">new</code></td>
<td>
<p>Name of the new worksheet to create</p>
</td></tr>
<tr><td><code id="wb_clone_worksheet_+3A_from">from</code></td>
<td>
<p>(optional) Workbook to clone old from</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a new workbook
wb &lt;- wb_workbook()

# Add worksheets
wb$add_worksheet("Sheet 1")
wb$clone_worksheet("Sheet 1", new = "Sheet 2")
# Take advantage of waiver functions
wb$clone_worksheet(old = "Sheet 1")

## cloning from another workbook

# create a workbook
wb &lt;- wb_workbook()$
add_worksheet("NOT_SUM")$
  add_data(x = head(iris))$
  add_fill(dims = "A1:B2", color = wb_color("yellow"))$
  add_border(dims = "B2:C3")

# we will clone this styled chart into another workbook
fl &lt;- system.file("extdata", "oxlsx2_sheet.xlsx", package = "openxlsx2")
wb_from &lt;- wb_load(fl)

# clone styles and shared strings
wb$clone_worksheet(old = "SUM", new = "SUM", from = wb_from)

</code></pre>

<hr>
<h2 id='wb_color'>Helper to create a color</h2><span id='topic+wb_color'></span><span id='topic+wb_colour'></span>

<h3>Description</h3>

<p>Creates a <code>wbColour</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_color(
  name = NULL,
  auto = NULL,
  indexed = NULL,
  hex = NULL,
  theme = NULL,
  tint = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_color_+3A_name">name</code></td>
<td>
<p>A name of a color known to R either as name or RGB/ARGB value.</p>
</td></tr>
<tr><td><code id="wb_color_+3A_auto">auto</code></td>
<td>
<p>A boolean.</p>
</td></tr>
<tr><td><code id="wb_color_+3A_indexed">indexed</code></td>
<td>
<p>An indexed color value. This color has to be provided by the workbook.</p>
</td></tr>
<tr><td><code id="wb_color_+3A_hex">hex</code></td>
<td>
<p>A rgb color either a ARGB hex value or RGB hex value With or without leading &quot;#&quot;.</p>
</td></tr>
<tr><td><code id="wb_color_+3A_theme">theme</code></td>
<td>
<p>A zero based index referencing a value in the theme.</p>
</td></tr>
<tr><td><code id="wb_color_+3A_tint">tint</code></td>
<td>
<p>A tint value applied. Range from -1 (dark) to 1 (light).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>wbColour</code> object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_get_base_colors">wb_get_base_colors()</a></code> <code><a href="grDevices.html#topic+colors">grDevices::colors()</a></code>
</p>

<hr>
<h2 id='wb_comment'>Helper to create a comment object</h2><span id='topic+wb_comment'></span>

<h3>Description</h3>

<p>Creates a <code>wbComment</code> object. Use with <code><a href="#topic+wb_add_comment">wb_add_comment()</a></code> to add to a worksheet location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_comment(
  text = NULL,
  style = NULL,
  visible = FALSE,
  author = getOption("openxlsx2.creator"),
  width = 2,
  height = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_comment_+3A_text">text</code></td>
<td>
<p>Comment text. Character vector. or a <code><a href="#topic+fmt_txt">fmt_txt()</a></code> string.</p>
</td></tr>
<tr><td><code id="wb_comment_+3A_style">style</code></td>
<td>
<p>A Style object or list of style objects the same length as comment vector.</p>
</td></tr>
<tr><td><code id="wb_comment_+3A_visible">visible</code></td>
<td>
<p>Is comment visible? Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wb_comment_+3A_author">author</code></td>
<td>
<p>Author of comment. A string. By default, will look at <code>options("openxlsx2.creator")</code>.
Otherwise, will check the system username.</p>
</td></tr>
<tr><td><code id="wb_comment_+3A_width">width</code></td>
<td>
<p>Textbox integer width in number of cells</p>
</td></tr>
<tr><td><code id="wb_comment_+3A_height">height</code></td>
<td>
<p>Textbox integer height in number of cells</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>wbComment</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1")

# write comment without author
c1 &lt;- wb_comment(text = "this is a comment", author = "", visible = TRUE)
wb$add_comment(dims = "B10", comment = c1)

# Write another comment with author information
c2 &lt;- wb_comment(text = "this is another comment", author = "Marco Polo")
wb$add_comment(sheet = 1, dims = "C10", comment = c2)

# write a styled comment with system author
s1 &lt;- create_font(b = "true", color = wb_color(hex = "FFFF0000"), sz = "12")
s2 &lt;- create_font(color = wb_color(hex = "FF000000"), sz = "9")
c3 &lt;- wb_comment(text = c("This Part Bold red\n\n", "This part black"), style = c(s1, s2))

wb$add_comment(sheet = 1, dims = wb_dims(3, 6), comment = c3)
</code></pre>

<hr>
<h2 id='wb_copy_cells'>Copy cells around within a worksheet</h2><span id='topic+wb_copy_cells'></span>

<h3>Description</h3>

<p>Copy cells around within a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_copy_cells(
  wb,
  sheet = current_sheet(),
  dims = "A1",
  data,
  as_value = FALSE,
  as_ref = FALSE,
  transpose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_copy_cells_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_sheet">sheet</code></td>
<td>
<p>a worksheet</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_dims">dims</code></td>
<td>
<p>A cell where to place the copy</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_data">data</code></td>
<td>
<p>A <code><a href="#topic+wb_data">wb_data</a></code> object containing cells to copy</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_as_value">as_value</code></td>
<td>
<p>Should a copy of the value be written?</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_as_ref">as_ref</code></td>
<td>
<p>Should references to the cell be written?</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_transpose">transpose</code></td>
<td>
<p>Should the data be written transposed?</p>
</td></tr>
<tr><td><code id="wb_copy_cells_+3A_...">...</code></td>
<td>
<p>additional arguments passed to add_data() if used with <code>as_value</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the <code>wbWorkbook</code> invisibly
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_data">wb_data()</a></code>
</p>
<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$
add_worksheet()$
  add_data(x = mtcars)$
  add_fill(dims = "A1:F1", color = wb_color("yellow"))

dat &lt;- wb_data(wb, dims = "A1:D4", col_names = FALSE)
# 1:1 copy to M2
wb$
  clone_worksheet(old = 1, new = "Clone1")$
  copy_cells(data = dat, dims = "M2")
</code></pre>

<hr>
<h2 id='wb_data'>Add the <code>wb_data</code> attribute to a data frame in a worksheet</h2><span id='topic+wb_data'></span><span id='topic++5B.wb_data'></span>

<h3>Description</h3>

<p>provide wb_data object as mschart input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_data(wb, sheet = current_sheet(), dims, ...)

## S3 method for class 'wb_data'

  x[
  i,
  j,
  drop = ifelse((missing(j) &amp;&amp; length(i) &gt; 1) || (!missing(i) &amp;&amp; length(j) &gt; 1), FALSE,
    TRUE)
]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_data_+3A_wb">wb</code></td>
<td>
<p>a workbook</p>
</td></tr>
<tr><td><code id="wb_data_+3A_sheet">sheet</code></td>
<td>
<p>a sheet in the workbook either name or index</p>
</td></tr>
<tr><td><code id="wb_data_+3A_dims">dims</code></td>
<td>
<p>the dimensions</p>
</td></tr>
<tr><td><code id="wb_data_+3A_...">...</code></td>
<td>
<p>additional arguments for <code>wb_to_df()</code>. Be aware that not every
argument is valid.</p>
</td></tr>
<tr><td><code id="wb_data_+3A_x">x</code></td>
<td>
<p>x</p>
</td></tr>
<tr><td><code id="wb_data_+3A_i">i</code></td>
<td>
<p>i</p>
</td></tr>
<tr><td><code id="wb_data_+3A_j">j</code></td>
<td>
<p>j</p>
</td></tr>
<tr><td><code id="wb_data_+3A_drop">drop</code></td>
<td>
<p>drop</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of class <code>wb_data</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_to_df">wb_to_df()</a></code> <code><a href="#topic+wb_add_mschart">wb_add_mschart()</a></code>, <code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> wb &lt;- wb_workbook() %&gt;%
   wb_add_worksheet() %&gt;%
   wb_add_data(x = mtcars, dims = "B2")

 wb_data(wb, 1, dims = "B2:E6")
</code></pre>

<hr>
<h2 id='wb_dims'>Helper to specify the <code>dims</code> argument</h2><span id='topic+wb_dims'></span>

<h3>Description</h3>

<p><code>wb_dims()</code> can be used to help provide the <code>dims</code> argument, in the <code style="white-space: pre;">&#8288;wb_add_*&#8288;</code> functions.
It returns a A1 spreadsheet range (&quot;A1:B1&quot; or &quot;A2&quot;).
It can be very useful as you can specify many parameters that interact together
In general, you must provide named arguments. <code>wb_dims()</code> will only accept unnamed arguments
if they are <code>rows</code>, <code>cols</code>, for example <code>wb_dims(1:4, 1:2)</code>, that will return &quot;A1:B4&quot;.
</p>
<p><code>wb_dims()</code> can also be used with an object (a <code>data.frame</code> or a <code>matrix</code> for example.)
All parameters are numeric unless stated otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_dims(..., select = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_dims_+3A_...">...</code></td>
<td>
<p>construct <code>dims</code> arguments, from rows/cols vectors or objects that
can be coerced to data frame. <code>x</code>, <code>rows</code>, <code>cols</code>, <code>from_row</code>, <code>from_col</code>, <code>from_dims</code>
<code>row_names</code>, and <code>col_names</code> are accepted.</p>
</td></tr>
<tr><td><code id="wb_dims_+3A_select">select</code></td>
<td>
<p>A string, one of the followings.
it improves the selection of various parts of <code>x</code>
One of &quot;x&quot;, &quot;data&quot;, &quot;col_names&quot;, or &quot;row_names&quot;.
<code>"data"</code> will only select the data part, excluding row names and column names  (default if <code>cols</code> or <code>rows</code> are specified)
<code>"x"</code> Includes the data, column and row names if they are present. (default if none of <code>rows</code> and <code>cols</code> are provided)
<code>"col_names"</code> will only return column names
<code>"row_names"</code> Will only return row names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using <code>wb_dims()</code> with an object, the default behavior is
to select only the data / row or columns in <code>x</code>
If you need another behavior, use <code>wb_dims()</code> without supplying <code>x</code>.
</p>

<ul>
<li> <p><code>x</code> An object (typically a <code>matrix</code> or a <code>data.frame</code>, but a vector is also accepted.)
</p>
</li>
<li> <p><code>from_row</code> / <code>from_col</code> / <code>from_dims</code> the starting position of <code>x</code>
(The <code>dims</code> returned will assume that the top left corner of <code>x</code> is at <code>from_row / from_col</code>
</p>
</li>
<li> <p><code>rows</code> Optional Which row span in <code>x</code> should this apply to.
If <code>rows</code> = 0, only column names will be affected.
</p>
</li>
<li> <p><code>cols</code> a range of columns id in <code>x</code>, or one of the column names of <code>x</code>
(length 1 only accepted for column names of <code>x</code>.)
</p>
</li>
<li> <p><code>row_names</code> A logical, this is to let <code>wb_dims()</code> know that <code>x</code> has row names or not.
If <code>row_names = TRUE</code>, <code>wb_dims()</code> will increment <code>from_col</code> by 1.
</p>
</li>
<li> <p><code>col_names</code> <code>wb_dims()</code> assumes that if <code>x</code> has column names, then trying to find the <code>dims</code>.
</p>
</li></ul>

<p><code>wb_dims()</code> tries to support most possible cases with <code>row_names = TRUE</code> and <code>col_names = FALSE</code>,
but it works best if <code>x</code> has named dimensions (<code>data.frame</code>, <code>matrix</code>), and those parameters are not specified.
data with column names, and without row names. as the code is more clean.
</p>
<p>In the <code>add_data()</code> / <code>add_font()</code> example, if writing the data with row names
</p>


<h3>Value</h3>

<p>A <code>dims</code> string
</p>


<h3>Using <code>wb_dims()</code> without an <code>x</code> object</h3>


<ul>
<li> <p><code>rows</code> / <code>cols</code> (if you want to specify a single one, use <code>from_row</code> / <code>from_col</code>)
</p>
</li>
<li> <p><code>from_row</code> / <code>from_col</code> the starting position of the <code>dims</code>
(similar to <code>start_row</code> / <code>start_col</code>, but with a clearer name.)
</p>
</li></ul>



<h3>Using <code>wb_dims()</code> with an <code>x</code> object</h3>

<p><code>wb_dims()</code> with an object has 8 use-cases (they work with any position values of <code>from_row</code> / <code>from_col</code>),
<code>from_col/from_row</code> correspond to the coordinates at the top left of <code>x</code> including column and row names if present.
</p>
<p>These use cases are provided without <code>from_row / from_col</code>, but they work also with <code>from_row / from_col</code>.
</p>

<ol>
<li><p> provide the full grid with <code>wb_dims(x = mtcars)</code>
</p>
</li>
<li><p> provide the data grid <code>wb_dims(x = mtcars, select = "data")</code>
</p>
</li>
<li><p> provide the <code>dims</code> of column names <code style="white-space: pre;">&#8288;wb_dims(x = mtcars, select = "col_names)&#8288;</code>
</p>
</li>
<li><p> provide the <code>dims</code> of row names  <code>wb_dims(x = mtcars, row_names = TRUE, select = "row_names")</code>
</p>
</li>
<li><p> provide the <code>dims</code> of a row span <code>wb_dims(x = mtcars, rows = 1:10)</code> selects
the first 10 data rows of <code>mtcars</code> (ignoring column names)
</p>
</li>
<li><p> provide the <code>dims</code> of the data in a column span <code>wb_dims(x = mtcars, cols = 1:5)</code>
select the data first 5 columns of <code>mtcars</code>
</p>
</li>
<li><p> provide a column span (including column names) <code>wb_dims(x = mtcars, cols = 4:7, select = "x")</code>
select the data columns 4, 5, 6, 7 of <code>mtcars</code> + column names
</p>
</li>
<li><p> provide the position of a single column by name <code>wb_dims(x = mtcars, cols = "mpg")</code>.
</p>
</li>
<li><p> provide a row span with a column. <code>wb_dims(x = mtcars, cols = "mpg", rows = 5:22)</code>
</p>
</li></ol>

<p>To reuse, a good trick is to create a wrapper function, so that styling can be
performed seamlessly.
</p>
<div class="sourceCode R"><pre>wb_dims_cars &lt;- function(...) {
  wb_dims(x = mtcars, from_row = 2, from_col = "B", ...)
}
# using this function
wb_dims_cars()                     # full grid (data + column names)
wb_dims_cars(select = "data")      # data only
wb_dims_cars(select = "col_names") # select column names
wb_dims_cars(cols = "vs")          # select the `vs` column
</pre></div>
<p>It can be very useful to apply many rounds of styling sequentially.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Provide coordinates
wb_dims(1, 4)
wb_dims(rows = 1, cols = 4)
wb_dims(from_row = 4)
wb_dims(from_col = 2)
wb_dims(from_col = "B")
wb_dims(1:4, 6:9, from_row = 5)
# Provide vectors
wb_dims(1:10, c("A", "B", "C"))
wb_dims(rows = 1:10, cols = 1:10)
# provide `from_col` / `from_row`
wb_dims(rows = 1:10, cols = c("A", "B", "C"), from_row = 2)
wb_dims(rows = 1:10, cols = 1:10, from_col = 2)
wb_dims(rows = 1:10, cols = 1:10, from_dims = "B1")
# or objects
wb_dims(x = mtcars, col_names = TRUE)

# select all data
wb_dims(x = mtcars, select = "data")

# column names of an object (with the special select = "col_names")
wb_dims(x = mtcars, select = "col_names")


# dims of the column names of an object
wb_dims(x = mtcars, select = "col_names", col_names = TRUE)

## add formatting to `mtcars` using `wb_dims()`----
wb &lt;- wb_workbook()
wb$add_worksheet("test wb_dims() with an object")
dims_mtcars_and_col_names &lt;- wb_dims(x = mtcars)
wb$add_data(x = mtcars, dims = dims_mtcars_and_col_names)

# Put the font as Arial for the data
dims_mtcars_data &lt;- wb_dims(x = mtcars, select = "data")
wb$add_font(dims = dims_mtcars_data, name = "Arial")

# Style col names as bold using the special `select = "col_names"` with `x` provided.
dims_column_names &lt;- wb_dims(x = mtcars, select = "col_names")
wb$add_font(dims = dims_column_names, bold = TRUE, size = 13)

# Finally, to add styling to column "cyl" (the 4th column) (only the data)
# there are many options, but here is the preferred one
# if you know the column index, wb_dims(x = mtcars, cols = 4) also works.
dims_cyl &lt;- wb_dims(x = mtcars, cols = "cyl")
wb$add_fill(dims = dims_cyl, color = wb_color("pink"))

# Mark a full column as important(with the column name too)
wb_dims_vs &lt;- wb_dims(x = mtcars, cols = "vs", select = "x")
wb$add_fill(dims = wb_dims_vs, fill = wb_color("yellow"))
wb$add_conditional_formatting(dims = wb_dims(x = mtcars, cols = "mpg"), type = "dataBar")
# wb_open(wb)
</code></pre>

<hr>
<h2 id='wb_freeze_pane'>Freeze pane of a worksheet</h2><span id='topic+wb_freeze_pane'></span>

<h3>Description</h3>

<p>Add a Freeze pane in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_freeze_pane(
  wb,
  sheet = current_sheet(),
  first_active_row = NULL,
  first_active_col = NULL,
  first_row = FALSE,
  first_col = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_freeze_pane_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_first_active_row">first_active_row</code></td>
<td>
<p>Top row of active region</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_first_active_col">first_active_col</code></td>
<td>
<p>Furthest left column of active region</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_first_row">first_row</code></td>
<td>
<p>If <code>TRUE</code>, freezes the first row (equivalent to <code>first_active_row = 2</code>)</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_first_col">first_col</code></td>
<td>
<p>If <code>TRUE</code>, freezes the first column (equivalent to <code>first_active_col = 2</code>)</p>
</td></tr>
<tr><td><code id="wb_freeze_pane_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- wb_workbook("Kenshin")

## Add some worksheets
wb$add_worksheet("Sheet 1")
wb$add_worksheet("Sheet 2")
wb$add_worksheet("Sheet 3")
wb$add_worksheet("Sheet 4")

## Freeze Panes
wb$freeze_pane("Sheet 1", first_active_row = 5, first_active_col = 3)
wb$freeze_pane("Sheet 2", first_col = TRUE) ## shortcut to first_active_col = 2
wb$freeze_pane(3, first_row = TRUE) ## shortcut to first_active_row = 2
wb$freeze_pane(4, first_active_row = 1, first_active_col = "D")
</code></pre>

<hr>
<h2 id='wb_get_tables'>List Excel tables in a worksheet</h2><span id='topic+wb_get_tables'></span>

<h3>Description</h3>

<p>List Excel tables in a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_tables(wb, sheet = current_sheet())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_get_tables_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_get_tables_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of table names on the specified sheet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- wb_workbook()
wb$add_worksheet(sheet = "Sheet 1")
wb$add_data_table(x = iris)
wb$add_data_table(x = mtcars, table_name = "mtcars", start_col = 10)

wb$get_tables(sheet = "Sheet 1")
</code></pre>

<hr>
<h2 id='wb_load'>Load an existing .xlsx, .xlsm or .xlsb file</h2><span id='topic+wb_load'></span>

<h3>Description</h3>

<p><code>wb_load()</code> returns a <a href="#topic+wbWorkbook">wbWorkbook</a> object conserving the content of the
original input file, including data, styles, media. This workbook can be
modified, read from, and be written back into a xlsx file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_load(file, sheet, data_only = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_load_+3A_file">file</code></td>
<td>
<p>A path to an existing .xlsx, .xlsm or .xlsb file</p>
</td></tr>
<tr><td><code id="wb_load_+3A_sheet">sheet</code></td>
<td>
<p>optional sheet parameter. if this is applied, only the selected
sheet will be loaded. This can be a numeric, a string or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wb_load_+3A_data_only">data_only</code></td>
<td>
<p>mode to import if only a data frame should be returned. This
strips the <code>wbWorkbook</code> to a bare minimum.</p>
</td></tr>
<tr><td><code id="wb_load_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a specific <code>sheet</code> is selected, the workbook will still contain sheets
for all worksheets. The argument <code>sheet</code> and <code>data_only</code> are used internally
by <code><a href="#topic+wb_to_df">wb_to_df()</a></code> to read from a file with minimal changes. They are not
specifically designed to create rudimentary but otherwise fully functional
workbooks. It is possible to import with
<code>wb_load(data_only = TRUE, sheet = NULL)</code>. In this way, only a workbook
framework is loaded without worksheets or data. This can be useful if only
some workbook properties are of interest.
</p>
<p>There are some internal arguments that can be passed to wb_load, which are
used for development. The <code>debug</code> argument allows debugging of <code>xlsb</code> files
in particular. With <code>calc_chain</code> it is possible to maintain the calculation
chain. The calculation chain is used by spreadsheet software to determine
the order in which formulas are evaluated. Removing the calculation chain
has no known effect. The calculation chain is created the next time the
worksheet is loaded into the spreadsheet. Keeping the calculation chain
could only shorten the loading time in said software. Unfortunately, if a
cell is added to the worksheet, the calculation chain may block the
worksheet as the formulas will not be evaluated again until each individual
cell with a formula is selected in the spreadsheet software and the Enter
key is pressed manually. It is therefore strongly recommended not to
activate this function.
</p>
<p>In rare cases, a warning is issued when loading an xlsx file that an xml
namespace has been removed from xml files. This refers to the internal
structure of the loaded xlsx file. Certain xlsx files created by third-party
applications contain a namespace (usually x). This namespace is not required
for the file to work in spreadsheet software and is not expected by
<code>openxlsx2</code>. It is therefore removed when the file is loaded into a
workbook. Removal is generally considered safe, but the feature is still not
commonly observed, hence the warning.
</p>
<p>Initial support for binary openxml files (<code>xlsb</code>) has been added to the
package. We parse the binary file format into pseudo-openxml files that we
can import. Therefore, once imported, it is possible to interact with the
file as if it had been provided in xlsx file format in the first place. This
parsing into pseudo xml files is of course slower than reading directly from
the binary file. Our implementation is also still missing some functions:
some array formulas are not yet correct, conditional formatting and data
validation are not implemented, nor are pivot tables and slicers.
</p>


<h3>Value</h3>

<p>A Workbook object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load existing workbook
fl &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
wb &lt;- wb_load(file = fl)
</code></pre>

<hr>
<h2 id='wb_merge_cells'>Merge cells within a worksheet</h2><span id='topic+wb_merge_cells'></span><span id='topic+wb_unmerge_cells'></span>

<h3>Description</h3>

<p>Worksheet cell merging
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_merge_cells(wb, sheet = current_sheet(), dims = NULL, solve = FALSE, ...)

wb_unmerge_cells(wb, sheet = current_sheet(), dims = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_merge_cells_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_merge_cells_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_merge_cells_+3A_dims">dims</code></td>
<td>
<p>worksheet cells</p>
</td></tr>
<tr><td><code id="wb_merge_cells_+3A_solve">solve</code></td>
<td>
<p>logical if intersecting merges should be solved</p>
</td></tr>
<tr><td><code id="wb_merge_cells_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If using the deprecated arguments <code>rows</code> and <code>cols</code> with a merged region must be rectangular,
only min and max of <code>cols</code> and <code>rows</code> are used.
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>
<p>Other worksheet content functions: 
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+filter-wb">filter-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+named_region-wb">named_region-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_conditional_formatting">wb_add_conditional_formatting</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_thread">wb_add_thread</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a new workbook
wb &lt;- wb_workbook()$add_worksheet()

# Merge cells: Row 2 column C to F (3:6)
wb &lt;- wb_merge_cells(wb, dims = "C3:F6")

# Merge cells:Rows 10 to 20 columns A to J (1:10)
wb &lt;- wb_merge_cells(wb, dims = wb_dims(rows = 10:20, cols = 1:10))

wb$add_worksheet()

## Intersecting merges
wb &lt;- wb_merge_cells(wb, dims = wb_dims(cols = 1:10, rows = 1))
wb &lt;- wb_merge_cells(wb, dims = wb_dims(cols = 5:10, rows = 2))
wb &lt;- wb_merge_cells(wb, dims = wb_dims(cols = 1:10, rows = 12))
try(wb_merge_cells(wb, dims = "A1:A10"))

## remove merged cells
# removes any intersecting merges
wb &lt;- wb_unmerge_cells(wb, dims = wb_dims(cols = 1, rows = 1))
wb &lt;- wb_merge_cells(wb, dims = "A1:A10")

# or let us decide how to solve this
wb &lt;- wb_merge_cells(wb, dims = "A1:A10", solve = TRUE)

</code></pre>

<hr>
<h2 id='wb_open'>Preview a workbook in a spreadsheet software</h2><span id='topic+wb_open'></span>

<h3>Description</h3>

<p>You can also use the shorter <code>wb$open()</code> as a replacement.
To open xlsx files, see <code><a href="#topic+xl_open">xl_open()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_open(wb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_open_+3A_wb">wb</code></td>
<td>
<p>a <a href="#topic+wbWorkbook">wbWorkbook</a> object</p>
</td></tr>
</table>

<hr>
<h2 id='wb_order'>Order worksheets in a workbook</h2><span id='topic+wb_order'></span><span id='topic+wb_get_order'></span><span id='topic+wb_set_order'></span>

<h3>Description</h3>

<p>Get/set order of worksheets in a Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_get_order(wb)

wb_set_order(wb, sheets)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_order_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object</p>
</td></tr>
<tr><td><code id="wb_order_+3A_sheets">sheets</code></td>
<td>
<p>Sheet order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not reorder the worksheets within the workbook
object, it simply shuffles the order when writing to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## setup a workbook with 3 worksheets
wb &lt;- wb_workbook()
wb$add_worksheet("Sheet 1", grid_lines = FALSE)
wb$add_data_table(x = iris)

wb$add_worksheet("mtcars (Sheet 2)", grid_lines = FALSE)
wb$add_data(x = mtcars)

wb$add_worksheet("Sheet 3", grid_lines = FALSE)
wb$add_data(x = Formaldehyde)

wb_get_order(wb)
wb$get_sheet_na
wb$set_order(c(1, 3, 2)) # switch position of sheets 2 &amp; 3
wb$add_data(2, 'This is still the "mtcars" worksheet', start_col = 15)
wb_get_order(wb)
wb$get_sheet_names() ## ordering within workbook is not changed
wb$set_order(3:1)
</code></pre>

<hr>
<h2 id='wb_page_setup'>Set page margins, orientation and print scaling of a worksheet</h2><span id='topic+wb_page_setup'></span>

<h3>Description</h3>

<p>Set page margins, orientation and print scaling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_page_setup(
  wb,
  sheet = current_sheet(),
  orientation = NULL,
  scale = 100,
  left = 0.7,
  right = 0.7,
  top = 0.75,
  bottom = 0.75,
  header = 0.3,
  footer = 0.3,
  fit_to_width = FALSE,
  fit_to_height = FALSE,
  paper_size = NULL,
  print_title_rows = NULL,
  print_title_cols = NULL,
  summary_row = NULL,
  summary_col = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_page_setup_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_orientation">orientation</code></td>
<td>
<p>Page orientation. One of &quot;portrait&quot; or &quot;landscape&quot;</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_scale">scale</code></td>
<td>
<p>Print scaling. Numeric value between 10 and 400</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_left">left</code>, <code id="wb_page_setup_+3A_right">right</code>, <code id="wb_page_setup_+3A_top">top</code>, <code id="wb_page_setup_+3A_bottom">bottom</code></td>
<td>
<p>Page margin in inches</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_header">header</code>, <code id="wb_page_setup_+3A_footer">footer</code></td>
<td>
<p>Margin in inches</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_fit_to_width">fit_to_width</code>, <code id="wb_page_setup_+3A_fit_to_height">fit_to_height</code></td>
<td>
<p>An integer that tells the spreadsheet software on how many pages the scaling should fit. This does not actually scale the sheet.</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_paper_size">paper_size</code></td>
<td>
<p>See details. Default value is 9 (A4 paper).</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_print_title_rows">print_title_rows</code>, <code id="wb_page_setup_+3A_print_title_cols">print_title_cols</code></td>
<td>
<p>Rows / columns to repeat at top of page when printing. Integer vector.</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_summary_row">summary_row</code></td>
<td>
<p>Location of summary rows in groupings. One of &quot;Above&quot; or &quot;Below&quot;.</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_summary_col">summary_col</code></td>
<td>
<p>Location of summary columns in groupings. One of &quot;Right&quot; or &quot;Left&quot;.</p>
</td></tr>
<tr><td><code id="wb_page_setup_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When adding fitting to width and height manual adjustment of the scaling factor is required. Setting <code>fit_to_width</code> and <code>fit_to_height</code> only tells spreadsheet software that the scaling was applied, but not which scaling was applied.
</p>
<p><code>paper_size</code> is an integer corresponding to:</p>

<table>
<tr>
 <td style="text-align: left;">
   size </td><td style="text-align: left;"> "paper type" </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> Letter paper (8.5 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   2 </td><td style="text-align: left;"> Letter small paper (8.5 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   3 </td><td style="text-align: left;"> Tabloid paper (11 in. by 17 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   4 </td><td style="text-align: left;"> Ledger paper (17 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   5 </td><td style="text-align: left;"> Legal paper (8.5 in. by 14 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   6 </td><td style="text-align: left;"> Statement paper (5.5 in. by 8.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   7 </td><td style="text-align: left;"> Executive paper (7.25 in. by 10.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   8 </td><td style="text-align: left;"> A3 paper (297 mm by 420 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   9 </td><td style="text-align: left;"> A4 paper (210 mm by 297 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   10 </td><td style="text-align: left;"> A4 small paper (210 mm by 297 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   11 </td><td style="text-align: left;"> A5 paper (148 mm by 210 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   12 </td><td style="text-align: left;"> B4 paper (250 mm by 353 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   13 </td><td style="text-align: left;"> B5 paper (176 mm by 250 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   14 </td><td style="text-align: left;"> Folio paper (8.5 in. by 13 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   15 </td><td style="text-align: left;"> Quarto paper (215 mm by 275 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   16 </td><td style="text-align: left;"> Standard paper (10 in. by 14 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   17 </td><td style="text-align: left;"> Standard paper (11 in. by 17 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   18 </td><td style="text-align: left;"> Note paper (8.5 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   19 </td><td style="text-align: left;"> #9 envelope (3.875 in. by 8.875 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   20 </td><td style="text-align: left;"> #10 envelope (4.125 in. by 9.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   21 </td><td style="text-align: left;"> #11 envelope (4.5 in. by 10.375 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   22 </td><td style="text-align: left;"> #12 envelope (4.75 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   23 </td><td style="text-align: left;"> #14 envelope (5 in. by 11.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   24 </td><td style="text-align: left;"> C paper (17 in. by 22 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   25 </td><td style="text-align: left;"> D paper (22 in. by 34 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   26 </td><td style="text-align: left;"> E paper (34 in. by 44 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   27 </td><td style="text-align: left;"> DL envelope (110 mm by 220 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   28 </td><td style="text-align: left;"> C5 envelope (162 mm by 229 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   29 </td><td style="text-align: left;"> C3 envelope (324 mm by 458 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   30 </td><td style="text-align: left;"> C4 envelope (229 mm by 324 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   31 </td><td style="text-align: left;"> C6 envelope (114 mm by 162 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   32 </td><td style="text-align: left;"> C65 envelope (114 mm by 229 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   33 </td><td style="text-align: left;"> B4 envelope (250 mm by 353 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   34 </td><td style="text-align: left;"> B5 envelope (176 mm by 250 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   35 </td><td style="text-align: left;"> B6 envelope (176 mm by 125 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   36 </td><td style="text-align: left;"> Italy envelope (110 mm by 230 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   37 </td><td style="text-align: left;"> Monarch envelope (3.875 in. by 7.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   38 </td><td style="text-align: left;"> 6 3/4 envelope (3.625 in. by 6.5 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   39 </td><td style="text-align: left;"> US standard fanfold (14.875 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   40 </td><td style="text-align: left;"> German standard fanfold (8.5 in. by 12 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   41 </td><td style="text-align: left;"> German legal fanfold (8.5 in. by 13 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   42 </td><td style="text-align: left;"> ISO B4 (250 mm by 353 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   43 </td><td style="text-align: left;"> Japanese double postcard (200 mm by 148 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   44 </td><td style="text-align: left;"> Standard paper (9 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   45 </td><td style="text-align: left;"> Standard paper (10 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   46 </td><td style="text-align: left;"> Standard paper (15 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   47 </td><td style="text-align: left;"> Invite envelope (220 mm by 220 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   50 </td><td style="text-align: left;"> Letter extra paper (9.275 in. by 12 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   51 </td><td style="text-align: left;"> Legal extra paper (9.275 in. by 15 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   52 </td><td style="text-align: left;"> Tabloid extra paper (11.69 in. by 18 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   53 </td><td style="text-align: left;"> A4 extra paper (236 mm by 322 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   54 </td><td style="text-align: left;"> Letter transverse paper (8.275 in. by 11 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   55 </td><td style="text-align: left;"> A4 transverse paper (210 mm by 297 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   56 </td><td style="text-align: left;"> Letter extra transverse paper (9.275 in. by 12 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   57 </td><td style="text-align: left;"> SuperA/SuperA/A4 paper (227 mm by 356 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   58 </td><td style="text-align: left;"> SuperB/SuperB/A3 paper (305 mm by 487 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   59 </td><td style="text-align: left;"> Letter plus paper (8.5 in. by 12.69 in.) </td>
</tr>
<tr>
 <td style="text-align: left;">
   60 </td><td style="text-align: left;"> A4 plus paper (210 mm by 330 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   61 </td><td style="text-align: left;"> A5 transverse paper (148 mm by 210 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   62 </td><td style="text-align: left;"> JIS B5 transverse paper (182 mm by 257 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   63 </td><td style="text-align: left;"> A3 extra paper (322 mm by 445 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   64 </td><td style="text-align: left;"> A5 extra paper (174 mm by 235 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   65 </td><td style="text-align: left;"> ISO B5 extra paper (201 mm by 276 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   66 </td><td style="text-align: left;"> A2 paper (420 mm by 594 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   67 </td><td style="text-align: left;"> A3 transverse paper (297 mm by 420 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   68 </td><td style="text-align: left;"> A3 extra transverse paper (322 mm by 445 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   69 </td><td style="text-align: left;"> Japanese Double Postcard (200 mm x 148 mm) 70=A6(105mm x 148mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   71 </td><td style="text-align: left;"> Japanese Envelope Kaku #2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   72 </td><td style="text-align: left;"> Japanese Envelope Kaku #3 </td>
</tr>
<tr>
 <td style="text-align: left;">
   73 </td><td style="text-align: left;"> Japanese Envelope Chou #3 </td>
</tr>
<tr>
 <td style="text-align: left;">
   74 </td><td style="text-align: left;"> Japanese Envelope Chou #4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   75 </td><td style="text-align: left;"> Letter Rotated (11in x 8 1/2 11 in) </td>
</tr>
<tr>
 <td style="text-align: left;">
   76 </td><td style="text-align: left;"> A3 Rotated (420 mm x 297 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   77 </td><td style="text-align: left;"> A4 Rotated (297 mm x 210 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   78 </td><td style="text-align: left;"> A5 Rotated (210 mm x 148 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   79 </td><td style="text-align: left;"> B4 (JIS) Rotated (364 mm x 257 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   80 </td><td style="text-align: left;"> B5 (JIS) Rotated (257 mm x 182 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   81 </td><td style="text-align: left;"> Japanese Postcard Rotated (148 mm x 100 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   82 </td><td style="text-align: left;"> Double Japanese Postcard Rotated (148 mm x 200 mm) 83 = A6 Rotated (148 mm x 105 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   84 </td><td style="text-align: left;"> Japanese Envelope Kaku #2 Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   85 </td><td style="text-align: left;"> Japanese Envelope Kaku #3 Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   86 </td><td style="text-align: left;"> Japanese Envelope Chou #3 Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   87 </td><td style="text-align: left;"> Japanese Envelope Chou #4 Rotated 88=B6(JIS)(128mm x 182mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   89 </td><td style="text-align: left;"> B6 (JIS) Rotated (182 mm x 128 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   90 </td><td style="text-align: left;"> (12 in x 11 in) </td>
</tr>
<tr>
 <td style="text-align: left;">
   91 </td><td style="text-align: left;"> Japanese Envelope You #4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   92 </td><td style="text-align: left;"> Japanese Envelope You #4 Rotated 93=PRC16K(146mm x 215mm) 94=PRC32K(97mm x 151mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   95 </td><td style="text-align: left;"> PRC 32K(Big) (97 mm x 151 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   96 </td><td style="text-align: left;"> PRC Envelope #1 (102 mm x 165 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   97 </td><td style="text-align: left;"> PRC Envelope #2 (102 mm x 176 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   98 </td><td style="text-align: left;"> PRC Envelope #3 (125 mm x 176 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   99 </td><td style="text-align: left;"> PRC Envelope #4 (110 mm x 208 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   100 </td><td style="text-align: left;"> PRC Envelope #5 (110 mm x 220 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   101 </td><td style="text-align: left;"> PRC Envelope #6 (120 mm x 230 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   102 </td><td style="text-align: left;"> PRC Envelope #7 (160 mm x 230 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   103 </td><td style="text-align: left;"> PRC Envelope #8 (120 mm x 309 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   104 </td><td style="text-align: left;"> PRC Envelope #9 (229 mm x 324 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   105 </td><td style="text-align: left;"> PRC Envelope #10 (324 mm x 458 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   106 </td><td style="text-align: left;"> PRC 16K Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   107 </td><td style="text-align: left;"> PRC 32K Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   108 </td><td style="text-align: left;"> PRC 32K(Big) Rotated </td>
</tr>
<tr>
 <td style="text-align: left;">
   109 </td><td style="text-align: left;"> PRC Envelope #1 Rotated (165 mm x 102 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   110 </td><td style="text-align: left;"> PRC Envelope #2 Rotated (176 mm x 102 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   111 </td><td style="text-align: left;"> PRC Envelope #3 Rotated (176 mm x 125 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   112 </td><td style="text-align: left;"> PRC Envelope #4 Rotated (208 mm x 110 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   113 </td><td style="text-align: left;"> PRC Envelope #5 Rotated (220 mm x 110 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   114 </td><td style="text-align: left;"> PRC Envelope #6 Rotated (230 mm x 120 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   115 </td><td style="text-align: left;"> PRC Envelope #7 Rotated (230 mm x 160 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   116 </td><td style="text-align: left;"> PRC Envelope #8 Rotated (309 mm x 120 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   117 </td><td style="text-align: left;"> PRC Envelope #9 Rotated (324 mm x 229 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
   118 </td><td style="text-align: left;"> PRC Envelope #10 Rotated (458 mm x 324 mm) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("S1")
wb$add_worksheet("S2")
wb$add_data_table(1, x = iris[1:30, ])
wb$add_data_table(2, x = iris[1:30, ], dims = c("C5"))

## landscape page scaled to 50%
wb$page_setup(sheet = 1, orientation = "landscape", scale = 50)

## portrait page scales to 300% with 0.5in left and right margins
wb$page_setup(sheet = 2, orientation = "portrait", scale = 300, left = 0.5, right = 0.5)


## print titles
wb$add_worksheet("print_title_rows")
wb$add_worksheet("print_title_cols")

wb$add_data("print_title_rows", rbind(iris, iris, iris, iris))
wb$add_data("print_title_cols", x = rbind(mtcars, mtcars, mtcars), row_names = TRUE)

wb$page_setup(sheet = "print_title_rows", print_title_rows = 1) ## first row
wb$page_setup(sheet = "print_title_cols", print_title_cols = 1, print_title_rows = 1)
</code></pre>

<hr>
<h2 id='wb_protect'>Protect a workbook from modifications</h2><span id='topic+wb_protect'></span>

<h3>Description</h3>

<p>Protect or unprotect a workbook from modifications by the user in the
graphical user interface. Replaces an existing protection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_protect(
  wb,
  protect = TRUE,
  password = NULL,
  lock_structure = FALSE,
  lock_windows = FALSE,
  type = 1,
  file_sharing = FALSE,
  username = unname(Sys.info()["user"]),
  read_only_recommended = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_protect_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_protect">protect</code></td>
<td>
<p>Whether to protect or unprotect the sheet (default <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_password">password</code></td>
<td>
<p>(optional) password required to unprotect the workbook</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_lock_structure">lock_structure</code></td>
<td>
<p>Whether the workbook structure should be locked</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_lock_windows">lock_windows</code></td>
<td>
<p>Whether the window position of the spreadsheet should be
locked</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_type">type</code></td>
<td>
<p>Lock type (see <strong>Details</strong>)</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_file_sharing">file_sharing</code></td>
<td>
<p>Whether to enable a popup requesting the unlock password
is prompted</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_username">username</code></td>
<td>
<p>The username for the <code>file_sharing</code> popup</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_read_only_recommended">read_only_recommended</code></td>
<td>
<p>Whether or not a post unlock message appears
stating that the workbook is recommended to be opened in read-only mode.</p>
</td></tr>
<tr><td><code id="wb_protect_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lock types:
</p>

<ul>
<li> <p><code>1</code>  xlsx with password (default)
</p>
</li>
<li> <p><code>2</code> xlsx recommends read-only
</p>
</li>
<li> <p><code>4</code> xlsx enforces read-only
</p>
</li>
<li> <p><code>8</code> xlsx is locked for annotation
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("S1")
wb_protect(wb, protect = TRUE, password = "Password", lock_structure = TRUE)

# Remove the protection
wb_protect(wb, protect = FALSE)

wb &lt;- wb_protect(
  wb,
  protect = TRUE,
  password = "Password",
  lock_structure = TRUE,
  type = 2L,
  file_sharing = TRUE,
  username = "Test",
  read_only_recommended = TRUE
)

</code></pre>

<hr>
<h2 id='wb_protect_worksheet'>Protect a worksheet from modifications</h2><span id='topic+wb_protect_worksheet'></span>

<h3>Description</h3>

<p>Protect or unprotect a worksheet from modifications by the user in the graphical user interface. Replaces an existing protection. Certain features require applying unlocking of initialized cells in the worksheet and across columns and/or rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_protect_worksheet(
  wb,
  sheet = current_sheet(),
  protect = TRUE,
  password = NULL,
  properties = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_protect_worksheet_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_protect_worksheet_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_protect_worksheet_+3A_protect">protect</code></td>
<td>
<p>Whether to protect or unprotect the sheet (default=TRUE)</p>
</td></tr>
<tr><td><code id="wb_protect_worksheet_+3A_password">password</code></td>
<td>
<p>(optional) password required to unprotect the worksheet</p>
</td></tr>
<tr><td><code id="wb_protect_worksheet_+3A_properties">properties</code></td>
<td>
<p>A character vector of properties to lock.  Can be one or
more of the following: <code>"selectLockedCells"</code>, <code>"selectUnlockedCells"</code>,
<code>"formatCells"</code>, <code>"formatColumns"</code>, <code>"formatRows"</code>, <code>"insertColumns"</code>,
<code>"insertRows"</code>, <code>"insertHyperlinks"</code>, <code>"deleteColumns"</code>, <code>"deleteRows"</code>,
<code>"sort"</code>, <code>"autoFilter"</code>, <code>"pivotTables"</code>, <code>"objects"</code>, <code>"scenarios"</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet("S1")
wb$add_data_table(1, x = iris[1:30, ])

wb$protect_worksheet(
  "S1",
  protect = TRUE,
  properties = c("formatCells", "formatColumns", "insertColumns", "deleteColumns")
)

# Formatting cells / columns is allowed , but inserting / deleting columns is protected:
wb$protect_worksheet(
  "S1",
  protect = TRUE,
   c(formatCells = FALSE, formatColumns = FALSE,
                 insertColumns = TRUE, deleteColumns = TRUE)
)

# Remove the protection
wb$protect_worksheet("S1", protect = FALSE)
</code></pre>

<hr>
<h2 id='wb_remove_tables'>Remove a data table from a worksheet</h2><span id='topic+wb_remove_tables'></span>

<h3>Description</h3>

<p>Remove Excel tables in a workbook using its name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_remove_tables(wb, sheet = current_sheet(), table, remove_data = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_remove_tables_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_remove_tables_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_remove_tables_+3A_table">table</code></td>
<td>
<p>Name of table to remove. Use <code><a href="#topic+wb_get_tables">wb_get_tables()</a></code> to view the
tables present in the worksheet.</p>
</td></tr>
<tr><td><code id="wb_remove_tables_+3A_remove_data">remove_data</code></td>
<td>
<p>Default <code>TRUE</code>. If <code>FALSE</code>, will only remove the data table attributes
but will keep the data in the worksheet.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb$add_worksheet(sheet = "Sheet 1")
wb$add_worksheet(sheet = "Sheet 2")
wb$add_data_table(sheet = "Sheet 1", x = iris, table_name = "iris")
wb$add_data_table(sheet = 1, x = mtcars, table_name = "mtcars", start_col = 10)

## delete worksheet removes table objects
wb &lt;- wb_remove_worksheet(wb, sheet = 1)

wb$add_data_table(sheet = 1, x = iris, table_name = "iris")
wb$add_data_table(sheet = 1, x = mtcars, table_name = "mtcars", start_col = 10)

## wb_remove_tables() deletes table object and all data
wb_get_tables(wb, sheet = 1)
wb$remove_tables(sheet = 1, table = "iris")
wb$add_data_table(sheet = 1, x = iris, table_name = "iris")

wb_get_tables(wb, sheet = 1)
wb$remove_tables(sheet = 1, table = "iris")
</code></pre>

<hr>
<h2 id='wb_remove_worksheet'>Remove a worksheet from a workbook</h2><span id='topic+wb_remove_worksheet'></span>

<h3>Description</h3>

<p>Remove a worksheet from a workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_remove_worksheet(wb, sheet = current_sheet())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_remove_worksheet_+3A_wb">wb</code></td>
<td>
<p>A wbWorkbook object</p>
</td></tr>
<tr><td><code id="wb_remove_worksheet_+3A_sheet">sheet</code></td>
<td>
<p>The sheet name or index to remove</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load a workbook
wb &lt;- wb_load(file = system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2"))

## Remove sheet 2
wb &lt;- wb_remove_worksheet(wb, 2)
</code></pre>

<hr>
<h2 id='wb_save'>Save a workbook to file</h2><span id='topic+wb_save'></span>

<h3>Description</h3>

<p>Save a workbook to file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_save(wb, file = NULL, overwrite = TRUE, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_save_+3A_wb">wb</code></td>
<td>
<p>A <code>wbWorkbook</code> object to write to file</p>
</td></tr>
<tr><td><code id="wb_save_+3A_file">file</code></td>
<td>
<p>A path to save the workbook to</p>
</td></tr>
<tr><td><code id="wb_save_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>FALSE</code>, will not overwrite when <code>file</code> already exists.</p>
</td></tr>
<tr><td><code id="wb_save_+3A_path">path</code></td>
<td>
<p>Deprecated argument. Please use <code>file</code> in new code.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the <code>wbWorkbook</code> object, invisibly
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook and add a worksheet
wb &lt;- wb_workbook("Creator of workbook")
wb$add_worksheet(sheet = "My first worksheet")

## Save workbook to working directory

wb_save(wb, file = temp_xlsx(), overwrite = TRUE)

</code></pre>

<hr>
<h2 id='wb_set_bookview'>Set the workbook position, size and filter</h2><span id='topic+wb_set_bookview'></span>

<h3>Description</h3>

<p>Set the workbook position, size and filter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_bookview(
  wb,
  active_tab = NULL,
  auto_filter_date_grouping = NULL,
  first_sheet = NULL,
  minimized = NULL,
  show_horizontal_scroll = NULL,
  show_sheet_tabs = NULL,
  show_vertical_scroll = NULL,
  tab_ratio = NULL,
  visibility = NULL,
  window_height = NULL,
  window_width = NULL,
  x_window = NULL,
  y_window = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_set_bookview_+3A_wb">wb</code></td>
<td>
<p>A <a href="#topic+wbWorkbook">wbWorkbook</a> object</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_active_tab">active_tab</code></td>
<td>
<p>activeTab</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_auto_filter_date_grouping">auto_filter_date_grouping</code></td>
<td>
<p>autoFilterDateGrouping</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_first_sheet">first_sheet</code></td>
<td>
<p>The first sheet to be displayed</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_minimized">minimized</code></td>
<td>
<p>minimized</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_show_horizontal_scroll">show_horizontal_scroll</code></td>
<td>
<p>showHorizontalScroll</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_show_sheet_tabs">show_sheet_tabs</code></td>
<td>
<p>showSheetTabs</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_show_vertical_scroll">show_vertical_scroll</code></td>
<td>
<p>showVerticalScroll</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_tab_ratio">tab_ratio</code></td>
<td>
<p>tabRatio</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_visibility">visibility</code></td>
<td>
<p>visibility</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_window_height">window_height</code></td>
<td>
<p>windowHeight</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_window_width">window_width</code></td>
<td>
<p>windowWidth</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_x_window">x_window</code></td>
<td>
<p>xWindow</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_y_window">y_window</code></td>
<td>
<p>yWindow</p>
</td></tr>
<tr><td><code id="wb_set_bookview_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Workbook object
</p>

<hr>
<h2 id='wb_set_grid_lines'>Modify grid lines visibility in a worksheet</h2><span id='topic+wb_set_grid_lines'></span><span id='topic+wb_grid_lines'></span>

<h3>Description</h3>

<p>Set worksheet grid lines to show or hide.
You can also add / remove grid lines when creating a worksheet with
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet(grid_lines = FALSE)</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_grid_lines(wb, sheet = current_sheet(), show = FALSE, print = show)

wb_grid_lines(wb, sheet = current_sheet(), show = FALSE, print = show)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_set_grid_lines_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_set_grid_lines_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_set_grid_lines_+3A_show">show</code></td>
<td>
<p>A logical. If <code>FALSE</code>, grid lines are hidden.</p>
</td></tr>
<tr><td><code id="wb_set_grid_lines_+3A_print">print</code></td>
<td>
<p>A logical. If <code>FALSE</code>, grid lines are not printed.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()$add_worksheet()
wb$get_sheet_names() ## list worksheets in workbook
wb$set_grid_lines(1, show = FALSE)
wb$set_grid_lines("Sheet 2", show = FALSE)
</code></pre>

<hr>
<h2 id='wb_set_header_footer'>Set headers and footers of a worksheet</h2><span id='topic+wb_set_header_footer'></span>

<h3>Description</h3>

<p>Set document headers and footers. You can also do this when adding a worksheet
with <code><a href="#topic+wb_add_worksheet">wb_add_worksheet()</a></code> with the <code>header</code>, <code>footer</code> arguments and friends.
These will show up when printing an xlsx file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_header_footer(
  wb,
  sheet = current_sheet(),
  header = NULL,
  footer = NULL,
  even_header = NULL,
  even_footer = NULL,
  first_header = NULL,
  first_footer = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_set_header_footer_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_set_header_footer_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="wb_set_header_footer_+3A_header">header</code>, <code id="wb_set_header_footer_+3A_even_header">even_header</code>, <code id="wb_set_header_footer_+3A_first_header">first_header</code>, <code id="wb_set_header_footer_+3A_footer">footer</code>, <code id="wb_set_header_footer_+3A_even_footer">even_footer</code>, <code id="wb_set_header_footer_+3A_first_footer">first_footer</code></td>
<td>
<p>Character vector of length 3 corresponding to positions left, center,
right.  <code>header</code> and <code>footer</code> are used to default additional arguments.
Setting <code>even</code>, <code>odd</code>, or <code>first</code>, overrides <code>header</code>/<code>footer</code>. Use <code>NA</code> to
skip a position.</p>
</td></tr>
<tr><td><code id="wb_set_header_footer_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Headers and footers can contain special tags
</p>

<ul>
<li> <p><strong>&amp;[Page]</strong> Page number
</p>
</li>
<li> <p><strong>&amp;[Pages]</strong> Number of pages
</p>
</li>
<li> <p><strong>&amp;[Date]</strong> Current date
</p>
</li>
<li> <p><strong>&amp;[Time]</strong> Current time
</p>
</li>
<li> <p><strong>&amp;[Path]</strong> File path
</p>
</li>
<li> <p><strong>&amp;[File]</strong> File name
</p>
</li>
<li> <p><strong>&amp;[Tab]</strong> Worksheet name
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()

# Add example data
wb$add_worksheet("S1")$add_data(x = 1:400)
wb$add_worksheet("S2")$add_data(x = 1:400)
wb$add_worksheet("S3")$add_data(x = 3:400)
wb$add_worksheet("S4")$add_data(x = 3:400)

wb$set_header_footer(
  sheet = "S1",
  header = c("ODD HEAD LEFT", "ODD HEAD CENTER", "ODD HEAD RIGHT"),
  footer = c("ODD FOOT RIGHT", "ODD FOOT CENTER", "ODD FOOT RIGHT"),
  even_header = c("EVEN HEAD LEFT", "EVEN HEAD CENTER", "EVEN HEAD RIGHT"),
  even_footer = c("EVEN FOOT RIGHT", "EVEN FOOT CENTER", "EVEN FOOT RIGHT"),
  first_header = c("TOP", "OF FIRST", "PAGE"),
  first_footer = c("BOTTOM", "OF FIRST", "PAGE")
)

wb$set_header_footer(
  sheet = 2,
  header = c("&amp;[Date]", "ALL HEAD CENTER 2", "&amp;[Page] / &amp;[Pages]"),
  footer = c("&amp;[Path]&amp;[File]", NA, "&amp;[Tab]"),
  first_header = c(NA, "Center Header of First Page", NA),
  first_footer = c(NA, "Center Footer of First Page", NA)
)

wb$set_header_footer(
  sheet = 3,
  header = c("ALL HEAD LEFT 2", "ALL HEAD CENTER 2", "ALL HEAD RIGHT 2"),
  footer = c("ALL FOOT RIGHT 2", "ALL FOOT CENTER 2", "ALL FOOT RIGHT 2")
)

wb$set_header_footer(
  sheet = 4,
  first_header = c("FIRST ONLY L", NA, "FIRST ONLY R"),
  first_footer = c("FIRST ONLY L", NA, "FIRST ONLY R")
)
</code></pre>

<hr>
<h2 id='wb_set_last_modified_by'>Modify author in the metadata of a workbook</h2><span id='topic+wb_set_last_modified_by'></span>

<h3>Description</h3>

<p>Just a wrapper of <code>wb$set_last_modified_by()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_last_modified_by(wb, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_set_last_modified_by_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="wb_set_last_modified_by_+3A_name">name</code></td>
<td>
<p>A string object with the name of the LastModifiedBy-User</p>
</td></tr>
<tr><td><code id="wb_set_last_modified_by_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_workbook">wb_workbook</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()
wb_set_last_modified_by(wb, "test")
</code></pre>

<hr>
<h2 id='wb_set_sheetview'>Modify the default view of a worksheet</h2><span id='topic+wb_set_sheetview'></span>

<h3>Description</h3>

<p>This helps set a worksheet's appearance, such as the zoom, whether to show grid lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_set_sheetview(
  wb,
  sheet = current_sheet(),
  color_id = NULL,
  default_grid_color = NULL,
  right_to_left = NULL,
  show_formulas = NULL,
  show_grid_lines = NULL,
  show_outline_symbols = NULL,
  show_row_col_headers = NULL,
  show_ruler = NULL,
  show_white_space = NULL,
  show_zeros = NULL,
  tab_selected = NULL,
  top_left_cell = NULL,
  view = NULL,
  window_protection = NULL,
  workbook_view_id = NULL,
  zoom_scale = NULL,
  zoom_scale_normal = NULL,
  zoom_scale_page_layout_view = NULL,
  zoom_scale_sheet_layout_view = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_set_sheetview_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_sheet">sheet</code></td>
<td>
<p>sheet</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_color_id">color_id</code>, <code id="wb_set_sheetview_+3A_default_grid_color">default_grid_color</code></td>
<td>
<p>Integer: A color, default is 64</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_right_to_left">right_to_left</code></td>
<td>
<p>Logical: if <code>TRUE</code> column ordering is right  to left</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_formulas">show_formulas</code></td>
<td>
<p>Logical: if <code>TRUE</code> cell formulas are shown</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_grid_lines">show_grid_lines</code></td>
<td>
<p>Logical: if <code>TRUE</code> the worksheet grid is shown</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_outline_symbols">show_outline_symbols</code></td>
<td>
<p>Logical: if <code>TRUE</code> outline symbols are shown</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_row_col_headers">show_row_col_headers</code></td>
<td>
<p>Logical: if <code>TRUE</code> row and column headers are shown</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_ruler">show_ruler</code></td>
<td>
<p>Logical: if <code>TRUE</code> a ruler is shown in page layout view</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_white_space">show_white_space</code></td>
<td>
<p>Logical: if <code>TRUE</code> margins are shown in page layout view</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_show_zeros">show_zeros</code></td>
<td>
<p>Logical: if <code>FALSE</code> cells containing zero are shown blank if <code>show_formulas = FALSE</code></p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_tab_selected">tab_selected</code></td>
<td>
<p>Integer: zero vector indicating the selected tab</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_top_left_cell">top_left_cell</code></td>
<td>
<p>Cell: the cell shown in the top left corner / or top right with rightToLeft</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_view">view</code></td>
<td>
<p>View: &quot;normal&quot;, &quot;pageBreakPreview&quot; or &quot;pageLayout&quot;</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_window_protection">window_protection</code></td>
<td>
<p>Logical: if <code>TRUE</code> the panes are protected</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_workbook_view_id">workbook_view_id</code></td>
<td>
<p>integer: Pointing to some other view inside the workbook</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_zoom_scale">zoom_scale</code>, <code id="wb_set_sheetview_+3A_zoom_scale_normal">zoom_scale_normal</code>, <code id="wb_set_sheetview_+3A_zoom_scale_page_layout_view">zoom_scale_page_layout_view</code>, <code id="wb_set_sheetview_+3A_zoom_scale_sheet_layout_view">zoom_scale_sheet_layout_view</code></td>
<td>
<p>Integer: the zoom scale should be between 10 and 400. These are values for current, normal etc.</p>
</td></tr>
<tr><td><code id="wb_set_sheetview_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()

wb$set_sheetview(
  zoom_scale = 75,
  right_to_left = FALSE,
  show_formulas = TRUE,
  show_grid_lines = TRUE,
  show_outline_symbols = FALSE,
  show_row_col_headers = TRUE,
  show_ruler = TRUE,
  show_white_space = FALSE,
  tab_selected = 1,
  top_left_cell = "B1",
  view = "normal",
  window_protection = TRUE
)
</code></pre>

<hr>
<h2 id='wb_to_df'>Create a data frame from a Workbook</h2><span id='topic+wb_to_df'></span><span id='topic+read_xlsx'></span><span id='topic+wb_read'></span>

<h3>Description</h3>

<p>Simple function to create a <code>data.frame</code> from a sheet in workbook. Simple as
in it was simply written down. <code>read_xlsx()</code> and <code>wb_read()</code> are just
internal wrappers of <code>wb_to_df()</code> intended for people coming from other
packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_to_df(
  file,
  sheet,
  start_row = 1,
  start_col = NULL,
  row_names = FALSE,
  col_names = TRUE,
  skip_empty_rows = FALSE,
  skip_empty_cols = FALSE,
  skip_hidden_rows = FALSE,
  skip_hidden_cols = FALSE,
  rows = NULL,
  cols = NULL,
  detect_dates = TRUE,
  na.strings = "#N/A",
  na.numbers = NA,
  fill_merged_cells = FALSE,
  dims,
  show_formula = FALSE,
  convert = TRUE,
  types,
  named_region,
  keep_attributes = FALSE,
  ...
)

read_xlsx(
  file,
  sheet,
  start_row = 1,
  start_col = NULL,
  row_names = FALSE,
  col_names = TRUE,
  skip_empty_rows = FALSE,
  skip_empty_cols = FALSE,
  rows = NULL,
  cols = NULL,
  detect_dates = TRUE,
  named_region,
  na.strings = "#N/A",
  na.numbers = NA,
  fill_merged_cells = FALSE,
  ...
)

wb_read(
  file,
  sheet = 1,
  start_row = 1,
  start_col = NULL,
  row_names = FALSE,
  col_names = TRUE,
  skip_empty_rows = FALSE,
  skip_empty_cols = FALSE,
  rows = NULL,
  cols = NULL,
  detect_dates = TRUE,
  named_region,
  na.strings = "NA",
  na.numbers = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_to_df_+3A_file">file</code></td>
<td>
<p>An xlsx file, <a href="#topic+wbWorkbook">wbWorkbook</a> object or URL to xlsx file.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_sheet">sheet</code></td>
<td>
<p>Either sheet name or index. When missing the first sheet in the workbook is selected.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_start_row">start_row</code></td>
<td>
<p>first row to begin looking for data.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_start_col">start_col</code></td>
<td>
<p>first column to begin looking for data.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_row_names">row_names</code></td>
<td>
<p>If <code>TRUE</code>, the first col of data will be used as row names.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_col_names">col_names</code></td>
<td>
<p>If <code>TRUE</code>, the first row of data will be used as column names.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_skip_empty_rows">skip_empty_rows</code></td>
<td>
<p>If <code>TRUE</code>, empty rows are skipped.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_skip_empty_cols">skip_empty_cols</code></td>
<td>
<p>If <code>TRUE</code>, empty columns are skipped.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_skip_hidden_rows">skip_hidden_rows</code></td>
<td>
<p>If <code>TRUE</code>, hidden rows are skipped.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_skip_hidden_cols">skip_hidden_cols</code></td>
<td>
<p>If <code>TRUE</code>, hidden columns are skipped.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_rows">rows</code></td>
<td>
<p>A numeric vector specifying which rows in the xlsx file to read.
If <code>NULL</code>, all rows are read.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_cols">cols</code></td>
<td>
<p>A numeric vector specifying which columns in the xlsx file to read.
If <code>NULL</code>, all columns are read.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_detect_dates">detect_dates</code></td>
<td>
<p>If <code>TRUE</code>, attempt to recognize dates and perform conversion.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_na.strings">na.strings</code></td>
<td>
<p>A character vector of strings which are to be interpreted as <code>NA</code>.
Blank cells will be returned as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_na.numbers">na.numbers</code></td>
<td>
<p>A numeric vector of digits which are to be interpreted as <code>NA</code>.
Blank cells will be returned as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_fill_merged_cells">fill_merged_cells</code></td>
<td>
<p>If <code>TRUE</code>, the value in a merged cell is given to all cells within the merge.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_dims">dims</code></td>
<td>
<p>Character string of type &quot;A1:B2&quot; as optional dimensions to be imported.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_show_formula">show_formula</code></td>
<td>
<p>If <code>TRUE</code>, the underlying Excel formulas are shown.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_convert">convert</code></td>
<td>
<p>If <code>TRUE</code>, a conversion to dates and numerics is attempted.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_types">types</code></td>
<td>
<p>A named numeric indicating, the type of the data.
Names must match the returned data. See <strong>Details</strong> for more.</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_named_region">named_region</code></td>
<td>
<p>Character string with a <code>named_region</code> (defined name or table).
If no sheet is selected, the first appearance will be selected. See <code><a href="#topic+wb_get_named_regions">wb_get_named_regions()</a></code></p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_keep_attributes">keep_attributes</code></td>
<td>
<p>If <code>TRUE</code> additional attributes are returned.
(These are used internally to define a cell type.)</p>
</td></tr>
<tr><td><code id="wb_to_df_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned data frame will have named rows matching the rows of the
worksheet. With <code>col_names = FALSE</code> the returned data frame will have
column names matching the columns of the worksheet. Otherwise the first
row is selected as column name.
</p>
<p>Depending if the R package <code>hms</code> is loaded, <code>wb_to_df()</code> returns
<code>hms</code> variables or string variables in the <code>hh:mm:ss</code> format.
</p>
<p>The <code>types</code> argument must be a named numeric.
</p>

<ul>
<li><p> 0: character
</p>
</li>
<li><p> 1: numeric
</p>
</li>
<li><p> 2: date
</p>
</li>
<li><p> 3: posixt (datetime)
</p>
</li>
<li><p> 4: logical
</p>
</li></ul>

<p><code>wb_to_df()</code> will not pick up formulas added to a workbook object
via <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code>. This is because only the formula is written and left
to be evaluated when the file is opened in a spreadsheet software.
Opening, saving and closing the file in a spreadsheet software will resolve
this.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wb_get_named_regions">wb_get_named_regions()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########################################################################
# numerics, dates, missings, bool and string
example_file &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
wb1 &lt;- wb_load(example_file)

# import workbook
wb_to_df(wb1)

# do not convert first row to column names
wb_to_df(wb1, col_names = FALSE)

# do not try to identify dates in the data
wb_to_df(wb1, detect_dates = FALSE)

# return the underlying Excel formula instead of their values
wb_to_df(wb1, show_formula = TRUE)

# read dimension without colNames
wb_to_df(wb1, dims = "A2:C5", col_names = FALSE)

# read selected cols
wb_to_df(wb1, cols = c("A:B", "G"))

# read selected rows
wb_to_df(wb1, rows = c(2, 4, 6))

# convert characters to numerics and date (logical too?)
wb_to_df(wb1, convert = FALSE)

# erase empty rows from dataset
wb_to_df(wb1, skip_empty_rows = TRUE)

# erase empty columns from dataset
wb_to_df(wb1, skip_empty_cols = TRUE)

# convert first row to rownames
wb_to_df(wb1, sheet = 2, dims = "C6:G9", row_names = TRUE)

# define type of the data.frame
wb_to_df(wb1, cols = c(2, 5), types = c("Var1" = 0, "Var3" = 1))

# start in row 5
wb_to_df(wb1, start_row = 5, col_names = FALSE)

# na string
wb_to_df(wb1, na.strings = "a")

###########################################################################
# Named regions
file_named_region &lt;- system.file("extdata", "namedRegions3.xlsx", package = "openxlsx2")
wb2 &lt;- wb_load(file_named_region)

# read dataset with named_region (returns global first)
wb_to_df(wb2, named_region = "MyRange", col_names = FALSE)

# read named_region from sheet
wb_to_df(wb2, named_region = "MyRange", sheet = 4, col_names = FALSE)

# read_xlsx() and wb_read()
example_file &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
read_xlsx(file = example_file)
df1 &lt;- wb_read(file = example_file, sheet = 1)
df2 &lt;- wb_read(file = example_file, sheet = 1, rows = c(1, 3, 5), cols = 1:3)
</code></pre>

<hr>
<h2 id='wb_update_table'>Update a data table position in a worksheet</h2><span id='topic+wb_update_table'></span>

<h3>Description</h3>

<p>Update the position of a data table, possibly written using <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_update_table(wb, sheet = current_sheet(), dims = "A1", tabname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_update_table_+3A_wb">wb</code></td>
<td>
<p>A workbook</p>
</td></tr>
<tr><td><code id="wb_update_table_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet</p>
</td></tr>
<tr><td><code id="wb_update_table_+3A_dims">dims</code></td>
<td>
<p>Cell range used for new data table.</p>
</td></tr>
<tr><td><code id="wb_update_table_+3A_tabname">tabname</code></td>
<td>
<p>A table name</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Be aware that this function does not alter any filter.
Excluding or adding rows does not make rows appear nor will it hide them.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- wb_workbook()$add_worksheet()$add_data_table(x = mtcars)
wb$update_table(tabname = "Table1", dims = "A1:J4")
</code></pre>

<hr>
<h2 id='wb_workbook'>Create a new Workbook object</h2><span id='topic+wb_workbook'></span>

<h3>Description</h3>

<p>Initialize a <a href="#topic+wbWorkbook">wbWorkbook</a> object. You can set workbook properties as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wb_workbook(
  creator = NULL,
  title = NULL,
  subject = NULL,
  category = NULL,
  datetime_created = Sys.time(),
  theme = NULL,
  keywords = NULL,
  comments = NULL,
  manager = NULL,
  company = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wb_workbook_+3A_creator">creator</code></td>
<td>
<p>Creator of the workbook (your name). Defaults to login username or <code>options("openxlsx2.creator")</code> if set.</p>
</td></tr>
<tr><td><code id="wb_workbook_+3A_title">title</code>, <code id="wb_workbook_+3A_subject">subject</code>, <code id="wb_workbook_+3A_category">category</code>, <code id="wb_workbook_+3A_keywords">keywords</code>, <code id="wb_workbook_+3A_comments">comments</code>, <code id="wb_workbook_+3A_manager">manager</code>, <code id="wb_workbook_+3A_company">company</code></td>
<td>
<p>Workbook property, a string.</p>
</td></tr>
<tr><td><code id="wb_workbook_+3A_datetime_created">datetime_created</code></td>
<td>
<p>The time of the workbook is created</p>
</td></tr>
<tr><td><code id="wb_workbook_+3A_theme">theme</code></td>
<td>
<p>Optional theme identified by string or number.
See <strong>Details</strong> for options.</p>
</td></tr>
<tr><td><code id="wb_workbook_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>theme</code> can be one of
&quot;Atlas&quot;, &quot;Badge&quot;, &quot;Berlin&quot;, &quot;Celestial&quot;, &quot;Crop&quot;, &quot;Depth&quot;, &quot;Droplet&quot;,
&quot;Facet&quot;, &quot;Feathered&quot;, &quot;Gallery&quot;, &quot;Headlines&quot;, &quot;Integral&quot;, &quot;Ion&quot;,
&quot;Ion Boardroom&quot;, &quot;LibreOffice&quot;, &quot;Madison&quot;, &quot;Main Event&quot;, &quot;Mesh&quot;,
&quot;Office 2007 - 2010 Theme&quot;, &quot;Office 2013 - 2022 Theme&quot;, &quot;Office Theme&quot;,
&quot;Old Office Theme&quot;, &quot;Organic&quot;, &quot;Parallax&quot;, &quot;Parcel&quot;, &quot;Retrospect&quot;,
&quot;Savon&quot;, &quot;Slice&quot;, &quot;Vapor Trail&quot;, &quot;View&quot;, &quot;Wisp&quot;, &quot;Wood Type&quot;
</p>


<h3>Value</h3>

<p>A <code>wbWorkbook</code> object
</p>


<h3>See Also</h3>

<p>Other workbook wrappers: 
<code><a href="#topic+base_font-wb">base_font-wb</a></code>,
<code><a href="#topic+col_widths-wb">col_widths-wb</a></code>,
<code><a href="#topic+creators-wb">creators-wb</a></code>,
<code><a href="#topic+grouping-wb">grouping-wb</a></code>,
<code><a href="#topic+row_heights-wb">row_heights-wb</a></code>,
<code><a href="#topic+wb_add_chartsheet">wb_add_chartsheet</a>()</code>,
<code><a href="#topic+wb_add_data">wb_add_data</a>()</code>,
<code><a href="#topic+wb_add_data_table">wb_add_data_table</a>()</code>,
<code><a href="#topic+wb_add_formula">wb_add_formula</a>()</code>,
<code><a href="#topic+wb_add_pivot_table">wb_add_pivot_table</a>()</code>,
<code><a href="#topic+wb_add_slicer">wb_add_slicer</a>()</code>,
<code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a>()</code>,
<code><a href="#topic+wb_base_colors">wb_base_colors</a></code>,
<code><a href="#topic+wb_clone_worksheet">wb_clone_worksheet</a>()</code>,
<code><a href="#topic+wb_copy_cells">wb_copy_cells</a>()</code>,
<code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a>()</code>,
<code><a href="#topic+wb_merge_cells">wb_merge_cells</a>()</code>,
<code><a href="#topic+wb_save">wb_save</a>()</code>,
<code><a href="#topic+wb_set_last_modified_by">wb_set_last_modified_by</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- wb_workbook()

## Set Workbook properties
wb &lt;- wb_workbook(
  creator  = "Me",
  title    = "Expense Report",
  subject  = "Expense Report - 2022 Q1",
  category = "sales"
)
</code></pre>

<hr>
<h2 id='wbWorkbook'>Workbook class</h2><span id='topic+wbWorkbook'></span>

<h3>Description</h3>

<p>This is the class used by <code>openxlsx2</code> to modify workbooks from R.
You can load an existing workbook with <code><a href="#topic+wb_load">wb_load()</a></code> and create a new one with
<code><a href="#topic+wb_workbook">wb_workbook()</a></code>.
</p>
<p>After that, you can modify the <code>wbWorkbook</code> object through two primary methods:
</p>
<p><em>Wrapper Function Method</em>: Utilizes the <code>wb</code> family of functions that support
piping to streamline operations.
</p>
<div class="sourceCode r"><pre>wb &lt;- wb_workbook(creator = "My name here") %&gt;%
  wb_add_worksheet(sheet = "Expenditure", grid_lines = FALSE) %&gt;%
  wb_add_data(x = USPersonalExpenditure, row_names = TRUE)
</pre></div>
<p><em>Chaining Method</em>: Directly modifies the object through a series of chained
function calls.
</p>
<div class="sourceCode r"><pre>wb &lt;- wb_workbook(creator = "My name here")$
  add_worksheet(sheet = "Expenditure", grid_lines = FALSE)$
  add_data(x = USPersonalExpenditure, row_names = TRUE)
</pre></div>
<p>While wrapper functions require explicit assignment of their output to reflect
changes, chained functions inherently modify the input object. Both approaches
are equally supported, offering flexibility to suit user preferences. The
documentation mainly highlights the use of wrapper functions.
</p>
<div class="sourceCode r"><pre># Import workbooks
path &lt;- system.file("extdata/openxlsx2_example.xlsx", package = "openxlsx2")
wb &lt;- wb_load(path)

## or create one yourself
wb &lt;- wb_workbook()
# add a worksheet
wb$add_worksheet("sheet")
# add some data
wb$add_data("sheet", cars)
# Add data with piping in a different location
wb &lt;- wb %&gt;% wb_add_data(x = cars, dims = wb_dims(from_dims = "D4"))
# open it in your default spreadsheet software
if (interactive()) wb$open()
</pre></div>
<p>Note that the documentation is more complete in each of the wrapper functions.
(i.e. <code>?wb_add_data</code> rather than <code>?wbWorkbook</code>).
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>sheet_names</code></dt><dd><p>The names of the sheets</p>
</dd>
<dt><code>calcChain</code></dt><dd><p>calcChain</p>
</dd>
<dt><code>charts</code></dt><dd><p>charts</p>
</dd>
<dt><code>is_chartsheet</code></dt><dd><p>A logical vector identifying if a sheet is a chartsheet.</p>
</dd>
<dt><code>customXml</code></dt><dd><p>customXml</p>
</dd>
<dt><code>connections</code></dt><dd><p>connections</p>
</dd>
<dt><code>ctrlProps</code></dt><dd><p>ctrlProps</p>
</dd>
<dt><code>Content_Types</code></dt><dd><p>Content_Types</p>
</dd>
<dt><code>app</code></dt><dd><p>app</p>
</dd>
<dt><code>core</code></dt><dd><p>The XML core</p>
</dd>
<dt><code>custom</code></dt><dd><p>custom</p>
</dd>
<dt><code>drawings</code></dt><dd><p>drawings</p>
</dd>
<dt><code>drawings_rels</code></dt><dd><p>drawings_rels</p>
</dd>
<dt><code>embeddings</code></dt><dd><p>embeddings</p>
</dd>
<dt><code>externalLinks</code></dt><dd><p>externalLinks</p>
</dd>
<dt><code>externalLinksRels</code></dt><dd><p>externalLinksRels</p>
</dd>
<dt><code>headFoot</code></dt><dd><p>The header and footer</p>
</dd>
<dt><code>media</code></dt><dd><p>media</p>
</dd>
<dt><code>metadata</code></dt><dd><p>contains cell/value metadata imported on load from xl/metadata.xml</p>
</dd>
<dt><code>persons</code></dt><dd><p>Persons of the workbook. to be used with <code><a href="#topic+wb_add_thread">wb_add_thread()</a></code></p>
</dd>
<dt><code>pivotTables</code></dt><dd><p>pivotTables</p>
</dd>
<dt><code>pivotTables.xml.rels</code></dt><dd><p>pivotTables.xml.rels</p>
</dd>
<dt><code>pivotDefinitions</code></dt><dd><p>pivotDefinitions</p>
</dd>
<dt><code>pivotRecords</code></dt><dd><p>pivotRecords</p>
</dd>
<dt><code>pivotDefinitionsRels</code></dt><dd><p>pivotDefinitionsRels</p>
</dd>
<dt><code>queryTables</code></dt><dd><p>queryTables</p>
</dd>
<dt><code>slicers</code></dt><dd><p>slicers</p>
</dd>
<dt><code>slicerCaches</code></dt><dd><p>slicerCaches</p>
</dd>
<dt><code>sharedStrings</code></dt><dd><p>sharedStrings</p>
</dd>
<dt><code>styles_mgr</code></dt><dd><p>styles_mgr</p>
</dd>
<dt><code>tables</code></dt><dd><p>tables</p>
</dd>
<dt><code>tables.xml.rels</code></dt><dd><p>tables.xml.rels</p>
</dd>
<dt><code>theme</code></dt><dd><p>theme</p>
</dd>
<dt><code>vbaProject</code></dt><dd><p>vbaProject</p>
</dd>
<dt><code>vml</code></dt><dd><p>vml</p>
</dd>
<dt><code>vml_rels</code></dt><dd><p>vml_rels</p>
</dd>
<dt><code>comments</code></dt><dd><p>Comments (notes) present in the workbook.</p>
</dd>
<dt><code>threadComments</code></dt><dd><p>Threaded comments</p>
</dd>
<dt><code>workbook</code></dt><dd><p>workbook</p>
</dd>
<dt><code>workbook.xml.rels</code></dt><dd><p>workbook.xml.rels</p>
</dd>
<dt><code>worksheets</code></dt><dd><p>worksheets</p>
</dd>
<dt><code>worksheets_rels</code></dt><dd><p>worksheets_rels</p>
</dd>
<dt><code>sheetOrder</code></dt><dd><p>The sheet order.  Controls ordering for worksheets and
worksheet names.</p>
</dd>
<dt><code>path</code></dt><dd><p>path</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-wbWorkbook-new"><code>wbWorkbook$new()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-append"><code>wbWorkbook$append()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-append_sheets"><code>wbWorkbook$append_sheets()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-validate_sheet"><code>wbWorkbook$validate_sheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_chartsheet"><code>wbWorkbook$add_chartsheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_worksheet"><code>wbWorkbook$add_worksheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-clone_worksheet"><code>wbWorkbook$clone_worksheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_data"><code>wbWorkbook$add_data()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_data_table"><code>wbWorkbook$add_data_table()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_pivot_table"><code>wbWorkbook$add_pivot_table()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_slicer"><code>wbWorkbook$add_slicer()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_formula"><code>wbWorkbook$add_formula()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_style"><code>wbWorkbook$add_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-to_df"><code>wbWorkbook$to_df()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-load"><code>wbWorkbook$load()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-save"><code>wbWorkbook$save()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-open"><code>wbWorkbook$open()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-buildTable"><code>wbWorkbook$buildTable()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-update_table"><code>wbWorkbook$update_table()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-copy_cells"><code>wbWorkbook$copy_cells()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_base_font"><code>wbWorkbook$get_base_font()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_base_font"><code>wbWorkbook$set_base_font()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_base_colors"><code>wbWorkbook$get_base_colors()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_base_colours"><code>wbWorkbook$get_base_colours()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_base_colors"><code>wbWorkbook$set_base_colors()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_base_colours"><code>wbWorkbook$set_base_colours()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_bookview"><code>wbWorkbook$set_bookview()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_sheet_names"><code>wbWorkbook$get_sheet_names()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_sheet_names"><code>wbWorkbook$set_sheet_names()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_row_heights"><code>wbWorkbook$set_row_heights()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_row_heights"><code>wbWorkbook$remove_row_heights()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-createCols"><code>wbWorkbook$createCols()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-group_cols"><code>wbWorkbook$group_cols()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-ungroup_cols"><code>wbWorkbook$ungroup_cols()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_col_widths"><code>wbWorkbook$remove_col_widths()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_col_widths"><code>wbWorkbook$set_col_widths()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-group_rows"><code>wbWorkbook$group_rows()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-ungroup_rows"><code>wbWorkbook$ungroup_rows()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_worksheet"><code>wbWorkbook$remove_worksheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_data_validation"><code>wbWorkbook$add_data_validation()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-merge_cells"><code>wbWorkbook$merge_cells()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-unmerge_cells"><code>wbWorkbook$unmerge_cells()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-freeze_pane"><code>wbWorkbook$freeze_pane()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_comment"><code>wbWorkbook$add_comment()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_comment"><code>wbWorkbook$get_comment()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_comment"><code>wbWorkbook$remove_comment()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_thread"><code>wbWorkbook$add_thread()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_thread"><code>wbWorkbook$get_thread()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_conditional_formatting"><code>wbWorkbook$add_conditional_formatting()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_image"><code>wbWorkbook$add_image()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_plot"><code>wbWorkbook$add_plot()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_drawing"><code>wbWorkbook$add_drawing()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_chart_xml"><code>wbWorkbook$add_chart_xml()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_mschart"><code>wbWorkbook$add_mschart()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_form_control"><code>wbWorkbook$add_form_control()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-print"><code>wbWorkbook$print()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-protect"><code>wbWorkbook$protect()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-protect_worksheet"><code>wbWorkbook$protect_worksheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_properties"><code>wbWorkbook$get_properties()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_properties"><code>wbWorkbook$set_properties()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_creators"><code>wbWorkbook$set_creators()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_creators"><code>wbWorkbook$add_creators()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_creators"><code>wbWorkbook$remove_creators()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_last_modified_by"><code>wbWorkbook$set_last_modified_by()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_page_setup"><code>wbWorkbook$set_page_setup()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-page_setup"><code>wbWorkbook$page_setup()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_header_footer"><code>wbWorkbook$set_header_footer()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_tables"><code>wbWorkbook$get_tables()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_tables"><code>wbWorkbook$remove_tables()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_filter"><code>wbWorkbook$add_filter()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_filter"><code>wbWorkbook$remove_filter()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_grid_lines"><code>wbWorkbook$set_grid_lines()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-grid_lines"><code>wbWorkbook$grid_lines()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_named_region"><code>wbWorkbook$add_named_region()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_named_regions"><code>wbWorkbook$get_named_regions()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-remove_named_region"><code>wbWorkbook$remove_named_region()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_order"><code>wbWorkbook$set_order()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_sheet_visibility"><code>wbWorkbook$get_sheet_visibility()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_sheet_visibility"><code>wbWorkbook$set_sheet_visibility()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_page_break"><code>wbWorkbook$add_page_break()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-clean_sheet"><code>wbWorkbook$clean_sheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_border"><code>wbWorkbook$add_border()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_fill"><code>wbWorkbook$add_fill()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_font"><code>wbWorkbook$add_font()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_numfmt"><code>wbWorkbook$add_numfmt()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_cell_style"><code>wbWorkbook$add_cell_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_cell_style"><code>wbWorkbook$get_cell_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_cell_style"><code>wbWorkbook$set_cell_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_cell_style_across"><code>wbWorkbook$set_cell_style_across()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_named_style"><code>wbWorkbook$add_named_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_dxfs_style"><code>wbWorkbook$add_dxfs_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-clone_sheet_style"><code>wbWorkbook$clone_sheet_style()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_sparklines"><code>wbWorkbook$add_sparklines()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_ignore_error"><code>wbWorkbook$add_ignore_error()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_sheetview"><code>wbWorkbook$set_sheetview()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-add_person"><code>wbWorkbook$add_person()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_person"><code>wbWorkbook$get_person()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_active_sheet"><code>wbWorkbook$get_active_sheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_active_sheet"><code>wbWorkbook$set_active_sheet()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-get_selected"><code>wbWorkbook$get_selected()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-set_selected"><code>wbWorkbook$set_selected()</code></a>
</p>
</li>
<li> <p><a href="#method-wbWorkbook-clone"><code>wbWorkbook$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-wbWorkbook-new"></a>



<h4>Method <code>new()</code></h4>

<p>Creates a new <code>wbWorkbook</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$new(
  creator = NULL,
  title = NULL,
  subject = NULL,
  category = NULL,
  datetime_created = Sys.time(),
  theme = NULL,
  keywords = NULL,
  comments = NULL,
  manager = NULL,
  company = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>creator</code></dt><dd><p>character vector of creators. Duplicated are ignored.</p>
</dd>
<dt><code>title, subject, category, keywords, comments, manager, company</code></dt><dd><p>workbook properties</p>
</dd>
<dt><code>datetime_created</code></dt><dd><p>The datetime (as <code>POSIXt</code>) the workbook is
created.  Defaults to the current <code>Sys.time()</code> when the workbook object
is created, not when the Excel files are saved.</p>
</dd>
<dt><code>theme</code></dt><dd><p>Optional theme identified by string or number</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-append"></a>



<h4>Method <code>append()</code></h4>

<p>Append a field. This method is intended for internal use
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$append(field, value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>field</code></dt><dd><p>A valid field name</p>
</dd>
<dt><code>value</code></dt><dd><p>A value for the field</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-append_sheets"></a>



<h4>Method <code>append_sheets()</code></h4>

<p>Append to <code>self$workbook$sheets</code> This method is intended for internal use
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$append_sheets(value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>value</code></dt><dd><p>A value for <code>self$workbook$sheets</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-validate_sheet"></a>



<h4>Method <code>validate_sheet()</code></h4>

<p>validate sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$validate_sheet(sheet)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>A character sheet name or integer location</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The integer position of the sheet
</p>


<hr>
<a id="method-wbWorkbook-add_chartsheet"></a>



<h4>Method <code>add_chartsheet()</code></h4>

<p>Add a chart sheet to the workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_chartsheet(
  sheet = next_sheet(),
  tab_color = NULL,
  zoom = 100,
  visible = c("true", "false", "hidden", "visible", "veryhidden"),
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>tab_color</code></dt><dd><p>tab_color</p>
</dd>
<dt><code>zoom</code></dt><dd><p>zoom</p>
</dd>
<dt><code>visible</code></dt><dd><p>visible</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_worksheet"></a>



<h4>Method <code>add_worksheet()</code></h4>

<p>Add worksheet to the <code>wbWorkbook</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_worksheet(
  sheet = next_sheet(),
  grid_lines = TRUE,
  row_col_headers = TRUE,
  tab_color = NULL,
  zoom = 100,
  header = NULL,
  footer = NULL,
  odd_header = header,
  odd_footer = footer,
  even_header = header,
  even_footer = footer,
  first_header = header,
  first_footer = footer,
  visible = c("true", "false", "hidden", "visible", "veryhidden"),
  has_drawing = FALSE,
  paper_size = getOption("openxlsx2.paperSize", default = 9),
  orientation = getOption("openxlsx2.orientation", default = "portrait"),
  hdpi = getOption("openxlsx2.hdpi", default = getOption("openxlsx2.dpi", default = 300)),
  vdpi = getOption("openxlsx2.vdpi", default = getOption("openxlsx2.dpi", default = 300)),
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>grid_lines</code></dt><dd><p>gridLines</p>
</dd>
<dt><code>row_col_headers</code></dt><dd><p>rowColHeaders</p>
</dd>
<dt><code>tab_color</code></dt><dd><p>tabColor</p>
</dd>
<dt><code>zoom</code></dt><dd><p>zoom</p>
</dd>
<dt><code>header</code></dt><dd><p>header</p>
</dd>
<dt><code>footer</code></dt><dd><p>footer</p>
</dd>
<dt><code>odd_header</code></dt><dd><p>oddHeader</p>
</dd>
<dt><code>odd_footer</code></dt><dd><p>oddFooter</p>
</dd>
<dt><code>even_header</code></dt><dd><p>evenHeader</p>
</dd>
<dt><code>even_footer</code></dt><dd><p>evenFooter</p>
</dd>
<dt><code>first_header</code></dt><dd><p>firstHeader</p>
</dd>
<dt><code>first_footer</code></dt><dd><p>firstFooter</p>
</dd>
<dt><code>visible</code></dt><dd><p>visible</p>
</dd>
<dt><code>has_drawing</code></dt><dd><p>hasDrawing</p>
</dd>
<dt><code>paper_size</code></dt><dd><p>paperSize</p>
</dd>
<dt><code>orientation</code></dt><dd><p>orientation</p>
</dd>
<dt><code>hdpi</code></dt><dd><p>hdpi</p>
</dd>
<dt><code>vdpi</code></dt><dd><p>vdpi</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-clone_worksheet"></a>



<h4>Method <code>clone_worksheet()</code></h4>

<p>Clone a workbooksheet to another workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$clone_worksheet(
  old = current_sheet(),
  new = next_sheet(),
  from = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>old</code></dt><dd><p>name of worksheet to clone</p>
</dd>
<dt><code>new</code></dt><dd><p>name of new worksheet to add</p>
</dd>
<dt><code>from</code></dt><dd><p>name of new worksheet to add</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-add_data"></a>



<h4>Method <code>add_data()</code></h4>

<p>add data
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_data(
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  col_names = TRUE,
  row_names = FALSE,
  with_filter = FALSE,
  name = NULL,
  sep = ", ",
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>x</code></dt><dd><p>x</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>start_col</code></dt><dd><p>startCol</p>
</dd>
<dt><code>start_row</code></dt><dd><p>startRow</p>
</dd>
<dt><code>array</code></dt><dd><p>array</p>
</dd>
<dt><code>col_names</code></dt><dd><p>colNames</p>
</dd>
<dt><code>row_names</code></dt><dd><p>rowNames</p>
</dd>
<dt><code>with_filter</code></dt><dd><p>withFilter</p>
</dd>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
<dt><code>sep</code></dt><dd><p>sep</p>
</dd>
<dt><code>apply_cell_style</code></dt><dd><p>applyCellStyle</p>
</dd>
<dt><code>remove_cell_style</code></dt><dd><p>if writing into existing cells, should the cell style be removed?</p>
</dd>
<dt><code>na.strings</code></dt><dd><p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
<code>na_strings()</code> uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</dd>
<dt><code>inline_strings</code></dt><dd><p>write characters as inline strings</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
<dt><code>return</code></dt><dd><p>The <code>wbWorkbook</code> object</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-add_data_table"></a>



<h4>Method <code>add_data_table()</code></h4>

<p>add a data table
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_data_table(
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  col_names = TRUE,
  row_names = FALSE,
  table_style = "TableStyleLight9",
  table_name = NULL,
  with_filter = TRUE,
  sep = ", ",
  first_column = FALSE,
  last_column = FALSE,
  banded_rows = TRUE,
  banded_cols = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  total_row = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>x</code></dt><dd><p>x</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>start_col</code></dt><dd><p>startCol</p>
</dd>
<dt><code>start_row</code></dt><dd><p>startRow</p>
</dd>
<dt><code>col_names</code></dt><dd><p>colNames</p>
</dd>
<dt><code>row_names</code></dt><dd><p>rowNames</p>
</dd>
<dt><code>table_style</code></dt><dd><p>tableStyle</p>
</dd>
<dt><code>table_name</code></dt><dd><p>tableName</p>
</dd>
<dt><code>with_filter</code></dt><dd><p>withFilter</p>
</dd>
<dt><code>sep</code></dt><dd><p>sep</p>
</dd>
<dt><code>first_column</code></dt><dd><p>firstColumn</p>
</dd>
<dt><code>last_column</code></dt><dd><p>lastColumn</p>
</dd>
<dt><code>banded_rows</code></dt><dd><p>bandedRows</p>
</dd>
<dt><code>banded_cols</code></dt><dd><p>bandedCols</p>
</dd>
<dt><code>apply_cell_style</code></dt><dd><p>applyCellStyle</p>
</dd>
<dt><code>remove_cell_style</code></dt><dd><p>if writing into existing cells, should the cell style be removed?</p>
</dd>
<dt><code>na.strings</code></dt><dd><p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
<code>na_strings()</code> uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</dd>
<dt><code>inline_strings</code></dt><dd><p>write characters as inline strings</p>
</dd>
<dt><code>total_row</code></dt><dd><p>write total rows to table</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_pivot_table"></a>



<h4>Method <code>add_pivot_table()</code></h4>

<p>add pivot table
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_pivot_table(
  x,
  sheet = next_sheet(),
  dims = "A3",
  filter,
  rows,
  cols,
  data,
  fun,
  params,
  pivot_table,
  slicer
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>a wb_data object</p>
</dd>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>the worksheet cell where the pivot table is placed</p>
</dd>
<dt><code>filter</code></dt><dd><p>a character object with names used to filter</p>
</dd>
<dt><code>rows</code></dt><dd><p>a character object with names used as rows</p>
</dd>
<dt><code>cols</code></dt><dd><p>a character object with names used as cols</p>
</dd>
<dt><code>data</code></dt><dd><p>a character object with names used as data</p>
</dd>
<dt><code>fun</code></dt><dd><p>a character object of functions to be used with the data</p>
</dd>
<dt><code>params</code></dt><dd><p>a list of parameters to modify pivot table creation</p>
</dd>
<dt><code>pivot_table</code></dt><dd><p>a character object with a name for the pivot table</p>
</dd>
<dt><code>slicer</code></dt><dd><p>a character object with names used as slicer</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p><code>fun</code> can be either of AVERAGE, COUNT, COUNTA, MAX, MIN, PRODUCT, STDEV,
STDEVP, SUM, VAR, VARP
</p>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_slicer"></a>



<h4>Method <code>add_slicer()</code></h4>

<p>add pivot table
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_slicer(
  x,
  dims = "A1",
  sheet = current_sheet(),
  pivot_table,
  slicer,
  params
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>a wb_data object</p>
</dd>
<dt><code>dims</code></dt><dd><p>the worksheet cell where the pivot table is placed</p>
</dd>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>pivot_table</code></dt><dd><p>the name of a pivot table on the selected sheet</p>
</dd>
<dt><code>slicer</code></dt><dd><p>a variable used as slicer for the pivot table</p>
</dd>
<dt><code>params</code></dt><dd><p>a list of parameters to modify pivot table creation</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_formula"></a>



<h4>Method <code>add_formula()</code></h4>

<p>Add formula
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_formula(
  sheet = current_sheet(),
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  cm = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>x</code></dt><dd><p>x</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>start_col</code></dt><dd><p>startCol</p>
</dd>
<dt><code>start_row</code></dt><dd><p>startRow</p>
</dd>
<dt><code>array</code></dt><dd><p>array</p>
</dd>
<dt><code>cm</code></dt><dd><p>cm</p>
</dd>
<dt><code>apply_cell_style</code></dt><dd><p>applyCellStyle</p>
</dd>
<dt><code>remove_cell_style</code></dt><dd><p>if writing into existing cells, should the cell style be removed?</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_style"></a>



<h4>Method <code>add_style()</code></h4>

<p>add style
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_style(style = NULL, style_name = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>style</code></dt><dd><p>style</p>
</dd>
<dt><code>style_name</code></dt><dd><p>style_name</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-to_df"></a>



<h4>Method <code>to_df()</code></h4>

<p>to_df
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$to_df(
  sheet,
  start_row = 1,
  start_col = NULL,
  row_names = FALSE,
  col_names = TRUE,
  skip_empty_rows = FALSE,
  skip_empty_cols = FALSE,
  skip_hidden_rows = FALSE,
  skip_hidden_cols = FALSE,
  rows = NULL,
  cols = NULL,
  detect_dates = TRUE,
  na.strings = "#N/A",
  na.numbers = NA,
  fill_merged_cells = FALSE,
  dims,
  show_formula = FALSE,
  convert = TRUE,
  types,
  named_region,
  keep_attributes = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>Either sheet name or index. When missing the first sheet in the workbook is selected.</p>
</dd>
<dt><code>start_row</code></dt><dd><p>first row to begin looking for data.</p>
</dd>
<dt><code>start_col</code></dt><dd><p>first column to begin looking for data.</p>
</dd>
<dt><code>row_names</code></dt><dd><p>If TRUE, the first col of data will be used as row names.</p>
</dd>
<dt><code>col_names</code></dt><dd><p>If TRUE, the first row of data will be used as column names.</p>
</dd>
<dt><code>skip_empty_rows</code></dt><dd><p>If TRUE, empty rows are skipped.</p>
</dd>
<dt><code>skip_empty_cols</code></dt><dd><p>If TRUE, empty columns are skipped.</p>
</dd>
<dt><code>skip_hidden_rows</code></dt><dd><p>If TRUE, hidden rows are skipped.</p>
</dd>
<dt><code>skip_hidden_cols</code></dt><dd><p>If TRUE, hidden columns are skipped.</p>
</dd>
<dt><code>rows</code></dt><dd><p>A numeric vector specifying which rows in the Excel file to read. If NULL, all rows are read.</p>
</dd>
<dt><code>cols</code></dt><dd><p>A numeric vector specifying which columns in the Excel file to read. If NULL, all columns are read.</p>
</dd>
<dt><code>detect_dates</code></dt><dd><p>If TRUE, attempt to recognize dates and perform conversion.</p>
</dd>
<dt><code>na.strings</code></dt><dd><p>A character vector of strings which are to be interpreted as NA. Blank cells will be returned as NA.</p>
</dd>
<dt><code>na.numbers</code></dt><dd><p>A numeric vector of digits which are to be interpreted as NA. Blank cells will be returned as NA.</p>
</dd>
<dt><code>fill_merged_cells</code></dt><dd><p>If TRUE, the value in a merged cell is given to all cells within the merge.</p>
</dd>
<dt><code>dims</code></dt><dd><p>Character string of type &quot;A1:B2&quot; as optional dimensions to be imported.</p>
</dd>
<dt><code>show_formula</code></dt><dd><p>If TRUE, the underlying Excel formulas are shown.</p>
</dd>
<dt><code>convert</code></dt><dd><p>If TRUE, a conversion to dates and numerics is attempted.</p>
</dd>
<dt><code>types</code></dt><dd><p>A named numeric indicating, the type of the data. 0: character, 1: numeric, 2: date, 3: posixt, 4:logical. Names must match the returned data</p>
</dd>
<dt><code>named_region</code></dt><dd><p>Character string with a named_region (defined name or table). If no sheet is selected, the first appearance will be selected.</p>
</dd>
<dt><code>keep_attributes</code></dt><dd><p>If TRUE additional attributes are returned. (These are used internally to define a cell type.)</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a data frame
</p>


<hr>
<a id="method-wbWorkbook-load"></a>



<h4>Method <code>load()</code></h4>

<p>load workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$load(file, sheet, data_only = FALSE, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>file</code></dt><dd><p>file</p>
</dd>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>data_only</code></dt><dd><p>data_only</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object invisibly
</p>


<hr>
<a id="method-wbWorkbook-save"></a>



<h4>Method <code>save()</code></h4>

<p>Save the workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$save(file = self$path, overwrite = TRUE, path = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>file</code></dt><dd><p>The path to save the workbook to</p>
</dd>
<dt><code>overwrite</code></dt><dd><p>If <code>FALSE</code>, will not overwrite when <code>path</code> exists</p>
</dd>
<dt><code>path</code></dt><dd><p>Deprecated argument previously used for file. Please use file in new code.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object invisibly
</p>


<hr>
<a id="method-wbWorkbook-open"></a>



<h4>Method <code>open()</code></h4>

<p>open wbWorkbook in Excel.
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$open(interactive = NA)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>interactive</code></dt><dd><p>If <code>FALSE</code> will throw a warning and not open the path.
This can be manually set to <code>TRUE</code>, otherwise when <code>NA</code> (default) uses
the value returned from <code><a href="base.html#topic+interactive">base::interactive()</a></code></p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>minor helper wrapping xl_open which does the entire same thing
</p>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-buildTable"></a>



<h4>Method <code>buildTable()</code></h4>

<p>Build table
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$buildTable(
  sheet = current_sheet(),
  colNames,
  ref,
  showColNames,
  tableStyle,
  tableName,
  withFilter = TRUE,
  totalsRowCount = 0,
  totalLabel = FALSE,
  showFirstColumn = 0,
  showLastColumn = 0,
  showRowStripes = 1,
  showColumnStripes = 0
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>colNames</code></dt><dd><p>colNames</p>
</dd>
<dt><code>ref</code></dt><dd><p>ref</p>
</dd>
<dt><code>showColNames</code></dt><dd><p>showColNames</p>
</dd>
<dt><code>tableStyle</code></dt><dd><p>tableStyle</p>
</dd>
<dt><code>tableName</code></dt><dd><p>tableName</p>
</dd>
<dt><code>withFilter</code></dt><dd><p>withFilter</p>
</dd>
<dt><code>totalsRowCount</code></dt><dd><p>totalsRowCount</p>
</dd>
<dt><code>totalLabel</code></dt><dd><p>totalLabel</p>
</dd>
<dt><code>showFirstColumn</code></dt><dd><p>showFirstColumn</p>
</dd>
<dt><code>showLastColumn</code></dt><dd><p>showLastColumn</p>
</dd>
<dt><code>showRowStripes</code></dt><dd><p>showRowStripes</p>
</dd>
<dt><code>showColumnStripes</code></dt><dd><p>showColumnStripes</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheet</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-update_table"></a>



<h4>Method <code>update_table()</code></h4>

<p>update a data_table
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$update_table(sheet = current_sheet(), dims = "A1", tabname)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>tabname</code></dt><dd><p>a tablename</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheet</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-copy_cells"></a>



<h4>Method <code>copy_cells()</code></h4>

<p>copy cells around in a workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$copy_cells(
  sheet = current_sheet(),
  dims = "A1",
  data,
  as_value = FALSE,
  as_ref = FALSE,
  transpose = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>data</code></dt><dd><p>a wb_data object</p>
</dd>
<dt><code>as_value</code></dt><dd><p>should a copy of the value be written</p>
</dd>
<dt><code>as_ref</code></dt><dd><p>should references to the cell be written</p>
</dd>
<dt><code>transpose</code></dt><dd><p>should the data be written transposed</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments passed to add_data() if used with <code>as_value</code></p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheet</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-get_base_font"></a>



<h4>Method <code>get_base_font()</code></h4>

<p>Get the base font
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_base_font()</pre></div>



<h5>Returns</h5>

<p>A list of of the font
</p>


<hr>
<a id="method-wbWorkbook-set_base_font"></a>



<h4>Method <code>set_base_font()</code></h4>

<p>Set the base font
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_base_font(
  font_size = 11,
  font_color = wb_color(theme = "1"),
  font_name = "Aptos Narrow",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>font_size</code></dt><dd><p>fontSize</p>
</dd>
<dt><code>font_color</code></dt><dd><p>font_color</p>
</dd>
<dt><code>font_name</code></dt><dd><p>font_name</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_base_colors"></a>



<h4>Method <code>get_base_colors()</code></h4>

<p>Get the base color
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_base_colors(xml = FALSE, plot = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>xml</code></dt><dd><p>xml</p>
</dd>
<dt><code>plot</code></dt><dd><p>plot</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-get_base_colours"></a>



<h4>Method <code>get_base_colours()</code></h4>

<p>Get the base colour
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_base_colours(xml = FALSE, plot = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>xml</code></dt><dd><p>xml</p>
</dd>
<dt><code>plot</code></dt><dd><p>plot</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-set_base_colors"></a>



<h4>Method <code>set_base_colors()</code></h4>

<p>Set the base color
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_base_colors(theme = "Office", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>theme</code></dt><dd><p>theme</p>
</dd>
<dt><code>...</code></dt><dd><p>...</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-set_base_colours"></a>



<h4>Method <code>set_base_colours()</code></h4>

<p>Set the base colour
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_base_colours(theme = "Office", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>theme</code></dt><dd><p>theme</p>
</dd>
<dt><code>...</code></dt><dd><p>...</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-set_bookview"></a>



<h4>Method <code>set_bookview()</code></h4>

<p>Set the book views
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_bookview(
  active_tab = NULL,
  auto_filter_date_grouping = NULL,
  first_sheet = NULL,
  minimized = NULL,
  show_horizontal_scroll = NULL,
  show_sheet_tabs = NULL,
  show_vertical_scroll = NULL,
  tab_ratio = NULL,
  visibility = NULL,
  window_height = NULL,
  window_width = NULL,
  x_window = NULL,
  y_window = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>active_tab</code></dt><dd><p>activeTab</p>
</dd>
<dt><code>auto_filter_date_grouping</code></dt><dd><p>autoFilterDateGrouping</p>
</dd>
<dt><code>first_sheet</code></dt><dd><p>firstSheet</p>
</dd>
<dt><code>minimized</code></dt><dd><p>minimized</p>
</dd>
<dt><code>show_horizontal_scroll</code></dt><dd><p>showHorizontalScroll</p>
</dd>
<dt><code>show_sheet_tabs</code></dt><dd><p>showSheetTabs</p>
</dd>
<dt><code>show_vertical_scroll</code></dt><dd><p>showVerticalScroll</p>
</dd>
<dt><code>tab_ratio</code></dt><dd><p>tabRatio</p>
</dd>
<dt><code>visibility</code></dt><dd><p>visibility</p>
</dd>
<dt><code>window_height</code></dt><dd><p>windowHeight</p>
</dd>
<dt><code>window_width</code></dt><dd><p>windowWidth</p>
</dd>
<dt><code>x_window</code></dt><dd><p>xWindow</p>
</dd>
<dt><code>y_window</code></dt><dd><p>yWindow</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_sheet_names"></a>



<h4>Method <code>get_sheet_names()</code></h4>

<p>Get sheet names
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_sheet_names(escape = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>escape</code></dt><dd><p>Logical if the xml special characters are escaped</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>named</code> <code>character</code> vector of sheet names in their order.  The
names represent the original value of the worksheet prior to any
character substitutions.
</p>


<hr>
<a id="method-wbWorkbook-set_sheet_names"></a>



<h4>Method <code>set_sheet_names()</code></h4>

<p>Sets a sheet name
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_sheet_names(old = NULL, new)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>old</code></dt><dd><p>Old sheet name</p>
</dd>
<dt><code>new</code></dt><dd><p>New sheet name</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-set_row_heights"></a>



<h4>Method <code>set_row_heights()</code></h4>

<p>Sets a row height for a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_row_heights(
  sheet = current_sheet(),
  rows,
  heights = NULL,
  hidden = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
<dt><code>heights</code></dt><dd><p>heights</p>
</dd>
<dt><code>hidden</code></dt><dd><p>hidden</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-remove_row_heights"></a>



<h4>Method <code>remove_row_heights()</code></h4>

<p>Removes a row height for a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_row_heights(sheet = current_sheet(), rows)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-createCols"></a>



<h4>Method <code>createCols()</code></h4>

<p>creates column object for worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$createCols(sheet = current_sheet(), n, beg, end)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>n</code></dt><dd><p>n</p>
</dd>
<dt><code>beg</code></dt><dd><p>beg</p>
</dd>
<dt><code>end</code></dt><dd><p>end</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-group_cols"></a>



<h4>Method <code>group_cols()</code></h4>

<p>Group cols
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$group_cols(
  sheet = current_sheet(),
  cols,
  collapsed = FALSE,
  levels = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>cols</code></dt><dd><p>cols</p>
</dd>
<dt><code>collapsed</code></dt><dd><p>collapsed</p>
</dd>
<dt><code>levels</code></dt><dd><p>levels</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-ungroup_cols"></a>



<h4>Method <code>ungroup_cols()</code></h4>

<p>ungroup cols
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$ungroup_cols(sheet = current_sheet(), cols)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>cols</code></dt><dd><p>columns</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-remove_col_widths"></a>



<h4>Method <code>remove_col_widths()</code></h4>

<p>Remove row heights from a worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_col_widths(sheet = current_sheet(), cols)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>A name or index of a worksheet</p>
</dd>
<dt><code>cols</code></dt><dd><p>Indices of columns to remove custom width (if any) from.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-set_col_widths"></a>



<h4>Method <code>set_col_widths()</code></h4>

<p>Set column widths
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_col_widths(
  sheet = current_sheet(),
  cols,
  widths = 8.43,
  hidden = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>cols</code></dt><dd><p>cols</p>
</dd>
<dt><code>widths</code></dt><dd><p>Width of columns</p>
</dd>
<dt><code>hidden</code></dt><dd><p>A logical vector to determine which cols are hidden; values
are repeated across length of <code>cols</code></p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-group_rows"></a>



<h4>Method <code>group_rows()</code></h4>

<p>Group rows
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$group_rows(
  sheet = current_sheet(),
  rows,
  collapsed = FALSE,
  levels = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
<dt><code>collapsed</code></dt><dd><p>collapsed</p>
</dd>
<dt><code>levels</code></dt><dd><p>levels</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-ungroup_rows"></a>



<h4>Method <code>ungroup_rows()</code></h4>

<p>ungroup rows
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$ungroup_rows(sheet = current_sheet(), rows)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-remove_worksheet"></a>



<h4>Method <code>remove_worksheet()</code></h4>

<p>Remove a worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_worksheet(sheet = current_sheet())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The worksheet to delete</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_data_validation"></a>



<h4>Method <code>add_data_validation()</code></h4>

<p>Adds data validation
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_data_validation(
  sheet = current_sheet(),
  dims = "A1",
  type,
  operator,
  value,
  allow_blank = TRUE,
  show_input_msg = TRUE,
  show_error_msg = TRUE,
  error_style = NULL,
  error_title = NULL,
  error = NULL,
  prompt_title = NULL,
  prompt = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>type</code></dt><dd><p>type</p>
</dd>
<dt><code>operator</code></dt><dd><p>operator</p>
</dd>
<dt><code>value</code></dt><dd><p>value</p>
</dd>
<dt><code>allow_blank</code></dt><dd><p>allowBlank</p>
</dd>
<dt><code>show_input_msg</code></dt><dd><p>showInputMsg</p>
</dd>
<dt><code>show_error_msg</code></dt><dd><p>showErrorMsg</p>
</dd>
<dt><code>error_style</code></dt><dd><p>The icon shown and the options how to deal with such inputs. Default &quot;stop&quot; (cancel), else &quot;information&quot; (prompt popup) or &quot;warning&quot; (prompt accept or change input)</p>
</dd>
<dt><code>error_title</code></dt><dd><p>The error title</p>
</dd>
<dt><code>error</code></dt><dd><p>The error text</p>
</dd>
<dt><code>prompt_title</code></dt><dd><p>The prompt title</p>
</dd>
<dt><code>prompt</code></dt><dd><p>The prompt text</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-merge_cells"></a>



<h4>Method <code>merge_cells()</code></h4>

<p>Set cell merging for a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$merge_cells(
  sheet = current_sheet(),
  dims = NULL,
  solve = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>solve</code></dt><dd><p>logical if intersecting cells should be solved</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-unmerge_cells"></a>



<h4>Method <code>unmerge_cells()</code></h4>

<p>Removes cell merging for a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$unmerge_cells(sheet = current_sheet(), dims = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-freeze_pane"></a>



<h4>Method <code>freeze_pane()</code></h4>

<p>Set freeze panes for a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$freeze_pane(
  sheet = current_sheet(),
  first_active_row = NULL,
  first_active_col = NULL,
  first_row = FALSE,
  first_col = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>first_active_row</code></dt><dd><p>first_active_row</p>
</dd>
<dt><code>first_active_col</code></dt><dd><p>first_active_col</p>
</dd>
<dt><code>first_row</code></dt><dd><p>first_row</p>
</dd>
<dt><code>first_col</code></dt><dd><p>first_col</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_comment"></a>



<h4>Method <code>add_comment()</code></h4>

<p>Add comment
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_comment(sheet = current_sheet(), dims = "A1", comment, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>row and column as spreadsheet dimension, e.g. &quot;A1&quot;</p>
</dd>
<dt><code>comment</code></dt><dd><p>a comment to apply to the worksheet</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_comment"></a>



<h4>Method <code>get_comment()</code></h4>

<p>Get comments
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_comment(sheet = current_sheet(), dims = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>dims</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A data frame containing comments
</p>


<hr>
<a id="method-wbWorkbook-remove_comment"></a>



<h4>Method <code>remove_comment()</code></h4>

<p>Remove comment
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_comment(sheet = current_sheet(), dims = "A1", ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>row and column as spreadsheet dimension, e.g. &quot;A1&quot;</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_thread"></a>



<h4>Method <code>add_thread()</code></h4>

<p>add threaded comment to worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_thread(
  sheet = current_sheet(),
  dims = "A1",
  comment = NULL,
  person_id,
  reply = FALSE,
  resolve = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>comment</code></dt><dd><p>the comment to add</p>
</dd>
<dt><code>person_id</code></dt><dd><p>the person Id this should be added for</p>
</dd>
<dt><code>reply</code></dt><dd><p>logical if the comment is a reply</p>
</dd>
<dt><code>resolve</code></dt><dd><p>logical if the comment should be marked as resolved</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-get_thread"></a>



<h4>Method <code>get_thread()</code></h4>

<p>Get threads
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_thread(sheet = current_sheet(), dims = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>dims</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A data frame containing threads
</p>


<hr>
<a id="method-wbWorkbook-add_conditional_formatting"></a>



<h4>Method <code>add_conditional_formatting()</code></h4>

<p>Add conditional formatting
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_conditional_formatting(
  sheet = current_sheet(),
  dims = NULL,
  rule = NULL,
  style = NULL,
  type = c("expression", "colorScale", "dataBar", "iconSet", "duplicatedValues",
    "uniqueValues", "containsErrors", "notContainsErrors", "containsBlanks",
    "notContainsBlanks", "containsText", "notContainsText", "beginsWith", "endsWith",
    "between", "topN", "bottomN"),
  params = list(showValue = TRUE, gradient = TRUE, border = TRUE, percent = FALSE, rank =
    5L),
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>rule</code></dt><dd><p>rule</p>
</dd>
<dt><code>style</code></dt><dd><p>style</p>
</dd>
<dt><code>type</code></dt><dd><p>type</p>
</dd>
<dt><code>params</code></dt><dd><p>Additional parameters</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_image"></a>



<h4>Method <code>add_image()</code></h4>

<p>Insert an image into a sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_image(
  sheet = current_sheet(),
  dims = "A1",
  file,
  width = 6,
  height = 3,
  row_offset = 0,
  col_offset = 0,
  units = "in",
  dpi = 300,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>file</code></dt><dd><p>file</p>
</dd>
<dt><code>width</code></dt><dd><p>width</p>
</dd>
<dt><code>height</code></dt><dd><p>height</p>
</dd>
<dt><code>row_offset, col_offset</code></dt><dd><p>offsets</p>
</dd>
<dt><code>units</code></dt><dd><p>units</p>
</dd>
<dt><code>dpi</code></dt><dd><p>dpi</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_plot"></a>



<h4>Method <code>add_plot()</code></h4>

<p>Add plot. A wrapper for add_image()
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_plot(
  sheet = current_sheet(),
  dims = "A1",
  width = 6,
  height = 4,
  row_offset = 0,
  col_offset = 0,
  file_type = "png",
  units = "in",
  dpi = 300,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>width</code></dt><dd><p>width</p>
</dd>
<dt><code>height</code></dt><dd><p>height</p>
</dd>
<dt><code>row_offset, col_offset</code></dt><dd><p>offsets</p>
</dd>
<dt><code>file_type</code></dt><dd><p>fileType</p>
</dd>
<dt><code>units</code></dt><dd><p>units</p>
</dd>
<dt><code>dpi</code></dt><dd><p>dpi</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_drawing"></a>



<h4>Method <code>add_drawing()</code></h4>

<p>Add xml drawing
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_drawing(
  sheet = current_sheet(),
  dims = "A1",
  xml,
  col_offset = 0,
  row_offset = 0,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>xml</code></dt><dd><p>xml</p>
</dd>
<dt><code>col_offset, row_offset</code></dt><dd><p>offsets for column and row</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_chart_xml"></a>



<h4>Method <code>add_chart_xml()</code></h4>

<p>Add xml chart
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_chart_xml(
  sheet = current_sheet(),
  dims = NULL,
  xml,
  col_offset = 0,
  row_offset = 0,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>xml</code></dt><dd><p>xml</p>
</dd>
<dt><code>col_offset, row_offset</code></dt><dd><p>positioning parameters</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_mschart"></a>



<h4>Method <code>add_mschart()</code></h4>

<p>Add mschart chart to the workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_mschart(
  sheet = current_sheet(),
  dims = NULL,
  graph,
  col_offset = 0,
  row_offset = 0,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>the dimensions where the sheet will appear</p>
</dd>
<dt><code>graph</code></dt><dd><p>mschart graph</p>
</dd>
<dt><code>col_offset, row_offset</code></dt><dd><p>offsets for column and row</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_form_control"></a>



<h4>Method <code>add_form_control()</code></h4>

<p>Add form control to workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_form_control(
  sheet = current_sheet(),
  dims = "A1",
  type = c("Checkbox", "Radio", "Drop"),
  text = NULL,
  link = NULL,
  range = NULL,
  checked = FALSE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>type</code></dt><dd><p>type</p>
</dd>
<dt><code>text</code></dt><dd><p>text</p>
</dd>
<dt><code>link</code></dt><dd><p>link</p>
</dd>
<dt><code>range</code></dt><dd><p>range</p>
</dd>
<dt><code>checked</code></dt><dd><p>checked</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-print"></a>



<h4>Method <code>print()</code></h4>

<p>Prints the <code>wbWorkbook</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$print()</pre></div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly; called for its side-effects
</p>


<hr>
<a id="method-wbWorkbook-protect"></a>



<h4>Method <code>protect()</code></h4>

<p>Protect a workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$protect(
  protect = TRUE,
  password = NULL,
  lock_structure = FALSE,
  lock_windows = FALSE,
  type = 1,
  file_sharing = FALSE,
  username = unname(Sys.info()["user"]),
  read_only_recommended = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>protect</code></dt><dd><p>protect</p>
</dd>
<dt><code>password</code></dt><dd><p>password</p>
</dd>
<dt><code>lock_structure</code></dt><dd><p>lock_structure</p>
</dd>
<dt><code>lock_windows</code></dt><dd><p>lock_windows</p>
</dd>
<dt><code>type</code></dt><dd><p>type</p>
</dd>
<dt><code>file_sharing</code></dt><dd><p>file_sharing</p>
</dd>
<dt><code>username</code></dt><dd><p>username</p>
</dd>
<dt><code>read_only_recommended</code></dt><dd><p>read_only_recommended</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-protect_worksheet"></a>



<h4>Method <code>protect_worksheet()</code></h4>

<p>protect worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$protect_worksheet(
  sheet = current_sheet(),
  protect = TRUE,
  password = NULL,
  properties = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>protect</code></dt><dd><p>protect</p>
</dd>
<dt><code>password</code></dt><dd><p>password</p>
</dd>
<dt><code>properties</code></dt><dd><p>A character vector of properties to lock.  Can be one
or more of the following: <code>"selectLockedCells"</code>,
<code>"selectUnlockedCells"</code>, <code>"formatCells"</code>, <code>"formatColumns"</code>,
<code>"formatRows"</code>, <code>"insertColumns"</code>, <code>"insertRows"</code>,
<code>"insertHyperlinks"</code>, <code>"deleteColumns"</code>, <code>"deleteRows"</code>, <code>"sort"</code>,
<code>"autoFilter"</code>, <code>"pivotTables"</code>, <code>"objects"</code>, <code>"scenarios"</code></p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_properties"></a>



<h4>Method <code>get_properties()</code></h4>

<p>Get properties of a workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_properties()</pre></div>


<hr>
<a id="method-wbWorkbook-set_properties"></a>



<h4>Method <code>set_properties()</code></h4>

<p>Set a property of a workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_properties(
  creator = NULL,
  title = NULL,
  subject = NULL,
  category = NULL,
  datetime_created = Sys.time(),
  modifier = NULL,
  keywords = NULL,
  comments = NULL,
  manager = NULL,
  company = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>creator</code></dt><dd><p>character vector of creators. Duplicated are ignored.</p>
</dd>
<dt><code>title, subject, category, datetime_created, modifier, keywords, comments, manager, company</code></dt><dd><p>A workbook property to set</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-set_creators"></a>



<h4>Method <code>set_creators()</code></h4>

<p>Set creator(s)
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_creators(creators)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>creators</code></dt><dd><p>A character vector of creators to set.  Duplicates are
ignored.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-add_creators"></a>



<h4>Method <code>add_creators()</code></h4>

<p>Add creator(s)
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_creators(creators)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>creators</code></dt><dd><p>A character vector of creators to add.  Duplicates are
ignored.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-remove_creators"></a>



<h4>Method <code>remove_creators()</code></h4>

<p>Remove creator(s)
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_creators(creators)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>creators</code></dt><dd><p>A character vector of creators to remove.  All duplicated
are removed.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-set_last_modified_by"></a>



<h4>Method <code>set_last_modified_by()</code></h4>

<p>Change the last modified by
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_last_modified_by(name, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>A new value</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-set_page_setup"></a>



<h4>Method <code>set_page_setup()</code></h4>

<p>set_page_setup() this function is intended to supersede page_setup(), but is not yet stable
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_page_setup(
  sheet = current_sheet(),
  black_and_white = NULL,
  cell_comments = NULL,
  copies = NULL,
  draft = NULL,
  errors = NULL,
  first_page_number = NULL,
  id = NULL,
  page_order = NULL,
  paper_height = NULL,
  paper_width = NULL,
  hdpi = NULL,
  vdpi = NULL,
  use_first_page_number = NULL,
  use_printer_defaults = NULL,
  orientation = NULL,
  scale = NULL,
  left = 0.7,
  right = 0.7,
  top = 0.75,
  bottom = 0.75,
  header = 0.3,
  footer = 0.3,
  fit_to_width = FALSE,
  fit_to_height = FALSE,
  paper_size = NULL,
  print_title_rows = NULL,
  print_title_cols = NULL,
  summary_row = NULL,
  summary_col = NULL,
  tab_color = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>black_and_white</code></dt><dd><p>black_and_white</p>
</dd>
<dt><code>cell_comments</code></dt><dd><p>cell_comment</p>
</dd>
<dt><code>copies</code></dt><dd><p>copies</p>
</dd>
<dt><code>draft</code></dt><dd><p>draft</p>
</dd>
<dt><code>errors</code></dt><dd><p>errors</p>
</dd>
<dt><code>first_page_number</code></dt><dd><p>first_page_number</p>
</dd>
<dt><code>id</code></dt><dd><p>id</p>
</dd>
<dt><code>page_order</code></dt><dd><p>page_order</p>
</dd>
<dt><code>paper_height, paper_width</code></dt><dd><p>paper size</p>
</dd>
<dt><code>hdpi, vdpi</code></dt><dd><p>horizontal and vertical dpi</p>
</dd>
<dt><code>use_first_page_number</code></dt><dd><p>use_first_page_number</p>
</dd>
<dt><code>use_printer_defaults</code></dt><dd><p>use_printer_defaults</p>
</dd>
<dt><code>orientation</code></dt><dd><p>orientation</p>
</dd>
<dt><code>scale</code></dt><dd><p>scale</p>
</dd>
<dt><code>left</code></dt><dd><p>left</p>
</dd>
<dt><code>right</code></dt><dd><p>right</p>
</dd>
<dt><code>top</code></dt><dd><p>top</p>
</dd>
<dt><code>bottom</code></dt><dd><p>bottom</p>
</dd>
<dt><code>header</code></dt><dd><p>header</p>
</dd>
<dt><code>footer</code></dt><dd><p>footer</p>
</dd>
<dt><code>fit_to_width</code></dt><dd><p>fitToWidth</p>
</dd>
<dt><code>fit_to_height</code></dt><dd><p>fitToHeight</p>
</dd>
<dt><code>paper_size</code></dt><dd><p>paperSize</p>
</dd>
<dt><code>print_title_rows</code></dt><dd><p>printTitleRows</p>
</dd>
<dt><code>print_title_cols</code></dt><dd><p>printTitleCols</p>
</dd>
<dt><code>summary_row</code></dt><dd><p>summaryRow</p>
</dd>
<dt><code>summary_col</code></dt><dd><p>summaryCol</p>
</dd>
<dt><code>tab_color</code></dt><dd><p>tabColor</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-page_setup"></a>



<h4>Method <code>page_setup()</code></h4>

<p>page_setup()
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$page_setup(
  sheet = current_sheet(),
  orientation = NULL,
  scale = 100,
  left = 0.7,
  right = 0.7,
  top = 0.75,
  bottom = 0.75,
  header = 0.3,
  footer = 0.3,
  fit_to_width = FALSE,
  fit_to_height = FALSE,
  paper_size = NULL,
  print_title_rows = NULL,
  print_title_cols = NULL,
  summary_row = NULL,
  summary_col = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>orientation</code></dt><dd><p>orientation</p>
</dd>
<dt><code>scale</code></dt><dd><p>scale</p>
</dd>
<dt><code>left</code></dt><dd><p>left</p>
</dd>
<dt><code>right</code></dt><dd><p>right</p>
</dd>
<dt><code>top</code></dt><dd><p>top</p>
</dd>
<dt><code>bottom</code></dt><dd><p>bottom</p>
</dd>
<dt><code>header</code></dt><dd><p>header</p>
</dd>
<dt><code>footer</code></dt><dd><p>footer</p>
</dd>
<dt><code>fit_to_width</code></dt><dd><p>fitToWidth</p>
</dd>
<dt><code>fit_to_height</code></dt><dd><p>fitToHeight</p>
</dd>
<dt><code>paper_size</code></dt><dd><p>paperSize</p>
</dd>
<dt><code>print_title_rows</code></dt><dd><p>printTitleRows</p>
</dd>
<dt><code>print_title_cols</code></dt><dd><p>printTitleCols</p>
</dd>
<dt><code>summary_row</code></dt><dd><p>summaryRow</p>
</dd>
<dt><code>summary_col</code></dt><dd><p>summaryCol</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-set_header_footer"></a>



<h4>Method <code>set_header_footer()</code></h4>

<p>Sets headers and footers
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_header_footer(
  sheet = current_sheet(),
  header = NULL,
  footer = NULL,
  even_header = NULL,
  even_footer = NULL,
  first_header = NULL,
  first_footer = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>header</code></dt><dd><p>header</p>
</dd>
<dt><code>footer</code></dt><dd><p>footer</p>
</dd>
<dt><code>even_header</code></dt><dd><p>evenHeader</p>
</dd>
<dt><code>even_footer</code></dt><dd><p>evenFooter</p>
</dd>
<dt><code>first_header</code></dt><dd><p>firstHeader</p>
</dd>
<dt><code>first_footer</code></dt><dd><p>firstFooter</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-get_tables"></a>



<h4>Method <code>get_tables()</code></h4>

<p>get tables
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_tables(sheet = current_sheet())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The sheet tables.  <code>character()</code> if empty
</p>


<hr>
<a id="method-wbWorkbook-remove_tables"></a>



<h4>Method <code>remove_tables()</code></h4>

<p>remove tables
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_tables(sheet = current_sheet(), table, remove_data = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>table</code></dt><dd><p>table</p>
</dd>
<dt><code>remove_data</code></dt><dd><p>removes the data as well</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_filter"></a>



<h4>Method <code>add_filter()</code></h4>

<p>add filters
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_filter(sheet = current_sheet(), rows, cols)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
<dt><code>cols</code></dt><dd><p>cols</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-remove_filter"></a>



<h4>Method <code>remove_filter()</code></h4>

<p>remove filters
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_filter(sheet = current_sheet())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-set_grid_lines"></a>



<h4>Method <code>set_grid_lines()</code></h4>

<p>grid lines
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_grid_lines(sheet = current_sheet(), show = FALSE, print = show)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>show</code></dt><dd><p>show</p>
</dd>
<dt><code>print</code></dt><dd><p>print</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-grid_lines"></a>



<h4>Method <code>grid_lines()</code></h4>

<p>grid lines
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$grid_lines(sheet = current_sheet(), show = FALSE, print = show)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>show</code></dt><dd><p>show</p>
</dd>
<dt><code>print</code></dt><dd><p>print</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_named_region"></a>



<h4>Method <code>add_named_region()</code></h4>

<p>add a named region
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_named_region(
  sheet = current_sheet(),
  dims = "A1",
  name,
  local_sheet = FALSE,
  overwrite = FALSE,
  comment = NULL,
  hidden = NULL,
  custom_menu = NULL,
  description = NULL,
  is_function = NULL,
  function_group_id = NULL,
  help = NULL,
  local_name = NULL,
  publish_to_server = NULL,
  status_bar = NULL,
  vb_procedure = NULL,
  workbook_parameter = NULL,
  xml = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
<dt><code>local_sheet</code></dt><dd><p>local_sheet</p>
</dd>
<dt><code>overwrite</code></dt><dd><p>overwrite</p>
</dd>
<dt><code>comment</code></dt><dd><p>comment</p>
</dd>
<dt><code>hidden</code></dt><dd><p>hidden</p>
</dd>
<dt><code>custom_menu</code></dt><dd><p>custom_menu</p>
</dd>
<dt><code>description</code></dt><dd><p>description</p>
</dd>
<dt><code>is_function</code></dt><dd><p>function</p>
</dd>
<dt><code>function_group_id</code></dt><dd><p>function group id</p>
</dd>
<dt><code>help</code></dt><dd><p>help</p>
</dd>
<dt><code>local_name</code></dt><dd><p>localName</p>
</dd>
<dt><code>publish_to_server</code></dt><dd><p>publish to server</p>
</dd>
<dt><code>status_bar</code></dt><dd><p>status bar</p>
</dd>
<dt><code>vb_procedure</code></dt><dd><p>vb procedure</p>
</dd>
<dt><code>workbook_parameter</code></dt><dd><p>workbookParameter</p>
</dd>
<dt><code>xml</code></dt><dd><p>xml</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_named_regions"></a>



<h4>Method <code>get_named_regions()</code></h4>

<p>get named regions in a workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_named_regions(tables = FALSE, x = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>tables</code></dt><dd><p>Return tables as well?</p>
</dd>
<dt><code>x</code></dt><dd><p>Not used.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A <code>data.frame</code> of named regions
</p>


<hr>
<a id="method-wbWorkbook-remove_named_region"></a>



<h4>Method <code>remove_named_region()</code></h4>

<p>remove a named region
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$remove_named_region(sheet = current_sheet(), name = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-set_order"></a>



<h4>Method <code>set_order()</code></h4>

<p>set worksheet order
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_order(sheets)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheets</code></dt><dd><p>sheets</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-get_sheet_visibility"></a>



<h4>Method <code>get_sheet_visibility()</code></h4>

<p>Get sheet visibility
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_sheet_visibility()</pre></div>



<h5>Returns</h5>

<p>Returns sheet visibility
</p>


<hr>
<a id="method-wbWorkbook-set_sheet_visibility"></a>



<h4>Method <code>set_sheet_visibility()</code></h4>

<p>Set sheet visibility
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_sheet_visibility(sheet = current_sheet(), value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>value</code></dt><dd><p>value</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_page_break"></a>



<h4>Method <code>add_page_break()</code></h4>

<p>Add a page break
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_page_break(sheet = current_sheet(), row = NULL, col = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>row</code></dt><dd><p>row</p>
</dd>
<dt><code>col</code></dt><dd><p>col</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-clean_sheet"></a>



<h4>Method <code>clean_sheet()</code></h4>

<p>clean sheet (remove all values)
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$clean_sheet(
  sheet = current_sheet(),
  dims = NULL,
  numbers = TRUE,
  characters = TRUE,
  styles = TRUE,
  merged_cells = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>numbers</code></dt><dd><p>remove all numbers</p>
</dd>
<dt><code>characters</code></dt><dd><p>remove all characters</p>
</dd>
<dt><code>styles</code></dt><dd><p>remove all styles</p>
</dd>
<dt><code>merged_cells</code></dt><dd><p>remove all merged_cells</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_border"></a>



<h4>Method <code>add_border()</code></h4>

<p>create borders for cell region
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_border(
  sheet = current_sheet(),
  dims = "A1",
  bottom_color = wb_color(hex = "FF000000"),
  left_color = wb_color(hex = "FF000000"),
  right_color = wb_color(hex = "FF000000"),
  top_color = wb_color(hex = "FF000000"),
  bottom_border = "thin",
  left_border = "thin",
  right_border = "thin",
  top_border = "thin",
  inner_hgrid = NULL,
  inner_hcolor = NULL,
  inner_vgrid = NULL,
  inner_vcolor = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>dimensions on the worksheet e.g. &quot;A1&quot;, &quot;A1:A5&quot;, &quot;A1:H5&quot;</p>
</dd>
<dt><code>bottom_color, left_color, right_color, top_color, inner_hcolor, inner_vcolor</code></dt><dd><p>a color, either something openxml knows or some RGB color</p>
</dd>
<dt><code>left_border, right_border, top_border, bottom_border, inner_hgrid, inner_vgrid</code></dt><dd><p>the border style, if NULL no border is drawn. See create_border for possible border styles</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_fill"></a>



<h4>Method <code>add_fill()</code></h4>

<p>provide simple fill function
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_fill(
  sheet = current_sheet(),
  dims = "A1",
  color = wb_color(hex = "FFFFFF00"),
  pattern = "solid",
  gradient_fill = "",
  every_nth_col = 1,
  every_nth_row = 1,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>color</code></dt><dd><p>the colors to apply, e.g. yellow: wb_color(hex = &quot;FFFFFF00&quot;)</p>
</dd>
<dt><code>pattern</code></dt><dd><p>various default &quot;none&quot; but others are possible:
&quot;solid&quot;, &quot;mediumGray&quot;, &quot;darkGray&quot;, &quot;lightGray&quot;, &quot;darkHorizontal&quot;,
&quot;darkVertical&quot;, &quot;darkDown&quot;, &quot;darkUp&quot;, &quot;darkGrid&quot;, &quot;darkTrellis&quot;,
&quot;lightHorizontal&quot;, &quot;lightVertical&quot;, &quot;lightDown&quot;, &quot;lightUp&quot;, &quot;lightGrid&quot;,
&quot;lightTrellis&quot;, &quot;gray125&quot;, &quot;gray0625&quot;</p>
</dd>
<dt><code>gradient_fill</code></dt><dd><p>a gradient fill xml pattern.</p>
</dd>
<dt><code>every_nth_col</code></dt><dd><p>which col should be filled</p>
</dd>
<dt><code>every_nth_row</code></dt><dd><p>which row should be filled</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_font"></a>



<h4>Method <code>add_font()</code></h4>

<p>provide simple font function
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_font(
  sheet = current_sheet(),
  dims = "A1",
  name = "Aptos Narrow",
  color = wb_color(hex = "FF000000"),
  size = "11",
  bold = "",
  italic = "",
  outline = "",
  strike = "",
  underline = "",
  charset = "",
  condense = "",
  extend = "",
  family = "",
  scheme = "",
  shadow = "",
  vert_align = "",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>name</code></dt><dd><p>font name: default &quot;Aptos Narrow&quot;</p>
</dd>
<dt><code>color</code></dt><dd><p>rgb color: default &quot;FF000000&quot;</p>
</dd>
<dt><code>size</code></dt><dd><p>font size: default &quot;11&quot;,</p>
</dd>
<dt><code>bold</code></dt><dd><p>bold</p>
</dd>
<dt><code>italic</code></dt><dd><p>italic</p>
</dd>
<dt><code>outline</code></dt><dd><p>outline</p>
</dd>
<dt><code>strike</code></dt><dd><p>strike</p>
</dd>
<dt><code>underline</code></dt><dd><p>underline</p>
</dd>
<dt><code>charset</code></dt><dd><p>charset</p>
</dd>
<dt><code>condense</code></dt><dd><p>condense</p>
</dd>
<dt><code>extend</code></dt><dd><p>extend</p>
</dd>
<dt><code>family</code></dt><dd><p>font family</p>
</dd>
<dt><code>scheme</code></dt><dd><p>font scheme</p>
</dd>
<dt><code>shadow</code></dt><dd><p>shadow</p>
</dd>
<dt><code>vert_align</code></dt><dd><p>vertical alignment</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_numfmt"></a>



<h4>Method <code>add_numfmt()</code></h4>

<p>provide simple number format function
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_numfmt(sheet = current_sheet(), dims = "A1", numfmt)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>numfmt</code></dt><dd><p>number format id or a character of the format</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_cell_style"></a>



<h4>Method <code>add_cell_style()</code></h4>

<p>provide simple cell style format function
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_cell_style(
  sheet = current_sheet(),
  dims = "A1",
  apply_alignment = NULL,
  apply_border = NULL,
  apply_fill = NULL,
  apply_font = NULL,
  apply_number_format = NULL,
  apply_protection = NULL,
  border_id = NULL,
  ext_lst = NULL,
  fill_id = NULL,
  font_id = NULL,
  hidden = NULL,
  horizontal = NULL,
  indent = NULL,
  justify_last_line = NULL,
  locked = NULL,
  num_fmt_id = NULL,
  pivot_button = NULL,
  quote_prefix = NULL,
  reading_order = NULL,
  relative_indent = NULL,
  shrink_to_fit = NULL,
  text_rotation = NULL,
  vertical = NULL,
  wrap_text = NULL,
  xf_id = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>apply_alignment</code></dt><dd><p>logical apply alignment</p>
</dd>
<dt><code>apply_border</code></dt><dd><p>logical apply border</p>
</dd>
<dt><code>apply_fill</code></dt><dd><p>logical apply fill</p>
</dd>
<dt><code>apply_font</code></dt><dd><p>logical apply font</p>
</dd>
<dt><code>apply_number_format</code></dt><dd><p>logical apply number format</p>
</dd>
<dt><code>apply_protection</code></dt><dd><p>logical apply protection</p>
</dd>
<dt><code>border_id</code></dt><dd><p>border ID to apply</p>
</dd>
<dt><code>ext_lst</code></dt><dd><p>extension list something like <code style="white-space: pre;">&#8288;&lt;extLst&gt;...&lt;/extLst&gt;&#8288;</code></p>
</dd>
<dt><code>fill_id</code></dt><dd><p>fill ID to apply</p>
</dd>
<dt><code>font_id</code></dt><dd><p>font ID to apply</p>
</dd>
<dt><code>hidden</code></dt><dd><p>logical cell is hidden</p>
</dd>
<dt><code>horizontal</code></dt><dd><p>align content horizontal ('left', 'center', 'right')</p>
</dd>
<dt><code>indent</code></dt><dd><p>logical indent content</p>
</dd>
<dt><code>justify_last_line</code></dt><dd><p>logical justify last line</p>
</dd>
<dt><code>locked</code></dt><dd><p>logical cell is locked</p>
</dd>
<dt><code>num_fmt_id</code></dt><dd><p>number format ID to apply</p>
</dd>
<dt><code>pivot_button</code></dt><dd><p>unknown</p>
</dd>
<dt><code>quote_prefix</code></dt><dd><p>unknown</p>
</dd>
<dt><code>reading_order</code></dt><dd><p>reading order left to right</p>
</dd>
<dt><code>relative_indent</code></dt><dd><p>relative indentation</p>
</dd>
<dt><code>shrink_to_fit</code></dt><dd><p>logical shrink to fit</p>
</dd>
<dt><code>text_rotation</code></dt><dd><p>degrees of text rotation</p>
</dd>
<dt><code>vertical</code></dt><dd><p>vertical alignment of content ('top', 'center', 'bottom')</p>
</dd>
<dt><code>wrap_text</code></dt><dd><p>wrap text in cell</p>
</dd>
<dt><code>xf_id</code></dt><dd><p>xf ID to apply</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object, invisibly
</p>


<hr>
<a id="method-wbWorkbook-get_cell_style"></a>



<h4>Method <code>get_cell_style()</code></h4>

<p>get sheet style
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_cell_style(sheet = current_sheet(), dims)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>a character vector of cell styles
</p>


<hr>
<a id="method-wbWorkbook-set_cell_style"></a>



<h4>Method <code>set_cell_style()</code></h4>

<p>set sheet style
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_cell_style(sheet = current_sheet(), dims, style)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>style</code></dt><dd><p>style</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-set_cell_style_across"></a>



<h4>Method <code>set_cell_style_across()</code></h4>

<p>set style across columns and/or rows
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_cell_style_across(
  sheet = current_sheet(),
  style,
  cols = NULL,
  rows = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>sheet</p>
</dd>
<dt><code>style</code></dt><dd><p>style</p>
</dd>
<dt><code>cols</code></dt><dd><p>cols</p>
</dd>
<dt><code>rows</code></dt><dd><p>rows</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code> object
</p>


<hr>
<a id="method-wbWorkbook-add_named_style"></a>



<h4>Method <code>add_named_style()</code></h4>

<p>set sheet style
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_named_style(
  sheet = current_sheet(),
  dims = "A1",
  name = "Normal",
  font_name = NULL,
  font_size = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
<dt><code>font_name, font_size</code></dt><dd><p>optional else the default of the theme</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorkbook</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_dxfs_style"></a>



<h4>Method <code>add_dxfs_style()</code></h4>

<p>create dxfs style
These styles are used with conditional formatting and custom table styles
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_dxfs_style(
  name,
  font_name = NULL,
  font_size = NULL,
  font_color = NULL,
  num_fmt = NULL,
  border = NULL,
  border_color = wb_color(getOption("openxlsx2.borderColor", "black")),
  border_style = getOption("openxlsx2.borderStyle", "thin"),
  bg_fill = NULL,
  gradient_fill = NULL,
  text_bold = NULL,
  text_italic = NULL,
  text_underline = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>the style name</p>
</dd>
<dt><code>font_name</code></dt><dd><p>the font name</p>
</dd>
<dt><code>font_size</code></dt><dd><p>the font size</p>
</dd>
<dt><code>font_color</code></dt><dd><p>the font color (a <code>wb_color()</code> object)</p>
</dd>
<dt><code>num_fmt</code></dt><dd><p>the number format</p>
</dd>
<dt><code>border</code></dt><dd><p>logical if borders are applied</p>
</dd>
<dt><code>border_color</code></dt><dd><p>the border color</p>
</dd>
<dt><code>border_style</code></dt><dd><p>the border style</p>
</dd>
<dt><code>bg_fill</code></dt><dd><p>any background fill</p>
</dd>
<dt><code>gradient_fill</code></dt><dd><p>any gradient fill</p>
</dd>
<dt><code>text_bold</code></dt><dd><p>logical if text is bold</p>
</dd>
<dt><code>text_italic</code></dt><dd><p>logical if text is italic</p>
</dd>
<dt><code>text_underline</code></dt><dd><p>logical if text is underlined</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments passed to <code>create_dxfs_style()</code></p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-clone_sheet_style"></a>



<h4>Method <code>clone_sheet_style()</code></h4>

<p>clone style from one sheet to another
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$clone_sheet_style(from = current_sheet(), to)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>from</code></dt><dd><p>the worksheet you are cloning</p>
</dd>
<dt><code>to</code></dt><dd><p>the worksheet the style is applied to</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-add_sparklines"></a>



<h4>Method <code>add_sparklines()</code></h4>

<p>apply sparkline to worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_sparklines(sheet = current_sheet(), sparklines)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>sparklines</code></dt><dd><p>sparkline created by <code>create_sparkline()</code></p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-add_ignore_error"></a>



<h4>Method <code>add_ignore_error()</code></h4>

<p>Ignore error on worksheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_ignore_error(
  sheet = current_sheet(),
  dims = "A1",
  calculated_column = FALSE,
  empty_cell_reference = FALSE,
  eval_error = FALSE,
  formula = FALSE,
  formula_range = FALSE,
  list_data_validation = FALSE,
  number_stored_as_text = FALSE,
  two_digit_text_year = FALSE,
  unlocked_formula = FALSE,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>dims</code></dt><dd><p>Cell range in a sheet</p>
</dd>
<dt><code>calculated_column</code></dt><dd><p>calculatedColumn</p>
</dd>
<dt><code>empty_cell_reference</code></dt><dd><p>emptyCellReference</p>
</dd>
<dt><code>eval_error</code></dt><dd><p>evalError</p>
</dd>
<dt><code>formula</code></dt><dd><p>formula</p>
</dd>
<dt><code>formula_range</code></dt><dd><p>formulaRange</p>
</dd>
<dt><code>list_data_validation</code></dt><dd><p>listDataValidation</p>
</dd>
<dt><code>number_stored_as_text</code></dt><dd><p>numberStoredAsText</p>
</dd>
<dt><code>two_digit_text_year</code></dt><dd><p>twoDigitTextYear</p>
</dd>
<dt><code>unlocked_formula</code></dt><dd><p>unlockedFormula</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-set_sheetview"></a>



<h4>Method <code>set_sheetview()</code></h4>

<p>add sheetview
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_sheetview(
  sheet = current_sheet(),
  color_id = NULL,
  default_grid_color = NULL,
  right_to_left = NULL,
  show_formulas = NULL,
  show_grid_lines = NULL,
  show_outline_symbols = NULL,
  show_row_col_headers = NULL,
  show_ruler = NULL,
  show_white_space = NULL,
  show_zeros = NULL,
  tab_selected = NULL,
  top_left_cell = NULL,
  view = NULL,
  window_protection = NULL,
  workbook_view_id = NULL,
  zoom_scale = NULL,
  zoom_scale_normal = NULL,
  zoom_scale_page_layout_view = NULL,
  zoom_scale_sheet_layout_view = NULL,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
<dt><code>color_id, default_grid_color</code></dt><dd><p>Integer: A color, default is 64</p>
</dd>
<dt><code>right_to_left</code></dt><dd><p>Logical: if TRUE column ordering is right  to left</p>
</dd>
<dt><code>show_formulas</code></dt><dd><p>Logical: if TRUE cell formulas are shown</p>
</dd>
<dt><code>show_grid_lines</code></dt><dd><p>Logical: if TRUE the worksheet grid is shown</p>
</dd>
<dt><code>show_outline_symbols</code></dt><dd><p>Logical: if TRUE outline symbols are shown</p>
</dd>
<dt><code>show_row_col_headers</code></dt><dd><p>Logical: if TRUE row and column headers are shown</p>
</dd>
<dt><code>show_ruler</code></dt><dd><p>Logical: if TRUE a ruler is shown in page layout view</p>
</dd>
<dt><code>show_white_space</code></dt><dd><p>Logical: if TRUE margins are shown in page layout view</p>
</dd>
<dt><code>show_zeros</code></dt><dd><p>Logical: if FALSE cells containing zero are shown blank if !showFormulas</p>
</dd>
<dt><code>tab_selected</code></dt><dd><p>Integer: zero vector indicating the selected tab</p>
</dd>
<dt><code>top_left_cell</code></dt><dd><p>Cell: the cell shown in the top left corner / or top right with rightToLeft</p>
</dd>
<dt><code>view</code></dt><dd><p>View: &quot;normal&quot;, &quot;pageBreakPreview&quot; or &quot;pageLayout&quot;</p>
</dd>
<dt><code>window_protection</code></dt><dd><p>Logical: if TRUE the panes are protected</p>
</dd>
<dt><code>workbook_view_id</code></dt><dd><p>integer: Pointing to some other view inside the workbook</p>
</dd>
<dt><code>zoom_scale, zoom_scale_normal, zoom_scale_page_layout_view, zoom_scale_sheet_layout_view</code></dt><dd><p>Integer: the zoom scale should be between 10 and 400. These are values for current, normal etc.</p>
</dd>
<dt><code>...</code></dt><dd><p>additional arguments</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>The <code>wbWorksheetObject</code>, invisibly
</p>


<hr>
<a id="method-wbWorkbook-add_person"></a>



<h4>Method <code>add_person()</code></h4>

<p>add person to workbook
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$add_person(
  name = NULL,
  id = NULL,
  user_id = NULL,
  provider_id = "None"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
<dt><code>id</code></dt><dd><p>id</p>
</dd>
<dt><code>user_id</code></dt><dd><p>user_id</p>
</dd>
<dt><code>provider_id</code></dt><dd><p>provider_id</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-get_person"></a>



<h4>Method <code>get_person()</code></h4>

<p>description get person
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_person(name = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>name</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-get_active_sheet"></a>



<h4>Method <code>get_active_sheet()</code></h4>

<p>description get active sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_active_sheet()</pre></div>


<hr>
<a id="method-wbWorkbook-set_active_sheet"></a>



<h4>Method <code>set_active_sheet()</code></h4>

<p>description set active sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_active_sheet(sheet = current_sheet())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-get_selected"></a>



<h4>Method <code>get_selected()</code></h4>

<p>description get selected sheets
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$get_selected()</pre></div>


<hr>
<a id="method-wbWorkbook-set_selected"></a>



<h4>Method <code>set_selected()</code></h4>

<p>set selected sheet
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$set_selected(sheet = current_sheet())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sheet</code></dt><dd><p>The name of the sheet</p>
</dd>
</dl>

</div>


<hr>
<a id="method-wbWorkbook-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>wbWorkbook$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='write_data'>Write an object to a worksheet</h2><span id='topic+write_data'></span>

<h3>Description</h3>

<p>Use <code><a href="#topic+wb_add_data">wb_add_data()</a></code> or <code><a href="#topic+write_xlsx">write_xlsx()</a></code> in new code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_data(
  wb,
  sheet,
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  col_names = TRUE,
  row_names = FALSE,
  with_filter = FALSE,
  sep = ", ",
  name = NULL,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_data_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="write_data_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="write_data_+3A_x">x</code></td>
<td>
<p>Object to be written. For classes supported look at the examples.</p>
</td></tr>
<tr><td><code id="write_data_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet cell range that will determine <code>start_col</code> and <code>start_row</code>: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="write_data_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="write_data_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="write_data_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="write_data_+3A_col_names">col_names</code></td>
<td>
<p>If <code>TRUE</code>, column names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="write_data_+3A_row_names">row_names</code></td>
<td>
<p>If <code>TRUE</code>, the row names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="write_data_+3A_with_filter">with_filter</code></td>
<td>
<p>If <code>TRUE</code>, add filters to the column name row.
NOTE: can only have one filter per worksheet.</p>
</td></tr>
<tr><td><code id="write_data_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list
columns to a character vector e.g. <code>sapply(x$list_column, paste, collapse = sep)</code>.</p>
</td></tr>
<tr><td><code id="write_data_+3A_name">name</code></td>
<td>
<p>The name of a named region if specified.</p>
</td></tr>
<tr><td><code id="write_data_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook</p>
</td></tr>
<tr><td><code id="write_data_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>keep the cell style?</p>
</td></tr>
<tr><td><code id="write_data_+3A_na.strings">na.strings</code></td>
<td>
<p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
looks if <code>options(openxlsx2.na.strings)</code> is set. Otherwise <code><a href="#topic+na_strings">na_strings()</a></code>
uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</td></tr>
<tr><td><code id="write_data_+3A_inline_strings">inline_strings</code></td>
<td>
<p>write characters as inline strings</p>
</td></tr>
<tr><td><code id="write_data_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible(0)
</p>

<hr>
<h2 id='write_datatable'>Write to a worksheet as an Excel table</h2><span id='topic+write_datatable'></span>

<h3>Description</h3>

<p>Write to a worksheet and format as an Excel table. Use <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code> in new code.
This function may not be exported
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_datatable(
  wb,
  sheet,
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  col_names = TRUE,
  row_names = FALSE,
  table_style = "TableStyleLight9",
  table_name = NULL,
  with_filter = TRUE,
  sep = ", ",
  first_column = FALSE,
  last_column = FALSE,
  banded_rows = TRUE,
  banded_cols = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  na.strings = na_strings(),
  inline_strings = TRUE,
  total_row = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_datatable_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_x">x</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet cell range that will determine <code>start_col</code> and <code>start_row</code>: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write <code>x</code> to.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_col_names">col_names</code></td>
<td>
<p>If <code>TRUE</code>, column names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_row_names">row_names</code></td>
<td>
<p>If <code>TRUE</code>, the row names of <code>x</code> are written.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_table_style">table_style</code></td>
<td>
<p>Any table style name or &quot;none&quot; (see <code>vignette("openxlsx2_style_manual")</code>)</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_table_name">table_name</code></td>
<td>
<p>Name of table in workbook. The table name must be unique.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_with_filter">with_filter</code></td>
<td>
<p>If <code>TRUE</code>, columns with have filters in the first row.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list
columns to a character vector e.g.
<code>sapply(x$list_column, paste, collapse = sep)</code>.
<br /><br />
<br /><strong>The below options correspond to Excel table options:</strong>
<br />
<img src="../help/figures/tableoptions.png" width="40%" alt="Figure: table\_options.png" />
</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_first_column">first_column</code></td>
<td>
<p>logical. If <code>TRUE</code>, the first column is bold.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_last_column">last_column</code></td>
<td>
<p>logical. If <code>TRUE</code>, the last column is bold.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_banded_rows">banded_rows</code></td>
<td>
<p>logical. If <code>TRUE</code>, rows are color banded.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_banded_cols">banded_cols</code></td>
<td>
<p>logical. If <code>TRUE</code>, the columns are color banded.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>keep the cell style?</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_na.strings">na.strings</code></td>
<td>
<p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
looks if <code>options(openxlsx2.na.strings)</code> is set. Otherwise <code><a href="#topic+na_strings">na_strings()</a></code>
uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_inline_strings">inline_strings</code></td>
<td>
<p>write characters as inline strings</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_total_row">total_row</code></td>
<td>
<p>logical. With the default <code>FALSE</code> no total row is added.</p>
</td></tr>
<tr><td><code id="write_datatable_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulae written using <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code> to a Workbook object will
not get picked up by <code>read_xlsx()</code>. This is because only the formula is written
and left to Excel to evaluate the formula when the file is opened in Excel.
The string <code>"_openxlsx_NA"</code> is reserved for <code>openxlsx2</code>.
If the data frame contains this string, the output will be broken.
</p>
<p>Supported classes are data frames, matrices and vectors of various types and
everything that can be converted into a data frame with <code>as.data.frame()</code>.
Everything else that the user wants to write should either be converted into
a vector or data frame or written in vector or data frame segments. This
includes base classes such as <code>table</code>, which were coerced internally in the
predecessor of this package.
</p>
<p>Even vectors and data frames can consist of different classes. Many base
classes are covered, though not all and far from all third-party classes.
When data of an unknown class is written, it is handled with <code>as.character()</code>.
It is not possible to write character nodes beginning with <code style="white-space: pre;">&#8288;&lt;r&gt;&#8288;</code> or <code style="white-space: pre;">&#8288;&lt;r/&gt;&#8288;</code>. Both
are reserved for internal functions. If you need these. You have to wrap
the input string in <code>fmt_txt()</code>.
</p>
<p>The columns of <code>x</code> with class Date/POSIXt, currency, accounting, hyperlink,
percentage are automatically styled as dates, currency, accounting,
hyperlinks, percentages respectively.
</p>
<p>Functions <code><a href="#topic+wb_add_data">wb_add_data()</a></code> and <code><a href="#topic+wb_add_data_table">wb_add_data_table()</a></code> behave quite similar. The
distinction is that the latter creates a table in the worksheet that can be
used for different kind of formulas and can be sorted independently, though
is less flexible than basic cell regions.
</p>

<hr>
<h2 id='write_formula'>Write a character vector as an Excel Formula</h2><span id='topic+write_formula'></span>

<h3>Description</h3>

<p>Write a a character vector containing Excel formula to a worksheet.
Use <code><a href="#topic+wb_add_formula">wb_add_formula()</a></code> or <code>add_formula()</code> in new code. This function is meant
for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_formula(
  wb,
  sheet,
  x,
  dims = wb_dims(start_row, start_col),
  start_col = 1,
  start_row = 1,
  array = FALSE,
  cm = FALSE,
  apply_cell_style = TRUE,
  remove_cell_style = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_formula_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="write_formula_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. (either as index or name)</p>
</td></tr>
<tr><td><code id="write_formula_+3A_x">x</code></td>
<td>
<p>A formula as character vector.</p>
</td></tr>
<tr><td><code id="write_formula_+3A_dims">dims</code></td>
<td>
<p>Spreadsheet dimensions that will determine where <code>x</code> spans: &quot;A1&quot;, &quot;A1:B2&quot;, &quot;A:B&quot;</p>
</td></tr>
<tr><td><code id="write_formula_+3A_start_col">start_col</code></td>
<td>
<p>A vector specifying the starting column to write to.</p>
</td></tr>
<tr><td><code id="write_formula_+3A_start_row">start_row</code></td>
<td>
<p>A vector specifying the starting row to write to.</p>
</td></tr>
<tr><td><code id="write_formula_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="write_formula_+3A_cm">cm</code></td>
<td>
<p>A special kind of array function that hides the curly braces in the cell.
Add this, if you see &quot;@&quot; inserted into your formulas.</p>
</td></tr>
<tr><td><code id="write_formula_+3A_apply_cell_style">apply_cell_style</code></td>
<td>
<p>Should we write cell styles to the workbook?</p>
</td></tr>
<tr><td><code id="write_formula_+3A_remove_cell_style">remove_cell_style</code></td>
<td>
<p>Should we keep the cell style?</p>
</td></tr>
<tr><td><code id="write_formula_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='write_xlsx'>Write data to an xlsx file</h2><span id='topic+write_xlsx'></span>

<h3>Description</h3>

<p>Write a data frame or list of data frames to an xlsx file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_xlsx(x, file, as_table = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_xlsx_+3A_x">x</code></td>
<td>
<p>An object or a list of objects that can be handled by <code><a href="#topic+wb_add_data">wb_add_data()</a></code> to write to file.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_file">file</code></td>
<td>
<p>An optional xlsx file name. If no file is passed, the object is not written to disk and only a workbook object is returned.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_as_table">as_table</code></td>
<td>
<p>If <code>TRUE</code>, will write as a data table, instead of data.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+wb_workbook">wb_workbook</a></code>, <code><a href="#topic+wb_add_worksheet">wb_add_worksheet</a></code>, <code><a href="#topic+wb_add_data_table">wb_add_data_table</a></code>, <code><a href="#topic+wb_add_data">wb_add_data</a></code>, <code><a href="#topic+wb_freeze_pane">wb_freeze_pane</a></code>, <code><a href="#topic+wb_set_col_widths">wb_set_col_widths</a></code>, <code><a href="#topic+wb_save">wb_save</a></code>
</p>

<dl>
<dt><code>creator</code></dt><dd><p>Creator of the workbook (your name). Defaults to login username or <code>options("openxlsx2.creator")</code> if set.</p>
</dd>
<dt><code>sheet</code></dt><dd><p>A name for the new worksheet</p>
</dd>
<dt><code>grid_lines</code></dt><dd><p>A logical. If <code>FALSE</code>, the worksheet grid lines will be
hidden.</p>
</dd>
<dt><code>tab_color</code></dt><dd><p>Color of the sheet tab. A  <code><a href="#topic+wb_color">wb_color()</a></code>,  a valid color (belonging to
<code>grDevices::colors()</code>) or a valid hex color beginning with &quot;#&quot;.</p>
</dd>
<dt><code>zoom</code></dt><dd><p>The sheet zoom level, a numeric between 10 and 400 as a
percentage. (A zoom value smaller than 10 will default to 10.)</p>
</dd>
<dt><code>total_row</code></dt><dd><p>logical. With the default <code>FALSE</code> no total row is added.</p>
</dd>
<dt><code>start_col</code></dt><dd><p>A vector specifying the starting column to write <code>x</code> to.</p>
</dd>
<dt><code>start_row</code></dt><dd><p>A vector specifying the starting row to write <code>x</code> to.</p>
</dd>
<dt><code>col_names</code></dt><dd><p>If <code>TRUE</code>, column names of <code>x</code> are written.</p>
</dd>
<dt><code>row_names</code></dt><dd><p>If <code>TRUE</code>, the row names of <code>x</code> are written.</p>
</dd>
<dt><code>na.strings</code></dt><dd><p>Value used for replacing <code>NA</code> values from <code>x</code>. Default
looks if <code>options(openxlsx2.na.strings)</code> is set. Otherwise <code><a href="#topic+na_strings">na_strings()</a></code>
uses the special <code style="white-space: pre;">&#8288;#N/A&#8288;</code> value within the workbook.</p>
</dd>
<dt><code>first_active_row</code></dt><dd><p>Top row of active region</p>
</dd>
<dt><code>first_active_col</code></dt><dd><p>Furthest left column of active region</p>
</dd>
<dt><code>first_row</code></dt><dd><p>If <code>TRUE</code>, freezes the first row (equivalent to <code>first_active_row = 2</code>)</p>
</dd>
<dt><code>first_col</code></dt><dd><p>If <code>TRUE</code>, freezes the first column (equivalent to <code>first_active_col = 2</code>)</p>
</dd>
<dt><code>widths</code></dt><dd><p>Width to set <code>cols</code> to specified column width or <code>"auto"</code> for
automatic sizing. <code>widths</code> is recycled to the length of <code>cols</code>. openxlsx2
sets the default width is 8.43, as this is the standard in some spreadsheet
software. See <strong>Details</strong> for general information on column widths.</p>
</dd>
<dt><code>overwrite</code></dt><dd><p>If <code>FALSE</code>, will not overwrite when <code>file</code> already exists.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>columns of <code>x</code> with class <code>Date</code> or <code>POSIXt</code> are automatically
styled as dates and datetimes respectively.
</p>


<h3>Value</h3>

<p>A workbook object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## write to working directory
write_xlsx(iris, file = temp_xlsx(), col_names = TRUE)

write_xlsx(iris,
  file = temp_xlsx(),
  col_names = TRUE
)

## Lists elements are written to individual worksheets, using list names as sheet names if available
l &lt;- list("IRIS" = iris, "MTCARS" = mtcars, matrix(runif(1000), ncol = 5))
write_xlsx(l, temp_xlsx(), col_widths = c(NA, "auto", "auto"))

## different sheets can be given different parameters
write_xlsx(l, temp_xlsx(),
  start_col = c(1, 2, 3), start_row = 2,
  as_table = c(TRUE, TRUE, FALSE), with_filter = c(TRUE, FALSE, FALSE)
)

# specify column widths for multiple sheets
write_xlsx(l, temp_xlsx(), col_widths = 20)
write_xlsx(l, temp_xlsx(), col_widths = list(100, 200, 300))
write_xlsx(l, temp_xlsx(), col_widths = list(rep(10, 5), rep(8, 11), rep(5, 5)))
</code></pre>

<hr>
<h2 id='xl_open'>Open an xlsx file or a <code>wbWorkbook</code> object</h2><span id='topic+xl_open'></span><span id='topic+xl_open.wbWorkbook'></span><span id='topic+xl_open.default'></span>

<h3>Description</h3>

<p>This function tries to open a Microsoft Excel (xls/xlsx) file or,
an <a href="#topic+wbWorkbook">wbWorkbook</a> with the proper application, in a portable manner.
</p>
<p>On Windows it uses <code>base::shell.exec()</code> (Windows only function) to
determine the appropriate program.
</p>
<p>On Mac, (c) it uses system default handlers, given the file type.
</p>
<p>On Linux, it searches (via <code>which</code>) for available xls/xlsx reader
applications (unless <code>options('openxlsx2.excelApp')</code> is set to the app bin
path), and if it finds anything, sets <code>options('openxlsx2.excelApp')</code> to the
program chosen by the user via a menu (if many are present, otherwise it
will set the only available). Currently searched for apps are
Libreoffice/Openoffice (<code>soffice</code> bin), Gnumeric (<code>gnumeric</code>) and Calligra
Sheets (<code>calligrasheets</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl_open(x, interactive = NA)

## S3 method for class 'wbWorkbook'
xl_open(x, interactive = NA)

## Default S3 method:
xl_open(x, interactive = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl_open_+3A_x">x</code></td>
<td>
<p>A path to the Excel (xls/xlsx) file or wbWorkbook object.</p>
</td></tr>
<tr><td><code id="xl_open_+3A_interactive">interactive</code></td>
<td>
<p>If <code>FALSE</code> will throw a warning and not open the path.
This can be manually set to <code>TRUE</code>, otherwise when <code>NA</code> (default) uses the
value returned from <code><a href="base.html#topic+interactive">base::interactive()</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
if (interactive()) {
  xlsx_file &lt;- system.file("extdata", "openxlsx2_example.xlsx", package = "openxlsx2")
  xl_open(xlsx_file)

  # (not yet saved) Workbook example
  wb &lt;- wb_workbook()
  x &lt;- mtcars[1:6, ]
  wb$add_worksheet("Cars")
  wb$add_data("Cars", x, start_col = 2, start_row = 3, row_names = TRUE)
  xl_open(wb)
}

</code></pre>

<hr>
<h2 id='xml_add_child'>append xml child to node</h2><span id='topic+xml_add_child'></span>

<h3>Description</h3>

<p>append xml child to node
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_add_child(xml_node, xml_child, level, pointer = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xml_add_child_+3A_xml_node">xml_node</code></td>
<td>
<p>xml_node</p>
</td></tr>
<tr><td><code id="xml_add_child_+3A_xml_child">xml_child</code></td>
<td>
<p>xml_child</p>
</td></tr>
<tr><td><code id="xml_add_child_+3A_level">level</code></td>
<td>
<p>optional level, if missing the first child is picked</p>
</td></tr>
<tr><td><code id="xml_add_child_+3A_pointer">pointer</code></td>
<td>
<p>pointer</p>
</td></tr>
<tr><td><code id="xml_add_child_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>read_xml()</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>xml_node &lt;- "&lt;a&gt;&lt;b/&gt;&lt;/a&gt;"
xml_child &lt;- "&lt;c/&gt;"

# add child to first level node
xml_add_child(xml_node, xml_child)

# add child to second level node as request
xml_node &lt;- xml_add_child(xml_node, xml_child, level = c("b"))

# add child to third level node as request
xml_node &lt;- xml_add_child(xml_node, "&lt;d/&gt;", level = c("b", "c"))

</code></pre>

<hr>
<h2 id='xml_attr_mod'>adds or updates attribute(s) in existing xml node</h2><span id='topic+xml_attr_mod'></span>

<h3>Description</h3>

<p>Needs xml node and named character vector as input. Modifies
the arguments of each first child found in the xml node and adds or updates
the attribute vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_attr_mod(
  xml_content,
  xml_attributes,
  escapes = FALSE,
  declaration = FALSE,
  remove_empty_attr = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xml_attr_mod_+3A_xml_content">xml_content</code></td>
<td>
<p>some valid xml_node</p>
</td></tr>
<tr><td><code id="xml_attr_mod_+3A_xml_attributes">xml_attributes</code></td>
<td>
<p>R vector of named attributes</p>
</td></tr>
<tr><td><code id="xml_attr_mod_+3A_escapes">escapes</code></td>
<td>
<p>bool if escapes should be used</p>
</td></tr>
<tr><td><code id="xml_attr_mod_+3A_declaration">declaration</code></td>
<td>
<p>bool if declaration should be imported</p>
</td></tr>
<tr><td><code id="xml_attr_mod_+3A_remove_empty_attr">remove_empty_attr</code></td>
<td>
<p>bool remove empty attributes or ignore them</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a named attribute in <code>xml_attributes</code> is &quot;&quot; remove the attribute
from the node.
If <code>xml_attributes</code> contains a named entry found in the xml node, it is
updated else it is added as attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # add single node
    xml_node &lt;- "&lt;a foo=\"bar\"&gt;openxlsx2&lt;/a&gt;&lt;b /&gt;"
    xml_attr &lt;- c(qux = "quux")
    # "&lt;a foo=\"bar\" qux=\"quux\"&gt;openxlsx2&lt;/a&gt;&lt;b qux=\"quux\"/&gt;"
    xml_attr_mod(xml_node, xml_attr)

  # update node and add node
    xml_node &lt;- "&lt;a foo=\"bar\"&gt;openxlsx2&lt;/a&gt;&lt;b /&gt;"
    xml_attr &lt;- c(foo = "baz", qux = "quux")
    # "&lt;a foo=\"baz\" qux=\"quux\"&gt;openxlsx2&lt;/a&gt;&lt;b foo=\"baz\" qux=\"quux\"/&gt;"
    xml_attr_mod(xml_node, xml_attr)

  # remove node and add node
    xml_node &lt;- "&lt;a foo=\"bar\"&gt;openxlsx2&lt;/a&gt;&lt;b /&gt;"
    xml_attr &lt;- c(foo = "", qux = "quux")
    # "&lt;a qux=\"quux\"&gt;openxlsx2&lt;/a&gt;&lt;b qux=\"quux\"/&gt;"
    xml_attr_mod(xml_node, xml_attr)
</code></pre>

<hr>
<h2 id='xml_node_create'>create xml_node from R objects</h2><span id='topic+xml_node_create'></span>

<h3>Description</h3>

<p>takes xml_name, xml_children and xml_attributes to create a new
xml_node.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_node_create(
  xml_name,
  xml_children = NULL,
  xml_attributes = NULL,
  escapes = FALSE,
  declaration = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xml_node_create_+3A_xml_name">xml_name</code></td>
<td>
<p>the name of the new xml_node</p>
</td></tr>
<tr><td><code id="xml_node_create_+3A_xml_children">xml_children</code></td>
<td>
<p>character vector children attached to the xml_node</p>
</td></tr>
<tr><td><code id="xml_node_create_+3A_xml_attributes">xml_attributes</code></td>
<td>
<p>named character vector of attributes for the xml_node</p>
</td></tr>
<tr><td><code id="xml_node_create_+3A_escapes">escapes</code></td>
<td>
<p>bool if escapes should be used</p>
</td></tr>
<tr><td><code id="xml_node_create_+3A_declaration">declaration</code></td>
<td>
<p>bool if declaration should be imported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if xml_children or xml_attributes should be empty, use NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xml_name &lt;- "a"
# "&lt;a/&gt;"
xml_node_create(xml_name)

xml_child &lt;- "openxlsx"
# "&lt;a&gt;openxlsx&lt;/a&gt;"
xml_node_create(xml_name, xml_children = xml_child)

xml_attr &lt;- c(foo = "baz", qux = "quux")
# "&lt;a foo=\"baz\" qux=\"quux\"/&gt;"
xml_node_create(xml_name, xml_attributes = xml_attr)

# "&lt;a foo=\"baz\" qux=\"quux\"&gt;openxlsx&lt;/a&gt;"
xml_node_create(xml_name, xml_children = xml_child, xml_attributes = xml_attr)
</code></pre>

<hr>
<h2 id='xml_rm_child'>remove xml child to node</h2><span id='topic+xml_rm_child'></span>

<h3>Description</h3>

<p>remove xml child to node
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_rm_child(xml_node, xml_child, level, which = 0, pointer = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xml_rm_child_+3A_xml_node">xml_node</code></td>
<td>
<p>xml_node</p>
</td></tr>
<tr><td><code id="xml_rm_child_+3A_xml_child">xml_child</code></td>
<td>
<p>xml_child</p>
</td></tr>
<tr><td><code id="xml_rm_child_+3A_level">level</code></td>
<td>
<p>optional level, if missing the first child is picked</p>
</td></tr>
<tr><td><code id="xml_rm_child_+3A_which">which</code></td>
<td>
<p>optional index which node to remove, if multiple are available. Default disabled all will be removed</p>
</td></tr>
<tr><td><code id="xml_rm_child_+3A_pointer">pointer</code></td>
<td>
<p>pointer</p>
</td></tr>
<tr><td><code id="xml_rm_child_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>read_xml()</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>xml_node &lt;- "&lt;a&gt;&lt;b&gt;&lt;c&gt;&lt;d/&gt;&lt;/c&gt;&lt;/b&gt;&lt;c/&gt;&lt;/a&gt;"
xml_child &lt;- "c"

xml_rm_child(xml_node, xml_child)

xml_rm_child(xml_node, xml_child, level = c("b"))

xml_rm_child(xml_node, "d", level = c("b", "c"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
