<!DOCTYPE html><html lang="en"><head><title>Help for package pointRes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pointRes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#event.plot'><p>Plot event years for individual trees</p></a></li>
<li><a href='#interval.trend'><p>Calculate pointer years using the interval trend method</p></a></li>
<li><a href='#lowpass13'><p>Apply 13-year low-pass filter</p></a></li>
<li><a href='#pointer.norm'><p>Calculate pointer years using the normalization in a moving window method</p></a></li>
<li><a href='#pointer.plot'><p>Plot pointer years for multiple sites</p></a></li>
<li><a href='#pointer.rgc'><p>Calculate pointer years using the relative growth change method</p></a></li>
<li><a href='#pointer.zchron'><p>Calculate pointer years using z-transformation of a site chronology</p></a></li>
<li><a href='#res.comp'><p>Calculate resilience indices</p></a></li>
<li><a href='#res.plot'><p>Plot resilience indices</p></a></li>
<li><a href='#s033'><p>Tree-ring series Schneetal</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing Pointer Years and Components of Resilience</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Marieke van der Maaten-Theunissen [aut, cph, cre, trl], Ernst van der Maaten [aut, trl], Gottfried Jetsckhe [aut, trl], Mario Trouillier [aut, trl]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marieke van der Maaten-Theunissen &lt;marieke.theunissen@tu-dresden.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate and plot event and pointer years as well as resilience indices. Designed for dendroecological applications, but also suitable to analyze patterns in other ecological time series.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), stats, ggplot2, dplR</td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr, TripleR, DescTools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-04 13:54:42 UTC; Marieke</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-04 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='event.plot'>Plot event years for individual trees</h2><span id='topic+event.plot'></span>

<h3>Description</h3>

<p>The function creates a dot plot showing positive and (or) negative event years from a <code>list</code> of the type as produced by <code><a href="#topic+pointer.norm">pointer.norm</a></code> or <code><a href="#topic+pointer.rgc">pointer.rgc</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event.plot(list.name, sign = c("both", "pos", "neg"),
           period = NULL, x.tick.major = 10, x.tick.minor = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="event.plot_+3A_list.name">list.name</code></td>
<td>
<p>a <code>list</code> as produced by <code><a href="#topic+pointer.norm">pointer.norm</a></code> or <code><a href="#topic+pointer.rgc">pointer.rgc</a></code></p>
</td></tr>
<tr><td><code id="event.plot_+3A_sign">sign</code></td>
<td>
<p>a <code>character</code> string specifying whether both positive and negative (<code>"both"</code>), or only positive (<code>"pos"</code>) or negative (<code>"neg"</code>) event years should be displayed. Defaults to <code>"both"</code>.</p>
</td></tr>
<tr><td><code id="event.plot_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year to be plotted. Defaults to the full period covered by the output of the pointer year analysis.</p>
</td></tr>
<tr><td><code id="event.plot_+3A_x.tick.major">x.tick.major</code></td>
<td>
<p>an <code>integer</code> controlling the major x-axis tick labels. Defaults to 10 years.</p>
</td></tr>
<tr><td><code id="event.plot_+3A_x.tick.minor">x.tick.minor</code></td>
<td>
<p>an <code>integer</code> controlling the minor x-axis ticks. Defaults to 5 years.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function makes a dot plot showing event years for individual trees. Positive and negative event years are indicated with different symbols and (or) colors.
</p>


<h3>Value</h3>

<p>Dot plot.
</p>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Plot event years from pointer.rgc output
data(s033)
py &lt;- pointer.rgc(s033)
event.plot(py) 

## Plot negative event years from pointer.norm output (method "Neuwirth") for a specific period
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 30)
pyn &lt;- pointer.norm(detr_s033, method.thresh = "Neuwirth")
event.plot(pyn, sign = "neg", period = c(1950, 2007)) 
           
</code></pre>

<hr>
<h2 id='interval.trend'>Calculate pointer years using the interval trend method</h2><span id='topic+interval.trend'></span>

<h3>Description</h3>

<p>The function calculates year-to-year growth changes for individual tree-ring series and defines interval trends for (the population of) trees using the pointer interval method according to Schweingruber et al. (1990), which is also extensively described in Jetschke et al. (2019). The minimum percentual growth change and the minimum percentage of trees that should display a negative (or positive) trend for that year to be considered as negative (or positive) pointer year, can be adjusted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval.trend(data, period = NULL, trend.thresh = 0, 
               IT.thresh = 95, make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interval.trend_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring series (raw or detrended) as columns and years as rows (e.g., output of <code>read.rwl</code> of package dplR).</p>
</td></tr>
<tr><td><code id="interval.trend_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td></tr>
<tr><td><code id="interval.trend_+3A_trend.thresh">trend.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold for a percentual growth change to be considered a trend. Defaults to 0.</p>
</td></tr>
<tr><td><code id="interval.trend_+3A_it.thresh">IT.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum percentage of trees that should display a negative (or positive) trend for that year to be considered as negative (or positive) pointer year. Defaults to 95.</p>
</td></tr>
<tr><td><code id="interval.trend_+3A_make.plot">make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a line plot, showing mean annual interval-trend values, should be created. The plot highlights positive and negative pointer years with black triangles pointing up and down, respectively. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates year-to-year growth changes. For each tree and year, the interval trend is defined as 1 if a positive change exceeds <code>trend.thresh</code>, as 0 if a negative change falls below minus <code>trend.thresh</code> and as 0.5 if the absolute change is below <code>trend.thresh</code>. <code>trend.thresh</code> defaults to 0%. The interval trend for a population is defined as the average interval trend of the individual trees. A year is considered a negative (or positive) pointer year if the percentage of trees showing a decreasing (or increasing) trend exceeds <code>IT.thresh</code> (defaults to 95%). Hence, in case of a negative pointer year the mean overall interval trend falls below 1 - <code>IT.thresh</code>, for a positive pointer year the mean overall interval trend exceeds <code>IT.thresh</code>.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>perc.diff</code></td>
<td>
<p>a <code>matrix</code> with percentual growth changes for individual tree-ring series</p>
</td></tr>
<tr><td><code>ITvalues</code></td>
<td>
<p>a <code>matrix</code> indicating positive (1), negative (0) and no interval trends (0.5) for individual tree-ring series</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), and <code>IT</code> - mean overall interval trend</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen, Ernst van der Maaten and Gottfried Jetschke.
</p>


<h3>References</h3>

<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: a critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>
<p>Schweingruber, F.H., Eckstein, D., Serre-Bachet, F. and Bräker, O.U. (1990) Identification, presentation and interpretation of event years and pointer years in dendrochronology. <em>Dendrochronologia</em> 8: 9-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate pointer years using interval.trend
## for a specified period and create a plot
data(s033)
IT &lt;- interval.trend(s033, period = c(1950,2010), make.plot = TRUE)

## Calculate pointer years as years with at least 90% of the trees
## showing a positive/negative interval trend
data(s033)
IT &lt;- interval.trend(s033, IT.thresh = 90)
IT$out[which(IT$out$nature == 1),"year"]
IT$out[which(IT$out$nature == -1),"year"]

</code></pre>

<hr>
<h2 id='lowpass13'>Apply 13-year low-pass filter</h2><span id='topic+lowpass13'></span>

<h3>Description</h3>

<p>The function applies a 13-year weighted low-pass filter, as described by Fritts (1976), on a <code>data.frame</code> with tree-ring series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lowpass13(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lowpass13_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with raw tree-ring series as columns and years as rows (e.g., output of <code>read.rwl</code> of package dplR).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A 13-year weighted low-pass filter, as described by Fritts (1976, p. 270), can be applied to tree-ring series prior to the calculation of event and pointer years using <code><a href="#topic+pointer.norm">pointer.norm</a></code>. According to Cropper (1979), such a filter improves the detection of event and pointer years for complacent series, whereas for sensitive series filtering has little effect.
</p>
<p>Note that the resulting time series are truncated by 6 years at both ends inherent to the calculation method.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> with 13-year low-pass filtered index series.
</p>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>References</h3>

<p>Cropper, J.P. (1979) Tree-ring skeleton plotting by computer. <em>Tree-Ring Bulletin</em> 39: 47-59.
</p>
<p>Fritts, H.C. (1976) Tree rings and climate. Academic Press Inc. (London) Ltd.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(s033)
lp13_s033 &lt;- lowpass13(s033)

</code></pre>

<hr>
<h2 id='pointer.norm'>Calculate pointer years using the normalization in a moving window method</h2><span id='topic+pointer.norm'></span>

<h3>Description</h3>

<p>The function calculates event and pointer years on a <code>data.frame</code> with tree-ring series using the normalization in a moving window method introduced by Cropper (1979; cf. Schweingruber et al. 1990, Jetschke et al. 2019). This method locally z-transforms tree growth in year <code><var>i</var></code> within a symmetric moving window of <code><var>n</var></code> years, thereby providing the number of standard deviations that tree growth deviates in individual years (Cropper values, Ct) from the window average. To identify event years, one absolute threshold on the number of standard deviations can be set (Cropper 1979), or, alternatively, three intensity classes (Neuwirth et al. 2007). Threshold values for defining event and pointer years can be adjusted.
</p>
<p>Prior to the calculation of event and pointer years with <code>pointer.norm</code>, a 13-year weighted low-pass filter, as described by Fritts (1976), may be applied on the tree-ring series using <code><a href="#topic+lowpass13">lowpass13</a></code>. According to Cropper (1979), such a filter improves the detection of event and pointer years for complacent series, whereas for sensitive series filtering has little effect. Alternatively, a flexible detrending (e.g., using a cubic-smoothing spline with a 50% frequency cut-off at 15 years) may be applied prior to <code>pointer.norm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointer.norm(data, period = NULL, window = 13, method.thresh = c("Cropper", "Neuwirth"),
             C.thresh = 0.75, N.thresh = c(1, 1.28, 1.645), series.thresh = 75, 
             make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointer.norm_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with detrended tree-ring series as columns and years as rows (e.g., output of <code>detrend</code> of package dplR), or a <code>data.frame</code> with filtered series (output of <code><a href="#topic+lowpass13">lowpass13</a></code>).</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_window">window</code></td>
<td>
<p>an <code>integer</code> specifying the window size (i.e. number of years) to be used to calculate normalized growth deviations. Must be an odd number (&gt;=3). Defaults to 13.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_method.thresh">method.thresh</code></td>
<td>
<p>a <code>character</code> string of <code>"Cropper"</code> or <code>"Neuwirth"</code>, specifying whether one absolute threshold or three intensity classes should be used for defining event years. Argument matching is performed.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_c.thresh">C.thresh</code></td>
<td>
<p>a (positive) <code>numeric</code> specifying the threshold for identification of event years using method <code>"Cropper"</code>. Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_n.thresh">N.thresh</code></td>
<td>
<p>a <code>vector</code> specifying the (positive) thresholds for identification of weak, strong and extreme event years using method <code>"Neuwirth"</code>. Defaults to 1, 1.28 and 1.645, respectively.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_series.thresh">series.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum percentage of trees that should display a positive (or negative) event year for that year to be considered as positive (or negative) pointer year. Defaults to 75.</p>
</td></tr>
<tr><td><code id="pointer.norm_+3A_make.plot">make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a bar plot, showing mean Cropper values, should be created. Pointer years are indicated with dark-gray bars. If event years were defined using <code>method.thresh "Neuwirth"</code> (<code><a href="#topic+pointer.norm">pointer.norm</a></code>), different tones of gray indicate weak, strong and extreme pointer years, based on the most common event year class. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function locally z-transforms tree growth in year <code><var>i</var></code> within a symmetric moving window of <code><var>n</var></code> years. For <code>method.thresh</code> <code>"Cropper"</code>, event years are defined as those years having absolute Cropper values (Ct) above a specified threshold (defaults to |Ct| &gt; 0.75). For <code>method.thresh</code> <code>"Neuwirth"</code>, three classes of distinct growth deviations can be defined, being 'weak', 'strong' and 'extreme' (defaults to |Ct| &gt; 1, |Ct| &gt; 1.28, and |Ct| &gt; 1.645). The window size can be adjusted (defaults to 13 years), as well as the minimum percentage of trees that should display a positive (or negative) event year for that year to be considered as positive (or negative) pointer year (defaults to 75%).
</p>
<p>Note that the resulting time series are truncated by <code><var>(window-1)/2</var></code> at both ends inherent to the calculation method.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<ul>
<li><p>for <code>method.thresh</code> <code>"Cropper"</code>:</p>
</li></ul>

<table role = "presentation">
<tr><td><code>Cvalues</code></td>
<td>
<p>a <code>matrix</code> with Cropper values for individual tree-ring series</p>
</td></tr>
<tr><td><code>EYvalues</code></td>
<td>
<p>a <code>matrix</code> indicating positive (1), negative (-1) and non-event years (0) for individual tree-ring series</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>perc.pos</code> - percentage of trees showing a positive event year, <code>perc.neg</code> - percentage of trees showing a negative event year, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), <code>Cvalues_mean</code> - mean Cropper value over the available series, and <code>Cvalues_sd</code> - standard deviation of Cropper values</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>
<ul>
<li><p>for <code>method.thresh</code> <code>"Neuwirth"</code>:</p>
</li></ul>

<table role = "presentation">
<tr><td><code>Cvalues</code></td>
<td>
<p>a <code>matrix</code> with Cropper values for individual tree-ring series</p>
</td></tr>
<tr><td><code>EYvalues</code></td>
<td>
<p>a <code>matrix</code> indicating weak (1/-1), strong (2/-2) and extreme (3/-3) positive/negative event years, as well as non-event years (0) for individual tree-ring series</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>perc.pos.extreme</code> - percentage of trees showing a positive extreme event year, <code>perc.pos.strong</code> - percentage of trees showing a positive strong event year, <code>perc.pos.weak</code> - percentage of trees showing a positive weak event year, <code>perc.neg.weak</code> - percentage of trees showing a negative weak event year, <code>perc.neg.strong</code> - percentage of trees showing a negative strong event year, <code>perc.neg.extreme</code> - percentage of trees showing a negative extreme event year, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), <code>Cvalues_mean</code> - mean Cropper value over the available series, <code>Cvalues_sd</code> - standard deviation of Cropper values</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>References</h3>

<p>Cropper, J.P. (1979) Tree-ring skeleton plotting by computer. <em>Tree-Ring Bulletin</em> 39: 47-59.
</p>
<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: A critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>
<p>Fritts, H.C. (1976) Tree rings and climate. Academic Press Inc. (London) Ltd.
</p>
<p>Neuwirth, B., Schweingruber, F.H. and Winiger, M. (2007) Spatial patterns of central European pointer years from 1901 to 1971. <em>Dendrochronologia</em> 24: 79-89.
</p>
<p>Schweingruber, F.H., Eckstein, D., Serre-Bachet, F. and Bräker, O.U. (1990) Identification, presentation and interpretation of event years and pointer years in dendrochronology. <em>Dendrochronologia</em> 8: 9-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate pointer years on detrended tree-ring series using method.thresh "Cropper"
## and a user-defined threshold for event-year definition of 1
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 30)
pyc &lt;- pointer.norm(detr_s033, method.thresh = "Cropper", C.thresh = 1)
head(pyc$out)

## Calculate pointer years on detrended tree-ring series using method.thresh "Neuwirth"
## and a user-defined window of 11 years
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 30)
pyn &lt;- pointer.norm(detr_s033, window = 11, method.thresh = "Neuwirth", make.plot = TRUE)
head(pyn$out)

</code></pre>

<hr>
<h2 id='pointer.plot'>Plot pointer years for multiple sites</h2><span id='topic+pointer.plot'></span>

<h3>Description</h3>

<p>The function creates a dot plot showing positive and (or) negative pointer years from <code>lists</code> of the type as produced by <code><a href="#topic+pointer.norm">pointer.norm</a></code>, <code><a href="#topic+pointer.rgc">pointer.rgc</a></code>, <code><a href="#topic+pointer.zchron">pointer.zchron</a></code> and (or) <code><a href="#topic+interval.trend">interval.trend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointer.plot(list.sites, sign = c("both", "pos", "neg"),
             period = NULL, labels = NULL,
             x.tick.major = 10, x.tick.minor = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointer.plot_+3A_list.sites">list.sites</code></td>
<td>
<p>a <code>list</code> with <code>lists</code> as produced by <code><a href="#topic+pointer.norm">pointer.norm</a></code>, <code><a href="#topic+pointer.rgc">pointer.rgc</a></code>, <code><a href="#topic+pointer.zchron">pointer.zchron</a></code> or <code><a href="#topic+interval.trend">interval.trend</a></code> for individual sites (created using list(site1, site2,..)).</p>
</td></tr>
<tr><td><code id="pointer.plot_+3A_sign">sign</code></td>
<td>
<p>a <code>character</code> string specifying whether both positive and negative (<code>"both"</code>), or only positive (<code>"pos"</code>) or negative (<code>"neg"</code>) pointer years should be displayed. Defaults to <code>"both"</code>.</p>
</td></tr>
<tr><td><code id="pointer.plot_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year to be plotted. Defaults to the full period covered by the output of the pointer year analyses.</p>
</td></tr>
<tr><td><code id="pointer.plot_+3A_labels">labels</code></td>
<td>
<p>a <code>character</code> vector with labels for the sites. Defaults to 'site 1, 2, .., <code><var>i</var></code>'.</p>
</td></tr>
<tr><td><code id="pointer.plot_+3A_x.tick.major">x.tick.major</code></td>
<td>
<p>an <code>integer</code> controlling the major x-axis tick labels. Defaults to 10 years.</p>
</td></tr>
<tr><td><code id="pointer.plot_+3A_x.tick.minor">x.tick.minor</code></td>
<td>
<p>an <code>integer</code> controlling the minor x-axis ticks. Defaults to 5 years.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function makes a dot plot showing pointer years for multiple sites. Positive and negative pointer years are indicated with different symbols an (or) colors.
</p>


<h3>Value</h3>

<p>Dot plot.
</p>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Plot negative pointer years for multiple sites (or different methods)
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 30)
py &lt;- pointer.rgc(s033)
pyn &lt;- pointer.norm(detr_s033, method = "Neuwirth")
it &lt;- interval.trend(s033)
zchron &lt;- pointer.zchron(detr_s033)
comparison &lt;- list(py, pyn, it, zchron)
pointer.plot(comparison, sign = "neg", period = c(1950, 2013),
             labels = c("py", "pyn", "it", "zchron")) 

## Plot pointer years for different specifications of pointer.norm (method "Neuwirth")
data(s033)
w09 &lt;- pointer.norm(detr_s033, window = 9, method.thresh = "Neuwirth")
w11 &lt;- pointer.norm(detr_s033, window = 11, method.thresh = "Neuwirth")
w13 &lt;- pointer.norm(detr_s033, method.thresh = "Neuwirth")
comparison &lt;- list(w09, w11, w13)
pointer.plot(comparison, period = c(1950, 2007)) 
           
</code></pre>

<hr>
<h2 id='pointer.rgc'>Calculate pointer years using the relative growth change method</h2><span id='topic+pointer.rgc'></span>

<h3>Description</h3>

<p>The function calculates event and pointer years on a <code>data.frame</code> with tree-ring series using the relative growth change method, described as abrupt growth change method in Schweingruber et al. (1990). This method relates tree growth in year <code><var>i</var></code> to the average growth of <code><var>n</var></code> preceding years. Thresholds for event- and pointer-year calculations can be adjusted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointer.rgc(data, period = NULL, nb.yrs = 4, rgc.thresh.pos = 60, rgc.thresh.neg = 40, 
            series.thresh = 75, make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointer.rgc_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring series (raw or detrended) as columns and years as rows (e.g., output of <code>read.rwl</code> or <code>detrend</code> of package dplR).</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_nb.yrs">nb.yrs</code></td>
<td>
<p>an <code>integer</code> specifying the number of preceding years to be used in calculating relative growth changes. Defaults to 4.</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_rgc.thresh.pos">rgc.thresh.pos</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold above which a relative growth change (in percentage) for a specific tree and year is considered a positive event year. Defaults to 60.</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_rgc.thresh.neg">rgc.thresh.neg</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold below which a relative growth change (in percentage) for a specific tree and year is considered a negative event year. Defaults to 40.</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_series.thresh">series.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum percentage of trees that should display a positive (or negative) event year for that year to be considered as positive (or negative) pointer year. Defaults to 75.</p>
</td></tr>
<tr><td><code id="pointer.rgc_+3A_make.plot">make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a bar plot, showing mean relative growth changes, should be created. Pointer years are indicated with dark-gray bars. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the ratio of tree growth in year <code><var>t</var></code> and the average growth of <code><var>n</var></code> preceding years for individual trees. Resulting relative growth changes are used to identify event years for trees, and these event years to define pointer years for the site.
</p>
<p>Following Schweingruber et al. (1990), <code><var>nb.yrs</var></code>, <code><var>rgc.thresh.pos</var></code>, <code><var>rgc.thresh.neg</var></code> and <code><var>series.thresh</var></code> are set to 4, 60, 40 and 75 respectively, meaning that a positive or negative pointer year will be defined when at least 75% of the tree-ring series display an event year with a growth increase or decrease of at least 60% or 40%, respectively, relative to the average growth in the four preceding years. Depending on the sensitivity of the tree-ring series, the thresholds <code><var>rgc.thresh.pos</var></code> and <code><var>rgc.thresh.neg</var></code> may be adjusted (e.g., lowered for more complacent series; Jetschke et al. 2019).
</p>
<p>Note that the resulting time series are truncated by <code><var>nb.yrs</var></code> at the beginning inherent to the calculation method.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>rgc</code></td>
<td>
<p>a <code>matrix</code> with relative growth changes for individual tree-ring series</p>
</td></tr>
<tr><td><code>EYvalues</code></td>
<td>
<p>a <code>matrix</code> indicating positive (1), negative (-1) and non-event years (0) for individual tree-ring series</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>perc.pos</code> - percentage of trees showing a positive event year, <code>perc.neg</code> - percentage of trees showing a negative event year, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), <code>dev_mean</code> - mean growth deviation in percentage over the available series for each year, and <code>dev_sd</code> - standard deviation of the growth deviation for each year</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>References</h3>

<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: A critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>
<p>Schweingruber, F.H., Eckstein, D., Serre-Bachet, F. and Bräker, O.U. (1990) Identification, presentation and interpretation of event years and pointer years in dendrochronology. <em>Dendrochronologia</em> 8: 9-38.
</p>
<p>In writing the function, the code of the dplR function <code>pointer</code> (Pierre Mérian) was used as a reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate pointer years on tree-ring series
data(s033)
py1 &lt;- pointer.rgc(s033)
head(py1$out)

## Calculate pointer years with user-defined arguments
data(s033)
py2 &lt;- pointer.rgc(s033, period = c(1950,2010), nb.yrs = 5, rgc.thresh.pos = 50,
                   rgc.thresh.neg = 50, series.thresh = 50, make.plot = TRUE)
head(py2$out)

</code></pre>

<hr>
<h2 id='pointer.zchron'>Calculate pointer years using z-transformation of a site chronology</h2><span id='topic+pointer.zchron'></span>

<h3>Description</h3>

<p>The function calculates pointer years on a <code>data.frame</code> of tree-ring series using a z-transformation of the site chronology (by default based on a biweight robust mean). The method provides the number of standard deviations that the chronology deviates in individual years. To identify pointer years, one absolute threshold on the number of standard deviations can be set. Optionally, a t-test can be applied to test whether the z-transformed chronology significantly exceeds the selected threshold. The function is intended to use on flexibly detrended data, e.g., with a cubic-smoothing spline with a 50% frequency cut-off at 15 years (cf. Jetschke et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointer.zchron(data, period = NULL, bi.weight = TRUE,
               z.thresh = 1, t.Test = FALSE, make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointer.zchron_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with detrended tree-ring series as columns and years as rows (e.g., output of <code>detrend</code> of package dplR).</p>
</td></tr>
<tr><td><code id="pointer.zchron_+3A_period">period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td></tr>
<tr><td><code id="pointer.zchron_+3A_bi.weight">bi.weight</code></td>
<td>
<p>a <code>logical</code> flag specifying whether a Tukey's biweight robust mean site chronology should be calculated. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="pointer.zchron_+3A_z.thresh">z.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold for identification of pointer years. Defaults to 1.</p>
</td></tr>
<tr><td><code id="pointer.zchron_+3A_t.test">t.Test</code></td>
<td>
<p>a <code>logical</code> flag specifying whether a t-test should be performed. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pointer.zchron_+3A_make.plot">make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a bar plot indicating pointer years should be created. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function develops a site chronology, which is z-transformed over its entire length, thereby providing the number of standard deviations that the chronology deviates in individual years. In developing the site chronology, a normal or biweight robust mean can be used. A threshold <code>z.thresh</code> on the minimum number of standard deviations can be set (cf. Cropper 1979) to define the years to be considered as pointer years. 
Optionally, a t-test may be performed to test whether the z-transformed chronology significantly differs from the selected threshold value in a particular year. Therefore, individual tree-ring series are z-transformed as well and compared to the threshold value <code>z.thresh</code>. In case a biweight robust mean is used in building the site chronology, the t-test is based on the biweight robust estimate of the standard deviation. In all t-tests a significance level of 0.05 is used.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>TRIsite</code></td>
<td>
<p>a <code>data.frame</code> with the calculated site chronology and corresponding sample depth (output of <code>chron</code> of package dplR)</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), and <code>AVGztrans</code> - z-transformed site chronology</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen, Ernst van der Maaten and Gottfried Jetschke.
</p>


<h3>References</h3>

<p>Cropper, J.P. (1979) Tree-ring skeleton plotting by computer. <em>Tree-Ring Bulletin</em> 39: 47-59.
</p>
<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: A critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate pointer years on detrended tree-ring series
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 15)
pz1 &lt;- pointer.zchron(detr_s033)
head(pz1$out)

## Calculate pointer years with user-defined arguments
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 15)
pz2 &lt;- pointer.zchron(detr_s033, period = c(1950,2010), z.thresh = 1.28,
                      make.plot = TRUE)
head(pz2$out)

</code></pre>

<hr>
<h2 id='res.comp'>Calculate resilience indices</h2><span id='topic+res.comp'></span>

<h3>Description</h3>

<p>The function calculates resilience indices on a <code>data.frame</code>, e.g., of tree-ring series, after Lloret et al. (2011; i.e. resistance, recovery, (relative) resilience), Thurm et al. (2016; recovery period, total growth reduction) and Schwarz et al. (2020; average growth reduction, average recovery rate), useful to analyze growth responses of individual trees prior, during and after extreme events / disturbances. The component 'resistance' is conceptually identical to 'abrupt growth changes' as described in Schweingruber et al. (1990; cf. <code><a href="#topic+pointer.rgc">pointer.rgc</a></code>). 'Recovery' is the ability of tree growth to recover after disturbance, whereas 'resilience' reflects the ability of trees to reach pre-disturbance growth levels. Weighting of the resilience by the experienced growth reduction results in 'relative resilience'. 'Recovery period' (or: 'growth recovery time') is the time needed to reach pre-disturbance growth levels again. 'Total growth reduction' reflects the cumulative growth reduction in the year of disturbance as well as the associated years in the recovery period. 'Average growth reduction' is the total growth reduction divided by the length of the recovery period. 'Average recovery rate' is the mean percentual recovery over the recovery period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>res.comp(data, nb.yrs = c(4,4), max.yrs.rec = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="res.comp_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring series (raw or detrended) as columns and years as rows (e.g., output of <code>read.rwl</code>, <code>bai.in</code> or <code>bai.out</code> of package dplR)</p>
</td></tr>
<tr><td><code id="res.comp_+3A_nb.yrs">nb.yrs</code></td>
<td>
<p>a <code>vector</code> specifying the number of years for pre- and post-disturbance periods to be considered in calculating resilience components after Lloret et al. (2011). Defaults to 4 for both periods.</p>
</td></tr>
<tr><td><code id="res.comp_+3A_max.yrs.rec">max.yrs.rec</code></td>
<td>
<p>a <code>numeric</code> specifying the maximum length of the recovery period to be considered. Defaults to 10.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates various resilience indices after Lloret et al. (2011), Thurm et al. (2016) and Schwarz et al. (2020). The output provides different matrices with resilience indices for individual tree-ring series and years.
</p>
<p>In calculating resilience indices the number of pre- and post disturbance years (<code><var>nb.yrs</var></code>), as well as the maximum number of years to be considered in defining the recovery period (<code><var>max.yrs.rec</var></code>) can be specified.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table role = "presentation">
<tr><td><code>resist</code></td>
<td>
<p>a <code>matrix</code> with resistance values (i.e. relative growth changes) for individual tree-ring series</p>
</td></tr>
<tr><td><code>recov</code></td>
<td>
<p>a <code>matrix</code> with recovery values for individual tree-ring series</p>
</td></tr>
<tr><td><code>resil</code></td>
<td>
<p>a <code>matrix</code> with resilience values for individual tree-ring series</p>
</td></tr>
<tr><td><code>rel.resil</code></td>
<td>
<p>a <code>matrix</code> with relative resilience values for individual tree-ring series</p>
</td></tr>
<tr><td><code>rec.period</code></td>
<td>
<p>a <code>matrix</code> with recovery periods for individual tree-ring series in years with decimal places (cf. Fig. 2 in Thurm et al. 2016). In case of no growth reduction (and thus no recovery), 0 is given as output. Inf indicates that no recovery occurred within the period as specified by <code><var>max.yrs.rec</var></code></p>
</td></tr>
<tr><td><code>avg.rec.rate</code></td>
<td>
<p>a <code>matrix</code> with average recovery rates for individual tree-ring series as percentage, calculated as 1 / <code><var>rec.period</var></code> * 100. In case of no growth reduction (and thus no recovery), NA is given as output. Inf indicates that no recovery occurred within the period as specified by <code><var>max.yrs.rec</var></code></p>
</td></tr>
<tr><td><code>tot.abs.grow.red</code></td>
<td>
<p>a <code>matrix</code> with total absolute growth reduction values for individual tree-ring series. 0 and Inf are given as output as for <code><var>rec.period</var></code></p>
</td></tr>
<tr><td><code>tot.rel.grow.red</code></td>
<td>
<p>a <code>matrix</code> with total growth reduction for individual tree-ring series expressed as percentage. 0 and Inf are given as output as for <code><var>rec.period</var></code></p>
</td></tr>
<tr><td><code>avg.abs.grow.red</code></td>
<td>
<p>a <code>matrix</code> with average absolute growth reduction, i.e. total absolute growth reduction divided by the number of full years needed for recovery. 0 and Inf are given as output as for <code><var>rec.period</var></code></p>
</td></tr>
<tr><td><code>avg.rel.grow.red</code></td>
<td>
<p>a <code>matrix</code> with average growth reduction expressed as percentage. 0 and Inf are given as output as for <code><var>rec.period</var></code></p>
</td></tr>
<tr><td><code>nb.series</code></td>
<td>
<p>a <code>data.frame</code> with the number of series for which the diverse indices could be calculated, with years in rows and indices in columns</p>
</td></tr>
<tr><td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen, Ernst van der Maaten and Mario Trouillier.
</p>


<h3>References</h3>

<p>Lloret, F., Keeling, E.G. and Sala, A. (2011) Components of tree resilience: effects of successive low-growth episodes in old ponderosa pine forests. <em>Oikos</em> 120: 1909-1920.
</p>
<p>Schwarz, J., Skiadaresis, G., Kohler, M., Kunz, J., Schnabel, F., Vitali, V. and Bauhus, J. (2020) Quantifying growth responses of trees to drought — a critique of commonly used resilience indices and recommendations for future studies. <em>Current Forestry Reports</em> 6: 185-200.
</p>
<p>Schweingruber, F.H., Eckstein, D., Serre-Bachet, F. and Bräker, O.U. (1990) Identification, presentation and interpretation of event years and pointer years in dendrochronology. <em>Dendrochronologia</em> 8: 9-38.
</p>
<p>Thurm, E.A., Uhl, E. and Pretzsch, H. (2016) Mixture reduces climate sensitivity of Douglas-fir stem growth. <em>Forest Ecology and Management</em> 376: 205-220.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate resilience indices on tree-ring series
data(s033)
res &lt;- res.comp(s033)

</code></pre>

<hr>
<h2 id='res.plot'>Plot resilience indices</h2><span id='topic+res.plot'></span>

<h3>Description</h3>

<p>The function creates box plots for selected years of the resilience indices as calculated by <code><a href="#topic+res.comp">res.comp</a></code>, and is intended for quick visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>res.plot(list.name, select.yr = NULL,
         param = c("resist", "recov", "resil", "rel.resil",
                   "rec.period", "avg.rec.rate",
                   "tot.abs.grow.red", "tot.rel.grow.red",
                   "avg.abs.grow.red", "avg.rel.grow.red"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="res.plot_+3A_list.name">list.name</code></td>
<td>
<p>a <code>list</code> as produced by <code><a href="#topic+res.comp">res.comp</a></code>.</p>
</td></tr>
<tr><td><code id="res.plot_+3A_select.yr">select.yr</code></td>
<td>
<p>an <code>integer</code> or <code>vector</code> specifying the year(s) to be plotted (e.g., c(1948, 1992)).</p>
</td></tr>
<tr><td><code id="res.plot_+3A_param">param</code></td>
<td>
<p>a <code>character</code> string specifying the resilience index to be plotted. Argument matching is performed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a box plot for a selected resilience index showing the full range of variation for individual trees in specific years. Box plots are only created for years for which indices are available for &gt;= 5 series, as this value represents the number of statistics that a box plot represents in its' simplest form.
</p>


<h3>Value</h3>

<p>Box plot.
</p>


<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Plot the recovery period for three selected years
data(s033)
res &lt;- res.comp(s033)
res.plot(res, select.yr = c(1976, 1992, 2003), param = "resist")

</code></pre>

<hr>
<h2 id='s033'>Tree-ring series Schneetal</h2><span id='topic+s033'></span>

<h3>Description</h3>

<p>This dataset presents tree-ring series for 20 European beech (<em>Fagus sylvatica</em> L.) trees from the forest reserve Schneetal, Bavaria, Germany. Series are averages of two cores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(s033)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 20 tree-ring series in columns and 136 years in rows.
</p>


<h3>References</h3>

<p>Principe, A.S., van der Maaten, E., van der Maaten-Theunissen, M., Struwe, T., Wilmking, M. &amp; Kreyling, J. (2017) Low resistance but high resilience in growth of a major deciduous forest tree (<em>Fagus sylvatica</em> L.) in response to late spring frost in southern Germany. <em>Trees</em> 31: 743-751. doi: 10.1007/s00468-016-1505-3.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
