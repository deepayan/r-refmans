<!DOCTYPE html><html><head><title>Help for package CFO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CFO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aCFO.next'><p>Determination of the dose level for next cohort in the accumulative calibration-free odds (aCFO) design</p></a></li>
<li><a href='#CFO.next'><p>Determination of the dose level for next cohort in the calibration-free odds (CFO) design</p></a></li>
<li><a href='#CFO.oc'><p>Generate operating characteristics of sigle-drug trials in multiple simulations</p></a></li>
<li><a href='#CFO.selectmtd'><p>Select the maximum tolerated dose (MTD) for the real single-drug trial</p></a></li>
<li><a href='#CFO.simu'><p>Conduct one simulation using the Calibration-free odds (CFO) or accumulative CFO (aCFO) design.</p></a></li>
<li><a href='#CFO2d.next'><p>Determinate the dose level for the next cohort in the two-dimensional calibration-free odds (2dCFO) design.</p></a></li>
<li><a href='#CFO2d.oc'><p>Generate operating characteristics of drug-combination trials in multiple simulations</p></a></li>
<li><a href='#CFO2d.selectmtd'><p>Select the maximum tolerated dose (MTD) for the real drug combination trial</p></a></li>
<li><a href='#CFO2d.simu'><p>Conduct one simulation using the two-dimensional calibration-free odds (2dCFO) design.</p></a></li>
<li><a href='#lateonset.next'><p>Determination of the dose level for next cohort in the calibration-free odds type (CFO-type) design with late-onset toxicity</p></a></li>
<li><a href='#lateonset.simu'><p>Conduct one simulation using the calibration-free odds type (CFO-type) design with late-onset toxicity.</p></a></li>
<li><a href='#plot.cfo'><p>Plot the results by other functions</p></a></li>
<li><a href='#print.cfo'><p>Generate descriptive summary for objects returned by other functions</p></a></li>
<li><a href='#summary.cfo'><p>Generate descriptive summary for objects returned by other functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>CFO-Type Designs in Phase I Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival,dplyr,ggplot2,Iso</td>
</tr>
<tr>
<td>Description:</td>
<td>In phase I clinical trials, the primary objective is to ascertain the maximum tolerated dose (MTD) corresponding to a specified target toxicity rate. The 'CFO' package facilitates the implementation of dose-finding trials by utilizing calibration-free odds type (CFO-type) designs. Specifically, it encompasses the calibration-free odds (CFO) (Jin and Yin (2022) &lt;<a href="https://doi.org/10.1177%2F09622802221079353">doi:10.1177/09622802221079353</a>&gt;), two-dimensional CFO (2dCFO) (Wang et al. (2023) &lt;<a href="https://doi.org/10.3389%2Ffonc.2023.1294258">doi:10.3389/fonc.2023.1294258</a>&gt;), time-to-event CFO (TITE-CFO) (Jin and Yin (2023) &lt;<a href="https://doi.org/10.1002%2Fpst.2304">doi:10.1002/pst.2304</a>&gt;), fractional CFO (fCFO), accumulative CFO (aCFO), TITE-aCFO, and f-aCFO designs. The ‘CFO' package accommodates diverse CFO-type designs, allowing users to tailor the approach based on factors such as dose information inclusion, handling of late-onset toxicity, and the nature of the target drug (single-drug or drug-combination). The functionalities embedded in 'CFO' package include the determination of the dose level for the next cohort, the selection of the MTD for a real trial, and the execution of single or multiple simulations to obtain operating characteristics. Moreover, these functions are equipped with early stopping and dose elimination rules to address safety considerations. Users have the flexibility to choose different distributions, thresholds, and cohort sizes among others for their specific needs. The output of the 'CFO' package can be summary statistics as well as various plots for better visualization. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-05 15:22:31 UTC; nikkifang</td>
</tr>
<tr>
<td>Author:</td>
<td>Jialu Fang [aut, cre],
  Wenliang Wang [aut],
  Guosheng Yin [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jialu Fang &lt;u3008682@connect.hku.hk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 15:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='aCFO.next'>Determination of the dose level for next cohort in the accumulative calibration-free odds (aCFO) design</h2><span id='topic+aCFO.next'></span>

<h3>Description</h3>

<p>In the aCFO design, the function is used to determine the dose movement based on the toxicity outcomes of the enrolled cohorts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aCFO.next(target, ays, ans, currdose, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target),
       cutoff.eli = 0.95, early.stop = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aCFO.next_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_ays">ays</code></td>
<td>
<p>the cumulative numbers of DLTs observed in patients for all dose levels.</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_ans">ans</code></td>
<td>
<p>the cumulative numbers of patients for all dose levels.</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_currdose">currdose</code></td>
<td>
<p>the current dose level.</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="aCFO.next_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The aCFO design is an extension of the CFO design. It integrates dose information from all positions (ranging
from the lowest to the highest dose levels) into the decision-making process of the trial. Before assigning the dose level
for a new cohort, aCFO compares the evidence from the current dose level with all doses to its left and right. In contrast,
the original CFO design makes dose allocation by examining one dose level above and one below the current dose level.
Consequently, the aCFO design enhances the utilization of information while maintaining the characteristics of the CFO
design (model-free and calibration-free). Additionally, the aCFO design preserves the same early stopping and dose
elimination criteria as the CFO design.
</p>


<h3>Value</h3>

<p>The <code>aCFO.next()</code> function returns a list object comprising the following elements:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> ays: the cumulative counts of DLTs observed at all dose levels.
</p>
</li>
<li><p> ans: the cumulative counts of patients treated at all dose levels.
</p>
</li>
<li><p> decision: the decision in the aCFO design, where <code>left</code>, <code>stay</code>, and <code>right</code> represent the
movement directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li><p> currdose: the current dose level.
</p>
</li>
<li><p> nextdose: the recommended dose level for the next cohort. <code>nextdose = 99</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li><p> overtox: the situation regarding which position experiences over-toxicity. The dose level indicated by
<code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that the
occurrence of over-toxicity did not happen.
</p>
</li></ul>



<h3>Note</h3>

<p>The dose level indicated by <code>overtox</code> and all the dose levels above experience over-toxicity, and these dose levels will be eliminated.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## determine the dose level for the next cohort of new patients
ays &lt;- c(0, 0, 1, 0, 0, 0, 0); ans &lt;- c(3, 3, 6, 0, 0, 0, 0)
decision &lt;- aCFO.next(target = 0.2, ays = ays, ans = ans, currdose = 3, 
            prior.para = list(alp.prior = 0.2, bet.prior = 0.8))
summary(decision)

ays &lt;- c(3, 0, 0, 0, 0, 0, 0); ans &lt;- c(3, 0, 0, 0, 0, 0, 0)
decision &lt;- aCFO.next(target = 0.2, ays = ays, ans = ans, currdose = 1,
            prior.para = list(alp.prior = 0.2, bet.prior = 0.8))
summary(decision)

ays &lt;- c(0, 0, 0, 0, 0, 0, 3); ans &lt;- c(3, 3, 3, 3, 3, 3, 3)
decision &lt;- aCFO.next(target = 0.2, ays = ays, ans = ans, currdose = 7,
            prior.para = list(alp.prior = 0.2, bet.prior = 0.8))
summary(decision)

</code></pre>

<hr>
<h2 id='CFO.next'>Determination of the dose level for next cohort in the calibration-free odds (CFO) design</h2><span id='topic+CFO.next'></span>

<h3>Description</h3>

<p>In the CFO design, the function is used to determine the dose movement based on the toxicity outcomes of the enrolled cohorts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO.next(target, cys, cns, currdose, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target),
       cutoff.eli = 0.95, early.stop = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO.next_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_cys">cys</code></td>
<td>
<p>the cumulative numbers of DLTs observed at the left, current, and right dose levels.</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_cns">cns</code></td>
<td>
<p>the cumulative numbers of patients treated at the left, current, and right dose levels.</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_currdose">currdose</code></td>
<td>
<p>the current dose level.</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO.next_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The CFO design determines the dose level for the next cohort by assessing evidence from the current
dose level and its adjacent levels. This evaluation is based on odds ratios denoted as <code class="reqn">O_k</code>, where
<code class="reqn">k = L, C, R</code> represents left, current (central), and right dose levels. Additionally, we define <code class="reqn">\overline{O}_k = 1/O_k</code>.
The ratio <code class="reqn">O_C / \overline{O}_{L}</code> indicates the inclination for de-escalation, while <code class="reqn">\overline{O}_C / O_R</code>
quantifies the tendency for escalation. Threshold values <code class="reqn">\gamma_L</code> and <code class="reqn">\gamma_R</code> are chosen to
minimize the probability of making incorrect decisions. The decision process is summarized in Table 1
of Jin and Yin (2022).
The early stopping and dose elimination rules are implemented to ensure patient safety. If the data suggest excessive
toxicity at the current dose level, we exclude that dose level and those higher levels. If the lowest dose level is overly toxic,
the trial will be terminated according to the early stopping rule.
</p>


<h3>Value</h3>

<p>The <code>CFO.next()</code> function returns a list object comprising the following elements:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> cys: the cumulative counts of DLTs observed at the left, current, and right dose levels.
</p>
</li>
<li><p> cns: the cumulative counts of patients treated at the left, current, and right dose levels.
</p>
</li>
<li><p> decision: the decision in the CFO design, where <code>left</code>, <code>stay</code>, and <code>right</code> represent the
movement directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li><p> currdose: the current dose level.
</p>
</li>
<li><p> nextdose: the recommended dose level for the next cohort. <code>nextdose = 99</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li><p> overtox: the situation regarding which positions experience over-toxicity. The dose level indicated
by <code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that
the occurrence of over-toxicity did not happen.
</p>
</li></ul>



<h3>Note</h3>

<p>When the current dose level is the lowest or highest (i.e., at the boundary), the parts in <code>cys</code> and
<code>cns</code> where there is no data are filled with <code>NA</code>. <br />
The dose level indicated by <code>overtox</code> and all the dose levels above experience over-toxicity, and these dose levels will be eliminated.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## determine the dose level for the next cohort of new patients
cys &lt;- c(0, 1, 0); cns &lt;- c(3, 6, 0)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=3)
summary(decision)

cys &lt;- c(NA, 3, 0); cns &lt;- c(NA, 3, 0)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=1)
summary(decision)

cys &lt;- c(0, 3, NA); cns &lt;- c(3, 3, NA)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=7)
summary(decision)

</code></pre>

<hr>
<h2 id='CFO.oc'>Generate operating characteristics of sigle-drug trials in multiple simulations</h2><span id='topic+CFO.oc'></span>

<h3>Description</h3>

<p>This function is used to perform multiple simulations for single-drug trials and obtain relevant operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO.oc(nsimu = 5000, design, target, p.true, init.level = 1, ncohort, cohortsize,
       assess.window = NA, tte.para = NA, accrual.rate = NA, accrual.dist = NA, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target),
       cutoff.eli = 0.95, early.stop = 0.95, seeds = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO.oc_+3A_nsimu">nsimu</code></td>
<td>
<p>the total number of trials to be simulated. The default value is 5000.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_design">design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'CFO'</code>, <code>'aCFO'</code>,
<code>'TITE-CFO'</code>, <code>'TITE-aCFO'</code>, <code>'fCFO'</code>, <code>'f-aCFO'</code>, <code>'bCFO'</code>,
and <code>'b-aCFO'</code>. Specifically, <code>'bCFO'</code> refers to the benchmark CFO design, and
<code>'b-aCFO'</code> denotes the benchmark aCFO design.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_p.true">p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_init.level">init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is 1.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_assess.window">assess.window</code></td>
<td>
<p>the maximal assessment window size. <code>NA</code> should be assigned if the design without late-oneset outcomes.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_tte.para">tte.para</code></td>
<td>
<p>the parameter related with the distribution of the time to DLT events. The time to DLT is sampled from a Weibull
distribution, with <code>tte.para</code> representing the proportion of DLTs occurring within the first half of the
assessment window. <code>NA</code> should be assigned if the design without late-oneset outcomes.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_accrual.rate">accrual.rate</code></td>
<td>
<p>the accrual rate, i.e., the number of patients accrued per unit time. <code>NA</code> should be assigned
if the design without late-onset outcomes.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_accrual.dist">accrual.dist</code></td>
<td>
<p>the distribution of the arrival times of patients. When <code>accrual.dist = 'fix'</code>, it corresponds to all
patients in each cohort arriving simultaneously at a given accrual rate. When <code>accrual.dist = 'unif'</code>,
it corresponds to a uniform distribution, and when <code>accrual.dist = 'exp'</code>, it corresponds to an
exponential distribution. <code>NA</code> should be assigned if the design without late-oneset outcomes.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO.oc_+3A_seeds">seeds</code></td>
<td>
<p>A vector of random seeds for each simulation, for example, <code>seeds = 1:nsimu</code> (default is NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>CFO.oc()</code> function returns basic setup of ($simu.setup) and the operating
characteristics of the design: <br />
</p>

<ul>
<li><p> p.true: the true DLT rates under the different dose levels.
</p>
</li>
<li><p> selpercent: the selection percentage at each dose level.
</p>
</li>
<li><p> npatients: the averaged number of patients treated at each dose level in one simulation.
</p>
</li>
<li><p> ntox: the averaged number of toxicity observed at each dose level in one simulation.
</p>
</li>
<li><p> MTDsel: the percentage of correct selection of the MTD.
</p>
</li>
<li><p> MTDallo: the percentage of patients allocated to the MTD.
</p>
</li>
<li><p> oversel: the percentage of selecting a dose above the MTD.
</p>
</li>
<li><p> overallo: the percentage of allocating patients at dose levels above the MTD.
</p>
</li>
<li><p> averDLT: the percentage of the patients suffering DLT.
</p>
</li>
<li><p> averdur: the average trial duration if trials with late-onset toxicities.
</p>
</li>
<li><p> percentstop: the percentage of early stopping without selecting the MTD.
</p>
</li>
<li><p> simu.setup: the parameters for the simulation set-up.
</p>
</li></ul>



<h3>Note</h3>

<p>The operating characteristics are generated by simulating multiple single-drug trials under the
pre-specified true toxicity probabilities of the investigational doses. The choice of which design to execute
is determined by setting the <code>design</code> argument. Some time-related arguments (<code>assess.window</code>, <code>accrual.rate</code>,
<code>tte.para</code>, and <code>accrual.dist</code>) need to be set as values only when running a design that can handle late-onset
toxicities; otherwise, they default to <code>NA</code>.<br />
Additionally, in the example, we set <code>nsimu = 5</code> for testing time considerations. In reality, <code>nsimu</code>
is typically set to 5000 to ensure the accuracy of the results.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Jin H, Yin G (2023). Time‐to‐event calibration‐free odds design: A robust efficient design for
phase I trials with late‐onset outcomes. <em>Pharmaceutical Statistics</em>. 22(5), 773–783.<br />
Yin G, Zheng S, Xu J (2013). Fractional dose-finding methods with late-onset toxicity in
phase I clinical trials. <em>Journal of Biopharmaceutical Statistics</em>, 23(4), 856-870.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## setting
nsimu &lt;- 5; target &lt;- 0.2; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
prior.para = list(alp.prior = target, bet.prior = 1 - target)
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'


## get the operating characteristics for 5 simulations using the f-aCFO design
faCFOoc &lt;- CFO.oc (nsimu, design='f-aCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(faCFOoc)
plot(faCFOoc)


# This test may take longer than 5 seconds to run
# It is provided for illustration purposes only
# Users can run this code directly

## get the operating characteristics for 5 simulations using the CFO design
CFOoc &lt;- CFO.oc (nsimu, design = 'CFO', target, p.true, init.level, ncohort, cohortsize,
         assess.window = NA, tte.para = NA, accrual.rate = NA, accrual.dist = NA, seeds = 1:nsimu)
summary(CFOoc)
plot(CFOoc)

## get the operating characteristics for 5 simulations using the aCFO design
aCFOoc &lt;- CFO.oc (nsimu, design = 'aCFO', target, p.true, init.level, ncohort, cohortsize,
       assess.window = NA, tte.para = NA, accrual.rate = NA, accrual.dist = NA, seeds = 1:nsimu)
summary(aCFOoc)
plot(aCFOoc)
## get the operating characteristics for 5 simulations using the TITE-CFO design
TITECFOoc &lt;- CFO.oc (nsimu, design = 'TITE-CFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(TITECFOoc)
plot(TITECFOoc)
## get the operating characteristics for 5 simulations using the TITE-aCFO design
TITEaCFOoc &lt;- CFO.oc (nsimu, design = 'TITE-aCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(TITEaCFOoc)
plot(TITEaCFOoc)
## get the operating characteristics for 5 simulations using the fCFO design
fCFOoc &lt;- CFO.oc (nsimu, design = 'fCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(fCFOoc)
plot(fCFOoc)
## get the operating characteristics for 5 simulations using the bCFO design
bCFOoc &lt;- CFO.oc (nsimu, design = 'bCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(bCFOoc)
plot(bCFOoc)
## get the operating characteristics for 5 simulations using the b-aCFO design
baCFOoc &lt;- CFO.oc (nsimu, design = 'b-aCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(baCFOoc)
plot(baCFOoc)

</code></pre>

<hr>
<h2 id='CFO.selectmtd'>Select the maximum tolerated dose (MTD) for the real single-drug trial</h2><span id='topic+CFO.selectmtd'></span>

<h3>Description</h3>

<p>Select the maximum tolerated dose (MTD) when the real single-drug trial is completed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO.selectmtd(target, npts, ntox, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO.selectmtd_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_npts">npts</code></td>
<td>
<p>a vector containing the number of patients treated at each dose level.</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_ntox">ntox</code></td>
<td>
<p>a vector containing the number of patients who experienced DLT at each dose level.</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO.selectmtd_+3A_verbose">verbose</code></td>
<td>
<p>set <code>verbose=TRUE</code> to return more details of the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CFO.selectmtd()</code> selects the MTD based on isotonic estimates of toxicity
probabilities. <code>CFO.selectmtd()</code> selects as the MTD dose <code class="reqn">j^*</code>, for which the
isotonic estimate of the DLT rate is closest to the target. If there
are ties, we select from the ties the highest dose level when the estimate
of the DLT rate is smaller than the target, or the lowest dose level
when the estimate of the DLT rate is greater than the target. The
isotonic estimates are obtained by the pooled-adjacent-violators algorithm
(PAVA).
</p>


<h3>Value</h3>

<p><code>CFO.selectmtd()</code> returns
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> MTD: the selected MTD. <code>MTD = 99</code> indicates that all tested doses are overly toxic.
</p>
</li>
<li><p> p_est: the isotonic estimate of the DLT probablity at each dose and associated <code class="reqn">95\%</code> credible interval.
<code>p_est = NA</code> if all tested doses are overly toxic.
</p>
</li>
<li><p> p_overdose: the probability of overdosing defined as <code class="reqn">Pr(toxicity &gt; \code{target}|data)</code>.
<code>p_overdose = NA</code> if all tested doses are overly toxic.
</p>
</li></ul>



<h3>Note</h3>

<p>The MTD selection and dose escalation/de-escalation rule are two independent
components of the trial design. Isotonic regression is employed to select the MTD after the completion of the trial.
When appropriate, another dose selection procedure (e.g., based on a fitted logistic model) can be used to select
the MTD after the completion of the trial using the CFO-type design.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Bril G, Dykstra R, Pillers C, Robertson T (1984). Algorithm AS 206: Isotonic regression in two independent variables.
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, 33(3), 352–357.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### select the MTD for the CFO-type single-drug trial
n &lt;- c(3,3,27,3,0,0,0)
y &lt;- c(0,0,4,2,0,0,0)
selmtd &lt;- CFO.selectmtd(target=0.2, npts=n, ntox=y)
summary(selmtd)
plot(selmtd)

</code></pre>

<hr>
<h2 id='CFO.simu'>Conduct one simulation using the Calibration-free odds (CFO) or accumulative CFO (aCFO) design.</h2><span id='topic+CFO.simu'></span>

<h3>Description</h3>

<p>In the CFO and aCFO designs, the function is used to conduct one single simulation and find the maximum tolerated dose (MTD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO.simu(design, target, p.true, init.level = 1, ncohort, cohortsize,
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO.simu_+3A_design">design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'CFO'</code> and <code>'aCFO'</code>.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_p.true">p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_init.level">init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is 1.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO.simu_+3A_seed">seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default value is set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>CFO.simu</code> function returns a list object comprising the following components:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> MTD: the selected MTD. <code>MTD = 99</code> indicates that the simulation is terminated due to early stopping.
</p>
</li>
<li><p> correct: a binary indicator of whether the recommended dose level matches the target DLT rate (1 for yes).
</p>
</li>
<li><p> npatients: the total number of patients allocated to all dose levels.
</p>
</li>
<li><p> ntox: the total number of DLTs observed for all dose levels.
</p>
</li>
<li><p> npercent: the percentage of subjects assigned to the target DLT rate.
</p>
</li>
<li><p> over.doses: a vector indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li><p> cohortdose: a vector including the dose level assigned to each cohort.
</p>
</li>
<li><p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li><p> patientDLT: a vector including the DLT outcome observed for each patient.
</p>
</li>
<li><p> sumDLT: the total number of DLT observed.
</p>
</li>
<li><p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li></ul>



<h3>Note</h3>

<p>The <code>CFO.simu()</code> function is designed to conduct a single CFO or aCFO simulation. If <code>design = 'CFO'</code>, it corresponds
to the CFO design. If <code>design = 'aCFO'</code>, it corresponds to the aCFO design. <br />
The early stopping and dose elimination rules are incorporated into the CFO or aCFO design
to ensure patient safety and benefit. If there is substantial evidence indicating that the current dose level
exhibits excessive toxicity, we exclude the current dose level as well as higher dose levels from the trial. If the lowest dose level is overly toxic, the trial will be terminated
according to the early stopping rule. Upon the predefined maximum sample size is reached or the lowest dose
level is over-toxicity, the experiment is concluded, and the MTD is determined using isotonic regression.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target &lt;- 0.2; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
### find the MTD for a single CFO simulation
CFOtrial &lt;- CFO.simu(design = 'CFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
summary(CFOtrial)
plot(CFOtrial)
### find the MTD for a single aCFO simulation
aCFOtrial &lt;- CFO.simu(design = 'aCFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
summary(aCFOtrial)
plot(aCFOtrial)
</code></pre>

<hr>
<h2 id='CFO2d.next'>Determinate the dose level for the next cohort in the two-dimensional calibration-free odds (2dCFO) design.</h2><span id='topic+CFO2d.next'></span>

<h3>Description</h3>

<p>This function is used to determine the next dose level for the next cohort in the 2dCFO design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO2d.next(target, cys, cns, currdose, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO2d.next_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_cys">cys</code></td>
<td>
<p>a matrix of the number of DLTs observed for each dose combination.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_cns">cns</code></td>
<td>
<p>a matrix of the number of patients allocated to each dose combination.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_currdose">currdose</code></td>
<td>
<p>a vector of the current dose indices in the horizontal and vertical direction.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO2d.next_+3A_seed">seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default value is set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the 2dCFO design, decision-making within the two-dimensional toxicity probability space is conducted by performing two independent one-dimensional
CFO analyses along both the horizontal and vertical axes (Wang et al. 2023).
</p>


<h3>Value</h3>

<p>The <code>CFO2d.next()</code> function returns a list with the following components:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> cys: a 3 by 3 matrix of the number of DLT observed for each dose combination at and around the current dose.
</p>
</li>
<li><p> cns: a 3 by 3 matrix of the number of patients allocated to each dose combination at and around the current dose.
</p>
</li>
<li><p> decision: a vector of length 2 representing the recommended decisions for vertical and horizontal
directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li><p> currdose: the current dose combination.
</p>
</li>
<li><p> nextdose: the recommended dose combination for the next cohort. <code>nextdose = (99, 99)</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li><p> overtox: the situation regarding which positions experience over-toxicity. The dose level indicated
by <code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that the
occurrence of over-toxicity did not happen.
</p>
</li></ul>



<h3>Note</h3>

<p>When the current dose level is the lowest or highest (i.e., at the boundary), the parts in <code>cys</code> and
<code>cns</code> where there is no data are filled with <code>NA</code>. <br />
The dose level indicated by <code>overtox</code> and all the dose levels above experience over-toxicity, and these dose levels will be eliminated.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cns &lt;- matrix(c(3, 3, 0,
                0, 6, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)

cys &lt;- matrix(c(0, 1, 0,
                0, 2, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
currdose &lt;- c(2,3)
decision &lt;- CFO2d.next(target = 0.3, cys, cns, currdose = currdose, seed = 1)
summary(decision)
</code></pre>

<hr>
<h2 id='CFO2d.oc'>Generate operating characteristics of drug-combination trials in multiple simulations</h2><span id='topic+CFO2d.oc'></span>

<h3>Description</h3>

<p>This function is used to conduct multiple simulations of drug-combination trials and obtain relevant the operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO2d.oc(nsimu = 1000, target, p.true, init.level = c(1,1), ncohort, cohortsize,
               prior.para = list(alp.prior = target, bet.prior = 1 - target), 
               cutoff.eli = 0.95, early.stop = 0.95, seeds = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO2d.oc_+3A_nsimu">nsimu</code></td>
<td>
<p>the total number of trials to be simulated. The default value is 1000.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_p.true">p.true</code></td>
<td>
<p>a matrix representing the true DIL rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_init.level">init.level</code></td>
<td>
<p>a numeric vector of length 2 representing the initial dose level (default is <code>c(1,1)</code>).</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of (<code>cutoff.eli = 0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO2d.oc_+3A_seeds">seeds</code></td>
<td>
<p>A vector of random seeds for each simulation, for example, <code>seeds = 1:nsimu</code> (default is <code>NULL</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>CFO.oc()</code> function returns basic setup of ($simu.setup) and the operating
characteristics of the design: <br />
</p>

<ul>
<li><p> p.true: the matrix of the true DLT rates under the different dose levels.
</p>
</li>
<li><p> selpercent: the matrix of the selection percentage of each dose level.
</p>
</li>
<li><p> npatients: a matrix of the averaged number of patients allocated to different doses in one simulation.
</p>
</li>
<li><p> ntox: a matrix of the averaged number of DLT observed for different doses in one simulation.
</p>
</li>
<li><p> MTDsel: the percentage of the correct selection of the MTD.
</p>
</li>
<li><p> MTDallo: the averaged percentage of patients assigned to the target DLT rate.
</p>
</li>
<li><p> oversel: the percentage of selecting a dose above the MTD.
</p>
</li>
<li><p> overallo: the averaged percentage of patients assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li><p> averDLT: the averaged total number of DLTs observed.
</p>
</li>
<li><p> percentstop: the percentage of early stopping without selecting the MTD.
</p>
</li>
<li><p> simu.setup: the parameters for the simulation set-up.
</p>
</li></ul>



<h3>Note</h3>

<p>In the example, we set <code>nsimu = 10</code> for testing time considerations. In reality, <code>nsimu</code>
is typically set to 1000 or 5000 to ensure the accuracy of the results.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate a two-dimensional dose-finding trial with 20 cohorts of size 3 for 10 replications.
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
0.10, 0.15, 0.30, 0.45, 0.55,
0.15, 0.30, 0.45, 0.50, 0.60), 
nrow = 3, ncol = 5, byrow = TRUE)
target &lt;- 0.3; ncohort &lt;- 12; cohortsize &lt;- 3
CFO2doc &lt;- CFO2d.oc(nsimu = 5, target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                    seeds = 1:5)
summary(CFO2doc)
plot(CFO2doc)
</code></pre>

<hr>
<h2 id='CFO2d.selectmtd'>Select the maximum tolerated dose (MTD) for the real drug combination trial</h2><span id='topic+CFO2d.selectmtd'></span>

<h3>Description</h3>

<p>Select the maximum tolerated dose (MTD) when the real drug combination trial is completed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO2d.selectmtd(target, npts, ntox, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO2d.selectmtd_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_npts">npts</code></td>
<td>
<p>a matrix containing the number of patients treated at each dose level.</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_ntox">ntox</code></td>
<td>
<p>a matrix containing the number of patients who experienced DLT at each dose level.</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO2d.selectmtd_+3A_verbose">verbose</code></td>
<td>
<p>set <code>verbose = TRUE</code> to return more details of the results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CFO2d.selectmtd()</code> selects the MTD based on isotonic estimates of toxicity
probabilities. <code>CFO2d.selectmtd()</code> selects as the MTD dose <code class="reqn">j^*</code>, for which the
isotonic estimate of the DLT rate is closest to the target. If there
are ties, we select from the ties the highest dose level when the estimate
of the DLT rate is smaller than the target, or the lowest dose level
when the estimate of the DLT rate is greater than the target. The
isotonic estimates are obtained by the pooled-adjacent-violators algorithm
(PAVA).
</p>


<h3>Value</h3>

<p><code>CFO2d.selectmtd()</code> returns
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> MTD: the selected MTD. <code>MTD = (99, 99)</code> indicates that all tested doses are overly toxic.
</p>
</li>
<li><p> p_est: the isotonic estimate of the DLT probablity at each dose and associated <code class="reqn">95\%</code> credible interval.
<code>p_est = NA</code> if all tested doses are overly toxic.
</p>
</li>
<li><p> p_est_CI: the credible interval for the isotonic estimate.
<code>p_est_CI = NA</code> if all tested doses are overly toxic.
</p>
</li></ul>



<h3>Note</h3>

<p>The MTD selection and dose escalation/deescalation rule are two independent
components of the trial design. Isotonic regression is employed to select the MTD after the completion of the trial.
When appropriate, another dose selection procedure (e.g., based on a fitted logistic model) can be used to select
the MTD after the completion of the trial using the 2dCFO design.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258. <br />
Bril G, Dykstra R, Pillers C, Robertson T (1984). Algorithm AS 206: Isotonic regression in two independent variables.
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, 33(3), 352–357.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ntox &lt;- matrix(c(0, 0, 2, 0, 0,
                0, 2, 7, 0, 0,
                0, 2, 0, 0, 0), 
              nrow = 3, ncol = 5, byrow = TRUE)

npts &lt;- matrix(c(3,  0, 12, 0, 0,
                3, 12, 24, 0, 0,
                3,  3,  0, 0, 0), 
              nrow = 3, ncol = 5, byrow = TRUE)
selmtd &lt;- CFO2d.selectmtd(target=0.3, npts=npts, ntox=ntox)
summary(selmtd)
plot(selmtd)

</code></pre>

<hr>
<h2 id='CFO2d.simu'>Conduct one simulation using the two-dimensional calibration-free odds (2dCFO) design.</h2><span id='topic+CFO2d.simu'></span>

<h3>Description</h3>

<p>In the 2dCFO design, the function is used to conduct one single simulation and find the maximum tolerated dose (MTD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                 prior.para = list(alp.prior = target, bet.prior = 1 - target),
                 cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CFO2d.simu_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_p.true">p.true</code></td>
<td>
<p>a matrix representing the true DIL rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_init.level">init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is <code>c(1,1)</code>.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of (<code>cutoff.eli = 0.95</code>) for general use.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="CFO2d.simu_+3A_seed">seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default is set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>CFO2d.simu()</code> function simulates the operating characteristics of the 2dCFO design
in a dose-combination trial.
The early stopping and dose elimination rules are incorporated into the 2dCFO design
to ensure patient safety and benefit.
</p>


<h3>Value</h3>

<p>The <code>CFO2d.simu()</code> function returns a list with the following components:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> MTD: a vector of length 2 representing the recommended dose level. <code>MTD = (99, 99)</code> indicates that this trial is terminated due to early stopping.
</p>
</li>
<li><p> correct: a binary indicator of whether the recommended dose level matches the target DLT rate (1 for yes).
</p>
</li>
<li><p> npatients: a matrix of the number of patients allocated to different doses.
</p>
</li>
<li><p> ntox: a matrix of the number of DLT observed for different doses.
</p>
</li>
<li><p> npercent: the percentage of patients assigned to the target DLT rate.
</p>
</li>
<li><p> over.doses: a matrix indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li><p> cohortdose: the dose combination assigned to each cohort.
</p>
</li>
<li><p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li><p> patientDLT: the DLT observed at each cohort.
</p>
</li>
<li><p> sumDLT: the total number of DLT observed.
</p>
</li>
<li><p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate a two-dimensional dose-finding trial with 20 cohorts of size 3.
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
                   0.10, 0.15, 0.30, 0.45, 0.55,
                   0.15, 0.30, 0.45, 0.50, 0.60), 
                 nrow = 3, ncol = 5, byrow = TRUE)
target &lt;- 0.3; ncohort &lt;- 20; cohortsize &lt;- 3
CFO2dtrial &lt;- CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, seed = 1)
summary(CFO2dtrial)
plot(CFO2dtrial)
</code></pre>

<hr>
<h2 id='lateonset.next'>Determination of the dose level for next cohort in the calibration-free odds type (CFO-type) design with late-onset toxicity</h2><span id='topic+lateonset.next'></span>

<h3>Description</h3>

<p>The function is used to determine the next dose level in the CFO-type design with late-onset toxicity, specifically, including
time-to-event CFO (TITE-CFO) design, fractional CFO (fCFO) design, benchmark CFO design,
time-to-event accumulative CFO (TITE-aCFO) design, fractional accumulative CFO (f-aCFO) design
and benchmark aCFO design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lateonset.next(design, target, p.true, currdose, assess.window, enter.times, dlt.times, 
       current.t, doses, prior.para = list(alp.prior = target, bet.prior = 1 - target),
       cutoff.eli = 0.95, early.stop = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lateonset.next_+3A_design">design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'TITE-CFO'</code>, <code>'TITE-aCFO'</code>,
<code>'fCFO'</code>, <code>'f-aCFO'</code>, <code>'bCFO'</code>, and <code>'b-aCFO'</code>. Specifically, <code>'bCFO'</code> refers
to the benchmark CFO design, and <code>'b-aCFO'</code> denotes the benchmark aCFO design.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_p.true">p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_currdose">currdose</code></td>
<td>
<p>the current dose level.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_assess.window">assess.window</code></td>
<td>
<p>the maximal assessment window size.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_enter.times">enter.times</code></td>
<td>
<p>the time that each participant enters the trial.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_dlt.times">dlt.times</code></td>
<td>
<p>the time to DLT for each subject in the trial. If no DLT occurs for a subject,
<code>dlt.times</code> is set to 0.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_current.t">current.t</code></td>
<td>
<p>the current time.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_doses">doses</code></td>
<td>
<p>the dose level for each subject in the trial.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="lateonset.next_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Late-onset outcomes commonly occur in phase I trials involving targeted agents or immunotherapies. The TITE
framework and fractional framework serve as two imputation methods to handle pending data
related to late-onset outcomes. This approach extends the CFO and aCFO designs to integrate time information
for delayed outcomes, leading to the development of TITE-CFO, fCFO, TITE-aCFO, and f-aCFO designs. <br />
In the TITE framework context, an assumption about the distribution of time to DLT must be pre-specified,
whereas the fractional framework does not require justification for a specific distribution of the time to
DLT. Consequently, fCFO and f-aCFO adapt to a more diverse range of scenarios.<br />
The function <code>lateonset.next()</code> also provides the option to execute
the benchmark CFO and benchmark aCFO design. These two methods await complete observation of toxicity outcomes for
the previous cohorts before determining the next dose assignment. This enhances precision but comes at the
expense of a prolonged trial duration.
</p>


<h3>Value</h3>

<p>The <code>lateonset.next()</code> function returns
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> decision: the decision in the CFO design, where <code>left</code>, <code>stay</code>, and <code>right</code> represent the
movement directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li><p> currdose: the current dose level.
</p>
</li>
<li><p> nextdose: the recommended dose level for the next cohort.
</p>
</li>
<li><p> overtox: the situation regarding which position experiences over-toxicity. The dose level indicated by
<code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that the
occurrence of over-toxicity did not happen.
</p>
</li>
<li><p> over.doses: a vector indicating whether the dose level (from the first to last dose level) is over-toxic
or not (1 for yes).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Jin H, Yin G (2023). Time‐to‐event calibration‐free odds design: A robust efficient design for
phase I trials with late‐onset outcomes. <em>Pharmaceutical Statistics</em>, 22(5), 773–783.<br />
Yin G, Zheng S, Xu J (2013). Fractional dose-finding methods with late-onset toxicity in
phase I clinical trials. <em>Journal of Biopharmaceutical Statistics</em>, 23(4), 856-870.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target &lt;- 0.2; p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
enter.times&lt;- c(0, 0.266, 0.638, 1.54, 2.48, 3.14, 3.32, 4.01, 4.39, 5.38, 5.76,
               6.54, 6.66, 6.93, 7.32, 7.66, 8.14, 8.74)
dlt.times&lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0.610, 0, 2.98, 0, 0, 1.95, 0, 0, 1.48)
current.t&lt;- 9.41
doses&lt;-c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 3, 3, 3, 4, 4, 4)
## determine the dose level for the next cohort using the TITE-CFO design
decision &lt;- lateonset.next(design = 'TITE-CFO', target, p.true, currdose = 4, assess.window = 3,   
               enter.times, dlt.times, current.t, doses)
summary(decision)
## determine the dose level for the next cohort using the TITE-aCFO design
decision &lt;- lateonset.next(design = 'TITE-aCFO', target, p.true, currdose = 4, assess.window = 3,   
               enter.times, dlt.times, current.t, doses)
summary(decision)
## determine the dose level for the next cohort using the f-CFO design
decision &lt;- lateonset.next(design = 'fCFO', target, p.true, currdose = 4, assess.window = 3,  
               enter.times, dlt.times, current.t, doses)
summary(decision)
## determine the dose level for the next cohort using the f-aCFO design
decision &lt;- lateonset.next(design = 'f-aCFO', target, p.true, currdose = 4, assess.window = 3,   
               enter.times, dlt.times, current.t, doses)
summary(decision)
## determine the dose level for the next cohort using the benchmark CFO design
decision &lt;- lateonset.next(design = 'bCFO', target, p.true, currdose = 4, assess.window = 3,   
               enter.times, dlt.times, current.t, doses)
summary(decision)
## determine the dose level for the next cohort using the benchmark aCFO design
decision &lt;- lateonset.next(design='b-aCFO', target, p.true, currdose = 4, assess.window = 3,   
               enter.times, dlt.times, current.t, doses)
summary(decision)

</code></pre>

<hr>
<h2 id='lateonset.simu'>Conduct one simulation using the calibration-free odds type (CFO-type) design with late-onset toxicity.</h2><span id='topic+lateonset.simu'></span>

<h3>Description</h3>

<p>The function is used to conduct one single simulation and find the maximum tolerated dose (MTD) for the CFO-type designs with late-onset toxicities,
specifically, including time-to-event CFO (TITE-CFO) design, fractional CFO (fCFO) design, benchmark CFO design,
time-to-event accumulative CFO (TITE-aCFO) design, fractional accumulative CFO (f-aCFO) design and benchmark aCFO design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lateonset.simu(design, target, p.true, init.level = 1, ncohort, cohortsize,
       assess.window, tte.para, accrual.rate, accrual.dist,  
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lateonset.simu_+3A_design">design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'TITE-CFO'</code>, <code>'TITE-aCFO'</code>,
<code>'fCFO'</code>, <code>'f-aCFO'</code>, <code>'bCFO'</code>, and <code>'b-aCFO'</code>. Specifically, <code>'bCFO'</code> refers
to the benchmark CFO design, and <code>'b-aCFO'</code> denotes the benchmark aCFO design.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_target">target</code></td>
<td>
<p>the target DLT rate.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_p.true">p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_init.level">init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is 1.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_ncohort">ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_cohortsize">cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_assess.window">assess.window</code></td>
<td>
<p>the maximal assessment window size.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_tte.para">tte.para</code></td>
<td>
<p>the parameter related with the distribution of the time to DLT events. The time to DLT is sampled from a Weibull
distribution, with <code>tte.para</code> representing the proportion of DLTs occurring within the first half of the
assessment window.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_accrual.rate">accrual.rate</code></td>
<td>
<p>the accrual.rate rate, i.e., the number of patients accrued per unit time.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_accrual.dist">accrual.dist</code></td>
<td>
<p>the distribution of the arrival times of patients. When <code>accrual.dist = 'fix'</code>, it corresponds to all
patients in each cohort arriving simultaneously at a given accrual rate. When <code>accrual.dist = 'unif'</code>,
it corresponds to a uniform distribution, and when <code>accrual.dist = 'exp'</code>, it corresponds to an
exponential distribution.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_prior.para">prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_cutoff.eli">cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_early.stop">early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td></tr>
<tr><td><code id="lateonset.simu_+3A_seed">seed</code></td>
<td>
<p>an integer to set as the seed of the random number generator for reproducible results. The default value is set to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>lateonset.simu()</code> function returns a list object comprising the following components:
</p>

<ul>
<li><p> target: the target DLT rate.
</p>
</li>
<li><p> MTD: the selected MTD. <code>MTD = 99</code> indicates that this trial is terminated due to early stopping.
</p>
</li>
<li><p> correct: a binary indicator of whether the recommended dose level matches the target DLT rate (1 for yes).
</p>
</li>
<li><p> npatients: the total number of patients allocated to all dose levels
</p>
</li>
<li><p> ntox: the total number of DLTs observed for all dose levels.
</p>
</li>
<li><p> npercent: the percentage of subjects assigned to the target DLT rate.
</p>
</li>
<li><p> over.doses: a vector indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li><p> cohortdose: a vector including the dose level assigned to each cohort.
</p>
</li>
<li><p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li><p> patientDLT: a vector including the DLT outcome observed for each patient.
</p>
</li>
<li><p> sumDLT: the total number of DLT observed.
</p>
</li>
<li><p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li>
<li><p> totaltime: the duration of the trial.
</p>
</li>
<li><p> entertimes: the time that each participant enters the trial.
</p>
</li>
<li><p> DLT.times: the time to DLT for each subject in the trial. If no DLT occurs for a certain subject,
<code>DLT.times</code> is 0.
</p>
</li></ul>



<h3>Note</h3>

<p>The early stopping and dose elimination rules are incorporated into the design
to ensure patient safety and benefit.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br />
Jin H, Yin G (2023). Time‐to‐event calibration‐free odds design: A robust efficient design for
phase I trials with late‐onset outcomes. <em>Pharmaceutical Statistics</em>. 22(5), 773–783.<br />
Yin G, Zheng S, Xu J (2013). Fractional dose-finding methods with late-onset toxicity in
phase I clinical trials. <em>Journal of Biopharmaceutical Statistics</em>, 23(4), 856-870.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target &lt;- 0.2; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'
## find the MTD for a single TITE-CFO simulation
TITECFOtrial &lt;- lateonset.simu (design = 'TITE-CFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(TITECFOtrial)
plot(TITECFOtrial)
## find the MTD for a single TITE-aCFO simulation
TITEaCFOtrial &lt;- lateonset.simu (design = 'TITE-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(TITEaCFOtrial)
plot(TITEaCFOtrial)
## find the MTD for a single fCFO simulation
fCFOtrial &lt;- lateonset.simu (design = 'fCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(fCFOtrial)
plot(fCFOtrial)
## find the MTD for a single f-aCFO simulation
faCFOtrial &lt;- lateonset.simu (design = 'f-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(faCFOtrial)
plot(faCFOtrial)
</code></pre>

<hr>
<h2 id='plot.cfo'>Plot the results by other functions</h2><span id='topic+plot.cfo'></span>

<h3>Description</h3>

<p>Plot the objects returned by other functions, including (1) dose allocation of a single trial;
(2) the estimate of toxicity probability for each dose and corresponding 95% credible interval;
(3) operating characteristics of multiple simulations, including MTD selection percentage,
the averaged number of patients allocated to different doses in one simulation and the averaged
number of DLT observed for different doses in one simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cfo'
plot(x, ..., name = deparse(substitute(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cfo_+3A_x">x</code></td>
<td>
<p>the object returned by other functions</p>
</td></tr>
<tr><td><code id="plot.cfo_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
<tr><td><code id="plot.cfo_+3A_name">name</code></td>
<td>
<p>the name of the object to be plotted.
User does not need to input this parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot()</code> returns a figure or a series of figures depending on the object entered.
</p>


<h3>Note</h3>

<p>In the example, we set <code>nsimu = 5</code> for testing time considerations. In reality, <code>nsimu</code>
is typically set to 5000 to ensure the accuracy of the results.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## settings for 1dCFO
nsimu &lt;- 5; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.02, 0.05, 0.20, 0.28, 0.34, 0.40, 0.44); target &lt;- 0.2
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'

## plot the object returned by CFO.simu()
CFOtrial &lt;- CFO.simu(design = 'CFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
plot(CFOtrial)

## plot the object returned by lateonset.simu()
## f-aCFO design
faCFOtrial &lt;- lateonset.simu (design = 'f-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
plot(faCFOtrial)

## summarize the object returned by CFO.oc()
faCFOoc &lt;- CFO.oc (nsimu, design = 'f-aCFO', target, p.true, init.level, ncohort, cohortsize,
        assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
plot(faCFOoc)

## plot the object returned by CFO.selectmtd()
selmtd &lt;- CFO.selectmtd(target=0.2, npts=c(3,3,27,3,0,0,0), ntox=c(0,0,4,2,0,0,0))
plot(selmtd)


# This test may take longer than 5 seconds to run
# It is provided for illustration purposes only
# Users can run this code directly
## settings for 2dCFO
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
                   0.10, 0.15, 0.30, 0.45, 0.55,
                   0.15, 0.30, 0.45, 0.50, 0.60), 
                 nrow = 3, ncol = 5, byrow = TRUE)
target &lt;- 0.3; ncohort &lt;- 12; cohortsize &lt;- 3

## plot the single simulation returned by CFO2d.simu()
CFO2dtrial &lt;- CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, seed = 1)
plot(CFO2dtrial)

## plot the multiple simulation returned by CFO2d.oc()
CFO2doc &lt;- CFO2d.oc(nsimu = 5, target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                    seeds = 1:5)
plot(CFO2doc)

## select a MTD based on the trial data
ntox &lt;- matrix(c(0, 0, 2, 0, 0, 0, 2, 7, 0, 0, 0, 2, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
npts &lt;- matrix(c(3, 0, 12, 0, 0, 3, 12, 24, 0, 0, 3, 3, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
selmtd &lt;- CFO2d.selectmtd(target=0.3, npts=npts, ntox=ntox)
plot(selmtd)


</code></pre>

<hr>
<h2 id='print.cfo'>Generate descriptive summary for objects returned by other functions</h2><span id='topic+print.cfo'></span>

<h3>Description</h3>

<p>Generate descriptive summary for objects returned by other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cfo'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cfo_+3A_x">x</code></td>
<td>
<p>the object returned by other functions</p>
</td></tr>
<tr><td><code id="print.cfo_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print()</code> prints the objects returned by other functions.
</p>


<h3>Value</h3>

<p><code>print()</code> prints the objects returned by other functions.
</p>


<h3>Note</h3>

<p>In the example, we set <code>nsimu = 5</code> for testing time considerations. In reality, <code>nsimu</code>
is typically set to 5000 to ensure the accuracy of the results.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## settings for 1dCFO
nsimu &lt;- 5; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.02, 0.05, 0.20, 0.28, 0.34, 0.40, 0.44); target &lt;- 0.2
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'

## summarize the object returned by CFO.next()
decision &lt;- CFO.next(target = 0.2, cys = c(0, 1, 0), cns = c(3, 6, 0), currdose = 3)
print(decision)

## summarize the object returned by lateonset.next()
enter.times&lt;- c(0, 0.266, 0.638, 1.54, 2.48, 3.14, 3.32, 4.01, 4.39, 5.38, 5.76,
               6.54, 6.66, 6.93, 7.32, 7.65, 8.14, 8.74)
dlt.times&lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 0, 0, 0, 2.58)
current.t&lt;- 9.41
doses&lt;-c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 3, 3, 3, 4, 4, 4)
decision &lt;- lateonset.next(design = 'f-aCFO', target, p.true, currdose = 4, assess.window,   
               enter.times, dlt.times, current.t, doses)
print(decision)

## summarize the object returned by CFO.selectmtd()
selmtd &lt;- CFO.selectmtd(target=0.2, npts=c(3,3,27,3,0,0,0), ntox=c(0,0,4,2,0,0,0))
print(selmtd)

## summarize the object returned by CFO.simu()
aCFOtrial &lt;- CFO.simu(design = 'aCFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
print(aCFOtrial)

## summarize the object returned by lateonset.simu()
faCFOtrial &lt;- lateonset.simu (design = 'f-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
print(faCFOtrial)

## summarize the object returned by CFO.oc()
faCFOoc &lt;- CFO.oc (nsimu, design = 'f-aCFO', target, p.true, init.level, ncohort, cohortsize,
                      assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
print(faCFOoc)


# This test may take longer than 5 seconds to run
# It is provided for illustration purposes only
# Users can run this code directly
## settings for 2dCFO
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
0.10, 0.15, 0.30, 0.45, 0.55,
0.15, 0.30, 0.45, 0.50, 0.60), 
nrow = 3, ncol = 5, byrow = TRUE)

cns &lt;- matrix(c(3, 3, 0,
                0, 6, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
cys &lt;- matrix(c(0, 1, 0,
                0, 2, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
currdose &lt;- c(2,3); target &lt;- 0.3; ncohort &lt;- 12; cohortsize &lt;- 3

## summarize the object returned by CFO2d.next()
decision &lt;- CFO2d.next(target, cys, cns, currdose = currdose, seed = 1)
print(decision)

## summarize the object returned by CFO2d.selectmtd()
ntox &lt;- matrix(c(0, 0, 2, 0, 0, 0, 2, 7, 0, 0, 0, 2, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
npts &lt;- matrix(c(3, 0, 12, 0, 0, 3, 12, 24, 0, 0, 3, 3, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
selmtd &lt;- CFO2d.selectmtd(target=0.3, npts=npts, ntox=ntox)
print(selmtd)

## summarize the object returned by CFO2d.simu()
CFO2dtrial &lt;- CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, seed = 1)
print(CFO2dtrial)

## summarize the object returned by CFO2d.oc()
CFO2doc &lt;- CFO2d.oc(nsimu = 5, target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                    seeds = 1:5)
print(CFO2doc)


</code></pre>

<hr>
<h2 id='summary.cfo'>Generate descriptive summary for objects returned by other functions</h2><span id='topic+summary.cfo'></span>

<h3>Description</h3>

<p>Generate descriptive summary for objects returned by other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cfo'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cfo_+3A_object">object</code></td>
<td>
<p>the object returned by other functions.</p>
</td></tr>
<tr><td><code id="summary.cfo_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary()</code> prints the objects returned by other functions.
</p>


<h3>Note</h3>

<p>In the example, we set <code>nsimu = 5</code> for testing time considerations. In reality, <code>nsimu</code>
is typically set to 5000 to ensure the accuracy of the results.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, and Guosheng Yin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## settings for 1dCFO
nsimu &lt;- 5; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.02, 0.05, 0.20, 0.28, 0.34, 0.40, 0.44); target &lt;- 0.2
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'

## summarize the object returned by CFO.next()
decision &lt;- CFO.next(target = 0.2, cys = c(0, 1, 0), cns = c(3, 6, 0), currdose = 3)
summary(decision)

## summarize the object returned by lateonset.next()
enter.times&lt;- c(0, 0.266, 0.638, 1.54, 2.48, 3.14, 3.32, 4.01, 4.39, 5.38, 5.76,
               6.54, 6.66, 6.93, 7.32, 7.65, 8.14, 8.74)
dlt.times&lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 0, 0, 0, 2.58)
current.t&lt;- 9.41
doses&lt;-c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 3, 3, 3, 4, 4, 4)
decision &lt;- lateonset.next(design = 'f-aCFO', target, p.true, currdose = 4, assess.window,   
               enter.times, dlt.times, current.t, doses)
summary(decision)

## summarize the object returned by CFO.selectmtd()
selmtd &lt;- CFO.selectmtd(target=0.2, npts=c(3,3,27,3,0,0,0), ntox=c(0,0,4,2,0,0,0))
summary(selmtd)

## summarize the object returned by CFO.simu()
aCFOtrial &lt;- CFO.simu(design = 'aCFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
summary(aCFOtrial)

## summarize the object returned by lateonset.simu()
faCFOtrial &lt;- lateonset.simu (design = 'f-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(faCFOtrial)

## summarize the object returned by CFO.oc()
faCFOoc &lt;- CFO.oc (nsimu, design = 'f-aCFO', target, p.true, init.level, ncohort, cohortsize,
                      assess.window, tte.para, accrual.rate, accrual.dist, seeds = 1:nsimu)
summary(faCFOoc)


# This test may take longer than 5 seconds to run
# It is provided for illustration purposes only
# Users can run this code directly
## settings for 2dCFO
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
0.10, 0.15, 0.30, 0.45, 0.55,
0.15, 0.30, 0.45, 0.50, 0.60), 
nrow = 3, ncol = 5, byrow = TRUE)

cns &lt;- matrix(c(3, 3, 0,
                0, 6, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
cys &lt;- matrix(c(0, 1, 0,
                0, 2, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
currdose &lt;- c(2,3); target &lt;- 0.3; ncohort &lt;- 12; cohortsize &lt;- 3

## summarize the object returned by CFO2d.next()
decision &lt;- CFO2d.next(target, cys, cns, currdose = currdose, seed = 1)
summary(decision)

## summarize the object returned by CFO2d.selectmtd()
ntox &lt;- matrix(c(0, 0, 2, 0, 0, 0, 2, 7, 0, 0, 0, 2, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
npts &lt;- matrix(c(3, 0, 12, 0, 0, 3, 12, 24, 0, 0, 3, 3, 0, 0, 0), nrow = 3, ncol = 5, byrow = TRUE)
selmtd &lt;- CFO2d.selectmtd(target=0.3, npts=npts, ntox=ntox)
summary(selmtd)

## summarize the object returned by CFO2d.simu()
CFO2dtrial &lt;- CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, seed = 1)
summary(CFO2dtrial)

## summarize the object returned by CFO2d.oc()
CFO2doc &lt;- CFO2d.oc(nsimu = 5, target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                    seeds = 1:5)
summary(CFO2doc)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
