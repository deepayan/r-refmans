<!DOCTYPE html><html><head><title>Help for package visreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {visreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.visreg'><p>Visualization of regression functions</p></a></li>
<li><a href='#plot.visreg2d'><p>Visualization of regression functions for two variables</p></a></li>
<li><a href='#subset.visreg'><p>Subset a visreg object</p></a></li>
<li><a href='#visreg'><p>Visualization of regression functions</p></a></li>
<li><a href='#visreg-faq'><p>Frequently Asked Questions for visreg</p></a></li>
<li><a href='#visreg-package'><p>Visualization of regression models</p></a></li>
<li><a href='#visreg2d'><p>Visualization of regression functions for two variables</p></a></li>
<li><a href='#visregList'><p>Join multiple visreg objects together in a list</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Visualization of Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Patrick Breheny, Woodrow Burchett</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rgl, MASS, survival, knitr, ggplot2, Matrix</td>
</tr>
<tr>
<td>Enhances:</td>
<td>nlme</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a convenient interface for constructing plots to visualize the fit of regression models arising from a wide variety of models in R ('lm', 'glm', 'coxph', 'rlm', 'gam', 'locfit', 'lmer', 'randomForest', etc.)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-04 19:48:51 UTC; pbreheny</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-04 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot.visreg'>Visualization of regression functions</h2><span id='topic+plot.visreg'></span>

<h3>Description</h3>

<p>A function for visualizing regression models quickly and easily.
Default plots contain a confidence band, prediction line, and partial
residuals.  Factors, transformations, conditioning, interactions, and a
variety of other options are supported.  The <code>plot.visreg</code> function
accepts a <code>visreg</code> or <code>visregList</code> object as calculated by
<code>visreg</code> and creates the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'visreg'
plot(x, overlay=FALSE, print.cond=FALSE,
whitespace=0.2, partial=identical(x$meta$trans, I), band=TRUE,
rug=ifelse(partial, 0, 2), strip.names=is.numeric(x$fit[,x$meta$by]),
legend=TRUE, top=c('line', 'points'), gg=FALSE, line.par=NULL,
fill.par=NULL, points.par=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.visreg_+3A_x">x</code></td>
<td>

<p>A <code>visreg</code> or <code>visregList</code> object; see
<code><a href="#topic+visreg">visreg</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_overlay">overlay</code></td>
<td>

<p>When <code>by</code> is specified, by default separate panels are used to
display each cross-section.  If <code>overlay=TRUE</code>, these
cross-sections are overlaid on top of each other in a single plot.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_print.cond">print.cond</code></td>
<td>

<p>If <code>print.cond=TRUE</code>, the explanatory variable values
conditioned on in a conditional plot are printed to the console
(default: <code>FALSE</code>). If <code>print.cond=TRUE</code> and
<code>type="contrast"</code>, the conditions will still be printed, but
they have no bearing on the plot unless interactions are present.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_whitespace">whitespace</code></td>
<td>

<p>When <code>xvar</code> is a factor, whitespace determines the amount of
space in between factors on the x-axis.  Default is 0.2, meaning
that 20 percent of the horizontal axis is whitespace.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_partial">partial</code></td>
<td>

<p>If <code>partial=TRUE</code> (the default), partial residuals are shown on
the plot.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_band">band</code></td>
<td>

<p>If <code>band=TRUE</code> (the default), confidence bands are shown on the
plot.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_rug">rug</code></td>
<td>

<p>By default, partial residuals are plotted.  Alternatively, a
<code><a href="graphics.html#topic+rug">rug</a></code> may be plotted along the horizontal axis instead.
Setting <code>rug=TRUE</code> turns off partial residuals by default; if
one wants both to be plotted, both <code>rug=TRUE</code> and
<code>partial=TRUE</code> need to be specified.  Two types of rug plots
are available.  If <code>rug=1</code> or <code>rug=TRUE</code>, then a basic rug
is drawn on the bottom.  If <code>rug=2</code>, then separate rugs are
drawn on the top for observations with positive residuals and on the
bottom for observations with negative residuals.  Such plots are
particularly useful in logistic regression (see examples).
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_strip.names">strip.names</code></td>
<td>

<p>When <code>by=TRUE</code>, <code>strip.names=TRUE</code> adds the name of the
<code>by</code> variable to the strip at the top of each panel.  Default
is <code>FALSE</code> for factors and <code>TRUE</code> for numeric <code>by</code>
variables.  <code>strip.names</code> can also be a character vector, in
which case it replaces the strip names altogether with values chosen
by the user.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_legend">legend</code></td>
<td>

<p>For overlay plots, (<code>overlay=TRUE</code>), should visreg create a
legend?  If <code>legend=TRUE</code> (the default), a legend is placed in
the top margin.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_top">top</code></td>
<td>

<p>By default, the model fits <code>'line'</code> are plotted on top of the
partial residuals; usually this is preferable, but it does run the
risk of obscuring certain residuals.  To change this behavior and
plot the partial residuals on top, specify <code>top='points'</code>.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_gg">gg</code></td>
<td>

<p>By default (<code>gg=FALSE</code>), <code>visreg</code> will use the
<code>lattice</code> package to render the plot if multiple panels are
required.  If <code>gg=TRUE</code>, it will use the <code>ggplot2</code> package
instead, provided that it is installed.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_line.par">line.par</code></td>
<td>

<p>List of parameters (see <code><a href="graphics.html#topic+par">par</a></code>) to pass to
<code>lines(...)</code> when lines are drawn in the plots.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_fill.par">fill.par</code></td>
<td>

<p>List of parameters (see <code><a href="graphics.html#topic+par">par</a></code>) to pass to
<code>polygon(...)</code> when shaded confidence regions are drawn in the
plots.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_points.par">points.par</code></td>
<td>

<p>List of parameters (see <code><a href="graphics.html#topic+par">par</a></code>) to pass to
<code>points(...)</code> when partial residuals are drawn in the plots.
</p>
</td></tr>
<tr><td><code id="plot.visreg_+3A_...">...</code></td>
<td>

<p>Graphical parameters can be passed to the function to customize the
plots.  If <code>by=TRUE</code>, lattice parameters can be passed, such as
layout (see examples below).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://pbreheny.github.io/visreg/options.html">http://pbreheny.github.io/visreg/options.html</a>
<code><a href="#topic+visreg">visreg</a></code>
<code><a href="#topic+visreg2d">visreg2d</a></code>
<code><a href="#topic+visreg-faq">visreg-faq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp,data=airquality)
visreg(fit, "Wind", line=list(col="red"), points=list(cex=1, pch=1))

## Changing appearance
visreg(fit, "Wind", line=list(col="red"), points=list(cex=1, pch=1))

## See ?visreg and http://pbreheny.github.io/visreg for more examples
</code></pre>

<hr>
<h2 id='plot.visreg2d'>Visualization of regression functions for two variables</h2><span id='topic+plot.visreg2d'></span>

<h3>Description</h3>

<p>Plot method for visualizing how two variables interact to
affect the response in regression models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'visreg2d'
plot(x, plot.type=c("image","persp","rgl", "gg"),
xlab, ylab, zlab, color, print.cond=FALSE, whitespace=0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.visreg2d_+3A_x">x</code></td>
<td>

<p>A <code><a href="#topic+visreg2d">visreg2d</a></code> object.
</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_plot.type">plot.type</code></td>
<td>

<p>The style of plot to be produced.  The following three options are
supported:
</p>

<ul>
<li> <p><code>'image'</code>, a filled contour plot.
</p>
</li>
<li> <p><code>'gg'</code>, a filled contour plot using <code>ggplot2</code>.
</p>
</li>
<li> <p><code>'persp'</code>, a 3 dimensional perspective plot.
</p>
</li>
<li> <p><code>'rgl'</code>, a version of the perspective plot that can be
rotated. Note: requires the rgl package to use.
</p>
</li></ul>

</td></tr>
<tr><td><code id="plot.visreg2d_+3A_xlab">xlab</code></td>
<td>

<p>Axis label for x variable</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_ylab">ylab</code></td>
<td>

<p>Axis label for y variable</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_zlab">zlab</code></td>
<td>

<p>Axis label for outcome</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_color">color</code></td>
<td>

<p>For <code>plot.type='persp'</code> or <code>plot.type='rgl'</code>, the
color of the surface.  For <code>plot.type='image'</code> or
<code>plot.type='gg'</code>, a vector of colors used to establish a
color palette.</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_print.cond">print.cond</code></td>
<td>

<p>If <code>print.cond==TRUE</code>, the explanatory variable values
conditioned on in a conditional plot are printed to the console
(default: <code>FALSE</code>). If <code>print.cond==TRUE</code> and
<code>type=="contrast"</code>, the conditions will still be printed, but
they have no bearing on the plot unless interactions are present.
</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_whitespace">whitespace</code></td>
<td>

<p>When <code>xvar</code> or <code>yvar</code> is a factor, whitespace determines
the amount of space in between the factors.  Default is 0.2, meaning
that 20 percent of the axis is whitespace.
</p>
</td></tr>
<tr><td><code id="plot.visreg2d_+3A_...">...</code></td>
<td>

<p>Graphical parameters can be passed to the function to customize the
plots.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://pbreheny.github.io/visreg/surface.html">http://pbreheny.github.io/visreg/surface.html</a>
<code><a href="#topic+visreg">visreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp + I(Wind^2) + I(Temp^2) +
I(Wind*Temp)+I(Wind*Temp^2) + I(Temp*Wind^2) + I(Temp^2*Wind^2),
data=airquality)

visreg2d(fit, x="Wind", y="Temp", plot.type="image")
visreg2d(fit, x="Wind", y="Temp", plot.type="image",
         color=c("purple", "green", "red"))
visreg2d(fit, x="Wind", y="Temp", plot.type="persp")

## Requires the rgl package
## Not run: 
visreg2d(fit,x="Wind",y="Temp",plot.type="rgl")

## End(Not run)

## Requires the ggplot2 package
## Not run: 
visreg2d(fit, x="Wind", y="Temp", plot.type="gg")

## End(Not run)

</code></pre>

<hr>
<h2 id='subset.visreg'>Subset a visreg object</h2><span id='topic+subset.visreg'></span>

<h3>Description</h3>

<p>Subset a visreg object so that only a portion of the full
model is plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'visreg'
subset(x, sub, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset.visreg_+3A_x">x</code></td>
<td>

<p>A <code><a href="#topic+visreg">visreg</a></code> object.
</p>
</td></tr>
<tr><td><code id="subset.visreg_+3A_sub">sub</code></td>
<td>

<p>Logical expression indicating elements to keep, as in
<code><a href="base.html#topic+subset">subset</a></code>.
</p>
</td></tr>
<tr><td><code id="subset.visreg_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Fit a model and construct a visreg object
airquality$Heat &lt;- cut(airquality$Temp,3,labels=c("Cool","Mild","Hot"))
fit &lt;- lm(Ozone~ Solar.R + Wind*Heat,data=airquality)
v &lt;- visreg(fit, "Wind", by="Heat", plot=FALSE)

# Plot only certain levels
vv &lt;- subset(v, Heat %in% c("Cool", "Hot"))
plot(vv)

# Plot only up to wind 15 mph
vv &lt;- subset(v, Wind &lt; 15)
plot(vv)
</code></pre>

<hr>
<h2 id='visreg'>Visualization of regression functions</h2><span id='topic+visreg'></span>

<h3>Description</h3>

<p>A function for visualizing regression models quickly and easily.
Default plots contain a confidence band, prediction line, and partial
residuals.  Factors, transformations, conditioning, interactions, and a
variety of other options are supported.  The <code>visreg</code> function
performs the calculations and, if <code>plot=TRUE</code> (the default), these
calculations are passed to <code>plot.visreg</code> for plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visreg(fit, xvar, by, breaks=3, type=c("conditional", "contrast"),
data=NULL, trans=I, scale=c("linear","response"), xtrans,  alpha=.05,
nn=101, cond=list(), jitter=FALSE, collapse=FALSE, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visreg_+3A_fit">fit</code></td>
<td>

<p>The fitted model object you wish to visualize.  Any object with
'predict' and 'model.frame' methods are supported, including lm,
glm, gam, rlm, coxph, and many more.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_xvar">xvar</code></td>
<td>

<p>Character string specifying the variable to be put on the x-axis of
your plot.  Both continuous variables and factors are supported.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_by">by</code></td>
<td>

<p>(Optional) A variable allowing you to divide your plot into
cross-sections based on levels of the <code>by</code> variable;
particularly useful for visualizing models with interactions.
Supplied as a character string.  Uses the lattice package.  Both
continuous variables and factors are supported.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_breaks">breaks</code></td>
<td>

<p>If a continuous variable is used for the <code>by</code> option, the
<code>breaks</code> argument controls the values at which the
cross-sections are taken. By default, cross-sections are taken at
the 10th, 50th, and 90th quantiles.  If <code>breaks</code> is a single
number, it specifies the number of breaks.  If <code>breaks</code> is a
vector of numbers, it specifies the values at which the
cross-sections are to be taken.  Each partial residuals appears
exactly once in the plot, in the panel it is closest to. 
</p>
</td></tr>
<tr><td><code id="visreg_+3A_type">type</code></td>
<td>
    
<p>The type of plot to be produced.  The following options are
supported:
</p>

<ul>
<li><p> If 'conditional' is selected, the plot returned shows the
value of the variable on the x-axis and the change in response on
the y-axis, holding all other variables constant (by default,
median for numeric variables and most common category for factors).
</p>
</li>
<li><p> If 'contrast' is selected, the plot returned shows the effect
on the expected value of the response by moving the x variable away
from a reference point on the x-axis (for numeric variables, this is
taken to be the mean).
</p>
</li></ul>

<p>For more details, see references.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_data">data</code></td>
<td>

<p>The data frame used to fit the model.  Typically, visreg() can
figure out where the data is, so it is not necessary to provide
this.  In some cases, however, the data set cannot be located and
must be supplied explicitly.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_trans">trans</code></td>
<td>

<p>(Optional) A function specifying a transformation for the vertical
axis.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_scale">scale</code></td>
<td>

<p>By default, the model is plotted on the scale of the linear
predictor.  If <code>scale='response'</code> for a glm, the inverse link
function will be applied so that the model is plotted on the scale
of the original response.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_xtrans">xtrans</code></td>
<td>

<p>(Optional) A function specifying a transformation for the horizontal
axis.  Note that, for model terms such as <code>log(x)</code>, visreg
automatically plots on the original axis (see examples).
</p>
</td></tr>
<tr><td><code id="visreg_+3A_alpha">alpha</code></td>
<td>

<p>Alpha level (1-coverage) for the confidence band displayed in the
plot (default: 0.05).
</p>
</td></tr>
<tr><td><code id="visreg_+3A_nn">nn</code></td>
<td>

<p>Controls the smoothness of the line and confidence band.  Increasing
this number will add to the computational burden, but produce a
smoother plot (default: 101).
</p>
</td></tr>
<tr><td><code id="visreg_+3A_cond">cond</code></td>
<td>

<p>Named list specifying conditional values of other explanatory
variables. By default, conditional plots in visreg are constructed
by filling in other explanatory variables with the median (for
numeric variables) or most common category (for factors), but this
can be overridden by specifying their values using <code>cond</code> (see
examples).
</p>
</td></tr>
<tr><td><code id="visreg_+3A_jitter">jitter</code></td>
<td>

<p>Adds a small amount of noise to <code>xvar</code>.  Potentially useful if
many observations have exactly the same value.  Default is FALSE.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_collapse">collapse</code></td>
<td>

<p>If the <code>predict</code> method for <code>fit</code> returns a matrix, should
this be returns as multiple visreg objects bound together as a list
(<code>collapse=FALSE</code>) or collapsed down to a single <code>visreg</code>
object (<code>collapse=TRUE</code>).
</p>
</td></tr>
<tr><td><code id="visreg_+3A_plot">plot</code></td>
<td>

<p>Send the calculations to <code><a href="#topic+plot.visreg">plot.visreg</a></code>?  Default is
TRUE.
</p>
</td></tr>
<tr><td><code id="visreg_+3A_...">...</code></td>
<td>

<p>Graphical parameters (e.g., <code>ylab</code>) can be passed to the
function to customize the plots.  If <code>by=TRUE</code>, lattice
parameters can be passed, such as layout (see examples below).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+plot.visreg">plot.visreg</a></code> for plotting options, such as changing
the appearance of points, lines, confidence bands, etc.
</p>


<h3>Value</h3>

<p>A <code>visreg</code> or <code>visregList</code> object (which is simply a list
of <code>visreg</code> objects).  A <code>visreg</code> object has three
components:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>A data frame with <code>nn</code> rows containing the fit of the
model as <code>xvar</code> varies, along with lower and upper confidence
bounds (named <code>visregFit</code>, <code>visregLwr</code>, and
<code>visregUpr</code>, respectively). The fitted matrix of coefficients.</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>A data frame with <code>n</code> rows, where <code>n</code> is the
number of observations in the original data set used to model.  This
frame contains information about the residuals, named
<code>visregReg</code> and <code>visregPos</code>; the latter records whether
the residual was positive or negative.</p>
</td></tr>
<tr><td><code>meta</code></td>
<td>
<p>Contains meta-information needed to construct plots, such
as the name of the x and y variables, whether there were any
<code>by</code> variables, etc.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
<code><a href="#topic+plot.visreg">plot.visreg</a></code>
<code><a href="#topic+visreg2d">visreg2d</a></code>
<code><a href="#topic+visreg-faq">visreg-faq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###################
## Linear models ##
###################

## Basic
fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp, data=airquality)
visreg(fit)
visreg(fit, "Wind", type="contrast")
visreg(fit, "Wind", type="conditional")

## Factors
airquality$Heat &lt;- cut(airquality$Temp, 3, labels=c("Cool","Mild","Hot"))
fit.heat &lt;- lm(Ozone ~ Solar.R + Wind + Heat, data=airquality)
visreg(fit.heat, "Heat", type="contrast")
visreg(fit.heat, "Heat", type="conditional")

## Transformations
fit1 &lt;- lm(Ozone ~ Solar.R + Wind + Temp + I(Wind^2), data=airquality)
fit2 &lt;- lm(log(Ozone) ~ Solar.R + Wind + Temp, data=airquality)
fit3 &lt;- lm(log(Ozone) ~ Solar.R + Wind + Temp + I(Wind^2), data=airquality)
visreg(fit1, "Wind")
visreg(fit2, "Wind", trans=exp, ylab="Ozone")
visreg(fit3, "Wind", trans=exp, ylab="Ozone")

## Conditioning
visreg(fit, "Wind", cond=list(Temp=50))
visreg(fit, "Wind", print.cond=TRUE)
visreg(fit, "Wind", cond=list(Temp=100))

## Interactions
fit.in1 &lt;- lm(Ozone~ Solar.R + Wind*Heat, data=airquality)
visreg(fit.in1, "Wind", by="Heat")
visreg(fit.in1, "Heat", by="Wind")
visreg(fit.in1, "Wind", by="Heat", type="contrast")
visreg(fit.in1, "Heat", by="Wind", breaks=6)
visreg(fit.in1, "Heat", by="Wind", breaks=c(0,10,20))

## Overlay
visreg(fit.in1, "Wind", by="Heat", overlay=TRUE)

######################
## Nonlinear models ##
######################

## Logistic regression
data("birthwt", package="MASS")
birthwt$race &lt;- factor(birthwt$race, labels=c("White","Black","Other"))
birthwt$smoke &lt;- factor(birthwt$smoke, labels=c("Nonsmoker","Smoker"))
fit &lt;- glm(low~age+race+smoke+lwt, data=birthwt, family="binomial")
visreg(fit, "lwt",
       xlab="Mother's Weight", ylab="Log odds (low birthweight)")
visreg(fit, "lwt", scale="response", partial=FALSE,
       xlab="Mother's Weight", ylab="P(low birthweight)")
visreg(fit, "lwt", scale="response", partial=FALSE,
       xlab="Mother's Weight", ylab="P(low birthweight)", rug=2)

## Proportional hazards
require(survival)
data(ovarian)
ovarian$rx &lt;- factor(ovarian$rx)
fit &lt;- coxph(Surv(futime, fustat) ~ age + rx, data=ovarian)
visreg(fit, "age", ylab="log(Hazard ratio)")

## Robust regression
require(MASS)
fit &lt;- rlm(Ozone ~ Solar.R + Wind*Heat, data=airquality)
visreg(fit, "Wind", cond=list(Heat="Mild"))

## And more...; anything with a 'predict' method should work

## Return raw components of plot
v &lt;- visreg(fit, "Wind", cond=list(Heat="Mild"))
</code></pre>

<hr>
<h2 id='visreg-faq'>Frequently Asked Questions for visreg</h2><span id='topic+visreg-faq'></span><span id='topic+visregfaq'></span><span id='topic+visregFAQ'></span><span id='topic+visreg.faq'></span><span id='topic+visreg_faq'></span>

<h3>Description</h3>

<p>This page tries to answer some of the questions that I get
asked most often about how to use the visreg package.  If you have a
question that does not appear below, I can be reached at
&lt;patrick-breheny@uiowa.edu&gt;.</p>


<h3>Frequent asked questions</h3>


<ol>
<li> <p><b>What is the difference between 'conditional' and
'contrast' plots?</b> 
</p>
<p>Suppose our data looked like:
</p>

<table>
<tr>
 <td style="text-align: right;">
      SBP </td><td style="text-align: right;"> Sex </td><td style="text-align: right;"> Age</td>
</tr>
<tr>
 <td style="text-align: right;">
      140 </td><td style="text-align: right;">   M </td><td style="text-align: right;">  56</td>
</tr>
<tr>
 <td style="text-align: right;">
      135 </td><td style="text-align: right;">   F </td><td style="text-align: right;">  47</td>
</tr>
<tr>
 <td style="text-align: right;">
      ...</td>
</tr>

</table>

<p>we fit a model with  
</p>
<p><code>fit &lt;- lm(SBP~Sex+Age)</code>
</p>
<p>and we want to plot the relationship between Age and SBP.  A
'conditional' plot illustrates the relationship between the two,
conditional on the sex being, say, Male (the default in visreg is to
choose the most common category). 
</p>
<p>The 'contrast' plot in visreg, on the other hand, illustrates the
effect on SBP of a <em>change</em> in age &ndash; the default in visreg is
to use the mean age as the reference point for this change.  Since
the above model does not have an interaction, this effect will be
the same for men and women, and thus does not require you to specify
a sex for the plot.   
</p>
<p>Both conditional and contrast plots answer subtly different
questions, and both are useful in different situations.
</p>
</li>
<li> <p><b>Can visreg can be used for mixed models (i.e., from the
'nlme' or 'lme4' packages)?</b>
</p>
<p>Sort of.  The underlying basis on which visreg operates is by using
the predict method to plot predictions from the model.  Predictions
for mixed models are complicated.  In particular, there is no
<code>se.fit</code> option provided by the <code>predict</code> methods in the
<code>nlme</code> and <code>lme4</code> packages, so you cannot obtain
confidence bands for conditional plots.  Nevertheless, <code>visreg</code>
will produce plots of estimated coefficients and partial residuals.
</p>
<p>In addition, there may be certain nesting structures among the
covariates that <code>visreg</code> cannot be aware of; for example, if
you are trying to plot the effect of age for various individuals,
fixing sex at <code>sex=Male</code>, this may involve setting the sex of
female subjects to <code>Male</code> for the sake of the plot.  Whether
such a plot has any meaning, you will have to judge for yourself.
In general, contrast plots are more trustworthy than than
conditional plots, given the intricacies of setting up conditions in
a hierarchical model.
</p>
<p>Keep in mind that depending on what sort of predictions (BLUPs) you
are interested in, you may need to manually control the inclusion
of random effects in your predictions.  By default, visreg includes
no random effects (i.e., <code>level=0</code> for <code>nlme</code> models and
<code>re.form=NA</code> for <code>lme4</code> models).  If you are including a
random effect as a <code>by</code> variable in <code>visreg</code>, you most
likely want to add those effects back in, and you will have to do so
manually, by directly specifying the appropriate <code>level</code> or
<code>re.form</code> argument to <code>predict</code> (see <code>?predict.nlme</code>
or <code>?predict.merMod</code>).  Handling this appropriately is the
user's responsibility; I cannot hope to automatically decide this
for all possible mixed models that could be passed to visreg.
</p>
<p>As mentioned above, you cannot obtain confidence bands for
conditional plots.  In the words of the authors of the <code>lme4</code>
package, &quot;There is no option for computing standard errors of
predictions because it is difficult to define an efficient method
that incorporates uncertainty in the variance parameters&quot;; hence no
<code>se.fit</code> option.  You can, however, get confidence bands for
<code>'contrast'</code> plots.  In a contrast plot, the random effects
cancel and the above issue is avoided.
</p>
<p>If you are running into difficulty using <code>visreg</code> with mixed
models, feel free to e-mail me; mixed models have been less
extensively tested with <code>visreg</code> than fixed-effect models, and
there may still be bugs to work out.
</p>
</li>
<li> <p><b>How do I use visreg for a model with offset terms?</b>
</p>
<p>By default, visreg is set up to provide conditional plots in which
all other terms are set to their median value (or most common
category).  This includes offset terms.  It is not uncommon,
however, to want to see results with the offset included.  To obtain
these results, one needs to specify the offset among the arguments
to cond. For example, using the Insurance data from the MASS
package:
</p>
<p><code>utils::data(Insurance, package="MASS")</code><br />
<code>fit &lt;- glm(Claims ~ District + Group + Age +
      offset(log(Holders)), data = Insurance, family = poisson)</code><br />
<code>visreg(fit, "Group", scale="response")</code><br />
</p>
<p>This will provide the model's predictions for the expected number of
claims given the median number of holders (here, 136).  To obtain
the expected number of claims per holder, we need to specify
Holders=1 in cond:
</p>
<p><code>visreg(fit, "Group", scale="response", cond=list(Holders=1))</code>
</p>
<p>Note also that to ensure proper functionality with all of visreg's
options, the use of the <code>offset()</code> function, rather than the
<code>offset=</code> argument, is recommended.
</p>
</li>
<li> <p><b>Why doesn't visreg work with models I fit with package
XXX?</b>
</p>
<p><code>visreg()</code> relies on being able to call certain generic
functions to interface with the fitted model object that is passed
to it.  Specifically, if <code>fit</code> is the fit of a model that is
passed to <code>visreg</code>, the following have to work:
</p>
<p><code>model.frame(fit)</code>
<code>formula(fit)</code>
</p>
<p>If they do not, there is nothing I can really do on the
<code>visreg</code> end to get it to work &ndash; the author of the package
would need to add support for those generic functions to make it
more portable.  If the above lines of code <em>do</em> work and
<code>visreg</code> still fails, please let me know &ndash; perhaps there is a
bug somewhere that I can fix.
</p>
</li></ol>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>
<p>Maintainer: Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>


<hr>
<h2 id='visreg-package'>Visualization of regression models</h2><span id='topic+visreg.package'></span><span id='topic+visreg-package'></span>

<h3>Description</h3>

<p><code>visreg</code> provides a number of plotting functions for
visualizing fitted regression models: regression functions, confidence
bands, partial residuals, interactions, and more.</p>


<h3>Details</h3>

<p>This package allows the use of visreg and visreg2d, functions for
visualizing regression models.  See example below for the most basic
use, and the help pages for each function for details. 
Also see the cited manuscript for additional details.  If you have a
question or feature request, please e-mail me at
&lt;patrick-breheny@uiowa.edu&gt;.
</p>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>
<p>Maintainer: Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+visreg">visreg</a></code>
<code><a href="#topic+visreg2d">visreg2d</a></code>
<code><a href="#topic+visreg-faq">visreg-faq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp, data=airquality)
visreg(fit, "Wind")
</code></pre>

<hr>
<h2 id='visreg2d'>Visualization of regression functions for two variables</h2><span id='topic+visreg2d'></span>

<h3>Description</h3>

<p>A function used to visualize how two variables interact to affect the
response in regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visreg2d(fit, xvar, yvar, type=c("conditional", "contrast"), data=NULL,
trans=I, scale=c("linear", "response"), nn=99, cond=list(), plot=TRUE,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visreg2d_+3A_fit">fit</code></td>
<td>

<p>The fitted model object you wish to visualize.  Any object with 
'predict' and 'model.frame' methods are supported, including lm,
glm, gam, rlm, coxph, and many more.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_xvar">xvar</code></td>
<td>

<p>Character string specifying the variable to be put on the x-axis of
your plot.  Both continuous variables and factors are supported.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_yvar">yvar</code></td>
<td>

<p>Character string specifying the variable to be put on the y-axis of
your plot.  Both continuous variables and factors are supported.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_type">type</code></td>
<td>

<p>The type of plot to be produced.  The following options are
supported:
</p>

<ul>
<li><p> If 'conditional' is selected, the plot returned shows the
value of the variable on the x-axis and the change in response on
the y-axis, holding all other variables constant (by default,
median for numeric variables and most common category for factors).
</p>
</li>
<li><p> If 'contrast' is selected, the plot returned shows the effect
on the expected value of the response by moving the x variable away
from a reference point on the x-axis (for numeric variables, this is
taken to be the mean).
</p>
</li></ul>

<p>For more details, see references.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_data">data</code></td>
<td>

<p>The data frame used to fit the model.  Typically, visreg() can
figure out where the data is, so it is not necessary to provide
this.  In some cases, however, the data set cannot be located and
must be supplied explicitly.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_trans">trans</code></td>
<td>

<p>(Optional) A function specifying a transformation for the vertical
axis.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_scale">scale</code></td>
<td>

<p>By default, the model is plotted on the scale of the linear
predictor.  If <code>scale='response'</code> for a glm, the inverse link
function will be applied so that the model is plotted on the scale
of the original response.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_nn">nn</code></td>
<td>

<p>Resolution of the three dimensional plot.  Higher values will
results in a smoother looking plot.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_cond">cond</code></td>
<td>

<p>Named list specifying conditional values of other explanatory
variables. By default, conditional plots in visreg are constructed
by filling in other explanatory variables with the median (for
numeric variables) or most common category (for factors), but this
can be overridden by specifying their values using <code>cond</code> (see
examples).
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_plot">plot</code></td>
<td>

<p>Send the calculations to <code><a href="#topic+plot.visreg2d">plot.visreg2d</a></code>, producing a
plot?  Default is TRUE.
</p>
</td></tr>
<tr><td><code id="visreg2d_+3A_...">...</code></td>
<td>

<p>Graphical parameters (e.g., <code>ylab</code>) can be passed to the
function to customize the plots.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>visreg2d</code> object consisting of:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Values of <code>xvar</code> to be plotted</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Values of <code>yvar</code> to be plotted</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Values of outcome to be plotted</p>
</td></tr>
<tr><td><code>meta</code></td>
<td>
<p>Meta-information needed to construct plots, such as the
name of the x and y variables.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Patrick Breheny and Woodrow Burchett
</p>


<h3>References</h3>


<ul>
<li> <p><a href="http://pbreheny.github.io/visreg">http://pbreheny.github.io/visreg</a>
</p>
</li>
<li><p> Breheny, P. and Burchett, W. (2017), Visualizing regression
models using visreg.
<a href="https://journal.r-project.org/archive/2017/RJ-2017-046/index.html">https://journal.r-project.org/archive/2017/RJ-2017-046/index.html</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="http://pbreheny.github.io/visreg/surface.html">http://pbreheny.github.io/visreg/surface.html</a>
<code><a href="#topic+visreg">visreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp + I(Wind^2) + I(Temp^2) +
I(Wind*Temp)+I(Wind*Temp^2) + I(Temp*Wind^2) + I(Temp^2*Wind^2),
data=airquality)

visreg2d(fit, x="Wind", y="Temp", plot.type="image")
visreg2d(fit, x="Wind", y="Temp", plot.type="persp")

## Requires the rgl package
## Not run: 
visreg2d(fit, x="Wind", y="Temp", plot.type="rgl")

## End(Not run)

## Requires the ggplot2 package
## Not run: 
visreg2d(fit, x="Wind", y="Temp", plot.type="gg")

## End(Not run)

</code></pre>

<hr>
<h2 id='visregList'>Join multiple visreg objects together in a list</h2><span id='topic+visregList'></span>

<h3>Description</h3>

<p>This function takes multiple visreg objects, from separate calls to
<code>visreg()</code>, and joins them together in a single object.  The single object
will be of type <code>visregList</code> unless <code>collapse=TRUE</code> is specified, in
which case the list will be collapsed back down into a single <code>visreg</code>
object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>visregList(..., labels, collapse=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visregList_+3A_...">...</code></td>
<td>

<p><code>visreg</code> objects, as produced by calls to <code><a href="#topic+visreg">visreg</a></code>.
</p>
</td></tr>
<tr><td><code id="visregList_+3A_labels">labels</code></td>
<td>

<p>A character vector with length corresponding to the number of <code>visreg</code>
objects passed to the function that provides labels for the different
objects in subsequent plots.  Only has an effect if <code>collapse=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="visregList_+3A_collapse">collapse</code></td>
<td>

<p>If <code>TRUE</code>, the resulting object will be collapsed down into a single
<code>visreg</code> object.  If <code>FALSE</code>, the resulting object will be a
<code>visregList</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>visreg</code> or <code>visregList</code> object, depending on the value of
<code>collapse</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick Breheny
</p>


<h3>See Also</h3>

<p><code><a href="#topic+visreg">visreg</a></code>
<code><a href="#topic+plot.visreg">plot.visreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp, data=airquality)
v1 &lt;- visreg(fit, "Wind", plot=FALSE, alpha=0.2)
v2 &lt;- visreg(fit, "Wind", plot=FALSE, alpha=0.01)
vv1 &lt;- visregList(v1, v2, collapse=FALSE)
vv2 &lt;- visregList(v1, v2, collapse=TRUE,
                  labels=c("Confidence: 0.80", "Confidence: 0.99"))
op &lt;- par(mfrow=c(1,2))
plot(vv1)
par(op)
plot(vv2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
