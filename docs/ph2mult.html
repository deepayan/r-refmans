<!DOCTYPE html><html lang="en"><head><title>Help for package ph2mult</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ph2mult}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binom.design'><p>The design function for Simon (admissible) two-stage design</p></a></li>
<li><a href='#binom.power'><p>The power function for Simon (admissible) two-stage design</p></a></li>
<li><a href='#IUT.design'><p>The design function for multinomial designs under intersection-union test (IUT)</p></a></li>
<li><a href='#IUT.power'><p>The power function for multinomial designs under intersection-union test (IUT)</p></a></li>
<li><a href='#UIT.design'><p>The design function for multinomial designs under union-intersection test (UIT)</p></a></li>
<li><a href='#UIT.power'><p>The power function for multinomial designs under union-intersection test (UIT)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase II Clinical Trial Design for Multinomial Endpoints</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Yalin Zhu, Rui Qin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yalin Zhu &lt;yalin.zhu@outlook.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide multinomial design methods under intersection-union test (IUT) and union-intersection test (UIT) scheme for Phase II trial. The design types include : Minimax (minimize the maximum sample size), Optimal (minimize the expected sample size), Admissible (minimize the Bayesian risk) and Maxpower (maximize the exact power level).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>clinfun, graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gsDesign, survival</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-11-23 03:43:29 UTC; kaijingzhang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-11-23 09:38:49</td>
</tr>
</table>
<hr>
<h2 id='binom.design'>The design function for Simon (admissible) two-stage design</h2><span id='topic+binom.design'></span>

<h3>Description</h3>

<p>Search criterion to find the Optimal, Minimax, Admissible and
Maximized power design stopping boundary and corresponding sample size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.design(type = c("minimax","optimal","maxpower","admissible"), p0, p1,
signif.level=0.05, power.level=0.85, nmax=100, plot.out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom.design_+3A_type">type</code></td>
<td>
<p>the output types of design, choose from &quot;minimax&quot;,&quot;optimal&quot;,&quot;admissible&quot; and &quot;maxpower&quot;</p>
</td></tr>
<tr><td><code id="binom.design_+3A_p0">p0</code></td>
<td>
<p>undesirable response rate.</p>
</td></tr>
<tr><td><code id="binom.design_+3A_p1">p1</code></td>
<td>
<p>desirable response rate for treatment efficacy.</p>
</td></tr>
<tr><td><code id="binom.design_+3A_signif.level">signif.level</code></td>
<td>
<p>threshold for the probability of declaring drug desirable under p0.</p>
</td></tr>
<tr><td><code id="binom.design_+3A_power.level">power.level</code></td>
<td>
<p>threshold for the probability of declaring drug desirable under p1.</p>
</td></tr>
<tr><td><code id="binom.design_+3A_nmax">nmax</code></td>
<td>
<p>maximum total sample size</p>
</td></tr>
<tr><td><code id="binom.design_+3A_plot.out">plot.out</code></td>
<td>
<p>logical; if FALSE (default), do not output plot, otherwise, output a plot for  design selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set: <code class="reqn">r_1</code> and <code class="reqn">n_1</code> for first stage <code class="reqn">r</code> and <code class="reqn">n</code> for second stage</p>
</td></tr>
</table>


<h3>References</h3>

<p>Simon, R. (1989).
<em>Optimal two-stage designs for phase II clinical trials.</em>
<em>Controlled clinical trials</em> <strong>10(1)</strong>, 1-10.
</p>
<p>Jung, S. H., Lee, T., Kim, K., &amp; George, S. L. (2004).
<em>Admissible two-stage designs for phase II cancer clinical trials.</em>
<em>Statistics in medicine</em> <strong>23(4)</strong>, 561-569.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.design(type = "admissible", p0 = 0.15, p1 = 0.3, signif.level = 0.05, power.level = 0.9,
plot.out = TRUE)
</code></pre>

<hr>
<h2 id='binom.power'>The power function for Simon (admissible) two-stage design</h2><span id='topic+binom.power'></span>

<h3>Description</h3>

<p>Calculate the type I error or power of a two-stage design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.power(r1,n1,r,n,p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binom.power_+3A_r1">r1</code></td>
<td>
<p>first stage threshold to stop the trial for futility.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_n1">n1</code></td>
<td>
<p>first stage sample size.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_r">r</code></td>
<td>
<p>overall threshold to stop the trial for futility.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_n">n</code></td>
<td>
<p>total sample size.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_p">p</code></td>
<td>
<p>pre-specified response rate, <code class="reqn">p=p_0</code> for calculating type I error, <code class="reqn">p=p_1</code> for calculating power.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>prob</code></td>
<td>
<p>the power function: <code class="reqn">\alpha = Pr(R \le r| p=p_0)</code> or <code class="reqn">1-\beta=Pr(R \le r| p=p_1)</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Simon, R. (1989).
<em>Optimal two-stage designs for phase II clinical trials.</em>
<em>Controlled clinical trials</em> <strong>10(1)</strong>, 1-10.
</p>


<h3>See Also</h3>

<p>binom.design
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate type I error
binom.power(5, 31, 16, 76, 0.15)
binom.power(5, 31, 16, 76, 0.3)

</code></pre>

<hr>
<h2 id='IUT.design'>The design function for multinomial designs under intersection-union test (IUT)</h2><span id='topic+IUT.design'></span>

<h3>Description</h3>

<p>Search the type I error or power of a multinomial (response and disease progression) single- or two-stage design under IUT:
<code class="reqn">H_0: p_1 \le p_{01} \ OR \  p_2 \ge p_{02} \ versus \ H_1: p_1 \ge p_{11} &gt; p_{01} \ AND \ p_2 \le p_{12} &lt; p_{02}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IUT.design(method = c("s1", "s2", "s2.f"),
s1.rej, t1.rej, s1.acc, t1.acc, n1, s2.rej, t2.rej, n2,
s1.rej.delta=0, t1.rej.delta=0, s1.acc.delta=0, t1.acc.delta=0,
s2.rej.delta=0, t2.rej.delta=0, n1.delta=0, n2.delta=0,
p0.s, p0.t, p1.s, p1.t, signif.level = 0.05, power.level = 0.85,
show.time = TRUE, output = c("minimax","optimal","maxpower","admissible", "all"),
plot.out=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IUT.design_+3A_method">method</code></td>
<td>
<p>design methods according to number of stage and stopping rule, &quot;s1&quot; represents single-stage design stopping for both efficacy and futility, &quot;s2&quot; represents two-stage design stopping for both efficacy and futility, &quot;s2.f&quot; represents two-stage design stopping for futility only.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s1.rej">s1.rej</code></td>
<td>
<p>first stage responses threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t1.rej">t1.rej</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s1.acc">s1.acc</code></td>
<td>
<p>first stage responses threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t1.acc">t1.acc</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_n1">n1</code></td>
<td>
<p>first stage sample size. Applied for &quot;s1&quot;, &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s2.rej">s2.rej</code></td>
<td>
<p>second stage responses threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t2.rej">t2.rej</code></td>
<td>
<p>second stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_n2">n2</code></td>
<td>
<p>second stage sample size. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s1.rej.delta">s1.rej.delta</code></td>
<td>
<p>pre-specified search difference for s1.rej.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t1.rej.delta">t1.rej.delta</code></td>
<td>
<p>pre-specified search difference for t1.rej.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s1.acc.delta">s1.acc.delta</code></td>
<td>
<p>pre-specified search difference for s1.acc.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t1.acc.delta">t1.acc.delta</code></td>
<td>
<p>pre-specified search difference for t1.acc.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_s2.rej.delta">s2.rej.delta</code></td>
<td>
<p>pre-specified search difference for s2.rej.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_t2.rej.delta">t2.rej.delta</code></td>
<td>
<p>pre-specified search difference for t2.rej.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_n1.delta">n1.delta</code></td>
<td>
<p>pre-specified search difference for n1.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_n2.delta">n2.delta</code></td>
<td>
<p>pre-specified search difference for n2.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_p0.s">p0.s</code></td>
<td>
<p>pre-specified response rate under null hypothesis.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_p0.t">p0.t</code></td>
<td>
<p>pre-specified disease progression rate under null hypothesis.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_p1.s">p1.s</code></td>
<td>
<p>pre-specified response rate under alternative hypothesis.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_p1.t">p1.t</code></td>
<td>
<p>pre-specified disease progression rate under alternative hypothesis.
Note: type I error calculation needs to take maximum of the power function with <code class="reqn">(p.s,p.t)=(p_{01},0)</code> and <code class="reqn">(p.s,p.t)=(1-p_{02},p_{02})</code></p>
</td></tr>
<tr><td><code id="IUT.design_+3A_signif.level">signif.level</code></td>
<td>
<p>pre-specified significant level.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_power.level">power.level</code></td>
<td>
<p>pre-specified power level.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_show.time">show.time</code></td>
<td>
<p>logical; if TRUE (default), show the calculation time for the search function.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_output">output</code></td>
<td>
<p>the output types of design, choose from &quot;minimax&quot;,&quot;optimal&quot;,&quot;admissible&quot; and
&quot;maxpower&quot;.</p>
</td></tr>
<tr><td><code id="IUT.design_+3A_plot.out">plot.out</code></td>
<td>
<p>logical; if TRUE, output a plot for  design selection.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set satisfying the design types properties: <code class="reqn">s.rej</code>, <code class="reqn">t.rej</code> and <code class="reqn">N</code> for &quot;s1&quot;,
<code class="reqn">s1.rej</code>, <code class="reqn">t1.rej</code>,  <code class="reqn">s1.acc</code>, <code class="reqn">t1.acc</code> and  <code class="reqn">N1</code> for first stage and <code class="reqn">s2.rej</code>, <code class="reqn">t2.rej</code> and <code class="reqn">N2</code> for the second stage of &quot;s2&quot;,
<code class="reqn">s1.acc</code>, <code class="reqn">t1.acc</code> and  <code class="reqn">N1</code> for first stage and <code class="reqn">s2.rej</code>, <code class="reqn">t2.rej</code> and <code class="reqn">N2</code> for the second stage of &quot;s2.f&quot;,
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang, M. N., Devidas, M., &amp; Anderson, J. (2007).
<em>One- and two-stage designs for phase II window studies.</em>
<em>Statistics in medicine</em> <strong>, 26(13)</strong>, 2604-2614.
</p>
<p>Simon, R. (1989).
<em>Optimal two-stage designs for phase II clinical trials.</em>
<em>Controlled clinical trials</em> <strong>10(1)</strong>, 1-10.
</p>
<p>Jung, S. H., Lee, T., Kim, K., &amp; George, S. L. (2004).
<em>Admissible two-stage designs for phase II cancer clinical trials.</em>
<em>Statistics in medicine</em> <strong>23(4)</strong>, 561-569.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p01=0.1; p02=0.9
## Calculate type I error for single-stage design
IUT.design(method="s1",s1.rej=18, t1.rej = 12, n1=80,
s1.rej.delta = 1, t1.rej.delta = 1, n1.delta=1,
p0.s = 0.15, p0.t = 0.25, p1.s = 0.3, p1.t= 0.1, output = "minimax")

## Designs for two-stage design, output PET and EN under null hypothesis
IUT.design(method="s2",s1.rej = 11, t1.rej = 4, s1.acc=8, t1.acc = 5, n1=40,
s2.rej=18, t2.rej = 11, n2=40, p0.s = 0.15, p0.t = 0.25, p1.s = 0.3, p1.t= 0.1, output = "minimax")
IUT.design(method="s2",s1.rej = 11, t1.rej = 4, s1.acc=8, t1.acc = 5, n1=40,
s2.rej=18, t2.rej = 11, n2=40, p0.s = 0.15, p0.t = 0.25, p1.s = 0.3, p1.t= 0.1, output = "optimal")

</code></pre>

<hr>
<h2 id='IUT.power'>The power function for multinomial designs under intersection-union test (IUT)</h2><span id='topic+IUT.power'></span>

<h3>Description</h3>

<p>Calculate the type I error or power of a multinomial (response and disease progression) single- or two-stage design under IUT:
<code class="reqn">H_0: p_1 \le p_{01} \  OR  \ p_2 \ge p_{02} \ versus \ H_1: p_1 \ge p_{11} &gt; p_{01} \ AND \ p_2 \le p_{12} &lt; p_{02}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IUT.power(method, s1.rej, t1.rej, s1.acc, t1.acc, n1, s2.rej, t2.rej, n2, p.s, p.t,
output.all)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IUT.power_+3A_method">method</code></td>
<td>
<p>design methods according to number of stage and stopping rule, &quot;s1&quot; represents single-stage design stopping for both efficacy and futility, &quot;s2&quot; represents two-stage design stopping for both efficacy and futility, &quot;s2.f&quot; represents two-stage design stopping for futility only.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_s1.rej">s1.rej</code></td>
<td>
<p>first stage responses threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_t1.rej">t1.rej</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_s1.acc">s1.acc</code></td>
<td>
<p>first stage responses threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_t1.acc">t1.acc</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_n1">n1</code></td>
<td>
<p>first stage sample size. Applied for &quot;s1&quot;, &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_s2.rej">s2.rej</code></td>
<td>
<p>second stage responses threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_t2.rej">t2.rej</code></td>
<td>
<p>second stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_n2">n2</code></td>
<td>
<p>second stage sample size. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_p.s">p.s</code></td>
<td>
<p>pre-specified response rate, <code class="reqn">p.s=p_{01}</code> for calculating type I error , <code class="reqn">p=p_{11}</code> for calculating power.</p>
</td></tr>
<tr><td><code id="IUT.power_+3A_p.t">p.t</code></td>
<td>
<p>pre-specified disease progression rate,  <code class="reqn">p.s=p_{02}</code> for calculating type I error, <code class="reqn">p=p_{12}</code> for calculating power.
Note: type I error calculation needs to take maximum of the power function with <code class="reqn">(p.s,p.t)=(p_{01},0)</code> and <code class="reqn">(p.s,p.t)=(1-p_{02},p_{02})</code></p>
</td></tr>
<tr><td><code id="IUT.power_+3A_output.all">output.all</code></td>
<td>
<p>logical, if FALSE (default), only output the value of power or type I error, otherwise, also output the probability of early termination (PET) and expected sample size (EN). Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>prob</code></td>
<td>
<p>the power function <code class="reqn">g(...,p.s,p.t)</code>: <code class="reqn">\alpha = \max [g(...,p_{01},0), g(...,1-p_{02},p_{02}) ]</code> or <code class="reqn">g(...,p_{11},p_{12})</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang, M. N., Devidas, M., &amp; Anderson, J. (2007).
<em>One- and two-stage designs for phase II window studies.</em>
<em>Statistics in medicine</em> <strong>, 26(13)</strong>, 2604-2614.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p01=0.1; p02=0.9
## Calculate type I error for single-stage design
max(IUT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01, p.t=0),
IUT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=1-p02, p.t=p02))
## Calculate power for single-stage design
IUT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design
max(IUT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=0),
IUT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=1-p02, p.t=p02))
## Output PET and EN under null hypothesis
IUT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)[-1]
## Calculate power for two-stage design
IUT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design stopping for futility only,
## output PET and EN under null hypothesis
max(IUT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=0),
IUT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=1-p02, p.t=p02))
## Output PET and EN under null hypothesis
IUT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)[-1]
## Calculate power for two-stage design
IUT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)
</code></pre>

<hr>
<h2 id='UIT.design'>The design function for multinomial designs under union-intersection test (UIT)</h2><span id='topic+UIT.design'></span>

<h3>Description</h3>

<p>Search the type I error or power of a multinomial (response and disease progression) single- or two-stage design under IUT:
<code class="reqn">H_0: p_1 \le p_{01} \ AND  \ p_2 \ge p_{02} \ versus \ H_1: p_1 \ge p_{11} &gt; p_{01} \ OR  \ p_2 \le p_{12} &lt; p_{02}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UIT.design(method, s1.rej, t1.rej, s1.acc, t1.acc, n1, s2.rej, t2.rej, n2,
s1.rej.delta=0, t1.rej.delta=0, s1.acc.delta=0, t1.acc.delta=0,
s2.rej.delta=0, t2.rej.delta=0, n1.delta=0, n2.delta=0, p0.s, p0.t, p1.s, p1.t,
signif.level = 0.05, power.level = 0.85, output.all = FALSE, show.time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UIT.design_+3A_method">method</code></td>
<td>
<p>design methods according to number of stage and stopping rule, &quot;s1&quot; represents single-stage design stopping for both efficacy and futility, &quot;s2&quot; represents two-stage design stopping for both efficacy and futility, &quot;s2.f&quot; represents two-stage design stopping for futility only.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s1.rej">s1.rej</code></td>
<td>
<p>first stage responses threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t1.rej">t1.rej</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s1.acc">s1.acc</code></td>
<td>
<p>first stage responses threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t1.acc">t1.acc</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_n1">n1</code></td>
<td>
<p>first stage sample size. Applied for &quot;s1&quot;, &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s2.rej">s2.rej</code></td>
<td>
<p>second stage responses threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t2.rej">t2.rej</code></td>
<td>
<p>second stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_n2">n2</code></td>
<td>
<p>second stage sample size. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s1.rej.delta">s1.rej.delta</code></td>
<td>
<p>pre-specified search difference for s1.rej.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t1.rej.delta">t1.rej.delta</code></td>
<td>
<p>pre-specified search difference for t1.rej.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s1.acc.delta">s1.acc.delta</code></td>
<td>
<p>pre-specified search difference for s1.acc.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t1.acc.delta">t1.acc.delta</code></td>
<td>
<p>pre-specified search difference for t1.acc.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_s2.rej.delta">s2.rej.delta</code></td>
<td>
<p>pre-specified search difference for s2.rej.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_t2.rej.delta">t2.rej.delta</code></td>
<td>
<p>pre-specified search difference for t2.rej.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_n1.delta">n1.delta</code></td>
<td>
<p>pre-specified search difference for n1.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_n2.delta">n2.delta</code></td>
<td>
<p>pre-specified search difference for n2.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_p0.s">p0.s</code></td>
<td>
<p>pre-specified response rate under null hypothesis.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_p0.t">p0.t</code></td>
<td>
<p>pre-specified disease progression rate under null hypothesis.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_p1.s">p1.s</code></td>
<td>
<p>pre-specified response rate under alternative hypothesis.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_p1.t">p1.t</code></td>
<td>
<p>pre-specified disease progression rate under alternative hypothesis.
Note: type I error calculation needs to take maximum of the power function with <code class="reqn">(p.s,p.t)=(p_{01},0)</code> and <code class="reqn">(p.s,p.t)=(1-p_{02},p_{02})</code></p>
</td></tr>
<tr><td><code id="UIT.design_+3A_signif.level">signif.level</code></td>
<td>
<p>pre-specified significant level.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_power.level">power.level</code></td>
<td>
<p>pre-specified power level.</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_output.all">output.all</code></td>
<td>
<p>logical; if TRUE, output all possible designs satisfying type I error and power restrictions, otherwise, only output the design with maximum power .</p>
</td></tr>
<tr><td><code id="UIT.design_+3A_show.time">show.time</code></td>
<td>
<p>logical; if TRUE (default), show the calculation time for the search function.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>boundset</code></td>
<td>
<p>the boundaries set satisfying the design types properties: <code class="reqn">s.rej</code>, <code class="reqn">t.rej</code> and <code class="reqn">N</code> for &quot;s1&quot;,
<code class="reqn">s1.rej</code>, <code class="reqn">t1.rej</code>,  <code class="reqn">s1.acc</code>, <code class="reqn">t1.acc</code> and  <code class="reqn">N1</code> for first stage and <code class="reqn">s2.rej</code>, <code class="reqn">t2.rej</code> and <code class="reqn">N2</code> for the second stage of &quot;s2&quot;,
<code class="reqn">s1.acc</code>, <code class="reqn">t1.acc</code> and  <code class="reqn">N1</code> for first stage and <code class="reqn">s2.rej</code>, <code class="reqn">t2.rej</code> and <code class="reqn">N2</code> for the second stage of &quot;s2.f&quot;,
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zee, B., Melnychuk, D., Dancey, J., &amp; Eisenhauer, E. (1999).
<em>Multinomial phase II cancer trials incorporating response and early progression.</em>
<em>Journal of biopharmaceutical statistics, </em> <strong>9(2),</strong> 351-363.
</p>
<p>Simon, R. (1989).
<em>Optimal two-stage designs for phase II clinical trials.</em>
<em>Controlled clinical trials</em> <strong>10(1)</strong>, 1-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Calculate type I error for single-stage design
UIT.design(method="s1",s1.rej=18, t1.rej = 12, n1=80,
p0.s = 0.15, p0.t = 0.25, p1.s = 0.3, p1.t= 0.1)

## Designs for two-stage design, output PET and EN under null hypothesis
UIT.design(method="s2",s1.rej = 11, t1.rej = 4, s1.acc=8, t1.acc = 5, n1=40,
s2.rej=18, t2.rej = 11, n2=40, p0.s = 0.15, p0.t = 0.25, p1.s = 0.3, p1.t= 0.1, output.all=TRUE)

</code></pre>

<hr>
<h2 id='UIT.power'>The power function for multinomial designs under union-intersection test (UIT)</h2><span id='topic+UIT.power'></span>

<h3>Description</h3>

<p>Calculate the type I error or power of a multinomial (response and disease progression) single- or two-stage design under UIT:
<code class="reqn">H_0: p_1 \le p_{01} \  AND  \ p_2 \ge p_{02} \ versus \ H_1: p_1 \ge p_{11} &gt; p_{01} \ OR \ p_2 \le p_{12} &lt; p_{02}</code>
(Note: original Zee et al. (1999) set up the correct hypotheses, but did not make a match decision.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UIT.power(method, s1.rej, t1.rej, s1.acc, t1.acc, n1, s2.rej, t2.rej, n2, p.s, p.t,
output.all)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UIT.power_+3A_method">method</code></td>
<td>
<p>design methods according to number of stage and stopping rule, &quot;s1&quot; represents single-stage design stopping for both efficacy and futility, &quot;s2&quot; represents two-stage design stopping for both efficacy and futility, &quot;s2.f&quot; represents two-stage design stopping for futility only.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_s1.rej">s1.rej</code></td>
<td>
<p>first stage responses threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_t1.rej">t1.rej</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s1&quot; or &quot;s2&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_s1.acc">s1.acc</code></td>
<td>
<p>first stage responses threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_t1.acc">t1.acc</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for futility. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_n1">n1</code></td>
<td>
<p>first stage sample size. Applied for &quot;s1&quot;, &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_s2.rej">s2.rej</code></td>
<td>
<p>second stage responses threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_t2.rej">t2.rej</code></td>
<td>
<p>second stage disease progressions threshold to stop the trial for efficacy. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_n2">n2</code></td>
<td>
<p>second stage sample size. Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_p.s">p.s</code></td>
<td>
<p>pre-specified response rate, <code class="reqn">p.s=p_{01}</code> for calculating type I error , <code class="reqn">p=p_{11}</code> for calculating power.</p>
</td></tr>
<tr><td><code id="UIT.power_+3A_p.t">p.t</code></td>
<td>
<p>pre-specified disease progression rate,  <code class="reqn">p.s=p_{02}</code> for calculating type I error, <code class="reqn">p=p_{12}</code> for calculating power.
Note: type I error calculation needs to take maximum of the power function with <code class="reqn">(p.s,p.t)=(p_{01},0)</code> and <code class="reqn">(p.s,p.t)=(1-p_{02},p_{02})</code></p>
</td></tr>
<tr><td><code id="UIT.power_+3A_output.all">output.all</code></td>
<td>
<p>logical, if FALSE (default), only output the value of power or type I error, otherwise, also output the probability of early termination (PET) and expected sample size (EN). Applied for &quot;s2&quot; or &quot;s2.f&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>prob</code></td>
<td>
<p>the power function <code class="reqn">g(...,p.s,p.t)</code>: <code class="reqn">\alpha = \max [g(...,p_{01},0), g(...,1-p_{02},p_{02}) ]</code> or <code class="reqn">g(...,p_{11},p_{12})</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Zee, B., Melnychuk, D., Dancey, J., &amp; Eisenhauer, E. (1999).
<em>Multinomial phase II cancer trials incorporating response and early progression.</em>
<em>Journal of biopharmaceutical statistics, </em> <strong>9(2),</strong> 351-363.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p01=0.1; p02=0.9
## Calculate type I error for single-stage design
UIT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01, p.t=p02)
## Calculate power for single-stage design
UIT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design, output PET and EN under null hypothesis
UIT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)
## Calculate power for two-stage design
UIT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design stopping for futility only,
## output PET and EN under null hypothesis
UIT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)
## Calculate power for two-stage design
UIT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
