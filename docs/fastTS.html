<!DOCTYPE html><html><head><title>Help for package fastTS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fastTS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AICc'><p>internal AICc function for lasso models</p></a></li>
<li><a href='#fastTS'><p>Fast time series modeling with ranked sparsity</p></a></li>
<li><a href='#penalty_scaler'><p>Penalty Scaling Function for parametric penalty weights</p></a></li>
<li><a href='#predict.fastTS'><p>Predict function for fastTS object</p></a></li>
<li><a href='#uihc_ed_arrivals'><p>Hourly arrivals into the University of Iowa Hospital Emergency Department</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast Time Series Modeling for Seasonal Series with Exogenous
Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of sparsity-ranked lasso and related methods 
    for time series data. This methodology is especially useful for 
    large time series with exogenous features and/or complex 
    seasonality. Originally described in Peterson and Cavanaugh 
    (2022) &lt;<a href="https://doi.org/10.1007%2Fs10182-021-00431-7">doi:10.1007/s10182-021-00431-7</a>&gt; in the context of variable 
    selection with interactions and/or polynomials, ranked sparsity is 
    a philosophy with methods useful for variable selection in the 
    presence of prior informational asymmetry. This situation exists for time 
    series data with complex seasonality, as shown in Peterson and Cavanaugh 
    (2024) &lt;<a href="https://doi.org/10.1177%2F1471082X231225307">doi:10.1177/1471082X231225307</a>&gt;, which also describes this package
    in greater detail. The sparsity-ranked penalization methods for time series
    implemented in 'fastTS' can fit large/complex/high-frequency time series
    quickly, even with a high-dimensional exogenous feature set. The method is
    considerably faster than its competitors, while often producing more 
    accurate predictions. Also included is a long hourly series of arrivals 
    into the University of Iowa Emergency Department with concurrent local 
    temperature.</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, kableExtra, knitr, magrittr, rmarkdown, testthat (&ge;
3.0.0), tibble</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, methods, ncvreg, RcppRoll, rlang, yardstick</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://petersonr.github.io/fastTS/">https://petersonr.github.io/fastTS/</a>,
<a href="https://github.com/petersonR/fastTS/">https://github.com/petersonR/fastTS/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/petersonR/fastTS/issues">https://github.com/petersonR/fastTS/issues</a></td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-28</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-28 21:21:10 UTC; ryanpeterson</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan Andrew Peterson
    <a href="https://orcid.org/0000-0002-4650-5798"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan Andrew Peterson &lt;ryan.a.peterson@cuanschutz.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 21:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AICc'>internal AICc function for lasso models</h2><span id='topic+AICc'></span><span id='topic+get_oos_results'></span><span id='topic+get_model_matrix'></span>

<h3>Description</h3>

<p>internal AICc function for lasso models
</p>
<p>Internal function for obtaining oos results
</p>
<p>Internal function for converting time series into model matrix of lags
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AICc(fit, eps = 1)

get_oos_results(fits, ytest, Xtest)

get_model_matrix(y, X = NULL, n_lags_max)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AICc_+3A_fit">fit</code></td>
<td>
<p>an object with logLik method,</p>
</td></tr>
<tr><td><code id="AICc_+3A_eps">eps</code></td>
<td>
<p>minimum df used in computation</p>
</td></tr>
<tr><td><code id="AICc_+3A_fits">fits</code></td>
<td>
<p>a list of fits with different tuning parameters</p>
</td></tr>
<tr><td><code id="AICc_+3A_ytest">ytest</code></td>
<td>
<p>validation data</p>
</td></tr>
<tr><td><code id="AICc_+3A_xtest">Xtest</code></td>
<td>
<p>new X data, including lags</p>
</td></tr>
<tr><td><code id="AICc_+3A_y">y</code></td>
<td>
<p>time series vector</p>
</td></tr>
<tr><td><code id="AICc_+3A_x">X</code></td>
<td>
<p>Additional exogenous features</p>
</td></tr>
<tr><td><code id="AICc_+3A_n_lags_max">n_lags_max</code></td>
<td>
<p>Maximum number of lags to add</p>
</td></tr>
</table>

<hr>
<h2 id='fastTS'>Fast time series modeling with ranked sparsity</h2><span id='topic+fastTS'></span><span id='topic+plot.fastTS'></span><span id='topic+coef.fastTS'></span><span id='topic+print.fastTS'></span><span id='topic+summary.fastTS'></span>

<h3>Description</h3>

<p>Uses penalized regression to quickly fit time series models with
potentially complex seasonal patterns and exogenous variables.
Based on methods described in Peterson &amp; Cavanaugh (2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastTS(
  y,
  X = NULL,
  n_lags_max,
  gamma = c(0, 2^(-2:4)),
  ptrain = 0.8,
  pf_eps = 0.01,
  w_endo,
  w_exo,
  weight_type = c("pacf", "parametric"),
  m = NULL,
  r = c(rep(0.1, length(m)), 0.01),
  plot = FALSE,
  ncvreg_args = list(penalty = "lasso", returnX = FALSE, lambda.min = 0.001)
)

## S3 method for class 'fastTS'
plot(x, log.l = TRUE, ...)

## S3 method for class 'fastTS'
coef(object, choose = c("AICc", "BIC"), ...)

## S3 method for class 'fastTS'
print(x, ...)

## S3 method for class 'fastTS'
summary(object, choose = c("AICc", "BIC"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastTS_+3A_y">y</code></td>
<td>
<p>univariate time series outcome</p>
</td></tr>
<tr><td><code id="fastTS_+3A_x">X</code></td>
<td>
<p>matrix of predictors (no intercept)</p>
</td></tr>
<tr><td><code id="fastTS_+3A_n_lags_max">n_lags_max</code></td>
<td>
<p>maximum number of lags to consider</p>
</td></tr>
<tr><td><code id="fastTS_+3A_gamma">gamma</code></td>
<td>
<p>vector of exponent for weights</p>
</td></tr>
<tr><td><code id="fastTS_+3A_ptrain">ptrain</code></td>
<td>
<p>prop. to leave out for test data</p>
</td></tr>
<tr><td><code id="fastTS_+3A_pf_eps">pf_eps</code></td>
<td>
<p>penalty factors below this will be set to zero</p>
</td></tr>
<tr><td><code id="fastTS_+3A_w_endo">w_endo</code></td>
<td>
<p>optional pre-specified weights for endogenous terms</p>
</td></tr>
<tr><td><code id="fastTS_+3A_w_exo">w_exo</code></td>
<td>
<p>optional pre-specified weights for exogenous terms (details)</p>
</td></tr>
<tr><td><code id="fastTS_+3A_weight_type">weight_type</code></td>
<td>
<p>type of weights to use for endogenous terms</p>
</td></tr>
<tr><td><code id="fastTS_+3A_m">m</code></td>
<td>
<p>mode(s) for seasonal lags (used if weight_type = &quot;parametric&quot;)</p>
</td></tr>
<tr><td><code id="fastTS_+3A_r">r</code></td>
<td>
<p>penalty factors for seasonal + local scaling functions (used if
weight_type = &quot;parametric&quot;)</p>
</td></tr>
<tr><td><code id="fastTS_+3A_plot">plot</code></td>
<td>
<p>logical; whether to plot the penalty functions</p>
</td></tr>
<tr><td><code id="fastTS_+3A_ncvreg_args">ncvreg_args</code></td>
<td>
<p>additional args to pass through to ncvreg</p>
</td></tr>
<tr><td><code id="fastTS_+3A_x">x</code></td>
<td>
<p>a fastTS object</p>
</td></tr>
<tr><td><code id="fastTS_+3A_log.l">log.l</code></td>
<td>
<p>Should the x-axis (lambda) be logged?</p>
</td></tr>
<tr><td><code id="fastTS_+3A_...">...</code></td>
<td>
<p>passed to downstream functions</p>
</td></tr>
<tr><td><code id="fastTS_+3A_object">object</code></td>
<td>
<p>a fastTS object</p>
</td></tr>
<tr><td><code id="fastTS_+3A_choose">choose</code></td>
<td>
<p>which criterion to use for lambda selection (AICc or BIC)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default weights for exogenous features will be chosen based on a
similar approach to the adaptive lasso (using bivariate OLS estimates). For
lower dimensional X, it's advised to set <code>w_exo="unpenalized"</code>,
because this allows for statistical inference on exogenous variable
coefficients via the <code>summary</code> function.
</p>
<p>By default, a seasonal frequency <code>m</code> must not be specified and the
PACF is used to estimate the weights for endogenous terms. A parametric
version is also available, which allows for a penalty scaling function that
penalizes seasonal and recent lags less according to the penalty scaling
functions described in Peterson &amp; Cavanaugh (2024). See the
<code>penalty_scaler</code> function for more details, and to plot the penalty
function for various values of <code>m</code> and <code>r</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>fastTS</code> with elements
</p>
<table>
<tr><td><code>fits</code></td>
<td>
<p>a list of lasso fits</p>
</td></tr> <tr><td><code>ncvreg_args</code></td>
<td>
<p>arguments passed to
ncvreg</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>the (negative) exponent on the penalty weights, one
for each fit</p>
</td></tr>
<tr><td><code>n_lags_max</code></td>
<td>
<p>the maximum number of lags</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p>the time series</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the utilized matrix of exogenous features</p>
</td></tr>
<tr><td><code>oos_results</code></td>
<td>
<p>results on test data using best of fits</p>
</td></tr>
<tr><td><code>train_idx</code></td>
<td>
<p>index of observations used in training data</p>
</td></tr>
<tr><td><code>weight_type</code></td>
<td>
<p>the type of weights used for endogenous terms</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>the mode(s) for seasonal lags (used if weight_type =
&quot;parametric&quot;)</p>
</td></tr> <tr><td><code>r</code></td>
<td>
<p>penalty factors for seasonal + local scaling
functions</p>
</td></tr>
<tr><td><code>ptrain</code></td>
<td>
<p>the proportion used to train the model</p>
</td></tr>
</table>
<p>x invisibly
</p>
<p>a vector of model coefficients
</p>
<p>x (invisibly)
</p>
<p>the summary object produced by ncvreg
evaluated at the best tuning parameter combination
(best AICc).
</p>


<h3>References</h3>

<p>Breheny, P. and Huang, J. (2011) Coordinate descent algorithms
for nonconvex penalized regression, with applications to biological feature
selection. Ann. Appl. Statist., 5: 232-253.
</p>
<p>Peterson, R.A., Cavanaugh, J.E. (2022) Ranked sparsity: a cogent
regularization framework for selecting and estimating feature interactions
and polynomials. AStA Adv Stat Anal.
https://doi.org/10.1007/s10182-021-00431-7
</p>
<p>Peterson, R.A., Cavanaugh, J.E. (2024). Fast, effective, and coherent time
series modeling using the sparsity-ranked lasso. Statistical Modelling
(accepted). DOI: https://doi.org/10.48550/arXiv.2211.01492
</p>


<h3>See Also</h3>

<p>predict.fastTS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("LakeHuron")
fit_LH &lt;- fastTS(LakeHuron)
fit_LH
coef(fit_LH)
plot(fit_LH)

</code></pre>

<hr>
<h2 id='penalty_scaler'>Penalty Scaling Function for parametric penalty weights</h2><span id='topic+penalty_scaler'></span>

<h3>Description</h3>

<p>Penalty Scaling Function for parametric penalty weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penalty_scaler(lag, m, r, plot = TRUE, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penalty_scaler_+3A_lag">lag</code></td>
<td>
<p>a vector of lags for which to calculate the penalty function</p>
</td></tr>
<tr><td><code id="penalty_scaler_+3A_m">m</code></td>
<td>
<p>a vector of seasonality modes</p>
</td></tr>
<tr><td><code id="penalty_scaler_+3A_r">r</code></td>
<td>
<p>a vector of dim (m + 1) for the factor penalties on c(m, time)</p>
</td></tr>
<tr><td><code id="penalty_scaler_+3A_plot">plot</code></td>
<td>
<p>logical; whether to plot the penalty function</p>
</td></tr>
<tr><td><code id="penalty_scaler_+3A_log">log</code></td>
<td>
<p>logical; whether to return the log of the penalty function</p>
</td></tr>
</table>

<hr>
<h2 id='predict.fastTS'>Predict function for fastTS object</h2><span id='topic+predict.fastTS'></span>

<h3>Description</h3>

<p>Predict function for fastTS object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fastTS'
predict(
  object,
  n_ahead = 1,
  X_test,
  y_test,
  cumulative = FALSE,
  forecast_ahead = FALSE,
  return_intermediate = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fastTS_+3A_object">object</code></td>
<td>
<p>an fastTS object</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_n_ahead">n_ahead</code></td>
<td>
<p>the look-ahead period for predictions</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_x_test">X_test</code></td>
<td>
<p>a matrix exogenous features for future predictions (optional)</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_y_test">y_test</code></td>
<td>
<p>the test series for future predictions (optional)</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_cumulative">cumulative</code></td>
<td>
<p>cumulative (rolling) sums of 1-, 2-, 3-, ..., k-step-ahead
predictions.</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_forecast_ahead">forecast_ahead</code></td>
<td>
<p>returns forecasted values for end of training series</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_return_intermediate">return_intermediate</code></td>
<td>
<p>if TRUE, returns the intermediate predictions between
the 1st and n_ahead predictions, as data frame.</p>
</td></tr>
<tr><td><code id="predict.fastTS_+3A_...">...</code></td>
<td>
<p>currently unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'y_test' argument must be supplied if predictions are desired or if
'n_ahead' &lt; 'nrow(X_test)'. This is because in order to obtain 1-step
forecast for, say, the 10th observation in the test data set, the 9th
observation of 'y_test' is required.
</p>
<p>Forecasts for the first
'n_ahead' observations after the training set can be obtained by setting
'forecast_ahead' to TRUE, which will return the forecasted values at
the end of the training data. it produces the 1-step-ahead prediction,
the 2-step-ahead prediction, ... through the 'n_ahead'-step prediction.
The 'cumulative' argument is similar but will return the cumulative (rolling)
sums of 1-, 2-, 3=, ..., 'n_ahead'-step-ahead predictions.
</p>


<h3>Value</h3>

<p>a vector of predictions, or a matrix of 1- through n_ahead predictions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("LakeHuron")
fit_LH &lt;- fastTS(LakeHuron)
predict(fit_LH)

</code></pre>

<hr>
<h2 id='uihc_ed_arrivals'>Hourly arrivals into the University of Iowa Hospital Emergency Department</h2><span id='topic+uihc_ed_arrivals'></span>

<h3>Description</h3>

<p>A data set containing the 17 columns described below. There are 41640
observations running from 2013 to 2018. Data set are already sorted by time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uihc_ed_arrivals
</code></pre>


<h3>Format</h3>

<p>a data frame with 17 columns and 41640 rows:
</p>

<dl>
<dt>Year</dt><dd><p>Calendar year</p>
</dd>
<dt>Quarter</dt><dd><p>Fiscal year quarter</p>
</dd>
<dt>Month</dt><dd><p>Integer for month of year</p>
</dd>
<dt>Day</dt><dd><p>Integer for day of month</p>
</dd>
<dt>Hour</dt><dd><p>Integer for hour of day</p>
</dd>
<dt>Arrivals</dt><dd><p>Number of arrivals into the ED (outcome)</p>
</dd>
<dt>Date</dt><dd><p>Date</p>
</dd>
<dt>Weekday</dt><dd><p>Indicator for day of week</p>
</dd>
<dt>temp</dt><dd><p>hourly concurrent temperature</p>
</dd>
<dt>xmas</dt><dd><p>Christmas day indicator</p>
</dd>
<dt>xmas2</dt><dd><p>Day after Christmas</p>
</dd>
<dt>nye</dt><dd><p>New Years Eve indicator</p>
</dd>
<dt>nyd</dt><dd><p>New Years Day indicator</p>
</dd>
<dt>thx</dt><dd><p>Thanksgiving day indicator</p>
</dd>
<dt>thx</dt><dd><p>Thanksgiving day (after) indicator</p>
</dd>
<dt>ind</dt><dd><p>Independence day indicator</p>
</dd>
<dt>game_Day</dt><dd><p>Hawkeye football game day indicator</p>
</dd>
</dl>



<h3>Source</h3>

<p>UIHC Emergency Department.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
