<!DOCTYPE html><html><head><title>Help for package LipidMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LipidMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acylcerdb'>
<p>AcylCeramides database</p></a></li>
<li><a href='#adductsTable'>
<p>Adducts table</p></a></li>
<li><a href='#alignmsbatch'><p>Align samples from an msbatch</p></a></li>
<li><a href='#annotateIsotopes'><p>Annotate isotopes</p></a></li>
<li><a href='#annotatemsbatch'><p>Lipid annotation for an msbatch</p></a></li>
<li><a href='#assignDB'><p>Load LipidMS default data bases</p></a></li>
<li><a href='#baconjdb'>
<p>Bile acids conjugates database</p></a></li>
<li><a href='#badb'>
<p>Bile acids database</p></a></li>
<li><a href='#batchdataProcessing'><p>Process several mzXML files (peakpicking and isotope annotation) and create an</p>
msbatch for batch processing.</a></li>
<li><a href='#carnitinesdb'>
<p>Carnitines database</p></a></li>
<li><a href='#cbs'><p>Total number of carbons and double bounds</p></a></li>
<li><a href='#CEdb'>
<p>CEs database</p></a></li>
<li><a href='#cerdb'>
<p>Ceramides database</p></a></li>
<li><a href='#cerPdb'>
<p>Ceramides Phosphate database</p></a></li>
<li><a href='#chainFrags'><p>Search of chain specific fragments</p></a></li>
<li><a href='#chains'><p>extract chains composition from a lipid name</p></a></li>
<li><a href='#checkClass'><p>Search of class fragments to confirm the lipid class.</p></a></li>
<li><a href='#checkIntensityRules'><p>Check intensity rules</p></a></li>
<li><a href='#checkIntRules'><p>Check intensity rules</p></a></li>
<li><a href='#cldb'>
<p>Cardiolipins database</p></a></li>
<li><a href='#clust'><p>Clustering for MS peaks based on mz or RT.</p></a></li>
<li><a href='#clustdist'><p>Calculate max distance between clusters.</p></a></li>
<li><a href='#clustering'><p>EIC extraction based on previous partitions generated by partitioning</p></a></li>
<li><a href='#coelutingFrags'><p>Coeluting fragments extraction</p></a></li>
<li><a href='#coelutionScore'><p>calculate coelution score between two peaks</p></a></li>
<li><a href='#combineChains'><p>Combine chain fragments that could belong to the same precursor.</p></a></li>
<li><a href='#confLevels'>
<p>Confidence Annotation Levels</p></a></li>
<li><a href='#createLipidDB'><p>Customizable lipid DBs creator</p></a></li>
<li><a href='#crossAdducts'><p>Cross different candidates tables to remove false positives.</p></a></li>
<li><a href='#crossTables'><p>Cross the original MS1 peaklist with the annotation results</p></a></li>
<li><a href='#dataProcessing'><p>Process mzXML files individually: peakpicking and isotope annotation</p></a></li>
<li><a href='#dbFourChains'><p>Creation of a database for C.</p></a></li>
<li><a href='#dbOneChain'><p>Creation of a database for Carnitines, CE, FA, HFA, LPL, MG, sphingoid</p>
bases and sphingoid bases phosphate.</a></li>
<li><a href='#dbSphingolipids'><p>Creation of a database for Cer, CerP, GlcCer and SM</p></a></li>
<li><a href='#dbThreeChains'><p>Creation of a database for TG.</p></a></li>
<li><a href='#dbTwoChains'><p>Creation of a database for FAHFA, DG and PL.</p></a></li>
<li><a href='#ddaFrags'><p>MS/MS scan extraction of a precursor in DDA</p></a></li>
<li><a href='#dgdb'>
<p>DGs database</p></a></li>
<li><a href='#diffcb'><p>Difference between two carbon:bounds structures</p></a></li>
<li><a href='#fadb'>
<p>FAs database</p></a></li>
<li><a href='#fahfadb'>
<p>FAHFAs database</p></a></li>
<li><a href='#fillpeaksmsbatch'><p>Fill peaks from a grouped msbatch</p></a></li>
<li><a href='#filtermsms'><p>Presence or absence of an mz value within a vector of mz values</p></a></li>
<li><a href='#filtrateAdducts'><p>Remove low adduct supported candidates to avoid false positives.</p></a></li>
<li><a href='#findCandidates'><p>Search of lipid candidates of a certain class</p></a></li>
<li><a href='#findMS2precursor'><p>find lisnks between MS1 peaks and precursors selected for MS2 in DDA</p></a></li>
<li><a href='#findPrecursor'><p>Find candidate precursor from fullMS function</p></a></li>
<li><a href='#frags'><p>Search for fragments of interest withing a list of coeluting fragments</p></a></li>
<li><a href='#getallpeaks'><p>Extract peaks from all msobjects in a msbatch.</p></a></li>
<li><a href='#getfeaturestable'><p>Write features table based on groups</p></a></li>
<li><a href='#getFormula'><p>Get formula and neutral mass for annotated compounds</p></a></li>
<li><a href='#getInclusionList'><p>Obtain an inclusion list from the annotation results</p></a></li>
<li><a href='#groupmsbatch'><p>Group features from an msbatch</p></a></li>
<li><a href='#hfadb'>
<p>HFAs database</p></a></li>
<li><a href='#idAcylCerneg'><p>Acylceramides (AcylCer) annotation for ESI-</p></a></li>
<li><a href='#idAcylCerpos'><p>Acylceramides (AcylCer) annotation for ESI+</p></a></li>
<li><a href='#idBAneg'><p>Bile Acids (BA) annotation for ESI-</p></a></li>
<li><a href='#idCarpos'><p>Acylcarnitine annotation for ESI+</p></a></li>
<li><a href='#idCEpos'><p>Cholesteryl Esters (CE) annotation for ESI+</p></a></li>
<li><a href='#idCerneg'><p>Ceramides (Cer) annotation for ESI-</p></a></li>
<li><a href='#idCerPneg'><p>Ceramides phosphate (CerP) annotation for ESI-</p></a></li>
<li><a href='#idCerpos'><p>Ceramides (Cer) annotation for ESI+</p></a></li>
<li><a href='#idCerPpos'><p>Ceramides phosphate (CerP) annotation for ESI+</p></a></li>
<li><a href='#idCLneg'><p>Cardiolipines (CL) annotation for ESI-</p></a></li>
<li><a href='#idDGpos'><p>Diacylglycerols (DG) annotation for ESI+</p></a></li>
<li><a href='#idFAHFAneg'><p>FAHFA annotation for ESI-</p></a></li>
<li><a href='#idFAneg'><p>Fatty Acids (FA) annotation for ESI-</p></a></li>
<li><a href='#idLPCneg'><p>Lysophosphocholines (LPC) annotation for ESI-</p></a></li>
<li><a href='#idLPCpos'><p>Lysophosphocholines (LPC) annotation for ESI+</p></a></li>
<li><a href='#idLPEneg'><p>Lysophosphoethanolamines (LPE) annotation for ESI-</p></a></li>
<li><a href='#idLPEpos'><p>Lysophosphoethanolamines (LPE) annotation for ESI+</p></a></li>
<li><a href='#idLPGneg'><p>Lysophosphoglycerols (LPG) annotation for ESI-</p></a></li>
<li><a href='#idLPIneg'><p>Lysophosphoinositols (LPI) annotation for ESI-</p></a></li>
<li><a href='#idLPSneg'><p>Lysophosphoserines (LPS) annotation for ESI-</p></a></li>
<li><a href='#idMGpos'><p>Monoacylglycerol (MG) annotation for ESI+</p></a></li>
<li><a href='#idNEG'><p>Lipids annotation for ESI-</p></a></li>
<li><a href='#idPCneg'><p>Phosphocholines (PC) annotation for ESI-</p></a></li>
<li><a href='#idPConeg'><p>Plasmanyl Phosphocholines (PCo) annotation for ESI-</p></a></li>
<li><a href='#idPCopos'><p>Plasmanyl Phosphocholines (PCo) annotation for ESI+</p></a></li>
<li><a href='#idPCpneg'><p>Plasmenyl Phosphocholines (PCp) annotation for ESI-</p></a></li>
<li><a href='#idPCpos'><p>Phosphocholines (PC) annotation for ESI+</p></a></li>
<li><a href='#idPCppos'><p>Plasmenyl Phosphocholines (PCp) annotation for ESI+</p></a></li>
<li><a href='#idPEneg'><p>Phosphoethanolamines (PE) annotation for ESI-</p></a></li>
<li><a href='#idPEoneg'><p>Plasmanyl Phosphoethanolamines (PEo) annotation for ESI-</p></a></li>
<li><a href='#idPEopos'><p>Plasmanyl Phosphoethanolamines (PEo) annotation for ESI+</p></a></li>
<li><a href='#idPEpneg'><p>Plasmenyl Phosphoethanolamines (PEp) annotation for ESI-</p></a></li>
<li><a href='#idPEpos'><p>Phosphoethanolamines (PE) annotation for ESI+</p></a></li>
<li><a href='#idPEppos'><p>Plasmenyl Phosphoethanolamines (PEp) annotation for ESI+</p></a></li>
<li><a href='#idPGneg'><p>Phosphoglycerols (PG) annotation for ESI-</p></a></li>
<li><a href='#idPGpos'><p>Phosphoglycerols (PG) annotation for ESI+</p></a></li>
<li><a href='#idPIneg'><p>Phosphoinositols (PI) annotation for ESI-</p></a></li>
<li><a href='#idPIpos'><p>Phosphoinositols (PI) annotation for ESI+</p></a></li>
<li><a href='#idPOS'><p>Lipids annotation for ESI+</p></a></li>
<li><a href='#idPSneg'><p>Phosphoserines (PS) annotation for ESI-</p></a></li>
<li><a href='#idSMneg'><p>Sphingomyelines (SM) annotation for ESI-</p></a></li>
<li><a href='#idSMpos'><p>Sphyngomyelines (SM) annotation for ESI+</p></a></li>
<li><a href='#idSphneg'><p>Sphingoid bases (Sph) annotation for ESI-</p></a></li>
<li><a href='#idSphPneg'><p>Sphingoid bases phosphate (SphP) annotation for ESI-</p></a></li>
<li><a href='#idSphpos'><p>Sphingoid bases (Sph) annotation for ESI-</p></a></li>
<li><a href='#idSphPpos'><p>Sphingoid bases phosphate (SphP) annotation for ESI+</p></a></li>
<li><a href='#idTGpos'><p>Triacylglycerols (TG) annotation for ESI+</p></a></li>
<li><a href='#indexrtpart'><p>Index partitions or clusters assigned during alignment.</p></a></li>
<li><a href='#joinAnnotationResults'><p>Summarize annotation results from an msbatch into the features table</p></a></li>
<li><a href='#joinfrags'><p>Join fragments information when several peaks of the same fragment are</p>
coeluting with a unique candidate</a></li>
<li><a href='#LipidMSapp'><p>LipidMS shiny app</p></a></li>
<li><a href='#lysopadb'>
<p>LPAs database</p></a></li>
<li><a href='#lysopaodb'>
<p>O-LPA database</p></a></li>
<li><a href='#lysopcdb'>
<p>LPCs database</p></a></li>
<li><a href='#lysopcodb'>
<p>O-LPC database</p></a></li>
<li><a href='#lysopcpdb'>
<p>P-LPC database</p></a></li>
<li><a href='#lysopedb'>
<p>LPEs database</p></a></li>
<li><a href='#lysopeodb'>
<p>O-LPE database</p></a></li>
<li><a href='#lysopepdb'>
<p>P-LPE database</p></a></li>
<li><a href='#lysopgdb'>
<p>LPGs database</p></a></li>
<li><a href='#lysopidb'>
<p>LPIs database</p></a></li>
<li><a href='#lysopsdb'>
<p>LPSs database</p></a></li>
<li><a href='#MassAcylCer'><p>Calculate formula and mass of acylceramides</p></a></li>
<li><a href='#MassCarnitines'><p>Calculate formula and mass of carnitines</p></a></li>
<li><a href='#MassCE'><p>Calculate formula and mass of cholesterol esthers</p></a></li>
<li><a href='#MassCer'><p>Calculate formula and mass of ceramides</p></a></li>
<li><a href='#MassCerP'><p>Calculate formula and mass of ceramides phosphate</p></a></li>
<li><a href='#MassCL'><p>Calculate formula and mass of CL</p></a></li>
<li><a href='#MassDG'><p>Calculate formula and mass of DG</p></a></li>
<li><a href='#MassFA'><p>Calculate formula and mass of fatty acids</p></a></li>
<li><a href='#MassFAHFA'><p>Calculate formula and mass of FAHFA</p></a></li>
<li><a href='#MassGlcCer'><p>Calculate formula and mass of glucoceramides</p></a></li>
<li><a href='#MassHFA'><p>Calculate formula and mass of hydroxi fatty acids</p></a></li>
<li><a href='#MassLysoPA'><p>Calculate formula and mass of LPA</p></a></li>
<li><a href='#MassLysoPAo'><p>Calculate formula and mass of LPAo</p></a></li>
<li><a href='#MassLysoPC'><p>Calculate formula and mass of LysoPC</p></a></li>
<li><a href='#MassLysoPCo'><p>Calculate formula and mass of LysoPCo</p></a></li>
<li><a href='#MassLysoPCp'><p>Calculate formula and mass of LysoPCp</p></a></li>
<li><a href='#MassLysoPE'><p>Calculate formula and mass of LPE</p></a></li>
<li><a href='#MassLysoPEo'><p>Calculate formula and mass of LPEo</p></a></li>
<li><a href='#MassLysoPEp'><p>Calculate formula and mass of LPEp</p></a></li>
<li><a href='#MassLysoPG'><p>Calculate formula and mass of LPG</p></a></li>
<li><a href='#MassLysoPI'><p>Calculate formula and mass of LPI</p></a></li>
<li><a href='#MassLysoPS'><p>Calculate formula and mass of LysoPS</p></a></li>
<li><a href='#MassMG'><p>Calculate formula and mass of MG</p></a></li>
<li><a href='#MassPA'><p>Calculate formula and mass of PA</p></a></li>
<li><a href='#MassPC'><p>Calculate formula and mass of PC</p></a></li>
<li><a href='#MassPCo'><p>Calculate formula and mass of PCo</p></a></li>
<li><a href='#MassPCp'><p>Calculate formula and mass of PCp</p></a></li>
<li><a href='#MassPE'><p>Calculate formula and mass of PE</p></a></li>
<li><a href='#MassPEo'><p>Calculate formula and mass of plasmanyl PE</p></a></li>
<li><a href='#MassPEp'><p>Calculate formula and mass of plasmenyl PE</p></a></li>
<li><a href='#MassPG'><p>Calculate formula and mass of PG</p></a></li>
<li><a href='#MassPI'><p>Calculate formula and mass of PI</p></a></li>
<li><a href='#MassPIP'><p>Calculate formula and mass of PIP</p></a></li>
<li><a href='#MassPIP2'><p>Calculate formula and mass of PIP2</p></a></li>
<li><a href='#MassPIP3'><p>Calculate formula and mass of PIP3</p></a></li>
<li><a href='#MassPS'><p>Calculate formula and mass of PS</p></a></li>
<li><a href='#MassSM'><p>Calculate formula and mass of sphingomyelines</p></a></li>
<li><a href='#MassSph'><p>Calculate formula and mass of sphingoid bases</p></a></li>
<li><a href='#MassSphP'><p>Calculate formula and mass of sphingoid phosphate bases</p></a></li>
<li><a href='#MassTG'><p>Calculate formula and mass of TG</p></a></li>
<li><a href='#mgdb'>
<p>MGs database</p></a></li>
<li><a href='#mzMatch'><p>mz match withing a vector of mz values</p></a></li>
<li><a href='#nlsphdb'>
<p>Neutral losses db for sphingoid bases. It is employed by idCerneg function.</p></a></li>
<li><a href='#organizeResults'><p>Prepare output for LipidMS annotation functions</p></a></li>
<li><a href='#padb'>
<p>PAs database</p></a></li>
<li><a href='#partitioning'><p>agglomarative partitioning for LC-HRMS data based on enviPick algorithm</p></a></li>
<li><a href='#pcdb'>
<p>PCs database</p></a></li>
<li><a href='#pcodb'>
<p>O-PC database</p></a></li>
<li><a href='#pcpdb'>
<p>P-PC database</p></a></li>
<li><a href='#peakdetection'><p>peak-pick based on previous EIC clusters generated by clustering</p></a></li>
<li><a href='#pedb'>
<p>PEs database</p></a></li>
<li><a href='#peodb'>
<p>O-PE database</p></a></li>
<li><a href='#pepdb'>
<p>P-PE database</p></a></li>
<li><a href='#pgdb'>
<p>PGs database</p></a></li>
<li><a href='#pidb'>
<p>PIs database</p></a></li>
<li><a href='#ploteicmsbatch'><p>EIC for all samples in a msbatch</p></a></li>
<li><a href='#plotLipids'><p>Plot informative peaks for lipid annotation</p></a></li>
<li><a href='#plotticmsbatch'><p>TIC for all samples in a msbatch</p></a></li>
<li><a href='#psdb'>
<p>PSs database</p></a></li>
<li><a href='#readMSfile'><p>Read mzXML file and initiate msobject</p></a></li>
<li><a href='#rtcorrection'><p>Correct RT based on a rtmodel.</p></a></li>
<li><a href='#rtdevplot'><p>Plot retention time deviation</p></a></li>
<li><a href='#searchIsotopes'><p>Targeted isotopes search</p></a></li>
<li><a href='#searchIsotopesmsbatch'><p>Targeted isotopes search for msbatch</p></a></li>
<li><a href='#select'><p>Check matches between chains composition and precursor structures</p></a></li>
<li><a href='#setmsbatch'><p>Create msbatch for batch processing.</p></a></li>
<li><a href='#smdb'>
<p>SMs database</p></a></li>
<li><a href='#sphdb'>
<p>Sphingoid bases database</p></a></li>
<li><a href='#sphPdb'>
<p>Sphingoid bases phosphate database</p></a></li>
<li><a href='#sumChains'><p>Calculate total number of carbons and double bounds of lipid chains</p></a></li>
<li><a href='#tgdb'>
<p>TGs database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Lipid Annotation for LC-MS/MS DDA or DIA Data</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.5</td>
</tr>
<tr>
<td>Author:</td>
<td>M Isabel Alcoriza-Balaguer</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Lipid annotation in untargeted LC-MS lipidomics based on fragmentation rules. Alcoriza-Balaguer MI, Garcia-Canaveras JC, Lopez A, Conde I, Juan O, Carretero J, Lahoz A (2019) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.8b03409">doi:10.1021/acs.analchem.8b03409</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), shiny, utils, parallel, doParallel, foreach</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>readMzXmlData, CHNOSZ, scales, shinythemes, stats, graphics,
grDevices, iterators</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-27 12:56:08 UTC; 73581298c</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-27 14:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='acylcerdb'>
AcylCeramides database
</h2><span id='topic+acylcerdb'></span>

<h3>Description</h3>

<p>In silico generated database for common acylceramides.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("acylcerdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 192 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='adductsTable'>
Adducts table
</h2><span id='topic+adductsTable'></span>

<h3>Description</h3>

<p>Table of possible adducts to be employed by LipidMS and related information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("adductsTable")</code></pre>


<h3>Format</h3>

<p>Data frame with 18 observations and the following 4 variables.
</p>

<dl>
<dt><code>adduct</code></dt><dd><p>character vector with the adducts names.</p>
</dd>
<dt><code>mdiff</code></dt><dd><p>numeric vector indicating the mass differences.</p>
</dd>
<dt><code>charge</code></dt><dd><p>numeric vector indicating the charge.</p>
</dd>
<dt><code>n</code></dt><dd><p>numeric vector. It indicates if the ion is a monomer (1),
a dimer (2), etc.</p>
</dd>
</dl>


<hr>
<h2 id='alignmsbatch'>Align samples from an msbatch</h2><span id='topic+alignmsbatch'></span>

<h3>Description</h3>

<p>Align samples from an msbatch to correct time drifts during acquisition queues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignmsbatch(
  msbatch,
  dmz = 5,
  drt = 30,
  minsamples,
  minsamplesfrac = 0.75,
  span = 0.4,
  parallel = FALSE,
  ncores,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alignmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch obtained from the <a href="#topic+setmsbatch">setmsbatch</a> function.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_dmz">dmz</code></td>
<td>
<p>mass tolerance between peak groups in ppm.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_drt">drt</code></td>
<td>
<p>maximum rt distance between peaks for alignment in seconds.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_minsamples">minsamples</code></td>
<td>
<p>minimum number of samples represented in each cluster 
used for the alignment.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_minsamplesfrac">minsamplesfrac</code></td>
<td>
<p>minimum samples fraction represented in each cluster 
used for the alignment. Used to calculate minsamples in case it is missing.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_span">span</code></td>
<td>
<p>span parameter for loess rt deviation smoothing.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_parallel">parallel</code></td>
<td>
<p>logical. If TRUE, parallel processing will be performed.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to be used in case parallel is TRUE.</p>
</td></tr>
<tr><td><code id="alignmsbatch_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, peak partitions are created based on the enviPick algorithm 
to speed up the following clustering algorithm. Briefly, peaks are ordered 
increasingly by mz and RT and grouped based on user-defined tolerances (dmz 
and drt). Each peak is initialized as a partition and then, they are 
evaluated to decide whether or not they can be joined to the previous 
partition. If mz and RT of a peak matches tolerance of any of the peaks in 
the previous partition, it is reassigned. Then, clustering algorithm is 
executed to group peaks based on their RT following the next steps for each 
partition:
</p>
<p>1.	Each peak in the partition is initialized as a new cluster. For each 
cluster we will keep the minimum, maximum and mean value of the RT, which at 
this point have the same values.
2.	Calculate a distance matrix between all clusters. This distance will be 
the greatest difference between minimum and maximum values of each cluster. 
Distances between clusters which share peaks from the same samples will be 
set to NA.
3.	While any distance is different to NA, search the minimum distance between 
two clusters.
4.	If distance is below the maximum distance allowed, join clusters and 
update minimum, maximum and mean values, else, set distance to NA and go back 
to point 3.
</p>
<p>Then, clusters with a sample representation over minsamples or minsamplesfrac, 
will be used for alignment. To this end, an RT matrix is built containing the 
RT of the peaks for each sample from the selected clusters. Then, median RT 
is calculated for each cluster and an RT deviation matrix is obtained. Finally, 
time drifts for each sample are corrected using loess regression by 
constructing a function based on RT deviation and median.
</p>


<h3>Value</h3>

<p>aligned msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Partitioning algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- alignmsbatch(msbatch)

## End(Not run)

</code></pre>

<hr>
<h2 id='annotateIsotopes'>Annotate isotopes</h2><span id='topic+annotateIsotopes'></span>

<h3>Description</h3>

<p>Annotate isotopes based on mass differences, retention time and peak
correlation if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annotateIsotopes(
  peaklist,
  rawScans,
  dmz,
  drt,
  massdiff,
  charge,
  isotopeAb,
  m0mass,
  corThr,
  checkInt,
  checkCor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annotateIsotopes_+3A_peaklist">peaklist</code></td>
<td>
<p>extracted peaks. Data.frame with 4 columns (mz, RT, int
and peakID).</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_rawscans">rawScans</code></td>
<td>
<p>raw scan data. Data.frame with 5 columns (mz, RT, int,
peakID and Scan).</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_dmz">dmz</code></td>
<td>
<p>mass tolerance in ppm.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_drt">drt</code></td>
<td>
<p>RT windows with the same units used in peaklist.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_massdiff">massdiff</code></td>
<td>
<p>mass difference.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_charge">charge</code></td>
<td>
<p>charge.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_isotopeab">isotopeAb</code></td>
<td>
<p>isotope natural abundance.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_m0mass">m0mass</code></td>
<td>
<p>mass of the most abundant naturally occurring stable isotope.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_corthr">corThr</code></td>
<td>
<p>peak correlation threshold.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_checkint">checkInt</code></td>
<td>
<p>logical. If TRUE, relative intensity is checked.</p>
</td></tr>
<tr><td><code id="annotateIsotopes_+3A_checkcor">checkCor</code></td>
<td>
<p>logical. If TRUE, peaks correlation is checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>peaklist with 6 columns (mz, RT, int, peakID, isotope and isoGroup).
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Isotope annotation has been adapted from CAMERA algorithm: 
Kuhl C, Tautenhahn R, Boettcher C, Larson TR, Neumann S (2012). “CAMERA: an 
integrated strategy for compound spectra extraction and annotation of liquid 
chromatography/mass spectrometry data sets.” Analytical Chemistry, 84, 283–289. 
http://pubs.acs.org/doi/abs/10.1021/ac202450g.
</p>

<hr>
<h2 id='annotatemsbatch'>Lipid annotation for an msbatch</h2><span id='topic+annotatemsbatch'></span>

<h3>Description</h3>

<p>Summarize annotation results of an msbatch into the feature table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annotatemsbatch(
  msbatch,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  coelCutoff = 0.8,
  lipidClassesPos = c("MG", "LPC", "LPE", "PC", "PCo", "PCp", "PE", "PEo", "PEp", "PG",
    "PI", "Sph", "SphP", "Cer", "CerP", "AcylCer", "SM", "Carnitines", "CE", "DG", "TG"),
  lipidClassesNeg = c("FA", "FAHFA", "LPC", "LPE", "LPG", "LPI", "LPS", "PC", "PCo",
    "PCp", "PE", "PEo", "PEp", "PG", "PI", "PS", "Sph", "SphP", "Cer", "CerP", "AcylCer",
    "SM", "CL", "BA"),
  dbs,
  simplifyAnnotations = FALSE,
  parallel = FALSE,
  ncores
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annotatemsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 5 seconds.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_lipidclassespos">lipidClassesPos</code></td>
<td>
<p>classes of interest in ESI+.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_lipidclassesneg">lipidClassesNeg</code></td>
<td>
<p>classes of interest in ESI-.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_simplifyannotations">simplifyAnnotations</code></td>
<td>
<p>logical. If TRUE, only the most frequent id will be 
kept (recommended when only pool samples have been acquired in DIA or DDA). If 
FALSE, all annotations will be shown.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_parallel">parallel</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="annotatemsbatch_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to be used in case parallel is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- annotatemsbatch(msbatch)

msbatch$features

## End(Not run)

</code></pre>

<hr>
<h2 id='assignDB'>Load LipidMS default data bases</h2><span id='topic+assignDB'></span>

<h3>Description</h3>

<p>load all LipidMS default data bases required to run identification functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assignDB()
</code></pre>


<h3>Value</h3>

<p>list of data frames
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dbs &lt;- assignDB()

## End(Not run)

</code></pre>

<hr>
<h2 id='baconjdb'>
Bile acids conjugates database
</h2><span id='topic+baconjdb'></span>

<h3>Description</h3>

<p>Common bile acids conjugates. It can be modified to look for other BA species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("baconjdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 2 observations and the following 2 variables.
</p>

<dl>
<dt><code>total</code></dt><dd><p>character vector indicating the names of the conjugates.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses of the conjugates
fragments.</p>
</dd>
</dl>


<hr>
<h2 id='badb'>
Bile acids database
</h2><span id='topic+badb'></span>

<h3>Description</h3>

<p>In silico generated database for common bile acids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("badb")</code></pre>


<h3>Format</h3>

<p>Data frame with 9 observations and the following 5 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector with the molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector containing the names of the BAs (i.e.
CA, TDCA, GLCA...).</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
<dt><code>conjugate</code></dt><dd><p>character vector containing the conjugate of each BA.</p>
</dd>
<dt><code>base</code></dt><dd><p>character vector containing the core of each BA.</p>
</dd>
</dl>


<hr>
<h2 id='batchdataProcessing'>Process several mzXML files (peakpicking and isotope annotation) and create an 
msbatch for batch processing.</h2><span id='topic+batchdataProcessing'></span>

<h3>Description</h3>

<p>Process several mzXML files (peakpicking and isotope annotation) and create an 
msbatch for batch processing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchdataProcessing(
  files,
  metadata,
  polarity,
  dmzagglom = 15,
  drtagglom = 500,
  drtclust = 100,
  minpeak = c(5, 3),
  drtgap = 10,
  drtminpeak = 15,
  drtmaxpeak = c(100, 200),
  recurs = 5,
  sb = c(3, 2),
  sn = 2,
  minint = c(1000, 100),
  weight = c(2, 3),
  dmzIso = 10,
  drtIso = 5,
  parallel = FALSE,
  ncores,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchdataProcessing_+3A_files">files</code></td>
<td>
<p>file paths of the mzXML files. Optional.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_metadata">metadata</code></td>
<td>
<p>csv file or data.frame with 3 columns: sample (samples named as the 
mzXML files), acquisitionmode (MS, DIA or DDA) and groups (i.e. blank, QC, sample).
DIA, DDA and MS files are allowed, but only DIA and DDA files will be used 
for lipid annotation.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_polarity">polarity</code></td>
<td>
<p>character value: negative or positive.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_dmzagglom">dmzagglom</code></td>
<td>
<p>mz tolerance (in ppm) used for partitioning and clustering.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtagglom">drtagglom</code></td>
<td>
<p>rt window used for partitioning (in seconds).</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtclust">drtclust</code></td>
<td>
<p>rt window used for clustering (in seconds).</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum number of measurements required for a peak.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtgap">drtgap</code></td>
<td>
<p>maximum RT gap length to be filled (in seconds).</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtminpeak">drtminpeak</code></td>
<td>
<p>minimum RT width of a peak (in seconds). At least minpeak 
within the drtminpeak window are required to define a peak.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtmaxpeak">drtmaxpeak</code></td>
<td>
<p>maximum RT width of a single peak (in seconds).</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_recurs">recurs</code></td>
<td>
<p>maximum number of peaks within one EIC.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_sb">sb</code></td>
<td>
<p>signal-to-base ratio.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_sn">sn</code></td>
<td>
<p>signal-to-noise ratio.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_minint">minint</code></td>
<td>
<p>minimum intensity of a peak.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_weight">weight</code></td>
<td>
<p>weight for assigning measurements to a peak.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_dmziso">dmzIso</code></td>
<td>
<p>mass tolerance for isotope matching.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_drtiso">drtIso</code></td>
<td>
<p>time windows for isotope matching.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_parallel">parallel</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to be used in case parallel is TRUE.</p>
</td></tr>
<tr><td><code id="batchdataProcessing_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function executes 2 steps: 1) creates an msobject for each 
sample (using the <a href="#topic+dataProcessing">dataProcessing</a> function) and 2) sets an msbatch 
(<a href="#topic+setmsbatch">setmsbatch</a> function).
</p>
<p>Numeric arguments accept one or two values for MS1 and MS2, respectively.
</p>


<h3>Value</h3>

<p>msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Peak-picking algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>


<h3>See Also</h3>

<p><a href="#topic+dataProcessing">dataProcessing</a> and <a href="#topic+setmsbatch">setmsbatch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# if metadata is a data frame:
msbatch &lt;- batchdataProcessing(metadata$sample, metadata, polarity = "positive",
dmzagglom = 25, drtagglom = 500, drtclust = 60, minpeak = c(5, 3),
drtgap = 5, drtminpeak = 20, drtmaxpeak = 100, recurs = 5, sb = c(3, 2),
sn = 2, minint = c(1000, 100), weight = 2, dmzIso = 10, drtIso = 5)

# if metadata is a csv file:
msbatch &lt;- batchdataProcessing(metadata = "metadata.csv", polarity = "positive",
dmzagglom = 25, drtagglom = 500, drtclust = 60, minpeak = c(5, 3),
drtgap = 5, drtminpeak = 20, drtmaxpeak = 100, recurs = 5, sb = c(3, 2),
sn = 2, minint = c(1000, 100), weight = 2, dmzIso = 10, drtIso = 5)

## End(Not run)

</code></pre>

<hr>
<h2 id='carnitinesdb'>
Carnitines database
</h2><span id='topic+carnitinesdb'></span>

<h3>Description</h3>

<p>In silico generated database for common carnitines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("carnitinesdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='cbs'>Total number of carbons and double bounds</h2><span id='topic+cbs'></span>

<h3>Description</h3>

<p>This function matches mz values with neutral masses from a dataframe which
links masses and structures (carbons and double bounds) and extracts the
structural information. It is used by identification functions to look for
the structure of the previously chosen candidates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbs(mz, ppm, db, charge = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cbs_+3A_mz">mz</code></td>
<td>
<p>mz value to be matched</p>
</td></tr>
<tr><td><code id="cbs_+3A_ppm">ppm</code></td>
<td>
<p>mass error tolerance</p>
</td></tr>
<tr><td><code id="cbs_+3A_db">db</code></td>
<td>
<p>database</p>
</td></tr>
<tr><td><code id="cbs_+3A_charge">charge</code></td>
<td>
<p>numeric value indicating the charge of the ion</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character value or vector indicating structural information
(carbons:bounds)
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='CEdb'>
CEs database
</h2><span id='topic+CEdb'></span>

<h3>Description</h3>

<p>In silico generated database for common CEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CEdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='cerdb'>
Ceramides database
</h2><span id='topic+cerdb'></span>

<h3>Description</h3>

<p>In silico generated database for common ceramides.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cerdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 52 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='cerPdb'>
Ceramides Phosphate database
</h2><span id='topic+cerPdb'></span>

<h3>Description</h3>

<p>In silico generated database for common ceramides phosphate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cerPdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 52 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='chainFrags'>Search of chain specific fragments</h2><span id='topic+chainFrags'></span>

<h3>Description</h3>

<p>Search of specific fragments that inform about the chains structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chainFrags(coelfrags, chainfrags, ppm = 10, candidates, f = NULL, dbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chainFrags_+3A_coelfrags">coelfrags</code></td>
<td>
<p>coeluting fragments for each candidate. Output of
<a href="#topic+coelutingFrags">coelutingFrags</a>.</p>
</td></tr>
<tr><td><code id="chainFrags_+3A_chainfrags">chainfrags</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. If it is an empty vector, chains will be calculated based
on the difference between the precursor and the other chain. See details.</p>
</td></tr>
<tr><td><code id="chainFrags_+3A_ppm">ppm</code></td>
<td>
<p>m/z tolerance in ppm.</p>
</td></tr>
<tr><td><code id="chainFrags_+3A_candidates">candidates</code></td>
<td>
<p>candidates data frame. If any chain needs to be calculated
based on the difference between the precursor and the other chain, this
argument will be required. Output of <a href="#topic+chainFrags">chainFrags</a>.</p>
</td></tr>
<tr><td><code id="chainFrags_+3A_f">f</code></td>
<td>
<p>known chains. If any chain needs to be calculated
based on the difference between the precursor and the other chain, this
argument will be required. Output of <a href="#topic+chainFrags">chainFrags</a>.</p>
</td></tr>
<tr><td><code id="chainFrags_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for the annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be changed. If data bases have
been customized using <a href="#topic+createLipidDB">createLipidDB</a>, they also have to be modified
here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The chainfrags argument must contain the fragmentation rules
which inform about the chains structure. For example, in the case of PG
subclass, the chain in sn1 position is identified by the lysoPG as M-H
resulting from the loss of the FA chain of sn2; and the chain in sn2 position
is identified as the free FA chain as M-H. These two fragments need to be
searched in two different steps: in the fist step we will look for lysoPGs
coeluting with the precursor using chainfrags = c(&quot;lysopg_M-H&quot;);
then, we will look for FA chains using chainfrags = c(&quot;fa_M-H&quot;). This
information can be combined later using <a href="#topic+combineChains">combineChains</a> function.
</p>
<p>To indicate the fragments to be searched, the class of lipid is writen
using the same names as the LipidMS databases without the &quot;db&quot; at the end
(i.e. pa, dg, lysopa, mg, CE, etc.), and the adduct has to be indicated as
it appears in the adductsTable, both parts separated by &quot;_&quot;. In case some
chain needs to be searched based on a neutral loss, this can be defined using
&quot;NL-&quot; prefix, followed by the database and adduct. If this neutral loss
is employed to find the remaining chain, &quot;cbdiff-&quot; prefix allows to calculate
the difference in carbons and doubles bounds between the precursor and the
building block found. For example, &quot;cbdiff-dg_M+H-H2O&quot; will look for DG as
M+H-H2O and then, it will return the difference between their number of
carbons and double bounds and the ones from the precursor. Otherwise,
&quot;NL-mg_M+H-H2O&quot; will look for fragments coming from the loss of MGs.
</p>
<p>In case these fragments identified as losses from the precursors are going to
be employed for the intensity rules, this same prefix has to be added.
</p>
<p>If a chain is calculated based on the difference of total number of
carbons and double bounds between the precursor and a previously searched chain,
<code>chainfrags</code> argument must be a character vector c(&quot;&quot;) and candidates
data frame and chain fragments list must be provided.
</p>


<h3>Value</h3>

<p>List of data frames with the chain fragments found.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='chains'>extract chains composition from a lipid name</h2><span id='topic+chains'></span>

<h3>Description</h3>

<p>extract chains composition from a lipid name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chains(id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chains_+3A_id">id</code></td>
<td>
<p>lipid name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with lipid class, FA position known (TRUE) or unknown (FALSE) 
and FA chains.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='checkClass'>Search of class fragments to confirm the lipid class.</h2><span id='topic+checkClass'></span>

<h3>Description</h3>

<p>Search of characteristic fragments that confirm a given lipid class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkClass(candidates, coelfrags, clfrags, ftype, clrequisites, ppm = 10, dbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkClass_+3A_candidates">candidates</code></td>
<td>
<p>output of <a href="#topic+findCandidates">findCandidates</a> function.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_coelfrags">coelfrags</code></td>
<td>
<p>list of peaks coeluting with each candidate. Output of
<a href="#topic+coelutingFrags">coelutingFrags</a>.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See details.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See details.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_clrequisites">clrequisites</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If none of the fragment is required, at least one of them
must be present within the coeluting fragments. If the presence of any
fragment excludes the class, it can be specified by using &quot;excluding&quot;.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_ppm">ppm</code></td>
<td>
<p>m/z tolerance in ppm.</p>
</td></tr>
<tr><td><code id="checkClass_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for the annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be changed. If data bases have
been customized using <a href="#topic+createLipidDB">createLipidDB</a>, they also have to be modified
here. It is employed when some fragment belongs to &quot;BB&quot; <code>ftype</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>clfrags</code>, <code>ftype</code> and <code>clrequisites</code> will indicate
the rules to confirm a lipid class. All three arguments must have the same
length.
</p>
<p>This function allows three different types of fragments: fragments with a
specific m/z as for example 227.0326 for PG in negative mode, which needs to
be defined as clfrags = c(227.0326) and ftype = c(&quot;F&quot;); neutral losses such
as the head group of some PL (i.e. NL of 74.0359 in PG in negative mode),
which will be defined as clfrags = c(74.0359) and ftype = c(&quot;NL&quot;); or
building blocks resulting from the loss of some groups, as for example, PA as
M-H resulting from the loss of the head group (glycerol) in PG in ESI-, which
will be defined as clfrags = c(&quot;pa_M-H&quot;) and ftype = c(&quot;BB&quot;). The last
two options could define the same fragments. In this case just one of them
would be necessary.
</p>
<p>When using the third type of fragment (&quot;BB&quot;), the building block will be
specified in lower case (i.e. pa, dg, lysopa, mg, etc.) and the adduct will be
given as it appears in the adductsTable, both separated by &quot;_&quot;. Names for the
building blocks are the ones used for the LipidMS databases without the &quot;db&quot;
at the end.
</p>
<p>In case the presence of a fragment indicates that the candidate does not
belong to the lipid class (i.e. loss of CH3 in PE, which corresponds to a PC
actually), this will be specified by using <code>clrequisites</code> = c(&quot;excluding&quot;).
</p>


<h3>Value</h3>

<p>List with 2 elements: a matrix with logical values (presence/absense)
of each expected fragment (columns) for each candidate (rows), and a logical
vector with the confirmation of the lipid class for each candidate.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='checkIntensityRules'>Check intensity rules</h2><span id='topic+checkIntensityRules'></span>

<h3>Description</h3>

<p>Check intensity rules to confirm chains position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkIntensityRules(intrules, rates, intrequired, nchains, combinations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkIntensityRules_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
details.</p>
</td></tr>
<tr><td><code id="checkIntensityRules_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (i.e. &quot;3/1&quot;). See details.</p>
</td></tr>
<tr><td><code id="checkIntensityRules_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="checkIntensityRules_+3A_nchains">nchains</code></td>
<td>
<p>number of chains of the targeted lipid class.</p>
</td></tr>
<tr><td><code id="checkIntensityRules_+3A_combinations">combinations</code></td>
<td>
<p>output of <a href="#topic+combineChains">combineChains</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will be employed when the targeted lipid class has
more than one chain.
</p>
<p>Taking PG subclass as an example, intensities of lysoPG fragments
(informative for sn1) can be employed to confirm the chains structure
(intrules = c(&quot;lysopg_sn1/lysopg_sn1&quot;)). In this case, the intensity of the
lysoPG resulting from the loss of the FA chain in sn2 is at least 3 times
greater (rates = c(&quot;3/1&quot;)) than the lysoPG resulting from the loss of the FA
chain in sn1.
</p>
<p>For the intrules argument, &quot;/&quot; will be use to separate the fragments related
to each chain (sn1/sn2/etc), and &quot;_&quot; will be use to indicate the list in
which they'll be searched. This will depend on the chain fragments
rules defined previously. Following the example, as we use lysoPG to define
the sn1 position, both fragments will be searched in this list (sn1).
</p>
<p>For classes with more than one FA chain, if some intensity rule should be
employed to identify their position but they are no defined yet, use &quot;Unknown&quot;.
If it is not necessary because the fragmentation rules are informative enough
to define the position (i.e. sphingolipid species), just leave an empty vector.
</p>


<h3>Value</h3>

<p>List of logical vectors  with the confirmation for each combination.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='checkIntRules'>Check intensity rules</h2><span id='topic+checkIntRules'></span>

<h3>Description</h3>

<p>Check intensity rules to confirm chains structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkIntRules(intrules, rates, intrequired, nchains, combinations, sn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkIntRules_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
details.</p>
</td></tr>
<tr><td><code id="checkIntRules_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates given as a string
(i.e. &quot;3/1&quot;). See details.</p>
</td></tr>
<tr><td><code id="checkIntRules_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="checkIntRules_+3A_nchains">nchains</code></td>
<td>
<p>number of chains of the targeted lipid class.</p>
</td></tr>
<tr><td><code id="checkIntRules_+3A_combinations">combinations</code></td>
<td>
<p>output of <a href="#topic+combineChains">combineChains</a></p>
</td></tr>
<tr><td><code id="checkIntRules_+3A_sn">sn</code></td>
<td>
<p>list of chain fragments identified. Object fragments of the
<a href="#topic+combineChains">combineChains</a> output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will be employed when the targeted lipid class has
more than one chain.
</p>
<p>Taking PG subclass as an example, intensities of lysoPG fragments
(informative for sn1) can be employed to confirm the chains structure
(intrules = c(&quot;lysopg_sn1/lysopg_sn1&quot;)).
In this case, the intensity of lysoPG resulting from the loss of the FA chain
in sn2 is at least 3 times higher (rates = c(&quot;3/1&quot;)) than the lysoPG
resulting from the loss of the FA chain in sn1.
</p>
<p>For the intrules argument, &quot;/&quot; will be use to separate the fragments to
compare, and &quot;_&quot; will be use to indicate in which list of fragments we
need to look for their intensities. This will depend on the chain fragments
rules defined previiously.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='cldb'>
Cardiolipins database
</h2><span id='topic+cldb'></span>

<h3>Description</h3>

<p>In silico generated database for commo CLs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cldb")</code></pre>


<h3>Format</h3>

<p>Data frame with 714 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='clust'>Clustering for MS peaks based on mz or RT.</h2><span id='topic+clust'></span>

<h3>Description</h3>

<p>Clustering for MS peaks based on mz or RT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clust(values, mins, maxs, samples, unique.samples, maxdist, ppm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clust_+3A_values">values</code></td>
<td>
<p>values to clusterize (mz or RT).</p>
</td></tr>
<tr><td><code id="clust_+3A_mins">mins</code></td>
<td>
<p>lower bound for each value.</p>
</td></tr>
<tr><td><code id="clust_+3A_maxs">maxs</code></td>
<td>
<p>higher bound for each value.</p>
</td></tr>
<tr><td><code id="clust_+3A_samples">samples</code></td>
<td>
<p>numeric vector that indicates to which sample each value belongs.</p>
</td></tr>
<tr><td><code id="clust_+3A_unique.samples">unique.samples</code></td>
<td>
<p>logical. FALSE if several measures from the same sample 
can be clusterized together.</p>
</td></tr>
<tr><td><code id="clust_+3A_maxdist">maxdist</code></td>
<td>
<p>maximum distance allowed within a cluster.</p>
</td></tr>
<tr><td><code id="clust_+3A_ppm">ppm</code></td>
<td>
<p>logical. TRUE if maxdist is given in ppm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector with the assigned clusters
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='clustdist'>Calculate max distance between clusters.</h2><span id='topic+clustdist'></span>

<h3>Description</h3>

<p>Calculate max distance between clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustdist(mins, maxs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clustdist_+3A_mins">mins</code></td>
<td>
<p>lower bound for each cluster.</p>
</td></tr>
<tr><td><code id="clustdist_+3A_maxs">maxs</code></td>
<td>
<p>higher bound for each cluster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector with the assigned clusters
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='clustering'>EIC extraction based on previous partitions generated by <a href="#topic+partitioning">partitioning</a></h2><span id='topic+clustering'></span>

<h3>Description</h3>

<p>EIC extraction based on previous partitions generated by <a href="#topic+partitioning">partitioning</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustering(msobject, dmzagglom, drtclust, minpeak, mslevel, cE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clustering_+3A_msobject">msobject</code></td>
<td>
<p>msobject generated by <a href="#topic+partitioning">partitioning</a></p>
</td></tr>
<tr><td><code id="clustering_+3A_dmzagglom">dmzagglom</code></td>
<td>
<p>mz tolerance for clusters</p>
</td></tr>
<tr><td><code id="clustering_+3A_drtclust">drtclust</code></td>
<td>
<p>RT window for clusters</p>
</td></tr>
<tr><td><code id="clustering_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum number of measures to define a peak</p>
</td></tr>
<tr><td><code id="clustering_+3A_mslevel">mslevel</code></td>
<td>
<p>info to access msobject</p>
</td></tr>
<tr><td><code id="clustering_+3A_ce">cE</code></td>
<td>
<p>info to access msobject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msobject
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Peak-picking algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>

<hr>
<h2 id='coelutingFrags'>Coeluting fragments extraction</h2><span id='topic+coelutingFrags'></span>

<h3>Description</h3>

<p>Given a RT and a list of peaks, this function subsets all coeluting fragments
within a rt windows. It is used by identification functions to extract
coeluting fragments from high energy functions for candidate precursor ions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coelutingFrags(
  precursors,
  products,
  rttol,
  rawData = data.frame(),
  coelCutoff = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coelutingFrags_+3A_precursors">precursors</code></td>
<td>
<p>candidates data frame. Output of <a href="#topic+findCandidates">findCandidates</a>.</p>
</td></tr>
<tr><td><code id="coelutingFrags_+3A_products">products</code></td>
<td>
<p>peaklist for MS2 function (MSMS).</p>
</td></tr>
<tr><td><code id="coelutingFrags_+3A_rttol">rttol</code></td>
<td>
<p>rt window in seconds.</p>
</td></tr>
<tr><td><code id="coelutingFrags_+3A_rawdata">rawData</code></td>
<td>
<p>raw scans data. Output of <a href="#topic+dataProcessing">dataProcessing</a> function (MSMS$rawData).</p>
</td></tr>
<tr><td><code id="coelutingFrags_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data frames with the coeluting fragments for each candidate.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='coelutionScore'>calculate coelution score between two peaks</h2><span id='topic+coelutionScore'></span>

<h3>Description</h3>

<p>Calculate coelution score between two peaks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coelutionScore(peak1, peak2, rawData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coelutionScore_+3A_peak1">peak1</code></td>
<td>
<p>character vector specifying the peakID of the first peak.</p>
</td></tr>
<tr><td><code id="coelutionScore_+3A_peak2">peak2</code></td>
<td>
<p>character vector specifying the peakID of the second peak.</p>
</td></tr>
<tr><td><code id="coelutionScore_+3A_rawdata">rawData</code></td>
<td>
<p>data frame with raw data for each scan. it need to have at
least 5 columns: mz, RT, int, Scan (ordinal number for a given MS function)
and peakID (peakID to which it has been assigned).
</p>
<p>#' @keywords internal</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='combineChains'>Combine chain fragments that could belong to the same precursor.</h2><span id='topic+combineChains'></span>

<h3>Description</h3>

<p>It calculates combinations of chain fragments that sum up the same number of
carbons and double bounds as the precursor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineChains(candidates, nchains, sn1, sn2, sn3, sn4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combineChains_+3A_candidates">candidates</code></td>
<td>
<p>candidates data frame. Output of <a href="#topic+findCandidates">findCandidates</a>.</p>
</td></tr>
<tr><td><code id="combineChains_+3A_nchains">nchains</code></td>
<td>
<p>number of chains of the targeted lipid class.</p>
</td></tr>
<tr><td><code id="combineChains_+3A_sn1">sn1</code></td>
<td>
<p>list of chain fragments identified for sn1 position. Output of
<a href="#topic+chainFrags">chainFrags</a>.</p>
</td></tr>
<tr><td><code id="combineChains_+3A_sn2">sn2</code></td>
<td>
<p>list of chain fragments identified for sn2 position. Output of
<a href="#topic+chainFrags">chainFrags</a>. If required.</p>
</td></tr>
<tr><td><code id="combineChains_+3A_sn3">sn3</code></td>
<td>
<p>list of chain fragments identified for sn3 position. Output of
<a href="#topic+chainFrags">chainFrags</a>. If required.</p>
</td></tr>
<tr><td><code id="combineChains_+3A_sn4">sn4</code></td>
<td>
<p>list of chain fragments identified for sn4 position. Output of
<a href="#topic+chainFrags">chainFrags</a>. If required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data frames with candidate chains structures.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='confLevels'>
Confidence Annotation Levels
</h2><span id='topic+confLevels'></span>

<h3>Description</h3>

<p>Confidence annotation levels and their hierarchy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("confLevels")</code></pre>


<h3>Format</h3>

<p>Data frame with 5 observations and 2 variables.
</p>

<dl>
<dt><code>level</code></dt><dd><p>character vector with the names of the annotation levels.</p>
</dd>
<dt><code>order</code></dt><dd><p>numeric vector that indicates the hierarchichal order.</p>
</dd>
</dl>


<hr>
<h2 id='createLipidDB'>Customizable lipid DBs creator</h2><span id='topic+createLipidDB'></span>

<h3>Description</h3>

<p>It allows to create easy-customizable lipid DBs for annotation with LipidMS
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createLipidDB(lipid, chains, chains2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createLipidDB_+3A_lipid">lipid</code></td>
<td>
<p>character value indicating the class of lipid. See Details.</p>
</td></tr>
<tr><td><code id="createLipidDB_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FA chains to be employed</p>
</td></tr>
<tr><td><code id="createLipidDB_+3A_chains2">chains2</code></td>
<td>
<p>character vector containing the sphingoid bases to be employed
if required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lipidClass</code> argument needs to be one of the following
character values: &quot;Cer&quot;, &quot;CerP&quot;, &quot;GlcCer&quot;, &quot;SM&quot;, &quot;Carnitine&quot;, &quot;CE&quot;, &quot;FA&quot;,
&quot;HFA&quot;, &quot;Sph&quot; (sphingoid bases), &quot;SphP&quot;, &quot;MG&quot;, &quot;LPA&quot;, , &quot;LPC&quot;,
&quot;LPE&quot;, &quot;LPG&quot;, &quot;LPI&quot;, &quot;LPS&quot;, &quot;FAHFA&quot;, &quot;DG&quot;, &quot;PC&quot;, &quot;PE&quot;, &quot;PG&quot;, &quot;PI&quot;, &quot;PS&quot;,
&quot;PA&quot;, &quot;TG&quot;, &quot;CL&quot; or &quot;all&quot;.
</p>


<h3>Value</h3>

<p>List with the requested dbs (data frames)
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fas &lt;- c("8:0", "10:0", "12:0", "14:0", "14:1", "15:0", "16:0", "16:1",
"17:0", "18:0", "18:1", "18:2", "18:3", "18:4", "20:0", "20:1", "20:2",
"20:3", "20:4", "20:5", "22:0", "22:1", "22:2", "22:3", "22:4", "22:5",
"22:6", "24:0", "24:1", "26:0")
sph &lt;- c("16:0", "16:1", "18:0", "18:1")
newdb &lt;- createLipidDB(lipid = "PC", chains = fas, chains2 = sph)

</code></pre>

<hr>
<h2 id='crossAdducts'>Cross different candidates tables to remove false positives.</h2><span id='topic+crossAdducts'></span>

<h3>Description</h3>

<p>This function crosses tables of precursor candidates identified using different
adducts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossAdducts(df1, df2, rttol, rawData, coelCutoff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossAdducts_+3A_df1">df1</code></td>
<td>
<p>data frame containing identification results using the main adduct</p>
</td></tr>
<tr><td><code id="crossAdducts_+3A_df2">df2</code></td>
<td>
<p>data frame containing identification results using a secondary
adduct</p>
</td></tr>
<tr><td><code id="crossAdducts_+3A_rttol">rttol</code></td>
<td>
<p>retention time tolerance in seconds</p>
</td></tr>
<tr><td><code id="crossAdducts_+3A_rawdata">rawData</code></td>
<td>
<p>raw scans data. Output of <a href="#topic+dataProcessing">dataProcessing</a> function
(MS1$rawData).</p>
</td></tr>
<tr><td><code id="crossAdducts_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Subset of the original data frame without adducts
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='crossTables'>Cross the original MS1 peaklist with the annotation results</h2><span id='topic+crossTables'></span>

<h3>Description</h3>

<p>Cross the original MS1 peaklist with the annotation results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossTables(msobject, ppm = 5, rttol = 10, dbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossTables_+3A_msobject">msobject</code></td>
<td>
<p>annotated msobject</p>
</td></tr>
<tr><td><code id="crossTables_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance in ppm.</p>
</td></tr>
<tr><td><code id="crossTables_+3A_rttol">rttol</code></td>
<td>
<p>rt tolerance to match peaks in seconds.</p>
</td></tr>
<tr><td><code id="crossTables_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msobject with an annotatedPeaklist, which is a data frame with 6 
columns: mz, RT, int, LipidMSid, adduct and confidence level for the 
annotation. When multiple IDs are proposed for the same feature, they are 
sorted based on the annotation level and score.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='dataProcessing'>Process mzXML files individually: peakpicking and isotope annotation</h2><span id='topic+dataProcessing'></span>

<h3>Description</h3>

<p>Process mzXML files individually: peakpicking and isotope anotation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataProcessing(
  file,
  acquisitionmode,
  polarity,
  dmzagglom = 15,
  drtagglom = 500,
  drtclust = 100,
  minpeak = c(5, 3),
  drtgap = 10,
  drtminpeak = c(15, 15),
  drtmaxpeak = c(100, 200),
  recurs = 5,
  sb = c(3, 2),
  sn = 2,
  minint = c(1000, 100),
  weight = c(2, 3),
  dmzIso = 5,
  drtIso = 5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataProcessing_+3A_file">file</code></td>
<td>
<p>file path.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_acquisitionmode">acquisitionmode</code></td>
<td>
<p>character value: MS, DIA or DDA.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_polarity">polarity</code></td>
<td>
<p>character value: negative or positive.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_dmzagglom">dmzagglom</code></td>
<td>
<p>mz tolerance (in ppm) used for partitioning and clustering.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtagglom">drtagglom</code></td>
<td>
<p>RT window used for partitioning (in seconds).</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtclust">drtclust</code></td>
<td>
<p>RT window used for clustering (in seconds).</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum number of measurements required for a peak.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtgap">drtgap</code></td>
<td>
<p>maximum RT gap length to be filled (in seconds).</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtminpeak">drtminpeak</code></td>
<td>
<p>minimum RT width of a peak (in seconds). At least minpeak 
within the drtminpeak window are required to define a peak.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtmaxpeak">drtmaxpeak</code></td>
<td>
<p>maximum RT width of a single peak (in seconds).</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_recurs">recurs</code></td>
<td>
<p>maximum number of peaks within one EIC.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_sb">sb</code></td>
<td>
<p>signal-to-base ratio.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_sn">sn</code></td>
<td>
<p>signal-to-noise ratio.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_minint">minint</code></td>
<td>
<p>minimum intensity of a peak.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_weight">weight</code></td>
<td>
<p>weight for assigning measurements to a peak.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_dmziso">dmzIso</code></td>
<td>
<p>mass tolerance for isotope matching.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_drtiso">drtIso</code></td>
<td>
<p>time window for isotope matching.</p>
</td></tr>
<tr><td><code id="dataProcessing_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is important that mzXML files are centroided. 
</p>
<p>This function executes 2 steps: 1) peak-picking based on enviPick
package and 2) isotope annotation based on CAMERA algorithm.
</p>
<p>Numeric arguments accept one or two values for MS1 and MS2, respectively.
</p>


<h3>Value</h3>

<p>an msobject that contains metadata of the mzXML file, raw data and
extracted peaks.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Peak-picking algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>
<p>Isotope annotation has been adapted from CAMERA algorithm: 
Kuhl C, Tautenhahn R, Boettcher C, Larson TR, Neumann S (2012). “CAMERA: an 
integrated strategy for compound spectra extraction and annotation of liquid 
chromatography/mass spectrometry data sets.” Analytical Chemistry, 84, 283–289. 
http://pubs.acs.org/doi/abs/10.1021/ac202450g.
</p>


<h3>See Also</h3>

<p><a href="#topic+batchdataProcessing">batchdataProcessing</a> and <a href="#topic+setmsbatch">setmsbatch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- dataProcessing("input_file.mzXML", acquisitionmode="DIA", polarity,
dmzagglom = 25, drtagglom = 500, drtclust = 60, minpeak = c(5, 3),
drtgap = 5, drtminpeak = 20, drtmaxpeak = 100, recurs = 5, sb = c(3, 2),
sn = 2, minint = c(1000, 100), weight = 2, dmzIso = 10, drtIso = 5)

## End(Not run)

</code></pre>

<hr>
<h2 id='dbFourChains'>Creation of a database for C.</h2><span id='topic+dbFourChains'></span>

<h3>Description</h3>

<p>Creation of a database CL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbFourChains(chains, lipid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbFourChains_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FAs to be employed</p>
</td></tr>
<tr><td><code id="dbFourChains_+3A_lipid">lipid</code></td>
<td>
<p>character value indication the class of lipid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing formula, mass and total number of carbons and
insaturations
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='dbOneChain'>Creation of a database for Carnitines, CE, FA, HFA, LPL, MG, sphingoid
bases and sphingoid bases phosphate.</h2><span id='topic+dbOneChain'></span>

<h3>Description</h3>

<p>Creation of a database for Carnitines, CE, FA, HFA, LPL, MG, sphingoid
bases and sphingoid bases phosphate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbOneChain(chains, lipid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbOneChain_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FAs to be employed</p>
</td></tr>
<tr><td><code id="dbOneChain_+3A_lipid">lipid</code></td>
<td>
<p>character value indication the class of lipid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing formula, mass and total number of carbons and
insaturations
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='dbSphingolipids'>Creation of a database for Cer, CerP, GlcCer and SM</h2><span id='topic+dbSphingolipids'></span>

<h3>Description</h3>

<p>Creation of a database for Cer, CerP, GlcCer and SM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbSphingolipids(chains, chains2, lipid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbSphingolipids_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FAs to be employed</p>
</td></tr>
<tr><td><code id="dbSphingolipids_+3A_chains2">chains2</code></td>
<td>
<p>character vector indicating the sphingoid bases to be employed</p>
</td></tr>
<tr><td><code id="dbSphingolipids_+3A_lipid">lipid</code></td>
<td>
<p>character value indication the class of lipid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing formula, mass and total number of carbons and
insaturations.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='dbThreeChains'>Creation of a database for TG.</h2><span id='topic+dbThreeChains'></span>

<h3>Description</h3>

<p>Creation of a database for TG.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbThreeChains(chains, lipid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbThreeChains_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FAs to be employed</p>
</td></tr>
<tr><td><code id="dbThreeChains_+3A_lipid">lipid</code></td>
<td>
<p>character value indication the class of lipid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing formula, mass and total number of carbons and
insaturations
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='dbTwoChains'>Creation of a database for FAHFA, DG and PL.</h2><span id='topic+dbTwoChains'></span>

<h3>Description</h3>

<p>Creation of a database for FAHFA, DG and PL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbTwoChains(chains, lipid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbTwoChains_+3A_chains">chains</code></td>
<td>
<p>character vector indicating the FAs to be employed</p>
</td></tr>
<tr><td><code id="dbTwoChains_+3A_lipid">lipid</code></td>
<td>
<p>character value indication the class of lipid.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing formula, mass and total number of carbons and
insaturations
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='ddaFrags'>MS/MS scan extraction of a precursor in DDA</h2><span id='topic+ddaFrags'></span>

<h3>Description</h3>

<p>This function searches for the closest precursor selected for MS2 in DDA
that matches mz tolerance and RT window of a list of candidates and extracts
their fragments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddaFrags(candidates, precursors, rawData, ppm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddaFrags_+3A_candidates">candidates</code></td>
<td>
<p>candidates data frame. Output of <a href="#topic+findCandidates">findCandidates</a>.</p>
</td></tr>
<tr><td><code id="ddaFrags_+3A_precursors">precursors</code></td>
<td>
<p>data frame with the whole list of precursors selected for MS2.</p>
</td></tr>
<tr><td><code id="ddaFrags_+3A_rawdata">rawData</code></td>
<td>
<p>peaklist for MS2 function (MSMS).</p>
</td></tr>
<tr><td><code id="ddaFrags_+3A_ppm">ppm</code></td>
<td>
<p>m/z tolerance in ppm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MS2 scans for a given precursor are searched within a rt window from
minrt-rttol/2 to maxrt+rttol/2. If the same precursor was selected several
times along the peak, the closest scan to the rt at the peak maximum is
selected for annotation.
</p>
<p>Coelution score for DDA fragments represents their relative intensity within 
the MS2 scan.
</p>


<h3>Value</h3>

<p>List of data frames with the fragments for each candidate.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='dgdb'>
DGs database
</h2><span id='topic+dgdb'></span>

<h3>Description</h3>

<p>In silico generated database for common DGs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dgdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='diffcb'>Difference between two carbon:bounds structures</h2><span id='topic+diffcb'></span>

<h3>Description</h3>

<p>This function calculates the number of carbon and double bounds that differ
between two structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diffcb(total, frag, db)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diffcb_+3A_total">total</code></td>
<td>
<p>character value indicating the precursor structure</p>
</td></tr>
<tr><td><code id="diffcb_+3A_frag">frag</code></td>
<td>
<p>character value indicating the fragment structure</p>
</td></tr>
<tr><td><code id="diffcb_+3A_db">db</code></td>
<td>
<p>db of chains to be considered</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character value
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='fadb'>
FAs database
</h2><span id='topic+fadb'></span>

<h3>Description</h3>

<p>In silico generated database for common FAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fadb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='fahfadb'>
FAHFAs database
</h2><span id='topic+fahfadb'></span>

<h3>Description</h3>

<p>In silico generated database for common FAHFAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fahfadb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='fillpeaksmsbatch'>Fill peaks from a grouped msbatch</h2><span id='topic+fillpeaksmsbatch'></span>

<h3>Description</h3>

<p>Use grouping results to target all peaks from the msbatch in each sample and 
refill intensities at the features table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillpeaksmsbatch(msbatch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fillpeaksmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch obtained from the <a href="#topic+groupmsbatch">groupmsbatch</a> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Once grouping has been performed, areas are extracted again for each 
peak and sample based on the peak parameters defined for each feature (mz and 
tolerance and initial and end RT).
</p>


<h3>Value</h3>

<p>msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- fillpeaksmsbatch(msbatch)

## End(Not run)

</code></pre>

<hr>
<h2 id='filtermsms'>Presence or absence of an mz value within a vector of mz values</h2><span id='topic+filtermsms'></span>

<h3>Description</h3>

<p>This function indicates the presence or absence of a fragment within a set
of mz values with certain tolerance. It is used by identification functions
to look for the generic fragments of each class of lipid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filtermsms(fragments, frag, ppm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filtermsms_+3A_fragments">fragments</code></td>
<td>
<p>vector of mz values</p>
</td></tr>
<tr><td><code id="filtermsms_+3A_frag">frag</code></td>
<td>
<p>mz to be matched</p>
</td></tr>
<tr><td><code id="filtermsms_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical value
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='filtrateAdducts'>Remove low adduct supported candidates to avoid false positives.</h2><span id='topic+filtrateAdducts'></span>

<h3>Description</h3>

<p>In case some feature has been annotated to different candidate species,
this function removes the one with less adducts assigned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filtrateAdducts(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filtrateAdducts_+3A_df">df</code></td>
<td>
<p>data frame containing candidates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Subset of the original data frame
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='findCandidates'>Search of lipid candidates of a certain class</h2><span id='topic+findCandidates'></span>

<h3>Description</h3>

<p>Search of lipid candidates from a peaklist based on a set of expected
adducts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findCandidates(
  MS1,
  db,
  ppm,
  rt,
  adducts,
  rttol = 3,
  dbs,
  rawData = data.frame(),
  coelCutoff = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findCandidates_+3A_ms1">MS1</code></td>
<td>
<p>peaklist of the MS function. Data frame with 3 columns: mz, RT (in seconds) and int (intensity).</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_db">db</code></td>
<td>
<p>database (i.e. pcdb, dgdb, etc.). Data frame with at least 2 columns: Mass (exact mass) and total (total number of carbons and double bound of the FA chains, i.e. &quot;34:1&quot;).</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_ppm">ppm</code></td>
<td>
<p>m/z tolerance in ppm.</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_adducts">adducts</code></td>
<td>
<p>character vector containing the expected adducts to search
for (i.e. &quot;M+H&quot;, &quot;M+Na&quot;, &quot;M-H&quot;, etc.). See details.</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_rttol">rttol</code></td>
<td>
<p>rt tolerance in seconds to match adducts.</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for the annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be changed. If data bases have
been customized using <a href="#topic+createLipidDB">createLipidDB</a>, they also have to be modified
here.</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_rawdata">rawData</code></td>
<td>
<p>raw scans data. Output of <a href="#topic+dataProcessing">dataProcessing</a> function (MS1$rawData).</p>
</td></tr>
<tr><td><code id="findCandidates_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="#topic+findCandidates">findCandidates</a> looks for matches between the m/z of the
MS1 peaklist and the expected m/z of the candidates in the database for each
adduct. If several adducts are expected, results are combined.
</p>
<p>Adducts allowed are contained in adductsTable data frame, which can be
modified if required (see <a href="#topic+adductsTable">adductsTable</a>).
</p>


<h3>Value</h3>

<p>Data frame with the found candidates. It contains 6 columns: mz,
RT, int (from the peaklist data.frame), ppms, cb (total number of carbons and
double bounds of the FA chains) and adducts.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='findMS2precursor'>find lisnks between MS1 peaks and precursors selected for MS2 in DDA</h2><span id='topic+findMS2precursor'></span>

<h3>Description</h3>

<p>Find lisnks between MS1 peaks and precursors selected for MS2 in DDA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMS2precursor(mz, minrt, maxrt, precursors, ppm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findMS2precursor_+3A_mz">mz</code></td>
<td>
<p>mz</p>
</td></tr>
<tr><td><code id="findMS2precursor_+3A_minrt">minrt</code></td>
<td>
<p>minimum intensity</p>
</td></tr>
<tr><td><code id="findMS2precursor_+3A_maxrt">maxrt</code></td>
<td>
<p>maximum intensity</p>
</td></tr>
<tr><td><code id="findMS2precursor_+3A_precursors">precursors</code></td>
<td>
<p>data frame with all precursors</p>
</td></tr>
<tr><td><code id="findMS2precursor_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>peak-pick based on previous EIC clusters generated by <a href="#topic+clustering">clustering</a>
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='findPrecursor'>Find candidate precursor from fullMS function</h2><span id='topic+findPrecursor'></span>

<h3>Description</h3>

<p>This function is employed by all identification function in this package to
find possible precursors in the fullMS function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findPrecursor(MS1, db, ppm, massdif, rt, n = 1, charge = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findPrecursor_+3A_ms1">MS1</code></td>
<td>
<p>data frame containing m/z, RT and intensity of ions from the first
function</p>
</td></tr>
<tr><td><code id="findPrecursor_+3A_db">db</code></td>
<td>
<p>database to be searched for matches</p>
</td></tr>
<tr><td><code id="findPrecursor_+3A_massdif">massdif</code></td>
<td>
<p>mass difference between neutral mass and the adduct expected</p>
</td></tr>
<tr><td><code id="findPrecursor_+3A_rt">rt</code></td>
<td>
<p>rt window</p>
</td></tr>
<tr><td><code id="findPrecursor_+3A_n">n</code></td>
<td>
<p>numeric value indicating whether to look for monomers (1), dimers
(2), etc.</p>
</td></tr>
<tr><td><code id="findPrecursor_+3A_charge">charge</code></td>
<td>
<p>numeric value indicating the expected charge of the ions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Subset of the original data frame without adducts
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='frags'>Search for fragments of interest withing a list of coeluting fragments</h2><span id='topic+frags'></span>

<h3>Description</h3>

<p>Given a set of coeluting fragments, this function searches for matches within
a database. It is used by identification functions to extract fragments of
interest based on the fragmentation patterns of each class of lipid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frags(df, ppm, db, mdiff, charge, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frags_+3A_df">df</code></td>
<td>
<p>data frame containing coeluting fragments</p>
</td></tr>
<tr><td><code id="frags_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance</p>
</td></tr>
<tr><td><code id="frags_+3A_db">db</code></td>
<td>
<p>database (data frame with two columns) where to look into</p>
</td></tr>
<tr><td><code id="frags_+3A_charge">charge</code></td>
<td>
<p>mdiff</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing matched ions information
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='getallpeaks'>Extract peaks from all msobjects in a msbatch.</h2><span id='topic+getallpeaks'></span>

<h3>Description</h3>

<p>Extract peaks from all MS1 peaklists of the msobjects in a msbatch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getallpeaks(msbatch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getallpeaks_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with 6 columns (mz, RT, int, peakID, isotope and isoGroup).
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='getfeaturestable'>Write features table based on groups</h2><span id='topic+getfeaturestable'></span>

<h3>Description</h3>

<p>Write features table based on groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getfeaturestable(msbatch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getfeaturestable_+3A_msbatch">msbatch</code></td>
<td>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='getFormula'>Get formula and neutral mass for annotated compounds</h2><span id='topic+getFormula'></span>

<h3>Description</h3>

<p>Get formula and neutral mass for annotated compounds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFormula(df, dbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFormula_+3A_df">df</code></td>
<td>
<p>data frame with the input results</p>
</td></tr>
<tr><td><code id="getFormula_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='getInclusionList'>Obtain an inclusion list from the annotation results</h2><span id='topic+getInclusionList'></span>

<h3>Description</h3>

<p>Obtain an inclusion list for the identified lipids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInclusionList(df, dbs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInclusionList_+3A_df">df</code></td>
<td>
<p>data frame. Output of identification functions (results table from
an msobject or feature table from an msbatch).</p>
</td></tr>
<tr><td><code id="getInclusionList_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with 6 columns: formula, RT, neutral mass, m/z, adduct
and the LipidMSid.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='groupmsbatch'>Group features from an msbatch</h2><span id='topic+groupmsbatch'></span>

<h3>Description</h3>

<p>Group features from an msbatch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupmsbatch(
  msbatch,
  dmz = 5,
  drtagglom = 30,
  drt = 15,
  minsamples,
  minsamplesfrac = 0.25,
  parallel = FALSE,
  ncores,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch obtained from <a href="#topic+setmsbatch">setmsbatch</a> or <a href="#topic+alignmsbatch">alignmsbatch</a> 
functions.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_dmz">dmz</code></td>
<td>
<p>mass tolerance between peak groups for grouping in ppm.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_drtagglom">drtagglom</code></td>
<td>
<p>rt window for mz partitioning.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_drt">drt</code></td>
<td>
<p>rt window for peaks clustering.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_minsamples">minsamples</code></td>
<td>
<p>minimum number of samples represented in clusters 
used for grouping.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_minsamplesfrac">minsamplesfrac</code></td>
<td>
<p>minimum samples fraction represented in each cluster 
used for grouping. Used to calculate minsamples in case it is missing.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_parallel">parallel</code></td>
<td>
<p>logical. If TRUE, parallel processing is performed.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_ncores">ncores</code></td>
<td>
<p>number of cores to be used in case parallel is TRUE.</p>
</td></tr>
<tr><td><code id="groupmsbatch_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, peak partitions are created based on the enviPick algorithm 
to speed up the following clustering algorithm. Briefly, peaks are ordered 
increasingly by mz and RT and grouped based on user-defined tolerances (dmz 
and drt). Each peak is initialized as a partition and then, they are 
evaluated to decide whether or not they can be joined to the previous 
partition. If mz and RT of a peak matches tolerance of any of the peaks in 
the previous partition, it is reassigned. Then, clustering algorithm is 
executed to improve these partitions based on their mz following the next 
steps for each partition:
</p>
<p>1.	Each peak in the partition is initialized as a new cluster. For each 
cluster we will keep the minimum, maximum and mean value of the mz, which at 
this point have the same values.
2.	Calculate a distance matrix between all clusters. This distance will be 
the greatest difference between minimum and maximum values of each cluster.
3.	While any distance is different to NA, search the minimum distance between 
two clusters.
4.	If distance is below the maximum distance allowed, join clusters and 
update minimum, maximum and mean values, else, set distance to NA and go back 
to point 3.
</p>
<p>Then this same clustring algorithm is executed again to group peaks based on 
their RT. In this case, distances between clusters which share peaks from the 
same samples will be set to NA.
</p>
<p>After groups have been defined, those clusters with a sample representation 
over minsamples or minsamplesfrac will be used for building the feature table.
</p>


<h3>Value</h3>

<p>grouped msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Partitioning algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- groupmsbatch(msbatch)

## End(Not run)

</code></pre>

<hr>
<h2 id='hfadb'>
HFAs database
</h2><span id='topic+hfadb'></span>

<h3>Description</h3>

<p>In silico generated database for common HFAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("hfadb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='idAcylCerneg'>Acylceramides (AcylCer) annotation for ESI-</h2><span id='topic+idAcylCerneg'></span>

<h3>Description</h3>

<p>AcylCer identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idAcylCerneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H", "M+CH3COO"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("cbdiff-cer_M-H"),
  chainfrags_sn2 = c("sph_Mn-62.06001", "sph_M-H-H2O"),
  chainfrags_sn3 = c("fa_Mn-1.9918", "fa_Mn-19.0179"),
  intrules = c("cbdiff-cer_sn1/sph_sn2", "sph_sn2/fa_sn3"),
  rates = c("5/1", "2/1"),
  intrequired = c(T, T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idAcylCerneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for AcylCer in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the sphingoid base. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_chainfrags_sn3">chainfrags_sn3</code></td>
<td>
<p>character vector containing the fragmentation rules for
the acyl chain. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected ratesbetween fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idAcylCerneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate AcylCer as M-H and M+CH3COO. 2) Search of AcylCer 
class fragments: no class fragments by default. 3) Search of specific fragments 
that inform about the acyl chain (Cer as M-H), the sphingoid base (neutral 
loss of 62.0600 of the Sph) and the FA chain (FA as M-H and M-H2O but with a N 
instead of an O, what results in a mass differences of 1.9918 and 19.0179 
respectively). 4) Look for possible chains structure based on the combination 
of chain fragments. 5) Check intensity rules to confirm chains position. In 
this case, the fragment coming from the loss of the acyl chain must be at least 
5 times more intense the fragment from the sphingoid base and this one, two 
times more intense than the FA chain from sn3.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idAcylCerneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idAcylCerpos'>Acylceramides (AcylCer) annotation for ESI+</h2><span id='topic+idAcylCerpos'></span>

<h3>Description</h3>

<p>AcylCer identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idAcylCerpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+H-H2O", "M+Na"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("cbdiff-cer_M+H", "cbdiff-cer_M+H-H2O", "cbdiff-cer_M+H-2H2O"),
  chainfrags_sn2 = c("sph_M+H-H2O", "sph_M+H-2H2O"),
  chainfrags_sn3 = c("fa_Mn+0.02329"),
  intrules = c("sph_sn2/cbdiff-cer_sn1", "sph_sn2/fa_sn3"),
  rates = c("2/1", "5/1"),
  intrequired = c(T, T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idAcylCerpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Cer in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the sphingoid base. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_chainfrags_sn3">chainfrags_sn3</code></td>
<td>
<p>character vector containing the fragmentation rules for
the acyl chain. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected ratesbetween fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idAcylCerpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idAcylCerpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate AcylCer as M+H, M+H-H2O and M+Na. 2) Search of 
AcylCer class fragments: there are no class fragments by default. 3) Search of 
specific fragments that inform about the acyl chain (Cer as M+H, M+H-H2O or
M+H-2H2H), the sphingoid base (Sph as M+H-H2O or M+H-2H2O) and the FA chain 
(FA as M+H but with a N intead of an O, what results in a mass difference of 
0.02329 with the Mn of the FA chain). 4) Look for possible chains structure 
based on the combination of chain fragments. 5) Check intensity rules to 
confirm chains position. In this case, Sph fragment must be twice more
intense than the loss of the acyl chain and at least 5 times more intense than
the FA chain from sn3.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCerPneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idBAneg'>Bile Acids (BA) annotation for ESI-</h2><span id='topic+idBAneg'></span>

<h3>Description</h3>

<p>BA identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idBAneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  conjfrag = c("baconj_M-H"),
  bafrag = c("ba_M-H-H2O", "ba_M-H-2H2O"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idBAneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for BA in ESI-. Adducts allowed can
be modified in the adducsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_conjfrag">conjfrag</code></td>
<td>
<p>character vector containing the fragmentation rules for
the BA-conjugates. By default just taurine and glycine are considered,
but baconjdb can be modified to add more possible conjugates.
See <a href="#topic+chainFrags">chainFrags</a> for details. It can also be an empty vector.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_bafrag">bafrag</code></td>
<td>
<p>character vector containing the fragmentation rules for
other BA fragments. See <a href="#topic+chainFrags">chainFrags</a> for details. It can be an empty
vector.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idBAneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idBAneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate BA as M-H. 2) Search of BA-conjugate fragments if
required. 3) Search of fragments coming from the loss of H2O.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (MS-only
if no rules are defined, or Subclass level if they are supported by fragments)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idBAneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCarpos'>Acylcarnitine annotation for ESI+</h2><span id='topic+idCarpos'></span>

<h3>Description</h3>

<p>Acylcarnitines identification based on fragmentation patterns for LC-MS/MS
DIA or DDA data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCarpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(60.0807, 85.0295, "fa_M+H-H2O"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  chainfrags_sn1 = c("fa_M+H-H2O"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCarpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Carnitines in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCarpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCarpos</code> function involves 3 steps. 1) FullMS-based
identification of candidate carnitines as M+H and M+Na. 2) Search of
carnitine class fragments: 60.0807 and 85.0295 or its loss (FA as M+H-H20)
coeluting with the precursor ion. 3) Search of specific fragments coming from
the FA chain (FA as M+H-H2O).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as Carnitines only have one chain, only Subclass and FA level are
possible) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCarpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCEpos'>Cholesteryl Esters (CE) annotation for ESI+</h2><span id='topic+idCEpos'></span>

<h3>Description</h3>

<p>CE identification based on fragmentation patterns for LC-MS/MS DIA or DDA data
acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCEpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("2M+NH4", "2M+Na", "M+NH4", "M+Na"),
  clfrags = c(369.3516, "fa_M+H-H2O"),
  clrequired = c(F, F),
  ftype = c("F", "BB"),
  chainfrags_sn1 = c("fa_M+H-H2O"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCEpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for CE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCEpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCEpos</code> function involves 3 steps. 1) FullMS-based
identification of candidate CE as 2M+NH4, 2M+Na, M+NH4 and M+Na. 2) Search of
CE class fragments: 369.3516 or its loss (FA as M+H-H20) coeluting with the
precursor ion. 3) Search of specific fragments that confirm chain composition
(FA as M+H-H2O).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as CE only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCEpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCerneg'>Ceramides (Cer) annotation for ESI-</h2><span id='topic+idCerneg'></span>

<h3>Description</h3>

<p>Cer identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCerneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H", "M+CH3COO"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("NL-nlsph_M-H", "sph_M-H-2H2O", "sph_M-H-H2O"),
  chainfrags_sn2 = c("fa_Mn-1.9918", "fa_M-H-H2O"),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCerneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Cer in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected ratesbetween fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCerneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCerneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate Cer as M-H and M+CH3COO. 2) Search of Cer class
fragments: there are no class fragment by default. 3) Search of specific
fragments that inform about the sphingoid base (Sph as M-H-2H2O resulting
from the loss of the FA chain or loss of part of the sphingoid base) and the
FA chain (FA as M-H but with a N instead of an O, what means a mass difference
of 1.9918 from the exact mass of the FA or FA as M-H-H2O). 4) Look for 
possible chains structure based on the combination of chain fragments. 
5) Check intensity rules to confirm chains position. In this case, there are 
no intensity rules by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCerneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCerPneg'>Ceramides phosphate (CerP) annotation for ESI-</h2><span id='topic+idCerPneg'></span>

<h3>Description</h3>

<p>CerP identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCerPneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(78.9585, 96.9691),
  clrequired = c(F, F),
  ftype = c("F", "F"),
  chainfrags_sn1 = c("sphP_M-H"),
  chainfrags_sn2 = c("fa_Mn-1.9918", ""),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCerPneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for CerP in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected ratesbetween fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCerPneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCerPneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate CerP as M-H. 2) Search of CerP class
fragments: 78.9585 and 96.9691. 3) Search of specific fragments that inform 
about the sphingoid base (SphP as M-H resulting from the loss of the FA chain) 
and the FA chain (FA as M-H but with a N instead of an O, what results in a 
mass difference of 1.9918 from the exact mass of the FA, or the difference 
between precursor and sn1 chain fragments). 4) Look for possible chains
structure based on the combination of chain fragments. 5) Check intensity
rules to confirm chains position. In this case, there are no intensity rules
by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCerPneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCerpos'>Ceramides (Cer) annotation for ESI+</h2><span id='topic+idCerpos'></span>

<h3>Description</h3>

<p>Ceramides identification based on fragmentation patterns for LC-MS/MS DIA or
DDA data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCerpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H-H2O", "M+Na", "M+H"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("sph_M+H-2H2O"),
  chainfrags_sn2 = c(""),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCerpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Cer in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between peaks (adducts, parent and
fragment ions...). Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCerpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCerpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate Cer as M+H, M+H-H2O and M+Na. 2) Search of Cer
class fragments: there isn't any class fragment by default. 3) Search of
specific fragments that inform about the sphingoid base (Sph as M+H-2H2O
resulting from the loss of the FA chain) and the FA chain (by default it is
calculated using the difference between precursor and sph fragments).
4) Look for possible chains structure based on the combination of chain
fragments. 5) Check intensity rules to confirm chains position. In this case,
there are no intensity rules by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCerpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCerPpos'>Ceramides phosphate (CerP) annotation for ESI+</h2><span id='topic+idCerPpos'></span>

<h3>Description</h3>

<p>CerP identification based on fragmentation patterns for LC-MS/MS DIA or
DDA data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCerPpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H"),
  clfrags = c("cer_M+H-H2O", "cer_M+H-2H2O"),
  clrequired = c(F, F),
  ftype = c("BB", "BB"),
  chainfrags_sn1 = c("sph_M+H-2H2O"),
  chainfrags_sn2 = c(""),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCerPpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Cer in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between peaks (adducts, parent and
fragment ions...). Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCerPpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCerPpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate CerP as M+H. 2) Search of Cer class fragments: 
Cer as M+H-H2O and M+H-2H2O resulting from the loss of the phosphate group and
1 or 2 H2O molecules. 3) Search of specific fragments that inform about the 
sphingoid base (Sph as M+H-2H2O resulting from the loss of the FA chain and 
the phosphate group) and the FA chain (by default it is calculated using the 
difference between precursor and sph fragments). 4) Look for possible chains 
structure based on the combination of chain fragments. 5) Check intensity 
rules to confirm chains position. In this case, there are no intensity rules 
by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCerPpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idCLneg'>Cardiolipines (CL) annotation for ESI-</h2><span id='topic+idCLneg'></span>

<h3>Description</h3>

<p>CL identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idCLneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  rt,
  adducts = c("M-H", "M+Na-2H"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("lysopa_M-H-H2O"),
  chainfrags_sn2 = c("lysopa_M-H-H2O"),
  chainfrags_sn3 = c("lysopa_M-H-H2O"),
  chainfrags_sn4 = c("lysopa_M-H-H2O"),
  intrules = c("Unknown"),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idCLneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for CL in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_chainfrags_sn3">chainfrags_sn3</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn3 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_chainfrags_sn4">chainfrags_sn4</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn4 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>. If some intensity rules should be employed to
identify the chains position but they are't known yet, use &quot;Unknown&quot;. If it
isn't required, leave an empty vector.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idCLneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idCLneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate CL as M-H or M-2H. 2) Search of CL class fragments:
no class fragments are searched by defaults as they use to have bad coelution
scores. 3) Search of specific fragments that inform about chain composition
at sn1 (lysoPA as M-H-H2O), sn2 (lysoPA as M-H-H2O), sn3 (lysoPA as M-H-H2O)
and sn4 (lysoPA as M-H-H2O). 4) Look for possible chains structure based on
the combination of chain fragments. 5) Check intensity rules to confirm
chains position. For CL there are no intensity rules by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idCLneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idDGpos'>Diacylglycerols (DG) annotation for ESI+</h2><span id='topic+idDGpos'></span>

<h3>Description</h3>

<p>DG identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idDGpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H-H2O", "M+NH4", "M+Na"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("mg_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O"),
  intrules = c("mg_sn1/mg_sn2"),
  rates = c("1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idDGpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for DG in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idDGpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idDGpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate DG as M+H-H2O, M+NH4 and M+Na. 2) Search of DG
class fragments: there are no class fragment by default. 3) Search of
specific fragments that inform about the FA chains (MGs as M+H-H2O
resulting from the loss of the FA chains). 4) Look for possible chains
structure based on the combination of chain fragments. 5) Check intensity
rules to confirm chains position: MG coming from the loss of the sn2 chain is
more intense than the one coming from the loss of sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idDGpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idFAHFAneg'>FAHFA annotation for ESI-</h2><span id='topic+idFAHFAneg'></span>

<h3>Description</h3>

<p>FAHFA identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idFAHFAneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("hfa_M-H"),
  chainfrags_sn2 = c("fa_M-H"),
  intrules = c("hfa_sn1/fa_sn2"),
  rates = c("3/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idFAHFAneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for FAHFA in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idFAHFAneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idFAHFAneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate FAHFA as M-H. 2) Search of FAHFA class fragments:
there is't any class fragment by default. 3) Search of specific fragments
that inform about chain composition in sn1 (HFA as M-H resulting from the
loss of the FA chain) and sn2 (FA chain as M-H). 4) Look for possible
chains structure based on the combination of chain fragments. 5) Check
intensity rules to confirm chains position. In this case, HFA intensity has
to be higher than FA.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idFAHFAneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idFAneg'>Fatty Acids (FA) annotation for ESI-</h2><span id='topic+idFAneg'></span>

<h3>Description</h3>

<p>FA identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idFAneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H", "2M-H"),
  clfrags = c("fa_M-H", "fa_M-H-H2O"),
  clrequired = c(FALSE, FALSE),
  ftype = c("BB", "BB"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idFAneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for FA in ESI-. Adducts allowed can
be modified in addutcsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idFAneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idFAneg</code> function involves 2 steps. 1) FullMS-based
identification of candidate FA as M-H or 2M-H. 2) Search of FA class
fragments: neutral loss of H2O coeluting with the precursor ion or the
molecular ion.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, just MS-only or Subclass level (if any class fragment is defined) are
possible) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idFAneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPCneg'>Lysophosphocholines (LPC) annotation for ESI-</h2><span id='topic+idLPCneg'></span>

<h3>Description</h3>

<p>LPC identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPCneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+CH3COO", "M-CH3", "M+CH3COO-CH3"),
  clfrags = c(168.0426, 224.0688, "lysopa_M-H", "lysopc_M-CH3"),
  clrequired = c(F, F, F, F),
  ftype = c("F", "F", "BB", "BB"),
  chainfrags_sn1 = c("fa_M-H"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPCneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPC in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPCneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPCneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPC as M+CH3COO, M-CH3 and M+CH3COO-CH3. To avoid
incorrect annotations of PE as PC, candidates which are present just as M-CH3
will be ignored. 2) Search of LPC class fragments: 168.0426, 224.0688, lysoPA
as M-H or lysoPC as M-CH3 coeluting with the precursor ion. 3) Search of
specific fragments that confirm chain composition (FA as M-H).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPC only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPCneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPCpos'>Lysophosphocholines (LPC) annotation for ESI+</h2><span id='topic+idLPCpos'></span>

<h3>Description</h3>

<p>LPC identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPCpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(104.1075, 184.0739),
  clrequired = c(F, F),
  ftype = c("F", "F"),
  chainfrags_sn1 = c("mg_M+H-H2O"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPCpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPC in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPCpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPCpos</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPC as M+H and M+Na. 2) Search of
LPC class fragments: 104.1075 and 184.0739 coeluting with the
precursor ion. 3) Search of specific fragments that confirm chain
composition (MG as M+H-H2O).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPC only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPCpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPEneg'>Lysophosphoethanolamines (LPE) annotation for ESI-</h2><span id='topic+idLPEneg'></span>

<h3>Description</h3>

<p>LPE identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPEneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(140.0115, 196.038, 214.048, "lysope_M-CH3"),
  clrequired = c(F, F, F, "excluding"),
  ftype = c("F", "F", "F", "BB"),
  chainfrags_sn1 = c("fa_M-H"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPEneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPE in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPEneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPEneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPE as M-H. 2) Search of
LPE class fragments: 140.0115, 196.038 and 214.048 coeluting with the
precursor ion. If a loss of CH3 group is found coeluting with any candidate,
this will be excluded as it is a characteristic fragment of LPC.3) Search of
specific fragments that confirm chain composition (FA as M-H).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPE only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPEneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPEpos'>Lysophosphoethanolamines (LPE) annotation for ESI+</h2><span id='topic+idLPEpos'></span>

<h3>Description</h3>

<p>LPE identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPEpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(141.01909),
  clrequired = c(F),
  ftype = c("NL"),
  chainfrags_sn1 = c("mg_M+H-H2O"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPEpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPEpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPEpos</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPE as M+H and M+Na. 2) Search of
LPE class fragments: neutral loss of 141.01909 coeluting with the
precursor ion. 3) Search of specific fragments that confirm chain
composition in sn1 (MG as M+H-H2O).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPE only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPEpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPGneg'>Lysophosphoglycerols (LPG) annotation for ESI-</h2><span id='topic+idLPGneg'></span>

<h3>Description</h3>

<p>LPG identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPGneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(152.9958, 227.0326, 209.022, 74.0359),
  clrequired = c(F, F, F, F),
  ftype = c("F", "F", "F", "NL"),
  chainfrags_sn1 = c("fa_M-H"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPGneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPG in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPGneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPGneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPG as M-H. 2) Search of LPG class fragments:
152.9958, 227.0326, 209.022 and neutral loss of 74.0359 coeluting with the
precursor ion. 3) Search of specific fragments that confirm chain composition
(FA as M-H).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPG only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPGneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPIneg'>Lysophosphoinositols (LPI) annotation for ESI-</h2><span id='topic+idLPIneg'></span>

<h3>Description</h3>

<p>LPI identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPIneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(241.0115, 223.0008, 259.0219, 297.0375),
  clrequired = c(F, F, F, F),
  ftype = c("F", "F", "F", "F"),
  chainfrags_sn1 = c("fa_M-H"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPIneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPI in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPIneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPIneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPI as M-H. 2) Search of
LPI class fragments: 241.0115, 223.0008, 259.0219 and 297.0375 coeluting
with the precursor ion. 3) Search of specific fragments that confirm chain
composition (FA as M-H).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPI only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPIneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idLPSneg'>Lysophosphoserines (LPS) annotation for ESI-</h2><span id='topic+idLPSneg'></span>

<h3>Description</h3>

<p>LPS identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idLPSneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H", "M+Na-2H"),
  clfrags = c(87.032),
  clrequired = c(F),
  ftype = c("NL"),
  chainfrags_sn1 = c("fa_M-H"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idLPSneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for LPS in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idLPSneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idLPSneg</code> function involves 3 steps. 1) FullMS-based
identification of candidate LPS as M-H and M+Na-2H. 2) Search of
LPS class fragments: neutral loss of 87.032 coeluting with the precursor ion.
3) Search of specific fragments that confirm chain composition (FA as M-H).
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as LPS only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idLPSneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idMGpos'>Monoacylglycerol (MG) annotation for ESI+</h2><span id='topic+idMGpos'></span>

<h3>Description</h3>

<p>MG identification based on fragmentation patterns for LC-MS/MS DIA and DDA data
acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idMGpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H-H2O", "M+NH4", "M+Na"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idMGpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for MG in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idMGpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idMGpos</code> function involves 2 steps. 1) FullMS-based
identification of candidate MG as M+H-H2O, M+NH4 and M+Na. 2) Search of
MG class fragments if any is assigned.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, just MS-only or Subclass level (if any class fragment is defined) are
possible) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idMGpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idNEG'>Lipids annotation for ESI-</h2><span id='topic+idNEG'></span>

<h3>Description</h3>

<p>Lipids annotation based on fragmentation patterns for LC-MS/MS DIA or DDA data
acquired in negative mode. This function compiles all functions writen for
ESI- annotations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idNEG(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  coelCutoff = 0.8,
  lipidClasses = c("FA", "FAHFA", "LPC", "LPE", "LPG", "LPI", "LPS", "PC", "PCo", "PCp",
    "PE", "PEo", "PEp", "PG", "PI", "PS", "Sph", "SphP", "Cer", "CerP", "AcylCer", "SM",
    "CL", "BA"),
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idNEG_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 5 seconds.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_lipidclasses">lipidClasses</code></td>
<td>
<p>classes of interest to run the identification functions.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idNEG_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification); and the annotatedPeaklist element shows the original 
MS1 peaklist with the annotations on it.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idNEG(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPCneg'>Phosphocholines (PC) annotation for ESI-</h2><span id='topic+idPCneg'></span>

<h3>Description</h3>

<p>PC identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPCneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+CH3COO", "M-CH3", "M+CH3COO-CH3"),
  clfrags = c(168.0426, 224.0688, "pc_M-CH3"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  chainfrags_sn1 = c("lysopc_M-CH3"),
  chainfrags_sn2 = c("fa_M-H", "lysopc_M-CH3"),
  intrules = c("lysopc_sn1/lysopc_sn2"),
  rates = c("3/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPCneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PC in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPCneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPCneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PC as M+CH3COO, M-CH3 or M+CH3COO-CH3. To avoid
incorrect annotations of PE as PC, candidates which are present just as M-CH3
will be ignored. 2) Search of PC class fragments: 168.0426, 224.0688 or loss
of CH3 coeluting with the precursor ion. 3) Search of specific fragments that
inform about chain composition in sn1 (lysoPC as M-CH3 resulting from the
loss of the FA chain at sn2) and sn2 (lysoPC as M-CH3 resulting from the loss
of sn1 or FA as M-H). 4) Look for possible chains structure based on the
combination of chain fragments. 5) Check intensity rules to confirm chains
position. In this case, lysoPC from sn1 is at least 3 times more intense than
lysoPC from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPConeg'>Plasmanyl Phosphocholines (PCo) annotation for ESI-</h2><span id='topic+idPConeg'></span>

<h3>Description</h3>

<p>PCo identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPConeg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+CH3COO", "M-CH3", "M+CH3COO-CH3"),
  clfrags = c(168.0426, 224.0688, "pco_M-CH3"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  chainfrags_sn1 = c("lysopco_M-CH3", "lysopco_M-CH3-H2O"),
  chainfrags_sn2 = c("fa_M-H", "fa_M-CO2-H"),
  intrules = c("lysopco_sn1/fa_sn2"),
  rates = c(1/3),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPConeg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PCo in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPConeg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPConeg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PCo as M+CH3COO, M-CH3 or M+CH3COO-CH3. To avoid
incorrect annotations of PEo as PCo, candidates which are present just as M-CH3
will be ignored. 2) Search of PCo class fragments: 168.0426, 224.0688 or loss
of CH3 coeluting with the precursor ion. 3) Search of specific fragments that
inform about chain composition in sn1 (LPCo as M-CH3 and M-CH3-H2O resulting 
from the loss of the FA chain at sn2) and sn2 (FA as M-H and M-CO2-H). 
4) Look for possible chains structure based on the  combination of chain 
fragments. 5) Check intensity rules to confirm chains position. In this case, 
FA fragments from sn2 are at least 3 times more intense than LPCo from sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPCopos'>Plasmanyl Phosphocholines (PCo) annotation for ESI+</h2><span id='topic+idPCopos'></span>

<h3>Description</h3>

<p>PCo identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPCopos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(104.1075, 184.0739, 183.06604),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "NL"),
  chainfrags_sn1 = c("lysopco_M+H", "lysopco_M+H-H2O"),
  chainfrags_sn2 = c("lysopc_M+H", "lysopc_M+H-H2O", ""),
  intrules = c("lysopco_sn1/lysopc_sn2"),
  rates = c("2/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPCopos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PC in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPCopos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPCopos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PCo as M+H and M+Na. 2) Search of PC class
fragments: 104.1075, 184.0739 and neutral loss of 183.06604 coeluting with
the precursor ion. 3) Search of specific fragments that inform about chain
composition in sn1 (LPCo as M+H or M+H-H2O resulting from the loss of the
FA chain at sn2) and sn2 (LPC as M+H-H2O resulting from the loss of
the FA chain at sn1 or the difference between precursor and sn1 chain
fragments). 4) Look for possible chains structure based on the combination of
chain fragments. 5) Check intensity rules to confirm chains position. In this
case, LPCo from sn1 is at least twice more intense than LPC from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCopos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPCpneg'>Plasmenyl Phosphocholines (PCp) annotation for ESI-</h2><span id='topic+idPCpneg'></span>

<h3>Description</h3>

<p>PCp identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPCpneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+CH3COO", "M-CH3", "M+CH3COO-CH3"),
  clfrags = c(168.0426, 224.0688, "pcp_M-CH3"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  chainfrags_sn1 = c("lysopcp_M-CH3", "lysopcp_M-CH3-H2O"),
  chainfrags_sn2 = c("fa_M-H", "fa_M-CO2-H"),
  intrules = c("lysopcp_sn1/fa_sn2"),
  rates = c(1/3),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPCpneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PCp in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPCpneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPCpneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PCp as M+CH3COO, M-CH3 or M+CH3COO-CH3. To avoid
incorrect annotations of PEp as PCp, candidates which are present just as M-CH3
will be ignored. 2) Search of PCp class fragments: 168.0426, 224.0688 or loss
of CH3 coeluting with the precursor ion. 3) Search of specific fragments that
inform about chain composition in sn1 (LPCp as M-CH3 and M-CH3-H2O resulting 
from the loss of the FA chain at sn2) and sn2 (FA as M-H and M-CO2-H). 
4) Look for possible chains structure based on the  combination of chain 
fragments. 5) Check intensity rules to confirm chains position. In this case, 
FA fragments from sn2 are at least 3 times more intense than LPCp from sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCpneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPCpos'>Phosphocholines (PC) annotation for ESI+</h2><span id='topic+idPCpos'></span>

<h3>Description</h3>

<p>PC identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPCpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(104.1075, 184.0739, 183.06604),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "NL"),
  chainfrags_sn1 = c("lysopc_M+H", "lysopc_M+H-H2O"),
  chainfrags_sn2 = c("lysopc_M+H", "lysopc_M+H-H2O", ""),
  intrules = c("lysopc_sn1/lysopc_sn2"),
  rates = c("2/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPCpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PC in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPCpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPCpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PC as M+H and M+Na. 2) Search of PC class
fragments: 104.1075, 184.0739 and neutral loss of 183.06604 coeluting with
the precursor ion. 3) Search of specific fragments that inform about chain
composition in sn1 (lysoPC as M+H or M+H-H2O resulting from the loss of the
FA chain at sn2) and sn2 (lysoPC as M+H or M+H-H2O resulting from the loss of
the FA chain at sn1 or the difference between precursor and sn1 chain
fragments). 4) Look for possible chains structure based on the combination of
chain fragments. 5) Check intensity rules to confirm chains position. In this
case, lysoPC from sn1 is at least twice more intense than lysoPC from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPCppos'>Plasmenyl Phosphocholines (PCp) annotation for ESI+</h2><span id='topic+idPCppos'></span>

<h3>Description</h3>

<p>PCp identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPCppos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(104.1075, 184.0739, 183.06604),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "NL"),
  chainfrags_sn1 = c("lysopcp_M+H", "lysopcp_M+H-H2O"),
  chainfrags_sn2 = c("lysopc_M+H-H2O", ""),
  intrules = c("lysopcp_sn1/lysopc_sn2"),
  rates = c("1/2"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPCppos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PC in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPCppos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPCppos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PC as M+H and M+Na. 2) Search of PC class
fragments: 104.1075, 184.0739 and neutral loss of 183.06604 coeluting with
the precursor ion. 3) Search of specific fragments that inform about chain
composition in sn1 (LPCp as M+H or M+H-H2O resulting from the loss of the
FA chain at sn2) and sn2 (LPC as M+H-H2O resulting from the loss of
the FA chain at sn1 or the difference between precursor and sn1 chain
fragments). 4) Look for possible chains structure based on the combination of
chain fragments. 5) Check intensity rules to confirm chains position. In this
case, LPC from sn2 is at least twice more intense than LPCo from sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPCppos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEneg'>Phosphoethanolamines (PE) annotation for ESI-</h2><span id='topic+idPEneg'></span>

<h3>Description</h3>

<p>PE identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  rt,
  adducts = c("M-H"),
  clfrags = c(140.0118, 196.038, 214.048, "pe_M-CH3"),
  clrequired = c(F, F, F, "excluding"),
  ftype = c("F", "F", "F", "BB"),
  chainfrags_sn1 = c("lysope_M-H"),
  chainfrags_sn2 = c("lysope_M-H", "fa_M-H"),
  intrules = c("lysope_sn1/lysope_sn2"),
  rates = c("3/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PE as M-H. 2) Search of PE class fragments:
140.0115, 196.038, 214.048 ion coeluting with the precursor ion. If a loss of
CH3 group is found coeluting with any candidate, this will be excluded as it
is a characteristic fragment of PC. 3) Search of specific fragments that
inform about chain composition in sn1 (lysoPE as M-H resulting from the loss
of the FA chain at sn2) and sn2 (lysoPE as M-H resulting from the loss
of the FA chain at sn1 or FA chain as M-H). 4) Look for possible
chains structure based on the combination of chain fragments. 5) Check
intensity rules to confirm chains position. In this case, lysoPE from sn1 is
at least 3 times more intense than lysoPE from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEoneg'>Plasmanyl Phosphoethanolamines (PEo) annotation for ESI-</h2><span id='topic+idPEoneg'></span>

<h3>Description</h3>

<p>PEo identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEoneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  rt,
  adducts = c("M-H", "M+NaCH3COO"),
  clfrags = c(140.0118, 196.038, 214.048, "peo_M-CH3"),
  clrequired = c(F, F, F, "excluding"),
  ftype = c("F", "F", "F", "BB"),
  chainfrags_sn1 = c("lysopeo_M-H", "lysopeo_M-H-H2O"),
  chainfrags_sn2 = c("fa_M-H"),
  intrules = c("lysopeo_sn1/fa_sn2"),
  rates = c(1/3),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEoneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PEo in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEoneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEoneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PEo as M-H and M+NaCH3COO. 2) Search 
of PEo class fragments: 140.0115, 196.038, 214.048 ion coeluting with the 
precursor ion. If a loss of CH3 group is found coeluting with any candidate, 
this will be excluded as it is a characteristic fragment of PCo. 3) Search of 
specific fragments that inform about chain composition in sn1 (lysoPEo as M-H 
and M-H-H2O resulting from the loss of the FA chain at sn2) and sn2 (FA chain 
as M-H). 4) Look for possible chains structure based on the combination of 
chain fragments. 5) Check intensity rules to confirm chains position. In this 
case, FA fragments from sn2 are at least 3 times more intense than LPEo from 
sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEoneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEopos'>Plasmanyl Phosphoethanolamines (PEo) annotation for ESI+</h2><span id='topic+idPEopos'></span>

<h3>Description</h3>

<p>PEo identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEopos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(141.0193),
  clrequired = c(F),
  ftype = c("NL"),
  chainfrags_sn1 = c("lysopeo_M+H", "lysopeo_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O"),
  intrules = c("lysopeo_sn1/mg_sn2"),
  rates = c("2/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEopos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See
<a href="#topic+createLipidDB">createLipidDB</a> and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEopos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEopos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PE as M+H and M+Na. 2) Search of PE class
fragments: loss of head group (NL of 141.0193) coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (LPEo as M+H or M+H-H2O resulting from the loss of the FA chain at sn2)
and sn2 (MG as M+H-H2O resulting just from the loss of the head group and the 
FA chain at sn1). 4) Look for possible chains structure based on the
combination of chain fragments. 5) Check intensity rules to confirm chains
position. LPEo from sn1 is at least 2 times more intense than MG from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEopos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEpneg'>Plasmenyl Phosphoethanolamines (PEp) annotation for ESI-</h2><span id='topic+idPEpneg'></span>

<h3>Description</h3>

<p>PEp identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEpneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  rt,
  adducts = c("M-H", "M+NaCH3COO"),
  clfrags = c(140.0118, 196.038, 214.048, "pep_M-CH3"),
  clrequired = c(F, F, F, "excluding"),
  ftype = c("F", "F", "F", "BB"),
  chainfrags_sn1 = c("lysopep_M-H", "lysopep_M-H-H2O"),
  chainfrags_sn2 = c("fa_M-H"),
  intrules = c("lysopep_sn1/fa_sn2"),
  rates = c(1/3),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEpneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PEp in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEpneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEpneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PEp as M-H and M+NaCH3COO. 2) Search 
of PEp class fragments: 140.0115, 196.038, 214.048 ion coeluting with the 
precursor ion. If a loss of CH3 group is found coeluting with any candidate, 
this will be excluded as it is a characteristic fragment of PCp. 3) Search of 
specific fragments that inform about chain composition in sn1 (lysoPEp as M-H 
and M-H-H2O resulting from the loss of the FA chain at sn2) and sn2 (FA chain 
as M-H). 4) Look for possible chains structure based on the combination of 
chain fragments. 5) Check intensity rules to confirm chains position. In this 
case, FA fragments from sn2 are at least 3 times more intense than LPEp from 
sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEoneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEpos'>Phosphoethanolamines (PE) annotation for ESI+</h2><span id='topic+idPEpos'></span>

<h3>Description</h3>

<p>PE identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c("dg_M+H-H2O"),
  clrequired = c(F),
  ftype = c("BB"),
  chainfrags_sn1 = c("lysope_M+H-H2O", "mg_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O"),
  intrules = c("lysope_sn1/lysope_sn1", "mg_sn1/mg_sn2"),
  rates = c("3/1", "1/2"),
  intrequired = c(F, F),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See
<a href="#topic+createLipidDB">createLipidDB</a> and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PE as M+H and M+Na. 2) Search of PE class
fragments: loss of head group (DG as M+H-H2O) coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (MG as M+H-H2O resulting from the loss of the FA chain at sn2 and
the head group or LPE as M+H-H2O resulting just from the loss of the FA chain)
and sn2 (MG as M+H-H2O resulting from the loss of the head group and FA chain 
from sn2). 4) Look for possible chains structure based on the combination of 
chain fragments. 5) Check intensity rules to confirm chains position. 
LPE or MG from sn1 is at least 3 times more intense than the ones from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPEppos'>Plasmenyl Phosphoethanolamines (PEp) annotation for ESI+</h2><span id='topic+idPEppos'></span>

<h3>Description</h3>

<p>PEp identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPEppos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(140.012),
  clrequired = c(F),
  ftype = c("NL"),
  chainfrags_sn1 = c("lysopep_M+H", "lysopep_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O"),
  intrules = c("lysopep_sn1/mg_sn2"),
  rates = c("1/3"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPEppos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See
<a href="#topic+createLipidDB">createLipidDB</a> and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPEppos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPEppos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PE as M+H and M+Na. 2) Search of PE class
fragments: loss of head group (NL of 140.012) coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (LPEp as M+H or M+H-H2O resulting from the loss of the FA chain at sn2)
and sn2 (MG as M+H-H2O from sn2 resulting from the loss of the FA chain at sn1). 
4) Look for possible chains structure based on the combination of chain 
fragments. 5) Check intensity rules to confirm chains position. MG from sn2 
is at least 3 times more intense than LPEp from sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPEppos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPGneg'>Phosphoglycerols (PG) annotation for ESI-</h2><span id='topic+idPGneg'></span>

<h3>Description</h3>

<p>PG identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPGneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(152.9958, 227.0326, 209.022, 74.0359),
  clrequired = c(F, F, F, F),
  ftype = c("F", "F", "F", "NL"),
  chainfrags_sn1 = c("lysopg_M-H"),
  chainfrags_sn2 = c("lysopg_M-H", "fa_M-H"),
  intrules = c("lysopg_sn1/lysopg_sn2"),
  rates = c("2/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPGneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PG in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPGneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPGneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PG as M-H. 2) Search of PG class fragments:
152.9958, 227.0326, 209.022 and neutral loss of 74.0359 coeluting with the
precursor ion. 3) Search of specific fragments that inform about chain
composition at sn1 (lysoPG as M-H resulting from the loss of the FA chain
at sn2) and sn2 (lysoPG as M-H resulting from the loss of the FA chain
at sn1 or FA chain as M-H). 4) Look for possible chains structure
based on the combination of chain fragments. 5) Check intensity rules to
confirm chains position. In this case, lysoPG from sn1 is at least 3 times
more intense than lysoPG from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPGneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPGpos'>Phosphoglycerols (PG) annotation for ESI+</h2><span id='topic+idPGpos'></span>

<h3>Description</h3>

<p>PG identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPGpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+NH4", "M+Na"),
  clfrags = c("dg_M+H-H2O"),
  clrequired = c(F),
  ftype = c("BB"),
  chainfrags_sn1 = c("mg_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O"),
  intrules = c("mg_sn1/mg_sn2"),
  rates = c("1/2"),
  intrequired = c(F),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPGpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See
<a href="#topic+createLipidDB">createLipidDB</a> and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPGpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPGpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PG as M+H, M+NH4 and M+Na. 2) Search of PG class
fragments: loss of head group (DG as M+H-H2O) coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (MG as M+H-H2O resulting from the loss of the FA chain at sn2)
and sn2 (MG as M+H-H2O resulting from the loss of the FA chain at sn1).
4) Look for possible chains structure based on the combination of chain
fragments. 5) Check intensity rules to confirm chains position. MG from sn2
is at least twice more intense than the one from sn1.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPGpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPIneg'>Phosphoinositols (PI) annotation for ESI-</h2><span id='topic+idPIneg'></span>

<h3>Description</h3>

<p>PI identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPIneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(241.0115, 223.0008, 259.0219, 297.0375),
  clrequired = c(F, F, F, F),
  ftype = c("F", "F", "F", "F"),
  chainfrags_sn1 = c("lysopi_M-H", "lysopa_M-H"),
  chainfrags_sn2 = c("lysopi_M-H", "lysopa_M-H", "fa_M-H"),
  intrules = c("lysopi_sn1/lysopi_sn2", "lysopa_sn1/lysopa_sn2"),
  rates = c("3/1", "3/1"),
  intrequired = c(F, F),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPIneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PI in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPIneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPIneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PI as M-H. 2) Search of PI class fragments:
241.0115, 223.0008, 259.0219 and 297.0375 coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (lysoPI as M-H resulting from the loss of the FA chain at sn2 or lysoPA
as M-H if it also losses the head group) and sn2 (lysoPI or lysoPA as M-H
resulting from the loss of the FA chain at sn1 or FA chain as M-H). 4) Look
for possible chains structure based on the combination of chain fragments.
5) Check intensity rules to confirm chains position. In this case, lysoPI or
lysoPA from sn1 is at least 3 times more intense than lysoPI or lysoPA from
sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPIneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPIpos'>Phosphoinositols (PI) annotation for ESI+</h2><span id='topic+idPIpos'></span>

<h3>Description</h3>

<p>PI identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPIpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+NH4", "M+Na"),
  clfrags = c("dg_M+H-H2O"),
  clrequired = c(F),
  ftype = c("BB"),
  chainfrags_sn1 = c("mg_M+H-H2O", "lysopi_M+H-H2O"),
  chainfrags_sn2 = c("mg_M+H-H2O", "lysopi_M+H-H2O"),
  intrules = c("mg_sn1/mg_sn2", "lysopi_sn1/lysopi_sn2"),
  rates = c("2/1", "2/1"),
  intrequired = c(F, F),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPIpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PE in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See
<a href="#topic+createLipidDB">createLipidDB</a> and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPIpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPIpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate PI as M+H, M+NH4 and M+Na. 2) Search of PI class
fragments: loss of head group (DG as M+H-H2O) coeluting with the precursor
ion. 3) Search of specific fragments that inform about chain composition at
sn1 (MG as M+H-H2O or LPI as M+H-H2O resulting from the loss of the FA chain 
at sn2) and sn2 (MG as M+H-H2O or LPI as M+H-H2O resulting from the loss of 
the FA chain at sn1). 4) Look for possible chains structure based on the 
combination of chain fragments. 5) Check intensity rules to confirm chains 
position. MG or LPI from sn1 are at least twice more intense than the ones 
from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPIpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPOS'>Lipids annotation for ESI+</h2><span id='topic+idPOS'></span>

<h3>Description</h3>

<p>Lipids annotation based on fragmentation patterns for LC-MS/MS DIA or DDA data
acquired in positive mode. This function compiles all functions written for
ESI+ annotations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPOS(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 5,
  coelCutoff = 0.8,
  lipidClasses = c("MG", "LPC", "LPE", "PC", "PCo", "PCp", "PE", "PEo", "PEp", "PG",
    "PI", "Sph", "SphP", "Cer", "AcylCer", "CerP", "SM", "Carnitines", "CE", "DG", "TG"),
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPOS_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 5 seconds.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_lipidclasses">lipidClasses</code></td>
<td>
<p>classes of interest to run the identification functions.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPOS_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification); and the annotatedPeaklist element shows the original 
MS1 peaklist with the annotations on it.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPOS(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idPSneg'>Phosphoserines (PS) annotation for ESI-</h2><span id='topic+idPSneg'></span>

<h3>Description</h3>

<p>PS identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idPSneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H", "M+Na-2H"),
  clfrags = c(87.032, 152.9958),
  clrequired = c(F, F),
  ftype = c("NL", "F"),
  chainfrags_sn1 = c("lysopa_M-H", "lysopa_M-H-H2O"),
  chainfrags_sn2 = c("lysopa_M-H", "lysopa_M-H-H2O", "fa_M-H"),
  intrules = c("lysopa_sn1/lysopa_sn2"),
  rates = c("3/1"),
  intrequired = c(T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idPSneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PS in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idPSneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idPSneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate PS as M-H or M+Na-2H. 2) Search of PS class
fragments: neutral loss of 87.032 (serine) coeluting with the precursor ion.
3) Search of specific fragments that inform about chain composition at sn1
(lysoPA as M-H or M-H-H2O resulting from the loss of the FA chain at sn2 and
the head group) and sn2 (lysoPA as M-H or M-H-H2O resulting from the loss of
the FA chain at sn1 and the head group or FA chain as M-H). 4) Look for
possible chains structure based on the combination of chain fragments.
5) Check intensity rules to confirm chains position. In this case, lysoPA
from sn1 is at least 3 times more intense than lysoPA from sn2.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idPSneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSMneg'>Sphingomyelines (SM) annotation for ESI-</h2><span id='topic+idSMneg'></span>

<h3>Description</h3>

<p>SM identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSMneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+CH3COO", "M-CH3", "M+CH3COO-CH3"),
  clfrags = c(168.0426, 224.0688, "sm_M-CH3"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  chainfrags_sn1 = c("sph_Mn+150.032"),
  chainfrags_sn2 = c("fa_Mn-1.9918", ""),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSMneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for PC in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSMneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSMneg</code> function involves 5 steps. 1) FullMS-based
identification of candidate SM as M+CH3COO, M-CH3 or M+CH3COO-CH3. 2) Search 
of SM class fragments: 168.0426, 224.0688 or loss of CH3 coeluting with the 
precursor ion. 3) Search of specific fragments that inform about chain 
composition in sn1 (Sph+phosphocholine as M-CH3-H2O which results in a mass 
difference of Sph+150.032) and sn2 (difference between precursor and sn1 chain
fragments). 4) Look for possible chains structure based on the
combination of chain fragments. 5) Check intensity rules to confirm chains 
position. In this case, there are no intensity rules by default.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSMneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSMpos'>Sphyngomyelines (SM) annotation for ESI+</h2><span id='topic+idSMpos'></span>

<h3>Description</h3>

<p>SM identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSMpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H", "M+Na"),
  clfrags = c(104.1075, 184.0739, 183.06604),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "NL"),
  chainfrags_sn1 = c("sph_M+H-2H2O"),
  chainfrags_sn2 = c(""),
  intrules = c(),
  rates = c(),
  intrequired = c(),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSMpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for SM in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSMpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSMpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate SM as M+H and M+Na. 2) Search of SM class
fragments: 104.1075, 184.0739 and neutral loss of 183.06604 coeluting with
the precursor ion. 3) Search of specific fragments that inform about the
composition of the sphingoid base (Sph as M+H-2H2O resulting from the loss of
the FA chain) and the FA chain (by default it is calculated using the
difference between precursor and sph chain fragments). 4) Look for possible
chains structure based on the combination of chain fragments. 5) Check
intensity rules to confirm chains position. In this case, there are no
intensity rules by default as FA chain is unlikely to be detected.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSMpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSphneg'>Sphingoid bases (Sph) annotation for ESI-</h2><span id='topic+idSphneg'></span>

<h3>Description</h3>

<p>Sph identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSphneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c("sph_M-H-H2O", "sph_M-H-2H2O"),
  clrequired = c(F, F),
  ftype = c("BB", "BB"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSphneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Sph in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSphneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSphneg</code> function involves 2 steps. 1) FullMS-based
identification of candidate Sph as M-H. 2) Search of Sph class fragments:
neutral loss of 1 or 2 H2O molecules.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as Sph only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSphneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSphPneg'>Sphingoid bases phosphate (SphP) annotation for ESI-</h2><span id='topic+idSphPneg'></span>

<h3>Description</h3>

<p>SphP identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in negative mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSphPneg(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M-H"),
  clfrags = c(78.9585, 96.9691, "sphP_M-H-H2O"),
  clrequired = c(F, F, F),
  ftype = c("F", "F", "BB"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSphPneg_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for SphP in ESI-. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSphPneg_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSphpos</code> function involves 2 steps. 1) FullMS-based
identification of candidate SphP as M-H. 2) Search of SphP class fragments:
78.9585, 96.969 or neutral loss of 1 H2O molecule.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as SphP only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been writen based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSphPneg(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSphpos'>Sphingoid bases (Sph) annotation for ESI-</h2><span id='topic+idSphpos'></span>

<h3>Description</h3>

<p>Sph identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSphpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H"),
  clfrags = c("sph_M+H-H2O", "sph_M+H-2H2O"),
  clrequired = c(F, F),
  ftype = c("BB", "BB"),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSphpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursors and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_rt">rt</code></td>
<td>
<p>rt window where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Sph in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSphpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSphpos</code> function involves 2 steps. 1) FullMS-based
identification of candidate Sph as M+H. 2) Search of Sph class fragments:
neutral loss of 1 or 2 H2O molecules.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as Sph only have one chain, only Subclass and FA level are possible)
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSphpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idSphPpos'>Sphingoid bases phosphate (SphP) annotation for ESI+</h2><span id='topic+idSphPpos'></span>

<h3>Description</h3>

<p>SphP identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idSphPpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+H"),
  clfrags = c("sphP_M+H-H2O", "sphP_M+H-2H2O", "sphP_M+H-H2O-NH4"),
  clrequired = c(F, F, F),
  ftype = c("BB", "BB", "BB"),
  coelCutoff = 0.7,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idSphPpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursors and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_rt">rt</code></td>
<td>
<p>rt window where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for Sph in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idSphPpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idSphPpos</code> function involves 2 steps. 1) FullMS-based
identification of candidate SphP as M+H. 2) Search of SphP class fragments:
neutral loss of 1 or 2 H2O molecules, or H2O and NH4.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (in this
case, as SphP only have one chain, only Subclass and FA level are possible).
and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idSphPpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='idTGpos'>Triacylglycerols (TG) annotation for ESI+</h2><span id='topic+idTGpos'></span>

<h3>Description</h3>

<p>TG identification based on fragmentation patterns for LC-MS/MS DIA or DDA
data acquired in positive mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idTGpos(
  msobject,
  ppm_precursor = 5,
  ppm_products = 10,
  rttol = 3,
  rt,
  adducts = c("M+NH4", "M+Na"),
  clfrags = c(),
  clrequired = c(),
  ftype = c(),
  chainfrags_sn1 = c("cbdiff-dg_M+H-H2O"),
  chainfrags_sn2 = c("cbdiff-dg_M+H-H2O"),
  chainfrags_sn3 = c("cbdiff-dg_M+H-H2O"),
  intrules = c("cbdiff-dg_sn2/cbdiff-dg_sn1", "cbdiff-dg_sn2/cbdiff-dg_sn3",
    "cbdiff-dg_sn1/cbdiff-dg_sn3"),
  rates = c("1", "1", "1"),
  intrequired = c(T, T, T),
  coelCutoff = 0.8,
  dbs,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idTGpos_+3A_msobject">msobject</code></td>
<td>
<p>an msobject returned by <a href="#topic+dataProcessing">dataProcessing</a>.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_ppm_precursor">ppm_precursor</code></td>
<td>
<p>mass tolerance for precursor ions. By default, 5 ppm.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_ppm_products">ppm_products</code></td>
<td>
<p>mass tolerance for product ions. By default, 10 ppm.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_rttol">rttol</code></td>
<td>
<p>total rt window for coelution between precursor and product
ions. By default, 3 seconds.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_rt">rt</code></td>
<td>
<p>rt range where the function will look for candidates. By default,
it will search within all RT range in MS1.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_adducts">adducts</code></td>
<td>
<p>expected adducts for TG in ESI+. Adducts allowed can
be modified in adductsTable (dbs argument).</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_clrequired">clrequired</code></td>
<td>
<p>logical vector indicating if each class fragment is
required or not. If any of them is required, at least one of them must be
present within the coeluting fragments. See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_ftype">ftype</code></td>
<td>
<p>character vector indicating the type of fragments in clfrags.
It can be: &quot;F&quot; (fragment), &quot;NL&quot; (neutral loss) or &quot;BB&quot; (building block).
See <a href="#topic+checkClass">checkClass</a> for details.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_chainfrags_sn1">chainfrags_sn1</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn1 position. See <a href="#topic+chainFrags">chainFrags</a> for details.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_chainfrags_sn2">chainfrags_sn2</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn2 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn1 chains.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_chainfrags_sn3">chainfrags_sn3</code></td>
<td>
<p>character vector containing the fragmentation rules for
the chain fragments in sn3 position. See <a href="#topic+chainFrags">chainFrags</a> for details. If
empty, it will be estimated based on the difference between precursors and
sn2 chains.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>. If some intensity rules should be employed to
identify the chains position but they are't known yet, use &quot;Unknown&quot;. If it
isn't required, leave an empty vector.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_rates">rates</code></td>
<td>
<p>character vector with the expected rates between fragments given
as a string (e.g. &quot;3/1&quot;). See <a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_intrequired">intrequired</code></td>
<td>
<p>logical vector indicating if any of the rules is required.
If not, at least one must be verified to confirm the structure.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between parent and fragment ions.
Only applied if rawData info is supplied. By default, 0.8.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
<tr><td><code id="idTGpos_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idTGpos</code> function involves 5 steps. 1) FullMS-based
identification of candidate TG as M+NH4 and M+Na. 2) Search of TG class
fragments: there are no class fragment by default. 3) Search of specific
fragments that inform about the FA chains: DGs resulting from the loss of FA
chains as M+H-H2O.  4) Look for possible chains structure based on the
combination of chain fragments. 5) Check intensity rules to confirm chains
position. In the case of TG, DG resulting from the loss of sn2 if the most
intense, followed by the loss of sn1 and sn3, but this FA position level
still needs to be improved due to the high level of coelution for TG.
</p>
<p>Results data frame shows: ID, lipid class, CDB (total number
of carbons and double bounds), FA composition (specific chains composition if
it has been confirmed), mz, RT (in seconds), I (intensity, which comes
directly from de input), Adducts, ppm (mz error), confidenceLevel (Subclass,
FA level, where chains are known but not their positions, or FA position
level) and Score (parent-fragment coelution score mean in DIA data or relative 
sum intensity in DDA of all fragments used for the identification).
</p>


<h3>Value</h3>

<p>annotated msobject (list with several elements). The results element
is a data frame that shows: ID, lipid class, CDB (total number of carbons
and double bounds), FA composition (specific chains composition if it has
been confirmed), mz, RT (in seconds), I (intensity), Adducts, ppm (mz error),
confidenceLevel (Subclass, FA level, where chains are known but not their
positions, or FA position level), peakID, and Score (parent-fragment coelution 
score mean in DIA data or relative sum intensity in DDA of all fragments used 
for the identification).
</p>


<h3>Note</h3>

<p>This function has been written based on fragmentation patterns
observed for three different platforms (QTOF 6550 from Agilent, Synapt G2-Si
from Waters and Q-exactive from Thermo), but it may need to be customized for
other platforms or acquisition settings.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msobject &lt;- idTGpos(msobject)

## End(Not run)

</code></pre>

<hr>
<h2 id='indexrtpart'>Index partitions or clusters assigned during alignment.</h2><span id='topic+indexrtpart'></span>

<h3>Description</h3>

<p>Index partitions or clusters assigned during alignment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indexrtpart(peaks, part, minsamples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indexrtpart_+3A_peaks">peaks</code></td>
<td>
<p>peaks obtained using <a href="#topic+getallpeaks">getallpeaks</a>.</p>
</td></tr>
<tr><td><code id="indexrtpart_+3A_part">part</code></td>
<td>
<p>numeric vector with the partition/cluster assigned to each peak.</p>
</td></tr>
<tr><td><code id="indexrtpart_+3A_minsamples">minsamples</code></td>
<td>
<p>minimum number of samples represented in each partition.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two elements: index and vector with the assigned partitions.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='joinAnnotationResults'>Summarize annotation results from an msbatch into the features table</h2><span id='topic+joinAnnotationResults'></span>

<h3>Description</h3>

<p>Summarize annotation results from an msbatch into the features table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joinAnnotationResults(msbatch, simplifyAnnotations = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joinAnnotationResults_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch</p>
</td></tr>
<tr><td><code id="joinAnnotationResults_+3A_simplifyannotations">simplifyAnnotations</code></td>
<td>
<p>logical. If TRUE, only the most frequent id will be 
kept (recommended when only pool samples have been acquired in DIA or DDA). If 
FALSE, all annotations will be shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='joinfrags'>Join fragments information when several peaks of the same fragment are
coeluting with a unique candidate</h2><span id='topic+joinfrags'></span>

<h3>Description</h3>

<p>Function employed by <a href="#topic+frags">frags</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joinfrags(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joinfrags_+3A_df">df</code></td>
<td>
<p>data frame containing coeluting fragments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='LipidMSapp'>LipidMS shiny app</h2><span id='topic+LipidMSapp'></span>

<h3>Description</h3>

<p>Interactive UI for LipidMS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LipidMSapp()
</code></pre>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# example data files can be download from github.com/maialba3/LipidMSv2.0_exampleFiles

library(LipidMS)
LipidMSapp()

## End(Not run)

</code></pre>

<hr>
<h2 id='lysopadb'>
LPAs database
</h2><span id='topic+lysopadb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopadb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopaodb'>
O-LPA database
</h2><span id='topic+lysopaodb'></span>

<h3>Description</h3>

<p>In silico generated database for common O-LPA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopaodb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopcdb'>
LPCs database
</h2><span id='topic+lysopcdb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPCs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopcdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopcodb'>
O-LPC database
</h2><span id='topic+lysopcodb'></span>

<h3>Description</h3>

<p>In silico generated database for common O-LPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopcodb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopcpdb'>
P-LPC database
</h2><span id='topic+lysopcpdb'></span>

<h3>Description</h3>

<p>In silico generated database for common P-LPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopcpdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopedb'>
LPEs database
</h2><span id='topic+lysopedb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopedb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopeodb'>
O-LPE database
</h2><span id='topic+lysopeodb'></span>

<h3>Description</h3>

<p>In silico generated database for common O-LPE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopeodb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopepdb'>
P-LPE database
</h2><span id='topic+lysopepdb'></span>

<h3>Description</h3>

<p>In silico generated database for common P-LPE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopepdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopgdb'>
LPGs database
</h2><span id='topic+lysopgdb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPGs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopgdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopidb'>
LPIs database
</h2><span id='topic+lysopidb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopidb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='lysopsdb'>
LPSs database
</h2><span id='topic+lysopsdb'></span>

<h3>Description</h3>

<p>In silico generated database for common LPSs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lysopsdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='MassAcylCer'>Calculate formula and mass of acylceramides</h2><span id='topic+MassAcylCer'></span>

<h3>Description</h3>

<p>Calculate formula and mass of acylceramides
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassAcylCer(acylcer)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassAcylCer_+3A_acylcer">acylcer</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassCarnitines'>Calculate formula and mass of carnitines</h2><span id='topic+MassCarnitines'></span>

<h3>Description</h3>

<p>Calculate formula and mass of carnitines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassCarnitines(carnitine)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassCarnitines_+3A_carnitine">carnitine</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassCE'>Calculate formula and mass of cholesterol esthers</h2><span id='topic+MassCE'></span>

<h3>Description</h3>

<p>Calculate formula and mass of cholesterol esthers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassCE(CE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassCE_+3A_ce">CE</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassCer'>Calculate formula and mass of ceramides</h2><span id='topic+MassCer'></span>

<h3>Description</h3>

<p>Calculate formula and mass of ceramides
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassCer(cer)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassCer_+3A_cer">cer</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassCerP'>Calculate formula and mass of ceramides phosphate</h2><span id='topic+MassCerP'></span>

<h3>Description</h3>

<p>Calculate formula and mass of ceramides phosphate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassCerP(cerP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassCerP_+3A_cerp">cerP</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassCL'>Calculate formula and mass of CL</h2><span id='topic+MassCL'></span>

<h3>Description</h3>

<p>Calculate formula and mass of CL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassCL(CL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassCL_+3A_cl">CL</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassDG'>Calculate formula and mass of DG</h2><span id='topic+MassDG'></span>

<h3>Description</h3>

<p>Calculate formula and mass of DG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassDG(DG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassDG_+3A_dg">DG</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassFA'>Calculate formula and mass of fatty acids</h2><span id='topic+MassFA'></span>

<h3>Description</h3>

<p>Calculate formula and mass of fatty acids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassFA(FA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassFA_+3A_fa">FA</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassFAHFA'>Calculate formula and mass of FAHFA</h2><span id='topic+MassFAHFA'></span>

<h3>Description</h3>

<p>Calculate formula and mass of FAHFA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassFAHFA(FAHFA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassFAHFA_+3A_fahfa">FAHFA</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassGlcCer'>Calculate formula and mass of glucoceramides</h2><span id='topic+MassGlcCer'></span>

<h3>Description</h3>

<p>Calculate formula and mass of glucoceramides
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassGlcCer(glccer)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassGlcCer_+3A_glccer">glccer</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassHFA'>Calculate formula and mass of hydroxi fatty acids</h2><span id='topic+MassHFA'></span>

<h3>Description</h3>

<p>Calculate formula and mass of hydroxi fatty acids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassHFA(HFA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassHFA_+3A_hfa">HFA</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPA'>Calculate formula and mass of LPA</h2><span id='topic+MassLysoPA'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPA(LPA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPA_+3A_lpa">LPA</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPAo'>Calculate formula and mass of LPAo</h2><span id='topic+MassLysoPAo'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPAo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPAo(LPAo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPAo_+3A_lpao">LPAo</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPC'>Calculate formula and mass of LysoPC</h2><span id='topic+MassLysoPC'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LysoPC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPC(LPC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPC_+3A_lpc">LPC</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPCo'>Calculate formula and mass of LysoPCo</h2><span id='topic+MassLysoPCo'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LysoPCo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPCo(LPCo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPCo_+3A_lpco">LPCo</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPCp'>Calculate formula and mass of LysoPCp</h2><span id='topic+MassLysoPCp'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LysoPCp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPCp(LPCp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPCp_+3A_lpcp">LPCp</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPE'>Calculate formula and mass of LPE</h2><span id='topic+MassLysoPE'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPE(LPE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPE_+3A_lpe">LPE</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPEo'>Calculate formula and mass of LPEo</h2><span id='topic+MassLysoPEo'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPEo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPEo(LPEo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPEo_+3A_lpeo">LPEo</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPEp'>Calculate formula and mass of LPEp</h2><span id='topic+MassLysoPEp'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPEp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPEp(LPEp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPEp_+3A_lpep">LPEp</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPG'>Calculate formula and mass of LPG</h2><span id='topic+MassLysoPG'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPG(LPG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPG_+3A_lpg">LPG</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPI'>Calculate formula and mass of LPI</h2><span id='topic+MassLysoPI'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LPI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPI(LPI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPI_+3A_lpi">LPI</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassLysoPS'>Calculate formula and mass of LysoPS</h2><span id='topic+MassLysoPS'></span>

<h3>Description</h3>

<p>Calculate formula and mass of LysoPS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassLysoPS(LPS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassLysoPS_+3A_lps">LPS</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassMG'>Calculate formula and mass of MG</h2><span id='topic+MassMG'></span>

<h3>Description</h3>

<p>Calculate formula and mass of MG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassMG(MG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassMG_+3A_mg">MG</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPA'>Calculate formula and mass of PA</h2><span id='topic+MassPA'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPA(PA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPA_+3A_pa">PA</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPC'>Calculate formula and mass of PC</h2><span id='topic+MassPC'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPC(PC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPC_+3A_pc">PC</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPCo'>Calculate formula and mass of PCo</h2><span id='topic+MassPCo'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PCo
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPCo(PCo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPCo_+3A_pco">PCo</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPCp'>Calculate formula and mass of PCp</h2><span id='topic+MassPCp'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PCp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPCp(PCp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPCp_+3A_pcp">PCp</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPE'>Calculate formula and mass of PE</h2><span id='topic+MassPE'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPE(PE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPE_+3A_pe">PE</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPEo'>Calculate formula and mass of plasmanyl PE</h2><span id='topic+MassPEo'></span>

<h3>Description</h3>

<p>Calculate formula and mass of plasmanyl PE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPEo(PEo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPEo_+3A_peo">PEo</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPEp'>Calculate formula and mass of plasmenyl PE</h2><span id='topic+MassPEp'></span>

<h3>Description</h3>

<p>Calculate formula and mass of plasmenyl PE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPEp(PEp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPEp_+3A_pep">PEp</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPG'>Calculate formula and mass of PG</h2><span id='topic+MassPG'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPG(PG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPG_+3A_pg">PG</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPI'>Calculate formula and mass of PI</h2><span id='topic+MassPI'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPI(PI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPI_+3A_pi">PI</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPIP'>Calculate formula and mass of PIP</h2><span id='topic+MassPIP'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PIP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPIP(PIP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPIP_+3A_pip">PIP</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPIP2'>Calculate formula and mass of PIP2</h2><span id='topic+MassPIP2'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PIP2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPIP2(PIP2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPIP2_+3A_pip2">PIP2</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPIP3'>Calculate formula and mass of PIP3</h2><span id='topic+MassPIP3'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PIP3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPIP3(PIP3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPIP3_+3A_pip3">PIP3</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassPS'>Calculate formula and mass of PS</h2><span id='topic+MassPS'></span>

<h3>Description</h3>

<p>Calculate formula and mass of PS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassPS(PS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassPS_+3A_ps">PS</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassSM'>Calculate formula and mass of sphingomyelines</h2><span id='topic+MassSM'></span>

<h3>Description</h3>

<p>Calculate formula and mass of sphingomyelines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassSM(SM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassSM_+3A_sm">SM</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassSph'>Calculate formula and mass of sphingoid bases</h2><span id='topic+MassSph'></span>

<h3>Description</h3>

<p>Calculate formula and mass of sphingoid bases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassSph(Sph)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassSph_+3A_sph">Sph</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassSphP'>Calculate formula and mass of sphingoid phosphate bases</h2><span id='topic+MassSphP'></span>

<h3>Description</h3>

<p>Calculate formula and mass of sphingoid phosphate bases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassSphP(SphP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassSphP_+3A_sphp">SphP</code></td>
<td>
<p>character value indicating total number of carbons and double
bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='MassTG'>Calculate formula and mass of TG</h2><span id='topic+MassTG'></span>

<h3>Description</h3>

<p>Calculate formula and mass of TG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MassTG(TG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MassTG_+3A_tg">TG</code></td>
<td>
<p>character value indicating total number of carbons and
double bounds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing formula and mass
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='mgdb'>
MGs database
</h2><span id='topic+mgdb'></span>

<h3>Description</h3>

<p>In silico generated database for common MGs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("mgdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 30 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='mzMatch'>mz match withing a vector of mz values</h2><span id='topic+mzMatch'></span>

<h3>Description</h3>

<p>This function searches marches between a given mz and a vector of mz values
with certain mass  tolerance and returns the index of the matched values. It
is used by identification functions to find candidates of each class of lipid
based on full MS information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mzMatch(mz, mzvector, ppm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mzMatch_+3A_mz">mz</code></td>
<td>
<p>mz value to be matched</p>
</td></tr>
<tr><td><code id="mzMatch_+3A_mzvector">mzvector</code></td>
<td>
<p>vector of mz values</p>
</td></tr>
<tr><td><code id="mzMatch_+3A_ppm">ppm</code></td>
<td>
<p>mass error tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector indicating the index of matched mz values and ppms for
each one of those matches (match1, ppm1, match2, ppm2, etc.)
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='nlsphdb'>
Neutral losses db for sphingoid bases. It is employed by idCerneg function.
</h2><span id='topic+nlsphdb'></span>

<h3>Description</h3>

<p>In silico generated database for neutral losses of sphingoid bases in ESI-.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("nlsphdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 4 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='organizeResults'>Prepare output for LipidMS annotation functions</h2><span id='topic+organizeResults'></span>

<h3>Description</h3>

<p>Prepare a readable output for LipidMS identification functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>organizeResults(
  candidates,
  coelfrags,
  clfrags,
  classConf,
  chainsComb,
  intrules,
  intConf,
  nchains,
  class,
  acquisitionmode
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="organizeResults_+3A_candidates">candidates</code></td>
<td>
<p>candidates data frame. Output of <a href="#topic+findCandidates">findCandidates</a>.</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_coelfrags">coelfrags</code></td>
<td>
<p>list of coeluting fragments for each candidate</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_clfrags">clfrags</code></td>
<td>
<p>vector containing the expected fragments for a given lipid
class.</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_classconf">classConf</code></td>
<td>
<p>output of <a href="#topic+checkClass">checkClass</a></p>
</td></tr>
<tr><td><code id="organizeResults_+3A_chainscomb">chainsComb</code></td>
<td>
<p>output of <a href="#topic+combineChains">combineChains</a></p>
</td></tr>
<tr><td><code id="organizeResults_+3A_intrules">intrules</code></td>
<td>
<p>character vector specifying the fragments to compare. See
<a href="#topic+checkIntensityRules">checkIntensityRules</a>.</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_intconf">intConf</code></td>
<td>
<p>output of <a href="#topic+checkIntensityRules">checkIntensityRules</a></p>
</td></tr>
<tr><td><code id="organizeResults_+3A_nchains">nchains</code></td>
<td>
<p>number of chains of the targeted lipid class.</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_class">class</code></td>
<td>
<p>character value. Lipid class (i.e. PC, PE, DG, TG, etc.).</p>
</td></tr>
<tr><td><code id="organizeResults_+3A_acquisitionmode">acquisitionmode</code></td>
<td>
<p>acquisition mode (DIA or DDA).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coelution score for DIA data is calculated as the mean coelution 
score of all fragments used for annotation, while for DDA data, the intensity
score is given, which is calculated as the sum of the relative intensities of 
the fragments used for annotation.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='padb'>
PAs database
</h2><span id='topic+padb'></span>

<h3>Description</h3>

<p>In silico generated database for common PAs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("padb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='partitioning'>agglomarative partitioning for LC-HRMS data based on enviPick algorithm</h2><span id='topic+partitioning'></span>

<h3>Description</h3>

<p>agglomarative partitioning for LC-HRMS data based on enviPick algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partitioning(msobject, dmzagglom, drtagglom, minpeak, mslevel, cE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partitioning_+3A_msobject">msobject</code></td>
<td>
<p>msobject generated by <a href="#topic+readMSfile">readMSfile</a></p>
</td></tr>
<tr><td><code id="partitioning_+3A_dmzagglom">dmzagglom</code></td>
<td>
<p>mz tolerance for partitions</p>
</td></tr>
<tr><td><code id="partitioning_+3A_drtagglom">drtagglom</code></td>
<td>
<p>RT window for partitions</p>
</td></tr>
<tr><td><code id="partitioning_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum number of measures to define a peak</p>
</td></tr>
<tr><td><code id="partitioning_+3A_mslevel">mslevel</code></td>
<td>
<p>MS level information to access msobject</p>
</td></tr>
<tr><td><code id="partitioning_+3A_ce">cE</code></td>
<td>
<p>collision energy information to access msobject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msobject
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Peak-picking algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>

<hr>
<h2 id='pcdb'>
PCs database
</h2><span id='topic+pcdb'></span>

<h3>Description</h3>

<p>In silico generated database for common PCs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pcdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='pcodb'>
O-PC database
</h2><span id='topic+pcodb'></span>

<h3>Description</h3>

<p>In silico generated database for common O-PC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pcodb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='pcpdb'>
P-PC database
</h2><span id='topic+pcpdb'></span>

<h3>Description</h3>

<p>In silico generated database for common P-PC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pcpdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='peakdetection'>peak-pick based on previous EIC clusters generated by <a href="#topic+clustering">clustering</a></h2><span id='topic+peakdetection'></span>

<h3>Description</h3>

<p>peak-pick based on previous EIC clusters generated by <a href="#topic+clustering">clustering</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peakdetection(
  msobject,
  minpeak,
  drtminpeak,
  drtmaxpeak,
  drtgap,
  recurs,
  weight,
  ended,
  sb,
  sn,
  minint,
  mslevel,
  cE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peakdetection_+3A_msobject">msobject</code></td>
<td>
<p>msobject generated by <a href="#topic+clustering">clustering</a></p>
</td></tr>
<tr><td><code id="peakdetection_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum number of measures to define a peak</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_drtminpeak">drtminpeak</code></td>
<td>
<p>minimum RT length of a peak</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_drtmaxpeak">drtmaxpeak</code></td>
<td>
<p>maximum RT length of a peak</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_drtgap">drtgap</code></td>
<td>
<p>maximum RT gap to be filled</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_recurs">recurs</code></td>
<td>
<p>maximum number of peaks for a EIC</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_weight">weight</code></td>
<td>
<p>weight for assigning measurements to a peak</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_ended">ended</code></td>
<td>
<p>number of failures allowed when detecting peaks</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_sb">sb</code></td>
<td>
<p>signal-to-base ration</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_sn">sn</code></td>
<td>
<p>signal-to-noise ratio</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_minint">minint</code></td>
<td>
<p>minimum intensity</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_mslevel">mslevel</code></td>
<td>
<p>info to access msobject</p>
</td></tr>
<tr><td><code id="peakdetection_+3A_ce">cE</code></td>
<td>
<p>info to access msobject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msobject
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>References</h3>

<p>Peak-picking algorithm has been imported from enviPick R-package:
https://cran.r-project.org/web/packages/enviPick/index.html
</p>

<hr>
<h2 id='pedb'>
PEs database
</h2><span id='topic+pedb'></span>

<h3>Description</h3>

<p>In silico generated database for common PEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pedb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='peodb'>
O-PE database
</h2><span id='topic+peodb'></span>

<h3>Description</h3>

<p>In silico generated database for common O-PE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("peodb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='pepdb'>
P-PE database
</h2><span id='topic+pepdb'></span>

<h3>Description</h3>

<p>In silico generated database for common P-PE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pepdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='pgdb'>
PGs database
</h2><span id='topic+pgdb'></span>

<h3>Description</h3>

<p>In silico generated database for common PGs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pgdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='pidb'>
PIs database
</h2><span id='topic+pidb'></span>

<h3>Description</h3>

<p>In silico generated database for common PIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pidb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='ploteicmsbatch'>EIC for all samples in a msbatch</h2><span id='topic+ploteicmsbatch'></span>

<h3>Description</h3>

<p>EIC for all samples in a msbatch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ploteicmsbatch(msbatch, mz, ppm, rt, colorbygroup = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ploteicmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch</p>
</td></tr>
<tr><td><code id="ploteicmsbatch_+3A_mz">mz</code></td>
<td>
<p>mz of interest</p>
</td></tr>
<tr><td><code id="ploteicmsbatch_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance in ppm</p>
</td></tr>
<tr><td><code id="ploteicmsbatch_+3A_rt">rt</code></td>
<td>
<p>numeric vector with the RT range to be plotted</p>
</td></tr>
<tr><td><code id="ploteicmsbatch_+3A_colorbygroup">colorbygroup</code></td>
<td>
<p>logical. If TRUE, samples will be coloured based on their
sample group (from metadata).</p>
</td></tr>
<tr><td><code id="ploteicmsbatch_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='plotLipids'>Plot informative peaks for lipid annotation</h2><span id='topic+plotLipids'></span>

<h3>Description</h3>

<p>Plot informative peaks for each lipid annotated with idPOS and idNEG (or
similar functions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLipids(msobject, span = 0.4, ppm = 10, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLipids_+3A_msobject">msobject</code></td>
<td>
<p>annotated msobject.</p>
</td></tr>
<tr><td><code id="plotLipids_+3A_span">span</code></td>
<td>
<p>smoothing parameter. Numeric value between 0 and 1.</p>
</td></tr>
<tr><td><code id="plotLipids_+3A_ppm">ppm</code></td>
<td>
<p>mz tolerance for EIC. If set to 0, the EIC will not be shown.</p>
</td></tr>
<tr><td><code id="plotLipids_+3A_verbose">verbose</code></td>
<td>
<p>print information messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak intensities are relative to the maximum intensity of each peak
to ease visualization.
</p>
<p>Grey lines show the the extracted ion chromatograms for the peaks.
</p>


<h3>Value</h3>

<p>msobject with a plots element which contains a list of plots.
Plots on the left side represent raw values while plots on the left are
smoothed or clean scans (MS2 in DDA).
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='plotticmsbatch'>TIC for all samples in a msbatch</h2><span id='topic+plotticmsbatch'></span>

<h3>Description</h3>

<p>TIC for all samples in a msbatch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotticmsbatch(msbatch, rt, colorbygroup = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotticmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>msbatch</p>
</td></tr>
<tr><td><code id="plotticmsbatch_+3A_rt">rt</code></td>
<td>
<p>numeric vector with the RT range to be plotted</p>
</td></tr>
<tr><td><code id="plotticmsbatch_+3A_colorbygroup">colorbygroup</code></td>
<td>
<p>logical. If TRUE, samples will be coloured based on their
sample group (from metadata).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='psdb'>
PSs database
</h2><span id='topic+psdb'></span>

<h3>Description</h3>

<p>In silico generated database for common PSs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("psdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 147 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='readMSfile'>Read mzXML file and initiate msobject</h2><span id='topic+readMSfile'></span>

<h3>Description</h3>

<p>Read mzXML file and initiate msobject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readMSfile(file, polarity)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readMSfile_+3A_file">file</code></td>
<td>
<p>file path for a mzXML file</p>
</td></tr>
<tr><td><code id="readMSfile_+3A_polarity">polarity</code></td>
<td>
<p>character value: negative or positive.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>msobject
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='rtcorrection'>Correct RT based on a rtmodel.</h2><span id='topic+rtcorrection'></span>

<h3>Description</h3>

<p>Correct RT based on a rtmodel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtcorrection(rt, rtmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtcorrection_+3A_rt">rt</code></td>
<td>
<p>rt vector to correct.</p>
</td></tr>
<tr><td><code id="rtcorrection_+3A_rtmodel">rtmodel</code></td>
<td>
<p>rt model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected rt vector.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>

<hr>
<h2 id='rtdevplot'>Plot retention time deviation</h2><span id='topic+rtdevplot'></span>

<h3>Description</h3>

<p>Plot retention time deviation of an aligned msbatch
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtdevplot(msbatch, colorbygroup = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtdevplot_+3A_msbatch">msbatch</code></td>
<td>
<p>aligned msbatch.</p>
</td></tr>
<tr><td><code id="rtdevplot_+3A_colorbygroup">colorbygroup</code></td>
<td>
<p>logical. If TRUE, samples will be coloured based on their
sample group (from metadata).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='searchIsotopes'>Targeted isotopes search</h2><span id='topic+searchIsotopes'></span>

<h3>Description</h3>

<p>This function uses annotation results of deisotoped data to search
for isotopes in raw data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchIsotopes(
  msobject,
  label,
  adductsTable = LipidMS::adductsTable,
  ppm = 10,
  coelCutoff = 0.7,
  results,
  dbs
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="searchIsotopes_+3A_msobject">msobject</code></td>
<td>
<p>msobject.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_label">label</code></td>
<td>
<p>isotope employed for the experiment. It can be &quot;13C&quot; or &quot;D&quot;.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_adductstable">adductsTable</code></td>
<td>
<p>adducts table employed for lipids annotation.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_ppm">ppm</code></td>
<td>
<p>mass error tolerance.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between isotopes. By default, 0.7.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_results">results</code></td>
<td>
<p>target list to search isotopes. If missing, all results from the
msobject are searched. It is used by <a href="#topic+searchIsotopesmsbatch">searchIsotopesmsbatch</a>.</p>
</td></tr>
<tr><td><code id="searchIsotopes_+3A_dbs">dbs</code></td>
<td>
<p>list of data bases required for annotation. By default, dbs
contains the required data frames based on the default fragmentation rules.
If these rules are modified, dbs may need to be supplied. See <a href="#topic+createLipidDB">createLipidDB</a>
and <a href="#topic+assignDB">assignDB</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the isotopes for each compound in the results data frame.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>

<hr>
<h2 id='searchIsotopesmsbatch'>Targeted isotopes search for msbatch</h2><span id='topic+searchIsotopesmsbatch'></span>

<h3>Description</h3>

<p>This function uses annotation results of deisotoped data to search
for isotopes in raw data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchIsotopesmsbatch(
  msbatch,
  label,
  adductsTable = LipidMS::adductsTable,
  ppm = 10,
  coelCutoff = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="searchIsotopesmsbatch_+3A_msbatch">msbatch</code></td>
<td>
<p>annotated msbatch.</p>
</td></tr>
<tr><td><code id="searchIsotopesmsbatch_+3A_label">label</code></td>
<td>
<p>isotope employed for the experiment. It can be &quot;13C&quot; or &quot;D&quot;.</p>
</td></tr>
<tr><td><code id="searchIsotopesmsbatch_+3A_adductstable">adductsTable</code></td>
<td>
<p>adducts table employed for lipids annotation.</p>
</td></tr>
<tr><td><code id="searchIsotopesmsbatch_+3A_ppm">ppm</code></td>
<td>
<p>mass error tolerance.</p>
</td></tr>
<tr><td><code id="searchIsotopesmsbatch_+3A_coelcutoff">coelCutoff</code></td>
<td>
<p>coelution score threshold between isotopes. By default, 0.7.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the isotopes for each compound in the results data frame.
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maribel_alcoriza@iislafe.es&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- batchProcessing(metadata = "metadata.csv", polarity = "positive")
msbatch &lt;- alignmsbatch(msbatch)
msbatch &lt;- groupmsbatch(msbatch)
msbatch &lt;- annotatemsbatch(msbatch)
searchIsotopesmsbatch(msbatch, label = "13C")

## End(Not run)

</code></pre>

<hr>
<h2 id='select'>Check matches between chains composition and precursor structures</h2><span id='topic+select'></span>

<h3>Description</h3>

<p>This function checks if the sum up of the chains structure match the
precursor structure. It is used by <a href="#topic+combineChains">combineChains</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select(chains, parent, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_+3A_chains">chains</code></td>
<td>
<p>character value containing chains structure separated by a
white space.</p>
</td></tr>
<tr><td><code id="select_+3A_parent">parent</code></td>
<td>
<p>precursor ion structure</p>
</td></tr>
<tr><td><code id="select_+3A_n">n</code></td>
<td>
<p>number of chains</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical value
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='setmsbatch'>Create msbatch for batch processing.</h2><span id='topic+setmsbatch'></span>

<h3>Description</h3>

<p>Create msbatch from a list of msobjects to build an msbatch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setmsbatch(msobjectlist, metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setmsbatch_+3A_msobjectlist">msobjectlist</code></td>
<td>
<p>list of msobjects.</p>
</td></tr>
<tr><td><code id="setmsbatch_+3A_metadata">metadata</code></td>
<td>
<p>sample metadata. Optional. It can be a csv file or a data.frame 
with 3 columns (sample, acquistionmode and sampletype).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>samples are sorted following the metadata data.frame.
</p>


<h3>Value</h3>

<p>msbatch
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@iislafe.es&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+dataProcessing">dataProcessing</a> and <a href="#topic+batchdataProcessing">batchdataProcessing</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
msbatch &lt;- setmsbatch(msobjectlist)

## End(Not run)

</code></pre>

<hr>
<h2 id='smdb'>
SMs database
</h2><span id='topic+smdb'></span>

<h3>Description</h3>

<p>In silico generated database for common SMs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("smdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 52 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='sphdb'>
Sphingoid bases database
</h2><span id='topic+sphdb'></span>

<h3>Description</h3>

<p>In silico generated database for common sphingoid bases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sphdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 4 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='sphPdb'>
Sphingoid bases phosphate database
</h2><span id='topic+sphPdb'></span>

<h3>Description</h3>

<p>In silico generated database for common sphingoid bases phosphate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sphPdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 4 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


<hr>
<h2 id='sumChains'>Calculate total number of carbons and double bounds of lipid chains</h2><span id='topic+sumChains'></span>

<h3>Description</h3>

<p>Given the structure of a lipid specie, it sums up the chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumChains(chains, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumChains_+3A_chains">chains</code></td>
<td>
<p>character value with the configuration of the chains separated
by a white space</p>
</td></tr>
<tr><td><code id="sumChains_+3A_n">n</code></td>
<td>
<p>number of chains</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character value indicating the total number of carbons and double
bounds
</p>


<h3>Author(s)</h3>

<p>M Isabel Alcoriza-Balaguer &lt;maialba@alumni.uv.es&gt;
</p>

<hr>
<h2 id='tgdb'>
TGs database
</h2><span id='topic+tgdb'></span>

<h3>Description</h3>

<p>In silico generated database for common TGs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("tgdb")</code></pre>


<h3>Format</h3>

<p>Data frame with 376 observations and the following 3 variables.
</p>

<dl>
<dt><code>formula</code></dt><dd><p>character vector containing molecular formulas.</p>
</dd>
<dt><code>total</code></dt><dd><p>character vector indicating the total number of carbons
and double bounds of the chains.</p>
</dd>
<dt><code>Mass</code></dt><dd><p>numeric vector with the neutral masses.</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
