<!DOCTYPE html><html><head><title>Help for package MDMR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MDMR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#delta'><p>Compute univariate MDMR effect sizes</p></a></li>
<li><a href='#gower'><p>Compute Gower's centered similarity matrix from a distance matrix</p></a></li>
<li><a href='#mdmr'><p>Conduct MDMR with analytic p-values</p></a></li>
<li><a href='#MDMR-package'><p>Multivariate Distance Matrix Regression</p></a></li>
<li><a href='#mixed.mdmr'><p>Fit Mixed-MDMR models</p></a></li>
<li><a href='#print.mdmr'><p>Print MDMR Object</p></a></li>
<li><a href='#print.mixed.mdmr'><p>Print Mixed MDMR Object</p></a></li>
<li><a href='#summary.mdmr'><p>Summarizing MDMR Results</p></a></li>
<li><a href='#summary.mixed.mdmr'><p>Summarizing Mixed MDMR Results</p></a></li>
<li><a href='#X.clust'><p>Simulated clustered predictor data to illustrate the Mixed-MDMR function</p></a></li>
<li><a href='#X.mdmr'><p>Simulated predictor data to illustrate the MDMR package.</p></a></li>
<li><a href='#Y.clust'><p>Simulated clustered outcome data to illustrate the Mixed-MDMR function</p></a></li>
<li><a href='#Y.mdmr'><p>Simulated outcome data to illustrate the MDMR package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Distance Matrix Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel B. McArtor &lt;dmcartor@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows users to conduct multivariate distance matrix regression using analytic p-values and compute measures of effect size. For details on the method, see McArtor, Lubke, &amp; Bergeman (2017) &lt;<a href="https://doi.org/10.1007%2Fs11336-016-9527-8">doi:10.1007/s11336-016-9527-8</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>CompQuadForm, parallel, lme4, car</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/dmcartor/mdmr">http://github.com/dmcartor/mdmr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/dmcartor/mdmr/issues">http://github.com/dmcartor/mdmr/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-14 03:41:15 UTC; Dan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-14 18:16:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='delta'>Compute univariate MDMR effect sizes</h2><span id='topic+delta'></span>

<h3>Description</h3>

<p><code>delta</code> computes permutation-based effect sizes on individual items
comprising the distance matrix outcome used in multivariate distance matrix
regression. It returns the omnibus estimates of delta (i.e. effect size of
the entire design matrix on each outcome) as well as estimates of each
pair-wise effect size (i.e. the effect of each predictor on each outcome
variable, conditional on the rest of the predictors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta(X, Y = NULL, dtype = NULL, niter = 10, x.inds = NULL,
  y.inds = NULL, G = NULL, G.list = NULL, ncores = 1, seed = NULL,
  plot.res = F, grayscale = F, cex = 1, y.las = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta_+3A_x">X</code></td>
<td>
<p>A <code class="reqn">n x p</code> matrix or data frame of predictors. Unordered factors
will be tested with contrast-codes by default, and ordered factors will be
tested with polynomial contrasts. For finer control of how categorical
predictors are handled, or if higher-order effects are desired, the output
from a call to <code>model.matrix()</code> can be supplied to this argument as
well.</p>
</td></tr>
<tr><td><code id="delta_+3A_y">Y</code></td>
<td>
<p>Outcome data: <code class="reqn">n x q</code> matrix of scores along the
dependent variables.</p>
</td></tr>
<tr><td><code id="delta_+3A_dtype">dtype</code></td>
<td>
<p>Measure of dissimilarity that will be used by <code><a href="stats.html#topic+dist">dist</a></code>
to compute the distance matrix based on <code>Y</code>. As is the case when calling
<code>dist</code> directly, this must be one of <code>"euclidean"</code>,
<code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>, <code>"binary"</code> or
<code>"minkowski"</code>, and unambiguous substring can be given.</p>
</td></tr>
<tr><td><code id="delta_+3A_niter">niter</code></td>
<td>
<p>Number of times to permute each outcome item in the procedure
to compute delta. The final result is the average of all <code>niter</code>
iterations. Higher values of <code>niter</code> require more computation time, but
result in more precise estimates.</p>
</td></tr>
<tr><td><code id="delta_+3A_x.inds">x.inds</code></td>
<td>
<p>Vector indicating which columns of X should have their
conditional effect sizes computed. Default value of <code>NULL</code> results in
all effects being computed, and a value of <code>0</code> results in no conditional
effects being computed, such that only the omnibus effect sizes will be
reported.</p>
</td></tr>
<tr><td><code id="delta_+3A_y.inds">y.inds</code></td>
<td>
<p>Vector indicating which columns of Y effect sizes should be
computed on. Default value of <code>NULL</code> results in all columns being
used.</p>
</td></tr>
<tr><td><code id="delta_+3A_g">G</code></td>
<td>
<p>Gower's centered similarity matrix computed from <code>D</code>.
Either <code>D</code> or <code>G</code> must be passed to <code>mdmr()</code>.</p>
</td></tr>
<tr><td><code id="delta_+3A_g.list">G.list</code></td>
<td>
<p>List of length <code class="reqn">q</code> where the <code class="reqn">i^{th}</code>
element contains the <code>G</code> matrix computed from distance a matrix that
was computed on a version of <code>Y</code> where the <code class="reqn">i^{th}</code>
column has been randomly permuted.</p>
</td></tr>
<tr><td><code id="delta_+3A_ncores">ncores</code></td>
<td>
<p>Integer; if <code>ncores</code> &gt; 1, the <code><a href="lattice.html#topic+parallel">parallel</a></code>
package is used to speed computation. Note: Windows users must set
<code>ncores = 1</code> because the <code>parallel</code> pacakge relies on forking. See
<code>mc.cores</code> in the <code><a href="parallel.html#topic+mclapply">mclapply</a></code> function in the
<code>parallel</code> pacakge for more details.</p>
</td></tr>
<tr><td><code id="delta_+3A_seed">seed</code></td>
<td>
<p>Integer; sets seed for the permutations of each variable
comprising Y so that results can be replicated.</p>
</td></tr>
<tr><td><code id="delta_+3A_plot.res">plot.res</code></td>
<td>
<p>Logical; Indicates whether or not a heat-map of the results
should be plotted.</p>
</td></tr>
<tr><td><code id="delta_+3A_grayscale">grayscale</code></td>
<td>
<p>Logical; Indicates whether or not the heat-map should be
plotted in grayscale.</p>
</td></tr>
<tr><td><code id="delta_+3A_cex">cex</code></td>
<td>
<p>Multiplier for cex.axis, cex.lab, cex.main, and cex that are
passed to the plotted result.</p>
</td></tr>
<tr><td><code id="delta_+3A_y.las">y.las</code></td>
<td>
<p>Orientation of labels for the outcome items. Defaults to
vertical (2). Value of 1 prints horizontal labels, and is only recommended
if the multivariate outcome is comprised of few variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See McArtor et al. (2017) for a detailed description of how delta is
computed. Note that it is a relative measure of effect, quantifying which
effects are strong (high values of delta) and weak (low values of delta)
within a single analysis, but estimates of delta cannot be directly compared
across different datasets.
</p>
<p>There are two options for using this function. The first option is to
specify the predictor matrix <code>X</code>, the outcome matrix <code>Y</code>, the
distance type <code>dtype</code> (supported by &quot;dist&quot; in R), and number of
iterations <code>niter</code>. This option conducts the permutation of each Y-item
<code>niter</code> times (to average out random association in each permutation)
and reports the median estimates of delta over the <code>niter</code> reps.
</p>
<p>The second option is to specify <code>X</code>, <code>G</code>, and <code>G.list</code>, a
list of G matrices where the permutation has already been done for each item
comprising Y. The names of the elements in <code>G.list</code> should correspond
to the names of the variables that were permuted. This option is implemented
so that delta can be computed when MDMR is being used in conjunction with
distance metrics not supported by <code>dist</code>.
</p>


<h3>Value</h3>

<p>A data frame whose rows correspond to the omnibus effects and the
effect of each individual predictor (conditional on the rest), and whose
columns correspond to each outcome variable whose effect sizes are being
quantified. If <code>plot.res = TRUE</code>, a heat-map is plotted of this data
frame to easily identify the strongest effects. Note that the heatmap is
partitioned into the omnibus effect (first row) and pair-wise effects
(remaining rows), because otherwise the omnibus effect would dominate the
heatmap.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>McArtor, D. B., Lubke, G. H., &amp; Bergeman, C. S. (2017). Extending
multivariate distance matrix regression with an effect size measure and the
distribution of the test statistic. Psychometrika, 82, 1052-1077.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mdmrdata)
# --- Method 1 --- #
delta(X.mdmr, Y = Y.mdmr, dtype = "euclidean", niter = 1, seed = 12345)

# --- Method 2 --- #
D &lt;- dist(Y.mdmr, method = "euclidean")
G &lt;- gower(D)
q &lt;- ncol(Y.mdmr)
G.list &lt;- vector(mode = "list", length = q)
names(G.list) &lt;- names(Y.mdmr)
for(i in 1:q) {
   Y.shuf &lt;- Y.mdmr
   Y.shuf[,i] &lt;- sample(Y.shuf[,i])
   G.list[[i]] &lt;- gower(dist(Y.shuf, method = "euclidean"))
}
delta(X.mdmr, G = G, G.list = G.list)

</code></pre>

<hr>
<h2 id='gower'>Compute Gower's centered similarity matrix from a distance matrix</h2><span id='topic+gower'></span>

<h3>Description</h3>

<p>Compute Gower's centered similarity matrix <code class="reqn">G</code>, which is the matrix
decomposed by the MDMR test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gower(d.mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gower_+3A_d.mat">d.mat</code></td>
<td>
<p>Symmetric distance matrix (or R distance object) computed from
the outcome data to be used in MDMR.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>G Gower's centered dissimilarity matrix computed from D.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>Gower, J. C. (1966). Some distance properties of latent root and
vector methods used in multivariate analysis. Biometrika, 53(3-4), 325-338.
</p>

<hr>
<h2 id='mdmr'>Conduct MDMR with analytic p-values</h2><span id='topic+mdmr'></span>

<h3>Description</h3>

<p><code>mdmr</code> (multivariate distance matrix regression) is used to regress a
distance matrix onto a set of predictors. It returns the test statistic,
pseudo R-square statistic, and analytic p-values for all predictors
jointly and for each predictor individually, conditioned on the rest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdmr(X, D = NULL, G = NULL, lambda = NULL, return.lambda = F,
  start.acc = 1e-20, ncores = 1, perm.p = (nrow(as.matrix(X)) &lt; 200),
  nperm = 500, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdmr_+3A_x">X</code></td>
<td>
<p>A <code class="reqn">n x p</code> matrix or data frame of predictors. Unordered factors
will be tested with contrast-codes by default, and ordered factors will be
tested with polynomial contrasts. For finer control of how categorical
predictors are handled, or if higher-order effects are desired, the output
from a call to <code>model.matrix()</code> can be supplied to this argument as
well.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_d">D</code></td>
<td>
<p>Distance matrix computed on the outcome data. Can be either a
matrix or an R <code><a href="stats.html#topic+dist">dist</a></code> object. Either <code>D</code> or <code>G</code>
must be passed to <code>mdmr()</code>.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_g">G</code></td>
<td>
<p>Gower's centered similarity matrix computed from <code>D</code>.
Either <code>D</code> or <code>G</code> must be passed to <code>mdmr</code>.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_lambda">lambda</code></td>
<td>
<p>Optional argument: Eigenvalues of <code>G</code>.
Eigendecomposition of large <code>G</code> matrices can be somewhat time
consuming, and the theoretical p-values require the eigenvalues of
<code>G</code>. If MDMR is to be conducted multiple times on one distance
matrix, it is advised to conduct the eigendecomposition once and pass the
eigenvalues to <code>mdmr()</code> directly each time.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_return.lambda">return.lambda</code></td>
<td>
<p>Logical; indicates whether or not the eigenvalues of
<code>G</code> should be returned, if calculated. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_start.acc">start.acc</code></td>
<td>
<p>Starting accuracy of the Davies (1980) algorithm
implemented in the <code><a href="CompQuadForm.html#topic+davies">davies</a></code> function in the <code>CompQuadForm</code>
package (Duchesne &amp;  De Micheaux, 2010) that <code>mdmr()</code> uses to compute
MDMR p-values.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_ncores">ncores</code></td>
<td>
<p>Integer; if <code>ncores</code> &gt; 1, the <code><a href="lattice.html#topic+parallel">parallel</a></code>
package is used to speed computation. Note: Windows users must set
<code>ncores = 1</code> because the <code>parallel</code> pacakge relies on forking. See
<code>mc.cores</code> in the <code><a href="parallel.html#topic+mclapply">mclapply</a></code> function in the
<code>parallel</code> pacakge for more details.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_perm.p">perm.p</code></td>
<td>
<p>Logical: should permutation-based p-values be computed instead
of analytic p-values? Default behavior is <code>TRUE</code> if <code>n &lt; 200</code> and
<code>FALSE</code> otherwise because the anlytic p-values depend on asymptotics.
for <code>n &gt; 200</code> and &quot;permutation&quot; otherwise.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations to use if permutation-based p-values are
to be computed.</p>
</td></tr>
<tr><td><code id="mdmr_+3A_seed">seed</code></td>
<td>
<p>Random seed to use to generate the permutation null distribution.
Defaults to a random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the fastest approach to conducting MDMR. It uses the
fastest known computational strategy to compute the MDMR test statistic (see
Appendix A of McArtor et al., 2017), and it uses fast, analytic p-values.
</p>
<p>The slowest part of conducting MDMR is now the necessary eigendecomposition
of the <code>G</code> matrix, whose computation time is a function of
<code class="reqn">n^3</code>. If MDMR is to be conducted multiple times on the same
distance matrix, it is recommended to compute eigenvalues of <code>G</code> in
advance and pass them to the function rather than computing them every
time <code>mdmr</code> is called, as is the case if the argument <code>lambda</code>
is left <code>NULL</code>.
</p>
<p>The distance matrix <code>D</code> can be passed to <code>mdmr</code> as either a
distance object or a symmetric matrix.
</p>


<h3>Value</h3>

<p>An object with six elements and a summary function. Calling
<code>summary(mdmr.res)</code> produces a data frame comprised of:
</p>
<table>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the corresponding MDMR test statistic</p>
</td></tr>
<tr><td><code>Numer DF</code></td>
<td>
<p>Numerator degrees of freedom for the corresponding effect</p>
</td></tr>
<tr><td><code>Pseudo R2</code></td>
<td>
<p>Size of the corresponding effect on the
distance matrix</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The p-value for each effect.</p>
</td></tr>
</table>
<p>In addition to the information in the three columns comprising
<code>summary(res)</code>, the <code>res</code> object also contains:
</p>
<table>
<tr><td><code>p.prec</code></td>
<td>
<p>A data.frame reporting the precision of each p-value. If
analytic p-values were computed, these are the maximum error bound of the
p-values reported by the <code>davies</code> function in <code>CompQuadForm</code>. If
permutation p-values were computed, it is the standard error of each
permutation p-value.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>A vector of the eigenvalues of <code>G</code> (if
<code>return.lambda = T</code>).</p>
</td></tr>
<tr><td><code>nperm</code></td>
<td>
<p>Number of permutations used. Will read <code>NA</code> if analytic
p-values were computed</p>
</td></tr>
</table>
<p>Note that the printed output of <code>summary(res)</code> will truncate p-values
to the smallest trustworthy values, but the object returned by
<code>summary(res)</code> will contain the p-values as computed. The reason for
this truncation differs for analytic and permutation p-values. For an
analytic p-value, if the error bound of the Davies algorithm is larger than
the p-value, the only conclusion that can be drawn with certainty is that
the p-value is smaller than (or equal to) the error bound. For a permutation
test, the estimated p-value will be zero if no permuted test statistics are
greater than the observed statistic, but the zero p-value is only a product
of the finite number of permutations conduted. The only conclusion that can
be drawn is that the p-value is smaller than <code>1/nperm</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P. L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B., Lubke, G. H., &amp; Bergeman, C. S. (2017). Extending
multivariate distance matrix regression with an effect size measure and the
distribution of the test statistic. Psychometrika, 82, 1052-1077.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- The following two approaches yield equivalent results --- #
# Approach 1
data(mdmrdata)
D &lt;- dist(Y.mdmr, method = "euclidean")
res1 &lt;- mdmr(X = X.mdmr, D = D)
summary(res1)

# Approach 2
data(mdmrdata)
D &lt;- dist(Y.mdmr, method = "euclidean")
G &lt;- gower(D)
res2 &lt;- mdmr(X = X.mdmr, G = G)
summary(res2)

</code></pre>

<hr>
<h2 id='MDMR-package'>Multivariate Distance Matrix Regression</h2><span id='topic+MDMR-package'></span><span id='topic+MDMR'></span>

<h3>Description</h3>

<p><code>MDMR</code> allows a user to conduct multivariate distance matrix regression
using analytic p-values and measures of effect size described by McArtor et
al. (2017). Analytic p-values are computed using the R package CompQuadForm
(Duchesne &amp; De Micheaux, 2010). It also facilitates the use of MDMR on
samples consisting of (hierarchically) clustered observations.
</p>


<h3>Usage</h3>

<p>To access this package's tutorial, type the following line into the console:
</p>
<p><code>vignette('mdmr-vignette')</code>
</p>
<p>There are three primary functions that comprise this package:
<code><a href="#topic+mdmr">mdmr</a></code>, which regresses a distance matrix onto a set of
predictors, and <code><a href="#topic+delta">delta</a></code>, which computes measures of univariate
effect size in the context of multivariate distance matrix regression. The
third function <code><a href="#topic+mixed.mdmr">mixed.mdmr</a></code> facilitates the use of MDMR on
(hierarchically) clustered samples using an approach analogous to the
linearar mixed-effects model for univariate outcomes. The help files of all
all three functions provide more general information than the package
vignette.
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P.L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B., Lubke, G. H., &amp; Bergeman, C. S. (2017). Extending
multivariate distance matrix regression with an effect size measure and the
distribution of the test statistic. Psychometrika, 82, 1052-1077.
</p>
<p>McArtor, D. B. (2017). Extending a distance-based approach to multivariate
multiple regression (Doctoral Dissertation).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>################################################################
## Conducting MDMR on data comprised of independent observations
################################################################
# Source data
data(mdmrdata)

# Get distance matrix
D &lt;- dist(Y.mdmr, method = 'euclidean')

# Conduct MDMR
mdmr.res &lt;- mdmr(X = X.mdmr, D = D)
summary(mdmr.res)

################################################################
## Conducting MDMR on data comprised of dependent observations
################################################################
# Source data
data("clustmdmrdata")

# Get distance matrix
D &lt;- dist(Y.clust)

# Conduct mixed-MDMR
mixed.res &lt;- mixed.mdmr(~ x1 + x2 + (x1 + x2 | grp),
                        data = X.clust, D = D)
summary(mixed.res)

</code></pre>

<hr>
<h2 id='mixed.mdmr'>Fit Mixed-MDMR models</h2><span id='topic+mixed.mdmr'></span>

<h3>Description</h3>

<p><code>mixed.mdmr</code> allows users to conduct multivariate distance matrix
regression (MDMR) in the context of a (hierarchically) clustered sample
without inflating Type-I error rates as a result of the violation of the
independence assumption. This is done by invoking a mixed-effects modeling
framework, in which clustering/grouping variables are specified as random
effects and the covariate effects of interest are fixed effects. The input
to <code>mixed.mdmr</code> largely reflects the input of the <code><a href="lme4.html#topic+lmer">lmer</a></code>
function from the package <code><a href="lme4.html#topic+lme4">lme4</a></code> insofar as the specification of
random and fixed effects are concerned (see Arguments for details). Note that
this function simply controls for the random effects in order to test the
fixed effects; it does not facilitate point estimation or inference on the
random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixed.mdmr(fmla, data, D = NULL, G = NULL, use.ssd = 1,
  start.acc = 1e-20, ncores = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixed.mdmr_+3A_fmla">fmla</code></td>
<td>
<p>A one-sided linear formula object describing both the fixed-effects and random-effects part of the model, beginning with an ~ operator, which is followed by the terms to include in the model, separated by + operators. Random-effects terms are distinguished by vertical bars (|) separating expressions for design matrices from grouping factors. Two vertical bars (||) can be used to specify multiple uncorrelated random effects for the same grouping variable.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_data">data</code></td>
<td>
<p>A mandatory data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_d">D</code></td>
<td>
<p>Distance matrix computed on the outcome data. Can be either a
matrix or an R <code><a href="stats.html#topic+dist">dist</a></code> object. Either <code>D</code> or <code>G</code>
must be passed to <code>mdmr()</code>.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_g">G</code></td>
<td>
<p>Gower's centered similarity matrix computed from <code>D</code>.
Either <code>D</code> or <code>G</code> must be passed to <code>mdmr</code>.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_use.ssd">use.ssd</code></td>
<td>
<p>The proportion of the total sum of squared distances (SSD)
that will be targeted in the modeling process. In the case of non-Euclidean
distances, specifying <code>use.ssd</code> to be slightly smaller than 1.00 (e.g.,
0.99) can substantially lower the computational burden of <code>mixed.mdmr</code>
while maintaining well-controlled Type-I error rates and only sacrificing
a trivial amount of power. In the case of Euclidean distances the
computational burden of <code>mixed.mdmr</code> is small, so <code>use.ssd</code> should
be set to 1.00.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_start.acc">start.acc</code></td>
<td>
<p>Starting accuracy of the Davies (1980) algorithm
implemented in the <code><a href="CompQuadForm.html#topic+davies">davies</a></code> function in the <code>CompQuadForm</code>
package (Duchesne &amp;  De Micheaux, 2010) that <code>mdmr()</code> uses to compute
MDMR p-values.</p>
</td></tr>
<tr><td><code id="mixed.mdmr_+3A_ncores">ncores</code></td>
<td>
<p>Integer; if <code>ncores</code> &gt; 1, the <code><a href="lattice.html#topic+parallel">parallel</a></code>
package is used to speed computation. Note: Windows users must set
<code>ncores = 1</code> because the <code>parallel</code> pacakge relies on forking. See
<code>mc.cores</code> in the <code><a href="parallel.html#topic+mclapply">mclapply</a></code> function in the
<code>parallel</code> pacakge for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with six elements and a summary function. Calling
<code>summary(mixed.mdmr.res)</code> produces a data frame comprised of:
</p>
<table>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the corresponding MDMR test statistic</p>
</td></tr>
<tr><td><code>Numer DF</code></td>
<td>
<p>Numerator degrees of freedom for the corresponding effect</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The p-value for each effect.</p>
</td></tr>
</table>
<p>In addition to the information in the three columns comprising
<code>summary(res)</code>, the <code>res</code> object also contains:
</p>
<table>
<tr><td><code>p.prec</code></td>
<td>
<p>A data.frame reporting the precision of each p-value. If
analytic p-values were computed, these are the maximum error bound of the
p-values reported by the <code>davies</code> function in <code>CompQuadForm</code>. If
permutation p-values were computed, it is the standard error of each
permutation p-value.</p>
</td></tr>
</table>
<p>Note that the printed output of <code>summary(res)</code> will truncate p-values
to the smallest trustworthy values, but the object returned by
<code>summary(res)</code> will contain the p-values as computed. The reason for
this truncation differs for analytic and permutation p-values. For an
analytic p-value, if the error bound of the Davies algorithm is larger than
the p-value, the only conclusion that can be drawn with certainty is that
the p-value is smaller than (or equal to) the error bound.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P. L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B. (2017). Extending a distance-based approach to multivariate
multiple regression (Doctoral Dissertation).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("clustmdmrdata")

# Get distance matrix
D &lt;- dist(Y.clust)

# Regular MDMR without the grouping variable
mdmr.res &lt;- mdmr(X = X.clust[,1:2], D = D, perm.p = FALSE)

# Results look significant
summary(mdmr.res)

# Account for grouping variable
mixed.res &lt;- mixed.mdmr(~ x1 + x2 + (x1 + x2 | grp),
                        data = X.clust, D = D)

# Signifance was due to the grouping variable
summary(mixed.res)


</code></pre>

<hr>
<h2 id='print.mdmr'>Print MDMR Object</h2><span id='topic+print.mdmr'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>mdmr</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mdmr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mdmr_+3A_x">x</code></td>
<td>
<p>Output from <code>mdmr</code></p>
</td></tr>
<tr><td><code id="print.mdmr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p-value</code></td>
<td>
<p>Analytic p-values for the omnibus test and each predictor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>

<hr>
<h2 id='print.mixed.mdmr'>Print Mixed MDMR Object</h2><span id='topic+print.mixed.mdmr'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>mixed.mdmr</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixed.mdmr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mixed.mdmr_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+mixed.mdmr">mixed.mdmr</a></code></p>
</td></tr>
<tr><td><code id="print.mixed.mdmr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p-value</code></td>
<td>
<p>Analytic p-values for the omnibus test and each predictor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>

<hr>
<h2 id='summary.mdmr'>Summarizing MDMR Results</h2><span id='topic+summary.mdmr'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>mdmr</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mdmr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mdmr_+3A_object">object</code></td>
<td>
<p>Output from <code>mdmr</code></p>
</td></tr>
<tr><td><code id="summary.mdmr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calling
<code>summary(mdmr.res)</code> produces a data frame comprised of:
</p>
<table>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the corresponding MDMR test statistic</p>
</td></tr>
<tr><td><code>Pseudo R2</code></td>
<td>
<p>Size of the corresponding effect on the
distance matrix</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The p-value for each effect.</p>
</td></tr>
</table>
<p>In addition to the information in the three columns comprising
<code>summary(res)</code>, the <code>res</code> object also contains:
</p>
<table>
<tr><td><code>p.prec</code></td>
<td>
<p>A data.frame reporting the precision of each p-value. If
analytic p-values were computed, these are the maximum error bound of the
p-values reported by the <code>davies</code> function in <code>CompQuadForm</code>. If
permutation p-values were computed, it is the standard error of each
permutation p-value.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>A vector of the eigenvalues of <code>G</code> (if
<code>return.lambda = T</code>).</p>
</td></tr>
<tr><td><code>nperm</code></td>
<td>
<p>Number of permutations used. Will read <code>NA</code> if analytic
p-values were computed</p>
</td></tr>
</table>
<p>Note that the printed output of <code>summary(res)</code> will truncate p-values
to the smallest trustworthy values, but the object returned by
<code>summary(res)</code> will contain the p-values as computed. The reason for
this truncation differs for analytic and permutation p-values. For an
analytic p-value, if the error bound of the Davies algorithm is larger than
the p-value, the only conclusion that can be drawn with certainty is that
the p-value is smaller than (or equal to) the error bound. For a permutation
test, the estimated p-value will be zero if no permuted test statistics are
greater than the observed statistic, but the zero p-value is only a product
of the finite number of permutations conduted. The only conclusion that can
be drawn is that the p-value is smaller than <code>1/nperm</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P. L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B., Lubke, G. H., &amp; Bergeman, C. S. (2017). Extending
multivariate distance matrix regression with an effect size measure and the
distribution of the test statistic. Psychometrika, 82, 1052-1077.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --- The following two approaches yield equivalent results --- #
# Approach 1
data(mdmrdata)
D &lt;- dist(Y.mdmr, method = "euclidean")
mdmr.res &lt;- mdmr(X = X.mdmr, D = D)
summary(mdmr.res)

</code></pre>

<hr>
<h2 id='summary.mixed.mdmr'>Summarizing Mixed MDMR Results</h2><span id='topic+summary.mixed.mdmr'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>mixed.mdmr</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixed.mdmr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mixed.mdmr_+3A_object">object</code></td>
<td>
<p>Output from <code><a href="#topic+mixed.mdmr">mixed.mdmr</a></code></p>
</td></tr>
<tr><td><code id="summary.mixed.mdmr_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calling
<code>summary(mdmr.res)</code> produces a data frame comprised of:
</p>
<table>
<tr><td><code>Statistic</code></td>
<td>
<p>Value of the corresponding MDMR test statistic</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The p-value for each effect.</p>
</td></tr>
</table>
<p>In addition to the information in the three columns comprising
<code>summary(res)</code>, the <code>res</code> object also contains:
</p>
<table>
<tr><td><code>p.prec</code></td>
<td>
<p>A data.frame reporting the precision of each p-value. If
analytic p-values were computed, these are the maximum error bound of the
p-values reported by the <code>davies</code> function in <code>CompQuadForm</code>. If
permutation p-values were computed, it is the standard error of each
permutation p-value.</p>
</td></tr>
</table>
<p>Note that the printed output of <code>summary(res)</code> will truncate p-values
to the smallest trustworthy values, but the object returned by
<code>summary(res)</code> will contain the p-values as computed. The reason for
this truncation differs for analytic and permutation p-values. For an
analytic p-value, if the error bound of the Davies algorithm is larger than
the p-value, the only conclusion that can be drawn with certainty is that
the p-value is smaller than (or equal to) the error bound.
</p>


<h3>Author(s)</h3>

<p>Daniel B. McArtor (dmcartor@gmail.com) [aut, cre]
</p>


<h3>References</h3>

<p>Davies, R. B. (1980). The Distribution of a Linear Combination of
chi-square Random Variables. Journal of the Royal Statistical Society.
Series C (Applied Statistics), 29(3), 323-333.
</p>
<p>Duchesne, P., &amp; De Micheaux, P. L. (2010). Computing the distribution of
quadratic forms: Further comparisons between the Liu-Tang-Zhang
approximation and exact methods. Computational Statistics and Data
Analysis, 54(4), 858-862.
</p>
<p>McArtor, D. B. (2017). Extending a distance-based approach to multivariate
multiple regression (Doctoral Dissertation).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("clustmdmrdata")

# Get distance matrix
D &lt;- dist(Y.clust)

# Regular MDMR without the grouping variable
mdmr.res &lt;- mdmr(X = X.clust[,1:2], D = D, perm.p = FALSE)

# Results look significant
summary(mdmr.res)


# Account for grouping variable
mixed.res &lt;- mixed.mdmr(~ x1 + x2 + (x1 + x2 | grp),
                        data = X.clust, D = D)

# Signifance was due to the grouping variable
summary(mixed.res)

</code></pre>

<hr>
<h2 id='X.clust'>Simulated clustered predictor data to illustrate the Mixed-MDMR function</h2><span id='topic+X.clust'></span>

<h3>Description</h3>

<p>See <code><a href="#topic+mixed.mdmr">mixed.mdmr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>X.clust
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 250 rows and 3 columns.</p>

<hr>
<h2 id='X.mdmr'>Simulated predictor data to illustrate the MDMR package.</h2><span id='topic+X.mdmr'></span>

<h3>Description</h3>

<p>See package vignette by calling <code>vignette("mdmr-vignette")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>X.mdmr
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 500 rows and 3 columns.</p>

<hr>
<h2 id='Y.clust'>Simulated clustered outcome data to illustrate the Mixed-MDMR function</h2><span id='topic+Y.clust'></span>

<h3>Description</h3>

<p>See <code><a href="#topic+mixed.mdmr">mixed.mdmr</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y.clust
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 250 rows and 12 columns.</p>

<hr>
<h2 id='Y.mdmr'>Simulated outcome data to illustrate the MDMR package.</h2><span id='topic+Y.mdmr'></span>

<h3>Description</h3>

<p>See package vignette by calling <code>vignette("mdmr-vignette")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y.mdmr
</code></pre>


<h3>Format</h3>

<p>An object of class <code>matrix</code> with 500 rows and 10 columns.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
