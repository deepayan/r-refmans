<!DOCTYPE html><html lang="en-US"><head><title>Help for package wdpar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {wdpar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#wdpar'><p>wdpar: Interface to the World Database on Protected Areas</p></a></li>
<li><a href='#st_erase_overlaps'><p>Erase overlaps</p></a></li>
<li><a href='#st_repair_geometry'><p>Repair geometry</p></a></li>
<li><a href='#wdpa_clean'><p>Clean data</p></a></li>
<li><a href='#wdpa_dissolve'><p>Dissolve data</p></a></li>
<li><a href='#wdpa_fetch'><p>Fetch data</p></a></li>
<li><a href='#wdpa_latest_version'><p>Query latest version</p></a></li>
<li><a href='#wdpa_read'><p>Read data</p></a></li>
<li><a href='#wdpa_url'><p>Download URL</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.8</td>
</tr>
<tr>
<td>Title:</td>
<td>Interface to the World Database on Protected Areas</td>
</tr>
<tr>
<td>Description:</td>
<td>Fetch and clean data from the World Database on Protected
    Areas (WDPA) and the World Database on Other Effective Area-Based
    Conservation Measures (WDOECM). Data is obtained from Protected Planet
    <a href="https://www.protectedplanet.net/en">https://www.protectedplanet.net/en</a>. To augment data cleaning procedures,
    users can install the 'prepr' R package (available at
    <a href="https://github.com/prioritizr/prepr">https://github.com/prioritizr/prepr</a>). For more information on this
    package, see Hanson (2022) &lt;<a href="https://doi.org/10.21105%2Fjoss.04594">doi:10.21105/joss.04594</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, assertthat (&ge; 0.2.0), progress (&ge; 1.2.0), curl (&ge;
3.2), httr (&ge; 1.3.1), countrycode (&ge; 1.1.0), chromote (&ge;
0.2.0), xml2 (&ge; 1.2.0), cli (&ge; 1.0.1), lwgeom (&ge; 0.2-1),
tibble (&ge; 2.1.3), pingr (&ge; 1.1.2), rappdirs (&ge; 0.3.1), withr
(&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.0.1), knitr (&ge; 1.2.0), roxygen2 (&ge; 6.1.1),
rmarkdown (&ge; 1.10), ggmap (&ge; 4.0.0), ggplot2 (&ge; 3.1.0),
prepr (&ge; 0.3.0), dplyr (&ge; 1.0.7), ps (&ge; 1.5.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), sf (&ge; 1.0-13)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://prioritizr.github.io/wdpar/">https://prioritizr.github.io/wdpar/</a>,
<a href="https://github.com/prioritizr/wdpar">https://github.com/prioritizr/wdpar</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/prioritizr/wdpar/issues">https://github.com/prioritizr/wdpar/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'internal.R' 'package.R' 'read_sf_n.R' 'st_erase_overlaps.R'
'st_repair_geometry.R' 'wdpa_clean.R' 'wdpa_dissolve.R'
'wdpa_url.R' 'wdpa_latest_version.R' 'wdpa_fetch.R'
'wdpa_read.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-07 02:47:05 UTC; jeff</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeffrey O Hanson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeffrey O Hanson &lt;jeffrey.hanson@uqconnect.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-07 07:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='wdpar'>wdpar: Interface to the World Database on Protected Areas</h2><span id='topic+wdpar'></span><span id='topic+wdpar-package'></span>

<h3>Description</h3>

<p>The <span class="pkg">wdpar</span> R package provides an interface to data provided by
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Specifically, it can be used to automatically obtain data from
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
It also provides methods for cleaning data from these databases following
best practices
(outlined in Butchart <em>et al.</em> 2015; Protected Planet 2021; Runge <em>et al.</em>
2015). The main functions are <code><a href="#topic+wdpa_fetch">wdpa_fetch()</a></code>
for downloading data and <code><a href="#topic+wdpa_clean">wdpa_clean()</a></code> for cleaning data. For
more information, please see the package vignette.
To cite this package, please see <code>citation("wdpar")</code>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jeffrey O Hanson <a href="mailto:jeffrey.hanson@uqconnect.edu.au">jeffrey.hanson@uqconnect.edu.au</a>
</p>


<h3>References</h3>

<p>Butchart SH, Clarke M, Smith RJ, Sykes RE, Scharlemann JP,
Harfoot M, ... &amp; Brooks TM (2015) Shortfalls and solutions for
meeting national and global conservation area targets.
<em>Conservation Letters</em>, <strong>8</strong>: 329&ndash;337.
</p>
<p>Protected Planet (2021) Calculating protected and OECM area coverage.
Available at:
<a href="https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage">https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage</a>.
</p>
<p>Runge CA, Watson JEM, Butchart HM, Hanson JO, Possingham HP &amp; Fuller RA
(2015) Protected areas and global conservation of migratory birds.
<em>Science</em>, <strong>350</strong>: 1255&ndash;1258.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://prioritizr.github.io/wdpar/">https://prioritizr.github.io/wdpar/</a>
</p>
</li>
<li> <p><a href="https://github.com/prioritizr/wdpar">https://github.com/prioritizr/wdpar</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/prioritizr/wdpar/issues">https://github.com/prioritizr/wdpar/issues</a>
</p>
</li></ul>


<hr>
<h2 id='st_erase_overlaps'>Erase overlaps</h2><span id='topic+st_erase_overlaps'></span>

<h3>Description</h3>

<p>Erase overlapping geometries in a <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st_erase_overlaps(x, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="st_erase_overlaps_+3A_x">x</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object.</p>
</td></tr>
<tr><td><code id="st_erase_overlaps_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> should progress be reported? Defaults to
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a more robust &ndash; albeit slower &ndash; implementation for
<code><a href="sf.html#topic+geos_binary_ops">sf::st_difference()</a></code> when <code>y</code> is missing.
</p>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="sf.html#topic+geos_binary_ops">sf::st_difference()</a></code>, <code><a href="#topic+wdpa_dissolve">wdpa_dissolve()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create data
pl1 &lt;- sf::st_polygon(list(matrix(c(0, 0, 2, 0, 1, 1, 0, 0), byrow = TRUE,
                                  ncol = 2))) * 100
pl2 &lt;- sf::st_polygon(list(matrix(c(0, 0.5, 2, 0.5, 1, 1.5, 0, 0.5),
                                  byrow = TRUE, ncol = 2))) * 100
pl3 &lt;- sf::st_polygon(list(matrix(c(0, 1.25, 2, 1.25, 1, 2.5, 0, 1.25),
                                  byrow = TRUE, ncol = 2))) * 100
x &lt;- sf::st_sf(order = c("A", "B", "C"),
               geometry = sf::st_sfc(list(pl1, pl2, pl3), crs = 3395))

# erase overlaps
y &lt;- st_erase_overlaps(x)

# plot data for visual comparison
par(mfrow = c(1, 2))
plot(sf::st_geometry(x), xlim = c(0, 200), ylim = c(0, 250),
     main = "original", col = "transparent")
plot(sf::st_geometry(y), , xlim = c(0, 200), ylim = c(0, 250),
     main = "no overlaps", col = "transparent")
</code></pre>

<hr>
<h2 id='st_repair_geometry'>Repair geometry</h2><span id='topic+st_repair_geometry'></span>

<h3>Description</h3>

<p>Repair the geometry of a <code><a href="sf.html#topic+sf">sf::st_sf()</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st_repair_geometry(x, geometry_precision = 1500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="st_repair_geometry_+3A_x">x</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object.</p>
</td></tr>
<tr><td><code id="st_repair_geometry_+3A_geometry_precision">geometry_precision</code></td>
<td>
<p><code>numeric</code> level of precision for processing
the spatial data (used with <code><a href="sf.html#topic+st_precision">sf::st_set_precision()</a></code>). The
default argument is 1500 (higher values indicate higher precision).
This level of precision is generally suitable for analyses at the
national-scale. For analyses at finer-scale resolutions, please
consider using a greater value (e.g. 10000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function works by first using the <code><a href="sf.html#topic+valid">sf::st_make_valid()</a></code> function
to attempt to fix geometry issues. Since the <code><a href="sf.html#topic+valid">sf::st_make_valid()</a></code> function
sometimes produce incorrect geometries in rare cases
(e.g. when fixing invalid geometries that cross the dateline),
this function then uses the <code>st_prepair()</code> function from the <span class="pkg">prepr</span>
package to fix those geometries instead
(see <a href="https://github.com/dickoa/prepr">https://github.com/dickoa/prepr</a> for details).
</p>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>Installation</h3>

<p>This function uses the <span class="pkg">prepr</span> package to help repair geometries
in certain cases. Because the <span class="pkg">prepr</span> package is not available on
the Comprehensive R Archive Network (CRAN), it must be installed from
its online code repository. To achieve this, please
use the following code:
</p>
<div class="sourceCode"><pre>if (!require(remotes)) install.packages("remotes")
remotes::install_github("dickoa/prepr")
</pre></div>
<p>Note that the <span class="pkg">prepr</span> package has system dependencies that need to be
installed before the package itself can be installed
(see package README file for platform-specific instructions).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create sf object
p1 &lt;- st_sf(
  id = 1,
  geometry = st_as_sfc("POLYGON((0 0, 0 10, 10 0, 10 10, 0 0))", crs = 3857)
)

# repair geometry
p2 &lt;- st_repair_geometry(p1)

# print object
print(p2)
</code></pre>

<hr>
<h2 id='wdpa_clean'>Clean data</h2><span id='topic+wdpa_clean'></span>

<h3>Description</h3>

<p>Clean data obtained from
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Specifically, this function is designed to clean data obtained from
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
For recommended practices on cleaning large datasets
(e.g. datasets that span multiple countries or a large geographic area),
please see below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_clean(
  x,
  crs = paste("+proj=cea +lon_0=0 +lat_ts=30 +x_0=0",
    "+y_0=0 +datum=WGS84 +ellps=WGS84 +units=m +no_defs"),
  exclude_unesco = TRUE,
  retain_status = c("Designated", "Inscribed", "Established"),
  snap_tolerance = 1,
  simplify_tolerance = 0,
  geometry_precision = 1500,
  erase_overlaps = TRUE,
  verbose = interactive()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wdpa_clean_+3A_x">x</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object containing protected area data.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_crs">crs</code></td>
<td>
<p><code>character</code> or <code>integer</code> object representing a
coordinate reference system. Defaults to World Behrmann
(<em>ESRI:54017</em>).</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_exclude_unesco">exclude_unesco</code></td>
<td>
<p><code>logical</code> should UNESCO Biosphere Reserves be excluded?
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_retain_status">retain_status</code></td>
<td>
<p><code>character</code> vector containing the statuses for
protected areas that should be retained during the cleaning process.
Available statuses include:
<code>"Proposed"</code>, <code>"Inscribed"</code>, <code>"Adopted"</code>, <code>"Designated"</code>, and
<code>"Established"</code>.
Additionally, a <code>NULL</code> argument can be specified to ensure that no
protected areas are excluded according to their status.
The default argument is a <code>character</code> vector containing <code>"Designated"</code>,
<code>"Inscribed"</code>, and <code>"Established"</code>.
This default argument ensures that protected areas that are not currently
implemented are excluded.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_snap_tolerance">snap_tolerance</code></td>
<td>
<p><code>numeric</code> tolerance for snapping geometry to a
grid for resolving invalid geometries. Defaults to 1 meter.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_simplify_tolerance">simplify_tolerance</code></td>
<td>
<p><code>numeric</code> simplification tolerance.
Defaults to 0 meters.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_geometry_precision">geometry_precision</code></td>
<td>
<p><code>numeric</code> level of precision for processing
the spatial data (used with <code><a href="sf.html#topic+st_precision">sf::st_set_precision()</a></code>). The
default argument is 1500 (higher values indicate higher precision).
This level of precision is generally suitable for analyses at the
national-scale. For analyses at finer-scale resolutions, please
consider using a greater value (e.g. 10000).</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_erase_overlaps">erase_overlaps</code></td>
<td>
<p><code>logical</code> should overlapping boundaries be
erased? This is useful for making comparisons between individual
protected areas and understanding their &quot;effective&quot; geographic coverage.
On the other hand, this processing step may not be needed
(e.g. if the protected area boundaries are going to be rasterized), and so
processing time can be substantially by skipping this step and setting
the argument to <code>FALSE</code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_clean_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> should progress on data cleaning be reported?
Defaults to <code>TRUE</code> in an interactive session, otherwise
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function cleans data following best practices
(Butchart <em>et al.</em> 2015; Protected Planet 2021; Runge <em>et al.</em> 2015).
To obtain accurate protected area coverage statistics for a country,
please note that you will need to manually clip the cleaned data to
the countries' coastline and its Exclusive Economic Zone (EEZ).
</p>

<ol>
<li><p> Exclude protected areas according to their status (i.e.
<code>"STATUS"</code> field). Specifically, protected areas that have
a status not specified in the argument to <code>retain_status</code> are excluded.
By default, only protected areas that have a
<code>"Designated"</code>, <code>"Inscribed"</code>, or <code>"Established"</code> status are retained.
This means that the default behavior is to exclude protected that
are not currently implemented.
</p>
</li>
<li><p> Exclude United Nations Educational, Scientific and Cultural
Organization (UNESCO) Biosphere Reserves (Coetzer <em>et al.</em> 2014).
This step is only performed if the argument to <code>exclude_unesco</code> is
<code>TRUE</code>.
</p>
</li>
<li><p> Standardize column names. This is important so that data
imported as in shapefile or file geodatabase format have the
same column names. Specifically, if present, the <code>"PARENT_ISO3"</code> field is
renamed to &quot;PARENT_ISO&quot; and the &quot;SHAPE&quot; field is renamed to
<code>"geometry"</code>.
</p>
</li>
<li><p> Create a field (<code>"GEOMETRY_TYPE"</code>) indicating if areas are
represented as point localities (<code>"POINT"</code>) or as polygons
(<code>"POLYGON"</code>).
</p>
</li>
<li><p> Exclude areas represented as point localities that do not
have a reported spatial extent (i.e. missing data for the field
</p>
</li>
<li><p> Geometries are wrapped to the dateline (using
<code><a href="sf.html#topic+st_transform">sf::st_wrap_dateline()</a></code> with the options
<code>"WRAPDATELINE=YES"</code> and <code>"DATELINEOFFSET=180"</code>).
</p>
</li>
<li><p> Reproject data to coordinate system specified in argument to
<code>crs</code> (using <code><a href="sf.html#topic+st_transform">sf::st_transform()</a></code>).
</p>
</li>
<li><p> Repair any invalid geometries that have manifested
(using <code><a href="#topic+st_repair_geometry">st_repair_geometry()</a></code>).
</p>
</li>
<li><p> Buffer areas represented as point localities to circular areas
using their reported spatial extent (using data in the field
<code>"REP_AREA"</code> and <code><a href="sf.html#topic+geos_unary">sf::st_buffer()</a></code>; see Visconti
<em>et al.</em> 2013).
</p>
</li>
<li><p> Snap the geometries to a grid to fix any remaining
geometry issues (using argument to <code>snap_tolerance</code> and
<code><a href="lwgeom.html#topic+st_snap_to_grid">lwgeom::st_snap_to_grid()</a></code>).
</p>
</li>
<li><p> Repair any invalid geometries that have manifested
(using <code><a href="#topic+st_repair_geometry">st_repair_geometry()</a></code>).
</p>
</li>
<li><p> Simplify the protected area geometries to reduce computational burden
(using argument to <code>simplify_tolerance</code> and
<code><a href="sf.html#topic+geos_unary">sf::st_simplify()</a></code>).
</p>
</li>
<li><p> Repair any invalid geometries that have manifested
(using <code><a href="#topic+st_repair_geometry">st_repair_geometry()</a></code>).
</p>
</li>
<li><p> The <code>"MARINE"</code> field is converted from integer codes
to descriptive names (i.e. <code>0</code> = <code>"terrestrial"</code>,
<code>1</code> = <code>"partial"</code>, <code>2</code> = <code>"marine"</code>).
</p>
</li>
<li><p> The <code>"PA_DEF"</code> field is converted from integer codes
to descriptive names (i.e. <code>0</code> = <code>"OECM"</code>, and <code>1</code> = <code>"PA"</code>).
</p>
</li>
<li><p> Zeros in the <code>"STATUS_YR"</code> field are replaced with
missing values (i.e. <code>NA_real_</code> values).
</p>
</li>
<li><p> Zeros in the <code>"NO_TK_AREA"</code> field are replaced with <code>NA</code>
values for areas where such data are not reported or applicable
(i.e. areas with the values <code>"Not Applicable"</code>
or <code>"Not Reported"</code> in the <code>"NO_TK_AREA"</code> field).
</p>
</li>
<li><p> Overlapping geometries are erased from the protected area data
(discussed in Deguignet <em>et al.</em> 2017). Geometries are erased such
that areas associated with more effective management
categories (<code>"IUCN_CAT"</code>) or have historical precedence are retained
(using <code><a href="sf.html#topic+geos_binary_ops">sf::st_difference()</a></code>).
</p>
</li>
<li><p> Slivers are removed (geometries with areas less than 0.1 square
meters).
</p>
</li>
<li><p> The size of areas are calculated in square kilometers and stored in
the field <code>"AREA_KM2"</code>.
</p>
</li>
<li><p> Trimming extra leading or trailing white space characters
from the <code>"MANG_PLAN"</code> field  (e.g., <code>" "</code>, <code>"\n"</code>, <code>"\r"</code>).
</p>
</li></ol>



<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>Recommended practices for large datasets</h3>

<p>This function can be used to clean large datasets assuming that
sufficient computational resources and time are available.
Indeed, it can clean data spanning large countries, multiple
countries, and even the full global dataset.
When processing the full global dataset, it is recommended to use a
computer system with at least 32 GB RAM available and to allow for at least
one full day for the data cleaning procedures to complete.
It is also recommended to avoid using the computer system for any other
tasks while the data cleaning procedures are being completed,
because they are very computationally intensive.
Additionally, when processing large datasets &ndash; and especially
for the global dataset &ndash; it is strongly recommended to disable the
procedure for erasing overlapping areas.
This is because the built-in procedure for erasing overlaps is
very time consuming when processing many protected areas, so that
information on each protected area can be output
(e.g. IUCN category, year established).
Instead, when cleaning large datasets, it is recommended to run
the data cleaning procedures with the procedure for erasing
overlapping areas disabled (i.e. with <code>erase_overlaps = FALSE</code>).
After the data cleaning procedures have completed,
the protected area data can be manually dissolved
to remove overlapping areas (e.g. using <code><a href="#topic+wdpa_dissolve">wdpa_dissolve()</a></code>).
For an example of processing a large protected area dataset,
please see the vignette.
</p>


<h3>References</h3>

<p>Butchart SH, Clarke M, Smith RJ, Sykes RE, Scharlemann JP,
Harfoot M, ... &amp; Brooks TM (2015) Shortfalls and solutions for
meeting national and global conservation area targets.
<em>Conservation Letters</em>, <strong>8</strong>: 329&ndash;337.
</p>
<p>Coetzer KL, Witkowski ET, &amp; Erasmus BF (2014) Reviewing
Biosphere Reserves globally: Effective conservation action or bureaucratic
label? <em>Biological Reviews</em>, <strong>89</strong>: 82&ndash;104.
</p>
<p>Deguignet M, Arnell A, Juffe-Bignoli D, Shi Y, Bingham H, MacSharry B &amp;
Kingston N (2017) Measuring the extent of overlaps in protected area
designations. <em>PloS One</em>, <strong>12</strong>: e0188681.
</p>
<p>Runge CA, Watson JEM, Butchart HM, Hanson JO, Possingham HP &amp; Fuller RA
(2015) Protected areas and global conservation of migratory birds.
<em>Science</em>, <strong>350</strong>: 1255&ndash;1258.
</p>
<p>Protected Planet (2021) Calculating protected and OECM area coverage.
Available at:
<a href="https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage">https://www.protectedplanet.net/en/resources/calculating-protected-area-coverage</a>.
</p>
<p>Visconti P, Di Marco M, Alvarez-Romero JG, Januchowski-Hartley SR, Pressey,
RL, Weeks R &amp; Rondinini C (2013) Effects of errors and gaps in spatial data
sets on assessment of conservation progress. <em>Conservation Biology</em>,
<strong>27</strong>: 1000&ndash;1010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wdpa_fetch">wdpa_fetch()</a></code>, <code><a href="#topic+wdpa_dissolve">wdpa_dissolve()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# fetch data for the Liechtenstein
lie_raw_data &lt;- wdpa_fetch("LIE", wait = TRUE)

# clean data
lie_data &lt;- wdpa_clean(lie_raw_data)

# plot cleaned dataset
plot(lie_data)


## End(Not run)
</code></pre>

<hr>
<h2 id='wdpa_dissolve'>Dissolve data</h2><span id='topic+wdpa_dissolve'></span>

<h3>Description</h3>

<p>Create a dataset of spatial boundaries that contains no
overlapping geometries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_dissolve(x, geometry_precision = 1500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wdpa_dissolve_+3A_x">x</code></td>
<td>
<p><code><a href="sf.html#topic+sf">sf::sf()</a></code> object.</p>
</td></tr>
<tr><td><code id="wdpa_dissolve_+3A_geometry_precision">geometry_precision</code></td>
<td>
<p><code>numeric</code> level of precision for processing
the spatial data (used with <code><a href="sf.html#topic+st_precision">sf::st_set_precision()</a></code>). The
default argument is 1500 (higher values indicate higher precision).
This level of precision is generally suitable for analyses at the
national-scale. For analyses at finer-scale resolutions, please
consider using a greater value (e.g. 10000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is basically a wrapper for <code><a href="sf.html#topic+geos_combine">sf::st_union()</a></code>.
It also contains additional parameters to assist with processing
large and complex geometry data.
</p>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="sf.html#topic+geos_combine">sf::st_union()</a></code>, <code><a href="#topic+st_erase_overlaps">st_erase_overlaps()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create data
pl1 &lt;- sf::st_polygon(list(matrix(c(0, 0, 2, 0, 1, 1, 0, 0), byrow = TRUE,
                                  ncol = 2))) * 100
pl2 &lt;- sf::st_polygon(list(matrix(c(0, 0.5, 2, 0.5, 1, 1.5, 0, 0.5),
                                  byrow = TRUE, ncol = 2))) * 100
pl3 &lt;- sf::st_polygon(list(matrix(c(0, 1.25, 2, 1.25, 1, 2.5, 0, 1.25),
                                  byrow = TRUE, ncol = 2))) * 100
x &lt;- sf::st_sf(order = c("A", "B", "C"),
               geometry = sf::st_sfc(list(pl1, pl2, pl3), crs = 3395))

# dissolve data
y &lt;- wdpa_dissolve(x)

# plot data for visual comparison
par(mfrow = c(1, 2))
plot(sf::st_geometry(x), xlim = c(0, 200), ylim = c(0, 250),
     main = "original", col = "transparent")
plot(sf::st_geometry(y), , xlim = c(0, 200), ylim = c(0, 250),
     main = "dissolved", col = "transparent")
</code></pre>

<hr>
<h2 id='wdpa_fetch'>Fetch data</h2><span id='topic+wdpa_fetch'></span>

<h3>Description</h3>

<p>Fetch data from <a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Specifically, data are downloaded from the
World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
<strong>Note that data are downloaded assuming non-commercial use.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_fetch(
  x,
  wait = FALSE,
  download_dir = tempdir(),
  force_download = FALSE,
  check_version = TRUE,
  n = NULL,
  page_wait = 2,
  datatype = "gdb",
  verbose = interactive()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wdpa_fetch_+3A_x">x</code></td>
<td>
<p><code>character</code> country for which to download data. This argument
can be the name of the country (e.g. <code>"Liechtenstein"</code>) or the
ISO-3 code for the country (e.g. <code>"LIE"</code>). This argument can also
be set to <code>"global"</code> to download all of the protected areas available
in the database (approximately 1.1 GB).</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_wait">wait</code></td>
<td>
<p><code>logical</code> if data is not immediately available for download
should the session be paused until it is ready for download? If argument
to <code>wait</code> is <code>FALSE</code> and the data is not ready then <code>NA</code>
will be returned. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_download_dir">download_dir</code></td>
<td>
<p><code>character</code> folder path to download the data.
Defaults to a temporary directory. To avoid downloading the
same dataset multiple times, it is recommended to use a persistent
directory (e.g. <code>rappdirs::user_data_dir("wdpar")</code>; see Examples below).</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_force_download">force_download</code></td>
<td>
<p><code>logical</code> if the data has previously been
downloaded and is available at argument to <code>download_dir</code>, should a
fresh copy be downloaded? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_check_version">check_version</code></td>
<td>
<p><code>logical</code> if the data are being imported from
from the argument to <code>download_dir</code>, should the data be checked to see
if the version number matches the latest version available online?
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_n">n</code></td>
<td>
<p><code>integer</code> number of records to import per data source.
Defaults to <code>NULL</code> such that all data are imported.</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_page_wait">page_wait</code></td>
<td>
<p><code>numeric</code> number of seconds to wait for web pages
to load when finding the download URL on
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Defaults to 2.
Since the process of finding a download URL requires
navigating through multiple web pages,
the default argument means that the function will take at least 8
seconds to complete.
Users on slow internet connections may experience issues
with the default argument (e.g. resulting in an error
containing the message <code>Error: Summary: NoSuchElement</code>).
To avoid this, users can try specifying a greater value (e.g. 5 seconds).</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_datatype">datatype</code></td>
<td>
<p><code>character</code> denoting the file format for which to download
protected area data. Available options include: (<code>"shp"</code>) shapefile format
and (<code>"gdb"</code>) file geodatabase format. Defaults to '&quot;gdb&quot;.
Note that global data are only available in file geodatabase format.</p>
</td></tr>
<tr><td><code id="wdpa_fetch_+3A_verbose">verbose</code></td>
<td>
<p><code>logical</code> should a progress on downloading data be
reported? Defaults to <code>TRUE</code> in an interactive session, otherwise
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains and imports data from Protected Planet.
By default (per <code>force_download = FALSE</code>), it will check to see if the
data have already been downloaded and, if so, simply import the previously
downloaded data.
It will also check to see if a newer version of the dataset is available
on Protected Planet (per <code>check_version = TRUE</code>) and, if so, provide an
alert.
If the latest version is not required, this alert can be safely ignored.
However, if the latest version of the data is required,
then using <code>force_download = TRUE</code> will ensure that the latest version
is always obtained.
After importing the data, it is strongly recommended to clean the data
prior to analysis (see <code><a href="#topic+wdpa_clean">wdpa_clean()</a></code>).
</p>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>Data source</h3>

<p>The <code>PA_DEF</code> column indicates the data source for individual
areas and sites that comprise the imported dataset.
Specifically, data obtained through the World Database on Protected Areas
(WDPA) are indicated with a value of <code>1</code> in the <code>PA_DEF</code> column.
Additionally, data obtained through the World Database on Other Effective
Area-Based Conservation Measures (WDOECM) are indicated with a value of <code>0</code>
in the <code>PA_DEF</code> column.
For more details on data conventions, please consult the official manual
(UNEP-WCMC 2019).
</p>


<h3>Troubleshooting</h3>

<p>The function requires a Chromium-based browser
(e.g., Google Chrome, Chromium, or Brave) to be installed.
This is because it uses the <span class="pkg">chromote</span> to find the URL
for downloading data from Protected Planet.
If you don't have one of these browsers installed, then please try
installing Google Chrome.
If you do have one of these browsers installed and this function
throws an error indicating that it can't find the browser,
try setting the <code>CHROMOTE_CHROME</code> environment variable to the
file path of the executable. For example, you could do this with:
</p>
<div class="sourceCode"><pre>Sys.setenv(CHROMOTE_CHROME = "INSERT_FILE_PATH_HERE.exe")
</pre></div>
<p>Also, the function will sometimes produce a message
that complains about a <code>handle_read_frame</code> error. Please understand
that this message is, in fact, not an error and can be safely ignored
(see <a href="https://github.com/rstudio/chromote/pull/111">https://github.com/rstudio/chromote/pull/111</a>).
As such, if you see this message when running the function,
you can assume that the function still worked correctly.
For reference, the misleading message will look something like this:
</p>
<div class="sourceCode"><pre>[error] handle_read_frame error: websocketpp.transport:7 (End of File)
</pre></div>
<p>For further help with troubleshooting, please refer to the documentation
for the <span class="pkg">chromote</span> package (https://rstudio.github.io/chromote/).
</p>


<h3>References</h3>

<p>UNEP-WCMC (2019). User Manual for the World Database on Protected Areas and
world database on other effective area-based conservation measures: 1.6.
UNEP-WCMC: Cambridge, UK. Available at: <a href="https://wcmc.io/WDPA_Manual">https://wcmc.io/WDPA_Manual</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wdpa_clean">wdpa_clean()</a></code>, <code><a href="#topic+wdpa_read">wdpa_read()</a></code>,
<code><a href="#topic+wdpa_url">wdpa_url()</a></code>, <code><a href="countrycode.html#topic+countrycode">countrycode::countrycode()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# fetch data for Liechtenstein
lie_raw_data &lt;- wdpa_fetch("Liechtenstein", wait = TRUE)

# print data
print(lie_raw_data)

# plot data
plot(lie_raw_data)

# fetch data for Liechtenstein using the ISO3 code
lie_raw_data &lt;- wdpa_fetch("LIE", wait = TRUE)

# since data are saved in a temporary directory by default,
# a persistent directory can be specified to avoid having to download the
# same dataset every time the R session is restarted
lie_raw_data &lt;- wdpa_fetch("LIE", wait = TRUE,
                           download_dir = rappdirs::user_data_dir("wdpar"))

# data for multiple countries can be downloaded separately and combined,
# this is useful to avoid having to download the global dataset
## load packages to easily merge datasets
library(dplyr)
library(tibble)

## define country names to download
country_codes &lt;- c("LIE", "MHL")

## download data for each country
mult_data &lt;- lapply(country_codes, wdpa_fetch, wait = TRUE)

## merge datasets together
mult_dat &lt;- st_as_sf(as_tibble(bind_rows(mult_data)))

## print data
print(mult_dat)

## End(Not run)
</code></pre>

<hr>
<h2 id='wdpa_latest_version'>Query latest version</h2><span id='topic+wdpa_latest_version'></span>

<h3>Description</h3>

<p>Find the latest version of the combined
World Database on Protected Areas
(WDPA) and World Database on Other Effective Area-Based Conservation Measures
(WDOECM) dataset.
This is a character identifier representing the month and year (e.g.
<code>Sep2020</code>) the data were released.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_latest_version()
</code></pre>


<h3>Details</h3>

<p>The version number is determined using a web address where the
global dataset is available. For specific details, please refer to
the source code for this function.
</p>


<h3>Value</h3>

<p>A <code>character</code> value with the dataset version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# find the latest version
wdpa_latest_version()

## End(Not run)

</code></pre>

<hr>
<h2 id='wdpa_read'>Read data</h2><span id='topic+wdpa_read'></span>

<h3>Description</h3>

<p>Read data obtained from
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Specifically, this function is designed to import data obtained from
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_read(x, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wdpa_read_+3A_x">x</code></td>
<td>
<p><code>character</code> file name for a zip archive file downloaded from
<a href="https://www.protectedplanet.net/en">https://www.protectedplanet.net/en</a>.</p>
</td></tr>
<tr><td><code id="wdpa_read_+3A_n">n</code></td>
<td>
<p><code>integer</code> number of records to import per data source.
Defaults to <code>NULL</code> such that all data are imported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that data have previously been downloaded to
your computer, and need to import the data.
After importing the data, it is strongly recommended to clean the data
prior to analysis (see <code><a href="#topic+wdpa_clean">wdpa_clean()</a></code>).
</p>


<h3>Value</h3>

<p>A <code><a href="sf.html#topic+sf">sf::sf()</a></code> object.
</p>


<h3>Data source</h3>

<p>The <code>PA_DEF</code> column indicates the data source for individual
areas and sites that comprise the imported dataset.
Specifically, data obtained through the World Database on Protected Areas
(WDPA) are indicated with a value of <code>1</code> in the <code>PA_DEF</code> column.
Additionally, data obtained through the World Database on Other Effective
Area-Based Conservation Measures (WDOECM) are indicated with a value of <code>0</code>
in the <code>PA_DEF</code> column.
For more details on data conventions, please consult the official manual
(UNEP-WCMC 2019).
</p>


<h3>References</h3>

<p>UNEP-WCMC (2019). User Manual for the World Database on Protected Areas and
world database on other effective area-based conservation measures: 1.6.
UNEP-WCMC: Cambridge, UK. Available at: <a href="https://wcmc.io/WDPA_Manual">https://wcmc.io/WDPA_Manual</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wdpa_fetch">wdpa_fetch()</a></code>, <code><a href="#topic+wdpa_clean">wdpa_clean()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# find url for Liechtenstein dataset
download_url &lt;- wdpa_url("LIE", wait = TRUE)

# path to save file zipfile with data
path &lt;- tempfile(pattern = "WDPA_", fileext = ".zip")

# download zipfile
result &lt;- httr::GET(download_url, httr::write_disk(path))

# load data
lie_raw_data &lt;- wdpa_read(path)

# plot data
plot(lie_raw_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='wdpa_url'>Download URL</h2><span id='topic+wdpa_url'></span>

<h3>Description</h3>

<p>Obtain a URL to download data from
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Specifically, the URL provides access to data available through
the World Database on Protected Areas
(WDPA) and the World Database on Other Effective Area-Based Conservation
Measures (WDOECM).
<strong>Note that data are accessed assuming non-commercial use.</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wdpa_url(x, wait = FALSE, page_wait = 2, datatype = "gdb")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wdpa_url_+3A_x">x</code></td>
<td>
<p><code>character</code> country for desired data. This argument
can be the name of the country (e.g. <code>"Liechtenstein"</code>) or the
ISO-3 code for the country (e.g. <code>"LIE"</code>). This argument can also
be set to <code>"global"</code> to obtain the URL for the global dataset.</p>
</td></tr>
<tr><td><code id="wdpa_url_+3A_wait">wait</code></td>
<td>
<p><code>logical</code> if data is not immediately available for download
should the session be paused until it is ready for download? If argument
to <code>wait</code> is <code>FALSE</code> and the data is not ready then an error
will be thrown. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wdpa_url_+3A_page_wait">page_wait</code></td>
<td>
<p><code>numeric</code> number of seconds to wait for web pages
to load when finding the download URL on
<a href="https://www.protectedplanet.net/en">Protected Planet</a>.
Defaults to 2.
Since the process of finding a download URL requires
navigating through multiple web pages,
the default argument means that the function will take at least 8
seconds to complete.
Users on slow internet connections may experience issues
with the default argument (e.g. resulting in an error
containing the message <code>Error: Summary: NoSuchElement</code>).
To avoid this, users can try specifying a greater value (e.g. 5 seconds).</p>
</td></tr>
<tr><td><code id="wdpa_url_+3A_datatype">datatype</code></td>
<td>
<p><code>character</code> denoting the file format for which to download
protected area data. Available options include: (<code>"shp"</code>) shapefile format
and (<code>"gdb"</code>) file geodatabase format. Defaults to '&quot;gdb&quot;.
Note that global data are only available in file geodatabase format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>character</code> value with the URL to download the data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wdpa_fetch">wdpa_fetch()</a></code>, <code><a href="countrycode.html#topic+countrycode">countrycode::countrycode()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# obtain url for New Zealand data
nzl_url &lt;- wdpa_url("New Zealand", wait = TRUE)
print(nzl_url)

# obtain url for New Zealand data using its ISO3 code
nzl_url &lt;- wdpa_url("NZL", wait = TRUE)
print(nzl_url)

# obtain url for global data
global_url &lt;- wdpa_url("global")
print(global_url)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
