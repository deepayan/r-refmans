<!DOCTYPE html><html><head><title>Help for package IPCWK</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IPCWK}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#IPCWK'><p>Kendall's Tau Partial Corr. for Survival Trait and Biomarkers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Kendall's Tau Partial Corr. for Survival Trait and Biomarkers</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>We propose the inverse probability-of-censoring weighted (IPCW) Kendall's tau to measure the association of the survival trait with biomarkers and Kendall's partial correlation to reflect the relationship of the survival trait with interaction variable conditional on main effects, as described in Wang and Chen (2020) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtaa017">doi:10.1093/bioinformatics/btaa017</a>&gt;. </td>
</tr>
<tr>
<td>Author:</td>
<td>Jie-Huei Wang, and Yi-Hau Chen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jie-Huei Wang &lt;jhwang@mail.fcu.edu.tw&gt;</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-26</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.3), MASS, survival, stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-25 18:23:04 UTC; user</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-26 16:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='IPCWK'>Kendall's Tau Partial Corr. for Survival Trait and Biomarkers</h2><span id='topic+IPCWK'></span>

<h3>Description</h3>

<p>The function proposes the inverse probability-of-censoring weighted (IPCW) Kendall's tau to measure the association of the survival trait with biomarkers and Kendall's partial correlation to reflect the relationship of the survival trait with interaction variable conditional on main effects, as described in Wang and Chen (2020) &lt;doi:10.1093/bioinformatics/btaa017&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPCWK(data, standarize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IPCWK_+3A_data">data</code></td>
<td>
<p>The <code class="reqn">N \times P</code> matrix of data. There are <code class="reqn">N</code> individuals in matrix, with one individual in each row. The <code class="reqn">P</code> columns orderly included the observable times which are time-to-event or censoring times and without ties at the event times, the status is a binary variable with 1 indicating the event has occured and 0 indicating (right) censoring, and the (<code class="reqn">P-2</code>) main predictors. Note that the missing values of predictors in the data are not allowed in this version.</p>
</td></tr>
<tr><td><code id="IPCWK_+3A_standarize">standarize</code></td>
<td>
<p>Setting to &quot;FALSE&quot;, point out the original gene espressions profiles are not standarized. We are going to standarize the gene features automatically by IPCWK function. Setting to &quot;TRUE&quot;, point out the original gene espressions profiles have been standarized. We maintain the original gene features matrix to do the following analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with components
</p>
<table>
<tr><td><code>CORR</code></td>
<td>
<p>The <code class="reqn">3 \times K</code> proposed correlation matrix, where K is the dimension of all biomarkers include main and interaction effects with one method in each row. The first row means the IPCW Kendall's tau correlation; the second row means the original Kendall's tau correlation without considering censoring scheme and the final row means the proposed Kendall's partial correlation. Note that the column names of &quot;CORR&quot; matrix is gene index, in which &quot;Ga&quot; means the ath main gene and &quot;Ga&amp;Gb&quot; means the ath main gene interact with the bth main gene.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wang JH, and Chen YH* (2020) Interaction Screening by Kendall's Partial Correlation for Ultrahigh-dimensional Data with Survival Trait. published in  Bioinformatics &lt;doi:10.1093/bioinformatics/btaa017&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
library(MASS)
library(survival)

numbeta=50
N=100 
beta0=matrix(0, numbeta, 1)
sigma1=0.5^abs(outer(1:numbeta, 1:numbeta, "-"))
W1=mvrnorm(N, beta0, sigma1, tol=1e-8, empirical=FALSE)
Z1=W1^2-1

### produce quadratic and two-way interaction effects ###
tempZZ1=matrix(Z1^2, N, numbeta)
tempZZ2=model.matrix(~(.)^2 - . -1, data=data.frame(Z1))
AZ=cbind(Z1, cbind(tempZZ1, tempZZ2))

### identify true predictors: G1, G10, G1&amp;G1, G10&amp;G10, G1&amp;G10, G10&amp;G20 ###
a=3
beta=matrix(0, dim(AZ)[2], 1)
beta[1,]=-0.8*a
beta[10,]=a
beta[51,]=1.2*a
beta[60,]=a
beta[109,]=-1.2*a
beta[515,]=a

### simulate survival time follows linear transformation model ###
C=matrix(runif(N,0,1), N, 1)
ST=X=S=matrix(0, N, 1)
temp=rexp(N)
ST=as.numeric(0.5*log(2*temp*exp(-AZ%*%beta)+1))
X=pmin(ST, C) 
S=(ST==X)
survdata=cbind(X, S, Z1)

### perform IPCWK function ###
test=IPCWK(data=survdata, standarize="FALSE")
true=which(beta!=0)
sum(order(-abs(test$CORR[1,]))[1:20] %in% true) ### IPCW-tau
sum(order(-abs(test$CORR[2,]))[1:20] %in% true) ### Kendall's tau
sum(order(-abs(test$CORR[3,]))[1:20] %in% true) ### PC-IPCW-tau
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
