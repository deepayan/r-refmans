<!DOCTYPE html><html lang="en"><head><title>Help for package fftab</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fftab}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fftab-package'><p>fftab: Tidy Manipulation of Fourier Transformed Data</p></a></li>
<li><a href='#.as_fftab_obj'><p>Build a FFTAB Object</p></a></li>
<li><a href='#.correlation'><p>Compute Normalized Correlation Between Two Signals</p></a></li>
<li><a href='#.dim'><p>Retrieve Object Dimensions</p></a></li>
<li><a href='#.fft'><p>Compute the Fast Fourier Transform (FFT) of a Vector</p></a></li>
<li><a href='#.find_dc_row'><p>Binary search for the DC row in lexicographically sorted data</p></a></li>
<li><a href='#.fourier_frequencies'><p>Compute Fourier frequencies for default inputs</p></a></li>
<li><a href='#.frequency'><p>Retrieve Frequency</p></a></li>
<li><a href='#.get_dim_cols'><p>Select Columns Starting with <code>.dim_</code></p></a></li>
<li><a href='#.is_array'><p>Check if an Object is an Array</p></a></li>
<li><a href='#.is_complex'><p>Check if an Object is Complex</p></a></li>
<li><a href='#.is_normalized'><p>Check if an Object is Normalized</p></a></li>
<li><a href='#.is_ts'><p>Check if an Object is a Time Series</p></a></li>
<li><a href='#.num_samples'><p>Compute the number of samples in an input</p></a></li>
<li><a href='#.nyquist'><p>Compute Nyquist Frequency</p></a></li>
<li><a href='#.phase_diff'><p>Compute Phase Difference Between Two Signals</p></a></li>
<li><a href='#.set_repr'><p>Set Representation Format</p></a></li>
<li><a href='#.shift_phase'><p>Shift Phase</p></a></li>
<li><a href='#.size'><p>Retrieve Object Size</p></a></li>
<li><a href='#.tsp'><p>Retrieve Time Series Parameters</p></a></li>
<li><a href='#.variance'><p>Compute Variance</p></a></li>
<li><a href='#add_cplx'><p>Add Additional Representations to Fourier Coefficients</p></a></li>
<li><a href='#add_l2nm'><p>Add L2 Norm and Squared L2 Norm of Frequency Dimensions</p></a></li>
<li><a href='#can_repr'><p>Manage Representations of a <code>fftab</code> Object</p></a></li>
<li><a href='#cross_spec'><p>Compute the Cross-Spectrum (Cross FFT)</p></a></li>
<li><a href='#fft_internal_filters'><p>Remove DC Component and Symmetric Frequencies</p></a></li>
<li><a href='#fftab'><p>Perform FFT and IFFT with Tidy Results</p></a></li>
<li><a href='#fourier_frequencies'><p>Compute Fourier Frequencies</p></a></li>
<li><a href='#get_fx'><p>Extract Fourier Coefficients and Components</p></a></li>
<li><a href='#get_rect'><p>Extract Rectangular or Polar Components</p></a></li>
<li><a href='#has_cplx'><p>Check Representations of a <code>fftab</code> Object</p></a></li>
<li><a href='#phase_diff'><p>Compute Phase Difference and Maximum Correlation Between Two Signals</p></a></li>
<li><a href='#plot.fftab'><p>Plot the modulus of FFT results</p></a></li>
<li><a href='#to_cplx'><p>Convert a <code>fftab</code> Object Between Representations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Tidy Manipulation of Fourier Transformed Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'fftab' package stores Fourier coefficients in a tibble and 
  allows their manipulation in various ways. Functions are available for converting 
  between complex, rectangular ('re', 'im'), and polar ('mod', 'arg') representations, 
  as well as for extracting components as vectors or matrices. Inputs can include 
  vectors, time series, and arrays of arbitrary dimensions, which are restored 
  to their original form when inverting the transform. Since 'fftab' stores Fourier 
  frequencies as columns in the tibble, many standard operations on spectral data 
  can be easily performed using tidy packages like 'dplyr'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggfortify, patchwork, testthat (&ge; 3.0.0), zoo</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, lifecycle, tibble, tidyr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/thk686/fftab">https://github.com/thk686/fftab</a>, <a href="https://thk686.github.io/fftab/">https://thk686.github.io/fftab/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/thk686/fftab/issues">https://github.com/thk686/fftab/issues</a></td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-13 22:31:34 UTC; keittth</td>
</tr>
<tr>
<td>Author:</td>
<td>Timothy Keitt [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Timothy Keitt &lt;tkeitt@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-15 10:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='fftab-package'>fftab: Tidy Manipulation of Fourier Transformed Data</h2><span id='topic+fftab-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>The 'fftab' package stores Fourier coefficients in a tibble and allows their manipulation in various ways. Functions are available for converting between complex, rectangular ('re', 'im'), and polar ('mod', 'arg') representations, as well as for extracting components as vectors or matrices. Inputs can include vectors, time series, and arrays of arbitrary dimensions, which are restored to their original form when inverting the transform. Since 'fftab' stores Fourier frequencies as columns in the tibble, many standard operations on spectral data can be easily performed using tidy packages like 'dplyr'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Timothy Keitt <a href="mailto:tkeitt@gmail.com">tkeitt@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/thk686/fftab">https://github.com/thk686/fftab</a>
</p>
</li>
<li> <p><a href="https://thk686.github.io/fftab/">https://thk686.github.io/fftab/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/thk686/fftab/issues">https://github.com/thk686/fftab/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.as_fftab_obj'>Build a FFTAB Object</h2><span id='topic+.as_fftab_obj'></span>

<h3>Description</h3>

<p>Converts an object into a <code>fftab</code> object with additional metadata attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.as_fftab_obj(x, .is_normalized, .is_complex, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".as_fftab_obj_+3A_x">x</code></td>
<td>
<p>The input object to convert, typically a tibble or data frame.</p>
</td></tr>
<tr><td><code id=".as_fftab_obj_+3A_.is_normalized">.is_normalized</code></td>
<td>
<p>A logical value indicating if the input is normalized.</p>
</td></tr>
<tr><td><code id=".as_fftab_obj_+3A_.is_complex">.is_complex</code></td>
<td>
<p>A logical value indicating if the original data was complex.</p>
</td></tr>
<tr><td><code id=".as_fftab_obj_+3A_...">...</code></td>
<td>
<p>Additional attributes to include in the structured object, such as
metadata or specific attributes required for Fourier Transform analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input object <code>x</code>, with the <code>fftab</code> class and any additional
attributes provided in <code>...</code>.
</p>

<hr>
<h2 id='.correlation'>Compute Normalized Correlation Between Two Signals</h2><span id='topic+.correlation'></span>

<h3>Description</h3>

<p>Computes the normalized correlation between two signals based on their Fourier representations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.correlation(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".correlation_+3A_a">a</code></td>
<td>
<p>A <code>fftab</code> object or signal representing the first input.</p>
</td></tr>
<tr><td><code id=".correlation_+3A_b">b</code></td>
<td>
<p>A <code>fftab</code> object or signal representing the second input.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the <strong>cross-spectrum</strong> of two signals, removes the DC component,
and calculates the real part of the cross-spectrum sum. The result is normalized using the
variances of both signals.
</p>
<p>Normalization ensures that the correlation value lies between -1 and 1.
</p>


<h3>Value</h3>

<p>A numeric value representing the <strong>normalized correlation</strong> between the two signals.
</p>

<hr>
<h2 id='.dim'>Retrieve Object Dimensions</h2><span id='topic+.dim'></span>

<h3>Description</h3>

<p>Retrieves the <code>.dim</code> attribute from an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.dim(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".dim_+3A_x">x</code></td>
<td>
<p>An R object to check for dimensions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>.dim</code> attribute or <code>NULL</code> if not present.
</p>

<hr>
<h2 id='.fft'>Compute the Fast Fourier Transform (FFT) of a Vector</h2><span id='topic+.fft'></span>

<h3>Description</h3>

<p>Computes the Fast Fourier Transform (FFT) of a numeric vector.
Optionally, normalizes the result by dividing it by the length of the input vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.fft(x, norm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".fft_+3A_x">x</code></td>
<td>
<p>A numeric vector representing the input signal to transform.</p>
</td></tr>
<tr><td><code id=".fft_+3A_norm">norm</code></td>
<td>
<p>A logical value indicating whether to normalize the FFT output
by dividing it by the length of the input vector. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function wraps around the base R <code>stats::fft</code> function and provides an
option for normalization.
</p>


<h3>Value</h3>

<p>A complex vector representing the FFT of the input signal.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fft">stats::fft()</a></code>
</p>

<hr>
<h2 id='.find_dc_row'>Binary search for the DC row in lexicographically sorted data</h2><span id='topic+.find_dc_row'></span>

<h3>Description</h3>

<p>Binary search for the DC row in lexicographically sorted data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.find_dc_row(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".find_dc_row_+3A_df">df</code></td>
<td>
<p>A tibble or data.frame with <code style="white-space: pre;">&#8288;.dim_*&#8288;</code> columns sorted lexicographically.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Row index of the DC component (0,0,...,0).
</p>

<hr>
<h2 id='.fourier_frequencies'>Compute Fourier frequencies for default inputs</h2><span id='topic+.fourier_frequencies'></span>

<h3>Description</h3>

<p>Computes normalized Fourier frequencies for scalar or vector inputs, which
are evenly spaced between -0.5 and 0.5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.fourier_frequencies(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".fourier_frequencies_+3A_x">x</code></td>
<td>
<p>A scalar or vector representing the length of the sequence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the normalized Fourier frequencies.
</p>

<hr>
<h2 id='.frequency'>Retrieve Frequency</h2><span id='topic+.frequency'></span>

<h3>Description</h3>

<p>Retrieves the frequency of a time series object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.frequency(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".frequency_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object or time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The frequency value or <code>1</code> if not a time series.
</p>

<hr>
<h2 id='.get_dim_cols'>Select Columns Starting with <code>.dim_</code></h2><span id='topic+.get_dim_cols'></span>

<h3>Description</h3>

<p>Selects columns from a data frame whose names start with <code>.dim_</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_dim_cols(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".get_dim_cols_+3A_x">x</code></td>
<td>
<p>A data frame or tibble from which to select columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing only the columns that start with <code>.dim_</code>.
</p>

<hr>
<h2 id='.is_array'>Check if an Object is an Array</h2><span id='topic+.is_array'></span>

<h3>Description</h3>

<p>Determines if an object has a <code>.dim</code> attribute, indicating it is an array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_array(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_array_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the object has a <code>.dim</code> attribute, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='.is_complex'>Check if an Object is Complex</h2><span id='topic+.is_complex'></span>

<h3>Description</h3>

<p>Checks whether an object has the <code>.is_complex</code> attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_complex(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_complex_+3A_x">x</code></td>
<td>
<p>An R object to check for complexity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether the <code>.is_complex</code> attribute is <code>TRUE</code>.
</p>

<hr>
<h2 id='.is_normalized'>Check if an Object is Normalized</h2><span id='topic+.is_normalized'></span>

<h3>Description</h3>

<p>Checks whether an object has the <code>.is_normalized</code> attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_normalized(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_normalized_+3A_x">x</code></td>
<td>
<p>An R object to check for normalization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether the <code>.is_normalized</code> attribute is <code>TRUE</code>.
Returns <code>NULL</code> if the attribute does not exist.
</p>

<hr>
<h2 id='.is_ts'>Check if an Object is a Time Series</h2><span id='topic+.is_ts'></span>

<h3>Description</h3>

<p>Determines if an object has a <code>.tsp</code> attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_ts(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_ts_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the object has a <code>.tsp</code> attribute, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='.num_samples'>Compute the number of samples in an input</h2><span id='topic+.num_samples'></span>

<h3>Description</h3>

<p>This helper function determines the number of samples in the input object.
For a vector, it returns its length. For a matrix or data frame, it returns
the number of rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.num_samples(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".num_samples_+3A_x">x</code></td>
<td>
<p>An input object (scalar, vector, matrix, or data frame).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer representing the number of samples (rows) in the input
object.
</p>

<hr>
<h2 id='.nyquist'>Compute Nyquist Frequency</h2><span id='topic+.nyquist'></span>

<h3>Description</h3>

<p>Computes the Nyquist frequency for an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.nyquist(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".nyquist_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Nyquist frequency (<code>.frequency(x) / 2</code>).
</p>

<hr>
<h2 id='.phase_diff'>Compute Phase Difference Between Two Signals</h2><span id='topic+.phase_diff'></span>

<h3>Description</h3>

<p>Computes the phase difference between two signals based on their cross-spectrum,
with symmetric and redundant frequency components removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.phase_diff(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".phase_diff_+3A_a">a</code></td>
<td>
<p>A <code>fftab</code> object or signal representing the first input.</p>
</td></tr>
<tr><td><code id=".phase_diff_+3A_b">b</code></td>
<td>
<p>A <code>fftab</code> object or signal representing the second input.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the <strong>cross-spectrum</strong> of two signals, removes symmetric and redundant
frequency components, converts the result into polar representation, weights the phase angles
by their magnitudes, and calculates the weighted average phase difference.
</p>
<p>Removing symmetric components ensures accurate phase alignment, avoiding ambiguity caused
by redundant negative frequencies.
</p>


<h3>Value</h3>

<p>A numeric value representing the <strong>phase difference</strong> (in radians) between the two signals.
</p>

<hr>
<h2 id='.set_repr'>Set Representation Format</h2><span id='topic+.set_repr'></span>

<h3>Description</h3>

<p>Converts an object into a specific representation format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.set_repr(x, repr, .keep = "unused")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".set_repr_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
<tr><td><code id=".set_repr_+3A_repr">repr</code></td>
<td>
<p>The representation type (<code>"cplx"</code>, <code>"rect"</code>, <code>"polr"</code>).</p>
</td></tr>
<tr><td><code id=".set_repr_+3A_.keep">.keep</code></td>
<td>
<p>Controls preservation of data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The object in the specified representation format.
</p>

<hr>
<h2 id='.shift_phase'>Shift Phase</h2><span id='topic+.shift_phase'></span>

<h3>Description</h3>

<p>Adjusts the phase of Fourier coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.shift_phase(x, shift)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".shift_phase_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
<tr><td><code id=".shift_phase_+3A_shift">shift</code></td>
<td>
<p>A numeric value indicating the phase shift.</p>
</td></tr>
</table>

<hr>
<h2 id='.size'>Retrieve Object Size</h2><span id='topic+.size'></span>

<h3>Description</h3>

<p>Retrieves the <code>.size</code> attribute from an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.size(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".size_+3A_x">x</code></td>
<td>
<p>An R object to check for size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>.size</code> attribute or <code>NULL</code> if not present.
</p>

<hr>
<h2 id='.tsp'>Retrieve Time Series Parameters</h2><span id='topic+.tsp'></span>

<h3>Description</h3>

<p>Retrieves the <code>.tsp</code> attribute from an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.tsp(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".tsp_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>.tsp</code> attribute or <code>NULL</code> if not present.
</p>

<hr>
<h2 id='.variance'>Compute Variance</h2><span id='topic+.variance'></span>

<h3>Description</h3>

<p>Computes the variance of Fourier coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.variance(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".variance_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric variance value.
</p>

<hr>
<h2 id='add_cplx'>Add Additional Representations to Fourier Coefficients</h2><span id='topic+add_cplx'></span><span id='topic+add_rect'></span><span id='topic+add_polr'></span>

<h3>Description</h3>

<p>These functions add additional representations to a <code>fftab</code> object without removing or modifying existing representations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_cplx(x)

add_rect(x)

add_polr(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_cplx_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object containing Fourier coefficients and associated metadata.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>add_cplx()</code></strong>: Adds a <strong>complex</strong> (<code>"cplx"</code>) representation to the Fourier coefficients.
</p>
</li>
<li> <p><strong><code>add_rect()</code></strong>: Adds a <strong>rectangular</strong> (<code>"rect"</code>) representation to the Fourier coefficients.
</p>
</li>
<li> <p><strong><code>add_polr()</code></strong>: Adds a <strong>polar</strong> (<code>"polr"</code>) representation to the Fourier coefficients.
</p>
</li></ul>

<p>These functions are useful for working with multiple representations simultaneously without overwriting existing data.
</p>


<h3>Value</h3>

<p>A <code>fftab</code> object with the additional representation included.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+fftab">fftab()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>matrix(1:9, 3) |&gt;
  fftab() |&gt;
  print(n = 3) |&gt;
  add_polr() |&gt;
  print(n = 3) |&gt;
  add_rect() |&gt;
  print(n = 3) |&gt;
  add_cplx() |&gt;
  print(n = 3)

</code></pre>

<hr>
<h2 id='add_l2nm'>Add L2 Norm and Squared L2 Norm of Frequency Dimensions</h2><span id='topic+add_l2nm'></span><span id='topic+add_l2sq'></span><span id='topic+get_l2nm'></span><span id='topic+get_l2sq'></span>

<h3>Description</h3>

<p>These functions compute and append the L2 norm and squared L2 norm of the frequency dimensions
(<code style="white-space: pre;">&#8288;.dim_*&#8288;</code> columns) as new columns in a <code>fftab</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_l2nm(x)

add_l2sq(x)

get_l2nm(x)

get_l2sq(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_l2nm_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object containing frequency dimensions (<code style="white-space: pre;">&#8288;.dim_*&#8288;</code>) and associated metadata.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>add_l2nm()</code></strong>: Appends a column <code>l2nm</code> containing the L2 norm, calculated as the square root
of the sum of squared values across <code style="white-space: pre;">&#8288;.dim_*&#8288;</code> columns.
</p>
</li>
<li> <p><strong><code>add_l2sq()</code></strong>: Appends a column <code>l2sq</code> containing the squared L2 norm, calculated as the sum
of squared values across <code style="white-space: pre;">&#8288;.dim_*&#8288;</code> columns.
</p>
</li>
<li> <p><strong><code>get_l2nm()</code></strong>: Returns a numeric vector representing the L2 norm for each row.
</p>
</li>
<li> <p><strong><code>get_l2sq()</code></strong>: Returns a numeric vector representing the squared L2 norm for each row.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector or <code>fftab</code> object with additional columns:
</p>

<ul>
<li> <p><strong><code>l2nm</code></strong>: The L2 norm of the frequency dimensions.
</p>
</li>
<li> <p><strong><code>l2sq</code></strong>: The squared L2 norm of the frequency dimensions.
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+fftab">fftab()</a></code>
</p>
</li>
<li> <p><code><a href="tibble.html#topic+add_column">tibble::add_column()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>matrix(1:9, 3) |&gt;
  fftab() |&gt;
  print(n = 3) |&gt;
  add_l2nm() |&gt;
  print(n = 3) |&gt;
  add_l2sq() |&gt;
  print(n = 3)

</code></pre>

<hr>
<h2 id='can_repr'>Manage Representations of a <code>fftab</code> Object</h2><span id='topic+can_repr'></span><span id='topic+get_repr'></span><span id='topic+set_repr'></span>

<h3>Description</h3>

<p>These functions handle representation management for a <code>fftab</code> object:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>can_repr(x, repr)

get_repr(x)

set_repr(x, repr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="can_repr_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object.</p>
</td></tr>
<tr><td><code id="can_repr_+3A_repr">repr</code></td>
<td>
<p>For <code>can_repr()</code>, a character vector specifying representations (<code>"polr"</code>, <code>"rect"</code>, <code>"cplx"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>get_repr()</code></strong>: Retrieve current representations.
</p>
</li>
<li> <p><strong><code>can_repr()</code></strong>: Check if the object supports specific representations.
</p>
</li>
<li> <p><strong><code>set_repr()</code></strong>: Convert the object to one or more specified representations.
</p>
</li></ul>



<h3>Value</h3>


<ul>
<li> <p><strong><code>can_repr()</code></strong>: Logical value (<code>TRUE</code> or <code>FALSE</code>) indicating if the object supports the specified representations.
</p>
</li>
<li> <p><strong><code>get_repr()</code></strong>: A character vector of current representations.
</p>
</li>
<li> <p><strong><code>set_repr()</code></strong>: A modified <code>fftab</code> object with the specified representation(s).
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+to_cplx">to_cplx()</a></code>, <code><a href="#topic+has_cplx">has_cplx()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0)) |&gt; can_repr("cplx")

fftab(c(1, 0, -1, 0)) |&gt; get_repr()

fftab(c(1, 0, -1, 0)) |&gt; set_repr(c("polr", "rect"))

</code></pre>

<hr>
<h2 id='cross_spec'>Compute the Cross-Spectrum (Cross FFT)</h2><span id='topic+cross_spec'></span><span id='topic+cross_spec.default'></span><span id='topic+cross_spec.ts'></span><span id='topic+cross_spec.array'></span><span id='topic+cross_spec.fftab'></span>

<h3>Description</h3>

<p>The <code>cross_spec</code> function computes the cross-spectrum between two inputs
using the Fourier transform. It supports multiple input types including
numeric vectors, time series (<code>ts</code>), arrays, and <code>fftab</code> objects.
The function provides options for normalization and controlling whether the
conjugate of the second input is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross_spec(a, b, norm = FALSE, conj = TRUE)

## Default S3 method:
cross_spec(a, b, norm = FALSE, conj = TRUE)

## S3 method for class 'ts'
cross_spec(a, b, norm = FALSE, conj = TRUE)

## S3 method for class 'array'
cross_spec(a, b, norm = FALSE, conj = TRUE)

## S3 method for class 'fftab'
cross_spec(a, b, norm = FALSE, conj = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cross_spec_+3A_a">a</code></td>
<td>
<p>The first input for the cross FFT. Supported types include numeric
vectors, <code>ts</code> objects, arrays, and <code>fftab</code> objects.</p>
</td></tr>
<tr><td><code id="cross_spec_+3A_b">b</code></td>
<td>
<p>The second input for the cross FFT. Must match the dimensions or
structure of <code>a</code>.</p>
</td></tr>
<tr><td><code id="cross_spec_+3A_norm">norm</code></td>
<td>
<p>Logical; if <code>TRUE</code>, normalizes the Fourier transforms before
computation. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cross_spec_+3A_conj">conj</code></td>
<td>
<p>Logical; if <code>TRUE</code>, uses the complex conjugate of the Fourier
transform of <code>b</code>. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object representing the cross-spectrum:
</p>

<ul>
<li><p> For <code>default</code> and <code>fftab</code> methods: A <code>fftab</code> object.
</p>
</li>
<li><p> For <code>ts</code> objects: A <code>fftab</code> object with <code>.tsp</code> attributes inherited
from <code>a</code>.
</p>
</li>
<li><p> For arrays: A <code>fftab</code> object with <code>.dim</code> attributes inherited
from <code>a</code>.
</p>
</li></ul>



<h3>Methods (by class)</h3>


<ul>
<li> <p><code>cross_spec(default)</code>: Default method for computing cross FFT.
Converts inputs to <code>fftab</code> objects before computation.
</p>
</li>
<li> <p><code>cross_spec(ts)</code>: Method for time series (<code>ts</code>) objects.
Ensures the time series frequencies are consistent and preserves the <code>tsp</code> attribute.
</p>
</li>
<li> <p><code>cross_spec(array)</code>: Method for array inputs.
Ensures dimensions are consistent and preserves the <code>dim</code> attribute.
</p>
</li>
<li> <p><code>cross_spec(fftab)</code>: Method for <code>fftab</code> objects.
Performs the cross-frequency transform directly using the Fourier transforms of <code>a</code> and <code>b</code>.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+fftab">fftab()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cross_spec(rnorm(8), rnorm(8), norm = TRUE)

cross_spec(
  ts(rnorm(8), frequency = 4),
  ts(rnorm(8), frequency = 4)
)

</code></pre>

<hr>
<h2 id='fft_internal_filters'>Remove DC Component and Symmetric Frequencies</h2><span id='topic+fft_internal_filters'></span><span id='topic+.remove_dc'></span><span id='topic+.remove_symmetric'></span><span id='topic+.split_symmetric'></span>

<h3>Description</h3>

<p>Internal functions to manipulate and filter Fourier coefficients in <code>fftab</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.remove_dc(x)

.remove_symmetric(x)

.split_symmetric(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fft_internal_filters_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object containing Fourier coefficients and associated metadata.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>.remove_dc()</code></strong>: Filters out rows where all <code style="white-space: pre;">&#8288;.dim_*&#8288;</code> columns have a value of <code>0</code>.
</p>
</li>
<li> <p><strong><code>.remove_symmetric()</code></strong>:
</p>

<ul>
<li><p> For real-valued signals, it filters out redundant, complex-conjugate frequencies.
</p>
</li>
<li><p> For complex-valued signals, no filtering is applied as symmetry isn't relevant.
</p>
</li></ul>

</li>
<li> <p><strong><code>.split_symmetric()</code></strong>: Splits the coefficients into symmetric and asymmetric parts.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>fftab</code> object with filtered coefficients.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="dplyr.html#topic+filter">dplyr::filter()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+fftab">fftab()</a></code>
</p>
</li></ul>


<hr>
<h2 id='fftab'>Perform FFT and IFFT with Tidy Results</h2><span id='topic+fftab'></span><span id='topic+fftab.default'></span><span id='topic+fftab.ts'></span><span id='topic+fftab.array'></span><span id='topic+ifftab'></span>

<h3>Description</h3>

<p>Provides functions to compute the Fast Fourier Transform (FFT) and its inverse (IFFT)
while maintaining results in a tabular format. Supports vectors, time series
(<code>ts</code>), and arrays as inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fftab(x, norm = FALSE)

## Default S3 method:
fftab(x, norm = FALSE)

## S3 method for class 'ts'
fftab(x, norm = FALSE)

## S3 method for class 'array'
fftab(x, norm = FALSE)

ifftab(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fftab_+3A_x">x</code></td>
<td>
<p>Input object for which to compute the FFT or IFFT. This can be:
</p>

<ul>
<li><p> A numeric vector (default method for <code>fftab</code>).
</p>
</li>
<li><p> A time series object (<code>ts</code>) for <code>fftab.ts</code>.
</p>
</li>
<li><p> A multidimensional numeric array for <code>fftab.array</code>.
</p>
</li>
<li><p> A <code>fftab</code> object for <code>ifftab</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fftab_+3A_norm">norm</code></td>
<td>
<p>Logical. If <code>TRUE</code>, computes normalized coefficients for FFT.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>fftab</code> organizes FFT results into a tibble for downstream analysis.
</p>
</li>
<li> <p><code>ifftab</code> ensures that reconstructed signals match the input structure (e.g., arrays, <code>ts</code>).
</p>
</li></ul>



<h3>Value</h3>


<ul>
<li> <p><strong><code>fftab</code></strong>: A tibble containing:
</p>

<ul>
<li><p> Fourier frequencies (<code>.dim_1</code>, <code>.dim_2</code>, etc.).
</p>
</li>
<li><p> FFT values stored in the <code>fx</code> column as complex values.
</p>
</li></ul>

</li>
<li> <p><strong><code>ifftab</code></strong>: A vector, array, or time series object representing the reconstructed signal.
</p>
</li></ul>



<h3>FFT</h3>

<p>The <code>fftab</code> function computes the FFT for different input types:
</p>

<ul>
<li> <p><strong>Default Input (<code>fftab.default</code>)</strong>: Computes FFT for numeric vectors.
</p>
</li>
<li> <p><strong>Time Series Input (<code>fftab.ts</code>)</strong>: Handles FFT for <code>ts</code> objects, scaling frequencies appropriately.
</p>
</li>
<li> <p><strong>Array Input (<code>fftab.array</code>)</strong>: Processes multidimensional arrays.
</p>
</li></ul>

<p>Results are returned as a tibble containing Fourier frequencies and FFT values.
</p>


<h3>IFFT</h3>

<p>The <code>ifftab</code> function reconstructs the original signal from a <code>fftab</code> object.
It supports vectors, arrays, and time series inputs. The inverse transform preserves
the original structure (e.g., array dimensions or time series attributes).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fft">stats::fft()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0))

fftab(c(1, 0, -1, 0)) |&gt; ifftab()

ts(sin(1:10), frequency = 12) |&gt; fftab()

array(1:8, dim = c(2, 2, 2)) |&gt; fftab()

</code></pre>

<hr>
<h2 id='fourier_frequencies'>Compute Fourier Frequencies</h2><span id='topic+fourier_frequencies'></span><span id='topic+fourier_frequencies.default'></span><span id='topic+fourier_frequencies.ts'></span><span id='topic+fourier_frequencies.array'></span>

<h3>Description</h3>

<p>Computes Fourier frequencies for various types of inputs, such as scalars,
vectors, matrices, time series, or arrays. This generic function dispatches
appropriate methods based on the input type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fourier_frequencies(x)

## Default S3 method:
fourier_frequencies(x)

## S3 method for class 'ts'
fourier_frequencies(x)

## S3 method for class 'array'
fourier_frequencies(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fourier_frequencies_+3A_x">x</code></td>
<td>
<p>The input object. Supported input types:
</p>

<ul>
<li> <p><strong>Scalar or vector</strong>: The length of the sequence.
</p>
</li>
<li> <p><strong>Time series (<code>ts</code>)</strong>: Frequencies are scaled based on the sampling rate.
</p>
</li>
<li> <p><strong>Multidimensional array or matrix</strong>: Frequencies are computed for each dimension.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has the following methods:
</p>

<ul>
<li> <p><strong>Default Input (<code>fourier_frequencies.default</code>)</strong>: Computes normalized Fourier frequencies for scalar or vector inputs.
</p>
</li>
<li> <p><strong>Time Series Input (<code>fourier_frequencies.ts</code>)</strong>: Computes frequencies scaled by the frequency attribute of a <code>ts</code> object.
</p>
</li>
<li> <p><strong>Multidimensional Arrays (<code>fourier_frequencies.array</code>)</strong>: Computes frequencies for each dimension of a matrix or array.
</p>
</li></ul>

<p>See the examples for details on each case.
</p>


<h3>Value</h3>

<p>A tibble where:
</p>

<ul>
<li> <p><code>.dim_1</code>, <code>.dim_2</code>, ..., represent the Fourier frequencies for each dimension.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="tidyr.html#topic+expand_grid">tidyr::expand_grid()</a></code>, <code><a href="stats.html#topic+frequency">frequency()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Default input (vector)
fourier_frequencies(8)

# Time series input
ts(rnorm(36), frequency = 12) |&gt; fourier_frequencies()

# Multidimensional array input
array(1:27, dim = c(3, 3, 3)) |&gt; fourier_frequencies()

# Matrix input
matrix(1:9, nrow = 3, ncol = 3) |&gt; fourier_frequencies()

</code></pre>

<hr>
<h2 id='get_fx'>Extract Fourier Coefficients and Components</h2><span id='topic+get_fx'></span><span id='topic+get_fx_norm'></span><span id='topic+get_re'></span><span id='topic+get_im'></span><span id='topic+get_mod'></span><span id='topic+get_arg'></span>

<h3>Description</h3>

<p>These utility functions extract specific components from a <code>fftab</code> object.
<code>get_fx</code> retrieves the raw Fourier coefficients, while <code>get_fx_norm</code> ensures the
coefficients are either normalized or not normalized based on the <code>norm</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fx(x)

get_fx_norm(x, norm = FALSE)

get_re(x)

get_im(x)

get_mod(x)

get_arg(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fx_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object containing FFT results.</p>
</td></tr>
<tr><td><code id="get_fx_+3A_norm">norm</code></td>
<td>
<p>Logical. If <code>TRUE</code>, forces normalized coefficients. If <code>FALSE</code>,
ensures non-normalized coefficients.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>get_fx</code></strong>: Returns coefficients as they are stored in the <code>fftab</code> object.
</p>
</li>
<li> <p><strong><code>get_fx_norm</code></strong>: Adjusts coefficients if they are not in the desired normalization state.
</p>
</li>
<li> <p><strong><code>get_re</code>, <code>get_im</code></strong>: Extract real and imaginary components.
</p>
</li>
<li> <p><strong><code>get_mod</code>, <code>get_arg</code></strong>: Compute magnitude and phase of coefficients.
</p>
</li></ul>



<h3>Value</h3>

<p>The requested components:
</p>

<ul>
<li> <p><strong><code>get_fx</code></strong>: A complex vector of raw Fourier coefficients (<code>fx</code>) as stored in the object.
</p>
</li>
<li> <p><strong><code>get_fx_norm</code></strong>: A complex vector of Fourier coefficients, explicitly normalized
or non-normalized based on the <code>norm</code> parameter.
</p>
</li>
<li> <p><strong><code>get_re</code></strong>: A numeric vector of real parts (<code>re</code>).
</p>
</li>
<li> <p><strong><code>get_im</code></strong>: A numeric vector of imaginary parts (<code>im</code>).
</p>
</li>
<li> <p><strong><code>get_mod</code></strong>: A numeric vector of magnitudes (<code>mod</code>).
</p>
</li>
<li> <p><strong><code>get_arg</code></strong>: A numeric vector of phase angles (<code>arg</code>), in radians.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+to_cplx">to_cplx()</a></code>, <code><a href="#topic+to_rect">to_rect()</a></code>, <code><a href="#topic+to_polr">to_polr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0)) |&gt; get_fx()

fftab(c(1, 0, -1, 0)) |&gt; get_fx_norm(norm = TRUE)

fftab(c(1, 0, -1, 0)) |&gt; get_re()

fftab(c(1, 0, -1, 0)) |&gt; get_im()

fftab(c(1, 0, -1, 0)) |&gt; get_mod()

fftab(c(1, 0, -1, 0)) |&gt; get_arg()

</code></pre>

<hr>
<h2 id='get_rect'>Extract Rectangular or Polar Components</h2><span id='topic+get_rect'></span><span id='topic+get_polr'></span>

<h3>Description</h3>

<p>The <code>get_rect</code> and <code>get_polr</code> functions extract specific components from a
<code>fftab</code> object, representing the Fourier coefficients in either rectangular
or polar form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rect(x)

get_polr(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_rect_+3A_x">x</code></td>
<td>
<p>A matrix object containing FFT results.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><strong><code>get_rect</code></strong>: A matrix with two columns:
</p>

<ul>
<li> <p><code>re</code>: The real part of the coefficients.
</p>
</li>
<li> <p><code>im</code>: The imaginary part of the coefficients.
</p>
</li></ul>

</li>
<li> <p><strong><code>get_polr</code></strong>: A matrix with two columns:
</p>

<ul>
<li> <p><code>mod</code>: The magnitude of the coefficients.
</p>
</li>
<li> <p><code>arg</code>: The phase angle of the coefficients, in radians.
</p>
</li></ul>

</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+get_fx">get_fx()</a></code>, <code><a href="#topic+get_re">get_re()</a></code>, <code><a href="#topic+get_mod">get_mod()</a></code>, <code><a href="#topic+to_rect">to_rect()</a></code>, <code><a href="#topic+to_polr">to_polr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0)) |&gt; get_rect()

fftab(c(1, 0, -1, 0)) |&gt; get_polr()

</code></pre>

<hr>
<h2 id='has_cplx'>Check Representations of a <code>fftab</code> Object</h2><span id='topic+has_cplx'></span><span id='topic+has_rect'></span><span id='topic+has_polr'></span>

<h3>Description</h3>

<p>These functions check if specific representations are present in a <code>fftab</code> object:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_cplx(x)

has_rect(x)

has_polr(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="has_cplx_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>has_cplx()</code></strong>: Checks if the object has complex representation (<code>fx</code> column).
</p>
</li>
<li> <p><strong><code>has_rect()</code></strong>: Checks if the object has rectangular representation (<code>re</code>, <code>im</code> columns).
</p>
</li>
<li> <p><strong><code>has_polr()</code></strong>: Checks if the object has polar representation (<code>mod</code>, <code>arg</code> columns).
</p>
</li></ul>



<h3>Value</h3>

<p>Logical value (<code>TRUE</code> or <code>FALSE</code>) indicating whether the specified representation exists.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+to_cplx">to_cplx()</a></code>, <code><a href="#topic+get_repr">get_repr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0)) |&gt; has_cplx()

fftab(c(1, 0, -1, 0)) |&gt; has_rect()

fftab(c(1, 0, -1, 0)) |&gt; has_polr()

</code></pre>

<hr>
<h2 id='phase_diff'>Compute Phase Difference and Maximum Correlation Between Two Signals</h2><span id='topic+phase_diff'></span>

<h3>Description</h3>

<p>Computes the phase difference and maximum normalized correlation between two input signals
after phase-aligning the second signal (<code>b</code>) to the first signal (<code>a</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase_diff(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phase_diff_+3A_a">a</code></td>
<td>
<p>A numeric vector or time series representing the first signal.</p>
</td></tr>
<tr><td><code id="phase_diff_+3A_b">b</code></td>
<td>
<p>A numeric vector or time series representing the second signal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function performs the following steps:
</p>

<ol>
<li><p> Computes the Fourier Transform of both input signals using <code>fftab</code>.
</p>
</li>
<li><p> Calculates the <strong>cross-spectrum</strong> of the signals.
</p>
</li>
<li><p> Converts the cross-spectrum to polar form and computes the weighted average phase difference.
</p>
</li>
<li><p> Adjusts the phase of the second signal (<code>b</code>) using <code>.shift_phase</code> to maximize alignment with the first signal (<code>a</code>).
</p>
</li>
<li><p> Computes the <strong>normalized correlation</strong> between the phase-aligned signals.
</p>
</li></ol>

<p>The correlation is normalized using the variances of both signals and will generally be <strong>higher</strong> than the correlation
between the original signals due to the optimal phase alignment.
</p>


<h3>Value</h3>

<p>A numeric vector of length two:
</p>

<ul>
<li><p> The first element represents the <strong>phase difference</strong> (in radians) required to maximize alignment between the two signals.
</p>
</li>
<li><p> The second element represents the <strong>maximum normalized correlation</strong> achieved after phase alignment.
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+fftab">fftab()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+cross_spec">cross_spec()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>phase_diff(
  sin(seq(0, 2 * pi, length.out = 128)),
  cos(seq(0, 2 * pi, length.out = 128))
)

</code></pre>

<hr>
<h2 id='plot.fftab'>Plot the modulus of FFT results</h2><span id='topic+plot.fftab'></span>

<h3>Description</h3>

<p>Plots the modulus of the FFT results against the frequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fftab'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fftab_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object. This should contain Fourier-transformed data.</p>
</td></tr>
<tr><td><code id="plot.fftab_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>ggplot2::ggplot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object representing the modulus of FFT results plotted against the frequencies.
The plot shows the modulus (<code>mod</code>) on the y-axis and frequency values on the x-axis.
</p>

<hr>
<h2 id='to_cplx'>Convert a <code>fftab</code> Object Between Representations</h2><span id='topic+to_cplx'></span><span id='topic+to_rect'></span><span id='topic+to_polr'></span>

<h3>Description</h3>

<p>These functions convert a <code>fftab</code> object to a specified representation:
</p>

<ul>
<li> <p><strong><code>to_cplx()</code></strong>: Converts to complex representation (<code>fx</code>).
</p>
</li>
<li> <p><strong><code>to_rect()</code></strong>: Converts to rectangular representation (<code>re</code>, <code>im</code>).
</p>
</li>
<li> <p><strong><code>to_polr()</code></strong>: Converts to polar representation (<code>mod</code>, <code>arg</code>).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>to_cplx(x, .keep = "unused")

to_rect(x, .keep = "unused")

to_polr(x, .keep = "unused")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_cplx_+3A_x">x</code></td>
<td>
<p>A <code>fftab</code> object.</p>
</td></tr>
<tr><td><code id="to_cplx_+3A_.keep">.keep</code></td>
<td>
<p>Specifies which columns to retain. See <code><a href="dplyr.html#topic+mutate">dplyr::mutate()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong><code>to_cplx()</code></strong>: Converts from rectangular (<code>re</code>, <code>im</code>) or polar (<code>mod</code>, <code>arg</code>) components to complex form.
</p>
</li>
<li> <p><strong><code>to_rect()</code></strong>: Converts from complex (<code>fx</code>) or polar components to rectangular form.
</p>
</li>
<li> <p><strong><code>to_polr()</code></strong>: Converts from complex (<code>fx</code>) or rectangular components to polar form.
</p>
</li></ul>



<h3>Value</h3>

<p>A modified <code>fftab</code> object containing the specified representation:
</p>

<ul>
<li> <p><strong><code>to_cplx()</code></strong>: Adds the <code>fx</code> column for complex values.
</p>
</li>
<li> <p><strong><code>to_rect()</code></strong>: Adds the <code>re</code> and <code>im</code> columns for rectangular components.
</p>
</li>
<li> <p><strong><code>to_polr()</code></strong>: Adds the <code>mod</code> and <code>arg</code> columns for polar components.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+has_cplx">has_cplx()</a></code>, <code><a href="#topic+get_repr">get_repr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fftab(c(1, 0, -1, 0)) |&gt; to_cplx()

fftab(c(1, 0, -1, 0)) |&gt; to_rect()

fftab(c(1, 0, -1, 0)) |&gt; to_polr()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
