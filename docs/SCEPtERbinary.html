<!DOCTYPE html><html lang="en"><head><title>Help for package SCEPtERbinary</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCEPtERbinary}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SCEPtERbinary-package'><p>A grid-based estimation tool for the age of stars in bynary systems</p></a></li>
<li><a href='#block'><p>Block of same initial [Fe/H] for the grid</p></a></li>
<li><a href='#errorObsBin'><p>Perturbe a set of observational data</p></a></li>
<li><a href='#estimateBin'><p>Age estimates for the supplied binary systems</p></a></li>
<li><a href='#sampleBinStar'><p>Sample a set of binary systems out of a grid</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Stellar CharactEristics Pisa Estimation gRid for Binary Systems</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-04-12</td>
</tr>
<tr>
<td>Description:</td>
<td>SCEPtER pipeline for estimating the stellar age for double-lined detached binary systems. The observational constraints adopted in the recovery are the effective temperature, the metallicity [Fe/H], the mass, and the radius of the two stars. The results are obtained adopting a maximum likelihood technique over a grid of pre-computed stellar models.</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), MASS, parallel, SCEPtER</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matteo Dell'Omodarme &lt;mattdell@fastmail.fm&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2014-12-20 14:36:03 UTC; matt</td>
</tr>
<tr>
<td>Author:</td>
<td>Matteo Dell'Omodarme [aut, cre],
  Giada Valle [aut]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2014-12-20 17:38:25</td>
</tr>
</table>
<hr>
<h2 id='SCEPtERbinary-package'>A grid-based estimation tool for the age of stars in bynary systems </h2><span id='topic+SCEPtERbinary-package'></span>

<h3>Description</h3>

<p>The package estimates the age of stars in double-lined detached binary
systems, given  observational 
effective temperature, metallicity [Fe/H], mass, and radius of both stars.
The results are obtained adopting a maximum likelihood
technique on a grid of computed stellar models.
</p>


<h3>References</h3>

<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in grid-based estimates of stellar mass and
radius. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, 561, A125.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in asteroseismic grid-based estimates of stellar ages. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, accepted.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Grid-based estimates of stellar ages in binary
systems. SCEPtER: Stellar CharactEristics Pisa Estimation gRid</em>. A&amp;A, submitted.
</p>

<hr>
<h2 id='block'>Block of same initial [Fe/H] for the grid</h2><span id='topic+block'></span>

<h3>Description</h3>

<p>The function computes the group identifier for grid rows, according to their
initial metallicities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    block(grid)
     </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="block_+3A_grid">grid</code></td>
<td>
<p>the grid of stellar models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>block</code> returns a vector with the group identifier for
each row of the supplied grid. 
</p>

<hr>
<h2 id='errorObsBin'>Perturbe a set of observational data</h2><span id='topic+errorObsBin'></span>

<h3>Description</h3>

<p>The function returns a perturbed object, starting from observational data
and a vector of uncertainties. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    errorObsBin(sigma, STAR, parallel=FALSE, corr=c(0,0,0,0,0,0,0))
     </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="errorObsBin_+3A_sigma">sigma</code></td>
<td>
<p>a vector of 14 elements containing the uncertainties on
observational data. The error on 
mass and radius must be expressed as relative error. If the errors on
the observations of the two stars are identical, it is possible to
provide a vector of length 7.
</p>
</td></tr> 
<tr><td><code id="errorObsBin_+3A_star">STAR</code></td>
<td>
<p>a vector of 18 elements containing  the observational data.</p>
</td></tr>
<tr><td><code id="errorObsBin_+3A_parallel">parallel</code></td>
<td>
<p>logical flag specifying if the computation should be
performed in parallel on a multi-core architecture.</p>
</td></tr>
<tr><td><code id="errorObsBin_+3A_corr">corr</code></td>
<td>
<p>a vector with the assumed the correlation between corresponding
observables of the two stars. Default to zero (no correlations).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector of observations <code>STAR</code> must contain, in the order:
</p>

<ol>
<li><p>The effective temperature (in K) of the star.
</p>
</li>
<li><p>The logarithm of the surface gravity of the star (in cm s^-2).
</p>
</li>
<li><p>The metallicity [Fe/H] of the star.
</p>
</li>
<li><p>The value of large frequency separation of the star, divided by
the solar value of this quantity. 
</p>
</li>
<li><p>The value of the frequency of maximum oscillation power of the
star, divided by 
the solar value of this quantity. 
</p>
</li>
<li><p>The mass (in solar units) of the star. 
</p>
</li>
<li><p>The radius (in solar unit) of the star. 
</p>
</li></ol>

<p>The vector of the uncertainties on the observation <code>sigma</code> must
contain the uncertainty on the above quantity. The
uncertainty on the asteroseismic parameters, mass, and radius 
must be expressed as relative error.
</p>


<h3>Value</h3>

<p><code>errorObsBin</code> returns an object obtained sampling from a
multivariate normal distribution with vector of mean <code>STAR</code> and
covariance matrix computed
according to the value of <code>corr</code>. 
</p>

<hr>
<h2 id='estimateBin'>Age estimates for the supplied binary systems</h2><span id='topic+estimateBin'></span>

<h3>Description</h3>

<p>The function computes the grid-based estimates of the age for
the supplied binary systems. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    estimateBin(data, STAR, sigma, thr, sel, parallel=FALSE)
     </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateBin_+3A_data">data</code></td>
<td>
<p>the matrix estimation grid. The matrix should be sorted according to
the values in the first column (the stellar effective
temperature). </p>
</td></tr>
<tr><td><code id="estimateBin_+3A_star">STAR</code></td>
<td>
<p>a matrix of 18 columns, containing in each row the
observational data of the stellar objects.</p>
</td></tr> 
<tr><td><code id="estimateBin_+3A_sigma">sigma</code></td>
<td>
<p>a vector of 14 elements, containing the error on observational
data. The error on 
mass and radius are expressed as relative error. If the errors on the
observables of the two stars are identical, it is possible to provide a
vector of length 7.</p>
</td></tr>
<tr><td><code id="estimateBin_+3A_thr">thr</code></td>
<td>
<p>the threshold for the selection of cases over which the
computation of likelihood is performed.</p>
</td></tr>
<tr><td><code id="estimateBin_+3A_sel">sel</code></td>
<td>
<p>a vector of 7 elements, containing 1 or 0 for inclusion or
exclusion of a observational data from the likelihood computation.</p>
</td></tr>
<tr><td><code id="estimateBin_+3A_parallel">parallel</code></td>
<td>
<p>logical flag indicating if the estimations should be
performed in parallel on a multi-core architecture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>STAR</code> should contains the observables for primary and
secondary stars. In order, it should contains the stellar effective
temperature, 
the logarithm of the surface gravity, the metallicity [Fe/H], the
average large frequency separation (in micro Hz), the maximum
oscillation power (in micro Hz), the mass (in solar units), the radius
(in solar units), the age (if known), and the relative age (if known).
Identical quantities for the secondary stars should follows.
<code>sigma</code> should contain, in the same order, the
uncertainties on the observational quantities.  
</p>
<p><code>estimateBin</code> returns a data frame obtained with the
estimates
of stellar parameters for each row of the input matrix <code>STAR</code>.
In the columns of the data frame there are:
the identifier <code>id</code>
of the row of the object matrix adopted for the estimate; the
independent star estimate of the primary mass
<code>M1</code> (in solar units), radius <code>R1</code> (in
solar units), age <code>age1</code> (in Gyr); the corresponding independent
estimates for the secondary (<code>M2</code>, <code>R2</code>, <code>age2</code>); the
joint-likelihood estimates of these quantities obtained explicitly assuming
coevality (<code>M1b</code>, <code>R1b</code>, <code>age1b</code>, <code>M2b</code>,
<code>R2b</code>, <code>age2b</code>); the relative age <code>r</code> of the primary
star (0 = ZAMS; 1 = TAMS); the best estimate of the age of the system
<code>ageBin</code> under coevality assumption; the mean of the age of the two
independent estimates of the stellar ages.  
</p>
<p>Age estimates are obtained by a maximum likelihood
technique. Details on the technique can
be found in the references reported below.
</p>


<h3>References</h3>

<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in grid-based estimates of stellar mass and
radius. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, 561, A125.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in asteroseismic grid-based estimates of stellar ages. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, accepted.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Grid-based estimates of stellar ages in binary
systems. SCEPtER: Stellar CharactEristics Pisa Estimation gRid</em>. A&amp;A, submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(SCEPtER)
data(stdGrid)
ogrid &lt;- stdGrid[ do.call(order, as.data.frame(stdGrid[,1])), ]

## observational constraint: Teff, [Fe/H], M, R
vsel &lt;- c(1,0,1,0,0,1,1)
sigma &lt;- c(100, 0.25, 0.1, 0.025, 0.05, 0.01, 0.005)

## syntetic sample of 10 bynary systems
bl &lt;- block(stdGrid)
sam &lt;- sampleBinStar(10, stdGrid, bl, restrict=TRUE)

## add Gaussian noise to the observations
starbp &lt;- errorObsBin(sigma, sam)

resB &lt;- estimateBin(ogrid, starbp, sigma, 3, vsel, parallel=FALSE)


## An observed system: PK Peg
## observation from Clausen et al. (2010). A&amp;A, 516, A42.

obs &lt;- c(6265,NA,-0.12,NA,NA,1.414,1.988,NA,NA, 6320,NA,-0.12,NA,NA,1.257,1.474,NA,NA)
sigma &lt;- c(85,0,0.07,0,0,0.007/1.414,0.008/1.988, 90,0,0.07,0,0,0.005/1.257,0.017/1.474)

## for sensible estimate adopt at least nrow=10000
star &lt;- matrix(obs, nrow=100, ncol=18, byrow=TRUE)

## add Gaussian noise
starp &lt;- errorObsBin(sigma, star)

resB &lt;- estimateBin(ogrid, starp, sigma, 3, vsel, parallel=FALSE)

quantile(resB$ageBin, c(0.16, 0.5, 0.84))
</code></pre>

<hr>
<h2 id='sampleBinStar'>Sample a set of binary systems out of a grid</h2><span id='topic+sampleBinStar'></span>

<h3>Description</h3>

<p>The function extracts, without replacement, a sample of binary systems out of a grid.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    sampleBinStar(n, grid, block, restrict=TRUE, parallel=FALSE)
     </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleBinStar_+3A_n">n</code></td>
<td>
<p>the number of objects to be sampled.</p>
</td></tr>
<tr><td><code id="sampleBinStar_+3A_grid">grid</code></td>
<td>
<p>the grid from which the objects are sampled.</p>
</td></tr>
<tr><td><code id="sampleBinStar_+3A_block">block</code></td>
<td>
<p>the length of blocks of the same initial metallicity [Fe/H]</p>
</td></tr>
<tr><td><code id="sampleBinStar_+3A_restrict">restrict</code></td>
<td>
<p>logical flag indicating if only models younger than 14 Gyr
should be considered.</p>
</td></tr>
<tr><td><code id="sampleBinStar_+3A_parallel">parallel</code></td>
<td>
<p>logical flag indicating if the estimations should be
performed in parallel on a multi-core architecture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sampleBinStar</code> returns a matrix of <code>n</code> rows, sampled without
replacement from <code>grid</code>.
A maximum age difference of 10 Myr is allowed in the binary system
selection. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(SCEPtER)
data(stdGrid)

bl &lt;- block(stdGrid)
sam &lt;- sampleBinStar(10, stdGrid, bl, restrict=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
