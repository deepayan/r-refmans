<!DOCTYPE html><html lang="en"><head><title>Help for package esreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {esreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cdf_at_quantile'><p>Cumulative Density Function at Quantile</p></a></li>
<li><a href='#conditional_mean_sigma'><p>Conditional Mean and Sigma</p></a></li>
<li><a href='#conditional_truncated_variance'><p>Conditional truncated variance</p></a></li>
<li><a href='#density_quantile_function'><p>Density Quantile Function</p></a></li>
<li><a href='#esr_loss'><p>Joint Loss Function</p></a></li>
<li><a href='#esr_rho_lp'><p>Joint (VaR, ES) loss for a linear predictor</p></a></li>
<li><a href='#esreg'><p>Joint Quantile and Expected Shortfall Regression</p></a></li>
<li><a href='#estfun.esreg'><p>Estimating function</p></a></li>
<li><a href='#G_vec'><p>Vectorized call to the G1 / G2 functions</p></a></li>
<li><a href='#G1_fun'><p>Specification Function</p></a></li>
<li><a href='#G1_prime_fun'><p>Specification Function</p></a></li>
<li><a href='#G1_prime_prime_fun'><p>Specification Function</p></a></li>
<li><a href='#G2_curly_fun'><p>Specification Function</p></a></li>
<li><a href='#G2_fun'><p>Specification Function</p></a></li>
<li><a href='#G2_prime_fun'><p>Specification Function</p></a></li>
<li><a href='#G2_prime_prime'><p>Specification Function</p></a></li>
<li><a href='#lambda_matrix'><p>Lambda Matrix</p></a></li>
<li><a href='#sigma_matrix'><p>Sigma Matrix</p></a></li>
<li><a href='#vcov.esreg'><p>Covariance Estimation</p></a></li>
<li><a href='#vcovA'><p>Asymptotic Covariance Estimation</p></a></li>
<li><a href='#vcovB'><p>Bootstrap Covariance Estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Joint Quantile and Expected Shortfall Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-12</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Simultaneous modeling of the quantile and the expected shortfall of a response variable given 
    a set of covariates, see Dimitriadis and Bayer (2019) &lt;<a href="https://doi.org/10.1214%2F19-EJS1560">doi:10.1214/19-EJS1560</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>quantreg, Rcpp, stats, Formula</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-13 08:05:33 UTC; sebastian</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Bayer [aut, cre],
  Timo Dimitriadis [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastian Bayer &lt;sebastian.bayer@uni-konstanz.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-13 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cdf_at_quantile'>Cumulative Density Function at Quantile</h2><span id='topic+cdf_at_quantile'></span>

<h3>Description</h3>

<p>Returns the cumulative density function evaluated at quantile predictions.
For a correctly specified model this should yield a value close to the quantile level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf_at_quantile(y, x, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdf_at_quantile_+3A_y">y</code></td>
<td>
<p>Vector of dependent data</p>
</td></tr>
<tr><td><code id="cdf_at_quantile_+3A_x">x</code></td>
<td>
<p>Matrix of covariates including the intercept</p>
</td></tr>
<tr><td><code id="cdf_at_quantile_+3A_q">q</code></td>
<td>
<p>Vector of quantile predictions</p>
</td></tr>
</table>

<hr>
<h2 id='conditional_mean_sigma'>Conditional Mean and Sigma</h2><span id='topic+conditional_mean_sigma'></span>

<h3>Description</h3>

<p>Estimate the conditional mean and sigma of the dependent data conditional on covariates x
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditional_mean_sigma(y, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditional_mean_sigma_+3A_y">y</code></td>
<td>
<p>Vector of dependent data</p>
</td></tr>
<tr><td><code id="conditional_mean_sigma_+3A_x">x</code></td>
<td>
<p>Matrix of covariates including the intercept</p>
</td></tr>
</table>

<hr>
<h2 id='conditional_truncated_variance'>Conditional truncated variance</h2><span id='topic+conditional_truncated_variance'></span>

<h3>Description</h3>

<p>Estimate the variance of y given x and given y &lt;= 0.
If approach is:
</p>

<ol>
<li><p> ind -  Variance of all y where y &lt;= 0.
</p>
</li>
<li><p> scl_N or scl_sp - Assumes a location-scale model:
y = x'b + (x'g)e. First, it estimates b and g using PMLE.
Then, it computes the conditional truncated variance by integrating the truncated density of y.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>conditional_truncated_variance(y, x, approach)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditional_truncated_variance_+3A_y">y</code></td>
<td>
<p>Vector of dependent data</p>
</td></tr>
<tr><td><code id="conditional_truncated_variance_+3A_x">x</code></td>
<td>
<p>Matrix of covariates including the intercept</p>
</td></tr>
<tr><td><code id="conditional_truncated_variance_+3A_approach">approach</code></td>
<td>
<p>ind, scl_N or scl_sp</p>
</td></tr>
</table>

<hr>
<h2 id='density_quantile_function'>Density Quantile Function</h2><span id='topic+density_quantile_function'></span>

<h3>Description</h3>

<p>Estimate the density quantile function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>density_quantile_function(y, x, u, alpha, sparsity, bandwidth_estimator)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="density_quantile_function_+3A_y">y</code></td>
<td>
<p>Vector of dependent data</p>
</td></tr>
<tr><td><code id="density_quantile_function_+3A_x">x</code></td>
<td>
<p>Matrix of covariates</p>
</td></tr>
<tr><td><code id="density_quantile_function_+3A_u">u</code></td>
<td>
<p>Quantile residuals</p>
</td></tr>
<tr><td><code id="density_quantile_function_+3A_alpha">alpha</code></td>
<td>
<p>Probability level</p>
</td></tr>
<tr><td><code id="density_quantile_function_+3A_sparsity">sparsity</code></td>
<td>
<p>iid or ind</p>
</td></tr>
<tr><td><code id="density_quantile_function_+3A_bandwidth_estimator">bandwidth_estimator</code></td>
<td>
<p>Bofinger, Chamberlain or Hall-Sheather</p>
</td></tr>
</table>


<h3>References</h3>

<p>For the iid and nid method, see Koenker (1994), and Hendricks and Koenker (1992).
For the bandwidth types, see Bofinger (1975), Chamberlain (1994), and Hall and Sheather(1988).
</p>

<hr>
<h2 id='esr_loss'>Joint Loss Function</h2><span id='topic+esr_loss'></span>

<h3>Description</h3>

<p>Computes the joint (VaR, ES) loss
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esr_loss(r, q, e, alpha, g1 = 2L, g2 = 1L, return_mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="esr_loss_+3A_r">r</code></td>
<td>
<p>Vector of returns</p>
</td></tr>
<tr><td><code id="esr_loss_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="esr_loss_+3A_e">e</code></td>
<td>
<p>Vector of expected shortfalls</p>
</td></tr>
<tr><td><code id="esr_loss_+3A_alpha">alpha</code></td>
<td>
<p>Probability level</p>
</td></tr>
<tr><td><code id="esr_loss_+3A_g1">g1</code></td>
<td>
<p>1, 2, see <a href="#topic+G1_fun">G1_fun</a></p>
</td></tr>
<tr><td><code id="esr_loss_+3A_g2">g2</code></td>
<td>
<p>1, 2, 3, 4, 5, see <a href="#topic+G2_curly_fun">G2_curly_fun</a>, <a href="#topic+G2_fun">G2_fun</a></p>
</td></tr>
<tr><td><code id="esr_loss_+3A_return_mean">return_mean</code></td>
<td>
<p>If TRUE returns the average tick loss, else the individual values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fissler and Ziegel (2016)
</p>

<hr>
<h2 id='esr_rho_lp'>Joint (VaR, ES) loss for a linear predictor</h2><span id='topic+esr_rho_lp'></span>

<h3>Description</h3>

<p>Returns the loss for the parameter vector b
</p>


<h3>Usage</h3>

<pre><code class='language-R'>esr_rho_lp(b, y, xq, xe, alpha, g1 = 2L, g2 = 1L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="esr_rho_lp_+3A_b">b</code></td>
<td>
<p>Parameter vector</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_y">y</code></td>
<td>
<p>Vector of dependent data</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_xq">xq</code></td>
<td>
<p>Matrix of covariates for the quantile part</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_xe">xe</code></td>
<td>
<p>Matrix of covariates for the expected shortfall part</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_alpha">alpha</code></td>
<td>
<p>Probability level</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_g1">g1</code></td>
<td>
<p>1, 2 (see <a href="#topic+G1_fun">G1_fun</a>)</p>
</td></tr>
<tr><td><code id="esr_rho_lp_+3A_g2">g2</code></td>
<td>
<p>1, 2, 3, 4, 5 (see <a href="#topic+G2_curly_fun">G2_curly_fun</a>, <a href="#topic+G2_fun">G2_fun</a>)</p>
</td></tr>
</table>

<hr>
<h2 id='esreg'>Joint Quantile and Expected Shortfall Regression</h2><span id='topic+esreg'></span><span id='topic+esreg.formula'></span><span id='topic+esreg.default'></span>

<h3>Description</h3>

<p>Estimates a joint linear regression model for the pair (VaR, ES):
</p>
<p style="text-align: center;"><code class="reqn">Q_\alpha(Y | Xq) = Xq'\beta_q</code>
</p>

<p style="text-align: center;"><code class="reqn">ES_\alpha(Y | Xe) = Xe'\beta_e</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>esreg(...)

## S3 method for class 'formula'
esreg(
  formula,
  data = parent.frame(),
  alpha,
  g1 = 2L,
  g2 = 1L,
  early_stopping = 10,
  ...
)

## Default S3 method:
esreg(xq, xe, y, alpha, g1 = 2L, g2 = 1L, early_stopping = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="esreg_+3A_...">...</code></td>
<td>
<p>Further arguments (does not apply here)</p>
</td></tr>
<tr><td><code id="esreg_+3A_formula">formula</code></td>
<td>
<p>Formula: y ~ x1 + x2 ... | x1 + x2 ...
where the first part after the response variable specifies the quantile equation
and the second the expected shortfall part. If only one set of regressors is
provided it is used for both model specifications.</p>
</td></tr>
<tr><td><code id="esreg_+3A_data">data</code></td>
<td>
<p>data.frame that holds the variables</p>
</td></tr>
<tr><td><code id="esreg_+3A_alpha">alpha</code></td>
<td>
<p>Probability level</p>
</td></tr>
<tr><td><code id="esreg_+3A_g1">g1</code></td>
<td>
<p>1, 2 (see <a href="#topic+G1_fun">G1_fun</a>, <a href="#topic+G1_prime_fun">G1_prime_fun</a>), defaults to 1</p>
</td></tr>
<tr><td><code id="esreg_+3A_g2">g2</code></td>
<td>
<p>1, 2, 3, 4, 5 (see <a href="#topic+G2_curly_fun">G2_curly_fun</a>, <a href="#topic+G2_fun">G2_fun</a>, <a href="#topic+G2_prime_fun">G2_prime_fun</a>). defaults to 2</p>
</td></tr>
<tr><td><code id="esreg_+3A_early_stopping">early_stopping</code></td>
<td>
<p>Stop the iterated local search if there is no improvement in early_stopping steps.</p>
</td></tr>
<tr><td><code id="esreg_+3A_xq">xq</code></td>
<td>
<p>Explanatory variables for the quantile regression equation</p>
</td></tr>
<tr><td><code id="esreg_+3A_xe">xe</code></td>
<td>
<p>Explanatory variables for the expected shortfall regression equation</p>
</td></tr>
<tr><td><code id="esreg_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An esreg object
</p>


<h3>References</h3>

<p><a href="https://arxiv.org/abs/1704.02213">A Joint Quantile and Expected Shortfall Regression Framework</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vcov.esreg">vcov.esreg</a></code> for covariance estimation
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate data (DGP-(2) in the linked paper)
set.seed(0)
x &lt;- rchisq(1000, df=1)
y &lt;- -x + (1 + 0.5 * x) * rnorm(1000)

# True quantile and expected shortfall regression parameters (for alpha=0.025)
alpha=0.025
true_pars &lt;- c(-1.959964, -1.979982, -2.337803, -2.168901)

# Estimate the model using the standard settings
fit &lt;- esreg(y ~ x, alpha=alpha)

# Compare the different variance-covariance estimators
cov1 &lt;- vcov(object=fit, sparsity="iid", sigma_est="ind")
cov2 &lt;- vcov(object=fit, sparsity="nid", sigma_est="scl_N")
cov3 &lt;- vcov(object=fit, sparsity="nid", sigma_est="scl_sp")

print("Comparison of the variance-covariance estimators")
print(cbind(Truth=true_pars,
            Estimate=coef(fit),
            SE_iid_ind=sqrt(diag(cov1)),
            SE_nid_N=sqrt(diag(cov2)),
            SE_nid_sp=sqrt(diag(cov3))))

# Compares estimates using different G2 functions
fit1 &lt;- esreg(y ~ x, alpha=alpha, g2=1)
fit2 &lt;- esreg(y ~ x, alpha=alpha, g2=2)
fit3 &lt;- esreg(y ~ x, alpha=alpha, g2=3)
fit4 &lt;- esreg(y ~ x, alpha=alpha, g2=4)
fit5 &lt;- esreg(y ~ x, alpha=alpha, g2=5)
fits &lt;- sapply(list(fit1, fit2, fit3, fit4, fit5), coef)
colnames(fits) &lt;- sapply(1:5, function(i) esreg:::.G_function_names(1, i)[2])
print("Comparison of the five G2 functions")
print(rbind(Truth=true_pars, t(fits)))

# Usage of different covariates
x &lt;- rchisq(1000, df=1)
noise &lt;- rnorm(1000)
y &lt;- -x + (1 + 0.5 * x) * rnorm(1000)
fit &lt;- esreg(y ~ x | x + noise, alpha=0.025)
print("Using different covariates for VaR and ES")
print(summary(fit))

</code></pre>

<hr>
<h2 id='estfun.esreg'>Estimating function</h2><span id='topic+estfun.esreg'></span>

<h3>Description</h3>

<p>This function matches the estfun function of the sandwich package and
returns the estimating functions for the fitted model.
It can for instance be used for an OPG estimator of the sigma matrix.
For esreg, the dimension of the estimating functions is n x (kq + ke).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estfun.esreg(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estfun.esreg_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+esreg">esreg</a> object</p>
</td></tr>
<tr><td><code id="estfun.esreg_+3A_...">...</code></td>
<td>
<p>Further arguments (does not apply here)</p>
</td></tr>
</table>

<hr>
<h2 id='G_vec'>Vectorized call to the G1 / G2 functions</h2><span id='topic+G_vec'></span>

<h3>Description</h3>

<p>Vectorized call to the G1 / G2 functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G_vec(z, g, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G_vec_+3A_z">z</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="G_vec_+3A_g">g</code></td>
<td>
<p>String, either G1, G1_prime, G2_curly, G2 or G2_curly</p>
</td></tr>
<tr><td><code id="G_vec_+3A_type">type</code></td>
<td>
<p>Numeric, for G1: 1-2; G2: 1-5
(see <a href="#topic+G1_fun">G1_fun</a>, <a href="#topic+G1_prime_fun">G1_prime_fun</a>, <a href="#topic+G2_curly_fun">G2_curly_fun</a>, <a href="#topic+G2_fun">G2_fun</a>, <a href="#topic+G2_prime_fun">G2_prime_fun</a>)</p>
</td></tr>
</table>

<hr>
<h2 id='G1_fun'>Specification Function</h2><span id='topic+G1_fun'></span>

<h3>Description</h3>

<p>G1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G1_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G1_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G1_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G1 function:
</p>

<ul>
<li><p> 1: G1(z) = z
</p>
</li>
<li><p> 2: G1(z) = 0
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G1_prime_fun'>Specification Function</h2><span id='topic+G1_prime_fun'></span>

<h3>Description</h3>

<p>G1_prime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G1_prime_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G1_prime_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G1_prime_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G1_prime function:
</p>

<ul>
<li><p> 1: G1_prime(z) = 1
</p>
</li>
<li><p> 2: G1_prime(z) = 0
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G1_prime_prime_fun'>Specification Function</h2><span id='topic+G1_prime_prime_fun'></span>

<h3>Description</h3>

<p>G1_prime_prime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G1_prime_prime_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G1_prime_prime_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G1_prime_prime_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G1_prime_prime function:
</p>

<ul>
<li><p> 1: G1_prime(z) = 0
</p>
</li>
<li><p> 2: G1_prime(z) = 0
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G2_curly_fun'>Specification Function</h2><span id='topic+G2_curly_fun'></span>

<h3>Description</h3>

<p>G2_curly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G2_curly_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G2_curly_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G2_curly_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G2_curly function:
</p>

<ul>
<li><p> 1: -log(-z), z &lt; 0
</p>
</li>
<li><p> 2: -sqrt(-z), z &lt; 0
</p>
</li>
<li><p> 3: -1/z, z &lt; 0
</p>
</li>
<li><p> 4: log(1 + exp(z))
</p>
</li>
<li><p> 5: exp(z)
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G2_fun'>Specification Function</h2><span id='topic+G2_fun'></span>

<h3>Description</h3>

<p>G2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G2_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G2_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G2_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G2 function:
</p>

<ul>
<li><p> 1: -1/z, z &lt; 0
</p>
</li>
<li><p> 2: 0.5/sqrt(-z), z &lt; 0
</p>
</li>
<li><p> 3: 1/z^2, z &lt; 0
</p>
</li>
<li><p> 4: 1 / (1 + exp(-z))
</p>
</li>
<li><p> 5: exp(z)
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G2_prime_fun'>Specification Function</h2><span id='topic+G2_prime_fun'></span>

<h3>Description</h3>

<p>G2_prime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G2_prime_fun(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G2_prime_fun_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G2_prime_fun_+3A_type">type</code></td>
<td>
<p>Choice of the G2_prime function:
</p>

<ul>
<li><p> 1: 1/z^2, z &lt; 0
</p>
</li>
<li><p> 2: 0.25 / (-z)^(3/2), z &lt; 0
</p>
</li>
<li><p> 3: -2/z^3, z &lt; 0
</p>
</li>
<li><p> 4: exp(z) / (1 + exp(z))^2
</p>
</li>
<li><p> 5: exp(z)
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='G2_prime_prime'>Specification Function</h2><span id='topic+G2_prime_prime'></span>

<h3>Description</h3>

<p>G2_prime_prime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G2_prime_prime(z, type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G2_prime_prime_+3A_z">z</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="G2_prime_prime_+3A_type">type</code></td>
<td>
<p>Choice of the G2_prime_prime function:
</p>

<ul>
<li><p> 1: -2/z^3, z &lt; 0
</p>
</li>
<li><p> 2: 0.375 / (-z)^(5/2), z &lt; 0
</p>
</li>
<li><p> 3: 6/z^4, z &lt; 0
</p>
</li>
<li><p> 4: -(exp(z) * (exp(z) - 1)) / (exp(z) + 1)^3
</p>
</li>
<li><p> 5: exp(z)
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='lambda_matrix'>Lambda Matrix</h2><span id='topic+lambda_matrix'></span>

<h3>Description</h3>

<p>Estimate the lambda matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_matrix(object, sparsity, bandwidth_estimator, misspec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lambda_matrix_+3A_object">object</code></td>
<td>
<p>An esreg object</p>
</td></tr>
<tr><td><code id="lambda_matrix_+3A_sparsity">sparsity</code></td>
<td>
<p>The estimator to be used for the sparsity in <code class="reqn">\Lambda</code>, see <a href="#topic+density_quantile_function">density_quantile_function</a>
</p>

<ul>
<li><p> iid - Piecewise linear interpolation of the distribution
</p>
</li>
<li><p> nid - Hendricks and Koenker sandwich
</p>
</li></ul>
</td></tr>
<tr><td><code id="lambda_matrix_+3A_bandwidth_estimator">bandwidth_estimator</code></td>
<td>
<p>The bandwidth estimator to be used for the iid and nid sparsity estimator, see <a href="#topic+density_quantile_function">density_quantile_function</a>
</p>

<ul>
<li><p> Bofinger
</p>
</li>
<li><p> Chamberlain
</p>
</li>
<li><p> Hall-Sheather
</p>
</li></ul>
</td></tr>
<tr><td><code id="lambda_matrix_+3A_misspec">misspec</code></td>
<td>
<p>if TRUE, the estimator accounts for potential misspecification in the model</p>
</td></tr>
</table>

<hr>
<h2 id='sigma_matrix'>Sigma Matrix</h2><span id='topic+sigma_matrix'></span>

<h3>Description</h3>

<p>Estimate the sigma matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigma_matrix(object, sigma_est, misspec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigma_matrix_+3A_object">object</code></td>
<td>
<p>An esreg object</p>
</td></tr>
<tr><td><code id="sigma_matrix_+3A_sigma_est">sigma_est</code></td>
<td>
<p>The estimator to be used for <code class="reqn">\Sigma</code>, see <a href="#topic+conditional_truncated_variance">conditional_truncated_variance</a>
</p>

<ul>
<li><p> ind - Variance over all negative residuals
</p>
</li>
<li><p> scl_N - Scaling with the normal distribution
</p>
</li>
<li><p> scl_sp - Scaling with the kernel density function
</p>
</li></ul>
</td></tr>
<tr><td><code id="sigma_matrix_+3A_misspec">misspec</code></td>
<td>
<p>if TRUE, the estimator accounts for potential misspecification in the model</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.esreg'>Covariance Estimation</h2><span id='topic+vcov.esreg'></span>

<h3>Description</h3>

<p>Estimate the variance-covariance matrix of the joint (VaR, ES) estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'esreg'
vcov(object, method = "asymptotic", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.esreg_+3A_object">object</code></td>
<td>
<p>An <a href="#topic+esreg">esreg</a> object</p>
</td></tr>
<tr><td><code id="vcov.esreg_+3A_method">method</code></td>
<td>
<p>For asymptotic use <a href="#topic+vcovA">vcovA</a>, for boot use <a href="#topic+vcovB">vcovB</a></p>
</td></tr>
<tr><td><code id="vcov.esreg_+3A_...">...</code></td>
<td>
<p>All possible values which can be passed to <a href="#topic+vcovA">vcovA</a> and <a href="#topic+vcovB">vcovB</a></p>
</td></tr>
</table>

<hr>
<h2 id='vcovA'>Asymptotic Covariance Estimation</h2><span id='topic+vcovA'></span>

<h3>Description</h3>

<p>Estimate the variance-covariance matrix of the joint (VaR, ES) estimator by the sandwich formula:
</p>
<p style="text-align: center;"><code class="reqn">\lambda^{-1} \Sigma \lambda^{-1}</code>
</p>

<p>Several estimators are available for both matrices and the default options are selected to take into account
possible misspecifications in the underlying data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcovA(
  object,
  sigma_est = "scl_sp",
  sparsity = "nid",
  misspec = TRUE,
  bandwidth_estimator = "Hall-Sheather"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcovA_+3A_object">object</code></td>
<td>
<p>An esreg object</p>
</td></tr>
<tr><td><code id="vcovA_+3A_sigma_est">sigma_est</code></td>
<td>
<p>The estimator to be used for <code class="reqn">\Sigma</code>, see <a href="#topic+conditional_truncated_variance">conditional_truncated_variance</a>
</p>

<ul>
<li><p> ind - Variance over all negative residuals
</p>
</li>
<li><p> scl_N - Scaling with the normal distribution
</p>
</li>
<li><p> scl_sp - Scaling with the kernel density function
</p>
</li></ul>
</td></tr>
<tr><td><code id="vcovA_+3A_sparsity">sparsity</code></td>
<td>
<p>The estimator to be used for the sparsity in <code class="reqn">\Lambda</code>, see <a href="#topic+density_quantile_function">density_quantile_function</a>
</p>

<ul>
<li><p> iid - Piecewise linear interpolation of the distribution
</p>
</li>
<li><p> nid - Hendricks and Koenker sandwich
</p>
</li></ul>
</td></tr>
<tr><td><code id="vcovA_+3A_misspec">misspec</code></td>
<td>
<p>if TRUE, the estimator accounts for potential misspecification in the model</p>
</td></tr>
<tr><td><code id="vcovA_+3A_bandwidth_estimator">bandwidth_estimator</code></td>
<td>
<p>The bandwidth estimator to be used for the iid and nid sparsity estimator, see <a href="#topic+density_quantile_function">density_quantile_function</a>
</p>

<ul>
<li><p> Bofinger
</p>
</li>
<li><p> Chamberlain
</p>
</li>
<li><p> Hall-Sheather
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='vcovB'>Bootstrap Covariance Estimation</h2><span id='topic+vcovB'></span>

<h3>Description</h3>

<p>Estimate the variance-covariance matrix of the joint (VaR, ES) estimator
using the bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcovB(object, bootstrap_method = "iid", B = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcovB_+3A_object">object</code></td>
<td>
<p>An esreg object</p>
</td></tr>
<tr><td><code id="vcovB_+3A_bootstrap_method">bootstrap_method</code></td>
<td>
<p>The bootstrap sampling scheme to be used
</p>

<ul>
<li><p> iid - The iid bootstrap of Efron (1979)
</p>
</li></ul>
</td></tr>
<tr><td><code id="vcovB_+3A_b">B</code></td>
<td>
<p>The number of bootstrap iterations</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
