<!DOCTYPE html><html><head><title>Help for package psychotree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {psychotree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bttree'><p>Bradley-Terry Trees</p></a></li>
<li><a href='#CEMSChoice'><p>CEMS University Choice Data</p></a></li>
<li><a href='#DIFSim'><p>Artificial Data with Differential Item Functioning</p></a></li>
<li><a href='#EuropeanValuesStudy'><p>European Values Study</p></a></li>
<li><a href='#gpcmtree'><p>Generalized Partial Credit Model Trees</p></a></li>
<li><a href='#mpttree'><p>MPT Trees</p></a></li>
<li><a href='#node_btplot'><p>Panel-Generating Function for Visualizing Bradley-Terry Tree Models</p></a></li>
<li><a href='#node_mptplot'><p>Panel-Generating Function for Visualizing MPT Tree Models</p></a></li>
<li><a href='#node_profileplot'><p>Panel-Generating Function for Visualizing IRT Tree Models</p></a></li>
<li><a href='#node_regionplot'><p>Panel-Generating Function for Visualizing IRT Tree Models</p></a></li>
<li><a href='#npltree'><p>Parametric Logisitic (n-PL) IRT Model Trees</p></a></li>
<li><a href='#pctree'><p>Partial Credit Trees</p></a></li>
<li><a href='#raschtree'><p>Rasch Trees</p></a></li>
<li><a href='#rstree'><p>Rating Scale Trees</p></a></li>
<li><a href='#SPISA'><p>SPIEGEL Studentenpisa Data (Subsample)</p></a></li>
<li><a href='#Topmodel2007'><p>Attractiveness of Germany's Next Topmodels 2007</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Recursive Partitioning Based on Psychometric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.16-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-03</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), partykit (&ge; 1.2-9), psychotools (&ge; 0.7-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stablelearner (&ge; 0.1-3), strucchange, tinytest, mirt</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, grid, stats, Formula</td>
</tr>
<tr>
<td>Description:</td>
<td>Recursive partitioning based on psychometric models,
  employing the general MOB algorithm (from package partykit) to obtain
  Bradley-Terry trees, Rasch trees, rating scale and partial credit trees, and
  MPT trees, trees for 1PL, 2PL, 3PL and 4PL models and generalized partial 
  credit models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-03 12:28:06 UTC; zeileis</td>
</tr>
<tr>
<td>Author:</td>
<td>Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Carolin Strobl [aut],
  Florian Wickelmaier [aut],
  Basil Komboz [aut],
  Julia Kopf [aut],
  Lennart Schneider <a href="https://orcid.org/0000-0003-4152-5308"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David Dreifuss [aut],
  Rudolf Debelak <a href="https://orcid.org/0000-0001-8900-2106"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Achim Zeileis &lt;Achim.Zeileis@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-06 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bttree'>Bradley-Terry Trees</h2><span id='topic+bttree'></span><span id='topic+plot.bttree'></span><span id='topic+print.bttree'></span><span id='topic+predict.bttree'></span><span id='topic+itempar.bttree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on Bradley-Terry models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bttree(formula, data, na.action, cluster,
  type = "loglin", ref = NULL, undecided = NULL, position = NULL, ...)

## S3 method for class 'bttree'
predict(object, newdata = NULL,
  type = c("worth", "rank", "best", "node"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bttree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This
should be of type <code>y ~ x1 + x2</code>
where <code>y</code> should be an object of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>
and <code>x1</code> and <code>x2</code> are used as partitioning variables.</p>
</td></tr>
<tr><td><code id="bttree_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="bttree_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain <code>NA</code>s, defaulting to <code><a href="stats.html#topic+na.pass">na.pass</a></code>.</p>
</td></tr>
<tr><td><code id="bttree_+3A_cluster">cluster</code></td>
<td>
<p>optional vector (typically numeric or factor) with a
cluster ID to be employed for clustered covariances in the parameter
stability tests.</p>
</td></tr>
<tr><td><code id="bttree_+3A_type">type</code></td>
<td>
<p>character indicating the type of auxiliary model in <code>bttree</code> and the
type of predictions in the <code>predict</code> method, respectively. For the auxiliary
model see <code><a href="psychotools.html#topic+btmodel">btmodel</a></code>. For the <code>predict</code> method, four options are
available: the fitted <code>"worth"</code> parameter for each alternative, the corresponding
<code>"rank"</code>, the <code>"best"</code> alternative or the predicted <code>"node"</code> number.</p>
</td></tr>
<tr><td><code id="bttree_+3A_ref">ref</code>, <code id="bttree_+3A_undecided">undecided</code>, <code id="bttree_+3A_position">position</code></td>
<td>
<p>arguments for the Bradley-Terry
model passed on to <code><a href="psychotools.html#topic+btmodel">btmodel</a></code>.</p>
</td></tr>
<tr><td><code id="bttree_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob_control">mob_control</a></code>.</p>
</td></tr>
<tr><td><code id="bttree_+3A_object">object</code></td>
<td>
<p>fitted model object of class <code>"bttree"</code>.</p>
</td></tr>
<tr><td><code id="bttree_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to look for variables with
which to predict. If omitted, the original observations are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bradley-Terry trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to Bradley-Terry models for
paired comparison data (implemented in <code><a href="psychotools.html#topic+btmodel">btmodel</a></code>).
Details about the underlying theory and further explanations of the
illustrations in the example section can be found in
Strobl, Wickelmaier, Zeileis (2011).
</p>
<p>Various methods are provided for <code>"bttree"</code> objects, most of them
inherit their behavior from <code>"mob"</code> objects (e.g., <code>print</code>, <code>summary</code>,
etc.). <code>itempar</code> behaves analogously to <code>coef</code> and extracts the
worth/item parameters from the BT models in the nodes of the tree. The <code>plot</code>
method employs the <code><a href="#topic+node_btplot">node_btplot</a></code> panel-generating function.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"bttree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>References</h3>

 
<p>Strobl C, Wickelmaier F, Zeileis A (2011). Accounting for
Individual Differences in Bradley-Terry Models by Means of Recursive Partitioning.
<em>Journal of Educational and Behavioral Statistics</em>, <b>36</b>(2), 135&ndash;153.
<a href="https://doi.org/10.3102/1076998609359791">doi:10.3102/1076998609359791</a>
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+btmodel">btmodel</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>o &lt;- options(digits = 4)

## Germany's Next Topmodel 2007 data
data("Topmodel2007", package = "psychotree")

## BT tree
tm_tree &lt;- bttree(preference ~ ., data = Topmodel2007, minsize = 5, ref = "Barbara")
plot(tm_tree, abbreviate = 1, yscale = c(0, 0.5))

## parameter instability tests in root node
if(require("strucchange")) sctest(tm_tree, node = 1)

## worth/item parameters in terminal nodes
itempar(tm_tree)

## CEMS university choice data
data("CEMSChoice", package = "psychotree")
summary(CEMSChoice$preference)

## BT tree
cems_tree &lt;- bttree(preference ~ french + spanish + italian + study + work + gender + intdegree,
  data = CEMSChoice, minsize = 5, ref = "London")
plot(cems_tree, abbreviate = 1, yscale = c(0, 0.5))
itempar(cems_tree)

options(digits = o$digits)
</code></pre>

<hr>
<h2 id='CEMSChoice'>CEMS University Choice Data</h2><span id='topic+CEMSChoice'></span>

<h3>Description</h3>

<p>Preferences of 303 students from WU Wien for different CEMS universities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CEMSChoice")</code></pre>


<h3>Format</h3>

<p>A data frame containing 303 observations on 10 variables.
</p>

<dl>
<dt>preference</dt><dd><p>Paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.
Preferences for all 15 paired comparisons from 6 objects:
London, Paris, Milano, St. Gallen, Barcelona, Stockholm.</p>
</dd>
<dt>study</dt><dd><p>Factor coding main discipline of study: commerce,
or other (economics, business administration, business education).</p>
</dd>
<dt>english</dt><dd><p>Factor coding knowledge of English (good, poor).</p>
</dd>
<dt>french</dt><dd><p>Factor coding knowledge of French (good, poor).</p>
</dd>
<dt>spanish</dt><dd><p>Factor coding knowledge of Spanish (good, poor).</p>
</dd>
<dt>italian</dt><dd><p>Factor coding knowledge of Italian (good, poor).</p>
</dd>
<dt>work</dt><dd><p>Factor. Was the student working full-time while studying?</p>
</dd>
<dt>gender</dt><dd><p>Factor coding gender.</p>
</dd>
<dt>intdegree</dt><dd><p>Factor. Does the student intend to take an international degree?</p>
</dd>
<dt>preference1998</dt><dd><p>Paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.
This is like <code>preference</code> but the comparisons between Barcelona
an Stockholm are (erroneously) reversed, see below.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Students at Wirtschaftsuniversität Wien (<a href="https://www.wu.ac.at/">https://www.wu.ac.at/</a>) can study abroad
visiting one of currently 17 CEMS universities (Community of European Management
Schools and International Companies). Dittrich et al. (1998) conduct and analyze
a survey of 303 students to examine the student's preferences for 6 universities:
London School of Economics, HEC Paris, Università Commerciale Luigi Bocconi (Milano),
Universität St. Gallen, ESADE (Barcelona), Handelshögskolan i Stockholm.
To identify reasons for the preferences, several subject covariates (including
foreign language competence, gender, etc.) have been assessed. Furthermore,
several object covariates are attached to <code>preference</code> (and <code>preference1998</code>):
the universities' field of <code>specialization</code> (economics, management science, finance)
and location (Latin country, or other).
</p>
<p>The correct data are available in the online complements to Dittrich et al. (1998).
However, the accompanying analysis was based on an erroneous version of the data in which the
choices for the last comparison pair (Barcelona : Stockholm) were accidentally reversed. See the
corrigendum in Dittrich et al. (2001) for further details. The variable <code>preference</code>
provides the correct data and can thus be used to replicate the analysis from the
corrigendum (Dittrich et al. 2001). For convenience, the erroneous version is
provided in <code>preference1998</code> which can therefore be used to replicate the
(incorrect) original analysis (Dittrich et al. 1998).
</p>


<h3>Source</h3>

<p>The Royal Statistical Society Datasets Website.
</p>


<h3>References</h3>

<p>Dittrich R, Hatzinger R, Katzenbeisser W (1998).
Modelling the Effect of Subject-Specific Covariates in Paired Comparison Studies
with an Application to University Rankings,
<em>Journal of the Royal Statistical Society C</em>, <b>47</b>, 511&ndash;525.
</p>
<p>Dittrich R, Hatzinger R, Katzenbeisser W (2001).
Corrigendum: Modelling the Effect of Subject-Specific Covariates in Paired Comparison
Studies with an Application to University Rankings,
<em>Journal of the Royal Statistical Society C</em>, <b>50</b>, 247&ndash;249.
</p>


<h3>See Also</h3>

<p><code><a href="psychotools.html#topic+paircomp">paircomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("CEMSChoice", package = "psychotree")
summary(CEMSChoice$preference)
covariates(CEMSChoice$preference)
</code></pre>

<hr>
<h2 id='DIFSim'>Artificial Data with Differential Item Functioning</h2><span id='topic+DIFSim'></span><span id='topic+DIFSimPC'></span>

<h3>Description</h3>

<p>Artificial data simulated from a Rasch model and a partial credit model,
respectively, where the items exhibit differential item functioning (DIF).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DIFSim)
data(DIFSimPC)
</code></pre>


<h3>Format</h3>

<p>Two data frames containing 200 and 500 observations, respectively, on 4 variables.
</p>

<dl>
<dt>resp</dt><dd><p>an <code><a href="psychotools.html#topic+itemresp">itemresp</a></code> matrix with binary or polytomous
results for 20 or 8 items, respectively.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>motivation</dt><dd><p>ordered factor indicating motivation level.</p>
</dd>
</dl>



<h3>Details</h3>

  
<p>The data are employed for illustrations in Strobl et al. (2015)
and Komboz et al. (2018). See the manual pages for
<code><a href="#topic+raschtree">raschtree</a></code> and <code><a href="#topic+pctree">pctree</a></code> for fitting the
tree models..
</p>


<h3>References</h3>

<p>Komboz B, Zeileis A, Strobl C (2018).
Tree-Based Global Model Tests for Polytomous Rasch Models.
<em>Educational and Psychological Measurement</em>, <b>78</b>(1), 128&ndash;166.
<a href="https://doi.org/10.1177/0013164416664394">doi:10.1177/0013164416664394</a>
</p>
<p>Strobl C, Kopf J, Zeileis A (2015). Rasch Trees: A New Method for Detecting
Differential Item Functioning in the Rasch Model.
<em>Psychometrika</em>, <b>80</b>(2), 289&ndash;316.
<a href="https://doi.org/10.1007/s11336-013-9388-3">doi:10.1007/s11336-013-9388-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+raschtree">raschtree</a></code>, <code><a href="#topic+pctree">pctree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("DIFSim", package = "psychotree")
data("DIFSimPC", package = "psychotree")

## summary of covariates
summary(DIFSim[, -1])
summary(DIFSimPC[, -1])

## empirical frequencies of responses
plot(DIFSim$resp)
plot(DIFSimPC$resp)

## histogram of raw scores
hist(rowSums(DIFSim$resp), breaks = 0:20 - 0.5)
hist(rowSums(DIFSimPC$resp), breaks = 0:17 - 0.5)
</code></pre>

<hr>
<h2 id='EuropeanValuesStudy'>European Values Study</h2><span id='topic+EuropeanValuesStudy'></span>

<h3>Description</h3>

<p>A sample of the 1999 European Values Study (EVS) containing an assessment of
materialism/postmaterialism in 3584 respondents from 32 countries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EuropeanValuesStudy")</code></pre>


<h3>Format</h3>

<p>A data frame containing 3584 observations on 10 variables.
</p>

<dl>
<dt>country</dt><dd><p>Factor coding the country of a respondent.</p>
</dd>
<dt>gender</dt><dd><p>Factor coding gender.</p>
</dd>
<dt>birthyear</dt><dd><p>Numeric. Year of birth.</p>
</dd>
<dt>eduage</dt><dd><p>Numeric. Age when full time education was or will be
completed.</p>
</dd>
<dt>marital</dt><dd><p>Factor. Current legal marital status.</p>
</dd>
<dt>employment</dt><dd><p>Ordered factor. Employment and number of working hours.</p>
</dd>
<dt>occupation</dt><dd><p>Factor. What is/was your main job?</p>
</dd>
<dt>income</dt><dd><p>Ordered factor. Income of household in ten categories from
10 percent lowest to 10 percent highest income category.</p>
</dd>
<dt>paircomp</dt><dd><p>Paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.
Five pairwise choices among four important political goals derived from
a double-choice task (see Details).</p>
</dd>
<dt>country2</dt><dd><p>Factor. Country group according to postmaterialism
(see Details).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are part of a larger survey conducted in 1999 in 32 countries in
Europe (see <a href="https://europeanvaluesstudy.eu/">https://europeanvaluesstudy.eu/</a>). Vermunt (2003)
obtained a sample from 10 percent of the available cases per country,
yielding 3584 valid cases.
</p>
<p>The item in the 1999 European Values Study questionnaire aiming at recording
materialism/postmaterialism reads as follows:
</p>
<p>There is a lot of talk these days about what the aims of this country
should be for the next ten years. On this card are listed some of the goals
which different people would give top priority. If you had to choose, which
of the things on this card would you say is most important? And which would
be the next most important?
</p>
<p>A Maintaining order in the nation<br />
B Giving people more say in important government decisions<br />
C Fighting rising prices<br />
D Protecting freedom of speech
</p>
<p>The double-choice task implies a partial ranking of the alternatives and
(assuming transitivity) an incomplete set of paired comparisons for each
respondent.
</p>
<p>The country group according to postmaterialism was derived by Vermunt (2003)
using a latent class model, and applied by Lee and Lee (2010) in a tree
model.
</p>


<h3>Source</h3>

<p>Latent GOLD Sample Data Sets Website.
</p>


<h3>References</h3>

<p>Lee PH, Yu PLH (2010). Distance-Based Tree Models for Ranking
Data. <em>Computational Statistics and Data Analysis</em>, <b>54</b>,
1672&ndash;1682.
</p>
<p>Vermunt JK (2003). Multilevel Latent Class Models.
<em>Sociological Methodology</em>, <b>33</b>, 213&ndash;239.
</p>


<h3>See Also</h3>

<p><code><a href="psychotools.html#topic+paircomp">paircomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("EuropeanValuesStudy", package = "psychotree")
summary(EuropeanValuesStudy$paircomp)

## Not run: 
## Bradley-Terry tree resulting in similar results compared to
## the (different) tree approach of Lee and Lee (2010)
evs &lt;- na.omit(EuropeanValuesStudy)
bt &lt;- bttree(paircomp ~ gender + eduage + birthyear + marital + employment + income + country2,
  data = evs, alpha = 0.01)
plot(bt, abbreviate = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='gpcmtree'>Generalized Partial Credit Model Trees</h2><span id='topic+gpcmtree'></span><span id='topic+print.gpcmtree'></span><span id='topic+plot.gpcmtree'></span><span id='topic+itempar.gpcmtree'></span><span id='topic+threshpar.gpcmtree'></span><span id='topic+guesspar.gpcmtree'></span><span id='topic+upperpar.gpcmtree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on generalized partial
credit models (GPCMs) for global testing of differential item functioning (DIF).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gpcmtree(formula, data, weights = NULL,
  grouppars = FALSE, vcov = TRUE, nullcats = "downcode",
  start = NULL, method = "BFGS", maxit = 500L,
  reltol = 1e-10, minsize = 500, ...)

## S3 method for class 'gpcmtree'
plot(x, type = c("regions", "profile"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpcmtree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This should be of type <code>y ~ x1 + x2</code> where
<code>y</code> should be an item response matrix and <code>x1</code> and <code>x2</code> are used as partitioning variables.
Additionally, it is poosible to allow for impact of a group variable so that different ability distributions
are estimated in each group. This can be specified by extending the previous <code>formula</code> by a group factor
<code>g</code> as <code>y ~ g | x1 + x2</code>.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights (interpreted as case weights).</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_grouppars">grouppars</code></td>
<td>
<p>logical. Should the estimated distributional group parameters of a multiple group model be
included in the model parameters?</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_vcov">vcov</code></td>
<td>
<p>logical or character specifying the type of variance-covariance matrix (if any) computed for the
final models (see <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>).</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_nullcats">nullcats</code></td>
<td>
<p>character string, specifying how items with null categories (i.e., categories not observed)
should be treated. See <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>, currently only <code>"downcode"</code> is available.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_start">start</code></td>
<td>
<p>an optional vector or list of starting values (see <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>).</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_method">method</code></td>
<td>
<p>control parameter for the optimizer employed by <code><a href="mirt.html#topic+mirt">mirt</a></code> for the EM algorithm
(see <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>).</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_maxit">maxit</code></td>
<td>
<p>control parameter for the optimizer employed by <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_reltol">reltol</code></td>
<td>
<p>control parameter for the optimizer employed by <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_minsize">minsize</code></td>
<td>
<p>integer specification of minimum number of observations in each node, which is passed to
<code><a href="partykit.html#topic+mob_control">mob_control</a></code>.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob_control">mob_control</a></code> for <code>gpcmtree</code>, or to the
underlying <code>plot</code> method, respectively.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_x">x</code></td>
<td>
<p>an object of class <code>gpcmtree</code>.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_type">type</code></td>
<td>
<p>character specifying the type of plot.</p>
</td></tr>
<tr><td><code id="gpcmtree_+3A_terminal_panel">terminal_panel</code>, <code id="gpcmtree_+3A_tp_args">tp_args</code>, <code id="gpcmtree_+3A_tnex">tnex</code>, <code id="gpcmtree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob">mob</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized partial credit model (GPCM) trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to GPCM models (implemented in <code><a href="psychotools.html#topic+gpcmodel">gpcmodel</a></code>).
</p>
<p>Various methods are provided for <code>"gpcmtree"</code> objects, most of them inherit their behavior from
<code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>). Additionally, dedicated extractor
functions or provided for the different groups of model parameters in each node of the tree: 
<code><a href="psychotools.html#topic+itempar">itempar</a></code> (item parameters),
<code><a href="psychotools.html#topic+threshpar">threshpar</a></code> (threshold parameters),
<code><a href="psychotools.html#topic+guesspar">guesspar</a></code> (guessing parameters),
<code><a href="psychotools.html#topic+upperpar">upperpar</a></code> (upper asymptote parameters).
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"gpcmtree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+plmodel">plmodel</a></code>,
<code><a href="#topic+rstree">rstree</a></code>, <code><a href="#topic+pctree">pctree</a></code>, <code><a href="#topic+raschtree">raschtree</a></code>, <code><a href="#topic+npltree">npltree</a></code></p>

<hr>
<h2 id='mpttree'>MPT Trees</h2><span id='topic+mpttree'></span><span id='topic+coef.mpttree'></span><span id='topic+plot.mpttree'></span><span id='topic+print.mpttree'></span><span id='topic+predict.mpttree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on multinomial processing tree (MPT) models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpttree(formula, data, na.action, cluster, spec, treeid = NULL,
  optimargs = list(control = list(reltol = .Machine$double.eps^(1/1.2),
                                  maxit = 1000)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpttree_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit. This should be
of type <code>y ~ x1 + x2</code> where <code>y</code> should be a matrix of response
frequencies and <code>x1</code> and <code>x2</code> are used as partitioning
variables.</p>
</td></tr>
<tr><td><code id="mpttree_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="mpttree_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s, defaulting to <code><a href="stats.html#topic+na.pass">na.pass</a></code>.</p>
</td></tr>
<tr><td><code id="mpttree_+3A_cluster">cluster</code></td>
<td>
<p>optional vector (typically numeric or factor) with a
cluster ID to be employed for clustered covariances in the parameter
stability tests.</p>
</td></tr>
<tr><td><code id="mpttree_+3A_spec">spec</code>, <code id="mpttree_+3A_treeid">treeid</code>, <code id="mpttree_+3A_optimargs">optimargs</code></td>
<td>
<p>arguments for the MPT model passed on to
<code><a href="psychotools.html#topic+mptmodel">mptmodel</a></code>.</p>
</td></tr>
<tr><td><code id="mpttree_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob_control">mob_control</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MPT trees (Wickelmaier &amp; Zeileis, 2018) are an application of
model-based recursive partitioning (implemented in
<code><a href="partykit.html#topic+mob">mob</a></code>) to MPT models (implemented in
<code><a href="psychotools.html#topic+mptmodel">mptmodel</a></code>).
</p>
<p>Various methods are provided for <code>"mpttree"</code> objects, most of them
inherit their behavior from <code>"mob"</code> objects (e.g., <code>print</code>,
<code>summary</code>, etc.).  The <code>plot</code> method employs the
<code><a href="#topic+node_mptplot">node_mptplot</a></code> panel-generating function.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"mpttree"</code> inheriting from class
<code>"modelparty"</code>.
</p>


<h3>References</h3>

 
<p>Wickelmaier F, Zeileis A (2018). Using Recursive Partitioning to Account
for Parameter Heterogeneity in Multinomial Processing Tree Models.
<em>Behavior Research Methods</em>, <b>50</b>(3), 1217&ndash;1233.
<a href="https://doi.org/10.3758/s13428-017-0937-z">doi:10.3758/s13428-017-0937-z</a>
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+mptmodel">mptmodel</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>o &lt;- options(digits = 4)

## Source Monitoring data
data("SourceMonitoring", package = "psychotools")

## MPT tree
sm_tree &lt;- mpttree(y ~ sources + gender + age, data = SourceMonitoring,
  spec = mptspec("SourceMon", .restr = list(d1 = d, d2 = d)))
plot(sm_tree, index = c("D1", "D2", "d", "b", "g"))

## extract parameter estimates
coef(sm_tree)

## parameter instability tests in root node
if(require("strucchange")) sctest(sm_tree, node = 1)

## storage and retrieval deficits in psychiatric patients
data("MemoryDeficits", package = "psychotools")
MemoryDeficits$trial &lt;- ordered(MemoryDeficits$trial)

## MPT tree
sr_tree &lt;- mpttree(cbind(E1, E2, E3, E4) ~ trial + group,
  data = MemoryDeficits, cluster = ID, spec = mptspec("SR2"), alpha = 0.1)

## extract parameter estimates
coef(sr_tree)

options(digits = o$digits)
</code></pre>

<hr>
<h2 id='node_btplot'>Panel-Generating Function for Visualizing Bradley-Terry Tree Models</h2><span id='topic+node_btplot'></span>

<h3>Description</h3>

<p>Panel-generating function for visualizing the worth parameters
from the nodes in Bradley-Terry tree models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node_btplot(mobobj, id = TRUE,
  worth = TRUE, names = TRUE, abbreviate = TRUE, index = TRUE, ref = TRUE,
  col = "black", refcol = "lightgray", bg = "white", cex = 0.5, pch = 19,
  xscale = NULL, yscale = NULL, ylines = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="node_btplot_+3A_mobobj">mobobj</code></td>
<td>
<p>an object of class <code>"mob"</code> based on Bradley-Terry models
fitted by <code><a href="psychotools.html#topic+btmodel">btmodel</a></code>.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_id">id</code></td>
<td>
<p>logical. Should the node ID be displayed?</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_worth">worth</code></td>
<td>
<p>logical. Should worth parameters (or their logs) be visualized?</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_names">names</code></td>
<td>
<p>logical. Should the names for the objects be displayed?</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical or numeric. Should object names be abbreviated?
If numeric this controls the length of the abbreviation.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_index">index</code></td>
<td>
<p>logical. Should different indexes for different stimuli be used?</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_ref">ref</code></td>
<td>
<p>logical. Should a horizontal line for the reference level be drawn?
Alternatively, <code>ref</code> can also be numeric or character to employ
a reference level different from that stored in the model object.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_col">col</code>, <code id="node_btplot_+3A_cex">cex</code>, <code id="node_btplot_+3A_pch">pch</code></td>
<td>
<p>graphical appearance of plotting symbols.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_refcol">refcol</code></td>
<td>
<p>line color for reference line (if <code>ref</code>).</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_bg">bg</code></td>
<td>
<p>color for background filling.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_xscale">xscale</code>, <code id="node_btplot_+3A_yscale">yscale</code></td>
<td>
<p>x and y axis limits.</p>
</td></tr>
<tr><td><code id="node_btplot_+3A_ylines">ylines</code></td>
<td>
<p>numeric. Number of lines used for y-axis labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The panel-generating function <code>node_btplot</code> is called by the <code>plot</code>
method for <code>"bttree"</code> objects and does not have to be called by the
user directly.
</p>


<h3>Value</h3>

<p>A panel function which can be supplied to the <code>plot</code> method for
<code>"mob"</code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bttree">bttree</a></code></p>

<hr>
<h2 id='node_mptplot'>Panel-Generating Function for Visualizing MPT Tree Models</h2><span id='topic+node_mptplot'></span>

<h3>Description</h3>

<p>Panel-generating function for visualizing the model parameters
from the nodes in MPT tree models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node_mptplot(mobobj, id = TRUE,
  names = TRUE, abbreviate = TRUE, index = TRUE, ref = TRUE,
  col = "black", linecol = "lightgray", bg = "white", cex = 0.5, pch = 19,
  xscale = NULL, yscale = c(0, 1), ylines = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="node_mptplot_+3A_mobobj">mobobj</code></td>
<td>
<p>an object of class <code>"mob"</code> based on MPT models
fitted by <code><a href="psychotools.html#topic+mptmodel">mptmodel</a></code>.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_id">id</code></td>
<td>
<p>logical. Should the node ID be displayed?</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_names">names</code></td>
<td>
<p>logical or character. Should the names for the parameters be
displayed? If character, this sets the names.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical or numeric. Should parameter names be abbreviated?
If numeric this controls the length of the abbreviation.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_index">index</code></td>
<td>
<p>logical or character. Should different indexes for different
parameters be used? If character, this controls the order of labels given
in <code>names</code>.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_ref">ref</code></td>
<td>
<p>logical. Should a horizontal line for the reference level be
drawn?</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_col">col</code>, <code id="node_mptplot_+3A_cex">cex</code>, <code id="node_mptplot_+3A_pch">pch</code></td>
<td>
<p>graphical appearance of plotting symbols.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_linecol">linecol</code></td>
<td>
<p>line color for reference line (if <code>ref</code>).</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_bg">bg</code></td>
<td>
<p>color for background filling.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_xscale">xscale</code>, <code id="node_mptplot_+3A_yscale">yscale</code></td>
<td>
<p>x and y axis limits.</p>
</td></tr>
<tr><td><code id="node_mptplot_+3A_ylines">ylines</code></td>
<td>
<p>numeric. Number of lines used for y-axis labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The panel-generating function <code>node_mptplot</code> is called by the <code>plot</code>
method for <code>"mpttree"</code> objects and does not have to be called by the
user directly.
</p>


<h3>Value</h3>

<p>A panel function which can be supplied to the <code>plot</code> method for
<code>"mob"</code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpttree">mpttree</a></code></p>

<hr>
<h2 id='node_profileplot'>Panel-Generating Function for Visualizing IRT Tree Models</h2><span id='topic+node_profileplot'></span>

<h3>Description</h3>

<p>Panel-generating function for visualizing profiles (points and lines)
of the parameters from the nodes in IRT tree models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node_profileplot(
  mobobj,
  what = c("items", "thresholds", "discriminations"),
  parg = list(type = NULL, ref = NULL, alias = TRUE),
  id = TRUE,
  names = FALSE,
  abbreviate = TRUE,
  index = TRUE,
  ref = TRUE,
  col = "black",
  border = col,
  linecol = "black",
  refcol = "lightgray",
  bg = "white",
  cex = 0.5,
  pch = 21,
  xscale = NULL,
  yscale = NULL,
  ylines = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="node_profileplot_+3A_mobobj">mobobj</code></td>
<td>
<p>an object of class <code>"npltree"</code> or class <code>"mob"</code>
fitted by <code><a href="#topic+npltree">npltree</a></code></p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_what">what</code></td>
<td>
<p>specifying the type of parameters to be plotted</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_parg">parg</code></td>
<td>
<p>supplementary arguments for <code>"what"</code></p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_id">id</code></td>
<td>
<p>logical. Should the node ID be displayed?</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_names">names</code></td>
<td>
<p>logical or character. If <code>TRUE</code>, the names of
the items are displayed on the x-axis. If <code>FALSE</code>, numbers of
items are shown. Alternatively a character vector of the same
length as the number of items can be supplied.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical. Should item names be abbreviated?
If numeric this controls the length of the abbreviation.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_index">index</code></td>
<td>
<p>logical. Should different indexes for different items be used?</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_ref">ref</code></td>
<td>
<p>logical. Should a horizontal line for the reference level be drawn?</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_col">col</code>, <code id="node_profileplot_+3A_border">border</code>, <code id="node_profileplot_+3A_pch">pch</code>, <code id="node_profileplot_+3A_cex">cex</code></td>
<td>
<p>graphical appearance of plotting symbols.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_linecol">linecol</code>, <code id="node_profileplot_+3A_refcol">refcol</code></td>
<td>
<p>character, specifying the line color to use for the
profile lines and reference line, respectively.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_bg">bg</code></td>
<td>
<p>color for background filling.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_xscale">xscale</code>, <code id="node_profileplot_+3A_yscale">yscale</code></td>
<td>
<p>x and y axis limits.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_ylines">ylines</code></td>
<td>
<p>numeric. Number of lines used for y-axis labels.</p>
</td></tr>
<tr><td><code id="node_profileplot_+3A_...">...</code></td>
<td>
<p>further arguments currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The panel-generating function <code>node_regionplot</code> is called by the <code>plot</code>
method of <code>"gpcmtree"</code> object by default and does not have to be called by the user directly.
See <code><a href="psychotools.html#topic+regionplot">regionplot</a></code> for details and references
of the drawn region plots and possible values and their meaning for
the argument <code>type</code> (taken by <code>node_regionplot</code>).
</p>


<h3>Value</h3>

<p>A panel function which can be supplied to the <code>plot</code> method for <code>"npltree"</code> objects
or <code>"mob"</code> objects fitted by <code><a href="#topic+npltree">npltree</a></code> or <code><a href="#topic+gpcmtree">gpcmtree</a></code>.
</p>

<hr>
<h2 id='node_regionplot'>Panel-Generating Function for Visualizing IRT Tree Models</h2><span id='topic+node_regionplot'></span>

<h3>Description</h3>

<p>Panel-generating function for visualizing the regions of expected
item responses across abilities (via shaded rectangles) based on
the parameters from the nodes in IRT tree models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node_regionplot(
  mobobj,
  names = FALSE,
  abbreviate = TRUE,
  type = c("mode", "median", "mean"),
  ref = NULL,
  ylim = NULL,
  off = 0.1,
  col_fun = gray.colors,
  bg = "white",
  uo_show = TRUE,
  uo_col = "red",
  uo_lty = 2,
  uo_lwd = 1.25,
  ylines = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="node_regionplot_+3A_mobobj">mobobj</code></td>
<td>
<p>an object of class <code>"npltree"</code> or class <code>"mob"</code>
fitted by <code><a href="#topic+npltree">npltree</a></code></p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_names">names</code></td>
<td>
<p>logical or character. If <code>TRUE</code>, the names of the items are displayed
on the x-axis. If <code>FALSE</code>, numbers of items are shown.
Alternatively a character vector of the same length as the number of items can be supplied.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical. Should item names be abbreviated?
If numeric this controls the length of the abbreviation.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_type">type</code></td>
<td>
<p>character, specifying which type of threshold parameters
are to be used to mark the category regions per item in the plot
(see <code><a href="psychotools.html#topic+regionplot">regionplot</a></code> for details).</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_ref">ref</code></td>
<td>
<p>a vector of labels or position indices of item parameters
which should be used as restriction/for normalization.
If <code>NULL</code> (the default), all items are used (sum zero restriction).
See <code><a href="psychotools.html#topic+threshpar">threshpar</a></code> for more details.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_ylim">ylim</code></td>
<td>
<p>y axis limits</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_off">off</code></td>
<td>
<p>numeric, the distance (in scale units) between two item rectangles.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_col_fun">col_fun</code></td>
<td>
<p>function. Function to use for creating the color
palettes for the rectangles. Per default <code>gray.colors</code> is
used. Be aware that <code>col_fun</code> should accept as first argument an
integer specifying the number of colors to create.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_bg">bg</code></td>
<td>
<p>color for background filling.</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_uo_show">uo_show</code></td>
<td>
<p>logical. If set to <code>TRUE</code> (the default),
disordered absolute item threshold parameters are indicated by a
horizontal line (only if <code>type</code> is set to <code>"mode"</code>).</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_uo_col">uo_col</code></td>
<td>
<p>character, color of indication lines (if <code>uo_show</code>).</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_uo_lty">uo_lty</code></td>
<td>
<p>numeric. Line typ of indication lines (if <code>uo_show</code>).</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_uo_lwd">uo_lwd</code></td>
<td>
<p>numeric. Line width of indication lines (if <code>uo_show</code>).</p>
</td></tr>
<tr><td><code id="node_regionplot_+3A_ylines">ylines</code></td>
<td>
<p>numeric. Number of lines used for y-axis labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A panel function which can be supplied to the <code>plot</code> method for <code>"npltree"</code> objects
or <code>"mob"</code> objects fitted by <code><a href="#topic+npltree">npltree</a></code>.
</p>

<hr>
<h2 id='npltree'>Parametric Logisitic (n-PL) IRT Model Trees</h2><span id='topic+npltree'></span><span id='topic+print.npltree'></span><span id='topic+plot.npltree'></span><span id='topic+itempar.npltree'></span><span id='topic+threshpar.npltree'></span><span id='topic+guesspar.npltree'></span><span id='topic+upperpar.npltree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on parametric logistic
(n-PL) item response theory (IRT) models for global testing of differential
item functioning (DIF).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npltree(formula, data, type = c("Rasch", "1PL", "2PL", "3PL", "3PLu", "4PL"),
  start = NULL, weights = NULL, grouppars = FALSE,
  vcov = TRUE, method = "BFGS", maxit = 500L,
  reltol = 1e-10, deriv = "sum", hessian = TRUE,
  full = TRUE, minsize = NULL, ...)

## S3 method for class 'npltree'
plot(x, type = c("profile", "regions"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npltree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This should be of type <code>y ~ x1 + x2</code> where
<code>y</code> should be an item response matrix and <code>x1</code> and <code>x2</code> are used as partitioning variables.
For the models estimated using marginal maximum likelihood (MML), it is additionally poosible to allow for
impact of a group variable so that different ability distributions are estimated in each group.
This can be specified by extending the previous <code>formula</code> by a group factor <code>g</code> as <code>y ~ g | x1 + x2</code>.</p>
</td></tr>
<tr><td><code id="npltree_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="npltree_+3A_type">type</code></td>
<td>
<p>character, specifying either the type of IRT model in <code>npltree</code> (see also <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>)
or the type of visualization to be used in the <code>plot</code> method, respectively.</p>
</td></tr>
<tr><td><code id="npltree_+3A_start">start</code></td>
<td>
<p>an optional vector or list of starting values (see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>
or <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>).</p>
</td></tr>
<tr><td><code id="npltree_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights (interpreted as case weights).</p>
</td></tr>
<tr><td><code id="npltree_+3A_grouppars">grouppars</code></td>
<td>
<p>logical. Should the estimated distributional group parameters of a multiple-group model
be included in the model parameters? (See <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>.)</p>
</td></tr>
<tr><td><code id="npltree_+3A_vcov">vcov</code></td>
<td>
<p>logical or character specifying the type of variance-covariance matrix (if any) computed for
the final models when fitted using MML (see <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>).</p>
</td></tr>
<tr><td><code id="npltree_+3A_method">method</code></td>
<td>
<p>control parameter for the optimizer used by <code><a href="mirt.html#topic+mirt">mirt</a></code> for the EM algorithm
when models are fitted using MML (see <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>).</p>
</td></tr>
<tr><td><code id="npltree_+3A_maxit">maxit</code></td>
<td>
<p>control parameter for the optimizer used by <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code> or
<code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code> (see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>, <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>).</p>
</td></tr>
<tr><td><code id="npltree_+3A_reltol">reltol</code></td>
<td>
<p>control parameter for the optimizer used by <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code> or
<code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code> (see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>, <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>).</p>
</td></tr>
<tr><td><code id="npltree_+3A_deriv">deriv</code></td>
<td>
<p>character. Which type of derivatives should be used for computing gradient and Hessian matrix
when fitting Rasch models  with the conditional maximum likelihood (CML) method (see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>)?</p>
</td></tr>
<tr><td><code id="npltree_+3A_hessian">hessian</code></td>
<td>
<p>logical. Should the Hessian be computed for Rasch models fitted with the CML method
(see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>)?</p>
</td></tr>
<tr><td><code id="npltree_+3A_full">full</code></td>
<td>
<p>logical. Should a full model object be returned for Rasch models fitted with the CML method
(see <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>)?</p>
</td></tr>
<tr><td><code id="npltree_+3A_minsize">minsize</code></td>
<td>
<p>The minimum number of observations in each node, which is passed to <code><a href="partykit.html#topic+mob_control">mob_control</a></code>.
If not set, it is 300 for 2PL models and 500 for 3PL, 3PLu, and 4PL models.</p>
</td></tr>
<tr><td><code id="npltree_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob_control">mob_control</a></code> for <code>npltree</code>, and to the underlying
<code>plot</code> method.</p>
</td></tr>
<tr><td><code id="npltree_+3A_x">x</code></td>
<td>
<p>an object of class <code>npltree</code>.</p>
</td></tr>
<tr><td><code id="npltree_+3A_terminal_panel">terminal_panel</code>, <code id="npltree_+3A_tp_args">tp_args</code>, <code id="npltree_+3A_tnex">tnex</code>, <code id="npltree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>arguments passed to <code><a href="partykit.html#topic+mob">mob</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parametric logistic (n-PL) model trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to item response theory (IRT) models (implemented in
<code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code> and <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>). While the <code>"Rasch"</code>
model is estimated by conditional maximum likelihood (CML) all other n-PL models are estimated by
marginal maximum likelihood (MML) via the standard EM algorithm. The latter allow the specification
of multiple-group model to capture group impact on the ability distributions.
</p>
<p>Various methods are provided for <code>"npltree"</code> objects, most of them inherit their behavior from
<code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>). Additionally, dedicated extractor
functions or provided for the different groups of model parameters in each node of the tree: 
<code><a href="psychotools.html#topic+itempar">itempar</a></code> (item parameters),
<code><a href="psychotools.html#topic+threshpar">threshpar</a></code> (threshold parameters),
<code><a href="psychotools.html#topic+guesspar">guesspar</a></code> (guessing parameters),
<code><a href="psychotools.html#topic+upperpar">upperpar</a></code> (upper asymptote parameters).
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"npltree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+nplmodel">nplmodel</a></code>,
<code><a href="#topic+rstree">rstree</a></code>, <code><a href="#topic+pctree">pctree</a></code>, <code><a href="#topic+raschtree">raschtree</a></code>, <code><a href="#topic+gpcmtree">gpcmtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>o &lt;- options(digits = 4)

# fit a Rasch (1PL) tree on the SPISA data set
library("psychotree")
data("SPISA", package = "psychotree")
nplt &lt;- npltree(spisa[, 1:9] ~ age + gender + semester + elite + spon, 
  data = SPISA, type = "Rasch")
nplt

# visualize
plot(nplt)

# compute summaries of the models fitted in nodes 1 and 2
summary(nplt, 1:2)

options(digits = o$digits)
</code></pre>

<hr>
<h2 id='pctree'>Partial Credit Trees</h2><span id='topic+pctree'></span><span id='topic+plot.pctree'></span><span id='topic+print.pctree'></span><span id='topic+predict.pctree'></span><span id='topic+itempar.pctree'></span><span id='topic+threshpar.pctree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on partial credit models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pctree(formula, data, na.action, nullcats = c("keep", "downcode", "ignore"),
  reltol = 1e-10,  deriv = c("sum", "diff"), maxit = 100L, ...)

## S3 method for class 'pctree'
predict(object, newdata = NULL,
  type = c("probability", "cumprobability", "mode", "median", "mean",
    "category-information", "item-information", "test-information", "node"),
  personpar = 0, ...)

## S3 method for class 'pctree'
plot(x, type = c("regions", "profile"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pctree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This
should be of type <code>y ~ x1 + x2</code> where <code>y</code> should be a
matrix with items in the columns and observations in the rows and
<code>x1</code> and <code>x2</code> are used as partitioning
variables.</p>
</td></tr>
<tr><td><code id="pctree_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="pctree_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain missing values (<code>NA</code>s).</p>
</td></tr>
<tr><td><code id="pctree_+3A_nullcats">nullcats</code></td>
<td>
<p>character. How null categories should be treated. See
<code><a href="psychotools.html#topic+pcmodel">pcmodel</a></code> for details.</p>
</td></tr>
<tr><td><code id="pctree_+3A_deriv">deriv</code></td>
<td>
<p>character. If &quot;sum&quot; (the default), the first derivatives
of the elementary symmetric functions are calculated with the sum
algorithm. Otherwise (&quot;diff&quot;) the difference algorithm (faster but
numerically unstable) is used.</p>
</td></tr>
<tr><td><code id="pctree_+3A_reltol">reltol</code>, <code id="pctree_+3A_maxit">maxit</code></td>
<td>
<p>arguments passed via <code><a href="psychotools.html#topic+pcmodel">pcmodel</a></code>
to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="pctree_+3A_...">...</code></td>
<td>
<p>arguments passed to the underlying functions, i.e., to
<code><a href="partykit.html#topic+mob_control">mob_control</a></code> for <code>pctree</code>, and to the
underlying <code>predict</code> and <code>plot</code> methods, respectively.</p>
</td></tr>
<tr><td><code id="pctree_+3A_object">object</code>, <code id="pctree_+3A_x">x</code></td>
<td>
<p>an object of class <code>"raschtree"</code>.</p>
</td></tr>
<tr><td><code id="pctree_+3A_newdata">newdata</code></td>
<td>
<p>optional data frame with partitioning variables for
which predictions should be computed. By default the learning data set
is used.</p>
</td></tr>
<tr><td><code id="pctree_+3A_type">type</code></td>
<td>
<p>character specifying the type of predictions or plot. For the
<code>predict</code> method, either just the ID of the terminal <code>"node"</code>
can be predicted or some property of the model at a given person parameter
(specified by <code>personpar</code>).</p>
</td></tr>
<tr><td><code id="pctree_+3A_personpar">personpar</code></td>
<td>
<p>numeric person parameter (of length 1) at which the
predictions are evaluated.</p>
</td></tr>
<tr><td><code id="pctree_+3A_terminal_panel">terminal_panel</code>, <code id="pctree_+3A_tp_args">tp_args</code>, <code id="pctree_+3A_tnex">tnex</code>, <code id="pctree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>arguments passed to
<code><a href="partykit.html#topic+plot.modelparty">plot.modelparty</a></code>/<code><a href="partykit.html#topic+plot.party">plot.party</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Partial credit trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to partial credit models
(implemented in <code><a href="psychotools.html#topic+pcmodel">pcmodel</a></code>).
</p>
<p>Various methods are provided for <code>"pctree"</code> objects, most of them
inherit their behavior from <code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>,
etc.). For the PCMs in the nodes of a tree, <code>coef</code> extracts all item and threshold
parameters except those restricted to be zero. <code>itempar</code> and <code>threshpar</code>
extract all item and threshold parameters (including the restricted ones).
The <code>plot</code> method by default employs the <code><a href="#topic+node_regionplot">node_regionplot</a></code>
panel-generating function and the <code><a href="#topic+node_profileplot">node_profileplot</a></code> panel-generating
function is provided as an alternative.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"pctree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>References</h3>

<p>Komboz B, Zeileis A, Strobl C (2018).
Tree-Based Global Model Tests for Polytomous Rasch Models.
<em>Educational and Psychological Measurement</em>, <b>78</b>(1), 128&ndash;166.
<a href="https://doi.org/10.1177/0013164416664394">doi:10.1177/0013164416664394</a>
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+pcmodel">pcmodel</a></code>,
<code><a href="#topic+rstree">rstree</a></code>, <code><a href="#topic+raschtree">raschtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>o &lt;- options(digits = 4)

## verbal aggression data from package psychotools
data("VerbalAggression", package = "psychotools")

## use response to the second other-to-blame situation (train)
VerbalAggression$s2 &lt;- VerbalAggression$resp[, 7:12]

## exclude subjects who only scored in the highest or the lowest categories
VerbalAggression &lt;- subset(VerbalAggression, rowSums(s2) &gt; 0 &amp; rowSums(s2) &lt; 12)

## fit partial credit tree model
pct &lt;- pctree(s2 ~ anger + gender, data = VerbalAggression)

## print tree (with and without parameters)
print(pct)
print(pct, FUN = function(x) " *")

## show summary for terminal panel nodes
summary(pct)

## visualization
plot(pct, type = "regions")
plot(pct, type = "profile")

## extract item and threshold parameters
coef(pct)
itempar(pct)
threshpar(pct)

## inspect parameter stability tests in the splitting node
if(require("strucchange")) sctest(pct, node = 1)

options(digits = o$digits)


## partial credit tree on artificial data from Komboz et al. (2018)
data("DIFSimPC", package = "psychotree")
pct2 &lt;- pctree(resp ~ gender + age + motivation, data = DIFSimPC)
plot(pct2, ylim = c(-4.5, 4.5), names = paste("I", 1:8))

</code></pre>

<hr>
<h2 id='raschtree'>Rasch Trees</h2><span id='topic+raschtree'></span><span id='topic+print.raschtree'></span><span id='topic+plot.raschtree'></span><span id='topic+predict.raschtree'></span><span id='topic+itempar.raschtree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on Rasch models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raschtree(formula, data, na.action,
  reltol = 1e-10, deriv = c("sum", "diff", "numeric"), maxit = 100L,
  ...)

## S3 method for class 'raschtree'
predict(object, newdata = NULL,
  type = c("probability", "cumprobability", "mode", "median", "mean",
    "category-information", "item-information", "test-information", "node"),
  personpar = 0, ...)

## S3 method for class 'raschtree'
plot(x, type = c("profile", "regions"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raschtree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This
should be of type <code>y ~ x1 + x2</code>
where <code>y</code> should be a binary 0/1 item response matrix
and <code>x1</code> and <code>x2</code> are used as partitioning variables.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain missing values (<code>NA</code>s).</p>
</td></tr>
<tr><td><code id="raschtree_+3A_deriv">deriv</code></td>
<td>
<p>character. Which type of derivatives should be used for computing
gradient and Hessian matrix? Analytical with sum algorithm (<code>"sum"</code>),
analytical with difference algorithm (<code>"diff"</code>, faster but numerically unstable),
or numerical. Passed to <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_reltol">reltol</code>, <code id="raschtree_+3A_maxit">maxit</code></td>
<td>
<p>arguments passed via <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>
to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_...">...</code></td>
<td>
<p>arguments passed to the underlying functions, i.e., to
<code><a href="partykit.html#topic+mob_control">mob_control</a></code> for <code>raschtree</code>, and to the
underlying <code>predict</code> and <code>plot</code> methods, respectively.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_object">object</code>, <code id="raschtree_+3A_x">x</code></td>
<td>
<p>an object of class <code>"raschtree"</code>.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_newdata">newdata</code></td>
<td>
<p>optional data frame with partitioning variables for
which predictions should be computed. By default the learning data set
is used.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_type">type</code></td>
<td>
<p>character specifying the type of predictions or plot. For the
<code>predict</code> method, either just the ID of the terminal <code>"node"</code>
can be predicted or some property of the model at a given person parameter
(specified by <code>personpar</code>).</p>
</td></tr>
<tr><td><code id="raschtree_+3A_personpar">personpar</code></td>
<td>
<p>numeric person parameter (of length 1) at which the
predictions are evaluated.</p>
</td></tr>
<tr><td><code id="raschtree_+3A_terminal_panel">terminal_panel</code>, <code id="raschtree_+3A_tp_args">tp_args</code>, <code id="raschtree_+3A_tnex">tnex</code>, <code id="raschtree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>arguments passed to
<code><a href="partykit.html#topic+plot.modelparty">plot.modelparty</a></code>/<code><a href="partykit.html#topic+plot.party">plot.party</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rasch trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to Rasch models
(implemented in <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>).
</p>
<p>Various methods are provided for <code>"raschtree"</code> objects, most of them
inherit their behavior from <code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>,
etc.). For the Rasch models in the nodes of a tree, <code>coef</code> extracts all item
parameters except the first one which is always restricted to be zero. <code>itempar</code>
extracts all item parameters (including the first one) and by default restricts their
sum to be zero (but other restrictions can be used as well). The <code>plot</code> method
by default employs the <code><a href="#topic+node_profileplot">node_profileplot</a></code> panel-generating function and
the <code><a href="#topic+node_regionplot">node_regionplot</a></code> panel-generating function is provided as an alternative.
</p>
<p>Rasch tree models are introduced in Strobl et al. (2015), whose analysis
for the <code><a href="#topic+SPISA">SPISA</a></code> data is replicated in
<code>vignette("raschtree", package = "psychotree")</code>. Their illustration
employing artificial data is replicated below.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"raschtree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>References</h3>

<p>Strobl C, Kopf J, Zeileis A (2015). Rasch Trees: A New Method for Detecting
Differential Item Functioning in the Rasch Model.
<em>Psychometrika</em>, <b>80</b>(2), 289&ndash;316.
<a href="https://doi.org/10.1007/s11336-013-9388-3">doi:10.1007/s11336-013-9388-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+raschmodel">raschmodel</a></code>,
<code><a href="#topic+rstree">rstree</a></code>, <code><a href="#topic+pctree">pctree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>o &lt;- options(digits = 4)

## artificial data
data("DIFSim", package = "psychotree")

## fit Rasch tree model
rt &lt;- raschtree(resp ~ age + gender + motivation, data = DIFSim)
plot(rt)

## extract item parameters
itempar(rt)

## inspect parameter stability tests in all splitting nodes
if(require("strucchange")) {
sctest(rt, node = 1)
sctest(rt, node = 2)
}

## highlight items 3 and 14 with DIF
ix &lt;- rep(1, 20)
ix[c(3, 14)] &lt;- 2
plot(rt, ylines = 2.5,  cex = c(0.4, 0.8)[ix], 
  pch = c(19, 19)[ix], col = gray(c(0.5, 0))[ix])

options(digits = o$digits)
</code></pre>

<hr>
<h2 id='rstree'>Rating Scale Trees</h2><span id='topic+rstree'></span><span id='topic+plot.rstree'></span><span id='topic+print.rstree'></span><span id='topic+predict.rstree'></span><span id='topic+itempar.rstree'></span><span id='topic+threshpar.rstree'></span>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on rating scale models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rstree(formula, data, na.action, reltol = 1e-10,
  deriv = c("sum", "diff"), maxit = 100L, ...)

## S3 method for class 'rstree'
predict(object, newdata = NULL,
  type = c("probability", "cumprobability", "mode", "median", "mean",
    "category-information", "item-information", "test-information", "node"),
  personpar = 0, ...)

## S3 method for class 'rstree'
plot(x, type = c("regions", "profile"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rstree_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This
should be of type <code>y ~ x1 + x2</code> where <code>y</code> should be a
matrix with items in the columns and observations in the rows and
<code>x1</code> and <code>x2</code> are used as partitioning
variables. Additionally each item (column) should have the same
maximum value (see <code><a href="#topic+pctree">pctree</a></code> for a way to handle
variable maximum values).</p>
</td></tr>
<tr><td><code id="rstree_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="rstree_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain missing values (<code>NA</code>s).</p>
</td></tr>
<tr><td><code id="rstree_+3A_deriv">deriv</code></td>
<td>
<p>character. If &quot;sum&quot; (the default), the first derivatives
of the elementary symmetric functions are calculated with the sum
algorithm. Otherwise (&quot;diff&quot;) the difference algorithm (faster but
numerically unstable) is used.</p>
</td></tr>
<tr><td><code id="rstree_+3A_reltol">reltol</code>, <code id="rstree_+3A_maxit">maxit</code></td>
<td>
<p>arguments passed via <code><a href="psychotools.html#topic+rsmodel">rsmodel</a></code>
to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="rstree_+3A_...">...</code></td>
<td>
<p>arguments passed to the underlying functions, i.e., to
<code><a href="partykit.html#topic+mob_control">mob_control</a></code> for <code>rstree</code>, and to the
underlying <code>predict</code> and <code>plot</code> methods, respectively.</p>
</td></tr>
<tr><td><code id="rstree_+3A_object">object</code>, <code id="rstree_+3A_x">x</code></td>
<td>
<p>an object of class <code>"raschtree"</code>.</p>
</td></tr>
<tr><td><code id="rstree_+3A_newdata">newdata</code></td>
<td>
<p>optional data frame with partitioning variables for
which predictions should be computed. By default the learning data set
is used.</p>
</td></tr>
<tr><td><code id="rstree_+3A_type">type</code></td>
<td>
<p>character specifying the type of predictions or plot. For the
<code>predict</code> method, either just the ID of the terminal <code>"node"</code>
can be predicted or some property of the model at a given person parameter
(specified by <code>personpar</code>).</p>
</td></tr>
<tr><td><code id="rstree_+3A_personpar">personpar</code></td>
<td>
<p>numeric person parameter (of length 1) at which the
predictions are evaluated.</p>
</td></tr>
<tr><td><code id="rstree_+3A_terminal_panel">terminal_panel</code>, <code id="rstree_+3A_tp_args">tp_args</code>, <code id="rstree_+3A_tnex">tnex</code>, <code id="rstree_+3A_drop_terminal">drop_terminal</code></td>
<td>
<p>arguments passed to
<code><a href="partykit.html#topic+plot.modelparty">plot.modelparty</a></code>/<code><a href="partykit.html#topic+plot.party">plot.party</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rating scale trees are an application of model-based recursive partitioning
(implemented in <code><a href="partykit.html#topic+mob">mob</a></code>) to rating scale models
(implemented in <code><a href="psychotools.html#topic+rsmodel">rsmodel</a></code>).
</p>
<p>Various methods are provided for <code>"rstree"</code> objects, most of them
inherit their behavior from <code>"mob"</code> objects (e.g., <code>print</code>,
<code>summary</code>, etc.). For the rating scale models in the nodes of a
tree, <code>coef</code> extracts all item parameters. The <code>plot</code> method
employs the <code><a href="#topic+node_regionplot">node_regionplot</a></code> panel-generating function by
default.
</p>
<p>Various methods are provided for <code>"rstree"</code> objects, most of them
inherit their behavior from <code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>,
etc.). For the RSMs in the nodes of a tree, <code>coef</code> extracts all item and threshold
parameters except those restricted to be zero. <code>itempar</code> and <code>threshpar</code>
extract all item and threshold parameters (including the restricted ones).
The <code>plot</code> method by default employs the <code><a href="#topic+node_regionplot">node_regionplot</a></code>
panel-generating function and the <code><a href="#topic+node_profileplot">node_profileplot</a></code> panel-generating
function is provided as an alternative.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"rstree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>References</h3>

<p>Komboz B, Zeileis A, Strobl C (2018).
Tree-Based Global Model Tests for Polytomous Rasch Models.
<em>Educational and Psychological Measurement</em>, <b>78</b>(1), 128&ndash;166.
<a href="https://doi.org/10.1177/0013164416664394">doi:10.1177/0013164416664394</a>
</p>


<h3>See Also</h3>

<p><code><a href="partykit.html#topic+mob">mob</a></code>, <code><a href="psychotools.html#topic+rsmodel">rsmodel</a></code>,
<code><a href="#topic+pctree">pctree</a></code>, <code><a href="#topic+raschtree">raschtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## IGNORE_RDIFF_BEGIN
o &lt;- options(digits = 4)

## verbal aggression data from package psychotools
data("VerbalAggression", package = "psychotools")

## responses to the first other-to-blame situation (bus)
VerbalAggression$s1 &lt;- VerbalAggression$resp[, 1:6]

## exclude subjects who only scored in the highest or the lowest categories
VerbalAggression &lt;- subset(VerbalAggression, rowSums(s1) &gt; 0 &amp; rowSums(s1) &lt; 12)

## fit rating scale tree model for the first other-to-blame situation
rst &lt;- rstree(s1 ~ anger + gender, data = VerbalAggression)

## print tree (with and without parameters)
print(rst)
print(rst, FUN = function(x) " *")

## show summary for terminal panel nodes
summary(rst)

## visualization
plot(rst, type = "regions")
plot(rst, type = "profile")

## extract item and threshold parameters
coef(rst)
itempar(rst)
threshpar(rst)

## inspect parameter stability tests in all splitting nodes
if(require("strucchange")) {
sctest(rst, node = 1)
sctest(rst, node = 2)
}

options(digits = o$digits)
## IGNORE_RDIFF_END
</code></pre>

<hr>
<h2 id='SPISA'>SPIEGEL Studentenpisa Data (Subsample)</h2><span id='topic+SPISA'></span>

<h3>Description</h3>

<p>A subsample from the general knowledge quiz &ldquo;Studentenpisa&rdquo;
conducted online by the German weekly news magazine SPIEGEL. The
data contain the quiz results from 45 questions as well as sociodemographic
data for 1075 university students from Bavaria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SPISA")</code></pre>


<h3>Format</h3>

<p>A data frame containing 1075 observations on 6 variables.
</p>

<dl>
<dt>spisa</dt><dd><p>matrix with <code>0</code>/<code>1</code> results from
45 questions in the quiz (indicating wrong/correct answers).</p>
</dd>
<dt>gender</dt><dd><p>factor indicating gender.</p>
</dd>
<dt>age</dt><dd><p>age in years.</p>
</dd>
<dt>semester</dt><dd><p>numeric indicating semester of university enrollment.</p>
</dd>
<dt>elite</dt><dd><p>factor indicating whether the university the student is
enrolled in has been granted &ldquo;elite&rdquo; status by the German
&ldquo;excellence initiative&rdquo;.</p>
</dd>
<dt>spon</dt><dd><p>ordered factor indicating frequency of accessing the
SPIEGEL online (SPON) magazine.</p>
</dd>
</dl>



<h3>Details</h3>

<p>An online quiz for testing one's general knowledge was conducted by
the German weekly news magazine SPIEGEL in 2009. Overall, about 700,000
participants answered the quiz and a set of sociodemographic questions.
The general knowledge quiz consisted of a total of 45 items from five
different topics: politics, history, economy, culture and natural sciences.
For each topic, four different sets of nine items were available, that
were randomly assigned to the participants. A thorough analysis and
discussion of the original data set is provided in Trepte and Verbeet (2010).
</p>
<p>Here, we provide the subsample of university students enrolled in the
federal state of Bavaria, who had been assigned questionnaire number 20
(so that all subjects have answered the same set of items). Excluding
all incomplete records, this subsample contains 1075 observations.
</p>
<p>The data are analyzed in Strobl et al. (2010), whose analysis is replicated
in <code>vignette("raschtree", package = "psychotree")</code>.
</p>
<p>The full list of items in questionnaire 20 is given below.
</p>
<p>Politics:<br />
Who determines the rules of action in German politics according to the constitution?
&ndash; The Bundeskanzler (federal chancellor).<br />
What is the function of the second vote in the elections to the German Bundestag (federal parliament)?
&ndash; It determines the allocation of seats in the Bundestag.<br />
How many people were killed by the RAF (Red Army Faction)?
&ndash; 33.<br />
Where is Hessen (i.e., the German federal country Hesse) located?
&ndash; (Indicate location on a map.)<br />
What is the capital of Rheinland-Pfalz (i.e., the German federal country Rhineland-Palatinate)?
&ndash; Mainz.<br />
Who is this? 
&ndash; (Picture of Horst Seehofer.)<br />
Which EU institution is elected in 2009 by the citizens of EU member countries?
&ndash; European Parliament.<br />
How many votes does China have in the UNO general assembly?
&ndash; 1.<br />
Where is Somalia located?
&ndash; (Indicate location on a map.)
</p>
<p>History:<br />
The Roman naval supremacy was established through...
&ndash; ... the abolition of Carthage.<br />
In which century did the Thirty Years' War take place?
&ndash; The 17th century.<br />
Which form of government is associated with the French King Louis XIV?
&ndash; Absolutism.<br />
What island did Napoleon die on in exile?
&ndash; St. Helena.<br />
How many percent of the votes did the NSDAP receive in the 1928 elections of the German Reichstag?
&ndash; About 3 percent.<br />
How many Jews were killed by the Nazis during the Holocaust?
&ndash; About 6 Million.<br />
Who is this?
&ndash; (Picture of Johannes Rau, former German federal president.)<br />
Which of the following countries is not a member of the EU?
&ndash; Croatia.<br />
How did Mao Zedong expand his power in China?
&ndash; The Long March.
</p>
<p>Economy:<br />
Who is this?
&ndash; (Picture of Dieter Zetsche, CEO of Mercedes-Benz.)<br />
What is the current full Hartz IV standard rate (part of the social welfare) for adults?
&ndash; 351 Euro.<br />
What was the average per capita gross national product in Germany in 2007?
&ndash; About 29,400 Euro.\
What is a CEO?
&ndash; A Chief Executive Officer.<br />
What is the meaning of the hexagonal &ldquo;organic&rdquo; logo?
&ndash; Synthetic pesticides are prohibited.<br />
Which company does this logo represent?
&ndash; Deutsche Bank.<br />
Which German company took over the British automobile manufacturers Rolls-Royce?
&ndash; BMW.<br />
Which internet company took over the media group Time Warner?
&ndash; AOL.<br />
What is the historic meaning of manufacturies?
&ndash; Manufacturies were the precursors of industrial mass production.<br />
</p>
<p>Culture:<br />
Which painter created this painting?
&ndash; Andy Warhol.<br />
What do these four buildings have in common?
&ndash; All four were designed by the same architects.<br />
Roman numbers: What is the meaning of CLVI?
&ndash; 156.<br />
What was the German movie with the most viewers since 1990?
&ndash; Der Schuh des Manitu.<br />
In which TV series was the US president portrayed by an African American actor for a long time?
&ndash; 24.<br />
What is the name of the bestselling novel by Daniel Kehlmann?
&ndash; Die Vermessung der Welt (Measuring The World).<br />
Which city is the setting for the novel &lsquo;Buddenbrooks&rsquo;?
&ndash; Lübeck.<br />
In which city is this building located?
&ndash; Paris.<br />
Which one of the following operas is not by Mozart?
&ndash; Aida.
</p>
<p>Natural sciences:<br />
Why does an ice floe not sink in the water?
&ndash; Due to the lower density of ice.<br />
What is ultrasound not used for?
&ndash; Radio.<br />
Which sensory cells in the human eye make color vision possible?
&ndash; Cones.<br />
What is also termed Trisomy 21?
&ndash; Down syndrome.<br />
Which element is the most common in the Earth's atmosphere?
&ndash; Nitrogen.<br />
Which kind of tree does this leaf belong to?
&ndash; Maple.<br />
Which kind of bird is this?
&ndash; Blackbird.<br />
Where is the stomach located?
&ndash; (Indicate location on a map of the body.)<br />
What is the sum of interior angles in a triangle?
&ndash; 180 degrees.
</p>


<h3>References</h3>

<p>Strobl C, Kopf J, Zeileis A (2015). Rasch Trees: A New Method for Detecting
Differential Item Functioning in the Rasch Model.
<em>Psychometrika</em>, <b>80</b>(2), 289&ndash;316.
<a href="https://doi.org/10.1007/s11336-013-9388-3">doi:10.1007/s11336-013-9388-3</a>
</p>
<p>SPIEGEL Online (2009). Studentenpisa &ndash; Alle Fragen, alle Antworten.
In German. Accessed 2010-10-26.
<a href="https://www.spiegel.de/lebenundlernen/uni/studentenpisa-alle-fragen-alle-antworten-a-620101.html">https://www.spiegel.de/lebenundlernen/uni/studentenpisa-alle-fragen-alle-antworten-a-620101.html</a>
</p>
<p>Trepte S, Verbeet M (2010). Allgemeinbildung in Deutschland &ndash;
Erkenntnisse aus dem SPIEGEL-Studentenpisa-Test.
ISBN 978-3-531-17218-7. VS Verlag, Wiesbaden.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+raschtree">raschtree</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("SPISA", package = "psychotree")

## summary of covariates
summary(SPISA[,-1])

## histogram of raw scores
hist(rowSums(SPISA$spisa), breaks = 0:45 + 0.5)

## Not run: 
## See the following vignette for a tree-based DIF analysis
vignette("raschtree", package = "psychotree")

## End(Not run)
</code></pre>

<hr>
<h2 id='Topmodel2007'>Attractiveness of Germany's Next Topmodels 2007</h2><span id='topic+Topmodel2007'></span>

<h3>Description</h3>

<p>Preferences of 192 respondents judging the attractiveness of the top six
contestants of the TV show <em>Germany's Next Topmodel 2007</em> (second cycle).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Topmodel2007")</code></pre>


<h3>Format</h3>

<p>A data frame containing 192 observations on 6 variables.
</p>

<dl>
<dt>preference</dt><dd><p>Paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.
Preferences for all 15 paired comparisons from 6 contestants:
Barbara, Anni, Hana, Fiona, Mandy, and Anja.</p>
</dd>
<dt>gender</dt><dd><p>Factor coding gender.</p>
</dd>
<dt>age</dt><dd><p>Integer. Age of the respondents in years.</p>
</dd>
<dt>q1</dt><dd><p>Factor. Do you recognize the women on the pictures?/Do you know
the TV show Germany's Next Topmodel?</p>
</dd>
<dt>q2</dt><dd><p>Factor. Did you watch Germany's Next Topmodel regularly?</p>
</dd>
<dt>q3</dt><dd><p>Factor. Did you watch the final show of Germany's Next
Topmodel?/Do you know who won Germany's Next Topmodel?</p>
</dd>
</dl>



<h3>Details</h3>

<p>Germany's Next Topmodel is a German casting television show (based on a
concept introduced in the United States) hosted by Heidi Klum (see Wikipedia 2009).
The second season of the show aired March&ndash;May 2007.
</p>
<p>A survey was conducted at the Department of Psychology, Universität Tübingen,
in 2007 shortly after the final show. The sample was stratified by gender and
age (younger versus older than 30 years) with 48 participants in each group.
</p>
<p>Digital photographs (resolution 303 times 404 pixels) of the top six
contestants were available from the ProSieben web page at the time of the survey.
The photos were selected to be comparable, showing the contestant's face and the
upper part of the body, all women being casually dressed.
</p>
<p>Participants were presented with all 15 pairs of photographs. On each trial,
their task was to judge which of the two women on the photos was the more
attractive. In order to assess the participants' expertise, additional
questions regarding their familiarity with the show were asked after the
pairwise comparisons were completed.
</p>
<p>The actual ranking, as resulting from sequential elimination during the
course of the show, was (from first to sixth place): Barbara, Anni, Hana,
Fiona, Mandy, Anja.
</p>


<h3>References</h3>

<p>Wikipedia (2009). Germany's Next Topmodel &ndash; Wikipedia, The Free Encyclopedia.
<a href="https://en.wikipedia.org/wiki/Germany's_Next_Topmodel">https://en.wikipedia.org/wiki/Germany's_Next_Topmodel</a>, accessed 2009-02-06.
</p>


<h3>See Also</h3>

<p><code><a href="psychotools.html#topic+paircomp">paircomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Topmodel2007", package = "psychotree")
summary(Topmodel2007$preference)
xtabs(~ gender + I(age &lt; 30), data = Topmodel2007)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
