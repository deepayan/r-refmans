<!DOCTYPE html><html lang="en"><head><title>Help for package granova</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {granova}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#granova-package'>
<p>Graphical Analysis of Variance</p></a></li>
<li><a href='#anorexia.sub'><p>Family Treatment Weight change data for young female anorexia patients.</p></a></li>
<li><a href='#arousal'><p>Arousal in Rats</p></a></li>
<li><a href='#blood_lead'><p>Blood lead levels of lead workers' children matched with similar control children.</p></a></li>
<li><a href='#granova.1w'><p>Graphic display for one-way ANOVA</p></a></li>
<li><a href='#granova.2w'><p>Graphical display of data for two-way analysis of variance</p></a></li>
<li><a href='#granova.contr'><p>Graphic Display of Contrast Effect of ANOVA</p></a></li>
<li><a href='#granova.ds'><p>Granova for Display of Dependent Sample Data</p></a></li>
<li><a href='#poison'><p>Poison data from Biological Experiment</p></a></li>
<li><a href='#rat'><p>Weight gains of rats fed different diets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Graphical Analysis of Variance</td>
</tr>
<tr>
<td>Author:</td>
<td>Frederic Bertrand <a href="https://orcid.org/0000-0002-0837-8281"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre],
  Robert M. Pruzek [aut],
  James E. Helmreich [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frederic Bertrand &lt;frederic.bertrand@utt.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), car (&ge; 2.0-21)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mgcv, rgl, tcltk, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>This small collection of functions provides what we call elemental graphics for display of analysis of variance
    results, David C. Hoaglin, Frederick Mosteller and John W. Tukey (1991, ISBN:978-0-471-52735-0), Paul R. Rosenbaum (1989) 
    &lt;<a href="https://doi.org/10.2307%2F2684513">doi:10.2307/2684513</a>&gt;, Robert M. Pruzek and James E. Helmreich <a href="https://jse.amstat.org/v17n1/helmreich.html">https://jse.amstat.org/v17n1/helmreich.html</a>. 
    The term elemental derives from the fact that each function is aimed at construction of
    graphical displays that afford direct visualizations of data with respect to the fundamental 
    questions that drive the particular analysis of variance methods. These functions can be 
    particularly helpful for students and non-statistician analysts. But these methods should be
    quite generally helpful for work-a-day applications of all kinds, as they can help to identify
    outliers, clusters or patterns, as well as highlight the role of non-linear transformations of data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-22 10:55:25 UTC; fbertran</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-22 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='granova-package'>
Graphical Analysis of Variance
</h2><span id='topic+granova-package'></span><span id='topic+granova'></span>

<h3>Description</h3>

<p>This small collection of functions provides what we call elemental graphics for display of anova
results. The term elemental derives from the fact that each function is aimed at construction of
graphical displays that afford direct visualizations of data with respect to the fundamental 
questions that drive the particular anova methods. The two main functions are granova.1w 
(a graphic for one way anova) and granova.2w (a corresponding graphic for two way anova). These 
functions were written to display data for any number of groups, regardless of their sizes 
(however, very large data sets or numbers of groups can be problematic). For these two functions 
a specialized approach is used to construct data-based contrast vectors for which anova data are
displayed. The result is that the graphics use straight lines, and when appropriate flat surfaces,
to facilitate clear interpretations while being faithful to the standard effect tests in anova. 
The graphic results are complementary to standard summary tables for these two basic kinds of 
analysis of variance; numerical summary results of analyses are also provided as side effects.
Two additional functions are granova.ds (for comparing two dependent samples), and granova.contr
(which provides graphic displays for a priori contrasts). All functions provide relevant
numerical results to supplement the graphic displays of anova data.
The graphics based on these functions should be especially helpful for learning how the methods have 
been applied to answer the question(s) posed. This means they can be 
particularly helpful for students and non-statistician analysts. But these methods should be
quite generally helpful for work-a-day applications of all kinds, as they can help to identify
outliers, clusters or patterns, as well as highlight the role of non-linear transformations of data. In the case 
of granova.1w and granova.ds especially, several arguments are provided to facilitate flexibility
in the construction of graphics that accommodate diverse features of data, according to their 
corresponding display requirements. See the help files for individual functions.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> granova</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Robert M. Pruzek &lt;RMPruzek@yahoo.com&gt; 
</p>
<p>James E. Helmreich &lt;James.Helmreich@Marist.edu&gt;
</p>
<p>Maintainer: Frederic Bertrand &lt;frederic.bertrand@utt.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granova.1w">granova.1w</a></code>
<code><a href="#topic+granova.2w">granova.2w</a></code>
<code><a href="#topic+granova.ds">granova.ds</a></code>
<code><a href="#topic+granova.contr">granova.contr</a></code>
</p>

<hr>
<h2 id='anorexia.sub'>Family Treatment Weight change data for young female anorexia patients.</h2><span id='topic+anorexia.sub'></span>

<h3>Description</h3>

<p>The MASS package includes the dataset <code>anorexia</code>, containing pre and post treatment weights for young female anorexia patients.  This is a subset of those data, containing only those patients who received Family Treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anorexia.sub)</code></pre>


<h3>Format</h3>

<p>A dataframe with 17 observations on the following 2 variables, no NAs.
</p>

<dl>
<dt><code>Prewt</code></dt><dd><p>Pretreatment weight of subject, in pounds.</p>
</dd>
<dt><code>Postwt</code></dt><dd><p>Postreatment weight of subject, in pounds.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Hand, D. J., Daly, F., McConway, K., Lunn, D. and Ostrowski, E. eds (1993) A Handbook of Small Data Sets. Chapman &amp; Hall, Data set 285 (p. 229)</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth edition. Springer.</p>

<hr>
<h2 id='arousal'>Arousal in Rats</h2><span id='topic+arousal'></span>

<h3>Description</h3>

<p>40 rats were given divided randomly into four groups and assigned to one of four treatments: placebo, drug A, drug B, or both drug A and drug B.  Response is a standard measure of physiological arousal. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(arousal)</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations, 10 in each of 4 columns the corresponding to placebo, drug A, drug B and both drug A and drug B; no NAs.
</p>

<dl>
<dt><code>Placebo</code></dt><dd><p>Rats receiving a placebo treatment.</p>
</dd>
<dt><code>Drug.A</code></dt><dd><p>Rats receiving only drug A.</p>
</dd>
<dt><code>Drug.B</code></dt><dd><p>Rats receiving only drug B.</p>
</dd>
<dt><code>Drug.A.B</code></dt><dd><p>Rats receiving both drug A and drug B.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Richard Lowry. Concepts &amp; Applications of Inferential Statistics. Vassar College, Poughkeepsie, N.Y., 2010,
http://faculty.vassar.edu/lowry/webtext.html</p>

<hr>
<h2 id='blood_lead'>Blood lead levels of lead workers' children matched with similar control children.</h2><span id='topic+blood_lead'></span>

<h3>Description</h3>

<p>Children of parents who had worked in a factory where lead was used in making batteries were matched by age, exposure to traffic, and neighborhood with children whose parents did not work in lead-related industries. Whole blood was assessed for lead content yielding measurements in mg/dl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anorexia.sub)</code></pre>


<h3>Format</h3>

<p>A dataframe with 33 observations on the following 2 variables, no NAs.
</p>

<dl>
<dt><code>Exposed</code></dt><dd><p>Blood lead level of exposed child, mg/dl.</p>
</dd>
<dt><code>Control</code></dt><dd><p>Blood lead level of exposed child, mg/dl.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Morton, D., Saah, A., Silberg, S., Owens, W., Roberts, M., Saah, M. (1982). Lead absorption in children of employees in a lead related industry. American Journal of Epidemiology, 115:549-555.</p>


<h3>References</h3>

<p>See discussion in Section 2.5 of Enhancing Dependent Sample Analyses with Graphics, Journal of Statistics Education Volume 17, Number 1 (March 2009).</p>

<hr>
<h2 id='granova.1w'>Graphic display for one-way ANOVA</h2><span id='topic+granova.1w'></span>

<h3>Description</h3>

<p>Graphic to display data for a one-way analysis of variance, and also to help understand how ANOVA works, 
how the F statistic is generated for the data in hand, etc. The graphic may be called 'elemental' or 'natural' because it is built
upon the key question that drives one-way ANOVA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>granova.1w(data, group = NULL, dg = 2, h.rng = 1.25, v.rng = 0.2, 
   box = FALSE, jj = 1, kx = 1, px = 1, size.line = -2.5, 
   top.dot = 0.15, trmean = FALSE, resid = FALSE, dosqrs = TRUE, 
   ident = FALSE, pt.lab = NULL, xlab = NULL, ylab = NULL, 
   main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="granova.1w_+3A_data">data</code></td>
<td>
<p>Dataframe or vector. If a dataframe, the two or more columns are taken to be groups of equal size (whence <code>group</code> is NULL).
If <code>data</code> is a vector, <code>group</code> must be a vector, perhaps a factor, that indicates groups (unequal group sizes allowed with this option). </p>
</td></tr>
<tr><td><code id="granova.1w_+3A_group">group</code></td>
<td>
<p>Group indicator, generally a factor in case <code>data</code> is a vector.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_dg">dg</code></td>
<td>
<p>Numeric; sets number of decimal points in output display, default = 2.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_h.rng">h.rng</code></td>
<td>
<p>Numeric; controls the horizontal spread of groups, default = 1.25</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_v.rng">v.rng</code></td>
<td>
<p>Numeric; controls the vertical spread of points, default = 0.25. </p>
</td></tr>
<tr><td><code id="granova.1w_+3A_box">box</code></td>
<td>
<p>Logical; provides a bounding box (actually a square) to the graph; default FALSE.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_jj">jj</code></td>
<td>
<p>Numeric; sets horizontal jittering level of points; when pairs of ordered means are close to one another, try jj &lt; 1; default = 1.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_kx">kx</code></td>
<td>
<p>Numeric; controls relative sizes of <code>cex</code>, default = 1.0</p>
</td></tr>  
<tr><td><code id="granova.1w_+3A_px">px</code></td>
<td>
<p>Numeric; controls relative sizes of <code>cex.axis</code>, default = 1.0</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_size.line">size.line</code></td>
<td>
<p>Numeric; controls vertical location of group size and name labels, default = -2.5.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_top.dot">top.dot</code></td>
<td>
<p>Numeric; controls hight of end of vertical dotted lines through groups; default = .15.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_trmean">trmean</code></td>
<td>
<p>Logical; marks 20% trimmed means for each group (as green cross) and prints out those values in output window, default = FALSE.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_resid">resid</code></td>
<td>
<p>Logical; displays marginal distribution of residuals (as a 'rug') on right side (wrt grand mean), default = FALSE.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_dosqrs">dosqrs</code></td>
<td>
<p>Logical; ensures plot of squares (for variances); when FALSE or the number of groups is 2, squares will be suppressed, default = TRUE.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_ident">ident</code></td>
<td>
<p>Logical; allows user to identify specific points on the plot, default = FALSE.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_pt.lab">pt.lab</code></td>
<td>
<p>Character vector; allows user to provide labels for points, else the rownames of xdata are used (if defined),
or if not labels are 1:N (for N the total number of all data points), default = NULL.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_xlab">xlab</code></td>
<td>
<p>Character; horizontal axis label, default = NULL.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_ylab">ylab</code></td>
<td>
<p>Character; vertical axis label, default = NULL.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_main">main</code></td>
<td>
<p>Character; main label, top of graphic; can be supplied by user, default = NULL, which leads to printing of generic title for graphic.</p>
</td></tr>
<tr><td><code id="granova.1w_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to <code>identify</code>, for example <code>offset</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The central idea of the graphic is to use the fact that a one way analysis of variance F statistic is the ratio of two variances each
of which can usefully be presented graphically. In particular, the sum of squares between (among) can be represented as the 
sum of products of so-called effects (each being a group mean minus the grand mean) and the group means; when these effects 
are themselves plotted against the group means a straight line necessarily ensues. The group means are plotted as (red 
triangles along this line. Data points (jittered) for groups are displayed (vertical axis) with respect to respective group means.
One-way ANOVA residuals can be displayed (set resid=TRUE) as a rug plot (on right margin); the standard deviation of the residuals, 
when squared, is just the mean square within, which corresponds to area of blue square. The conventional F statistic is just a ratio of 
the between to the within mean squares, or variances, each of which corresponds to areas of squares in the graphic. 
The blue square, centered on the grand mean vertically and zero for the X-axis, corresponds to mean square within (with side based 
on [twice] the pooled standard deviation); the red square corresponds to the mean square between, also centered on the grand mean. 
Use of effects to locate the groups in the order of the observed means, from left to right (by increasing size) yields this 'elemental' 
graphic for this commonly used statistical method. 
</p>
<p>Groups need not be of the same sizes, nor do data need to reflect any particular distributional characteristics. Skewness, outliers, 
clustering of data points, and various other features of the data may be seen in this graphic, possibly identified using point labels. 
Trimmed means (20%) can also be displayed if desired. Finally, by redisplaying the response data in two or more versions of the graphic 
it can be useful to visualize various effects of non-linear data transformations. (<code>ident=TRUE</code>).
</p>


<h3>Value</h3>

<p>Returns a list with two components:
</p>
<table role = "presentation">
<tr><td><code>grandsum</code></td>
<td>
<p>Contains the basic ANOVA statistics: the grandmean, the degrees of freedom and mean sums of squares between and within groups,
the F statistic, F probability and the ratio between the sum of squares between groups and the total sum of squares.</p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>Contains a table of statistics by group: the size of each group, the contrast coefficients used in plotting the groups, the weighted
means, means, and 20% trimmed means, and the group variances and standard deviations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>, 
</p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>  
</p>


<h3>References</h3>

<p>Fundamentals of Exploratory Analysis of Variance, Hoaglin D., Mosteller F. and Tukey J. eds., Wiley, 1991.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+granova.2w">granova.2w</a></code>, <code><a href="#topic+granova.contr">granova.contr</a></code>, <code><a href="#topic+granova.ds">granova.ds</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>	
data(arousal)
#Drug A
granova.1w(arousal[,1:2], h.rng = 1.6, v.rng = 0.5, top.dot = .35)

#########################

data(anorexia, package="MASS")
wt.gain &lt;- anorexia[, 3] - anorexia[, 2]
granova.1w(wt.gain, group = anorexia[, 1], size.line = -3)

##########################

data(poison)
##Note violation of constant variance across groups in following graphic.
granova.1w(poison$SurvTime, group = poison$Group, ylab = "Survival Time")
##RateSurvTime = SurvTime^-1
granova.1w(poison$RateSurvTime, group = poison$Group, 
ylab = "Survival Rate = Inverse of Survival Time")

##Nonparametric version: RateSurvTime ranked and rescaled
##to be comparable to RateSurvTime; 
##note labels as well as residual (rug) plot below.
granova.1w(poison$RankRateSurvTime, group = poison$Group, 
ylab = "Ranked and Centered Survival Rates",
main = "One-way ANOVA display, poison data (ignoring 2-way set-up)", 
res = TRUE)
</code></pre>

<hr>
<h2 id='granova.2w'>Graphical display of data for two-way analysis of variance</h2><span id='topic+granova.2w'></span>

<h3>Description</h3>

<p>Produces a rotatable graphic (controlled by the mouse) to display all data points for any two way analysis of variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granova.2w(data, formula = NULL, fit = "linear", ident = FALSE, 
       offset = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="granova.2w_+3A_data">data</code></td>
<td>
<p>An N x 3 dataframe. (If it is a matrix, it will be converted to a dataframe.) Column 1 must contain response values or
scores for all groups, N in all; columns 2 and 3 should be factors (or will be coerced to factors) showing levels of the two treatments.
If rows are named, then for <code>ident= TRUE</code>, points can be identified with those labels, otherwise the row number of <code>data</code> is used.
Note that factor levels will (generally) be reordered.</p>
</td></tr>
<tr><td><code id="granova.2w_+3A_formula">formula</code></td>
<td>
<p>Optional formula used by <code><a href="stats.html#topic+aov">aov</a></code> to produce the summary 2-way ANOVA table provided as output. 
Not used in the scatterplot.</p>
</td></tr>
<tr><td><code id="granova.2w_+3A_fit">fit</code></td>
<td>
<p>Defines whether the fitted surface will be <code>linear</code> (default) or some more complicated surface, e.g., <code>quadratic</code>, or <code>smooth</code>; see below.</p>
</td></tr>
<tr><td><code id="granova.2w_+3A_ident">ident</code></td>
<td>
<p>Logical, if TRUE allows interactive identification of individual points using rownames of <code>data</code> on graphic. If rownames are not provided then 1:N is used. Click and hold right mouse button while dragging over point.  Right click white space to end.</p>
</td></tr>
<tr><td><code id="granova.2w_+3A_offset">offset</code></td>
<td>
<p>Number; if <code>NULL</code> then default for <code>identify3d</code> is used.</p>
</td></tr>
<tr><td><code id="granova.2w_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to <code>scatter3d</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function depicts data points graphically in a window using the row by column set-up for a two-way ANOVA; 
the graphic is rotatable, controlled by the mouse. Data-based contrasts (cf. description for one-way ANOVA: 
<code><a href="#topic+granova.1w">granova.1w</a></code>) are used to ensure a flat surface &ndash; corresponding to an additive fit 
(if <code>fit = linear</code>; see below) &ndash; for all cells. Points are displayed vertically 
(initially) with respect to the fitting surface. In particular, (dark blue) spheres are used to show 
data points for all groups. The mean for each cell is shown as a white sphere. The graphic is based on 
<code>rgl</code> and <code>scatter3d</code>; the graphic display can be zoomed in and out by scrolling, where the mouse 
is used to rotate the entire figure in a 3d representation.  The row and column (factor A and B) effects 
have been used for spacing of the cells on the margins of the fitting surface. As noted, the first column of 
the input data frame must be response values (scores); the second and third columns should be integers that 
identify levels of the A and B factors respectively. Based on the row and column means, factor levels are 
first ordered (from small to large) separately for the row and column means; levels are assumed not to be 
ordered at the outset. 
</p>
<p>The function <code>scatter3d</code> is used from <code>car</code> (thanks, John Fox).  
The value of <code>fit</code> is passed to <code>scatter3d</code> and determines the surface fit to the data.  The default value of <code>fit</code> is <code>linear</code>, so that  
interactions may be seen as departures of the cell means from a flat surface. It is possible to replace 
<code>linear</code> with any of <code>quadratic</code>, <code>smooth</code>, or <code>additive</code>; see help for <code>scatter3d</code> 
for details.  Note in particular that a <code>formula</code> specified by the user (or the default) has no direct effect on the graphic, but is reflected in the console output.
</p>
<p>For data sets above about 300 or 400 points, the default sphere size (set by <code>sphere.size</code>) can be quite small.  The optional 
argument <code>sphere.size = 2</code> or a similar value will increase the size of the spheres.  However, the sphere
sizes possible are discrete.
</p>
<p>The table of counts for the cell means is printed (with respect the the reordered rows and columns); 
similarly, the table of cell means is printed (also, based on reordered rows and columns). Finally, numerical 
summary results derived from function <code><a href="stats.html#topic+aov">aov</a></code> are also printed. Although the function accommodates 
the case where cell counts are not all the same, or when the data are unbalanced with respect to the A &amp; B factors, 
the surface can be misleading, especially in highly unbalanced data.  Machine memory for this function has caused 
problems with some larger data sets.  The authors would appreciate reports of problems or successes with 
larger data sets.
</p>


<h3>Value</h3>

<p>Returns a list with four components:
</p>
<table role = "presentation">
<tr><td><code>A.effects</code></td>
<td>
<p>Reordered factor A (second column of <code>data</code>) effects (deviations of A-level means from grand mean)</p>
</td></tr>
<tr><td><code>B.effects</code></td>
<td>
<p>Reordered factor B (third column of <code>data</code>) effects (deviations of B-level means from grand mean)</p>
</td></tr>
<tr><td><code>CellCounts.Reordered</code></td>
<td>
<p>Cell sizes for all A-level, B-level combinations, with rows/columns reordered according to A.effects and B.effects.</p>
</td></tr>
<tr><td><code>CellMeans.Reordered</code></td>
<td>
<p>Means for all cells, i.e., A-level, B-level combinations, with rows/columns reordered according to A.effects and B.effects</p>
</td></tr>
<tr><td><code>anova.summary</code></td>
<td>
<p>Summary <code>aov</code> results, based on input data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Right click on the graphic to terminate <code>identify</code> and return the output from the function.</p>


<h3>Author(s)</h3>

<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>


<h3>References</h3>

<p>Fundamentals of Exploratory Analysis of Variance, Hoaglin D., Mosteller F. and Tukey J. eds., Wiley, 1991.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+granova.1w">granova.1w</a></code>, <code><a href="#topic+granova.contr">granova.contr</a></code>, <code><a href="#topic+granova.ds">granova.ds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# using the R dataset warpbreaks; see documentation 
#(first surface flat since fit = 'linear' (default); 
#second surface shows curvature)
granova.2w(warpbreaks)
granova.2w(warpbreaks, formula = breaks ~ wool + tension)
granova.2w(warpbreaks, formula = breaks ~ wool + tension, 
fit = 'quadratic')

# Randomly generated data
resp &lt;- rnorm(80, 0, .25) + rep(c(0, .2, .4, .6), ea = 20)
f1 &lt;- rep(1:4, ea = 20)
f2 &lt;- rep(rep(1:5, ea = 4), 4)
rdat1 &lt;- cbind(resp, f1, f2)
granova.2w(rdat1)
#
rdat2 &lt;- cbind(rnorm(64, 10, 2), sample(1:4, 64, repl = TRUE), 
   sample(1:3, 64, repl = TRUE))
granova.2w(rdat2)
#
#

data(poison)
#Raw Survival Time as outcome measure:
granova.2w(poison[, c(4, 1, 2)])
# Now with quadratic surface (helpful for this poor metric):
granova.2w(poison[, c(4, 1, 2)], fit = 'quadratic') 
#
#Inverse of Survival Time as outcome measure 
#(actually rate of survival, a better version of response, clearly):
granova.2w(poison[, c(5, 1, 2)])
#Now curvature is minimal (confirming adequacy of 
#linear model fit for this metric):
granova.2w(poison[, c(5, 1, 2)], fit = 'quadratic') 
#
#Ranked Version of Inverse:
granova.2w(poison[, c(6, 1, 2)])

</code></pre>

<hr>
<h2 id='granova.contr'>Graphic Display of Contrast Effect of ANOVA</h2><span id='topic+granova.contr'></span>

<h3>Description</h3>

<p>Provides graphic displays that shows data and effects for a priori contrasts in ANOVA contexts; also corresponding numerical results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granova.contr(data, contrasts, ylab = "Outcome (response)", 
	xlab = NULL, jj = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="granova.contr_+3A_data">data</code></td>
<td>
<p>Vector of scores for all equally sized groups, or a data.fame or matrix where each column represents a group.</p>
</td></tr>
<tr><td><code id="granova.contr_+3A_contrasts">contrasts</code></td>
<td>
<p>Matrix of column contrasts with dimensions (number of groups [G]) x (number of contrasts) [generally (G x G-1)].</p>
</td></tr>
<tr><td><code id="granova.contr_+3A_ylab">ylab</code></td>
<td>
<p>Character; y axis lable.</p>
</td></tr>
<tr><td><code id="granova.contr_+3A_xlab">xlab</code></td>
<td>
<p>Character vector of length number of contrast columns.  To name the specific contrast being made in all but last panel of graphic.  Default = <code>NULL</code></p>
</td></tr>
<tr><td><code id="granova.contr_+3A_jj">jj</code></td>
<td>
<p>Numeric; controls <code><a href="base.html#topic+jitter">jitter</a></code> and confers the possibility of 
controlling the amount of jitter in the panel plots for the contrasts  Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function provides graphic displays of contrast effects for prespecified contrasts in ANOVA. Data points are displayed
as relevant for each contrast based on comparing groups according to the positive and negative contrast coefficients for each
contrast on the horizontal axis, against response values on the vertical axis. Data points corresponding to groups not being
compared in any contrast (coefficients of zero) are ignored. For each contrast (generally as part of a 2 x 2 panel) a line
segment is given that compares the (weighted) mean of the response variable for the negative coefficients versus the positive
coefficients. Standardized contrasts are used, wherein the sum of (magnitudes) of negative coefficients is unity; and the same
for positive coefficients. If a line is &lsquo;notably&rsquo; different from horizontal (i.e. slope of zero), a &lsquo;notable&rsquo; effect has
been identified; however, the question of statistical significance generally depends on a sound context-based estimate of
standard error for the corresponding effect. This means that while summary aov numerical results and test statistics are presented
(see below), the appropriateness of the default standard error generally requires the analyst's judgment. The response
values are to be input in (a stacked) form, i.e. as a vector, for all cells (cf. arg. ylab).  The matrix of contrast vectors <code>contrasts</code>
must have G rows (the number of groups), and a number of columns equal to the number of prespecified contrasts, at most G-1. If
the number of columns of <code>contrasts</code> is G-1, then the number per group, or cell size, is taken to be <code>length(data)/G</code>, where <code>G = nrow(contrasts)</code>.
</p>
<p>If the number of columns of <code>contrasts</code> is less than G-1 then the user must stipulate <code>npg</code>, the number in each group or cell.
The function is designed for the case when all cell sizes are the same, and may be most helpful when the a priori contrasts
are mutually orthogonal (e.g., in power of 2 designs, or their fractional counterparts; also when specific row or column comparisons,
or their interactions (see the example below based on rat weight gain data)). It is not essential that contrasts be
mutually orthogonal; but mutual linear independence is required. (When factor levels correspond to some underlying continuum
a standard application might use <code>con = contr.poly(G)</code>, for G the number of groups; consider also <code>contr.helmert(G)</code>.)
The final plot in each application shows the data for all groups or cells in the design, where groups are simply numbered from 1:G, 
for G the number of groups, on the horizontal axis, versus the response values on the vertical axis.
</p>


<h3>Value</h3>

<p>Two sets of numerical results are presented: Weighted cell means for positive and negative coefficients 
for each a priori contrast, and summary results from <code>lm</code>.
</p>
<table role = "presentation">
<tr><td><code>summary.lm</code></td>
<td>
<p>Summary results for a linear model analysis based on the R function <code>lm</code> 
(When effects are simple, as in an equal n's  power of 2 design, mean differences will generally correspond to the linear regression coefficients as seen in the <code>lm</code> summary results.)</p>
</td></tr>
<tr><td><code>means.pos.neg.coeff</code></td>
<td>
<p>table showing the (weighted) means for positive and negative coefficients for each (row) contrast, and for each row, the difference between these means in the final column</p>
</td></tr>
<tr><td><code>means.pos.neg.coeff</code></td>
<td>
<p>Table showing the (weighted) means for positive and negative coefficients 
for each (row) contrast, and for each row, the difference between these means, and the standardized effect size in the final column.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>Contrast matrix used.</p>
</td></tr>
<tr><td><code>group.means.sds</code></td>
<td>
<p>Group means and standard deviations.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Input data in matrix form.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+granova.1w">granova.1w</a></code>, <code><a href="#topic+granova.2w">granova.2w</a></code>, <code><a href="#topic+granova.ds">granova.ds</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arousal)	
contrasts22 &lt;- data.frame( c(-.5,-.5,.5,.5), 
	c(-.5,.5,-.5,.5), c(.5,-.5,-.5,.5) )
names(contrasts22) &lt;- c("Drug.A", "Drug.B", "Drug.A.B")
granova.contr(arousal, contrasts = contrasts22)
	
data(rat)
dat6 &lt;- matrix(c(1, 1, 1, -1, -1, -1, -1, 1, 0, -1, 1, 0, 1, 1, -2, 
    1, 1, -2, -1, 1, 0, 1, -1, 0, 1, 1, -2, -1, -1, 2), ncol = 5)
granova.contr(rat[,1], contrasts = dat6, ylab = "Rat Weight Gain", 
  xlab = c("Amount 1 vs. Amount 2", "Type 1 vs. Type 2", 
  "Type 1 &amp; 2 vs Type 3", "Interaction of Amount and Type 1 &amp; 2", 
  "Interaction of Amount and  Type (1, 2), 3"))
#Polynomial Contrasts 
granova.contr(rat[,1],contrasts = contr.poly(6))

#based on random data 
data.random &lt;- rt(64, 5)
granova.contr(data.random, contrasts = contr.helmert(8), 
	ylab = "Random Data")
</code></pre>

<hr>
<h2 id='granova.ds'>Granova for Display of Dependent Sample Data</h2><span id='topic+granova.ds'></span>

<h3>Description</h3>

<p>Plots dependent sample data beginning from a scatterplot for the X,Y pairs; proceeds to 
display difference scores as point projections; also X and Y means, as well as the mean of the 
difference scores. Also prints various summary statistics including: effect size, means for X and Y, 
a 95% confidence interval for the mean difference as well as the t-statistic and degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>granova.ds(data, revc = FALSE, sw = 0.4, ne = 0.5, ptpch=c(19,3), 
        ptcex=c(.8,1.4), labcex = 1, ident = FALSE, 
        colors = c(1,2,1,4,2,'green3'), pt.lab = NULL,
        xlab = NULL, ylab = NULL, main = NULL, sub = NULL, 
        par.orig = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="granova.ds_+3A_data">data</code></td>
<td>
<p>is an n X 2 dataframe or matrix. First column defines X (intially for horzontal axis), the second defines Y. </p>
</td></tr>
<tr><td><code id="granova.ds_+3A_revc">revc</code></td>
<td>
<p>reverses X,Y specifications.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_sw">sw</code></td>
<td>
<p>extends axes toward lower left, effectively moving data points to the southwest.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_ne">ne</code></td>
<td>
<p>extends axes toward upper right, effectively moving data points to northeast. Making both sw and ne smaller moves points farther
apart, while making both larger moves data points closer together.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_ptpch">ptpch</code></td>
<td>
<p>controls the pch of the (X,Y) points and of differences score points.</p>
</td></tr> 
<tr><td><code id="granova.ds_+3A_ptcex">ptcex</code></td>
<td>
<p>controls the cex of the (X,Y) points and of differences score points.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_labcex">labcex</code></td>
<td>
<p>controls size of axes labels.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_ident">ident</code></td>
<td>
<p>logical, default FALSE. Allows user to identify individual points.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_colors">colors</code></td>
<td>
<p>vector defining colors of six components of the plot: (X,Y) points, horizontal and vertical dashed lines representing 
means of the two groups, light dashed diagonal lines connecting (X,Y) points and projections differences dotplot,  
differences arranged as a dotplot, heavy dashed diagonal line representing the mean of differences, 
confidence interval. </p>
</td></tr>
<tr><td><code id="granova.ds_+3A_pt.lab">pt.lab</code></td>
<td>
<p>optional character vector defining labels for points.  Only used if ident is TRUE.
If NULL, rownames(data) are used if available; if not 1:n is used.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_xlab">xlab</code></td>
<td>
<p>optional label (as character) for horizontal axis. If not defined, axis labels are taken from colnames of data.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_ylab">ylab</code></td>
<td>
<p>optional label (as character) for vertical axis.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_main">main</code></td>
<td>
<p>optional main title (as character); if not supplied by user generic title is provided.</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_sub">sub</code></td>
<td>
<p>optional subtile (as character).</p>
</td></tr>
<tr><td><code id="granova.ds_+3A_par.orig">par.orig</code></td>
<td>
<p>returns par to original settings; if multipanel plots it is advisable to specify FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Paired X &amp; Y values are plotted as scatterplot. The identity reference line (for Y=X) is drawn. Since the better data view often entails
having X's &gt; Y's the revc argument facilitates reversal of the X, Y specifications.  Parallel projections of data points to (a lower-left) line 
segment show how each point relates to its X-Y = D difference; blue
&lsquo;crosses&rsquo; are used to display the distribution of difference scores and the mean difference is displayed as a heavy dashed (red) line, parallel to
the identity reference line. Means for X and Y are also plotted (as thin dashed vertical and horizontal lines), and rug plots are shown for the
distributions of X (at the top of graphic) and Y (on the right side). Several summary statistics are plotted as well, to facilitate both description
and inference; see below. The 95% confidence interval for the population mean difference is also shown graphically.  Because all data points are plotted relative to the identity
line, and summary results are shown graphically, clusters, data trends, outliers, and possible uses of transformations are readily seen, possibly
to be accommodated.
</p>


<h3>Value</h3>

<p>A list is returned with the following components:
</p>
<table role = "presentation">
<tr><td><code>mean(X)</code></td>
<td>
<p>Mean of X values</p>
</td></tr>
<tr><td><code>mean(Y)</code></td>
<td>
<p>Mean of Y values</p>
</td></tr>
<tr><td><code>mean(D=X-Y)</code></td>
<td>
<p>Mean of differences D = X - Y</p>
</td></tr>
<tr><td><code>SD(D)</code></td>
<td>
<p>Standard deviation of differences D</p>
</td></tr>
<tr><td><code>ES(D)</code></td>
<td>
<p>Effect Size for differences D: mean(D)/SD(D)</p>
</td></tr>
<tr><td><code>r(X</code>, <code>Y)</code></td>
<td>
<p>Correlation based on X,Y pairs</p>
</td></tr>
<tr><td><code>r(x+y</code>, <code>D)</code></td>
<td>
<p>Correlation based on X+Y,D pairs</p>
</td></tr>
<tr><td><code>LL 95%CI</code></td>
<td>
<p>Lower bound for 95% confidence interval for population mean(D)</p>
</td></tr>
<tr><td><code>UL 95%CI</code></td>
<td>
<p>Upper bound for 95% confidence interval for population mean(D)</p>
</td></tr>
<tr><td><code>t(D-bar)</code></td>
<td>
<p>t-statistic associated w/ test of hypothesis that population mean(D) = 0.0</p>
</td></tr>
<tr><td><code>df.t</code></td>
<td>
<p>Degrees of freedom for the t-statistic</p>
</td></tr>
<tr><td><code>pval.t</code></td>
<td>
<p>P-value for two sided t-test of null hypothesis that population mean(D) does not equal zero.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>


<h3>References</h3>

<p>Exploratory Plots for Paired Data, Rosenbaum P., The American Statistician, May 1989, vol. 43, no. 2, pp. 108-9.
</p>
<p>Enhancing Dependent Sample Analyses with Graphics, Pruzek, R. and Helmreich, J., Journal of Statistics Education, March 2009, Vol. 17, no. 1.
</p>
<p>http://www.amstat.org/publications/jse/v17n1/helmreich.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### See discussion of anorexia graphic in EDSAG, J. Statistics Ed.
data(anorexia.sub)

granova.ds(anorexia.sub, revc = TRUE, 
	main = "Assessment Plot for weights to assess Family Therapy treatment 
	for Anorexia Patients")
# If labels for four unusual points at lower left are desired:
granova.ds(anorexia.sub, revc = TRUE, 
	main = "Assessment Plot for weights to assess Family Therapy treatment 
	for Anorexia Patients", ident = TRUE)


## See discussion of blood lead graphic in EDSAG, J. Statistics Ed.
data(blood_lead)

granova.ds(blood_lead, sw = .1, 
   main = "Dependent Sample Assessment Plot
   Blood Lead Levels of Matched Pairs of Children")
</code></pre>

<hr>
<h2 id='poison'>Poison data from Biological Experiment</h2><span id='topic+poison'></span>

<h3>Description</h3>

<p>Survial times of animals in a 3 x 4 factorial experiment involving poisons (3 levels) and various treatments (four levels), as described in Chapter 8 of Box, Hunter and Hunter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(poison)</code></pre>


<h3>Format</h3>

<p>This data frame was originally <code>poison.data</code> from the package <code>BHH2</code>, but as presented here has added columns; no NAs.
</p>

<dl>
<dt><code>Poison</code></dt><dd><p>Factor with three levels I, II, and III.</p>
</dd>
<dt><code>Treatment</code></dt><dd><p>Factor with four levels, A, B, C, and D.</p>
</dd>
<dt><code>Group</code></dt><dd><p>Factor with 12 levels, 1:12.</p>
</dd>
<dt><code>SurvTime</code></dt><dd><p>Numeric; survival time.</p>
</dd>
<dt><code>RateSurvTime</code></dt><dd><p>Numeric; inverse of SurvTime</p>
</dd>
<dt><code>RankRateSurvTime</code></dt><dd><p>Numeric; <code>RateSurvTime</code> scores have been converted to ranks, and then rescaled to have the same median as and a spread comparable to <code>RateSurvTime</code></p>
</dd>
</dl>


<h3>Source</h3>

<p>Box, G. E. P. and D. R. Cox, An Analysis of Transformations (with discussion), Journal of the Royal Statistical Society, Series B, Vol. 26, No. 2, pp. 211 - 254.
</p>


<h3>References</h3>

<p>Box G. E. P, Hunter, J. S. and Hunter, W. C. (2005). Statistics for Experimenters II. New York: Wiley.</p>

<hr>
<h2 id='rat'>Weight gains of rats fed different diets</h2><span id='topic+rat'></span>

<h3>Description</h3>

<p>60 rats were fed varying diets to see which produced the greatest weight gain.  Two diet factors were protein type: beef, pork, chicken and protein level: high and low.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rat)</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 3 variables, no NAs.
</p>

<dl>
<dt><code>Weight.Gain</code></dt><dd><p>Weight gain (grams) of rats fed the diets.</p>
</dd>
<dt><code>Diet.Amount</code></dt><dd><p>Amount of protein in diet: 1 = High, 2 = Low.</p>
</dd>
<dt><code>Diet.Type</code></dt><dd><p>Type of protein in diet: 1 = Beef, 2 = Pork, 3 = Cereal.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Fundamentals of Exploratory Analysis of Variance, Hoaglin D., Mosteller F. and Tukey J. eds., Wiley, 1991, p. 100; originally from Statistical Methods, 7th ed, Snedecor G. and Cochran W. (1980), Iowa State Press.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
