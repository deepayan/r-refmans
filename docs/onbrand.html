<!DOCTYPE html><html lang="en"><head><title>Help for package onbrand</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {onbrand}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#onbrand'><p>onbrand: officer Abstraction Layer for Organizational Templates</p></a></li>
<li><a href='#add_pptx_ph_content'><p>Populate Placeholder In Officer Report</p></a></li>
<li><a href='#build_span'><p>Construct Table Span From Components</p></a></li>
<li><a href='#fetch_md_def'><p>Fetch Markdown Default Format from onbrand Object</p></a></li>
<li><a href='#fetch_officer_object'><p>Extracts Officer Object From Onbrand Report Object</p></a></li>
<li><a href='#fetch_report_format'><p>Fetch The Specified Report Formatting Information</p></a></li>
<li><a href='#fetch_rpttype'><p>Determines Type of Report Template</p></a></li>
<li><a href='#fph'><p>Fetch PowerPoint Placeholder</p></a></li>
<li><a href='#fst'><p>Fetch Word Style</p></a></li>
<li><a href='#ft_apply_md'><p>Render Markdown in flextable Object</p></a></li>
<li><a href='#md_to_officer'><p>Parse Markdown for Officer</p></a></li>
<li><a href='#md_to_oo'><p>Parse Markdown into Officer as_paragraph Result</p></a></li>
<li><a href='#mk_lg_tbl'><p>Creates Large Table Data for Testing</p></a></li>
<li><a href='#preview_template'><p>Generate Report Previewing the Locations From Mapping File</p></a></li>
<li><a href='#read_template'><p>Read Word or PowerPoint Templates</p></a></li>
<li><a href='#report_add_doc_content'><p>Add Content to Body of a Word Document Report</p></a></li>
<li><a href='#report_add_slide'><p>Add Slide and Content</p></a></li>
<li><a href='#save_report'><p>Save Onbrand Report to a File</p></a></li>
<li><a href='#set_officer_object'><p>Places Officer Object Into Onbrand Report Object</p></a></li>
<li><a href='#span_table'><p>Spread Large Table Over Smaller Tables</p></a></li>
<li><a href='#template_details'><p>Show Template Details for 'onbrand' Object</p></a></li>
<li><a href='#view_layout'><p>Generate Annotated Layout for Report Templates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Templated Reporting Workflows in Word and PowerPoint</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Harrold &lt;john.m.harrold@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Automated reporting in Word and PowerPoint can require customization for each organizational template. This package works around this by adding standard reporting functions and an abstraction layer to facilitate automated reporting workflows that can be replicated across different organizational templates.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://onbrand.ubiquity.tools/">https://onbrand.ubiquity.tools/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/john-harrold/onbrand/issues">https://github.com/john-harrold/onbrand/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>digest, dplyr, flextable, ggplot2, magrittr, officer (&ge;
0.3.7), stringr, rlang, yaml</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, knitrdata, markdown, rmarkdown, testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-23 01:05:13 UTC; jmh</td>
</tr>
<tr>
<td>Author:</td>
<td>John Harrold <a href="https://orcid.org/0000-0003-2052-4373"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Bryan Smith [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-23 15:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='onbrand'>onbrand: officer Abstraction Layer for Organizational Templates</h2><span id='topic+onbrand-package'></span><span id='topic+onbrand'></span>

<h3>Description</h3>

<p>The onbrand package creates an abstraction layer that is easily
configurable with a yaml file to allow for creation of reproducible
reporting work flows across Word and PowerPoint templates.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: John Harrold <a href="mailto:john.m.harrold@gmail.com">john.m.harrold@gmail.com</a> (<a href="https://orcid.org/0000-0003-2052-4373">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Bryan Smith <a href="mailto:r.bryan.smith@gmail.com">r.bryan.smith@gmail.com</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://github.com/john-harrold/onbrand">https://github.com/john-harrold/onbrand</a>
</p>

<hr>
<h2 id='add_pptx_ph_content'>Populate Placeholder In Officer Report</h2><span id='topic+add_pptx_ph_content'></span>

<h3>Description</h3>

<p>Places content in a PowerPoint placeholder for a given officer document.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_pptx_ph_content(
  obnd,
  content_type,
  content,
  ph_label = NULL,
  user_location = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_pptx_ph_content_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="add_pptx_ph_content_+3A_content_type">content_type</code></td>
<td>
<p>string indicating the content type</p>
</td></tr>
<tr><td><code id="add_pptx_ph_content_+3A_content">content</code></td>
<td>
<p>content (see details below)</p>
</td></tr>
<tr><td><code id="add_pptx_ph_content_+3A_ph_label">ph_label</code></td>
<td>
<p>placeholder location (text, or NULL if user_location is used)</p>
</td></tr>
<tr><td><code id="add_pptx_ph_content_+3A_user_location">user_location</code></td>
<td>
<p>User specified location using ph_location() or NULL if ph_label
is used.</p>
</td></tr>
<tr><td><code id="add_pptx_ph_content_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each content type listed below the following content is expected:
</p>

<ul>
<li> <p><code>"text"</code> text string of information
</p>
</li>
<li> <p><code>"list"</code> vector of paired values (indent level and text), eg.  c(1, &quot;Main Bullet&quot;, 2 &quot;Sub Bullet&quot;)
</p>
</li>
<li> <p><code>"imagefile"</code> string containing path to image file
</p>
</li>
<li> <p><code>"ggplot"</code> ggplot object, eg. p = ggplot() + ....
</p>
</li>
<li> <p><code>"table"</code> list containing the table content and other options with the following elements (defaults in parenthesis):
</p>

<ul>
<li> <p><code>table</code> Data frame containing the tabular data
</p>
</li>
<li> <p><code>header</code> Boolean variable to control displaying the header (<code>TRUE</code>)
</p>
</li>
<li> <p><code>first_row</code> Boolean variable to indicate that the first row contains header information (<code>TRUE</code>)
</p>
</li></ul>

</li>
<li> <p><code>"flextable"</code> list containing flextable content and other options with the following elements (defaults in parenthesis):
</p>

<ul>
<li> <p><code>table</code> Data frame containing the tabular data
</p>
</li>
<li> <p><code>header_top</code>, <code>header_middle</code>, <code>header_bottom</code> (<code>NULL</code>) a list with the same names as the data frame names containing the tabular data and values with the header text to show in the table
</p>
</li>
<li> <p><code>header_format</code> string containing the format, either <code>"text"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>merge_header</code> (<code>TRUE</code>) Set to true to combine column headers with the same information
</p>
</li>
<li> <p><code>table_body_alignment</code>, table_header_alignment (&quot;center&quot;) Controls alignment
</p>
</li>
<li> <p><code>table_autofit</code> (<code>TRUE</code>) Automatically fit content, or specify the cell width and height with <code>cwidth</code> (<code>0.75</code>) and <code>cheight</code> (<code>0.25</code>)
</p>
</li>
<li> <p><code>table_theme</code> (<code>"theme_vanilla"</code>) Table theme
</p>
</li></ul>

</li>
<li> <p><code>"flextable_object"</code> user defined flextable object 
</p>
</li></ul>



<h3>Value</h3>

<p>officer pptx object with the content added
</p>


<h3>See Also</h3>

<p><code><a href="#topic+view_layout">view_layout</a></code> <code><a href="#topic+report_add_slide">report_add_slide</a></code>
</p>

<hr>
<h2 id='build_span'>Construct Table Span From Components</h2><span id='topic+build_span'></span>

<h3>Description</h3>

<p>Takes a large table, common rows, and header information and
constructs a table that is a subset of those components using supplied
ranges of rows and columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_span(
  table_body = NULL,
  row_common = NULL,
  table_body_head = NULL,
  row_common_head = NULL,
  header_format = "text",
  obnd = NULL,
  row_sel = NULL,
  col_sel = NULL,
  table_alignment = "center",
  inner_border = officer::fp_border(color = "black", width = 0.3),
  outer_border = officer::fp_border(color = "black", width = 2),
  set_header_inner_border_v = TRUE,
  set_header_inner_border_h = TRUE,
  set_header_outer_border = TRUE,
  set_body_inner_border_v = TRUE,
  set_body_inner_border_h = FALSE,
  set_body_outer_border = TRUE,
  notes_detect = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_span_+3A_table_body">table_body</code></td>
<td>
<p>Data frame with the body of the large table.</p>
</td></tr>
<tr><td><code id="build_span_+3A_row_common">row_common</code></td>
<td>
<p>Data frame with the common rows.</p>
</td></tr>
<tr><td><code id="build_span_+3A_table_body_head">table_body_head</code></td>
<td>
<p>Data frame or matrix with headers for the table body.</p>
</td></tr>
<tr><td><code id="build_span_+3A_row_common_head">row_common_head</code></td>
<td>
<p>Data frame or matrix with headers for the common rows.</p>
</td></tr>
<tr><td><code id="build_span_+3A_header_format">header_format</code></td>
<td>
<p>Format of the header either <code>"text"</code> (default) or <code>"md"</code> for markdown.</p>
</td></tr>
<tr><td><code id="build_span_+3A_obnd">obnd</code></td>
<td>
<p>Optional onbrand object used to format markdown. The default <code>NULL</code> value will use default formatting.</p>
</td></tr>
<tr><td><code id="build_span_+3A_row_sel">row_sel</code></td>
<td>
<p>Indices of rows to build to the table with.</p>
</td></tr>
<tr><td><code id="build_span_+3A_col_sel">col_sel</code></td>
<td>
<p>Indices of columns to build to the table with.</p>
</td></tr>
<tr><td><code id="build_span_+3A_table_alignment">table_alignment</code></td>
<td>
<p>Character string specifying the alignment #'of the table (body and headers). Can be <code>"center"</code> (default), <code>"left"</code>, <code>"right"</code>, or <code>"justify"</code></p>
</td></tr>
<tr><td><code id="build_span_+3A_inner_border">inner_border</code></td>
<td>
<p>Border object for inner border lines defined using <code>officer::fp_border()</code></p>
</td></tr>
<tr><td><code id="build_span_+3A_outer_border">outer_border</code></td>
<td>
<p>Border object for outer border lines defined using <code>officer::fp_border()</code></p>
</td></tr>
<tr><td><code id="build_span_+3A_set_header_inner_border_v">set_header_inner_border_v</code></td>
<td>
<p>Boolean value to enable or disable inner vertical borders for headers</p>
</td></tr>
<tr><td><code id="build_span_+3A_set_header_inner_border_h">set_header_inner_border_h</code></td>
<td>
<p>Boolean value to enable or disable inner horizontal borders for headers</p>
</td></tr>
<tr><td><code id="build_span_+3A_set_header_outer_border">set_header_outer_border</code></td>
<td>
<p>Boolean value to enable or disable outer border for headers</p>
</td></tr>
<tr><td><code id="build_span_+3A_set_body_inner_border_v">set_body_inner_border_v</code></td>
<td>
<p>Boolean value to enable or disable inner vertical borders for the body</p>
</td></tr>
<tr><td><code id="build_span_+3A_set_body_inner_border_h">set_body_inner_border_h</code></td>
<td>
<p>Boolean value to enable or disable inner horizontal borders for the body</p>
</td></tr>
<tr><td><code id="build_span_+3A_set_body_outer_border">set_body_outer_border</code></td>
<td>
<p>Boolean value to enable or disable outer border borders for the body</p>
</td></tr>
<tr><td><code id="build_span_+3A_notes_detect">notes_detect</code></td>
<td>
<p>Vector of strings to detect in output tables (example <code>c("NC", "BLQ")</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The way the data frames relate to each other are mapped out below. The
dimensions of the different data frames are identified below (nrow x ncol)
</p>
<pre>
                            col_sel
                      |&lt;---------------&gt;|

|--------------------------------------------| ---
|                 |   .                 .    |  ^
|                 |   .                 .    |  |
| row_common_head |   . table_body_head .    |  | m
|      m x n      |   .      m x c      .    |  |
|                 |   .                 .    |  v
|--------------------------------------------| ---
|                 |   .                 .    |  ^
|                 |   .                 .    |  |
|    row_common   |   .   table_body    .    |  |
|      r x n      |   .     r x c       .    |  |
|                 |   .                 .    |  |
|.................|..........................|  |     -
|                 |   ./  /  /  /  /  / .    |  |     ^
|                 |   .  /  /  /  /  /  .    |  | r   |
|                 |   . /  /  /  /  /  /.    |  |     | row_sel
|                 |   ./  /  /  /  /  / .    |  |     |
|                 |   .  /  /  /  /  /  .    |  |     v
|.................|...../../../../../../.... |  |     -
|                 |   .                 .    |  |
|                 |   .                 .    |  v
|--------------------------------------------| ---

|&lt;---------------&gt;|&lt;------------------------&gt;|
        n                    c
</pre>


<h3>Value</h3>

<p>list with the following elements
</p>

<ul>
<li><p>df:     Data frame with the built table.
</p>
</li>
<li><p>ft:     The data frame as a flextable object.
</p>
</li>
<li><p>notes:  Note placeholders found in the table.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

tbl_res = mk_lg_tbl()

res =
span_table(table_body      = tbl_res$lg_tbl_body,
           row_common      = tbl_res$lg_tbl_row_common,
           table_body_head = tbl_res$lg_tbl_body_head,
           row_common_head = tbl_res$lg_tbl_row_common_head,
           max_row         = 20,
           max_col         = 10,
           notes_detect    = c("BQL", "NC"))


# Notes detected in the first table:
res[["tables"]][["Table 1"]][["notes"]]

# First table as a data frame:
res[["tables"]][["Table 1"]][["df"]]

# First table as a flextable:
res[["tables"]][["Table 1"]][["ft"]]

}

</code></pre>

<hr>
<h2 id='fetch_md_def'>Fetch Markdown Default Format from onbrand Object</h2><span id='topic+fetch_md_def'></span>

<h3>Description</h3>

<p>Used to extract the formatting elements for a given style from
an onbrand object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_md_def(obnd, style = "default", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_md_def_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="fetch_md_def_+3A_style">style</code></td>
<td>
<p>name of style in md_def for the report type in obnd to fetch (<code>"default"</code>)</p>
</td></tr>
<tr><td><code id="fetch_md_def_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following elements
</p>

<ul>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>md_def: List with the default format for the specified style
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
   template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
   mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))
obnd = fetch_md_def(obnd, style="default")
md_def =  obnd[["md_def"]]
</code></pre>

<hr>
<h2 id='fetch_officer_object'>Extracts Officer Object From Onbrand Report Object</h2><span id='topic+fetch_officer_object'></span>

<h3>Description</h3>

<p>If you need modify the onbrand report object directly with
officer functions you can use this function to extract the report object
from the onbrand object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_officer_object(obnd, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_officer_object_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="fetch_officer_object_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>rpt: Officer object
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+set_officer_object">set_officer_object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

rpt = fetch_officer_object(obnd)$rpt

</code></pre>

<hr>
<h2 id='fetch_report_format'>Fetch The Specified Report Formatting Information</h2><span id='topic+fetch_report_format'></span>

<h3>Description</h3>

<p>Returns a list of the default font format for the report element
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_report_format(obnd, format_name = "default", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_report_format_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="fetch_report_format_+3A_format_name">format_name</code></td>
<td>
<p>Name of report format to fetch; this is defined in the md_def</p>
</td></tr>
<tr><td><code id="fetch_report_format_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned list.
section for the given report type (<code>"default"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing the following elements
</p>

<ul>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li>
<li><p>format_details: List containing the format details for the specified
format_name
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
       template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
        mapping = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

fr = fetch_report_format(obnd)
</code></pre>

<hr>
<h2 id='fetch_rpttype'>Determines Type of Report Template</h2><span id='topic+fetch_rpttype'></span>

<h3>Description</h3>

<p>Based on the file extension for a template
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_rpttype(template = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_rpttype_+3A_template">template</code></td>
<td>
<p>Name of PowerPoint or Word file</p>
</td></tr>
<tr><td><code id="fetch_rpttype_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>rpttype: Either Word, PowerPoint or Unknown
</p>
</li>
<li><p>rptext: Either docx, pptx, or Unknown
</p>
</li>
<li><p>rptobj: Either rdocx, rpptx, or Unknown
</p>
</li>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>rpttype = fetch_rpttype(template=
  file.path(system.file(package="onbrand"), "templates", "report.pptx"))

</code></pre>

<hr>
<h2 id='fph'>Fetch PowerPoint Placeholder</h2><span id='topic+fph'></span>

<h3>Description</h3>

<p>Retrieves the placeholder name in PowerPoint for a specified
layout element.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fph(obnd, template = NULL, pn = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fph_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="fph_+3A_template">template</code></td>
<td>
<p>Name of slide template (name from templates in yaml mapping file)</p>
</td></tr>
<tr><td><code id="fph_+3A_pn">pn</code></td>
<td>
<p>Placehodler name to fetch</p>
</td></tr>
<tr><td><code id="fph_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>ph:      Placeholder label or <code>NULL</code> if failure
</p>
</li>
<li><p>type:    Placeholder content type in PowerPoint or <code>NULL</code> if failure
</p>
</li>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Creating an onbrand object:
obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

# Pulling out the placeholder information:
ph = fph(obnd, "two_content_header_text", "content_left_header")


</code></pre>

<hr>
<h2 id='fst'>Fetch Word Style</h2><span id='topic+fst'></span>

<h3>Description</h3>

<p>Retrieves the style name in Word for a specified onbrand style
name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fst(obnd, osn = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fst_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="fst_+3A_osn">osn</code></td>
<td>
<p>onbrand Word style name to fetch</p>
</td></tr>
<tr><td><code id="fst_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>wsn:    Word style name that corresponds to the specified onbrand style name (<code>osn</code>)
</p>
</li>
<li><p>dff:    Default font format for that style (the corresponding <code>md_def</code> section of the yaml file for that style)
</p>
</li>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>msgs:   Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Creating an onbrand object:
obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

# Pulling out the placeholder information:
st = fst(obnd, "Heading_3")


</code></pre>

<hr>
<h2 id='ft_apply_md'>Render Markdown in flextable Object</h2><span id='topic+ft_apply_md'></span>

<h3>Description</h3>

<p>Takes a flextable object and renders any markdown in the
specified part.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft_apply_md(ft, obnd = NULL, part = "body")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ft_apply_md_+3A_ft">ft</code></td>
<td>
<p>Flextable object.</p>
</td></tr>
<tr><td><code id="ft_apply_md_+3A_obnd">obnd</code></td>
<td>
<p>Optional onbrand object used to format markdown. The default <code>NULL</code> value will use default formatting.</p>
</td></tr>
<tr><td><code id="ft_apply_md_+3A_part">part</code></td>
<td>
<p>Part of the table can be one of <code>"all"</code>, <code>"body"</code> (default), <code>"header"</code>, or <code>"footer"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>flextable with markdown applied
</p>

<hr>
<h2 id='md_to_officer'>Parse Markdown for Officer</h2><span id='topic+md_to_officer'></span>

<h3>Description</h3>

<p>Parses text in Markdown format and returns fpar and as_paragraph command strings to be used with officer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_to_officer(
  str,
  default_format = list(color = "black", font.size = 12, bold = FALSE, italic = FALSE,
    underlined = FALSE, font.family = "Cambria (Body)", vertical.align = "baseline",
    shading.color = "transparent")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="md_to_officer_+3A_str">str</code></td>
<td>
<p>string containing Markdown can contain the following elements:
</p>

<ul>
<li><p> paragraph:   two or more new lines creates a paragraph
</p>
</li>
<li><p> bold:        can be either <code>"**text in bold**"</code> or <code>"__text in bold__"</code>
</p>
</li>
<li><p> italics:     can be either <code>"*text in italics*"</code> or <code>"_text in italics_"</code>
</p>
</li>
<li><p> subscript:   <code>"Normal~subscript~"</code>
</p>
</li>
<li><p> superscript: <code>"Normal^superscript^"</code>
</p>
</li>
<li><p> color:       <code>"&lt;color:red&gt;red text&lt;/color&gt;"</code>
</p>
</li>
<li><p> shade:       <code>"&lt;shade:#33ff33&gt;shading&lt;/shade&gt;"</code>
</p>
</li>
<li><p> font family: <code>"&lt;ff:symbol&gt;symbol&lt;/ff&gt;"</code>
</p>
</li>
<li><p> reference:   <code>"&lt;ref:key&gt;"</code> Where <code>"key"</code> is the value  assigned when adding a table or figure
</p>
</li></ul>
</td></tr>
<tr><td><code id="md_to_officer_+3A_default_format">default_format</code></td>
<td>
<p>list containing the default format for elements not defined with markdown default values.
</p>
<pre>
   default_format = list(
      color          = "black",
      font.size      = 12,
      bold           = FALSE,
      italic         = FALSE,
      underlined     = FALSE,
      font.family    = "Cambria (Body)",
      vertical.align = "baseline",
      shading.color  = "transparent")
</pre></td></tr>
</table>


<h3>Value</h3>

<p>list with parsed paragraph elements with the content added to the body, 
each paragraph can be found in a numbered list element (e.g. <code>pgraph_1</code>,
<code>pgraph_2</code>, etc) each with the following elements:
</p>

<ul>
<li><p>locs: Dataframe showing the locations of markdown elements in the current paragraph
</p>
</li>
<li><p>pele: These are the individual parsed paragraph elements
</p>
</li>
<li><p>ftext_cmd: String containing the ftext commands.
</p>
</li>
<li><p>fpar_cmd: String containing the fpar commands that can be run using
<code>eval</code> to return the output of <code>fpar</code>. For example:
</p>
<pre>
  myfpar = eval(parse(text=pgparse$pgraph_1$fpar_cmd))
 </pre>
</li>
<li><p>as_paragraph_cmd: String containing the as_paragraph_cmd that can be run using
</p>
<pre>
  myas_para = eval(parse(text=pgparse$pgraph_1$as_paragraph_cmd))
 </pre>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>res              = md_to_officer("Be **bold**!")
fpar_obj         = eval(parse(text=res$pgraph_1$fpar_cmd))
as_paragraph_obj = eval(parse(text=res$pgraph_1$as_paragraph_cmd))
</code></pre>

<hr>
<h2 id='md_to_oo'>Parse Markdown into Officer as_paragraph Result</h2><span id='topic+md_to_oo'></span>

<h3>Description</h3>

<p>Used to take small markdown chunks and return the as_paragraph
results. This function will take the markdown specified in str, calls
md_to_officer, evals the as_paragraph field from the first paragraph
returned, evals that result and returns the object from the as_paragraph
command.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md_to_oo(strs, default_format = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="md_to_oo_+3A_strs">strs</code></td>
<td>
<p>vector of strings containing Markdown can contain the following elements:</p>
</td></tr>
<tr><td><code id="md_to_oo_+3A_default_format">default_format</code></td>
<td>
<p>list containing the default format for elements not defined with markdown default values (format the same as <code><a href="#topic+md_to_officer">md_to_officer</a></code>, default is <code>NULL</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following elements
</p>

<ul>
<li><p>isgood:    Boolean value indicating the result of the function call
</p>
</li>
<li><p>msgs:      sequence of strings containing a description of any problems
</p>
</li>
<li><p>as_par_cmd:as_paragraph generated code from md_to_officer
</p>
</li>
<li><p>oo:        as_paragraph officer object resulting from running the as_par_cmd code
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>res = md_to_oo("Be **bold**")
</code></pre>

<hr>
<h2 id='mk_lg_tbl'>Creates Large Table Data for Testing</h2><span id='topic+mk_lg_tbl'></span>

<h3>Description</h3>

<p>Generates a large table for testing multi-page table reports.
It is used for testing <code>span_table()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_lg_tbl()
</code></pre>


<h3>Value</h3>

<p>list with the following elements
</p>

<ul>
<li><p>lg_tbl_body:              Table body to be spread across multiple pages.
</p>
</li>
<li><p>lg_tbl_row_common:        Common rows of data to be found horizontially.
</p>
</li>
<li><p>lg_tbl_body_head:         Header data for the body portion.
</p>
</li>
<li><p>lg_tbl_row_common_head:   Header data for the common_row portion.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>res =  mk_lg_tbl()
</code></pre>

<hr>
<h2 id='preview_template'>Generate Report Previewing the Locations From Mapping File</h2><span id='topic+preview_template'></span>

<h3>Description</h3>

<p>Takes an onbrand object with a loaded template and populates
the template with the elements from the mapping file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preview_template(obnd, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preview_template_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="preview_template_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>onbrand object with template previews added and any messages passed
along
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
   template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
   mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))
obnd = preview_template(obnd)

obnd = read_template(
   template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
   mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))
obnd = preview_template(obnd)
</code></pre>

<hr>
<h2 id='read_template'>Read Word or PowerPoint Templates</h2><span id='topic+read_template'></span>

<h3>Description</h3>

<p>Takes a given template file/yaml mapping file combination, reads in
that information, checks to make sure the mapping information is correct and
then returns an onbrand object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_template(
  template = file.path(system.file(package = "onbrand"), "templates", "report.pptx"),
  mapping = file.path(system.file(package = "onbrand"), "templates", "report.yaml"),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_template_+3A_template">template</code></td>
<td>
<p>Name of PowerPoint or Word file to annotate (defaults to included PowerPoint template)</p>
</td></tr>
<tr><td><code id="read_template_+3A_mapping">mapping</code></td>
<td>
<p>Name of yaml file with configuration information</p>
</td></tr>
<tr><td><code id="read_template_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>onbrand object which is a list with the following elements:
</p>

<ul>
<li><p>isgood:       Boolean variable indicating the current state of the object
</p>
</li>
<li><p>rpt:          Officer object containing the initialized report
</p>
</li>
<li><p>rpttype:      Type of report (either PowerPoint or Word)
</p>
</li>
<li><p>key_table:    Empty (NULL) mapping table for tracking cross referencing (Word only)
</p>
</li>
<li><p>placeholders: Empty list to hold placeholder substitution text (Word only)
</p>
</li>
<li><p>meta:         Metadata read in from the yaml file
</p>
</li>
<li><p>mapping:      Mapping yaml file
</p>
</li>
<li><p>msgs:         Vector of messages indicating any errors that were encountered
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

</code></pre>

<hr>
<h2 id='report_add_doc_content'>Add Content to Body of a Word Document Report</h2><span id='topic+report_add_doc_content'></span>

<h3>Description</h3>

<p>Appends content to the body of a Word document
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_add_doc_content(
  obnd,
  type = NULL,
  content = NULL,
  fig_start_at = NULL,
  tab_start_at = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_add_doc_content_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="report_add_doc_content_+3A_type">type</code></td>
<td>
<p>Type of content to add</p>
</td></tr>
<tr><td><code id="report_add_doc_content_+3A_content">content</code></td>
<td>
<p>Content to add</p>
</td></tr>
<tr><td><code id="report_add_doc_content_+3A_fig_start_at">fig_start_at</code></td>
<td>
<p>Indicates that you want to restart figure numbering at
the specified value (e.g. 1) after adding this content a value of <code>NULL</code> (default)
will ignore this option.</p>
</td></tr>
<tr><td><code id="report_add_doc_content_+3A_tab_start_at">tab_start_at</code></td>
<td>
<p>Indicates that you want to restart figure numbering at
the specified value (e.g. 1) after adding this content a value of <code>NULL</code> (default)
will ignore this option.</p>
</td></tr>
<tr><td><code id="report_add_doc_content_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each <code>content</code> types listed below the different <code>content</code> outlined is expected. Text
can be specified in different formats: <code>"text"</code> indicates plain text,
<code>"fpar"</code> is formatted text defined by the <code>fpar</code> command from the
<code>officer</code> package, <code>"ftext"</code> is a list of formatted text defined
by the <code>ftext</code> command, and <code>"md"</code> is text formatted in markdown
format (<code>?md_to_officer</code> for markdown details).
</p>

<ul>
<li> <p><code>"break"</code> page break, content is (<code>NULL</code>) and a page break will be inserted here
</p>
</li>
<li> <p><code>"ph"</code> adds placeholder text substitution
</p>

<ul>
<li> <p><code>"name"</code> placeholder name (value in body of text surrounded by three equal signs, e.g. if you have <code>"===MYPH==="</code>. in the document the name is just <code>"MYPH"</code>)
</p>
</li>
<li> <p><code>"value"</code> value to be substituted into the placeholder (<code>"my text"</code>)
</p>
</li>
<li> <p><code>"location"</code> document location where the placeholder will be located (either <code>"header"</code>, <code>"footer"</code>, or <code>"body"</code>)
</p>
</li></ul>

</li>
<li> <p><code>"toc"</code> generates the table of contents, and content is a list
that must contain __one__ of the following. 
</p>

<ul>
<li> <p><code>"level"</code> number indicating the depth of the contents to display (default: <code>3</code>)
</p>
</li>
<li> <p><code>"style"</code> string containing the onbrand style name to use to build the TOC
</p>
</li></ul>

</li>
<li> <p><code>"section"</code> formats the current document section
</p>

<ul>
<li> <p><code>"section_type"</code> type of section to apply, either <code>"columns"</code>,  <code>"continuous"</code>, <code>"landscape"</code>, <code>"portrait"</code>, <code>"columns"</code>,  or  <code>"columns_landscape"</code>
</p>
</li>
<li> <p><code>"width"</code>        override the default page width with this value in inches (<code>NULL</code>)
</p>
</li>
<li> <p><code>"height"</code>       override the default page height with this value in inches (<code>NULL</code>)
</p>
</li>
<li> <p><code>"widths"</code>       column widths in inches, number of columns set by number of values (<code>NULL</code>)
</p>
</li>
<li> <p><code>"space"</code>        space in inches between columns (<code>NULL</code>)
</p>
</li>
<li> <p><code>"sep"</code>          Boolean value controlling line separating columns (<code>FALSE</code>)
</p>
</li></ul>

</li>
<li> <p><code>"text"</code> content is a list containing a paragraph of text with the following elements
</p>

<ul>
<li> <p><code>"text"</code> string containing the text content either a string or the output of <code>"fpar"</code> for formatted text.
</p>
</li>
<li> <p><code>"style"</code> string containing the style to use (default <code>NULL</code> will use the <code>doc_def</code>, <code>Text</code> style)
</p>
</li>
<li> <p><code>"format"</code> string containing the format, either <code>"text"</code>, <code>"fpar"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li></ul>

</li>
<li> <p><code>"imagefile"</code> content is a list containing information describing an image file with the following elements
</p>

<ul>
<li> <p><code>image</code> string containing path to image file
</p>
</li>
<li> <p><code>caption</code> caption of the image (<code>NULL</code>)
</p>
</li>
<li> <p><code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>notes</code> notes to add under the image  (<code>NULL</code>)
</p>
</li>
<li> <p><code>notes_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>key</code> unique key for cross referencing e.g. &quot;FIG_DATA&quot; (<code>NULL</code>)
</p>
</li>
<li> <p><code>height</code> height of the image (<code>NULL</code>)
</p>
</li>
<li> <p><code>width</code> width of the image (<code>NULL</code>)
</p>
</li></ul>

</li>
<li> <p><code>"ggplot"</code> content is a list containing a ggplot object, (eg. p = ggplot() + ....) with the following elements
</p>

<ul>
<li> <p><code>image</code> ggplot object
</p>
</li>
<li> <p><code>caption</code> caption of the image (<code>NULL</code>)
</p>
</li>
<li> <p><code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>notes</code> notes to add under the image  (<code>NULL</code>)
</p>
</li>
<li> <p><code>notes_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>key</code> unique key for cross referencing e.g. &quot;FIG_DATA&quot; (<code>NULL</code>)
</p>
</li>
<li> <p><code>height</code> height of the image (<code>NULL</code>)
</p>
</li>
<li> <p><code>width</code> width of the image (<code>NULL</code>)
</p>
</li></ul>

</li>
<li> <p><code>"table"</code> content is a list containing the table content and other options with the following elements:
</p>

<ul>
<li> <p><code>table</code> data frame containing the tabular data
</p>
</li>
<li> <p><code>"style"</code> string containing the style to use (default <code>NULL</code> will use the <code>doc_def</code>, <code>Table</code> style)
</p>
</li>
<li> <p><code>caption</code> caption of the table (<code>NULL</code>)
</p>
</li>
<li> <p><code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>notes</code> notes to add under the image  (<code>NULL</code>)
</p>
</li>
<li> <p><code>notes_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>key</code> unique key for cross referencing e.g. &quot;TAB_DATA&quot; (<code>NULL</code>)
</p>
</li>
<li> <p><code>header</code> Boolean variable to control displaying the header (<code>TRUE</code>)
</p>
</li>
<li> <p><code>first_row</code> Boolean variable to indicate that the first row contains header information (<code>TRUE</code>)
</p>
</li></ul>

</li>
<li> <p><code>"flextable"</code> content is a list containing flextable content and other options with the following elements (defaults in parenthesis):
</p>

<ul>
<li> <p><code>table</code> data frame containing the tabular data
</p>
</li>
<li> <p><code>caption</code> caption of the table (<code>NULL</code>)
</p>
</li>
<li> <p><code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>notes</code> notes to add under the image  (<code>NULL</code>)
</p>
</li>
<li> <p><code>notes_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>key</code> unique key for cross referencing e.g. &quot;TAB_DATA&quot; (<code>NULL</code>)
</p>
</li>
<li> <p><code>header_top</code>, <code>header_middle</code>, <code>header_bottom</code> (<code>NULL</code>) a list with the same names as the data frame names containing the tabular data and values with the header text to show in the table
</p>
</li>
<li> <p><code>header_format</code> string containing the format, either <code>"text"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>merge_header</code> (<code>TRUE</code>) Set to true to combine column headers with the same information
</p>
</li>
<li> <p><code>table_body_alignment</code>, table_header_alignment (&quot;center&quot;) Controls alignment
</p>
</li>
<li> <p><code>table_autofit</code> (<code>TRUE</code>) Automatically fit content, or specify the cell width and height with <code>cwidth</code> (<code>0.75</code>) and <code>cheight</code> (<code>0.25</code>)
</p>
</li>
<li> <p><code>table_theme</code> (<code>"theme_vanilla"</code>) Table theme
</p>
</li></ul>

</li>
<li> <p><code>"flextable_object"</code> content is a list specifying the a user defined flextable object with the following elements:
</p>

<ul>
<li> <p><code>ft</code> flextable object
</p>
</li>
<li> <p><code>caption</code> caption of the table (<code>NULL</code>)
</p>
</li>
<li> <p><code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>notes</code> notes to add under the image  (<code>NULL</code>)
</p>
</li>
<li> <p><code>notes_format</code> string containing the format, either <code>"text"</code>, <code>"ftext"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)
</p>
</li>
<li> <p><code>key</code> unique key for cross referencing e.g. &quot;TAB_DATA&quot; (<code>NULL</code>)
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>onbrand object with the content added to the body or isgood set
to FALSE with any messages in the msgs field. The isgood value is a Boolean variable
indicating the current state of the object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read  Word template into an onbrand object
obnd = read_template(
 template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
 mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

# The examples below use the following packages
library(ggplot2)
library(flextable)
library(officer)

# Adding text
obnd = report_add_doc_content(obnd,
  type     = "text",
  content  = list(text="Text with no style specified will use the doc_def text format."))


# Text formatted with fpar
fpartext = fpar(
ftext("Formatted text can be created using the ", prop=NULL),
ftext("fpar ", prop=fp_text(color="green")),
ftext("command from the officer package.", prop=NULL))

obnd = report_add_doc_content(obnd,
 type     = "text",
 content  = list(text   = fpartext,
                 format = "fpar",
                 style  = "Normal"))

# Text formatted with markdown
mdtext = "Formatted text can be created using
**&lt;color:green&gt;markdown&lt;/color&gt;** formatting"
obnd = report_add_doc_content(obnd,
 type     = "text",
 content  = list(text   = mdtext,
                 format = "md",
                 style  = "Normal"))


# Adding figures
p = ggplot() + annotate("text", x=0, y=0, label = "picture example")
imgfile = tempfile(pattern="image", fileext=".png")
ggsave(filename=imgfile, plot=p, height=5.15, width=9, units="in")

# From an image file:
obnd = report_add_doc_content(obnd,
type     = "imagefile",
content  = list(image   = imgfile,
               caption = "This is an example of an image from a file."))

# From a ggplot object
obnd = report_add_doc_content(obnd,
type     = "imagefile",
content  = list(image   = imgfile,
               caption = "This is an example of an image from a file."))


#Adding tables
tdf =    data.frame(Parameters = c("Length", "Width", "Height"),
                Values     = 1:3,
                Units      = c("m", "m", "m") )

# Word table
tab_cont = list(table   = tdf,
               caption = "Word Table.")
obnd = report_add_doc_content(obnd,
 type     = "table",
 content  = tab_cont)

# onbrand flextable abstraction:
tab_cont = list(table   = tdf,
               caption = "Word Table.")
obnd = report_add_doc_content(obnd,
type     = "table",
content  = tab_cont)

# flextable object
tab_fto = flextable(tdf)
obnd = report_add_doc_content(obnd,
 type     = "flextable_object",
 content  = list(ft=tab_fto,
                 caption  = "Flextable object created by the user."))

# Saving the report output
save_report(obnd, tempfile(fileext = ".docx"))

</code></pre>

<hr>
<h2 id='report_add_slide'>Add Slide and Content</h2><span id='topic+report_add_slide'></span>

<h3>Description</h3>

<p>Creates a report slide and populates the content in
placeholders and arbitrary locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_add_slide(
  obnd,
  template = NULL,
  elements = NULL,
  user_location = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_add_slide_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="report_add_slide_+3A_template">template</code></td>
<td>
<p>Name of slide template to use (name from templates in yaml mapping file)</p>
</td></tr>
<tr><td><code id="report_add_slide_+3A_elements">elements</code></td>
<td>
<p>Content and type for each placeholder you wish to fill for
this slide: This is a list with names set to placeholders for the specified
template. Each placeholder is a list and should have a content element and a
type element (see Details below).</p>
</td></tr>
<tr><td><code id="report_add_slide_+3A_user_location">user_location</code></td>
<td>
<p>List with arbitrary element names (see Details below)</p>
</td></tr>
<tr><td><code id="report_add_slide_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To add content based on placeholder names consider the mapping information for the slide
template <code>title_slide</code> with the two place holders <code>title</code> and
<code>subtitle</code>.
</p>
<pre>rpptx:
 master: Office Theme
 templates:
   title_slide:
     title:
       type:         ctrTitle
       index:        1
       ph_label:     Title 1
       content_type: text
     subtitle:
       type:         subTitle
       index:        1
       ph_label:     Subtitle 2
       content_type: text</pre>
<p>This shows how to populate a title slide with text:
</p>
<pre>obnd = report_add_slide(obnd,
 template = "title_slide",
 elements = list(
    title     = list( content      = "Slide Title",
                      type         = "text"),
    subtitle  = list( content      = "Subtitle",
                      type         = "text")))</pre>
<p>To add content based on user defined locations you need to supply a list
with the content, type, starting point and stopping point. You can use any
template you wish, and you need to populate the <code>user_location</code> input.
This consists of lists. The name of these lists can be arbitrary
(text_example and fig_example below). Each list has a content and type, this
is the same used in elements above. The start and stop each represent x and
y coordinates. This is the fraction of the width and height of the slide
measured from the upper left. So the <code>start = c(0.5, 0)</code> below means
the box holding that content would start at the middle of the slide width
and the top of the slide.
</p>
<pre> #'obnd = report_add_slide(obnd,
 template = "two_content_header_text",
 user_location = list(
    text_example  = list( content      = "This is text",
                          type         = "text",
                          start        = c(.01,.02),
                          stop         = c(.3,.15)),
    fig_example   = list( content      = ggplot2::ggplot(),
                          type         = "ggplot",
                          start        = c(.5,0),
                          stop         = c(1,.5))
 )
)</pre>
<p>See the function <code><a href="#topic+add_pptx_ph_content">add_pptx_ph_content</a></code> for a list of
allowed values for <code>type</code>. Note that if mapping defines the
<code>content_type</code> as <code>text</code>, you cannot use a <code>list</code> type.
Similarly, if the <code>content_type</code> is defined as <code>list</code>, you
cannot use a <code>text</code> type.
</p>


<h3>Value</h3>

<p>onbrand report object with either the content added or isgood set
to FALSE with any messages in the msgs field. The isgood value is a Boolean variable
indicating the current state of the object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_pptx_ph_content">add_pptx_ph_content</a></code> <code><a href="#topic+view_layout">view_layout</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

# Adding content based on placeholder elements
obnd = report_add_slide(obnd,
 template = "content_text",
 elements = list(
    title         = list( content      = "Text Example",
                          type         = "text"),
    sub_title     = list( content      = "Adding a slide with a block of text",
                          type         = "text"),
    content_body  = list( content      = "A block of text",
                          type         = "text")))

# Adding content based on specified locations
obnd = report_add_slide(obnd,
 template = "two_content_header_text",
 user_location = list(
    text_example  = list( content      = "This is text",
                          type         = "text",
                          start        = c(.01,.02),
                          stop         = c(.3,.15))))
</code></pre>

<hr>
<h2 id='save_report'>Save Onbrand Report to a File</h2><span id='topic+save_report'></span>

<h3>Description</h3>

<p>Saves report in onbrand object to the specified file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_report(obnd, output_file = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_report_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="save_report_+3A_output_file">output_file</code></td>
<td>
<p>File name to save the report.</p>
</td></tr>
<tr><td><code id="save_report_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>msgs:   Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

save_report(obnd, tempfile(fileext = ".pptx"))

obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

save_report(obnd, tempfile(fileext = ".docx"))

</code></pre>

<hr>
<h2 id='set_officer_object'>Places Officer Object Into Onbrand Report Object</h2><span id='topic+set_officer_object'></span>

<h3>Description</h3>

<p>After modifying a report object manually, you can return it to
the onbrand object using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_officer_object(obnd, rpt = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_officer_object_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="set_officer_object_+3A_rpt">rpt</code></td>
<td>
<p>officer object</p>
</td></tr>
<tr><td><code id="set_officer_object_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned onbrand
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>onbrand object with the report replaced
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fetch_officer_object">fetch_officer_object</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obnd = read_template(
      template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
      mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))

# pulling out the report
rpt = fetch_officer_object(obnd)$rpt

# Modifications would be made here with officer directly

# Replacing the report into the onbrand object
obnd = set_officer_object(obnd, rpt)

</code></pre>

<hr>
<h2 id='span_table'>Spread Large Table Over Smaller Tables</h2><span id='topic+span_table'></span>

<h3>Description</h3>

<p>Takes a large table and spreads it over smaller tables to
paginate it. It will preserve common row  information on the left and
separate columns according to maximum specifications. The final tables will
have widths less than or equal to both max_col and max_width, and heights
less than or equal to both max_row and max_height.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>span_table(
  table_body = NULL,
  row_common = NULL,
  table_body_head = NULL,
  row_common_head = NULL,
  header_format = "text",
  obnd = NULL,
  max_row = 20,
  max_col = 10,
  max_height = 7,
  max_width = 6.5,
  table_alignment = "center",
  inner_border = officer::fp_border(color = "black", width = 0.3),
  outer_border = officer::fp_border(color = "black", width = 2),
  set_header_inner_border_v = TRUE,
  set_header_inner_border_h = TRUE,
  set_header_outer_border = TRUE,
  set_body_inner_border_v = TRUE,
  set_body_inner_border_h = FALSE,
  set_body_outer_border = TRUE,
  notes_detect = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="span_table_+3A_table_body">table_body</code></td>
<td>
<p>Data frame with the body of the large table.</p>
</td></tr>
<tr><td><code id="span_table_+3A_row_common">row_common</code></td>
<td>
<p>Data frame with the common rows.</p>
</td></tr>
<tr><td><code id="span_table_+3A_table_body_head">table_body_head</code></td>
<td>
<p>Data frame or matrix with headers for the table body.</p>
</td></tr>
<tr><td><code id="span_table_+3A_row_common_head">row_common_head</code></td>
<td>
<p>Data frame or matrix with headers for the common rows.</p>
</td></tr>
<tr><td><code id="span_table_+3A_header_format">header_format</code></td>
<td>
<p>Format of the header either <code>"text"</code> (default) or <code>"md"</code> for markdown.</p>
</td></tr>
<tr><td><code id="span_table_+3A_obnd">obnd</code></td>
<td>
<p>Optional onbrand object used to format markdown. The default <code>NULL</code> value will use default formatting.</p>
</td></tr>
<tr><td><code id="span_table_+3A_max_row">max_row</code></td>
<td>
<p>Maximum number of rows in output tables (A value of <code>NULL</code> will set max_row to the number of rows in the table).</p>
</td></tr>
<tr><td><code id="span_table_+3A_max_col">max_col</code></td>
<td>
<p>Maximum number of columns in output tables (A value of <code>NULL</code> will set max_col to number of columns in the table).</p>
</td></tr>
<tr><td><code id="span_table_+3A_max_height">max_height</code></td>
<td>
<p>Maximum height of the final table in inches (A value of <code>NULL</code> will use 100 inches).</p>
</td></tr>
<tr><td><code id="span_table_+3A_max_width">max_width</code></td>
<td>
<p>Maximum width of the final table in inches (A value of <code>NULL</code> will use 100 inches).</p>
</td></tr>
<tr><td><code id="span_table_+3A_table_alignment">table_alignment</code></td>
<td>
<p>Character string specifying the alignment #'of the table (body and headers). Can be <code>"center"</code> (default), <code>"left"</code>, <code>"right"</code>, or <code>"justify"</code></p>
</td></tr>
<tr><td><code id="span_table_+3A_inner_border">inner_border</code></td>
<td>
<p>Border object for inner border lines defined using <code>officer::fp_border()</code></p>
</td></tr>
<tr><td><code id="span_table_+3A_outer_border">outer_border</code></td>
<td>
<p>Border object for outer border lines defined using <code>officer::fp_border()</code></p>
</td></tr>
<tr><td><code id="span_table_+3A_set_header_inner_border_v">set_header_inner_border_v</code></td>
<td>
<p>Boolean value to enable or disable inner vertical borders for headers</p>
</td></tr>
<tr><td><code id="span_table_+3A_set_header_inner_border_h">set_header_inner_border_h</code></td>
<td>
<p>Boolean value to enable or disable inner horizontal borders for headers</p>
</td></tr>
<tr><td><code id="span_table_+3A_set_header_outer_border">set_header_outer_border</code></td>
<td>
<p>Boolean value to enable or disable outer border for headers</p>
</td></tr>
<tr><td><code id="span_table_+3A_set_body_inner_border_v">set_body_inner_border_v</code></td>
<td>
<p>Boolean value to enable or disable inner vertical borders for the body</p>
</td></tr>
<tr><td><code id="span_table_+3A_set_body_inner_border_h">set_body_inner_border_h</code></td>
<td>
<p>Boolean value to enable or disable inner horizontal borders for the body</p>
</td></tr>
<tr><td><code id="span_table_+3A_set_body_outer_border">set_body_outer_border</code></td>
<td>
<p>Boolean value to enable or disable outer border borders for the body</p>
</td></tr>
<tr><td><code id="span_table_+3A_notes_detect">notes_detect</code></td>
<td>
<p>Vector of strings to detect in output tables (example <code>c("NC", "BLQ")</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The way the data frames relate to each other are mapped out below. The
dimensions of the different data frames are identified below (nrow x ncol)
</p>
<pre>
 |-------------------------------------| ---
 |                 |                   |  ^
 |                 |                   |  |
 | row_common_head |  table_body_head  |  | m
 |      m x n      |       m x c       |  |
 |                 |                   |  v
 |-------------------------------------| ---
 |                 |                   |  ^
 |                 |                   |  |
 |    row_common   |    table_body     |  | r
 |      r x n      |      r x c        |  |
 |                 |                   |  |
 |                 |                   |  v
 |-------------------------------------| ---

 |&lt;---------------&gt;|&lt;-----------------&gt;|
         n                   c
</pre>


<h3>Value</h3>

<p>list with the following elements
</p>

<ul>
<li><p>isgood:    Boolean indicating the exit status of the function.
</p>
</li>
<li><p>one_body:  Full table with no headers.
</p>
</li>
<li><p>one_table: Full table with headers.
</p>
</li>
<li><p>msgs:      Vector of text messages describing any errors that were found.
</p>
</li>
<li><p>tables:    Named list of tables. Each list element is of the output.
format from <code>build_span()</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+build_span">build_span</a> for the relationship of inputs.</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){

tbl_res = mk_lg_tbl()

res =
span_table(table_body      = tbl_res$lg_tbl_body,
           row_common      = tbl_res$lg_tbl_row_common,
           table_body_head = tbl_res$lg_tbl_body_head,
           row_common_head = tbl_res$lg_tbl_row_common_head,
           max_row         = 20,
           max_col         = 10,
           notes_detect    = c("BQL", "NC"))


# Notes detected in the first table:
res[["tables"]][["Table 1"]][["notes"]]

# First table as a data frame:
res[["tables"]][["Table 1"]][["df"]]

# First table as a flextable:
res[["tables"]][["Table 1"]][["ft"]]

}

</code></pre>

<hr>
<h2 id='template_details'>Show Template Details for 'onbrand' Object</h2><span id='topic+template_details'></span>

<h3>Description</h3>

<p>Takes an onbrand object with a loaded template and displays
relevant details about the template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>template_details(obnd, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="template_details_+3A_obnd">obnd</code></td>
<td>
<p>onbrand report object</p>
</td></tr>
<tr><td><code id="template_details_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be
displayed on the terminal; Messages will be included in the returned results
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides relevant details about an onbrand object.  For PowerPoint 
this contains the template names and elements present for that template. For 
Word it will contain defined text and table styles. This information can be 
displayed in the console, returned as text or formatted for use in RMarkdown 
documentation.
</p>


<h3>Value</h3>

<p>list with the following elements:
</p>

<ul>
<li><p>rpttype:      Type of report (either PowerPoint or Word)
</p>
</li>
<li><p>msgs:         Vector of messages with details or any errors that were encountered
</p>
</li>
<li><p>txt:          Vector of template details in text format
</p>
</li>
<li><p>df:           Vector of template details in a dataframe
</p>
</li>
<li><p>ft:           Vector of template details in flextable format
</p>
</li>
<li><p>isgood:       Boolean variable indicating the current state of the object
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>obnd = read_template(
   template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
   mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))
details = template_details(obnd)

obnd = read_template(
   template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
   mapping  = file.path(system.file(package="onbrand"), "templates", "report.yaml"))
details = template_details(obnd)
</code></pre>

<hr>
<h2 id='view_layout'>Generate Annotated Layout for Report Templates</h2><span id='topic+view_layout'></span>

<h3>Description</h3>

<p>Produces a report with each layout element labeled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>view_layout(
  template = file.path(system.file(package = "onbrand"), "templates", "report.pptx"),
  output_file = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="view_layout_+3A_template">template</code></td>
<td>
<p>Name of PowerPoint or Word file to annotate (defaults to included PoerPoint template)</p>
</td></tr>
<tr><td><code id="view_layout_+3A_output_file">output_file</code></td>
<td>
<p>name of file to place the annotated layout information, set to <code>NULL</code> and it will generate a file named layout with the appropriate extension</p>
</td></tr>
<tr><td><code id="view_layout_+3A_verbose">verbose</code></td>
<td>
<p>Boolean variable when set to TRUE (default) messages will be</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates an Annotated report based on the template provided.  
Elements of slide masters are identified by placeholder labels. As PowerPoint 
masters are created the labels can be difficult to predict. Word documents are 
identified by style names. This function will create a layout file identifying 
all of the elements of each slide master for a PowerPoint template or each 
paragraph and table style for a Word template.
</p>


<h3>Value</h3>

<p>List with the following elements
</p>

<ul>
<li><p>isgood: Boolean variable indicating success or failure
</p>
</li>
<li><p>rpt: Officer with the annotated layout
</p>
</li>
<li><p>msgs: Vector of messages
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>lpptx = view_layout(
     template = file.path(system.file(package="onbrand"), "templates", "report.pptx"),
     output_file   = file.path(tempdir(), "layout.pptx"))

ldocx = view_layout(
     template = file.path(system.file(package="onbrand"), "templates", "report.docx"),
     output_file   = file.path(tempdir(), "layout.docx"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
