<!DOCTYPE html><html><head><title>Help for package icensBKL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {icensBKL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aidsCohort'><p>AIDS Cohort Study on Patients with Hemophilia</p></a></li>
<li><a href='#aidsCT'><p>AIDS Clinical Trial ACTG 181</p></a></li>
<li><a href='#breastCancer'><p>Cosmetic Data on Breast Cancer Patients</p></a></li>
<li><a href='#clayton.copula'><p>Cumulative density function of the Clayton copula</p></a></li>
<li><a href='#contourProb'>
<p>Contour Probability</p></a></li>
<li><a href='#fit.copula'><p>Function to fit a survival copula</p></a></li>
<li><a href='#graft'><p>Homograft's Survival Times</p></a></li>
<li><a href='#hiv'><p>HIV Data on Hemophilia Patients</p></a></li>
<li><a href='#icbiplot'>
<p>Interval-censored biplot</p></a></li>
<li><a href='#icsurv2cdf'>
<p>Conversion of icsurv objects in a data.frame</p></a></li>
<li><a href='#kSampleIcens'>
<p>Non-parametric comparison of k survival curves</p></a></li>
<li><a href='#loglogistic'>
<p>Log-logistic distribution</p></a></li>
<li><a href='#mastitis'><p>Data on Mastitis in Dairy Cattle</p></a></li>
<li><a href='#mobile'><p>Survey on Mobile Phone Purchases</p></a></li>
<li><a href='#normal.copula'><p>Cumulative density function of the normal copula</p></a></li>
<li><a href='#NPbayesSurv'>
<p>Bayesian non-parametric estimation of a survival curve</p>
with right-censored data</a></li>
<li><a href='#NPICbayesSurv'>
<p>Bayesian non-parametric estimation of a survival curve</p>
with interval-censored data</a></li>
<li><a href='#plackett.copula'><p>Cumulative density function of the Plackett copula</p></a></li>
<li><a href='#survfitS.smoothSurvReg'>
<p>Survivor function for Objects of Class 'smoothSurvReg'</p></a></li>
<li><a href='#tandmob'><p>Signal Tandmobiel Data, Subsample</p></a></li>
<li><a href='#tandmobAll'><p>Signal Tandmobiel Data</p></a></li>
<li><a href='#yoghurt'><p>Sensory Shelf Life of Yoghurt</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Accompanion to the Book on Interval Censoring by Bogaerts,
Komarek, and Lesaffre</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), survival, MASS, Icens</td>
</tr>
<tr>
<td>Imports:</td>
<td>TeachingDemos, mvtnorm, smoothSurv, gtools, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>interval, logspline, mixAK, bayesSurv, FHtest, icenReg,
frailtypack, MLEcens, cubature, runjags, coda, dynsurv</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains datasets and several smaller functions suitable for analysis of interval-censored data. The package complements the book Bogaerts, Komárek and Lesaffre (2017, ISBN: 978-1-4200-7747-6) "Survival Analysis with Interval-Censored Data: A Practical Approach" <a href="https://www.routledge.com/Survival-Analysis-with-Interval-Censored-Data-A-Practical-Approach-with/Bogaerts-Komarek-Lesaffre/p/book/9781420077476">https://www.routledge.com/Survival-Analysis-with-Interval-Censored-Data-A-Practical-Approach-with/Bogaerts-Komarek-Lesaffre/p/book/9781420077476</a>. Full R code related to the examples presented in the book can be found at <a href="https://ibiostat.be/online-resources/icbook/supplemental">https://ibiostat.be/online-resources/icbook/supplemental</a>. Packages mentioned in the "Suggests" section are used in those examples.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ibiostat.be/online-resources/icbook/supplemental/">https://ibiostat.be/online-resources/icbook/supplemental/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-19 21:17:47 UTC; komarek</td>
</tr>
<tr>
<td>Author:</td>
<td>Arnošt Komárek <a href="https://orcid.org/0000-0001-8778-3762"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Kris Bogaerts <a href="https://orcid.org/0000-0003-0188-8665"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Emmanuel Lesaffre [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arnošt Komárek &lt;arnost.komarek@mff.cuni.cz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 09:50:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='aidsCohort'>AIDS Cohort Study on Patients with Hemophilia</h2><span id='topic+aidsCohort'></span>

<h3>Description</h3>

<p>The study population for this example consists of 257 individuals with Type A or B hemophilia
who had been treated at two French hospitals since 1978. These
patients were at risk for infection by the human immunodeficiency
virus (HIV) through contaminated blood factor received for their
treatment. By the time of analysis, 188 patients were found to be
infected with the virus, 41 of whom subsequently progressed to the
acquired immunodeficiency syndrome (AIDS) or other related clinical
symptoms. For reasons of simplicity, we refer to all of these events
as AIDS. The primary goal of the analysis was to assess the effects of
level of treatment received for hemophilia, and age, on the risk of
developing AIDS-related symptoms.
</p>
<p>The time scale was obtained by dividing the real time axis into 6-month
intervals, with <code class="reqn">T=1</code> denoting the time period from January 1,
1978 to June 30, 1978.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aidsCohort)</code></pre>


<h3>Format</h3>

<p>a data frame with 257 rows and the following variables
</p>

<dl>
<dt>L.Y</dt><dd><p>left (lower) limit of interval containing the infection time.</p>
</dd>
<dt>R.Y</dt><dd><p>right (upper) limit of interval containing the infection
time. It is equal to <code>NA</code> for those with right-censored
infection time at <code>L.Y</code>.</p>
</dd>
<dt>L.Z</dt><dd><p>left (lower) limit of interval containing the time of the
first clinical symptoms. It is equal to <code>NA</code> for those who
were not infected by the end of the study period.</p>
</dd>
<dt>R.Z</dt><dd><p>right (upper) limit of interval containing the time of the
first clinical symptoms. It is equal to <code>NA</code> for those who
were not infected by the end of the study period or for those
whose time of the first clinical symptoms is right-censored at
<code>L.Z</code>.
</p>
</dd>
<dt>age</dt><dd><p>the age covariate which is equal to 1 if the estimated
age at time infection is <code class="reqn">&lt;20</code> years, and 2 otherwise.</p>
</dd>
<dt>group</dt><dd><p>treatment group. It is 0 for lightly treated group and
1 for heavily treated group.</p>
</dd>
<dt>fage</dt><dd><p><code>factor</code> variable created from <code>age</code>.</p>
</dd>
<dt>fgroup</dt><dd><p><code>factor</code> variable created from <code>group</code>.</p>
</dd>        
</dl>
  


<h3>Source</h3>

<p>Kim, M. Y., De Gruttola, V. G., and Lagakos, S. W. (1993).
Analyzing doubly censored data with covariates, with application to AIDS.
<em>Biometrics</em>, <b>49</b>, 13-22.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aidsCohort", package="icensBKL")
summary(aidsCohort)
</code></pre>

<hr>
<h2 id='aidsCT'>AIDS Clinical Trial ACTG 181</h2><span id='topic+aidsCT'></span>

<h3>Description</h3>

<p>AIDS Clinical Trials Group protocol ACTG 181 was a natural history
substudy of a comparative trial of three anti-pneumocystis drugs.
Patients were followed for shedding of cytomegalovirus (CMV) in urine
and blood samples, and for colonization of mycobacterium avium complex
(MAC) in the sputum and stool. Subjects were screened for CMV in the
urine every 4 weeks and in the blood every 12 weeks. Subjects were
screened for MAC every 12 weeks. Many patients missed several of the
prescheduled clinic visits, and returned with new laboratory
indications for CMV or MAC. Thus, their times until first CMV shedding
or MAC colonization are censored into intervals of time when the
missed clinic visits occurred. However, for the current analysis,
visit times were rounded to the closest quarter because they are of
practical interest to physicians in that they correspond to standard clinic schedules.
Only 204 of the 232 subjects in the study who were tested for CMV
shedding and MAC colonization at least once during the trial, and did
not have a prior CMV or MAC diagnosis are included in the data base.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aidsCT)</code></pre>


<h3>Format</h3>

<p>a data frame with 204 rows and the following variables
</p>

<dl>
<dt>L.CMV</dt><dd><p>left (lower) limit of interval (L.CMV, R.CMV] that
contains time of CMV shedding (months). It is <code>NA</code> if the time of CMV
shedding is left-censored at <code>R.CMV</code>.      
</p>
</dd>
<dt>R.CMV</dt><dd><p>right (upper) limit of interval (L.CMV, R.CMV] that
contains time of CMV shedding (months). It is <code>NA</code> if the time of CMV
shedding is right-censored at <code>L.CMV</code>.
</p>
</dd>
<dt>L.MAC</dt><dd><p>left (lower) limit of interval (L.MAC, R.MAC] that
contains time of MAC colonization (months). It is <code>NA</code> if the
time of MAC colonization is left-censored at <code>R.MAC</code>.
</p>
</dd>
<dt>R.MAC</dt><dd><p>right (upper) limit of interval (L.MAC, R.MAC] that
contains time of MAC colonization (months). It is <code>NA</code> if the
time of MAC colonization is right-censored at <code>L.MAC</code>.
</p>
</dd>
</dl>
  


<h3>Source</h3>

<p>Betensky, R. A. and Finkelstein, D. M. (1999).
A non-parametric maximum likelihood estimator for bivariate interval
censored data.
<em>Statistics in Medicine</em>, <b>18</b>, 3089-3100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("aidsCT", package="icensBKL")
summary(aidsCT)
</code></pre>

<hr>
<h2 id='breastCancer'>Cosmetic Data on Breast Cancer Patients</h2><span id='topic+breastCancer'></span>

<h3>Description</h3>

<p>Breadle et al. (1984a, 1984b) report a retrospective study carried out
to compare the cosmetic effects of radiotherapy alone versus radiotherapy
and adjuvant chemotherapy on women with early breast cancer. 
</p>
<p>Patients were observed initially every 4 to 6 months, but as their
recovery progressed, the interval betwenn visits lengthened.
At each visit, the clinician recorded a measure of breast retraction
on a 3-point scale (none, moderate, severe).
Event of interest was the time to first appearance of moderate or severe breast retraction.
</p>
<p>The subjects in this data were patients who had been treated at
the Joint Center for Radiation Therapy in Boston between 1976 and 1980.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(breastCancer)</code></pre>


<h3>Format</h3>

<p>a data frame with 94 rows and the following variables
</p>

<dl>
<dt>low</dt><dd><p>lower limit of interval (lower,upper] that contains the
event of interest (months). It is <code>NA</code> for left-censored observations.</p>
</dd>
<dt>upp</dt><dd><p>upper limit of interval (lower,upper] that contains the
event of interest (months). It is <code>NA</code> for right-censored observations.</p>
</dd>
<dt>treat</dt><dd><p>treatment regimen
</p>

<dl>
<dt>1 = <code>radio only</code> =</dt><dd><p>radiotherapy only</p>
</dd>
<dt>2 = <code>radio+chemo</code> =</dt><dd><p>radiotherapy + chemotherapy</p>
</dd> 
</dl>

</dd>  
</dl>



<h3>Source</h3>

<p>Finkelstein, D. M. and Wolfe, R. A. (1985).
A semiparametric model for regression analysis of interval-censored failure time data.
<em>Biometrics</em>, <b>41</b>, 933-945. Table 4.
</p>


<h3>References</h3>

<p>Beadle, G. F., Harris, J. R., Silver, B., Botnick, L., and Hellman, S. (1984a).
Cosmetic results following primary radiation therapy for early breast cancer.
<em>Cancer</em>, <b>54</b>, 2911-2918.
</p>
<p>Beadle, G. F., Harris, J. R., Come, S., Henderson, C., Silver, B., and Hellman, S. (1984b).
The effect of adjuvant chemotherapy on the cosmetic results after primary radiation treatment for early stage breast cancer:
A preliminary analysis.
<em>International Journal of Radiation Oncology, Biology and Physics</em>, <b>10</b>, 2131-2137.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("breastCancer", package="icensBKL")
summary(breastCancer)
</code></pre>

<hr>
<h2 id='clayton.copula'>Cumulative density function of the Clayton copula</h2><span id='topic+clayton.copula'></span>

<h3>Description</h3>

<p>Cumulative density function of the Clayton copula evaluated at points
(u, v) with given parameter exp(beta %*%cov)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clayton.copula(u, v, beta, cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clayton.copula_+3A_u">u</code></td>
<td>
<p>vector of points in [0,1] representing the first coordinate where the Clayton copula must be evaluated</p>
</td></tr>
<tr><td><code id="clayton.copula_+3A_v">v</code></td>
<td>
<p>vector of points in [0,1] representing the second coordinate where the Clayton copula must be evaluated</p>
</td></tr>
<tr><td><code id="clayton.copula_+3A_beta">beta</code></td>
<td>
<p>vector of coefficients to be multiplied with the covariates in order to determine the parameter of the Clayton copula</p>
</td></tr>
<tr><td><code id="clayton.copula_+3A_cov">cov</code></td>
<td>
<p>vector of covariates to be multipleid with the coefficients in order to determine the parameter of the Clayton copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cumulative density function of the Clayton copula evaluated at
points (u,v) with given parameter exp(beta %*%cov)</p>


<h3>Note</h3>

<p>This is not to be called by the user.</p>


<h3>Author(s)</h3>

<p>Kris Bogaerts <a href="mailto:kris.bogaerts@kuleuven.be">kris.bogaerts@kuleuven.be</a>
</p>


<h3>References</h3>

<p>Clayton, D. G. (1978). A model for association in bivariate life-tables and its application in epidemiological studies of familial tendency in chronic disease incidence. 
<em>Biometrika</em>, 65, 141-151.
</p>

<hr>
<h2 id='contourProb'>
Contour Probability
</h2><span id='topic+contourProb'></span>

<h3>Description</h3>

<p>Calculation of a contour probability (possible Bayesian counterpart of
a p-value) based on the MCMC posterior
sample for a univariate parameter corresponding to the equal-tail
credible interval.
</p>
<p>For details, see Bogaerts, Komárek and Lesaffre (201X, Sec. 9.1.4.2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contourProb(sample, theta0 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contourProb_+3A_sample">sample</code></td>
<td>
<p>a numeric vector with the MCMC sample from the posterior
distribution of a univariate parameter.
</p>
</td></tr>
<tr><td><code id="contourProb_+3A_theta0">theta0</code></td>
<td>
<p>a value of the parameter to which the contour
probability is to be related.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of the contour probability.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Bogaerts, K., Komárek, A. and Lesaffre, E. (201X).
<em>Survival Analysis with Interval-Censored Data: A Practical
Approach</em>.
Boca Raton: Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="Icens.html#topic+PGM">PGM</a></code>, <code><a href="interval.html#topic+ictest">ictest</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20170127)
sample &lt;- rnorm(1000, mean = 2, sd = 1)
contourProb(sample)
contourProb(sample, theta0 = 2)
</code></pre>

<hr>
<h2 id='fit.copula'>Function to fit a survival copula</h2><span id='topic+fit.copula'></span>

<h3>Description</h3>

<p>The function fits a survival copula (Clayton, Gaussian or
Plackett) to interval censored data
using a two-stage procedure. The marginal dsitributions are fitted
using an acceleated failure time model with a smoothed error
distribution as implemented in the smoothSurv package. The copula parameter may depend on covariates as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.copula(data, copula = "normal", init.param = NULL, cov = ~1,
           marginal1 = formula(data), logscale1 = ~1, lambda1 = exp(3:(-3)),
           marginal2 = formula(data), logscale2 = ~1, lambda2 = exp(3:(-3)),
           bootstrap = FALSE, nboot = 1000,
           control1 = smoothSurvReg.control(info = FALSE),
           control2 = smoothSurvReg.control(info = FALSE),
           seed = 12345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.copula_+3A_data">data</code></td>
<td>

<p>Data frame in which to interpret the variables occurring in the formula.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_copula">copula</code></td>
<td>

<p>A character string specifying the copula used to fit the model. Valid choices are &quot;normal&quot;, &quot;clayton&quot; or &quot;plackett&quot;.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_init.param">init.param</code></td>
<td>

<p>Optional vector of the initial values of the regression parameter(s) of the copula.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_cov">cov</code></td>
<td>

<p>A formula expression to determine a possible dependence of the copula parameter. For the Clayton and Plackett copula, the dependence will be modelled on the log-scale. For the normal copula, the dependence will be modelled modulo a Fisher transformation.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_marginal1">marginal1</code></td>
<td>

<p>A formula expression as for other regression models to be used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the first marginal. Use <code><a href="survival.html#topic+Surv">Surv</a></code> on the left hand side of the formula.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_logscale1">logscale1</code></td>
<td>

<p>A formula expression to determine a possible dependence of the log-scale in the first marginal on covariates. It is used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the first marginal.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_lambda1">lambda1</code></td>
<td>

<p>A vector of values of the tuning parameter <code class="reqn">\lambda</code> for the model of the first marginal. It is used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the first marginal.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_marginal2">marginal2</code></td>
<td>

<p>A formula expression as for other regression models to be used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the second marginal. Use <code><a href="survival.html#topic+Surv">Surv</a></code> on the left hand side of the formula.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_logscale2">logscale2</code></td>
<td>

<p>A formula expression to determine a possible dependence of the log-scale in the second marginal on covariates. It is used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the second marginal.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_lambda2">lambda2</code></td>
<td>

<p>A vector of values of the tuning parameter <code class="reqn">\lambda</code> for the model of the second marginal. It is used in a <code><a href="smoothSurv.html#topic+smoothSurvReg">smoothSurvReg</a></code> fit for the second marginal.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_bootstrap">bootstrap</code></td>
<td>

<p>If TRUE, a bootstrap is applied in order to determine the standard erros of the copula parameter(s).
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_nboot">nboot</code></td>
<td>

<p>The number of bootstrap samples to be used in case the bootstrap argument is TRUE.
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_control1">control1</code></td>
<td>

<p>A <code><a href="smoothSurv.html#topic+smoothSurvReg.control">smoothSurvReg.control</a></code> object which
determines the settings for the smoothSurv fit of the first
marginal.
</p>
</td></tr>  
<tr><td><code id="fit.copula_+3A_control2">control2</code></td>
<td>

<p>A <code><a href="smoothSurv.html#topic+smoothSurvReg.control">smoothSurvReg.control</a></code> object which
determines the settings for the smoothSurv fit of the first
marginal. 
</p>
</td></tr>
<tr><td><code id="fit.copula_+3A_seed">seed</code></td>
<td>
<p>seed for random numbers generator.</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>A list with elements <code>fit</code>, <code>variance</code>, <code>BScoefficients</code>, <code>BSresults</code>.
</p>


<h3>Author(s)</h3>

<p>Kris Bogaerts <a href="mailto:kris.bogaerts@kuleuven.be">kris.bogaerts@kuleuven.be</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Signal Tandmobiel study
### Plackett copula fitted to emergence times 
### of teeth 14 and 24, covariate = gender
data(tandmob, package = "icensBKL")
tand1424 &lt;- subset(tandmob,
  select = c("GENDER", "fGENDER", "L14", "R14", "L24", "R24"))
summary(tand1424)

T1424.plackett &lt;- fit.copula(tand1424,                             
   copula = "plackett", init.param = NULL, cov = ~GENDER,
   marginal1 = Surv(L14, R14, type = "interval2") ~ GENDER,
   logscale1 = ~GENDER, lambda1 = exp((-3):3),
   marginal2 = Surv(L24, R24, type = "interval2") ~ GENDER,
   logscale2 = ~GENDER, lambda2 = exp((-3):3),
   bootstrap = FALSE)
print(T1424.plackett)
    
</code></pre>

<hr>
<h2 id='graft'>Homograft's Survival Times</h2><span id='topic+graft'></span>

<h3>Description</h3>

<p>SOMETHING WILL COME HERE.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(graft)</code></pre>


<h3>Format</h3>

<p>a data frame with 301 rows (272 patients; 243 patients
contributing one observation, 29 patients contributiong two observations)
and the variables that can be divided into the following conceptual
groups:
</p>
<p><b>Identification of the patient and the homograft</b>
</p>

<dl>
<dt>idnr</dt><dd><p>identification number of a patient</p>
</dd>
<dt>Hsecond</dt><dd><p>0/1, equal to 1 if this is already the second homograft
(replacement) for a given patient
</p>
</dd>    
</dl>

<p><b>Time variable and censoring indicators</b>
</p>

<dl>
<dt>timeFU</dt><dd><p>follow-up time after the operation (years)</p>
</dd>
<dt>homo.repl.biod</dt><dd><p>0/1, value of 1 indicates that the homograft
failed after the time <code>timeFU</code>   
because of biodegeneration, that is for other reasons than
infection. Value of 0 indicates right censoring when considering
the failure of the homograft because of biodegeneration as event</p>
</dd>
<dt>homo.failure</dt><dd><p>0/1, value of 1 indicates that the homograft
failed after the time <code>timeFU</code> for various reasons.
Value of 0 indicates right censoring
when considering the failure of the homograft as event</p>
</dd>
<dt>death</dt><dd><p>0/1, value of 1 indicates death <code>timeFU</code> years
after the operation</p>
</dd>
</dl>

<p><b>Basic characteristics of the patients</b>
</p>

<dl>
<dt>age</dt><dd><p>age at operation (years)</p>
</dd>
<dt>gender</dt><dd><p>gender of the patient
</p>

<dl>
<dt>0 = <code>male</code>=</dt><dd><p>male</p>
</dd>
<dt>1 = <code>female</code>=</dt><dd><p>female</p>
</dd>
</dl>
  
</dd>
</dl>
  
<p><b>Description of diagnosis</b>
</p>

<dl>
<dt>clamp.time</dt><dd><p>a simple way how to reflect the diagnosis, cross-clamp time (min)</p>
</dd>
<dt>position</dt><dd>
<p>codes between grafts which are anatomically correctly (concordant)
and which are not correctly (discordant) placed. It has a close relationship to the diagnosis
</p>

<dl>
<dt>0 = <code>CONC</code> =</dt><dd><p>concordant</p>
</dd>
<dt>1 = <code>DISC</code> =</dt><dd><p>discordant</p>
</dd>
</dl>
  
</dd>
<dt>type</dt><dd>
<p>further distinguishes <em>discordant</em> grafts according to the <em>Truncus</em> status
</p>

<dl>
<dt>0 = <code>CONC</code> =</dt><dd><p>concordant</p>
</dd>
<dt>1 = <code>DISC</code> =</dt><dd><p>discordant, not Truncus</p>
</dd>
<dt>2 = <code>TRUNCUS</code> =</dt><dd><p>discordant, Truncus</p>
</dd>      
</dl>
  
</dd>  
<dt>Truncus</dt><dd>
<p>further distinguishes <em>discordant</em> grafts according to the <em>Truncus</em> status.
This variable is equal to 0 for all <em>concordant</em> grafts and
for all discordant, not Truncus grafts
</p>

<dl>
<dt>0 = <code>no</code> =</dt><dd><p>no</p>
</dd>
<dt>1 = <code>yes</code> =</dt><dd><p>yes</p>
</dd>
</dl>
  
</dd>
<dt>Ross</dt><dd>
<p>further distinguishes <em>concordant</em> grafts according to the <em>Ross</em> status.
This variable is also equal to 0 for all <em>discordant</em> grafts.      
</p>

<dl>
<dt>0 = <code>no</code> =</dt><dd><p>no</p>
</dd>
<dt>1 = <code>yes</code> =</dt><dd><p>yes</p>
</dd>
</dl>
  
</dd>
</dl>

<p><b>Features of the homografts</b>
</p>

<dl>
<dt>Hsize</dt><dd><p>size of the homograft (mm)</p>
</dd>
<dt>Hgraft</dt><dd>
<p>donor graft
</p>

<dl>
<dt>0 = <code>PH</code> =</dt><dd><p>pulmonary donor graft</p>
</dd>
<dt>1 = <code>AH</code> =</dt><dd><p>aortic donor graft</p>
</dd>
</dl>
  
</dd>
</dl>

<p><b>Immunological factors</b>
</p>

<dl>
<dt>BG.compatible</dt><dd>
<p>is the blood group compatible between recipient and donor?
</p>

<dl>
<dt>0 = <code>no</code> =</dt><dd><p>no</p>
</dd>
<dt>1 = <code>yes</code> =</dt><dd><p>yes</p>
</dd>
</dl>
  
</dd>
<dt>BG.recip</dt><dd>
<p>blood group of recipient
</p>

<dl>
<dt>0 = <code>0</code> =</dt><dd><p>0</p>
</dd>
<dt>1 = <code>A</code> =</dt><dd><p>A</p>
</dd>
<dt>1 = <code>B</code> =</dt><dd><p>B</p>
</dd>
<dt>2 = <code>AB</code> =</dt><dd><p>AB</p>
</dd>      
</dl>
  
</dd>
<dt>BG.donor</dt><dd>
<p>blood group of donor
</p>

<dl>
<dt>0 = <code>0</code> =</dt><dd><p>0</p>
</dd>
<dt>1 = <code>A</code> =</dt><dd><p>A</p>
</dd>
<dt>1 = <code>B</code> =</dt><dd><p>B</p>
</dd>
<dt>2 = <code>AB</code> =</dt><dd><p>AB</p>
</dd>      
</dl>
  
</dd>  
<dt>Rh.recip</dt><dd>
<p>Rhesus factor of recipient
</p>

<dl>
<dt>0 = <code>n</code> =</dt><dd><p>negative</p>
</dd>
<dt>1 = <code>p</code> =</dt><dd><p>positive</p>
</dd>
</dl>
  
</dd>
<dt>Rh.donor</dt><dd>
<p>Rhesus factor of donor
</p>

<dl>
<dt>0 = <code>n</code> =</dt><dd><p>negative</p>
</dd>
<dt>1 = <code>p</code> =</dt><dd><p>positive</p>
</dd>
</dl>
  
</dd>
<dt>Iwarm</dt><dd><p>warm ischemia (ischemic time) (hours)</p>
</dd>
<dt>Icold</dt><dd><p>cold ischemia (ischemic time) (days)</p>
</dd>    
</dl>
  


<h3>Source</h3>

<p>Department of Cardiac Surgery, University Hospital Gasthuisberg,
Herestraat 49, 3000 Leuven, Belgium
</p>


<h3>References</h3>

<p>Meyns, B., Jashari, R., Gewillig, M., Mertens, L., Kom<code class="reqn">\mbox{\'a}</code>rek, A.,
Lesaffre, E., Budts, W., and Daenen, W. (2005).
Factors influencing the survival of cryopreserved homografts. The
second homograft performs as well as the first.
<em>European Journal of Cardio-thoracic Surgery</em>, <b>28</b>, 211-216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("graft", package="icensBKL")
summary(graft)
</code></pre>

<hr>
<h2 id='hiv'>HIV Data on Hemophilia Patients</h2><span id='topic+hiv'></span>

<h3>Description</h3>

<p>The data arises from a 16-center prospective study in the 1980s on people with hemophilia for the purpose of investigating the
risk of HIV-1 infection on these people. The event of interest is the HIV-1 infection. Patients received either 
no or low-dose factor VIII concentrate. Times are recorded in quarters
and 0 represents January 1, 1978, the start of the epidemic and the time at which all patients are considered to be negative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hiv)</code></pre>


<h3>Format</h3>

<p>a data frame with 368 rows and the following variables
</p>

<dl>
<dt>id</dt><dd><p>patient identification number</p>
</dd>
<dt>low</dt><dd><p>lower limit of interval (lower,upper] that contains the
event of interest (quarters).</p>
</dd>
<dt>upp</dt><dd><p>upper limit of interval (lower,upper] that contains the
event of interest (quarters). It is <code>NA</code> for right-censored observations.</p>
</dd>
<dt>treat</dt><dd><p>treatment regimen
</p>

<dl>
<dt>0 = <code>no</code> =</dt><dd><p>no factor VIII concentrate</p>
</dd>
<dt>1 = <code>low dose</code> =</dt><dd><p>low-dose factor VIII concentrate</p>
</dd> 
</dl>

</dd>  
</dl>



<h3>Source</h3>

<p>Sun, J. (2006).
<em>The Statistical Analysis of Interval-censored Failure Time Data.</em>
New York: Springer. ISBN 978-0387-32905-5. Table A.2. 
</p>


<h3>References</h3>

<p>Goedert, J. J., Kessler, C. M., Aledort, L. M., Biggar, R. J.,
Andes, W. A., White, G. C., Drummond, J. E., Vaidya, K., Mann, D. L.,
Eyster, M. E. and et al. (1989).
A prospective study of human immunodeficiency virus type 1 infection
and the development of AIDS in subjects with hemophilia.
<em>The New England Journal of Medicine</em>, <b>321</b>, 
1141-1148.
</p>
<p>Kroner, B. L., Rosenberg, P. S., Aledort, L. M., Alvord, W. G., and Goedert, J. J. (1994)
HIV-1 infection incidence among persons with hemophilia in the United States and western Europe, 1978-1990.
Multicenter Hemophilia Cohort Study.
<em>Journal of Acquired Immune Deficiency Syndromes</em>, <b>7</b>, 
279-286.
</p>
<p>Sun, J. (2006).
<em>The Statistical Analysis of Interval-censored Failure Time Data.</em>
New York: Springer. ISBN 978-0387-32905-5. Section 3.4. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("hiv", package="icensBKL")
summary(hiv)
</code></pre>

<hr>
<h2 id='icbiplot'>
Interval-censored biplot
</h2><span id='topic+icbiplot'></span>

<h3>Description</h3>

<p>Principal Component Analysis for interval-censored data as described
in Cecere, Groenen and Lesaffre (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icbiplot(L, R, p = 2, MaxIter = 10000, tol = 1e-06, plotit = TRUE, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icbiplot_+3A_l">L</code></td>
<td>

<p>Matrix of dimension number of individuals/samples by number of variables with left endpoints of observed intervals.
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_r">R</code></td>
<td>

<p>Matrix of dimension number of individuals/samples by number of variables with right endpoints of observed intervals.
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_p">p</code></td>
<td>

<p>Dimension of the solution. Default value is <code class="reqn">p = 2</code>.
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_maxiter">MaxIter</code></td>
<td>

<p>Maximum number of iterations in the iterative minimazation algorithm
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_tol">tol</code></td>
<td>

<p>Tolerance when convergence is declared
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_plotit">plotit</code></td>
<td>

<p>Logical value. Default equals TRUE. A biplot in dimension 2 is plotted.
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_seed">seed</code></td>
<td>

<p>The seed for the random number generator. If NULL, current R system seed is used.
</p>
</td></tr>
<tr><td><code id="icbiplot_+3A_...">...</code></td>
<td>

<p>further arguments to be passed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following components
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>matrix of number of individuals times 2 (p) with coordinates representing the individuals</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>matrix of number of variables times 2 (p)  with coordinates representing the variables</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>matrix of number of individuals times number of variables with approximated events</p>
</td></tr>
<tr><td><code>DAF</code></td>
<td>
<p>Disperssion accounted for (DAF) index</p>
</td></tr>
<tr><td><code>FpV</code></td>
<td>
<p>matrix showing the fit per variable</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iterations performed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Silvia Cecere, port into icensBKL by Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Cecere, S., Groenen, P. J. F., and Lesaffre, E. (2013).
The interval-censored biplot.
<em>Journal of Computational and Graphical Statistics</em>,
<b>22</b>(1), 123-134.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("tandmob", package = "icensBKL")
Boys &lt;- subset(tandmob, fGENDER=="boy")
L &lt;- cbind(Boys$L14, Boys$L24, Boys$L34, Boys$L44)
R &lt;- cbind(Boys$R14, Boys$R24, Boys$R34, Boys$R44)
L[is.na(L)] &lt;- 0
R[is.na(R)] &lt;- 20    ## 20 = infinity in this case

icb &lt;- icbiplot(L, R, p = 2, MaxIter = 10000, tol = 1e-6,
                plotit = TRUE, seed = 12345) 
</code></pre>

<hr>
<h2 id='icsurv2cdf'>
Conversion of icsurv objects in a data.frame
</h2><span id='topic+icsurv2cdf'></span>

<h3>Description</h3>

<p>Convert an object of class <code>icsurv</code> (created by several functions
of the package <code>Icens</code> to a two-column <code>data.frame</code> that can
be easily used to plot the fitted distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icsurv2cdf(fit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icsurv2cdf_+3A_fit">fit</code></td>
<td>
<p>an object of class <code>icsurv</code>, typically obtained by one
of the functions   <code><a href="Icens.html#topic+EM">EM</a></code>,
<code><a href="Icens.html#topic+PGM">PGM</a></code>,
<code><a href="Icens.html#topic+VEM">VEM</a></code>,
<code><a href="Icens.html#topic+ISDM">ISDM</a></code>,
<code><a href="Icens.html#topic+EMICM">EMICM</a></code> of the package <code>Icens</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns labeled <code>time</code> and <code>cdf</code>.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>See Also</h3>

<p><code><a href="Icens.html#topic+EM">EM</a></code>,
<code><a href="Icens.html#topic+PGM">PGM</a></code>,
<code><a href="Icens.html#topic+VEM">VEM</a></code>,
<code><a href="Icens.html#topic+ISDM">ISDM</a></code>,
<code><a href="Icens.html#topic+EMICM">EMICM</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Distribution function of the emergence of tooth 44 on boys
### (this example: only a subset of boys)
data("tandmob", package="icensBKL")
Boys &lt;- subset(tandmob, fGENDER=="boy")
Sboy &lt;- Surv(Boys$L44, Boys$R44, type="interval2")

Aboy &lt;- subset(Boys, select=c("L44", "R44"))
Aboy$L44[is.na(Aboy$L44)] &lt;- 0
Aboy$R44[is.na(Aboy$R44)] &lt;- 20    ## 20 = infinity in this case
fitB.NPMLE &lt;- EMICM(Aboy)
print(fitB.NPMLE)
plot(fitB.NPMLE)

fitB.NPMLE &lt;- icsurv2cdf(fitB.NPMLE)
print(fitB.NPMLE)
plot(fitB.NPMLE$time, fitB.NPMLE$cdf, type="l", xlim=c(6, 13), ylim=c(0, 1),
     xlab="Age (years)", ylab="Proportion emerged")
</code></pre>

<hr>
<h2 id='kSampleIcens'>
Non-parametric comparison of k survival curves
</h2><span id='topic+kSampleIcens'></span>

<h3>Description</h3>

<p>Weighted log-rank tests for non-parametric comparison of <code class="reqn">k</code>
survival curves observed as interval-censored data.
It implements an interval-censored analog to well known
<code class="reqn">G^{\varrho,\gamma}</code> class of right-censored
<code class="reqn">k</code>-sample tests of Fleming and Harrington (1991, Chapter 7)
proposed by Gómez and Oller (2008) and described
also in Gómez et al. (2009, Sec. 3).
</p>
<p>This R implementation considerably exploited the example code
shown in Gómez et al. (2009, Sec. 3.3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kSampleIcens(A, group, icsurv, rho=0, gamma=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kSampleIcens_+3A_a">A</code></td>
<td>
<p>two column matrix or <code>data.frame</code> with lower and upper limits of observed intervals in a pooled sample.
It is passed to function <code><a href="Icens.html#topic+PGM">PGM</a></code>
from the <code>Icens</code> package which calculates the NPMLE of the
cdf function based on a pooled sample.
</p>
</td></tr>


<tr><td><code id="kSampleIcens_+3A_group">group</code></td>
<td>
<p>a vector of group indicators. Its length must be the same
as number of rows in <code>A</code> or as number of columns in <code>icsurv$clmat</code>.</p>
</td></tr>
<tr><td><code id="kSampleIcens_+3A_icsurv">icsurv</code></td>
<td>
<p>estimated cdf of based on a pooled sample. It must be an
object of class <code>icsurv</code> obtained by using the function
<code><a href="Icens.html#topic+PGM">PGM</a></code> with <code>A</code> matrix.
</p>
<p>It does not have to be supplied. Nevertheless, if supplied by the
user, it is not re-calculated inside the function call which spares
some computational time, especially if the test is to be run
with different <code class="reqn">\varrho</code> and
<code class="reqn">\gamma</code> values.
</p>
</td></tr>   


<tr><td><code id="kSampleIcens_+3A_rho">rho</code></td>
<td>
<p>parameter of the weighted log-rank (denoted as
<code class="reqn">\varrho</code> in Bogaerts, Komárek and Lesaffre (2017)).</p>
</td></tr>
<tr><td><code id="kSampleIcens_+3A_gamma">gamma</code></td>
<td>
<p>parameter of the weighted log-rank
(denoted as <code class="reqn">\gamma</code> in Bogaerts, Komárek and Lesaffre (2017))</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>An object of class <code>htest</code>.
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Fleming, T. R. and Harrington, D. P. (1991).
<em>Counting Processes and Survival Analysis</em>.
New York: Wiley.
</p>
<p>Gómez, G. and Oller Pique, R. (2008).
<em>A new class of rank tests for interval-censored data.</em>
Harvard University Biostatistics Working Paper Series, Working Paper 93.
<a href="https://biostats.bepress.com/harvardbiostat/paper93/">https://biostats.bepress.com/harvardbiostat/paper93/</a>
</p>
<p>Gómez, G., Calle, M. L., Oller, R., Langohr, K. (2009).
Tutorial on methods for interval-censored data and their
implementation in R.
<em>Statistical Modelling</em>, <b>9</b>, 259-297.
</p>
<p>Bogaerts, K., Komárek, A. and Lesaffre, E. (2017).
<em>Survival Analysis with Interval-Censored Data: A Practical
Approach</em>.
Boca Raton: Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="Icens.html#topic+PGM">PGM</a></code>, <code><a href="interval.html#topic+ictest">ictest</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Comparison of emergence distributions
##  of tooth 44 on boys and girls
data("tandmob", package="icensBKL")

  ## take only first 50 children here
  ## to decrease the CPU time
  ## of the example
tandmob50 &lt;- tandmob[1:50,]

  ## only needed variables
Acompare &lt;- subset(tandmob50, select=c("fGENDER", "L44", "R44"))

  ## left-censored observations:
  ##  change lower limit denoted by NA to 0
Acompare$L44[is.na(Acompare$L44)] &lt;- 0

  ## right-censored observations:
  ##  change upper limit denoted by NA to 20
  ##  20 = infinity in this case
Acompare$R44[is.na(Acompare$R44)] &lt;- 20

  ## inputs for kSampleIcens function
Amat &lt;- Acompare[, c("L44", "R44")]
Group &lt;- Acompare$fGENDER

  ## two-sample test
  ## (interval-censored version of classical Mantel's log-rank)
kSampleIcens(A=Amat, group=Group, rho=0, gamma=0)

  ## some other choices of rho and gamma,
  ## pooled CDF is supplied to kSampleIcens function
  ## to speed-up the calculation
  ## and also to set maxiter to higher value than above
  ## to ensure convergence
poolcdf &lt;- PGM(A=Amat, maxiter=10000)

  ## IC version of classical Mantel's log-rank again
kSampleIcens(A=Amat, group=Group, icsurv=poolcdf, rho=0, gamma=0)

  ## IC version of Peto-Prentice generalization of
  ## the Wilcoxon test
kSampleIcens(A=Amat, group=Group, icsurv=poolcdf, rho=1, gamma=0)

kSampleIcens(A=Amat, group=Group, icsurv=poolcdf, rho=0, gamma=1)
kSampleIcens(A=Amat, group=Group, icsurv=poolcdf, rho=1, gamma=1)
</code></pre>

<hr>
<h2 id='loglogistic'>
Log-logistic distribution
</h2><span id='topic+loglogistic'></span><span id='topic+dllogis'></span><span id='topic+pllogis'></span><span id='topic+qllogis'></span><span id='topic+rllogis'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random
generation for the log-logistic distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dllogis(x, shape, scale=1, log=FALSE)

pllogis(q, shape, scale=1, lower.tail=TRUE, log.p=FALSE)

qllogis(p, shape, scale=1, lower.tail=TRUE, log.p=FALSE)

rllogis(n, shape, scale=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglogistic_+3A_x">x</code>, <code id="loglogistic_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_shape">shape</code></td>
<td>
<p>the shape parameter <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_scale">scale</code></td>
<td>
<p>the scale parameter <code class="reqn">\alpha^{-1}</code>.</p>
</td></tr>  
<tr><td><code id="loglogistic_+3A_log">log</code>, <code id="loglogistic_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities <code>p</code> are
given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<code class="reqn">\mbox{P}(X\leq x)</code>, otherwise, <code class="reqn">\mbox{P}(X &gt; x)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Log-logistic distribution
<code class="reqn">\mbox{LL}(\alpha,\,\gamma)</code>
has a density
</p>
<p style="text-align: center;"><code class="reqn">f(x) =
    \displaystyle\frac{\alpha\gamma(\alpha\,x)^{\gamma-1}}{\bigl\{1 +
      (\alpha\,x)^{\gamma}\bigr\}^{2}},\quad x&gt;0,</code>
</p>

<p>and a distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x) =
      \displaystyle 1 - \frac{1}{(1 + (\alpha\,x)^\gamma)}, x&gt;0,</code>
</p>
  
<p>where <code class="reqn">\alpha</code> and <code class="reqn">\gamma</code> are positive
parameters (<code class="reqn">\alpha</code> is the inverse of the <code>scale</code> parameter and
<code class="reqn">\gamma</code> is the <code>shape</code> parameter).
The mean and the variance are given by
</p>
<p style="text-align: center;"><code class="reqn">
  \begin{array}{rcll}
  \mbox{E}X   &amp; \;=\; &amp; \displaystyle \frac{1}{\alpha}\,\frac{\pi}{\gamma\sin\bigl(\frac{\pi}{\gamma}\bigr)}, &amp;\quad \gamma &gt; 1, \\[4ex]
  \mbox{var}X &amp; \;=\; &amp; \displaystyle \frac{1}{\alpha^2}\,
                         \biggl\{\frac{2\pi}{\gamma\sin\bigl(\frac{2\pi}{\gamma}\bigr)}\,-\,
                                 \frac{\pi^2}{\gamma^2\sin^2\bigl(\frac{\pi}{\gamma}\bigr)}\biggr\},
         &amp;\quad \gamma &gt; 2, \\[4ex]
  \end{array}
  </code>
</p>
  


<h3>Value</h3>

<p><code>dllogis</code> gives the density,
<code>pllogis</code> gives the distribution function,
<code>qllogis</code> gives the quantile function,
and <code>rllogis</code> generates random deviates.  
</p>


<h3>Author(s)</h3>

<p>Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Logistic">Logistic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1977)
print(x &lt;- rllogis(10, shape=3, scale=5))
print(d &lt;- dllogis(x, shape=3, scale=5))
print(p &lt;- pllogis(x, shape=3, scale=5))
qllogis(p, shape=3, scale=5)
</code></pre>

<hr>
<h2 id='mastitis'>Data on Mastitis in Dairy Cattle</h2><span id='topic+mastitis'></span>

<h3>Description</h3>

<p>Mastitis in dairy cattle is the inflammation of the udder and the most
important disease in the dairy sector of the western world. Mastitis
reduces the milk production and the quality of the milk. For this
mastitis study, 100 cows were included into the study from the time of parturition (assumed to be free of infection). They were screened
monthly at the udder-quarter level for bacterial infections. Since the
udder quarters are separated, one quarter might be infected while other
quarters remain free of infection. The cows were  followed up until the
end of the lactation period, which lasted approximately 300 to 350
days. Some cows were lost to follow-up, due to, e.g. culling. Because of
the approximately monthly follow-up (except during July/August for which
only one visit was planned due to lack of personnel), data are interval
censored. Right censored data are present when no infection occurred
before the end of the lactation period or the lost to follow up time. As visits were planned independently of infection times, independent noninformative censoring is a valid assumption.
</p>
<p>Two covariates were recorded. The first is the number of calvings, i.e.,
parity. This is a categorical cow-level covariate with the following
categories: (1) one calving, (2) 2 to 4 calvings and (3) more than 4
calvings and is also represented by two dummy variables (representing classes
2 and 3). The second covariate is the position of the udder quarter
(front or rear). Both variables have been suggested in the literature to
impact the incidence of mastitis (Weller et al., 1992; Adkinson et al., 1993).
</p>
<p>Date are adopted from Goethal et al. (2009). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mastitis)</code></pre>


<h3>Format</h3>

<p>a data frame with 400 rows and the following variables
</p>

<dl>
<dt>cow</dt><dd><p>identification number of the cow.</p>
</dd>
<dt>frear</dt><dd><p><code>factor</code> indication of the location of the udder (<code>front</code>/<code>rear</code>.)
</p>
</dd>    
<dt>rear</dt><dd><p>indication of the location of the udder, 0 =
<code>front</code>, 1 = <code>rear</code>.
</p>
</dd>
<dt>fpar</dt><dd><p><code>factor</code> variable indicating parity (<code>1</code>/<code>2-4</code>/<code>&gt;4</code>.)
</p>
</dd>        
<dt>par1</dt><dd><p>dummy variable for a parity of 1.</p>
</dd>
<dt>par24</dt><dd><p>dummy variable for a parity of 2 to 4.</p>
</dd>
<dt>par56</dt><dd><p>dummy variable for a parity of <code class="reqn">&gt;</code>4.</p>
</dd>
<dt>ll</dt><dd><p>lower limit of interval <code class="reqn">(</code>lower, upper<code class="reqn">]</code>
that contains time of infection.</p>
</dd>
<dt>ul</dt><dd><p>upper limit of interval <code class="reqn">(</code>lower, upper<code class="reqn">]</code> that contains time of infection.</p>
</dd>    
<dt>censor</dt><dd><p>censor indicator,
0 = right-censored, 1 = interval-censored.
Left-censored observations have a missing value in the lower limit
(<code>ll</code>). Right-censored observations have a missing value in
the upper limit (<code>ul</code>).
</p>
</dd>        
</dl>



<h3>Source</h3>

<p>Goethals, K., Ampe, B., Berkvens, D., Laevens, H., Janssen, P. and
Duchateau, L. (2009). Modeling interval-censored, clustered cow udder
quarter infection times through the shared gamma frailty
model. <em>Journal of Agricultural, Biological, and Environmental
Statistics</em>, <b>14</b>(1), 1-14.
</p>


<h3>References</h3>

<p>Adkinson, R. W., Ingawa, K. H., Blouin, D. C., and Nickerson, S. C. (1993).
Distribution of clinical mastitis among quarters of the bovine udder.
<em>Journal of Dairy Science</em>, <b>76</b>(11), 3453-3459.
</p>
<p>Goethals, K., Ampe, B., Berkvens, D., Laevens, H., Janssen, P., and
Duchateau, L. (2009). Modeling interval-censored, clustered cow udder
quarter infection times through the shared gamma frailty
model. <em>Journal of Agricultural, Biological, and Environmental
Statistics</em>, <b>14</b>(1), 1-14.
</p>
<p>Weller, J. I., Saran, A., and Zeliger, Y. (1992). Genetic and environmental
relationships among somatic cell count, bacterial infection, and clinical
mastitis. <em>Journal of Dairy Science</em>, <b>75</b>(9), 2532-2540.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mastitis", package="icensBKL")
summary(mastitis)
</code></pre>

<hr>
<h2 id='mobile'>Survey on Mobile Phone Purchases</h2><span id='topic+mobile'></span>

<h3>Description</h3>

<p>In February 2013 a survey on mobile phone purchases was held among 15 to
79 years old owners of a mobile phone in Finland. The participants were
randomly sampled from a publicly available phone number directory by
setting quotas in the gender, age and region of the respondents. A total
of 536 completed interviews were recorded using a computer-assisted
telephone interview (CATI) system. The amount of female owners but also
15-24 years old owners were underrepresented in the data while male and
65-79 years old owners were overrepresented in the study compared to the
2012 Finnish official statistics. The respondents answered several
questions about the purchase of their current and previous mobile phone
and reported also some family characteristics. More details about the
survey may be found in Karvanen et al. (2014).
</p>
<p>The purchase times are interval censored because only the month and not
the day of purchase was asked. In addition, many respondents could not
recall the time of purchase. For their current phone, 310 respondents
were able to report the month and year of the purchase, an additional
115 were able to provide the season and year and 37 were not able to
recall even the year.  Out of 517 respondents who answered the questions
about their previous phone, 117 were able to report the purchase month
and year, an additional 91 were able to report the season and year, 146
provided only the year and 163 were not able to recall even the year. A
maximum purchase interval of 200 months is assumed when the purchase
year is missing. Three respondents who reported their previous phone to
have bought after their current phone, 30 respondents for whom the
purchase intervals of their previous and current phone are completely
overlapping and 6 respondents who did not report their household size
were excluded from the analysis.
</p>
<p>The dataset shown here includes 478 respondents who correctly reported to have had a previous phone and have non-overlapping intervals for the purchase times of the previous and current phone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mobile)</code></pre>


<h3>Format</h3>

<p>a data frame with 478 rows and the following variables
</p>

<dl>
<dt>dPLL</dt><dd><p>lower limit purchase date of the previous phone.</p>
</dd>
<dt>dPUL</dt><dd><p>upper limit purchase date of the previous phone.</p>
</dd>    
<dt>dCLL</dt><dd><p>lower limit purchase date of the current phone.</p>
</dd>
<dt>dCUL</dt><dd><p>upper limit purchase date of the current phone.</p>
</dd>
<dt>PLL</dt><dd><p>numeric lower limit purchase date of the previous phone
(0 <code class="reqn">=</code> January 1, 1992)</p>
</dd>
<dt>PUL</dt><dd><p>numeric upper limit purchase date of the previous phone.</p>
</dd>    
<dt>CLL</dt><dd><p>numeric lower limit purchase date of the current phone.</p>
</dd>
<dt>CUL</dt><dd><p>numeric upper limit purchase date of the current phone.</p>
</dd>
<dt>gender</dt><dd><p>gender (0 <code class="reqn">=</code> <em>male</em>, 1 <code class="reqn">=</code> <em>female</em>).</p>
</dd>
<dt>fgender</dt><dd><p><code>factor</code> derived from <code>gender</code>.</p>
</dd>    
<dt>agegrp</dt><dd><p>age group (1 <code class="reqn">=</code> 15-24 years, 2 <code class="reqn">=</code> 25-34
years, 3 <code class="reqn">=</code> 35-44 years, 4 <code class="reqn">=</code> 45-54 years, 5 <code class="reqn">=</code>
55-64 years, 6 <code class="reqn">=</code> 65-79 years).</p>
</dd>
<dt>fagegrp</dt><dd><p><code>factor</code> derived from <code>agegrp</code>.</p>
</dd>
<dt>hhsize</dt><dd><p>size of household (1 <code class="reqn">=</code> 1 person, 2 <code class="reqn">=</code> 2
persons, 3 <code class="reqn">=</code> 3 persons, 4 <code class="reqn">=</code> 4 persons, 5 <code class="reqn">=</code> 5
persons or more).</p>
</dd>
<dt>fhhsize</dt><dd><p><code>factor</code> derived from <code>hhsize</code>.</p>
</dd>
<dt>income</dt><dd><p>household income before taxes (1 <code class="reqn">=</code> 30 000 EUR or
less, 2 <code class="reqn">=</code> 30 001-50 000 EUR, 3 <code class="reqn">=</code> 50 001-70 000 EUR, 4
<code class="reqn">=</code> more than 70 000 EUR, 5 <code class="reqn">=</code> No answer).</p>
</dd>
<dt>fincome</dt><dd><p><code>factor</code> derived from <code>income</code>.</p>
</dd>
</dl>
  


<h3>Source</h3>

<p><a href="https://jyx.jyu.fi/handle/123456789/77334/">https://jyx.jyu.fi/handle/123456789/77334/</a>
</p>


<h3>References</h3>

<p>Karvanen, J., Rantanen, A., and Luoma, L. (2014). Survey data and Bayesian
analysis: A cost-efficient way to estimate customer equity. <em>Quantitative
Marketing and Economics</em>, <b>12</b>(3), 305-329.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mobile", package="icensBKL")
summary(mobile)
</code></pre>

<hr>
<h2 id='normal.copula'>Cumulative density function of the normal copula</h2><span id='topic+normal.copula'></span>

<h3>Description</h3>

<p>Cumulative density function of the normal copula evaluated at points
(u,v) with given parameter exp(beta %*%cov)</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal.copula(u, v, beta, cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal.copula_+3A_u">u</code></td>
<td>
<p>vector of points in [0,1] representing the first coordinate where the normal copula must be evaluated</p>
</td></tr>
<tr><td><code id="normal.copula_+3A_v">v</code></td>
<td>
<p>vector of points in [0,1] representing the second coordinate where the normal copula must be evaluated</p>
</td></tr>
<tr><td><code id="normal.copula_+3A_beta">beta</code></td>
<td>
<p>vector of coefficients to be multiplied with the covariates in order to determine the parameter of the normal copula</p>
</td></tr>
<tr><td><code id="normal.copula_+3A_cov">cov</code></td>
<td>
<p>vector of covariates to be multipleid with the coefficients in order to determine the parameter of the normal copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cumulative density function of the normal copula evaluated at
points (u,v) with given parameter exp(beta %*%cov)</p>


<h3>Note</h3>

<p>This is not to be called by the user.</p>


<h3>Author(s)</h3>

<p>Kris Bogaerts <a href="mailto:kris.bogaerts@kuleuven.be">kris.bogaerts@kuleuven.be</a>
</p>


<h3>References</h3>

<p>Nelsen, R. B. (1998). <em>An Introduction to Copulas</em>. Lecture Notes in Statistics 139. Springer-Verlag, New-York.
</p>

<hr>
<h2 id='NPbayesSurv'>
Bayesian non-parametric estimation of a survival curve
with right-censored data
</h2><span id='topic+NPbayesSurv'></span>

<h3>Description</h3>

<p>Bayesian non-parametric estimation of a survival curve for
right-censored data as proposed by Susarla and Van Ryzin (1976, 1978)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPbayesSurv(time, censor,
  choice = c("exp", "weibull", "lnorm"), c = 1, parm,
  xlab = "Time", ylab = "Survival Probability", maintitle = "",
  cex.lab = 1.2, cex.axis = 1.0, cex.main = 1.5, cex.text = 1.2, lwd = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPbayesSurv_+3A_time">time</code>, <code id="NPbayesSurv_+3A_censor">censor</code></td>
<td>
<p>numeric vectors with (right-censored) survival
times and 0/1 censoring indicators (1 for event, 0 for censored)
</p>
</td></tr>  
<tr><td><code id="NPbayesSurv_+3A_choice">choice</code></td>
<td>
<p>a character string indicating the initial guess
(<code class="reqn">S^*</code>) of the survival distribution
</p>
</td></tr>
<tr><td><code id="NPbayesSurv_+3A_c">c</code></td>
<td>
<p>parameter of the Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="NPbayesSurv_+3A_parm">parm</code></td>
<td>
<p>a numeric vector of parameters for the initial guess:
<code>rate</code> parameter for exponential (see also
<code><a href="stats.html#topic+Exponential">Exponential</a></code>), a two-element vector with <code>shape</code>
and <code>scale</code> parameters for weibull (see also
<code><a href="stats.html#topic+Weibull">Weibull</a></code>), a two-element vector with
<code>meanlog</code> and <code>sdlog</code> parameters for log-normal (see also
<code><a href="stats.html#topic+Lognormal">Lognormal</a></code>). If not given, parameters for the
initial guess are taken from the ML fit</p>
</td></tr>
<tr><td><code id="NPbayesSurv_+3A_xlab">xlab</code>, <code id="NPbayesSurv_+3A_ylab">ylab</code></td>
<td>
<p>labels for axes of the plot
</p>
</td></tr>
<tr><td><code id="NPbayesSurv_+3A_maintitle">maintitle</code></td>
<td>
<p>text for the main title
</p>
</td></tr>
<tr><td><code id="NPbayesSurv_+3A_cex.lab">cex.lab</code>, <code id="NPbayesSurv_+3A_cex.axis">cex.axis</code>, <code id="NPbayesSurv_+3A_cex.main">cex.main</code>, <code id="NPbayesSurv_+3A_cex.text">cex.text</code>, <code id="NPbayesSurv_+3A_lwd">lwd</code></td>
<td>
<p>graphical parameters
</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>A vector corresponding to the <code>parm</code> argument
</p>


<h3>Author(s)</h3>

<p>Emmanuel Lesaffre <a href="mailto:emmanuel.lesaffre@kuleuven.be">emmanuel.lesaffre@kuleuven.be</a>,
Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Susarla, V. and Van Ryzin, J. (1976).
Nonparametric Bayesian estimation of survival curves from incomplete
observations. 
<em>Journal of the American Statistical Association</em>, <b>71</b>(356), 897-902.
</p>
<p>Susarla, V. and Van Ryzin, J. (1978).
Large sample theory for a Bayesian nonparametric survival curve
estimator based on censored samples. 
<em>The Annals of Statistics</em>, <b>6</b>(4), 755-768.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Nonparametric Bayesian estimation of a survival curve
## Homograft study, aortic homograft patients
data("graft", package = "icensBKL")

graft.AH &lt;- subset(graft, Hgraft == "AH") # aortic homograft patients
time &lt;- graft$timeFU[graft$Hgraft == "AH"]
censor &lt;- graft$homo.failure[graft$Hgraft == "AH"]

  ## Initial guess: Weibull, c = 0.1 and 100
oldpar &lt;- par(mfrow = c(1, 2))
NPbayesSurv(time, censor, "weibull", c = 100,
   xlab = "Follow-up time since the operation (years)", maintitle = "c = 100")
NPbayesSurv(time, censor, "weibull", c = 100,
   xlab = "Follow-up time since the operation (years)", maintitle = "c = 100")
par(oldpar)

  ## Initial guess: Exponential, c = 100
oldpar &lt;- par(mfrow = c(1, 1))
NPbayesSurv(time, censor, "exp", c = 100,
   xlab = "Follow-up time since the operation (years)", maintitle = "Exp: c = 100")

  ## Initial guess: Log-normal, c = 100
NPbayesSurv(time, censor, "lnorm", c = 100,
   xlab = "Follow-up time since the operation (years)", maintitle = "Log-Normal: c = 100")
par(oldpar)
</code></pre>

<hr>
<h2 id='NPICbayesSurv'>
Bayesian non-parametric estimation of a survival curve
with interval-censored data
</h2><span id='topic+NPICbayesSurv'></span>

<h3>Description</h3>

<p>Bayesian non-parametric estimation of a survival curve for
right-censored data as proposed by Susarla and Van Ryzin (1976, 1978)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPICbayesSurv(low, upp, 
  choice = c("exp", "weibull", "lnorm"), cc, parm,
  n.sample = 5000, n.burn = 5000, cred.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPICbayesSurv_+3A_low">low</code></td>
<td>
<p>lower limits of observed intervals with <code>NA</code> if left-censored</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_upp">upp</code></td>
<td>
<p>upper limits of observed intervals with <code>NA</code> if
right-censored</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_choice">choice</code></td>
<td>
<p>a character string indicating the initial guess
(<code class="reqn">S^*</code>) of the survival distribution
</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_cc">cc</code></td>
<td>
<p>parameter of the Dirichlet process prior
</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_parm">parm</code></td>
<td>
<p>a numeric vector of parameters for the initial guess:
<code>rate</code> parameter for exponential (see also
<code><a href="stats.html#topic+Exponential">Exponential</a></code>), a two-element vector with <code>shape</code>
and <code>scale</code> parameters for weibull (see also
<code><a href="stats.html#topic+Weibull">Weibull</a></code>), a two-element vector with
<code>meanlog</code> and <code>sdlog</code> parameters for log-normal (see also
<code><a href="stats.html#topic+Lognormal">Lognormal</a></code>). If not given, parameters for the
initial guess are taken from the ML fit</p>
</td></tr>   
<tr><td><code id="NPICbayesSurv_+3A_n.sample">n.sample</code></td>
<td>
<p>number of iterations of the Gibbs sampler after the burn-in</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_n.burn">n.burn</code></td>
<td>
<p>length of the burn-in</p>
</td></tr>
<tr><td><code id="NPICbayesSurv_+3A_cred.level">cred.level</code></td>
<td>
<p>credibility level of calculated pointwise credible intervals
for values of the survival function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with the following components
</p>

<dl>
<dt>S</dt><dd><p>a <code>data.frame</code> with columns: <code>t</code> (time points),
<code>S</code> (posterior mean of the value of the survival function at
<code>t</code>), <code>Lower, Upper</code> (lower and upper bound of the
pointwise credible interval for the value of the survival function)</p>
</dd>
<dt>t</dt><dd><p>grid of time points (excluding an &ldquo;infinity&rdquo; value)</p>
</dd>
<dt>w</dt><dd><p>a matrix with sampled weights</p>
</dd>
<dt>n</dt><dd><p>a matrix with sampled values of <code class="reqn">n</code></p>
</dd>
<dt>Ssample</dt><dd><p>a matrix with sampled values of the survival function</p>
</dd>
<dt>c</dt><dd><p>parameter of the Dirichlet process prior which was used</p>
</dd>
<dt>choice</dt><dd><p>character indicating the initial guess</p>
</dd>
<dt>parm</dt><dd><p>parameters of the initial guess</p>
</dd>
<dt>n.burn</dt><dd><p>length of the burn-in</p>
</dd>
<dt>n.sample</dt><dd><p>number of sampled values</p>
</dd>            
</dl>
    


<h3>Author(s)</h3>

<p>Emmanuel Lesaffre <a href="mailto:emmanuel.lesaffre@kuleuven.be">emmanuel.lesaffre@kuleuven.be</a>,
Arnošt Komárek <a href="mailto:arnost.komarek@mff.cuni.cz">arnost.komarek@mff.cuni.cz</a>
</p>


<h3>References</h3>

<p>Calle, M. L. and Gómez, G. (2001).
Nonparametric Bayesian estimation from interval-censored data using
Monte Carlo methods. 
<em>Journal of Statistical Planning and Inference</em>, <b>98</b>(1-2), 73-87.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Breast Cancer study (radiotherapy only group)
## Dirichlet process approach to estimate nonparametrically
## the survival distribution with interval-censored data
data("breastCancer", package = "icensBKL")
breastR &lt;- subset(breastCancer, treat == "radio only", select = c("low", "upp"))

### Lower and upper interval limit to be used here
low &lt;- breastR[, "low"]
upp &lt;- breastR[, "upp"]

### Common parameters for sampling
### (quite low, only for testing)
n.sample &lt;- 100
n.burn &lt;- 100

### Gibbs sampler
set.seed(19680821)
Samp &lt;- NPICbayesSurv(low, upp, choice = "weibull", n.sample = n.sample, n.burn = n.burn)

print(ncol(Samp$w))         ## number of supporting intervals
print(nrow(Samp$S))         ## number of grid points (without "infinity")
print(Samp$S[, "t"])        ## grid points (without "infinity")
print(Samp$t)               ## grid points (without "infinity")
print(Samp$S)               ## posterior mean and pointwise credible intervals

print(Samp$w[1:10,])         ## sampled weights (the first 10 iterations)
print(Samp$n[1:10,])         ## sampled latend vectors (the first 10 iterations)
print(Samp$Ssample[1:10,])   ## sampled S (the first 10 iterations)

print(Samp$parm)     ## parameters of the guess

### Fitted survival function including pointwise credible bands
ngrid &lt;- nrow(Samp$S)

plot(Samp$S[1:(ngrid-1), "t"], Samp$S[1:(ngrid-1), "Mean"], type = "l",
     xlim = c(0, 50), ylim = c(0, 1), xlab = "Time", ylab = expression(hat(S)(t)))
polygon(c(Samp$S[1:(ngrid-1), "t"], Samp$S[(ngrid-1):1, "t"]),
        c(Samp$S[1:(ngrid-1), "Lower"], Samp$S[(ngrid-1):1, "Upper"]),
        col = "grey95", border = NA)
lines(Samp$S[1:(ngrid - 1), "t"], Samp$S[1:(ngrid - 1), "Lower"], col = "grey", lwd = 2)
lines(Samp$S[1:(ngrid - 1), "t"], Samp$S[1:(ngrid - 1), "Upper"], col = "grey", lwd = 2)
lines(Samp$S[1:(ngrid - 1), "t"], Samp$S[1:(ngrid - 1), "Mean"], col = "black", lwd = 3)
</code></pre>

<hr>
<h2 id='plackett.copula'>Cumulative density function of the Plackett copula</h2><span id='topic+plackett.copula'></span>

<h3>Description</h3>

<p>Cumulative density function of the Plackett copula evaluated at points
(u,v) with given parameter exp(beta %*%cov)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plackett.copula(u, v, beta, cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plackett.copula_+3A_u">u</code></td>
<td>
<p>vector of points in [0,1] representing the first coordinate where the Plackett copula must be evaluated</p>
</td></tr>
<tr><td><code id="plackett.copula_+3A_v">v</code></td>
<td>
<p>vector of points in [0,1] representing the second coordinate where the Plackett copula must be evaluated</p>
</td></tr>
<tr><td><code id="plackett.copula_+3A_beta">beta</code></td>
<td>
<p>vector of coefficients to be multiplied with the covariates in order to determine the parameter of the Plackett copula</p>
</td></tr>
<tr><td><code id="plackett.copula_+3A_cov">cov</code></td>
<td>
<p>vector of covariates to be multipleid with the coefficients in order to determine the parameter of the Plackett copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cumulative density function of the Plackett copula evaluated at
points (u,v) with given parameter exp(beta %*%cov)</p>


<h3>Note</h3>

<p>This is not to be called by the user.</p>


<h3>Author(s)</h3>

<p>Kris Bogaerts <a href="mailto:kris.bogaerts@kuleuven.be">kris.bogaerts@kuleuven.be</a>
</p>


<h3>References</h3>

<p>R. L. Plackett (1965).
A class of bivariate distributions. <em>Journal of the American Statistical Association</em>, <b>60</b>, 516-522.
</p>

<hr>
<h2 id='survfitS.smoothSurvReg'>
Survivor function for Objects of Class 'smoothSurvReg'
</h2><span id='topic+survfitS.smoothSurvReg'></span>

<h3>Description</h3>

<p>Compute survivor function at left and right endpoint based on the fitted model.
The function is an adapted version of the survfit.smoothSurvReg function of the package smoothSurv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survfitS.smoothSurvReg(formula, cov, logscale.cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survfitS.smoothSurvReg_+3A_formula">formula</code></td>
<td>

<p>Object of class smoothSurvReg.
</p>
</td></tr>
<tr><td><code id="survfitS.smoothSurvReg_+3A_cov">cov</code></td>
<td>

<p>Vector or matrix with covariates values for which the survivor function
is to be computed. It must be a matrix with as many columns as
is the number of covariates (interactions included) or the vector of length
equal to the number of covariates (interactions included). Intercept is not
to be included in <code>cov</code>. If <code>cov</code> is missing  a survivor curve
for the value of a covariate vector equal to zero is calculated.
</p>
</td></tr>
<tr><td><code id="survfitS.smoothSurvReg_+3A_logscale.cov">logscale.cov</code></td>
<td>

<p>Vector or matrix with covariate values for the expression of log-scale
(if this depended on covariates).
It can be omitted in the case that log-scale was common for all observations. 
</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns named <code>S1</code> and <code>S2</code> containing the value of survivor function at the left and right endpoints, respectively.
</p>


<h3>Note</h3>

<p>This is not to be called by the user.</p>


<h3>Author(s)</h3>

<p>Kris Bogaerts <a href="mailto:kris.bogaerts@kuleuven.be">kris.bogaerts@kuleuven.be</a>
</p>

<hr>
<h2 id='tandmob'>Signal Tandmobiel Data, Subsample</h2><span id='topic+tandmob'></span>

<h3>Description</h3>

<p>This is a random sample of 500 children (256 boys and 244 girls) from
the dataset resulting from a longitudinal prospective dental
study performed in Flanders (North of Belgium) in 1996 &ndash; 2001. The
cohort of 4 468 randomly sampled children who attended the first year
of the basic school at the beginning of the study was annualy dental
examined by one of 16 trained dentists.
The original dataset consists thus of at most 6 dental observations
for each child.
</p>
<p>The dataset presented here contains mainly the
information on the emergence and caries times summarized in the
interval-censored observations.
In addition to the interval censored observation of the emergence time
of several teeth, a random visit was selected in order to create
current status data of the emergence times for the same children. Also
the time to caries of the four permanent first molars are included in
the data set. Finally, the covariates gender, frequency of brushing,
the presence of sealants and occlusal plaque on the first permanent
molars collected in the first year were included as potential
confounders in the data set. 
</p>
<p>For more detail on the design of the study see Vanobbergen et
al. (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tandmob)</code></pre>


<h3>Format</h3>

<p>a data frame with 500 rows and the following
variables
</p>

<dl>
<dt>IDNR</dt><dd><p>identification number of a child.</p>
</dd>
<dt>GENDER</dt><dd><p>numeric gender; 0=boy, 1=girl.</p>
</dd>
<dt>fGENDER</dt><dd><p>factor derived from a variable <code>GENDER</code>.</p>
</dd>
<dt>DMF_1</dt><dd><p>dmft-score at baseline around the age of 7 years.</p>
</dd>
<dt>OH16o, OH26o, OH36o, OH46o</dt><dd><p>numeric occlusal plaque status of teeth
16, 26, 36, 46 (permanent first molars); 0=no plaque, 1=pits/fissures, 2=total.</p>
</dd>
<dt>fOH16o, fOH26o, fOH36o, fOH46o</dt><dd><p>factors derived from variables
<code>OH16o, OH26o, OH36o, OH46o</code>.</p>
</dd>
<dt>BRUSHING</dt><dd><p>numeric brushing frequency at baseline;
0=less than daily, 1=at least once a day.</p>
</dd>
<dt>fBRUSHING</dt><dd><p>factor derived from a variable <code>BRUSHING</code>.</p>
</dd>
<dt>SEAL16, SEAL26, SEAL36, SEAL46</dt><dd><p>numeric baseline presence of sealing on
teeth 16, 26, 36, 46 (permanent first molars); 0=no, 1=yes.</p>
</dd>
<dt>fSEAL16, fSEAL26, fSEAL36, fSEAL46</dt><dd><p>factors derived from
variables <code>SEAL16, SEAL26, SEAL36, SEAL46</code>.</p>
</dd>
<dt>DMF_54, DMF_64, DMF_74, DMF_84</dt><dd><p>numeric
baseline dmft score of teeth 54, 64, 74, 84 (primary first molars);
0=sound, 1=caries experience.</p>
</dd>
<dt>DMF_55, DMF_65, DMF_75, DMF_85</dt><dd><p>numeric
baseline dmft score of teeth 55, 65, 75, 85 (primary second molars);
0=sound, 1=caries experience.</p>
</dd>    
<dt>fDMF_54, fDMF_64, fDMF_74, fDMF_84</dt><dd><p>factors
derived from variables <code>DMF_54, DMF_64, DMF_74, DMF_84</code>.</p>
</dd>
<dt>fDMF_55, fDMF_65, fDMF_75, fDMF_85</dt><dd><p>factors
derived from variables <code>DMF_55, DMF_65, DMF_75, DMF_85</code>.</p>
</dd>    
<dt>L14, L24, L34, L44</dt><dd><p>left (lower) limit of observed emergence time of teeth 14, 24,
34, 44 (permanent first premolars), <code>NA</code> for left-censored observations.</p>
</dd>
<dt>R14, R24, R34, R44</dt><dd><p>right (upper) limit of observed emergence time of teeth 14, 24,
34, 44 (permanent first premolars), <code>NA</code> for right-censored observations.</p>
</dd>
<dt>L15, L25, L35, L45</dt><dd><p>left (lower) limit of observed emergence time of teeth 15, 25,
35, 45 (permanent second premolars), <code>NA</code> for left-censored observations.</p>
</dd>
<dt>R15, R25, R35, R45</dt><dd><p>right (upper) limit of observed emergence time of teeth 15, 25,
35, 45 (permanent second premolars), <code>NA</code> for right-censored observations.</p>
</dd>
<dt>L16, L26, L36, L46</dt><dd><p>left (lower) limit of observed emergence time of teeth 16, 26,
36, 46 (permanent first molars), <code>NA</code> for left-censored observations.</p>
</dd>
<dt>R16, R26, R36, R46</dt><dd><p>right (upper) limit of observed emergence time of teeth 16, 26,
36, 46 (permanent first molars), <code>NA</code> for right-censored observations.</p>
</dd>
<dt>CS_age</dt><dd><p>age at visit selected to determine current status.</p>
</dd>
<dt>CS_14, CS_24, CS_34, CS_44</dt><dd><p>numeric current status of teeth 14, 24,
34, 44 (permanent first premolars) at age given by variable
<code>CS_age</code>; 0=not emerged, 1=emerged.</p>
</dd>
<dt>fCS_14, fCS_24, fCS_34, fCS_44</dt><dd><p>factors derived from variables
<code>CS_14, CS_24, CS_34, CS_44</code>.</p>
</dd>
<dt>CL16, CL26, CL36, CL46</dt><dd><p>left (lower) limit of observed time to
caries of teeth 16, 26, 36, 46 (permanent first molars), <code>NA</code> for left-censored observations.</p>
</dd>
<dt>CR16, CR26, CR36, CR46</dt><dd><p>right (upper) limit of observed time
to caries of teeth 16, 26, 36, 46 (permanent first molars), <code>NA</code> for right-censored observations.</p>
</dd>    
</dl>



<h3>Source</h3>


<p>Leuven Biostatistics and Statistical Bioinformatics Centre (L-Biostat),
Katholieke Universiteit Leuven,
Kapucijnenvoer 35, 3000 Leuven, Belgium
</p>
<p><code>URL:</code> <code>http://med.kuleuven.be/biostat/</code>
</p>
<p>Data collection was supported by Unilever, Belgium.
The Signal Tandmobiel project comprises the following partners:
D. Declerck (Dental School, Catholic University Leuven),
L. Martens (Dental School, University Ghent),
J. Vanobbergen (Oral Health Promotion and Prevention, Flemish Dental Association),
P. Bottenberg (Dental School, University Brussels),
E. Lesaffre (Biostatistical Centre, Catholic University Leuven),
K. Hoppenbrouwers (Youth Health Department, Catholic University Leuven; Flemish Association for Youth Health Care).  
</p>


<h3>References</h3>

<p>Carvalho, J. C., Ekstrand, K. R., and Thylstrup, A. (1989).
Dental plaque and caries on occlusal surfaces of first permanent
molars in relation to stage of eruption.
<em>Journal of Dental Research</em>, <b>68</b>, 773&ndash;779.
</p>
<p>Vanobbergen, J., Martens, L., Lesaffre, E., and Declerck, D. (2000).
The Signal-Tandmobiel project &ndash; a longitudinal intervention health promotion
study in Flanders (Belgium): baseline and first year results.
<em>European Journal of Paediatric Dentistry</em>, <b>2</b>, 87&ndash;96.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("tandmob", package="icensBKL")
summary(tandmob)
</code></pre>

<hr>
<h2 id='tandmobAll'>Signal Tandmobiel Data</h2><span id='topic+tandmobAll'></span>

<h3>Description</h3>

<p>This is the dataset resulting from a longitudinal prospective dental
study performed in Flanders (North of Belgium) in 1996 &ndash; 2001. The
cohort of 4\,468 randomly sampled children who attended the first year
of the basic school at the beginning of the study was annualy dental
examined by one of 16 trained dentists.
The original dataset consists thus of at most 6 dental observations
for each child.
</p>
<p>The dataset presented here contains mainly the
information on the emergence and caries times summarized in the
interval-censored observations. Some baseline covariates are also
included here.




</p>
<p>For more detail on the design of the study see Vanobbergen et
al. (2000).
</p>











<h3>Usage</h3>

<pre><code class='language-R'>data(tandmobAll)</code></pre>


<h3>Format</h3>

<p>a data frame with 4\,430 rows (38 sampled children did not come
to any of the designed dental examinations) and the following
variables
</p>

<dl>
<dt>IDNR</dt><dd><p>identification number of a child</p>
</dd>
<dt>GENDER</dt><dd><p>character <em>boy</em> or <em>girl</em></p>
</dd>
<dt>GENDERNum</dt><dd><p>numeric, 0 = <em>boy</em>, 1 = <em>girl</em></p>
</dd>
<dt>DOB</dt><dd><p>character, date of birth in the format DDmmmYY</p>
</dd>
<dt>PROVINCE</dt><dd><p>factor, code of the province with
</p>

<dl>
<dt>0 = <code>Ant</code> =</dt><dd><p>Antwerpen</p>
</dd>
<dt>1 = <code>VlB</code> =</dt><dd><p>Vlaams Brabant</p>
</dd>
<dt>2 = <code>Lim</code> =</dt><dd><p>Limburg</p>
</dd>
<dt>3 = <code>OVl</code> =</dt><dd><p>Oost Vlaanderen</p>
</dd>
<dt>4 = <code>WVl</code> =</dt><dd><p>West Vlaanderen</p>
</dd>
</dl>
  
</dd>
<dt>EDUC</dt><dd><p>factor, code of the educational system with
</p>

<dl>
<dt>0 = <code>Free</code> =</dt><dd><p>Free school</p>
</dd>
<dt>1 = <code>Community</code> =</dt><dd><p>Community school</p>
</dd>
<dt>2 = <code>Province/council</code> =</dt><dd><p>Province/council school</p>
</dd>
</dl>
  
</dd>
<dt>STARTBR</dt><dd><p>factor, code indicating the starting age of brushing
the teeth (as reported by parents) with
</p>

<dl>
<dt>1 = <code>&lt;=1</code> =</dt><dd><p>[0, 1] years</p>
</dd>
<dt>2 = <code>(1,2]</code> =</dt><dd><p>(1, 2] years</p>
</dd>
<dt>3 = <code>(2,3]</code> =</dt><dd><p>(2, 3] years</p>
</dd>
<dt>4 = <code>(3,4]</code> =</dt><dd><p>(3, 4] years</p>
</dd>
<dt>5 = <code>(4,5]</code> =</dt><dd><p>(4, 5] years</p>
</dd>      
<dt>6 = <code>&gt;5</code> =</dt><dd><p>later than at the age of 5</p>
</dd>      
</dl>
  
</dd>











<dt>EBEG.xx</dt><dd><p>lower limit of the emergence (in years of age) of the
permanent tooth xx. <code>NA</code> if the emergence was left-censored.
</p>
<p>xx takes values 11, 21, 31, 41 (permanent incisors),
12, 22, 32, 42 (permanent central canines),
13, 23, 33, 43 (permanent lateral canines),
14, 24, 34, 44 (permanent first premolars),
15, 25, 35, 45 (permanent second premolars),
16, 26, 36, 46 (permanent first molars),
17, 27, 37, 47 (permanent second molars).
</p>
</dd>
<dt>EEND.xx</dt><dd><p>upper limit of the emergence (in years of age) of the
permanent tooth xx. <code>NA</code> if the emergence was right-censored.
</p>
<p>xx takes values as for the variable <code>EBEG.xx</code>.
</p>
</dd>
<dt>FBEG.xx</dt><dd><p>lower limit for the caries time (in years of age, &lsquo;F&rsquo;
stands for &lsquo;failure&rsquo;) of the permanent tooth xx. <code>NA</code> if the
caries time was left-censored.
</p>
<p>xx takes values as for the variable <code>EBEG.xx</code>.    
</p>
</dd>
<dt>FEND.xx</dt><dd><p>upper limit for the caries time (in years of age, &lsquo;F&rsquo;
stands for &lsquo;failure&rsquo;) of the permanent tooth xx. <code>NA</code> if the
caries time was right-censored.
</p>
<p>xx takes values as for the variable <code>EBEG.xx</code>.
</p>
<p>Unfortunately, for all teeth except 16, 26, 36 and 46 almost all
the caries times are right-censored. For teeth 16, 26, 36, 46, the
amount of right-censoring is only about 25%.
</p>
</dd>
<dt>Txx.DMF</dt><dd><p>indicator whether a deciduous tooth xx was
<em><b>d</b>ecayed</em> or <em><b>m</b>issing due to caries</em>
or <em><b>f</b>illed</em> on at most the last examination
before the first examination when the emergence of the permanent
successor was recorded.
</p>
<p>xx takes values 53, 63, 73, 83 (deciduous lateral incisors),
54, 64, 74, 84 (deciduous first molars),
55, 65, 75, 85 (deciduous second molars).
</p>
</dd>
<dt>Txx.CAR</dt><dd><p>indicator whether a~deciduous tooth xx was
removed due to the orthodontical reasons or decayed
on at most the last examination before the first examination when  
the emergence of the permanent successor was recorded.
</p>
</dd>  
</dl>
  


<h3>Source</h3>

<p>Biostatistical Centre, Katholieke Universiteit Leuven,
Kapucijnenvoer 35, 3000 Leuven, Belgium
</p>
<p><code>URL:</code> <code>http://med.kuleuven.be/biostat/</code>
</p>
<p>Data collection was supported by Unilever, Belgium.
The Signal Tandmobiel project comprises the following partners:
D. Declerck (Dental School, Catholic University Leuven),
L. Martens (Dental School, University Ghent),
J. Vanobbergen (Oral Health Promotion and Prevention, Flemish Dental Association),
P. Bottenberg (Dental School, University Brussels),
E. Lesaffre (Biostatistical Centre, Catholic University Leuven),
K. Hoppenbrouwers (Youth Health Department, Catholic University Leuven; Flemish Association for Youth Health Care).  
</p>


<h3>References</h3>

















<p>Vanobbergen, J., Martens, L., Lesaffre, E., and Declerck, D. (2000).
The Signal-Tandmobiel project &ndash; a longitudinal intervention health promotion
study in Flanders (Belgium): baseline and first year results.
<em>European Journal of Paediatric Dentistry</em>, <b>2</b>, 87&ndash;96.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("tandmobAll", package="icensBKL")
summary(tandmobAll)
</code></pre>

<hr>
<h2 id='yoghurt'>Sensory Shelf Life of Yoghurt</h2><span id='topic+yoghurt'></span>

<h3>Description</h3>

<p>For the current study, the objective was to determine the sensory shelf
life (SSL) of whole-fat, stirred yoghurt with strawberry pulp. A
reversed storage design was used in which yoghurt pots of 150 g were
kept at 4°C, and some of them were stored in a 42°C oven for 0, 4, 8,
12, 24, 36 and 48 hours. These times were chosen because previous
experiments showed that deterioration in flavor occurred quickly up to
approximately 12 hours and then slowed down. After being stored at 42°C,
the samples were refrigerated at 4°C until they were tasted. More
details about the experiment can be found in Hough (2010).
</p>
<p>Fifty adults between 18 and 30 years and 50 children between 10 and 12
years who consumed stirred yoghurt at least once a week were recruited
from a town in Argentina. For each of the 7 samples presented in random
order, the subject tasted the sample and answered the question:
&ldquo;Would you normally consume this product? Yes or No?&rdquo;. If a
subject would consume the samples up to 8 hours' storage but not the
samples with 12 hours' storage or longer, it is known that SSL is
somewhere between 8 and 12 hours storage. The data are thus
interval-censored. Right-censored data occur when the subject accepts
all samples and left-censored data if the sample with the first storage
time is rejected. For subjects with inconsistent answers, several
options to construct the interval are possible. Here, the widest
uncertainty interval as to the storage time at which the subject rejects
the yoghurt was applied. That is, from the first &ldquo;yes&rdquo; before a
&ldquo;no&rdquo; until the last &ldquo;no&rdquo; which occurs after a &ldquo;yes&rdquo;.
</p>
<p>Several subjects were excluded from the analysis (4 adults and 3
children) because they  preferred the stored product to the fresh product. 
The data are reproduced from Hough (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(yoghurt)</code></pre>


<h3>Format</h3>

<p>a data frame with 93 rows and the following variables
</p>

<dl>
<dt>left</dt><dd><p>lower (left) limit of interval that contains an event of
interest, set to <code>NA</code> for left-censored observations.</p>
</dd>
<dt>right</dt><dd><p>upper (right) limit of interval that contains an event of
interest, set to <code>NA</code> for right-censored observations.</p>
</dd>
<dt>adult</dt><dd><p>a binary variable indicating whether respondent is
child (0) or adult (1).</p>
</dd>
<dt>fadult</dt><dd><p><code>factor</code> derived from variable <code>adult</code>.</p>
</dd>
</dl>
  


<h3>Source</h3>

<p>Hough, G. (2010). <em>Sensory Shelf Life Estimation of Food
Products</em>. CRC press. ISBN  9781420092912.
</p>


<h3>References</h3>

<p>Hough, G. (2010). <em>Sensory Shelf Life Estimation of Food
Products</em>. CRC press. ISBN  9781420092912.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("yoghurt", package="icensBKL")
summary(yoghurt)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
