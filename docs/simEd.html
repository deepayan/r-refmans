<!DOCTYPE html><html><head><title>Help for package simEd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simEd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#accrej'><p>Acceptance-Rejection Algorithm Visualization</p></a></li>
<li><a href='#craps'><p>Monte Carlo Simulation of the Dice Game &quot;Craps&quot;</p></a></li>
<li><a href='#galileo'><p>Monte Carlo Simulation of Galileo's Dice</p></a></li>
<li><a href='#ibeta'><p>Visualization of Random Variate Generation for the Beta Distribution</p></a></li>
<li><a href='#ibinom'><p>Visualization of Random Variate Generation for the Binomial Distribution</p></a></li>
<li><a href='#icauchy'><p>Visualization of Random Variate Generation for the Cauchy Distribution</p></a></li>
<li><a href='#ichisq'><p>Visualization of Random Variate Generation for the Chi-Squared Distribution</p></a></li>
<li><a href='#iexp'><p>Visualization of Random Variate Generation for the Exponential Distribution</p></a></li>
<li><a href='#ifd'><p>Visualization of Random Variate Generation for the FALSE Distribution</p></a></li>
<li><a href='#igamma'><p>Visualization of Random Variate Generation for the Gamma Distribution</p></a></li>
<li><a href='#igeom'><p>Visualization of Random Variate Generation for the Geometric Distribution</p></a></li>
<li><a href='#ilnorm'><p>Visualization of Random Variate Generation for the Log-Normal Distribution</p></a></li>
<li><a href='#ilogis'><p>Visualization of Random Variate Generation for the Logistic Distribution</p></a></li>
<li><a href='#inbinom'><p>Visualization of Random Variate Generation for the Negative Binomial Distribution</p></a></li>
<li><a href='#inorm'><p>Visualization of Random Variate Generation for the Normal Distribution</p></a></li>
<li><a href='#ipois'><p>Visualization of Random Variate Generation for the Poisson Distribution</p></a></li>
<li><a href='#it'><p>Visualization of Random Variate Generation for the Student T Distribution</p></a></li>
<li><a href='#iunif'><p>Visualization of Random Variate Generation for the Uniform Distribution</p></a></li>
<li><a href='#iweibull'><p>Visualization of Random Variate Generation for the Weibull Distribution</p></a></li>
<li><a href='#lehmer'><p>Lehmer Generator Visualization</p></a></li>
<li><a href='#meanTPS'><p>Mean of Time-Persistent Statistics (TPS)</p></a></li>
<li><a href='#msq'><p>Multi-Server Queue Simulation</p></a></li>
<li><a href='#quantileTPS'><p>Sample Quantiles of Time-Persistent Statistics (TPS)</p></a></li>
<li><a href='#queueTrace'><p>Trace Data for Single-Server Queue Simulation</p></a></li>
<li><a href='#sample'><p>Random Samples</p></a></li>
<li><a href='#sdTPS'><p>Standard Deviation of Time-Persistent Statistics (TPS)</p></a></li>
<li><a href='#set.seed'><p>Seeding Random Variate Generators</p></a></li>
<li><a href='#simEd-package'><p>Simulation Education</p></a></li>
<li><a href='#ssq'><p>Single-Server Queue Simulation</p></a></li>
<li><a href='#ssqvis'><p>Single-Server Queue Simulation Visualization</p></a></li>
<li><a href='#thinning'><p>Thinning Algorithm Visualization</p></a></li>
<li><a href='#tylersGrill'><p>Arrival and Service Data for Tyler's Grill (University of Richmond)</p></a></li>
<li><a href='#vbeta'><p>Variate Generation for Beta Distribution</p></a></li>
<li><a href='#vbinom'><p>Variate Generation for Binomial Distribution</p></a></li>
<li><a href='#vcauchy'><p>Variate Generation for Cauchy Distribution</p></a></li>
<li><a href='#vchisq'><p>Variate Generation for Chi-Squared Distribution</p></a></li>
<li><a href='#vexp'><p>Variate Generation for Exponential Distribution</p></a></li>
<li><a href='#vfd'><p>Variate Generation for FALSE Distribution</p></a></li>
<li><a href='#vgamma'><p>Variate Generation for Gamma Distribution</p></a></li>
<li><a href='#vgeom'><p>Variate Generation for Geometric Distribution</p></a></li>
<li><a href='#vlnorm'><p>Variate Generation for Log-Normal Distribution</p></a></li>
<li><a href='#vlogis'><p>Variate Generation for Logistic Distribution</p></a></li>
<li><a href='#vnbinom'><p>Variate Generation for Negative Binomial Distribution</p></a></li>
<li><a href='#vnorm'><p>Variate Generation for Normal Distribution</p></a></li>
<li><a href='#vpois'><p>Variate Generation for Poisson Distribution</p></a></li>
<li><a href='#vt'><p>Variate Generation for Student T Distribution</p></a></li>
<li><a href='#vunif'><p>Variate Generation for Uniform Distribution</p></a></li>
<li><a href='#vweibull'><p>Variate Generation for Weibull Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulation Education</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, methods, stats, utils, shape</td>
</tr>
<tr>
<td>Depends:</td>
<td>rstream</td>
</tr>
<tr>
<td>Suggests:</td>
<td>magick</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains various functions to be used for simulation education,
    including simple Monte Carlo simulation functions, queueing simulation
    functions, variate generation functions capable of producing independent
    streams and antithetic variates, functions for illustrating random variate
    generation for various discrete and continuous distributions, and functions
    to compute time-persistent statistics.  Also contains functions for 
    visualizing: event-driven details of a single-server queue model; a Lehmer
    random number generator; variate generation via acceptance-rejection; and
    of generating a non-homogeneous Poisson process via thinning.  Also
    contains two queueing data sets (one fabricated, one real-world) to
    facilitate input modeling.  More details on the use of these functions can
    be found in Lawson and Leemis (2015) &lt;<a href="https://doi.org/10.1109%2FWSC.2017.8248124">doi:10.1109/WSC.2017.8248124</a>&gt;, in
    Kudlay, Lawson, and Leemis (2020) &lt;<a href="https://doi.org/10.1109%2FWSC48552.2020.9384010">doi:10.1109/WSC48552.2020.9384010</a>&gt;, and
    in Lawson and Leemis (2021) &lt;<a href="https://doi.org/10.1109%2FWSC52266.2021.9715299">doi:10.1109/WSC52266.2021.9715299</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-26 13:08:36 UTC; blawson</td>
</tr>
<tr>
<td>Author:</td>
<td>Barry Lawson [aut, cre, cph],
  Larry Leemis [aut],
  Vadim Kudlay [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Barry Lawson &lt;blawson@bates.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 23:20:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='accrej'>Acceptance-Rejection Algorithm Visualization</h2><span id='topic+accrej'></span>

<h3>Description</h3>

<p>This function animates the process of generating variates via
acceptance-rejection for a specified density function (pdf) bounded
by a specified majorizing function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrej(
  n = 20,
  pdf = function(x) dbeta(x, 3, 2),
  majorizingFcn = NULL,
  majorizingFcnType = NULL,
  support = c(0, 1),
  seed = NA,
  maxTrials = Inf,
  plot = TRUE,
  showTitle = TRUE,
  plotDelay = plot * -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrej_+3A_n">n</code></td>
<td>
<p>number of variates to generate.</p>
</td></tr>
<tr><td><code id="accrej_+3A_pdf">pdf</code></td>
<td>
<p>desired probability density function from which random
variates are to be drawn</p>
</td></tr>
<tr><td><code id="accrej_+3A_majorizingfcn">majorizingFcn</code></td>
<td>
<p>majorizing function.  Default value is NULL,
corresponding to a constant majorizing function that is
1.01 times the maximum value of the pdf. May
alternatively be provided as a user-specified function,
or as a data frame requiring additional notation as
either piecewise-constant or piecewise-linear.  See
examples.</p>
</td></tr>
<tr><td><code id="accrej_+3A_majorizingfcntype">majorizingFcnType</code></td>
<td>
<p>used to indicate whether a majorizing function that
is provided via data frame is to be interpreted as
either piecewise-constant (<code>"pwc"</code>) or
piecewise-linear (<code>"pwl"</code>).  If the majorizing
function is either the default or a user-specified
function (closure), the value of this parameter is
ignored.</p>
</td></tr>
<tr><td><code id="accrej_+3A_support">support</code></td>
<td>
<p>the lower and upper bounds of the support of the
probability distribution of interest, specified as a
two-element vector.</p>
</td></tr>
<tr><td><code id="accrej_+3A_seed">seed</code></td>
<td>
<p>initial seed for the uniform variates used during generation.</p>
</td></tr>
<tr><td><code id="accrej_+3A_maxtrials">maxTrials</code></td>
<td>
<p>maximum number of accept-reject trials; infinite by default</p>
</td></tr>
<tr><td><code id="accrej_+3A_plot">plot</code></td>
<td>
<p>if TRUE, visual display will be produced.  If FALSE,
generated variates will be returned without visual display.</p>
</td></tr>
<tr><td><code id="accrej_+3A_showtitle">showTitle</code></td>
<td>
<p>if TRUE, display title in the main plot.</p>
</td></tr>
<tr><td><code id="accrej_+3A_plotdelay">plotDelay</code></td>
<td>
<p>wait time, in seconds, between plots; -1 (default) for interactive
mode, where the user is queried for input to progress.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three modes for visualizing the acceptance-rejection
algorithm for generating random variates from a particular
probability distribution:
</p>

<ul>
<li><p> interactive advance (<code>plotDelay = -1</code>), where
pressing the 'ENTER' key advances to the next step
(an accepted random variate) in the algorithm,
typing 'j #' jumps ahead # steps,
typing 'q' quits immediately,
and typing 'e' proceeds to the end;
</p>
</li>
<li><p> automatic advance (<code>plotDelay</code> &gt; 0); or
</p>
</li>
<li><p> final visualization only (<code>plotDelay = 0</code>).
</p>
</li></ul>

<p>As an alternative to visualizing, variates can be generated
</p>


<h3>Value</h3>

<p>Returns the n generated variates accepted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
accrej(n = 20, seed = 8675309, plotDelay = 0)
accrej(n = 10, seed = 8675309, plotDelay = 0.1)

# interactive mode
if (interactive()) {
  accrej(n = 10, seed = 8675309, plotDelay = -1)
}

# Piecewise-constant majorizing function
m &lt;- function(x) {
  if      (x &lt; 0.3)  1.0 
  else if (x &lt; 0.85) 2.5
  else               1.5
}
accrej(n = 10, seed = 8675309, majorizingFcn = m, plotDelay = 0)

# Piecewise-constant majorizing function as data frame
m &lt;- data.frame(
  x = c(0.0, 0.3, 0.85, 1.0),
  y = c(1.0, 1.0, 2.5,  1.5))
accrej(n = 10, seed = 8675309, majorizingFcn = m, 
       majorizingFcnType = "pwc", plotDelay = 0)

# Piecewise-linear majorizing function as data frame
m &lt;- data.frame(
   x = c(0.0, 0.1, 0.3, 0.5, 0.7, 1.0), 
   y = c(0.0, 0.5, 1.1, 2.2, 1.9, 1.0))
accrej(n = 10, seed = 8675309, majorizingFcn = m, 
       majorizingFcnType = "pwl", plotDelay = 0)

# invalid majorizing function; should give warning
try(accrej(n = 20, majorizingFcn = function(x) dbeta(x, 1, 3), plotDelay = 0))

# Piecewise-linear majorizing function with power-distribution density function
m &lt;- data.frame(x = c(0, 1, 2), y = c(0, 0.375, 1.5))
samples &lt;- accrej(n = 10, pdf = function(x) (3 / 8) * x ^ 2, support = c(0,2),
                  majorizingFcn = m, majorizingFcnType = "pwl", plotDelay = 0)

</code></pre>

<hr>
<h2 id='craps'>Monte Carlo Simulation of the Dice Game &quot;Craps&quot;</h2><span id='topic+craps'></span>

<h3>Description</h3>

<p>A Monte Carlo simulation of the dice game &quot;craps&quot;.
Returns a point estimate of the probability of winning craps using fair dice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>craps(nrep = 1000, seed = NA, showProgress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="craps_+3A_nrep">nrep</code></td>
<td>
<p>Number of replications (plays of a single game of craps)</p>
</td></tr>
<tr><td><code id="craps_+3A_seed">seed</code></td>
<td>
<p>Initial seed to the random number generator (NA uses current
state of random number generator; <code>NULL</code> seeds using system
clock)</p>
</td></tr>
<tr><td><code id="craps_+3A_showprogress">showProgress</code></td>
<td>
<p>If <code>TRUE</code>, displays a progress bar on screen
during execution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a Monte Carlo simulation of the dice game craps played with fair
dice.
A single play of the game proceeds as follows:
</p>

<ul>
<li><p> Two fair dice are rolled.  If the sum is 7 or 11, the player wins
immediately; if the sum is 2, 3, or 12, the player loses immediately.
Otherwise the sum becomes the <em>point</em>.
</p>
</li>
<li><p> The two dice continue to be rolled until either a sum of 7 is rolled
(in which case the player loses) or a sum equal to the <em>point</em> is
rolled (in which case the player wins).
</p>
</li></ul>

<p>The simulation involves <code>nrep</code> replications of the game.
</p>
<p>Note: When the value of <code>nrep</code> is large, the function will execute
noticeably faster when <code>showProgress</code> is set to <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>Point estimate of the probability of winning at craps (a real-valued scalar).
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+set.seed">base::set.seed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # set the initial seed externally using set.seed;
 # then use that current state of the generator with default nrep = 1000
 set.seed(8675309)
 craps()  # uses state of generator set above

 # explicitly set the seed in the call to the function,
 # using default nrep = 1000
 craps(seed = 8675309)

 # use the current state of the random number generator with nrep = 10000
 prob &lt;- craps(10000)

 # explicitly set nrep = 10000 and seed = 8675309
 prob &lt;- craps(10000, 8675309)

</code></pre>

<hr>
<h2 id='galileo'>Monte Carlo Simulation of Galileo's Dice</h2><span id='topic+galileo'></span>

<h3>Description</h3>

<p>A Monte Carlo simulation of the Galileo's Dice problem.
Returns a vector containing point estimates of the probabilities of the
sum of three fair dice for sums 3, 4, <code class="reqn">\ldots</code>, 18.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galileo(nrep = 1000, seed = NA, showProgress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galileo_+3A_nrep">nrep</code></td>
<td>
<p>number of replications (rolls of the three dice)</p>
</td></tr>
<tr><td><code id="galileo_+3A_seed">seed</code></td>
<td>
<p>initial seed to the random number generator (NA uses current
state of random number generator; NULL seeds using system clock)</p>
</td></tr>
<tr><td><code id="galileo_+3A_showprogress">showProgress</code></td>
<td>
<p>If TRUE, displays a progress bar on screen during execution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a Monte Carlo simulation of the Galileo's Dice problem.
The simulation involves <code>nrep</code> replications of rolling three dice and
summing the up-faces, and computing point estimates of the probabilities
of each possible sum 3, 4, <code class="reqn">\ldots</code>, 18.
</p>
<p>Note: When the value of <code>nrep</code> is large, the function will execute
noticeably faster when <code>showProgress</code> is set to <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>An 18-element vector of point estimates of the probabilities.
(Because a sum of 1 or 2 is not possible, the corresponding entries in the
returned vector have value <code>NA</code>.)
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # set the initial seed externally using set.seed;
 # then use that current state of the generator with default nrep = 1000
 set.seed(8675309)
 galileo()  # uses state of generator set above

 # explicitly set the seed in the call to the function,
 # using default nrep = 1000
 galileo(seed = 8675309)

 # use the current state of the random number generator with nrep = 10000
 prob &lt;- galileo(10000)

 # explicitly set nrep = 10000 and seed = 8675309
 prob &lt;- galileo(10000, 8675309)

</code></pre>

<hr>
<h2 id='ibeta'>Visualization of Random Variate Generation for the Beta Distribution</h2><span id='topic+ibeta'></span>

<h3>Description</h3>

<p>Generates random variates from the Beta distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ibeta(
  u = runif(1),
  shape1,
  shape2,
  ncp = 0,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ibeta_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ibeta_+3A_shape1">shape1</code></td>
<td>
<p>Shape parameter 1 (alpha)</p>
</td></tr>
<tr><td><code id="ibeta_+3A_shape2">shape2</code></td>
<td>
<p>Shape parameter 2 (beta)</p>
</td></tr>
<tr><td><code id="ibeta_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (default 0)</p>
</td></tr>
<tr><td><code id="ibeta_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ibeta_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ibeta_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ibeta_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ibeta_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="ibeta_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ibeta_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ibeta_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ibeta_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ibeta_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ibeta_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ibeta_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ibeta_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ibeta_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ibeta_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Beta distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The beta distribution has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = \frac{\Gamma(a+b)}{\Gamma(a) \ \Gamma(b)} x^{a-1}(1-x)^{b-1}}{
          f(x) = Gamma(a+b)/(Gamma(a)Gamma(b)) x^(a-1)(1-x)^(b-1)}
</pre></div>
<p>for <code class="reqn">a &gt; 0</code>, <code class="reqn">b &gt; 0</code> and <code class="reqn">0 \leq x \leq 1</code> where the
boundary values at <code class="reqn">x=0</code> or <code class="reqn">x=1</code> are defined as by continuity (as limits).
</p>
<p>The mean is <code class="reqn">\frac{a}{a+b}</code> and the variance is
<code class="reqn">{ab}{(a+b)^2 (a+b+1)}</code>
</p>
<p>The algorithm for generating random variates from the beta distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated beta random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qbeta</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Beta random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rbeta">stats::rbeta</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ibeta(0.5, shape1 = 3, shape2 = 1, ncp = 2)

 set.seed(8675309)
 ibeta(runif(10), 3, 1, showPDF = TRUE)

 set.seed(8675309)
 ibeta(runif(10), 3, 1, showECDF = TRUE)

 set.seed(8675309)
 ibeta(runif(10), 3, 1, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ibeta(runif(10), 3, 1, showPDF = TRUE, showCDF = FALSE)

 ibeta(runif(100), 3, 1, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 ibeta(NULL, 3, 1, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 ibeta(runif(10), 3, 1, show = c(1,1,0))
 ibeta(runif(10), 3, 1, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ibeta(vunif(10), 3, 1, show = c(1,0,1))
 ibeta(vunif(10), 3, 1, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 ibeta(vunif(10), 3, 1, show = c(1,1,1))
 ibeta(vunif(10), 3, 1, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ibeta(runif(20), 3, 1, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ibeta(runif(20), 3, 1, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ibeta(runif(20), 3, 1, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ibeta(runif(10), 3, 1, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 ibeta(runif(10), 3, 1, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ibeta(runif(10), 3, 1, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='ibinom'>Visualization of Random Variate Generation for the Binomial Distribution</h2><span id='topic+ibinom'></span>

<h3>Description</h3>

<p>Generates random variates from the Binomial distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability mass
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ibinom(
  u = runif(1),
  size,
  prob,
  minPlotQuantile = 0,
  maxPlotQuantile = 1,
  plot = TRUE,
  showCDF = TRUE,
  showPMF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ibinom_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ibinom_+3A_size">size</code></td>
<td>
<p>number of trials (zero or more)</p>
</td></tr>
<tr><td><code id="ibinom_+3A_prob">prob</code></td>
<td>
<p>probability of success on each trial (0 <code class="reqn">&lt;</code> <code>prob</code> <code class="reqn">\le</code> 1)</p>
</td></tr>
<tr><td><code id="ibinom_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ibinom_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ibinom_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ibinom_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ibinom_+3A_showpmf">showPMF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PMF plot appears,
otherwise PMF plot is suppressed</p>
</td></tr>
<tr><td><code id="ibinom_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ibinom_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PMF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ibinom_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ibinom_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ibinom_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ibinom_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ibinom_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ibinom_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ibinom_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ibinom_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Binomial distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PMF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PMF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The binomial distribution with parameters <code>size</code> = <code class="reqn">n</code> and
<code>prob</code> = <code class="reqn">p</code> has pmf
</p>
<p style="text-align: center;"><code class="reqn">p(x) = {n \choose x} p^x (1-p)^{(n-x)}</code>
</p>

<p>for <code class="reqn">x = 0, \ldots, n</code>.
</p>
<p>The algorithm for generating random variates from the binomial distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated binomial random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qbinom</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PMF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PMF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PMF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Binomial random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rbinom">stats::rbinom</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ibinom(0.5, size = 7, prob = 0.4,)

 set.seed(8675309)
 ibinom(runif(10), 10, 0.3, showPMF = TRUE)

 set.seed(8675309)
 ibinom(runif(10), 10, 0.3, showECDF = TRUE)

 set.seed(8675309)
 ibinom(runif(10), 10, 0.3, showPMF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ibinom(runif(10), 10, 0.3, showPMF = TRUE, showCDF = FALSE)

 ibinom(runif(100), 10, 0.3, showPMF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PMF and CDF without any variates
 ibinom(NULL, 10, 0.3, showPMF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PMF using show
 ibinom(runif(10), 10, 0.3, show = c(1,1,0))
 ibinom(runif(10), 10, 0.3, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ibinom(vunif(10), 10, 0.3, show = c(1,0,1))
 ibinom(vunif(10), 10, 0.3, show = 5)

 # plot CDF with inversion, PMF, and ECDF using show
 ibinom(vunif(10), 10, 0.3, show = c(1,1,1))
 ibinom(vunif(10), 10, 0.3, show = 7)

 # plot three different CDF+PMF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ibinom(runif(20), 10, 0.3, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ibinom(runif(20), 10, 0.3, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ibinom(runif(20), 10, 0.3, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ibinom(runif(10), 10, 0.3, show = 7, plotDelay = 0.1)

 # display animation of CDF and PMF components only
 ibinom(runif(10), 10, 0.3, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ibinom(runif(10), 10, 0.3, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='icauchy'>Visualization of Random Variate Generation for the Cauchy Distribution</h2><span id='topic+icauchy'></span>

<h3>Description</h3>

<p>Generates random variates from the Cauchy distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icauchy(
  u = runif(1),
  location = 0,
  scale = 1,
  minPlotQuantile = 0.05,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icauchy_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="icauchy_+3A_location">location</code></td>
<td>
<p>Location parameter (default 0)</p>
</td></tr>
<tr><td><code id="icauchy_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="icauchy_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="icauchy_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="icauchy_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="icauchy_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="icauchy_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="icauchy_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="icauchy_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="icauchy_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="icauchy_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="icauchy_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="icauchy_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="icauchy_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="icauchy_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="icauchy_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="icauchy_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Cauchy distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<div class="sourceCode"><pre>The Cauchy distribution has density
\deqn{f(x) = \frac{1}{\pi s} \ \left(1 + \left( \frac{x - l}{s} \right)^2
              \right)^{-1}}{
          f(x) = 1 / (\pi s (1 + ((x-l)/s)^2))}
</pre></div>
<p>for all <code class="reqn">x</code>.
</p>
<p>The mean is <code class="reqn">a/(a+b)</code> and the variance is <code class="reqn">ab/((a+b)^2 (a+b+1))</code>.
</p>
<p>The algorithm for generating random variates from the Cauchy distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated Cauchy random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qcauchy</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Cauchy random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rcauchy">stats::rcauchy</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> icauchy(0.5, location = 3, scale = 1)

 set.seed(8675309)
 icauchy(runif(10), 0, 3, showPDF = TRUE)

 set.seed(8675309)
 icauchy(runif(10), 0, 3, showECDF = TRUE)

 set.seed(8675309)
 icauchy(runif(10), 0, 3, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 icauchy(runif(10), 0, 3, showPDF = TRUE, showCDF = FALSE)

 icauchy(runif(100), 0, 3, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 icauchy(NULL, 0, 3, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 icauchy(runif(10), 0, 3, show = c(1,1,0))
 icauchy(runif(10), 0, 3, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 icauchy(vunif(10), 0, 3, show = c(1,0,1))
 icauchy(vunif(10), 0, 3, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 icauchy(vunif(10), 0, 3, show = c(1,1,1))
 icauchy(vunif(10), 0, 3, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 icauchy(runif(20), 0, 3, show = 7, respectLayout = TRUE, restorePar = FALSE)
 icauchy(runif(20), 0, 3, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 icauchy(runif(20), 0, 3, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 icauchy(runif(10), 0, 3, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 icauchy(runif(10), 0, 3, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   icauchy(runif(10), 0, 3, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='ichisq'>Visualization of Random Variate Generation for the Chi-Squared Distribution</h2><span id='topic+ichisq'></span>

<h3>Description</h3>

<p>Generates random variates from the Chi-Squared distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ichisq(
  u = runif(1),
  df,
  ncp = 0,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ichisq_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ichisq_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer)</p>
</td></tr>
<tr><td><code id="ichisq_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative)</p>
</td></tr>
<tr><td><code id="ichisq_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ichisq_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ichisq_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ichisq_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ichisq_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="ichisq_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ichisq_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ichisq_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ichisq_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ichisq_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ichisq_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ichisq_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ichisq_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ichisq_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ichisq_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Chi-Squared distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The chi-squared distribution with <code>df</code> = <code class="reqn">n \geq 0</code> degrees
of freedom has density
</p>
<div class="sourceCode"><pre>\deqn{f_n(x) = \frac{1}{2^{n/2} \ \Gamma(n/2)} x^{n/2-1} e^{-x/2}}{
          f_n(x) = 1 / (2^(n/2) \Gamma(n/2)) x^(n/2-1) e^(-x/2)}
</pre></div>
<p>for <code class="reqn">x &gt; 0</code>. The mean and variance are <code class="reqn">n</code> and <code class="reqn">2n</code>.
</p>
<p>The non-central chi-squared distribution with <code>df</code> = n degrees of
freedom and non-centrality parameter <code>ncp</code> <code class="reqn">= \lambda</code> has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = e^{-\lambda/2} \sum_{r=0}^\infty \frac{(\lambda/2)^r}{r!} f_{n + 2r}(x)}{
          f(x) = exp(-\lambda/2) SUM_{r=0}^\infty ((\lambda/2)^r / r!) dchisq(x, df + 2r)}
</pre></div>
<p>for <code class="reqn">x \geq 0</code>.
</p>
<p>The algorithm for generating random variates from the chi-squared distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated chi-squared random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qchisq</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Chi-Squared random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rchisq">stats::rchisq</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ichisq(0.5, df = 3, ncp = 2)

 set.seed(8675309)
 ichisq(runif(10), 3, showPDF = TRUE)

 set.seed(8675309)
 ichisq(runif(10), 3, showECDF = TRUE)

 set.seed(8675309)
 ichisq(runif(10), 3, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ichisq(runif(10), 3, showPDF = TRUE, showCDF = FALSE)

 ichisq(runif(100), 3, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 ichisq(NULL, 3, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 ichisq(runif(10), 3, show = c(1,1,0))
 ichisq(runif(10), 3, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ichisq(vunif(10), 3, show = c(1,0,1))
 ichisq(vunif(10), 3, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 ichisq(vunif(10), 3, show = c(1,1,1))
 ichisq(vunif(10), 3, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ichisq(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ichisq(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ichisq(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ichisq(runif(10), 3, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 ichisq(runif(10), 3, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ichisq(runif(10), 3, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='iexp'>Visualization of Random Variate Generation for the Exponential Distribution</h2><span id='topic+iexp'></span>

<h3>Description</h3>

<p>Generates random variates from the Exponential distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iexp(
  u = runif(1),
  rate = 1,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iexp_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="iexp_+3A_rate">rate</code></td>
<td>
<p>Rate of distribution (default 1)</p>
</td></tr>
<tr><td><code id="iexp_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="iexp_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="iexp_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="iexp_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="iexp_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="iexp_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="iexp_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="iexp_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="iexp_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="iexp_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="iexp_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="iexp_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="iexp_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="iexp_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="iexp_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Exponential distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<div class="sourceCode"><pre> The exponential distribution with rate \eqn{\lambda} has density

     \deqn{f(x) = \lambda e^{-\lambda x}}{
               f(x) = \lambda e^(-\lambda x)}

 for \eqn{x \geq 0}.
</pre></div>
<p>The algorithm for generating random variates from the exponential distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated exponential random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qexp</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Exponential random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rexp">stats::rexp</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> iexp(0.5, rate = 3)

 set.seed(8675309)
 iexp(runif(10), 2, showPDF = TRUE)

 set.seed(8675309)
 iexp(runif(10), 2, showECDF = TRUE)

 set.seed(8675309)
 iexp(runif(10), 2, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 iexp(runif(10), 2, showPDF = TRUE, showCDF = FALSE)

 iexp(runif(100), 2, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 iexp(NULL, 2, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 iexp(runif(10), 2, show = c(1,1,0))
 iexp(runif(10), 2, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 iexp(vunif(10), 2, show = c(1,0,1))
 iexp(vunif(10), 2, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 iexp(vunif(10), 2, show = c(1,1,1))
 iexp(vunif(10), 2, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 iexp(runif(20), 2, show = 7, respectLayout = TRUE, restorePar = FALSE)
 iexp(runif(20), 2, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 iexp(runif(20), 2, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 iexp(runif(10), 2, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 iexp(runif(10), 2, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   iexp(runif(10), 2, show = 7, plotDelay = -1)
 }

  # overlay visual exploration of ks.test results
  oldpar &lt;- par(no.readonly = TRUE)
  set.seed(54321)
  vals &lt;- iexp(runif(10), 2, showECDF = TRUE, restorePar = FALSE)
  D &lt;- as.numeric(ks.test(vals, "pexp", 2)$statistic)
  for (x in seq(0.25, 0.65, by = 0.05)) {
    y &lt;- pexp(x, 2)
    segments(x, y, x, y + D, col = "darkgreen", lwd = 2, xpd = NA)
  }
  par(oldpar) # restore original par values, since restorePar = FALSE above

</code></pre>

<hr>
<h2 id='ifd'>Visualization of Random Variate Generation for the FALSE Distribution</h2><span id='topic+ifd'></span>

<h3>Description</h3>

<p>Generates random variates from the FALSE distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifd(
  u = runif(1),
  df1,
  df2,
  ncp = 0,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifd_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ifd_+3A_df1">df1</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="ifd_+3A_df2">df2</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="ifd_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter &gt;= 0</p>
</td></tr>
<tr><td><code id="ifd_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ifd_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ifd_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ifd_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ifd_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="ifd_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ifd_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ifd_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ifd_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ifd_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ifd_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ifd_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ifd_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ifd_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ifd_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the FALSE distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The F distribution with <code>df1</code> <code class="reqn">= n_1</code> and <code>df2</code>
<code class="reqn">= n_2</code> degrees of freedom has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac {\Gamma(n_1/2 + n_2/2)} {\Gamma(n_1/2) \ \Gamma(n_2/2)}
                \left( \frac{n_1}{n_2} \right)^{n_1/2} x^{n_1/2 - 1}
                \left( 1 + \frac{n_1x}{n_2} \right) ^ {-(n_1 + n_2)/2}</code>
</p>

<p>for <code class="reqn">x &gt; 0</code>.
</p>
<p>The algorithm for generating random variates from the FALSE distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated FALSE random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qf</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of FALSE random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rf">stats::rf</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ifd(0.5, df1 = 1, df2 = 2, ncp = 10)

 set.seed(8675309)
 ifd(runif(10), 5, 5, showPDF = TRUE)

 set.seed(8675309)
 ifd(runif(10), 5, 5, showECDF = TRUE)

 set.seed(8675309)
 ifd(runif(10), 5, 5, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ifd(runif(10), 5, 5, showPDF = TRUE, showCDF = FALSE)

 ifd(runif(100), 5, 5, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 ifd(NULL, 5, 5, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 ifd(runif(10), 5, 5, show = c(1,1,0))
 ifd(runif(10), 5, 5, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ifd(vunif(10), 5, 5, show = c(1,0,1))
 ifd(vunif(10), 5, 5, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 ifd(vunif(10), 5, 5, show = c(1,1,1))
 ifd(vunif(10), 5, 5, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ifd(runif(20), 5, 5, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ifd(runif(20), 5, 5, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ifd(runif(20), 5, 5, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ifd(runif(10), 5, 5, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 ifd(runif(10), 5, 5, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ifd(runif(10), 5, 5, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='igamma'>Visualization of Random Variate Generation for the Gamma Distribution</h2><span id='topic+igamma'></span>

<h3>Description</h3>

<p>Generates random variates from the Gamma distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>igamma(
  u = runif(1),
  shape,
  rate = 1,
  scale = 1/rate,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="igamma_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="igamma_+3A_shape">shape</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="igamma_+3A_rate">rate</code></td>
<td>
<p>Alternate parameterization for scale</p>
</td></tr>
<tr><td><code id="igamma_+3A_scale">scale</code></td>
<td>
<p>Scale parameter</p>
</td></tr>
<tr><td><code id="igamma_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="igamma_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="igamma_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="igamma_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="igamma_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="igamma_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="igamma_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="igamma_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="igamma_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="igamma_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="igamma_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="igamma_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="igamma_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="igamma_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="igamma_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Gamma distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<div class="sourceCode"><pre>The gamma distribution with parameters \code{shape} = \eqn{a} and
\code{scale} = \eqn{s} has density

     \deqn{f(x) = \frac{1}{s^a\, \Gamma(a)} x^{a-1} e^{-x/s}}{
               f(x) = 1/(s^a Gamma(a)) x^(a-1) e^(-x/s)}

for \eqn{x \ge 0}, \eqn{a &gt; 0}, and \eqn{s &gt; 0}.
(Here \eqn{\Gamma(a)}{Gamma(a)} is the function implemented by
R's \code{\link[base:Special]{gamma}()} and defined in its help.)

The population mean and variance are \eqn{E(X) = as}
and \eqn{Var(X) = as^2}.
</pre></div>
<p>The algorithm for generating random variates from the gamma distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated gamma random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qgamma</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Gamma random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rgamma">stats::rgamma</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> igamma(0.5, shape = 5, scale = 3)

 set.seed(8675309)
 igamma(runif(10), 3, 2, showPDF = TRUE)

 set.seed(8675309)
 igamma(runif(10), 3, 2, showECDF = TRUE)

 set.seed(8675309)
 igamma(runif(10), 3, 2, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 igamma(runif(10), 3, 2, showPDF = TRUE, showCDF = FALSE)

 igamma(runif(100), 3, 2, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 igamma(NULL, 3, 2, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 igamma(runif(10), 3, 2, show = c(1,1,0))
 igamma(runif(10), 3, 2, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 igamma(vunif(10), 3, 2, show = c(1,0,1))
 igamma(vunif(10), 3, 2, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 igamma(vunif(10), 3, 2, show = c(1,1,1))
 igamma(vunif(10), 3, 2, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 igamma(runif(20), 3, 2, show = 7, respectLayout = TRUE, restorePar = FALSE)
 igamma(runif(20), 3, 2, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 igamma(runif(20), 3, 2, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 igamma(runif(10), 3, 2, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 igamma(runif(10), 3, 2, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   igamma(runif(10), 3, 2, show = 7, plotDelay = -1)
 }

  # overlay visual exploration of ks.test results
  oldpar &lt;- par(no.readonly = TRUE)
  set.seed(54321)
  vals &lt;- igamma(runif(10), 3, 2, showECDF = TRUE, restorePar = FALSE)
  D &lt;- as.numeric(ks.test(vals, "pgamma", 3, 2)$statistic)
  for (x in seq(1.20, 1.60, by = 0.05)) {
    y &lt;- pgamma(x, 3, 2)
    segments(x, y, x, y + D, col = "darkgreen", lwd = 2, xpd = NA)
  }
  par(oldpar) # restore original par values, since restorePar = FALSE above

</code></pre>

<hr>
<h2 id='igeom'>Visualization of Random Variate Generation for the Geometric Distribution</h2><span id='topic+igeom'></span>

<h3>Description</h3>

<p>Generates random variates from the Geometric distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability mass
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>igeom(
  u = runif(1),
  prob,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPMF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="igeom_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="igeom_+3A_prob">prob</code></td>
<td>
<p>Probability of success in each trial (0 <code class="reqn">&lt;</code> <code>prob</code> <code class="reqn">\le</code> 1)</p>
</td></tr>
<tr><td><code id="igeom_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="igeom_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="igeom_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="igeom_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="igeom_+3A_showpmf">showPMF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PMF plot appears,
otherwise PMF plot is suppressed</p>
</td></tr>
<tr><td><code id="igeom_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="igeom_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PMF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="igeom_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="igeom_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="igeom_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="igeom_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="igeom_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="igeom_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="igeom_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="igeom_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Geometric distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PMF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PMF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The geometric distribution with parameter <code>prob</code> = <code class="reqn">p</code> has density
</p>
<p style="text-align: center;"><code class="reqn">p(x) = p (1-p)^x</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>, where <code class="reqn">0 &lt; p \le 1</code>.
</p>
<p>The algorithm for generating random variates from the geometric distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated geometric random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qgeom</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PMF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PMF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PMF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Geometric random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rgeom">stats::rgeom</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> igeom(0.5, prob = 0.25)

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE)

 set.seed(8675309)
 igeom(runif(10), 0.4, showECDF = TRUE)

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 igeom(runif(10), 0.4, showPMF = TRUE, showCDF = FALSE)

 igeom(runif(100), 0.4, showPMF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PMF and CDF without any variates
 igeom(NULL, 0.4, showPMF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PMF using show
 igeom(runif(10), 0.4, show = c(1,1,0))
 igeom(runif(10), 0.4, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 igeom(vunif(10), 0.4, show = c(1,0,1))
 igeom(vunif(10), 0.4, show = 5)

 # plot CDF with inversion, PMF, and ECDF using show
 igeom(vunif(10), 0.4, show = c(1,1,1))
 igeom(vunif(10), 0.4, show = 7)

 # plot three different CDF+PMF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = FALSE)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 igeom(runif(20), 0.4, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 igeom(runif(10), 0.4, show = 7, plotDelay = 0.1)

 # display animation of CDF and PMF components only
 igeom(runif(10), 0.4, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   igeom(runif(10), 0.4, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='ilnorm'>Visualization of Random Variate Generation for the Log-Normal Distribution</h2><span id='topic+ilnorm'></span>

<h3>Description</h3>

<p>Generates random variates from the Log-Normal distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ilnorm(
  u = runif(1),
  meanlog = 0,
  sdlog = 1,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ilnorm_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_meanlog">meanlog</code></td>
<td>
<p>Mean of distribution on log scale (default 0)</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_sdlog">sdlog</code></td>
<td>
<p>Standard deviation of distribution on log scale (default 1)</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ilnorm_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Log-Normal distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The log-normal distribution has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = \frac{1}{\sqrt{2 \pi} \sigma x}
                 e^{-(\log{x} - \mu)^2 / (2 \sigma^2)} }{
          f(x) = 1/(\sqrt(2 \pi) \sigma x) e^-((log x - \mu)^2 / (2 \sigma^2))}
</pre></div>
<p>where <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> are the mean and standard deviation
of the logarithm.
</p>
<p>The mean is
<code class="reqn">E(X) = \exp(\mu + 1/2 \sigma^2)</code>,
the median is
<code class="reqn">med(X) = \exp(\mu)</code>,
and the variance is
<code class="reqn">Var(X) = \exp(2\times \mu +\sigma^2)\times (\exp(\sigma^2)-1)</code>
and hence the coefficient of variation is
<code class="reqn">sqrt(\exp(\sigma^2)-1)</code>
which is approximately <code class="reqn">\sigma</code> when small
(e.g., <code class="reqn">\sigma &lt; 1/2</code>).
</p>
<p>The algorithm for generating random variates from the log-normal distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated log-normal random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qlnorm</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Log-Normal random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rlnorm">stats::rlnorm</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ilnorm(0.5, meanlog = 5, sdlog = 0.5)

 set.seed(8675309)
 ilnorm(runif(10), 8, 2, showPDF = TRUE)

 set.seed(8675309)
 ilnorm(runif(10), 8, 2, showECDF = TRUE)

 set.seed(8675309)
 ilnorm(runif(10), 8, 2, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ilnorm(runif(10), 8, 2, showPDF = TRUE, showCDF = FALSE)

 ilnorm(runif(100), 8, 2, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 ilnorm(NULL, 8, 2, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 ilnorm(runif(10), 8, 2, show = c(1,1,0))
 ilnorm(runif(10), 8, 2, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ilnorm(vunif(10), 8, 2, show = c(1,0,1))
 ilnorm(vunif(10), 8, 2, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 ilnorm(vunif(10), 8, 2, show = c(1,1,1))
 ilnorm(vunif(10), 8, 2, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ilnorm(runif(20), 8, 2, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ilnorm(runif(20), 8, 2, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ilnorm(runif(20), 8, 2, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ilnorm(runif(10), 8, 2, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 ilnorm(runif(10), 8, 2, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ilnorm(runif(10), 8, 2, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='ilogis'>Visualization of Random Variate Generation for the Logistic Distribution</h2><span id='topic+ilogis'></span>

<h3>Description</h3>

<p>Generates random variates from the Logistic distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ilogis(
  u = runif(1),
  location = 0,
  scale = 1,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ilogis_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ilogis_+3A_location">location</code></td>
<td>
<p>Location parameter</p>
</td></tr>
<tr><td><code id="ilogis_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="ilogis_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ilogis_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ilogis_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ilogis_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ilogis_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="ilogis_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ilogis_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ilogis_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ilogis_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ilogis_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ilogis_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ilogis_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ilogis_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ilogis_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ilogis_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Logistic distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The logistic distribution with <code>location</code> <code class="reqn">= \mu</code> and
<code>scale</code> <code class="reqn">= \sigma</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \frac{1}{1 + e^{-(x - \mu) / \sigma}}</code>
</p>

<p>and density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{1}{\sigma} \frac{e^{(x-\mu)/\sigma}}
                     {(1 + e^{(x-\mu)/\sigma})^2}</code>
</p>

<p>It is a long-tailed distribution with mean <code class="reqn">\mu</code> and
variance <code class="reqn">\pi^2 / 3 \sigma^2</code>.
</p>
<p>The algorithm for generating random variates from the logistic distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated logistic random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qlogis</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Logistic random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rlogis">stats::rlogis</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ilogis(0.5, location = 5, scale = 0.5)

 set.seed(8675309)
 ilogis(runif(10), 5, 1.5, showPDF = TRUE)

 set.seed(8675309)
 ilogis(runif(10), 5, 1.5, showECDF = TRUE)

 set.seed(8675309)
 ilogis(runif(10), 5, 1.5, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ilogis(runif(10), 5, 1.5, showPDF = TRUE, showCDF = FALSE)

 ilogis(runif(100), 5, 1.5, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 ilogis(NULL, 5, 1.5, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 ilogis(runif(10), 5, 1.5, show = c(1,1,0))
 ilogis(runif(10), 5, 1.5, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ilogis(vunif(10), 5, 1.5, show = c(1,0,1))
 ilogis(vunif(10), 5, 1.5, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 ilogis(vunif(10), 5, 1.5, show = c(1,1,1))
 ilogis(vunif(10), 5, 1.5, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ilogis(runif(20), 5, 1.5, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ilogis(runif(20), 5, 1.5, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ilogis(runif(20), 5, 1.5, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ilogis(runif(10), 5, 1.5, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 ilogis(runif(10), 5, 1.5, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ilogis(runif(10), 5, 1.5, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='inbinom'>Visualization of Random Variate Generation for the Negative Binomial Distribution</h2><span id='topic+inbinom'></span>

<h3>Description</h3>

<p>Generates random variates from the Negative Binomial distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability mass
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inbinom(
  u = runif(1),
  size,
  prob,
  mu,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPMF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inbinom_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="inbinom_+3A_size">size</code></td>
<td>
<p>target for number of successful trials, or dispersion
parameter (the shape parameter of the gamma mixing
distribution).  Must be strictly positive, need not be
integer.</p>
</td></tr>
<tr><td><code id="inbinom_+3A_prob">prob</code></td>
<td>
<p>Probability of success in each trial;  '0 &lt; prob &lt;= 1'</p>
</td></tr>
<tr><td><code id="inbinom_+3A_mu">mu</code></td>
<td>
<p>alternative parameterization via mean</p>
</td></tr>
<tr><td><code id="inbinom_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="inbinom_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="inbinom_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="inbinom_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="inbinom_+3A_showpmf">showPMF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PMF plot appears,
otherwise PMF plot is suppressed</p>
</td></tr>
<tr><td><code id="inbinom_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="inbinom_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PMF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="inbinom_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="inbinom_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="inbinom_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="inbinom_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="inbinom_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="inbinom_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="inbinom_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="inbinom_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Negative Binomial distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PMF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PMF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The negative binomial distribution with <code>size</code> <code class="reqn">= n</code> and
<code>prob</code> <code class="reqn">= p</code> has density
</p>
<div class="sourceCode"><pre>      \deqn{p(x) = \frac{\Gamma(x+n)}{\Gamma(n) \ x!} p^n (1-p)^x}{
                p(x) = Gamma(x+n)/(Gamma(n) x!) p^n (1-p)^x}
</pre></div>
<p>for <code class="reqn">x = 0, 1, 2, \ldots, n &gt; 0</code> and <code class="reqn">0 &lt; p \leq 1</code>. This represents the
number of failures which occur in a sequence of Bernoulli trials before a
target number of successes is reached.
</p>
<p>The mean is <code class="reqn">\mu = n(1 - p)/p</code> and variance <code class="reqn">n(1 - p)/p^2</code>
</p>
<p>The algorithm for generating random variates from the negative binomial distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated negative binomial random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qnbinom</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PMF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PMF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PMF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Negative Binomial random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rnbinom">stats::rnbinom</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> inbinom(0.5, size = 10, mu = 10)

 set.seed(8675309)
 inbinom(runif(10), 10, 0.25, showPMF = TRUE)

 set.seed(8675309)
 inbinom(runif(10), 10, 0.25, showECDF = TRUE)

 set.seed(8675309)
 inbinom(runif(10), 10, 0.25, showPMF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 inbinom(runif(10), 10, 0.25, showPMF = TRUE, showCDF = FALSE)

 inbinom(runif(100), 10, 0.25, showPMF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PMF and CDF without any variates
 inbinom(NULL, 10, 0.25, showPMF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PMF using show
 inbinom(runif(10), 10, 0.25, show = c(1,1,0))
 inbinom(runif(10), 10, 0.25, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 inbinom(vunif(10), 10, 0.25, show = c(1,0,1))
 inbinom(vunif(10), 10, 0.25, show = 5)

 # plot CDF with inversion, PMF, and ECDF using show
 inbinom(vunif(10), 10, 0.25, show = c(1,1,1))
 inbinom(vunif(10), 10, 0.25, show = 7)

 # plot three different CDF+PMF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 inbinom(runif(20), 10, 0.25, show = 7, respectLayout = TRUE, restorePar = FALSE)
 inbinom(runif(20), 10, 0.25, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 inbinom(runif(20), 10, 0.25, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 inbinom(runif(10), 10, 0.25, show = 7, plotDelay = 0.1)

 # display animation of CDF and PMF components only
 inbinom(runif(10), 10, 0.25, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   inbinom(runif(10), 10, 0.25, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='inorm'>Visualization of Random Variate Generation for the Normal Distribution</h2><span id='topic+inorm'></span>

<h3>Description</h3>

<p>Generates random variates from the Normal distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inorm(
  u = runif(1),
  mean = 0,
  sd = 1,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inorm_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="inorm_+3A_mean">mean</code></td>
<td>
<p>Mean of distribution (default 0)</p>
</td></tr>
<tr><td><code id="inorm_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of distribution (default 1)</p>
</td></tr>
<tr><td><code id="inorm_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="inorm_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="inorm_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="inorm_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="inorm_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="inorm_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="inorm_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="inorm_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="inorm_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="inorm_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="inorm_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="inorm_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="inorm_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="inorm_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="inorm_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Normal distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The normal distribution has density
</p>
<div class="sourceCode"><pre> \deqn{f(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-(x - \mu)^2/(2 \sigma^2)}}{
           f(x) = 1/(\sqrt(2\pi)\sigma) e^(-(x - \mu)^2/(2 \sigma^2))}
</pre></div>
<p>for <code class="reqn">-\infty &lt; x &lt; \infty</code> and <code class="reqn">\sigma &gt; 0</code>, where <code class="reqn">\mu</code> is the
mean of the distribution and <code class="reqn">\sigma</code> the standard deviation.
</p>
<p>The algorithm for generating random variates from the normal distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated normal random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qnorm</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Normal random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rnorm">stats::rnorm</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> inorm(0.5, mean = 3, sd = 1)

 set.seed(8675309)
 inorm(runif(10), 10, 2, showPDF = TRUE)

 set.seed(8675309)
 inorm(runif(10), 10, 2, showECDF = TRUE)

 set.seed(8675309)
 inorm(runif(10), 10, 2, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 inorm(runif(10), 10, 2, showPDF = TRUE, showCDF = FALSE)

 inorm(runif(100), 10, 2, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 inorm(NULL, 10, 2, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 inorm(runif(10), 10, 2, show = c(1,1,0))
 inorm(runif(10), 10, 2, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 inorm(vunif(10), 10, 2, show = c(1,0,1))
 inorm(vunif(10), 10, 2, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 inorm(vunif(10), 10, 2, show = c(1,1,1))
 inorm(vunif(10), 10, 2, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 inorm(runif(20), 10, 2, show = 7, respectLayout = TRUE, restorePar = FALSE)
 inorm(runif(20), 10, 2, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 inorm(runif(20), 10, 2, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 inorm(runif(10), 10, 2, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 inorm(runif(10), 10, 2, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   inorm(runif(10), 10, 2, show = 7, plotDelay = -1)
 }

  # overlay visual exploration of ks.test results
  oldpar &lt;- par(no.readonly = TRUE)
  set.seed(54321)
  vals &lt;- inorm(runif(10), 10, 2, showECDF = TRUE, restorePar = FALSE)
  D &lt;- as.numeric(ks.test(vals, "pnorm", 10, 2)$statistic)
  for (x in seq(9.5, 10.5, by = 0.1)) {
    y &lt;- pnorm(x, 10, 2)
    segments(x, y, x, y + D, col = "darkgreen", lwd = 2, xpd = NA)
  }
  par(oldpar) # restore original par values, since restorePar = FALSE above

</code></pre>

<hr>
<h2 id='ipois'>Visualization of Random Variate Generation for the Poisson Distribution</h2><span id='topic+ipois'></span>

<h3>Description</h3>

<p>Generates random variates from the Poisson distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability mass
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipois(
  u = runif(1),
  lambda,
  minPlotQuantile = 0,
  maxPlotQuantile = 0.95,
  plot = TRUE,
  showCDF = TRUE,
  showPMF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipois_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="ipois_+3A_lambda">lambda</code></td>
<td>
<p>Rate of distribution</p>
</td></tr>
<tr><td><code id="ipois_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="ipois_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="ipois_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="ipois_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="ipois_+3A_showpmf">showPMF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PMF plot appears,
otherwise PMF plot is suppressed</p>
</td></tr>
<tr><td><code id="ipois_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="ipois_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PMF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="ipois_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="ipois_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="ipois_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="ipois_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="ipois_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="ipois_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="ipois_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="ipois_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Poisson distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PMF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PMF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The Poisson distribution has density
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{\lambda^x e^{-\lambda}}{x!}</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>.
The mean and variance are <code class="reqn">E(X) = Var(X) = \lambda</code>
</p>
<p>The algorithm for generating random variates from the Poisson distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated Poisson random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qpois</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PMF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PMF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPMF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PMF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Poisson random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rpois">stats::rpois</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ipois(0.5, lambda = 5)

 set.seed(8675309)
 ipois(runif(10), 3, showPMF = TRUE)

 set.seed(8675309)
 ipois(runif(10), 3, showECDF = TRUE)

 set.seed(8675309)
 ipois(runif(10), 3, showPMF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 ipois(runif(10), 3, showPMF = TRUE, showCDF = FALSE)

 ipois(runif(100), 3, showPMF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PMF and CDF without any variates
 ipois(NULL, 3, showPMF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PMF using show
 ipois(runif(10), 3, show = c(1,1,0))
 ipois(runif(10), 3, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 ipois(vunif(10), 3, show = c(1,0,1))
 ipois(vunif(10), 3, show = 5)

 # plot CDF with inversion, PMF, and ECDF using show
 ipois(vunif(10), 3, show = c(1,1,1))
 ipois(vunif(10), 3, show = 7)

 # plot three different CDF+PMF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 ipois(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = FALSE)
 ipois(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 ipois(runif(20), 3, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 ipois(runif(10), 3, show = 7, plotDelay = 0.1)

 # display animation of CDF and PMF components only
 ipois(runif(10), 3, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   ipois(runif(10), 3, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='it'>Visualization of Random Variate Generation for the Student T Distribution</h2><span id='topic+it'></span>

<h3>Description</h3>

<p>Generates random variates from the Student T distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>it(
  u = runif(1),
  df,
  ncp,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="it_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="it_+3A_df">df</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="it_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter delta (default NULL)</p>
</td></tr>
<tr><td><code id="it_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="it_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="it_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="it_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="it_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="it_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="it_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="it_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="it_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="it_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="it_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="it_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="it_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="it_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="it_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Student T distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The t-distribution with <code>df</code> <code class="reqn">= v</code> degrees of freedom has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{\Gamma((v+1)/2)}{\sqrt{v\pi} \
             \Gamma(v/2)} \ (1 + x^2/v)^{-(v+1)/2}</code>
</p>

<p>for all real <code class="reqn">x</code>. It has mean 0 (for <code class="reqn">v &gt; 1</code>) and variance
<code class="reqn">v/(v-2)</code> (for <code class="reqn">v &gt; 2</code>).
</p>
<p>The general non-central t with parameters <code class="reqn">(\nu, \delta)</code> =
<code>(df, ncp)</code> is defined as the distribution of
<code class="reqn">T_{\nu}(\delta) := (U + \delta) \ / \ \sqrt{(V/\nu)}</code>
where <code class="reqn">U</code> and <code class="reqn">V</code> are
independent random variables, <code class="reqn">U \sim \mathcal{N}(0,1)</code>
and <code class="reqn">V \sim \chi^2(\nu)</code>.
</p>
<p>The algorithm for generating random variates from the Student t distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated Student t random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qt</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Student T random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rt">stats::rt</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> it(0.5, df = 5, ncp = 10)

 set.seed(8675309)
 it(runif(10), 4, showPDF = TRUE)

 set.seed(8675309)
 it(runif(10), 4, showECDF = TRUE)

 set.seed(8675309)
 it(runif(10), 4, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 it(runif(10), 4, showPDF = TRUE, showCDF = FALSE)

 it(runif(100), 4, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 it(NULL, 4, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 it(runif(10), 4, show = c(1,1,0))
 it(runif(10), 4, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 it(vunif(10), 4, show = c(1,0,1))
 it(vunif(10), 4, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 it(vunif(10), 4, show = c(1,1,1))
 it(vunif(10), 4, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 it(runif(20), 4, show = 7, respectLayout = TRUE, restorePar = FALSE)
 it(runif(20), 4, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 it(runif(20), 4, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 it(runif(10), 4, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 it(runif(10), 4, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   it(runif(10), 4, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='iunif'>Visualization of Random Variate Generation for the Uniform Distribution</h2><span id='topic+iunif'></span>

<h3>Description</h3>

<p>Generates random variates from the Uniform distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iunif(
  u = runif(1),
  min = 0,
  max = 1,
  minPlotQuantile = 0,
  maxPlotQuantile = 1,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iunif_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="iunif_+3A_min">min</code></td>
<td>
<p>lower limit of distribution (default 0)</p>
</td></tr>
<tr><td><code id="iunif_+3A_max">max</code></td>
<td>
<p>upper limit of distribution (default 1)</p>
</td></tr>
<tr><td><code id="iunif_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="iunif_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="iunif_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="iunif_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="iunif_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="iunif_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="iunif_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="iunif_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="iunif_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="iunif_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="iunif_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="iunif_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="iunif_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="iunif_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="iunif_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Uniform distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The uniform distribution has density
</p>
<div class="sourceCode"><pre>      \deqn{f(x) = \frac{1}{max-min}}{
                f(x) = 1/(max-min)}
</pre></div>
<p>for <code class="reqn">min \le x \le max</code>.
</p>
<p>The algorithm for generating random variates from the uniform distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated uniform random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qunif</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Uniform random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> iunif(0.5, min = -10, max = 10)

 set.seed(8675309)
 iunif(runif(10), 0, 10, showPDF = TRUE)

 set.seed(8675309)
 iunif(runif(10), 0, 10, showECDF = TRUE)

 set.seed(8675309)
 iunif(runif(10), 0, 10, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 iunif(runif(10), 0, 10, showPDF = TRUE, showCDF = FALSE)

 iunif(runif(100), 0, 10, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 iunif(NULL, 0, 10, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 iunif(runif(10), 0, 10, show = c(1,1,0))
 iunif(runif(10), 0, 10, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 iunif(vunif(10), 0, 10, show = c(1,0,1))
 iunif(vunif(10), 0, 10, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 iunif(vunif(10), 0, 10, show = c(1,1,1))
 iunif(vunif(10), 0, 10, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 iunif(runif(20), 0, 10, show = 7, respectLayout = TRUE, restorePar = FALSE)
 iunif(runif(20), 0, 10, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 iunif(runif(20), 0, 10, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 iunif(runif(10), 0, 10, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 iunif(runif(10), 0, 10, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   iunif(runif(10), 0, 10, show = 7, plotDelay = -1)
 }

  # overlay visual exploration of ks.test results
  oldpar &lt;- par(no.readonly = TRUE)
  set.seed(54321)
  vals &lt;- iunif(runif(10), 0, 10, showECDF = TRUE, restorePar = FALSE)
  D &lt;- as.numeric(ks.test(vals, "punif", 0, 10)$statistic)
  for (x in seq(4.0, 6.0, by = 0.1)) {
    y &lt;- punif(x, 0, 10)
    segments(x, y, x, y + D, col = "darkgreen", lwd = 2, xpd = NA)
  }
  par(oldpar) # restore original par values, since restorePar = FALSE above

</code></pre>

<hr>
<h2 id='iweibull'>Visualization of Random Variate Generation for the Weibull Distribution</h2><span id='topic+iweibull'></span>

<h3>Description</h3>

<p>Generates random variates from the Weibull distribution by inversion.
Optionally graphs the population cumulative distribution function and
associated random variates, the population probability density
function and a histogram of the random variates, and the empirical
cumulative distribution function versus the population cumulative
distribution function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iweibull(
  u = runif(1),
  shape,
  scale = 1,
  minPlotQuantile = 0.01,
  maxPlotQuantile = 0.99,
  plot = TRUE,
  showCDF = TRUE,
  showPDF = TRUE,
  showECDF = TRUE,
  show = NULL,
  maxInvPlotted = 50,
  plotDelay = 0,
  sampleColor = "red3",
  populationColor = "grey",
  showTitle = TRUE,
  respectLayout = FALSE,
  restorePar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iweibull_+3A_u">u</code></td>
<td>
<p>vector of uniform(0,1) random numbers, or NULL to show population
figures only</p>
</td></tr>
<tr><td><code id="iweibull_+3A_shape">shape</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="iweibull_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="iweibull_+3A_minplotquantile">minPlotQuantile</code></td>
<td>
<p>minimum quantile to plot</p>
</td></tr>
<tr><td><code id="iweibull_+3A_maxplotquantile">maxPlotQuantile</code></td>
<td>
<p>maximum quantile to plot</p>
</td></tr>
<tr><td><code id="iweibull_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), one or more plots will appear
(see parameters below); otherwise no plots appear</p>
</td></tr>
<tr><td><code id="iweibull_+3A_showcdf">showCDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), cdf plot appears, otherwise cdf
plot is suppressed</p>
</td></tr>
<tr><td><code id="iweibull_+3A_showpdf">showPDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), PDF plot
appears, otherwise PDF plot is suppressed</p>
</td></tr>
<tr><td><code id="iweibull_+3A_showecdf">showECDF</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), ecdf plot appears,
otherwise ecdf plot is suppressed</p>
</td></tr>
<tr><td><code id="iweibull_+3A_show">show</code></td>
<td>
<p>octal number (0-7) indicating plots to display;  4: CDF, 2: PDF,
1: ECDF; sum for desired combination</p>
</td></tr>
<tr><td><code id="iweibull_+3A_maxinvplotted">maxInvPlotted</code></td>
<td>
<p>number of inversions to plot across CDF before switching to
plotting quantiles only</p>
</td></tr>
<tr><td><code id="iweibull_+3A_plotdelay">plotDelay</code></td>
<td>
<p>delay in seconds between CDF plots</p>
</td></tr>
<tr><td><code id="iweibull_+3A_samplecolor">sampleColor</code></td>
<td>
<p>Color used to display random sample from distribution</p>
</td></tr>
<tr><td><code id="iweibull_+3A_populationcolor">populationColor</code></td>
<td>
<p>Color used to display population</p>
</td></tr>
<tr><td><code id="iweibull_+3A_showtitle">showTitle</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), displays a title in the
first of any displayed plots</p>
</td></tr>
<tr><td><code id="iweibull_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), respects existing
settings for device layout</p>
</td></tr>
<tr><td><code id="iweibull_+3A_restorepar">restorePar</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), restores user's previous
par settings on function exit</p>
</td></tr>
<tr><td><code id="iweibull_+3A_...">...</code></td>
<td>
<p>Possible additional arguments. Currently, additional arguments not considered.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Weibull distribution, and optionally,
illustrates
</p>

<ul>
<li><p> the use of the inverse-CDF technique,
</p>
</li>
<li><p> the effect of random sampling variability in relation to the PDF and CDF.
</p>
</li></ul>

<p>When all of the graphics are requested,
</p>

<ul>
<li><p> the first graph illustrates the use of the inverse-CDF technique by
graphing the population CDF and the transformation of the random numbers
to random variates,
</p>
</li>
<li><p> the second graph illustrates the effect of random sampling variability
by graphing the population PDF and the histogram associated with the
random variates, and
</p>
</li>
<li><p> the third graph illustrates effect of random sampling variability by
graphing the population CDF and the empirical CDF associated with the
random variates.
</p>
</li></ul>

<p>All aspects of the random variate generation algorithm are output in red by
default, which can be changed by specifying <code>sampleColor</code>.
All aspects of the population distribution are output in gray by default,
which can be changed by specifying <code>populationColor</code>.
</p>
<p>The Weibull distribution with parameters <code>shape</code> = <code class="reqn">a</code> and
<code>scale</code> = <code class="reqn">b</code> has density
</p>
<div class="sourceCode"><pre> \deqn{f(x) = \frac{a}{b} \left(\frac{x}{b}\right)^{a-1} e^{-(x/b)^a}}{
           f(x) = (a/b) (x/b)^(a-1) exp(-(x/b)^a)}
</pre></div>
<p>for <code class="reqn">x \ge 0</code>, <code class="reqn">a &gt; 0</code>, and <code class="reqn">b &gt; 0</code>.
</p>
<p>The algorithm for generating random variates from the Weibull distribution is
synchronized (one random variate for each random number) and monotone in u.
This means that the variates generated here might be useful in some variance
reduction techniques used in Monte Carlo and discrete-event simulation.
</p>
<p>Values from the u vector are plotted in the cdf plot along the vertical axis
as colored dots.  A horizontal, dashed, colored line extends from the dot to
the population cdf.  At the intersection, a vertical, dashed colored line
extends downward to the horizontal axis, where a second colored dot, denoting
the associated Weibull random variate is plotted.
</p>
<p>This is not a particularly fast variate generation algorithm because it uses
the base R <code>qweibull</code> function to invert the values contained in <code>u</code>.
</p>
<p>All of the elements of the <code>u</code> vector must be between 0 and 1.
Alternatively, <code>u</code> can be <code>NULL</code> in which case plot(s) of the
theoretical PDF and cdf are displayed according to plotting parameter
values (defaulting to display of both the PDF and cdf).
</p>
<p>The <code>show</code> parameter can be used as a shortcut way to denote plots to
display.  The argument to <code>show</code> can be either:
</p>

<ul>
<li><p> a binary vector of length three, where the entries from left to right
correspond to <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>,
respectively.  For each entry, a 1 indicates the plot should be
displayed, and a 0 indicates the plot should be suppressed.
</p>
</li>
<li><p> an integer in [0,7] interpreted similar to the Unix chmod command.  That
is, the integer's binary representation can be transformed into a
length-three vector discussed above (e.g., 6 corresponds to c(1,1,0)).
See examples.
</p>
</li></ul>

<p>Any valid value for <code>show</code> takes precedence over existing individual
values for <code>showCDF</code>, <code>showPDF</code>, and <code>showECDF</code>.
</p>
<p>If <code>respectLayout</code> is <code>TRUE</code>, the function respects existing
settings for device layout.  Note, however, that if the number of plots
requested (either via <code>show</code> or via <code>showCDF</code>, <code>showPMF</code>, and
<code>showECDF</code>) exceeds the number of plots available in the current layout
(as determined by <code>prod(par("mfrow"))</code>), the function will display all
requested plots but will also display a warning message indicating that the
current layout does not permit simultaneous viewing of all requested plots.
The most recent plot with this attribute can be further annotated after the call.
</p>
<p>If <code>respectLayout</code> is <code>FALSE</code>, any existing user settings for device
layout are ignored.  That is, the function uses <code>par</code> to explicitly set
<code>mfrow</code> sufficient to show all requested plots stacked vertically to
align their horizontal axes, and then resets row, column, and margin settings
to their prior state on exit.
</p>
<p>The <code>minPlotQuantile</code> and <code>maxPlotQuantile</code> arguments are present in
order to compress the plots horizontally.   The random variates generated are
not impacted by these two arguments.  Vertical, dotted, black lines are
plotted at the associated quantiles on the plots.
</p>
<p><code>plotDelay</code> can be used to slow down or halt the variate generation for
classroom explanation.
</p>
<p>In the plot associated with the PDF, the maximum plotting height is
associated with 125\
that extends above this limit will have three dots appearing above it.
</p>


<h3>Value</h3>

<p>A vector of Weibull random variates
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rweibull">stats::rweibull</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>,
<code><a href="#topic+vunif">simEd::vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> iweibull(0.5, shape = 2, scale = 0.5)

 set.seed(8675309)
 iweibull(runif(10), 1, 2, showPDF = TRUE)

 set.seed(8675309)
 iweibull(runif(10), 1, 2, showECDF = TRUE)

 set.seed(8675309)
 iweibull(runif(10), 1, 2, showPDF = TRUE, showECDF = TRUE, sampleColor = "blue3")

 set.seed(8675309)
 iweibull(runif(10), 1, 2, showPDF = TRUE, showCDF = FALSE)

 iweibull(runif(100), 1, 2, showPDF = TRUE, minPlotQuantile = 0.02, maxPlotQuantile = 0.98)

 # plot the PDF and CDF without any variates
 iweibull(NULL, 1, 2, showPDF = TRUE, showCDF = TRUE)

 # plot CDF with inversion and PDF using show
 iweibull(runif(10), 1, 2, show = c(1,1,0))
 iweibull(runif(10), 1, 2, show = 6)

 # plot CDF with inversion and ECDF using show, using vunif
 iweibull(vunif(10), 1, 2, show = c(1,0,1))
 iweibull(vunif(10), 1, 2, show = 5)

 # plot CDF with inversion, PDF, and ECDF using show
 iweibull(vunif(10), 1, 2, show = c(1,1,1))
 iweibull(vunif(10), 1, 2, show = 7)

 # plot three different CDF+PDF+ECDF horizontal displays,
 # with title only on the first display
 oldpar &lt;- par(no.readonly = TRUE)
 par(mfrow = c(3,3))  # 3 rows, 3 cols, filling rows before columns
 set.seed(8675309)
 iweibull(runif(20), 1, 2, show = 7, respectLayout = TRUE, restorePar = FALSE)
 iweibull(runif(20), 1, 2, show = 7, respectLayout = TRUE, restorePar = FALSE, showTitle = FALSE)
 iweibull(runif(20), 1, 2, show = 7, respectLayout = TRUE, restorePar = TRUE,  showTitle = FALSE)
 par(oldpar)

 # display animation of all components
 iweibull(runif(10), 1, 2, show = 7, plotDelay = 0.1)

 # display animation of CDF and PDF components only
 iweibull(runif(10), 1, 2, show = 5, plotDelay = 0.1)

 if (interactive()) {
   # interactive -- pause at each stage of inversion
   iweibull(runif(10), 1, 2, show = 7, plotDelay = -1)
 }

</code></pre>

<hr>
<h2 id='lehmer'>Lehmer Generator Visualization</h2><span id='topic+lehmer'></span>

<h3>Description</h3>

<p>This function animates the processes of a basic Lehmer
pseudo-random number generator (PRNG). Also known in the literature as a
multiplicative linear congruential generator (MLCG), the generator
is based on the formula:
</p>
<p style="text-align: center;"><code class="reqn">X_{k+1} \equiv a \cdot X_k \pmod{m}</code>
</p>

<p>where 'm' is the prime modulus, 'a' is the multiplier chosen from {1, m-1},
and 'X_0' is the initial seed chosen from {1, m-1}.  The random numbers
generated in (0,1) are X_{k+1}/m.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lehmer(
  a = 13,
  m = 31,
  seed = 1,
  animate = TRUE,
  numSteps = NA,
  title = NA,
  showTitle = TRUE,
  plotDelay = -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lehmer_+3A_a">a</code></td>
<td>
<p>multiplier in MLCG equation.</p>
</td></tr>
<tr><td><code id="lehmer_+3A_m">m</code></td>
<td>
<p>prime modulus in MLCG equation.</p>
</td></tr>
<tr><td><code id="lehmer_+3A_seed">seed</code></td>
<td>
<p>initial seed for the generator, i.e., the initial value X_0</p>
</td></tr>
<tr><td><code id="lehmer_+3A_animate">animate</code></td>
<td>
<p>should the visual output be displayed.</p>
</td></tr>
<tr><td><code id="lehmer_+3A_numsteps">numSteps</code></td>
<td>
<p>number of steps to animate; default value is Inf if
<code>plotDelay</code> is -1, or the size of the period
otherwise.  Ignored if animate is false.</p>
</td></tr>
<tr><td><code id="lehmer_+3A_title">title</code></td>
<td>
<p>optional title to display in plot (NA uses default title)</p>
</td></tr>
<tr><td><code id="lehmer_+3A_showtitle">showTitle</code></td>
<td>
<p>if TRUE, display title in the main plot.</p>
</td></tr>
<tr><td><code id="lehmer_+3A_plotdelay">plotDelay</code></td>
<td>
<p>wait time between transitioning; -1 (default) for interactive
mode, where the user is queried for input to progress.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the entire period from the PRNG cycle, as a vector of integers in {1, m-1}.
</p>


<h3>References</h3>

<p>Lehmer, D.H. (1951).  Mathematical Models in Large-Scale Computing Units.
<em>Ann. Comput. Lab</em>.  Harvard University, <strong>26</strong>, 141-146.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Default case (m, a = 31, 13); small full period
 lehmer(plotDelay = 0, numSteps = 16)
 lehmer(numSteps = 10, plotDelay = 0.1)   # auto-advance mode

 if (interactive()) {
   lehmer(plotDelay = -1)  # plotDelay -1 uses interactive mode
 }
 
 # multiplier producing period of length 5, with different seeds
 lehmer(a = 8, m = 31, seed = 1, numSteps = 5, plotDelay = 0.1)
 lehmer(a = 8, m = 31, seed = 24, numSteps = 5, plotDelay = 0.1)

 # degenerate cases where seed does not appear in the final period
 lehmer(a = 12, m = 20, seed = 7, numSteps = 4, plotDelay = 0.1)  # length  4
 lehmer(a = 4, m = 6, seed = 1, numSteps = 1, plotDelay = 0.1)  # length 1
 
</code></pre>

<hr>
<h2 id='meanTPS'>Mean of Time-Persistent Statistics (TPS)</h2><span id='topic+meanTPS'></span>

<h3>Description</h3>

<p>Computes the sample mean of a time-persistent function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanTPS(times = NULL, numbers = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanTPS_+3A_times">times</code></td>
<td>
<p>A numeric vector of non-decreasing time observations</p>
</td></tr>
<tr><td><code id="meanTPS_+3A_numbers">numbers</code></td>
<td>
<p>A numeric vector containing the values of the
time-persistent statistic between the time observation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of <code>times</code> and <code>numbers</code> either must be the
same, or <code>times</code> may have one more entry than <code>numbers</code>
(interval endpoints vs. interval counts).  The sample mean is the area
under the step-function created by the values in <code>numbers</code> between
the first and last element in <code>times</code> divided by the length of the
observation period.
</p>


<h3>Value</h3>

<p>the sample mean of the time-persistent function provided
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> times  &lt;- c(1,2,3,4,5)
 counts &lt;- c(1,2,1,1,2)
 meanTPS(times, counts)

 output &lt;- ssq(seed = 54321, maxTime = 100, saveServerStatus = TRUE)
 utilization &lt;- meanTPS(output$serverStatusT, output$serverStatusN)

 # compute and graphically display mean of number in system vs time
 output &lt;- ssq(maxArrivals = 60, seed = 54321, saveAllStats = TRUE)
 plot(output$numInSystemT, output$numInSystemN, type = "s", bty = "l",
     las = 1, xlab = "time", ylab = "number in system")
 timeAvgNumInSysMean &lt;- meanTPS(output$numInSystemT, output$numInSystemN)
 abline(h = timeAvgNumInSysMean, lty = "solid", col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='msq'>Multi-Server Queue Simulation</h2><span id='topic+msq'></span>

<h3>Description</h3>

<p>A next-event simulation of a single-queue multiple-server
service node, with extensible arrival and service processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msq(
  maxArrivals = Inf,
  seed = NA,
  numServers = 2,
  serverSelection = c("LRU", "LFU", "CYC", "RAN", "ORD"),
  interarrivalFcn = NULL,
  serviceFcn = NULL,
  interarrivalType = "M",
  serviceType = "M",
  maxTime = Inf,
  maxDepartures = Inf,
  maxInSystem = Inf,
  maxEventsPerSkyline = 15,
  saveAllStats = FALSE,
  saveInterarrivalTimes = FALSE,
  saveServiceTimes = FALSE,
  saveWaitTimes = FALSE,
  saveSojournTimes = FALSE,
  saveNumInQueue = FALSE,
  saveNumInSystem = FALSE,
  saveServerStatus = FALSE,
  showOutput = TRUE,
  animate = FALSE,
  showQueue = NULL,
  showSkyline = NULL,
  showSkylineSystem = FALSE,
  showSkylineQueue = FALSE,
  showSkylineServer = FALSE,
  showTitle = TRUE,
  showProgress = TRUE,
  plotQueueFcn = defaultPlotMSQ,
  plotSkylineFcn = defaultPlotSkyline,
  jobImage = NA,
  plotDelay = NA,
  respectLayout = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msq_+3A_maxarrivals">maxArrivals</code></td>
<td>
<p>maximum number of customer arrivals allowed to enter the system</p>
</td></tr>
<tr><td><code id="msq_+3A_seed">seed</code></td>
<td>
<p>initial seed to the random number generator (NA uses current state of
random number generator; NULL seeds using system clock)</p>
</td></tr>
<tr><td><code id="msq_+3A_numservers">numServers</code></td>
<td>
<p>Number of servers to simulation (an integer between 1 and 24)</p>
</td></tr>
<tr><td><code id="msq_+3A_serverselection">serverSelection</code></td>
<td>
<p>Algorithm to use for selecting among idle servers (default is &quot;LRU&quot;)</p>
</td></tr>
<tr><td><code id="msq_+3A_interarrivalfcn">interarrivalFcn</code></td>
<td>
<p>Function for generating interarrival times for queue simulation.
Default value (<code>NA</code>) will result in use of default interarrival
function based on <code>interarrivalType</code>.  See examples.</p>
</td></tr>
<tr><td><code id="msq_+3A_servicefcn">serviceFcn</code></td>
<td>
<p>Function for generating service times for queue simulation.
Default value (<code>NA</code>) will result in use of default service function
based on <code>serviceType</code>.  See examples.</p>
</td></tr>
<tr><td><code id="msq_+3A_interarrivaltype">interarrivalType</code></td>
<td>
<p>string representation of desired interarrival process.
Options are &quot;M&quot; &ndash; exponential with rate 1;
&quot;G&quot; &ndash; uniform(0,2), having mean 1; and &quot;D&quot; &ndash; deterministic with
constant value 1.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="msq_+3A_servicetype">serviceType</code></td>
<td>
<p>string representation of desired service process .
Options are &quot;M&quot; &ndash; exponential with rate 10/9;
&quot;G&quot; &ndash; uniform(0, 1.8), having mean 9/10; and &quot;D&quot; &ndash;
deterministic with constant value 9/10.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="msq_+3A_maxtime">maxTime</code></td>
<td>
<p>maximum time to simulate</p>
</td></tr>
<tr><td><code id="msq_+3A_maxdepartures">maxDepartures</code></td>
<td>
<p>maximum number of customer departures to process</p>
</td></tr>
<tr><td><code id="msq_+3A_maxinsystem">maxInSystem</code></td>
<td>
<p>maximum number of customers that the system can hold (server(s) plus queue).
Infinite by default.</p>
</td></tr>
<tr><td><code id="msq_+3A_maxeventsperskyline">maxEventsPerSkyline</code></td>
<td>
<p>maximum number of events viewable at a time in the skyline plot.
A large value for this parameter may result in plotting delays.
This parameter does not impact the final plotting, which will show all
end-of-simulation results.</p>
</td></tr>
<tr><td><code id="msq_+3A_saveallstats">saveAllStats</code></td>
<td>
<p>if <code>TRUE</code>, returns all vectors of statistics (see below)
collected by the simulation</p>
</td></tr>
<tr><td><code id="msq_+3A_saveinterarrivaltimes">saveInterarrivalTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all interarrival times generated</p>
</td></tr>
<tr><td><code id="msq_+3A_saveservicetimes">saveServiceTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all service times generated</p>
</td></tr>
<tr><td><code id="msq_+3A_savewaittimes">saveWaitTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all wait times (in the queue) generated</p>
</td></tr>
<tr><td><code id="msq_+3A_savesojourntimes">saveSojournTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all sojourn times (time spent in the system)
generated</p>
</td></tr>
<tr><td><code id="msq_+3A_savenuminqueue">saveNumInQueue</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the queue changes</p>
</td></tr>
<tr><td><code id="msq_+3A_savenuminsystem">saveNumInSystem</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the system changes</p>
</td></tr>
<tr><td><code id="msq_+3A_saveserverstatus">saveServerStatus</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of
server status (0:idle, 1:busy) for whenever the status changes</p>
</td></tr>
<tr><td><code id="msq_+3A_showoutput">showOutput</code></td>
<td>
<p>if <code>TRUE</code>, displays summary statistics upon completion</p>
</td></tr>
<tr><td><code id="msq_+3A_animate">animate</code></td>
<td>
<p>If FALSE, no animation will be shown.</p>
</td></tr>
<tr><td><code id="msq_+3A_showqueue">showQueue</code></td>
<td>
<p>if TRUE, displays a visualization of the queue</p>
</td></tr>
<tr><td><code id="msq_+3A_showskyline">showSkyline</code></td>
<td>
<p>If <code>NULL</code> (default), defers to each individual showSkyline...
parameter below; otherwise, supersedes individual showSkyline...
parameter values.
If <code>TRUE</code>, displays full skyline plot; <code>FALSE</code> suppresses
skyline plot. Can alternatively be specified using chmod-like octal
component specification: use 1, 2, 4 for system, queue, and server
respectively, summing to indicate desired combination (e.g., 7 for all).
Can also be specified as a binary vector (e.g., c(1,1,1) for all).</p>
</td></tr>
<tr><td><code id="msq_+3A_showskylinesystem">showSkylineSystem</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in system
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="msq_+3A_showskylinequeue">showSkylineQueue</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in queue
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="msq_+3A_showskylineserver">showSkylineServer</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in server
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="msq_+3A_showtitle">showTitle</code></td>
<td>
<p>if <code>TRUE</code>, display title at the top of the main plot</p>
</td></tr>
<tr><td><code id="msq_+3A_showprogress">showProgress</code></td>
<td>
<p>if TRUE, displays a progress bar on screen during no-animation execution</p>
</td></tr>
<tr><td><code id="msq_+3A_plotqueuefcn">plotQueueFcn</code></td>
<td>
<p>Plotting function to display Queue visualization.
By default, this is provided by <code>defaultPlotSSQ</code>. Please refer to
the corresponding help for more details about required arguments.</p>
</td></tr>
<tr><td><code id="msq_+3A_plotskylinefcn">plotSkylineFcn</code></td>
<td>
<p>Plotting function to display Skyline visualization.
By default, this is provided by <code>defaultPlotSkyline</code>.  Please refer
to the corresponding help for more details about required arguments.</p>
</td></tr>
<tr><td><code id="msq_+3A_jobimage">jobImage</code></td>
<td>
<p>a vector of URLs/local addresses of images to use as jobs. Requires
package <code>'magick'</code>.</p>
</td></tr>
<tr><td><code id="msq_+3A_plotdelay">plotDelay</code></td>
<td>
<p>a positive numeric value indicating seconds between plots.
A value of -1 enters 'interactive' mode, where the state will pause
for user input at each step.  A value of 0 will display only the final
end-of-simulation plot.</p>
</td></tr>
<tr><td><code id="msq_+3A_respectlayout">respectLayout</code></td>
<td>
<p>If TRUE, plot layout (i.e., par, device, etc.) settings will be respected.
Not recommended except for specialized use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a next-event implementation of a single-queue multiple-server
queue simulation.
</p>
<p>The <code>seed</code> parameter can take one of three valid
argument types:
</p>

<ul>
<li> <p><code>NA</code> (default), which will use the current state of the random
number generator without explicitly setting a new seed (see examples);
</p>
</li>
<li><p> a positive integer, which will be used as the initial seed passed in
an explicit call to <code><a href="#topic+set.seed">set.seed</a></code>; or
</p>
</li>
<li> <p><code>NULL</code>, which will be passed in an explicit call to to
<code><a href="#topic+set.seed">set.seed</a></code>, thereby setting the initial seed using the
system clock.
</p>
</li></ul>

<p>The server selection mechanism can be chosen from among five options, with
<code>"LRU"</code> being the default:
</p>

<ul>
<li> <p><code>"LRU"</code> (least recently used): from among the currently
available (idle) servers, selects the server who has been idle longest.
</p>
</li>
<li> <p><code>"LFU"</code> (least frequently used): from among the currently
available servers, selects the server having the lowest computed
utilization.
</p>
</li>
<li> <p><code>"CYC"</code> (cyclic): selects a server in a cyclic manner; i.e,
indexing the servers 1, 2, <code class="reqn">\ldots</code>, <code>numServers</code> and incrementing
cyclically, starts from one greater than the index of the most recently
engaged server and selects the first idle server encountered.
</p>
</li>
<li> <p><code>"RAN"</code> (random): selects a server at random from among the
currently available servers.
</p>
</li>
<li> <p><code>"ORD"</code> (in order): indexing the servers 1, 2, <code class="reqn">\ldots</code>,
<code>numServers</code>, selects the idle server having the lowest index.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list containing:
</p>

<ul>
<li><p> the number of arrivals to the system (<code>customerArrivals</code>),
</p>
</li>
<li><p> the number of customers processed (<code>customerDepartures</code>),
</p>
</li>
<li><p> the ending time of the simulation (<code>simulationEndTime</code>),
</p>
</li>
<li><p> average wait time in the queue (<code>avgWait</code>),
</p>
</li>
<li><p> average time in the system (<code>avgSojourn</code>),
</p>
</li>
<li><p> average number in the system (<code>avgNumInSystem</code>),
</p>
</li>
<li><p> average number in the queue (<code>avgNumInQueue</code>), and
</p>
</li>
<li><p> server utilization (<code>utilization</code>).
</p>
</li></ul>

<p>of the queue as computed by the simulation.
When requested via the &ldquo;save...&rdquo; parameters, the list may also contain:
</p>

<ul>
<li><p> a vector of interarrival times (<code>interarrivalTimes</code>),
</p>
</li>
<li><p> a vector of wait times (<code>waitTimes</code>),
</p>
</li>
<li><p> a vector of service times (<code>serviceTimes</code>),
</p>
</li>
<li><p> a vector of sojourn times (<code>sojournTimes</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the system
(<code>numInSystemT</code>, <code>numInSystemN</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the queue
(<code>numInQueueT</code>, <code>numInQueueN</code>), and
</p>
</li>
<li><p> two vectors (time and status) noting changes to server status
(<code>serverStatusT</code>, <code>serverStatusN</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # process 100 arrivals, R-provided seed (via NULL seed), default 2 servers
 msq(100, NULL)
 # process 100 arrivals, seed 8675309, 3 servers, LFU server selection
 msq(100, 8675309, 3, 'LFU')

 msq(maxArrivals = 100, seed = 8675309)
 msq(maxTime = 100, seed = 8675309)

 ############################################################################
 # example to show use of seed = NA (default) to rely on current state of generator
 output1 &lt;- msq(200, 8675309, showOutput = FALSE, saveAllStats = TRUE)
 output2 &lt;- msq(300,          showOutput = FALSE, saveAllStats = TRUE)
 set.seed(8675309)
 output3 &lt;- msq(200,          showOutput = FALSE, saveAllStats = TRUE)
 output4 &lt;- msq(300,          showOutput = FALSE, saveAllStats = TRUE)
 sum(output1$sojournTimes != output3$sojournTimes) # should be zero
 sum(output2$sojournTimes != output4$sojournTimes) # should be zero

 ############################################################################
 # use same service function for (default) two servers
 myArrFcn &lt;- function() { vexp(1, rate = 1/4, stream = 1) }               # mean is 4
 mySvcFcn &lt;- function() { vgamma(1, shape = 1, rate = 0.3, stream = 2) }  # mean is 3.3
 output &lt;- msq(maxArrivals = 100, interarrivalFcn = myArrFcn,
     serviceFcn = mySvcFcn, saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 mean(output$serviceTimes)

 ############################################################################
 # use different service function for (default) two servers
 myArrFcn  &lt;- function() { vexp(1, rate = 1/4, stream = 1) }                # mean is 4
 mySvcFcn1 &lt;- function() { vgamma(1, shape = 3, scale = 1.1, stream = 2) }  # mean is 3.3
 mySvcFcn2 &lt;- function() { vgamma(1, shape = 3, scale = 1.2, stream = 3) }  # mean is 3.6
 output &lt;- msq(maxArrivals = 100, interarrivalFcn = myArrFcn,
     serviceFcn = list(mySvcFcn1, mySvcFcn2), saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 meanTPS(output$numInQueueT, output$numInQueueN)  # compute time-averaged num in queue
 mean(output$serviceTimesPerServer[[1]])  # compute avg service time for server 1
 mean(output$serviceTimesPerServer[[2]])  # compute avg service time for server 2
 meanTPS(output$serverStatusT[[1]], output$serverStatusN[[1]])  # compute server 1 utilization
 meanTPS(output$serverStatusT[[2]], output$serverStatusN[[2]])  # compute server 2 utilization

 ############################################################################
 # example to show use of (simple) trace data for arrivals and service times,
 # allowing for reuse of trace data times
 smallQueueTrace &lt;- list()
 smallQueueTrace$arrivalTimes &lt;- c(15, 47, 71, 111, 123, 152, 166, 226, 310, 320)
 smallQueueTrace$serviceTimes &lt;- c(43, 36, 34,  30,  38,  40,  31,  29,  36,  30)

 interarrivalTimes &lt;- NULL
 serviceTimes      &lt;- NULL

 getInterarr &lt;- function()
 {
     if (length(interarrivalTimes) == 0) {
           interarrivalTimes &lt;&lt;- c(smallQueueTrace$arrivalTimes[1],
                                  diff(smallQueueTrace$arrivalTimes))
     }
     nextInterarr &lt;- interarrivalTimes[1]
     interarrivalTimes &lt;&lt;- interarrivalTimes[-1]  # remove 1st element globally
     return(nextInterarr)
 }

 getService &lt;- function()
 {
     if (length(serviceTimes) == 0) {
         serviceTimes &lt;&lt;- smallQueueTrace$serviceTimes
     }
     nextService &lt;- serviceTimes[1]
     serviceTimes &lt;&lt;- serviceTimes[-1]  # remove 1st element globally
     return(nextService)
 }

 output &lt;- msq(maxArrivals = 100, numServers = 2, interarrivalFcn = getInterarr,
               serviceFcn = getService, saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 mean(output$serviceTimes)
 mean(output$serviceTimesPerServer[[1]])  # compute avg service time for server 1
 mean(output$serviceTimesPerServer[[2]])  # compute avg service time for server 2

 ############################################################################
 # Testing with visualization

 # Visualizing msq with a set seed, infinite queue capacity, 10 arrivals,
 # and showing queue (default) and skyline for all 3 attributes
 msq(seed = 1234, numServers = 5, maxArrivals = 10, showSkyline = 7, 
     plotDelay = 0.1)

 # Same simulation as above but using default interactive mode
 if (interactive()) {
   msq(seed = 1234, numServers = 5, maxArrivals = 10, showSkyline = 7)
 }

 # Visualizing msq with a set seed, finite queue capacity, 20 arrivals,
 # and showing queue (default) and skyline for all 3 attributes
 msq(seed = 1234, numServers = 5, maxArrivals = 25, showSkyline = 7,
     maxInSystem = 5, plotDelay = 0)

 # Using default distributions to simulate an M/G/2 queue
 msq(seed = 1234, maxDepartures = 10, 
     interarrivalType = "M", serviceType = "G", plotDelay = 0)

</code></pre>

<hr>
<h2 id='quantileTPS'>Sample Quantiles of Time-Persistent Statistics (TPS)</h2><span id='topic+quantileTPS'></span>

<h3>Description</h3>

<p>Computes the sample quantiles of a time-persistent
function, corresponding to the given probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileTPS(times = NULL, numbers = NULL, probs = c(0, 0.25, 0.5, 0.75, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileTPS_+3A_times">times</code></td>
<td>
<p>A numeric vector of non-decreasing time observations</p>
</td></tr>
<tr><td><code id="quantileTPS_+3A_numbers">numbers</code></td>
<td>
<p>A numeric vector containing the values of the
time-persistent statistic between the time observation</p>
</td></tr>
<tr><td><code id="quantileTPS_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities with values in [0,1]</p>
</td></tr>
</table>


<h3>Details</h3>

<div class="sourceCode"><pre>   The lengths of \code{times} and \code{numbers} either must be
the same, or \code{times} may have one more entry than \code{numbers}
(interval endpoints vs. interval counts).  The sample quantiles are calculated
by determining the length of time spent in each state, sorting these times,
then calculating the quantiles associated with the values in the \code{prob}
vector in the same fashion as one would calculate quantiles associated with
a univariate discrete probability distribution.
</pre></div>


<h3>Value</h3>

<p>a vector of the sample quantiles of the time-persistent function provided
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> times  &lt;- c(1,2,3,4,5)
 counts &lt;- c(1,2,1,1,2)
 meanTPS(times, counts)
 sdTPS(times, counts)
 quantileTPS(times, counts)

 output &lt;- ssq(seed = 54321, maxTime = 100, saveNumInSystem = TRUE)
 utilization &lt;- meanTPS(output$numInSystemT, output$numInSystemN)
 sdServerStatus &lt;- sdTPS(output$numInSystemT, output$numInSystemN)
 quantileServerStatus &lt;- quantileTPS(output$numInSystemT, output$numInSystemN)

 # compute and graphically display quantiles of number in system vs time
 output &lt;- ssq(maxArrivals = 60, seed = 54321, saveAllStats = TRUE)
 quantileSys &lt;- quantileTPS(output$numInSystemT, output$numInSystemN)
 plot(output$numInSystemT, output$numInSystemN, type = "s", bty = "l",
     las = 1, xlab = "time", ylab = "number in system")
 labels &lt;- c("0%", "25%", "50%", "75%", "100%")
 mtext(text = labels, side = 4, at = quantileSys, las = 1, col = "red")
 abline(h = quantileSys, lty = "dashed", col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='queueTrace'>Trace Data for Single-Server Queue Simulation</h2><span id='topic+queueTrace'></span>

<h3>Description</h3>

<p>This data set contains the arrival and service times for 1000 jobs
arriving to a generic single-server queue.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>queueTrace
</code></pre>


<h3>Format</h3>

<p>A list of two vectors, <code>arrivalTimes</code> and <code>serviceTimes</code>.
</p>


<h3>Details</h3>

<p>This trace data could be used as input for the <a href="#topic+ssq">ssq</a> function, but not
directly.  That is, <a href="#topic+ssq">ssq</a> expects interarrival and service functions as
input, not vectors of arrival times and service times.  Accordingly, the user
will need to write functions to extract the interarrival and service times
from this trace, which can then be passed to <a href="#topic+ssq">ssq</a>.  See examples below.
</p>


<h3>Source</h3>

<p>Discrete-Event Simulation: A First Course (2006).
L.M. Leemis and S.K. Park.
Pearson/Prentice Hall, Upper Saddle River, NJ.
ISBN-13: 978-0131429178
</p>


<h3>Examples</h3>

<pre><code class='language-R'>interarrivalTimes   &lt;- c(queueTrace$arrivalTimes[1], diff(queueTrace$arrivalTimes))
serviceTimes        &lt;- queueTrace$serviceTimes

avgInterarrivalTime &lt;- mean(interarrivalTimes)
avgServiceTime      &lt;- mean(serviceTimes)

# functions to use this trace data for the ssq() function;
# note that the functions below destroy the global values of the copied
# interarrivalTimes and serviceTimes vectors along the way...
#
interarrivalTimes &lt;- NULL
serviceTimes      &lt;- NULL
getInterarr &lt;- function(...)
{
   if (length(interarrivalTimes) == 0) {
          interarrivalTimes &lt;- c(queueTrace$arrivalTimes[1],
                                  diff(queueTrace$arrivalTimes))
    }
    nextInterarr &lt;- interarrivalTimes[1]
    interarrivalTimes &lt;- interarrivalTimes[-1]
    return(nextInterarr)
}
getService &lt;- function(...)
{
    if (length(serviceTimes) == 0) {
        serviceTimes &lt;- queueTrace$serviceTimes
    }
    nextService &lt;- serviceTimes[1]
    serviceTimes &lt;- serviceTimes[-1] 
    return(nextService)
}
ssq(maxArrivals = 1000, interarrivalFcn = getInterarr, serviceFcn = getService)

</code></pre>

<hr>
<h2 id='sample'>Random Samples</h2><span id='topic+sample'></span>

<h3>Description</h3>

<p><code>sample</code> takes a sample of the specified size from the
elements of <code>x</code>, either with or without replacement, and with
capability to use independent streams and antithetic variates in the draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample(
  x,
  size,
  replace = FALSE,
  prob = NULL,
  stream = NULL,
  antithetic = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_+3A_x">x</code></td>
<td>
<p>Either a vector of one or more elements from which to choose,
or a positive integer</p>
</td></tr>
<tr><td><code id="sample_+3A_size">size</code></td>
<td>
<p>A non-negative integer giving the number of items to choose</p>
</td></tr>
<tr><td><code id="sample_+3A_replace">replace</code></td>
<td>
<p>If <code>FALSE</code> (default), sampling is without replacement;
otherwise, sample is with replacement</p>
</td></tr>
<tr><td><code id="sample_+3A_prob">prob</code></td>
<td>
<p>A vector of probability weights for obtaining the elements
of the vector being sampled</p>
</td></tr>
<tr><td><code id="sample_+3A_stream">stream</code></td>
<td>
<p>If <code>NULL</code> (default), directly calls <code>base::sample</code>
and returns its result; otherwise, an integer in 1:100
indicates the <code>rstream</code> stream used to generate the sample</p>
</td></tr>
<tr><td><code id="sample_+3A_antithetic">antithetic</code></td>
<td>
<p>If <code>FALSE</code> (default), uses <code class="reqn">u</code> = uniform(0,1)
variate(s)generated via <code>rstream::rstream.sample</code> to
generate the sample; otherwise, uses <code class="reqn">1 - u</code>.
(NB: ignored if <code>stream</code> is <code>NULL</code>.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>stream</code> is <code>NULL</code>, sampling is done by direct call to
<code><a href="base.html#topic+sample.int">base::sample</a></code> (refer to its documentation for details).
In this case, a value of <code>TRUE</code> for <code>antithetic</code> is ignored.
</p>
<p>The remainder of details below presume that <code>stream</code> has a positive
integer value, corresponding to use of the <code><a href="#topic+vunif">vunif</a></code> variate
generator for generating the random sample.
</p>
<p>If <code>x</code> has length 1 and is numeric, sampling takes place from <code>1:x</code>
only if <code>x</code> is a positive integer; otherwise, sampling takes place using
the single value of <code>x</code> provided (either a floating-point value or a
non-positive integer).  Otherwise <code>x</code> can be a valid R vector, list, or
data frame from which to sample.
</p>
<p>The default for <code>size</code> is the number of items inferred from <code>x</code>,
so that <code>sample(x, stream = </code><code class="reqn">m</code><code>)</code> generates a
random permutation of the elements of <code>x</code> (or <code>1:x</code>) using random
number stream <code class="reqn">m</code>.
</p>
<p>It is allowed to ask for <code>size = 0</code> samples (and only then is a
zero-length <code>x</code> permitted), in which case
<code><a href="base.html#topic+sample.int">base::sample</a></code> is invoked to return the correct
(empty) data type.
</p>
<p>The optional <code>prob</code> argument can be used to give a vector of probabilities
for obtaining the elements of the vector being sampled. Unlike
<code><a href="base.html#topic+sample.int">base::sample</a></code>, the weights here must sum to one.
If <code>replace</code> is false, these probabilities are applied successively;
that is the probability of choosing the next item is proportional to the
weights among the remaining items. The number of nonzero probabilities must
be at least <code>size</code> in this case.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a single positive integer, <code>sample</code> returns a vector
drawn from the integers <code>1:x</code>.
Otherwise, <code>sample</code> returns a vector, list, or data frame consistent
with <code>typeof(x)</code>.
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sample.int">base::sample</a></code>, <code><a href="#topic+vunif">vunif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)

 # use base::sample (since stream is NULL) to generate a permutation of 1:5
 sample(5)

 # use vunif(1, stream = 1) to generate a permutation of 1:5
 sample(5, stream = 1)

 # generate a (boring) sample of identical values drawn using the single value 867.5309
 sample(867.5309, size = 10, replace = TRUE, stream = 1)

 # use vunif(1, stream = 1) to generate a size-10 sample drawn from 7:9
 sample(7:9, size = 10, replace = TRUE, stream = 1)

 # use vunif(1, stream = 1) to generate a size-10 sample drawn from c('x','y','z')
 sample(c('x','y','z'), size = 10, replace = TRUE, stream = 1)

 # use vunif(1, stream = 1) to generate a size-5 sample drawn from a list
 mylist &lt;- list()
 mylist$a &lt;- 1:5
 mylist$b &lt;- 2:6
 mylist$c &lt;- 3:7
 sample(mylist, size = 5, replace = TRUE, stream = 1)

 # use vunif(1, stream = 1) to generate a size-5 sample drawn from a data frame
 mydf &lt;- data.frame(a = 1:6, b = c(1:3, 1:3))
 sample(mydf, size = 5, replace = TRUE, stream = 1)

</code></pre>

<hr>
<h2 id='sdTPS'>Standard Deviation of Time-Persistent Statistics (TPS)</h2><span id='topic+sdTPS'></span>

<h3>Description</h3>

<p>Computes the sample standard deviation of a time-persistent
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdTPS(times = NULL, numbers = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdTPS_+3A_times">times</code></td>
<td>
<p>A numeric vector of non-decreasing time observations</p>
</td></tr>
<tr><td><code id="sdTPS_+3A_numbers">numbers</code></td>
<td>
<p>A numeric vector containing the values of the
time-persistent statistic between the time observation</p>
</td></tr>
</table>


<h3>Details</h3>

<div class="sourceCode"><pre>The lengths of \code{times} and \code{numbers} either must be
the same, or \code{times} may have one more entry than \code{numbers}
(interval endpoints vs. interval counts). The sample variance is the
area under the square of the step-function created by the values in
\code{numbers} between the first and last element in \code{times} divided
by the length of the observation period, less the square of the sample mean.
The sample standard deviation is the square root of the sample variance.
</pre></div>


<h3>Value</h3>

<p>the sample standard deviation of the time-persistent function provided
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'> times  &lt;- c(1,2,3,4,5)
 counts &lt;- c(1,2,1,1,2)
 meanTPS(times, counts)
 sdTPS(times, counts)

 output &lt;- ssq(seed = 54321, maxTime = 100, saveServerStatus = TRUE)
 utilization &lt;- meanTPS(output$serverStatusT, output$serverStatusN)
 sdServerStatus &lt;- sdTPS(output$serverStatusT, output$serverStatusN)

 # compute and graphically display mean and sd of number in system vs time
 output &lt;- ssq(maxArrivals = 60, seed = 54321, saveAllStats = TRUE)
 plot(output$numInSystemT, output$numInSystemN, type = "s", bty = "l",
    las = 1, xlab = "time", ylab = "number in system")
 meanSys &lt;- meanTPS(output$numInSystemT, output$numInSystemN)
 sdSys   &lt;- sdTPS(output$numInSystemT, output$numInSystemN)
 abline(h = meanSys, lty = "solid", col = "red", lwd = 2)
 abline(h = c(meanSys - sdSys, meanSys + sdSys),
    lty = "dashed", col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='set.seed'>Seeding Random Variate Generators</h2><span id='topic+set.seed'></span>

<h3>Description</h3>

<p><code>set.seed</code> in the <code>simEd</code> package allows the user to simultaneously
set the initial seed for both the <code>stats</code> and <code>simEd</code> variate
generators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.seed(seed, kind = NULL, normal.kind = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.seed_+3A_seed">seed</code></td>
<td>
<p>A single value, interpreted as an integer, or <code>NULL</code>
(see 'Details')</p>
</td></tr>
<tr><td><code id="set.seed_+3A_kind">kind</code></td>
<td>
<p>Character or <code>NULL</code>. This is passed verbatim to
<code>base::set.seed</code>.</p>
</td></tr>
<tr><td><code id="set.seed_+3A_normal.kind">normal.kind</code></td>
<td>
<p>Character or <code>NULL</code>. This is passed verbatim to
<code>base::set.seed</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function intentionally masks the <code>base::set.seed</code> function,
allowing the user to simultaneously set the initial seed for the
<code>stats</code> variate generators (by explicitly calling <code>base::set.seed</code>)
and for the <code>simEd</code> variate generators (by explicitly setting up
10 streams using the <code>rstream.mrg32k3a</code> generator from the
<code>rstream</code> package).
</p>
<p>Any call to <code>set.seed</code> re-initializes the seed for the <code>stats</code>
and <code>simEd</code> generators as if no seed had been set.
If called with <code>seed = NULL</code>, both the <code>stats</code> and <code>simEd</code>
variate generators are re-initialized using a random seed based on the
system clock.
</p>
<p>If the user wishes to set the seed for the <code>stats</code> generators without
affecting the seeds of the <code>simEd</code> generators, an explicit call to
<code>base::set.seed</code> can be made.
</p>
<p>Note that once <code>set.seed</code> is called, advancing the <code>simEd</code> generator
state using any of the stream-based <code>simEd</code> variate generators will not
affect the state of the non-stream-based <code>stats</code> generators, and
vice-versa.
</p>
<p>As soon as the <code>simEd</code> package is attached (i.e., when <code>simEd</code> is
the parent of the global environment), <code>simEd::set.seed</code> becomes the
default for a call to <code>set.seed</code>.  When the <code>simEd</code> package is
detached, <code>base::set.seed</code> will revert to the default.
</p>


<h3>Value</h3>

<p><code>set.seed</code> returns <code>NULL</code>, invisibly, consistent with
<code>base::set.seed</code>.
</p>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+set.seed">base::set.seed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 rexp(3, rate = 2)  # explicit call of stats::rexp

 set.seed(8675309)
 vexp(3, rate = 2)  # also uses stats::rexp

 set.seed(8675309)
 vexp(3, rate = 2, stream = 1) # uses rstream and stats::qexp
 vexp(3, rate = 2, stream = 2)
 rexp(3, rate = 2) # explicit call of stats::rexp, starting with seed 8675309

 set.seed(8675309)
 vexp(1, rate = 2, stream = 1) # uses rstream and stats::qexp
 vexp(1, rate = 2, stream = 2)
 vexp(1, rate = 2, stream = 1)
 vexp(1, rate = 2, stream = 2)
 vexp(1, rate = 2, stream = 1)
 vexp(1, rate = 2, stream = 2)
 vexp(3, rate = 2)             # calls stats::rexp, starting with seed 8675309

</code></pre>

<hr>
<h2 id='simEd-package'>Simulation Education</h2><span id='topic+simEd-package'></span><span id='topic+simEd'></span>

<h3>Description</h3>

<p>Contains various functions to be used for simulation education,
    including simple Monte Carlo simulation functions, queueing simulation
    functions, variate generation functions capable of producing independent
    streams and antithetic variates, functions for illustrating random variate
    generation for various discrete and continuous distributions, and functions
    to compute time-persistent statistics.  Also contains functions for 
    visualizing: event-driven details of a single-server queue model; a Lehmer
    random number generator; variate generation via acceptance-rejection; and
    of generating a non-homogeneous Poisson process via thinning.  Also
    contains two queueing data sets (one fabricated, one real-world) to
    facilitate input modeling.  More details on the use of these functions can
    be found in Lawson and Leemis (2015) &lt;doi:10.1109/WSC.2017.8248124&gt;, in
    Kudlay, Lawson, and Leemis (2020) &lt;doi:10.1109/WSC48552.2020.9384010&gt;, and
    in Lawson and Leemis (2021) &lt;doi:10.1109/WSC52266.2021.9715299&gt;.
</p>
<p><strong>Request From Authors:</strong>
If you adopt and use this package for your simulation course, we would
greatly appreciate were you to email us (addresses below) to let us know,
as we would like to maintain a list of adopters. Please include your name,
university/affiliation, and course name/number. Thanks!
</p>


<h3>Details</h3>

<p>The goal of this package is to facilitate use of R for an introductory
course in discrete-event simulation.
</p>
<p>This package contains animation functions for visualizing:
</p>

<ul>
<li><p> event-driven details of a single-server queue model (<code><a href="#topic+ssqvis">ssqvis</a></code>);
</p>
</li>
<li><p> a Lehmer random number generator (<code><a href="#topic+lehmer">lehmer</a></code>);
</p>
</li>
<li><p> variate generation via acceptance-rejection
(<code><a href="#topic+accrej">accrej</a></code>);
</p>
</li>
<li><p> generation of a non-homogeneous Poisson process via thinning
(<code><a href="#topic+thinning">thinning</a></code>).
</p>
</li></ul>

<p>The package contains variate generators capable of independent streams
(based on Josef Leydold's <code><a href="rstream.html#topic+rstream">rstream</a></code> package) and antithetic
variates for four discrete and eleven continuous distributions:
</p>

<ul>
<li><p> discrete: <code><a href="#topic+vbinom">vbinom</a></code>, <code><a href="#topic+vgeom">vgeom</a></code>,
<code><a href="#topic+vnbinom">vnbinom</a></code>, <code><a href="#topic+vpois">vpois</a></code>
</p>
</li>
<li><p> continuous: <code><a href="#topic+vbeta">vbeta</a></code>, <code><a href="#topic+vcauchy">vcauchy</a></code>,
<code><a href="#topic+vchisq">vchisq</a></code>, <code><a href="#topic+vexp">vexp</a></code>, <code><a href="#topic+vgamma">vgamma</a></code>,
<code><a href="#topic+vlnorm">vlnorm</a></code>, <code><a href="#topic+vlogis">vlogis</a></code>, <code><a href="#topic+vnorm">vnorm</a></code>,
<code><a href="#topic+vt">vt</a></code>, <code><a href="#topic+vunif">vunif</a></code>, <code><a href="#topic+vweibull">vweibull</a></code>
</p>
</li></ul>

<p>All of the variate generators use inversion, and are therefore monotone and
synchronized.
</p>
<p>The package contains functions to visualize variate generation for the same
four discrete and eleven continuous distributions:
</p>

<ul>
<li><p> discrete: <code><a href="#topic+ibinom">ibinom</a></code>, <code><a href="#topic+igeom">igeom</a></code>,
<code><a href="#topic+inbinom">inbinom</a></code>, <code><a href="#topic+ipois">ipois</a></code>
</p>
</li>
<li><p> continuous: <code><a href="#topic+ibeta">ibeta</a></code>, <code><a href="#topic+icauchy">icauchy</a></code>,
<code><a href="#topic+ichisq">ichisq</a></code>, <code><a href="#topic+iexp">iexp</a></code>, <code><a href="#topic+igamma">igamma</a></code>,
<code><a href="#topic+ilnorm">ilnorm</a></code>, <code><a href="#topic+ilogis">ilogis</a></code>, <code><a href="#topic+inorm">inorm</a></code>,
<code><a href="#topic+it">it</a></code>, <code><a href="#topic+iunif">iunif</a></code>, <code><a href="#topic+iweibull">iweibull</a></code>
</p>
</li></ul>

<p>The package also contains functions that are event-driven simulation
implementations of a single-server single-queue system and of a
multiple-server single-queue system:
</p>

<ul>
<li><p> single-server: <code><a href="#topic+ssq">ssq</a></code>
</p>
</li>
<li><p> multiple-server: <code><a href="#topic+msq">msq</a></code>
</p>
</li></ul>

<p>Both queueing functions are extensible in allowing the user to provide custom
arrival and service process functions.  As of version 2.0.0, both of these
functions provide animation capability.
</p>
<p>The package contains functions that implement Monte Carlo simulation
approaches for estimating probabilities in two different dice games:
</p>

<ul>
<li><p> Galileo's dice problem: <code><a href="#topic+galileo">galileo</a></code>
</p>
</li>
<li><p> craps: <code><a href="#topic+craps">craps</a></code>
</p>
</li></ul>

<p>The package contains three functions for computing time-persistent statistics:
</p>

<ul>
<li><p> time-average mean: <code><a href="#topic+meanTPS">meanTPS</a></code>
</p>
</li>
<li><p> time-average standard deviation: <code><a href="#topic+sdTPS">sdTPS</a></code>
</p>
</li>
<li><p> time-average quantiles: <code><a href="#topic+quantileTPS">quantileTPS</a></code>
</p>
</li></ul>

<p>The package also masks two functions from the <code><a href="stats.html#topic+stats">stats</a></code> package:
</p>

<ul>
<li> <p><code><a href="#topic+set.seed">set.seed</a></code>, which explicitly calls the <code><a href="stats.html#topic+stats">stats</a></code>
version in addition to setting up seeds for the independent streams in
the package;
</p>
</li>
<li> <p><code><a href="#topic+sample">sample</a></code>, which provides capability to use independent
streams and antithetic variates.
</p>
</li></ul>

<p>Finally, the package provides two queueing data sets to facilitate input
modeling:
</p>

<ul>
<li> <p><code><a href="#topic+queueTrace">queueTrace</a></code>, which contains 1000 arrival times and
1000 service times (all fabricated) for a single-server queueing
system;
</p>
</li>
<li> <p><code><a href="#topic+tylersGrill">tylersGrill</a></code>, which contains 1434 arrival times and
110 (sampled) service times corresponding to actual data collected
during one business day at Tyler's Grill at the University of Richmond.
</p>
</li></ul>



<h3>Acknowledgments</h3>

<p>The authors would like to thank Dr. Barry L. Nelson, Walter P. Murphy
Professor in the Department of Industrial Engineering &amp; Management Sciences
at Northwestern University, for meaningful feedback during the development of
this package.
</p>


<h3>Author(s)</h3>

<p>Barry Lawson [aut, cre, cph],
  Larry Leemis [aut],
  Vadim Kudlay [aut]
Maintainer: Barry Lawson &lt;blawson@bates.edu&gt;
</p>

<hr>
<h2 id='ssq'>Single-Server Queue Simulation</h2><span id='topic+ssq'></span>

<h3>Description</h3>

<p>A next-event simulation of a single-server queue, with
extensible arrival and service processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssq(
  maxArrivals = Inf,
  seed = NA,
  interarrivalFcn = NULL,
  serviceFcn = NULL,
  interarrivalType = "M",
  serviceType = "M",
  maxTime = Inf,
  maxDepartures = Inf,
  maxInSystem = Inf,
  maxEventsPerSkyline = 15,
  saveAllStats = FALSE,
  saveInterarrivalTimes = FALSE,
  saveServiceTimes = FALSE,
  saveWaitTimes = FALSE,
  saveSojournTimes = FALSE,
  saveNumInQueue = FALSE,
  saveNumInSystem = FALSE,
  saveServerStatus = FALSE,
  showOutput = TRUE,
  animate = FALSE,
  showQueue = NULL,
  showSkyline = NULL,
  showSkylineSystem = FALSE,
  showSkylineQueue = FALSE,
  showSkylineServer = FALSE,
  showTitle = TRUE,
  showProgress = TRUE,
  plotQueueFcn = defaultPlotSSQ,
  plotSkylineFcn = defaultPlotSkyline,
  jobImage = NA,
  plotDelay = NA,
  respectLayout = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssq_+3A_maxarrivals">maxArrivals</code></td>
<td>
<p>maximum number of customer arrivals allowed to enter the system</p>
</td></tr>
<tr><td><code id="ssq_+3A_seed">seed</code></td>
<td>
<p>initial seed to the random number generator (NA uses current state of
random number generator; NULL seeds using system clock)</p>
</td></tr>
<tr><td><code id="ssq_+3A_interarrivalfcn">interarrivalFcn</code></td>
<td>
<p>function for generating interarrival times for queue simulation.
Default value (<code>NA</code>) will result in use of default interarrival
function based on <code>interarrivalType</code>.  See examples.</p>
</td></tr>
<tr><td><code id="ssq_+3A_servicefcn">serviceFcn</code></td>
<td>
<p>function for generating service times for queue simulation.
Default value (<code>NA</code>) will result in use of default service function
based on <code>serviceType</code>.  See examples.</p>
</td></tr>
<tr><td><code id="ssq_+3A_interarrivaltype">interarrivalType</code></td>
<td>
<p>string representation of desired interarrival process.
Options are &quot;M&quot; &ndash; exponential with rate 1;
&quot;G&quot; &ndash; uniform(0,2), having mean 1; and &quot;D&quot; &ndash; deterministic with
constant value 1.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="ssq_+3A_servicetype">serviceType</code></td>
<td>
<p>string representation of desired service process .
Options are &quot;M&quot; &ndash; exponential with rate 10/9;
&quot;G&quot; &ndash; uniform(0, 1.8), having mean 9/10; and &quot;D&quot; &ndash;
deterministic with constant value 9/10.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="ssq_+3A_maxtime">maxTime</code></td>
<td>
<p>maximum time to simulate</p>
</td></tr>
<tr><td><code id="ssq_+3A_maxdepartures">maxDepartures</code></td>
<td>
<p>maximum number of customer departures to process</p>
</td></tr>
<tr><td><code id="ssq_+3A_maxinsystem">maxInSystem</code></td>
<td>
<p>maximum number of customers that the system can hold (server(s) plus queue).
Infinite by default.</p>
</td></tr>
<tr><td><code id="ssq_+3A_maxeventsperskyline">maxEventsPerSkyline</code></td>
<td>
<p>maximum number of events viewable at a time in the skyline plot.
A large value for this parameter may result in plotting delays.
This parameter does not impact the final plotting, which will show all
end-of-simulation results.</p>
</td></tr>
<tr><td><code id="ssq_+3A_saveallstats">saveAllStats</code></td>
<td>
<p>if <code>TRUE</code>, returns all vectors of statistics (see below)
collected by the simulation</p>
</td></tr>
<tr><td><code id="ssq_+3A_saveinterarrivaltimes">saveInterarrivalTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all interarrival times generated</p>
</td></tr>
<tr><td><code id="ssq_+3A_saveservicetimes">saveServiceTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all service times generated</p>
</td></tr>
<tr><td><code id="ssq_+3A_savewaittimes">saveWaitTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all wait times (in the queue) generated</p>
</td></tr>
<tr><td><code id="ssq_+3A_savesojourntimes">saveSojournTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all sojourn times (time spent in the system)
generated</p>
</td></tr>
<tr><td><code id="ssq_+3A_savenuminqueue">saveNumInQueue</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the queue changes</p>
</td></tr>
<tr><td><code id="ssq_+3A_savenuminsystem">saveNumInSystem</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the system changes</p>
</td></tr>
<tr><td><code id="ssq_+3A_saveserverstatus">saveServerStatus</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of
server status (0:idle, 1:busy) for whenever the status changes</p>
</td></tr>
<tr><td><code id="ssq_+3A_showoutput">showOutput</code></td>
<td>
<p>if <code>TRUE</code>, displays summary statistics upon completion</p>
</td></tr>
<tr><td><code id="ssq_+3A_animate">animate</code></td>
<td>
<p>logical; if <code>FALSE</code>, no animation plots will be shown.</p>
</td></tr>
<tr><td><code id="ssq_+3A_showqueue">showQueue</code></td>
<td>
<p>logical; if <code>TRUE</code>, displays a visualization of the queue</p>
</td></tr>
<tr><td><code id="ssq_+3A_showskyline">showSkyline</code></td>
<td>
<p>If <code>NULL</code> (default), defers to each individual showSkyline...
parameter below; otherwise, supersedes individual showSkyline...
parameter values.
If <code>TRUE</code>, displays full skyline plot; <code>FALSE</code> suppresses
skyline plot. Can alternatively be specified using chmod-like octal
component specification: use 1, 2, 4 for system, queue, and server
respectively, summing to indicate desired combination (e.g., 7 for all).
Can also be specified as a binary vector (e.g., c(1,1,1) for all).</p>
</td></tr>
<tr><td><code id="ssq_+3A_showskylinesystem">showSkylineSystem</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in system
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssq_+3A_showskylinequeue">showSkylineQueue</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in queue
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssq_+3A_showskylineserver">showSkylineServer</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in server
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssq_+3A_showtitle">showTitle</code></td>
<td>
<p>if <code>TRUE</code>, display title at the top of the main plot</p>
</td></tr>
<tr><td><code id="ssq_+3A_showprogress">showProgress</code></td>
<td>
<p>if TRUE, displays a progress bar on screen during no-animation execution</p>
</td></tr>
<tr><td><code id="ssq_+3A_plotqueuefcn">plotQueueFcn</code></td>
<td>
<p>plotting function to display queue visualization.
By default, this is provided by <code>defaultPlotSSQ</code>. Please refer to
that associated help for more details about required arguments.</p>
</td></tr>
<tr><td><code id="ssq_+3A_plotskylinefcn">plotSkylineFcn</code></td>
<td>
<p>plotting function to display Skyline visualization.
By default, this is provided by <code>defaultPlotSkyline</code>.  Please refer
to that associated help for more details about required arguments.</p>
</td></tr>
<tr><td><code id="ssq_+3A_jobimage">jobImage</code></td>
<td>
<p>a vector of URLs/local addresses of images to use as jobs. Requires
package <code>'magick'</code>.</p>
</td></tr>
<tr><td><code id="ssq_+3A_plotdelay">plotDelay</code></td>
<td>
<p>a positive numeric value indicating seconds between plots.
A value of -1 enters 'interactive' mode, where the state will pause
for user input at each step.  A value of 0 will display only the final
end-of-simulation plot.</p>
</td></tr>
<tr><td><code id="ssq_+3A_respectlayout">respectLayout</code></td>
<td>
<p>logical; if <code>TRUE</code>, plot layout (i.e. par, device, etc.) settings
will be respected.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a next-event implementation of a single-server queue simulation.
</p>
<p>The <code>seed</code> parameter can take one of three valid
argument types:
</p>

<ul>
<li> <p><code>NA</code> (default), which will use the current state of the random
number generator without explicitly setting a new seed (see examples);
</p>
</li>
<li><p> a positive integer, which will be used as the initial seed passed in
an explicit call to <code><a href="#topic+set.seed">set.seed</a></code>; or
</p>
</li>
<li> <p><code>NULL</code>, which will be passed in an explicit call to to
<code><a href="#topic+set.seed">set.seed</a></code>, thereby setting the initial seed using the
system clock.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list containing:
</p>

<ul>
<li><p> the number of arrivals to the system (<code>customerArrivals</code>),
</p>
</li>
<li><p> the number of customers processed (<code>customerDepartures</code>),
</p>
</li>
<li><p> the ending time of the simulation (<code>simulationEndTime</code>),
</p>
</li>
<li><p> average wait time in the queue (<code>avgWait</code>),
</p>
</li>
<li><p> average time in the system (<code>avgSojourn</code>),
</p>
</li>
<li><p> average number in the system (<code>avgNumInSystem</code>),
</p>
</li>
<li><p> average number in the queue (<code>avgNumInQueue</code>), and
</p>
</li>
<li><p> server utilization (<code>utilization</code>).
</p>
</li></ul>

<p>of the queue as computed by the simulation.
When requested via the &ldquo;save...&rdquo; parameters, the list may also contain:
</p>

<ul>
<li><p> a vector of interarrival times (<code>interarrivalTimes</code>),
</p>
</li>
<li><p> a vector of wait times (<code>waitTimes</code>),
</p>
</li>
<li><p> a vector of service times (<code>serviceTimes</code>),
</p>
</li>
<li><p> a vector of sojourn times (<code>sojournTimes</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the system
(<code>numInSystemT</code>, <code>numInSystemN</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the queue
(<code>numInQueueT</code>, <code>numInQueueN</code>), and
</p>
</li>
<li><p> two vectors (time and status) noting changes to server status
(<code>serverStatusT</code>, <code>serverStatusN</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # process 100 arrivals, R-provided seed (via NULL seed)
 ssq(100, NULL)

 ssq(maxArrivals = 100, seed = 54321)
 ssq(maxDepartures = 100, seed = 54321)
 ssq(maxTime = 100, seed = 54321)

 ############################################################################
 # example to show use of seed = NA (default) to rely on current state of generator
 output1 &lt;- ssq(200, 8675309, showOutput = FALSE, saveAllStats = TRUE)
 output2 &lt;- ssq(300,          showOutput = FALSE, saveAllStats = TRUE)
 set.seed(8675309)
 output3 &lt;- ssq(200,          showOutput = FALSE, saveAllStats = TRUE)
 output4 &lt;- ssq(300,          showOutput = FALSE, saveAllStats = TRUE)
 sum(output1$sojournTimes != output3$sojournTimes) # should be zero
 sum(output2$sojournTimes != output4$sojournTimes) # should be zero

 myArrFcn &lt;- function() { vexp(1, rate = 1/4, stream = 1)  }  # mean is 4
 mySvcFcn &lt;- function() { vgamma(1, shape = 1, rate = 0.3) }  # mean is 3.3

 output &lt;- ssq(maxArrivals = 100, interarrivalFcn = myArrFcn, serviceFcn = mySvcFcn,
              saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 mean(output$serviceTimes)
 meanTPS(output$numInQueueT, output$numInQueueN) # compute time-averaged num in queue
 meanTPS(output$serverStatusT, output$serverStatusN) # compute server utilization

 ############################################################################
 # example to show use of (simple) trace data for arrivals and service times;
 # ssq() will need one more interarrival (arrival) time than jobs processed
 #
 arrivalTimes      &lt;- NULL
 interarrivalTimes &lt;- NULL
 serviceTimes      &lt;- NULL

 initTimes &lt;- function() {
     arrivalTimes      &lt;&lt;- c(15, 47, 71, 111, 123, 152, 232, 245, 99999)
     interarrivalTimes &lt;&lt;- c(arrivalTimes[1], diff(arrivalTimes))
     serviceTimes      &lt;&lt;- c(43, 36, 34, 30, 38, 30, 31, 29)
 }

 getInterarr &lt;- function() {
     nextInterarr &lt;- interarrivalTimes[1]
     interarrivalTimes &lt;&lt;- interarrivalTimes[-1]  # remove 1st element globally
     return(nextInterarr)
 }

 getService &lt;- function() {
     nextService &lt;- serviceTimes[1]
     serviceTimes &lt;&lt;- serviceTimes[-1]  # remove 1st element globally
     return(nextService)
 }

 initTimes()
 numJobs &lt;- length(serviceTimes)
 output &lt;- ssq(maxArrivals = numJobs, interarrivalFcn = getInterarr,
               serviceFcn = getService, saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 mean(output$serviceTimes)


 ############################################################################
 # example to show use of (simple) trace data for arrivals and service times,
 # allowing for reuse (recycling) of trace data times
 arrivalTimes      &lt;- NULL
 interarrivalTimes &lt;- NULL
 serviceTimes      &lt;- NULL

 initArrivalTimes &lt;- function() {
   arrivalTimes      &lt;&lt;- c(15, 47, 71, 111, 123, 152, 232, 245)
   interarrivalTimes &lt;&lt;- c(arrivalTimes[1], diff(arrivalTimes))
 }

 initServiceTimes &lt;- function() {
     serviceTimes    &lt;&lt;- c(43, 36, 34, 30, 38, 30, 31, 29)
 }

 getInterarr &lt;- function() {
     if (length(interarrivalTimes) == 0)  initArrivalTimes()

     nextInterarr &lt;- interarrivalTimes[1]
     interarrivalTimes &lt;&lt;- interarrivalTimes[-1] # remove 1st element globally
     return(nextInterarr)
 }

 getService &lt;- function() {
     if (length(serviceTimes) == 0)  initServiceTimes()

     nextService &lt;- serviceTimes[1]
     serviceTimes &lt;&lt;- serviceTimes[-1]  # remove 1st element globally
     return(nextService)
 }

 initArrivalTimes()
 initServiceTimes()
 output &lt;- ssq(maxArrivals = 100, interarrivalFcn = getInterarr,
               serviceFcn = getService, saveAllStats = TRUE)
 mean(output$interarrivalTimes)
 mean(output$serviceTimes)

 ############################################################################
 # Testing with visualization

 # Visualizing ssq with a set seed, infinite queue capacity, 20 arrivals,
 # interactive mode (default), showing skyline for all 3 attributes (default)
 if (interactive()) {
   ssq(seed = 1234, maxArrivals = 20, animate = TRUE)
 }

 # Same as above, but jump to final queue visualization using plotDelay 0
 ssq(seed = 1234, maxArrivals = 20, animate = TRUE, plotDelay = 0)

 # Perform simulation again with finite queue of low capacity. Note same
 # variate generation but different outcomes due to rejection pathway
 ssq(seed = 1234, maxArrivals = 25, animate = TRUE, maxInSystem = 5, plotDelay = 0)

 # Using default distributions to simulate a default M/G/1 Queue
 ssq(seed = 1234, maxDepartures = 10, interarrivalType = "M", serviceType = "G", 
     animate = TRUE, plotDelay = 0)

</code></pre>

<hr>
<h2 id='ssqvis'>Single-Server Queue Simulation Visualization</h2><span id='topic+ssqvis'></span>

<h3>Description</h3>

<p>A modified ssq implementation that illustrates event-driven
details, including the event calendar, inversion for interarrival and service
time variate generation, the simulation clock, the status of the queueing
system, and statistics collection. The function plots step-by-step in either
an interactive mode or time-delayed automatic mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssqvis(
  maxArrivals = Inf,
  seed = NA,
  interarrivalType = "M",
  serviceType = "M",
  maxTime = Inf,
  maxDepartures = Inf,
  maxEventsPerSkyline = 15,
  saveAllStats = FALSE,
  saveInterarrivalTimes = FALSE,
  saveServiceTimes = FALSE,
  saveWaitTimes = FALSE,
  saveSojournTimes = FALSE,
  saveNumInQueue = FALSE,
  saveNumInSystem = FALSE,
  saveServerStatus = FALSE,
  showOutput = TRUE,
  showSkyline = NULL,
  showSkylineQueue = TRUE,
  showSkylineSystem = TRUE,
  showSkylineServer = TRUE,
  showTitle = TRUE,
  jobImage = NA,
  plotDelay = -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssqvis_+3A_maxarrivals">maxArrivals</code></td>
<td>
<p>maximum number of customer arrivals allowed to enter the system</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_seed">seed</code></td>
<td>
<p>initial seed to the random number generator (NA uses current state of
random number generator; NULL seeds using system clock)</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_interarrivaltype">interarrivalType</code></td>
<td>
<p>string representation of desired interarrival process.
Options are &quot;M&quot; &ndash; exponential with rate 1;
&quot;G&quot; &ndash; uniform(0,2), having mean 1; and &quot;D&quot; &ndash; deterministic with
constant value 1.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_servicetype">serviceType</code></td>
<td>
<p>string representation of desired service process .
Options are &quot;M&quot; &ndash; exponential with rate 10/9;
&quot;G&quot; &ndash; uniform(0, 1.8), having mean 9/10; and &quot;D&quot; &ndash;
deterministic with constant value 9/10.  Default is &quot;M&quot;.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_maxtime">maxTime</code></td>
<td>
<p>maximum time to simulate</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_maxdepartures">maxDepartures</code></td>
<td>
<p>maximum number of customer departures to process</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_maxeventsperskyline">maxEventsPerSkyline</code></td>
<td>
<p>maximum number of events viewable at a time in the skyline plot.
A large value for this parameter may result in plotting delays.
This parameter does not impact the final plotting, which will show all
end-of-simulation results.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_saveallstats">saveAllStats</code></td>
<td>
<p>if <code>TRUE</code>, returns all vectors of statistics (see below)
collected by the simulation</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_saveinterarrivaltimes">saveInterarrivalTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all interarrival times generated</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_saveservicetimes">saveServiceTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all service times generated</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_savewaittimes">saveWaitTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all wait times (in the queue) generated</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_savesojourntimes">saveSojournTimes</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of all sojourn times (time spent in the system)
generated</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_savenuminqueue">saveNumInQueue</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the queue changes</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_savenuminsystem">saveNumInSystem</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of counts for whenever
the number in the system changes</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_saveserverstatus">saveServerStatus</code></td>
<td>
<p>if <code>TRUE</code>, returns a vector of times and a vector of
server status (0:idle, 1:busy) for whenever the status changes</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showoutput">showOutput</code></td>
<td>
<p>if <code>TRUE</code>, displays summary statistics upon completion</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showskyline">showSkyline</code></td>
<td>
<p>If <code>NULL</code> (default), defers to each individual showSkyline...
parameter below; otherwise, supersedes individual showSkyline...
parameter values.
If <code>TRUE</code>, displays full skyline plot; <code>FALSE</code> suppresses
skyline plot. Can alternatively be specified using chmod-like octal
component specification: use 1, 2, 4 for system, queue, and server
respectively, summing to indicate desired combination (e.g., 7 for all).
Can also be specified as a binary vector (e.g., c(1,1,1) for all).</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showskylinequeue">showSkylineQueue</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in queue
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showskylinesystem">showSkylineSystem</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in system
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showskylineserver">showSkylineServer</code></td>
<td>
<p>logical; if <code>TRUE</code>, includes number in server
as part of skyline plot.  Value for <code>showSkyline</code>
supersedes this parameter's value.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_showtitle">showTitle</code></td>
<td>
<p>if <code>TRUE</code>, display title at the top of the main plot</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_jobimage">jobImage</code></td>
<td>
<p>a vector of URLs/local addresses of images to use as jobs. Requires
package <code>'magick'</code>.</p>
</td></tr>
<tr><td><code id="ssqvis_+3A_plotdelay">plotDelay</code></td>
<td>
<p>a positive numeric value indicating seconds between plots.
A value of -1 enters 'interactive' mode, where the state will pause
for user input at each step.  A value of 0 will display only the final
end-of-simulation plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Animates the details of an event-driven implementation of a single-server
queue simulation.
</p>
<p>The event calendar, inversion for interarrival and service time variates,
and an abbreviated (current) timeline are animated in the top pane of the
window.  In this pane, blue corresponds to the arrival process, orange
corresponds to the service process, and purple corresponds to uniform
variates used in inversion.  Yellow is used to highlight recent updates.
</p>
<p>The state of the queueing system is animated in the middle pane of the
window.  In this pane, red indicates an idle server, orange indicates that
a new customer has just arrived to the server and a corresponding service
time is being generated, and green indicates a busy server.  By default,
customers are depicted as black rectangles and identified by increasing
arrival number, but this depiction can be overridden by the <code>jobImage</code>
parameter.
</p>
<p>Statistics are displayed in the bottom pane of the window.  Time-persistent
statistics are shown as &quot;skyline functions&quot; in the left portion of this
pane.  Both time-persistent and based-on-observation statistics are shown
in respective tables in the right portion of this pane. In the tables,
yellow is used to highlight recent updates.
</p>
<p>The <code>seed</code> parameter can take one of three valid
argument types:
</p>

<ul>
<li> <p><code>NA</code> (default), which will use the current state of the random
number generator without explicitly setting a new seed (see examples);
</p>
</li>
<li><p> a positive integer, which will be used as the initial seed passed in
an explicit call to <code><a href="#topic+set.seed">set.seed</a></code>; or
</p>
</li>
<li> <p><code>NULL</code>, which will be passed in an explicit call to to
<code><a href="#topic+set.seed">set.seed</a></code>, thereby setting the initial seed using the
system clock.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list containing:
</p>

<ul>
<li><p> the number of arrivals to the system (<code>customerArrivals</code>),
</p>
</li>
<li><p> the number of customers processed (<code>customerDepartures</code>),
</p>
</li>
<li><p> the ending time of the simulation (<code>simulationEndTime</code>),
</p>
</li>
<li><p> average wait time in the queue (<code>avgWait</code>),
</p>
</li>
<li><p> average time in the system (<code>avgSojourn</code>),
</p>
</li>
<li><p> average number in the system (<code>avgNumInSystem</code>),
</p>
</li>
<li><p> average number in the queue (<code>avgNumInQueue</code>), and
</p>
</li>
<li><p> server utilization (<code>utilization</code>).
</p>
</li></ul>

<p>of the queue as computed by the simulation.
When requested via the &ldquo;save...&rdquo; parameters, the list may also contain:
</p>

<ul>
<li><p> a vector of interarrival times (<code>interarrivalTimes</code>),
</p>
</li>
<li><p> a vector of wait times (<code>waitTimes</code>),
</p>
</li>
<li><p> a vector of service times (<code>serviceTimes</code>),
</p>
</li>
<li><p> a vector of sojourn times (<code>sojournTimes</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the system
(<code>numInSystemT</code>, <code>numInSystemN</code>),
</p>
</li>
<li><p> two vectors (time and count) noting changes to number in the queue
(<code>numInQueueT</code>, <code>numInQueueN</code>), and
</p>
</li>
<li><p> two vectors (time and status) noting changes to server status
(<code>serverStatusT</code>, <code>serverStatusN</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Visualizing ssq with a set seed, infinite queue capacity, 4 arrivals,
 # and showing skyline with number in system, queue, and server.
 ssqvis(seed = 1234, maxArrivals = 4, showSkyline = 7, plotDelay = 0.01)

</code></pre>

<hr>
<h2 id='thinning'>Thinning Algorithm Visualization</h2><span id='topic+thinning'></span>

<h3>Description</h3>

<p>This function animates the &quot;thinning&quot; approach the
generation of the random event times for a non-homogeneous
Poisson process with a specified intensity function, given a
majorizing function that dominates the intensity function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thinning(
  maxTime = 24,
  intensityFcn = function(x) (5 - sin(x/0.955) - (4 * cos(x/3.82)))/0.5,
  majorizingFcn = NULL,
  majorizingFcnType = NULL,
  seed = NA,
  maxTrials = Inf,
  plot = TRUE,
  showTitle = TRUE,
  plotDelay = plot * -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thinning_+3A_maxtime">maxTime</code></td>
<td>
<p>maximum time of the non-homogeneous Poisson process.
(The minimum time is assumed to be zero.)</p>
</td></tr>
<tr><td><code id="thinning_+3A_intensityfcn">intensityFcn</code></td>
<td>
<p>intensity function corresponding to rate of arrivals across
time.</p>
</td></tr>
<tr><td><code id="thinning_+3A_majorizingfcn">majorizingFcn</code></td>
<td>
<p>majorizing function.  Default value is NULL,
corresponding to a constant majorizing function that is
1.01 times the maximum value of the intensity function.
May alternatively be provided as a user-specified function,
or as a data frame requiring additional notation as
either piecewise-constant or piecewise-linear.  See
examples.</p>
</td></tr>
<tr><td><code id="thinning_+3A_majorizingfcntype">majorizingFcnType</code></td>
<td>
<p>used to indicate whether a majorizing function that
is provided via data frame is to be interpreted as
either piecewise-constant (<code>"pwc"</code>) or
piecewise-linear (<code>"pwl"</code>).  If the majorizing
function is either the default or a user-specified
function (closure), the value of this parameter is
ignored.</p>
</td></tr>
<tr><td><code id="thinning_+3A_seed">seed</code></td>
<td>
<p>initial seed for the uniform variates used during
generation.</p>
</td></tr>
<tr><td><code id="thinning_+3A_maxtrials">maxTrials</code></td>
<td>
<p>maximum number of accept-reject trials; infinite by default.</p>
</td></tr>
<tr><td><code id="thinning_+3A_plot">plot</code></td>
<td>
<p>if TRUE, visual display will be produced.  If FALSE,
generated event times will be returned without visual display.</p>
</td></tr>
<tr><td><code id="thinning_+3A_showtitle">showTitle</code></td>
<td>
<p>if TRUE, display title in the main plot.</p>
</td></tr>
<tr><td><code id="thinning_+3A_plotdelay">plotDelay</code></td>
<td>
<p>wait time, in seconds, between plots; -1 (default) for
interactive mode, where the user is queried for input
to progress.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three modes for visualizing Lewis and Shedler's thinning
algorithm for generating random event times for a non-homogeneous
Poisson process with a particular intensity function:
</p>

<ul>
<li><p> interactive advance (<code>plotDelay = -1</code>), where
pressing the 'ENTER' key advances to the next step
(an accepted random variate) in the algorithm,
typing 'j #' jumps ahead # steps,
typing 'q' quits immediately,
and typing 'e' proceeds to the end;
</p>
</li>
<li><p> automatic advance (<code>plotDelay</code> &gt; 0); or
</p>
</li>
<li><p> final visualization only (<code>plotDelay = 0</code>).
</p>
</li></ul>

<p>As an alternative to visualizing, event times can be generated
</p>


<h3>Value</h3>

<p>returns a vector of the generated random event times
</p>


<h3>References</h3>

<p>Lewis, P.A.W. and Shedler, G.S. (1979). Simulation of non-homogeneous Poisson
processes by thinning. <em>Naval Research Logistics</em>, <strong>26</strong>, 403413.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nhpp &lt;- thinning(maxTime = 12, seed = 8675309, plotDelay = 0)
nhpp &lt;- thinning(maxTime = 24, seed = 8675309, plotDelay = 0)


nhpp &lt;- thinning(maxTime = 48, seed = 8675309, plotDelay = 0)

# thinning with custom intensity function and default majorizing function
intensity &lt;- function(x) { 
    day &lt;- 24 * floor(x/24)
    return(80 * (dnorm(x, day + 6,    2.5) + 
                 dnorm(x, day + 12.5, 1.5) + 
                 dnorm(x, day + 19,   2.0)))
}
nhpp &lt;- thinning(maxTime = 24, plotDelay = 0, intensityFcn = intensity)

# thinning with custom intensity and constant majorizing functions
major &lt;- function(x) { 25 }
nhpp &lt;- thinning(maxTime = 24, plotDelay = 0, intensityFcn = intensity,
                 majorizingFcn = major)

# piecewise-constant data.frame for bounding default intensity function
fpwc &lt;- data.frame(
    x = c(0, 2, 20, 30, 44, 48),
    y = c(5, 5, 20, 12, 20,  5)
)
nhpp &lt;- thinning(maxTime = 24, plotDelay = 0, majorizingFcn = fpwc, majorizingFcnType = "pwc")

# piecewise-linear data.frame for bounding default intensity function
fpwl &lt;- data.frame(
    x = c(0, 12, 24, 36, 48),
    y = c(5, 25, 10, 25, 5)
)
nhpp &lt;- thinning(maxTime = 24, plotDelay = 0, majorizingFcn = fpwl, majorizingFcnType = "pwl")

# piecewise-linear closure/function bounding default intensity function
fclo &lt;- function(x) {
    if (x &lt;= 12) (5/3)*x + 5
    else if (x &lt;= 24) 40 - (5/4)*x
    else if (x &lt;= 36) (5/4)*x - 20
    else 85 - (5/3) * x
}
nhpp &lt;- thinning(maxTime = 48, plotDelay = 0, majorizingFcn = fclo)

# thinning with fancy custom intensity function and default majorizing
intensity &lt;- function(x) { 
    day &lt;- 24 * floor(x/24)
    return(80 * (dnorm(x, day + 6,    2.5) + 
                 dnorm(x, day + 12.5, 1.5) + 
                 dnorm(x, day + 19,   2.0)))
}
nhpp &lt;- thinning(maxTime = 24, plotDelay = 0, intensityFcn = intensity)

# piecewise-linear data.frame for bounding custom intensity function
fpwl &lt;- data.frame(
    x = c(0,  6,  9, 12, 16, 19, 24, 30, 33, 36, 40, 43, 48),
    y = c(5, 17, 12, 28, 14, 18,  7, 17, 12, 28, 14, 18,  7)
)
nhpp &lt;- thinning(maxTime = 48, plotDelay = 0, intensityFcn = intensity,
          majorizingFcn = fpwl, majorizingFcnType = "pwl")

# thinning with simple custom intensity function and custom majorizing
intensity &lt;- function(t) {
    if      (t &lt; 12) t
    else if (t &lt; 24) 24 - t
    else if (t &lt; 36) t - 24
    else             48 - t
}
majorizing &lt;- data.frame(
    x = c(0, 12, 24, 36, 48),
    y = c(1, 13,  1, 13,  1))
times &lt;- thinning(plotDelay = 0, intensityFcn = intensity,
    majorizingFcn = majorizing , majorizingFcnType = "pwl", maxTime = 48)


</code></pre>

<hr>
<h2 id='tylersGrill'>Arrival and Service Data for Tyler's Grill (University of Richmond)</h2><span id='topic+tylersGrill'></span>

<h3>Description</h3>

<p>This data set contains a list of two vectors of data.
</p>
<p>The first vector in the list contains the arrival times for 1434 customers
arriving to Tyler's Grill at the University of Richmond during a single day
in 2005.  The arrival times were collected during operating hours, from
07:30 until 21:00.  Arrival times are provided in seconds from opening
(07:30).
</p>
<p>The second vector contains service times sample for 110 customers at Tyler's
Grill in 2005.  Service times are provided in seconds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tylersGrill
</code></pre>


<h3>Format</h3>

<p><code>tylersGrill$arrivalTimes</code> returns the vector of 1434 arrival times.<br />
<code>tylersGrill$serviceTimes</code> returns the vector of 110 service times.
</p>


<h3>Source</h3>

<p>CMSC 326 Simulation course at the University of Richmond, 2005.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>interarr &lt;- c(0, diff(tylersGrill$arrivalTimes))
svc      &lt;- tylersGrill$serviceTimes

avgInterarrivalTime &lt;- mean(interarr)
avgServiceTime      &lt;- mean(svc)

# use method of moments to fit gamma to Tyler's Grill service times
aHat &lt;- mean(svc)^2 / var(svc)
bHat &lt;- var(svc) / mean(svc)
hist(svc, freq = FALSE, las = 1, xlab = "service time", ylab = "density")
x &lt;- 1:max(svc)
curve(dgamma(x, shape = aHat, scale = bHat), add = TRUE, col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='vbeta'>Variate Generation for Beta Distribution</h2><span id='topic+vbeta'></span>

<h3>Description</h3>

<p>Variate Generation for Beta Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vbeta(
  n,
  shape1,
  shape2,
  ncp = 0,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vbeta_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vbeta_+3A_shape1">shape1</code></td>
<td>
<p>Shape parameter 1 (alpha)</p>
</td></tr>
<tr><td><code id="vbeta_+3A_shape2">shape2</code></td>
<td>
<p>Shape parameter 2 (beta)</p>
</td></tr>
<tr><td><code id="vbeta_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (default 0)</p>
</td></tr>
<tr><td><code id="vbeta_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qbeta">stats::qbeta</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qbeta">stats::qbeta</a></code>;</p>
</td></tr>
<tr><td><code id="vbeta_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vbeta_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the beta distribution.
</p>
<p>Beta variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qbeta">stats::qbeta</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vbeta</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The beta distribution has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = \frac{\Gamma(a+b)}{\Gamma(a) \ \Gamma(b)} x^{a-1}(1-x)^{b-1}}{
          f(x) = Gamma(a+b)/(Gamma(a)Gamma(b)) x^(a-1)(1-x)^(b-1)}
</pre></div>
<p>for <code class="reqn">a &gt; 0</code>, <code class="reqn">b &gt; 0</code> and <code class="reqn">0 \leq x \leq 1</code> where the
boundary values at <code class="reqn">x=0</code> or <code class="reqn">x=1</code> are defined as by continuity (as limits).
</p>
<p>The mean is <code class="reqn">\frac{a}{a+b}</code> and the variance is
<code class="reqn">{ab}{(a+b)^2 (a+b+1)}</code>
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of beta random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rbeta">stats::rbeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbeta
 vbeta(3, shape1 = 3, shape2 = 1, ncp = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbeta
 vbeta(3, 3, 1, stream = 1)
 vbeta(3, 3, 1, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbeta
 vbeta(1, 3, 1, stream = 1)
 vbeta(1, 3, 1, stream = 2)
 vbeta(1, 3, 1, stream = 1)
 vbeta(1, 3, 1, stream = 2)
 vbeta(1, 3, 1, stream = 1)
 vbeta(1, 3, 1, stream = 2)

 set.seed(8675309)
 variates &lt;- vbeta(100, 3, 1, stream = 1)
 set.seed(8675309)
 variates &lt;- vbeta(100, 3, 1, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vbinom'>Variate Generation for Binomial Distribution</h2><span id='topic+vbinom'></span>

<h3>Description</h3>

<p>Variate Generation for Binomial Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vbinom(n, size, prob, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vbinom_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vbinom_+3A_size">size</code></td>
<td>
<p>number of trials (zero or more)</p>
</td></tr>
<tr><td><code id="vbinom_+3A_prob">prob</code></td>
<td>
<p>probability of success on each trial (0 <code class="reqn">&lt;</code> <code>prob</code> <code class="reqn">\le</code> 1)</p>
</td></tr>
<tr><td><code id="vbinom_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qbinom">stats::qbinom</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qbinom">stats::qbinom</a></code>;</p>
</td></tr>
<tr><td><code id="vbinom_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vbinom_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the binomial distribution.
</p>
<p>Binomial variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qbinom">stats::qbinom</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vbinom</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The binomial distribution with parameters <code>size</code> = <code class="reqn">n</code> and
<code>prob</code> = <code class="reqn">p</code> has pmf
</p>
<p style="text-align: center;"><code class="reqn">p(x) = {n \choose x} p^x (1-p)^{(n-x)}</code>
</p>

<p>for <code class="reqn">x = 0, \ldots, n</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of binomial random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rbinom">stats::rbinom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbinom
 vbinom(3, size = 10, prob = 0.25)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbinom
 vbinom(3, 10, 0.25, stream = 1)
 vbinom(3, 10, 0.25, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qbinom
 vbinom(1, 10, 0.25, stream = 1)
 vbinom(1, 10, 0.25, stream = 2)
 vbinom(1, 10, 0.25, stream = 1)
 vbinom(1, 10, 0.25, stream = 2)
 vbinom(1, 10, 0.25, stream = 1)
 vbinom(1, 10, 0.25, stream = 2)

 set.seed(8675309)
 variates &lt;- vbinom(100, 10, 0.25, stream = 1)
 set.seed(8675309)
 variates &lt;- vbinom(100, 10, 0.25, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vcauchy'>Variate Generation for Cauchy Distribution</h2><span id='topic+vcauchy'></span>

<h3>Description</h3>

<p>Variate Generation for Cauchy Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcauchy(
  n,
  location = 0,
  scale = 1,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcauchy_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vcauchy_+3A_location">location</code></td>
<td>
<p>Location parameter (default 0)</p>
</td></tr>
<tr><td><code id="vcauchy_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="vcauchy_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qcauchy">stats::qcauchy</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qcauchy">stats::qcauchy</a></code>;</p>
</td></tr>
<tr><td><code id="vcauchy_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vcauchy_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Cauchy distribution.
</p>
<p>Cauchy variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qcauchy">stats::qcauchy</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vcauchy</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<div class="sourceCode"><pre>The Cauchy distribution has density
\deqn{f(x) = \frac{1}{\pi s} \ \left(1 + \left( \frac{x - l}{s} \right)^2
              \right)^{-1}}{
          f(x) = 1 / (\pi s (1 + ((x-l)/s)^2))}
</pre></div>
<p>for all <code class="reqn">x</code>.
</p>
<p>The mean is <code class="reqn">a/(a+b)</code> and the variance is <code class="reqn">ab/((a+b)^2 (a+b+1))</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of Cauchy random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rcauchy">stats::rcauchy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qcauchy
 vcauchy(3, location = 3, scale = 1)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qcauchy
 vcauchy(3, 0, 3, stream = 1)
 vcauchy(3, 0, 3, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qcauchy
 vcauchy(1, 0, 3, stream = 1)
 vcauchy(1, 0, 3, stream = 2)
 vcauchy(1, 0, 3, stream = 1)
 vcauchy(1, 0, 3, stream = 2)
 vcauchy(1, 0, 3, stream = 1)
 vcauchy(1, 0, 3, stream = 2)

 set.seed(8675309)
 variates &lt;- vcauchy(100, 0, 3, stream = 1)
 set.seed(8675309)
 variates &lt;- vcauchy(100, 0, 3, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vchisq'>Variate Generation for Chi-Squared Distribution</h2><span id='topic+vchisq'></span>

<h3>Description</h3>

<p>Variate Generation for Chi-Squared Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vchisq(n, df, ncp = 0, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vchisq_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vchisq_+3A_df">df</code></td>
<td>
<p>Degrees of freedom (non-negative, but can be non-integer)</p>
</td></tr>
<tr><td><code id="vchisq_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter (non-negative)</p>
</td></tr>
<tr><td><code id="vchisq_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qchisq">stats::qchisq</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qchisq">stats::qchisq</a></code>;</p>
</td></tr>
<tr><td><code id="vchisq_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vchisq_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the chi-squared distribution.
</p>
<p>Chi-Squared variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qchisq">stats::qchisq</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vchisq</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The chi-squared distribution with <code>df</code> = <code class="reqn">n \geq 0</code> degrees
of freedom has density
</p>
<div class="sourceCode"><pre>\deqn{f_n(x) = \frac{1}{2^{n/2} \ \Gamma(n/2)} x^{n/2-1} e^{-x/2}}{
          f_n(x) = 1 / (2^(n/2) \Gamma(n/2)) x^(n/2-1) e^(-x/2)}
</pre></div>
<p>for <code class="reqn">x &gt; 0</code>. The mean and variance are <code class="reqn">n</code> and <code class="reqn">2n</code>.
</p>
<p>The non-central chi-squared distribution with <code>df</code> = n degrees of
freedom and non-centrality parameter <code>ncp</code> <code class="reqn">= \lambda</code> has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = e^{-\lambda/2} \sum_{r=0}^\infty \frac{(\lambda/2)^r}{r!} f_{n + 2r}(x)}{
          f(x) = exp(-\lambda/2) SUM_{r=0}^\infty ((\lambda/2)^r / r!) dchisq(x, df + 2r)}
</pre></div>
<p>for <code class="reqn">x \geq 0</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of chi-squared random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rchisq">stats::rchisq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(3, df = 3, ncp = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(3, 3, stream = 1)
 vchisq(3, 3, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qchisq
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)
 vchisq(1, 3, stream = 1)
 vchisq(1, 3, stream = 2)

 set.seed(8675309)
 variates &lt;- vchisq(100, 3, stream = 1)
 set.seed(8675309)
 variates &lt;- vchisq(100, 3, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vexp'>Variate Generation for Exponential Distribution</h2><span id='topic+vexp'></span>

<h3>Description</h3>

<p>Variate Generation for Exponential Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vexp(n, rate = 1, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vexp_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vexp_+3A_rate">rate</code></td>
<td>
<p>Rate of distribution (default 1)</p>
</td></tr>
<tr><td><code id="vexp_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qexp">stats::qexp</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qexp">stats::qexp</a></code>;</p>
</td></tr>
<tr><td><code id="vexp_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vexp_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the exponential distribution.
</p>
<p>Exponential variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qexp">stats::qexp</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vexp</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<div class="sourceCode"><pre> The exponential distribution with rate \eqn{\lambda} has density

     \deqn{f(x) = \lambda e^{-\lambda x}}{
               f(x) = \lambda e^(-\lambda x)}

 for \eqn{x \geq 0}.
</pre></div>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of exponential random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rexp">stats::rexp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qexp
 vexp(3, rate = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qexp
 vexp(3, 2, stream = 1)
 vexp(3, 2, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qexp
 vexp(1, 2, stream = 1)
 vexp(1, 2, stream = 2)
 vexp(1, 2, stream = 1)
 vexp(1, 2, stream = 2)
 vexp(1, 2, stream = 1)
 vexp(1, 2, stream = 2)

 set.seed(8675309)
 variates &lt;- vexp(100, 2, stream = 1)
 set.seed(8675309)
 variates &lt;- vexp(100, 2, stream = 1, antithetic = TRUE)

 set.seed(8675309)
 # NOTE: Default functions for M/M/1 ssq(), ignoring fixed n
 interarrivals &lt;- vexp(1000, rate = 1,    stream = 1)
 services      &lt;- vexp(1000, rate = 10/9, stream = 2)

</code></pre>

<hr>
<h2 id='vfd'>Variate Generation for FALSE Distribution</h2><span id='topic+vfd'></span>

<h3>Description</h3>

<p>Variate Generation for FALSE Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vfd(n, df1, df2, ncp = 0, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vfd_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vfd_+3A_df1">df1</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="vfd_+3A_df2">df2</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="vfd_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter &gt;= 0</p>
</td></tr>
<tr><td><code id="vfd_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qf">stats::qf</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qf">stats::qf</a></code>;</p>
</td></tr>
<tr><td><code id="vfd_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vfd_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the FALSE distribution.
</p>
<p>FALSE variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qf">stats::qf</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vfd</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The F distribution with <code>df1</code> <code class="reqn">= n_1</code> and <code>df2</code>
<code class="reqn">= n_2</code> degrees of freedom has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac {\Gamma(n_1/2 + n_2/2)} {\Gamma(n_1/2) \ \Gamma(n_2/2)}
                \left( \frac{n_1}{n_2} \right)^{n_1/2} x^{n_1/2 - 1}
                \left( 1 + \frac{n_1x}{n_2} \right) ^ {-(n_1 + n_2)/2}</code>
</p>

<p>for <code class="reqn">x &gt; 0</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of FALSE random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rf">stats::rf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qf
 vfd(3, df1 = 1, df2 = 2, ncp = 10)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qf
 vfd(3, 5, 5, stream = 1)
 vfd(3, 5, 5, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qf
 vfd(1, 5, 5, stream = 1)
 vfd(1, 5, 5, stream = 2)
 vfd(1, 5, 5, stream = 1)
 vfd(1, 5, 5, stream = 2)
 vfd(1, 5, 5, stream = 1)
 vfd(1, 5, 5, stream = 2)

 set.seed(8675309)
 variates &lt;- vfd(100, 5, 5, stream = 1)
 set.seed(8675309)
 variates &lt;- vfd(100, 5, 5, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vgamma'>Variate Generation for Gamma Distribution</h2><span id='topic+vgamma'></span>

<h3>Description</h3>

<p>Variate Generation for Gamma Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vgamma(
  n,
  shape,
  rate = 1,
  scale = 1/rate,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vgamma_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vgamma_+3A_shape">shape</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="vgamma_+3A_rate">rate</code></td>
<td>
<p>Alternate parameterization for scale</p>
</td></tr>
<tr><td><code id="vgamma_+3A_scale">scale</code></td>
<td>
<p>Scale parameter</p>
</td></tr>
<tr><td><code id="vgamma_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qgamma">stats::qgamma</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qgamma">stats::qgamma</a></code>;</p>
</td></tr>
<tr><td><code id="vgamma_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vgamma_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the gamma distribution.
</p>
<p>Gamma variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qgamma">stats::qgamma</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vgamma</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<div class="sourceCode"><pre>The gamma distribution with parameters \code{shape} = \eqn{a} and
\code{scale} = \eqn{s} has density

     \deqn{f(x) = \frac{1}{s^a\, \Gamma(a)} x^{a-1} e^{-x/s}}{
               f(x) = 1/(s^a Gamma(a)) x^(a-1) e^(-x/s)}

for \eqn{x \ge 0}, \eqn{a &gt; 0}, and \eqn{s &gt; 0}.
(Here \eqn{\Gamma(a)}{Gamma(a)} is the function implemented by
R's \code{\link[base:Special]{gamma}()} and defined in its help.)

The population mean and variance are \eqn{E(X) = as}
and \eqn{Var(X) = as^2}.
</pre></div>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of gamma random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rgamma">stats::rgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgamma
 vgamma(3, shape = 2, rate = 1)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgamma
 vgamma(3, 2, scale = 1, stream = 1)
 vgamma(3, 2, scale = 1, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgamma
 vgamma(1, 2, scale = 1, stream = 1)
 vgamma(1, 2, scale = 1, stream = 2)
 vgamma(1, 2, scale = 1, stream = 1)
 vgamma(1, 2, scale = 1, stream = 2)
 vgamma(1, 2, scale = 1, stream = 1)
 vgamma(1, 2, scale = 1, stream = 2)

 set.seed(8675309)
 variates &lt;- vgamma(100, 2, scale = 1, stream = 1)
 set.seed(8675309)
 variates &lt;- vgamma(100, 2, scale = 1, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vgeom'>Variate Generation for Geometric Distribution</h2><span id='topic+vgeom'></span>

<h3>Description</h3>

<p>Variate Generation for Geometric Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vgeom(n, prob, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vgeom_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vgeom_+3A_prob">prob</code></td>
<td>
<p>Probability of success in each trial (0 <code class="reqn">&lt;</code> <code>prob</code> <code class="reqn">\le</code> 1)</p>
</td></tr>
<tr><td><code id="vgeom_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qgeom">stats::qgeom</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qgeom">stats::qgeom</a></code>;</p>
</td></tr>
<tr><td><code id="vgeom_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vgeom_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the geometric distribution.
</p>
<p>Geometric variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qgeom">stats::qgeom</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vgeom</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The geometric distribution with parameter <code>prob</code> = <code class="reqn">p</code> has density
</p>
<p style="text-align: center;"><code class="reqn">p(x) = p (1-p)^x</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>, where <code class="reqn">0 &lt; p \le 1</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of geometric random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rgeom">stats::rgeom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgeom
 vgeom(3, prob = 0.3)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgeom
 vgeom(3, 0.3, stream = 1)
 vgeom(3, 0.3, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qgeom
 vgeom(1, 0.3, stream = 1)
 vgeom(1, 0.3, stream = 2)
 vgeom(1, 0.3, stream = 1)
 vgeom(1, 0.3, stream = 2)
 vgeom(1, 0.3, stream = 1)
 vgeom(1, 0.3, stream = 2)

 set.seed(8675309)
 variates &lt;- vgeom(100, 0.3, stream = 1)
 set.seed(8675309)
 variates &lt;- vgeom(100, 0.3, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vlnorm'>Variate Generation for Log-Normal Distribution</h2><span id='topic+vlnorm'></span>

<h3>Description</h3>

<p>Variate Generation for Log-Normal Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vlnorm(
  n,
  meanlog = 0,
  sdlog = 1,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vlnorm_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vlnorm_+3A_meanlog">meanlog</code></td>
<td>
<p>Mean of distribution on log scale (default 0)</p>
</td></tr>
<tr><td><code id="vlnorm_+3A_sdlog">sdlog</code></td>
<td>
<p>Standard deviation of distribution on log scale (default 1)</p>
</td></tr>
<tr><td><code id="vlnorm_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qlnorm">stats::qlnorm</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qlnorm">stats::qlnorm</a></code>;</p>
</td></tr>
<tr><td><code id="vlnorm_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vlnorm_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the log-normal distribution.
</p>
<p>Log-Normal variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qlnorm">stats::qlnorm</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vlnorm</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The log-normal distribution has density
</p>
<div class="sourceCode"><pre>\deqn{f(x) = \frac{1}{\sqrt{2 \pi} \sigma x}
                 e^{-(\log{x} - \mu)^2 / (2 \sigma^2)} }{
          f(x) = 1/(\sqrt(2 \pi) \sigma x) e^-((log x - \mu)^2 / (2 \sigma^2))}
</pre></div>
<p>where <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> are the mean and standard deviation
of the logarithm.
</p>
<p>The mean is
<code class="reqn">E(X) = \exp(\mu + 1/2 \sigma^2)</code>,
the median is
<code class="reqn">med(X) = \exp(\mu)</code>,
and the variance is
<code class="reqn">Var(X) = \exp(2\times \mu +\sigma^2)\times (\exp(\sigma^2)-1)</code>
and hence the coefficient of variation is
<code class="reqn">sqrt(\exp(\sigma^2)-1)</code>
which is approximately <code class="reqn">\sigma</code> when small
(e.g., <code class="reqn">\sigma &lt; 1/2</code>).
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of log-normal random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rlnorm">stats::rlnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlnorm
 vlnorm(3, meanlog = 5, sdlog = 0.5)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlnorm
 vlnorm(3, 8, 2, stream = 1)
 vlnorm(3, 8, 2, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlnorm
 vlnorm(1, 8, 2, stream = 1)
 vlnorm(1, 8, 2, stream = 2)
 vlnorm(1, 8, 2, stream = 1)
 vlnorm(1, 8, 2, stream = 2)
 vlnorm(1, 8, 2, stream = 1)
 vlnorm(1, 8, 2, stream = 2)

 set.seed(8675309)
 variates &lt;- vlnorm(100, 8, 2, stream = 1)
 set.seed(8675309)
 variates &lt;- vlnorm(100, 8, 2, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vlogis'>Variate Generation for Logistic Distribution</h2><span id='topic+vlogis'></span>

<h3>Description</h3>

<p>Variate Generation for Logistic Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vlogis(
  n,
  location = 0,
  scale = 1,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vlogis_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vlogis_+3A_location">location</code></td>
<td>
<p>Location parameter</p>
</td></tr>
<tr><td><code id="vlogis_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="vlogis_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qlogis">stats::qlogis</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qlogis">stats::qlogis</a></code>;</p>
</td></tr>
<tr><td><code id="vlogis_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vlogis_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the logistic distribution.
</p>
<p>Logistic variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qlogis">stats::qlogis</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vlogis</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The logistic distribution with <code>location</code> <code class="reqn">= \mu</code> and
<code>scale</code> <code class="reqn">= \sigma</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \frac{1}{1 + e^{-(x - \mu) / \sigma}}</code>
</p>

<p>and density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{1}{\sigma} \frac{e^{(x-\mu)/\sigma}}
                     {(1 + e^{(x-\mu)/\sigma})^2}</code>
</p>

<p>It is a long-tailed distribution with mean <code class="reqn">\mu</code> and
variance <code class="reqn">\pi^2 / 3 \sigma^2</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of logistic random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rlogis">stats::rlogis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlogis
 vlogis(3, location = 5, scale = 0.5)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlogis
 vlogis(3, 5, 1.5, stream = 1)
 vlogis(3, 5, 1.5, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qlogis
 vlogis(1, 5, 1.5, stream = 1)
 vlogis(1, 5, 1.5, stream = 2)
 vlogis(1, 5, 1.5, stream = 1)
 vlogis(1, 5, 1.5, stream = 2)
 vlogis(1, 5, 1.5, stream = 1)
 vlogis(1, 5, 1.5, stream = 2)

 set.seed(8675309)
 variates &lt;- vlogis(100, 5, 1.5, stream = 1)
 set.seed(8675309)
 variates &lt;- vlogis(100, 5, 1.5, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vnbinom'>Variate Generation for Negative Binomial Distribution</h2><span id='topic+vnbinom'></span>

<h3>Description</h3>

<p>Variate Generation for Negative Binomial Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vnbinom(n, size, prob, mu, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vnbinom_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vnbinom_+3A_size">size</code></td>
<td>
<p>target for number of successful trials, or dispersion
parameter (the shape parameter of the gamma mixing
distribution).  Must be strictly positive, need not be
integer.</p>
</td></tr>
<tr><td><code id="vnbinom_+3A_prob">prob</code></td>
<td>
<p>Probability of success in each trial;  '0 &lt; prob &lt;= 1'</p>
</td></tr>
<tr><td><code id="vnbinom_+3A_mu">mu</code></td>
<td>
<p>alternative parameterization via mean</p>
</td></tr>
<tr><td><code id="vnbinom_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qnbinom">stats::qnbinom</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qnbinom">stats::qnbinom</a></code>;</p>
</td></tr>
<tr><td><code id="vnbinom_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vnbinom_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the negative binomial distribution.
</p>
<p>Negative Binomial variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qnbinom">stats::qnbinom</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vnbinom</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The negative binomial distribution with <code>size</code> <code class="reqn">= n</code> and
<code>prob</code> <code class="reqn">= p</code> has density
</p>
<div class="sourceCode"><pre>      \deqn{p(x) = \frac{\Gamma(x+n)}{\Gamma(n) \ x!} p^n (1-p)^x}{
                p(x) = Gamma(x+n)/(Gamma(n) x!) p^n (1-p)^x}
</pre></div>
<p>for <code class="reqn">x = 0, 1, 2, \ldots, n &gt; 0</code> and <code class="reqn">0 &lt; p \leq 1</code>. This represents the
number of failures which occur in a sequence of Bernoulli trials before a
target number of successes is reached.
</p>
<p>The mean is <code class="reqn">\mu = n(1 - p)/p</code> and variance <code class="reqn">n(1 - p)/p^2</code>
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of negative binomial random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rnbinom">stats::rnbinom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnbinom
 vnbinom(3, size = 10, mu = 10)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnbinom
 vnbinom(3, 10, 0.25, stream = 1)
 vnbinom(3, 10, 0.25, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnbinom
 vnbinom(1, 10, 0.25, stream = 1)
 vnbinom(1, 10, 0.25, stream = 2)
 vnbinom(1, 10, 0.25, stream = 1)
 vnbinom(1, 10, 0.25, stream = 2)
 vnbinom(1, 10, 0.25, stream = 1)
 vnbinom(1, 10, 0.25, stream = 2)

 set.seed(8675309)
 variates &lt;- vnbinom(100, 10, 0.25, stream = 1)
 set.seed(8675309)
 variates &lt;- vnbinom(100, 10, 0.25, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vnorm'>Variate Generation for Normal Distribution</h2><span id='topic+vnorm'></span>

<h3>Description</h3>

<p>Variate Generation for Normal Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vnorm(n, mean = 0, sd = 1, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vnorm_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vnorm_+3A_mean">mean</code></td>
<td>
<p>Mean of distribution (default 0)</p>
</td></tr>
<tr><td><code id="vnorm_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of distribution (default 1)</p>
</td></tr>
<tr><td><code id="vnorm_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qnorm">stats::qnorm</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qnorm">stats::qnorm</a></code>;</p>
</td></tr>
<tr><td><code id="vnorm_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vnorm_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the normal distribution.
</p>
<p>Normal variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qnorm">stats::qnorm</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vnorm</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The normal distribution has density
</p>
<div class="sourceCode"><pre> \deqn{f(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-(x - \mu)^2/(2 \sigma^2)}}{
           f(x) = 1/(\sqrt(2\pi)\sigma) e^(-(x - \mu)^2/(2 \sigma^2))}
</pre></div>
<p>for <code class="reqn">-\infty &lt; x &lt; \infty</code> and <code class="reqn">\sigma &gt; 0</code>, where <code class="reqn">\mu</code> is the
mean of the distribution and <code class="reqn">\sigma</code> the standard deviation.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of normal random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rnorm">stats::rnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnorm
 vnorm(3, mean = 2, sd = 1)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnorm
 vnorm(3, 10, 2, stream = 1)
 vnorm(3, 10, 2, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qnorm
 vnorm(1, 10, 2, stream = 1)
 vnorm(1, 10, 2, stream = 2)
 vnorm(1, 10, 2, stream = 1)
 vnorm(1, 10, 2, stream = 2)
 vnorm(1, 10, 2, stream = 1)
 vnorm(1, 10, 2, stream = 2)

 set.seed(8675309)
 variates &lt;- vnorm(100, 10, 2, stream = 1)
 set.seed(8675309)
 variates &lt;- vnorm(100, 10, 2, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vpois'>Variate Generation for Poisson Distribution</h2><span id='topic+vpois'></span>

<h3>Description</h3>

<p>Variate Generation for Poisson Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpois(n, lambda, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpois_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vpois_+3A_lambda">lambda</code></td>
<td>
<p>Rate of distribution</p>
</td></tr>
<tr><td><code id="vpois_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qpois">stats::qpois</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qpois">stats::qpois</a></code>;</p>
</td></tr>
<tr><td><code id="vpois_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vpois_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Poisson distribution.
</p>
<p>Poisson variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qpois">stats::qpois</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vpois</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The Poisson distribution has density
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{\lambda^x e^{-\lambda}}{x!}</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>.
The mean and variance are <code class="reqn">E(X) = Var(X) = \lambda</code>
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of Poisson random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rpois">stats::rpois</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qpois
 vpois(3, lambda = 5)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qpois
 vpois(3, 3, stream = 1)
 vpois(3, 3, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qpois
 vpois(1, 3, stream = 1)
 vpois(1, 3, stream = 2)
 vpois(1, 3, stream = 1)
 vpois(1, 3, stream = 2)
 vpois(1, 3, stream = 1)
 vpois(1, 3, stream = 2)

 set.seed(8675309)
 variates &lt;- vpois(100, 3, stream = 1)
 set.seed(8675309)
 variates &lt;- vpois(100, 3, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vt'>Variate Generation for Student T Distribution</h2><span id='topic+vt'></span>

<h3>Description</h3>

<p>Variate Generation for Student T Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vt(n, df, ncp = 0, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vt_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vt_+3A_df">df</code></td>
<td>
<p>Degrees of freedom &gt; 0</p>
</td></tr>
<tr><td><code id="vt_+3A_ncp">ncp</code></td>
<td>
<p>Non-centrality parameter delta (default NULL)</p>
</td></tr>
<tr><td><code id="vt_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qt">stats::qt</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qt">stats::qt</a></code>;</p>
</td></tr>
<tr><td><code id="vt_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vt_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Student t distribution.
</p>
<p>Student T variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qt">stats::qt</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vt</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The t-distribution with <code>df</code> <code class="reqn">= v</code> degrees of freedom has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{\Gamma((v+1)/2)}{\sqrt{v\pi} \
             \Gamma(v/2)} \ (1 + x^2/v)^{-(v+1)/2}</code>
</p>

<p>for all real <code class="reqn">x</code>. It has mean 0 (for <code class="reqn">v &gt; 1</code>) and variance
<code class="reqn">v/(v-2)</code> (for <code class="reqn">v &gt; 2</code>).
</p>
<p>The general non-central t with parameters <code class="reqn">(\nu, \delta)</code> =
<code>(df, ncp)</code> is defined as the distribution of
<code class="reqn">T_{\nu}(\delta) := (U + \delta) \ / \ \sqrt{(V/\nu)}</code>
where <code class="reqn">U</code> and <code class="reqn">V</code> are
independent random variables, <code class="reqn">U \sim \mathcal{N}(0,1)</code>
and <code class="reqn">V \sim \chi^2(\nu)</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of Student t random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rt">stats::rt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qt
 vt(3, df = 3, ncp = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qt
 vt(3, 2, stream = 1)
 vt(3, 2, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qt
 vt(1, 2, stream = 1)
 vt(1, 2, stream = 2)
 vt(1, 2, stream = 1)
 vt(1, 2, stream = 2)
 vt(1, 2, stream = 1)
 vt(1, 2, stream = 2)

 set.seed(8675309)
 variates &lt;- vt(100, 2, stream = 1)
 set.seed(8675309)
 variates &lt;- vt(100, 2, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vunif'>Variate Generation for Uniform Distribution</h2><span id='topic+vunif'></span>

<h3>Description</h3>

<p>Variate Generation for Uniform Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vunif(n, min = 0, max = 1, stream = NULL, antithetic = FALSE, asList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vunif_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vunif_+3A_min">min</code></td>
<td>
<p>lower limit of distribution (default 0)</p>
</td></tr>
<tr><td><code id="vunif_+3A_max">max</code></td>
<td>
<p>upper limit of distribution (default 1)</p>
</td></tr>
<tr><td><code id="vunif_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates;</p>
</td></tr>
<tr><td><code id="vunif_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vunif_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the uniform distribution.
</p>
<p>Uniform variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qunif">stats::qunif</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vunif</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The uniform distribution has density
</p>
<div class="sourceCode"><pre>      \deqn{f(x) = \frac{1}{max-min}}{
                f(x) = 1/(max-min)}
</pre></div>
<p>for <code class="reqn">min \le x \le max</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of uniform random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qunif
 vunif(3, min = -2, max = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qunif
 vunif(3, 0, 10, stream = 1)
 vunif(3, 0, 10, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qunif
 vunif(1, 0, 10, stream = 1)
 vunif(1, 0, 10, stream = 2)
 vunif(1, 0, 10, stream = 1)
 vunif(1, 0, 10, stream = 2)
 vunif(1, 0, 10, stream = 1)
 vunif(1, 0, 10, stream = 2)

 set.seed(8675309)
 variates &lt;- vunif(100, 0, 10, stream = 1)
 set.seed(8675309)
 variates &lt;- vunif(100, 0, 10, stream = 1, antithetic = TRUE)

</code></pre>

<hr>
<h2 id='vweibull'>Variate Generation for Weibull Distribution</h2><span id='topic+vweibull'></span>

<h3>Description</h3>

<p>Variate Generation for Weibull Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vweibull(
  n,
  shape,
  scale = 1,
  stream = NULL,
  antithetic = FALSE,
  asList = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vweibull_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="vweibull_+3A_shape">shape</code></td>
<td>
<p>Shape parameter</p>
</td></tr>
<tr><td><code id="vweibull_+3A_scale">scale</code></td>
<td>
<p>Scale parameter (default 1)</p>
</td></tr>
<tr><td><code id="vweibull_+3A_stream">stream</code></td>
<td>
<p>if <code>NULL</code> (default), uses <code><a href="stats.html#topic+runif">stats::runif</a></code>
to generate uniform variates to invert via
<code><a href="stats.html#topic+qweibull">stats::qweibull</a></code>;
otherwise, an integer in 1:25 indicates the <code><a href="rstream.html#topic+rstream">rstream</a></code> stream
from which to generate uniform variates to invert via
<code><a href="stats.html#topic+qweibull">stats::qweibull</a></code>;</p>
</td></tr>
<tr><td><code id="vweibull_+3A_antithetic">antithetic</code></td>
<td>
<p>if <code>FALSE</code> (default), inverts <code class="reqn">u</code> = uniform(0,1)
variate(s) generated via either <code><a href="stats.html#topic+runif">stats::runif</a></code> or
<code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>; otherwise, uses
<code class="reqn">1 - u</code></p>
</td></tr>
<tr><td><code id="vweibull_+3A_aslist">asList</code></td>
<td>
<p>if <code>FALSE</code> (default), output only the generated
random variates; otherwise, return a list with components suitable for
visualizing inversion. See return for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates random variates from the Weibull distribution.
</p>
<p>Weibull variates are generated by inverting uniform(0,1) variates
produced either by <code><a href="stats.html#topic+runif">stats::runif</a></code> (if <code>stream</code> is
<code>NULL</code>) or by <code><a href="rstream.html#topic+rstream.sample">rstream::rstream.sample</a></code>
(if <code>stream</code> is not <code>NULL</code>).
In either case, <code><a href="stats.html#topic+qweibull">stats::qweibull</a></code> is used to
invert the uniform(0,1) variate(s).
In this way, using <code>vweibull</code> provides a monotone and synchronized
binomial variate generator, although not particularly fast.
</p>
<p>The stream indicated must be an integer between 1 and 25 inclusive.
</p>
<p>The Weibull distribution with parameters <code>shape</code> = <code class="reqn">a</code> and
<code>scale</code> = <code class="reqn">b</code> has density
</p>
<div class="sourceCode"><pre> \deqn{f(x) = \frac{a}{b} \left(\frac{x}{b}\right)^{a-1} e^{-(x/b)^a}}{
           f(x) = (a/b) (x/b)^(a-1) exp(-(x/b)^a)}
</pre></div>
<p>for <code class="reqn">x \ge 0</code>, <code class="reqn">a &gt; 0</code>, and <code class="reqn">b &gt; 0</code>.
</p>


<h3>Value</h3>

<p>If <code>asList</code> is FALSE (default), return a vector of random variates.
</p>
<p>Otherwise, return a list with components suitable for visualizing inversion,
specifically:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>        A vector of generated U(0,1) variates </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>        A vector of Weibull random variates </p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p> Parameterized quantile function </p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>     Parameterized title of distribution </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Barry Lawson (<a href="mailto:blawson@bates.edu">blawson@bates.edu</a>), <br />
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>), <br />
Vadim Kudlay (<a href="mailto:vkudlay@nvidia.com">vkudlay@nvidia.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="rstream.html#topic+rstream">rstream</a></code>, <code><a href="#topic+set.seed">set.seed</a></code>,
<code><a href="stats.html#topic+runif">stats::runif</a></code>
</p>
<p><code><a href="stats.html#topic+rweibull">stats::rweibull</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qweibull
 vweibull(3, shape = 2, scale = 1)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qweibull
 vweibull(3, 2, 1, stream = 1)
 vweibull(3, 2, 1, stream = 2)

 set.seed(8675309)
 # NOTE: following inverts rstream::rstream.sample using stats::qweibull
 vweibull(1, 2, 1, stream = 1)
 vweibull(1, 2, 1, stream = 2)
 vweibull(1, 2, 1, stream = 1)
 vweibull(1, 2, 1, stream = 2)
 vweibull(1, 2, 1, stream = 1)
 vweibull(1, 2, 1, stream = 2)

 set.seed(8675309)
 variates &lt;- vweibull(100, 2, 1, stream = 1)
 set.seed(8675309)
 variates &lt;- vweibull(100, 2, 1, stream = 1, antithetic = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
