<!DOCTYPE html><html><head><title>Help for package gggibbous</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gggibbous}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dmeladh'><p><em>Adh</em> allele frequencies in Australasian <em>Drosophila melanogaster</em></p></a></li>
<li><a href='#draw_key_moon'><p>Moon key glyph for legends</p></a></li>
<li><a href='#geom_moon'><p>Moon charts</p></a></li>
<li><a href='#gggibbous'><p>gggibbous: Moon charts, a pie chart alternative for two groups</p></a></li>
<li><a href='#lunardist'><p>Lunar distances and principal phases for 2019</p></a></li>
<li><a href='#moonGrob'><p>Draw a moon</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Moon Charts, a Pie Chart Alternative</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mnbram/gggibbous">https://github.com/mnbram/gggibbous</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mnbram/gggibbous/issues">https://github.com/mnbram/gggibbous/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Moon charts are like pie charts except that the proportions are
    shown as crescent or gibbous portions of a circle, like the lit and unlit
    portions of the moon. As such, they work best with only one or two groups.
    'gggibbous' extends 'ggplot2' to allow for plotting multiple moon charts in
    a single panel and does not require a square coordinate system.</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2 (&ge; 3.2.1), R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grid, scales (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, mapproj, maps, rmarkdown, testthat (&ge; 2.1.0), vdiffr
(&ge; 0.3.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-05 00:06:26 UTC; mike</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Bramson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Bramson &lt;mnbramson@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-06 17:40:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='dmeladh'><em>Adh</em> allele frequencies in Australasian <em>Drosophila melanogaster</em></h2><span id='topic+dmeladh'></span>

<h3>Description</h3>

<p>This data set contains allele frequencies for the &quot;fast&quot; and &quot;slow&quot; variants
of the enzyme alcohol dehydrogenase in Australasian (mostly Australian)
populations of <em>Drosophila melanogaster</em>. The data are taken from
Oakeshott, J.G., et al. 1982. Alcohol dehydrogenase and glycerol-3-phosphate
dehydrogenase clines in <em>Drosophila melanogaster</em> on different
continents. Evolution, 36(1): 86-96.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmeladh
</code></pre>


<h3>Format</h3>

<p>A data frame with 34 rows and 6 variables:
</p>

<dl>
<dt>Locality</dt><dd><p>location of population sample</p>
</dd>
<dt>Latitude</dt><dd><p>latitude of population sample</p>
</dd>
<dt>Longitude</dt><dd><p>longitude of population sample</p>
</dd>
<dt>N</dt><dd><p>number of samples</p>
</dd>
<dt>AdhF</dt><dd><p>percent of samples with <em>Adh^F</em> allele, as an integer</p>
</dd>
<dt>AdhS</dt><dd><p>percent of samples with <em>Adh^S</em> allele, as an integer</p>
</dd>
</dl>


<hr>
<h2 id='draw_key_moon'>Moon key glyph for legends</h2><span id='topic+draw_key_moon'></span><span id='topic+draw_key_moon_left'></span><span id='topic+draw_key_full_moon'></span>

<h3>Description</h3>

<p>Draws the legend key glyphs used in <code>geom_moon</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_key_moon(data, params, size)

draw_key_moon_left(data, params, size)

draw_key_full_moon(data, params, size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_key_moon_+3A_data">data</code></td>
<td>
<p>A single row data frame containing the scaled aesthetics to
display in this key</p>
</td></tr>
<tr><td><code id="draw_key_moon_+3A_params">params</code></td>
<td>
<p>A list of additional parameters supplied to the geom.</p>
</td></tr>
<tr><td><code id="draw_key_moon_+3A_size">size</code></td>
<td>
<p>Width and height of key in mm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>draw_key_moon</code> (the default in <code>geom_moon</code>) draws a gibbous moon
filled from the right. <code>draw_key_moon_left</code> draws a crescent moon from
the right. <code>draw_key_full_moon</code> draws a circle, which is very similar to
<code>draw_key_point</code> in <code>ggplot2</code>, but the size is calculated slightly
differently and the default aesthetics differ.
</p>


<h3>Value</h3>

<p>A grid grob.
</p>

<hr>
<h2 id='geom_moon'>Moon charts</h2><span id='topic+geom_moon'></span>

<h3>Description</h3>

<p>The moon geom is used to create moon charts, which are like pie charts except
that the proportions are shown as crescent or gibbous portions of a circle,
like the lit and unlit portions of the moon. As such, they work best with
only one or two groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_moon(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_moon_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code> or
<code><a href="ggplot2.html#topic+aes_">aes_()</a></code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_stat">stat</code></td>
<td>
<p>The statistical transformation to use on the data for this
layer, as a string.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of
a call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_moon_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>geom_moon</code> acts like <code>geom_point</code> in that multiple moons can be
plotted on the same panel with <code>x</code> and <code>y</code> in the plot's coordinate
system, but size determined independently of the coordinate system. This
behavior also means that the moons will always be circular even if the
coordinate system is not square.
</p>
<p>In order to get a full circle with two complementary sections (a crescent and
a gibbous moon), you need to plot two shapes: one with <code>right = TRUE</code>
and one with <code>right = FALSE</code>, with <code>ratio</code> on the second one equal
to <code>1 - ratio</code> on the first.
</p>


<h3>Aesthetics</h3>

<p><code>x</code> and <code>y</code> are required aesthetics.
<code>size</code>, <code>fill</code>,
<code>colo(u)r</code>, <code>alpha</code>, <code>stroke</code>, and <code>group</code> aesthetics
are understood as in other <code>geom</code>s.
Two new aesthetics are also introduced: <code>ratio</code> and <code>right</code>.
<code>ratio</code> controls the proportion of the moon to be plotted, from 0 to 1.
<code>right</code> takes a boolean value to indicate whether the moon should be
filled from the right or the left.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ggplot(
  data.frame(x = 1:5, y = 1, size = 1:5, ratio = 1:5 * 0.2),
  aes(x = x, y = y, size = size, ratio = ratio)
) +
  geom_moon()

# To make full moon charts, you need two calls to geom_moon(), one with
# right = TRUE and one with right = FALSE and ratio equal to 1 - ratio
# from the first one 
ggplot(dmeladh) +
  geom_moon(
    x = 0.5, y = 0.5, fill = "forestgreen", color = "forestgreen",
    aes(ratio = AdhF / 100)
  ) +
  geom_moon(
    x = 0.5, y = 0.5, fill = "gold", color = "gold",
    aes(ratio = AdhS / 100), right = FALSE
  ) +
  facet_wrap(~Locality, ncol = 7)

# The same thing can be accomplished with a single call to geom_moon()
# using a "long" data frame with both frequencies if you set a grouping
# variable and set the `right` variable to a boolean column
dmeladh_long &lt;- reshape(
  dmeladh,
  varying = c("AdhF", "AdhS"),
  v.names = "freq",
  timevar = "allele",
  times = c("AdhF", "AdhS"),
  idvar = c("Locality", "Latitude", "Longitude", "N"),
  direction = "long"
)
dmeladh_long$right &lt;- rep(c(TRUE, FALSE), each = nrow(dmeladh))
ggplot(dmeladh_long) +
  geom_moon(
    x = 0.5, y = 0.5, key_glyph = draw_key_rect,
    aes(ratio = freq / 100, fill = allele, color = allele, right = right),
  ) +
  facet_wrap(~Locality, ncol = 7)

# Moon charts (and pie charts) are sometimes useful on maps when x and y
# cannot be used as aesthetic dimensions because they are already spatial
# dimensions. Overplotting needs to be considered carefully, however.   
ggplot(
  subset(dmeladh, N &gt; 200),
  aes(Longitude, Latitude)
) +
  geom_moon(aes(ratio = AdhF / 100), fill = "black") +
  geom_moon(aes(ratio = AdhS / 100), right = FALSE) +
  coord_fixed()
</code></pre>

<hr>
<h2 id='gggibbous'>gggibbous: Moon charts, a pie chart alternative for two groups</h2><span id='topic+gggibbous'></span>

<h3>Description</h3>

<p>Moon charts are like pie charts except that the proportions are shown as
crescent or gibbous portions of a circle, like the lit and unlit portions of
the moon. As such, they work best with only one or two groups.
<code>gggibbous</code> extends <code>ggplot2</code> to allow for plotting multiple moon
charts in a single panel and does not require a square coordinate system.
</p>


<h3>Details</h3>

<p>The workhorse function is <code>geom_moon</code>, which adds a moon chart layer to
a ggplot2 plot.
The <code>draw_key_moon</code>, <code>draw_key_moon_left</code>, and
<code>draw_key_full_moon</code> functions provides legend key glyphs for plots that
use <code>geom_moon</code>.
There are also functions for the raw <code>grid</code> grobs: <code>grid.moon</code> and
<code>moonGrob</code>.
</p>
<p>For more information, see the <code>gggibbous</code> vignette.
</p>

<hr>
<h2 id='lunardist'>Lunar distances and principal phases for 2019</h2><span id='topic+lunardist'></span>

<h3>Description</h3>

<p>This data set contains the distance from the Earth to the Moon for each day
in 2019, as well as the dates (in UTC) of each occurrence of the four
principal phases of the moon. The data are adapted from NASA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lunardist
</code></pre>


<h3>Format</h3>

<p>A data frame with 365 rows and 3 variables:
</p>

<dl>
<dt>date</dt><dd><p>Date</p>
</dd>
<dt>distance</dt><dd><p>Distance from the Earth to the Moon in kilometers</p>
</dd>
<dt>phase</dt><dd><p>Principal phase of the moon (full, new, first quarter, third
quarter) or NA if no principal phase on that date</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://svs.gsfc.nasa.gov/4442">https://svs.gsfc.nasa.gov/4442</a>
</p>

<hr>
<h2 id='moonGrob'>Draw a moon</h2><span id='topic+moonGrob'></span><span id='topic+grid.moon'></span>

<h3>Description</h3>

<p>Functions to create and draw crescent or gibbous moon shapes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moonGrob(
  x,
  y,
  ratio = 0.25,
  right = TRUE,
  r = 10,
  angle = 0,
  default.units = "npc",
  size.units = "mm",
  ...
)

grid.moon(..., draw = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moonGrob_+3A_x">x</code></td>
<td>
<p>A numeric vector or unit object specifying x-locations.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_y">y</code></td>
<td>
<p>A numeric vector or unit object specifying y-locations.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_ratio">ratio</code></td>
<td>
<p>A numeric vector with values from 0 to 1 specifying the
proportion of the moons to draw.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_right">right</code></td>
<td>
<p>A boolean vector specifying whether the moon should be filled
from the right (TRUE) or left (FALSE).</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_r">r</code></td>
<td>
<p>A numeric vector specifying the radii of the circles describing
the moons.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_angle">angle</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_default.units">default.units</code></td>
<td>
<p>A string indicating the default units to use
if <code>x</code>, <code>y</code>, <code>width</code>, or <code>height</code>
are only given as numeric vectors.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_size.units">size.units</code></td>
<td>
<p>A string indicating the units to use for the radii of the
moons.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>grid::polygonGrob</code>.</p>
</td></tr>
<tr><td><code id="moonGrob_+3A_draw">draw</code></td>
<td>
<p>A logical value indicating whether graphics output
should be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both functions create a moon grob (a graphical object describing a crescent
or gibbous moon), but only <code>grid.moon</code> draws the moon (and then only
if draw is TRUE).
</p>
<p>These functions calculate a set of points describing the perimeters of the
moons and pass these points on to <code>grid::polygonGrob</code>.
</p>
<p>The units in <code>default.units</code> and <code>size.units</code> can be different;
<code>grid</code> will add them together appropriately before drawing.
</p>


<h3>Value</h3>

<p>A grob object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grid::grid.newpage()
grid.moon(x = 1:3 * 0.25, y = rep(0.5, 3), ratio = 1:3 * 0.25, r = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
