<!DOCTYPE html><html><head><title>Help for package spaceNet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spaceNet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spaceNet'><p>Latent Space Models for Multivariate Networks</p></a></li>
<li><a href='#alphaRef'><p>Compute Intercept Value in the Reference Network</p></a></li>
<li><a href='#heuSearch'><p>Heuristic model search</p></a></li>
<li><a href='#internal-functions'>
<p>Internal <code>spaceNet</code> functions</p></a></li>
<li><a href='#multiNet'><p>Latent Space Models for Multivariate Networks</p></a></li>
<li><a href='#vickers'><p>Vickers-Chan 7th Graders Multidimensional Network</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-19</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent Space Models for Multidimensional Networks</td>
</tr>
<tr>
<td>Description:</td>
<td>Latent space models for multivariate networks (multiplex) estimated via MCMC algorithm. See D Angelo et al. (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1803.07166">doi:10.48550/arXiv.1803.07166</a>&gt; and D Angelo et al. (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1807.03874">doi:10.48550/arXiv.1807.03874</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mclust (&ge; 5.3), permute, RcppTN, Rfast, sna, vegan</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-19 21:33:34 UTC; Silvia</td>
</tr>
<tr>
<td>Author:</td>
<td>Silvia D'Angelo [aut, cre],
  Michael Fop <a href="https://orcid.org/0000-0003-3936-2757"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Marco Alfò [ctb],
  Thomas Brendan Murphy [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Silvia D'Angelo &lt;silvia.dangelo@ucd.ie&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-19 22:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='spaceNet'>Latent Space Models for Multivariate Networks</h2><span id='topic+spaceNet'></span><span id='topic+spaceNet-package'></span>

<h3>Description</h3>

<p>A package for latent space models for binary multivariate networks (multiplex).
The model assumes that the nodes in the multiplex lie in a low-dimensional latent space. The probability of two nodes being connected is inversely related to their distance in this latent space: nodes close in the space are more likely to be linked, while nodes that are far apart are less likely to be connected. The model allows the inclusion of node-specific sender and receiver effects and edge-specific covariates. Inference is carried out via a MCMC algorithm.</p>


<h3>Details</h3>

 
<p>The main function is <code><a href="#topic+multiNet">multiNet</a></code>, which estimates the latent space model via MCMC algorithm. Data can be inputed either as a list or an array. Also, edge-specific covariates in the form of a list or an array can be included in the model.
</p>


<h3>Author(s)</h3>

<p>Silvia D'Angelo and Michael Fop.
</p>
<p>Mantainer: Silvia D'Angelo <a href="mailto:silvia.dangelo@ucd.ie">silvia.dangelo@ucd.ie</a>
</p>


<h3>References</h3>

<p>D'Angelo, S. and Murphy, T. B. and Alfò, M. (2018). Latent space modeling of multidimensional networks with application to the exchange of votes in the Eurovision
Song Contest. <a href="https://arxiv.org/abs/1803.07166">arXiv</a>.
</p>
<p>D'Angelo, S. and Alfò, M. and Murphy, T. B. (2018). Node-specific effects in latent space modelling of multidimensional networks. <a href="https://arxiv.org/abs/1807.03874">arXiv</a>.
</p>

<hr>
<h2 id='alphaRef'>Compute Intercept Value in the Reference Network</h2><span id='topic+alphaRef'></span>

<h3>Description</h3>

<p>Computes the value for the intercept in the reference network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alphaRef(Y, D = 2, sender = NULL, receiver = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alphaRef_+3A_y">Y</code></td>
<td>
<p>A three-dimensional array or list of <code class="reqn">(n\times n)</code> adjacency matrices composing the multidimensional network. A list will be converted to an array. If an array, the dimension of <code>Y</code> must be <code>(n,n,K)</code>, where <code>n</code> is the number of nodes and <code>K</code> the number of networks. Structural missing values (<code>NA</code>) are allowed, but no imputation is performed; see details.</p>
</td></tr>
<tr><td><code id="alphaRef_+3A_d">D</code></td>
<td>
<p>The dimension of the latent space, with <code>D &gt; 0</code>. The default value is <code>D = 2</code>.</p>
</td></tr>
<tr><td><code id="alphaRef_+3A_sender">sender</code>, <code id="alphaRef_+3A_receiver">receiver</code></td>
<td>
<p>The type of node-specific sender and receiver effects to be included in the model. If specified, these effects can be set to constant (<code>"const"</code>) or/and variable (<code>"var"</code>). By default, node-specific effects are not included in the model (<code>NULL</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the value for the intercept in the reference network (first network) of the multiplex. It is calculated taking into account the average effect of the latent space on edge probabilities (approximated with the constant <code class="reqn">2</code>) and the observed mean probability of an edge in the first network (<code class="reqn">Y^{(1)}</code>):
</p>
<p style="text-align: center;"><code class="reqn">p^{(1)}=\frac{\sum_{i=1}^n \sum_{j =1}^n y_{ij}^{(1)}}{n (n-1)},</code>
</p>

<p>with <code class="reqn">n</code> the number of nodes in the network.
Then, the reference intercept is computed as:
</p>
<p style="text-align: center;"><code class="reqn">\log \Bigl( \frac{p^{(1)}}{1 -p^{(1)}} \Bigr) + 2.</code>
</p>

<p>When sender and/or receiver effects are included in the model, the intercept for the reference network is forced to be positive, see references.
</p>


<h3>Value</h3>

<p>The function returns the intercept value in the reference network.
</p>


<h3>References</h3>

<p>D'Angelo, S. and Murphy, T. B. and Alfò, M. (2018). Latent space modeling of multidimensional networks with application to the exchange of votes in the Eurovision Song Contest. <a href="https://arxiv.org/abs/1803.07166">arXiv</a>.
</p>
<p>D'Angelo, S. and Alfò, M. and Murphy, T. B. (2018). Node-specific effects in latent space modelling of multidimensional networks. <a href="https://arxiv.org/abs/1807.03874">arXiv</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiNet">multiNet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vickers)
alphaR &lt;- alphaRef(vickers, D = 2)  # model without node-specific effect
</code></pre>

<hr>
<h2 id='heuSearch'>Heuristic model search</h2><span id='topic+heuSearch'></span>

<h3>Description</h3>

<p>This function performs an heuristic model search, to select which type of sender and receiver effects should be included in the model. The sender/receiver effects can be either absent, constant or variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heuSearch( Y, D = 2, nrep = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heuSearch_+3A_y">Y</code></td>
<td>
<p>A three-dimensional array or list of <code class="reqn">(n\times n)</code> adjacency matrices composing the multidimensional network. A list will be converted to an array. If an array, the dimension of <code>Y</code> must be <code>(n,n,K)</code>, where <code>n</code> is the number of nodes and <code>K</code> the number of networks. Structural missing values (<code>NA</code>) are allowed, but no imputation is performed; see details.</p>
</td></tr>
<tr><td><code id="heuSearch_+3A_d">D</code></td>
<td>
<p>The dimension of the latent space, with <code>D &gt; 0</code>. The default value is <code>D = 2</code>.</p>
</td></tr>
<tr><td><code id="heuSearch_+3A_nrep">nrep</code></td>
<td>
<p> The number of datasets to be simulated for each model type. By default <code>nrep = 1000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs an heuristic model search for the type of sender/receiver effects to be included in the model for the multidimensional network <code>Y</code> with <code class="reqn">n</code> nodes and <code class="reqn">K</code> networks.
</p>
<p>The function simulates <code>nrep</code> different multidimensional networks of dimensions <code class="reqn">(n, K)</code> from the nine models arising from different combinations of sender/receiver effects: <code>"NN"</code>, <code>"CN"</code>, <code>"NC"</code>, <code>"CC"</code>, <code>"VN"</code>, <code>"NV"</code>, <code>"VC"</code>, <code>"CV"</code>, <code>"VV"</code>. The first letter indicates the sender effect type, while the second letter denotes the receiver effect type. The effects can be constrained across the networks, with <code>"N"</code> indicating no effects, <code>"C"</code> constant effects and <code>"V"</code> variable effects. The simulated multidimensional networks are then used to train a classifier, which is employed to assign the observed multiplex <code>Y</code> to the most plausible node-specific effect model.
</p>


<h3>Value</h3>

<p>The function returns a list containing the following objects:
</p>

<ul>
<li><p><code>bestModel</code> The selected combination of sender and receiver effects.
</p>
</li>
<li><p><code>modelProbs</code> The estimated probabilities that <code>Y</code> has been generated by the models corresponding to all the sender/receiver effects combinations. 
</p>
</li>
<li><p><code>modClass</code> The model-specific accuracies of the classifier. Rows correspond to the predicted model, while columns to the model the simualted data have been generated from. 
</p>
</li></ul>



<h3>References</h3>

<p>D'Angelo, S. and Murphy, T. B. and Alfò, M. (2018). Latent space modeling of multidimensional networks with application to the exchange of votes in the Eurovision Song Contest. <a href="https://arxiv.org/abs/1803.07166">arXiv</a>.
</p>
<p>D'Angelo, S. and Alfò, M. and Murphy, T. B. (2018). Node-specific effects in latent space modelling of multidimensional networks. <a href="https://arxiv.org/abs/1807.03874">arXiv</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiNet">multiNet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vickers)
#heuS &lt;- heuSearch( vickers, D = 2, nrep = 10) # nrep is set to 10 as an example.
</code></pre>

<hr>
<h2 id='internal-functions'>
Internal <code>spaceNet</code> functions
</h2><span id='topic+startZ'></span><span id='topic+startLogit'></span><span id='topic+startSend'></span><span id='topic+startRec'></span><span id='topic+startLambda'></span><span id='topic+simMultiNet'></span><span id='topic+list2array'></span><span id='topic+sigmaFC'></span><span id='topic+muFc'></span><span id='topic+alphaBetaProp_k'></span><span id='topic+zProp_i'></span><span id='topic+lambdaProp_l'></span><span id='topic+gammaThetaProp_i'></span><span id='topic+logPosterior'></span><span id='topic+loglik'></span>

<h3>Description</h3>

<p>Internal functions not to be called by the user.
</p>

<hr>
<h2 id='multiNet'>Latent Space Models for Multivariate Networks</h2><span id='topic+multiNet'></span><span id='topic+print.multiNet'></span>

<h3>Description</h3>

<p>Implements latent space models for multivariate networks (multiplex) via MCMC algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiNet(Y, niter = 1000, D = 2,
         muA = 0, tauA = NULL, nuA = 3,
         muB = 0, tauB = NULL, nuB = 3,
         muL = 0, tauL = NULL, nuL = 3,
         alphaRef = NULL,
         sender = c("const", "var"),
         receiver = c("const", "var"),
         covariates = NULL,
         DIC = FALSE, WAIC = FALSE,
         burnIn = round(niter*0.3),
         trace = TRUE,
         allChains = FALSE,
         refSpace = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiNet_+3A_y">Y</code></td>
<td>
<p>A three-dimensional array or list of <code class="reqn">(n\times n)</code> adjacency matrices composing the multidimensional network. A list will be converted to an array. If an array, the dimension of <code>Y</code> must be <code>(n,n,K)</code>, where <code>n</code> is the number of nodes and <code>K</code> the number of networks. Missing values (<code>NA</code>) are allowed; see details.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_niter">niter</code></td>
<td>
<p>The number of MCMC iterations. The default value is <code>niter = 1000</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_d">D</code></td>
<td>
<p>The dimension of the latent space, with <code>D &gt; 1</code>. The default value is <code>D = 2</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_mua">muA</code>, <code id="multiNet_+3A_mub">muB</code>, <code id="multiNet_+3A_mul">muL</code></td>
<td>
<p>Mean hyperparameters, see details.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_taua">tauA</code>, <code id="multiNet_+3A_taub">tauB</code>, <code id="multiNet_+3A_taul">tauL</code></td>
<td>
<p>Mean hyperparameters, see details.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_nua">nuA</code>, <code id="multiNet_+3A_nub">nuB</code>, <code id="multiNet_+3A_nul">nuL</code></td>
<td>
<p>Variance hyperparameters, see details.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_alpharef">alphaRef</code></td>
<td>
<p>The value for the intercept in the first network (the reference network). This value can be specified by the user on the basis of prior knowledge. By default is computed using the function <code><a href="#topic+alphaRef">alphaRef</a></code>, see details.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_sender">sender</code>, <code id="multiNet_+3A_receiver">receiver</code></td>
<td>
<p>The type of node-specific sender and receiver effects to be included in the model. If specified, these effects can be set to constant (<code>"const"</code>) or/and variable (<code>"var"</code>). By default, node-specific effects are not included in the model (<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="multiNet_+3A_covariates">covariates</code></td>
<td>
<p>An array or a list with edge-covariates matrices. A list is automatically converted to an array. Covariates can be either continuous or discrete and must be constant throughout the views of the multiplex. The dimension of <code>covariates</code> is <code>(n,n,L)</code>, where <code>n</code> is the number of nodes and <code>L</code> the number of covariates, that is, the number of covariates matrices. Missing values (<code>NA</code>) are not allowed.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_dic">DIC</code></td>
<td>
<p>A logical value indicating wether the DIC (Deviance Information Criterion) should be computed. The default is <code>DIC = FALSE</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_waic">WAIC</code></td>
<td>
<p>A logical value indicating wether the WAIC (Widely Available Information Criterion) should be computed. The default is <code>WAIC = FALSE</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_burnin">burnIn</code></td>
<td>
<p>A numerical value, the number of iterations of the chain to be discarded when computing the posterior estimates. The default value is <code>burnIn = round(niter*0.3)</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_trace">trace</code></td>
<td>
<p>A logical value indicating if a progress bar should be printed.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_allchains">allChains</code></td>
<td>
<p>A logical value indicating if the full parameter chains should also be returned in output. The default value is <code>allChains = FALSE</code>.</p>
</td></tr>
<tr><td><code id="multiNet_+3A_refspace">refSpace</code></td>
<td>
<p>Optional. A matrix containing a set of reference values for the latent coordinates of the nodes. Its dimension must be <code>(n, D)</code>, where <code>n</code> is the number of nodes and <code>D</code> the number of dimensions of the latent space. The coordinates stored in the matrix <code>refSpace</code> are compared with the estimated ones at each iteration via Procrustes correlation. High values of the correlation index indicate that the estimated coordinates are a translation and/or a rotation of the coordinates in <code>refSpace</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates a latent space model for multidimensional networks (multiplex) via MCMC. The model assumes that the probability of observing an arc between any two nodes is inversely related to their distance in a low-dimensional latent space. Hence, nodes close in the latent space have a higher probability of being connected across the views of the multiplex than nodes far apart.
The model allows the inclusion of node-specific sender and receiver effects and edge-specific covariates.
</p>
<p>The probability of an edge beteween nodes <code class="reqn">i</code> and <code class="reqn">j</code> in the <code class="reqn">k^{th}</code> network is defined as:
</p>
<p style="text-align: center;"><code class="reqn">
 P \Bigl( y_{ij}^{(k)} = 1 | \Omega^{(k)} , d_{ij}, \lambda \Bigr)=
\frac{ C_{ij}^{(k)} }{1 +  C_{ij}^{(k)} }.</code>
</p>

<p>with <code class="reqn">C_{ij}^{(k)} = \exp \{\alpha^{(k)}-\beta^{(k)} d_{ij} -\lambda x_{ij} \} </code> when node-specific effects are not present and <code class="reqn">C_{ij}^{(k)} = \exp \{\alpha^{(k)} \phi_{ij}^{(k)} -\beta^{(k)} d_{ij} -\lambda x_{ij} \} </code> when they are included in the model.
</p>
<p>The arguments of <code class="reqn">C_{ij}^{(k)}</code> are:
</p>

<ul>
<li><p>The squared Euclidean distance between nodes <code class="reqn">i</code> and <code class="reqn">j</code> in the latent space, <code class="reqn">d_{ij}</code>
</p>
</li>
<li><p>A coefficient <code class="reqn">\lambda</code> to scale the edge-specific covariate <code class="reqn">x_{ij}</code>. If more than one covariate is introduced in the model, their sum is considered, with each covariate being rescaled by a specific coefficient <code class="reqn">\lambda_l</code>. Edge-specific covariates are assumed to be inversely related to edge probabilities, hence <code class="reqn">\lambda \geq 0</code>.
</p>
</li>
<li><p>A vector of network-specific parameters, <code class="reqn">\Omega^{(k)} = (\alpha^{(k)},\beta^{(k)}) </code>. These parameters are:
</p>

<ul>
<li><p>A rescaling coefficient <code class="reqn">\beta^{(k)} </code>, which weights the importance of the latent space in the <code class="reqn">k^{th}</code> network, with <code class="reqn">\beta^{(k)} \geq 0 </code>. In the first network (that is the reference network), the coefficient is fixed to <code class="reqn">\beta^{(1)} = 1</code> for identifiability reasons.  
</p>
</li>
<li><p>An intercept parameter <code class="reqn">\alpha^{(k)} </code>, which corresponds to the largest edge probability allowed in the <code class="reqn">k^{th}</code> network. Indeed, when  <code class="reqn">\beta^{(k)} = 0 </code> and when no covariate is included, the probability of having a link between a couple of nodes is that of the random graph:
</p>
<p style="text-align: center;"><code class="reqn">
 P \Bigl( y_{ij}^{(k)} = 1 |  \alpha^{(k)} \Bigr)=
\frac{ \exp \{ \alpha^{(k)}\} }{1 +  \exp \{\alpha^{(k)}\} }.</code>
</p>


<p>The intercepts have a lower bound corresponding to <code class="reqn">\log \Bigl( \frac{\log (n)}{ n - \log(n)} \Bigr) </code>. For identifiability reasons, the intercept of the first network needs to be fixed. Its value can be either specified by the user on the basis of prior knowledge or computed with the function <code><a href="#topic+alphaRef">alphaRef</a></code>.
</p>
</li></ul>


</li>
<li><p>When node-specific effects are included in the model,
</p>
<p style="text-align: center;"><code class="reqn">\phi_{ij}^{(k)} = g (\theta_{i}^{(k)} + \gamma_{j}^{(k)} )</code>
</p>

<p>with :
</p>

<ul>
<li> <p><code class="reqn">\theta_{i}^{(k)}</code> the sender effect of node <code class="reqn">i</code> in network <code class="reqn">k</code>. 
</p>
</li>
<li> <p><code class="reqn">\gamma_{j}^{(k)}</code> the receiver effect of node <code class="reqn">j</code> in network <code class="reqn">k</code>.
</p>
</li>
<li> <p><code class="reqn">g</code> a scalar. When both sender and receiver effects are present, <code class="reqn">g=0.5</code>; when only one type of effect is included in the model, <code class="reqn">g=1</code>.
</p>
</li></ul>

<p>When the sender and/or receiver effects are set to constant (<code>"const"</code>), each node <code class="reqn">i</code> is assumed to have a constant effect across the different networks: <code class="reqn">\theta_{i}^{(k)} = \theta_{i}</code> and/or <code class="reqn">\gamma_{i}^{(k)} = \gamma_{i}</code>. Instead, when they are set to variable (<code>"var"</code>), each node has a different effect across the networks: <code class="reqn">\theta_{i}^{(k)}</code> and/or <code class="reqn">\gamma_{i}^{(k)}</code>.

</p>
</li></ul>

<p>Inference on the model parameters is carried out via a MCMC algorithm. A hierarchical framework is adopted for estimation, where the parameters of the distributions of <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\lambda</code> are considered nuisance parameters and assumed to follow hyper-prior distributions. The parameters of these hyperpriors need to be fixed and are the following:
</p>

<ul>
<li><p><code>tauA, tauB</code> and <code>tauL</code> are the scale factors for the variances of the hyperprior distributions for the mean parameters of <code class="reqn">\alpha^{(k)}, \beta^{(k)}</code> and <code class="reqn">\lambda_l</code>. If not specified by the user, <code>tauA</code> and <code>tauB</code> are computed as <code class="reqn">(K-1)\ K </code>, if <code class="reqn">K &gt; 1</code>, otherwise they are set to <code class="reqn">0.5</code>. Parameter <code>tauL</code> is calculated as <code class="reqn">(L-1)\ K </code>, if <code class="reqn">L &gt; 1</code>, otherwise it is set to <code class="reqn">0.5</code>.    
</p>
</li>
<li><p><code>muA, muB</code> and <code>muL</code> are the means of the hyperprior distributions for the mean parameters of <code class="reqn">\alpha^{(k)}, \beta^{(k)}</code> and <code class="reqn">\lambda_l</code>. If not specified by the user, they are all set to <code class="reqn">0</code>. 
</p>
</li>
<li><p><code>nuA, nuB</code> and <code>nuL</code> are the degrees of freedom of the hyperprior distributions for the variance parameters of <code class="reqn">\alpha^{(k)}, \beta^{(k)}</code> and <code class="reqn">\lambda_l</code>. If not specified by the user, they are all set to <code class="reqn">3</code>. 
</p>
</li></ul>

<p>Missing data are considered structural and correspond to edges missing because one or more nodes are not observable in some of the networks of the multiplex. No imputation is performed, instead, the term corresponding to the missing edge is discarded in the computation of the likelihood function. For example, if either node <code class="reqn">i</code> or <code class="reqn">j</code> is not observable in network <code class="reqn">k</code>, the edge <code class="reqn">(i,j)</code> is missing and the likelihood function for network <code class="reqn">k</code> is calculated discarding the corresponding <code class="reqn">(i,j)</code> term. Notice that the model assumes a single common generative latent space for the whole multidimensional network. Thus, discarding the <code class="reqn">(i,j)</code> term in the <code class="reqn">k^{th}</code> network does not prevent from recovering the coordinates of nodes <code class="reqn">i</code> and <code class="reqn">j</code> in the latent space.
</p>


<h3>Value</h3>

<p>An object of class <code>'multiNet'</code> containing the following components:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>The number of nodes in the multidimensional network.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>The number of networks in the multidimensional network.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The number of dimensions of the estimated latent space.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>A list with the following components:
</p>

<ul>
<li><p><code>alpha</code> is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the intercept parameters; 
</p>
</li>
<li><p><code>beta</code> is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the latent space coefficient parameters;
</p>
</li>
<li><p><code>theta</code> is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the sender effect parameters;
</p>
</li>
<li><p><code>gamma</code> is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the receiver effect parameters;
</p>
</li>
<li><p><code>lambda</code> is a list with two components: the means of the posterior distributions and the standard deviations of the posterior distributions for the covariate coefficient parameters.
</p>
</li></ul>

</td></tr>
<tr><td><code>latPos</code></td>
<td>
<p>A list with posterior estimates of means and standard deviations of the latent coordinates.</p>
</td></tr>
<tr><td><code>accRates</code></td>
<td>
<p>A list with the following components:
</p>

<ul>
<li><p><code>alpha</code> is a vector with the acceptance rates for the intercept parameters;
</p>
</li>
<li><p><code>beta</code> is a vector with the acceptance rates for the latent space coefficient parameters;
</p>
</li>
<li><p><code>theta</code> is a matrix with the acceptance rates for the sender effect parameters;
</p>
</li>
<li><p><code>gamma</code> is a matrix with the acceptance rates for the receiver effect parameters;
</p>
</li>
<li><p><code>lambda</code> is a vector with the acceptance rates for the covariate coefficient parameters;
</p>
</li>
<li><p><code>latPos</code> is a vector with the acceptance rates for the latent coordinates of the nodes.
</p>
</li></ul>

</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>The Deviance Information Criterion of the estimated model. Computed only if <code>DIC = TRUE</code> in input.</p>
</td></tr>
<tr><td><code>WAIC</code></td>
<td>
<p>The Widely Available Information Criterion of the estimated model. Computed only if <code>WAIC = TRUE</code> in input.</p>
</td></tr>
<tr><td><code>allChains</code></td>
<td>
<p>If <code>allChains = TRUE</code>, a list with the following components is returned:
</p>

<ul>
<li><p><code>parameters</code> is a list with the estimated posterior distributions of the model parameters: <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, <code class="reqn">\theta</code>, <code class="reqn">\gamma</code> and <code class="reqn">\lambda</code>;
</p>
</li>
<li><p><code>latPos</code> is an array with the posterior distributions of the latent coordinates of each node;
</p>
</li>
<li><p><code>priorParameters</code> is a list with the estimated posterior distributions of the parameters of the prior distributions of <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\lambda</code>. 
</p>
</li></ul>

</td></tr>
<tr><td><code>corrRefSpace</code></td>
<td>
<p>A numerical vector containing the values of the Procrustes correlation between the reference space and the estimated one, computed at each mcmc iteration. Only outputed when <code>refSpace</code> is given, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>A list with some information on the estimated model:
</p>

<ul>
<li><p><code>call</code> contains the function call;
</p>
</li>
<li><p><code>niter</code> is the number of MCMC iterations;
</p>
</li>
<li><p><code>burnIn</code> is the number of initial iterations to discarded when computing the estimates;
</p>
</li>
<li><p><code>sender</code> is the node-specific sender effect type;
</p>
</li>
<li><p><code>receiver</code> is the node-specific receiver effect type;
</p>
</li>
<li><p><code>covariates</code> is the covariates array, if present;
</p>
</li>
<li><p><code>L</code> is the number of covariates.
</p>
</li></ul>

</td></tr>
</table>


<h3>References</h3>

<p>D'Angelo, S. and Murphy, T. B. and Alfò, M. (2018). Latent space modeling of multidimensional networks with application to the exchange of votes in the Eurovision
Song Contest. <a href="https://arxiv.org/abs/1803.07166">arXiv</a>.
</p>
<p>D'Angelo, S. and Alfò, M. and Murphy, T. B. (2018). Node-specific effects in latent space modelling of multidimensional networks. <a href="https://arxiv.org/abs/1807.03874">arXiv</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+alphaRef">alphaRef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vickers)

it &lt;- 10     # small number of iterations just for example

# 2-dimensional latent space model, no covariates
mod &lt;- multiNet(vickers, niter = it, D = 2)

# 2-dimensional latent space model, sex as covariate
mod &lt;- multiNet(vickers, niter = it, D = 2,
                covariates = sex)

# 2-dimensional latent space model, with constant sender
# effect and variable receiver effect
mod &lt;- multiNet(vickers, niter = it, D = 2,
                sender = "const", receiver = "var")

</code></pre>

<hr>
<h2 id='vickers'>Vickers-Chan 7th Graders Multidimensional Network</h2><span id='topic+vickers'></span><span id='topic+sex'></span>

<h3>Description</h3>

<p>The data by Vickers et al. (1981) represent three different social relations among 29 seventh grade students in a school in Victoria, Australia. A binary covariate matrix is available and it describes if two students share the same sex or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vickers)
</code></pre>


<h3>Details</h3>

<p>The data by Vickers et al. (1981) are stored in a list named <code>vickers</code> and represent three different social relations among 29 seventh grade students, 12 boys and 17 girls, in a school in Victoria, Australia. Each student was asked if
</p>

<ul>
<li><p><em>Network 1</em>: he\ she got on with another given student;
</p>
</li>
<li><p><em>Network 2</em>: he\ she considered another given student as his\ her best friend;
</p>
</li>
<li><p><em>Network 3</em>: he\ she would have liked to work with another given student.
</p>
</li></ul>

<p>The matrix <code>sex</code> is an edge-specific binary covariate recording the gender of pairs of students. If a pair of students is of the same sex, the corresponding entry in the matrix is 0, otherwise is 1.
</p>


<h3>References</h3>

<p>Vickers, M. and Chan, S. (1981). Representing Classroom Social Structure. <em>Melbourne: Victoria Institue of Secondary Education.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vickers)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
