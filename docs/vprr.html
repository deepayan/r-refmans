<!DOCTYPE html><html><head><title>Help for package vprr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vprr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bin_calculate'><p>Get bin averages for VPR and CTD data</p></a></li>
<li><a href='#bin_cast'><p>Bin vpr data</p></a></li>
<li><a href='#concentration_category'><p>Binned concentrations</p></a></li>
<li><a href='#ctd_cast'><p>Isolate ascending or descending section of ctd cast</p></a></li>
<li><a href='#ctd_dat_combine'><p>VPR CTD data</p></a></li>
<li><a href='#ctd_df_cols'><p>Read CTD data (SBE49) and Fluorometer data from CTD- VPR package</p></a></li>
<li><a href='#ctd_roi_merge'><p>VPR CTD data combined with tabulated ROIs</p></a></li>
<li><a href='#ctd_roi_oce'><p>VPR data including CTD and ROI information</p></a></li>
<li><a href='#getRoiMeasurements'><p>THIS FUNCTION HAS BEEN DEPRECATED</p></a></li>
<li><a href='#insertRow'><p>INTERNAL USE ONLY</p>
quick data frame function from github to insert row inside dat frame</a></li>
<li><a href='#isopycnal_calculate'><p>Get vector to draw isopycnal lines on TS plot</p>
Used internally to create TS plots</a></li>
<li><a href='#normalize_matrix'><p>Normalize a matrix</p></a></li>
<li><a href='#px_to_mm'><p>Get conversion factor for pixels to mm for roi measurements</p></a></li>
<li><a href='#roi_dat_combine'><p>VPR ROI data</p></a></li>
<li><a href='#roimeas_dat_combine'><p>VPR measurement data calculated by Visual Plankton</p></a></li>
<li><a href='#size_df_f'><p>VPR size information dataframe</p></a></li>
<li><a href='#taxa_conc_n'><p>A binned data frame of concentration data per category</p></a></li>
<li><a href='#vp_plot_matrix'><p>Plots normalized confusion matrix</p></a></li>
<li><a href='#vp_plot_unkn'><p>Function to visualize losses to unknown category due to disagreement in Dual classifier</p></a></li>
<li><a href='#vpr_autoid_check'><p>Checks manually created aid files for errors</p></a></li>
<li><a href='#vpr_autoid_copy'><p>Copy VPR images into folders</p></a></li>
<li><a href='#vpr_autoid_create'><p>Modifies aid and aid mea files based on manual reclassification</p></a></li>
<li><a href='#vpr_autoid_read'><p>Read VPR aid files</p></a></li>
<li><a href='#vpr_category'><p>Get taxa ids from string</p></a></li>
<li><a href='#vpr_category_create'><p>Create a new taxa to be considered for classification after processing with VP</p></a></li>
<li><a href='#vpr_ctd_files'><p>Create a list of ctd files to be read</p></a></li>
<li><a href='#vpr_ctd_read'><p>Read and format CTD VPR data</p></a></li>
<li><a href='#vpr_ctd_ymd'><p>Add Year/ month/ day hour:minute:second information</p></a></li>
<li><a href='#vpr_ctdroi_merge'><p>Merge CTD and ROI data from VPR</p></a></li>
<li><a href='#vpr_ctdroisize_merge'><p>Format CTD and Size data from VPR</p></a></li>
<li><a href='#vpr_day'><p>Get day identifier</p></a></li>
<li><a href='#vpr_dayhour'><p>Find day &amp; hour info to match each station of interest for processing</p></a></li>
<li><a href='#vpr_hour'><p>Get hour identifier</p></a></li>
<li><a href='#vpr_img_category'><p>Explore images by depth and classification</p></a></li>
<li><a href='#vpr_img_check'><p>Remove ROI strings from aid and aidmeas files based on a manually organized folder of images</p></a></li>
<li><a href='#vpr_img_copy'><p>Image copying function for specific taxa of interest</p></a></li>
<li><a href='#vpr_img_depth'><p>Explore VPR images by depth bin</p></a></li>
<li><a href='#vpr_img_reclassified'><p>Explore reclassified images</p></a></li>
<li><a href='#vpr_manual_classification'><p>Function to check results of classification manually</p></a></li>
<li><a href='#vpr_oce_create'><p>Create ctd oce object with vpr data</p></a></li>
<li><a href='#vpr_plot_contour'><p>Interpolated contour plot of particular variable</p></a></li>
<li><a href='#vpr_plot_histsize'><p>Plot size frequency histogram</p></a></li>
<li><a href='#vpr_plot_profile'><p>Plots VPR profiles of temperature, salinity, density, fluorescence and concentration (by classification group)</p></a></li>
<li><a href='#vpr_plot_sizefreq'><p>Size Frequency plots for VPR data</p></a></li>
<li><a href='#vpr_plot_TS'><p>Make a balloon plot against a TS plot</p></a></li>
<li><a href='#vpr_plot_TScat'><p>Make a balloon plot</p></a></li>
<li><a href='#vpr_pred_read'><p>Read prediction output from a CNN model</p></a></li>
<li><a href='#vpr_roi'><p>Get roi ids from string</p></a></li>
<li><a href='#vpr_roi_concentration'><p>Calculate VPR concentrations</p></a></li>
<li><a href='#vpr_save'><p>Save VPR data as an as.oce object</p></a></li>
<li><a href='#vpr_size_bin'><p>Bin VPR size data</p></a></li>
<li><a href='#vpr_summary'><p>Data Summary Report</p></a></li>
<li><a href='#vpr_trrois_size'><p>Get size data from idsize files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Processing and Visualization of Video Plankton Recorder Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emily O'Grady &lt;vprrcontact@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An oceanographic data processing package for analyzing and visualizing Video 
    Plankton Recorder data.  This package was developed at 'Bedford Institute of Oceanography'.
    Functions are designed to process automated image classification output and create organized and 
    easily portable data products.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, oce, dplyr, interp, magick, gsw, tidyr, stringr,
metR, gridExtra, lubridate, cmocean, withr, usethis</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://eogrady21.github.io/vprr/">https://eogrady21.github.io/vprr/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-12 12:14:19 UTC; ChisholmE</td>
</tr>
<tr>
<td>Author:</td>
<td>Emily O'Grady [aut, cre, cph],
  Kevin Sorochan dev [aut],
  Catherine Johnson [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-12 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bin_calculate'>Get bin averages for VPR and CTD data</h2><span id='topic+bin_calculate'></span>

<h3>Description</h3>

<p>Bins CTD data for an individual cast to avoid depth averaging across tow-yo's
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_calculate(data, binSize = 1, imageVolume, rev = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_calculate_+3A_data">data</code></td>
<td>
<p>ctd data frame object including scan, salinity, temperature,
depth, conductivity, time, fluor_ref, turbidity_ref, turbidity_mv,
altitude, cast_id, n_roi</p>
</td></tr>
<tr><td><code id="bin_calculate_+3A_binsize">binSize</code></td>
<td>
<p>the height of bins over which to average, default is 1 metre</p>
</td></tr>
<tr><td><code id="bin_calculate_+3A_imagevolume">imageVolume</code></td>
<td>
<p>the volume of VPR images used for calculating concentrations (mm^3)</p>
</td></tr>
<tr><td><code id="bin_calculate_+3A_rev">rev</code></td>
<td>
<p>logical value, if TRUE, binning will begin at bottom of each cast,
this controls data loss due to uneven binning over depth. If bins begin at
bottom, small amounts of data may be lost at the surface of each cast, if
binning begins at surface (rev = FALSE), small amounts of data may be lost
at bottom of each cast</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Image volume calculations can change based on optical setting of VPR as well as autodeck setting used to process images
For IML2018051 (S2) image volume was calculated as 108155 mm^3 by seascan (6.6 cubic inches)
For COR2019002 S2 image volume was calculated as 83663 mm^3 and S3 image volume was calculated as 366082 mm^3.
Used internally ( <code><a href="#topic+bin_cast">bin_cast</a></code> ) after <code><a href="#topic+ctd_cast">ctd_cast</a></code> on a single ascending or descending section of VPR cast
</p>


<h3>Note</h3>

<p>binSize should be carefully considered for best results
</p>
<p>Depth is used for calculations! Please ensure depth is included in data frame using <a href="oce.html#topic+swDepth">swDepth</a>
</p>


<h3>Author(s)</h3>

<p>E. Chisholm, K. Sorochan
</p>

<hr>
<h2 id='bin_cast'>Bin vpr data</h2><span id='topic+bin_cast'></span>

<h3>Description</h3>

<p>Formats <code>oce</code> style VPR data into depth averaged bins using <code><a href="#topic+ctd_cast">ctd_cast</a></code> and <code><a href="#topic+bin_calculate">bin_calculate</a></code>
This function is used inside <code><a href="#topic+concentration_category">concentration_category</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_cast(ctd_roi_oce, imageVolume, binSize, rev = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_cast_+3A_ctd_roi_oce">ctd_roi_oce</code></td>
<td>
<p><code>oce</code> ctd format VPR data from <code><a href="#topic+vpr_oce_create">vpr_oce_create</a></code></p>
</td></tr>
<tr><td><code id="bin_cast_+3A_imagevolume">imageVolume</code></td>
<td>
<p>the volume of VPR images used for calculating concentrations (mm^3)</p>
</td></tr>
<tr><td><code id="bin_cast_+3A_binsize">binSize</code></td>
<td>
<p>passed to <code><a href="#topic+bin_calculate">bin_calculate</a></code>, determines size of depth bins over which data is averaged</p>
</td></tr>
<tr><td><code id="bin_cast_+3A_rev">rev</code></td>
<td>
<p>logical value,passed to <code><a href="#topic+bin_calculate">bin_calculate</a></code> if TRUE, binning will begin at bottom of each cast,
this controls data loss due to uneven binning over depth. If bins begin at
bottom, small amounts of data may be lost at the surface of each cast, if
binning begins at surface (rev = FALSE), small amounts of data may be lost
at bottom of each cast</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Image volume calculations can change based on optical setting of VPR as well as autodeck setting used to process images
For IML2018051 (S2) image volume was calculated as 108155 mm^3 by seascan (6.6 cubic inches)
For COR2019002 S2 image volume was calculated as 83663 mm^3 and S3 image volume was calculated as 366082 mm^3
</p>


<h3>Value</h3>

<p>A dataframe of depth averaged bins of VPR data over an entire cast with calculated concentration values
</p>

<hr>
<h2 id='concentration_category'>Binned concentrations</h2><span id='topic+concentration_category'></span>

<h3>Description</h3>

<p>This function produces depth binned concentrations for a specified taxa. Similar to <code><a href="#topic+bin_cast">bin_cast</a></code> but calculates concentrations for only one taxa.
Used inside <code><a href="#topic+vpr_roi_concentration">vpr_roi_concentration</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concentration_category(data, taxa, binSize, imageVolume, rev = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concentration_category_+3A_data">data</code></td>
<td>
<p>dataframe produced by processing internal to vpr_roi_concentration</p>
</td></tr>
<tr><td><code id="concentration_category_+3A_taxa">taxa</code></td>
<td>
<p>name of taxa isolated</p>
</td></tr>
<tr><td><code id="concentration_category_+3A_binsize">binSize</code></td>
<td>
<p>passed to <code><a href="#topic+bin_calculate">bin_calculate</a></code>, determines size of depth bins over which data is averaged</p>
</td></tr>
<tr><td><code id="concentration_category_+3A_imagevolume">imageVolume</code></td>
<td>
<p>the volume of VPR images used for calculating concentrations (mm^3)</p>
</td></tr>
<tr><td><code id="concentration_category_+3A_rev">rev</code></td>
<td>
<p>Logical value defining direction of binning, FALSE - bins will be
calculated from surface to bottom, TRUE- bins will be calculated bottom to
surface</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Image volume calculations can change based on optical setting of VPR as well as autodeck setting used to process images
For IML2018051 (S2) image volume was calculated as 108155 mm^3 by seascan (6.6 cubic inches)
For COR2019002 S2 image volume was calculated as 83663 mm^3 and S3 image volume was calculated as 366082 mm^3
</p>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='ctd_cast'>Isolate ascending or descending section of ctd cast</h2><span id='topic+ctd_cast'></span>

<h3>Description</h3>

<p>This is an internal step required to bin data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctd_cast(
  data,
  cast_direction = "ascending",
  data_type,
  cutoff = 0.1,
  breaks = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctd_cast_+3A_data">data</code></td>
<td>
<p>an <code>oce</code> ctd object</p>
</td></tr>
<tr><td><code id="ctd_cast_+3A_cast_direction">cast_direction</code></td>
<td>
<p>'ascending' or 'descending' depending on desired section</p>
</td></tr>
<tr><td><code id="ctd_cast_+3A_data_type">data_type</code></td>
<td>
<p>specify 'oce' or 'df' depending on class of desired output</p>
</td></tr>
<tr><td><code id="ctd_cast_+3A_cutoff">cutoff</code></td>
<td>
<p>Argument passed to <a href="oce.html#topic+ctdFindProfiles">ctdFindProfiles</a></p>
</td></tr>
<tr><td><code id="ctd_cast_+3A_breaks">breaks</code></td>
<td>
<p>Argument passed to <a href="oce.html#topic+ctdFindProfiles">ctdFindProfiles</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Outputs either data frame or oce ctd object
</p>


<h3>Note</h3>

<p><code><a href="oce.html#topic+ctdFindProfiles">ctdFindProfiles</a></code> arguments for <code>minLength</code> and <code>cutOff</code> were updated to
prevent losing data (EC 2019/07/23)
</p>


<h3>Author(s)</h3>

<p>K Sorochan, E Chisholm
</p>

<hr>
<h2 id='ctd_dat_combine'>VPR CTD data</h2><span id='topic+ctd_dat_combine'></span>

<h3>Description</h3>

<p>A dataframe including all CTD parameters from the VPR CTD,
produced by <code><a href="#topic+vpr_ctd_read">vpr_ctd_read</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctd_dat_combine
</code></pre>


<h3>Format</h3>

<p>A dataframe with 15 variables
</p>

<dl>
<dt>time_ms</dt><dd><p>Time stamp when ROI was collected (milliseconds)</p>
</dd>
<dt>conductivity</dt><dd><p>Conductivity collected by the VPR CTD</p>
</dd>
<dt>pressure</dt><dd><p>Pressure measured from the VPR CTD in decibars</p>
</dd>
<dt>temperature</dt><dd><p>Temperature measured from the VPR CTD in celsius</p>
</dd>
<dt>salinity</dt><dd><p>Salinity measured from the VPR CTD</p>
</dd>
<dt>fluor_ref</dt><dd><p>A reference fluorescence baseline provided in millivolts by the VPR CTD for calibrating fluorescence_mv data</p>
</dd>
<dt>fluorescence_mv</dt><dd><p>Fluorescence in millivolts from the VPR CTD (uncalibrated)</p>
</dd>
<dt>turbidity_ref</dt><dd><p>A reference turbidity baseline provided in millivolts for calibrating turbidity_mv</p>
</dd>
<dt>turbidity_mv</dt><dd><p>Turbidity in millivolts from the VPR CTD (uncalibrated)</p>
</dd>
<dt>altitude_NA</dt><dd><p>Altitude data from the VPR CTD</p>
</dd>
<dt>day</dt><dd><p>Day on which VPR data was collected (from AutoDeck)</p>
</dd>
<dt>hour</dt><dd><p>Hour during which VPR data was collected (from AutoDeck)</p>
</dd>
<dt>station</dt><dd><p>Station idnetifier provided during processing</p>
</dd>
<dt>sigmaT</dt><dd><p>Density caluclated from temperature, pressure and salinity data</p>
</dd>
<dt>depth</dt><dd><p>Depth in metres caluclated form pressure</p>
</dd>
</dl>


<hr>
<h2 id='ctd_df_cols'>Read CTD data (SBE49) and Fluorometer data from CTD- VPR package</h2><span id='topic+ctd_df_cols'></span>

<h3>Description</h3>

<p>Internal use <code><a href="#topic+vpr_ctd_read">vpr_ctd_read</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctd_df_cols(x, col_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctd_df_cols_+3A_x">x</code></td>
<td>
<p>full filename (ctd .dat file)</p>
</td></tr>
<tr><td><code id="ctd_df_cols_+3A_col_list">col_list</code></td>
<td>
<p>list of CTD data column names</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>WARNING</strong> This is hard coded to accept a specific
order of CTD data columns. The names and values in these columns can change
based on the specific instrument and should be updated before processing data
from a new VPR.
</p>
<p>Text file format .dat file
Outputs ctd dataframe with variables time_ms, conductivity, temperature,
pressure, salinity, fluor_ref, fluorescence_mv, turbidity_ref,
turbidity_mv, altitude_NA
</p>


<h3>Author(s)</h3>

<p>K. Sorochan, E. Chisholm
</p>

<hr>
<h2 id='ctd_roi_merge'>VPR CTD data combined with tabulated ROIs</h2><span id='topic+ctd_roi_merge'></span>

<h3>Description</h3>

<p>A dataframe representing CTD data which has been merged with tabulated
ROIs in each category, produced by <code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctd_roi_merge
</code></pre>


<h3>Format</h3>

<p>A dataframe with 28 variables
</p>

<dl>
<dt>time_ms</dt><dd><p>Time stamp when ROI was collected (milliseconds)</p>
</dd>
<dt>conductivity</dt><dd><p>Conductivity collected by the VPR CTD</p>
</dd>
<dt>pressure</dt><dd><p>Pressure measured from the VPR CTD in decibars</p>
</dd>
<dt>temperature</dt><dd><p>Temperature measured from the VPR CTD in celsius</p>
</dd>
<dt>salinity</dt><dd><p>Salinity measured from the VPR CTD</p>
</dd>
<dt>fluor_ref</dt><dd><p>A reference fluorescence baseline provided in millivolts by the VPR CTD for calibrating fluorescence_mv data</p>
</dd>
<dt>fluorescence_mv</dt><dd><p>Fluorescence in millivolts from the VPR CTD (uncalibrated)</p>
</dd>
<dt>turbidity_ref</dt><dd><p>A reference turbidity baseline provided in millivolts for calibrating turbidity_mv</p>
</dd>
<dt>turbidity_mv</dt><dd><p>Turbidity in millivolts from the VPR CTD (uncalibrated)</p>
</dd>
<dt>altitude_NA</dt><dd><p>Altitude data from the VPR CTD</p>
</dd>
<dt>day</dt><dd><p>Day on which VPR data was collected (from AutoDeck)</p>
</dd>
<dt>hour</dt><dd><p>Hour during which VPR data was collected (from AutoDeck)</p>
</dd>
<dt>station</dt><dd><p>Station identifier provided during processing</p>
</dd>
<dt>sigmaT</dt><dd><p>Density caluclated from temperature, pressure and salinity data</p>
</dd>
<dt>depth</dt><dd><p>Depth in metres caluclated form pressure</p>
</dd>
<dt>roi</dt><dd><p>ROI identification number</p>
</dd>
<dt>categories</dt><dd><p>For each category name (eg. bad_image_blurry, Calanus, krill), there is a line in the dataframe representing the number of ROIs identified in this category</p>
</dd>
<dt>n_roi_total</dt><dd><p>Total number of ROIs in all categories for each CTD data point</p>
</dd>
</dl>


<hr>
<h2 id='ctd_roi_oce'>VPR data including CTD and ROI information</h2><span id='topic+ctd_roi_oce'></span>

<h3>Description</h3>

<p>An oce formatted CTD object with VPR CTD and ROI data from package example
data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctd_roi_oce
</code></pre>


<h3>Format</h3>

<p>An oce package format, a 'CTD' object with VPR CTD and ROI data (1000
data rows)
</p>

<hr>
<h2 id='getRoiMeasurements'>THIS FUNCTION HAS BEEN DEPRECATED</h2><span id='topic+getRoiMeasurements'></span>

<h3>Description</h3>

<p>pull roi measurements from all taxa, all files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRoiMeasurements(taxafolder, nchar_folder, unit = "mm", opticalSetting)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRoiMeasurements_+3A_taxafolder">taxafolder</code></td>
<td>
<p>path to taxa folder (base &ndash; autoid folder)</p>
</td></tr>
<tr><td><code id="getRoiMeasurements_+3A_nchar_folder">nchar_folder</code></td>
<td>
<p>number of characters in basepath</p>
</td></tr>
<tr><td><code id="getRoiMeasurements_+3A_unit">unit</code></td>
<td>
<p>unit data will be output in, 'mm' (default &ndash; millimetres) or 'px' (pixels)</p>
</td></tr>
<tr><td><code id="getRoiMeasurements_+3A_opticalsetting">opticalSetting</code></td>
<td>
<p>VPR optical setting determining conversion between pixels and millimetres (options are 'S0', 'S1', 'S2', or 'S3')</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is very finicky, easily broken because it relies on character string splitting.
taxaFolder argument should not end in a backslash, please check output carefully to
ensure taxa names or ROI numbers have been properly sub string'd
</p>

<hr>
<h2 id='insertRow'>INTERNAL USE ONLY
quick data frame function from github to insert row inside dat frame</h2><span id='topic+insertRow'></span>

<h3>Description</h3>

<p>INTERNAL USE ONLY
quick data frame function from github to insert row inside dat frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insertRow(existingDF, newrow, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insertRow_+3A_existingdf">existingDF</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="insertRow_+3A_newrow">newrow</code></td>
<td>
<p>new row of data</p>
</td></tr>
<tr><td><code id="insertRow_+3A_r">r</code></td>
<td>
<p>index of new row</p>
</td></tr>
</table>

<hr>
<h2 id='isopycnal_calculate'>Get vector to draw isopycnal lines on TS plot
Used internally to create TS plots</h2><span id='topic+isopycnal_calculate'></span>

<h3>Description</h3>

<p>Get vector to draw isopycnal lines on TS plot
Used internally to create TS plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isopycnal_calculate(sal, pot.temp, reference.p = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isopycnal_calculate_+3A_sal">sal</code></td>
<td>
<p>salinity vector</p>
</td></tr>
<tr><td><code id="isopycnal_calculate_+3A_pot.temp">pot.temp</code></td>
<td>
<p>temperature vector in deg C</p>
</td></tr>
<tr><td><code id="isopycnal_calculate_+3A_reference.p">reference.p</code></td>
<td>
<p>reference pressure for calculation, set to 0</p>
</td></tr>
</table>


<h3>Note</h3>

<p>: modified from source:<a href="https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R">https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R</a>
</p>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='normalize_matrix'>Normalize a matrix</h2><span id='topic+normalize_matrix'></span>

<h3>Description</h3>

<p>take each element of matrix dived by column total
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize_matrix(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_matrix_+3A_mat">mat</code></td>
<td>
<p>a matrix to normalize</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Make sure to remove total rows before using with VP data
</p>


<h3>Note</h3>

<p>used internally for visualization of confusion matrices
</p>

<hr>
<h2 id='px_to_mm'>Get conversion factor for pixels to mm for roi measurements</h2><span id='topic+px_to_mm'></span>

<h3>Description</h3>

<p>Used internally
</p>


<h3>Usage</h3>

<pre><code class='language-R'>px_to_mm(x, opticalSetting)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="px_to_mm_+3A_x">x</code></td>
<td>
<p>an aidmea data frame (standard) to be converted into mm from pixels</p>
</td></tr>
<tr><td><code id="px_to_mm_+3A_opticalsetting">opticalSetting</code></td>
<td>
<p>the VPR setting determining the field of view and conversion factor between mm and pixels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>converts pixels to mm using conversion factor specific to optical setting
</p>
<p>Options for opticalSetting are 'S0', 'S1', 'S2', or 'S3'
</p>

<hr>
<h2 id='roi_dat_combine'>VPR ROI data</h2><span id='topic+roi_dat_combine'></span>

<h3>Description</h3>

<p>A dataframe including VPR ROI data from the sample dataset, produced by
<code><a href="#topic+vpr_autoid_read">vpr_autoid_read</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roi_dat_combine
</code></pre>


<h3>Format</h3>

<p>A dataframe with 13 variables
</p>

<dl>
<dt>roi</dt><dd><p>Unique ROI identifier - 8 digit</p>
</dd>
<dt>categories</dt><dd><p>For each category name (eg. bad_image_blurry, Calanus, krill), there is a line in the dataframe representing the number of ROIs identified in this category</p>
</dd>
<dt>time_ms</dt><dd><p>Time stamp when ROI was collected (milliseconds)</p>
</dd>
</dl>


<hr>
<h2 id='roimeas_dat_combine'>VPR measurement data calculated by Visual Plankton</h2><span id='topic+roimeas_dat_combine'></span>

<h3>Description</h3>

<p>A data frame of measurement information for each ROI in the sample
data set including long axis length, perimeter and area, produced by
<code><a href="#topic+vpr_autoid_read">vpr_autoid_read</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roimeas_dat_combine
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 variables
</p>

<dl>
<dt>roi</dt><dd><p>Unique ROI identifier - 10 digit</p>
</dd>
<dt>taxa</dt><dd><p>Category in which ROI has been classified by Visual Plankton</p>
</dd>
<dt>day_hour</dt><dd><p>day and hour in which data was collected (from Autodeck)</p>
</dd>
<dt>Perimeter</dt><dd><p>The perimeter of the ROI in millimeters</p>
</dd>
<dt>Area</dt><dd><p>The area of the ROI in millimeters</p>
</dd>
<dt>width1</dt><dd><p>Width at a first point of the ROI in millimetres (defined in more detail in VPR manual)</p>
</dd>
<dt>width2</dt><dd><p>Width at a second point of the ROI in millimetres (defined in more detail in VPR manual)</p>
</dd>
<dt>width3</dt><dd><p>Width at a third point of the ROI in millimetres (defined in more detail in VPR manual)</p>
</dd>
<dt>short_axis_length</dt><dd><p>The length in millimeters of the ROI along the shorter axis</p>
</dd>
<dt>long_axis_length</dt><dd><p>The length in millimeters of the ROI along the longer axis</p>
</dd>
<dt>station</dt><dd><p>Station identifier provided in processing</p>
</dd>
<dt>time_ms</dt><dd><p>Time stamp when ROI was collected in milliseconds</p>
</dd>
</dl>


<hr>
<h2 id='size_df_f'>VPR size information dataframe</h2><span id='topic+size_df_f'></span>

<h3>Description</h3>

<p>A sample data frame of size information from Visual Plankton outputs,
processed using <code><a href="#topic+vpr_ctdroisize_merge">vpr_ctdroisize_merge</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>size_df_f
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 14 rows and 14 columns.
</p>


<h3>Details</h3>

<p>@format A dataframe with 14 variables including
</p>

<dl>
<dt>frame_ID</dt><dd><p>Unique identifier for each VPR frame</p>
</dd>
<dt>pressure</dt><dd><p>Pressure measured from the VPR CTD in decibars</p>
</dd>
<dt>temperature</dt><dd><p>Temperature measured from the VPR CTD in celsius</p>
</dd>
<dt>salinity</dt><dd><p>Salinity measured from the VPR CTD</p>
</dd>
<dt>sigmaT</dt><dd><p>Density calculated from temperature, salinity and pressure</p>
</dd>
<dt>fluorescence_mv</dt><dd><p>Fluorescence measured by the VPR CTD in millivolts
(uncalibrated)</p>
</dd>
<dt>turbidity_mv</dt><dd><p>Turbidity measured by the VPR CTD in
millivolts (uncalibrated)</p>
</dd>
<dt>roi</dt><dd><p>Unique ROI identification number - 10
digits, 8 digit millisecond time stamp and two unique digits to denote
multiple ROIs within a millisecond</p>
</dd>
<dt>taxa</dt><dd><p>Category in which ROI has
been classified by Visual Plankton</p>
</dd>
<dt>day_hour</dt><dd><p>Day and hour in which
data was collected, from AutoDeck processing</p>
</dd>
<dt>long_axis_length</dt><dd><p>The
length of the longest axis of the ROI image, measured by Visual Plankton</p>
</dd>
<dt>station</dt><dd><p>Station identifier provided during processing</p>
</dd>
<dt>time_ms</dt><dd><p>Time stamp when ROI was collected (milliseconds)</p>
</dd>
<dt>roi_ID</dt><dd><p>ROI identification number- 8 digit time stamp, without unique
2 digit ending</p>
</dd>
</dl>


<hr>
<h2 id='taxa_conc_n'>A binned data frame of concentration data per category</h2><span id='topic+taxa_conc_n'></span>

<h3>Description</h3>

<p>A 'binned' dataframe from sample VPR data, including concentrations
of each category, where each data point represents a 5 metre bin of
averaged VPR data. Produced using <code><a href="#topic+vpr_roi_concentration">vpr_roi_concentration</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxa_conc_n
</code></pre>


<h3>Format</h3>

<p>A dataframe with 21 variables
</p>

<dl>
<dt>depth</dt><dd><p>Depth calculated from pressure in metres</p>
</dd>
<dt>min_depth</dt><dd><p>The minimum depth of the bin in metres</p>
</dd>
<dt>max_depth</dt><dd><p>The maximum depth of the bin in metres</p>
</dd>
<dt>depth_diff</dt><dd><p>The difference between minimum and maximum bin depth in metres</p>
</dd>
<dt>min_time_s</dt><dd><p>The minimum time in seconds of the bin</p>
</dd>
<dt>max_time_s</dt><dd><p>The maximum time in seconds of the bin</p>
</dd>
<dt>time_diff_s</dt><dd><p>The difference between minimum and maximum time in a bin, in seconds</p>
</dd>
<dt>n_roi_bin</dt><dd><p>The number of ROI observations in a bin</p>
</dd>
<dt>conc_m3</dt><dd><p>The concentration of ROIs in a bin, calculated based on image volume and number of frames per bin</p>
</dd>
<dt>temperature</dt><dd><p>Temperature measured from the VPR CTD in celsius (averaged within the bin)</p>
</dd>
<dt>salinity</dt><dd><p>Salinity measured from the VPR CTD (averaged within the bin)</p>
</dd>
<dt>density</dt><dd><p>sigma T density calculated from temperature, salinity and pressure (averaged within the bin)</p>
</dd>
<dt>fluorescence</dt><dd><p>Fluorescence measured by the VPR CTD in millivolts
(uncalibrated) (averaged within the bin)</p>
</dd>
<dt>turbidity</dt><dd><p>Turbidity measured by the VPR CTD in
millivolts (uncalibrated) (averaged within the bin)</p>
</dd>
<dt>avg_hr</dt><dd><p>The mean time in which bin data was collected, in hours</p>
</dd>
<dt>n_frames</dt><dd><p>The number of frames captured within a bin</p>
</dd>
<dt>vol_sampled_bin_m3</dt><dd><p>The volume of the bin sampled in metres cubed</p>
</dd>
<dt>toyo</dt><dd><p>Identifier of the tow-yo section which bin is a part of, either ascending or descending, appended by a number</p>
</dd>
<dt>max_cast_depth</dt><dd><p>The maximum depth of the entire VPR cast</p>
</dd>
<dt>taxa</dt><dd><p>The category in which ROIs in bin have been classified by Visual Plankton</p>
</dd>
<dt>station</dt><dd><p>Station identifier provided during processing</p>
</dd>
</dl>


<hr>
<h2 id='vp_plot_matrix'>Plots normalized confusion matrix</h2><span id='topic+vp_plot_matrix'></span>

<h3>Description</h3>

<p>Plots normalized confusion matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vp_plot_matrix(cm, classes, type, addLabels = TRUE, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vp_plot_matrix_+3A_cm">cm</code></td>
<td>
<p>Confusion matrix (numeric)</p>
</td></tr>
<tr><td><code id="vp_plot_matrix_+3A_classes">classes</code></td>
<td>
<p>character list of classes present in confusion matrix
(ordered)</p>
</td></tr>
<tr><td><code id="vp_plot_matrix_+3A_type">type</code></td>
<td>
<p>character value 'NN', 'SVM' or 'Dual', appended to 'Confusion
Matrix' to create title</p>
</td></tr>
<tr><td><code id="vp_plot_matrix_+3A_addlabels">addLabels</code></td>
<td>
<p>logical value whether to add percentage accuracy labels to
plot (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="vp_plot_matrix_+3A_threshold">threshold</code></td>
<td>
<p>numeric value which determines the minimum value of
frequency labelled on the plot on a normalized scale of 0-1 (useful for highlighting significant
disagreement)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a visualization of the confusion matrix, normalized
</p>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='vp_plot_unkn'>Function to visualize losses to unknown category due to disagreement in Dual classifier</h2><span id='topic+vp_plot_unkn'></span>

<h3>Description</h3>

<p>Makes confusion matrix like plot, where x axis represent SVM classification, y axis represent NN classification
Allows visual summary of data lost to unknown category
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vp_plot_unkn(cm, classes, threshold = 0, summary = TRUE, sample_size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vp_plot_unkn_+3A_cm">cm</code></td>
<td>
<p>dual unknown confusion matrix from VP</p>
</td></tr>
<tr><td><code id="vp_plot_unkn_+3A_classes">classes</code></td>
<td>
<p>taxa groups in order, from VP</p>
</td></tr>
<tr><td><code id="vp_plot_unkn_+3A_threshold">threshold</code></td>
<td>
<p>minimum value which will be labelled in plot</p>
</td></tr>
<tr><td><code id="vp_plot_unkn_+3A_summary">summary</code></td>
<td>
<p>logical to add text summary to plot
E. Chisholm May 2019</p>
</td></tr>
<tr><td><code id="vp_plot_unkn_+3A_sample_size">sample_size</code></td>
<td>
<p>character string describes the sample size used to train the model being plotted (optional)</p>
</td></tr>
</table>

<hr>
<h2 id='vpr_autoid_check'>Checks manually created aid files for errors</h2><span id='topic+vpr_autoid_check'></span>

<h3>Description</h3>

<p>Removes any empty aid files after manual reclassification, checks for tow
numbers and other metadata to match. Performs check to ensure measurement and
ROI files are the same length
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_autoid_check(basepath, cruise, del)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_autoid_check_+3A_basepath">basepath</code></td>
<td>
<p>basepath to autoid folder eg. C:/data/CRUISENAME/autoid/</p>
</td></tr>
<tr><td><code id="vpr_autoid_check_+3A_cruise">cruise</code></td>
<td>
<p>name of cruise which is being checked</p>
</td></tr>
<tr><td><code id="vpr_autoid_check_+3A_del">del</code></td>
<td>
<p>Logical value, if <code>TRUE</code>, empty files will be deleted (see warning), if <code>FALSE</code>, files WILL NOT be deleted (they will be listed in output)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING: This function will delete empty aid and aidmeas files, permanently changing your directory. Consider making a back up copy before running this function.
</p>


<h3>Value</h3>

<p>text file (saved in working directory) named CRUISENAME_aid_file_check.txt
</p>


<h3>Author(s)</h3>

<p>E Chisholm
</p>

<hr>
<h2 id='vpr_autoid_copy'>Copy VPR images into folders</h2><span id='topic+vpr_autoid_copy'></span>

<h3>Description</h3>

<p>Organize VPR images into folders based on classifications provided by visual plankton
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_autoid_copy(basepath, day, hour, classifier_type, classifier_name, taxa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_autoid_copy_+3A_basepath">basepath</code></td>
<td>
<p>A file path to your autoid folder where VP data is stored eg. &quot;C:\\data\\cruise_XXXXXXXXXXXXXXX\\autoid\\&quot;</p>
</td></tr>
<tr><td><code id="vpr_autoid_copy_+3A_day">day</code></td>
<td>
<p>character string representing numeric day of interest</p>
</td></tr>
<tr><td><code id="vpr_autoid_copy_+3A_hour">hour</code></td>
<td>
<p>character string representing hour of interest</p>
</td></tr>
<tr><td><code id="vpr_autoid_copy_+3A_classifier_type">classifier_type</code></td>
<td>
<p>character string representing the type of classifier (either 'svm', 'nn' or 'dual') from Visual Plankton</p>
</td></tr>
<tr><td><code id="vpr_autoid_copy_+3A_classifier_name">classifier_name</code></td>
<td>
<p>character string representing name of Visual Plankton classifier</p>
</td></tr>
<tr><td><code id="vpr_autoid_copy_+3A_taxa">taxa</code></td>
<td>
<p>optional list of character strings if you wish to only copy images from specific classification groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>organized file directory where VPR images are contained with folders, organized by day, hour and classification,
inside your basepath/autoid folder
</p>

<hr>
<h2 id='vpr_autoid_create'>Modifies aid and aid mea files based on manual reclassification</h2><span id='topic+vpr_autoid_create'></span>

<h3>Description</h3>

<p>Modifies aid and aid mea files based on manual reclassification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_autoid_create(reclassify, misclassified, basepath, day, hour, mea = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_autoid_create_+3A_reclassify">reclassify</code></td>
<td>
<p>list of reclassify files (output from vpr_manual_classification())</p>
</td></tr>
<tr><td><code id="vpr_autoid_create_+3A_misclassified">misclassified</code></td>
<td>
<p>list misclassify files (output from vpr_manual_classification())</p>
</td></tr>
<tr><td><code id="vpr_autoid_create_+3A_basepath">basepath</code></td>
<td>
<p>base path to auto ID folder eg 'E:/autoID_EC_07032019/'</p>
</td></tr>
<tr><td><code id="vpr_autoid_create_+3A_day">day</code></td>
<td>
<p>day identifier for relevant aid &amp; aidmeas files</p>
</td></tr>
<tr><td><code id="vpr_autoid_create_+3A_hour">hour</code></td>
<td>
<p>hour identifier for relevant aid &amp; aidmeas files</p>
</td></tr>
<tr><td><code id="vpr_autoid_create_+3A_mea">mea</code></td>
<td>
<p>logical indicating whether or not there are accompanying measurement files to be created
</p>


<h4>examples</h4>

<p>basepath &lt;- 'E:/autoID_EC_07032019/'
day &lt;- '289'
hr &lt;- '08'
day_hour_files &lt;-  paste0('d', day, '.h', hr)
misclassified &lt;- list.files(day_hour_files, pattern = 'misclassified_', full.names = TRUE)
reclassify &lt;- list.files(day_hour_files, pattern = 'reclassify_', full.names = TRUE)
vpr_autoid_create(reclassify, misclassified, basepath)
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='vpr_autoid_read'>Read VPR aid files</h2><span id='topic+vpr_autoid_read'></span>

<h3>Description</h3>

<p>Read aid text files containing ROI string information or measurement data and output as a dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_autoid_read(
  file_list_aid,
  file_list_aidmeas,
  export,
  station_of_interest,
  opticalSetting,
  warn = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_autoid_read_+3A_file_list_aid">file_list_aid</code></td>
<td>
<p>a list object of aid text files, containing roi strings. Output from matlab Visual Plankton software.</p>
</td></tr>
<tr><td><code id="vpr_autoid_read_+3A_file_list_aidmeas">file_list_aidmeas</code></td>
<td>
<p>a list object of aidmea text files, containing ROI measurements. Output from matlab Visual Plankton software.</p>
</td></tr>
<tr><td><code id="vpr_autoid_read_+3A_export">export</code></td>
<td>
<p>a character string specifying which type of data to output, either 'aid' (roi strings) or 'aidmeas' (measurement data)</p>
</td></tr>
<tr><td><code id="vpr_autoid_read_+3A_station_of_interest">station_of_interest</code></td>
<td>
<p>Station information to be added to ROI data output, use NA if irrelevant</p>
</td></tr>
<tr><td><code id="vpr_autoid_read_+3A_opticalsetting">opticalSetting</code></td>
<td>
<p>Optional argument specifying VPR optical setting. If provided will be used to convert size data into mm from pixels, if missing size data will be output in pixels</p>
</td></tr>
<tr><td><code id="vpr_autoid_read_+3A_warn">warn</code></td>
<td>
<p>Logical, FALSE silences size data unit warnings</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only outputs either ROI string information OR measurement data
</p>


<h3>Note</h3>

<p>Full paths to each file should be specified
</p>


<h3>Author(s)</h3>

<p>E. Chisholm &amp; K. Sorochan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
station_of_interest &lt;- 'test'
dayhour &lt;- c('d222.h03', 'd222.h04')

#' #VPR OPTICAL SETTING (S0, S1, S2 OR S3)
opticalSetting &lt;- "S2"
imageVolume &lt;- 83663 #mm^3

auto_id_folder &lt;- system.file('extdata/COR2019002/autoid/', package = 'vprr', mustWork = TRUE)
auto_id_path &lt;- list.files(paste0(auto_id_folder, "/"), full.names = TRUE)

#'   # Path to aid for each taxa
aid_path &lt;- paste0(auto_id_path, '/aid/')
# Path to mea for each taxa
aidmea_path &lt;- paste0(auto_id_path, '/aidmea/')

# AUTO ID FILES
aid_file_list &lt;- list()
aidmea_file_list &lt;- list()
for (i in 1:length(dayhour)) {
  aid_file_list[[i]] &lt;-
    list.files(aid_path, pattern = dayhour[[i]], full.names = TRUE)
  # SIZE DATA FILES
  aidmea_file_list[[i]] &lt;-
    list.files(aidmea_path, pattern = dayhour[[i]], full.names = TRUE)
}

aid_file_list_all &lt;- unlist(aid_file_list)
aidmea_file_list_all &lt;- unlist(aidmea_file_list)

 # ROIs
roi_dat_combine &lt;-
  vpr_autoid_read(
    file_list_aid = aid_file_list_all,
    file_list_aidmeas = aidmea_file_list_all,
    export = 'aid',
    station_of_interest = station_of_interest,
    opticalSetting = opticalSetting,
    warn = FALSE
  )

# MEASUREMENTS
roimeas_dat_combine &lt;-
  vpr_autoid_read(
    file_list_aid = aid_file_list_all,
    file_list_aidmeas = aidmea_file_list_all,
    export = 'aidmeas',
    station_of_interest = station_of_interest,
    opticalSetting = opticalSetting,
    warn = FALSE
 )

</code></pre>

<hr>
<h2 id='vpr_category'>Get taxa ids from string</h2><span id='topic+vpr_category'></span>

<h3>Description</h3>

<p>Get taxa ids from string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_category(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_category_+3A_x">x</code></td>
<td>
<p>A string specifying the directory of the &quot;taxafolder&quot;, containing the taxa id</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of only the taxa id
</p>


<h3>Author(s)</h3>

<p>K Sorochan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vpr_hour">vpr_hour</a></code>, <code><a href="#topic+vpr_day">vpr_day</a></code>, <code><a href="#topic+vpr_roi">vpr_roi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>taxa_string &lt;- 'C:/data/cruise/autoid/Calanus/d000/h00'
vpr_category(taxa_string)

</code></pre>

<hr>
<h2 id='vpr_category_create'>Create a new taxa to be considered for classification after processing with VP</h2><span id='topic+vpr_category_create'></span>

<h3>Description</h3>

<p>creates empty directory structure to allow consideration of new taxa during vpr_manual_classification()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_category_create(taxa, basepath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_category_create_+3A_taxa">taxa</code></td>
<td>
<p>new taxa name to be added (can be a list of multiple taxa names)</p>
</td></tr>
<tr><td><code id="vpr_category_create_+3A_basepath">basepath</code></td>
<td>
<p>basepath used for vpr_manual_classification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>empty directory structure using new taxa name inside basepath
</p>

<hr>
<h2 id='vpr_ctd_files'>Create a list of ctd files to be read</h2><span id='topic+vpr_ctd_files'></span>

<h3>Description</h3>

<p>Searches through typical VP directory structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_ctd_files(castdir, cruise, day_hour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_ctd_files_+3A_castdir">castdir</code></td>
<td>
<p>root directory for ctd cast files</p>
</td></tr>
<tr><td><code id="vpr_ctd_files_+3A_cruise">cruise</code></td>
<td>
<p>cruise name (exactly as in directory structure)</p>
</td></tr>
<tr><td><code id="vpr_ctd_files_+3A_day_hour">day_hour</code></td>
<td>
<p>vector of day-hour combinations (e.g, dXXX.hXX)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use with caution
</p>


<h3>Value</h3>

<p>vector of ctd file paths matching days-hour combinations provided
</p>


<h3>Author(s)</h3>

<p>E. Chisholm and K. Sorochan
</p>

<hr>
<h2 id='vpr_ctd_read'>Read and format CTD VPR data</h2><span id='topic+vpr_ctd_read'></span>

<h3>Description</h3>

<p>Acts as a wrapper for <code><a href="#topic+ctd_df_cols">ctd_df_cols</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_ctd_read(ctd_files, station_of_interest, day, hour, col_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_ctd_read_+3A_ctd_files">ctd_files</code></td>
<td>
<p>full file paths to vpr ctd <code>.dat</code> files</p>
</td></tr>
<tr><td><code id="vpr_ctd_read_+3A_station_of_interest">station_of_interest</code></td>
<td>
<p>VPR station name</p>
</td></tr>
<tr><td><code id="vpr_ctd_read_+3A_day">day</code></td>
<td>
<p>Day of interest, if not provided will be pulled from file path</p>
</td></tr>
<tr><td><code id="vpr_ctd_read_+3A_hour">hour</code></td>
<td>
<p>Hour of interest, if not provided will be pulled from file path</p>
</td></tr>
<tr><td><code id="vpr_ctd_read_+3A_col_list">col_list</code></td>
<td>
<p>Optional list of CTD data column names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Reads CTD data and adds day, hour, and station information.
Calculates sigma T and depth variables from existing CTD data to supplement raw data.
If there are multiple hours of CTD data, combines them into single dataframe.
</p>
<p><strong>WARNING</strong> <code><a href="#topic+ctd_df_cols">ctd_df_cols</a></code> is hard coded to accept a specific
order of CTD data columns. The names and values in these columns can change
based on the specific instrument and should be updated/confirmed before processing data
from a new VPR.
</p>


<h3>Author(s)</h3>

<p>E. Chisholm &amp; K. Sorochan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
station_of_interest &lt;- 'test'

ctd_files &lt;- system.file("extdata/COR2019002/rois/vpr5/d222", "h03ctd.dat",
package = "vprr", mustWork = TRUE)

ctd_dat_combine &lt;- vpr_ctd_read(ctd_files, station_of_interest)

</code></pre>

<hr>
<h2 id='vpr_ctd_ymd'>Add Year/ month/ day hour:minute:second information</h2><span id='topic+vpr_ctd_ymd'></span>

<h3>Description</h3>

<p>Calculate and record calendar dates for vpr data from day-of-year, hour, and time (in milliseconds) info.
Will also add 'time_hr' parameter if not already present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_ctd_ymd(data, year, offset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_ctd_ymd_+3A_data">data</code></td>
<td>
<p>VPR data frame from <code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code></p>
</td></tr>
<tr><td><code id="vpr_ctd_ymd_+3A_year">year</code></td>
<td>
<p>Year of data collection</p>
</td></tr>
<tr><td><code id="vpr_ctd_ymd_+3A_offset">offset</code></td>
<td>
<p>time offset in hours between VPR CPU and processed data times (optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a VPR data frame with complete date/time information in a new row named 'ymdhms'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>year &lt;- 2019
data('ctd_roi_merge')
dat &lt;- vpr_ctd_ymd(ctd_roi_merge, year)


</code></pre>

<hr>
<h2 id='vpr_ctdroi_merge'>Merge CTD and ROI data from VPR</h2><span id='topic+vpr_ctdroi_merge'></span>

<h3>Description</h3>

<p>Combines CTD data (time, hydrographic parameters), with ROI information
(identification number) into single dataframe, aligning ROI identification
numbers and taxa classifications with time and hydrographic parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_ctdroi_merge(ctd_dat_combine, roi_dat_combine)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_ctdroi_merge_+3A_ctd_dat_combine">ctd_dat_combine</code></td>
<td>
<p>a CTD dataframe from VPR processing from <code><a href="#topic+vpr_ctd_read">vpr_ctd_read</a></code></p>
</td></tr>
<tr><td><code id="vpr_ctdroi_merge_+3A_roi_dat_combine">roi_dat_combine</code></td>
<td>
<p>a data frame of roi aid data from <code><a href="#topic+vpr_autoid_read">vpr_autoid_read</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>E. Chisholm &amp; K. Sorochan
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ctd_dat_combine')
data('roi_dat_combine')

ctd_roi_merge &lt;- vpr_ctdroi_merge(ctd_dat_combine, roi_dat_combine)
</code></pre>

<hr>
<h2 id='vpr_ctdroisize_merge'>Format CTD and Size data from VPR</h2><span id='topic+vpr_ctdroisize_merge'></span>

<h3>Description</h3>

<p>Format CTD and Meas data frames into combined data frame for analysis and plotting of size data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_ctdroisize_merge(data, data_mea, taxa_of_interest)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_ctdroisize_merge_+3A_data">data</code></td>
<td>
<p>VPR dataframe from <code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code>, with calculated variable sigmaT</p>
</td></tr>
<tr><td><code id="vpr_ctdroisize_merge_+3A_data_mea">data_mea</code></td>
<td>
<p>VPR size data frame from <code><a href="#topic+vpr_autoid_read">vpr_autoid_read</a></code></p>
</td></tr>
<tr><td><code id="vpr_ctdroisize_merge_+3A_taxa_of_interest">taxa_of_interest</code></td>
<td>
<p>a list of taxa of interest to be included in output dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing VPR CTD and size data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("ctd_roi_merge")
data("roimeas_dat_combine")
category_of_interest = 'Calanus'

ctd_roi_merge$time_hr &lt;- ctd_roi_merge$time_ms /3.6e+06

size_df_f &lt;- vpr_ctdroisize_merge(ctd_roi_merge, data_mea = roimeas_dat_combine,
 taxa_of_interest = category_of_interest)

</code></pre>

<hr>
<h2 id='vpr_day'>Get day identifier</h2><span id='topic+vpr_day'></span>

<h3>Description</h3>

<p>Get day identifier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_day(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_day_+3A_x">x</code></td>
<td>
<p>A string specifying the directory and file name of the size file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of only the day identifier (i.e., &quot;dXXX&quot;)
</p>


<h3>Author(s)</h3>

<p>K Sorochan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vpr_hour">vpr_hour</a></code>, <code><a href="#topic+vpr_roi">vpr_roi</a></code>, <code><a href="#topic+vpr_category">vpr_category</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>day_string &lt;- 'C:/data/cruise/autoid/Calanus/d000/h00'
vpr_day(day_string)

</code></pre>

<hr>
<h2 id='vpr_dayhour'>Find day &amp; hour info to match each station of interest for processing</h2><span id='topic+vpr_dayhour'></span>

<h3>Description</h3>

<p>@author E. Chisholm and K. Sorochan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_dayhour(stations, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_dayhour_+3A_stations">stations</code></td>
<td>
<p>a vector of character values naming stations of interest</p>
</td></tr>
<tr><td><code id="vpr_dayhour_+3A_file">file</code></td>
<td>
<p>CSV file containing 'day', 'hour', 'station', and 'day_hour' columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of day-hour combinations corresponding to stations of interest
</p>

<hr>
<h2 id='vpr_hour'>Get hour identifier</h2><span id='topic+vpr_hour'></span>

<h3>Description</h3>

<p>Get hour identifier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_hour(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_hour_+3A_x">x</code></td>
<td>
<p>A string specifying the directory and file name of the size file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of only the hour identifier (i.e., &quot;hXX&quot;)
</p>


<h3>Author(s)</h3>

<p>K Sorochan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vpr_day">vpr_day</a></code>, <code><a href="#topic+vpr_roi">vpr_roi</a></code>, <code><a href="#topic+vpr_category">vpr_category</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hour_string &lt;- 'C:/data/cruise/autoid/Calanus/d000/h00'
vpr_hour(hour_string)

</code></pre>

<hr>
<h2 id='vpr_img_category'>Explore images by depth and classification</h2><span id='topic+vpr_img_category'></span>

<h3>Description</h3>

<p>Pulls images from specific depth ranges in specific classification group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_img_category(
  data,
  min.depth,
  max.depth,
  roiFolder,
  format = "list",
  taxa_of_interest
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_img_category_+3A_data">data</code></td>
<td>
<p>data frame containing CTD and ROI data from
<code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code>, which also contains calculated variables
sigmaT and time_hr</p>
</td></tr>
<tr><td><code id="vpr_img_category_+3A_min.depth">min.depth</code></td>
<td>
<p>minimum depth of ROIs you are interested in looking at</p>
</td></tr>
<tr><td><code id="vpr_img_category_+3A_max.depth">max.depth</code></td>
<td>
<p>maximum depth of ROIs you are interested in exploring</p>
</td></tr>
<tr><td><code id="vpr_img_category_+3A_roifolder">roiFolder</code></td>
<td>
<p>directory that ROIs are within (can be very general eg.
C:/data, but will be quicker to process with more specific file path)</p>
</td></tr>
<tr><td><code id="vpr_img_category_+3A_format">format</code></td>
<td>
<p>option of how images will be output, either as 'list' a list
of file names or 'image' where images will be displayed</p>
</td></tr>
<tr><td><code id="vpr_img_category_+3A_taxa_of_interest">taxa_of_interest</code></td>
<td>
<p>character string of classification group from which
to pull images</p>
</td></tr>
</table>

<hr>
<h2 id='vpr_img_check'>Remove ROI strings from aid and aidmeas files based on a manually organized folder of images</h2><span id='topic+vpr_img_check'></span>

<h3>Description</h3>

<p>Should be used after <code><a href="#topic+vpr_img_copy">vpr_img_copy</a></code>, and manual image removal from created folders
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_img_check(folder_dir, basepath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_img_check_+3A_folder_dir">folder_dir</code></td>
<td>
<p>directory path to day hour folders containing manually
reorganized images of a specific taxa eg.
'C:/data/cruise_IML2018051/krill/images/' where that folder contains
'......d123.h01/' which contains manually sorted images of krill</p>
</td></tr>
<tr><td><code id="vpr_img_check_+3A_basepath">basepath</code></td>
<td>
<p>directory path to original Visual Plankton files, specified
down to the classification group. eg.
'C:/data/cruise_IML2018051/autoid/krill'</p>
</td></tr>
</table>

<hr>
<h2 id='vpr_img_copy'>Image copying function for specific taxa of interest</h2><span id='topic+vpr_img_copy'></span>

<h3>Description</h3>

<p>This function can be used to copy images from a particular taxa, day and hour into distinct folders within the auto id directory
This is useful for visualizing the ROIs of a particular classification group or for performing manual tertiary checks to remove
images not matching classification group descriptions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_img_copy(auto_id_folder, taxas.of.interest, day, hour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_img_copy_+3A_auto_id_folder">auto_id_folder</code></td>
<td>
<p>eg &quot;D:/VP_data/IML2018051/autoid&quot;</p>
</td></tr>
<tr><td><code id="vpr_img_copy_+3A_taxas.of.interest">taxas.of.interest</code></td>
<td>
<p>eg. taxas.of.interest &lt;- c('Calanus')</p>
</td></tr>
<tr><td><code id="vpr_img_copy_+3A_day">day</code></td>
<td>
<p>character, day of interest</p>
</td></tr>
<tr><td><code id="vpr_img_copy_+3A_hour">hour</code></td>
<td>
<p>character, hour of interest</p>
</td></tr>
</table>

<hr>
<h2 id='vpr_img_depth'>Explore VPR images by depth bin</h2><span id='topic+vpr_img_depth'></span>

<h3>Description</h3>

<p>Allows user to pull VPR images from specific depth ranges, to investigate
trends before classification of images into taxa groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_img_depth(data, min.depth, max.depth, roiFolder, format = "list")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_img_depth_+3A_data">data</code></td>
<td>
<p>data frame containing CTD and ROI data from
<code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code>, which also contains calculated variables
sigmaT and time_hr</p>
</td></tr>
<tr><td><code id="vpr_img_depth_+3A_min.depth">min.depth</code></td>
<td>
<p>minimum depth of ROIs you are interested in looking at</p>
</td></tr>
<tr><td><code id="vpr_img_depth_+3A_max.depth">max.depth</code></td>
<td>
<p>maximum depth of ROIs you are interested in exploring</p>
</td></tr>
<tr><td><code id="vpr_img_depth_+3A_roifolder">roiFolder</code></td>
<td>
<p>directory that ROIs are within (can be very general eg.
C:/data, but will be quicker to process with more specific file path)</p>
</td></tr>
<tr><td><code id="vpr_img_depth_+3A_format">format</code></td>
<td>
<p>option of how images will be output, either as 'list' a list
of file names or 'image' where images will be displayed</p>
</td></tr>
</table>

<hr>
<h2 id='vpr_img_reclassified'>Explore reclassified images</h2><span id='topic+vpr_img_reclassified'></span>

<h3>Description</h3>

<p>Pull image from reclassified or misclassified files produced during <code><a href="#topic+vpr_manual_classification">vpr_manual_classification</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_img_reclassified(day, hour, base_dir, taxa_of_interest, image_dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_img_reclassified_+3A_day">day</code></td>
<td>
<p>Character string, 3 digit day of interest of VPR data</p>
</td></tr>
<tr><td><code id="vpr_img_reclassified_+3A_hour">hour</code></td>
<td>
<p>Character string, 2 digit hour of interest of VPR data</p>
</td></tr>
<tr><td><code id="vpr_img_reclassified_+3A_base_dir">base_dir</code></td>
<td>
<p>directory path to folder containing day/hour folders in which misclassified and reclassified files are organized (eg.'C:/VPR_PROJECT/r_project_data_vis/classification files/') which would contain 'd123.h01/reclassified_krill.txt' )</p>
</td></tr>
<tr><td><code id="vpr_img_reclassified_+3A_taxa_of_interest">taxa_of_interest</code></td>
<td>
<p>Classification group from which to pull images</p>
</td></tr>
<tr><td><code id="vpr_img_reclassified_+3A_image_dir">image_dir</code></td>
<td>
<p>directory path to ROI images, eg. &quot;E:\\data\\cruise_IML2018051\\&quot;, file separator MUST BE &quot;\\&quot; in order to be recognized</p>
</td></tr>
</table>


<h3>Value</h3>

<p>folders of misclassified or reclassified images inside image_dir
</p>

<hr>
<h2 id='vpr_manual_classification'>Function to check results of classification manually</h2><span id='topic+vpr_manual_classification'></span>

<h3>Description</h3>

<p>Displays each image in day hour specified,
prompts user to confirm or deny classification.
If classification is denied, asks for a reclassification
value based on available taxa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_manual_classification(
  day,
  hour,
  basepath,
  taxa_of_interest,
  gr = TRUE,
  scale = "x300",
  opticalSetting = "S2",
  img_bright = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_manual_classification_+3A_day">day</code></td>
<td>
<p>day of interest in autoid</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_hour">hour</code></td>
<td>
<p>hour of interest in autoid</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_basepath">basepath</code></td>
<td>
<p>file path to auto id folder eg 'E:/autoID_EC_07032019/'</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_taxa_of_interest">taxa_of_interest</code></td>
<td>
<p>list of taxa folders you wish you sort through</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_gr">gr</code></td>
<td>
<p>logical indicating whether pop up graphic menus are used (user preference - defaults to TRUE)</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_scale">scale</code></td>
<td>
<p>argument passed to <code><a href="magick.html#topic+image_scale">image_scale</a></code>, default = 'x300'</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_opticalsetting">opticalSetting</code></td>
<td>
<p>specifies optical setting of VPR, defining image frame
size, current options are 'S0', 'S1', 'S2' (default), 'S3', see further
info in details</p>
</td></tr>
<tr><td><code id="vpr_manual_classification_+3A_img_bright">img_bright</code></td>
<td>
<p>logical value indicating whether or not to include a blown
out high brightness version of image (can be helpful for viewing dark field
fine appendages)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optical Setting frame sizes: S0 = 7x7 mm, S1 = 14x14mm, S2 =
24x24mm, S3 = 48x48 mm. These settings define the conversion factor from
pixels to millimetres and calculate image size for classification
reference
</p>


<h3>Development</h3>


<ul>
<li><p> Add &quot;undo&quot; functionality to go back on a typing mistake
</p>
</li>
<li><p>  Fix scaling/ size issue so images are consistently sized
</p>
</li>
<li><p> show ROI number for image somewhere for reference when in doubt of classification
</p>
</li></ul>


<hr>
<h2 id='vpr_oce_create'>Create ctd oce object with vpr data</h2><span id='topic+vpr_oce_create'></span>

<h3>Description</h3>

<p>Formats VPR data frame into <code>oce</code> format CTD object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_oce_create(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_oce_create_+3A_data">data</code></td>
<td>
<p>data frame of vpr data with variable names </p>
<p>'time_ms', 'fluorescence_mv', 'turbidity_mv', 'n_roi', 'sigmaT'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ctd_roi_merge')
oce_dat &lt;- vpr_oce_create(ctd_roi_merge)

</code></pre>

<hr>
<h2 id='vpr_plot_contour'>Interpolated contour plot of particular variable</h2><span id='topic+vpr_plot_contour'></span>

<h3>Description</h3>

<p>Creates interpolated contour plot, can be used as a background for ROI or tow yo information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_contour(
  data,
  var,
  dup = "mean",
  method = "interp",
  labels = TRUE,
  bw = 1,
  cmo
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_contour_+3A_data">data</code></td>
<td>
<p>data frame needs to include time_hr, depth, and variable of
choice (var)</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_var">var</code></td>
<td>
<p>variable in dataframe which will be interpolated and plotted</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_dup">dup</code></td>
<td>
<p>if method == 'interp'. Method of handling duplicates in interpolation, passed to interp function (options: 'mean', 'strip', 'error')</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_method">method</code></td>
<td>
<p>Specifies interpolation method, options are 'interp' or
'oce', oce uses slightly different method (oce is least error prone)</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_labels">labels</code></td>
<td>
<p>logical value indicating whether or not to plot contour labels</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_bw">bw</code></td>
<td>
<p>bin width defining interval at which contours are labelled</p>
</td></tr>
<tr><td><code id="vpr_plot_contour_+3A_cmo">cmo</code></td>
<td>
<p>name of a <code>cmocean</code> plotting theme, see <code>?cmocean</code> for more information</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>E. Chisholm &amp; Kevin Sorochan
</p>

<hr>
<h2 id='vpr_plot_histsize'>Plot size frequency histogram</h2><span id='topic+vpr_plot_histsize'></span>

<h3>Description</h3>

<p>Plot size frequency histogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_histsize(data, param, title = NULL, bw = 0.1, xlim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_histsize_+3A_data">data</code></td>
<td>
<p>size data from auto_measure_mm subset into taxas</p>
</td></tr>
<tr><td><code id="vpr_plot_histsize_+3A_param">param</code></td>
<td>
<p>size parameter of interest (corresponds to sub lists within data argument)</p>
</td></tr>
<tr><td><code id="vpr_plot_histsize_+3A_title">title</code></td>
<td>
<p>main title for plot, if left null will default based on parameter and taxa</p>
</td></tr>
<tr><td><code id="vpr_plot_histsize_+3A_bw">bw</code></td>
<td>
<p>bin width, defines width of bars on histogram, defaults to 0.1, decrease for more detail</p>
</td></tr>
<tr><td><code id="vpr_plot_histsize_+3A_xlim">xlim</code></td>
<td>
<p>plot xlimit, defaults to min max of data if not provided</p>
</td></tr>
</table>


<h3>Note</h3>

<p>param options are typically 'Perimeter', 'Area', 'width1','width2',
'width3', 'short_axis_length', 'long_axis_length'
</p>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='vpr_plot_profile'>Plots VPR profiles of temperature, salinity, density, fluorescence and concentration (by classification group)</h2><span id='topic+vpr_plot_profile'></span>

<h3>Description</h3>

<p>This plot allows a good overview of vertical distribution of individual classification groups along with reference to hydrographic parameters.
Facet wrap is used to create distinct panels for each taxa provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_profile(taxa_conc_n, taxa_to_plot, plot_conc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_profile_+3A_taxa_conc_n">taxa_conc_n</code></td>
<td>
<p>A VPR data frame with hydrographic and concentration data separated by taxa (from <code><a href="#topic+vpr_roi_concentration">vpr_roi_concentration</a></code>)</p>
</td></tr>
<tr><td><code id="vpr_plot_profile_+3A_taxa_to_plot">taxa_to_plot</code></td>
<td>
<p>The specific classification groups which will be plotted, if NULL, will plot all taxa combined</p>
</td></tr>
<tr><td><code id="vpr_plot_profile_+3A_plot_conc">plot_conc</code></td>
<td>
<p>Logical value whether or not to include a concentration plot (FALSE just shows CTD data)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A gridded object of at least 3 ggplot objects
</p>

<hr>
<h2 id='vpr_plot_sizefreq'>Size Frequency plots for VPR data</h2><span id='topic+vpr_plot_sizefreq'></span>

<h3>Description</h3>

<p>This uses the <code><a href="graphics.html#topic+hist">hist</a></code> plot function in base R to give a histogram of size (long axis length) frequency within a taxa.
<strong>!!WARNING:</strong> this function uses hard coded plot attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_sizefreq(x, number_of_classes, colour_of_bar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_sizefreq_+3A_x">x</code></td>
<td>
<p>a data frame with columns 'taxa', 'long_axis_length'</p>
</td></tr>
<tr><td><code id="vpr_plot_sizefreq_+3A_number_of_classes">number_of_classes</code></td>
<td>
<p>numeric value passed to nclass argument in hist()</p>
</td></tr>
<tr><td><code id="vpr_plot_sizefreq_+3A_colour_of_bar">colour_of_bar</code></td>
<td>
<p>character value defining colour of plotted bars</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>K. Sorochan
</p>

<hr>
<h2 id='vpr_plot_TS'>Make a balloon plot against a TS plot</h2><span id='topic+vpr_plot_TS'></span>

<h3>Description</h3>

<p>TS balloon plot with ROI concentration, sorted by taxa
includes isopycnal line calculations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_TS(x, reference.p = 0, var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_TS_+3A_x">x</code></td>
<td>
<p>dataframe with temperature, salinity, number of rois (n_roi_bin)</p>
</td></tr>
<tr><td><code id="vpr_plot_TS_+3A_reference.p">reference.p</code></td>
<td>
<p>reference pressure (default at 0 for surface)- used to calculate isopycnals</p>
</td></tr>
<tr><td><code id="vpr_plot_TS_+3A_var">var</code></td>
<td>
<p>variable on which size of points will be based, eg conc_m3 or n_roi_bin</p>
</td></tr>
</table>


<h3>Note</h3>

<p>modified from source: <a href="https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R">https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R</a>
</p>


<h3>Author(s)</h3>

<p>E. Chisholm
</p>

<hr>
<h2 id='vpr_plot_TScat'>Make a balloon plot</h2><span id='topic+vpr_plot_TScat'></span>

<h3>Description</h3>

<p>Balloon plot against a TS plot with ROI concentration and sorted by taxa
includes isopycnal line calculations. Version of <code><a href="#topic+vpr_plot_TS">vpr_plot_TS</a></code>, with only relevant* taxa specified.
*to current analysis and research objectives (See note).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_plot_TScat(x, reference.p = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_plot_TScat_+3A_x">x</code></td>
<td>
<p>dataframe with temperature, salinity, number of rois named by taxa</p>
</td></tr>
<tr><td><code id="vpr_plot_TScat_+3A_reference.p">reference.p</code></td>
<td>
<p>reference pressure (default at 0 for surface)- used to calculate isopycnals</p>
</td></tr>
</table>


<h3>Note</h3>

<p><strong>WARNING HARD CODED</strong> FOR  5 TAXA, CALANUS, KRILL, ECHINODERM LARVAE, SMALL COPEPOD, CHAETOGNATHS
!! Uses isopycnal labelling method which does not label every contour
</p>
<p>modified from source: <a href="https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R">https://github.com/Davidatlarge/ggTS/blob/master/ggTS_DK.R</a>
</p>

<hr>
<h2 id='vpr_pred_read'>Read prediction output from a CNN model</h2><span id='topic+vpr_pred_read'></span>

<h3>Description</h3>

<p>Read prediction output from a CNN model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_pred_read(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_pred_read_+3A_filename">filename</code></td>
<td>
<p>model prediction output file (.txt) from <code>vpr_transferlearn::save_output()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe
</p>

<hr>
<h2 id='vpr_roi'>Get roi ids from string</h2><span id='topic+vpr_roi'></span>

<h3>Description</h3>

<p>Get roi ids from string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_roi(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_roi_+3A_x">x</code></td>
<td>
<p>A string specifying directory and file name of roi</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string of only the 10 digit roi identifier
</p>


<h3>Author(s)</h3>

<p>K Sorochan
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vpr_hour">vpr_hour</a></code>, <code><a href="#topic+vpr_day">vpr_day</a></code>, <code><a href="#topic+vpr_category">vpr_category</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
roi_string &lt;- 'roi.0100000000.tif'
vpr_roi(roi_string)

</code></pre>

<hr>
<h2 id='vpr_roi_concentration'>Calculate VPR concentrations</h2><span id='topic+vpr_roi_concentration'></span>

<h3>Description</h3>

<p>Calculates concentrations for each named taxa in dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_roi_concentration(
  data,
  taxas_list,
  station_of_interest,
  binSize,
  imageVolume
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_roi_concentration_+3A_data">data</code></td>
<td>
<p>a VPR dataframe as produced by <code><a href="#topic+vpr_ctdroi_merge">vpr_ctdroi_merge</a></code></p>
</td></tr>
<tr><td><code id="vpr_roi_concentration_+3A_taxas_list">taxas_list</code></td>
<td>
<p>a list of character strings representing taxa present in the station being processed</p>
</td></tr>
<tr><td><code id="vpr_roi_concentration_+3A_station_of_interest">station_of_interest</code></td>
<td>
<p>The station being processed</p>
</td></tr>
<tr><td><code id="vpr_roi_concentration_+3A_binsize">binSize</code></td>
<td>
<p>passed to <code><a href="#topic+bin_calculate">bin_calculate</a></code>, determines size of depth bins over which data is averaged</p>
</td></tr>
<tr><td><code id="vpr_roi_concentration_+3A_imagevolume">imageVolume</code></td>
<td>
<p>the volume of VPR images used for calculating concentrations (mm^3)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data('ctd_roi_merge')
ctd_roi_merge$time_hr &lt;- ctd_roi_merge$time_ms /3.6e+06

taxas_list &lt;- c('Calanus', 'krill')
binSize &lt;- 5
station_of_interest &lt;- 'test'
imageVolume &lt;- 83663

taxa_conc_n &lt;- vpr_roi_concentration(ctd_roi_merge, taxas_list,
station_of_interest, binSize, imageVolume)

</code></pre>

<hr>
<h2 id='vpr_save'>Save VPR data as an <a href="oce.html#topic+as.oce">as.oce</a> object</h2><span id='topic+vpr_save'></span>

<h3>Description</h3>

<p>Save VPR data as an <a href="oce.html#topic+as.oce">as.oce</a> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_save(data, metadata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_save_+3A_data">data</code></td>
<td>
<p>a VPR data frame</p>
</td></tr>
<tr><td><code id="vpr_save_+3A_metadata">metadata</code></td>
<td>
<p>(optional) a named list of character values giving metadata
values. If this argument is not provided user will be prompted for a few
generic metadata requirements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will pass a VPR data frame object to an <code>oce</code> object.
Using an <code>oce</code> object as the default export format for VPR data allows for
metadata and data to be kept in the same, space efficient file, and avoid
redundancy in the data frame. The function check for data parameters that
may actually be metadata parameters (rows which have the same value
repeated for every observation). These parameters will automatically be
copied into the metadata slot of the <code>oce</code> object. The function will also
prompt for a variety of required metadata fields. Depending on specific
research / archiving requirements, these metadata parameters could be
updated by providing the argument <code>metadata</code>.
</p>
<p>Default metadata parameters include 'deploymentType', 'waterDepth',
'serialNumber', 'latitude', 'longitude', 'castDate', 'castStartTime',
'castEndTime', 'processedBy', 'opticalSetting', 'imageVolume', 'comment'.
</p>


<h3>Value</h3>

<p>an oce CTD object with all VPR data as well as metadata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("taxa_conc_n")
metadata &lt;- c('deploymentType' = 'towyo', 'waterDepth' =
max(ctd_roi_merge$pressure), 'serialNumber' = NA, 'latitude' = 47,
'longitude' = -65, 'castDate' = '2019-08-11', 'castStartTime'= '00:00',
'castEndTime' = '01:00', 'processedBy' = 'E. Chisholm', 'opticalSetting' =
'S2', 'imageVolume' = 83663, 'comment' = 'test data')

oce_dat &lt;- vpr_save(taxa_conc_n, metadata)
# save(oce_dat, file = vpr_save.RData') # save data

</code></pre>

<hr>
<h2 id='vpr_size_bin'>Bin VPR size data</h2><span id='topic+vpr_size_bin'></span>

<h3>Description</h3>

<p>Calculates statistics for VPR measurement data in depth averaged bins for analysis and visualization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_size_bin(data_all, bin_mea)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_size_bin_+3A_data_all">data_all</code></td>
<td>
<p>a VPR CTD and measurement dataframe from <code><a href="#topic+vpr_ctdroisize_merge">vpr_ctdroisize_merge</a></code></p>
</td></tr>
<tr><td><code id="vpr_size_bin_+3A_bin_mea">bin_mea</code></td>
<td>
<p>Numerical value representing size of depth bins over which data will be combined, unit is metres, typical values range from 1 - 5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe of binned VPR size data statistics including number of observations, median, interquartile ranges, salinity and pressure, useful for making boxplots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data('size_df_f')
vpr_size_bin(size_df_f, bin_mea = 5)

</code></pre>

<hr>
<h2 id='vpr_summary'>Data Summary Report</h2><span id='topic+vpr_summary'></span>

<h3>Description</h3>

<p>Part of VP easy plot processing, prints data summary report to give quantitative, exploratory analysis of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_summary(all_dat, fn, tow = tow, day = day, hour = hour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_summary_+3A_all_dat">all_dat</code></td>
<td>
<p>data frame containing VPR and CTD data including time_ms,
time_hr, conductivity, temperature, pressure, salinity, fluorescence_mv,
turbidity_mv, sigmaT</p>
</td></tr>
<tr><td><code id="vpr_summary_+3A_fn">fn</code></td>
<td>
<p>file name to save data summary, if not provided, summary will print to console</p>
</td></tr>
<tr><td><code id="vpr_summary_+3A_tow">tow</code></td>
<td>
<p>VPR tow number</p>
</td></tr>
<tr><td><code id="vpr_summary_+3A_day">day</code></td>
<td>
<p>julian day</p>
</td></tr>
<tr><td><code id="vpr_summary_+3A_hour">hour</code></td>
<td>
<p>two digit hour (24 hr clock)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>E Chisholm
</p>

<hr>
<h2 id='vpr_trrois_size'>Get size data from idsize files</h2><span id='topic+vpr_trrois_size'></span>

<h3>Description</h3>

<p>useful for getting size distribution of known rois from each taxa. gathers
size information from idsize text files produced when training a new
classifier in VP (Visual Plankton)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpr_trrois_size(directory, taxa, opticalSetting)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpr_trrois_size_+3A_directory">directory</code></td>
<td>
<p>cruise directory eg. 'C:/data/IML2018051/'</p>
</td></tr>
<tr><td><code id="vpr_trrois_size_+3A_taxa">taxa</code></td>
<td>
<p>list of character elements containing taxa of interest</p>
</td></tr>
<tr><td><code id="vpr_trrois_size_+3A_opticalsetting">opticalSetting</code></td>
<td>
<p>VPR optical setting determining conversion between pixels and millimetres (options are 'S0', 'S1', 'S2', or 'S3')</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
