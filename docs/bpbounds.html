<!DOCTYPE html><html><head><title>Help for package bpbounds</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bpbounds}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bpbounds-package'><p>bpbounds: Nonparametric bounds for the Average Causal Effect due to Balke and Pearl and extensions</p></a></li>
<li><a href='#bpbounds'><p>Nonparametric Bounds for the Average Causal Effect due to Balke and Pearl.</p></a></li>
<li><a href='#runExample'><p>Run Shiny App demonstrating the package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Nonparametric Bounds for the Average Causal Effect Due to Balke
and Pearl and Extensions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the nonparametric bounds for the average
    causal effect under an instrumental variable model by Balke and Pearl
    (Bounds on Treatment Effects from Studies with Imperfect Compliance,
    JASA, 1997, 92, 439, 1171-1176). The package can calculate bounds for
    a binary outcome, a binary treatment/phenotype, and an instrument with
    either 2 or 3 categories. The package implements bounds for situations
    where these 3 variables are measured in the same dataset (trivariate
    data) or where the outcome and instrument are measured in one study
    and the treatment/phenotype and instrument are measured in another
    study (bivariate data).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/remlapmot/bpbounds">https://github.com/remlapmot/bpbounds</a>,
<a href="https://remlapmot.github.io/bpbounds/">https://remlapmot.github.io/bpbounds/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/remlapmot/bpbounds/issues">https://github.com/remlapmot/bpbounds/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, knitr, rmarkdown, shiny, testthat, tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-03 18:35:04 UTC; tom</td>
</tr>
<tr>
<td>Author:</td>
<td>Tom Palmer <a href="https://orcid.org/0000-0003-4655-4511"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Roland Ramsahai <a href="https://orcid.org/0000-0002-7349-1977"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Vanessa Didelez <a href="https://orcid.org/0000-0001-8587-7706"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Nuala Sheehan <a href="https://orcid.org/0000-0001-9094-2605"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tom Palmer &lt;remlapmot@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-03 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bpbounds-package'>bpbounds: Nonparametric bounds for the Average Causal Effect due to Balke and Pearl and extensions</h2><span id='topic+bpbounds-package'></span>

<h3>Description</h3>

<p>This package implements the nonparametric bounds for the average causal effect defined by
Balke and Pearl, Bounds on Treatment Effects from Studies with Imperfect Compliance,
JASA, 1997; and some extensions.
</p>


<h3>Details</h3>

<p>The functions implement bounds for the situation where each of the outcome,
treatment/phenotype, and instrumental variable are binary; and additionally for when the
instrument has 3 categories (e.g. a single genotype under an additive model in a
Mendelian randomization study).
</p>
<p>The package implements bounds for when the three variables are measured in the same study
(trivariate data) and when the outcome and instrument are measured in one study and the
treatment/phenotype and instrument in another sample (bivariate/two sample data).
</p>

<hr>
<h2 id='bpbounds'>Nonparametric Bounds for the Average Causal Effect due to Balke and Pearl.</h2><span id='topic+bpbounds'></span>

<h3>Description</h3>

<p>Nonparametric Bounds for the Average Causal Effect due to Balke and Pearl.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpbounds(p, t = NULL, fmt = "trivariate")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpbounds_+3A_p">p</code></td>
<td>
<p>Object of class &quot;table&quot; containing either cell counts or conditional
probabilities. For trivariate data these are for the
phenotype/treatment-outcome association given Z, i.e. P(X, Y | Z).
</p>
<p>Cell counts could be generated from <code>xtabs(~ x + y + z, data = data)</code>.
And then conditional probabilities obatained by calling
<code>prop.table(..., margins = 3)</code> on your object from <code>xtabs()</code>.
</p>
<p>If you only know the conditional probabilities you can enter these, e.g.
for the Balke and Pearl Vitamin A example:
</p>
<div class="sourceCode"><pre>cp   = c(.0064, 0, .9936, 0, .0028, .001, .1972, .799)
tabp = as.table(array(
  cp,
  dim = c(2, 2, 2),
  dimnames = list(
    x = c(0, 1),
    y = c(0, 1),
    z = c(0, 1)
  )
))
</pre></div>
<p>And then call <code>bpbounds()</code> using this object.
</p>
<p>For bivariate data this object contains cell conditional probabilities for
the outcome-instrument (Y|Z) association.</p>
</td></tr>
<tr><td><code id="bpbounds_+3A_t">t</code></td>
<td>
<p>Specified for bivariate data. Object with
treatment/phenotype-instrument cell counts or conditional probabilities,
i.e. (X|Z).</p>
</td></tr>
<tr><td><code id="bpbounds_+3A_fmt">fmt</code></td>
<td>
<p>A character string which sould be either &quot;bivariate&quot;
(i.e. X, Z in one dataset and Y, Z in another dataset) or
&quot;trivariate&quot; (X, Y, Z in the same dataset).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the following elements:
</p>

<dl>
<dt>fmt</dt><dd><p>whether the data is bivariate or trivariate</p>
</dd>
<dt>nzcats</dt><dd><p>2 or 3, the no. instrument categories</p>
</dd>
<dt>inequality</dt><dd><p>Logical, indicating whether the IV inquality is satisfied</p>
</dd>
<dt>bplb</dt><dd><p>Lower bound of ACE</p>
</dd>
<dt>bpub</dt><dd><p>Upper bound of ACE</p>
</dd>
<dt>bplower</dt><dd><p>Vector of lower bound probabilities</p>
</dd>
<dt>bpupper</dt><dd><p>Vector of upper bound probabilities</p>
</dd>
<dt>p11low</dt><dd><p>Lower bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p11upp</dt><dd><p>Upper bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p10low</dt><dd><p>Lower bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p10upp</dt><dd><p>Upper bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p11lower</dt><dd><p>Vector of probabilities for lower bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p11upper</dt><dd><p>Vector of probabilities for upper bound of P(Y=1|do(X=1))</p>
</dd>
<dt>p10lower</dt><dd><p>Vector of probabilities for lower bound of P(Y=1|do(X=0))</p>
</dd>
<dt>p10upper</dt><dd><p>Vector of probabilities for upper bound of P(Y=1|do(X=0))</p>
</dd>
<dt>crrlb</dt><dd><p>Lower bound of CRR</p>
</dd>
<dt>crrub</dt><dd><p>Upper bound of CRR</p>
</dd>
<dt>monoinequality</dt><dd><p>Logical, indicating whether the monoticity inequality
is satisfied</p>
</dd>
<dt>monobplb</dt><dd><p>Lower bound of ACE assuming monotonicity</p>
</dd>
<dt>monobpub</dt><dd><p>Upper bound of ACE assuming monotonicity</p>
</dd>
<dt>monobplower</dt><dd><p>Vector of probabilities for lower bound of ACE assuming
monotonicity</p>
</dd>
<dt>monobpupper</dt><dd><p>Vector of probabilities for upper bound of ACE assuming
monotonicity</p>
</dd>
<dt>monop11low</dt><dd><p>Lower bound of P(Y=1|do(X=1)) assuming monotonicity</p>
</dd>
<dt>monop11upp</dt><dd><p>Upper bound of P(Y=1|do(X=1)) assuming monotonicity</p>
</dd>
<dt>monop10low</dt><dd><p>Lower bound of P(Y=1|do(X=0)) assuming monotonicity</p>
</dd>
<dt>monop10upp</dt><dd><p>Upper bound of P(Y=1|do(X=0)) assuming monotonicity</p>
</dd>
<dt>monop11lower</dt><dd><p>Vector for corresponding bound above</p>
</dd>
<dt>monop11upper</dt><dd><p>Vector for corresponding bound above</p>
</dd>
<dt>monop10lower</dt><dd><p>Vector for corresponding bound above</p>
</dd>
<dt>monop10upper</dt><dd><p>Vector for corresponding bound above</p>
</dd>
<dt>monocrrlb</dt><dd><p>Lower bound of CRR assuming monotonicity</p>
</dd>
<dt>monocrrub</dt><dd><p>Upper bound of CRR assuming monotonicity</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Vitamin A example, using cell counts

require(tidyr)
require(bpbounds)

tab1dat &lt;- data.frame(
  z = c(0, 0, 1, 1, 1, 1, 0, 0),
  x = c(0, 0, 0, 0, 1, 1, 1, 1),
  y = c(0, 1, 0, 1, 0, 1, 0, 1),
  freq = c(74, 11514, 34, 2385, 12, 9663, 0, 0)
)

tab1inddat = uncount(tab1dat, freq)
xt = xtabs(~ x + y + z, data = tab1inddat)
p = prop.table(xt, margin = 3)
bpres = bpbounds(p)
sbpres = summary(bpres)
print(sbpres)



# Vitamin A example, using conditional probabilities

require(bpbounds)
cp = c(.0064, 0, .9936, 0, .0028, .001, .1972, .799)
tabp = as.table(array(
  cp,
  dim = c(2, 2, 2),
  dimnames = list(
    x = c(0, 1),
    y = c(0, 1),
    z = c(0, 1)
  )
))
bpbounds(tabp)


</code></pre>

<hr>
<h2 id='runExample'>Run Shiny App demonstrating the package</h2><span id='topic+runExample'></span>

<h3>Description</h3>

<p>Run Shiny App demonstrating the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runExample(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runExample_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="shiny.html#topic+runApp">shiny::runApp()</a></code>, e.g. <code>port</code>, <code>launch.browser</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive() &amp;&amp; requireNamespace("shiny", quietly = TRUE)) {
  bpbounds::runExample()
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
