<!DOCTYPE html><html><head><title>Help for package rptR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rptR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rptR'><p>rptR: Repeatability Estimation for Gaussian and Non-Gaussian data</p></a></li>
<li><a href='#BeetlesBody'><p>BeetlesBody dataset</p></a></li>
<li><a href='#BeetlesFemale'><p>BeetlesFemale dataset</p></a></li>
<li><a href='#BeetlesMale'><p>BeetlesMale dataset</p></a></li>
<li><a href='#bootstrap_nongaussian'><p>Bootstrapping for non-gaussian functions (internal use)</p></a></li>
<li><a href='#group_vars'><p>Calculates / extracts variance components from random effects and random slopes</p></a></li>
<li><a href='#LRT_nongaussian'><p>Likelihood ratio test for non-gaussian functions (internal use)</p></a></li>
<li><a href='#permut_nongaussian'><p>Permutation function for non-gaussian functions (internal use)</p></a></li>
<li><a href='#plot.rpt'><p>Plot a rpt object</p></a></li>
<li><a href='#print.rpt'><p>Print a rpt object</p></a></li>
<li><a href='#print.summary.rpt'><p>Prints the summary of a rpt object</p></a></li>
<li><a href='#rpt'><p>Repeatability Estimation for Gaussian and Non-Gaussian Data</p></a></li>
<li><a href='#rptBinary'><p>GLMM-based Repeatability Estimation for Binary Data</p></a></li>
<li><a href='#rptGaussian'><p>LMM-based Repeatability Estimation for Gaussian Data</p></a></li>
<li><a href='#rptPoisson'><p>GLMM-based Repeatability Estimation for Poisson-distributed Data</p></a></li>
<li><a href='#rptProportion'><p>GLMM-based Repeatability Estimation for Proportion Data</p></a></li>
<li><a href='#summary.rpt'><p>Summary of a rpt object</p></a></li>
<li><a href='#with_warnings'><p>Captures and suppresses (still to find out why) warnings of an expression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Repeatability Estimation for Gaussian and Non-Gaussian Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.22</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.1)</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-06-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Stoffel &lt;martin.adam.stoffel@gmail.com&gt;,
         Shinichi Nakagawa &lt;s.nakagawa@unsw.edu.au&gt;,
         Holger Schielzeth &lt;holger.schielzeth@uni-jena.de&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Stoffel &lt;martin.adam.stoffel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimating repeatability (intra-class
    correlation) from Gaussian, binary, proportion and Poisson data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, lme4, parallel (&ge; 3.1.2), pbapply</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-06 15:13:44 UTC; martin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-06 22:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='rptR'>rptR: Repeatability Estimation for Gaussian and Non-Gaussian data</h2><span id='topic+rptR'></span><span id='topic+rptR-package'></span>

<h3>Description</h3>

<p>A collection of functions for calculating point estimates, interval estimates and 
significance tests of the repeatability (intra-class correlation coefficient) as well as 
variance components in mixed effects models. The function <a href="#topic+rpt">rpt</a> is a wrapper function 
that calls more specialised functions as required. Specialised functions can also be called 
directly (see <a href="#topic+rpt">rpt</a> for details). All
functions return lists of values in the form of an S3 object <code>rpt</code>. The function <a href="#topic+summary.rpt">summary.rpt</a> produces summaries in a
detailed format and <a href="#topic+plot.rpt">plot.rpt</a> plots bootstraps or permutation results.
</p>


<h3>Note</h3>

<p>Currently there four different functions depending on the distribution and type of response: (1)
<a href="#topic+rptGaussian">rptGaussian</a> for a Gaussian response distributions, (2) <a href="#topic+rptPoisson">rptPoisson</a> for Poisson-distributed data, 
(3) <a href="#topic+rptBinary">rptBinary</a> for binary response following binomial distributions and (4) <a href="#topic+rptProportion">rptProportion</a> for
response matrices with a column for successes and a column for failures that are analysed as proportions
following binomial distributions. All function use a mixed model framework in <code>lme4</code>, 
and the non-Gaussian functions use an observational level random effect to account
for overdispersion.
</p>
<p>All functions use the argument <code>formula</code>, which is the same formula interface as in the
<code>lme4</code> package (indeed models are fitted by <code>lmer</code> or <code>glmer</code>). Repeatabilites are 
calculated for the response variable, while one or
more grouping factors of interest can be assigned as random effects in the form (1|group) and
have to be specified with the <code>grname</code> argument. This allows to estimate adjusted
repeatabilities (controlling for fixed effects) and the estimation of multiple variance 
components simultaneously (multiple random effects). All variables have to be columns 
in a <code>data.frame</code> given in the <code>data</code> argument. The <code>link</code> argument specifies
the link function for a given non-Gaussian distribtion. 
</p>
<p>The argument <code>ratio</code> allows switching to raw variances rather than ratios of variances 
to be estimated and The argument <code>adjusted</code> allows switching to an estimation where the 
variance explained by fixed effects is included in the denominator of the repeatability 
calculation. The reserved <code>grname</code> terms &quot;Residual&quot;, &quot;Overdispersion&quot; and &quot;Fixed&quot; allow 
the estimation of oversipersion variance, residual variance and variance explained by 
fixed effects, respectively. All computation can be parallelized with the <code>parallel</code> 
argument, which enhances computation speed for larger computations.
</p>
<p>When using <code>rptR</code> please cite:   
</p>
<p>Stoffel, M., Nakagawa, S. &amp; Schielzeth, H. (2017) <em>rptR: Repeatability estimation and variance decomposition by generalized linear
mixed-effects models.</em>. Methods Ecol Evol. Accepted Author Manuscript. doi:10.1111/2041-210X.12797
</p>


<h3>Author(s)</h3>

<p>Martin Stoffel (martin.adam.stoffel@gmail.com), Shinichi Nakagawa
(s.nakagawa@unsw.edu.au) &amp; Holger Schielzeth (holger.schielzeth@uni-jena.de)
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>

<hr>
<h2 id='BeetlesBody'>BeetlesBody dataset</h2><span id='topic+BeetlesBody'></span>

<h3>Description</h3>

<p>BeetlesBody dataset
</p>


<h3>Details</h3>

<p>This is an simulated dataset which was used as a toy example for a different purpose 
(Nakagawa &amp; Schielzeth 2013). 
It offers a balanced dataset with rather simple structure, sizable effects and decent sample size, 
just right for demonstrating some features of <code>rptR</code>. 
Sufficient sample size is required in particular for the non-Gaussian traits, 
because those tend to be more computationally demanding and less rich in information per data 
point than simple Gaussian traits.
</p>
<p>In brief the imaginary sampling design of the simulated dataset is as follows. 
Beetle larvae were sampled from 12 populations ('Population') with samples taken from two 
discrete microhabitats at each location ('Habitat'). Samples were split in equal proportion 
and raised in two dietary treatments ('Treatment'). Beetles were sexed at the pupal stage ('Sex') 
and pupae were kept in sex-homogeneous containers ('Container'). The phenotype 
in this dataset is body length ('BodyL').
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2013) <em>A general and simple method for obtaining R2
from generalized linear mixed-effects models</em>. Methods in Ecology and Evolution 4: 133-142.
</p>

<hr>
<h2 id='BeetlesFemale'>BeetlesFemale dataset</h2><span id='topic+BeetlesFemale'></span>

<h3>Description</h3>

<p>BeetlesFemale dataset
</p>


<h3>Details</h3>

<p>This is an simulated dataset which was used as a toy example for a different purpose 
(Nakagawa &amp; Schielzeth 2013). 
It offers a balanced dataset with rather simple structure, sizable effects and decent sample size, 
just right for demonstrating some features of <code>rptR</code>. 
Sufficient sample size is required in particular for the non-Gaussian traits, 
because those tend to be more computationally demanding and less rich in information per data 
point than simple Gaussian traits.
</p>
<p>In brief the imaginary sampling design of the simulated dataset is as follows. 
Beetle larvae were sampled from 12 populations ('Population') with samples taken from two 
discrete microhabitats at each location ('Habitat'). Samples were split in equal proportion 
and raised in two dietary treatments ('Treatment'). Beetles were sexed at the pupal stage ('Sex') 
and pupae were kept in sex-homogeneous containers ('Container'). 
The phenotype in this dataset is the number of eggs laid by female beetles ('Egg').
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2013) <em>A general and simple method for obtaining R2
from generalized linear mixed-effects models</em>. Methods in Ecology and Evolution 4: 133-142.
</p>

<hr>
<h2 id='BeetlesMale'>BeetlesMale dataset</h2><span id='topic+BeetlesMale'></span>

<h3>Description</h3>

<p>BeetlesMale dataset
</p>


<h3>Details</h3>

<p>This is an simulated dataset which was used as a toy example for a different purpose 
(Nakagawa &amp; Schielzeth 2013). 
It offers a balanced dataset with rather simple structure, sizable effects and decent sample size, 
just right for demonstrating some features of <code>rptR</code>. 
Sufficient sample size is required in particular for the non-Gaussian traits, 
because those tend to be more computationally demanding and less rich in information per data 
point than simple Gaussian traits.
</p>
<p>In brief the imaginary sampling design of the simulated dataset is as follows. 
Beetle larvae were sampled from 12 populations ('Population') with samples taken from two 
discrete microhabitats at each location ('Habitat'). Samples were split in equal proportion 
and raised in two dietary treatments ('Treatment'). Beetles were sexed at the pupal stage ('Sex') 
and pupae were kept in sex-homogeneous containers ('Container'). 
The phenotype in this dataset is a binary variable containing the two distinct color 
morphs of males: dark and reddish-brown ('Colour').
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2013) <em>A general and simple method for obtaining R2
from generalized linear mixed-effects models</em>. Methods in Ecology and Evolution 4: 133-142.
</p>

<hr>
<h2 id='bootstrap_nongaussian'>Bootstrapping for non-gaussian functions (internal use)</h2><span id='topic+bootstrap_nongaussian'></span>

<h3>Description</h3>

<p>Bootstrapping for non-gaussian functions (internal use)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_nongaussian(bootstr, R_pe, formula, data, Ysim, mod, grname,
  grname_org, nboot, parallel, ncores, CI, rptObj, update)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_nongaussian_+3A_bootstr">bootstr</code></td>
<td>
<p>bootstrap function. Re-assigns response simulated by simulate.merMod to data and estimates R with the R_pe function.</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_r_pe">R_pe</code></td>
<td>
<p>Function to estimate Repeatabilities and Variances for grouping factors, Residuals, Overdispersion and Fixed effects.</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_formula">formula</code></td>
<td>
<p>lme4 model formula</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_data">data</code></td>
<td>
<p>data.frame given as original input</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_ysim">Ysim</code></td>
<td>
<p>data.frame with simulated response variables from simulate.merMod</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_mod">mod</code></td>
<td>
<p>fitted lme4 model</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_grname">grname</code></td>
<td>
<p>original grnames vector without Residual or Fixed</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_grname_org">grname_org</code></td>
<td>
<p>original grnames vector</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstraps, equal to columns in Ysim</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_parallel">parallel</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_ncores">ncores</code></td>
<td>
<p>number of cores specified, defaults to NULL</p>
</td></tr>
<tr><td><code id="bootstrap_nongaussian_+3A_ci">CI</code></td>
<td>
<p>confidence interval, defaults to 0.95</p>
</td></tr>
</table>

<hr>
<h2 id='group_vars'>Calculates / extracts variance components from random effects and random slopes</h2><span id='topic+group_vars'></span>

<h3>Description</h3>

<p>This function uses the method from Paul Johnson to compute the average group
variance across the levels of a covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_vars(grname, VarComps, mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_vars_+3A_grname">grname</code></td>
<td>
<p>The name of a grouping factor, usually accessed by looping over the
grname argument of the rptR functions.</p>
</td></tr>
<tr><td><code id="group_vars_+3A_varcomps">VarComps</code></td>
<td>
<p>A list. Output of the lme4::VarCorr function.</p>
</td></tr>
<tr><td><code id="group_vars_+3A_mod">mod</code></td>
<td>
<p>An lme4 model object.</p>
</td></tr>
</table>

<hr>
<h2 id='LRT_nongaussian'>Likelihood ratio test for non-gaussian functions (internal use)</h2><span id='topic+LRT_nongaussian'></span>

<h3>Description</h3>

<p>Likelihood ratio test for non-gaussian functions (internal use)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRT_nongaussian(formula, data, grname, mod, link, family)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRT_nongaussian_+3A_formula">formula</code></td>
<td>
<p>lme4 model formula</p>
</td></tr>
<tr><td><code id="LRT_nongaussian_+3A_data">data</code></td>
<td>
<p>data.frame given as original input</p>
</td></tr>
<tr><td><code id="LRT_nongaussian_+3A_grname">grname</code></td>
<td>
<p>original grnames vector without Residual or Fixed</p>
</td></tr>
<tr><td><code id="LRT_nongaussian_+3A_link">link</code></td>
<td>
<p>link function</p>
</td></tr>
<tr><td><code id="LRT_nongaussian_+3A_family">family</code></td>
<td>
<p>respnse family (so far just binomial or poisson)</p>
</td></tr>
</table>

<hr>
<h2 id='permut_nongaussian'>Permutation function for non-gaussian functions (internal use)</h2><span id='topic+permut_nongaussian'></span>

<h3>Description</h3>

<p>Permutation function for non-gaussian functions (internal use)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permut_nongaussian(permut, R_pe, formula, data, dep_var, grname, npermut,
  parallel, ncores, link, family, R, rptObj, update)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permut_nongaussian_+3A_permut">permut</code></td>
<td>
<p>permutation function which permutes residuals and calculates R</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_r_pe">R_pe</code></td>
<td>
<p>Function to estimate Repeatabilities and Variances for grouping factors, Residuals, Overdispersion and Fixed effects.</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_formula">formula</code></td>
<td>
<p>lme4 model formula</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_data">data</code></td>
<td>
<p>data.frame given as original input</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_dep_var">dep_var</code></td>
<td>
<p>original response variable</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_grname">grname</code></td>
<td>
<p>original grnames vector without Residual or Fixed</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_npermut">npermut</code></td>
<td>
<p>number of permutations</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_parallel">parallel</code></td>
<td>
<p>boolean</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_ncores">ncores</code></td>
<td>
<p>number of cores specified, defaults to NULL</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_link">link</code></td>
<td>
<p>link function</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_family">family</code></td>
<td>
<p>respnse family (so far just binomial or poisson)</p>
</td></tr>
<tr><td><code id="permut_nongaussian_+3A_r">R</code></td>
<td>
<p>point estimate to concetenate with permutations</p>
</td></tr>
</table>

<hr>
<h2 id='plot.rpt'>Plot a rpt object</h2><span id='topic+plot.rpt'></span>

<h3>Description</h3>

<p>Plots the distribution of repeatability estimates from bootstrapping and permutation tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rpt'
plot(x, grname = names(x$ngroups), scale = c("link",
  "original"), type = c("boot", "permut"), main = NULL,
  breaks = "FD", xlab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rpt_+3A_x">x</code></td>
<td>
<p>An rpt object returned from one of the rpt functions.</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_grname">grname</code></td>
<td>
<p>The name of the grouping factor to plot.</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_scale">scale</code></td>
<td>
<p>Either &quot;link&quot; or &quot;original&quot; scale results for results of non-Gaussian functions.</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_type">type</code></td>
<td>
<p>Either &quot;boot&quot; or &quot;permut&quot; for plotting the results of bootstraps or permutations.</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_main">main</code></td>
<td>
<p>Plot title</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_breaks">breaks</code></td>
<td>
<p>hist() argument</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_xlab">xlab</code></td>
<td>
<p>x-axis title</p>
</td></tr>
<tr><td><code id="plot.rpt_+3A_...">...</code></td>
<td>
<p>Additional arguments to the hist() function for customized plotting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A histogram of the distribution of bootstrapping or permutation test estimates of the 
repeatability including a confidence interval (CI).
</p>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de), 
Shinichi Nakagawa (s.nakagawa@unsw.edu.au),
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>

<hr>
<h2 id='print.rpt'>Print a rpt object</h2><span id='topic+print.rpt'></span>

<h3>Description</h3>

<p>Displays the results a rpt object (i.e. the result of a rpt function call) in a nice form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rpt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rpt_+3A_x">x</code></td>
<td>
<p>An rpt object returned from one of the rpt functions</p>
</td></tr>
<tr><td><code id="print.rpt_+3A_...">...</code></td>
<td>
<p>Additional arguments; none are used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Abbreviations in the print.rpt output:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>Repeatability.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Standard error of R.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Confidence interval of R derived from parametric bootstrapping.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>P-value</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p>Likelihood-ratio test</p>
</td></tr>
<tr><td><code>Permutation</code></td>
<td>
<p>Permutation of residuals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de), 
Shinichi Nakagawa (s.nakagawa@unsw.edu.au),
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>

<hr>
<h2 id='print.summary.rpt'>Prints the summary of a rpt object</h2><span id='topic+print.summary.rpt'></span>

<h3>Description</h3>

<p>Displays the summary of an rpt object (i.e. the result of a rpt function call) in an 
extended form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.rpt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.rpt_+3A_x">x</code></td>
<td>
<p>An rpt object returned from one of the rpt functions</p>
</td></tr>
<tr><td><code id="print.summary.rpt_+3A_...">...</code></td>
<td>
<p>Additional arguments; none are used in this method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de), 
Shinichi Nakagawa (s.nakagawa@unsw.edu.au),
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Nakagawa, S. and Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>

<hr>
<h2 id='rpt'>Repeatability Estimation for Gaussian and Non-Gaussian Data</h2><span id='topic+rpt'></span>

<h3>Description</h3>

<p>A wrapper function for (adjusted) repeatability estimation from generalized linear mixed-effects 
models fitted by restricted maximum likelihood (REML). Calls 
specialised functions depending of the choice of datatype and method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpt(formula, grname, data, datatype = c("Gaussian", "Binary",
  "Proportion", "Poisson"), link = c("logit", "probit", "log", "sqrt"),
  CI = 0.95, nboot = 1000, npermut = 0, parallel = FALSE,
  ncores = NULL, ratio = TRUE, adjusted = TRUE, expect = "meanobs",
  rptObj = NULL, update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rpt_+3A_formula">formula</code></td>
<td>
<p>Formula as used e.g. by <a href="lme4.html#topic+lmer">lmer</a>. The grouping factor(s) of
interest needs to be included as a random effect, e.g. '(1|groups)'.
Covariates and additional random effects can be included to estimate adjusted 
repeatabilities.</p>
</td></tr>
<tr><td><code id="rpt_+3A_grname">grname</code></td>
<td>
<p>A character string or vector of character strings giving the
name(s) of the grouping factor(s), for which the repeatability should
be estimated. Spelling needs to match the random effect names as given in <code>formula</code> 
and terms have to be set in quotation marks. The reseved terms &quot;Residual&quot;, 
&quot;Overdispersion&quot; and &quot;Fixed&quot; allow the estimation of overdispersion variance, residual 
variance and variance explained by fixed effects, respectively.</p>
</td></tr>
<tr><td><code id="rpt_+3A_data">data</code></td>
<td>
<p>A dataframe that contains the variables included in the <code>formula</code>
and <code>grname</code> arguments.</p>
</td></tr>
<tr><td><code id="rpt_+3A_datatype">datatype</code></td>
<td>
<p>Character string specifying the data type ('Gaussian', 
'Binary', 'Proportion', 'Poisson').</p>
</td></tr>
<tr><td><code id="rpt_+3A_link">link</code></td>
<td>
<p>Character string specifying the link function. Ignored for 
'Gaussian' datatype.</p>
</td></tr>
<tr><td><code id="rpt_+3A_ci">CI</code></td>
<td>
<p>Width of the required confidence interval between 0 and 1 (defaults to 
0.95).</p>
</td></tr>
<tr><td><code id="rpt_+3A_nboot">nboot</code></td>
<td>
<p>Number of parametric bootstraps for interval estimation 
(defaults to 1000). Larger numbers of bootstraps give a better
asymtotic CI, but may be time-consuming. Bootstrapping can be switch off by setting 
<code>nboot = 0</code>. See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rpt_+3A_npermut">npermut</code></td>
<td>
<p>Number of permutations used when calculating asymptotic p-values 
(defaults to 0). Larger numbers of permutations give a better
asymtotic p-values, but may be time-consuming (in particular when multiple grouping factors
are specified). Permutaton tests can be switch off by setting <code>npermut = 0</code>. 
See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rpt_+3A_parallel">parallel</code></td>
<td>
<p>Boolean to express if parallel computing should be applied (defaults to FALSE). 
If TRUE, bootstraps and permutations will be distributed across multiple cores.</p>
</td></tr>
<tr><td><code id="rpt_+3A_ncores">ncores</code></td>
<td>
<p>Specifying the number of cores to use for parallelization. On default,
all but one of the available cores are used.</p>
</td></tr>
<tr><td><code id="rpt_+3A_ratio">ratio</code></td>
<td>
<p>Boolean to express if variances or ratios of variance should be estimated. 
If FALSE, the variance(s) are returned without forming ratios. If TRUE (the default) ratios 
of variances (i.e. repeatabilities) are estimated.</p>
</td></tr>
<tr><td><code id="rpt_+3A_adjusted">adjusted</code></td>
<td>
<p>Boolean to express if adjusted or unadjusted repeatabilities should be estimated. 
If TRUE (the default), the variances explained by fixed effects (if any) will not
be part of the denominator, i.e. repeatabilities are calculated after controlling for 
variation due to covariates. If FALSE, the varianced explained by fixed effects (if any) will
be added to the denominator.</p>
</td></tr>
<tr><td><code id="rpt_+3A_expect">expect</code></td>
<td>
<p>A character string specifying the method for estimating the expectation in Poisson models
with log link and in Binomial models with logit link (in all other cases the agrument is ignored). 
The only valid terms are 'meanobs' and 'latent' (and 'liability for binary and proportion data). 
With the default 'meanobs', the expectation is 
estimated as the mean of the observations in the sample. With 'latent', the expectation is
estimated from estiamtes of the intercept and variances on the link scale. While this is a 
preferred solution, it is susceptible to the distribution of fixed effect covariates and gives 
appropriate results typically only when all covariances are centered to zero. With 'liability' 
estimates follow formulae as presented in Nakagawa &amp; Schielzeth (2010). Liability estimates tend 
to be slightly higher.</p>
</td></tr>
<tr><td><code id="rpt_+3A_rptobj">rptObj</code></td>
<td>
<p>The output of a rptR function. Can be specified in combination with update = TRUE
to update bootstraps and permutations</p>
</td></tr>
<tr><td><code id="rpt_+3A_update">update</code></td>
<td>
<p>If TRUE, the rpt object to be updated has to be inputted with the rptObj argument.
The function just updates the permutations and bootstraps, so make sure to specify all other
arguments excactly like for the rpt object specified in rptObj.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>datatype='Gaussian'</code> calls function <a href="#topic+rptGaussian">rptGaussian</a>,  
for <code>datatype='Poisson'</code> calls function <a href="#topic+rptPoisson">rptPoisson</a>,   
for <code>datatype='Binary'</code> calls function <a href="#topic+rptBinary">rptBinary</a>,   
for <code>datatype='Proportion'</code> calls function <a href="#topic+rptProportion">rptProportion</a>.  
</p>
<p>Confidence intervals and standard errors are estimated by <strong>parametric bootstrapping</strong>. 
Under the assumption that the model is specified correctly, the fitted model can be used
to generate response values that could potentially be obversed. Differences between the original 
data and the simulated response from the fitted model arise from sampling variation. The full model
is then fitted to each simuated response vector. The distribution of estimates across all 
<code>nboot</code> replicates represents the design- and model-specific sampling variance and hence 
uncertainty of the estimates.
</p>
<p>In addition to the likelihood-ratio test, the package uses <strong>permutation tests</strong> for null 
hypothesis testing. The general idea is to randomize data under the null hypothesis of no effect 
and then test in how many cases the estimates from the model reach or exceed those in the observed 
data. In the simplest case, a permutation test randomizes the vector of group identities against 
the response vector many times, followed by refitting the model and recalculating the repeatabilities.
This provides a null distribution for the case that group identities are unrelated to the response. 
However, in more complex models involving multiple random effects and/or fixed effects, such a 
procedure will also break the data structure between the grouping factor of interest and other 
aspects of the experimental design. Therefore <code>rptR</code> implements a more robust alternative 
which works by fitting a model withouth the grouping factor of interest. It then adds the 
randomized residuals to the fitted values of this model, followed by recalculating the repeatability 
from the full model. This procedure maintains the general data structure and any effects other 
than the grouping effect of interest. The number of permutations can be adjusted with the <code>nperm</code> argument. 
By the logic of a null hypothsis testing, the observed data is one possible (albeit maybe unlikely) 
outcome under the null hypothesis. So the observed data is always included as one 'randomization' and 
the P value can thus never be lower than <code>1/nperm</code>, because at least one randomization is as 
exteme as the observed data.   
</p>
<p>Note also that the <strong>likelihood-ratio test</strong>, since testing variances at the boundary of the 
possible parameter range (i.e. against zero), uses a mixture distribution of Chi-square 
distrbutions with zero and one degree of freedom as a reference. This ist equivalent to deviding 
the P value derived from a Chi-square distribution with one degree of freedom by two.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rpt</code>. See specific functions for details.
</p>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de), 
Shinichi Nakagawa (s.nakagawa@unsw.edu.au),
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for 
Gaussian and non-Gaussian data: a practical guide for biologists</em>. 
Biological Reviews 85: 935-956.
</p>


<h3>See Also</h3>

<p><a href="#topic+rptR">rptR</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(BeetlesBody)
data(BeetlesMale)
data(BeetlesFemale)

#  prepare proportion data
BeetlesMale$Dark &lt;- BeetlesMale$Colour
BeetlesMale$Reddish &lt;- (BeetlesMale$Colour-1)*-1
BeetlesColour &lt;- aggregate(cbind(Dark, Reddish) ~ Treatment + Population + Container, 
     data=BeetlesMale, FUN=sum)

# Note: nboot and npermut are set to 0 for speed reasons. Use larger numbers
# for the real analysis.

# gaussian data (example with a single random effect)
rpt(BodyL ~ (1|Population), grname="Population", data=BeetlesBody, 
     nboot=0, npermut=0, datatype = "Gaussian")

# poisson data (example with two grouping levels and adjusted for fixed effect)
rpt(Egg ~ Treatment + (1|Container) + (1|Population), grname=c("Population"), 
     data = BeetlesFemale, nboot=0, npermut=0, datatype = "Poisson")

## Not run: 

# binary data (example with estimation of the fixed effect variance)
rpt(Colour ~ Treatment + (1|Container) + (1|Population), 
     grname=c("Population", "Container", "Fixed"), 
     data=BeetlesMale, nboot=0, npermut=0, datatype = "Binary", adjusted = FALSE)

# proportion data (example for the estimation of raw variances, 
# including residual and fixed-effect variance)
rpt(cbind(Dark, Reddish) ~ Treatment + (1|Population), 
     grname=c("Population", "Residual", "Fixed"), data=BeetlesColour,
     nboot=0, npermut=0, datatype = "Proportion", ratio=FALSE)


## End(Not run)

</code></pre>

<hr>
<h2 id='rptBinary'>GLMM-based Repeatability Estimation for Binary Data</h2><span id='topic+rptBinary'></span>

<h3>Description</h3>

<p>Estimates repeatability from a generalized linear mixed-effects models fitted by restricted maximum likelihood (REML).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rptBinary(formula, grname, data, link = c("logit", "probit"),
  CI = 0.95, nboot = 1000, npermut = 0, parallel = FALSE,
  ncores = NULL, ratio = TRUE, adjusted = TRUE, expect = "meanobs",
  rptObj = NULL, update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rptBinary_+3A_formula">formula</code></td>
<td>
<p>Formula as used e.g. by <a href="lme4.html#topic+lmer">lmer</a>. The grouping factor(s) of
interest needs to be included as a random effect, e.g. '(1|groups)'.
Covariates and additional random effects can be included to estimate adjusted 
repeatabilities.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_grname">grname</code></td>
<td>
<p>A character string or vector of character strings giving the
name(s) of the grouping factor(s), for which the repeatability should
be estimated. Spelling needs to match the random effect names as given in <code>formula</code> 
and terms have to be set in quotation marks. The reseved terms &quot;Residual&quot;, 
&quot;Fixed&quot; allow the estimation of residual 
variance and variance explained by fixed effects, respectively. &quot;Overdispersion&quot; is 
not available for rptBinary.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_data">data</code></td>
<td>
<p>A dataframe that contains the variables included in the <code>formula</code>
and <code>grname</code> arguments.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_link">link</code></td>
<td>
<p>Link function. <code>logit</code> and <code>probit</code> are allowed, defaults to <code>logit</code>.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_ci">CI</code></td>
<td>
<p>Width of the required confidence interval between 0 and 1 (defaults to 
0.95).</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_nboot">nboot</code></td>
<td>
<p>Number of parametric bootstraps for interval estimation 
(defaults to 1000). Larger numbers of bootstraps give a better
asymtotic CI, but may be time-consuming. Bootstrapping can be switch off by setting 
<code>nboot = 0</code>. See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_npermut">npermut</code></td>
<td>
<p>Number of permutations used when calculating asymptotic p-values 
(defaults to 0). Larger numbers of permutations give a better
asymtotic p-values, but may be time-consuming (in particular when multiple grouping factors
are specified). Permutaton tests can be switch off by setting <code>npermut = 0</code>. 
See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_parallel">parallel</code></td>
<td>
<p>Boolean to express if parallel computing should be applied (defaults to FALSE). 
If TRUE, bootstraps and permutations will be distributed across multiple cores.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_ncores">ncores</code></td>
<td>
<p>Specifying the number of cores to use for parallelization. On default,
all but one of the available cores are used.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_ratio">ratio</code></td>
<td>
<p>Boolean to express if variances or ratios of variance should be estimated. 
If FALSE, the variance(s) are returned without forming ratios. If TRUE (the default) ratios 
of variances (i.e. repeatabilities) are estimated.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_adjusted">adjusted</code></td>
<td>
<p>Boolean to express if adjusted or unadjusted repeatabilities should be estimated. 
If TRUE (the default), the variances explained by fixed effects (if any) will not
be part of the denominator, i.e. repeatabilities are calculated after controlling for 
variation due to covariates. If FALSE, the varianced explained by fixed effects (if any) will
be added to the denominator.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_expect">expect</code></td>
<td>
<p>A character string specifying the method for estimating the expectation in Poisson models
with log link and in Binomial models with logit link (in all other cases the agrument is ignored). 
The only valid terms are 'meanobs' and 'latent' (and 'liability for binary and proportion data). 
With the default 'meanobs', the expectation is 
estimated as the mean of the observations in the sample. With 'latent', the expectation is
estimated from estiamtes of the intercept and variances on the link scale. While this is a 
preferred solution, it is susceptible to the distribution of fixed effect covariates and gives 
appropriate results typically only when all covariances are centered to zero. With 'liability' 
estimates follow formulae as presented in Nakagawa &amp; Schielzeth (2010). Liability estimates tend 
to be slightly higher.</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_rptobj">rptObj</code></td>
<td>
<p>The output of a rptR function. Can be specified in combination with update = TRUE
to update bootstraps and permutations</p>
</td></tr>
<tr><td><code id="rptBinary_+3A_update">update</code></td>
<td>
<p>If TRUE, the rpt object to be updated has to be inputted with the rptObj argument.
The function just updates the permutations and bootstraps, so make sure to specify all other
arguments excactly like for the rpt object specified in rptObj.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see details section of <code><a href="#topic+rpt">rpt</a></code> for details on parametric bootstrapping,
permutation and likelihood-ratio tests.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rpt</code> that is a a list with the following elements: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Function call.</p>
</td></tr>
<tr><td><code>datatype</code></td>
<td>
<p>Response distribution (here: 'Binary').</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Coverage of the confidence interval as specified by the <code>CI</code> argument.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p><code>data.frame</code> with point estimates for repeatabilities. Columns
represent grouping factors of interest. Rows show original and link scale repeatabilites 
(in this order).</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p><code>data.frame</code> with approximate standard errors (<em>se</em>) for repeatabilities. Columns
are groups of interest. Rows are original and link scale (in this order).
Note that the distribution might not be symmetrical, in which case the emphse is less informative.</p>
</td></tr>
<tr><td><code>CI_emp</code></td>
<td>
<p><code>list</code> of two elements containing the confidence intervals for repeatabilities 
on the link and original scale, respectively. Within each list element, lower and upper CI
are columns and each row for each grouping factor of interest.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p><code>data.frame</code> with p-values from a significance test based on likelihood-ratios
in the first column and significance test based on permutation of residuals for 
both the original and link scale in the second and third column. Each row represents a grouping
factor of interest.</p>
</td></tr>
<tr><td><code>R_boot_link</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_boot_org</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_link</code></td>
<td>
<p>Permutation samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_org</code></td>
<td>
<p>Permutation samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p>List of two elements. <em>LRT_mod</em> is the likelihood for the full model and (2) <em>LRT_table</em> is a data.frame 
for the reduced model(s) including columns for the likelihood <em>logl_red</em>, the likelihood ratio(s) <em>LR_D</em>, 
p-value(s)<em>LR_P</em> and degrees of freedom for the likelihood-ratio test(s) <em>LR_df</em>.</p>
</td></tr> 
<tr><td><code>ngroups</code></td>
<td>
<p>Number of groups for each grouping level.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code>mod</code></td>
<td>
<p>Fitted model.</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>Boolean. TRUE, if ratios have been estimated, FALSE, if variances have been estimated</p>
</td></tr>
<tr><td><code>adjusted</code></td>
<td>
<p>Boolean. TRUE, if estimates are adjusted</p>
</td></tr>
<tr><td><code>all_warnings</code></td>
<td>
<p><code>list</code> with two elements. 'warnings_boot' and 'warnings_permut' contain
warnings from the lme4 model fitting of bootstrap and permutation samples, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de),
Shinichi Nakagawa (s.nakagawa@unsw.edu.au) &amp;
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Carrasco, J. L. &amp; Jover, L.  (2003) <em>Estimating the generalized 
concordance correlation coefficient through variance components</em>. Biometrics 59: 849-858.
</p>
<p>Faraway, J. J. (2006) <em>Extending the linear model with R</em>. Boca Raton, FL, Chapman &amp; Hall/CRC.
</p>
<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>


<h3>See Also</h3>

<p><a href="#topic+rpt">rpt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BeetlesMale)

# Note: nboot and npermut are set to 0 for speed reasons. 

# repeatability with one grouping level
rptBinary(Colour ~ (1|Population), grname=c("Population"), 
data=BeetlesMale, nboot=0, npermut=0)

# unadjusted repeatabilities with  fixed effects and 
# estimation of the fixed effect variance
rptBinary(Colour ~ Treatment + (1|Container) + (1|Population), 
                   grname=c("Container", "Population", "Fixed"), 
                   data=BeetlesMale, nboot=0, npermut=0, adjusted=FALSE)


## Not run: 
# variance estimation of random effects and residual
R_est &lt;- rptBinary(Colour ~ Treatment + (1|Container) + (1|Population), 
                   grname=c("Container","Population","Residual"), 
                   data = BeetlesMale, nboot=0, npermut=0, ratio = FALSE)

## End(Not run)    

     
</code></pre>

<hr>
<h2 id='rptGaussian'>LMM-based Repeatability Estimation for Gaussian Data</h2><span id='topic+rptGaussian'></span>

<h3>Description</h3>

<p>Estimates the repeatability from a general linear mixed-effects models fitted by restricted maximum likelihood (REML).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rptGaussian(formula, grname, data, CI = 0.95, nboot = 1000,
  npermut = 0, parallel = FALSE, ncores = NULL, ratio = TRUE,
  adjusted = TRUE, rptObj = NULL, update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rptGaussian_+3A_formula">formula</code></td>
<td>
<p>Formula as used e.g. by <a href="lme4.html#topic+lmer">lmer</a>. The grouping factor(s) of
interest needs to be included as a random effect, e.g. '(1|groups)'.
Covariates and additional random effects can be included to estimate adjusted 
repeatabilities.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_grname">grname</code></td>
<td>
<p>A character string or vector of character strings giving the
name(s) of the grouping factor(s), for which the repeatability should
be estimated. Spelling needs to match the random effect names as given in <code>formula</code> 
and terms have to be set in quotation marks. The reseved terms &quot;Residual&quot;, 
&quot;Overdispersion&quot; and &quot;Fixed&quot; allow the estimation of overdispersion variance, residual 
variance and variance explained by fixed effects, respectively.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_data">data</code></td>
<td>
<p>A dataframe that contains the variables included in the <code>formula</code>
and <code>grname</code> arguments.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_ci">CI</code></td>
<td>
<p>Width of the required confidence interval between 0 and 1 (defaults to 
0.95).</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_nboot">nboot</code></td>
<td>
<p>Number of parametric bootstraps for interval estimation 
(defaults to 1000). Larger numbers of bootstraps give a better
asymtotic CI, but may be time-consuming. Bootstrapping can be switch off by setting 
<code>nboot = 0</code>. See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_npermut">npermut</code></td>
<td>
<p>Number of permutations used when calculating asymptotic p-values 
(defaults to 0). Larger numbers of permutations give a better
asymtotic p-values, but may be time-consuming (in particular when multiple grouping factors
are specified). Permutaton tests can be switch off by setting <code>npermut = 0</code>. 
See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_parallel">parallel</code></td>
<td>
<p>Boolean to express if parallel computing should be applied (defaults to FALSE). 
If TRUE, bootstraps and permutations will be distributed across multiple cores.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_ncores">ncores</code></td>
<td>
<p>Specifying the number of cores to use for parallelization. On default,
all but one of the available cores are used.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_ratio">ratio</code></td>
<td>
<p>Boolean to express if variances or ratios of variance should be estimated. 
If FALSE, the variance(s) are returned without forming ratios. If TRUE (the default) ratios 
of variances (i.e. repeatabilities) are estimated.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_adjusted">adjusted</code></td>
<td>
<p>Boolean to express if adjusted or unadjusted repeatabilities should be estimated. 
If TRUE (the default), the variances explained by fixed effects (if any) will not
be part of the denominator, i.e. repeatabilities are calculated after controlling for 
variation due to covariates. If FALSE, the varianced explained by fixed effects (if any) will
be added to the denominator.</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_rptobj">rptObj</code></td>
<td>
<p>The output of a rptR function. Can be specified in combination with update = TRUE
to update bootstraps and permutations</p>
</td></tr>
<tr><td><code id="rptGaussian_+3A_update">update</code></td>
<td>
<p>If TRUE, the rpt object to be updated has to be inputted with the rptObj argument.
The function just updates the permutations and bootstraps, so make sure to specify all other
arguments excactly like for the rpt object specified in rptObj.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see details section of <code><a href="#topic+rpt">rpt</a></code> for details on parametric bootstrapping,
permutation and likelihood-ratio tests.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rpt</code> that is a a list with the following elements: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Function call.</p>
</td></tr>
<tr><td><code>datatype</code></td>
<td>
<p>Response distribution (here: 'Gaussian').</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Coverage of the confidence interval as specified by the <code>CI</code> argument.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p><code>data.frame</code> with point estimates for repeatabilities for each grouping factor
of interest.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p><code>data.frame</code> with approximate standard errors (<em>se</em>) for repeatabilities. 
Rows repsresent grouping factors of interest. Note that the distribution might not be symmetrical, 
in which case the <em>se</em> is less informative.</p>
</td></tr>
<tr><td><code>CI_emp</code></td>
<td>
<p><code>data.frame</code> containing the (empirical) confidence intervals for the repeatabilities 
estiamted based parametric bootstrapping. Each row represents a grouping factor of interest.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p><code>data.frame</code> with p-values based on likelihood-ratio tests
(first column) and permutation tests (second column). Each row represents a grouping factor 
of interest.</p>
</td></tr>
<tr><td><code>R_boot</code></td>
<td>
<p>Vector(s) of parametric bootstrap samples for <em>R</em>. Each <code>list</code>
element respesents a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut</code></td>
<td>
<p>Vector(s) of permutation samples for <em>R</em>. Each <code>list</code>
element represents a grouping factor.</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p><code>list</code> with two elements. (1) The likelihood for the full model and a <code>data.frame</code> 
called <code>LRT_table</code> for the reduced model(s), which includes columns
for the respective grouping factor(s), the likelihood(s) <em>logL_red</em>, likelihood ratio(s)
<em>LR_D</em>, p-value(s) <em>LRT_P</em> and degrees of freedom <em>LRT_df</em></p>
</td></tr> 
<tr><td><code>ngroups</code></td>
<td>
<p>Number of groups for each grouping level.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code>mod</code></td>
<td>
<p>Fitted model.</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>Boolean. TRUE, if ratios have been estimated, FALSE, if variances have been estimated</p>
</td></tr>
<tr><td><code>adjusted</code></td>
<td>
<p>Boolean. TRUE, if estimates are adjusted</p>
</td></tr>
<tr><td><code>all_warnings</code></td>
<td>
<p><code>list</code> with two elements. 'warnings_boot' and 'warnings_permut' contain
warnings from the lme4 model fitting of bootstrap and permutation samples, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de),
Shinichi Nakagawa (s.nakagawa@unsw.edu.au) &amp;
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Carrasco, J. L. &amp; Jover, L.  (2003) <em>Estimating the generalized 
concordance correlation coefficient through variance components</em>. Biometrics 59: 849-858.
</p>
<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>


<h3>See Also</h3>

<p><a href="#topic+rpt">rpt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 

data(BeetlesBody)

# Note: nboot and npermut are set to 3 for speed reasons. Use larger numbers
# for the real analysis.

# one random effect
rpt_est &lt;- rptGaussian(BodyL ~ (1|Population), grname="Population", 
                   data=BeetlesBody, nboot=3, npermut=3, ratio = FALSE)

# two random effects
rptGaussian(BodyL ~ (1|Container) + (1|Population), grname=c("Container", "Population"), 
                   data=BeetlesBody, nboot=3, npermut=3)
                   
# unadjusted repeatabilities with fixed effects and 
# estimation of the fixed effect variance
rptGaussian(BodyL ~ Sex + Treatment + Habitat + (1|Container) + (1|Population), 
                  grname=c("Container", "Population", "Fixed"), 
                  data=BeetlesBody, nboot=3, npermut=3, adjusted=FALSE)
                  
                  
# two random effects, estimation of variance (instead repeatability)
R_est &lt;- rptGaussian(formula = BodyL ~ (1|Population) + (1|Container), 
            grname= c("Population", "Container", "Residual"),
            data=BeetlesBody, nboot=3, npermut=3, ratio = FALSE)

</code></pre>

<hr>
<h2 id='rptPoisson'>GLMM-based Repeatability Estimation for Poisson-distributed Data</h2><span id='topic+rptPoisson'></span>

<h3>Description</h3>

<p>Estimates repeatability from a generalized linear mixed-effects models fitted by restricted maximum likelihood (REML).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rptPoisson(formula, grname, data, link = c("log", "sqrt"), CI = 0.95,
  nboot = 1000, npermut = 0, parallel = FALSE, ncores = NULL,
  ratio = TRUE, adjusted = TRUE, expect = "meanobs", rptObj = NULL,
  update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rptPoisson_+3A_formula">formula</code></td>
<td>
<p>Formula as used e.g. by <a href="lme4.html#topic+lmer">lmer</a>. The grouping factor(s) of
interest needs to be included as a random effect, e.g. '(1|groups)'.
Covariates and additional random effects can be included to estimate adjusted 
repeatabilities.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_grname">grname</code></td>
<td>
<p>A character string or vector of character strings giving the
name(s) of the grouping factor(s), for which the repeatability should
be estimated. Spelling needs to match the random effect names as given in <code>formula</code> 
and terms have to be set in quotation marks. The reseved terms &quot;Residual&quot;, 
&quot;Overdispersion&quot; and &quot;Fixed&quot; allow the estimation of overdispersion variance, residual 
variance and variance explained by fixed effects, respectively.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_data">data</code></td>
<td>
<p>A dataframe that contains the variables included in the <code>formula</code>
and <code>grname</code> arguments.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_link">link</code></td>
<td>
<p>Link function. <code>logit</code> and <code>probit</code> are allowed, defaults to <code>logit</code>.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_ci">CI</code></td>
<td>
<p>Width of the required confidence interval between 0 and 1 (defaults to 
0.95).</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_nboot">nboot</code></td>
<td>
<p>Number of parametric bootstraps for interval estimation 
(defaults to 1000). Larger numbers of bootstraps give a better
asymtotic CI, but may be time-consuming. Bootstrapping can be switch off by setting 
<code>nboot = 0</code>. See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_npermut">npermut</code></td>
<td>
<p>Number of permutations used when calculating asymptotic p-values 
(defaults to 0). Larger numbers of permutations give a better
asymtotic p-values, but may be time-consuming (in particular when multiple grouping factors
are specified). Permutaton tests can be switch off by setting <code>npermut = 0</code>. 
See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_parallel">parallel</code></td>
<td>
<p>Boolean to express if parallel computing should be applied (defaults to FALSE). 
If TRUE, bootstraps and permutations will be distributed across multiple cores.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_ncores">ncores</code></td>
<td>
<p>Specifying the number of cores to use for parallelization. On default,
all but one of the available cores are used.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_ratio">ratio</code></td>
<td>
<p>Boolean to express if variances or ratios of variance should be estimated. 
If FALSE, the variance(s) are returned without forming ratios. If TRUE (the default) ratios 
of variances (i.e. repeatabilities) are estimated.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_adjusted">adjusted</code></td>
<td>
<p>Boolean to express if adjusted or unadjusted repeatabilities should be estimated. 
If TRUE (the default), the variances explained by fixed effects (if any) will not
be part of the denominator, i.e. repeatabilities are calculated after controlling for 
variation due to covariates. If FALSE, the varianced explained by fixed effects (if any) will
be added to the denominator.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_expect">expect</code></td>
<td>
<p>A character string specifying the method for estimating the expectation in Poisson models
with log link and in Binomial models with logit link (in all other cases the agrument is ignored). 
The only valid terms are 'meanobs' and 'latent' (and 'liability for binary and proportion data). 
With the default 'meanobs', the expectation is 
estimated as the mean of the observations in the sample. With 'latent', the expectation is
estimated from estiamtes of the intercept and variances on the link scale. While this is a 
preferred solution, it is susceptible to the distribution of fixed effect covariates and gives 
appropriate results typically only when all covariances are centered to zero. With 'liability' 
estimates follow formulae as presented in Nakagawa &amp; Schielzeth (2010). Liability estimates tend 
to be slightly higher.</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_rptobj">rptObj</code></td>
<td>
<p>The output of a rptR function. Can be specified in combination with update = TRUE
to update bootstraps and permutations</p>
</td></tr>
<tr><td><code id="rptPoisson_+3A_update">update</code></td>
<td>
<p>If TRUE, the rpt object to be updated has to be inputted with the rptObj argument.
The function just updates the permutations and bootstraps, so make sure to specify all other
arguments excactly like for the rpt object specified in rptObj.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see details section of <code><a href="#topic+rpt">rpt</a></code> for details on parametric bootstrapping,
permutation and likelihood-ratio tests.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rpt</code> that is a a list with the following elements: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Function call</p>
</td></tr>
<tr><td><code>datatype</code></td>
<td>
<p>Response distribution (here: 'Poisson').</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Coverage of the confidence interval as specified by the <code>CI</code> argument.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p><code>data.frame</code> with point estimates for repeatabilities. Columns
represent grouping factors of interest. Rows show original and link scale repeatabilites 
(in this order).</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p><code>data.frame</code> with approximate standard errors (<em>se</em>) for repeatabilities. Columns
are groups of interest. Rows are original and link scale (in this order).
Note that the distribution might not be symmetrical, in which case the <em>se</em> is less informative.</p>
</td></tr>
<tr><td><code>CI_emp</code></td>
<td>
<p><code>list</code> of two elements containing the confidence intervals for repeatabilities 
on the link and original scale, respectively. Within each list element, lower and upper CI
are columns and each row for each grouping factor of interest.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p><code>data.frame</code> with p-values from a significance test based on likelihood-ratios
in the first column and significance test based on permutation of residuals for 
both the original and link scale in the second and third column. Each row represents a grouping
factor of interest.</p>
</td></tr>
<tr><td><code>R_boot_link</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_boot_org</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_link</code></td>
<td>
<p>Permutation samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_org</code></td>
<td>
<p>Permutation samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p>List of two elements. <em>LRT_mod</em> is the likelihood for the full model and (2) <em>LRT_table</em> is a data.frame 
for the reduced model(s) including columns for the likelihood <em>logl_red</em>, the likelihood ratio(s) <em>LR_D</em>, 
p-value(s)<em>LR_P</em> and degrees of freedom for the likelihood-ratio test(s) <em>LR_df</em>.</p>
</td></tr> 
<tr><td><code>ngroups</code></td>
<td>
<p>Number of groups for each grouping level.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code>mod</code></td>
<td>
<p>Fitted model.</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>Boolean. TRUE, if ratios have been estimated, FALSE, if variances have been estimated</p>
</td></tr>
<tr><td><code>adjusted</code></td>
<td>
<p>Boolean. TRUE, if estimates are adjusted</p>
</td></tr>
<tr><td><code>all_warnings</code></td>
<td>
<p><code>list</code> with two elements. 'warnings_boot' and 'warnings_permut' contain
warnings from the lme4 model fitting of bootstrap and permutation samples, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de),
Shinichi Nakagawa (s.nakagawa@unsw.edu.au) &amp;
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Carrasco, J. L. &amp; Jover, L.  (2003) <em>Estimating the generalized 
concordance correlation coefficient through variance components</em>. Biometrics 59: 849-858.
</p>
<p>Faraway, J. J. (2006) <em>Extending the linear model with R</em>. Boca Raton, FL, Chapman &amp; Hall/CRC.
</p>
<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>


<h3>See Also</h3>

<p><a href="#topic+rpt">rpt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(BeetlesFemale)

# Note: nboot and npermut are set to 0 for speed reasons. 

# estimating adjusted repeatabilities for two random effects
rptPoisson(Egg ~ Treatment + (1|Container) + (1|Population), 
                   grname=c("Container", "Population"), 
                   data = BeetlesFemale, nboot=0, npermut=0)

# unadjusted repeatabilities with  fixed effects and 
# estimation of the fixed effect variance
rptPoisson(Egg ~ Treatment + (1|Container) + (1|Population), 
                   grname=c("Container", "Population", "Fixed"), 
                   data=BeetlesFemale, nboot=0, npermut=0, adjusted=FALSE)
                
               
# variance estimation of random effects, residual and overdispersion 
rptPoisson(formula = Egg ~ Treatment + (1|Container) + (1|Population) , 
                   grname=c("Container","Population","Residual", "Overdispersion"), 
                   data = BeetlesFemale, nboot=0, npermut=0, ratio = FALSE)
                   
                   


</code></pre>

<hr>
<h2 id='rptProportion'>GLMM-based Repeatability Estimation for Proportion Data</h2><span id='topic+rptProportion'></span>

<h3>Description</h3>

<p>Estimates repeatability from a generalized linear mixed-effects models fitted by restricted maximum likelihood (REML).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rptProportion(formula, grname, data, link = c("logit", "probit"),
  CI = 0.95, nboot = 1000, npermut = 0, parallel = FALSE,
  ncores = NULL, ratio = TRUE, adjusted = TRUE, expect = "meanobs",
  rptObj = NULL, update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rptProportion_+3A_formula">formula</code></td>
<td>
<p>Formula as used e.g. by <a href="lme4.html#topic+lmer">lmer</a>. The grouping factor(s) of
interest needs to be included as a random effect, e.g. '(1|groups)'.
Covariates and additional random effects can be included to estimate adjusted 
repeatabilities.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_grname">grname</code></td>
<td>
<p>A character string or vector of character strings giving the
name(s) of the grouping factor(s), for which the repeatability should
be estimated. Spelling needs to match the random effect names as given in <code>formula</code> 
and terms have to be set in quotation marks. The reseved terms &quot;Residual&quot;, 
&quot;Overdispersion&quot; and &quot;Fixed&quot; allow the estimation of overdispersion variance, residual 
variance and variance explained by fixed effects, respectively.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_data">data</code></td>
<td>
<p>A dataframe that contains the variables included in the <code>formula</code>
and <code>grname</code> arguments.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_link">link</code></td>
<td>
<p>Link function. <code>logit</code> and <code>probit</code> are allowed, defaults to <code>logit</code>.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_ci">CI</code></td>
<td>
<p>Width of the required confidence interval between 0 and 1 (defaults to 
0.95).</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_nboot">nboot</code></td>
<td>
<p>Number of parametric bootstraps for interval estimation 
(defaults to 1000). Larger numbers of bootstraps give a better
asymtotic CI, but may be time-consuming. Bootstrapping can be switch off by setting 
<code>nboot = 0</code>. See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_npermut">npermut</code></td>
<td>
<p>Number of permutations used when calculating asymptotic p-values 
(defaults to 0). Larger numbers of permutations give a better
asymtotic p-values, but may be time-consuming (in particular when multiple grouping factors
are specified). Permutaton tests can be switch off by setting <code>npermut = 0</code>. 
See also <strong>Details</strong> below.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_parallel">parallel</code></td>
<td>
<p>Boolean to express if parallel computing should be applied (defaults to FALSE). 
If TRUE, bootstraps and permutations will be distributed across multiple cores.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_ncores">ncores</code></td>
<td>
<p>Specifying the number of cores to use for parallelization. On default,
all but one of the available cores are used.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_ratio">ratio</code></td>
<td>
<p>Boolean to express if variances or ratios of variance should be estimated. 
If FALSE, the variance(s) are returned without forming ratios. If TRUE (the default) ratios 
of variances (i.e. repeatabilities) are estimated.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_adjusted">adjusted</code></td>
<td>
<p>Boolean to express if adjusted or unadjusted repeatabilities should be estimated. 
If TRUE (the default), the variances explained by fixed effects (if any) will not
be part of the denominator, i.e. repeatabilities are calculated after controlling for 
variation due to covariates. If FALSE, the varianced explained by fixed effects (if any) will
be added to the denominator.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_expect">expect</code></td>
<td>
<p>A character string specifying the method for estimating the expectation in Poisson models
with log link and in Binomial models with logit link (in all other cases the agrument is ignored). 
The only valid terms are 'meanobs' and 'latent' (and 'liability for binary and proportion data). 
With the default 'meanobs', the expectation is 
estimated as the mean of the observations in the sample. With 'latent', the expectation is
estimated from estiamtes of the intercept and variances on the link scale. While this is a 
preferred solution, it is susceptible to the distribution of fixed effect covariates and gives 
appropriate results typically only when all covariances are centered to zero. With 'liability' 
estimates follow formulae as presented in Nakagawa &amp; Schielzeth (2010). Liability estimates tend 
to be slightly higher.</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_rptobj">rptObj</code></td>
<td>
<p>The output of a rptR function. Can be specified in combination with update = TRUE
to update bootstraps and permutations</p>
</td></tr>
<tr><td><code id="rptProportion_+3A_update">update</code></td>
<td>
<p>If TRUE, the rpt object to be updated has to be inputted with the rptObj argument.
The function just updates the permutations and bootstraps, so make sure to specify all other
arguments excactly like for the rpt object specified in rptObj.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see details section of <code><a href="#topic+rpt">rpt</a></code> for details on parametric bootstrapping,
permutation and likelihood-ratio tests.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rpt</code> that is a a list with the following elements: 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Function call</p>
</td></tr>
<tr><td><code>datatype</code></td>
<td>
<p>Response distribution (here: 'Proportion').</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Width of the confidence interval.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p><code>data.frame</code> with point estimates for repeatabilities. Columns
represent grouping factors of interest. Rows show original and link scale repeatabilites 
(in this order).</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p><code>data.frame</code> with approximate standard errors (<em>se</em>) for repeatabilities. Columns
are groups of interest. Rows are original and link scale (in this order).
Note that the distribution might not be symmetrical, in which case the <em>se</em> is less informative.</p>
</td></tr>
<tr><td><code>CI_emp</code></td>
<td>
<p><code>list</code> of two elements containing the confidence intervals for repeatabilities 
on the link and original scale, respectively. Within each list element, lower and upper CI
are columns and each row for each grouping factor of interest.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p><code>data.frame</code> with p-values from a significance test based on likelihood-ratios
in the first column and significance test based on permutation of residuals for 
both the original and link scale in the second and third column. Each row represents a grouping
factor of interest.</p>
</td></tr>
<tr><td><code>R_boot_link</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_boot_org</code></td>
<td>
<p>Parametric bootstrap samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_link</code></td>
<td>
<p>Permutation samples for <em>R</em> on the link scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>R_permut_org</code></td>
<td>
<p>Permutation samples for <em>R</em> on the original scale. Each <code>list</code>
element is a grouping factor.</p>
</td></tr>
<tr><td><code>LRT</code></td>
<td>
<p>List of two elements. <em>LRT_mod</em> is the likelihood for the full model and (2) <em>LRT_table</em> is a data.frame 
for the reduced model(s) including columns for the likelihood <em>logl_red</em>, the likelihood ratio(s) <em>LR_D</em>, 
p-value(s)<em>LR_P</em> and degrees of freedom for the likelihood-ratio test(s) <em>LR_df</em>.</p>
</td></tr> 
<tr><td><code>ngroups</code></td>
<td>
<p>Number of groups for each grouping level.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code>overdisp</code></td>
<td>
<p>Overdispersion parameter. Equals the variance in the observational factor random effect</p>
</td></tr>
<tr><td><code>mod</code></td>
<td>
<p>Fitted model.</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>Boolean. TRUE, if ratios have been estimated, FALSE, if variances have been estimated</p>
</td></tr>
<tr><td><code>adjusted</code></td>
<td>
<p>Boolean. TRUE, if estimates are adjusted</p>
</td></tr>
<tr><td><code>all_warnings</code></td>
<td>
<p><code>list</code> with two elements. 'warnings_boot' and 'warnings_permut' contain
warnings from the lme4 model fitting of bootstrap and permutation samples, respectively.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de),
Shinichi Nakagawa (s.nakagawa@unsw.edu.au) &amp;
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Carrasco, J. L. &amp; Jover, L.  (2003) <em>Estimating the generalized 
concordance correlation coefficient through variance components</em>. Biometrics 59: 849-858.
</p>
<p>Faraway, J. J. (2006) <em>Extending the linear model with R</em>. Boca Raton, FL, Chapman &amp; Hall/CRC.
</p>
<p>Nakagawa, S. &amp; Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>


<h3>See Also</h3>

<p><a href="#topic+rpt">rpt</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BeetlesMale)

# prepare proportion data
BeetlesMale$Dark &lt;- BeetlesMale$Colour
BeetlesMale$Reddish &lt;- (BeetlesMale$Colour-1)*-1
BeetlesColour &lt;- aggregate(cbind(Dark, Reddish) ~ Treatment + Population + Container, 
     data=BeetlesMale, FUN=sum)

# Note: nboot and npermut are set to 0 for speed reasons. 

# repeatability with one grouping level
rptProportion(cbind(Dark, Reddish) ~ (1|Population), 
     grname=c("Population"), data=BeetlesColour, nboot=3, npermut=3)

# unadjusted repeatabilities with  fixed effects and 
# estimation of the fixed effect variance
rptProportion(cbind(Dark, Reddish) ~ Treatment + (1|Container) + (1|Population), 
     grname=c("Population", "Fixed"), 
     data=BeetlesColour, nboot=0, npermut=0, adjusted=FALSE)
                   
# variance estimation of random effects, residual and overdispersion 
rptProportion(cbind(Dark, Reddish) ~ Treatment + (1|Container) + (1|Population), 
     grname=c("Container","Population","Residual", "Overdispersion"), 
     data = BeetlesColour, nboot=0, npermut=0, ratio = FALSE)

</code></pre>

<hr>
<h2 id='summary.rpt'>Summary of a rpt object</h2><span id='topic+summary.rpt'></span>

<h3>Description</h3>

<p>Summary of a rpt object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rpt'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.rpt_+3A_object">object</code></td>
<td>
<p>An rpt object returned from one of the rpt functions</p>
</td></tr>
<tr><td><code id="summary.rpt_+3A_...">...</code></td>
<td>
<p>Additional arguments; none are used in this method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Holger Schielzeth  (holger.schielzeth@uni-jena.de), 
Shinichi Nakagawa (s.nakagawa@unsw.edu.au),
Martin Stoffel (martin.adam.stoffel@gmail.com)
</p>


<h3>References</h3>

<p>Nakagawa, S. and Schielzeth, H. (2010) <em>Repeatability for Gaussian and 
non-Gaussian data: a practical guide for biologists</em>. Biological Reviews 85: 935-956
</p>

<hr>
<h2 id='with_warnings'>Captures and suppresses (still to find out why) warnings of an expression</h2><span id='topic+with_warnings'></span>

<h3>Description</h3>

<p>This function is used within rptR to capture lme4 model fitting warnings in the
bootstrap and permutation procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_warnings(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_warnings_+3A_expr">expr</code></td>
<td>
<p>An expression, such as the sequence of code used by rptR to calculate
bootstrap or permutation estimates</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
