<!DOCTYPE html><html><head><title>Help for package KSgeneral</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {KSgeneral}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cont_ks_c_cdf'>
<p>Computes the complementary cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is continuous</p></a></li>
<li><a href='#cont_ks_cdf'>
<p>Computes the cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is continuous</p></a></li>
<li><a href='#cont_ks_test'>
<p>Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is continuous</p></a></li>
<li><a href='#disc_ks_c_cdf'>
<p>Computes the complementary cumulative distribution function of the two-sided Komogorov-Smirnov statistic when the cdf under the null hypothesis is purely discrete</p></a></li>
<li><a href='#disc_ks_test'>
<p>Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is purely discrete</p></a></li>
<li><a href='#ks_c_cdf_Rcpp'>
<p>R function calling directly the C++ routines that compute the complementary cumulative distribution function of the two-sided (or one-sided, as a special case) Kolmogorov-Smirnov statistic, when the cdf under the null hypothesis is arbitrary (i.e., purely discrete, mixed or continuous)</p></a></li>
<li><a href='#KSgeneral-package'>
<p>Computing P-Values of the K-S Test for (Dis)Continuous Null</p>
Distribution</a></li>
<li><a href='#mixed_ks_c_cdf'>
<p>Computes the complementary cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is mixed</p></a></li>
<li><a href='#mixed_ks_test'>
<p>Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is mixed</p></a></li>
<li><a href='#Population_Data'>
<p>The proportion of inhabitants living within a 200 kilometer wide costal strip in 232 countries in the year 2010</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Computing P-Values of the K-S Test for (Dis)Continuous Null
Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>Dimitrina S. Dimitrova &lt;D.Dimitrova@city.ac.uk&gt;,
        Yun Jia &lt;yunjia2019@gmail.com&gt;,
        Vladimir K. Kaishev &lt;Vladimir.Kaishev.1@city.ac.uk&gt; and 
        Senren Tan &lt;raymondtsrtsr@outlook.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dimitrina S. Dimitrova &lt;D.Dimitrova@city.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>fftw3 (&gt;=3.3.4)</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Copyright holders of FFTW3: Copyright (c) 2003, 2007-11
Matteo Frigo; Copyright (c) 2003, 2007-11 Massachusetts
Institute of Technology</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes a p-value of the one-sample two-sided (or one-sided, as a special case) Kolmogorov-Smirnov (KS) statistic, for any fixed critical level, and an arbitrary, possibly large sample size for a pre-specified purely discrete, mixed or continuous cumulative distribution function (cdf) under the null hypothesis. If a data sample is supplied, 'KSgeneral' computes the p-value corresponding to the value of the KS test statistic computed based on the user provided data sample. The package 'KSgeneral' implements a novel, accurate and efficient method named Exact-KS-FFT, expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using Fast Fourier Transform (FFT). The package can also be used to compute and plot the complementary cdf of the KS statistic which is known to depend on the hypothesized distribution when the latter is discontinuous (i.e. purely discrete or mixed). To cite this package in publication use: Dimitrina S. Dimitrova, Vladimir K. Kaishev, and Senren Tan. Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed, or Continuous. Journal of Statistical Software. 2020; 95(10): 1&ndash;42. &lt;<a href="https://doi.org/10.18637%2Fjss.v095.i10">doi:10.18637/jss.v095.i10</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/raymondtsr/KSgeneral">https://github.com/raymondtsr/KSgeneral</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.12), MASS, dgof</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-15 13:57:35 UTC; jy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-15 22:30:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='cont_ks_c_cdf'>
Computes the complementary cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is continuous
</h2><span id='topic+cont_ks_c_cdf'></span>

<h3>Description</h3>

<p>Computes the complementary cdf <code class="reqn">P(D_{n} \ge q) \equiv P(D_{n} &gt; q)</code> at a fixed <code class="reqn">q</code>, <code class="reqn">q\in[0, 1]</code>, for the one-sample two-sided Kolmogorov-Smirnov statistic, <code class="reqn">D_{n}</code>, for a given sample size <code class="reqn">n</code>, when the cdf <code class="reqn">F(x)</code> under the null hypothesis is continuous.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cont_ks_c_cdf(q, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cont_ks_c_cdf_+3A_q">q</code></td>
<td>

<p>numeric value between 0 and 1, at which the complementary cdf <code class="reqn">P(D_{n}\ge q)</code> is computed
</p>
</td></tr>
<tr><td><code id="cont_ks_c_cdf_+3A_n">n</code></td>
<td>

<p>the sample size
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+cont_ks_c_cdf">cont_ks_c_cdf</a></code> implements the FFT-based algorithm proposed by Moscovich and Nadler (2017) to compute the complementary cdf, <code class="reqn">P(D_{n} \ge q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is continuous.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code> which makes it more efficient and numerically stable than the algorithm proposed by Marsaglia et al. (2003).
The latter is used by many existing packages computing the cdf of <code class="reqn">D_{n}</code>, e.g., the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">stats</span> and the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">dgof</span>.
More precisely, in these packages, the exact p-value, <code class="reqn">P(D_{n} \ge q)</code> is computed only in the case when <code class="reqn">q = d_{n}</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a user provided sample <code class="reqn"> \{x_{1}, ..., x_{n} \} </code>.
Another limitation of the functions <code><a href="stats.html#topic+ks.test">ks.test</a></code> is that the sample size should be less than 100, and the computation time is <code class="reqn">O(n^{3})</code>.
In contrast, the function <code><a href="#topic+cont_ks_c_cdf">cont_ks_c_cdf</a></code> provides results with at least 10 correct digits after the decimal point for sample sizes <code class="reqn">n</code> up to 100000 and computation time of 16 seconds on a machine with an 2.5GHz Intel Core i5 processor with 4GB RAM, running MacOS X Yosemite.
For <code>n</code> &gt; 100000, accurate results can still be computed with similar accuracy, but at a higher computation time.
See Dimitrova, Kaishev, Tan (2020), Appendix C for further details and examples.
</p>


<h3>Value</h3>

<p>Numeric value corresponding to <code class="reqn">P(D_{n} \ge q)</code>.
</p>


<h3>Source</h3>

<p>Based on the C++ code available at <a href="https://github.com/mosco/crossing-probability">https://github.com/mosco/crossing-probability</a> developed by Moscovich and Nadler (2017).
See also Dimitrova, Kaishev, Tan (2020) for more details.
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Marsaglia G., Tsang WW., Wang J. (2003). &quot;Evaluating Kolmogorov's Distribution&quot;. Journal of Statistical Software, <b>8</b>(18), 1-4.
</p>
<p>Moscovich A., Nadler B. (2017). &quot;Fast Calculation of Boundary Crossing Probabilities for Poisson Processes&quot;. Statistics and Probability Letters, <b>123</b>, 177-182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute the value for P(D_{100} &gt;= 0.05)

KSgeneral::cont_ks_c_cdf(0.05, 100)


## Compute P(D_{n} &gt;= q)
## for n = 100, q = 1/500, 2/500, ..., 500/500
## and then plot the corresponding values against q

n &lt;- 100
q &lt;- 1:500/500
plot(q, sapply(q, function(x) KSgeneral::cont_ks_c_cdf(x, n)), type='l')

## Compute P(D_{n} &gt;= q) for n = 141, nq^{2} = 2.1 as shown
## in Table 18 of Dimitrova, Kaishev, Tan (2020)

KSgeneral::cont_ks_c_cdf(sqrt(2.1/141), 141)

</code></pre>

<hr>
<h2 id='cont_ks_cdf'>
Computes the cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is continuous
</h2><span id='topic+cont_ks_cdf'></span>

<h3>Description</h3>

<p>Computes the cdf <code class="reqn">P(D_{n} \le q) \equiv P(D_{n} &lt; q)</code> at a fixed <code class="reqn">q</code>, <code class="reqn">q\in[0, 1]</code>, for the one-sample two-sided Kolmogorov-Smirnov statistic, <code class="reqn">D_{n}</code>, for a given sample size <code class="reqn">n</code>, when the cdf <code class="reqn">F(x)</code> under the null hypothesis is continuous.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cont_ks_cdf(q, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cont_ks_cdf_+3A_q">q</code></td>
<td>

<p>numeric value between 0 and 1, at which the cdf <code class="reqn">P(D_{n} \le q)</code> is computed
</p>
</td></tr>
<tr><td><code id="cont_ks_cdf_+3A_n">n</code></td>
<td>

<p>the sample size
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+cont_ks_cdf">cont_ks_cdf</a></code> implements the FFT-based algorithm proposed by Moscovich and Nadler (2017) to compute the cdf <code class="reqn">P(D_{n} \le q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is continuous.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code> which makes it more efficient and numerically stable than the algorithm proposed by Marsaglia et al. (2003).
The latter is used by many existing packages computing the cdf of <code class="reqn">D_{n}</code>, e.g., the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">stats</span> and the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">dgof</span>.
More precisely, in these packages, the exact p-value, <code class="reqn">P(D_{n} \ge q)</code> is computed only in the case when <code class="reqn">q = d_{n}</code>, where <code class="reqn">d_{n}</code> is the value of the KS statistic computed based on a user provided sample <code class="reqn"> \{x_{1}, ..., x_{n} \} </code>.
Another limitation of the functions <code><a href="stats.html#topic+ks.test">ks.test</a></code> is that the sample size should be less than 100, and the computation time is <code class="reqn">O(n^{3})</code>.
In contrast, the function <code><a href="#topic+cont_ks_cdf">cont_ks_cdf</a></code> provides results with at least 10 correct digits after the decimal point for sample sizes <code class="reqn">n</code> up to 100000 and computation time of 16 seconds on a machine with an 2.5GHz Intel Core i5 processor with 4GB RAM, running MacOS X Yosemite.
For <code>n</code> &gt; 100000, accurate results can still be computed with similar accuracy, but at a higher computation time.
See Dimitrova, Kaishev, Tan (2020), Appendix B for further details and examples.
</p>


<h3>Value</h3>

<p>Numeric value corresponding to <code class="reqn">P(D_{n} \le q)</code>.
</p>


<h3>Source</h3>

<p>Based on the C++ code available at <a href="https://github.com/mosco/crossing-probability">https://github.com/mosco/crossing-probability</a> developed by Moscovich and Nadler (2017).
See also Dimitrova, Kaishev, Tan (2020) for more details.
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Marsaglia G., Tsang WW., Wang J. (2003). &quot;Evaluating Kolmogorov's Distribution&quot;. Journal of Statistical Software, <b>8</b>(18), 1-4.
</p>
<p>Moscovich A., Nadler B. (2017). &quot;Fast Calculation of Boundary Crossing Probabilities for Poisson Processes&quot;. Statistics and Probability Letters, <b>123</b>, 177-182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute the value for P(D_{100} &lt;= 0.05)

KSgeneral::cont_ks_cdf(0.05, 100)


## Compute P(D_{n} &lt;= q)
## for n = 100, q = 1/500, 2/500, ..., 500/500
## and then plot the corresponding values against q

n&lt;-100
q&lt;-1:500/500
plot(q, sapply(q, function(x) KSgeneral::cont_ks_cdf(x, n)), type='l')

## Compute P(D_{n} &lt;= q) for n = 40, nq^{2} = 0.76 as shown
## in Table 9 of Dimitrova, Kaishev, Tan (2020)

KSgeneral::cont_ks_cdf(sqrt(0.76/40), 40)

</code></pre>

<hr>
<h2 id='cont_ks_test'>
Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is continuous
</h2><span id='topic+cont_ks_test'></span>

<h3>Description</h3>

<p>Computes the p-value <code class="reqn">P(D_{n} \ge d_{n}) \equiv P(D_{n} &gt; d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, when <code class="reqn">F(x)</code> is continuous.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cont_ks_test(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cont_ks_test_+3A_x">x</code></td>
<td>

<p>a numeric vector of data sample values <code class="reqn">\{x_{1}, ..., x_{n}\}</code>.
</p>
</td></tr>
<tr><td><code id="cont_ks_test_+3A_y">y</code></td>
<td>

<p>a pre-specified continuous cdf, <code class="reqn">F(x)</code> under the null hypothesis. Note that <code>y</code> should be a character string naming a continuous cumulative distribution function such as <code><a href="stats.html#topic+pexp">pexp</a></code>, <code><a href="stats.html#topic+pnorm">pnorm</a></code>, etc.
Only continuous cdfs are valid!
</p>
</td></tr>
<tr><td><code id="cont_ks_test_+3A_...">...</code></td>
<td>

<p>values of the parameters of the cdf, <code class="reqn">F(x)</code> specified (as a character string) by <code>y</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+cont_ks_test">cont_ks_test</a></code> implements the FFT-based algorithm proposed by Moscovich and Nadler (2017) to compute the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a user provided data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, assuming <code class="reqn">F(x)</code> is continuous.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code> which makes it more efficient and numerically stable than the algorithm proposed by Marsaglia et al. (2003).
The latter is used by many existing packages computing the cdf of <code class="reqn">D_{n}</code>, e.g., the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">stats</span> and the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">dgof</span>.
A limitation of the functions <code><a href="stats.html#topic+ks.test">ks.test</a></code> is that the sample size should be less than 100, and the computation time is <code class="reqn">O(n^{3})</code>.
In contrast, the function <code><a href="#topic+cont_ks_test">cont_ks_test</a></code> provides results with at least 10 correct digits after the decimal point for sample sizes <code class="reqn">n</code> up to 100000 and computation time of 16 seconds on a machine with an 2.5GHz Intel Core i5 processor with 4GB RAM, running MacOS X Yosemite.
For <code>n</code> &gt; 100000, accurate results can still be computed with similar accuracy, but at a higher computation time.
See Dimitrova, Kaishev, Tan (2020), Appendix C for further details and examples.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>&quot;two-sided&quot;.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Based on the C++ code available at <a href="https://github.com/mosco/crossing-probability">https://github.com/mosco/crossing-probability</a> developed by Moscovich and Nadler (2017).
See also Dimitrova, Kaishev, Tan (2020) for more details.
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Moscovich A., Nadler B. (2017). &quot;Fast Calculation of Boundary Crossing Probabilities for Poisson Processes&quot;. Statistics and Probability Letters, <b>123</b>, 177-182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Comparing the p-values obtained by stat::ks.test
## and KSgeneral::cont_ks_test

x&lt;-abs(rnorm(100))
p.kt &lt;- ks.test(x, "pexp", exact = TRUE)$p
p.kt_fft &lt;- KSgeneral::cont_ks_test(x, "pexp")$p
abs(p.kt-p.kt_fft)


</code></pre>

<hr>
<h2 id='disc_ks_c_cdf'>
Computes the complementary cumulative distribution function of the two-sided Komogorov-Smirnov statistic when the cdf under the null hypothesis is purely discrete
</h2><span id='topic+disc_ks_c_cdf'></span>

<h3>Description</h3>

<p>Computes the complementary cdf, <code class="reqn">P(D_{n} \ge q)</code> at a fixed <code class="reqn">q</code>, <code class="reqn">q\in[0, 1]</code>, of the one-sample two-sided Kolmogorov-Smirnov (KS) statistic, when the cdf <code class="reqn">F(x)</code> under the null hypothesis is purely discrete, using the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
Moreover, for comparison purposes, <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code> gives, as an option, the possibility to compute (an approximate value for) the asymptotic <code class="reqn">P(D_{n} \ge q)</code> using the simulation-based algorithm of Wood and Altavela (1978).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disc_ks_c_cdf(q, n, y, ..., exact = NULL, tol = 1e-08, sim.size = 1e+06, num.sim = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disc_ks_c_cdf_+3A_q">q</code></td>
<td>

<p>numeric value between 0 and 1, at which the complementary cdf <code class="reqn">P(D_{n}\ge q)</code> is computed
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_n">n</code></td>
<td>

<p>the sample size
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_y">y</code></td>
<td>

<p>a pre-specified discrete cdf, <code class="reqn">F(x)</code> under the null hypothesis.
Note that <code>y</code> should be a step function within the class: <code><a href="stats.html#topic+stepfun">stepfun</a></code>, of which <code><a href="stats.html#topic+ecdf">ecdf</a></code> is a subclass!
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_...">...</code></td>
<td>

<p>values of the parameters of the cdf, <code class="reqn">F(x)</code>, specified (as a character string) by <code>y</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_exact">exact</code></td>
<td>

<p>logical variable specifying whether one wants to compute exact p-value <code class="reqn">P(D_{n} \ge q)</code> using the Exact-KS-FFT method, in which case <code>exact = TRUE</code> or wants to compute an approximate p-value <code class="reqn">P(D_{n} \ge q)</code> using the simulation-based algorithm of Wood and Altavela (1978), in which case <code>exact = FALSE</code>. When <code>exact = NULL</code> and <code>n &lt;= 100000</code>, the exact <code class="reqn">P(D_{n} \ge q)</code> will be computed using the Exact-KS-FFT method. Otherwise, the asymptotic complementary cdf is computed based on Wood and Altavela (1978). By default, <code>exact = NULL</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_tol">tol</code></td>
<td>

<p>the value of <code class="reqn">\epsilon</code> that is used to compute the values of <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, as detailed in Step 1 of Section 2.1 in Dimitrova, Kaishev and Tan (2020) (see also (ii) in the Procedure Exact-KS-FFT therein). By default, <code>tol = 1e-08</code>. Note that a value of <code>NA</code> or <code>0</code> will lead to an error!
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_sim.size">sim.size</code></td>
<td>

<p>the required number of simulated trajectories in order to produce one Monte Carlo estimate (one MC run) of the asymptotic complementary cdf using the algorithm of Wood and Altavela (1978). By default, <code>sim.size = 1e+06</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_c_cdf_+3A_num.sim">num.sim</code></td>
<td>

<p>the number of MC runs, each producing one estimate (based on <code>sim.size</code> number of trajectories), which are then averaged in order to produce the final estimate for the asymptotic complementary cdf. This is done in order to reduce the variance of the final estimate. By default, <code>num.sim = 10</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code> implements the Exact-KS-FFT method, proposed by Dimitrova, Kaishev, Tan (2020) to compute the complementary cdf <code class="reqn">P(D_{n} \ge q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is purely discrete.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code> which makes it more efficient and numerically stable than the only alternative algorithm developed by Arnold and Emerson (2011) and implemented as the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> in the package <span class="pkg">dgof</span>.
The latter only computes a p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, corresponding to the value of the KS test statistic <code class="reqn">d_{n}</code> computed based on a user provided sample <code class="reqn"> \{x_{1}, ..., x_{n} \} </code>.
More precisely, in the package <span class="pkg">dgof</span> (function <code><a href="stats.html#topic+ks.test">ks.test</a></code>), the p-value for a one-sample two-sided KS test is calculated by combining the approaches of Gleser (1985) and Niederhausen (1981). However, the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> only provides exact p-values for <code>n</code> <code class="reqn">\le</code> 30, since as noted by the authors (see Arnold and Emerson (2011)), when <code>n</code> is large, numerical instabilities may occur. In the latter case, <code><a href="stats.html#topic+ks.test">ks.test</a></code> uses simulation to approximate p-values, which may be rather slow and inaccurate (see Table 6 of Dimitrova, Kaishev, Tan (2020)).
</p>
<p>Thus, making use of the Exact-KS-FFT method, the function <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code> provides an exact and highly computationally efficient (alternative) way of computing <code class="reqn">P(D_{n} \ge q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is purely discrete.
</p>
<p>Lastly, incorporated into the function <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code> is the MC simulation-based method of Wood and Altavela (1978) for estimating the asymptotic complementary cdf of <code class="reqn">D_{n}</code>. The latter method is the default method behind <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code> when the sample size <code>n</code> is <code>n</code> <code class="reqn">\ge</code> 100000.
</p>


<h3>Value</h3>

<p>Numeric value corresponding to <code class="reqn">P(D_{n} \ge q)</code>.
</p>


<h3>References</h3>

<p>Arnold T.A., Emerson J.W. (2011). &quot;Nonparametric Goodness-of-Fit Tests for Discrete Null Distributions&quot;. The R Journal, <b>3</b>(2), 34-39.
</p>
<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Gleser L.J. (1985). &quot;Exact Power of Goodness-of-Fit Tests of Kolmogorov Type for Discontinuous Distributions&quot;. Journal of the American Statistical Association, <b>80</b>(392), 954-958.
</p>
<p>Niederhausen H. (1981). &quot;Sheffer Polynomials for Computing Exact Kolmogorov-Smirnov and Renyi Type Distributions&quot;. The Annals of Statistics, 58-64.
</p>
<p>Wood C.L., Altavela M.M. (1978). &quot;Large-Sample Results for Kolmogorov-Smirnov Statistics for Discrete Distributions&quot;. Biometrika, <b>65</b>(1), 235-239.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ks.test">ks.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example to compute the exact complementary cdf for D_{n}
## when the underlying cdf F(x) is a binomial(3, 0.5) distribution,
## as shown in Example 3.4 of Dimitrova, Kaishev, Tan (2020)

binom_3 &lt;- stepfun(c(0:3), c(0,pbinom(0:3,3,0.5)))
KSgeneral::disc_ks_c_cdf(0.05, 400, binom_3)

## Not run: 
## Compute P(D_{n} &gt;= q) for n = 100,
## q = 1/5000, 2/5000, ..., 5000/5000, when
## the underlying cdf F(x) is a binomial(3, 0.5) distribution,
## as shown in Example 3.4 of Dimitrova, Kaishev, Tan (2020),
## and then plot the corresponding values against q,
## i.e. plot the resulting complementary cdf of D_{n}

n &lt;- 100
q &lt;- 1:5000/5000
binom_3 &lt;- stepfun(c(0:3), c(0,pbinom(0:3,3,0.5)))
plot(q, sapply(q, function(x) KSgeneral::disc_ks_c_cdf(x, n, binom_3)), type='l')

## End(Not run)

## Not run: 
## Example to compute the asymptotic complementary cdf for D_{n}
## based on Wood and Altavela (1978),
## when the underlying cdf F(x) is a binomial(3, 0.5) distribution,
## as shown in Example 3.4 of Dimitrova, Kaishev, Tan (2020)

binom_3 &lt;- stepfun(c(0: 3), c(0, pbinom(0 : 3, 3, 0.5)))
KSgeneral::disc_ks_c_cdf(0.05, 400, binom_3, exact = FALSE, tol = 1e-08,
sim.size = 1e+06, num.sim = 10)

## End(Not run)

</code></pre>

<hr>
<h2 id='disc_ks_test'>
Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is purely discrete
</h2><span id='topic+disc_ks_test'></span>

<h3>Description</h3>

<p>Computes the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, when <code class="reqn">F(x)</code> is purely discrete, using the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disc_ks_test(x, y, ..., exact = NULL, tol = 1e-08, sim.size = 1e+06, num.sim = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disc_ks_test_+3A_x">x</code></td>
<td>

<p>a numeric vector of data sample values <code class="reqn">\{x_{1}, ..., x_{n}\}</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_y">y</code></td>
<td>

<p>a pre-specified discrete cdf, <code class="reqn">F(x)</code>, under the null hypothesis.
Note that <code>y</code> should be a step function within the class: <code><a href="stats.html#topic+stepfun">stepfun</a></code>, of which <code><a href="stats.html#topic+ecdf">ecdf</a></code> is a subclass!
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_...">...</code></td>
<td>

<p>values of the parameters of the cdf, <code class="reqn">F(x)</code>, specified (as a character string) by <code>y</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_exact">exact</code></td>
<td>

<p>logical variable specifying whether one wants to compute exact p-value <code class="reqn">P(D_{n} \ge d_{n})</code> using the Exact-KS-FFT method, in which case <code>exact = TRUE</code> or wants to compute an approximate p-value <code class="reqn">P(D_{n} \ge d_{n})</code> using the simulation-based algorithm of Wood and Altavela (1978), in which case <code>exact = FALSE</code>. When <code>exact = NULL</code> and <code>n &lt;= 100000</code>, the exact <code class="reqn">P(D_{n} \ge d_{n})</code> will be computed using the Exact-KS-FFT method. Otherwise, the asymptotic complementary cdf is computed based on Wood and Altavela (1978). By default, <code>exact = NULL</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_tol">tol</code></td>
<td>

<p>the value of <code class="reqn">\epsilon</code> that is used to compute the values of <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, as detailed in Step 1 of Section 2.1 in Dimitrova, Kaishev and Tan (2020) (see also (ii) in the Procedure Exact-KS-FFT therein). By default, <code>tol = 1e-08</code>. Note that a value of <code>NA</code> or <code>0</code> will lead to an error!
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_sim.size">sim.size</code></td>
<td>

<p>the required number of simulated trajectories in order to produce one Monte Carlo estimate (one MC run) of the asymptotic p-value using the algorithm of Wood and Altavela (1978). By default, <code>sim.size = 1e+06</code>.
</p>
</td></tr>
<tr><td><code id="disc_ks_test_+3A_num.sim">num.sim</code></td>
<td>

<p>the number of MC runs, each producing one estimate (based on <code>sim.size</code> number of trajectories), which are then averaged in order to produce the final estimate for the asymptotic p-value. This is done in order to reduce the variance of the final estimate. By default, <code>num.sim = 10</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+disc_ks_test">disc_ks_test</a></code> implements the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
It represents an accurate and fast (run time <code class="reqn">O(n^{2}log(n))</code>) alternative to the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> from the package <span class="pkg">dgof</span>, which computes a p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a user provided data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, assuming <code class="reqn">F(x)</code> is purely discrete.
</p>
<p>In the function <code><a href="stats.html#topic+ks.test">ks.test</a></code>, the p-value for a one-sample two-sided KS test is calculated by combining the approaches of Gleser (1985) and Niederhausen (1981). However, the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> due to Arnold and Emerson (2011) only provides exact p-values for <code>n</code> <code class="reqn">\le</code> 30, since as noted by the authors, when <code>n</code> is large, numerical instabilities may occur. In the latter case, <code><a href="stats.html#topic+ks.test">ks.test</a></code> uses simulation to approximate p-values, which may be rather slow and inaccurate (see Table 6 of Dimitrova, Kaishev, Tan (2020)).
</p>
<p>Thus, making use of the Exact-KS-FFT method, the function <code><a href="#topic+disc_ks_test">disc_ks_test</a></code> provides an exact and highly computationally efficient (alternative) way of computing the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, when <code class="reqn">F(x)</code> is purely discrete.
</p>
<p>Lastly, incorporated into the function <code><a href="#topic+disc_ks_test">disc_ks_test</a></code> is the MC simulation-based method of Wood and Altavela (1978) for estimating the asymptotic p-value of <code class="reqn">D_{n}</code>. The latter method is the default method behind <code><a href="#topic+disc_ks_test">disc_ks_test</a></code> when the sample size <code>n</code> is <code>n</code> <code class="reqn">\ge</code> 100000.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>&quot;two-sided&quot;.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Arnold T.A., Emerson J.W. (2011). &quot;Nonparametric Goodness-of-Fit Tests for Discrete Null Distributions&quot;. The R Journal, <b>3</b>(2), 34-39.
</p>
<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Gleser L.J. (1985). &quot;Exact Power of Goodness-of-Fit Tests of Kolmogorov Type for Discontinuous Distributions&quot;. Journal of the American Statistical Association, <b>80</b>(392), 954-958.
</p>
<p>Niederhausen H. (1981). &quot;Sheffer Polynomials for Computing Exact Kolmogorov-Smirnov and Renyi Type Distributions&quot;. The Annals of Statistics, 58-64.
</p>
<p>Wood C.L., Altavela M.M. (1978). &quot;Large-Sample Results for Kolmogorov-Smirnov Statistics for Discrete Distributions&quot;. Biometrika, <b>65</b>(1), 235-239.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ks.test">ks.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Comparison of results obtained from dgof::ks.test
# and KSgeneral::disc_ks_test, when F(x) follows the discrete
# Uniform[1, 10] distribution as in Example 3.5 of
# Dimitrova, Kaishev, Tan (2020)

# When the sample size is larger than 100, the
# function dgof::ks.test will be numerically
# unstable

x3 &lt;- sample(1:10, 25, replace = TRUE)
KSgeneral::disc_ks_test(x3, ecdf(1:10), exact = TRUE)
dgof::ks.test(x3, ecdf(1:10), exact = TRUE)
KSgeneral::disc_ks_test(x3, ecdf(1:10), exact = TRUE)$p -
          dgof::ks.test(x3, ecdf(1:10), exact = TRUE)$p

x4 &lt;- sample(1:10, 500, replace = TRUE)
KSgeneral::disc_ks_test(x4, ecdf(1:10), exact = TRUE)
dgof::ks.test(x4, ecdf(1:10), exact = TRUE)
KSgeneral::disc_ks_test(x4, ecdf(1:10), exact = TRUE)$p -
          dgof::ks.test(x4, ecdf(1:10), exact = TRUE)$p

# Using stepfun() to specify the same discrete distribution as defined by ecdf():

steps &lt;- stepfun(1:10, cumsum(c(0, rep(0.1, 10))))
KSgeneral::disc_ks_test(x3, steps, exact = TRUE)

</code></pre>

<hr>
<h2 id='ks_c_cdf_Rcpp'>
R function calling directly the C++ routines that compute the complementary cumulative distribution function of the two-sided (or one-sided, as a special case) Kolmogorov-Smirnov statistic, when the cdf under the null hypothesis is arbitrary (i.e., purely discrete, mixed or continuous)
</h2><span id='topic+ks_c_cdf_Rcpp'></span>

<h3>Description</h3>

<p>Function calling directly the C++ routines that compute the complementary cdf for the one-sample two-sided Kolmogorov-Smirnov statistic, given the sample size <code>n</code> and the file &quot;Boundary_Crossing_Time.txt&quot; in the working directory.
The latter file contains <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, specified in Steps 1 and 2 of the Exact-KS-FFT method (see Equation (5) in Section 2 of Dimitrova, Kaishev, Tan (2020)).
The latter values form the n-dimensional rectangular region for the uniform order statistics (see Equations (3), (5) and (6) in Dimitrova, Kaishev, Tan (2020)), namely
<code class="reqn">P(D_{n}\ge q) = 1 - P(A_{i} \le U_{(i)} \le B_{i}, 1 \le i \le n) = 1 - P(g(t) \le nU_{n}(t) \le h(t), 0 \le t \le 1)</code>,
where the upper and lower boundary functions <code class="reqn">h(t)</code>, <code class="reqn">g(t)</code> are defined as
<code class="reqn">h(t) = \sum_{i=1}^{n}1_{(A_{i} &lt; t)}</code>, <code class="reqn">g(t) = \sum_{i=1}^{n}1_{(B_{i} \le t)}</code>,
or equivalently, noting that <code class="reqn">h(t)</code> and <code class="reqn">g(t)</code> are correspondingly left and right continuous functions, we have
<code class="reqn">\sup\{t\in[0,1]: h(t) &lt; i \} = A_{i}</code> and <code class="reqn">\inf\{t\in[0,1]: g(t) &gt; i-1 \} = B_{i}</code>.
</p>
<p>Note that on can also compute the (complementary) cdf for the one-sided KS statistics <code class="reqn">D_{n}^{-}</code> or <code class="reqn">D_{n}^{+}</code> (cf., Dimitrova, Kaishev, Tan (2020)) by appropriately specifying correspondingly <code class="reqn">A_{i} = 0</code> for all <code class="reqn">i</code> or <code class="reqn">B_{i} = 1</code> for all <code class="reqn">i</code>, in the function <code><a href="#topic+ks_c_cdf_Rcpp">ks_c_cdf_Rcpp</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ks_c_cdf_Rcpp(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ks_c_cdf_Rcpp_+3A_n">n</code></td>
<td>

<p>the sample size
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that all calculations here are done directly in C++ and output in R.
That leads to faster computation time, as well as in some cases, possibly higher accuracy (depending on the accuracy of the pre-computed values <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, provided in the file &quot;Boundary_Crossing_Time.txt&quot;) compared to the functions <code><a href="#topic+cont_ks_c_cdf">cont_ks_c_cdf</a></code>, <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code>, <code><a href="#topic+mixed_ks_c_cdf">mixed_ks_c_cdf</a></code>.
</p>
<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
The one-sided KS test statistics are correspondingly defined as <code class="reqn">D_{n}^{-} = \sup_{x} (F(x) - F_{n}(x))</code> and <code class="reqn">D_{n}^{+} = \sup_{x} (F_{n}(x) - F(x))</code>.
</p>
<p>The function <code><a href="#topic+ks_c_cdf_Rcpp">ks_c_cdf_Rcpp</a></code> implements the Exact-KS-FFT method, proposed by Dimitrova, Kaishev, Tan (2020), to compute the complementary cdf, <code class="reqn">P(D_{n} \ge q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is arbitrary (i.e. purely discrete, mixed or continuous).
It is based on expressing the complementary cdf as

<code class="reqn">P(D_{n} \ge q) = 1 - P(A_{i} \le U_{(i)} \le B_{i}, 1 \le i \le n)</code>, where <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code> are defined as in Step 1 of Dimitrova, Kaishev, Tan (2020).
</p>
<p>The complementary cdf is then re-expressed in terms of the conditional probability that a homogeneous Poisson process, <code class="reqn">\xi_{n}(t)</code> with intensity <code class="reqn">n</code> will not cross an upper boundary <code class="reqn">h(t)</code> and a lower boundary <code class="reqn">g(t)</code>, given that <code class="reqn">\xi_{n}(1) = n</code> (see Steps 2 and 3 in Section 2.1 of Dimitrova, Kaishev, Tan (2020)). This conditional probability is evaluated using FFT in Step 4 of the method in order to obtain the value of the complementary cdf <code class="reqn">P(D_{n} \ge q)</code>.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code> which makes it highly computationally efficient compared to other known algorithms developed for the special cases of continuous or purely discrete <code class="reqn">F(x)</code>.
</p>
<p>The values <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, specified in Steps 1 and 2 of the Exact-KS-FFT method (see Dimitrova, Kaishev, Tan (2020), Section 2) must be pre-computed (in R or, if needed, using alternative softwares offering high accuracy, e.g. Mathematica) and saved in a file with the name &quot;Boundary_Crossing_Time.txt&quot; (in the current working directory).
</p>
<p>The function <code><a href="#topic+ks_c_cdf_Rcpp">ks_c_cdf_Rcpp</a></code> is called in R and it first reads the file &quot;Boundary_Crossing_Time.txt&quot; and then computes the value for the complementaty cdf
<code class="reqn">P(D_{n}\ge q) = 1 - P(A_{i} \le U_{(i)} \le B_{i}, 1 \le i \le n) = 1 - P(g(t) \le nU_{n}(t) \le h(t), 0 \le t \le 1)</code> in C++ and output in R (or as noted above, as a special case, computes the value of the complementary cdf <code class="reqn">P(D_{n}^{+} \ge q) = 1 - P(A_{i} \le U_{(i)} \le 1, 1 \le i \le n)</code> or <code class="reqn">P(D_{n}^{-} \ge q) = 1 - P(0 \le U_{(i)} \le B_{i}, 1 \le i \le n)</code>).
</p>


<h3>Value</h3>

<p>Numeric value corresponding to <code class="reqn">P(D_{n}\ge q) = 1 - P(A_{i} \le U_{(i)} \le B_{i}, 1 \le i \le n) = 1 - P(g(t) \le \eta_{n}(t) \le h(t), 0 \le t \le 1)</code> (or, as a special case, to <code class="reqn">P(D_{n}^{+} \ge q)</code> or <code class="reqn">P(D_{n}^{-} \ge q)</code>), given a sample size <code>n</code> and the file &quot;Boundary_Crossing_Time.txt&quot; containing <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, specified in Steps 1 and 2 of the Exact-KS-FFT method (see Dimitrova, Kaishev, Tan (2020), Section 2).
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Moscovich A., Nadler B. (2017). &quot;Fast Calculation of Boundary Crossing Probabilities for Poisson Processes&quot;. Statistics and Probability Letters, <b>123</b>, 177-182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Computing the complementary cdf P(D_{n} &gt;= q)
## for n = 10 and q = 0.1, when F(x) is continuous,
## In this case,
## B_i = (i-1)/n + q
## A_i =  i/n - q


n &lt;- 10
q &lt;- 0.1
up_rec &lt;- ((1:n)-1)/n + q
low_rec &lt;- (1:n)/n - q
df &lt;- data.frame(rbind(up_rec, low_rec))
write.table(df,"Boundary_Crossing_Time.txt", sep = ", ",
                  row.names = FALSE, col.names = FALSE)
ks_c_cdf_Rcpp(n)

</code></pre>

<hr>
<h2 id='KSgeneral-package'>
Computing P-Values of the K-S Test for (Dis)Continuous Null
Distribution
</h2><span id='topic+KSgeneral-package'></span>

<h3>Description</h3>

<p>The one-sample two-sided Kolmogorov-Smirnov (KS) statistic is one of the most popular goodness-of-fit test statistics that is used to measure how well the distribution of a random sample agrees with a prespecified theoretical distribution.
Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code class="reqn">n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the two-sided KS statistic is defined as
<code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of the prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn"> \{ X_{1}, ..., X_{n} \} </code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The package <span class="pkg">KSgeneral</span> implements a novel, accurate and efficient Fast Fourier Transform (FFT)-based method, referred as Exact-KS-FFT method to compute the complementary cdf,
<code class="reqn">P(D_{n} \ge q)</code>, at a fixed <code class="reqn">q\in[0, 1]</code> for a given (hypothezied) purely discrete, mixed or continuous underlying cdf <code class="reqn">F(x)</code>, and arbitrary, possibly large sample size <code class="reqn">n</code>.
A plot of the complementary cdf <code class="reqn">P(D_{n} \ge q)</code>, <code class="reqn">0 \le q \le 1</code>, can also be produced.
</p>
<p>In other words, the package computes the p-value, <code class="reqn">P(D_{n} \ge q)</code> for any fixed critical level <code class="reqn">q\in[0, 1]</code>.
If a data sample, <code class="reqn">\{x_{1}, ..., x_{n}\}</code> is supplied, <span class="pkg">KSgeneral</span> computes the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on <code class="reqn">\{x_{1}, ..., x_{n}\}</code>.
</p>
<p>Remark: The description of the package and its functions are primarily tailored to computing the (complementary) cdf of the two-sided KS statistic, <code class="reqn">D_{n}</code>.
It should be noted however that one can compute the (complementary) cdf for the one-sided KS statistics <code class="reqn">D_{n}^{-}</code> or <code class="reqn">D_{n}^{+}</code> (cf., Dimitrova, Kaishev, Tan (2020)) by appropriately specifying correspondingly <code class="reqn">A_{i} = 0</code> for all <code class="reqn">i</code> or <code class="reqn">B_{i} = 1</code> for all <code class="reqn">i</code>, in the function <code><a href="#topic+ks_c_cdf_Rcpp">ks_c_cdf_Rcpp</a></code>.
</p>


<h3>Details</h3>

<p>The Exact-KS-FFT method underlying <span class="pkg">KSgeneral</span> is based on expressing the p-value <code class="reqn">P(D_{n} \ge q)</code> in terms of an appropriate rectangle probability with respect to the uniform order statistics, as noted by Gleser (1985) for <code class="reqn">P(D_{n} &gt; q)</code>.
The latter representation is used to express <code class="reqn">P(D_{n} \ge q)</code> via a double-boundary non-crossing probability for a homogeneous Poisson process, with intensity <code class="reqn">n</code>, which is then efficiently computed using FFT, ensuring total run-time of order <code class="reqn">O(n^{2}log(n))</code> (see Dimitrova, Kaishev, Tan (2020) and also Moscovich and Nadler (2017) for the special case when <code class="reqn">F(x)</code> is continuous).
</p>
<p><span class="pkg">KSgeneral</span> represents an R wrapper of the original C++ code due to Dimitrova, Kaishev, Tan (2020) and based on the C++ code developed by Moscovich and Nadler (2017).
The package includes the functions <code><a href="#topic+disc_ks_c_cdf">disc_ks_c_cdf</a></code>, <code><a href="#topic+mixed_ks_c_cdf">mixed_ks_c_cdf</a></code> and <code><a href="#topic+cont_ks_c_cdf">cont_ks_c_cdf</a></code> that compute the complementary cdf <code class="reqn">P(D_n \ge q)</code>, for a fixed <code class="reqn">q</code>, <code class="reqn">0 \le q \le 1</code>, when <code class="reqn">F(x)</code> is purely discrete, mixed or continuous, respectively.
<span class="pkg">KSgeneral</span> includes also the functions <code><a href="#topic+disc_ks_test">disc_ks_test</a></code>, <code><a href="#topic+mixed_ks_test">mixed_ks_test</a></code> and <code><a href="#topic+cont_ks_test">cont_ks_test</a></code> that compute the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a user provided data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, when <code class="reqn">F(x)</code> is purely discrete, mixed or continuous, respectively.
</p>
<p>The functions <code><a href="#topic+disc_ks_test">disc_ks_test</a></code> and <code><a href="#topic+cont_ks_test">cont_ks_test</a></code> represent accurate and fast (run time <code class="reqn">O(n^{2}log(n))</code>) alternatives to the functions <code><a href="stats.html#topic+ks.test">ks.test</a></code> from the package <span class="pkg">dgof</span> and the function <code><a href="stats.html#topic+ks.test">ks.test</a></code> from the package <span class="pkg">stat</span>, which compute p-values of <code class="reqn">P(D_{n} \ge d_{n})</code>, assuming <code class="reqn">F(x)</code> is purely discrete or continuous, respectively.
</p>
<p>The package also includes the function <code><a href="#topic+ks_c_cdf_Rcpp">ks_c_cdf_Rcpp</a></code> which gives the flexibility to compute the complementary cdf (p-value) for the one-sided KS test statistics <code class="reqn">D_{n}^{-}</code> or <code class="reqn">D_{n}^{+}</code>.
It also allows for faster computation time and possibly higher accuracy in computing <code class="reqn">P(D_{n} \ge q)</code>.

</p>


<h3>Author(s)</h3>

<p>Dimitrina S. Dimitrova &lt;D.Dimitrova@city.ac.uk&gt;,
        Yun Jia &lt;yunjia2019@gmail.com&gt;,
        Vladimir K. Kaishev &lt;Vladimir.Kaishev.1@city.ac.uk&gt; and 
        Senren Tan &lt;raymondtsrtsr@outlook.com&gt;
</p>
<p>Maintainer: Dimitrina S. Dimitrova &lt;D.Dimitrova@city.ac.uk&gt;
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>
<p>Gleser L.J. (1985). &quot;Exact Power of Goodness-of-Fit Tests of Kolmogorov Type for Discontinuous Distributions&quot;. Journal of the American Statistical Association, <b>80</b>(392), 954-958.
</p>
<p>Moscovich A., Nadler B. (2017). &quot;Fast Calculation of Boundary Crossing Probabilities for Poisson Processes&quot;. Statistics and Probability Letters, <b>123</b>, 177-182.
</p>

<hr>
<h2 id='mixed_ks_c_cdf'>
Computes the complementary cumulative distribution function of the two-sided Kolmogorov-Smirnov statistic when the cdf under the null hypothesis is mixed
</h2><span id='topic+mixed_ks_c_cdf'></span>

<h3>Description</h3>

<p>Computes the complementary cdf, <code class="reqn">P(D_{n} \ge q)</code> at a fixed <code class="reqn">q</code>, <code class="reqn">q\in[0, 1]</code>, of the one-sample two-sided Kolmogorov-Smirnov statistic,  when the cdf <code class="reqn">F(x)</code> under the null hypothesis is mixed, using the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixed_ks_c_cdf(q, n, jump_points, Mixed_dist, ..., tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixed_ks_c_cdf_+3A_q">q</code></td>
<td>

<p>numeric value between 0 and 1, at which the complementary cdf <code class="reqn">P(D_{n} \ge q)</code> is computed
</p>
</td></tr>
<tr><td><code id="mixed_ks_c_cdf_+3A_n">n</code></td>
<td>

<p>the sample size
</p>
</td></tr>
<tr><td><code id="mixed_ks_c_cdf_+3A_jump_points">jump_points</code></td>
<td>

<p>a numeric vector containing the points of (jump) discontinuity, i.e. where the underlying cdf <code class="reqn">F(x)</code> has jump(s)
</p>
</td></tr>
<tr><td><code id="mixed_ks_c_cdf_+3A_mixed_dist">Mixed_dist</code></td>
<td>

<p>a pre-specified (user-defined) mixed cdf, <code class="reqn">F(x)</code>, under the null hypothesis.
</p>
</td></tr>
<tr><td><code id="mixed_ks_c_cdf_+3A_...">...</code></td>
<td>

<p>values of the parameters of the cdf, <code class="reqn">F(x)</code> specified (as a character string) by <code>Mixed_dist</code>.
</p>
</td></tr>
<tr><td><code id="mixed_ks_c_cdf_+3A_tol">tol</code></td>
<td>

<p>the value of <code class="reqn">\epsilon</code> that is used to compute the values of <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, as detailed in Step 1 of Section 2.1 in Dimitrova, Kaishev and Tan (2020) (see also (ii) in the Procedure Exact-KS-FFT therein). By default, <code>tol = 1e-10</code>. Note that a value of <code>NA</code> or <code>0</code> will lead to an error!
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+mixed_ks_c_cdf">mixed_ks_c_cdf</a></code> implements the Exact-KS-FFT method, proposed by Dimitrova, Kaishev, Tan (2020) to compute the complementary cdf <code class="reqn">P(D_{n} \ge q)</code> at a value <code class="reqn">q</code>, when <code class="reqn">F(x)</code> is mixed.
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code>.
</p>
<p>We have not been able to identify alternative, fast and accurate, method (software) that has been developed/implemented when the hypothesized <code class="reqn">F(x)</code> is mixed.
</p>


<h3>Value</h3>

<p>Numeric value corresponding to <code class="reqn">P(D_{n} \ge q)</code>.
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the complementary cdf of D_{n}
# when the underlying distribution is a mixed distribution
# with two jumps at 0 and log(2.5),
# as in Example 3.1 of Dimitrova, Kaishev, Tan (2020)

## Defining the mixed distribution

Mixed_cdf_example &lt;- function(x)
{
     result &lt;- 0
     if (x &lt; 0){
         result &lt;- 0
     }
     else if (x == 0){
         result &lt;- 0.5
     }
     else if (x &lt; log(2.5)){
         result &lt;- 1 - 0.5 * exp(-x)
     }
     else{
         result &lt;- 1
     }

     return (result)
 }

KSgeneral::mixed_ks_c_cdf(0.1, 25, c(0, log(2.5)), Mixed_cdf_example)


## Not run: 
## Compute P(D_{n} &gt;= q) for n = 5,
## q = 1/5000, 2/5000, ..., 5000/5000
## when the underlying distribution is a mixed distribution
## with four jumps at 0, 0.2, 0.8, 1.0,
## as in Example 2.8 of Dimitrova, Kaishev, Tan (2020)

n &lt;- 5
q &lt;- 1:5000/5000

Mixed_cdf_example &lt;- function(x)
{
  result &lt;- 0
  if (x &lt; 0){
    result &lt;- 0
  }
  else if (x == 0){
    result &lt;- 0.2
  }
  else if (x &lt; 0.2){
    result &lt;- 0.2 + x
  }
  else if (x &lt; 0.8){
    result &lt;- 0.5
  }
  else if (x &lt; 1){
    result &lt;- x - 0.1
  }
  else{
    result &lt;- 1
  }

  return (result)
}

plot(q, sapply(q, function(x) KSgeneral::mixed_ks_c_cdf(x, n,
     c(0, 0.2, 0.8, 1.0), Mixed_cdf_example)), type='l')


## End(Not run)

</code></pre>

<hr>
<h2 id='mixed_ks_test'>
Computes the p-value for a one-sample two-sided Kolmogorov-Smirnov test when the cdf under the null hypothesis is mixed
</h2><span id='topic+mixed_ks_test'></span>

<h3>Description</h3>

<p>Computes the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, when <code class="reqn">F(x)</code> is mixed, using the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixed_ks_test(x, jump_points, Mixed_dist, ..., tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixed_ks_test_+3A_x">x</code></td>
<td>

<p>a numeric vector of data sample values <code class="reqn">\{x_{1}, ..., x_{n}\}</code>.
</p>
</td></tr>
<tr><td><code id="mixed_ks_test_+3A_jump_points">jump_points</code></td>
<td>

<p>a numeric vector containing the points of (jump) discontinuity, i.e. where the underlying cdf <code class="reqn">F(x)</code> has jump(s)
</p>
</td></tr>
<tr><td><code id="mixed_ks_test_+3A_mixed_dist">Mixed_dist</code></td>
<td>

<p>a pre-specified (user-defined) mixed cdf, <code class="reqn">F(x)</code>, under the null hypothesis.
</p>
</td></tr>
<tr><td><code id="mixed_ks_test_+3A_...">...</code></td>
<td>

<p>values of the parameters of the cdf, <code class="reqn">F(x)</code> specified (as a character string) by <code>Mixed_dist</code>.
</p>
</td></tr>
<tr><td><code id="mixed_ks_test_+3A_tol">tol</code></td>
<td>

<p>the value of <code class="reqn">\epsilon</code> that is used to compute the values of <code class="reqn">A_{i}</code> and <code class="reqn">B_{i}</code>, <code class="reqn">i = 1, ..., n</code>, as detailed in Step 1 of Section 2.1 in Dimitrova, Kaishev and Tan (2020) (see also (ii) in the Procedure Exact-KS-FFT therein). By default, <code>tol = 1e-10</code>. Note that a value of <code>NA</code> or <code>0</code> will lead to an error!
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a random sample <code class="reqn">\{X_{1}, ..., X_{n}\}</code> of size <code>n</code> with an empirical cdf <code class="reqn">F_{n}(x)</code>, the Kolmogorov-Smirnov goodness-of-fit statistic is defined as <code class="reqn">D_{n} = \sup | F_{n}(x) - F(x) | </code>, where <code class="reqn">F(x)</code> is the cdf of a prespecified theoretical distribution under the null hypothesis <code class="reqn">H_{0}</code>, that <code class="reqn">\{X_{1}, ..., X_{n}\}</code> comes from <code class="reqn">F(x)</code>.
</p>
<p>The function <code><a href="#topic+mixed_ks_test">mixed_ks_test</a></code> implements the Exact-KS-FFT method expressing the p-value as a double-boundary non-crossing probability for a homogeneous Poisson process, which is then efficiently computed using FFT (see Dimitrova, Kaishev, Tan (2020)).
This algorithm ensures a total worst-case run-time of order <code class="reqn">O(n^{2}log(n))</code>.
</p>
<p>The function <code><a href="#topic+mixed_ks_test">mixed_ks_test</a></code> computes the p-value <code class="reqn">P(D_{n} \ge d_{n})</code>, where <code class="reqn">d_{n}</code> is the value of the KS test statistic computed based on a user-provided data sample <code class="reqn">\{x_{1}, ..., x_{n}\}</code>, when <code class="reqn">F(x)</code> is mixed,
</p>
<p>We have not been able to identify alternative, fast and accurate, method (software) that has been developed/implemented when the hypothesized <code class="reqn">F(x)</code> is mixed.
</p>


<h3>Value</h3>

<p>A list with class &quot;htest&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>&quot;two-sided&quot;.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to compute the p-value of the one-sample two-sided KS test,
# when the underlying distribution is a mixed distribution
# with two jumps at 0 and log(2.5),
# as in Example 3.1 of Dimitrova, Kaishev, Tan (2020)

# Defining the mixed distribution

Mixed_cdf_example &lt;- function(x)
{
     result &lt;- 0
     if (x &lt; 0){
         result &lt;- 0
     }
     else if (x == 0){
         result &lt;- 0.5
     }
     else if (x &lt; log(2.5)){
         result &lt;- 1 - 0.5 * exp(-x)
     }
     else{
         result &lt;- 1
     }

     return (result)
}
test_data &lt;- c(0,0,0,0,0,0,0.1,0.2,0.3,0.4,
            0.5,0.6,0.7,0.8,log(2.5),log(2.5),
            log(2.5),log(2.5),log(2.5),log(2.5))
KSgeneral::mixed_ks_test(test_data, c(0, log(2.5)),
                         Mixed_cdf_example)


## Compute the p-value of a two-sided K-S test
## when F(x) follows a zero-and-one-inflated
## beta distribution, as in Example 3.3
## of Dimitrova, Kaishev, Tan (2020)

## The data set is the proportion of inhabitants
## living within a 200 kilometer wide costal strip
## in 232 countries in the year 2010

data("Population_Data")
mu &lt;- 0.6189
phi &lt;- 0.6615
a &lt;- mu * phi
b &lt;- (1 - mu) * phi

Mixed_cdf_example &lt;- function(x)
{
     result &lt;- 0
     if (x &lt; 0){
         result &lt;- 0
     }
     else if (x == 0){
         result &lt;- 0.1141
     }
     else if (x &lt; 1){
         result &lt;- 0.1141 + 0.4795 * pbeta(x, a, b)
     }
     else{
         result &lt;- 1
     }

     return (result)
}
KSgeneral::mixed_ks_test(Population_Data, c(0, 1), Mixed_cdf_example)


</code></pre>

<hr>
<h2 id='Population_Data'>
The proportion of inhabitants living within a 200 kilometer wide costal strip in 232 countries in the year 2010
</h2><span id='topic+Population_Data'></span>

<h3>Description</h3>

<p>This data set contains the proportion of inhabitants living within a 200 kilometer wide costal strip in 232 countries in the year 2010.
In Example 3.3 of Dimitrova, Kaishev, Tan (2020), the data set is modelled using a zero-and-one-inflated beta distribution in the null hypothesis and a one-sample two-sided Kolmogorov-Smirnov test is performed to test whether the proposed distribution fits the data well enough.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Population_Data")</code></pre>


<h3>Format</h3>

<p>A data frame with 232 observations on the proportion of inhabitants living within a 200 kilometer wide costal strip in 2010.
</p>


<h3>Source</h3>

<p><a href="https://sedac.ciesin.columbia.edu/data/set/nagdc-population-landscape-climate-estimates-v3">https://sedac.ciesin.columbia.edu/data/set/nagdc-population-landscape-climate-estimates-v3</a>
</p>


<h3>References</h3>

<p>Dimitrina S. Dimitrova, Vladimir K. Kaishev, Senren Tan. (2020) &quot;Computing the Kolmogorov-Smirnov Distribution When the Underlying CDF is Purely Discrete, Mixed or Continuous&quot;. Journal of Statistical Software, <b>95</b>(10): 1-42. doi:10.18637/jss.v095.i10.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
