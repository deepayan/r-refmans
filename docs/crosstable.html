<!DOCTYPE html><html><head><title>Help for package crosstable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crosstable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crosstable-package'><p>crosstable: Crosstables for Descriptive Analyses</p></a></li>
<li><a href='#apply_labels'><p>Batch set variable labels</p></a></li>
<li><a href='#as_flextable.crosstable'><p>Turns a <code>crosstable</code> object into a formatted <code>flextable</code></p></a></li>
<li><a href='#as_gt.crosstable'><p>Converts a <code>crosstable</code> object into a formatted <code>gt</code> table.</p></a></li>
<li><a href='#as_workbook'><p>Converts a <code>crosstable</code> object into a formatted, savable <code>openxlsx</code> workbook.</p></a></li>
<li><a href='#body_add_crosstable'><p>Add a crosstable to an <code>officer</code> document</p></a></li>
<li><a href='#body_add_crosstable_footnote'><p>Adds a standard footnote explaining the abbreviations used in a crosstable</p></a></li>
<li><a href='#body_add_gg2'><p>Alternative to <code>officer::body_add_gg()</code> which uses <code>ggplot</code> syntax</p></a></li>
<li><a href='#body_add_img2'><p>Alternative to <code>officer::body_add_img()</code> which adds a <code>units</code> choice</p></a></li>
<li><a href='#body_add_legend'><p>Add a legend to a table or a figure</p></a></li>
<li><a href='#body_add_list'><p>Add a list to an <code>officer</code> document</p></a></li>
<li><a href='#body_add_normal'><p>Add a new paragraph with default style</p></a></li>
<li><a href='#body_add_table_list'><p>Add a list of tables</p></a></li>
<li><a href='#body_add_table_section'><p>Add a section with a table and its legend</p></a></li>
<li><a href='#body_add_title'><p>Add a title to an <code>officer</code> document</p></a></li>
<li><a href='#body_replace_text_at_bkms'><p>Replace text on several bookmarks at once</p></a></li>
<li><a href='#clean_names_with_labels'><p>Cleans names of a dataframe while retaining old names as labels</p></a></li>
<li><a href='#confint_numeric'><p>Confidence interval of a numeric vector</p></a></li>
<li><a href='#cross_summary'><p>Summarize a numeric vector</p></a></li>
<li><a href='#crosstable'><p>Easily describe datasets</p></a></li>
<li><a href='#crosstable_effect_args'><p>Default arguments for calculating and displaying effects in <code>crosstable()</code></p></a></li>
<li><a href='#crosstable_options'><p>Options for the package <code>crosstable</code></p></a></li>
<li><a href='#crosstable_peek_options'><p>See which <code>crosstable</code> option is currently set.</p></a></li>
<li><a href='#crosstable_reset_options'><p>Reset all <code>crosstable</code> options.</p></a></li>
<li><a href='#crosstable_test_args'><p>Default arguments for calculating and displaying tests in <code>crosstable()</code></p></a></li>
<li><a href='#ct_compact'><p>Generic function to compact a table (publication formatting)</p></a></li>
<li><a href='#display_effect'><p>Default function to display the effect</p></a></li>
<li><a href='#display_test'><p>Default function to display a test result</p></a></li>
<li><a href='#docx_bookmarks2'><p>List Word bookmarks, including the ones in header and footer</p></a></li>
<li><a href='#effect_summary'><p>Effect measure for association between one continuous and one categorical variable</p></a></li>
<li><a href='#effect_survival'><p>Effect measure for association between one censored variable and one categorical variable</p></a></li>
<li><a href='#effect_tabular'><p>Effect measure for association between two categorical variables</p></a></li>
<li><a href='#format_fixed'><p>Format numbers with the exact same number of decimals, including trailing zeros</p></a></li>
<li><a href='#generate_autofit_macro'><p>Generate a macro file for autofitting</p></a></li>
<li><a href='#get_label'><p>Get label if wanted and available, or default (name) otherwise</p></a></li>
<li><a href='#get_percent_pattern'><p>Percent pattern helper</p></a></li>
<li><a href='#import_labels'><p>Import labels</p></a></li>
<li><a href='#iris2'><p>Modified <code>iris</code> dataset</p></a></li>
<li><a href='#is.crosstable'><p>Test if an object is a crosstable</p></a></li>
<li><a href='#mtcars2'><p>Modified <code>mtcars</code> dataset</p></a></li>
<li><a href='#N'><p>Return the number of non NA observations</p></a></li>
<li><a href='#na'><p>Return the number of NA observations</p></a></li>
<li><a href='#narm'><p>Remove missing values</p></a></li>
<li><a href='#peek'><p>Open a <code>crosstable</code> in a temporary document</p></a></li>
<li><a href='#pivot_crosstable'><p>Pivot a crosstable</p></a></li>
<li><a href='#plim'><p>Format p values (alternative to <code>format.pval()</code>)</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#remove_labels'><p>Remove all label attributes.</p></a></li>
<li><a href='#rename_with_labels'><p>Rename every column of a dataframe with its label</p></a></li>
<li><a href='#set_label'><p>Set the &quot;label&quot; attribute of an object</p></a></li>
<li><a href='#summaryFunctions'><p>Summary functions</p></a></li>
<li><a href='#test_correlation_auto'><p>test for correlation coefficients</p></a></li>
<li><a href='#test_summarize_auto'><p>test for mean comparison</p></a></li>
<li><a href='#test_summarize_linear_contrasts'><p>Test for linear trend across ordered factor with contrasts</p></a></li>
<li><a href='#test_survival_logrank'><p>test for survival comparison</p></a></li>
<li><a href='#test_tabular_auto'><p>test for contingency table</p></a></li>
<li><a href='#transpose_crosstable'><p>Transpose a crosstable</p></a></li>
<li><a href='#write_and_open'><p>Alternative to default <code>officer</code> print() function. Write the file and try to open it right away.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Crosstables for Descriptive Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Create descriptive tables for continuous and categorical variables. 
    Apply summary statistics and counting function, with or without a grouping variable, and create beautiful reports using 'rmarkdown' or 'officer'.
    You can also compute effect sizes and statistical tests if needed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://danchaltiel.github.io/crosstable/">https://danchaltiel.github.io/crosstable/</a>,
<a href="https://github.com/DanChaltiel/crosstable/">https://github.com/DanChaltiel/crosstable/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DanChaltiel/crosstable/issues/">https://github.com/DanChaltiel/crosstable/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 1.9.0), cli (&ge; 3.0.0), dplyr (&ge; 1.1.0),
flextable (&ge; 0.5.1), forcats (&ge; 1.0.0), glue (&ge; 1.3.0),
lifecycle (&ge; 0.2.0), methods, officer (&ge; 0.4.0), purrr (&ge;
0.2.3), rlang (&ge; 1.0.0), stats, stringr (&ge; 1.4.0), tibble (&ge;
1.1), tidyr (&ge; 1.0.0), utils,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>callr, covr, crayon, xml2, digest, gt, expss, ggplot2,
gmodels, Hmisc, hms, jsonlite, knitr, lubridate, openxlsx,
rmarkdown, sloop, stringi, survival, systemfonts, tidyselect,
testthat (&ge; 3.0.0), withr, waldo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>by_factor , effects, officer</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-12 20:13:56 UTC; Dan</td>
</tr>
<tr>
<td>Author:</td>
<td>Dan Chaltiel <a href="https://orcid.org/0000-0003-3488-779X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  David Hajage [ccp]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dan Chaltiel &lt;dan.chaltiel@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-12 20:43:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='crosstable-package'>crosstable: Crosstables for Descriptive Analyses</h2><span id='topic+crosstable-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Create descriptive tables for continuous and categorical variables. Apply summary statistics and counting function, with or without a grouping variable, and create beautiful reports using 'rmarkdown' or 'officer'. You can also compute effect sizes and statistical tests if needed.
</p>


<h3>Details</h3>

<p>The <code>crosstable</code>package is centered on the <code><a href="#topic+crosstable">crosstable()</a></code>' function.
See vignettes for more information.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dan Chaltiel <a href="mailto:dan.chaltiel@gmail.com">dan.chaltiel@gmail.com</a> (<a href="https://orcid.org/0000-0003-3488-779X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> David Hajage [conceptor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://danchaltiel.github.io/crosstable/">https://danchaltiel.github.io/crosstable/</a>
</p>
</li>
<li> <p><a href="https://github.com/DanChaltiel/crosstable/">https://github.com/DanChaltiel/crosstable/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/DanChaltiel/crosstable/issues/">https://github.com/DanChaltiel/crosstable/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='apply_labels'>Batch set variable labels</h2><span id='topic+apply_labels'></span>

<h3>Description</h3>

<p>This function is a copycat of from expss package v0.10.7 (slightly modified) to avoid having to depend on expss. See <code><a href="expss.html#topic+apply_labels">expss::apply_labels()</a></code> for more documentation. Note that this version is not compatible with <code>data.table</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_labels(data, ..., warn_missing = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_labels_+3A_data">data</code></td>
<td>
<p>data.frame/list</p>
</td></tr>
<tr><td><code id="apply_labels_+3A_...">...</code></td>
<td>
<p>named arguments</p>
</td></tr>
<tr><td><code id="apply_labels_+3A_warn_missing">warn_missing</code></td>
<td>
<p>if TRUE, throw a warning if some names are missing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as <code>data</code>, with labels
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iris %&gt;%
  apply_labels(Sepal.Length="Length of Sepal",
               Sepal.Width="Width of Sepal") %&gt;%
  crosstable()
</code></pre>

<hr>
<h2 id='as_flextable.crosstable'>Turns a <code>crosstable</code> object into a formatted <code>flextable</code></h2><span id='topic+as_flextable.crosstable'></span><span id='topic+ctf'></span><span id='topic+cross_to_flextable'></span><span id='topic+to_flextable'></span><span id='topic+as_flextable'></span><span id='topic+af'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>flextable</dt><dd><p><code><a href="flextable.html#topic+as_flextable">as_flextable</a></code></p>
</dd>
</dl>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crosstable'
as_flextable(
  x,
  keep_id = FALSE,
  by_header = NULL,
  autofit = TRUE,
  compact = FALSE,
  show_test_name = TRUE,
  fontsizes = list(body = 11, subheaders = 11, header = 11),
  padding_v = NULL,
  remove_header_keys = FALSE,
  header_show_n = FALSE,
  header_show_n_pattern = "{.col} (N={.n})",
  generic_labels = list(id = ".id", variable = "variable", value = "value", total =
    "Total", label = "label", test = "test", effect = "effect"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_flextable.crosstable_+3A_x">x</code></td>
<td>
<p>the result of <code><a href="#topic+crosstable">crosstable()</a></code>.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_keep_id">keep_id</code></td>
<td>
<p>whether to keep the <code>.id</code> column.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_by_header">by_header</code></td>
<td>
<p>a string to override the header if <code>x</code> has only one <code>by</code> stratum.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_autofit">autofit</code></td>
<td>
<p>whether to use <code><a href="flextable.html#topic+autofit">flextable::autofit()</a></code> on the table.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_compact">compact</code></td>
<td>
<p>whether to compact the table. If <code>TRUE</code>, see <code><a href="#topic+ct_compact.crosstable">ct_compact.crosstable()</a></code> to see how to use <code>keep_id</code>.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_show_test_name">show_test_name</code></td>
<td>
<p>in the <code>test</code> column, show the test name.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_fontsizes">fontsizes</code></td>
<td>
<p>font sizes as a list of keys. Default to <code>list(body=11, subheaders=11, header=11)</code>. If set through arguments instead of options, all 3 names should be specified.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_padding_v">padding_v</code></td>
<td>
<p>vertical padding (body).</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_remove_header_keys">remove_header_keys</code></td>
<td>
<p>if <code>TRUE</code> and <code>x</code> has several <code>by</code> strata, header will only display values.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_header_show_n">header_show_n</code></td>
<td>
<p>numeric vector telling on which depth the group size should be indicated in the header. You can control the pattern using option <code>crosstable_options</code>. See <code><a href="#topic+crosstable_options">crosstable_options()</a></code> for details about it. See example for use case.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_header_show_n_pattern">header_show_n_pattern</code></td>
<td>
<p>glue pattern used when <code>header_show_n==TRUE</code>. <code>.col</code> is the name of the column and <code>.n</code> the size of the group. Default to <code>{.col} (N={.n})</code>; you can also use <code>{.col_key}</code> and <code>{.col_val}</code> when <code>by</code> has multiple stratum. To control the &quot;Total&quot; column, enter this as a <code>list</code> with names &quot;cell&quot; and &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_generic_labels">generic_labels</code></td>
<td>
<p>names of the crosstable default columns. Useful for translation for instance.</p>
</td></tr>
<tr><td><code id="as_flextable.crosstable_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a flextable.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>as_flextable(crosstable)</code>: Turns a <code>crosstable</code> object into a formatted <code>flextable</code>.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crosstable">crosstable()</a></code>, <code><a href="flextable.html#topic+flextable">flextable::flextable()</a></code>, <code><a href="#topic+as_gt.crosstable">as_gt.crosstable()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Crosstables
library(crosstable)
library(dplyr)
crosstable_options(crosstable_fontsize_header=14,
                   crosstable_fontsize_subheaders=10,
                   crosstable_fontsize_body=8)
crosstable(iris) %&gt;% as_flextable()
crosstable(mtcars2, -model, by=c(am, vs)) %&gt;% as_flextable(header_show_n=1:2)
crosstable(mtcars2, cols=c(mpg, cyl), by=am, effect=TRUE) %&gt;%
   as_flextable(keep_id=TRUE, autofit=FALSE)
crosstable(mtcars2, cols=c(mpg, cyl), by=am, effect=TRUE, total=TRUE) %&gt;%
   as_flextable(compact=TRUE, header_show_n=TRUE,
                header_show_n_pattern=list(cell="{.col} (N={.n})", total="Total\n(N={.n})"))

#Renaming (because why not?)
crosstable(mtcars2, am, by=vs, total="both", test=TRUE, effect=TRUE) %&gt;%
   rename(ID=.id, math=variable, Tot=Total, lab=label, pval=test, fx=effect) %&gt;%
   as_flextable(by_header = "Engine shape",
                generic_labels=list(id = "ID", variable = "math", total="Tot",
                                    label = "lab", test = "pval", effect="fx"))
</code></pre>

<hr>
<h2 id='as_gt.crosstable'>Converts a <code>crosstable</code> object into a formatted <code>gt</code> table.</h2><span id='topic+as_gt.crosstable'></span><span id='topic+as_gt'></span><span id='topic+as_gt.default'></span>

<h3>Description</h3>

<p>Converts a <code>crosstable</code> object into a formatted <code>gt</code> table.
</p>
<p>Method to convert an object to a <code>gt</code> table
</p>
<p>Default method to convert an object to a <code>gt</code> table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'crosstable'
as_gt(
  x,
  show_test_name = TRUE,
  by_header = NULL,
  keep_id = FALSE,
  generic_labels = list(id = ".id", variable = "variable", value = "value", total =
    "Total", label = "label", test = "test", effect = "effect"),
  ...
)

as_gt(x, ...)

## Default S3 method:
as_gt(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_gt.crosstable_+3A_x">x</code></td>
<td>
<p>object to be converted</p>
</td></tr>
<tr><td><code id="as_gt.crosstable_+3A_show_test_name">show_test_name</code></td>
<td>
<p>in the <code>test</code> column, show the test name</p>
</td></tr>
<tr><td><code id="as_gt.crosstable_+3A_by_header">by_header</code></td>
<td>
<p>a string to override the <code>by</code> header</p>
</td></tr>
<tr><td><code id="as_gt.crosstable_+3A_keep_id">keep_id</code></td>
<td>
<p>whether to keep the <code>.id</code> column</p>
</td></tr>
<tr><td><code id="as_gt.crosstable_+3A_generic_labels">generic_labels</code></td>
<td>
<p>names of the crosstable default columns</p>
</td></tr>
<tr><td><code id="as_gt.crosstable_+3A_...">...</code></td>
<td>
<p>arguments for custom methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a formatted <code>gt</code> table
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>as_gt(crosstable)</code>: For crosstables
</p>
</li>
<li> <p><code>as_gt(default)</code>: default function
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_flextable.crosstable">as_flextable.crosstable()</a></code>
</p>
<p><code><a href="gt.html#topic+gt">gt::gt()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx = mtcars2 %&gt;% dplyr::select(2:10)
crosstable(xx) %&gt;% as_gt
crosstable(xx, by=am) %&gt;% as_gt
crosstable(xx, by=cyl, test=TRUE, total=TRUE) %&gt;%
   as_gt(keep_id=TRUE, show_test_name=FALSE, by_header="Cylinders")
</code></pre>

<hr>
<h2 id='as_workbook'>Converts a <code>crosstable</code> object into a formatted, savable <code>openxlsx</code> workbook.</h2><span id='topic+as_workbook'></span>

<h3>Description</h3>

<p>Converts a <code>crosstable</code> object into a formatted, savable <code>openxlsx</code> workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_workbook(
  x,
  show_test_name = TRUE,
  by_header = NULL,
  keep_id = FALSE,
  generic_labels = list(id = ".id", variable = "variable", value = "value", total =
    "Total", label = "label", test = "test", effect = "effect"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_workbook_+3A_x">x</code></td>
<td>
<p>the result of <code><a href="#topic+crosstable">crosstable()</a></code> or a list of crosstables</p>
</td></tr>
<tr><td><code id="as_workbook_+3A_show_test_name">show_test_name</code></td>
<td>
<p>in the <code>test</code> column, show the test name</p>
</td></tr>
<tr><td><code id="as_workbook_+3A_by_header">by_header</code></td>
<td>
<p>a string to override the <code>by</code> header</p>
</td></tr>
<tr><td><code id="as_workbook_+3A_keep_id">keep_id</code></td>
<td>
<p>whether to keep the <code>.id</code> column</p>
</td></tr>
<tr><td><code id="as_workbook_+3A_generic_labels">generic_labels</code></td>
<td>
<p>names of the crosstable default columns</p>
</td></tr>
<tr><td><code id="as_workbook_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>openxlsx</code> workbook containing the crosstable(s)
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(openxlsx)
target = tempfile(fileext=".xlsx")

x=crosstable(mtcars2, c(mpg, vs, gear), total=TRUE, test=TRUE)
as_workbook(x, keep_id=TRUE) %&gt;%
    saveWorkbook(file=target)
if(interactive()) browseURL(target)

target = tempfile(fileext=".xlsx")
x2=list(iris=crosstable(iris2), crosstable(mtcars2))
as_workbook(x2, keep_id=TRUE) %&gt;%
    saveWorkbook(file=target)
if(interactive()) browseURL(target)
</code></pre>

<hr>
<h2 id='body_add_crosstable'>Add a crosstable to an <code>officer</code> document</h2><span id='topic+body_add_crosstable'></span>

<h3>Description</h3>

<p><code><a href="#topic+body_add_crosstable">body_add_crosstable()</a></code> adds such a <code>flextable</code> an <code>officer</code> document.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_crosstable(
  doc,
  x,
  body_fontsize = NULL,
  header_fontsize = ceiling(body_fontsize * 1.2),
  padding_v = NULL,
  allow_break = TRUE,
  max_cols = 25,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_crosstable_+3A_doc">doc</code></td>
<td>
<p>a <code>rdocx</code> object, created by <code><a href="officer.html#topic+read_docx">officer::read_docx()</a></code></p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_x">x</code></td>
<td>
<p>a <code>crosstable</code> object</p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_body_fontsize">body_fontsize</code></td>
<td>
<p>fontsize of the body</p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_header_fontsize">header_fontsize</code></td>
<td>
<p>fontsize of the header. Defaults to <code>1.2*body_fontsize</code>.</p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_padding_v">padding_v</code></td>
<td>
<p>vertical padding of all table rows</p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_allow_break">allow_break</code></td>
<td>
<p>allow crosstable rows to break across pages</p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_max_cols">max_cols</code></td>
<td>
<p>max number of columns for <code>x</code></p>
</td></tr>
<tr><td><code id="body_add_crosstable_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+as_flextable.crosstable">as_flextable.crosstable()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Officer
library(officer)
mytable = crosstable(mtcars2)
doc = read_docx() %&gt;%
    body_add_crosstable(mytable) %&gt;%
    body_add_break %&gt;%
    body_add_crosstable(mytable, compact=TRUE)

dfile = tempfile(fileext=".docx")
print(doc, target = dfile)
if(interactive()) browseURL(dfile)
</code></pre>

<hr>
<h2 id='body_add_crosstable_footnote'>Adds a standard footnote explaining the abbreviations used in a crosstable</h2><span id='topic+body_add_crosstable_footnote'></span>

<h3>Description</h3>

<p>Use it below <code><a href="#topic+body_add_crosstable">body_add_crosstable()</a></code>.
Footnote: Med: median, IQR: interquartile range, Std: standard deviation. Percentages are expressed in column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_crosstable_footnote(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_crosstable_footnote_+3A_doc">doc</code></td>
<td>
<p>a <code>rdocx</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='body_add_gg2'>Alternative to <code><a href="officer.html#topic+body_add_gg">officer::body_add_gg()</a></code> which uses <code>ggplot</code> syntax</h2><span id='topic+body_add_gg2'></span>

<h3>Description</h3>

<p>Alternative to <code><a href="officer.html#topic+body_add_gg">officer::body_add_gg()</a></code> which uses <code>ggplot</code> syntax
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_gg2(
  doc,
  value,
  width = 6,
  height = 5,
  units = getOption("crosstable_units", "in"),
  style = getOption("crosstable_style_image", doc$default_styles$paragraph),
  res = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_gg2_+3A_doc">doc</code></td>
<td>
<p>an <code>rdocx</code> object</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_value">value</code></td>
<td>
<p>ggplot object</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_width">width</code>, <code id="body_add_gg2_+3A_height">height</code></td>
<td>
<p>width and height. Can be abbreviated to w and h.</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_units">units</code></td>
<td>
<p>units for width and height</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_style">style</code></td>
<td>
<p>paragraph style</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_res">res</code></td>
<td>
<p>resolution of the png image in ppi (passed to the argument <code>dpi</code> of <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code>)</p>
</td></tr>
<tr><td><code id="body_add_gg2_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
library(ggplot2)
p = ggplot(data=iris, aes(Sepal.Length, Petal.Length)) + geom_point()
crosstable_options(
  units="cm",
  style_image="centered"
)
doc = read_docx() %&gt;%
 body_add_normal("Text before") %&gt;%
 body_add_gg2(p, w=14, h=10, scale=1.5) %&gt;% #or units="cm" instead of using options
 body_add_normal("Text after")
write_and_open(doc)
</code></pre>

<hr>
<h2 id='body_add_img2'>Alternative to <code><a href="officer.html#topic+body_add_img">officer::body_add_img()</a></code> which adds a <code>units</code> choice</h2><span id='topic+body_add_img2'></span>

<h3>Description</h3>

<p>Alternative to <code><a href="officer.html#topic+body_add_img">officer::body_add_img()</a></code> which adds a <code>units</code> choice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_img2(
  doc,
  src,
  width,
  height,
  units = getOption("crosstable_units", "in"),
  style = getOption("crosstable_style_image", doc$default_styles$paragraph),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_img2_+3A_doc">doc</code></td>
<td>
<p>an <code>rdocx</code> object</p>
</td></tr>
<tr><td><code id="body_add_img2_+3A_src">src</code></td>
<td>
<p>image filename, the basename of the file must not contain any blank.</p>
</td></tr>
<tr><td><code id="body_add_img2_+3A_width">width</code>, <code id="body_add_img2_+3A_height">height</code></td>
<td>
<p>width and height. Can be abbreviated to w and h.</p>
</td></tr>
<tr><td><code id="body_add_img2_+3A_units">units</code></td>
<td>
<p>units for width and height</p>
</td></tr>
<tr><td><code id="body_add_img2_+3A_style">style</code></td>
<td>
<p>paragraph style</p>
</td></tr>
<tr><td><code id="body_add_img2_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code><a href="officer.html#topic+body_add_img">officer::body_add_img()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+body_add_gg2">body_add_gg2()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img.file = file.path( R.home("doc"), "html", "logo.jpg" )
if(file.exists(img.file)){
    library(officer)
    options(crosstable_units="cm")
    doc = read_docx() %&gt;%
        body_add_normal("This is the R logo.") %&gt;%
        body_add_img2(img.file, h=7.6, w=10, style="centered") #or units="cm" without options
    #write_and_open(doc)
}
</code></pre>

<hr>
<h2 id='body_add_legend'>Add a legend to a table or a figure</h2><span id='topic+body_add_legend'></span><span id='topic+body_add_table_legend'></span><span id='topic+body_add_figure_legend'></span>

<h3>Description</h3>

<p>Add a legend to a table or a figure in an <code>officer</code> document. Legends can be referred to using the <code style="white-space: pre;">&#8288;@ref&#8288;</code> syntax in <code><a href="#topic+body_add_normal">body_add_normal()</a></code> (see examples for some use cases). Table legends should be inserted before the table while figure legends should be inserted after the figure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_table_legend(
  doc,
  legend,
  ...,
  bookmark = NULL,
  legend_style = getOption("crosstable_style_legend", doc$default_styles$paragraph),
  style = deprecated(),
  legend_prefix = NULL,
  name_format = NULL,
  legend_name = "Table",
  seqfield = "SEQ Table \\* Arabic",
  par_before = FALSE,
  legacy = FALSE
)

body_add_figure_legend(
  doc,
  legend,
  ...,
  bookmark = NULL,
  legend_style = getOption("crosstable_style_legend", doc$default_styles$paragraph),
  style = deprecated(),
  legend_prefix = NULL,
  name_format = NULL,
  legend_name = "Figure",
  seqfield = "SEQ Figure \\* Arabic",
  par_after = FALSE,
  legacy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_legend_+3A_doc">doc</code></td>
<td>
<p>a docx object</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_legend">legend</code></td>
<td>
<p>the table legend. Supports <code>glue</code> syntax and markdown syntax (see Section below).</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_bookmark">bookmark</code></td>
<td>
<p>the id of the bookmark. This is the id that should then be called in <code><a href="#topic+body_add_normal">body_add_normal()</a></code> using the <code>"\\@ref(id)"</code> syntax. Forbidden characters will be removed.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_legend_style">legend_style</code></td>
<td>
<p>style of of the whole legend. May depend on the docx template. However, if <code>name_format</code> is provided with a specific <code>font.size</code>, this size will apply to the whole legend for consistency.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_style">style</code></td>
<td>
<p>deprecated in favor of <code>name_format</code>.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_legend_prefix">legend_prefix</code></td>
<td>
<p>a prefix that comes before the legend, after the numbering</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_name_format">name_format</code></td>
<td>
<p>format of the legend's LHS (legend_name + numbering) using <code><a href="officer.html#topic+fp_text">officer::fp_text_lite()</a></code> or <code><a href="officer.html#topic+fp_text">officer::fp_text()</a></code>. Default to <code>fp_text_lite(bold=TRUE)</code> in addition to the format defined in <code>legend_style</code>. Note that the reference to the bookmark will have the same specific format in the text.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_legend_name">legend_name</code></td>
<td>
<p>name before the numbering. Default to either &quot;Table&quot; or &quot;Figure&quot;.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_seqfield">seqfield</code></td>
<td>
<p>Keep default. Otherwise, you may figure it out doing this: in a docx file, insert a table legend, right click on the inserted number and select &quot;Toggle Field Codes&quot;. This argument should be the value of the field, with extra escaping.</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_par_before">par_before</code>, <code id="body_add_legend_+3A_par_after">par_after</code></td>
<td>
<p>should an empty paragraph be inserted before/after the legend?</p>
</td></tr>
<tr><td><code id="body_add_legend_+3A_legacy">legacy</code></td>
<td>
<p>use the old version of this function, if you cannot update <code>{officer}</code> to v0.4+</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Warning</h3>

<p>Be aware that you unfortunately cannot reference a bookmark more than once using this method. Writing: <br /> <code>body_add_normal("Table \\@ref(iris_col1) is about flowers. I really like Table \\@ref(iris_col1).")</code><br />
will prevent the numbering from applying.
</p>


<h3>What to do if there is still no numbering?</h3>

<p>During the opening of the document, MS Word might ask you to &quot;update the fields&quot;, to which you should answer &quot;Yes&quot;.  <br />
If it is not asked or if you answer &quot;No&quot;, the legends added with <code><a href="#topic+body_add_table_legend">body_add_table_legend()</a></code> or <code><a href="#topic+body_add_figure_legend">body_add_figure_legend()</a></code> might have no actual numbers displayed. <br />
In this case, you have to manually update the references in MS Word: select all (<kbd>Ctrl</kbd>+<kbd>A</kbd>), then update (<kbd>F9</kbd>), sometimes twice. More info on <a href="https://ardata-fr.github.io/officeverse/faq.html#update-fields">https://ardata-fr.github.io/officeverse/faq.html#update-fields</a>.
</p>


<h3>Markdown support</h3>

<p>In all <code>crosstable</code> helpers for <code>officer</code>, you can use the following Markdown syntax to format your text:
</p>

<ul>
<li> <p><em>bold</em>: <code>"**text in bold**"</code>
</p>
</li>
<li><p> *italics: <code>"*text in italics*"</code>
</p>
</li>
<li> <p><em>subscript</em>: <code>"Text in ~subscript~"</code>
</p>
</li>
<li> <p><em>superscript</em>: <code>"Text in ^superscript^"</code>
</p>
</li>
<li> <p><em>newline</em>: <code style="white-space: pre;">&#8288;Before &lt;br&gt; After&#8288;</code>
</p>
</li>
<li> <p><em>color</em>: <code>"&lt;color:red&gt;red text&lt;/color&gt;"</code>
</p>
</li>
<li> <p><em>shade</em>: <code>"&lt;shade:yellow&gt;yellow text&lt;/shade&gt;"</code> (background color)
</p>
</li>
<li> <p><em>font family</em>: <code>"&lt;ff:symbol&gt;symbol&lt;/ff&gt;"</code> (
</p>
</li></ul>

<p>Note that the font name depends on your system language. For instant, in French, it would be <code>Symbol</code> with an uppercase first letter.
</p>
<p>See the last example of <code><a href="#topic+body_add_normal">body_add_normal()</a></code> for a practical case.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
library(ggplot2)
p = ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width, color=Species)) + geom_point()
fp_italic = fp_text_lite(italic=TRUE, font.size=10)
x = read_docx() %&gt;%
    body_add_normal("There is Table \\@ref(iris_col1) and Table \\@ref(iris_col2). ",
                    "The `iris` dataset is about flowers.") %&gt;%
    body_add_normal() %&gt;%
    body_add_table_legend("Iris dataset, column 1 (mean={round(mean(iris[[1]]), 2)})",
                           bookmark="iris_col1") %&gt;%
    body_add_crosstable(crosstable(iris[1])) %&gt;%
    body_add_normal() %&gt;%
    body_add_table_legend("Iris dataset, column 2 (mean={round(mean(iris[[2]]), 2)})",
                          bookmark="iris_col2",
                          name_format=fp_italic, legend_style="Balloon Text") %&gt;%
    body_add_crosstable(crosstable(iris[2])) %&gt;%
    body_add_normal() %&gt;%
    body_add_normal("There is also the figure \\@ref(iris_fig)") %&gt;%
    body_add_gg(p) %&gt;%
    body_add_figure_legend("Iris plot", bookmark="iris_fig")
write_and_open(x)
#If asked to update fields, press "Yes". Otherwise press Ctrl+A then F9 twice for the references
#to appear.
</code></pre>

<hr>
<h2 id='body_add_list'>Add a list to an <code>officer</code> document</h2><span id='topic+body_add_list'></span><span id='topic+body_add_list_item'></span>

<h3>Description</h3>

<p>Add a list to an <code>officer</code> document
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_list(doc, value, ordered = FALSE, style = NULL, ...)

body_add_list_item(doc, value, ordered = FALSE, style = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_list_+3A_doc">doc</code></td>
<td>
<p>a docx object</p>
</td></tr>
<tr><td><code id="body_add_list_+3A_value">value</code></td>
<td>
<p>a character vector (<code>body_add_list()</code>) or scalar (<code>body_add_list_item</code>). See Section below for markdown support.</p>
</td></tr>
<tr><td><code id="body_add_list_+3A_ordered">ordered</code></td>
<td>
<p>if <code>TRUE</code>, adds an ordered list, if <code>FALSE</code> (default), adds a bullet list</p>
</td></tr>
<tr><td><code id="body_add_list_+3A_style">style</code></td>
<td>
<p>specify the style manually, overriding <code>ordered</code>. A better way is to set options <code>crosstable_style_list_ordered</code> and <code>crosstable_style_list_unordered</code> globally.</p>
</td></tr>
<tr><td><code id="body_add_list_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="officer.html#topic+body_add_par">officer::body_add_par()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ordered lists and bullet lists are not supported by the default officer template (see <a href="#262">https://github.com/davidgohel/officer/issues/262</a>). You have to manually set custom styles matching those list in a custom Word template file. Then, you can use either the <code>style</code> argument or crosstable options. See examples for more details.
</p>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Markdown support</h3>

<p>In all <code>crosstable</code> helpers for <code>officer</code>, you can use the following Markdown syntax to format your text:
</p>

<ul>
<li> <p><em>bold</em>: <code>"**text in bold**"</code>
</p>
</li>
<li><p> *italics: <code>"*text in italics*"</code>
</p>
</li>
<li> <p><em>subscript</em>: <code>"Text in ~subscript~"</code>
</p>
</li>
<li> <p><em>superscript</em>: <code>"Text in ^superscript^"</code>
</p>
</li>
<li> <p><em>newline</em>: <code style="white-space: pre;">&#8288;Before &lt;br&gt; After&#8288;</code>
</p>
</li>
<li> <p><em>color</em>: <code>"&lt;color:red&gt;red text&lt;/color&gt;"</code>
</p>
</li>
<li> <p><em>shade</em>: <code>"&lt;shade:yellow&gt;yellow text&lt;/shade&gt;"</code> (background color)
</p>
</li>
<li> <p><em>font family</em>: <code>"&lt;ff:symbol&gt;symbol&lt;/ff&gt;"</code> (
</p>
</li></ul>

<p>Note that the font name depends on your system language. For instant, in French, it would be <code>Symbol</code> with an uppercase first letter.
</p>
<p>See the last example of <code><a href="#topic+body_add_normal">body_add_normal()</a></code> for a practical case.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#For this example to work, `my_template.docx` should include styles named
#`ordered_list` and `unordered_list`

library(officer)
library(crosstable)
options(crosstable_style_list_ordered="ordered_list")
options(crosstable_style_list_unordered="unordered_list")

read_docx("my_template.docx") %&gt;%
 body_add_list(c("Numbered item 1", "Numbered item 2"), ordered = TRUE) %&gt;%
 body_add_list_item("Numbered item 3", ordered = TRUE) %&gt;%
 body_add_list(c("Bullet item 1", "Bullet item 2"), ordered = FALSE) %&gt;%
 body_add_list_item("Bullet item 3", ordered = FALSE) %&gt;%
 write_and_open()

## End(Not run)
</code></pre>

<hr>
<h2 id='body_add_normal'>Add a new paragraph with default style</h2><span id='topic+body_add_normal'></span><span id='topic+body_add_glued'></span>

<h3>Description</h3>

<p>Add a new paragraph in an <code>officer</code> document with default style.<br />
Variables can be inserted in the text as multiple strings (<code>paste()</code> style) or enclosed by braces (<code>glue()</code> style).  <br />
Basic markdown syntax is available: <code style="white-space: pre;">&#8288;**bold**&#8288;</code>, <code style="white-space: pre;">&#8288;*italic*&#8288;</code>, and <code style="white-space: pre;">&#8288;_underlined_&#8288;</code>. <br />
References to any bookmark can be inserted using the syntax <code style="white-space: pre;">&#8288;@ref(bookmark)&#8288;</code> and newlines can be inserted using the token <code style="white-space: pre;">&#8288;&lt;br&gt;&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_normal(
  doc,
  ...,
  .sep = "",
  style = NULL,
  squish = TRUE,
  parse = c("ref", "format", "code")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_normal_+3A_doc">doc</code></td>
<td>
<p>the doc object (created with the <code>read_docx</code> function of <code>officer</code> package)</p>
</td></tr>
<tr><td><code id="body_add_normal_+3A_...">...</code></td>
<td>
<p>one or several character strings, pasted using <code>.sep</code>. As with <code>glue::glue()</code>, expressions enclosed by braces will be evaluated as R code. If more than one variable is passed, all should be of length 1.</p>
</td></tr>
<tr><td><code id="body_add_normal_+3A_.sep">.sep</code></td>
<td>
<p>Separator used to separate elements.</p>
</td></tr>
<tr><td><code id="body_add_normal_+3A_style">style</code></td>
<td>
<p>Style for normal text. Best set with <code><a href="#topic+crosstable_options">crosstable_options()</a></code>.</p>
</td></tr>
<tr><td><code id="body_add_normal_+3A_squish">squish</code></td>
<td>
<p>Whether to squish the result (remove trailing and repeated spaces). Default to <code>TRUE</code>. Allows to add multiline paragraph without breaking the string.</p>
</td></tr>
<tr><td><code id="body_add_normal_+3A_parse">parse</code></td>
<td>
<p>which format to parse. Default to all formats (<code>c("ref", "format", "code")</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new doc object
</p>
<p>The docx object <code>doc</code>
</p>


<h3>Markdown support</h3>

<p>In all <code>crosstable</code> helpers for <code>officer</code>, you can use the following Markdown syntax to format your text:
</p>

<ul>
<li> <p><em>bold</em>: <code>"**text in bold**"</code>
</p>
</li>
<li><p> *italics: <code>"*text in italics*"</code>
</p>
</li>
<li> <p><em>subscript</em>: <code>"Text in ~subscript~"</code>
</p>
</li>
<li> <p><em>superscript</em>: <code>"Text in ^superscript^"</code>
</p>
</li>
<li> <p><em>newline</em>: <code style="white-space: pre;">&#8288;Before &lt;br&gt; After&#8288;</code>
</p>
</li>
<li> <p><em>color</em>: <code>"&lt;color:red&gt;red text&lt;/color&gt;"</code>
</p>
</li>
<li> <p><em>shade</em>: <code>"&lt;shade:yellow&gt;yellow text&lt;/shade&gt;"</code> (background color)
</p>
</li>
<li> <p><em>font family</em>: <code>"&lt;ff:symbol&gt;symbol&lt;/ff&gt;"</code> (
</p>
</li></ul>

<p>Note that the font name depends on your system language. For instant, in French, it would be <code>Symbol</code> with an uppercase first letter.
</p>
<p>See the last example of <code><a href="#topic+body_add_normal">body_add_normal()</a></code> for a practical case.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
library(crosstable)

info_rows = c("Also, table iris has {nrow(iris)} rows.",
              "And table mtcars has {nrow(mtcars)} rows.")
doc = read_docx()  %&gt;%
    body_add_normal("Table iris has", ncol(iris), "columns.", .sep=" ") %&gt;% #paste style
    body_add_normal("However, table mtcars has {ncol(mtcars)} columns") %&gt;% #glue style
    body_add_normal(info_rows)                                          %&gt;% #vector style
    body_add_normal("")
doc = doc %&gt;%
    body_add_normal("You can write text in *italic1*, _underlined1_, **bold1**, and `code`,
                    and you can also add * **references** *, for instance a ref to Table
                    @ref(my_table). Multiple spaces are ignored (squished) so that you
                    can enter multiline text.") %&gt;%
    body_add_normal() %&gt;%
    body_add_normal("Here I should use `body_add_crosstable()` to add a table before the
                     legend.") %&gt;%
    body_add_table_legend("My pretty table", bookmark="my_table")
write_and_open(doc)

#Markdown support
read_docx() %&gt;%
  body_add_normal("This is **bold and *italic* (see Table @ref(my_bkm)). ** &lt;br&gt; This is
                   **bold `console \\*CODE\\*` and *bold _and_ italic* **") %&gt;%
  body_add_normal("This is &lt;color:red&gt;red **bold** text&lt;/color&gt;, this is ~subscript *italic*~,
                   and this is ^superscript with &lt;shade:yellow&gt;yellow&lt;/shade&gt;^") %&gt;%
  body_add_normal("This is &lt;ff:Alibi&gt;a fancy font&lt;/ff&gt; and this `is code`!!") %&gt;%
              #you might need to change "Alibi" to "alibi" here
  body_add_normal() %&gt;%
  body_add_table_legend("Some table legend", bookmark="my_bkm") %&gt;%
  write_and_open()
</code></pre>

<hr>
<h2 id='body_add_table_list'>Add a list of tables</h2><span id='topic+body_add_table_list'></span><span id='topic+body_add_flextable_list'></span><span id='topic+body_add_crosstable_list'></span>

<h3>Description</h3>

<p>Add a list of tables in an officer document. <code>crosstables</code> will be added using <code><a href="#topic+body_add_crosstable">body_add_crosstable()</a></code> and <code>flextables</code> will be added using <code><a href="flextable.html#topic+body_add_flextable">flextable::body_add_flextable()</a></code>. Plain dataframes will be converted to flextables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_table_list(
  doc,
  l,
  fun_before = "title2",
  fun_after = NULL,
  fun = fun_before,
  ...
)

body_add_flextable_list(...)

body_add_crosstable_list(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_table_list_+3A_doc">doc</code></td>
<td>
<p>a <code>rdocx</code> object, created by <code><a href="officer.html#topic+read_docx">officer::read_docx()</a></code></p>
</td></tr>
<tr><td><code id="body_add_table_list_+3A_l">l</code></td>
<td>
<p>a named list of tables (of class <code>crosstable</code>, <code>flextable</code>, or <code>data.frame</code>).</p>
</td></tr>
<tr><td><code id="body_add_table_list_+3A_fun_before">fun_before</code></td>
<td>
<p>a function to be used before each table</p>
</td></tr>
<tr><td><code id="body_add_table_list_+3A_fun_after">fun_after</code></td>
<td>
<p>a function to be used after each table.</p>
</td></tr>
<tr><td><code id="body_add_table_list_+3A_fun">fun</code></td>
<td>
<p>Deprecated</p>
</td></tr>
<tr><td><code id="body_add_table_list_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="#topic+body_add_crosstable">body_add_crosstable()</a></code> or <code><a href="flextable.html#topic+body_add_flextable">body_add_flextable()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3><code>fun_before</code> and <code>fun_after</code></h3>

<p>These should be function of the form <code style="white-space: pre;">&#8288;function(doc, .name)&#8288;</code> where <code>.name</code> is the name of the current table of the list.
You can also pass <code>"title2"</code> to add the name as a title of level 2 between each table (works for levels 3 and 4 as well), <code>"newline"</code> to simply add a new line, or even <code>NULL</code> to not separate them (beware that the tables might merge then).
<code>fun_before</code> is designed to add a title while <code>fun_after</code> is designed to add a table legend (cf. examples).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
ctl = list(iris2=crosstable(iris2, 1),
           "Just a flextable"=flextable::flextable(mtcars2[1:5,1:5]),
           "Just a dataframe"=iris2[1:5,1:5])

fun1 = function(doc, .name){
    doc %&gt;%
        body_add_title(" This is table '{.name}' as a flex/crosstable", level=2) %&gt;%
        body_add_normal("Here is the table:")
}
fun2 = function(doc, .name){
  doc %&gt;% body_add_table_legend("{.name}", bookmark=.name)
}
read_docx() %&gt;%
  body_add_title("Separated by subtitle", 1) %&gt;%
  body_add_table_list(ctl, fun_before="title2") %&gt;%
  body_add_break() %&gt;%
  body_add_title("Separated using a custom function", 1) %&gt;%
  body_add_normal("You can therefore use bookmarks, for instance here are
                   tables \\@ref(iris2), \\@ref(just_a_flextable)
                   and \\@ref(just_a_dataframe).") %&gt;%
  body_add_table_list(ctl, fun_before=fun1, fun_after=fun2, body_fontsize=8) %&gt;%
  write_and_open()
</code></pre>

<hr>
<h2 id='body_add_table_section'>Add a section with a table and its legend</h2><span id='topic+body_add_table_section'></span>

<h3>Description</h3>

<p>Add a section with a table and its legend
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_table_section(
  doc,
  x,
  legend,
  ...,
  bookmark = NULL,
  title = getOption("crosstable_section_title", TRUE),
  title_lvl = getOption("crosstable_section_title_level", 3),
  sentence = getOption("crosstable_section_sentence", FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_table_section_+3A_doc">doc</code></td>
<td>
<p>a <code>rdocx</code> object</p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_x">x</code></td>
<td>
<p>a table: <code>crosstable</code>, <code>flextable</code>, or plain old <code>dataframe</code></p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_legend">legend</code></td>
<td>
<p>the legend to use</p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="flextable.html#topic+body_add_flextable">body_add_flextable()</a></code> or <code><a href="#topic+body_add_crosstable">body_add_crosstable()</a></code></p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_bookmark">bookmark</code></td>
<td>
<p>the bookmark to use. Defaults to the cleaned variable name of <code>x</code></p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_title">title</code></td>
<td>
<p>the title to add for the section. Can also be <code>FALSE</code> (no title) or <code>TRUE</code> (the title defaults to <code>legend</code>)</p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_title_lvl">title_lvl</code></td>
<td>
<p>the title level if applicable</p>
</td></tr>
<tr><td><code id="body_add_table_section_+3A_sentence">sentence</code></td>
<td>
<p>a sentence to add between the title (if applicable) and the table. If <code>TRUE</code>, defaults to <code>"Information about {tolower(title)} is described in Table @ref({bookmark})"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>docx</code> object <code>doc</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
read_docx() %&gt;%
  body_add_title("Description", 1) %&gt;%
  body_add_title("Population A", 2) %&gt;%
  body_add_table_section(head(iris), "The iris dataset", sentence=TRUE) %&gt;%
  body_add_table_section(crosstable(iris), "A crosstable of the iris dataset",
                         title=FALSE, sentence=TRUE, body_fontsize=8) %&gt;%
  write_and_open()
</code></pre>

<hr>
<h2 id='body_add_title'>Add a title to an <code>officer</code> document</h2><span id='topic+body_add_title'></span>

<h3>Description</h3>

<p>Add a title to an <code>officer</code> document
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_title(
  doc,
  value,
  level = 1,
  squish = TRUE,
  style = getOption("crosstable_style_heading", "heading")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_add_title_+3A_doc">doc</code></td>
<td>
<p>the doc object (created with the <code>read_docx</code> function of <code>officer</code> package)</p>
</td></tr>
<tr><td><code id="body_add_title_+3A_value">value</code></td>
<td>
<p>a character string. See Section below for markdown support.</p>
</td></tr>
<tr><td><code id="body_add_title_+3A_level">level</code></td>
<td>
<p>the level of the title. See <code>styles_info(doc)</code> to know the possibilities.</p>
</td></tr>
<tr><td><code id="body_add_title_+3A_squish">squish</code></td>
<td>
<p>Whether to squish the result (remove trailing and repeated spaces). Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="body_add_title_+3A_style">style</code></td>
<td>
<p>the name of the title style. See <code>styles_info(doc)</code> to know the possibilities.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Markdown support</h3>

<p>In all <code>crosstable</code> helpers for <code>officer</code>, you can use the following Markdown syntax to format your text:
</p>

<ul>
<li> <p><em>bold</em>: <code>"**text in bold**"</code>
</p>
</li>
<li><p> *italics: <code>"*text in italics*"</code>
</p>
</li>
<li> <p><em>subscript</em>: <code>"Text in ~subscript~"</code>
</p>
</li>
<li> <p><em>superscript</em>: <code>"Text in ^superscript^"</code>
</p>
</li>
<li> <p><em>newline</em>: <code style="white-space: pre;">&#8288;Before &lt;br&gt; After&#8288;</code>
</p>
</li>
<li> <p><em>color</em>: <code>"&lt;color:red&gt;red text&lt;/color&gt;"</code>
</p>
</li>
<li> <p><em>shade</em>: <code>"&lt;shade:yellow&gt;yellow text&lt;/shade&gt;"</code> (background color)
</p>
</li>
<li> <p><em>font family</em>: <code>"&lt;ff:symbol&gt;symbol&lt;/ff&gt;"</code> (
</p>
</li></ul>

<p>Note that the font name depends on your system language. For instant, in French, it would be <code>Symbol</code> with an uppercase first letter.
</p>
<p>See the last example of <code><a href="#topic+body_add_normal">body_add_normal()</a></code> for a practical case.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
library(crosstable)
library(dplyr)
doc = read_docx() %&gt;%
   body_add_title("La table iris (nrow={nrow(iris)})", 1) %&gt;%
   body_add_title("Description", 2) %&gt;%
   body_add_normal("La table iris a ", ncol(iris), " colonnes.")
#write_and_open(doc)
</code></pre>

<hr>
<h2 id='body_replace_text_at_bkms'>Replace text on several bookmarks at once</h2><span id='topic+body_replace_text_at_bkms'></span>

<h3>Description</h3>

<p>Replace text on several bookmarks at once
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_replace_text_at_bkms(doc, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_replace_text_at_bkms_+3A_doc">doc</code></td>
<td>
<p>a <code>rdocx</code> object</p>
</td></tr>
<tr><td><code id="body_replace_text_at_bkms_+3A_...">...</code></td>
<td>
<p>named</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The docx object <code>doc</code>
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='clean_names_with_labels'>Cleans names of a dataframe while retaining old names as labels</h2><span id='topic+clean_names_with_labels'></span>

<h3>Description</h3>

<p>Cleans names of a dataframe while retaining old names as labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_names_with_labels(
  df,
  except = NULL,
  .fun = getOption("crosstable_clean_names_fun")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_names_with_labels_+3A_df">df</code></td>
<td>
<p>a data.frame</p>
</td></tr>
<tr><td><code id="clean_names_with_labels_+3A_except">except</code></td>
<td>
<p>&lt;<code><a href="tidyselect.html#topic+language">tidy-select</a></code>&gt; columns that should not be renamed.</p>
</td></tr>
<tr><td><code id="clean_names_with_labels_+3A_.fun">.fun</code></td>
<td>
<p>the function used to clean the names. Default function is limited; if the cleaning is not good enough you could use janitor::make_clean_names()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with clean names and label attributes
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#options(crosstable_clean_names_fun=janitor::make_clean_names)
x = data.frame("name with space"=1, TwoWords=1, "total $ (2009)"=1, àccénts=1,
               check.names=FALSE)
cleaned = clean_names_with_labels(x, except=TwoWords)
cleaned %&gt;% names()
cleaned %&gt;% get_label()
</code></pre>

<hr>
<h2 id='confint_numeric'>Confidence interval of a numeric vector</h2><span id='topic+confint_numeric'></span>

<h3>Description</h3>

<p>Not an S3 method, which might have conflicted with <a href="stats.html#topic+confint">stats::confint</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint_numeric(object, level = 0.95, B = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_numeric_+3A_object">object</code></td>
<td>
<p>a vector, numeric or equivalent (date, logical...)</p>
</td></tr>
<tr><td><code id="confint_numeric_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="confint_numeric_+3A_b">B</code></td>
<td>
<p>if &gt;0, the number of bootstraps</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the vector [conf_inf, conf_sup]
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>confint_numeric(iris$Sepal.Length)
confint_numeric(mtcars2$hp_date)
confint_numeric(mtcars2$hp_date, level=0.99)
</code></pre>

<hr>
<h2 id='cross_summary'>Summarize a numeric vector</h2><span id='topic+cross_summary'></span>

<h3>Description</h3>

<p>Summarize a numeric vector with min, max, mean, sd, median, IQR, n and missings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross_summary(x, dig = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cross_summary_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="cross_summary_+3A_dig">dig</code></td>
<td>
<p>number of digits</p>
</td></tr>
<tr><td><code id="cross_summary_+3A_...">...</code></td>
<td>
<p>params to pass on to <code><a href="#topic+format_fixed">format_fixed()</a></code>: <code>zero_digits</code> and <code>only_round</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of named functions
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cross_summary(iris$Sepal.Length)
cross_summary(iris$Petal.Width, dig=3)
cross_summary(mtcars2$hp_date)
cross_summary(mtcars2$qsec_posix, date_format="%d/%m %H:%M")
</code></pre>

<hr>
<h2 id='crosstable'>Easily describe datasets</h2><span id='topic+crosstable'></span>

<h3>Description</h3>

<p>Generate a descriptive table of all chosen columns, as contingency tables for categorical variables and as calculation summaries for numeric variables. If the <code>by</code> argument points to one or several categorical variables, <code>crosstable</code> will output a description of all columns for each level. Otherwise, if it points to a numeric variable, <code>crosstable</code> will calculate correlation coefficients with all other selected numeric columns. Finally, if it points to a <code>Surv</code> object, <code>crosstable</code> will describe the survival at different times.<br />
<br />
Can be formatted as an HTML table using <code><a href="#topic+as_flextable">as_flextable()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable(
  data,
  cols = everything(),
  ...,
  by = NULL,
  total = c("none", "row", "column", "both"),
  percent_pattern = "{n} ({p_row})",
  percent_digits = 2,
  num_digits = 1,
  showNA = c("ifany", "always", "no"),
  label = TRUE,
  funs = c(` ` = cross_summary),
  funs_arg = list(),
  cor_method = c("pearson", "kendall", "spearman"),
  drop_levels = FALSE,
  unique_numeric = 3,
  date_format = NULL,
  times = NULL,
  followup = FALSE,
  test = FALSE,
  test_args = crosstable_test_args(),
  effect = FALSE,
  effect_args = crosstable_effect_args(),
  margin = deprecated(),
  .vars = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_+3A_data">data</code></td>
<td>
<p>A data.frame</p>
</td></tr>
<tr><td><code id="crosstable_+3A_cols">cols</code></td>
<td>
<p>&lt;<code><a href="tidyselect.html#topic+language">tidy-select</a></code>&gt; Columns to describe, default to <code>everything()</code>. See examples or <code>vignette("crosstable-selection")</code> for more details.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_...">...</code></td>
<td>
<p>Unused. All parameters after this one must be named.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_by">by</code></td>
<td>
<p>The variable to group on. Character or name.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_total">total</code></td>
<td>
<p>one of [&quot;none&quot;, &quot;row&quot;, &quot;column&quot; or &quot;both&quot;] to indicate whether to add total rows and/or columns. Default to <code>none</code>.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_percent_pattern">percent_pattern</code></td>
<td>
<p>Pattern used to describe proportions in categorical data. Syntax uses a <code><a href="glue.html#topic+glue">glue::glue()</a></code> specification, see the <strong>section</strong> below for more details. Default to <code>"{n} ({p_col})"</code> if <code>by</code> is null and <code>"{n} ({p_row})"</code> if it is not.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_percent_digits">percent_digits</code></td>
<td>
<p>Number of digits for percentages.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_num_digits">num_digits</code></td>
<td>
<p>Number of digits for numeric summaries.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_showna">showNA</code></td>
<td>
<p>Whether to show NA in categorical variables (one of <code>c("ifany", "always", "no")</code>, like in <code>table()</code>).</p>
</td></tr>
<tr><td><code id="crosstable_+3A_label">label</code></td>
<td>
<p>Whether to show labels. See <code><a href="#topic+import_labels">import_labels()</a></code> or <code><a href="#topic+set_label">set_label()</a></code>for how to add labels to the dataset columns.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_funs">funs</code></td>
<td>
<p>Functions to apply to numeric variables. Default to <code><a href="#topic+cross_summary">cross_summary()</a></code>.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_funs_arg">funs_arg</code></td>
<td>
<p>Additional parameters for <code>funs</code>, e.g. <code>digits</code> (the number of decimal places) for the default <code><a href="#topic+cross_summary">cross_summary()</a></code>. Ultimately, these arguments are passed to <code><a href="#topic+format_fixed">format_fixed()</a></code>.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_cor_method">cor_method</code></td>
<td>
<p>One of <code>c("pearson", "kendall", "spearman")</code> to indicate which correlation coefficient is to be used.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_drop_levels">drop_levels</code></td>
<td>
<p>Whether to drop unused levels of factor variables. Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_unique_numeric">unique_numeric</code></td>
<td>
<p>The number of non-missing different levels a variable should have to be considered as numeric.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_date_format">date_format</code></td>
<td>
<p>if <code>x</code> is a vector of Date or POSIXt, the format to apply (see <a href="base.html#topic+strptime">strptime</a> for formats)</p>
</td></tr>
<tr><td><code id="crosstable_+3A_times">times</code></td>
<td>
<p>When using formula with <code><a href="survival.html#topic+Surv">survival::Surv()</a></code> objects, which times to summarize.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_followup">followup</code></td>
<td>
<p>When using formula with <code><a href="survival.html#topic+Surv">survival::Surv()</a></code> objects, whether to display follow-up time.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_test">test</code></td>
<td>
<p>Whether to perform tests.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_test_args">test_args</code></td>
<td>
<p>See <code><a href="#topic+crosstable_test_args">crosstable_test_args</a></code> to override default testing behaviour.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_effect">effect</code></td>
<td>
<p>Whether to compute a effect measure.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_effect_args">effect_args</code></td>
<td>
<p>See <code><a href="#topic+crosstable_effect_args">crosstable_effect_args</a></code> to override default behaviour.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_margin">margin</code></td>
<td>
<p>Deprecated in favor of <code>percent_pattern</code>. One of [&quot;row&quot;, &quot;column&quot;, &quot;cell&quot;, &quot;none&quot;, or &quot;all&quot;]. Default to <code>row</code>.</p>
</td></tr>
<tr><td><code id="crosstable_+3A_.vars">.vars</code></td>
<td>
<p>Deprecated in favor of <code>cols</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code>/<code>tibble</code> of class <code>crosstable</code>
</p>


<h3>About <code>percent_pattern</code></h3>

<p>The <code>percent_pattern</code> argument is very powerful but can be difficult to understand at first :
</p>

<ul>
<li><p> It is usually a single string that uses the glue syntax, where variables are put in curly braces (<code>{x}</code>).
</p>
</li>
<li><p> Counts are expressed as <code>{n}</code>, <code>{n_row}</code>, <code>{n_col}</code>, and <code>{n_tot}</code>, and proportions as <code>{p_row}</code>, <code>{p_col}</code>, and <code>{p_cell}</code>, depending on the margin on which they are calculated.
</p>
</li>
<li><p> For each variable, a version including missing values in the total is proposed as <code>{n_xxx_na}</code> or <code>{p_xxx_na}</code>.
</p>
</li>
<li><p> For each proportion, a confidence interval is also calculated using <a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Wilson_score_interval">Wilson score</a> and can be expressed as <code>{p_xxx_inf}</code> and <code>{p_xxx_sup}</code>. See examples for practical applications.
</p>
</li>
<li><p> Alternatively, <code>percent_pattern</code> can be a list of characters with names <code>body</code>, <code>total_row</code>, <code>total_col</code>, and <code>total_all</code> to also control the pattern in other parts of the crosstable than the body.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p>https://danchaltiel.github.io/crosstable/, as_flextable, import_labels
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#whole table
crosstable(iris)
crosstable(mtcars)
crosstable(mtcars2)

#tidyselection, custom functions
library(dplyr)
crosstable(mtcars2, c(ends_with("t"), starts_with("c")), by=vs,
           funs=c(mean, quantile), funs_arg=list(probs=c(.25,.75)))

#margin and totals, multiple by
crosstable(mtcars2, c(disp, cyl), by=c(am, vs),
           margin=c("row", "col"), total = "both")

#predicate selection, correlation, effect calculation
crosstable(mtcars2, where(is.numeric), by=hp, effect=TRUE)

#lambda selection &amp; statistical tests
crosstable(mtcars2, ~is.numeric(.x) &amp;&amp; mean(.x)&gt;50, by=vs, test=TRUE)

#Dates
mtcars2$my_date = as.Date(mtcars2$hp , origin="2010-01-01") %&gt;% set_label("Some nonsense date")
crosstable(mtcars2, my_date, by=vs, date_format="%d/%m/%Y")

#Survival data (using formula syntax)
library(survival)
crosstable(aml, Surv(time, status) ~ x, times=c(0,15,30,150), followup=TRUE)

#Patterns
crosstable(mtcars2, vs, by=am, percent_digits=0,
           percent_pattern="{n} ({p_col} / {p_row})")
crosstable(mtcars2, vs, by=am, percent_digits=0,
           percent_pattern="N={n} \np[95%CI] = {p_col} [{p_col_inf}; {p_col_sup}]")
str_high="n&gt;5"; str_lo="n&lt;=5"
crosstable(mtcars2, vs, by=am, percent_digits=0,
           percent_pattern="col={p_col}, row={p_row} ({ifelse(n&lt;5, str_lo, str_high)})")
</code></pre>

<hr>
<h2 id='crosstable_effect_args'>Default arguments for calculating and displaying effects in <code><a href="#topic+crosstable">crosstable()</a></code></h2><span id='topic+crosstable_effect_args'></span>

<h3>Description</h3>

<p>This helper function provides default parameters for defining how the effect sizes should be computed. It belongs to the <code>effect_args</code> argument of the <code><a href="#topic+crosstable">crosstable()</a></code> function. See <a href="#topic+effect_summary">effect_summary</a>, <a href="#topic+effect_tabular">effect_tabular</a>, and <a href="#topic+effect_survival">effect_survival</a> for more insight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable_effect_args(
  effect_summarize = diff_mean_auto,
  effect_tabular = effect_odds_ratio,
  effect_survival = effect_survival_coxph,
  effect_display = display_effect,
  conf_level = 0.95,
  digits = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_effect_args_+3A_effect_summarize">effect_summarize</code></td>
<td>
<p>a function of three arguments (continuous variable, grouping variable and conf_level), used to compare continuous variable. Returns a list of five components: <code>effect</code> (the effect value(s)), <code>ci</code> (the matrix of confidence interval(s)), <code>effect.name</code> (the interpretation(s) of the effect value(s)), <code>effect.type</code> (the description of the measure used) and <code>conf_level</code> (the confidence interval level). Users can use <code><a href="#topic+diff_mean_auto">diff_mean_auto()</a></code>, <code><a href="#topic+diff_mean_student">diff_mean_student()</a></code>, <code><a href="#topic+diff_mean_boot">diff_mean_boot()</a></code>, or <code><a href="#topic+diff_median">diff_median()</a></code>, or their custom own function.</p>
</td></tr>
<tr><td><code id="crosstable_effect_args_+3A_effect_tabular">effect_tabular</code></td>
<td>
<p>a function of three arguments (two categorical variables and conf_level) used to measure the associations between two factors. Returns a list of five components: <code>effect</code> (the effect value(s)), <code>ci</code> (the matrix of confidence interval(s)), <code>effect.name</code> (the interpretation(s) of the effect value(s)), <code>effect.type</code> (the description of the measure used) and <code>conf_level</code> (the confidence interval level).Users can use <code><a href="#topic+effect_odds_ratio">effect_odds_ratio()</a></code>, <code><a href="#topic+effect_relative_risk">effect_relative_risk()</a></code>, or <code><a href="#topic+effect_risk_difference">effect_risk_difference()</a></code>, or their custom own function.</p>
</td></tr>
<tr><td><code id="crosstable_effect_args_+3A_effect_survival">effect_survival</code></td>
<td>
<p>a function of two argument (a formula and conf_level), used to measure the association between a censored and a factor. Returns the same components as created by <code>effect_summarize</code>.Users can use <code><a href="#topic+effect_survival_coxph">effect_survival_coxph()</a></code> or their custom own function.</p>
</td></tr>
<tr><td><code id="crosstable_effect_args_+3A_effect_display">effect_display</code></td>
<td>
<p>a function to format the effect. See <code><a href="#topic+display_effect">display_effect()</a></code>.</p>
</td></tr>
<tr><td><code id="crosstable_effect_args_+3A_conf_level">conf_level</code></td>
<td>
<p>the desired confidence interval level</p>
</td></tr>
<tr><td><code id="crosstable_effect_args_+3A_digits">digits</code></td>
<td>
<p>the decimal places</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with effect parameters
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='crosstable_options'>Options for the package <code>crosstable</code></h2><span id='topic+crosstable_options'></span>

<h3>Description</h3>

<p>Use this function to manage your <code>crosstable</code> parameters globally while taking advantage of autocompletion. Use <code><a href="#topic+crosstable_peek_options">crosstable_peek_options()</a></code> to see which option is currently set and <code><a href="#topic+crosstable_reset_options">crosstable_reset_options()</a></code> to set all options back to default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable_options(
  ...,
  zero_percent = FALSE,
  only_round = FALSE,
  verbosity_autotesting = "default",
  verbosity_duplicate_cols = "default",
  crosstable_fishertest_B = 1e+05,
  total,
  percent_pattern,
  margin,
  percent_digits,
  num_digits,
  showNA,
  label,
  funs,
  funs_arg,
  cor_method,
  drop_levels,
  unique_numeric,
  date_format,
  times,
  followup,
  test_arg,
  effect_args,
  wrap_id = 70,
  compact_padding = 25,
  header_show_n_pattern = "{.col} (N={.n})",
  keep_id,
  by_header,
  autofit,
  compact,
  remove_header_keys,
  show_test_name,
  padding_v,
  header_show_n,
  fontsize_body,
  fontsize_subheaders,
  fontsize_header,
  units = "in",
  peek_docx = TRUE,
  font_code = "Consolas",
  add_max_cols = 25,
  format_legend_name,
  table_legend_par_before,
  table_legend_prefix,
  figure_legend_par_after,
  figure_legend_prefix,
  normal_squish,
  title_squish,
  allow_break,
  style_normal,
  style_character,
  style_strong,
  style_image,
  style_legend,
  style_heading,
  style_list_ordered,
  style_list_unordered,
  scientific_log,
  .local = FALSE,
  reset = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_options_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_zero_percent">zero_percent</code></td>
<td>
<p>set to TRUE so that proportions are not displayed if <code>n==0</code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_only_round">only_round</code></td>
<td>
<p>default argument for <code><a href="#topic+format_fixed">format_fixed()</a></code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_verbosity_autotesting">verbosity_autotesting</code></td>
<td>
<p>one of <code>default</code>, <code>quiet</code>, or <code>verbose</code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_verbosity_duplicate_cols">verbosity_duplicate_cols</code></td>
<td>
<p>one of <code>default</code>, <code>quiet</code>, or <code>verbose</code>.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_crosstable_fishertest_b">crosstable_fishertest_B</code></td>
<td>
<p>number of simulations to perform when <code>fisher.test()</code> is failing (FEXACT error 7).</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_total">total</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_percent_pattern">percent_pattern</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_margin">margin</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_percent_digits">percent_digits</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_num_digits">num_digits</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_showna">showNA</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_label">label</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_funs">funs</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_funs_arg">funs_arg</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_cor_method">cor_method</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_drop_levels">drop_levels</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_unique_numeric">unique_numeric</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_date_format">date_format</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_times">times</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_followup">followup</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_test_arg">test_arg</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_effect_args">effect_args</code></td>
<td>
<p>For setting <code><a href="#topic+crosstable">crosstable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_wrap_id">wrap_id</code></td>
<td>
<p>if <code>id</code> contains no spaces, wrap it with this maximum number of characters.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_compact_padding">compact_padding</code></td>
<td>
<p>in flextables, left-padding for non-headers rows when <code>compact=TRUE</code>.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_header_show_n_pattern">header_show_n_pattern</code></td>
<td>
<p>glue pattern used when showing N in the header of flextables. <code>.col</code> is the name of the column and <code>.n</code> the size of the group. Default to <code>{.col} (N={.n})</code>.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_keep_id">keep_id</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_by_header">by_header</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_autofit">autofit</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_compact">compact</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_remove_header_keys">remove_header_keys</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_show_test_name">show_test_name</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_padding_v">padding_v</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_header_show_n">header_show_n</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_fontsize_body">fontsize_body</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_fontsize_subheaders">fontsize_subheaders</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally. Subheaders are only considered when <code>compact=TRUE</code>.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_fontsize_header">fontsize_header</code></td>
<td>
<p>For setting <code><a href="#topic+as_flextable">as_flextable()</a></code> arguments globally.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_units">units</code></td>
<td>
<p>default units in <code><a href="#topic+body_add_gg2">body_add_gg2()</a></code> and <code><a href="#topic+body_add_img2">body_add_img2()</a></code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_peek_docx">peek_docx</code></td>
<td>
<p>behavior of <code><a href="#topic+peek">peek()</a></code>, which will open a <code>docx</code> if <code>TRUE</code> (default) and an <code>xlsx</code> if <code>FALSE</code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_font_code">font_code</code></td>
<td>
<p>font family used to show code, most likely a monospaced typeface such as Consolas (default)</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_add_max_cols">add_max_cols</code></td>
<td>
<p>max number of columns a crosstable can have to be added to a Word document</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_format_legend_name">format_legend_name</code></td>
<td>
<p>how the legend name (&quot;Table&quot;, &quot;Figure&quot;) is formatted. Default to <code>officer::fp_text_lite(bold=TRUE)</code></p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_table_legend_par_before">table_legend_par_before</code></td>
<td>
<p>whether to add an empty paragraph before all table legends</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_table_legend_prefix">table_legend_prefix</code>, <code id="crosstable_options_+3A_figure_legend_prefix">figure_legend_prefix</code></td>
<td>
<p>a prefix before each legend, after the numbering</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_figure_legend_par_after">figure_legend_par_after</code></td>
<td>
<p>whether to add an empty paragraph after all figure legends</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_normal_squish">normal_squish</code></td>
<td>
<p>Should you squish text in normal paragraphs?</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_title_squish">title_squish</code></td>
<td>
<p>Should you squish text in headers paragraphs?</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_allow_break">allow_break</code></td>
<td>
<p>allow crosstable rows to break across pages</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_normal">style_normal</code></td>
<td>
<p>For specifying styles used in your <code>{officer}</code> template.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_character">style_character</code></td>
<td>
<p>For specifying styles used in your <code>{officer}</code> template.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_strong">style_strong</code></td>
<td>
<p>For specifying styles used in your <code>{officer}</code> template.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_image">style_image</code></td>
<td>
<p>For specifying styles used in your <code>{officer}</code> template.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_legend">style_legend</code></td>
<td>
<p>For specifying styles used in your <code>{officer}</code> template.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_heading">style_heading</code></td>
<td>
<p>For specifying styles used by headings on different levels. Levels will be pasted in the end (e.g. use <code>"title"</code> if your level 2 heading style is <code>"title2"</code>).</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_style_list_ordered">style_list_ordered</code>, <code id="crosstable_options_+3A_style_list_unordered">style_list_unordered</code></td>
<td>
<p>For specifying styles used by lists in the <code>rdocx</code> template. Needed for <code><a href="#topic+body_add_list">body_add_list()</a></code> to work.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_scientific_log">scientific_log</code></td>
<td>
<p>the maximum power a number can have before being formatted as scientific. Default to 4 so applies on numbers &lt;1e-4 or &gt;1e4.</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_.local">.local</code></td>
<td>
<p>if TRUE, the effect will only apply to the local frame (thanks to <code>rlang::local_options()</code>)</p>
</td></tr>
<tr><td><code id="crosstable_options_+3A_reset">reset</code></td>
<td>
<p>if <code>TRUE</code>, set all these options back to default</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for its side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crosstable_peek_options">crosstable_peek_options()</a></code> and <code><a href="#topic+crosstable_reset_options">crosstable_reset_options()</a></code>
</p>

<hr>
<h2 id='crosstable_peek_options'>See which <code>crosstable</code> option is currently set.</h2><span id='topic+crosstable_peek_options'></span>

<h3>Description</h3>

<p>See which <code>crosstable</code> option is currently set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable_peek_options(keep_null = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_peek_options_+3A_keep_null">keep_null</code></td>
<td>
<p>set to TRUE to get a list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of crosstable options
</p>

<hr>
<h2 id='crosstable_reset_options'>Reset all <code>crosstable</code> options.</h2><span id='topic+crosstable_reset_options'></span>

<h3>Description</h3>

<p>Reset all <code>crosstable</code> options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable_reset_options(quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_reset_options_+3A_quiet">quiet</code></td>
<td>
<p>set to <code>TRUE</code> to remove the message.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for its side effects
</p>

<hr>
<h2 id='crosstable_test_args'>Default arguments for calculating and displaying tests in <code><a href="#topic+crosstable">crosstable()</a></code></h2><span id='topic+crosstable_test_args'></span><span id='topic+test_args'></span>

<h3>Description</h3>

<p>This is the starting point for refining the testing algorithm used in crosstable. Users can provide their own functions for test.~.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable_test_args(
  test_summarize = test_summarize_auto,
  test_tabular = test_tabular_auto,
  test_correlation = test_correlation_auto,
  test_survival = test_survival_logrank,
  test_display = display_test,
  plim = 4,
  show_method = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable_test_args_+3A_test_summarize">test_summarize</code></td>
<td>
<p>a function of two arguments (continuous variable and grouping variable), used to compare continuous variable. Must return a list of two components: <code>p.value</code> and <code>method</code>. See <code><a href="#topic+test_summarize_auto">test_summarize_auto</a></code> or <code><a href="#topic+test_summarize_linear_contrasts">test_summarize_linear_contrasts</a></code> for some examples of such functions.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_test_tabular">test_tabular</code></td>
<td>
<p>a function of two arguments (two categorical variables), used to test association between two categorical variables.  Must return a list of two components: <code>p.value</code> and <code>method</code>. See <code><a href="#topic+test_tabular_auto">test_tabular_auto</a></code> for example.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_test_correlation">test_correlation</code></td>
<td>
<p>a function of three arguments (two continuous variables plus the correlation method), used to test association between two continuous variables.  Like <code>cor.test</code>, it must return a list of at least <code>estimate</code>, <code>p.value</code>, and <code>method</code>, with also <code>conf.int</code> optionally. See <code><a href="#topic+test_correlation_auto">test_correlation_auto</a></code> for example.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_test_survival">test_survival</code></td>
<td>
<p>a function of one argument (the formula <code>surv~by</code>), used to compare survival estimations. Must return a list of two components: <code>p.value</code> and <code>method</code>. See <code><a href="#topic+test_survival_logrank">test_survival_logrank</a></code> for example.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_test_display">test_display</code></td>
<td>
<p>function used to display the test result. See <code><a href="#topic+display_test">display_test</a></code>.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_plim">plim</code></td>
<td>
<p>number of digits for the p value.</p>
</td></tr>
<tr><td><code id="crosstable_test_args_+3A_show_method">show_method</code></td>
<td>
<p>whether to display the test name (logical).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with test parameters
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+test_summarize_auto">test_summarize_auto</a></code>, <code><a href="#topic+test_tabular_auto">test_tabular_auto</a></code>, <code><a href="#topic+test_survival_logrank">test_survival_logrank</a></code>, <code><a href="#topic+test_summarize_linear_contrasts">test_summarize_linear_contrasts</a></code>, <code><a href="#topic+display_test">display_test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
my_test_args=crosstable_test_args()
my_test_args$test_summarize = test_summarize_linear_contrasts
iris %&gt;%
  mutate(Petal.Width.qt = paste0("Q", ntile(Petal.Width, 5)) %&gt;% ordered()) %&gt;%
  crosstable(Petal.Length ~ Petal.Width.qt, test=TRUE, test_args = my_test_args)
</code></pre>

<hr>
<h2 id='ct_compact'>Generic function to compact a table (publication formatting)</h2><span id='topic+ct_compact'></span><span id='topic+ct_compact.data.frame'></span><span id='topic+ct_compact.crosstable'></span><span id='topic+ct_compact.default'></span><span id='topic+compact'></span><span id='topic+compact.data.frame'></span><span id='topic+compact.crosstable'></span><span id='topic+compact.default'></span>

<h3>Description</h3>

<p>Generic function to compact a table (publication formatting)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
ct_compact(
  data,
  name_from,
  name_to = "variable",
  wrap_cols = NULL,
  rtn_flextable = FALSE,
  ...
)

## S3 method for class 'crosstable'
ct_compact(
  data,
  name_from = c("label", ".id"),
  name_to = "variable",
  keep_id = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ct_compact_+3A_data">data</code></td>
<td>
<p>the object to compact</p>
</td></tr>
<tr><td><code id="ct_compact_+3A_...">...</code></td>
<td>
<p>additional arguments (not used)</p>
</td></tr>
<tr><td><code id="ct_compact_+3A_name_from">name_from</code></td>
<td>
<p>name of the column to be collapsed when compacting</p>
</td></tr>
<tr><td><code id="ct_compact_+3A_name_to">name_to</code></td>
<td>
<p>name of the column that will receive the collapsed column. Will be created if it doesn't exist.</p>
</td></tr>
<tr><td><code id="ct_compact_+3A_wrap_cols">wrap_cols</code></td>
<td>
<p>name of the columns to wrap</p>
</td></tr>
<tr><td><code id="ct_compact_+3A_rtn_flextable">rtn_flextable</code></td>
<td>
<p>whether to return a formatted <code><a href="flextable.html#topic+flextable">flextable()</a></code> object or a simple <code>data.frame</code></p>
</td></tr>
<tr><td><code id="ct_compact_+3A_keep_id">keep_id</code></td>
<td>
<p><code>glue</code> pattern to keep the column name along with the label. If <code>TRUE</code>, default to <code>"{label} ({.id})"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a compacted data.frame
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#dataframes
x=iris[c(1:5,51:55,101:105),]
ct_compact(x, name_from="Species")
ct_compact(x, name_from="Species", name_to="Petal.Length")
x$Species2 = substr(x$Species, 1, 1)
ct_compact(x, name_from="Species", wrap_cols="Species2")

#crosstables
x=crosstable(mtcars2, c(disp,hp,am), by=vs, test=TRUE, effect=TRUE)
ct_compact(x)
ct_compact(x, name_from=".id")
</code></pre>

<hr>
<h2 id='display_effect'>Default function to display the effect</h2><span id='topic+display_effect'></span>

<h3>Description</h3>

<p>User can provide their own custom version in <code><a href="#topic+crosstable_effect_args">crosstable_effect_args()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>display_effect(effect, digits = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="display_effect_+3A_effect">effect</code></td>
<td>
<p>effect</p>
</td></tr>
<tr><td><code id="display_effect_+3A_digits">digits</code></td>
<td>
<p>digits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='display_test'>Default function to display a test result</h2><span id='topic+display_test'></span>

<h3>Description</h3>

<p>Default function to display a test result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>display_test(test, digits = 4, method = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="display_test_+3A_test">test</code></td>
<td>
<p>test</p>
</td></tr>
<tr><td><code id="display_test_+3A_digits">digits</code></td>
<td>
<p>number of digits</p>
</td></tr>
<tr><td><code id="display_test_+3A_method">method</code></td>
<td>
<p>display method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='docx_bookmarks2'>List Word bookmarks, including the ones in header and footer</h2><span id='topic+docx_bookmarks2'></span>

<h3>Description</h3>

<p>This is a correction of <code><a href="officer.html#topic+docx_bookmarks">officer::docx_bookmarks()</a></code>. See <a href="https://github.com/davidgohel/officer/pull/313">this PR</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>docx_bookmarks2(
  x,
  return_vector = FALSE,
  target = c("all", "header", "body", "footer")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="docx_bookmarks2_+3A_x">x</code></td>
<td>
<p>an <code>rdocx</code> object</p>
</td></tr>
<tr><td><code id="docx_bookmarks2_+3A_return_vector">return_vector</code></td>
<td>
<p>use <code>TRUE</code> for compatibility with <code><a href="officer.html#topic+docx_bookmarks">officer::docx_bookmarks()</a></code></p>
</td></tr>
<tr><td><code id="docx_bookmarks2_+3A_target">target</code></td>
<td>
<p>one of c(&quot;all&quot;, &quot;header&quot;, &quot;body&quot;, &quot;footer&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with all bookmarks
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='effect_summary'>Effect measure for association between one continuous and one categorical variable</h2><span id='topic+effect_summary'></span><span id='topic+diff_mean_auto'></span><span id='topic+diff_mean_boot'></span><span id='topic+diff_median_boot'></span><span id='topic+diff_median'></span><span id='topic+diff_mean_student'></span>

<h3>Description</h3>

<p>User can either use or extend these functions to configure effect calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_mean_auto(x, by, conf_level = 0.95, R = 500)

diff_mean_boot(x, by, conf_level = 0.95, R = 500)

diff_median_boot(x, by, conf_level = 0.95, R = 500)

diff_mean_student(x, by, conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effect_summary_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="effect_summary_+3A_by">by</code></td>
<td>
<p>categorical vector (of exactly 2 unique levels)</p>
</td></tr>
<tr><td><code id="effect_summary_+3A_conf_level">conf_level</code></td>
<td>
<p>confidence interval level</p>
</td></tr>
<tr><td><code id="effect_summary_+3A_r">R</code></td>
<td>
<p>number of bootstrap replication</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with five components: effect, ci, effect.name, effect.type, and conf_level
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>diff_mean_auto()</code>: (<strong>Default</strong>) calculate a specific &quot;difference in means&quot; effect based on normality (Shapiro or Anderson test) and variance homogeneity (Bartlett test)
</p>
</li>
<li> <p><code>diff_mean_boot()</code>: calculate a &quot;difference in means&quot; effect with a bootstrapped CI using standard deviation
</p>
</li>
<li> <p><code>diff_median_boot()</code>: calculate a &quot;difference in medians&quot; effect with a bootstrapped CI using quantiles#'
</p>
</li>
<li> <p><code>diff_mean_student()</code>: calculate a &quot;difference in means&quot; effect using <code>t.test</code> confidence intervals
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crosstable_effect_args">crosstable_effect_args()</a></code>
</p>

<hr>
<h2 id='effect_survival'>Effect measure for association between one censored variable and one categorical variable</h2><span id='topic+effect_survival'></span><span id='topic+effect_survival_coxph'></span>

<h3>Description</h3>

<p>Effect measure for association between one censored variable and one categorical variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect_survival_coxph(x, by, conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effect_survival_+3A_x">x</code></td>
<td>
<p>survival vector (made using <code><a href="survival.html#topic+Surv">survival::Surv()</a></code>)</p>
</td></tr>
<tr><td><code id="effect_survival_+3A_by">by</code></td>
<td>
<p>categorical vector (of exactly 2 unique levels)</p>
</td></tr>
<tr><td><code id="effect_survival_+3A_conf_level">conf_level</code></td>
<td>
<p>confidence interval level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components: p.value and method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>

<hr>
<h2 id='effect_tabular'>Effect measure for association between two categorical variables</h2><span id='topic+effect_tabular'></span><span id='topic+effect_odds_ratio'></span><span id='topic+effect_relative_risk'></span><span id='topic+effect_risk_difference'></span>

<h3>Description</h3>

<p>User can either use or extend these functions to configure effect calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect_odds_ratio(x, by, conf_level = 0.95)

effect_relative_risk(x, by, conf_level = 0.95)

effect_risk_difference(x, by, conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effect_tabular_+3A_x">x</code></td>
<td>
<p>categorical vector (character, factor, ...)</p>
</td></tr>
<tr><td><code id="effect_tabular_+3A_by">by</code></td>
<td>
<p>categorical vector (of exactly 2 unique levels)</p>
</td></tr>
<tr><td><code id="effect_tabular_+3A_conf_level">conf_level</code></td>
<td>
<p>confidence interval level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with five components: effect, ci, effect.name, effect.type, and conf_level
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>effect_odds_ratio()</code>: (<strong>Default</strong>) calculate the odds ratio
</p>
</li>
<li> <p><code>effect_relative_risk()</code>: calculate the relative risk
</p>
</li>
<li> <p><code>effect_risk_difference()</code>: calculate the risk difference
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crosstable_effect_args">crosstable_effect_args()</a></code>
</p>

<hr>
<h2 id='format_fixed'>Format numbers with the exact same number of decimals, including trailing zeros</h2><span id='topic+format_fixed'></span>

<h3>Description</h3>

<p>Format numbers with the exact same number of decimals, including trailing zeros
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_fixed(
  x,
  digits = 1,
  zero_digits = 1,
  date_format = NULL,
  percent = FALSE,
  is_period = FALSE,
  scientific = getOption("crosstable_scientific_log", 4),
  epsilon = getOption("crosstable_format_epsilon", NULL),
  only_round = getOption("crosstable_only_round", FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_fixed_+3A_x">x</code></td>
<td>
<p>a numeric vector to format</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_digits">digits</code></td>
<td>
<p>number of decimals</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_zero_digits">zero_digits</code></td>
<td>
<p>number of significant digits for values rounded to 0 (can be set to NULL to keep the original 0 value)</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_date_format">date_format</code></td>
<td>
<p>if <code>x</code> is a vector of Date or POSIXt, the format to apply (see <a href="base.html#topic+strptime">strptime</a> for formats)</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_percent">percent</code></td>
<td>
<p>if TRUE, format the values as percentages</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_is_period">is_period</code></td>
<td>
<p>whether <code>x</code> is a period (a numeric value of seconds)</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_scientific">scientific</code></td>
<td>
<p>the power of ten above/under which numbers will be displayed as scientific notation.</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_epsilon">epsilon</code></td>
<td>
<p>values less than <code>epsilon</code> are formatted as <code>"&lt; [epsilon]"</code></p>
</td></tr>
<tr><td><code id="format_fixed_+3A_only_round">only_round</code></td>
<td>
<p>if TRUE, <code>format_fixed</code> simply returns the rounded value. Can be set globally with <code>options("crosstable_only_round"=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="format_fixed_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector of formatted numbers
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1, 1.2, 12.78749, pi, 0.00000012)
format_fixed(x, digits=3) #default zero_digits=1
format_fixed(x, digits=3, zero_digits=2)
format_fixed(x, digits=3, zero_digits=NULL)

x_sd = sd(iris$Sepal.Length/10000, na.rm=TRUE)
format_fixed(x_sd, dig=6)
format_fixed(x_sd, dig=3, zero_digits=2) #default only_round=FALSE
format_fixed(x_sd, dig=3, zero_digits=2, only_round=TRUE)
options("crosstable_only_round"=TRUE)
format_fixed(x_sd, dig=3, zero_digits=2) #override default
options("crosstable_only_round"=NULL)

x2 = c(0.01, 0.1001, 0.500005, 0.00000012)
format_fixed(x2, scientific=0, dig=1) #everything abs&gt;10^0 gets scientific
#last would be 0 so it is scientific. Try `zero_digits=NA` or `dig=7`
format_fixed(x2, scientific=FALSE, dig=6)
format_fixed(x2, scientific=FALSE, percent=TRUE, dig=0)
format_fixed(x2, scientific=FALSE, eps=0.05)
</code></pre>

<hr>
<h2 id='generate_autofit_macro'>Generate a macro file for autofitting</h2><span id='topic+generate_autofit_macro'></span>

<h3>Description</h3>

<p>This function generates a file that can be imported into MS Word in order to use a macro for autofitting all tables in a document at once. This macro file should be imported only once per computer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_autofit_macro()
</code></pre>


<h3>Value</h3>

<p>Nothing, called for its side effects
</p>


<h3>Installation</h3>


<ul>
<li><p> In the <code>R</code> console, run <code>generate_autofit_macro()</code> to generate the file <code>crosstable_autofit.bas</code> in your working directory.
</p>
</li>
<li><p> In MS Word, press Alt+F11 to open the VB Editor.
</p>
</li>
<li><p> In the Editor, go to <code>File</code> &gt; <code>Import</code> or press <code>Ctrl+M</code> to open the import dialog, and import <code>crosstable_autofit.bas</code>. There should now be a &quot;CrosstableMacros&quot; module in the &quot;Normal&quot; project.
</p>
</li>
<li><p> Run the macro, either from the VB Editor or from <code>View</code> &gt; <code>Macros</code> &gt; <code style="white-space: pre;">&#8288;View Macros&#8288;</code> &gt; <code>Run</code>.
</p>
</li></ul>

<p>This process will make the macro accessible from any Word file on this computer. Note that, in the Editor, you can also drag the module to your document project to make the macro accessible only from this file. The file will have to be named with the <code>docm</code> extension though.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='get_label'>Get label if wanted and available, or default (name) otherwise</h2><span id='topic+get_label'></span>

<h3>Description</h3>

<p>Get label if wanted and available, or default (name) otherwise
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_label(x, default = names(x), object = FALSE, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_label_+3A_x">x</code></td>
<td>
<p>labelled object. If <code>x</code> is a list/data.frame, <code>get_label()</code> will return the labels of all children recursively</p>
</td></tr>
<tr><td><code id="get_label_+3A_default">default</code></td>
<td>
<p>value returned if there is no label. Default to <code>names(x)</code>.</p>
</td></tr>
<tr><td><code id="get_label_+3A_object">object</code></td>
<td>
<p>if <code>x</code> is a list/data.frame, <code>object=TRUE</code> will force getting the labels of the object instead of the children</p>
</td></tr>
<tr><td><code id="get_label_+3A_simplify">simplify</code></td>
<td>
<p>if <code>x</code> is a list and <code>object=FALSE</code>, simplify the result to a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector if <code>simplify==TRUE</code>, a list otherwise
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_label">set_label()</a></code>, <code><a href="#topic+import_labels">import_labels()</a></code>, <code><a href="#topic+remove_label">remove_label()</a></code>, <code><a href="Hmisc.html#topic+label">Hmisc::label()</a></code>, <code><a href="expss.html#topic+var_lab">expss::var_lab()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx=mtcars2 %&gt;%
  set_label("The mtcars2 dataset", object=TRUE)
xx$cyl=remove_label(xx$cyl)

#vectors
get_label(xx$mpg) #label="Miles/(US) gallon"
get_label(xx$cyl) #default to NULL (as names(xx$cyl)==NULL)
get_label(xx$cyl, default="Default value")

#data.frames
get_label(xx)
get_label(xx, object=TRUE)
data.frame(name=names(xx), label=get_label(xx, default=NA)) #cyl is NA

#lists
get_label(list(xx$cyl, xx$mpg))
get_label(list(foo=xx$cyl, bar=xx$mpg))
get_label(list(foo=xx$cyl, bar=xx$mpg), default="Default value")
</code></pre>

<hr>
<h2 id='get_percent_pattern'>Percent pattern helper</h2><span id='topic+get_percent_pattern'></span>

<h3>Description</h3>

<p>Get a list with pre-filled values for <code>percent_pattern</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_percent_pattern(
  margin = c("row", "column", "cell", "none", "all"),
  na = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_percent_pattern_+3A_margin">margin</code></td>
<td>
<p>a vector giving the margins to compute.</p>
</td></tr>
<tr><td><code id="get_percent_pattern_+3A_na">na</code></td>
<td>
<p>whether to use <code>NA</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_percent_pattern(c("cells","row","column"))
get_percent_pattern(c("cells","row","column"), na=TRUE)
</code></pre>

<hr>
<h2 id='import_labels'>Import labels</h2><span id='topic+import_labels'></span><span id='topic+save_labels'></span>

<h3>Description</h3>

<p><code>import_labels</code> imports labels from a data.frame (<code>data_label</code>) to another one (<code>.tbl</code>). Works in synergy with <code><a href="#topic+save_labels">save_labels()</a></code>.
</p>
<p><code>save_labels</code> saves the labels from a data.frame in a temporary variable that can be retrieve by <code>import_labels</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_labels(
  .tbl,
  data_label,
  name_from = "name",
  label_from = "label",
  warn_name = FALSE,
  warn_label = FALSE,
  verbose = deprecated()
)

save_labels(.tbl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import_labels_+3A_.tbl">.tbl</code></td>
<td>
<p>the data.frame to be labelled</p>
</td></tr>
<tr><td><code id="import_labels_+3A_data_label">data_label</code></td>
<td>
<p>a data.frame from which to import labels. If missing, the function will take the labels from the last dataframe on which <code><a href="#topic+save_labels">save_labels()</a></code> was called.</p>
</td></tr>
<tr><td><code id="import_labels_+3A_name_from">name_from</code></td>
<td>
<p>in <code>data_label</code>, which column to get the variable name (default to <code>name</code>)</p>
</td></tr>
<tr><td><code id="import_labels_+3A_label_from">label_from</code></td>
<td>
<p>in <code>data_label</code>, which column to get the variable label (default to <code>label</code>)</p>
</td></tr>
<tr><td><code id="import_labels_+3A_warn_name">warn_name</code></td>
<td>
<p>if TRUE, displays a warning if a variable name is not found in <code>data_label</code></p>
</td></tr>
<tr><td><code id="import_labels_+3A_warn_label">warn_label</code></td>
<td>
<p>if TRUE, displays a warning if a label is not found in <code>.tbl</code></p>
</td></tr>
<tr><td><code id="import_labels_+3A_verbose">verbose</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe, as <code>.tbl</code>, with labels
</p>
<p><code>.tbl</code> invisibly. Used only for its side effects.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_label">get_label()</a></code>, <code><a href="#topic+set_label">set_label()</a></code>, <code><a href="#topic+remove_label">remove_label()</a></code>, <code><a href="#topic+save_labels">save_labels()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#import the labels from a data.frame to another
iris_label = data.frame(
  name=c("Sepal.Length", "Sepal.Width",
         "Petal.Length", "Petal.Width", "Species"),
  label=c("Length of Sepals", "Width of Sepals",
          "Length of Petals", "Width of Petals", "Specie name")
)
iris %&gt;%
  import_labels(iris_label) %&gt;%
  crosstable

#save the labels, use some dplyr label-removing function, then retrieve the labels
library(dplyr)
mtcars2 %&gt;%
  save_labels() %&gt;%
  transmute(disp=as.numeric(disp)+1) %&gt;%
  import_labels(warn_label=FALSE) %&gt;% #
  crosstable(disp)
</code></pre>

<hr>
<h2 id='iris2'>Modified <code>iris</code> dataset</h2><span id='topic+iris2'></span>

<h3>Description</h3>

<p>Modified <code>iris</code> dataset so:
</p>

<ul>
<li><p> every column is labelled (using <code>label</code> attribute)
</p>
</li>
<li> <p><code>Species</code> column is considered as factor
</p>
</li></ul>

<p>See <code><a href="datasets.html#topic+iris">iris</a></code> for more informations on the original &quot;Edgar Anderson's Iris Data&quot; dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iris2
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on 5 variables with labels.
</p>


<h3>Source</h3>

<pre>
library(dplyr)
iris2 = iris %&gt;%
    expss::apply_labels( #I also could have used [import_labels] or even `labelled::set_variable_labels()`
        Species = "Specie",
        Sepal.Length = "Length of Sepal",
        Sepal.Width = "Width of Sepal",
        Petal.Length = "Length of Petal",
        Petal.Width = "Width of Petal"
    ) %&gt;%
    as_tibble()
</pre>


<h3>Examples</h3>

<pre><code class='language-R'>library(crosstable)
ct=crosstable(iris2, by=Species)
ct
as_flextable(ct)
</code></pre>

<hr>
<h2 id='is.crosstable'>Test if an object is a crosstable</h2><span id='topic+is.crosstable'></span><span id='topic+is.transposed_crosstable'></span><span id='topic+is.compacted_crosstable'></span><span id='topic+is.multiby_crosstable'></span>

<h3>Description</h3>

<p>Test if an object is a crosstable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.crosstable(x)

is.transposed_crosstable(x)

is.compacted_crosstable(x)

is.multiby_crosstable(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.crosstable_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the object inherits from the <code>crosstable</code> class or other subclasses.
</p>

<hr>
<h2 id='mtcars2'>Modified <code>mtcars</code> dataset</h2><span id='topic+mtcars2'></span>

<h3>Description</h3>

<p>Modified <code>mtcars</code> dataset so:
</p>

<ul>
<li><p> every column is labelled (using <code>label</code> attribute)
</p>
</li>
<li><p> rownames are a character column named <code>model</code>
</p>
</li>
<li> <p><code>gear</code> and <code>cyl</code> columns are considered as numerical factors
</p>
</li>
<li> <p><code>vs</code> and <code>am</code> columns are considered as character vector
</p>
</li></ul>

<p>See <code><a href="datasets.html#topic+mtcars">mtcars</a></code> for more informations on the original &quot;Motor Trend Car Road Tests&quot; dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtcars2
</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on 11 variables with labels.
</p>


<h3>Source</h3>

<pre>
library(dplyr)
mtcars2 = mtcars %&gt;%
    mutate(
       model=rownames(mtcars),
       vs=ifelse(vs==0, "vshaped", "straight"),
       am=ifelse(am==0, "auto", "manual"),
       across(c("cyl", "gear"), factor),
       .before=1
    ) %&gt;%
    expss::apply_labels( #I also could have used [import_labels] or even `labelled::set_variable_labels()`
        mpg="Miles/(US) gallon",
        cyl="Number of cylinders",
        disp="Displacement (cu.in.)",
        hp="Gross horsepower",
        drat="Rear axle ratio",
        wt="Weight (1000 lbs)",
        qsec="1/4 mile time",
        vs="Engine",
        am="Transmission",
        gear="Number of forward gears",
       carb="Number of carburetors"
    )
</pre>


<h3>Examples</h3>

<pre><code class='language-R'>library(crosstable)
ct=crosstable(mtcars2, by=vs)
ct
as_flextable(ct)
</code></pre>

<hr>
<h2 id='N'>Return the number of non NA observations</h2><span id='topic+N'></span>

<h3>Description</h3>

<p>Return the number of non NA observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="N_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer, number of non NA observations
</p>


<h3>Author(s)</h3>

<p>David Hajage
</p>

<hr>
<h2 id='na'>Return the number of NA observations</h2><span id='topic+na'></span>

<h3>Description</h3>

<p>Return the number of NA observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>na(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer, number of NA observations
</p>


<h3>Author(s)</h3>

<p>David Hajage
</p>

<hr>
<h2 id='narm'>Remove missing values</h2><span id='topic+narm'></span>

<h3>Description</h3>

<p>Remove missing values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>narm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="narm_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same vector without missing values
</p>

<hr>
<h2 id='peek'>Open a <code>crosstable</code> in a temporary document</h2><span id='topic+peek'></span>

<h3>Description</h3>

<p>This eases copy-pasting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peek(x, docx = getOption("crosstable_peek_docx", TRUE), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peek_+3A_x">x</code></td>
<td>
<p>a crosstable</p>
</td></tr>
<tr><td><code id="peek_+3A_docx">docx</code></td>
<td>
<p>if true, peek as a <code>docx</code>, else, peek as <code>xlsx</code></p>
</td></tr>
<tr><td><code id="peek_+3A_...">...</code></td>
<td>
<p>passed on to <code>as_flextable.crosstable()</code> or to <code>as_workbook()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for its side effects
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>

<hr>
<h2 id='pivot_crosstable'>Pivot a crosstable</h2><span id='topic+pivot_crosstable'></span>

<h3>Description</h3>

<p>Pivot a crosstable so the <code>variable</code> column is spread across its values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivot_crosstable(ct)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pivot_crosstable_+3A_ct">ct</code></td>
<td>
<p>a crosstable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble of class <code>pivoted_crosstable</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct = crosstable(mtcars2, c(mpg, drat, wt, qsec))
p_ct = pivot_crosstable(ct)
as_flextable(p_ct)
</code></pre>

<hr>
<h2 id='plim'>Format p values (alternative to <code><a href="base.html#topic+format.pval">format.pval()</a></code>)</h2><span id='topic+plim'></span>

<h3>Description</h3>

<p>Format p values (alternative to <code><a href="base.html#topic+format.pval">format.pval()</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plim(p, digits = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plim_+3A_p">p</code></td>
<td>
<p>p values</p>
</td></tr>
<tr><td><code id="plim_+3A_digits">digits</code></td>
<td>
<p>number of digits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>formatted p values
</p>


<h3>Author(s)</h3>

<p>David Hajage
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format.pval">format.pval()</a></code>, https://stackoverflow.com/a/23018806/3888000
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span><span id='topic+everything'></span><span id='topic+all_of'></span><span id='topic+any_of'></span><span id='topic+starts_with'></span><span id='topic+ends_with'></span><span id='topic+contains'></span><span id='topic+matches'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+reexports">%&gt;%</a></code>, <code><a href="dplyr.html#topic+reexports">all_of</a></code>, <code><a href="dplyr.html#topic+reexports">any_of</a></code>, <code><a href="dplyr.html#topic+reexports">contains</a></code>, <code><a href="dplyr.html#topic+reexports">ends_with</a></code>, <code><a href="dplyr.html#topic+reexports">everything</a></code>, <code><a href="dplyr.html#topic+reexports">matches</a></code>, <code><a href="dplyr.html#topic+reexports">starts_with</a></code></p>
</dd>
</dl>

<hr>
<h2 id='remove_labels'>Remove all label attributes.</h2><span id='topic+remove_labels'></span><span id='topic+remove_label'></span>

<h3>Description</h3>

<p>Use <code>remove_labels()</code> to remove the label from an object or to recursively remove all the labels from a collection of objects (such as a list or a data.frame). <br /> <br /> This can be useful with functions reacting badly to labelled objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_labels(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_labels_+3A_x">x</code></td>
<td>
<p>object to unlabel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as <code>x</code>, with no labels
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><a href="#topic+get_label">get_label</a>, <a href="#topic+set_label">set_label</a>, <a href="#topic+import_labels">import_labels</a>, <a href="expss.html#topic+unlab">expss::unlab</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mtcars2 %&gt;% remove_labels %&gt;% crosstable(mpg) #no label
mtcars2$hp %&gt;% remove_labels %&gt;% get_label() #NULL
</code></pre>

<hr>
<h2 id='rename_with_labels'>Rename every column of a dataframe with its label</h2><span id='topic+rename_with_labels'></span><span id='topic+rename_dataframe_with_labels'></span>

<h3>Description</h3>

<p>Rename every column of a dataframe with its label
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_with_labels(df, except = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rename_with_labels_+3A_df">df</code></td>
<td>
<p>a data.frame</p>
</td></tr>
<tr><td><code id="rename_with_labels_+3A_except">except</code></td>
<td>
<p>&lt;<code><a href="tidyselect.html#topic+language">tidy-select</a></code>&gt; columns that should not be renamed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe which names are copied from the label attribute
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Source</h3>

<p>https://stackoverflow.com/q/75848408/3888000
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rename_with_labels(mtcars2[,1:5], except=5) %&gt;% names()
rename_with_labels(iris2, except=Sepal.Length) %&gt;% names()
rename_with_labels(iris2, except=starts_with("Pet")) %&gt;% names()
</code></pre>

<hr>
<h2 id='set_label'>Set the &quot;label&quot; attribute of an object</h2><span id='topic+set_label'></span><span id='topic+copy_label_from'></span>

<h3>Description</h3>

<p>Set the &quot;label&quot; attribute of an object
</p>
<p>Copy the label from one variable to another
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_label(x, value, object = FALSE)

copy_label_from(x, from)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_label_+3A_x">x</code></td>
<td>
<p>the variable to label</p>
</td></tr>
<tr><td><code id="set_label_+3A_value">value</code></td>
<td>
<p>value of the label. If <code>x</code> is a list/data.frame, the labels will all be set recursively. If <code>value</code> is a function, it will be applied to the current labels of <code>x</code>.</p>
</td></tr>
<tr><td><code id="set_label_+3A_object">object</code></td>
<td>
<p>if <code>x</code> is a list/data.frame, <code>object=TRUE</code> will force setting the labels of the object instead of the children</p>
</td></tr>
<tr><td><code id="set_label_+3A_from">from</code></td>
<td>
<p>the variable whose label must be copied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as <code>x</code>, with labels
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_label">get_label()</a></code>, <code><a href="#topic+import_labels">import_labels()</a></code>, <code><a href="#topic+remove_label">remove_label()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
mtcars %&gt;%
   mutate(mpg2=set_label(mpg, "Miles per gallon"),
          mpg3=mpg %&gt;% copy_label_from(mpg2)) %&gt;%
   crosstable(c(mpg, mpg2, mpg3))
mtcars %&gt;%
   copy_label_from(mtcars2) %&gt;%
   crosstable(c(mpg, vs))
mtcars2 %&gt;% set_label(toupper) %&gt;% get_label()
</code></pre>

<hr>
<h2 id='summaryFunctions'>Summary functions</h2><span id='topic+summaryFunctions'></span><span id='topic+meansd'></span><span id='topic+moystd'></span><span id='topic+meanCI'></span><span id='topic+mediqr'></span><span id='topic+minmax'></span><span id='topic+nna'></span>

<h3>Description</h3>

<p>Summary functions to use with <code><a href="#topic+crosstable">crosstable()</a></code> or anywhere else.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meansd(x, na.rm = TRUE, dig = 2, ...)

meanCI(x, na.rm = TRUE, dig = 2, level = 0.95, format = TRUE, ...)

mediqr(x, na.rm = TRUE, dig = 2, format = TRUE, ...)

minmax(x, na.rm = TRUE, dig = 2, ...)

nna(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summaryFunctions_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="summaryFunctions_+3A_na.rm">na.rm</code></td>
<td>
<p><code>TRUE</code> as default</p>
</td></tr>
<tr><td><code id="summaryFunctions_+3A_dig">dig</code></td>
<td>
<p>number of digits</p>
</td></tr>
<tr><td><code id="summaryFunctions_+3A_...">...</code></td>
<td>
<p>params to pass on to <code><a href="#topic+format_fixed">format_fixed()</a></code>:
</p>

<ul>
<li> <p><code>zero_digits</code> (default=<code>1</code>): the number of significant digits for values rounded to 0 (set to NULL to keep the original 0 value)
</p>
</li>
<li> <p><code>only_round</code> (default=<code>FALSE</code>): use <code><a href="base.html#topic+round">round()</a></code> instead of <code><a href="#topic+format_fixed">format_fixed()</a></code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="summaryFunctions_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="summaryFunctions_+3A_format">format</code></td>
<td>
<p>a sugar argument. If FALSE, the function returns a list instead of a formatted string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>meansd()</code>: returns mean and std error
</p>
</li>
<li> <p><code>meanCI()</code>: returns mean and confidence interval
</p>
</li>
<li> <p><code>mediqr()</code>: returns median and IQR
</p>
</li>
<li> <p><code>minmax()</code>: returns minimum and maximum
</p>
</li>
<li> <p><code>nna()</code>: returns  number of observations and number of missing values
</p>
</li></ul>


<h3>Fixed format</h3>

<p>These functions use <code><a href="#topic+format_fixed">format_fixed()</a></code> which allows to have trailing zeros after rounded values.
In the case when the output of rounded values is zero, the use of the <code>zero_digits</code> argument allows to keep some significant digits for this specific case only.
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>


<h3>See Also</h3>

<p><code><a href="#topic+format_fixed">format_fixed()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>meansd(iris$Sepal.Length, dig=3)
meanCI(iris$Sepal.Length)
minmax(iris$Sepal.Length, dig=3)
mediqr(iris$Sepal.Length, dig=3)
nna(iris$Sepal.Length)

#arguments for format_fixed
x = iris$Sepal.Length/10000 #closer to zero

meansd(x, dig=3)
meansd(x, dig=3, zero_digits=NULL) #or NA
meansd(x, dig=3, only_round=TRUE)
options("crosstable_only_round"=TRUE)
meansd(x, dig=3, zero_digits=2)
options("crosstable_only_round"=NULL)
meanCI(mtcars2$x_date)

#dates
x = as.POSIXct(mtcars$qsec*3600*24 , origin="2010-01-01")
meansd(x)
minmax(x, date_format="%d/%m/%Y")

</code></pre>

<hr>
<h2 id='test_correlation_auto'>test for correlation coefficients</h2><span id='topic+test_correlation_auto'></span>

<h3>Description</h3>

<p>test for correlation coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_correlation_auto(x, by, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_correlation_auto_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="test_correlation_auto_+3A_by">by</code></td>
<td>
<p>another vector</p>
</td></tr>
<tr><td><code id="test_correlation_auto_+3A_method">method</code></td>
<td>
<p>&quot;pearson&quot;, &quot;kendall&quot;, or &quot;spearman&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the correlation test with appropriate method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>

<hr>
<h2 id='test_summarize_auto'>test for mean comparison</h2><span id='topic+test_summarize_auto'></span>

<h3>Description</h3>

<p>Compute a oneway.test (with equal or unequal variance) or a
kruskal.test as appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_summarize_auto(x, g)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_summarize_auto_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="test_summarize_auto_+3A_g">g</code></td>
<td>
<p>another vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components: p.value and method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>

<hr>
<h2 id='test_summarize_linear_contrasts'>Test for linear trend across ordered factor with contrasts</h2><span id='topic+test_summarize_linear_contrasts'></span>

<h3>Description</h3>

<p>Test for linear trend across ordered factor with contrasts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_summarize_linear_contrasts(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_summarize_linear_contrasts_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="test_summarize_linear_contrasts_+3A_y">y</code></td>
<td>
<p>ordered factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components: p.value and method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
my_test_args=crosstable_test_args()
my_test_args$test_summarize = test_summarize_linear_contrasts
iris %&gt;%
  mutate(Petal.Width.qt = paste0("Q", ntile(Petal.Width, 5)) %&gt;% ordered()) %&gt;%
  crosstable(Petal.Length ~ Petal.Width.qt, test=TRUE, test_args = my_test_args)
</code></pre>

<hr>
<h2 id='test_survival_logrank'>test for survival comparison</h2><span id='topic+test_survival_logrank'></span>

<h3>Description</h3>

<p>Compute a logrank test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_survival_logrank(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_survival_logrank_+3A_formula">formula</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components: p.value and method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>

<hr>
<h2 id='test_tabular_auto'>test for contingency table</h2><span id='topic+test_tabular_auto'></span>

<h3>Description</h3>

<p>Compute a chisq.test, a chisq.test with correction of continuity
or a fisher test as appropriate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_tabular_auto(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_tabular_auto_+3A_x">x</code></td>
<td>
<p>vector</p>
</td></tr>
<tr><td><code id="test_tabular_auto_+3A_y">y</code></td>
<td>
<p>another vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with two components: p.value and method
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel, David Hajage
</p>

<hr>
<h2 id='transpose_crosstable'>Transpose a crosstable</h2><span id='topic+transpose_crosstable'></span><span id='topic+t.crosstable'></span>

<h3>Description</h3>

<p>Pivot a crosstable so the <code>label</code> column is swapped with the <code>by</code> row.
This requires the <code>variable</code> column to be the same for every data column, like when all columns are numeric of when all columns are factors with the same levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transpose_crosstable(x)

## S3 method for class 'crosstable'
t(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transpose_crosstable_+3A_x">x</code></td>
<td>
<p>a crosstable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble of class <code>transposed_crosstable</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ct = crosstable(mtcars2, c(mpg, drat, wt, qsec), by=am)
t_ct = t(ct)
as_flextable(t_ct)
</code></pre>

<hr>
<h2 id='write_and_open'>Alternative to default <code>officer</code> print() function. Write the file and try to open it right away.</h2><span id='topic+write_and_open'></span>

<h3>Description</h3>

<p>As it tests if the file is writable, this function also prevents <code>officer:::print.rdocx()</code> to abort the RStudio session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_and_open(doc, docx.file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_and_open_+3A_doc">doc</code></td>
<td>
<p>the docx object</p>
</td></tr>
<tr><td><code id="write_and_open_+3A_docx.file">docx.file</code></td>
<td>
<p>the name of the target file. If missing or NULL, the doc will open in a temporary file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for its side effects
</p>


<h3>Author(s)</h3>

<p>Dan Chaltiel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer)
library(crosstable)
mytable = crosstable(mtcars2)
doc = read_docx() %&gt;%
    body_add_crosstable(mytable)

write_and_open(doc)
## Not run: 
write_and_open(doc, "example.docx")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
