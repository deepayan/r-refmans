<!DOCTYPE html><html lang="en"><head><title>Help for package crossmatch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {crossmatch}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crossmatchdist'>
<p>The Exact Null Distribution Of The Cross-match Statistic Under The Null</p></a></li>
<li><a href='#crossmatchtest'><p>The Cross-Match Test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Cross-Match Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs the cross-match test that is an exact, 
		distribution free test of equality of 2 high dimensional multivariate distributions.   
		The input is a distance matrix and the labels of
        the two groups to be compared, the output is the number of
        cross-matches and a p-value. See Rosenbaum (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2005.00513.x">doi:10.1111/j.1467-9868.2005.00513.x</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>nbpMatching</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-18 07:54:28 UTC; ligges</td>
</tr>
<tr>
<td>Author:</td>
<td>Ruth Heller [aut, cph],
  Dylan Small [aut, cph],
  Paul Rosenbaum [aut, cph],
  Marieke Stolte [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marieke Stolte &lt;stolte@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-21 08:00:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='crossmatchdist'>
The Exact Null Distribution Of The Cross-match Statistic Under The Null
</h2><span id='topic+crossmatchdist'></span>

<h3>Description</h3>

<p>The exact null distribution of the number of crossmatches for <code>bigN&gt;=4</code> cases, 
<code>n&gt;=2</code> from one type and <code>N-n&gt;=2</code> from another type. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossmatchdist(bigN, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crossmatchdist_+3A_bign">bigN</code></td>
<td>

<p>The total number of observations
</p>
</td></tr>
<tr><td><code id="crossmatchdist_+3A_n">n</code></td>
<td>

<p>The number of cases from one type
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bigN</code> is even. Let a1 be the number of cross-matches pairs. Then <code>a2=(n-a1)/2</code> and
<code>a0=bigN/2-(n+a1)/2</code> are the number of pairs both of one type and the other type 
respectively.   
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dist</code></td>
<td>
<p>A matrix with rows <code>a0, a1, a2, Pr(A1=a1)</code> and <code>Pr(A1&lt;=a1)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ruth Heller
</p>


<h3>References</h3>

<p>Rosenbaum, P.R. (2005),
An exact distribution-free test comparing two multivariate distributions based on adjacency,
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>67</b>, 4, 515-530.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crossmatchdist(18,9)
</code></pre>

<hr>
<h2 id='crossmatchtest'>The Cross-Match Test</h2><span id='topic+crossmatchtest'></span>

<h3>Description</h3>

<p>A test for comparing two multivariate distributions by using the distance between the observations. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossmatchtest(z, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crossmatchtest_+3A_z">z</code></td>
<td>
<p>A binary vector corresponding to observations class labels.</p>
</td></tr>
<tr><td><code id="crossmatchtest_+3A_d">D</code></td>
<td>
<p>A distance matrix of dimensions NxN, where N is the total number of observations. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Observations are divided into pairs to minimize the total distance within pairs, using a polynomial
time algorithm made available in R by Lu, B., Greevy, R., Xu, X., and Beck, C in the R package &quot;nbpMatching&quot;.
The cross-match test takes as the test statistic the number of times a subject from one group was
paired with a subject from another group, rejecting the hypothesis of equal distribution for small values
of the statistic; see Rosenbaum (2005) for details. 
</p>


<h3>Value</h3>

<p>A list with the following
</p>
<table role = "presentation">
<tr><td><code>a1</code></td>
<td>
<p>The number of cross-matches</p>
</td></tr>
<tr><td><code>Ea1</code></td>
<td>
<p>The expected number of cross-matches under the null</p>
</td></tr>
<tr><td><code>Va1</code></td>
<td>
<p>The variance of number of cross-matches under the null</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>The observed difference from expectation under null in SE units</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The p-value based on exact null distribution (NA for datasets with 340 observations or more)</p>
</td></tr>
<tr><td><code>approxpval</code></td>
<td>
<p>The approximate p-value based on normal approximation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ruth Heller 
</p>


<h3>References</h3>

<p>Rosenbaum, P.R. (2005),
An exact distribution-free test comparing two multivariate distributions based on adjacency,
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>67</b>, 4, 515-530.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The example in Section 2 of the article (see References)

#The data consists of 2 outcomes measured on 9 treated cases and 9 controls: 
dat &lt;- rbind(c(0.47,0.39,0.47,0.78,1,1,0.54,1,0.38,1,0.27,0.63,0.22,0,-1,-0.42,-1,-1),
             c(0.03,0.11,0.16,-0.1,-0.05,0.16,0.12,0.4,0.04,0.71,0.01,0.21,-0.18,
               -0.08,-0.35,0.26,-0.6,-1.0))
z &lt;- c(rep(0,9),rep(1,9))
X &lt;- t(dat)

## Rank based Mahalanobis distance between each pair:
X &lt;- as.matrix(X)
n &lt;- dim(X)[1]
k &lt;- dim(X)[2]
for (j in 1:k) X[,j] &lt;- rank(X[,j])
cv &lt;- cov(X)
vuntied &lt;- var(1:n)
rat &lt;- sqrt(vuntied/diag(cv))
cv &lt;- diag(rat) %*% cv %*% diag(rat)
out &lt;- matrix(NA,n,n)

library(MASS)

icov &lt;- ginv(cv)
for (i in 1:n) out[i,] &lt;- mahalanobis(X,X[i,],icov,inverted=TRUE)

dis &lt;- out

## The cross-match test:

crossmatchtest(z,dis)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
