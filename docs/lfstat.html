<!DOCTYPE html><html lang="en-GB"><head><title>Help for package lfstat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lfstat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lfstat-package'>
<p>Calculation of Low Flow Statistics for Daily Stream Flow Data</p></a></li>
<li><a href='#apply.seasonal'>
<p>Apply an aggregation function seasonally.</p></a></li>
<li><a href='#as.lfobj'>
<p>Coerce to class <code>'lfobj'</code></p></a></li>
<li><a href='#as.xts.lfobj'>
<p>Convert Object To Class <code>'xts'</code></p></a></li>
<li><a href='#baseflow'><p>Calculate the base flow of a river</p></a></li>
<li><a href='#BFI'>
<p>Base Flow Index</p></a></li>
<li><a href='#bfplot'>
<p>Base Flow Plot</p></a></li>
<li><a href='#check_distribution'><p>Checks if a Distribution is suited</p></a></li>
<li><a href='#createlfobj'>
<p>Create an low flow object for further Low Flow Analysis</p></a></li>
<li><a href='#dmcurve'>
<p>Double Mass Curve</p></a></li>
<li><a href='#ev_return_period'>
<p>Estimate the return period for given quantiles</p></a></li>
<li><a href='#evfit'><p>Fit an extreme value distribution to observations</p></a></li>
<li><a href='#evquantile'><p>Estimating populations quantiles of extreme values</p></a></li>
<li><a href='#fdc'>
<p>Flow Duration Curve</p></a></li>
<li><a href='#fill_na'>
<p>Interpolation NA values in a vector</p></a></li>
<li><a href='#find_droughts'><p>Identifying Low Flow Periods</p></a></li>
<li><a href='#flowunit'><p>Set and retrieve unit of the discharge</p></a></li>
<li><a href='#gringorten'>
<p>Gringorten Plotting Positions</p></a></li>
<li><a href='#hydrograph'>
<p>Hydrograph</p></a></li>
<li><a href='#hyear_start'>
<p>Extract or guess the Start of a Hydrological Year</p></a></li>
<li><a href='#lfnacheck'>
<p>Low flow object check for missing values.</p></a></li>
<li><a href='#lfnainterpolate'>
<p>Interpolate missing values</p></a></li>
<li><a href='#ma'><p>Simple Moving Average</p></a></li>
<li><a href='#MAM'>
<p>Mean Annual Minimum</p></a></li>
<li><a href='#meanflow'>
<p>Mean flow</p></a></li>
<li><a href='#multistationsreport'>
<p>Report for several stations</p></a></li>
<li><a href='#ngaruroro'><p>Daily stream flow data used for low flow analysis</p></a></li>
<li><a href='#plot.deficit'><p>Plot time series of deficits</p></a></li>
<li><a href='#pooling'><p>Pooling Procedures of Low Flow Events</p></a></li>
<li><a href='#Qxx'>
<p>Qxx, Q95, Q90, Q70</p></a></li>
<li><a href='#readlfdata'>
<p>Reads data sheets</p></a></li>
<li><a href='#recession'>
<p>Recession Constant</p></a></li>
<li><a href='#recessionplot'>
<p>Recession diagnostic plot</p></a></li>
<li><a href='#reversing'><p>Reversed functions for several Extreme Value Distributions</p></a></li>
<li><a href='#rfa'><p>Regional Frequency Analysis</p></a></li>
<li><a href='#rfaplot'><p>Regional Frequency Analysis</p></a></li>
<li><a href='#rpline'><p>Highlight quantiles/return periods</p></a></li>
<li><a href='#sbplot'>
<p>Seasonal Bar Chart</p></a></li>
<li><a href='#seasindex'>
<p>Seasonality Index</p></a></li>
<li><a href='#season'>
<p>Attribute dates to seasons</p></a></li>
<li><a href='#seasratio'>
<p>Seasonality Ratio</p></a></li>
<li><a href='#seglenplot'>
<p>Bar chart of recession length</p></a></li>
<li><a href='#setlfunit'>
<p>Define the unit to use in low flow plots</p></a></li>
<li><a href='#streamdef'>
<p>Streamflow Deficit</p></a></li>
<li><a href='#streamdefplot'>
<p>Streamflow Deficit Plot</p></a></li>
<li><a href='#summary.deficit'><p>Object Summaries</p></a></li>
<li><a href='#trace_value'><p>Draw Paths to Points perpendicular to Coordinate Axis</p></a></li>
<li><a href='#tyears'>
<p>Calculate Low-Flow Quantiles for given Return Periods</p></a></li>
<li><a href='#tyearsS'>
<p>Calculate Low-Flow Quantiles for given Return Periods</p></a></li>
<li><a href='#vary_threshold'><p>Create varying thresholds</p></a></li>
<li><a href='#water_year'><p>Compute the water year</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculation of Low Flow Statistics for Daily Stream Flow Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-06</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mundl/lfstat/issues">https://github.com/mundl/lfstat/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>The "Manual on Low-flow Estimation and Prediction" (Gustard &amp; Demuth (2009, ISBN:978-92-63-11029-9)), published by the World Meteorological Organisation, gives a comprehensive summary on how to analyse stream flow data focusing on low-flows. This packages provides functions to compute the described statistics and produces plots similar to the ones in the manual. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), xts, lmom, lattice</td>
</tr>
<tr>
<td>Imports:</td>
<td>lmomRFA, dygraphs, zoo, latticeExtra, plyr, scales</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-06 18:44:34 UTC; tobi</td>
</tr>
<tr>
<td>Author:</td>
<td>Tobias Gauster [ctb, cre],
  Gregor Laaha <a href="https://orcid.org/0000-0002-6793-9640"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Daniel Koffler [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tobias Gauster &lt;t.gauster@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-08 10:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='lfstat-package'>
Calculation of Low Flow Statistics for Daily Stream Flow Data
</h2><span id='topic+lfstat-package'></span><span id='topic+lfstat'></span>

<h3>Description</h3>

<p>The &quot;Manual on Low-flow Estimation and Prediction&quot; (Gustard &amp; Demuth (2009, ISBN:978-92-63-11029-9)), published by the World Meteorological Organisation, gives a comprehensive summary on how to analyse stream flow data focusing on low-flows. This packages provides functions to compute the described statistics and produces plots similar to the ones in the manual. 
</p>


<h3>Details</h3>



<h4>Create an object of class <code>lfobj</code> (Low-Flow-Objects)</h4>

<p>The package calculates indices and makes graphics for low flow
analysis. It brings its own class <code>'lfobj'</code>, a special data.frame format
with columns <code>'day'</code>, <code>'month'</code>, <code>'year'</code>, <code>'flow'</code>, <code>'hyear'</code> and possibly <code>'baseflow'</code>.
</p>
<p><code>'day'</code>, <code>'month'</code> and <code>'year'</code> refer to the date, <code>'flow'</code> is the measured
runoff (unit-independent), <code>'baseflow'</code> the calculated base flow.
</p>
<p><code>'hyear'</code> refers to the hydrological year. When creating the <code>'lfobj'</code> you
define the month where the stations hydrological year starts. If annual indices are
calculated or single years are plotted, the <code>'hyear'</code> is taken.
</p>
<p>Basically there are to options to create an low flow object:
</p>
<p>If you have special data format, e.g. <abbr><span class="acronym">GRDC</span></abbr>, you can use the function
<code><a href="#topic+readlfdata">readlfdata</a></code>, see <code>?readlfdata</code> to see which formats are currently
supported.
Otherwise you can use <code><a href="#topic+createlfobj">createlfobj</a></code>. You can apply it for new data in
one of two ways:
1) You create a data.frame with columns: <code>'day'</code>, <code>'month'</code>, <code>'year'</code> and
<code>'flow'</code>.
2) You create a time-series (<code>'ts'</code>) from <code>'flow'</code> and give the start date of
the series when calling <code>'createlfobj'</code>.
</p>



<h4>Preparation</h4>

<p>lfstat does not need to know the unit of the flow, but you might want it
to appear in your plots. You can use <code><a href="#topic+setlfunit">setlfunit</a></code> to define how units are
labelled in your graphics. Examples are given in <code>'?setlfunit'</code>.
</p>
<p>Please check for NA-values using <code><a href="#topic+lfnacheck">lfnacheck</a></code>, indices and plots are made
as if series were complete. See the manual on how to deal with missing
values and, if reasonable, use <code><a href="#topic+lfnainterpolate">lfnainterpolate</a></code>.
</p>



<h4>Available Indices</h4>


<ul>
<li> <p><code><a href="#topic+meanflow">meanflow</a></code>
</p>
</li>
<li> <p><code><a href="#topic+Qxx">Qxx</a></code>
</p>
</li>
<li> <p><code><a href="#topic+MAM">MAM</a></code> (mean annual minima)
</p>
</li>
<li> <p><code><a href="#topic+BFI">BFI</a></code>
</p>
</li>
<li> <p><code><a href="#topic+recession">recession</a></code> (recession constant)
</p>
</li>
<li> <p><code><a href="#topic+streamdef">streamdef</a></code> (Streamflow deficit)
</p>
</li>
<li> <p><code><a href="#topic+tyears">tyears</a></code> (Extreme value - T-years event)
</p>
</li>
<li> <p><code><a href="#topic+seasratio">seasratio</a></code>
</p>
</li>
<li> <p><code><a href="#topic+seasindex">seasindex</a></code>
</p>
</li>
<li> <p><code><a href="#topic+multistationsreport">multistationsreport</a></code>
</p>
</li></ul>




<h4>Plots</h4>


<ul>
<li> <p><code><a href="#topic+hydrograph">hydrograph</a></code>
</p>
</li>
<li> <p><code><a href="#topic+recessionplot">recessionplot</a></code> (Diagnosis for recession)
</p>
</li>
<li> <p><code><a href="#topic+fdc">fdc</a></code> (Flow-duration-curve)
</p>
</li>
<li> <p><code><a href="#topic+sbplot">sbplot</a></code> (seasonal bar chart)
</p>
</li>
<li> <p><code><a href="#topic+seglenplot">seglenplot</a></code> (select recession length for <code><a href="#topic+recession">recession</a></code>)
</p>
</li>
<li> <p><code><a href="#topic+streamdefplot">streamdefplot</a></code> (Streamflow deficit)
</p>
</li>
<li> <p><code><a href="#topic+rfa">rfa</a></code> (Regional frequency analysis)
</p>
</li>
<li> <p><code><a href="#topic+dmcurve">dmcurve</a></code> (Double mass curve)
</p>
</li></ul>



<p>Index of help topics:
</p>
<pre>
BFI                     Base Flow Index
MAM                     Mean Annual Minimum
Qxx                     Qxx, Q95, Q90, Q70
apply.seasonal          Apply an aggregation function seasonally.
as.lfobj                Coerce to class "lfobj"
as.xts.lfobj            Convert Object To Class "xts"
baseflow                Calculate the base flow of a river
bfplot                  Base Flow Plot
check_distribution      Checks if a Distribution is suited
createlfobj             Create an low flow object for further Low Flow
                        Analysis
dmcurve                 Double Mass Curve
ev_return_period        Estimate the return period for given quantiles
evfit                   Fit an extreme value distribution to
                        observations
evquantile              Estimating populations quantiles of extreme
                        values
fdc                     Flow Duration Curve
fill_na                 Interpolation NA values in a vector
find_droughts           Identifying Low Flow Periods
flowunit                Set and retrieve unit of the discharge
gringorten              Gringorten Plotting Positions
hydrograph              Hydrograph
hyear_start             Extract or guess the Start of a Hydrological
                        Year
lfnacheck               Low flow object check for missing values.
lfnainterpolate         Interpolate missing values
lfstat-package          Calculation of Low Flow Statistics for Daily
                        Stream Flow Data
ma                      Simple Moving Average
meanflow                Mean flow
multistationsreport     Report for several stations
ngaruroro               Daily stream flow data used for low flow
                        analysis
plot.deficit            Plot time series of deficits
pooling                 Pooling Procedures of Low Flow Events
readlfdata              Reads data sheets
recession               Recession Constant
recessionplot           Recession diagnostic plot
reversing               Reversed functions for several Extreme Value
                        Distributions
rfa                     Regional Frequency Analysis
rfaplot                 Regional Frequency Analysis
rpline                  Highlight quantiles/return periods
sbplot                  Seasonal Bar Chart
seasindex               Seasonality Index
season                  Attribute dates to seasons
seasratio               Seasonality Ratio
seglenplot              Bar chart of recession length
setlfunit               Define the unit to use in low flow plots
streamdef               Streamflow Deficit
streamdefplot           Streamflow Deficit Plot
summary.deficit         Object Summaries
trace_value             Draw Paths to Points perpendicular to
                        Coordinate Axis
tyears                  Calculate Low-Flow Quantiles for given Return
                        Periods
tyearsS                 Calculate Low-Flow Quantiles for given Return
                        Periods
vary_threshold          Create varying thresholds
water_year              Compute the water year
</pre>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: NA
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p. <a href="https://library.wmo.int/doc_num.php?explnum_id=7699">https://library.wmo.int/doc_num.php?explnum_id=7699</a>
</p>

<hr>
<h2 id='apply.seasonal'>
Apply an aggregation function seasonally.
</h2><span id='topic+apply.seasonal'></span>

<h3>Description</h3>

<p>Similar to the functions <code><a href="xts.html#topic+apply.daily">apply.daily</a></code>, <code><a href="xts.html#topic+apply.monthly">apply.monthly</a></code>, <code><a href="xts.html#topic+apply.yearly">apply.yearly</a></code> etc. from the <span class="pkg">xts</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply.seasonal(x, varying, fun = function(x) min(x, na.rm = TRUE),
               aggregate = NULL, replace.inf = TRUE, origin = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply.seasonal_+3A_x">x</code></td>
<td>
<p>an object of class <code>'xts'</code> or <code>'zoo'</code>. The time series which should get aggregated.</p>
</td></tr>
<tr><td><code id="apply.seasonal_+3A_varying">varying</code></td>
<td>
<p>a character vector of length one of a possibly named vector of class  <code>'Date'</code> or coercible to  <code>'Date'</code>. Valid character vectors are <code>"daily"</code>, <code>"weekly"</code>, <code>"monthly"</code> or <code>"constant"</code>. If of class  <code>'Date'</code>, the elements are considered as start points of a season. See Examples.</p>
</td></tr>
<tr><td><code id="apply.seasonal_+3A_fun">fun</code></td>
<td>
<p>the function used for aggregating all elements of a season.</p>
</td></tr>
<tr><td><code id="apply.seasonal_+3A_aggregate">aggregate</code></td>
<td>
<p>possibly a function used for aggregating per season.</p>
</td></tr>
<tr><td><code id="apply.seasonal_+3A_replace.inf">replace.inf</code></td>
<td>
<p>should non-finite values introduced by <code>fun</code> be omitted?</p>
</td></tr>
<tr><td><code id="apply.seasonal_+3A_origin">origin</code></td>
<td>
<p>The start of the hydrological year. If set to 1 (the default) aggregation is carried out using the calendar year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with every (hydrological) year being a row and every column being a season.</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(ngaruroro)
 ng &lt;- as.xts(ngaruroro)

 year &lt;- water_year(time(ng), origin = "Sept")
 ng10 &lt;- ng[year %in% 1991:2000, ]

 # computes the annual minima (AM)
 apply.seasonal(ng10, varying = "yearly", origin = 9)

 # computes the mean annual minima (MAM)
 apply.seasonal(ng10, varying = "yearly", aggregate = mean, origin = 9)

 # computes monthly minima (AM)
 apply.seasonal(ng10, varying = "monthly", origin = 9)

 # computes minima for summer and winter separately
 # winter starts in September
 seasons &lt;- as.Date(c("1999-09-01", "1999-11-04"))
 names(seasons) &lt;- c("winter", "summer")
 apply.seasonal(ng10$discharge, varying = seasons, origin = 9)
</code></pre>

<hr>
<h2 id='as.lfobj'>
Coerce to class <code>'lfobj'</code>
</h2><span id='topic+as.lfobj'></span><span id='topic+as.lfobj.xts'></span><span id='topic+as.lfobj.zoo'></span><span id='topic+is.lfobj'></span>

<h3>Description</h3>

<p>Functions to check if object is of class <code>'fobj'</code> or coerce it if possible. Currently, only methods for <code>'zoo'</code> and <code>'xts'</code> exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.lfobj(x, ...)
is.lfobj(x)
## S3 method for class 'xts'
as.lfobj(x, ...)
## S3 method for class 'zoo'
as.lfobj(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.lfobj_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="as.lfobj_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>'lfobj'</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createlfobj">createlfobj</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ngaruroro)
is.lfobj(ngaruroro)

# coerce zoo object to class \code{'lfobj'}
z1 &lt;- zoo(1:10, order.by = seq(Sys.Date(), length.out = 10, by = "days"))
as.lfobj(z1, hyearstart = 5)

# coerce xts object to class \code{'lfobj'}
xts1 &lt;- xts(1:10, order.by = seq(Sys.Date(), length.out = 10, by = "days"))
as.lfobj(xts1, hyearstart = 5)



</code></pre>

<hr>
<h2 id='as.xts.lfobj'>
Convert Object To Class <code>'xts'</code>
</h2><span id='topic+as.xts.lfobj'></span>

<h3>Description</h3>

<p>Conversion function to coerce data objects of classes <code>'lfobj'</code> to class <code>'xts'</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lfobj'
as.xts(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.xts.lfobj_+3A_x">x</code></td>
<td>

<p>an object of class <code>'lfobj'</code>.
</p>
</td></tr>
<tr><td><code id="as.xts.lfobj_+3A_...">...</code></td>
<td>

<p>additional parameters or attributes
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object of class <code>'xts'</code>.</p>


<h3>See Also</h3>

<p><code><a href="xts.html#topic+as.xts">as.xts</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ray)
r &lt;- as.xts(ray)

# attributes of the lfobject are retained
attr(ray, "lfobj")
xtsAttributes(r)
</code></pre>

<hr>
<h2 id='baseflow'>Calculate the base flow of a river</h2><span id='topic+baseflow'></span>

<h3>Description</h3>

<p>Given a stream flow hydrograph of flows (regular time series), the base flow is separated. The minima of a period (default <code>block.len = 5)</code> is calculated and turning points are identified. At turning points the base flow equals the actual flow, in between, linear interpolation is carried out. </p>


<h3>Usage</h3>

<pre><code class='language-R'>baseflow(x, tp.factor = 0.9, block.len = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="baseflow_+3A_x">x</code></td>
<td>
<p>numeric vector containing flows</p>
</td></tr>
<tr><td><code id="baseflow_+3A_tp.factor">tp.factor</code></td>
<td>
<p>numeric vector of length one. Towards high flows, allow the
central value of three consecutive minima only to be of a factor
<code>(1 - tp.factor)</code> higher than the surrounding values</p>
</td></tr>
<tr><td><code id="baseflow_+3A_block.len">block.len</code></td>
<td>
<p>numeric vector of length one. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of <code>length(x)</code>. It contains <code>NA</code>s as until the
first turning point, the base flow cannot be determined.</p>


<h3>References</h3>

<p>Tallaksen, L. M. and  Van Lanen, H. A. J. 2004 Hydrological Drought: Processes and Estimation Methods for Streamflow and Groundwater. <em>Developments in Water Science</em> <b>48</b>, Amsterdam: Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## reproducing Tallaksen and van Lanen (2004)
## Example 5.3 Base Flow Index"

data(ray)
ray &lt;- as.xts(ray)

# calculate base flow and plot it
ray$baseflow &lt;- baseflow(ray$discharge)
ray96 &lt;- ray[format(time(ray), "%Y") == "1996", ]
plot(ray96$discharge, type = "l")
lines(ray96$baseflow, col = 2)

# aggregated base flows for river Ray
# these are mean flow totals per day, not per year as written
# in Tallaksen and van Lanen (2004)
round(colSums(ray96[, c("discharge", "baseflow")]), 2)
</code></pre>

<hr>
<h2 id='BFI'>
Base Flow Index
</h2><span id='topic+BFI'></span>

<h3>Description</h3>

<p>Calculates the base flow index of an object of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BFI(lfobj, year = "any",breakdays = NULL, yearly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BFI_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code>
</p>
</td></tr>
<tr><td><code id="BFI_+3A_year">year</code></td>
<td>

<p>The year for which the BFI should be computed. If <code>hyearstart != 1</code> the BFI is calculated for the hydrological, <code>year = "any"</code> means the whole series should be taken.
</p>
</td></tr>
<tr><td><code id="BFI_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if the BFI should be calculated for different seasons.
</p>
</td></tr>
<tr><td><code id="BFI_+3A_yearly">yearly</code></td>
<td>

<p>If TRUE, the BFI is calculated for each hydrological year separately.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>'breakdays'</code> is a single day, e.g. &quot;01/06&quot;, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A length one vector giving the base flow index for the whole series or the specified
year. If yearly is true, a vector of the annual base flow indices is returned. If
break days are specified, the values are separated per season.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfplot">bfplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
BFI(ngaruroro)
BFI(ngaruroro, breakdays = c("01/11","01/05"))
BFI(ngaruroro, year = 1991)
bfplot(ngaruroro, year = 1991)
</code></pre>

<hr>
<h2 id='bfplot'>
Base Flow Plot
</h2><span id='topic+bfplot'></span>

<h3>Description</h3>

<p>Visualizes the hydrograph versus the base flow hydrograph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfplot(lfobj,
       year = "any",
       col = "green",
       bfcol = "blue",
       ylog = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bfplot_+3A_lfobj">lfobj</code></td>
<td>

<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="bfplot_+3A_year">year</code></td>
<td>

<p>The hydrological year for which the BFI should be computed. If &quot;any&quot; the
whole series is plotted.
</p>
</td></tr>
<tr><td><code id="bfplot_+3A_col">col</code></td>
<td>
<p>Colour of flow</p>
</td></tr>
<tr><td><code id="bfplot_+3A_bfcol">bfcol</code></td>
<td>
<p>Colour of base flow</p>
</td></tr>
<tr><td><code id="bfplot_+3A_ylog">ylog</code></td>
<td>
<p>Log y-axis?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects (plotting).</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BFI">BFI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# Plot starts in December, as ngaruroro's hyearstart = 12
bfplot(ngaruroro, year = 1991)
</code></pre>

<hr>
<h2 id='check_distribution'>Checks if a Distribution is suited</h2><span id='topic+check_distribution'></span>

<h3>Description</h3>

<p>Most distributions are used for modelling either minima or maxima. Sometimes a better fit can be achieved by reversing the distribution. This functions helps to decide if the reversed distribution is advisable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_distribution(extreme = c("minimum", "maximum"), distribution,
                   def = list(minimum = c(),
                              maximum = c("gev")))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_distribution_+3A_extreme">extreme</code></td>
<td>
<p>character vector, describing the kind of extreme value to be fitted. Either <code>'minimum'</code> or <code>'maximum'</code>.</p>
</td></tr>
<tr><td><code id="check_distribution_+3A_distribution">distribution</code></td>
<td>
<p>character vector of length one. Distribution chosen by the user.</p>
</td></tr>
<tr><td><code id="check_distribution_+3A_def">def</code></td>
<td>
<p>a list of length two, containing the elements <code>'minimum'</code> and <code>'maximum'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector as long as <code>distribution</code> containing the optimal choice for the given <code>distribution</code>s under the constraints of <code>def</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using the Weibull distribution for minimum values is a good choice
check_distribution(extreme = "minimum", distribution = "wei")

# ... whereas the GEV is meant for maxima.
# Therefore the reversed distribution is suggested.
check_distribution(extreme = "minimum", distribution = "gev")
</code></pre>

<hr>
<h2 id='createlfobj'>
Create an low flow object for further Low Flow Analysis
</h2><span id='topic+createlfobj'></span><span id='topic+createlfobj.default'></span><span id='topic+createlfobj.data.frame'></span><span id='topic+createlfobj.ts'></span><span id='topic+createlfobj.lfobj'></span>

<h3>Description</h3>

<p>Generic function for creating a low flow object (class <code>'lfobj'</code>). Low flow objects can be
created from a time series of daily flow, a data.frame with columns
&quot;flow&quot;, &quot;day&quot;, &quot;month&quot; and &quot;year&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createlfobj(x, ...)


## S3 method for class 'data.frame'
createlfobj(x, hyearstart = NULL, baseflow = TRUE,
            meta = list(),...)

## S3 method for class 'ts'
createlfobj(x,
            startdate,
            dateformat = "%d/%m/%Y",
            ...)

## S3 method for class 'lfobj'
createlfobj(x, hyearstart = NULL, baseflow = NULL,
            meta = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createlfobj_+3A_x">x</code></td>
<td>

<p>An object out of which an object of class <code>'lfobj'</code> should be created
</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_hyearstart">hyearstart</code></td>
<td>

<p>integer between 1 and 12, indicating the start of the hydrological year.
</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_baseflow">baseflow</code></td>
<td>

<p>logical, should the base flow curve be calculated? Needed, if you want
to apply functions <code>'bfplot'</code> or <code>'BFI'</code> later on.
</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_meta">meta</code></td>
<td>
<p>A list of meta-information</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_startdate">startdate</code></td>
<td>
<p>start of the time-series</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_dateformat">dateformat</code></td>
<td>
<p>Format of the start date</p>
</td></tr>
<tr><td><code id="createlfobj_+3A_...">...</code></td>
<td>
<p>Additional arguments, passed on to <code>createlfobj.data.frame</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>'hyearstart'</code> defines the starting month of the hydrological year. If
<code>'hyearstart'</code> is greater then 6.5, the hydrological year starts earlier
then the actual date, e.g. <code>hyearstart = 10</code>, then the 1st of October 2011
is part of the hydrological year 2012. If <code>hyearstart = 4</code>, then the 31st
of March 2011 is part of the hydrological year 2010.
</p>
<p>When creating an object of class <code>lfobj</code> with the aforementioned functions, eventually <code>createlfobj.data.frame</code> is called.
</p>


<h3>Value</h3>

<p>An object of class <code>'lfobj'</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readlfdata">readlfdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creating a lfobj from a timeseries
# Some sample data:
somevalues &lt;- rexp(365)

# Convert to time series:
time &lt;- ts(somevalues)

# Lets say our data contains values from one hydrological year (Oct-Sep)
# starting on 1. Oct. 1992:
myriver &lt;- createlfobj(time, startdate = "01/10/1992",hyearstart = 10)

# Add meta-data
createlfobj(myriver, meta = list(river = "myriver"))
</code></pre>

<hr>
<h2 id='dmcurve'>
Double Mass Curve
</h2><span id='topic+dmcurve'></span>

<h3>Description</h3>

<p>Calculates the double mass curve of two object of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
dmcurve(x, y, year = "any", namex = substitute(x), namey = substitute(y),
    na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dmcurve_+3A_x">x</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="dmcurve_+3A_y">y</code></td>
<td>
<p>An object of class <code>"lfobj"</code></p>
</td></tr>
<tr><td><code id="dmcurve_+3A_year">year</code></td>
<td>

<p>The year for which the double mass curve should be calculated
</p>
</td></tr>
<tr><td><code id="dmcurve_+3A_namex">namex</code></td>
<td>

<p>character - Label of the x-Axis in the double mass curve
</p>
</td></tr>
<tr><td><code id="dmcurve_+3A_namey">namey</code></td>
<td>

<p>character - Label of the y-Axis in the double mass curve
</p>
</td></tr>
<tr><td><code id="dmcurve_+3A_na.rm">na.rm</code></td>
<td>

<p>Remove NAs?
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects (plotting).</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
n1 &lt;- subset(ngaruroro, year %in% 1985:1989)
n2 &lt;- subset(ngaruroro, year %in% 1990:1995)
dmcurve(n1,n2, namex = "'Ngaruroro 1985 - 1989'", namey = "'Ngaruroro 1990
- 1995'")
</code></pre>

<hr>
<h2 id='ev_return_period'>
Estimate the return period for given quantiles
</h2><span id='topic+ev_return_period'></span>

<h3>Description</h3>

<p>For discharges of interest, estimate the corresponding return period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ev_return_period(x, fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ev_return_period_+3A_x">x</code></td>
<td>
<p>numeric vector containing the quantiles</p>
</td></tr>
<tr><td><code id="ev_return_period_+3A_fit">fit</code></td>
<td>
<p>object of class <code>evfit</code> describing the underlying distribution, possibly created with <code>evfit()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector of return periods.</p>


<h3>See Also</h3>

<p><code><a href="#topic+evfit">evfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
ng &lt;- as.xts(ngaruroro)

# yearly minima
minima &lt;- apply.yearly(ng$discharge, min, na.rm = TRUE)

# fit a Weibull distribution
fit &lt;- evfit(x = as.vector(minima), distribution = "wei")

# compute return periods
minima$rp &lt;- round(ev_return_period(minima, fit), 2)

print(minima)
plot(discharge ~ rp, data = minima,
     xlab = "Flow in m^3/s", ylab = "Return period in years")
</code></pre>

<hr>
<h2 id='evfit'>Fit an extreme value distribution to observations</h2><span id='topic+evfit'></span>

<h3>Description</h3>

<p>Fits an extreme value distribution using <var>L</var>-moments to the values provided. In the presence of zero flow observations a mixed distribution is fitted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>evfit(x, distribution, zeta = NULL, check = TRUE,
      extreme = c("minimum", "maximum"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evfit_+3A_x">x</code></td>
<td>
<p>numeric vector. Data which is an extreme value distribution is fitted to. </p>
</td></tr>
<tr><td><code id="evfit_+3A_distribution">distribution</code></td>
<td>
<p>A character vector of distributions to fit. Basically all distributions provided by Hosking's <code><a href="lmom.html#topic+lmom-package">lmom-package</a></code> and their reversed counterparts can be chosen. See <code><a href="#topic+reversing">reversing</a></code>.</p>
</td></tr>
<tr><td><code id="evfit_+3A_zeta">zeta</code></td>
<td>
<p>numeric vector of length one for manually setting a lower bound. Only a few distributions allow for a lower bound, namely <code>'gpa'</code>, <code>'ln3'</code>, <code>'wak'</code> and <code>'wei'</code>. The default value of <code>NULL</code> results in not bounding the distribution, therefore the parameter <code>zeta</code> is estimated.</p>
</td></tr>
<tr><td><code id="evfit_+3A_check">check</code></td>
<td>
<p>logical, should <code><a href="#topic+check_distribution">check_distribution</a></code> get called?</p>
</td></tr>
<tr><td><code id="evfit_+3A_extreme">extreme</code></td>
<td>
<p>character vector of length one. Can be either <code>'minimum'</code> or <code>'maximum'</code>. Helps to choose a correct distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorized over <code>distribution</code>.
</p>
<p>According to paragraph 7.4.2 of the <abbr><span class="acronym">WNO</span></abbr> manual, special care has to be taken in the presence of zero flow observations. A cdf called G(x) is fitted to the non-zero values of the original time series.
</p>
<p>If a distribution is fitted which allows for finite lower bound (<code>zeta</code>), and <code>zeta</code> is estimated being negative, estimation is repeated constraining <code>zeta = 0</code>. If this behavior is not desired, the parameter <code>zeta</code> has to be set explicitly.
</p>


<h3>Value</h3>

<p>An object of class <code>'evfit'</code> containing the <var>L</var>-moments and the estimated parameters is returned. Objects of class <code>'evfit'</code> are basically a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>values</code></td>
<td>
<p>the values <code>x</code> used for fitting.</p>
</td></tr>
<tr><td><code>freq.zeros</code></td>
<td>
<p>a character vector of length one. Frequency of zero flow observations.</p>
</td></tr>
<tr><td><code>is.censored</code></td>
<td>
<p>logical, if the censored time was used for fitting.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list as long as <code>distribution</code> containing the estimated parameters for each distribution.</p>
</td></tr>
<tr><td><code>lmom</code></td>
<td>
<p>sample L-moments of the censored series (only containing non-zero values). </p>
</td></tr>
<tr><td><code>extreme</code></td>
<td>
<p>character vector of length one, indicating what kind of extreme value was fitted.</p>
</td></tr>
<tr><td><code>T_Years_Event</code></td>
<td>
<p>optional. If quantiles have been computed they a stored in a matrix with return periods in rows and distributions in columns.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>There are methods for printing summarizing objects of class <code>'evfit'</code>.
</p>
<p><code><a href="#topic+evfit">evfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
ng &lt;- as.xts(ngaruroro)
minima &lt;- as.vector(apply.yearly(ng$discharge, min, na.rm = TRUE))
evfit(x = minima, distribution = c("wei", "gevR"),
      extreme = "minimum")
</code></pre>

<hr>
<h2 id='evquantile'>Estimating populations quantiles of extreme values</h2><span id='topic+evquantile'></span>

<h3>Description</h3>

<p>Computes population quantiles for given return periods. Estimation is done using <var>L</var>-moments.</p>


<h3>Usage</h3>

<pre><code class='language-R'>evquantile(fit, return.period = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evquantile_+3A_fit">fit</code></td>
<td>
<p>object of class <code>evfit</code>, possibly created with <code>evfit()</code>.</p>
</td></tr>
<tr><td><code id="evquantile_+3A_return.period">return.period</code></td>
<td>
<p>numeric vector of return periods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorized over <code>return.period</code>.</p>


<h3>Value</h3>

<p>A matrix containing the low-flow quantiles, with rows corresponding to return periods columns to distributions.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")

# using tyears is a fast way to produce an object of class evfit
y &lt;- tyears(ngaruroro, dist = "wei", event = 100, plot = TRUE)

# computing quantiles for given return periods
rp &lt;- c(1.42, 5, 10)
evquantile(y, return.period = rp)
rpline(y, return.period = rp, suffix = c("a", "m\u00B3"))
</code></pre>

<hr>
<h2 id='fdc'>
Flow Duration Curve
</h2><span id='topic+fdc'></span>

<h3>Description</h3>

<p>Plots the flow duration curve for a given low flow object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdc(lfobj, year = "any", breakdays = NULL, colors = TRUE,
    xnorm = FALSE, ylog = TRUE, legend = TRUE, separate = FALSE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fdc_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="fdc_+3A_year">year</code></td>
<td>
<p>numeric - The year for which the flow duration curve should be computed. If <code>hyearstart != 1</code> the <abbr><span class="acronym">BFI</span></abbr> is calculated for the hydrological year, <code>any = "any"</code> means the whole series should be taken.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_breakdays">breakdays</code></td>
<td>
<p>A vector of break days if the  <abbr><span class="acronym">BFI</span></abbr> should be calculated for different seasons.
</p>
</td></tr>
<tr><td><code id="fdc_+3A_colors">colors</code></td>
<td>

<p>logical - If <code>'breakdays'</code> are specified, should the different flow duration curves are
displayed in different colours?
</p>
</td></tr>
<tr><td><code id="fdc_+3A_xnorm">xnorm</code></td>
<td>
<p>logical - should the x-axis be normalized?</p>
</td></tr>
<tr><td><code id="fdc_+3A_ylog">ylog</code></td>
<td>
<p>logical - The the logarithm of the y-axis?</p>
</td></tr>
<tr><td><code id="fdc_+3A_legend">legend</code></td>
<td>
<p>logical - Should a legend be plotted?</p>
</td></tr>
<tr><td><code id="fdc_+3A_separate">separate</code></td>
<td>
<p>logical - Should a separate plot be drawn for every
season?</p>
</td></tr>
<tr><td><code id="fdc_+3A_...">...</code></td>
<td>
<p>Graphical parameters handed to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>breakdays</code> is a single day, e.g. &quot;01/06&quot;, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A vector of quantiles.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ecdf">ecdf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
fdc(ngaruroro,year = 1991)
</code></pre>

<hr>
<h2 id='fill_na'>
Interpolation NA values in a vector
</h2><span id='topic+fill_na'></span>

<h3>Description</h3>

<p>This function is a tiny wrapper around <code><a href="stats.html#topic+approx">approx</a></code> which allows to contain the maximum number of NA values in a row that will be filled by interpolation. This is useful to obtain regular time series.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_na(x, max.len = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_na_+3A_x">x</code></td>
<td>
<p>a vector, possibly containing NA values</p>
</td></tr>
<tr><td><code id="fill_na_+3A_max.len">max.len</code></td>
<td>
<p>an integer vector of length one, constraining the number of of consecutive NA observations which will get replaced with interpolated values</p>
</td></tr>
<tr><td><code id="fill_na_+3A_...">...</code></td>
<td>
<p>further arguments, passed on to <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+approx">approx</a></code>, <code><a href="zoo.html#topic+na.approx">na.approx</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:20
x[c(2, 3, 6, 11:15)] &lt;- NA
fill_na(x, max.len = 2)
</code></pre>

<hr>
<h2 id='find_droughts'>Identifying Low Flow Periods</h2><span id='topic+find_droughts'></span>

<h3>Description</h3>

<p>A streamflow deficit is defined as an event where discharges are below a given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_droughts(x, threshold = vary_threshold, varying = "constant", interval = "day", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_droughts_+3A_x">x</code></td>
<td>

<p>an object which can be coerced to class <code>'xts'</code>. Either with a single column or with a column named <code>'discharge'</code>. Units of <code>'x'</code> are retrieved from the attributes. If it fails, an error is raised.
</p>
</td></tr>
<tr><td><code id="find_droughts_+3A_threshold">threshold</code></td>
<td>
<p>The threshold can either be a constant value, a time series with the same length as <code>x</code> or a function (taking a single argument) returning either of these. Furthermore <code>threshold</code> can be a character vector of length one specifying a quantile of x like <code>threshold = 'Q80'</code> as a shortcut of <code>threshold = function(x) quantile(x, 0.2, na.rm = TRUE)</code>. See <code><a href="#topic+vary_threshold">vary_threshold</a></code> for varying a threshold in time.</p>
</td></tr>
<tr><td><code id="find_droughts_+3A_varying">varying</code></td>
<td>
<p>if <code>varying</code> is a character vector of length one, values of &quot;constant&quot;, &quot;daily&quot;, &quot;weekly&quot; and &quot;monthly&quot; are allowed. If a vector of class POSIX is provided, a seasonal varying threshold is computed, where the times provided define the start of the season. Only the day of the year is taken, the year itself doesn't have a meaning.</p>
</td></tr>
<tr><td><code id="find_droughts_+3A_interval">interval</code></td>
<td>
<p>A character string, containing one of &quot;day&quot;, &quot;week&quot;, &quot;month&quot;, &quot;quarter&quot; or &quot;year&quot; as accepted by <code><a href="base.html#topic+seq.Date">seq.Date</a></code>.</p>
</td></tr>
<tr><td><code id="find_droughts_+3A_...">...</code></td>
<td>

<p>if threshold is a function, these additional arguments are passed on to the function
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>'deficit'</code>, which is basically an <code>'xts'</code> object with the columns
</p>
<table role = "presentation">
<tr><td><code>discharge</code></td>
<td>
<p>discharges as provided with <code>x</code></p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p>the threshold</p>
</td></tr>
<tr><td><code>def.increase</code></td>
<td>
<p>The increase of the deficit volume in m^3 per day. </p>
</td></tr>
<tr><td><code>event.no</code></td>
<td>
<p>an event id. If an event is numbered &quot;0&quot; this period not considered as a streamflow deficit.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>There are summary and plot methods, see <code><a href="#topic+summary.deficit">summary.deficit</a></code> and <code><a href="#topic+plot.deficit">plot.deficit</a></code>.
</p>
<p><code><a href="#topic+pooling">pooling</a></code>, <code><a href="#topic+summary.deficit">summary.deficit</a></code>, <code><a href="#topic+plot.deficit">plot.deficit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ray)
ray &lt;- as.xts(ray)["1970::1979", ]
r &lt;- find_droughts(ray)
head(r)
summary(r)


plot(r)


# threshold is to low, because there are many days with
# zero flow observations
# provide threshold as a constant value
r &lt;- find_droughts(ray, threshold = 0.02)
head(r)
summary(r)

plot(r)



# provide threshold as a function
r &lt;- find_droughts(ray,
                   threshold = function(x) quantile(x, 0.2, na.rm = TRUE))
head(r)
summary(r)
</code></pre>

<hr>
<h2 id='flowunit'>Set and retrieve unit of the discharge</h2><span id='topic+flowunit'></span><span id='topic+flowunit.lfobj'></span><span id='topic+flowunit.xts'></span><span id='topic+flowunit+3C-'></span><span id='topic+flowunit+3C-.lfobj'></span><span id='topic+flowunit+3C-.xts'></span>

<h3>Description</h3>

<p>In order to compute deficit volumes time series of discharges (either of class <code>'lfobj'</code> or <code>'xts'</code>) <code><a href="#topic+summary.deficit">summary.deficit</a></code> needs to be aware of the unit. Units are stored in the attributes of the time series. <code>flowunit(x)</code> retrieves the current unit from the attributes, <code>flowunit(x) &lt;- value</code> sets a new one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flowunit(x)
## S3 method for class 'xts'
flowunit(x)
## S3 method for class 'lfobj'
flowunit(x)

flowunit(x) &lt;- value
## S3 replacement method for class 'xts'
flowunit(x) &lt;- value
## S3 replacement method for class 'lfobj'
flowunit(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flowunit_+3A_x">x</code></td>
<td>
<p> The time series, either of class <code>'lfobj'</code> or <code>'xts'</code>.</p>
</td></tr>
<tr><td><code id="flowunit_+3A_value">value</code></td>
<td>
<p> a valid character string of length one that can be interpreted as flow unit. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, just a few functions like <code><a href="#topic+summary.deficit">summary.deficit</a></code> and <code>lfstat:::plot.deficit_dygraph</code> make use of the unit stored as an attribute.
</p>
<p>Usually flow units are of dimension $L^3 T^-1$. Currently a length $l$ can be on of <code>c("metre", "cm", "centimetre" "litre")</code>, whereas time $T$ can be one in <code>c("days", "hours", "mins", "secs")</code>, possibly abbreviated. The numerator of the fraction (everything before the literal <code>"/"</code>) is interpreted as the length (superscripts like <code>"^3"</code> are discarded), the denominator as time. E.g. valid units would be <code>"cm^3/s"</code>, <code>"m^3/day"</code> or <code>"litre/sec"</code>.
</p>


<h3>Value</h3>

<p>A character vector of length one, containing the currently used discharge unit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ray)
ray &lt;- as.xts(ray)["1970::1970", ]

# currently discharges are in cubic metres per second
flowunit(ray)

# calculating deficit volumes, for fixed threshold 0.001 m^3/s
(s &lt;- summary(find_droughts(ray, threshold = 0.001)))

# multiplying the discharge by 1000 converts is to litre per second
ray$discharge &lt;- ray$discharge * 1000

# changing the unit accordingly, yields the same volumes
flowunit(ray) &lt;- "l/s"
(ss &lt;- summary(find_droughts(ray, threshold = 1)))

identical(s$volume, ss$volume)
</code></pre>

<hr>
<h2 id='gringorten'>
Gringorten Plotting Positions
</h2><span id='topic+gringorten'></span>

<h3>Description</h3>

<p>Computes the Gringorten Plotting position.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gringorten(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gringorten_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector in <code>[0, 1]</code>, giving the corresponding plotting positions.</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rnorm(10)
pp &lt;- gringorten(y)
pp

plot(pp ~ y, ylim = c(0, 1))
</code></pre>

<hr>
<h2 id='hydrograph'>
Hydrograph
</h2><span id='topic+hydrograph'></span>

<h3>Description</h3>

<p>Plots the hydrograph for a given period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hydrograph(lfobj, startdate = NULL, enddate = NULL, amin = FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hydrograph_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code></p>
</td></tr>
<tr><td><code id="hydrograph_+3A_startdate">startdate</code></td>
<td>
<p>Begin of hydrograph, date or hydrological year</p>
</td></tr>
<tr><td><code id="hydrograph_+3A_enddate">enddate</code></td>
<td>
<p>End of hydrograph, date or hydrological year</p>
</td></tr>
<tr><td><code id="hydrograph_+3A_amin">amin</code></td>
<td>
<p>logical, mark annual minima?</p>
</td></tr>
<tr><td><code id="hydrograph_+3A_...">...</code></td>
<td>
<p>Additional arguments handed to &quot;plot&quot; - please note that
some changes e.g. tickmarks on x-axis are not possible</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Start date and end date can be <code>NULL</code> (first/last date in a low flow object
), a date in
format <code>"dd/mm/yyyy"</code> (e.g. &quot;01/10/1971&quot;) or a year <code>"yyyy"</code> (e.g 1961).
</p>


<h3>Value</h3>

<p>Plot of hydrograph
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfplot">bfplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# Full period
hydrograph(ngaruroro)

# Hydrological year 1981 and 1982 with annual minima
hydrograph(ngaruroro, startdate = 1981, enddate = 1982, amin = TRUE)

# From 01/01/1981 to 31/03/1981
hydrograph(ngaruroro, startdate = "01/01/1981", enddate = "31/03/1981")

# Log - yaxis
hydrograph(ngaruroro, startdate = "01/01/1981", enddate = "31/03/1981",log = "y")
</code></pre>

<hr>
<h2 id='hyear_start'>
Extract or guess the Start of a Hydrological Year
</h2><span id='topic+hyear_start'></span><span id='topic+hyear_start+3C-'></span><span id='topic+hyear_start+3C-.xts'></span><span id='topic+hyear_start+3C-.lfobj'></span><span id='topic+hyear_start.xts'></span><span id='topic+hyear_start.data.frame'></span>

<h3>Description</h3>

<p>Retrieve the start of a hydrological year either from the attributes or from the column <code>'hyear'</code> of an object of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyear_start(x, abbreviate = FALSE)

## S3 method for class 'data.frame'
hyear_start(x, abbreviate = FALSE)

## S3 method for class 'xts'
hyear_start(x, abbreviate = FALSE)

hyear_start(x) &lt;- value
## S3 replacement method for class 'xts'
hyear_start(x) &lt;- value
## S3 replacement method for class 'lfobj'
hyear_start(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hyear_start_+3A_x">x</code></td>
<td>
<p>object of which the start of the hydrological year should be determined.</p>
</td></tr>
<tr><td><code id="hyear_start_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical. Should the names be abbreviated?</p>
</td></tr>
<tr><td><code id="hyear_start_+3A_value">value</code></td>
<td>
<p>numeric vector of length one. Month in which the hydrological year starts.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a valid start of an hydrological year is found in the attributes, it is returned. Otherwise if a column <code>'hyear'</code> exists, it is used. If this is note possible the integer number one is returned (for January) and a warning is issued.
</p>


<h3>Value</h3>

<p>a vector of length one, either of type character (<code>abbreviate = TRUE</code>) or numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+water_year">water_year</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
hyear_start(ngaruroro)

data(ray)
hyear_start(ray, abbreviate = TRUE)
</code></pre>

<hr>
<h2 id='lfnacheck'>
Low flow object check for missing values.
</h2><span id='topic+lfnacheck'></span>

<h3>Description</h3>

<p>Looks for NAs in a low flow object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfnacheck(lfobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lfnacheck_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the total number of NAs, the percentage, the NAs for every
year and the durations of NA-series.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfplot">bfplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
lfnacheck(ngaruroro)
</code></pre>

<hr>
<h2 id='lfnainterpolate'>
Interpolate missing values
</h2><span id='topic+lfnainterpolate'></span>

<h3>Description</h3>

<p>If a low flow object contains missing values, the missing values are replaced by
connecting the last available value before the break and the first after
the break by a straight line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfnainterpolate(lfobj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lfnainterpolate_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code></p>
</td></tr></table>
<p> with interpolated missing values
</p>


<h3>Warning </h3>

<p>Check carefully in advance if interpolation is a reasonable choice for
filling the hydrograph
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bfplot">bfplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)

# Part of the ngaruroro series with missing data
hydrograph(ngaruroro, startdate = "1/7/1987", enddate = "1/9/1987",amin = FALSE)

ngaruroroint &lt;- lfnainterpolate(ngaruroro)

# The completed hydrograph
hydrograph(ngaruroroint, startdate = "1/7/1987", enddate = "1/9/1987",amin = FALSE)
</code></pre>

<hr>
<h2 id='ma'>Simple Moving Average</h2><span id='topic+ma'></span>

<h3>Description</h3>

<p>Smoothing a time series with moving averages using the <code>filter</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ma(x, n, sides = "past")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ma_+3A_x">x</code></td>
<td>

<p>numeric vector to be smoothed
</p>
</td></tr>
<tr><td><code id="ma_+3A_n">n</code></td>
<td>

<p>numeric vector of length one determining the width of the smoothing window
</p>
</td></tr>
<tr><td><code id="ma_+3A_sides">sides</code></td>
<td>

<p>one of <code>'past'</code>, <code>'center'</code> or <code>'future'</code> indicating the side of the filter.)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector as long as x, but smoothed. Possibly with NAs.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+filter">filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ma(1:10, n = 3, sides = 2)    # centred around lag 0
ma(1:10, n = 3)               # past values
</code></pre>

<hr>
<h2 id='MAM'>
Mean Annual Minimum
</h2><span id='topic+MAM'></span>

<h3>Description</h3>

<p>Computes the Mean Annual Minimum (<abbr><span class="acronym">MAM</span></abbr>-n) for any given n.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAM(lfobj, n = 7, year = "any", breakdays = NULL, yearly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAM_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="MAM_+3A_n">n</code></td>
<td>
<p>Mean Annual minimum for n-days, e.g. n=7 computes <abbr><span class="acronym">MAM7</span></abbr></p>
</td></tr>
<tr><td><code id="MAM_+3A_year">year</code></td>
<td>

<p>The year for which the <abbr><span class="acronym">BFI</span></abbr> should be computed. If <code>hyearstart != 1</code> the
<abbr><span class="acronym">BFI</span></abbr> is calculated for the hydrological year! <code>'any'</code> means the whole
series should be taken. If a vector of years is given, all this
years are included in the calculation.
</p>
</td></tr>
<tr><td><code id="MAM_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if the <abbr><span class="acronym">BFI</span></abbr> should be calculated for different seasons.
</p>
</td></tr>
<tr><td><code id="MAM_+3A_yearly">yearly</code></td>
<td>

<p>If TRUE,  the BFI is calculated for each hydrological year separately.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>breakdays</code> is a single day, e.g. <code>"01/06"</code>, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A length one vector giving the <abbr><span class="acronym">BFI</span></abbr> for the whole series or the
specified year. If yearly is true, a vector of the annual <abbr><span class="acronym">BFI</span></abbr>s is
returned. If break days are specified, separated values for every
season are given.
</p>


<h3>Warning </h3>

<p>At the moment there is no check for seasonal overlap. E.g. The <abbr><span class="acronym">MAM</span></abbr>7 of
1991 and 1992 could take the same days for calculation if the are in
<code class="reqn">n/2-days</code> range. This problem could be avoided by choosing a
&quot;meaningful&quot; <code>hyearstart</code> and <code>breakdays</code>, usually dates out of the low
flow seasons.
</p>


<h3>Note</h3>

<p>The annual minima can be calculated by setting <code>n = 1</code> and <code>yearly = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meanflow">meanflow</a></code>,<code><a href="#topic+Q95">Q95</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
MAM(ngaruroro)
MAM(ngaruroro, n=1) #Mean annual minimum
MAM(ngaruroro, year = c(1991,1995)) #Taking values from 1991 and 1995
MAM(ngaruroro, year = 1991:1995) #Taking values from 1991 to 1995 (1991,1992,...,1995)
MAM(ngaruroro, breakdays = c("01/11","01/05"))
MAM(ngaruroro, year = 1991)
</code></pre>

<hr>
<h2 id='meanflow'>
Mean flow
</h2><span id='topic+meanflow'></span>

<h3>Description</h3>

<p>Calculates the mean flow of an object of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanflow(lfobj, year = "any", monthly = FALSE, yearly = FALSE,
breakdays = NULL, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meanflow_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="meanflow_+3A_year">year</code></td>
<td>

<p>The year for which the mean flow should be computed. If <code>hyearstart != 1</code> the mean flow is calculated for the hydrological year! &quot;any&quot; means the whole series should be taken.
</p>
</td></tr>
<tr><td><code id="meanflow_+3A_monthly">monthly</code></td>
<td>

<p>logical - Should the mean flow be calculated separately for every month?.
</p>
</td></tr>
<tr><td><code id="meanflow_+3A_yearly">yearly</code></td>
<td>

<p>logical - If TRUE,  the mean flow is calculated for each hydrological year separately.
</p>
</td></tr>
<tr><td><code id="meanflow_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if the mean flow should be calculated for different seasons.
</p>
</td></tr>
<tr><td><code id="meanflow_+3A_na.rm">na.rm</code></td>
<td>
<p>Should missing values be ignored?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>'breakdays'</code> is a single day, e.g. &quot;01/06&quot;, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A length one vector giving the mean flow for the whole series or the specified
year. If yearly is true, a vector of the annual mean flows is returned. If
break days are specified, the values are separated per season.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MAM">MAM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
meanflow(ngaruroro)
meanflow(ngaruroro, breakdays = c("01/11","01/05"))
meanflow(ngaruroro, year = 1991)</code></pre>

<hr>
<h2 id='multistationsreport'>
Report for several stations
</h2><span id='topic+multistationsreport'></span>

<h3>Description</h3>

<p>Calculates indices for several stations at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multistationsreport(...,indices = c("meanflow", "Q95", "MAM1", "MAM7",
    "MAM10", "MAM30", "MAM90", "baseflowindex", "recession"),
    recessionmethod = "MRC", recessionseglength = 7, recessionthreshold = 70,
    recessiontrimIRS = 0.1,lflist = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multistationsreport_+3A_...">...</code></td>
<td>
<p>Objects of class <code>"lfobj"</code></p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_indices">indices</code></td>
<td>
<p>A vector of indices to calculate</p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_recessionmethod">recessionmethod</code></td>
<td>
<p>See <code><a href="#topic+recession">recession</a></code></p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_recessionseglength">recessionseglength</code></td>
<td>
<p>See <code><a href="#topic+recession">recession</a></code></p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_recessionthreshold">recessionthreshold</code></td>
<td>
<p>See <code><a href="#topic+recession">recession</a></code></p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_recessiontrimirs">recessiontrimIRS</code></td>
<td>
<p>See <code><a href="#topic+recession">recession</a></code></p>
</td></tr>
<tr><td><code id="multistationsreport_+3A_lflist">lflist</code></td>
<td>
<p>Alternative give a list containing low flow objects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the calculated indices.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meanflow">meanflow</a></code>, <code><a href="#topic+Q95">Q95</a></code>,<code><a href="#topic+MAM">MAM</a></code>,<code><a href="#topic+BFI">BFI</a></code>,<code><a href="#topic+recession">recession</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
multistationsreport(ngaruroro, indices = c("meanflow", "MAM7"))

seventies &lt;- subset(ngaruroro, hyear %in% 1970:1979)
eighties &lt;- subset(ngaruroro, hyear %in% 1980:1989)
nineties &lt;- subset(ngaruroro, hyear %in% 1990:1999)

multistationsreport(seventies, eighties, nineties)
</code></pre>

<hr>
<h2 id='ngaruroro'>Daily stream flow data used for low flow analysis</h2><span id='topic+ngaruroro'></span><span id='topic+ng'></span><span id='topic+ray'></span>

<h3>Description</h3>

<p>This data set provides the streamflow records for the rivers Ngaruroro (New Zealand) and Ray (UK). They are provided as a low flow object (class <code>'lfobj'</code>) as used in the package lfstat. The user might want to perform analysis with shorter time series. The data set <code>ng</code> just contains the eighties (hydrological year 1980 &ndash; 1989) of the Ngaruroro discharges.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ngaruroro)
data(ng)
data(ray)</code></pre>


<h3>Format</h3>

<p>A low flow object, <code><a href="#topic+createlfobj">createlfobj</a></code></p>


<h3>Source</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
hyear_start(ngaruroro)
plot(ngaruroro)

data(ray)
hyear_start(ray)
attr(ray, "lfobj")
</code></pre>

<hr>
<h2 id='plot.deficit'>Plot time series of deficits</h2><span id='topic+plot.deficit'></span>

<h3>Description</h3>

<p>Plot method for objects of class deficit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'deficit'
plot(x, type = "dygraph", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.deficit_+3A_x">x</code></td>
<td>
<p>object of class deficit</p>
</td></tr>
<tr><td><code id="plot.deficit_+3A_type">type</code></td>
<td>
<p>if <code>type = "dygraph"</code> interactive time series plotting is done using the <span class="pkg">dygraphs</span> JavaScript library. Otherwise <code><a href="xts.html#topic+plot.xts">plot.xts</a></code> is called. </p>
</td></tr>
<tr><td><code id="plot.deficit_+3A_...">...</code></td>
<td>
<p>further arguments, passed on to the subsequent plot function, e.g. <code>step = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An interactive dygraph plot or an xts plot, depending on argument <code>'type'</code>.</p>


<h3>See Also</h3>

<p><code><a href="dygraphs.html#topic+dygraph">dygraph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ray)
r &lt;- find_droughts(ray, threshold = 0.02)
plot(r["1970::1970", ])

plot(r["1970::1970", ], step = FALSE)
</code></pre>

<hr>
<h2 id='pooling'>Pooling Procedures of Low Flow Events</h2><span id='topic+pooling'></span><span id='topic+pool_ic'></span><span id='topic+pool_ma'></span><span id='topic+pool_sp'></span><span id='topic+pool_it'></span>

<h3>Description</h3>

<p>Several pooling procedures can be applied to reduce the number of dependent droughts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pool_ic(x, tmin = 5, ratio = 0.1)
pool_it(x, tmin = 5)
pool_ma(x, n = 10)
pool_sp(x)
  </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pooling_+3A_x">x</code></td>
<td>
<p>an object of class <code>deficit</code>, e.g. as produced by
<code><a href="#topic+find_droughts">find_droughts</a></code>.</p>
</td></tr>
<tr><td><code id="pooling_+3A_tmin">tmin</code></td>
<td>
<p>numeric vector of length one interpreted as the number of days between two droughts to be considered independent events. Two droughts are pooled if their inter-event time is less than <code>tmin</code>.</p>
</td></tr>
<tr><td><code id="pooling_+3A_ratio">ratio</code></td>
<td>
<p>numeric vector of length. Specifies the minimum ratio of inter-event volume and precedent drought volume. Two droughts are pooled if the critical <code>ratio</code> is deceeded.</p>
</td></tr>
<tr><td><code id="pooling_+3A_n">n</code></td>
<td>
<p>numeric vector of length one determining the width of the smoothing window</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inter-event criterion (<code>pool_ic</code>) pools subsequent drought events if the inter-event time is less than <code>tmin</code> and the ratio of the drought volume and the inter-event volume is less than a given <code>ratio</code>. The function <code>pool_it</code> is simply a wrapper around <code>pool_ic(..., ratio = Inf)</code>.
</p>
<p>Pooling by a moving average (<code>pool_ma</code>) simply smooths the time series before finding drought events.
</p>
<p>Using the Sequent Peak algorithm (<code>pool_sp</code>), a drought lasts until its cumulative deficit volume is zero again.
</p>


<h3>Value</h3>

<p>an object of class <code>deficit</code> (inherited from <code>xts</code>), with an
additional column <code>event.orig</code>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_droughts">find_droughts</a></code>, <code><a href="#topic+summary.deficit">summary.deficit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
ng &lt;- as.xts(ngaruroro)
ng &lt;- ng["1986::1990", ]

drought &lt;- find_droughts(ng)


ic &lt;- pool_ic(drought)
summary(ic)

ma &lt;- pool_ma(drought)
summary(ma)

sp &lt;- pool_sp(drought)
summary(sp)
plot(sp)
</code></pre>

<hr>
<h2 id='Qxx'>
Qxx, Q95, Q90, Q70
</h2><span id='topic+Q95'></span><span id='topic+Qxx'></span><span id='topic+Q70'></span><span id='topic+Q90'></span>

<h3>Description</h3>

<p>Calculates the quantiles of an object of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qxx(lfobj, Qxx, year = "any", monthly = FALSE, yearly = FALSE,
breakdays = NULL, na.rm = TRUE)

Q95(lfobj, year = "any", monthly = FALSE, yearly = FALSE,
breakdays = NULL, na.rm = TRUE)

Q90(lfobj, year = "any", monthly = FALSE, yearly = FALSE,
breakdays = NULL, na.rm = TRUE)

Q70(lfobj, year = "any", monthly = FALSE, yearly = FALSE,
breakdays = NULL, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Qxx_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code>
</p>
</td></tr>
<tr><td><code id="Qxx_+3A_qxx">Qxx</code></td>
<td>
<p>The quantile to calculate, e.g. 70 would refer to Q70</p>
</td></tr>
<tr><td><code id="Qxx_+3A_year">year</code></td>
<td>

<p>The year for which the Q95 should be computed. If <code>hyearstart != 1</code> the Q95 is calculated for the hydrological year, <code>year = "any"</code> means the whole series should be taken.
</p>
</td></tr>
<tr><td><code id="Qxx_+3A_monthly">monthly</code></td>
<td>

<p>logical - Should the Q95 be calculated separately for every month?.
</p>
</td></tr>
<tr><td><code id="Qxx_+3A_yearly">yearly</code></td>
<td>

<p>logical - If TRUE,  the Q95 is calculated for each hydrological year separately.
</p>
</td></tr>
<tr><td><code id="Qxx_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if the Q95 should be calculated for different seasons.
</p>
</td></tr>
<tr><td><code id="Qxx_+3A_na.rm">na.rm</code></td>
<td>
<p>Should NAs be ignored?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>breakdays</code> is a single day, e.g. &quot;01/06&quot;, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A length one vector giving the Q95 for the whole series or the specified
year. If yearly is true, a vector of the annual Q95s is returned. If
break days are specified, the values are separated per season.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MAM">MAM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
Q95(ngaruroro)
Q95(ngaruroro, breakdays = c("01/11","01/05"))
Q95(ngaruroro, year = 1991)
# Calculate Q99
Qxx(ngaruroro, Qxx = 99)
</code></pre>

<hr>
<h2 id='readlfdata'>
Reads data sheets
</h2><span id='topic+readlfdata'></span>

<h3>Description</h3>

<p>Reads data sheets of different formats directly and returns objects of class <code>'lfobj'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readlfdata(file, type = c("GRDC", "HZB", "LFU", "TU"), lfobj = TRUE,
           readmeta = TRUE, encoding = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readlfdata_+3A_file">file</code></td>
<td>
<p>The name of the file which the data are to be read from.</p>
</td></tr>
<tr><td><code id="readlfdata_+3A_type">type</code></td>
<td>
<p>The style of the sheet, currently the following formats
are accepted: <code>'GRDC'</code>, <code>'HZB'</code> (Austria), <code>'LFU'</code> (Germany, Bavaria), <code>'TU'</code>
(Technical University Vienna)</p>
</td></tr>
<tr><td><code id="readlfdata_+3A_lfobj">lfobj</code></td>
<td>
<p>logical, should a low flow object be created?</p>
</td></tr>
<tr><td><code id="readlfdata_+3A_readmeta">readmeta</code></td>
<td>
<p>logical, should meta information from data sheets be
saved?</p>
</td></tr>
<tr><td><code id="readlfdata_+3A_encoding">encoding</code></td>
<td>
<p>The name of the encoding to be assumed. See the Encoding section of <code><a href="base.html#topic+connections">connections</a></code>.</p>
</td></tr>
<tr><td><code id="readlfdata_+3A_...">...</code></td>
<td>
<p>Handed to <code>'createlfobj'</code>, could be <code>'hyearstart'</code>, <code>'baseflow'</code> or
<code>'meta'</code>, if <code>'readmeta'</code> is <code>'FALSE'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>'lfobj'</code> or <code>'data.frame'</code> depending on <code>'lfobj'</code>.
</p>


<h3>Note</h3>

<p>If you like other file formats (national standards)
to be includes, send some examples with a remark how NAs are marked to
the author
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createlfobj">createlfobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Finding the filename of the sample file on your computer
fn &lt;- system.file("samplesheets/9104020.day", package = "lfstat")
grdc &lt;- readlfdata(fn, type = "GRDC", baseflow = FALSE, hyearstart = 1)
head(grdc)


fn &lt;- system.file("samplesheets/kloesterle.dat", package = "lfstat")
hzb &lt;- readlfdata(fn, type = "HZB", baseflow = FALSE, hyearstart = 1)
head(hzb)

fn &lt;- system.file("samplesheets/oberammergau.dat", package = "lfstat")
lfu &lt;- readlfdata(fn, type = "LFU", baseflow = FALSE, hyearstart = 1)
head(lfu)
</code></pre>

<hr>
<h2 id='recession'>
Recession Constant
</h2><span id='topic+recession'></span>

<h3>Description</h3>

<p>Does recession analysis using either the <abbr><span class="acronym">MRC</span></abbr> (Master recession curve) or
<abbr><span class="acronym">IRS</span></abbr> (individual recession segments) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recession(lfobj,
          method = c("MRC", "IRS"),
          seglength,
          threshold,
          peaklevel = 0.95,
          seasonbreakdays = NULL,
          thresbreaks = c("fixed", "monthly","seasonal"),
          thresbreakdays = NULL,
          plotMRC = TRUE,
          trimIRS = 0,
          na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="recession_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code></p>
</td></tr>
<tr><td><code id="recession_+3A_method">method</code></td>
<td>
 <p><code>'MRC'</code> or <code>'IRS'</code></p>
</td></tr>
<tr><td><code id="recession_+3A_seglength">seglength</code></td>
<td>
<p>The length of the duration segments - see the <abbr><span class="acronym">WNO</span></abbr>-manual
and use <code><a href="#topic+seglenplot">seglenplot</a></code> to choose a good value.</p>
</td></tr>
<tr><td><code id="recession_+3A_threshold">threshold</code></td>
<td>
<p>The threshold level (70 means Q70)</p>
</td></tr>
<tr><td><code id="recession_+3A_peaklevel">peaklevel</code></td>
<td>
<p>A level between 0 and 1 or a logical vector, see
details.</p>
</td></tr>
<tr><td><code id="recession_+3A_seasonbreakdays">seasonbreakdays</code></td>
<td>
<p>A vector of break days. Needed if the recession
constant should be calculated individually for different seasons, see
details.</p>
</td></tr>
<tr><td><code id="recession_+3A_thresbreaks">thresbreaks</code></td>
<td>
 <p><code>'fixed'</code> uses a fixed threshold level, <code>'monthly'</code>
calculates the threshold for every month separately, <code>'seasonal'</code>
calculates thresholds for every season defined using
<code>'thresbreakdays'</code>.</p>
</td></tr>
<tr><td><code id="recession_+3A_thresbreakdays">thresbreakdays</code></td>
<td>
<p>Needed if <code>thresbreaks = 'seasonal'</code> to define
the periods for which separate thresholds should be calculated, see
details</p>
</td></tr>
<tr><td><code id="recession_+3A_plotmrc">plotMRC</code></td>
<td>
<p>logical, if TRUE and <code>method = 'MRC'</code> a plot like
figure 5.4 in the manual is given.</p>
</td></tr>
<tr><td><code id="recession_+3A_trimirs">trimIRS</code></td>
<td>
<p>Should a trimmed mean be used for calculating the
IRS-constant? (0 means no, 0.1 means trim by 10 %)</p>
</td></tr>
<tr><td><code id="recession_+3A_na.rm">na.rm</code></td>
<td>
<p>Should NAs in the series be ignored?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For recession analysis it is necessary to define flood discharge peaks
in the hydrograph. Argument <code>peaklevel</code> defines a day to be a
discharge peak, if <code class="reqn">peaklevel * flow &gt; flow[day before]</code> and
<code class="reqn">peaklevel * flow &gt; flow[day after]</code>. Use <code><a href="#topic+recessionplot">recessionplot</a></code>
to find a good level or hand a logical vector where TRUE means rain peak.
</p>
<p>If  <code>'thresbreakdays'</code> or  <code>'seasonbreakdays'</code> is a single day, e.g. <code>'01/06'</code>, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>The overall recession rate in days. If seasons are defined a rate for
every season is calculated.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seglenplot">seglenplot</a></code>, <code><a href="#topic+recessionplot">recessionplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
recession(ngaruroro,method = "MRC",seglen = 7,threshold = 70)
</code></pre>

<hr>
<h2 id='recessionplot'>
Recession diagnostic plot
</h2><span id='topic+recessionplot'></span>

<h3>Description</h3>

<p>Helps to define the peak level of a low flow object and visualises recession periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recessionplot(lfobj,
              peaklevel = 0.95,
              plot = TRUE,
              peakreturn = FALSE,
              thresplot = TRUE,
              threscol = "blue",
              threshold = 70,
              thresbreaks = c("fixed","monthly","seasonal"),
              thresbreakdays = c("01/06","01/10"),
              recessionperiod = TRUE,
              recessioncol = "darkblue",
              seglength = 7,
              ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="recessionplot_+3A_lfobj">lfobj</code></td>
<td>
<p>A object of class <code>'lfobj'</code></p>
</td></tr>
<tr><td><code id="recessionplot_+3A_peaklevel">peaklevel</code></td>
<td>
<p>A level between 0 and 1 or a logical vector, see
details.</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_plot">plot</code></td>
<td>
<p>Should a plot be made</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_peakreturn">peakreturn</code></td>
<td>
<p>Should a logical with rain peaks be returned</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_thresplot">thresplot</code></td>
<td>
<p>Should the threshold be plotted</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_threscol">threscol</code></td>
<td>
<p>Colour of threshold in plot</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_threshold">threshold</code></td>
<td>
<p>Threshold level (70 refers to Q70)</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_thresbreaks">thresbreaks</code></td>
<td>
<p>&quot;fixed&quot; uses a fixed threshold level, &quot;monthly&quot;
calculates the threshold for every month separately, &quot;seasonal&quot;
calculates thresholds for every season defined using
<code>'thresbreakdays'</code>.</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_thresbreakdays">thresbreakdays</code></td>
<td>
<p>Needed if <code>thresbreaks = 'seasonal'</code> to define
the periods for which separate thresholds should be calculated, see
details</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_recessionperiod">recessionperiod</code></td>
<td>
<p>Should recession periods be marked</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_recessioncol">recessioncol</code></td>
<td>
<p>Colour of recession period marks</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_seglength">seglength</code></td>
<td>
<p>The minimum number of days to be marked as recession period</p>
</td></tr>
<tr><td><code id="recessionplot_+3A_...">...</code></td>
<td>
<p>Further arguments handed to <code><a href="#topic+hydrograph">hydrograph</a></code></p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>For recession analysis it is necessary to define flood discharge peaks
in the hydrograph. The peak level defines a day to be a
discharge peak, if <code>peaklevel * flow &gt; flow[day before]</code> and
<code>peaklevel * flow &gt; flow[day after]</code>.
</p>
<p>This function can be used to check different values of the peak level.
</p>


<h3>Value</h3>

<p>If <code>'peakreturn = TRUE'</code>: A logical vector giving rain peaks as <code>TRUE</code></p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recession">recession</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# To few points identified as peak flood discharge
recessionplot(ngaruroro, peaklevel = .5, start = 1991, end = 1991)

# To many
recessionplot(ngaruroro, peaklevel = .999, start = 1991, end = 1991)

# Good choice?
recessionplot(ngaruroro, peaklevel = .92, start = 1991, end = 1991)

# Getting peakdays for 1991
peak &lt;- recessionplot(ngaruroro, peaklevel = .92, plot = FALSE, peakreturn = TRUE)
rain1991 &lt;- subset(ngaruroro, subset = (hyear == 1991) &amp; peak, select = c(day, month, year))
</code></pre>

<hr>
<h2 id='reversing'>Reversed functions for several Extreme Value Distributions</h2><span id='topic+reversing'></span><span id='topic+cdf_ev'></span><span id='topic+pel_ev'></span><span id='topic+qua_ev'></span>

<h3>Description</h3>

<p>As several Extreme Value distributions are parameterized for high extreme values, reversed functions for minima (e.g. low flow statistics) are derived. Reversing is done by fitting to the negated data (<code>-x</code>), subtracting probabilities from one (<code>1 - f</code>) and computing the negated probabilities.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf_ev(distribution, x, para)
pel_ev(distribution, lmom, ...)
qua_ev(distribution, f, para)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reversing_+3A_distribution">distribution</code></td>
<td>
<p>character vector of length one containing the name of the distribution. The family of the chosen distribution must be supported by the package <span class="pkg">lmom</span>. See <code><a href="lmom.html#topic+lmom">lmom</a></code>. For example <code>distribution = "gev"</code> directly uses the functions from package <span class="pkg">lmom</span>, whereas <code>distribution = "gevR"</code> performs reversing.</p>
</td></tr>
<tr><td><code id="reversing_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="reversing_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="reversing_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution, in the order zeta, beta, delta (location, scale, shape).</p>
</td></tr>
<tr><td><code id="reversing_+3A_lmom">lmom</code></td>
<td>
<p>Numeric vector containing the L-moments of the distribution or of a data sample. E.g. as returned by <code>samlmu(x)</code>.</p>
</td></tr>
<tr><td><code id="reversing_+3A_...">...</code></td>
<td>
<p>parameters like <code>bound</code>, passed on to the estimating function. E.g. in case of <code>dist = 'wei'</code> to <code>pelwei</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>'cdf_ev'</code> gives the distribution function; <code>'qua_ev'</code> gives the quantile function.</p>


<h3>See Also</h3>

<p><code><a href="lmom.html#topic+lmom">lmom</a></code>, <code><a href="lmom.html#topic+cdfgev">cdfgev</a></code>, <code><a href="lmom.html#topic+cdfgev">cdfgev</a></code>, <code><a href="lmom.html#topic+pel-functions">pel-functions</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
ng &lt;- as.xts(ngaruroro)
minima &lt;- as.vector(apply.yearly(ng$discharge, min, na.rm = TRUE))

# Weibull distribution and reversed GEV give the same results
distr &lt;- "wei"
qua_ev(distr, seq(0, 1, 0.1), para = pel_ev(distr, samlmu(minima)))

distr &lt;- "gevR"
qua_ev(distr, seq(0, 1, 0.1), para = pel_ev(distr, samlmu(minima)))
</code></pre>

<hr>
<h2 id='rfa'>Regional Frequency Analysis</h2><span id='topic+rfa'></span>

<h3>Description</h3>

<p>This function uses J.R.M. Hosking's package produce an object of class
<code>'rfd'</code>, containing the specification of the regional frequency distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfa(lflist, n = 7, event = 100, dist = c("wei", "gev", "ln3", "gum", "pe3"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rfa_+3A_lflist">lflist</code></td>
<td>
<p>A list of <code>'lfobj'</code>s.</p>
</td></tr>
<tr><td><code id="rfa_+3A_n">n</code></td>
<td>
<p><abbr><span class="acronym">MAM</span></abbr>-n is used (e.g. n=7 means <abbr><span class="acronym">MAM</span></abbr>7).</p>
</td></tr>
<tr><td><code id="rfa_+3A_event">event</code></td>
<td>
<p>A value for T, e.g. event = 100 means the 100 years extreme low flow event.</p>
</td></tr>
<tr><td><code id="rfa_+3A_dist">dist</code></td>
<td>
<p>A vector of distribution to fit, the names are according to
Hosking's in his <span class="pkg">lmom</span> package. Can be an of  <code>"wei"</code>, <code>"gev"</code>,
<code>"ln3"</code>, <code>"gum"</code>, <code>"pe3"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"rfd"</code>,
containing the specification of the regional frequency distribution:
It is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>dist</code></td>
<td>
<p>The character string <code>dist</code>.</p>
</td></tr>
<tr><td><code>para</code></td>
<td>
<p>Vector containing the parameters of the fitted regional distribution.</p>
</td></tr>
<tr><td><code>qfunc</code></td>
<td>
<p>The quantile function of distribution <code>dist</code>.
It is a function that takes a single argument, a vector of probabilities,
and returns a vector of quantiles.</p>
</td></tr>
<tr><td><code>rmom</code></td>
<td>
<p>The regional average <code class="reqn">L</code>-moments.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>Index flood values at each site.  This is a named vector
whose values are the index flood values at each site, from <code>regdata[[3]]</code>,
and whose names are the site names, from <code>regdata[[1]]</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation
and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
<a href="https://library.wmo.int/doc_num.php?explnum_id=7699">https://library.wmo.int/doc_num.php?explnum_id=7699</a>
</p>


<h3>See Also</h3>

<p><code><a href="lmomRFA.html#topic+regfit">regfit</a></code> and <code><a href="lmom.html#topic+lmom-package">lmom-package</a></code> which this function wraps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# Toy example to get some more "rivers"
seventies &lt;- subset(ngaruroro, hyear %in% 1970:1979)
eighties &lt;- subset(ngaruroro, hyear %in% 1980:1989)
nineties &lt;- subset(ngaruroro, hyear %in% 1990:1999)

toyrfa &lt;- rfa(list(seventies,eighties,nineties), n=3,dist = "gev")

require(lmomRFA)
regquant(c(1/1000,1/100),toyrfa)
sitequant(1/100,toyrfa)
</code></pre>

<hr>
<h2 id='rfaplot'>Regional Frequency Analysis</h2><span id='topic+rfaplot'></span>

<h3>Description</h3>

<p>This function uses J.R.M. Hosking's package <span class="pkg">lmom</span> to produce a L-moment diagram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfaplot(lflist, n = 7, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rfaplot_+3A_lflist">lflist</code></td>
<td>
<p>A list of <code>'lfobj'</code>s.</p>
</td></tr>
<tr><td><code id="rfaplot_+3A_n">n</code></td>
<td>
<p><abbr><span class="acronym">MAM</span></abbr>-n is used (e.g. n=7 means <abbr><span class="acronym">MAM</span></abbr>7).</p>
</td></tr>
<tr><td><code id="rfaplot_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="lmom.html#topic+lmrd">lmom::lmrd</a></code>
</p>

<dl>
<dt><code>x</code></dt><dd><p>Numeric vector of <code class="reqn">L</code>-skewness values.
</p>
<p>Alternatively, if argument <code>y</code> is omitted, <code>x</code> can be an object
that contains both <code class="reqn">L</code>-skewness and <code class="reqn">L</code>-kurtosis values.
It can be a vector with elements named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
a matrix or data frame with columns named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
or an object of class <code>"regdata"</code> (as defined in package <span class="pkg">lmomRFA</span>).
</p>
</dd>
<dt><code>y</code></dt><dd><p>Numeric vector of <code class="reqn">L</code>-kurtosis values.</p>
</dd>
<dt><code>distributions</code></dt><dd><p>Indicates the three-parameter distributions
whose <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis relations
are to be plotted as lines on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GLO</code>    </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GEV</code>    </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GPA</code>    </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GNO</code>    </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>PE3</code>    </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>WAK.LB</code> </td><td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;">               </td><td style="text-align: left;"> for the Wakeby distribution. </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>ALL.LB</code> </td><td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;">               </td><td style="text-align: left;"> for all distributions.
      </td>
</tr>

</table>











<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
The specified <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis curves will be plotted.
</p>
<p>If no three-parameter distributions are to be plotted,
specify <code>distributions</code> to be <code>FALSE</code> or
the empty string, <code>""</code>.
</p>
</dd>
<dt><code>twopar</code></dt><dd>
<p>Two-parameter distributions whose (<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) values
are to be plotted as points on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>E</code> or <code>EXP</code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>G</code> or <code>GUM</code> </td><td style="text-align: left;"> Gumbel </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>L</code> or <code>LOG</code> </td><td style="text-align: left;"> logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>N</code> or <code>NOR</code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>U</code> or <code>UNI</code> </td><td style="text-align: left;"> uniform
      </td>
</tr>

</table>

<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
<code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis points for the specified distributions will be plotted
and given one-character labels.
</p>
<p>The default is to plot the two-parameter distributions that are special
cases of the three-parameter distributions specified in
argument <code>distributions</code>.  Thus for example if
<code>distributions="GPA PE3"</code>, the default for <code>twopar</code>
is <code>"EXP NOR UNI"</code>: NOR is a special case of PE3, UNI of GPA,
EXP of both GPA and PE3.
</p>
<p>If no two-parameter distributions are to be plotted,
specify <code>twopar</code> to be <code>FALSE</code> or the empty string, <code>""</code>.
</p>
</dd>
<dt><code>xlim</code></dt><dd><p>x axis limits.
Default: <code>c(0, 0.6)</code>, expanded if necessary to cover the range of the data.</p>
</dd>
<dt><code>ylim</code></dt><dd><p>y axis limits.
Default: <code>c(0, 0.4)</code>, expanded if necessary to cover the range of the data.</p>
</dd>
<dt><code>pch</code></dt><dd><p>Plotting character to be used for the plotted
(<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) points.</p>
</dd>
<dt><code>cex</code></dt><dd><p>Symbol size for plotted points, like graphics parameter <code>cex</code>.</p>
</dd>
<dt><code>col</code></dt><dd><p>Vector specifying the colors.  If it is of length 1
and <code>x</code> is present, it will be used for the plotted points.
Otherwise it will be used for the lines on the plot.
For the default colors for the lines, see the description
of argument <code>lty</code> below.</p>
</dd>
<dt><code>lty</code></dt><dd><p>Vector specifying the line types to be used for the lines on the plot.
</p>
<p>By default, colors and line types are matched to the distributions given
in argument <code>distributions</code>, as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
      
      
      
      
      
      
      
      
      
      </td><td style="text-align: left;"> <code>GLO</code>    </td><td style="text-align: left;"> blue,  solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GEV</code>    </td><td style="text-align: left;"> green, solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GPA</code>    </td><td style="text-align: left;"> red,   solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GNO</code>    </td><td style="text-align: left;"> black, solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>PE3</code>    </td><td style="text-align: left;"> cyan,  solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>WAK.LB</code> </td><td style="text-align: left;"> red,   dashed line</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>ALL.LB</code> </td><td style="text-align: left;"> black, dashed line
      </td>
</tr>

</table>

<p>The green and cyan colors are less bright than the standard
<code>"green"</code> and <code>"cyan"</code>; they are defined to be
<code>"#00C000"</code> and <code>"#00E0E0"</code>, respectively.
</p>
</dd>
<dt><code>lwd</code></dt><dd><p>Vector specifying the line widths to be used for the lines on the plot.</p>
</dd>
<dt><code>legend.lmrd</code></dt><dd><p>Controls whether a legend,
identifying the <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis
relations of the three-parameter distributions, is plotted.
Either logical, indicating whether a legend is to be drawn,
or a list specifying arguments to the <code>legend</code> function.
Default arguments include <code>bty="n"</code>, which must be overridden
if a legend box is to be drawn; other arguments set by default are
<code>x</code>, <code>y</code>, <code>legend</code>, <code>col</code>, <code>lty</code>, and <code>lwd</code>.
</p>
<p>Not used if <code>distributions=FALSE</code>.</p>
</dd>
<dt><code>xlegend</code></dt><dd><p>x coordinate of the upper left corner of the legend.
Default: the minimum x value.
Not used if <code>distributions=FALSE</code> or <code>legend.lmrd=FALSE</code>.</p>
</dd>
<dt><code>ylegend</code></dt><dd><p>y coordinate of the upper left corner of the legend.
Default: the maximum y value.
Not used if <code>distributions=FALSE</code> or <code>legend.lmrd=FALSE</code>.</p>
</dd>
<dt><code>xlab</code></dt><dd><p>X axis label.</p>
</dd>
<dt><code>ylab</code></dt><dd><p>Y axis label.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, returned invisibly, describing what was plotted.
Useful for customization of the legend, as in one of the examples below.
List elements:
</p>
<table role = "presentation">
<tr><td><code>lines</code></td>
<td>
<p>List containing elements describing the plotted distribution curves (if any).
Each element is a vector with the same length as <code>distributions</code>.
List elements <code>distributions</code>, <code>col.lines</code>, <code>lty</code>, <code>lwd</code>.</p>
</td></tr>
<tr><td><code>twopar</code></td>
<td>
<p>Character vector containing the 1-character symbols for the
two-parameter distributions that were plotted.</p>
</td></tr>
<tr><td><code>points</code></td>
<td>
<p>List containing elements describing the plot (if any) of the data points.
List elements <code>col.pts</code>, <code>pch</code>, <code>cex</code>.</p>
</td></tr>
</table>
<p>If any of the above items was not plotted, the corresponding list element is <code>NULL</code>.
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation
and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
<a href="https://library.wmo.int/doc_num.php?explnum_id=7699">https://library.wmo.int/doc_num.php?explnum_id=7699</a>
</p>


<h3>See Also</h3>

<p><code><a href="lmom.html#topic+lmrd">lmrd</a></code> and <code><a href="lmom.html#topic+lmom-package">lmom-package</a></code> which this function wraps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# Toy example to get some more "rivers"
seventies &lt;- subset(ngaruroro, hyear %in% 1970:1979)
eighties &lt;- subset(ngaruroro, hyear %in% 1980:1989)
nineties &lt;- subset(ngaruroro, hyear %in% 1990:1999)

rfaplot(list(seventies, eighties, nineties), n = 3)
</code></pre>

<hr>
<h2 id='rpline'>Highlight quantiles/return periods</h2><span id='topic+rpline'></span>

<h3>Description</h3>

<p>Draw a Line in an extreme value plot corresponding to a given return period.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpline(fit, return.period = NULL, log = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rpline_+3A_fit">fit</code></td>
<td>
<p>object of class <code>evfit</code>, possibly created with <code>evfit()</code>.</p>
</td></tr>
<tr><td><code id="rpline_+3A_return.period">return.period</code></td>
<td>
<p>numeric vector of return periods</p>
</td></tr>
<tr><td><code id="rpline_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code>  it is assumed that probabilities were plotted on a double logarithmic scale.</p>
</td></tr>
<tr><td><code id="rpline_+3A_...">...</code></td>
<td>
<p>other arguments, passed on to <code><a href="#topic+trace_value">trace_value</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the corresponding quantiles and draws lines and labels.</p>


<h3>Value</h3>

<p>This function is used for its side effects</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
y &lt;- tyears(ngaruroro, dist = "wei", event = 100, plot = TRUE)
rp &lt;- c(1.42, 5, 10)
rpline(y, return.period = rp, suffix = c("a", "m\u00B3"))
</code></pre>

<hr>
<h2 id='sbplot'>
Seasonal Bar Chart
</h2><span id='topic+sbplot'></span>

<h3>Description</h3>

<p>Plots a seasonal bar chart for daily streamflow data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sbplot(lfobj, hyearorder = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sbplot_+3A_lfobj">lfobj</code></td>
<td>

<p>A low flow object, as created with <code>createlfobj</code>
</p>
</td></tr>
<tr><td><code id="sbplot_+3A_hyearorder">hyearorder</code></td>
<td>

<p>logical, if TRUE the bars are plotted according to the hydrological
year, if FALSE they start with January.
</p>
</td></tr></table>


<h3>Value</h3>

<p>An object of class <code>trellis</code>, see <code><a href="lattice.html#topic+barchart">barchart</a></code>.</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createlfobj">createlfobj</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
sbplot(ngaruroro)

# Starting with january
sbplot(ngaruroro, hyearorder = FALSE)
</code></pre>

<hr>
<h2 id='seasindex'>
Seasonality Index
</h2><span id='topic+seasindex'></span>

<h3>Description</h3>

<p>Calculates the seasonality index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasindex(lfobj,
          Q = 95,
          na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seasindex_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code></p>
</td></tr>
<tr><td><code id="seasindex_+3A_q">Q</code></td>
<td>
<p>Which quantile to use (standard = Q95)</p>
</td></tr>
<tr><td><code id="seasindex_+3A_na.rm">na.rm</code></td>
<td>
<p>Should missing values be ignored?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list describing the arrow
</p>
<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>Angle in radians</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>Julian Date</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>Length</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Laaha, G. and Bl\&quot;oschl, G. (2006), Seasonality indices for regionalizing
low flows. Hydrol. Process., 20
</p>
<p>Laaha, G. Process Based Regionalisation of Low Flows, Band 198 von Wiener
Mitteilungen, Inst. f\&quot;ur Wasserbau u. Ingenieurhydrologie,
Techn. Univ. Wien, 2006, ISBN 3852340896</p>


<h3>See Also</h3>

<p><code><a href="#topic+seasindex">seasindex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)

# Start of the hydrological year (01/12) is taken as second break day
seasindex(ngaruroro)
</code></pre>

<hr>
<h2 id='season'>
Attribute dates to seasons
</h2><span id='topic+season'></span>

<h3>Description</h3>

<p>Based on a vector of breaks (start dates) dates are classified into seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>season(x, start = c(winter = as.Date("2005-12-01"),
                    spring = as.Date("2005-03-01"),
                    summer = as.Date("2005-06-01"),
                    autumn = as.Date("2005-09-01")))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="season_+3A_x">x</code></td>
<td>

<p>Vector of dates to be classified into seasons. Methods for class <code>'numeric'</code>, <code>'Date'</code> and <code>'POSIXct'</code> exist. If input is numeric it is assumed to be the day of the year (see <code><a href="base.html#topic+strptime">strptime</a></code> <code>'%j'</code>).
</p>
</td></tr>
<tr><td><code id="season_+3A_start">start</code></td>
<td>
<p>Possibly named vector of starts of a season. If the vector is
unnamed generic names are used and a warning is risen.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Factor of classifications of seasons.
</p>


<h3>See Also</h3>

<p><code>link{apply.seasonal}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># input vector is of class Date
times &lt;- seq(from = Sys.Date(), to = Sys.Date() + 500, by = 20)
season(times)

# input vector is numeric (the day of the year)
n &lt;- as.numeric(format(times, "%j"))
season(n)

identical(season(times), season(n))
</code></pre>

<hr>
<h2 id='seasratio'>
Seasonality Ratio
</h2><span id='topic+seasratio'></span>

<h3>Description</h3>

<p>Calculates the seasonality ratio for two seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasratio(lfobj,
          breakdays,
          Q = 95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seasratio_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>"lfobj"</code></p>
</td></tr>
<tr><td><code id="seasratio_+3A_breakdays">breakdays</code></td>
<td>
<p>One or two dates defining the summer/winter season</p>
</td></tr>
<tr><td><code id="seasratio_+3A_q">Q</code></td>
<td>
<p>Which quantile to use (standard = Q95)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>'breakdays'</code> is a single day, e.g. &quot;01/06&quot;, the start of the hydrological year is taken as the second break day. If other seasons are to be specified, a vector of two break days is needed.
</p>


<h3>Value</h3>

<p>The seasonality ratio.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Laaha, G. and Bl\&quot;oschl, G. (2006), Seasonality indices for regionalizing low flows. Hydrol. Process., 20
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seasindex">seasindex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)

# Start of the hydrological year (01/12) is taken as second break day
seasratio(ngaruroro, breakdays = "01/07")

# Two breakdays
seasratio(ngaruroro, breakdays = c("01/03","01/09"))
</code></pre>

<hr>
<h2 id='seglenplot'>
Bar chart of recession length
</h2><span id='topic+seglenplot'></span>

<h3>Description</h3>

<p>Plots a bar chart to find a good value for argument <code>'seglength'</code> when using
<code><a href="#topic+recession">recession</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seglenplot(lfobj,
           threslevel = 70,
           thresbreaks = c("fixed","monthly","seasonal"),
           thresbreakdays = NULL,
           rainpeaklevel = 0.95,
           na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seglenplot_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code></p>
</td></tr>
<tr><td><code id="seglenplot_+3A_threslevel">threslevel</code></td>
<td>
<p>The threshold level (70 means Q70)</p>
</td></tr>
<tr><td><code id="seglenplot_+3A_thresbreaks">thresbreaks</code></td>
<td>
<p><code>'fixed'</code> uses a fixed threshold level, <code>'monthly'</code>
calculates the threshold for every month separately, <code>'seasonal'</code>
calculates thresholds for every season defined using
<code>'thresbreakdays'</code>.</p>
</td></tr>
<tr><td><code id="seglenplot_+3A_thresbreakdays">thresbreakdays</code></td>
<td>
<p>Needed if <code>thresbreaks = 'seasonal'</code> to define
the periods for which separate thresholds should be calculated, see
details</p>
</td></tr>
<tr><td><code id="seglenplot_+3A_rainpeaklevel">rainpeaklevel</code></td>
<td>
<p>A level between 0 and 1 or a logical vector, see
details.</p>
</td></tr>
<tr><td><code id="seglenplot_+3A_na.rm">na.rm</code></td>
<td>
<p>Should NAs in the series be ignored?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For recession analysis it is necessary to define flood discharge peaks
(rain peaks) in the hydrograph. Argument <code>rainpeaklevel</code> defines a day to be a
discharge peak, if <code>rainpeaklevel * flow &gt; flow[day before]</code> and
<code>rainpeaklevel * flow &gt; flow[day after]</code>.
</p>
<p>If  <code>'thresbreakdays'</code> or  <code>'seasonbreakdays'</code> is a single day, e.g. <code>'01/06'</code>, the start of the hydrological year is taken as the second break day. If more than two seasons are to be specified, a vector of all break days is needed.
</p>


<h3>Value</h3>

<p>A bar chart
</p>


<h3>Warning</h3>

<p>Other then in the manual, we implemented a bar chart
instead of a histogram. To save space, empty bars are not plotted!
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recession">recession</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
seglenplot(ngaruroro)
</code></pre>

<hr>
<h2 id='setlfunit'>
Define the unit to use in low flow plots
</h2><span id='topic+setlfunit'></span>

<h3>Description</h3>

<p>Sets the option for the unit in plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setlfunit(string = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setlfunit_+3A_string">string</code></td>
<td>
<p>String of the unit</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unit string should be readable for the R-function
<code><a href="base.html#topic+expression">expression</a></code>, for common units see example below.
</p>


<h3>Value</h3>

<p>No return value, called for side effects. For the current R session a unit for discharges is set.</p>


<h3>Warning</h3>

<p>No calculation on data is done by setting this string.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
# Default: no unit
bfplot(ngaruroro, year = 1991)

# The plot does not change, just the y-label does!
setlfunit("m^3/s")
bfplot(ngaruroro,year = 1991)

# Some possible labels:
setlfunit("m^3/s")
setlfunit("m^{3}*s^{-1}")
setlfunit("scriptscriptstyle(frac(m^3,s))")
setlfunit("l/s")
setlfunit("l*s^{-1}")
setlfunit("scriptscriptstyle(frac(l,s))")
setlfunit("m^3/s/km^2")
setlfunit("m^3*s^{-1}*km^{-2}")
setlfunit("scriptscriptstyle(frac(m^3,s%.%km^2))")
setlfunit("l/s/km^2")
setlfunit("l*s^{-1}*km^{-2}")
setlfunit("scriptscriptstyle(frac(l,s%.%km^2))")
</code></pre>

<hr>
<h2 id='streamdef'>
Streamflow Deficit
</h2><span id='topic+streamdef'></span>

<h3>Description</h3>

<p>Calculates the streamflow deficit. Deprecated, use <code><a href="#topic+find_droughts">find_droughts</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>streamdef(lfobj,
          pooling = c("none", "MA", "IT", "IC"),
          threslevel = 70,
          thresbreaks = c("fixed","monthly","daily","seasonal"),
          breakdays = c("01/06","01/10"),
          MAdays = 7,
          tmin = 5,
          IClevel = 0.1,
          mindur = 0,
          minvol = 0,
          table = c("all", "volmax", "durmax"),
          na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="streamdef_+3A_lfobj">lfobj</code></td>
<td>

<p>An object of class <code>"lfobj"</code>
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_pooling">pooling</code></td>
<td>

<p>The pooling procedure used, &quot;MA&quot; stands for moving average, &quot;IT&quot; is the inter event time and &quot;IC&quot; is Lena Tallaksen's inter event time and volume criterion.
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_threslevel">threslevel</code></td>
<td>

<p>The threshold level, 70 means that Q70 should be used as threshold
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_thresbreaks">thresbreaks</code></td>
<td>

<p>The periods for which separated thresholds should be used, <code>'fixed'</code> uses a constant threshold, <code>'monthly'</code> uses monthly breaks, <code>'daily'</code> takes daily threshold levels. If <code>'seasonal'</code> is specified, you can enter the break days manually using <code>'breakdays'</code>.
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if <code>thresbreaks = "seasonal"</code>. Please enter the break days using the format &quot;
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_madays">MAdays</code></td>
<td>

<p>If pooling = &quot;MA&quot; this is the number of days that should be averaged
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_tmin">tmin</code></td>
<td>

<p>Defines the number of days that low flow events must be separated within the &quot;IT&quot; or &quot;IC&quot; method.
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_iclevel">IClevel</code></td>
<td>

<p>The ratio between inter-event excess volume in the &quot;IC&quot; method
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_mindur">mindur</code></td>
<td>

<p>The minimal duration of a low flow event in &quot;IC&quot; and &quot;IT&quot; method
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_minvol">minvol</code></td>
<td>

<p>The minimal deficit in a low flow period in &quot;IC&quot; and &quot;IT&quot; method
</p>
</td></tr>
<tr><td><code id="streamdef_+3A_table">table</code></td>
<td>
<p>Should the output be a table of <code>"all"</code> deficit, <code>"volmax"</code>
annual volume maxima or <code>"durmax"</code> annual duration maxima</p>
</td></tr>
<tr><td><code id="streamdef_+3A_na.rm">na.rm</code></td>
<td>
<p>Should NAs be removed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When method <code>'MA'</code> is applied, the first and last <code>MAdays/2</code> are not averaged, their original value is taken instead!
</p>


<h3>Value</h3>

<p>A data frame containing characteristics of all low flow periods.
</p>
<table role = "presentation">
<tr><td><code>d</code></td>
<td>
<p>The duration of the low flow event</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>The drought volume (negative Values, as it is a deficit)</p>
</td></tr>
<tr><td><code>mi</code></td>
<td>
<p>The drought magnitude, i.e. the (positive) ratio between deficit volume and deficit duration</p>
</td></tr>
<tr><td><code>Qmin</code></td>
<td>
<p>The minimum flow of the low flow period</p>
</td></tr>
<tr><td><code>startyear</code></td>
<td>
<p>Year of the start of the low flow period</p>
</td></tr>
<tr><td><code>startmonth</code></td>
<td>
<p>Month of the start of the low flow period</p>
</td></tr>
<tr><td><code>startday</code></td>
<td>
<p>Day of the start of the low flow period</p>
</td></tr>
</table>
<p>Please note that when using the &quot;IT&quot; method the end date of the low flow period is not necessarily start date + duration.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+streamdefplot">streamdefplot</a></code>, <code><a href="#topic+createlfobj">createlfobj</a></code>, <code><a href="#topic+find_droughts">find_droughts</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
ng &lt;- subset(ngaruroro, hyear &gt; 1980)

# Full Table
streamdef(ng, pooling = "MA", MAdays = 6)

# Annual Volume-Maxima only
streamdef(ng, pooling = "MA", MAdays = 6,table = "volmax")
</code></pre>

<hr>
<h2 id='streamdefplot'>
Streamflow Deficit Plot
</h2><span id='topic+streamdefplot'></span>

<h3>Description</h3>

<p>Gives a plot for a given hydrological year that shows deficit
duration, occurrence and volume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>streamdefplot(lfobj, year, threslevel = 70, thresbreaks = c("fixed",
                 "monthly", "daily", "seasonal"), breakdays =
                 c("01/06", "01/10"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="streamdefplot_+3A_lfobj">lfobj</code></td>
<td>

<p>An object of class <code>'lfobj'</code>
</p>
</td></tr>
<tr><td><code id="streamdefplot_+3A_year">year</code></td>
<td>

<p>The hydrological year that should be plotted
</p>
</td></tr>
<tr><td><code id="streamdefplot_+3A_threslevel">threslevel</code></td>
<td>

<p>The threshold level, 70 means that Q70 should be used as threshold
</p>
</td></tr>
<tr><td><code id="streamdefplot_+3A_thresbreaks">thresbreaks</code></td>
<td>

<p>The periods for which separated thresholds should be used, <code>'fixed'</code> uses a constant threshold, <code>'monthly'</code> uses monthly breaks, <code>'daily'</code> takes daily threshold levels. If <code>'seasonal'</code> is specified, you can enter the break days manually using <code>'breakdays'</code>.
</p>
</td></tr>
<tr><td><code id="streamdefplot_+3A_breakdays">breakdays</code></td>
<td>

<p>A vector of break days if <code>thresbreaks = 'seasonal'</code>. Please enter the break days using the format <code>'%d/%m'</code>, e.g. c(<code>'01/03'</code>, <code>'01/09'</code>) uses the first of March an the first of September as break days.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects (plotting).</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p><code>streamdef</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
streamdefplot(ngaruroro, year = 1991)
</code></pre>

<hr>
<h2 id='summary.deficit'>Object Summaries</h2><span id='topic+summary.deficit'></span>

<h3>Description</h3>

<p>Summarizes an object of class deficit. For every drought event the start, end as well as the drought volume and duration is listed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'deficit'
summary(object, drop_minor = c(volume = "0.5%", duration = 5), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.deficit_+3A_object">object</code></td>
<td>
<p>an object of class deficit, as produced by <code><a href="#topic+find_droughts">find_droughts</a></code>.</p>
</td></tr>
<tr><td><code id="summary.deficit_+3A_drop_minor">drop_minor</code></td>
<td>
<p>a vector of length one or two, determining the filtering of minor droughts. If <code>drop_minor</code> is of length one and its value is zero, no filtering is applied. Also a numeric of character vector of length two with the named elements <code>volume</code> and <code>duration</code> is accepted. If a value contains the percentage (%) sign this percentage of the maximum duration or volume is used a the filter criterion.</p>
</td></tr>
<tr><td><code id="summary.deficit_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame where each row corresponds to an event. There are summarizing columns
</p>
<table role = "presentation">
<tr><td><code>event.no</code></td>
<td>
<p>the event id</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>the starting day of the drought event</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>the day which the event is attributed to. Usually identical with column <code>start</code>, unless the object <code>x</code> is the result of the Sequent Peak Algorithm.</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>
<p>the volume of the drought event in cubic meters</p>
</td></tr>
<tr><td><code>duration</code></td>
<td>
<p>the duration of the drought event in days</p>
</td></tr>
<tr><td><code>dbt</code></td>
<td>
<p>days below threshold. Number of days the discharge is lower than the given threshold.</p>
</td></tr>
<tr><td><code>qmin</code></td>
<td>
<p>the minimum discharge</p>
</td></tr>
<tr><td><code>tqmin</code></td>
<td>
<p>date of the minimum discharge</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(ray)
ray &lt;- as.xts(ray)["1970::1970", ]
r &lt;- find_droughts(ray, threshold = 0.02)
summary(r)      # minor events got filtered

summary(r, drop_minor = 0)      # no filtering
summary(r, drop_minor = c("volume" = 10000, "duration" = 5))
summary(r, drop_minor = c("volume" = "10%", "duration" = 5))
</code></pre>

<hr>
<h2 id='trace_value'>Draw Paths to Points perpendicular to Coordinate Axis</h2><span id='topic+trace_value'></span>

<h3>Description</h3>

<p>To depict the distances in <code>x</code> and <code>y</code> direction to a point, draw lines and labels.</p>


<h3>Usage</h3>

<pre><code class='language-R'>trace_value(x, y, digits = 0, annotate = TRUE, lab.x = x, lab.y = y, prefix = "",
            suffix = "", cex = 0.75, col = "blue", lty = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trace_value_+3A_x">x</code></td>
<td>
<p>numeric vector of x coordinates</p>
</td></tr>
<tr><td><code id="trace_value_+3A_y">y</code></td>
<td>
<p>numeric vector of y coordinates</p>
</td></tr>
<tr><td><code id="trace_value_+3A_digits">digits</code></td>
<td>
<p>vector of length one or two, giving the number of digits used for rounding the label of the <code>x</code> and <code>y</code> coordinate.</p>
</td></tr>
<tr><td><code id="trace_value_+3A_annotate">annotate</code></td>
<td>
<p>logical, should the lines get annotated with labels?</p>
</td></tr>
<tr><td><code id="trace_value_+3A_lab.x">lab.x</code></td>
<td>
<p>character vector of length one. Label of the <code>x</code> coordinate.</p>
</td></tr>
<tr><td><code id="trace_value_+3A_lab.y">lab.y</code></td>
<td>
<p>character vector of length one. Label of the <code>y</code> coordinate.</p>
</td></tr>
<tr><td><code id="trace_value_+3A_prefix">prefix</code></td>
<td>
<p>vector of length one or two, text printed before the label of the <code>x</code> and <code>y</code> coordinate.</p>
</td></tr>
<tr><td><code id="trace_value_+3A_suffix">suffix</code></td>
<td>
<p>vector of length one or two, text printed after the label of the <code>x</code> and <code>y</code> coordinate.</p>
</td></tr>
<tr><td><code id="trace_value_+3A_cex">cex</code></td>
<td>
<p>character expansion factor</p>
</td></tr>
<tr><td><code id="trace_value_+3A_col">col</code></td>
<td>
<p>colour used for text and lines</p>
</td></tr>
<tr><td><code id="trace_value_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="trace_value_+3A_...">...</code></td>
<td>
<p>other graphical parameters, passed on to <code>lines</code>, <code>points</code> and <code>text</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorised over <code>x</code> and <code>y</code>.</p>


<h3>Value</h3>

<p>No return value, called for side effects (plotting).</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(-2, 3)
curve(sin, -2*pi, 2*pi, xname = "t")
trace_value(x, sin(x), digits = c(0, 1))
</code></pre>

<hr>
<h2 id='tyears'>
Calculate Low-Flow Quantiles for given Return Periods
</h2><span id='topic+tyears'></span>

<h3>Description</h3>

<p>Fits an extreme value distribution using <var>L</var>-moments to the minima of a time series of discharges and subsequently estimates quantiles (the so called <var>T</var>-years event) for given return periods. In the presence of zero flow observations a mixed distribution is fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tyears(lfobj, event = 1/probs, probs = 0.01,
       dist = "wei", check = TRUE, zeta = zetawei, zetawei = NULL,
       plot = TRUE, col = 1, log = TRUE, legend = TRUE,
       rp.axis = "top", rp.lab = "Return period",
       freq.axis = TRUE,
       freq.lab = expression(paste("Frequency " *(italic(F)),
                                   " = Non-Exceedance Probability P ",
                                   (italic(X) &lt;= italic(x)))),
       xlab = expression("Reduced variate,  " * -log(-log(italic(F)))),
       ylab = "Quantile",
       hyearstart = hyear_start(lfobj),
       n = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tyears_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code> or an object which can be coerced to class <code>'xts'</code>. Either with a single column or with a column named <code>'discharge'</code>.</p>
</td></tr>
<tr><td><code id="tyears_+3A_event">event</code></td>
<td>
<p>numeric vector specifying the return periods. E.g. <code>event = 100</code> will yield the 100 years extreme low flow event.</p>
</td></tr>
<tr><td><code id="tyears_+3A_probs">probs</code></td>
<td>
<p>Alternate way to specify the return period of the event.</p>
</td></tr>
<tr><td><code id="tyears_+3A_dist">dist</code></td>
<td>
<p>A character vector of distributions to fit. Basically all distributions provided by Hosking's <code><a href="lmom.html#topic+lmom-package">lmom-package</a></code> and their reversed counterparts can be chosen.</p>
</td></tr>
<tr><td><code id="tyears_+3A_check">check</code></td>
<td>
<p>logical, should <code><a href="#topic+check_distribution">check_distribution</a></code> get called?</p>
</td></tr>
<tr><td><code id="tyears_+3A_zeta">zeta</code></td>
<td>
<p>numeric vector of length one for manually setting a lower bound. Only a few distributions allow for a lower bound, namely <code>'gpa'</code>, <code>'ln3'</code>, <code>'wak'</code> and <code>'wei'</code>. The default value of <code>NULL</code> results in not bounding the distribution, therefore the parameter <code>zeta</code> is estimated.</p>
</td></tr>
<tr><td><code id="tyears_+3A_zetawei">zetawei</code></td>
<td>
<p>same as <code>zeta</code></p>
</td></tr>
<tr><td><code id="tyears_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code>, sample observations as well as estimated quantile functions are plotted.</p>
</td></tr>
<tr><td><code id="tyears_+3A_col">col</code></td>
<td>
<p>numeric or character vector of length one or as long as <code>dist</code>, specifying the colour used for plotting.</p>
</td></tr>
<tr><td><code id="tyears_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code> probabilities will be plotted on a double logarithmic scale.</p>
</td></tr>
<tr><td><code id="tyears_+3A_legend">legend</code></td>
<td>
<p>logical, should a legend be added to the plot?</p>
</td></tr>
<tr><td><code id="tyears_+3A_rp.axis">rp.axis</code></td>
<td>
<p>vector of length one, specifying if and how an additional scale bar for the return periods is drawn. Possible choices are <code>'bottom'</code>, <code>'top'</code> and <code>'none'</code>. Alternatively, the position of the scale bar can be specified as an real number between 0 and 1, indicating the y-position of the legend.</p>
</td></tr>
<tr><td><code id="tyears_+3A_rp.lab">rp.lab</code></td>
<td>
<p>character vector, text above the scale bar for return periods</p>
</td></tr>
<tr><td><code id="tyears_+3A_freq.axis">freq.axis</code></td>
<td>
<p>logical, should an additional abscissa showing the probabilities be drawn on top of the plot?</p>
</td></tr>
<tr><td><code id="tyears_+3A_freq.lab">freq.lab</code></td>
<td>
<p>character vector, text above the probability axis</p>
</td></tr>
<tr><td><code id="tyears_+3A_xlab">xlab</code></td>
<td>
<p>character vector, a label for the x axis</p>
</td></tr>
<tr><td><code id="tyears_+3A_ylab">ylab</code></td>
<td>
<p>character vector, a label for the y axis</p>
</td></tr>
<tr><td><code id="tyears_+3A_hyearstart">hyearstart</code></td>
<td>
<p>vector of length one, providing the start of the hydrological year. This is evaluated by <code><a href="#topic+water_year">water_year</a></code>. The default is, to retrieve the values stored in the attributes of the <code>lfobj</code>.</p>
</td></tr>
<tr><td><code id="tyears_+3A_n">n</code></td>
<td>
<p>Argument 'n' is deprecated and ignored. To apply a moving average, do it prior to calling <code>'tyears'</code>. See section Examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorised over <code>dist</code> and <code>event</code>.
</p>
<p>According to paragraph 7.4.2 of the <abbr><span class="acronym">WNO</span></abbr> manual, special care has to be taken in the presence of zero flow observations. A cdf called G(x) is fitted to the non-zero values of the original  time series
</p>
<p>If a distribution is fitted which allows for finite lower bound (<code>zeta</code>), and <code>zeta</code> is estimated being negative, estimation is repeated constraining <code>zeta = 0</code>. If this behavior is not desired, the parameter <code>zeta</code> has to be set explicitly.
</p>


<h3>Value</h3>

<p>An object of class <code>'evfit'</code>, see <code><a href="#topic+evfit">evfit</a></code>.
</p>


<h3>Author(s)</h3>

<p>Daniel Koffler and Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p>There are methods for printing summarizing objects of class <code>'evfit'</code>.
</p>
<p><code><a href="#topic+evfit">evfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
ng &lt;- subset(ngaruroro, hyear %in% 1964:2000)

# vector of return periods
rp &lt;- c(1.5, 5, 10, 100)

# Fitting some distributions for the low flows (annual minima)
# and estimating the quantile for arbitrary return periods
y &lt;- tyears(ng, dist = c("gum", "wei", "ln3", "pe3"), event = rp,
            plot = FALSE)

# print()ing the object shows just the return periods
y

# but y is actually a list
str(y)

# there is a summary method, returning L-moments and estimated parameters
summary(y)

plot(y)


# fitting just one distribution, with annotated quantiles
z &lt;- tyears(ng, dist = c("gevR"), event = rp)
rpline(y, return.period = rp, suffix = c("a", "m\u00B3"))


# applying a moving average before fitting
ng2 &lt;- ng
ng2$flow &lt;- ma(ng2$flow, n = 4)
tyears(ng2, dist = c("gum", "wei", "ln3", "pe3"), event = rp,
       plot = FALSE)
</code></pre>

<hr>
<h2 id='tyearsS'>
Calculate Low-Flow Quantiles for given Return Periods
</h2><span id='topic+tyearsS'></span>

<h3>Description</h3>

<p>Fits an extreme value distribution using <var>L</var>-moments to the dry spells of a time series of discharges and subsequently estimates quantiles (the so called <var>T</var>-years event) for given return periods. In the presence of zero flow observations a mixed distribution is fitted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tyearsS(lfobj, event = 1/probs, probs = 0.01, pooling = NULL,
        dist = "wei", check = TRUE, zeta = NULL,
        plot = TRUE, col = 1, log = TRUE, legend = TRUE,
        rp.axis = "bottom", rp.lab = "Return period", freq.axis = TRUE,
        freq.lab = expression(paste("Frequency " *(italic(F)),
                                    " = Non-Exceedance Probability P ",
                                    (italic(X) &lt;= italic(x)))),
        xlab = expression("Reduced variate,  " * -log(-log(italic(F)))),
        ylab = "Quantile",
        variable = c("volume", "duration"), aggr = "max",
        hyearstart = hyear_start(lfobj), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tyearsS_+3A_lfobj">lfobj</code></td>
<td>
<p>An object of class <code>'lfobj'</code> or an object which can be coerced to class <code>'xts'</code>. Either with a single column or with a column named 'discharge'.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_event">event</code></td>
<td>
<p>numeric vector specifying the return periods. E.g. <code>event = 100</code> will yield the 100 years extreme low flow event.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_probs">probs</code></td>
<td>
<p>Alternate way to specify the return period of the event.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_pooling">pooling</code></td>
<td>
<p>a pooling function, see <code><a href="#topic+pooling">pooling</a></code>.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_dist">dist</code></td>
<td>
<p>A character vector of distributions to fit. Basically all distributions provided by Hosking's <code><a href="lmom.html#topic+lmom-package">lmom-package</a></code> and their reversed counterparts can be chosen.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_check">check</code></td>
<td>
<p>logical, should <code><a href="#topic+check_distribution">check_distribution</a></code> get called?</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_zeta">zeta</code></td>
<td>
<p>numeric vector of length one for manually setting a lower bound. Only a few distributions allow for a lower bound, namely <code>'gpa'</code>, <code>'ln3'</code>, <code>'wak'</code> and <code>'wei'</code>. The default value of <code>NULL</code> results in not bounding the distribution, therefore the parameter <code>zeta</code> is estimated.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code>, sample observations as well as estimated quantile functions are plotted.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_col">col</code></td>
<td>
<p>numeric or character vector of length one or as long as <code>dist</code>, specifying the colour used for plotting.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code> probabilities will be plotted on a double logarithmic scale.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_legend">legend</code></td>
<td>
<p>logical, should a legend be added to the plot?</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_rp.axis">rp.axis</code></td>
<td>
<p>vector of length one, specifying if and how an additional scale bar for the return periods is drawn. Possible choices are <code>'bottom'</code>, <code>'top'</code> and <code>'none'</code>. Alternatively, the position of the scale bar can be specified as an real number between 0 and 1, indicating the y-position of the legend.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_rp.lab">rp.lab</code></td>
<td>
<p>character vector, text above the scale bar for return periods</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_freq.axis">freq.axis</code></td>
<td>
<p>logical, should an additional abscissa showing the probabilities be drawn on top of the plot?</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_freq.lab">freq.lab</code></td>
<td>
<p>character vector, text above the probability axis</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_xlab">xlab</code></td>
<td>
<p>character vector, a label for the x axis</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_ylab">ylab</code></td>
<td>
<p>character vector, a label for the y axis</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_variable">variable</code></td>
<td>
<p>character vector of length one. Either <code>'v'</code> to calculate volumes or <code>'d'</code> for durations.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_aggr">aggr</code></td>
<td>
<p>function like <code>max</code> or <code>sum</code> used for aggregating volumes or durations of a hydrological year.</p>
</td></tr>
<tr><td><code id="tyearsS_+3A_hyearstart">hyearstart</code></td>
<td>
<p>vector of length one, providing the start of the hydrological year. This is evaluated by <code><a href="#topic+water_year">water_year</a></code>. The default is, to retrieve the values stored in the attributes of the <code>lfobj</code>. </p>
</td></tr>
<tr><td><code id="tyearsS_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="#topic+find_droughts">find_droughts</a></code>, e.g. <code>threshold</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is vectorised over <code>dist</code> and <code>event</code>.
</p>
<p>According to paragraph 7.4.2 of the <abbr><span class="acronym">WNO</span></abbr> manual, special care has to be taken in the presence of zero flow observations. A cdf called G(x) is fitted to the non-zero values of the original  time series
</p>
<p>If a distribution is fitted which allows for finite lower bound (<code>zeta</code>), and <code>zeta</code> is estimated being negative, estimation is repeated constraining <code>zeta = 0</code>. If this behavior is not desired, the parameter <code>zeta</code> has to be set explicitly.
</p>


<h3>Value</h3>

<p>An object of class <code>'evfit'</code>, see <code><a href="#topic+evfit">evfit</a></code>.
</p>


<h3>Author(s)</h3>

<p>Gregor Laaha
</p>


<h3>References</h3>

<p>Gustard, A. &amp; Demuth, S. (2009) (Eds) Manual on Low-flow Estimation and Prediction. Operational Hydrology Report No. 50, <abbr><span class="acronym">WNO</span></abbr>-No. 1029, 136p.
</p>


<h3>See Also</h3>

<p>There are methods for printing summarizing objects of class <code>'evfit'</code>.
</p>
<p><code><a href="#topic+evfit">evfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ngaruroro")
rp &lt;- c(1.3, 3, 5, 35)
sumD &lt;- tyearsS(ngaruroro, event = rp, dist = "wei",
                variable = "d", aggr = sum)
sumD
summary(sumD)
</code></pre>

<hr>
<h2 id='vary_threshold'>Create varying thresholds </h2><span id='topic+vary_threshold'></span>

<h3>Description</h3>

<p>Helper function to easily create a daily, weekly, monthly or seasonal varying threshold.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vary_threshold(x, varying = "constant",
               fun = function(x) quantile(x, probs = 0.05, na.rm = TRUE), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vary_threshold_+3A_x">x</code></td>
<td>
<p>an object which can be coerced to class <code>'xts'</code>. Either with a single column or with a column named 'discharge'.</p>
</td></tr>
<tr><td><code id="vary_threshold_+3A_varying">varying</code></td>
<td>
<p>if <code>varying</code> is a character vector of length one, values of &quot;constant&quot;, &quot;daily&quot;, &quot;weekly&quot; and &quot;monthly&quot; are allowed. If a vector of class POSIX is provided, a seasonal varying threshold is computed, where the times provided define the start of the season. Only the day of the year is taken, the year itself doesn't have a meaning.</p>
</td></tr>
<tr><td><code id="vary_threshold_+3A_fun">fun</code></td>
<td>
<p>a function accepting a single argument and returning either a vector of length one or a vector as long as <code>x</code>.</p>
</td></tr>
<tr><td><code id="vary_threshold_+3A_...">...</code></td>
<td>
<p>additional arguments, passed on to <code>fun</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector as long as <code>x</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ngaruroro)
ng &lt;- as.xts(ngaruroro)["1983::1985", ]
r &lt;- find_droughts(ng, varying = "monthly")
plot(r)

thr1 &lt;- vary_threshold(ng, varying = "weekly", fun = mean, na.rm = TRUE)
plot(thr1)

thr2 &lt;- vary_threshold(ng, varying = "monthly", fun = mean, na.rm = TRUE)
lines(thr2, col = 2)
</code></pre>

<hr>
<h2 id='water_year'>Compute the water year</h2><span id='topic+water_year'></span>

<h3>Description</h3>

<p>Given a date, compute the corresponding water year (hydrological year).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>water_year(x, origin = "din", as.POSIX = FALSE,
           assign = c("majority", "start", "end"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="water_year_+3A_x">x</code></td>
<td>

<p>a vector, implicit coercion to class <code>'POSIXlt'</code> is performed.
</p>
</td></tr>
<tr><td><code id="water_year_+3A_origin">origin</code></td>
<td>

<p>a vector of length one specifying the month in which the hydrological year starts.  Four different ways of defining the beginning of a hydrological year are supported: a character string like <code>'din'</code> or <code>'usgs'</code> representing a definition of an institution (see Details), an integer number between 1 and 12, a character string of the month name (possibly abbreviated) or POSIX/Date object from which only the month is taken.
</p>
</td></tr>
<tr><td><code id="water_year_+3A_as.posix">as.POSIX</code></td>
<td>
<p>logical, if TRUE return value is of class <code>POSIXct</code>. Otherwise a factor is returned.</p>
</td></tr>
<tr><td><code id="water_year_+3A_assign">assign</code></td>
<td>

<p>a character vector of length one, deciding how a hydrological year is labelled. Depending on the climate, the hydrological year can start earlier or later than the calendar year. Usually the hydrological year &quot;equals&quot; the calendar year for the longest period of months they have in common. Alternatively a water year can also be designated by the calendar year in which it starts or ends.
</p>
</td></tr>
<tr><td><code id="water_year_+3A_...">...</code></td>
<td>

<p>arguments, passed on to <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code>, e.g. such as <code>format</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, it is only supported to start a hydrological year on the 1st of a month.
</p>
<p>There are abbreviations for a few established definitions:
</p>

<table>
<tr>
 <td style="text-align: left;">
   </td><td style="text-align: left;"> <b>start</b> </td><td style="text-align: left;"> <b>description</b> </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>'din'</code> </td><td style="text-align: left;"> 1st of November </td><td style="text-align: left;"> <abbr><span class="acronym">DIN</span></abbr> 4049 (default), as used in Austria and Germany </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>'usgs'</code> </td><td style="text-align: left;"> 1st of October</td><td style="text-align: left;">  <abbr><span class="acronym">USGS</span></abbr>, the United States Geological Survey</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>'swiss'</code> </td><td style="text-align: left;"> 1st of October</td><td style="text-align: left;"> as defined by the Swiss "Bundesamt f. Energie" (<abbr><span class="acronym">BFE</span></abbr>) </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>'glacier'</code> </td><td style="text-align: left;"> 1st of September </td><td style="text-align: left;"> Widely used in glaciology </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Its convenient to have the water year as a factor with levels even for year without observations. For example, otherwise years without observations don't appear after aggregation.
</p>


<h3>Value</h3>

<p>a factor representing the hydrological year. </p>


<h3>Examples</h3>

<pre><code class='language-R'># generating monthly sequence
x &lt;- seq(from = as.Date("1992-01-01"),
         by = "months", length.out = 12)

# specifying the beginning with a decimal number
water_year(x, origin = 10)

# using a month name
water_year(x, origin = "Jul")      # can be abbreviated
water_year(x, origin = "july")     # case insensitive

# using an POSIX or Date object
water_year(x, origin = as.Date("2012-08-22"))     # only month is taken
water_year(x, origin = as.POSIXct("2012-08-22"))

# or by specifying an institution
water_year(x, origin = "usgs")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
