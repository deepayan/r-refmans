<!DOCTYPE html><html lang="en"><head><title>Help for package MultiVarSel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiVarSel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultiVarSel-package'><p>Package</p></a></li>
<li><a href='#copals_camera'>
<p>Copals data</p></a></li>
<li><a href='#group'><p>This is a qualitative variable indicating the type of tree each row of Y is.</p></a></li>
<li><a href='#metab'><p>This is a dataset containing the abundance of 199 metabolites from 9 seeds samples</p>
just after germination.
The temperature of seed maturation vary between the different seeds.</a></li>
<li><a href='#prot'><p>This is a dataset containing the abundance of 724 proteins from 9 seeds samples</p>
just after germination.
The temperature of seed maturation vary between the different seeds.</a></li>
<li><a href='#variable_selection'><p>This function allows the user to select the most relevant variables thanks to</p>
the estimation of their selection frequencies obtained by the stability
selection approach.</a></li>
<li><a href='#whitening'><p>This function provides an estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.</p></a></li>
<li><a href='#whitening_choice'><p>This function helps to choose the best whitening strategy among the following types of dependence</p>
modellings: AR1, ARMA, non parametric and without any whitening.</a></li>
<li><a href='#whitening_test'><p>This function provides the p-value of an adaptation of the Portmanteau statistic to test if there is some dependence in the rows of the residuals matrix given as an argument of the function.</p></a></li>
<li><a href='#Y'><p>This is a metabolomic dataset from 30 copals samples of trees coming from Africa</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variable Selection in a Multivariate Linear Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie Perrot-Dockès, Céline Lévy-Leduc, Julien Chiquet</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marie Perrot-Dockès &lt;marie.perrocks@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It performs variable selection in a multivariate linear model by estimating the covariance matrix 
 of the residuals then use it to remove the dependence that may exist among the responses and eventually performs variable selection by using the Lasso criterion.
 The method is described in the paper Perrot-Dockès et al. (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1704.00076">doi:10.48550/arXiv.1704.00076</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>glmnet, Matrix (&ge; 1.2-11), parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-21 09:50:51 UTC; perrot-dockes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-21 10:23:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='MultiVarSel-package'>Package</h2><span id='topic+MultiVarSel-package'></span><span id='topic+MultiVarSelect'></span>

<h3>Description</h3>

<p>MultiVarSel consists of four functions: &quot;whitening.R&quot;, &quot;whitening_test.R&quot;,
&quot;whitening_choice.R&quot; and &quot;variable_selection.R&quot;.
For further information on how to use these functions, 
we refer the reader to the vignette of the package.
</p>


<h3>Details</h3>

<p>This package consists of four functions: &quot;whitening.R&quot;, &quot;whitening_test.R&quot;,
&quot;whitening_choice.R&quot; and &quot;variable_selection.R&quot;.
For further information on how to use these functions, 
we refer the reader to the vignette of the package.
</p>


<h3>Author(s)</h3>

<p>Marie Perrot-Dockes, Celine Levy-Leduc, Julien Chiquet
</p>
<p>Maintainer: Marie Perrot-Dockes &lt;marie.perrocks@gmail.com&gt;
</p>


<h3>References</h3>

<p>M. Perrot-Dockes et al. &quot;A multivariate variable selection approach 
for analyzing LC-MS metabolomics data&quot;, arXiv:1704.00076
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("copals_camera")
Y &lt;- scale(Y[, 1:50])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
S12_inv &lt;- whitening(residuals, "AR1", pAR = 1, qMA = 0)
Frequencies &lt;- variable_selection(
  Y = Y, X = X,
  square_root_inv_hat_Sigma = S12_inv,
  nb_repli = 10,  nb.cores = 1, parallel = FALSE
)
## Not run: 
# Parallel computing
require(doMC)
registerDoMC(cores=4)
Freqs &lt;- variable_selection(Y,X,square_root_inv_hat_Sigma,
                    nb_repli=10,parallel=TRUE,nb.cores=4)

## End(Not run)                   
</code></pre>

<hr>
<h2 id='copals_camera'>
Copals data
</h2><span id='topic+copals_camera'></span>

<h3>Description</h3>

<p>A Liquid Chromatography Mass Spectrometry dataset made of African copals samples.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("copals_camera")</code></pre>


<h3>Format</h3>

<p>It containes Y a data frame with 30 observations on 1019 variables  and group a
qualitative variable indicating the type of tree each row of Y is.
</p>


<h3>References</h3>

<p>M. Perrot-Dockes et al. &quot;A multivariate variable selection approach 
for analyzing LC-MS metabolomics data&quot;,  arXiv:1704.00076
<a href="https://arxiv.org/pdf/1704.00076.pdf">https://arxiv.org/pdf/1704.00076.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(copals_camera)
</code></pre>

<hr>
<h2 id='group'>This is a qualitative variable indicating the type of tree each row of Y is.</h2><span id='topic+group'></span>

<h3>Description</h3>

<p>This is a qualitative variable indicating the type of tree each row of Y is.
</p>


<h3>Author(s)</h3>

<p>Marie Perrot-Dockes <a href="mailto:marie.perrot-dockes@agroparistech.fr">marie.perrot-dockes@agroparistech.fr</a>
</p>


<h3>References</h3>

<p><a href="https://arxiv.org/pdf/1704.00076.pdf">https://arxiv.org/pdf/1704.00076.pdf</a>
</p>

<hr>
<h2 id='metab'>This is a dataset containing the abundance of 199 metabolites from 9 seeds samples
just after germination.
The temperature of seed maturation vary between the different seeds.</h2><span id='topic+metab'></span>

<h3>Description</h3>

<p>This is a dataset containing the abundance of 199 metabolites from 9 seeds samples
just after germination.
The temperature of seed maturation vary between the different seeds.
</p>


<h3>Author(s)</h3>

<p>Marie Perrot-Dockes <a href="mailto:marie.perrot-dockes@agroparistech.fr">marie.perrot-dockes@agroparistech.fr</a>
</p>

<hr>
<h2 id='prot'>This is a dataset containing the abundance of 724 proteins from 9 seeds samples
just after germination.
The temperature of seed maturation vary between the different seeds.</h2><span id='topic+prot'></span>

<h3>Description</h3>

<p>This is a dataset containing the abundance of 724 proteins from 9 seeds samples
just after germination.
The temperature of seed maturation vary between the different seeds.
</p>


<h3>Author(s)</h3>

<p>Marie Perrot-Dockes <a href="mailto:marie.perrot-dockes@agroparistech.fr">marie.perrot-dockes@agroparistech.fr</a>
</p>

<hr>
<h2 id='variable_selection'>This function allows the user to select the most relevant variables thanks to
the estimation of their selection frequencies obtained by the stability
selection approach.</h2><span id='topic+variable_selection'></span>

<h3>Description</h3>

<p>This function allows the user to select the most relevant variables thanks to
the estimation of their selection frequencies obtained by the stability
selection approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variable_selection(Y, X, square_root_inv_hat_Sigma, nb_repli = 1000,
  parallel = FALSE, nb.cores = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="variable_selection_+3A_y">Y</code></td>
<td>
<p>a response matrix</p>
</td></tr>
<tr><td><code id="variable_selection_+3A_x">X</code></td>
<td>
<p>a matrix of covariables</p>
</td></tr>
<tr><td><code id="variable_selection_+3A_square_root_inv_hat_sigma">square_root_inv_hat_Sigma</code></td>
<td>
<p>Estimation of the inverse of the square root of the covariance matrix
of each row of the residuals matrix obtained by the whitening function.</p>
</td></tr>
<tr><td><code id="variable_selection_+3A_nb_repli">nb_repli</code></td>
<td>
<p>numerical, number of replications in the stability selection</p>
</td></tr>
<tr><td><code id="variable_selection_+3A_parallel">parallel</code></td>
<td>
<p>logical, if TRUE then a parallelized version of the code is used</p>
</td></tr>
<tr><td><code id="variable_selection_+3A_nb.cores">nb.cores</code></td>
<td>
<p>numerical, number of cores used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the selection frequencies of the different variables obtained
by the stability selection, the corresponding level in the design matrix and the associated
column of the observations matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("copals_camera")
Y &lt;- scale(Y[, 1:50])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
S12_inv &lt;- whitening(residuals, "AR1", pAR = 1, qMA = 0)
Frequencies &lt;- variable_selection(
  Y = Y, X = X,
  square_root_inv_hat_Sigma = S12_inv,
  nb_repli = 10, nb.cores = 1, parallel = FALSE
)
</code></pre>

<hr>
<h2 id='whitening'>This function provides an estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.</h2><span id='topic+whitening'></span>

<h3>Description</h3>

<p>This function provides an estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whitening(residuals, typeDep, pAR = 1, qMA = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="whitening_+3A_residuals">residuals</code></td>
<td>
<p>the residuals matrix obtained by fitting a linear model to each column of the response matrix as if they were independent</p>
</td></tr>
<tr><td><code id="whitening_+3A_typedep">typeDep</code></td>
<td>
<p>character in c(&quot;AR1&quot;, &quot;ARMA&quot;, &quot;nonparam&quot;) defining which type of dependence to use</p>
</td></tr>
<tr><td><code id="whitening_+3A_par">pAR</code></td>
<td>
<p>numerical, only use if typeDep = &quot;ARMA&quot;, the parameter p for the ARMA(p, q) process</p>
</td></tr>
<tr><td><code id="whitening_+3A_qma">qMA</code></td>
<td>
<p>numerical, only use if typeDep = &quot;ARMA&quot;, the parameter q for the ARMA(p, q) process</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the estimation of the inverse of the square root of the covariance matrix of each row of the residuals matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(copals_camera)
Y &lt;- scale(Y[, 1:100])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
whitening(residuals, "AR1")
</code></pre>

<hr>
<h2 id='whitening_choice'>This function helps to choose the best whitening strategy among the following types of dependence
modellings: AR1, ARMA, non parametric and without any whitening.</h2><span id='topic+whitening_choice'></span>

<h3>Description</h3>

<p>This function helps to choose the best whitening strategy among the following types of dependence
modellings: AR1, ARMA, non parametric and without any whitening.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whitening_choice(residuals, typeDeps = "AR1", pAR = 1, qMA = 0,
  threshold = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="whitening_choice_+3A_residuals">residuals</code></td>
<td>
<p>the residuals matrix obtained by fitting a linear model to each column of the response matrix as if they were independent</p>
</td></tr>
<tr><td><code id="whitening_choice_+3A_typedeps">typeDeps</code></td>
<td>
<p>character in c(&quot;AR1&quot;, &quot;ARMA&quot;, &quot;nonparam&quot;, &quot;no_whitening&quot;) defining which dependence structure to use to whiten the residuals.</p>
</td></tr>
<tr><td><code id="whitening_choice_+3A_par">pAR</code></td>
<td>
<p>numerical, only use if typeDep = &quot;ARMA&quot;, the parameter p for the ARMA(p, q) process</p>
</td></tr>
<tr><td><code id="whitening_choice_+3A_qma">qMA</code></td>
<td>
<p>numerical, only use if typeDep = &quot;ARMA&quot;, the parameter q for the ARMA(p, q) process</p>
</td></tr>
<tr><td><code id="whitening_choice_+3A_threshold">threshold</code></td>
<td>
<p>significance level of the test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It provides a table giving the p-values for the different whitening tests applied to the residuals multiplied on the right
by the inverse of the square root of the estimated covariance matrix.
If the p-value is small (in general smaller than 0.05)
it means that the hypothesis that each row of the  residuals &quot;whitened&quot; matrix is a white noise, is rejected.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(copals_camera)
Y &lt;- scale(Y[, 1:100])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
whitening_choice(residuals, c("AR1", "nonparam", "ARMA", "no_whitening"),
  pAR = 1, qMA = 1 )
</code></pre>

<hr>
<h2 id='whitening_test'>This function provides the p-value of an adaptation of the Portmanteau statistic to test if there is some dependence in the rows of the residuals matrix given as an argument of the function.</h2><span id='topic+whitening_test'></span>

<h3>Description</h3>

<p>This function provides the p-value of an adaptation of the Portmanteau statistic to test if there is some dependence in the rows of the residuals matrix given as an argument of the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whitening_test(residuals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="whitening_test_+3A_residuals">residuals</code></td>
<td>
<p>the residuals matrix obtained by fitting a linear model to each column of the response matrix as if they were independent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the p-value of a whitening test. If the p-value is small (generally smaller than 0.05)
it means that the hypothesis that each row of the  residuals matrix is a white noise, is rejected.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(copals_camera)
Y &lt;- scale(Y[, 1:100])
X &lt;- model.matrix(~ group + 0)
residuals &lt;- lm(as.matrix(Y) ~ X - 1)$residuals
whitening_test(residuals)
</code></pre>

<hr>
<h2 id='Y'>This is a metabolomic dataset from 30 copals samples of trees coming from Africa</h2><span id='topic+Y'></span>

<h3>Description</h3>

<p>This is a metabolomic dataset from 30 copals samples of trees coming from Africa
</p>


<h3>Author(s)</h3>

<p>Marie Perrot-Dockes <a href="mailto:marie.perrot-dockes@agroparistech.fr">marie.perrot-dockes@agroparistech.fr</a>
</p>


<h3>References</h3>

<p><a href="https://arxiv.org/pdf/1704.00076.pdf">https://arxiv.org/pdf/1704.00076.pdf</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
