<!DOCTYPE html><html><head><title>Help for package EMSNM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EMSNM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EMSNM-package'>
<p>EM Algorithm for Sigmoid Normal Model</p></a></li>
<li><a href='#Ccompute'>
<p>Ccompute</p></a></li>
<li><a href='#EM_parameter_sd'>
<p>Bootstrap Parameter Inference</p></a></li>
<li><a href='#EM_result_sort'>
<p>Sort Parameter</p></a></li>
<li><a href='#EMalgorithm'>
<p>Parameter Estimation</p></a></li>
<li><a href='#EMbootstrap'>
<p>Bootstrap Method</p></a></li>
<li><a href='#EMsimulation'>
<p>Simulation For Estimation</p></a></li>
<li><a href='#fnorm'>
<p>Density Value</p></a></li>
<li><a href='#Ggenerate'>
<p>Subgroup Determination</p></a></li>
<li><a href='#softmax'>
<p>Softmax Value</p></a></li>
<li><a href='#standard'>
<p>Data Standardlization</p></a></li>
<li><a href='#update_eta'>
<p>Updata Eta</p></a></li>
<li><a href='#update_gamma'>
<p>Updata Alpha and Sigma</p></a></li>
<li><a href='#weight_matrix'>
<p>Weighted Inner Product</p></a></li>
<li><a href='#Wgenerate'>
<p>Sigmoid Logistic Data Generation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>EM Algorithm for Sigmoid Normal Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It provides a method based on EM algorithm to estimate the parameter of a mixture model, Sigmoid-Normal Model, where the samples come from several normal distributions (also call them subgroups) whose mean is determined by co-variable Z and coefficient alpha while the variance are homogeneous. Meanwhile, the subgroup each item belongs to is determined by co-variables X and coefficient eta through Sigmoid link function which is the extension of Logistic Link function. It uses bootstrap to estimate the standard error of parameters. When sample is indeed separable, removing estimation with abnormal sigma, the estimation of alpha is quite well. I used this method to explore the subgroup structure of HIV patients and it can be used in other domains where exists subgroup structure.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-24 16:49:30 UTC; huihui</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-25 09:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='EMSNM-package'>
EM Algorithm for Sigmoid Normal Model
</h2><span id='topic+EMSNM-package'></span><span id='topic+EMSNM'></span>

<h3>Description</h3>

<p>It provides a method based on EM algorithm to estimate the parameter of a mixture model, Sigmoid-Normal Model, where the samples come from several normal distributions (also call them subgroups) whose mean is determined by co-variable Z and coefficient alpha while the variance are homogeneous. Meanwhile, the subgroup each item belongs to is determined by co-variables X and coefficient eta through Sigmoid link function which is the extension of Logistic Link function. It uses bootstrap to estimate the standard error of parameters. When sample is indeed separable, removing estimation with abnormal sigma, the estimation of alpha is quite well. I used this method to explore the subgroup structure of HIV patients and it can be used in other domains where exists subgroup structure.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EMSNM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> EM Algorithm for Sigmoid Normal Model</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-04-19</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Linsui Deng &lt;denglinsui@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> It provides a method based on EM algorithm to estimate the parameter of a mixture model, Sigmoid-Normal Model, where the samples come from several normal distributions (also call them subgroups) whose mean is determined by co-variable Z and coefficient alpha while the variance are homogeneous. Meanwhile, the subgroup each item belongs to is determined by co-variables X and coefficient eta through Sigmoid link function which is the extension of Logistic Link function. It uses bootstrap to estimate the standard error of parameters. When sample is indeed separable, removing estimation with abnormal sigma, the estimation of alpha is quite well. I used this method to explore the subgroup structure of HIV patients and it can be used in other domains where exists subgroup structure.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
Ccompute                Ccompute
EMSNM-package           EM Algorithm for Sigmoid Normal Model
EM_parameter_sd         Bootstrap Parameter Inference
EM_result_sort          Sort Parameter
EMalgorithm             Parameter Estimation
EMbootstrap             Bootstrap Method
EMsimulation            Simulation For Estimation
Ggenerate               Subgroup Determination
Wgenerate               Sigmoid Logistic Data Generation
fnorm                   Density Value
softmax                 Softmax Value
standard                Data Standardlization
update_eta              Updata Eta
update_gamma            Updata Alpha and Sigma
weight_matrix           Weighted Inner Product
</pre>
<p>The EMalgorithm is used to estimate the parameters, EMbootstrap is used to estimate the parameters with bootstrap method. In EMsimulation we can simulate the situation with given parameters, so parameter estimation can be verified.
</p>


<h3>Author(s)</h3>

<p>Linsui Deng &lt;denglinsui@gmail.com&gt;
</p>
<p>Maintainer: Linsui Deng &lt;denglinsui@gmail.com&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 100
expriments &lt;- 30
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

#test of EMsimulation
EMsimulation_result &lt;- EMsimulation(eta=etatest,alpha=alphatest,sigma=sigmatest,
                            samplesize=samplesize,expriments=expriments,
                            compact_flag=TRUE,C0=5,C1=0.5,C2=5)
index &lt;- which(EMsimulation_result$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMsimulation_result$alpha[index,,],
                                            EMsimulation_result$eta[index,,])
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                EMsimulation_result$sigma[index])

#test of EMbootstrap
samplesize &lt;- 1000
X &lt;- matrix(c(matrix(1,samplesize),
                  rnorm(samplesize*(etasize-1))+1),samplesize,etasize)
Z &lt;- matrix(c(matrix(1,samplesize),rbinom(prob=1/2,size=1,n=samplesize),
                 rnorm(samplesize*(alphasize-2))+1),samplesize,alphasize)
                 
Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,sigma=sigmatest,X=X,Z=Z)

boots_samplesize &lt;- 100
boots_expriments &lt;- 30
samplesize &lt;- dim(Wtest$X)[1]
EMbootstrap_theta &lt;- EMbootstrap(Wtest$X,Wtest$Y,Wtest$Z,samplesize,
                                 boots_samplesize,boots_expriments,
                                 classsize=2,compact_flag=TRUE,C0=5,C1=0.2,C2=5)
index &lt;- which(EMbootstrap_theta$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMbootstrap_theta$alpha[index,,],
                                             EMbootstrap_theta$eta[index,,])
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                 EMbootstrap_theta$sigma[index])                          
</code></pre>

<hr>
<h2 id='Ccompute'>
Ccompute
</h2><span id='topic+Ccompute'></span>

<h3>Description</h3>

<p>Compute the probability of Y in given parameters alphat, sigmat, etat and variables X, Z by the Bayesian Formula under the assumption of Sigmoid-Normal Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ccompute(alphat, sigmat, etat, X, Z, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ccompute_+3A_alphat">alphat</code></td>
<td>

<p>the coeffients of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="Ccompute_+3A_sigmat">sigmat</code></td>
<td>

<p>the variance of Y
</p>
</td></tr>
<tr><td><code id="Ccompute_+3A_etat">etat</code></td>
<td>

<p>the coeffients determining subgroup 
</p>
</td></tr>
<tr><td><code id="Ccompute_+3A_x">X</code></td>
<td>

<p>the covariables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="Ccompute_+3A_z">Z</code></td>
<td>

<p>the covaraibles determining subgroup
</p>
</td></tr>
<tr><td><code id="Ccompute_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the probability of Y in given parameters alphat, sigmat, etat and variables X, Z under the assumption of Sigmoid-Normal Model.
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
Ztest &lt;- matrix(rnorm(samplesize*alphasize),samplesize,alphasize)

etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)
alphatest &lt;- matrix(seq(1.15,1,length=alphasize*classsize),alphasize,classsize)

Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,X=Xtest,Z=Ztest)

#test of Ccompute
sigmatest &lt;- 1
Ctest &lt;- 
  Ccompute(alphat=alphatest,sigmat=sigmatest,
           etat=etatest,X=Wtest$X,Z=Wtest$Z,Y=Wtest$Y)
</code></pre>

<hr>
<h2 id='EM_parameter_sd'>
Bootstrap Parameter Inference
</h2><span id='topic+EM_parameter_sd'></span>

<h3>Description</h3>

<p>Estimating the parameters and their stand error through the sorted parameters estimated by bootstrap method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_parameter_sd(EMsimulation_sort_alpha, EMsimulation_sort_eta, EMsimulation_sort_sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_parameter_sd_+3A_emsimulation_sort_alpha">EMsimulation_sort_alpha</code></td>
<td>

<p>sorted alpha estimated by bootstrap method.
</p>
</td></tr>
<tr><td><code id="EM_parameter_sd_+3A_emsimulation_sort_eta">EMsimulation_sort_eta</code></td>
<td>

<p>sorted eta estimated by bootstrap method.
</p>
</td></tr>
<tr><td><code id="EM_parameter_sd_+3A_emsimulation_sort_sigma">EMsimulation_sort_sigma</code></td>
<td>

<p>sorted sigma estimated by bootstrap method.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>sigma</code></td>
<td>
<p>the estimation of sigma</p>
</td></tr>
<tr><td><code>sigma_sd</code></td>
<td>
<p>the estimation of standard error of sigma</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the estimation of alpha</p>
</td></tr>
<tr><td><code>alpha_sd</code></td>
<td>
<p>the estimation of standard error of alpha</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>the estimation of eta</p>
</td></tr>
<tr><td><code>eta_sd</code></td>
<td>
<p>the estimation of standard error of eta</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 100
expriments &lt;- 30
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

EMsimulation_result &lt;- EMsimulation(eta=etatest,alpha=alphatest,sigma=sigmatest,
                            samplesize=samplesize,expriments=expriments,
                            compact_flag=TRUE,C0=5,C1=0.5,C2=5)
index &lt;- which(EMsimulation_result$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMsimulation_result$alpha[index,,],
                                            EMsimulation_result$eta[index,,])
#test of EM_parameter_sd
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                EMsimulation_result$sigma[index])
</code></pre>

<hr>
<h2 id='EM_result_sort'>
Sort Parameter
</h2><span id='topic+EM_result_sort'></span>

<h3>Description</h3>

<p>Since the number of subgroup types is always beyond 1, the order of subgroup may be different, we can sort them in this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_result_sort(EMsimulation_result_alpha, EMsimulation_result_eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_result_sort_+3A_emsimulation_result_alpha">EMsimulation_result_alpha</code></td>
<td>

<p>alpha estimated by bootstrap method.
</p>
</td></tr>
<tr><td><code id="EM_result_sort_+3A_emsimulation_result_eta">EMsimulation_result_eta</code></td>
<td>

<p>eta estimated by bootstrap method.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>sorted alpha estimated by bootstrap method.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>sorted eta estimated by bootstrap method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 100
expriments &lt;- 30
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

#test of EMsimulation
EMsimulation_result &lt;- EMsimulation(eta=etatest,alpha=alphatest,sigma=sigmatest,
                            samplesize=samplesize,expriments=expriments,
                            compact_flag=TRUE,C0=5,C1=0.5,C2=5)
                            
#test of EM_result_sort
EMsimulation_result_sort &lt;- EM_result_sort(EMsimulation_result$alpha,
                                            EMsimulation_result$eta)
</code></pre>

<hr>
<h2 id='EMalgorithm'>
Parameter Estimation
</h2><span id='topic+EMalgorithm'></span>

<h3>Description</h3>

<p>Estimate paramters value by EM algorithm under the assumption of Sigmoid-Normal Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMalgorithm(X, Y, Z, etat, alphat, sigmat, classsize = 2, learning_rate = 0.1, 
            regular_parameter_eta = 0.001, max_iteration = 10000,
            max_iteration_eta = 10000, compact_flag = FALSE, C0 = 5, C1 = 2, C2 = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMalgorithm_+3A_x">X</code></td>
<td>

<p>the covariables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_z">Z</code></td>
<td>

<p>the covaraibles determining subgroup
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_etat">etat</code></td>
<td>

<p>the coeffients determining subgroup 
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_alphat">alphat</code></td>
<td>

<p>the coeffients of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_sigmat">sigmat</code></td>
<td>

<p>the variance of Y
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_classsize">classsize</code></td>
<td>

<p>the number of subgroup types in your model assumption
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_learning_rate">learning_rate</code></td>
<td>

<p>learning rate of updating eta
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_regular_parameter_eta">regular_parameter_eta</code></td>
<td>

<p>regular value of updating eta by gradiant descending methond.
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_max_iteration">max_iteration</code></td>
<td>

<p>maximum steps of interation to avoid unlimited looping. 
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_max_iteration_eta">max_iteration_eta</code></td>
<td>

<p>maximal steps of eta interation to avoid unlimited looping. 
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_compact_flag">compact_flag</code></td>
<td>

<p>if the value of eta is limited in a compact set, set it TRUE
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_c0">C0</code></td>
<td>

<p>the maximum of intercept of eta.
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_c1">C1</code></td>
<td>

<p>the minimum of the norm of slope of eta
</p>
</td></tr>
<tr><td><code id="EMalgorithm_+3A_c2">C2</code></td>
<td>

<p>the maximum of the norm of slope of eta
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>alpha estimation</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>eta estimation</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>sigma estimation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data generation
samplesize &lt;- 1000
classsize &lt;- 2
etasize &lt;- 3
alphasize &lt;- 3

set.seed(1)
Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
etatest &lt;- matrix(c(1,2,-1,
                    0,0,0),etasize,classsize)

Ztest &lt;- matrix(rnorm(samplesize*alphasize),samplesize,alphasize)
alphatest &lt;- matrix(c(1,0,2,
                      5,0,7),alphasize,classsize)
sigmatest &lt;- 5

Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,X=Xtest,Z=Ztest,sigma=sigmatest)

eta_initial &lt;- matrix(c(rnorm(3),0,0,0),etasize,classsize)
alpha_initial&lt;- matrix(rnorm(alphasize*classsize)*3,alphasize,classsize)
sigma_initial &lt;- 1

EMtheta &lt;- EMalgorithm(X=Wtest$X,Z=Wtest$Z,Y=Wtest$Y,classsize=2,
                       etat=eta_initial,alphat=alpha_initial,sigmat=sigma_initial,
                       learning_rate=0.01,regular_parameter_eta=0.001,
                       max_iteration=1000,max_iteration_eta=10000, 
                       compact_flag = TRUE, C0 = 5, C1 = 2, C2 = 9)
</code></pre>

<hr>
<h2 id='EMbootstrap'>
Bootstrap Method
</h2><span id='topic+EMbootstrap'></span>

<h3>Description</h3>

<p>Estimate the value of parameters several times by bootstrap method where the parameters are estimated by EM algorithm. In this way, we can observe the distribution of parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMbootstrap(X, Y, Z, samplesize, boots_samplesize, boots_expriments, classsize = 2,
            learning_rate = 0.1, regular_parameter_eta = 0.001, max_iteration = 10000, 
            max_iteration_eta = 10000, compact_flag = FALSE, C0 = 5, C1 = 2, C2 = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMbootstrap_+3A_x">X</code></td>
<td>

<p>the co-variables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_z">Z</code></td>
<td>

<p>the co-variables determining subgroup
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_samplesize">samplesize</code></td>
<td>

<p>the size of this sample.
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_boots_samplesize">boots_samplesize</code></td>
<td>

<p>the size of chosen sample in one step of bootstrap
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_boots_expriments">boots_expriments</code></td>
<td>

<p>the steps of bootstrap
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_classsize">classsize</code></td>
<td>

<p>the number of subgroup types in your model assumption
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_learning_rate">learning_rate</code></td>
<td>

<p>learning rate of updating eta
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_regular_parameter_eta">regular_parameter_eta</code></td>
<td>

<p>regular value of updating eta by gradient descending method.
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_max_iteration">max_iteration</code></td>
<td>

<p>maximum steps of iteration to avoid unlimited looping. 
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_max_iteration_eta">max_iteration_eta</code></td>
<td>

<p>maximal steps of eta iteration to avoid unlimited looping. 
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_compact_flag">compact_flag</code></td>
<td>

<p>if the value of eta is limited in a compact set, set it TRUE
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_c0">C0</code></td>
<td>

<p>the maximum of intercept of eta.
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_c1">C1</code></td>
<td>

<p>the minimum of the norm of slope of eta
</p>
</td></tr>
<tr><td><code id="EMbootstrap_+3A_c2">C2</code></td>
<td>

<p>the maximum of the norm of slope of eta
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Actually, the method can be extended to other parameter estimation where the standard error of parameter can't be calculated in a simple way.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>alpha estimated by bootstrap method.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>eta estimated by bootstrap method.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>sigma estimated by bootstrap method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 1000
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

#test of EMbootstrap
X &lt;- matrix(c(matrix(1,samplesize),
                  rnorm(samplesize*(etasize-1))+1),samplesize,etasize)
Z &lt;- matrix(c(matrix(1,samplesize),rbinom(prob=1/2,size=1,n=samplesize),
                 rnorm(samplesize*(alphasize-2))+1),samplesize,alphasize)
                 
Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,sigma=sigmatest,X=X,Z=Z)

boots_samplesize &lt;- 100
boots_expriments &lt;- 30
samplesize &lt;- dim(Wtest$X)[1]
EMbootstrap_theta &lt;- EMbootstrap(Wtest$X,Wtest$Y,Wtest$Z,samplesize,
                                 boots_samplesize,boots_expriments,
                                 classsize=2,compact_flag=TRUE,C0=5,C1=0.2,C2=5)
index &lt;- which(EMbootstrap_theta$sigma&lt;0.8)
EMsimulation_result_sort &lt;- EM_result_sort(EMbootstrap_theta$alpha[index,,],
                                             EMbootstrap_theta$eta[index,,])
EM_parameter &lt;- EM_parameter_sd(EMsimulation_result_sort$alpha,
                                EMsimulation_result_sort$eta,
                                 EMbootstrap_theta$sigma[index]) 
</code></pre>

<hr>
<h2 id='EMsimulation'>
Simulation For Estimation
</h2><span id='topic+EMsimulation'></span>

<h3>Description</h3>

<p>It simulates the experiments with given alpha, eta and sigma to verify the EMalgorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMsimulation(eta, alpha, sigma, samplesize, expriments, 
             compact_flag = FALSE, C0 = 5, C1 = 2, C2 = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMsimulation_+3A_eta">eta</code></td>
<td>

<p>the true value of eta
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_alpha">alpha</code></td>
<td>

<p>the true value of alpha
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_sigma">sigma</code></td>
<td>

<p>the true value of sigma
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_samplesize">samplesize</code></td>
<td>

<p>the size of sample
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_expriments">expriments</code></td>
<td>

<p>the times of experiments
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_compact_flag">compact_flag</code></td>
<td>

<p>if the value of eta is limited in a compact set, set it TRUE
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_c0">C0</code></td>
<td>

<p>the maximum of intercept of eta.
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_c1">C1</code></td>
<td>

<p>the minimum of the norm of slope of eta
</p>
</td></tr>
<tr><td><code id="EMsimulation_+3A_c2">C2</code></td>
<td>

<p>the maximum of the norm of slope of eta
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>alpha estimated in simulation.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>eta estimated in simulation.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>sigma estimated in simulation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#parameter initialization
etasize &lt;- 2
classsize &lt;- 2
alphasize &lt;- 3
samplesize &lt;- 100
expriments &lt;- 30
  
etatest &lt;- matrix(c(1,1,
                    0,0),etasize,classsize)

alphatest &lt;- matrix(c(1,0,2,
                      4,3,5),alphasize,classsize)
sigmatest &lt;- 0.5

#test of EMsimulation
EMsimulation_result &lt;- EMsimulation(eta=etatest,alpha=alphatest,sigma=sigmatest,
                            samplesize=samplesize,expriments=expriments,
                            compact_flag=TRUE,C0=5,C1=0.5,C2=5)
</code></pre>

<hr>
<h2 id='fnorm'>
Density Value
</h2><span id='topic+fnorm'></span>

<h3>Description</h3>

<p>Calculate the density value of respond value Y under each mean and homogeneous variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fnorm(Y, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fnorm_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
<tr><td><code id="fnorm_+3A_mu">mu</code></td>
<td>

<p>different mean of each subgroup
</p>
</td></tr>
<tr><td><code id="fnorm_+3A_sigma">sigma</code></td>
<td>

<p>standard error
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density value of Y under different mu and common sigma.
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fnormtest &lt;- fnorm(matrix(1:6,3,2),matrix(seq(1,3,length=6),3,2),1)
</code></pre>

<hr>
<h2 id='Ggenerate'>
Subgroup Determination
</h2><span id='topic+Ggenerate'></span>

<h3>Description</h3>

<p>In data genaration, determining the subgroup of each item belonging to through random number and Sigmoid Link function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ggenerate(eta, X, seed = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ggenerate_+3A_eta">eta</code></td>
<td>

<p>the coeffients determining subgroup 
</p>
</td></tr>
<tr><td><code id="Ggenerate_+3A_x">X</code></td>
<td>

<p>the covariables determining subgroup 
</p>
</td></tr>
<tr><td><code id="Ggenerate_+3A_seed">seed</code></td>
<td>

<p>random seed
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the classes items belonging to, it's a vector. If X1 belongs to class 3, then the 1st row 3rd colmn is 1 and the rest of 1st row are 0. 
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

#test of Ggenerate
Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)

Gtest1 &lt;- Ggenerate(etatest,Xtest)
Gtest2 &lt;- Ggenerate(etatest,Xtest,1)
</code></pre>

<hr>
<h2 id='softmax'>
Softmax Value
</h2><span id='topic+softmax'></span>

<h3>Description</h3>

<p>Calculate the Softmax Value of each subgroup to represent the probability of items belonging to specific class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(eta, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="softmax_+3A_eta">eta</code></td>
<td>

<p>the coeffients determining subgroup 
</p>
</td></tr>
<tr><td><code id="softmax_+3A_x">X</code></td>
<td>

<p>the covariables determining subgroup 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Softmax Value of each subgroup
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

#test of softmax
Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)
softmax_value &lt;- softmax(etatest,Xtest)
</code></pre>

<hr>
<h2 id='standard'>
Data Standardlization
</h2><span id='topic+standard'></span>

<h3>Description</h3>

<p>Standardlize the data to elimilate the effect of scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standard(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standard_+3A_x">X</code></td>
<td>

<p>the original data
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>standarlized data
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data generata

Y &lt;- rnorm(100)*2+5

Y_sta &lt;- standard(Y)
</code></pre>

<hr>
<h2 id='update_eta'>
Updata Eta
</h2><span id='topic+update_eta'></span>

<h3>Description</h3>

<p>Updata eta in step t+1 with given data and coeffients estimated in step t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_eta(fun, alphat, sigmat, etat, X, Y, Z, learning_rate_eta = 0.001, 
           regular_parameter_eta = 0.001, max_iteration_eta = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_eta_+3A_fun">fun</code></td>
<td>

<p>the function updata eta
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_alphat">alphat</code></td>
<td>

<p>the estimated coeffients of the mean of each subgroup in step t
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_sigmat">sigmat</code></td>
<td>

<p>the estimated standard error of Y in step t
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_etat">etat</code></td>
<td>

<p>the estimated coeffients determining subgroup in step t
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_x">X</code></td>
<td>

<p>the covariables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_z">Z</code></td>
<td>

<p>the covaraibles determining subgroup
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_learning_rate_eta">learning_rate_eta</code></td>
<td>

<p>learning rate of updating eta
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_regular_parameter_eta">regular_parameter_eta</code></td>
<td>

<p>regular value of updating eta by gradiant descending methond.
</p>
</td></tr>
<tr><td><code id="update_eta_+3A_max_iteration_eta">max_iteration_eta</code></td>
<td>

<p>maximal steps of eta interation to avoid unlimited looping.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>alpha estimated in step t.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>eta estimated in step t+1.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>sigma estimated in step t.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
Ztest &lt;- matrix(rnorm(samplesize*alphasize),samplesize,alphasize)

etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)
alphatest &lt;- matrix(seq(1.15,1,length=alphasize*classsize),alphasize,classsize)
sigmatest &lt;- 0.1

Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,X=Xtest,Z=Ztest)

#test of update_eta
thetaupdate_eta &lt;- update_eta(fun=eta_gradient_fun,alphat=alphatest,sigmat=sigmatest,
           etat=etatest,X=Wtest$X,Z=Wtest$Z,Y=Wtest$Y,
           learning_rate=0.1,regular_parameter=0.001,max_iteration=10000)
</code></pre>

<hr>
<h2 id='update_gamma'>
Updata Alpha and Sigma
</h2><span id='topic+update_gamma'></span>

<h3>Description</h3>

<p>Updata alpha and sigma in t+1 step with given data and coeffients estimated in step t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_gamma(alphat, sigmat, etat, X, Z, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_gamma_+3A_alphat">alphat</code></td>
<td>

<p>the estimated coeffients of the mean of each subgroup in step t
</p>
</td></tr>
<tr><td><code id="update_gamma_+3A_sigmat">sigmat</code></td>
<td>

<p>the estimated standard error of Y in step t
</p>
</td></tr>
<tr><td><code id="update_gamma_+3A_etat">etat</code></td>
<td>

<p>the estimated coeffients determining subgroup in step t
</p>
</td></tr>
<tr><td><code id="update_gamma_+3A_x">X</code></td>
<td>

<p>the covariables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="update_gamma_+3A_z">Z</code></td>
<td>

<p>the covaraibles determining subgroup
</p>
</td></tr>
<tr><td><code id="update_gamma_+3A_y">Y</code></td>
<td>

<p>the respond variable
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>alpha estimated in step t+1.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>eta estimated in step t.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>sigma estimated in step t+1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
Ztest &lt;- matrix(rnorm(samplesize*alphasize),samplesize,alphasize)

etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)
alphatest &lt;- matrix(seq(1.15,1,length=alphasize*classsize),alphasize,classsize)
sigmatest &lt;- 0.1

Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,X=Xtest,Z=Ztest)

#test of updata_gamma
thetaupdate_gamma &lt;- update_gamma(alphat=alphatest,sigmat=sigmatest,
                            etat=etatest,X=Wtest$X,Z=Wtest$Z,Y=Wtest$Y)
</code></pre>

<hr>
<h2 id='weight_matrix'>
Weighted Inner Product
</h2><span id='topic+weight_matrix'></span>

<h3>Description</h3>

<p>Calculate the weighted inner product of A and B with the weight W. This result is useful in Logistic Regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weight_matrix(A, W, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weight_matrix_+3A_a">A</code></td>
<td>

<p>the left matrix
</p>
</td></tr>
<tr><td><code id="weight_matrix_+3A_w">W</code></td>
<td>

<p>the weight 
</p>
</td></tr>
<tr><td><code id="weight_matrix_+3A_b">B</code></td>
<td>

<p>the right matrix
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the wighted inner product, noticing it can be vector when A or B is 2 dimension. 
</p>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data generation
A &lt;- matrix(rnorm(200),100,2)
W &lt;- rnorm(100)
B &lt;- matrix(rnorm(100),100,1)
weighted &lt;- weight_matrix(A,W,B)
</code></pre>

<hr>
<h2 id='Wgenerate'>
Sigmoid Logistic Data Generation
</h2><span id='topic+Wgenerate'></span>

<h3>Description</h3>

<p>Generate data satisties Sigmoid Logistic Model to check EMalgorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wgenerate(alpha, sigma = 1, eta, samplesize = 0, X, Z, seed1 = 0, seed2 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wgenerate_+3A_alpha">alpha</code></td>
<td>

<p>the coeffients of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_sigma">sigma</code></td>
<td>

<p>the variance of Y
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_eta">eta</code></td>
<td>

<p>the coeffients determining subgroup 
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_samplesize">samplesize</code></td>
<td>

<p>the size of sample you wanna generate
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_x">X</code></td>
<td>

<p>the covariables of the mean of each subgroup
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_z">Z</code></td>
<td>

<p>the covaraibles determining subgroup
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_seed1">seed1</code></td>
<td>

<p>random seed of generating Y
</p>
</td></tr>
<tr><td><code id="Wgenerate_+3A_seed2">seed2</code></td>
<td>

<p>random seed of generating G
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>X</code></td>
<td>
<p>the covariables of the mean of each subgroup</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>the covaraibles determining subgroup</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>the generated respond variable</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>the classes items belonging to</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Linsui Deng
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#some variables
samplesize &lt;- 1000
classsize &lt;- 6
etasize &lt;- 3
alphasize &lt;- 2

#test of Wgenerate
Xtest &lt;- data.frame(matrix(rnorm(samplesize*etasize),samplesize,etasize))
Ztest &lt;- matrix(rnorm(samplesize*alphasize),samplesize,alphasize)

etatest &lt;- matrix(seq(1.15,1,length=etasize*classsize),etasize,classsize)
alphatest &lt;- matrix(seq(1.15,1,length=alphasize*classsize),alphasize,classsize)

Wtest &lt;- Wgenerate(alpha=alphatest,eta=etatest,X=Xtest,Z=Ztest)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
