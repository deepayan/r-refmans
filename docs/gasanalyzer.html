<!DOCTYPE html><html><head><title>Help for package gasanalyzer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gasanalyzer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_equations'><p>Create a list of equations for recalculating gasanalyzer data.</p></a></li>
<li><a href='#export_ess_dive'><p>Export a subset of the data into the ESS-DIVE reporting format for leaf-level</p>
gas exchange data.</a></li>
<li><a href='#get_factory_cals'><p>Returns a matrix with factory calibration information for given instrument</p>
serial numbers and calibration dates.</a></li>
<li><a href='#import_factory_cals'><p>Import instrument-specific factory calibration files from a folder.</p></a></li>
<li><a href='#modify_equations'><p>Modify an existing list of equations with specific user-specified equations.</p></a></li>
<li><a href='#permutate'><p>Expand a data frame with all possible combinations of the values in a column.</p></a></li>
<li><a href='#read_6400_txt'><p>Reads 6400XT text files and creates a tibble with gas-exchange data.</p></a></li>
<li><a href='#read_6800_equations'><p>Read gas-exchange equations directly from 6800 xlsx files.</p></a></li>
<li><a href='#read_6800_txt'><p>Reads 6800 text files and creates a tibble with gas-exchange data.</p></a></li>
<li><a href='#read_6800_xlsx'><p>Reads 6800 xlsx files and creates a tibble with gas-exchange data.</p></a></li>
<li><a href='#read_gasexchange'><p>Read gas-exchange data from a text file.</p></a></li>
<li><a href='#read_gfs'><p>Reads GFS-3000 text files and creates a tibble with gas-exchange data</p></a></li>
<li><a href='#recalculate'><p>Recalculate gas-exchange data based on a set of equations.</p></a></li>
<li><a href='#var2label'><p>Render gasanalyzer variables or values using mathematical notation.</p></a></li>
<li><a href='#write_gasexchange'><p>Write a gas-exchange tibble to a text file.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Import, Recompute and Analyze Data from Portable Gas Analyzers</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to import data from several instruments
    commonly used by plant physiologists to measure characteristics
    related to photosynthesis. It provides a standardized list of variable
    names, and several sets of equations to calculate additional variables
    based on the measurements.  These equations have been described by von
    Caemmerer and Farquhar (1981) &lt;<a href="https://doi.org/10.1007%2FBF00384257">doi:10.1007/BF00384257</a>&gt;, Busch et al.
    (2020) &lt;<a href="https://doi.org/10.1038%2Fs41477-020-0606-6">doi:10.1038/s41477-020-0606-6</a>&gt; and MÃ¡rquez et al. (2021)
    &lt;<a href="https://doi.org/10.1038%2Fs41477-021-00861-w">doi:10.1038/s41477-021-00861-w</a>&gt;. In addition, this package
    facilitates performing sensitivity analyses on variables or
    assumptions used in the calculations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/plantphys/gasanalyzer">https://gitlab.com/plantphys/gasanalyzer</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>jsonify, methods, stats, stringi, tibble, tidyxl (&ge; 1.0.8),
tools, units, utils, vctrs, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, graphics, ggplot2, gridExtra,
photosynthesis</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-09 16:19:18 UTC; danny</td>
</tr>
<tr>
<td>Author:</td>
<td>Danny Tholen <a href="https://orcid.org/0000-0002-9517-0939"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Danny Tholen &lt;thalecress+p@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 19:13:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_equations'>Create a list of equations for recalculating gasanalyzer data.</h2><span id='topic+create_equations'></span>

<h3>Description</h3>

<p>This function creates a list of equations that can be used to recalculate
gas-exchange data by passing the resulting object to the <code><a href="#topic+recalculate">recalculate()</a></code>
method. Various <code>useflags</code> can be defined to tune the equations.
In addition, custom equations can be defined as arguments. Note that
the calculations may fail if commons are missing in the gas-exchange data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_equations(useflags = "default", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_equations_+3A_useflags">useflags</code></td>
<td>
<p>character vector with the type of equations to create
(such as c(&quot;li6800&quot;, &quot;gfs3000&quot;)). Leave empty to obtain the default set.
An unknown flag returns an empty list, and a warning listing all valid
flags.</p>
</td></tr>
<tr><td><code id="create_equations_+3A_...">...</code></td>
<td>
<p>custom equations. the arguments must tagged function expressions.
Note that the function body must be wrapped in curly brackets. The tags
will be matched against the names of a data frame when applying the return
value with <code><a href="#topic+recalculate">recalculate()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of language objects with equations
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_6800_equations">read_6800_equations()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")

# import factory calibration for example data:
import_factory_cals(exampledir)

# read data from a txt file:
li6800 &lt;- read_6800_txt(paste0(exampledir, "//lowo2"))

# passing an invalid flags shows which flags are valid:
create_equations("help")

# create a default set of gas-exchange equations, for the 6800, but overwrite
# the default calculation of leaf light absorption with a custom value:
Eqs &lt;- create_equations(c("default", "li6800"), LeafQ.alpha = \() {0.86})

#apply:
li6800_recalc &lt;- recalculate(li6800, Eqs)

li6800$LeafQ.alpha
li6800_recalc$LeafQ.alpha
</code></pre>

<hr>
<h2 id='export_ess_dive'>Export a subset of the data into the ESS-DIVE reporting format for leaf-level
gas exchange data.</h2><span id='topic+export_ess_dive'></span>

<h3>Description</h3>

<p>Ely et al. (2021) proposed a standardized nomenclature for reporting
gas-exchange data and metadata within the framework of the Environmental
System Science Data Infrastructure for a Virtual Ecosystem (ESS-DIVE)
repository. This method converts data frames or tibbles created with
<code>gasanalyzer</code> to this standardized format. Note that the scope of the
proposed standard is limited, and therefore only a subset of the data
is exported. Users should add relevant additional columns and provide
relevant metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_ess_dive(df, filename = "", extra_cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_ess_dive_+3A_df">df</code></td>
<td>
<p>a tibble with gas-exchange data.</p>
</td></tr>
<tr><td><code id="export_ess_dive_+3A_filename">filename</code></td>
<td>
<p>path to the output file. If none provided the method returns
the data as a tibble.</p>
</td></tr>
<tr><td><code id="export_ess_dive_+3A_extra_cols">extra_cols</code></td>
<td>
<p>a character vector specifying additional columns (not
specified in the standard specified by Ely et al. 2021) to include in the
returned data or saved files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a filename is given as argument, the data is written into a comma
separated, UTF-8 encoded file without BOM and with CRLF line headings. In
addition, a data dictionary file (&quot;_dd&quot; is inserted at the end of the
filename, before the file extension). If no filename is provided, the
converted data is returned.
</p>


<h3>Value</h3>

<p>Nothing if a filename is provided. Otherwise, a tibble with
variables and headings specified by the ESS-DIVE gas-exchange standard
is returned.
</p>


<h3>References</h3>

<p>Ely KS, Rogers A, Agarwal DA, et al (2021) <em>A reporting format
for leaf-level gas exchange data and metadata.</em> Ecol Inform 61:101232.
https://doi.org/10.1016/j.ecoinf.2021.101232
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example &lt;- system.file("extdata//d13C.tsv", package = "gasanalyzer")

# read data and recalculate using default gas-exchange equations:
df &lt;- read_gasexchange(example) |&gt;
  recalculate(create_equations("default"))

# view df in ess_dive format:
export_ess_dive(df)


# save the data and a data dictionary:
export_ess_dive(df, "ess_dive_test.csv")
# read and show the dictionary:
readLines("ess_dive_test_dd.csv")

</code></pre>

<hr>
<h2 id='get_factory_cals'>Returns a matrix with factory calibration information for given instrument
serial numbers and calibration dates.</h2><span id='topic+get_factory_cals'></span>

<h3>Description</h3>

<p>The factory calibration of the 6800 can be used to calculate
concentrations from raw values. If calibration information is available in
the package environment it can be retrieved by this method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_factory_cals(sn = NULL, datetime = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_factory_cals_+3A_sn">sn</code></td>
<td>
<p>a character vector with an instrument serial number. If named, the
names are kept in the output.</p>
</td></tr>
<tr><td><code id="get_factory_cals_+3A_datetime">datetime</code></td>
<td>
<p>a POSIXct time vector indicating the latest possible time for
the calibration data that is to be returned. If no calibration before
datetime is found, the oldest available calibration is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The datetime option can be used to make sure that newer calibration
files are not used in combination with older datafiles.
</p>


<h3>Value</h3>

<p>A character matrix with factory calibration data. If no datetime is
provided, the newest calibration is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata//", package = "gasanalyzer")

# import factory cals for example data:
import_factory_cals(exampledir)

# show calibration data for a specific instrument serial numbers, closest to
# the current time:
get_factory_cals(sn = "68H-422400", datetime=Sys.time())
</code></pre>

<hr>
<h2 id='import_factory_cals'>Import instrument-specific factory calibration files from a folder.</h2><span id='topic+import_factory_cals'></span>

<h3>Description</h3>

<p>The factory calibration of the 6800 can be used to calculate
concentrations from raw values. The calibration files are found
in subfolders of /home/licor/.factory on the instrument. They can be copied
to a computer and imported to the package configuration files using this
method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_factory_cals(
  folder = tools::R_user_dir("gasanalyzer", which = "config"),
  keep = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import_factory_cals_+3A_folder">folder</code></td>
<td>
<p>A folder where calibration files are to be found.</p>
</td></tr>
<tr><td><code id="import_factory_cals_+3A_keep">keep</code></td>
<td>
<p>Copies valid calibration files to a package-specific
configuration folder. Will result in automatic import of the data in the
future. Will overwrite files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will also load the calibration into the package environment,
where they can be retrieved by <code><a href="#topic+get_factory_cals">get_factory_cals()</a></code>.
</p>
<p>This method assumes the files are named with serial number and calibration
date, separated by an underscore.
</p>


<h3>Value</h3>

<p>Calibration data is stored in the package environment.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_factory_cals">get_factory_cals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")

# show calibration data
get_factory_cals()

# import factory calibration for example data:
import_factory_cals(exampledir)

# show calibration data
get_factory_cals()

</code></pre>

<hr>
<h2 id='modify_equations'>Modify an existing list of equations with specific user-specified equations.</h2><span id='topic+modify_equations'></span>

<h3>Description</h3>

<p>This method allows replacing a specific equations in a list with
custom versions. Although it is possible to add custom equations using
<code><a href="#topic+create_equations">create_equations()</a></code>, it can be useful to modify existing sets. It can also
be used to modify equations imported from an <code>xlsx</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modify_equations(eqs, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modify_equations_+3A_eqs">eqs</code></td>
<td>
<p>a list of calls for recomputing <code>gasanalyzer</code> equations.</p>
</td></tr>
<tr><td><code id="modify_equations_+3A_...">...</code></td>
<td>
<p>custom equations. the arguments must tagged function expressions.
The tags will be matched against the equation list specified in eqs, and
matching expressions will be replaced. Additional expressions will be
added to the list. Note that the function body must be wrapped in curly
brackets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified list of calls containing equations to recalculate
<code>gasanalyzer</code> data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_6800_equations">read_6800_equations()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")

# import factory calibration for example data:
import_factory_cals(exampledir)

# read data from a txt file:
li6800 &lt;- read_6800_txt(paste0(exampledir, "//lowo2"))

# create a default set of gas-exchange equations, for the Li-6800:
Eqs &lt;- create_equations(c("default", "li6800"))

# replace the value for the leaf light absorptance:
Eqs &lt;- modify_equations(Eqs, LeafQ.alpha = \() {0.86})

# apply:
li6800_recalc &lt;- recalculate(li6800, Eqs)

li6800$LeafQ.alpha
li6800_recalc$LeafQ.alpha
</code></pre>

<hr>
<h2 id='permutate'>Expand a data frame with all possible combinations of the values in a column.</h2><span id='topic+permutate'></span>

<h3>Description</h3>

<p>For sensitivity analyses, it is useful to permutate the values in a single
column, whilst keeping all other values constant. After creating such a
permutation, <code><a href="#topic+recalculate">recalculate()</a></code> should be used to analyze the effect of the
change in the column of interest. If the effect of changes in multiple
columns is to be analyzed, this function can be called in series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permutate(df, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permutate_+3A_df">df</code></td>
<td>
<p>a dataframe or tibble</p>
</td></tr>
<tr><td><code id="permutate_+3A_...">...</code></td>
<td>
<p>a name-value pair. The name gives the name of the column in the
input that is to be changed. The value is a vector specifying all values
that are desired in the output. For every value in this vector, all other
rows are duplicated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing all possible combinations of the input df
and the vector specified in ...
</p>
<p>Note that the units and classes of the columns in the input data frame are
applied to the replacement values. Unexpected behavior may occur when
providing incompatible classes or units.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example &lt;- system.file("extdata//6400-testfile", package = "gasanalyzer")

# read data:
li6400 &lt;- read_6400_txt(example)

# expand the data frame for a range of leaf areas, and recalculate the data:
li6400 &lt;- permutate(li6400, Const.S = seq(1, 8)) |&gt;
  recalculate(create_equations(c("default", "li6400")))

if (interactive()) {
  require(units)
  require(graphics)

  # observe that changing the leaf area enclosed in the chamber would have a
  # nonlinear effect on the rate of photosynthesis:
  aggregate(list(A = li6400$GasEx.A), list(Area = (li6400$Const.S)), mean) |&gt;
    plot()
}
</code></pre>

<hr>
<h2 id='read_6400_txt'>Reads 6400XT text files and creates a tibble with gas-exchange data.</h2><span id='topic+read_6400_txt'></span>

<h3>Description</h3>

<p>The text files stored by the 6400 contain measured and calculated values that
are read by this function and formatted in a large tibble for use with R.
Constants and metadata are also added as columns. Note that no recalculation of
the gas-exchange parameters is performed, although it is possible to do that using
<code><a href="#topic+recalculate">recalculate()</a></code> after importing the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_6400_txt(filename, tz = Sys.timezone())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_6400_txt_+3A_filename">filename</code></td>
<td>
<p>an text file containing 6400XT gas-exchange data.</p>
</td></tr>
<tr><td><code id="read_6400_txt_+3A_tz">tz</code></td>
<td>
<p>a character string specifying the timezone for the loaded file. If
omitted, the current time zone is used. Invalid values are typically
treated as UTC, on some platforms with a warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple files can be loaded by calling the function with <code><a href="base.html#topic+lapply">lapply()</a></code> or
<code><a href="purrr.html#topic+map">purrr::map()</a></code> to merge multiple files. In this case, it is important
to ensure that the column names will match.
</p>


<h3>Value</h3>

<p>A tibble with gas-exchange data in columns.
</p>


<h3>See Also</h3>

<p>recalculate
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example &lt;- system.file("extdata//6400-testfile", package = "gasanalyzer")

# read data
li6400data &lt;- read_6400_txt(example)

#View
li6400data

</code></pre>

<hr>
<h2 id='read_6800_equations'>Read gas-exchange equations directly from 6800 xlsx files.</h2><span id='topic+read_6800_equations'></span>

<h3>Description</h3>

<p>It is recommended to use <code><a href="#topic+create_equations">create_equations()</a></code> for recalculating gas-exchange
data, but under some conditions, it may be useful to apply exactly the same
equations as used in the xlsx data file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_6800_equations(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_6800_equations_+3A_filename">filename</code></td>
<td>
<p>an xlsx file containing 6800 gas-exchange data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, this only works for xlsx files stored by the 6800. this function
extracts xlsx formulas from the file and stores them in a list for use by the
<code><a href="#topic+recalculate">recalculate()</a></code> function. Note there is no guarantee that the extracted
equations work on any other data files. Since newer versions of the 6800
firmware allows defining custom equations, it is not guaranteed that all
equations can be extracted successfully.
</p>


<h3>Value</h3>

<p>A list of gas-equations.
</p>
<p>In principle, this can be made to work for the 6400 as well, but since
that instrument uses a variation of the older xls format, it is hard to
get working in practice.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_equations">create_equations()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example &lt;- system.file("extdata//lowo2.xlsx", package = "gasanalyzer")

# get equations stored in the xlsx file
Eqs &lt;- read_6800_equations(example)

#Inpect how stomatal conductance is calculated:
Eqs$GasEx.gsw
</code></pre>

<hr>
<h2 id='read_6800_txt'>Reads 6800 text files and creates a tibble with gas-exchange data.</h2><span id='topic+read_6800_txt'></span>

<h3>Description</h3>

<p>The text files stored by the 6800 contain measured and calculated values that
are read by this function and formatted in a large tibble for use with R.
Constants and metadata (such as calibration information) are also added as
columns. Note that no recalculation of the gas-exchange parameters is
performed, although it is possible to do that using <code><a href="#topic+recalculate">recalculate()</a></code> after
importing the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_6800_txt(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_6800_txt_+3A_filename">filename</code></td>
<td>
<p>an text file containing 6800 gas-exchange data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple files can be loaded by calling the function with <code><a href="base.html#topic+lapply">lapply()</a></code> or
<code><a href="purrr.html#topic+map">purrr::map()</a></code> to merge multiple files. In this case, it is important
to ensure that the column names will match.
</p>


<h3>Value</h3>

<p>A tibble with gas-exchange data in columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recalculate">recalculate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")
# import factory calibration for example data:
import_factory_cals(exampledir)

# read data
li6800 &lt;- read_6800_xlsx(paste0(exampledir, "//lowo2.xlsx"))
li6800_txt &lt;- read_6800_txt(paste0(exampledir, "//lowo2"))

# compare all except equations. Note txt file reports some NAs as zero:
columns_to_check &lt;- names(li6800)[!names(li6800) %in%
                                   c("gasanalyzer.Equations")]
all.equal(li6800[columns_to_check],
          li6800_txt[columns_to_check],
          tol = 0.01)

</code></pre>

<hr>
<h2 id='read_6800_xlsx'>Reads 6800 xlsx files and creates a tibble with gas-exchange data.</h2><span id='topic+read_6800_xlsx'></span>

<h3>Description</h3>

<p>The xlsx files stored by the 6800 contain measured and calculated values that
are read by this function and formatted in a large tibble for use with R.
Constants and metadata (such as calibration information) are also added as
columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_6800_xlsx(filename, recalculate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_6800_xlsx_+3A_filename">filename</code></td>
<td>
<p>an xlsx file containing 6800 gas-exchange data.</p>
</td></tr>
<tr><td><code id="read_6800_xlsx_+3A_recalculate">recalculate</code></td>
<td>
<p>character string indicating whether or not to recalculate data
using equations from the xlsx file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that values for many derived gas-exchange parameters are not
stored in the files, but are calculated by equations stored in the xlsx.
These values are 0 after importing, unless setting recalculate = TRUE. It is
also possible to calculate this parameters after importing using the
<code><a href="#topic+recalculate">recalculate()</a></code> function.
</p>
<p>Multiple files can be loaded by calling the function with <code><a href="base.html#topic+lapply">lapply()</a></code> or
<code><a href="purrr.html#topic+map">purrr::map()</a></code> to merge multiple files. In this case, it is important
to ensure that the column names will match. Recalculation can be disabled
for speed, and instead applied to the merged data using <code><a href="#topic+recalculate">recalculate()</a></code>.
</p>


<h3>Value</h3>

<p>A tibble with gas-exchange data in columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recalculate">recalculate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")
# import factory calibration for example data:
import_factory_cals(exampledir)

# read data:
li6800 &lt;- read_6800_xlsx(paste0(exampledir, "//lowo2.xlsx"))
li6800_norecalc &lt;- read_6800_xlsx(paste0(exampledir, "//lowo2.xlsx"),
  recalculate = FALSE)
li6800_norecalc$gasanalyzer.Equations &lt;-
  list(read_6800_equations(paste0(exampledir, "//lowo2.xlsx")))

all.equal(li6800, recalculate(li6800_norecalc), check.attributes = FALSE)


</code></pre>

<hr>
<h2 id='read_gasexchange'>Read gas-exchange data from a text file.</h2><span id='topic+read_gasexchange'></span>

<h3>Description</h3>

<p>Data stored by <code><a href="#topic+write_gasexchange">write_gasexchange()</a></code> can be read by this method. The first
row is the header, the second row specify the units. File encoding must be
UTF-16LE (use the export as unicode txt option in Microsoft Excel).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_gasexchange(filename, delim = "\t")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_gasexchange_+3A_filename">filename</code></td>
<td>
<p>path to the input file</p>
</td></tr>
<tr><td><code id="read_gasexchange_+3A_delim">delim</code></td>
<td>
<p>delimiter to use for the file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with gas-exchange data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
example &lt;- system.file("extdata//d13C.tsv", package = "gasanalyzer")

# read data
read_gasexchange(example)
</code></pre>

<hr>
<h2 id='read_gfs'>Reads GFS-3000 text files and creates a tibble with gas-exchange data</h2><span id='topic+read_gfs'></span>

<h3>Description</h3>

<p>The text files stored by the GFS-3000 contain measured and calculated values
that are read by this function and formatted in a large tibble for use with
R. Note that no recalculation of the gas-exchange parameters is
performed, although it is possible to do that using <code><a href="#topic+recalculate">recalculate()</a></code> after
importing the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_gfs(
  filename,
  tz = Sys.timezone(),
  unified_names = TRUE,
  skip_to_data = 2,
  delim = ";"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_gfs_+3A_filename">filename</code></td>
<td>
<p>an xlsx file containing 6800 gas-exchange data.</p>
</td></tr>
<tr><td><code id="read_gfs_+3A_tz">tz</code></td>
<td>
<p>a character string specifying the timezone for the loaded file. If
omitted, the current time zone is used. Invalid values are typically
treated as UTC, on some platforms with a warning.</p>
</td></tr>
<tr><td><code id="read_gfs_+3A_unified_names">unified_names</code></td>
<td>
<p>= TRUE, use unified column names. This is necessary for
further processing of the data using this package.</p>
</td></tr>
<tr><td><code id="read_gfs_+3A_skip_to_data">skip_to_data</code></td>
<td>
<p>use skip=4 if the file has a double header.</p>
</td></tr>
<tr><td><code id="read_gfs_+3A_delim">delim</code></td>
<td>
<p>= &quot;;&quot; Allows specified the delimiter used in the files. Re-saved
data may use a comma as delimiter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple files can be loaded by calling the function with <code><a href="base.html#topic+lapply">lapply()</a></code> or
<code><a href="purrr.html#topic+map">purrr::map()</a></code> to merge multiple files. In this case, it is important
to ensure that the column names will match.
</p>


<h3>Value</h3>

<p>a tibble with gas-exchange data in columns and equations as
attribute.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recalculate">recalculate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example &lt;- system.file("extdata//aci1.csv", package = "gasanalyzer")

# Read using GFS-3000 names and formatting:
gfs3000_old &lt;- read_gfs(example, unified_names = FALSE)
# Read using unified column names:
gfs3000 &lt;- read_gfs(example)

# Inspect the intercellular CO2:
gfs3000_old$ci
gfs3000$GasEx.Ci

# Recalculate data using default gas exchange equations:
gfs3000 &lt;- recalculate(gfs3000, create_equations(c("default", "gfs3000")))
gfs3000$GasEx.Ci
</code></pre>

<hr>
<h2 id='recalculate'>Recalculate gas-exchange data based on a set of equations.</h2><span id='topic+recalculate'></span>

<h3>Description</h3>

<p>The recalculation uses equations in a list of quosures provided as argument.
This list can be obtained from <code><a href="#topic+create_equations">create_equations()</a></code> or
<code><a href="#topic+read_6800_equations">read_6800_equations()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recalculate(df, eqs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recalculate_+3A_df">df</code></td>
<td>
<p>A data frame or an extension thereof (e.g. a tibble).</p>
</td></tr>
<tr><td><code id="recalculate_+3A_eqs">eqs</code></td>
<td>
<p>a list of quosures that define how the df will be altered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with recalculated columns as specified by the eqs
argument
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exampledir &lt;- system.file("extdata", package = "gasanalyzer")
# import factory calibration for example data:
import_factory_cals(exampledir)

# read data:
li6800 &lt;- read_6800_xlsx(paste0(exampledir, "//lowo2.xlsx"))

# recalculate using xlsx equations:
li6800 &lt;- recalculate(li6800)

# recalculate using gasanalyzer default equations for the li6800:
li6800_ge &lt;- recalculate(li6800, create_equations(c("default", "li6800")))

# the difference is that units have been enforced using gasanalyzer, which
# has been recorded in a column:
all.equal(li6800, li6800_ge[names(li6800)], tol = 0.01)
</code></pre>

<hr>
<h2 id='var2label'>Render gasanalyzer variables or values using mathematical notation.</h2><span id='topic+var2label'></span>

<h3>Description</h3>

<p>The argument is converted to a plotmath expression that can be used using
<code>plot</code> or <code>ggplot2</code>. If there is no known plotmath expression defined,
the argument is returned as is.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var2label(varname, use_units = FALSE, val = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var2label_+3A_varname">varname</code></td>
<td>
<p>a character list or vector argument with variable names.</p>
</td></tr>
<tr><td><code id="var2label_+3A_use_units">use_units</code></td>
<td>
<p>whether or not to append default units to the resulting.
expression. It is better to rely on the units in the actual data, which is
handled automatically by newer ggplot2 versions.</p>
</td></tr>
<tr><td><code id="var2label_+3A_val">val</code></td>
<td>
<p>a value to display rather than the variable name. Needs to be of
the same length as varname and if not a character vector it should be
coercible to one. NAs are replaced with the plotmath
expressions.</p>
</td></tr>
<tr><td><code id="var2label_+3A_...">...</code></td>
<td>
<p>options passed on to make_unit_label.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of plotmath expressions.
</p>


<h3>See Also</h3>

<p>plotmath
</p>


<h3>Examples</h3>

<pre><code class='language-R'># make labels
lbls &lt;- var2label(c("GasEx.Ci", "GasEx.A"), use_units = TRUE)
print(lbls)

# plot
plot(1, type = "n", xlab = lbls[[1]], ylab = lbls[[2]])
# add temperature as title, removing [] from the units:
title(main = var2label("Meas.Tleaf",use_units = TRUE, val = 25,
  group = c("", ""))[[1]])

</code></pre>

<hr>
<h2 id='write_gasexchange'>Write a gas-exchange tibble to a text file.</h2><span id='topic+write_gasexchange'></span>

<h3>Description</h3>

<p>The column names and column units are saved as a two-row header. The files
use UTF-16LE and CRLF line headings for compatibility. By default, tabs are
used as delimiter. If you intend to open the file in a spreadsheet program,
it may be helpful to use <code>csv</code> as file extension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_gasexchange(df, filename, delim = "\t")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_gasexchange_+3A_df">df</code></td>
<td>
<p>a tibble with gas-exchange data</p>
</td></tr>
<tr><td><code id="write_gasexchange_+3A_filename">filename</code></td>
<td>
<p>path to the output file</p>
</td></tr>
<tr><td><code id="write_gasexchange_+3A_delim">delim</code></td>
<td>
<p>delimiter to use for the file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that for data-exchange between R sessions, <code><a href="base.html#topic+saveRDS">saveRDS()</a></code> and <code><a href="base.html#topic+readRDS">readRDS()</a></code>
are faster, and support saving and loading list columns (such as calibration
information and equations). This method is primarily meant for exchanging
data with other software packages.
</p>


<h3>Value</h3>

<p>No return value. If there a problems writing the file, a warning or
error will be shown.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
example &lt;- system.file("extdata//d13C.tsv", package = "gasanalyzer")

# read data and recalculate using default gas-exchange equations:
df &lt;- read_gasexchange(example) |&gt;
  recalculate(create_equations("default"))

# write recaculated data
write_gasexchange(df, "d13C_recalculated.tsv")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
