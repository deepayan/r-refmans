<!DOCTYPE html><html><head><title>Help for package CopulaREMADA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CopulaREMADA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arthritis'><p>The rheumatoid arthritis data</p></a></li>
<li><a href='#betaDG'><p>The beta-D-Glucan-data</p></a></li>
<li><a href='#CopulaREMADA'>
<p>Maximum likelhood estimation  for copula mixed models for diagnostic test accurracy studies</p></a></li>
<li><a href='#CopulaREMADA-package'><p>Copula Mixed  Models for Multivariate Meta-Analysis of Diagnostic Test Accuracy Studies</p></a></li>
<li><a href='#coronary'><p>The coronary CT angiography data</p></a></li>
<li><a href='#CT'><p>The computing tomography data</p></a></li>
<li><a href='#cvinesim'>
<p>Simulation from a trivariate C-vine copula</p></a></li>
<li><a href='#dcop'>
<p>Bivariate copula densities</p></a></li>
<li><a href='#dvinesim'>
<p>Simulation from a (truncated) quadrivariate D-vine copula</p></a></li>
<li><a href='#FactorCopulaREMADA'>
<p>Maximum likelihood estimation  of 1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests</p></a></li>
<li><a href='#hybridCopulaREMADA'>
<p>Maximum likelhood estimation  for hybrid copula mixed models for combining case-control and cohort studies in meta-analysis of diagnostic tests</p></a></li>
<li><a href='#LAG'><p>The lymphangiography data</p></a></li>
<li><a href='#mgrid'><p>A list containing four-dimensional arrays</p></a></li>
<li><a href='#MK2016'><p>The coronary CT angiography data in Menke and Kowalski (2016).</p></a></li>
<li><a href='#MRI'><p>The magnetic resonance imaging data</p></a></li>
<li><a href='#mutinomVineCopulaREMADA'>
<p>Maximum likelhood estimation  for multinomial quadrivariate (truncated) D-vine copula mixed models for diagnostic test accurracy studies accounting for non-evaluable outcomes</p></a></li>
<li><a href='#OGT'><p>The orale glucose tolerance data</p></a></li>
<li><a href='#pcondcop'>
<p>Bivariate copula conditional distribution functions</p></a></li>
<li><a href='#qcondcop'>
<p>Bivariate copula conditional quantile functions</p></a></li>
<li><a href='#quadVineCopulaREMADA'>
<p>Maximum likelihood estimation  of quadrivariate  D-vine copula mixed models for joint meta-analysis and comparison of  two diagnostic tests</p></a></li>
<li><a href='#rcop'>
<p>Simulation from parametric bivariate copula families</p></a></li>
<li><a href='#rCopulaREMADA'>
<p>Simulation from copula mixed models for diagnostic test accuaracy studies</p></a></li>
<li><a href='#rFactorCopulaREMADA'>
<p>Simulation from  1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests</p></a></li>
<li><a href='#rmultinomVineCopulaREMADA'>
<p>Simulation from  multinomial quadrivariate (truncated) D-vine copula mixed models for diagnostic test accurracy studies accounting for non-evaluable outcomes</p></a></li>
<li><a href='#rVineCopulaREMADA'>
<p>Simulation from trivariate vine copula mixed models for diagnostic test accuaracy studies accounting for disease prevalence and non-evaluable results</p></a></li>
<li><a href='#SROC'>
<p>Summary receiver operating characteristic   curves for copula mixed effect models for bivariate meta-analysis of diagnostic test accuracy studies</p></a></li>
<li><a href='#tau2par'>
<p>Mapping of Kendall's tau and copula parameter</p></a></li>
<li><a href='#telomerase'><p>The telomerase data</p></a></li>
<li><a href='#vine.vuong'>
<p>Vuong's test for the comparison of non-nested vine copula mixed models for diagnostic test accuaracy studies</p></a></li>
<li><a href='#VineCopulaREMADA'>
<p>Maximum likelhood estimation  for (truncated) vine copula mixed models for diagnostic test accurracy studies accounting for disease prevalence and non-evaluable outcomes</p></a></li>
<li><a href='#vuong'>
<p>Vuong's test for the comparison of non-nested copula mixed models for diagnostic test accuaracy studies</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula Mixed Models for Multivariate Meta-Analysis of Diagnostic
Test Accuracy Studies</td>
</tr>
<tr>
<td>Author:</td>
<td>Aristidis K. Nikoloulopoulos &lt;A.Nikoloulopoulos@uea.ac.uk&gt; </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aristidis K. Nikoloulopoulos &lt;A.Nikoloulopoulos@uea.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), statmod, matlab, tensor, mc2d</td>
</tr>
<tr>
<td>Description:</td>
<td>The bivariate copula mixed model for meta-analysis of diagnostic test accuracy studies in Nikoloulopoulos (2015) &lt;<a href="https://doi.org/10.1002%2Fsim.6595">doi:10.1002/sim.6595</a>&gt;. The vine copula mixed model for meta-analysis of diagnostic test accuracy studies accounting for disease prevalence in Nikoloulopoulos (2017) &lt;<a href="https://doi.org/10.1177%2F0962280215596769">doi:10.1177/0962280215596769</a>&gt; and also accounting for non-evaluable subjects in Nikoloulopoulos (2020) &lt;<a href="https://doi.org/10.1515%2Fijb-2019-0107">doi:10.1515/ijb-2019-0107</a>&gt;. The hybrid vine copula mixed model for meta-analysis of diagnostic test accuracy case-control and cohort studies in Nikoloulopoulos (2018) &lt;<a href="https://doi.org/10.1177%2F0962280216682376">doi:10.1177/0962280216682376</a>&gt;. The D-vine copula mixed model for meta-analysis and comparison of two diagnostic tests in Nikoloulopoulos (2019) &lt;<a href="https://doi.org/10.1177%2F0962280218796685">doi:10.1177/0962280218796685</a>&gt;. The multinomial quadrivariate D-vine copula mixed model for meta-analysis of diagnostic tests with non-evaluable subjects in Nikoloulopoulos (2020) &lt;<a href="https://doi.org/10.1177%2F0962280220913898">doi:10.1177/0962280220913898</a>&gt;. The one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests (2022) &lt;<a href="https://doi.org/10.1111%2Frssa.12838">doi:10.1111/rssa.12838</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 2.10)</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-29 08:45:30 UTC; aris</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-07 16:10:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='arthritis'>The rheumatoid arthritis data</h2><span id='topic+arthritis'></span>

<h3>Description</h3>

<p> Data obtained from a meta-analysis that aimed to determine whether anti-cyclic citrullinated peptide (anti-CCP) antibody  identifies more accurately patients with rheumatoid arthritis than rheumatoid factor (RF) does. We include <code class="reqn">N=22</code>  studies that assessed both RF and anti-CCP2 antibody for diagnosing rheumatoid arthritis.
</p>


<h3>Format</h3>

<p>A data frame with 22 observations on the following 8 variables.
</p>

<dl>
<dt>TP1</dt><dd><p>the number of true positives for RF</p>
</dd>
<dt>FN1</dt><dd><p>the number of false negatives for RF</p>
</dd>
<dt>FP1</dt><dd><p>the number of false positives for RF</p>
</dd>
<dt>TN1</dt><dd><p>the number of true negatives for RF</p>
</dd>
<dt>TP2</dt><dd><p>the number of true positives for anti-CCP2</p>
</dd>
<dt>FN2</dt><dd><p>the number of false negatives for anti-CCP2</p>
</dd>
<dt>FP2</dt><dd><p>the number of false positives for anti-CCP2</p>
</dd>
<dt>TN2</dt><dd><p>the number of true negatives for anti-CCP2</p>
</dd>
</dl>


<h3>References</h3>

<p>Nishimura, K., Sugiyama, D., Kogata, Y., et al. (2007) Meta-analysis: Diagnostic accuracy of anti-cyclic citrullinated peptide antibody and rheumatoid factor for rheumatoid arthritis. <em>Annals of Internal Medicine</em>, <b>146</b>(11), 
797&ndash;808.
</p>
<p>Dimou, N.L., Adam, M. and Bagos, P.G. (2016) A multivariate method for meta-analysis and comparison of diagnostic
tests. <em>Statistics in Medicine</em>, <b>35</b>(20), 3509&ndash;3523.
</p>

<hr>
<h2 id='betaDG'>The beta-D-Glucan-data</h2><span id='topic+betaDG'></span>

<h3>Description</h3>

<p>Data on 8 cohort studies inthemeta-analysis in Karageorgopoulos et al. (2011). The interest there is to assess <code class="reqn">beta</code>-D-Glucan as aserum or plasma marker for the presence of invasive fungal infections.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(betaDG)</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>


<h3>References</h3>

<p>Karageorgopoulos, D.E., Vouloumanou, E.K., Ntziora, F., et al.
(2011) <code class="reqn">beta</code>-D-Glucan assay for the diagnosis of invasive fungal infections: a meta-analysis. <em>Clinical Infectious Diseases</em>, <b>52</b>(6), 750&ndash;770.
</p>

<hr>
<h2 id='CopulaREMADA'>
Maximum likelhood estimation  for copula mixed models for diagnostic test accurracy studies
</h2><span id='topic+CopulaREMADA'></span><span id='topic+CopulaREMADA.norm'></span><span id='topic+CopulaREMADA.beta'></span><span id='topic+countermonotonicCopulaREMADA'></span><span id='topic+countermonotonicCopulaREMADA.norm'></span><span id='topic+countermonotonicCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>For  copula mixed models for diagnostic test accuracy studies numerical evaluation of the MLE is easily done with the following steps:
</p>
<p>1. Calculate Gauss-Legendre  quadrature points 
gl$nodes and weights gl$weights.
</p>
<p>2. Convert from independent uniform quadrature points  to dependent uniform quadrature points  that have distribution 'cop'.
The inverse of the conditional distribution <code>qcondcop</code> corresponding to the copula 'cop' is used  to achieve this.
</p>
<p>3. Numerically evaluate the joint probability mass function with the bivariate integral
in a double sum. 
</p>
<p>With Gauss-Legendre quadrature, the same nodes and weights
are used for different functions;
this helps in yielding smooth numerical derivatives for numerical optimization via quasi-Newton.
Our comparisons show that <code class="reqn">n_q=15</code> is adequate with good precision to at least at four decimal places. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcond,tau2par)
CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcond,tau2par) 
countermonotonicCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid) 
countermonotonicCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CopulaREMADA_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing two matrices with the rows of the output matrix x are copies of the vector <code>gl$nodes</code>; columns of the output matrix y are copies of the vector <code>gl$nodes</code>. For more details see also <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_qcond">qcond</code></td>
<td>
<p>function for the inverse of conditional copula cdf</p>
</td></tr>
<tr><td><code id="CopulaREMADA_+3A_tau2par">tau2par</code></td>
<td>
<p>function for maping Kendall's tau to copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842&ndash;3865. doi: <a href="https://doi.org/10.1002/sim.6595">10.1002/sim.6595</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rCopulaREMADA">rCopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid&lt;- meshgrid(gl$n,gl$n)

data(LAG)
attach(LAG)
c270est.b=CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)
detach(LAG)

data(MRI)
attach(MRI)
c270est.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)
detach(MRI)

data(CT)
attach(CT)
est.n=countermonotonicCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid)
est.b=countermonotonicCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid)
detach(CT)
</code></pre>

<hr>
<h2 id='CopulaREMADA-package'>Copula Mixed  Models for Multivariate Meta-Analysis of Diagnostic Test Accuracy Studies</h2><span id='topic+CopulaREMADA-package'></span>

<h3>Description</h3>

<p>Fits copula mixed models for multivariate meta-analysis of diagnostic test accuracy studies proposed in Nikoloulopoulos (2015, 2017, 2018a, 2018b, 2019, 2020a, 2020b, 2022). 
</p>


<h3>Details</h3>

<p>This package contains <span class="rlang"><b>R</b></span> functions to implement: 
</p>

<ul>
<li><p> The copula mixed model for meta-analysis of diagnostic test accuracy studies and produce SROC curves and summary operating points (a pair of average sensitivity and specificity) with a confidence region and a predictive region (Nikoloulopoulos, 2015, 2018a). All the analyses presented in Section 7 of Nikoloulopoulos (2015) are given as code examples in the package;
</p>
</li>
<li><p> The vine copula mixed model for meta-analysis of diagnostic test accuracy studies accounting for disease prevalence and non-evaluable subjects (Nikoloulopoulos, 2017, 2020a); 
</p>
</li>
<li><p> The hybrid vine copula mixed model for meta-analysis of diagnostic test accuracy case-control and cohort studies (Nikoloulopoulos, 2018b);
</p>
</li>
<li><p> The D-vine copula mixed model for meta-analysis and comparison of two diagnostic tests (Nikoloulopoulos, 2019). 
</p>
</li>
<li><p> The multinomial quadrivariate D-vine copula mixed model for diagnostic studies meta-analysis accounting for non-evaluable subjects (Nikoloulopoulos, 2020b). 
</p>
</li>
<li><p> The one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests (Nikoloulopoulos, 2022). 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Aristidis K. Nikoloulopoulos.
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842&ndash;3865. doi: <a href="https://doi.org/10.1002/sim.6595">10.1002/sim.6595</a>.
</p>
<p>Nikoloulopoulos, A.K.  (2017) A vine copula mixed effect model for trivariate meta-analysis of diagnostic test accuracy studies accounting for disease prevalence. <em>Statistical Methods in Medical Research</em>, <b>26</b>, 2270&ndash;2286. doi: <a href="https://doi.org/10.1177/0962280215596769">10.1177/0962280215596769</a>.
</p>
<p>Nikoloulopoulos, A.K. (2018a) On composite likelihood in bivariate meta-analysis of diagnostic test accuracy studies.  <em>AStA Advances in Statistical Analysis</em>, <b>102</b>, 211&ndash;227. doi: <a href="https://doi.org/10.1007/s10182-017-0299-y">10.1007/s10182-017-0299-y</a>. 
</p>
<p>Nikoloulopoulos, A.K. (2018b) Hybrid copula mixed models for combining case-control and cohort studies in meta-analysis of diagnostic tests. <em>Statistical Methods in Medical Research</em>, <b>27</b>, 2540&ndash;2553. doi: <a href="https://doi.org/10.1177/0962280216682376">10.1177/0962280216682376</a>. 
</p>
<p>Nikoloulopoulos, A.K.  (2019) A D-vine copula mixed model for joint meta-analysis and comparison of  diagnostic tests.  <em>Statistical Methods in Medical Research</em>,  28(10-11):3286&ndash;3300. doi: <a href="https://doi.org/10.1177/0962280218796685">10.1177/0962280218796685</a>. 
</p>
<p>Nikoloulopoulos, A.K.  (2020a) An extended trivariate vine copula mixed model for meta-analysis of diagnostic studies in the presence of non-evaluable outcomes.  <em>The International Journal of Biostatistics</em>, 16(2). doi: <a href="https://doi.org/10.1515/ijb-2019-0107">10.1515/ijb-2019-0107</a>.
</p>
<p>Nikoloulopoulos, A.K. (2020b) A multinomial quadrivariate D-vine copula mixed model for diagnostic studies meta-analysis in the presence of non-evaluable subjects. <em>Statistical Methods in Medical Research</em>,  29 (10), 2988&ndash;3005. doi: <a href="https://doi.org/10.1177/0962280220913898">10.1177/0962280220913898</a>. 
</p>
<p>Nikoloulopoulos, A.K. (2022) An one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>,  185 (3), 1398&ndash;1423. doi: <a href="https://doi.org/10.1111/rssa.12838">10.1111/rssa.12838</a>.
</p>

<hr>
<h2 id='coronary'>The coronary CT angiography data</h2><span id='topic+coronary'></span>

<h3>Description</h3>

<p>Data on 26 studies from a systematic review for diagnostic accuracy studies of coronary computed tomography angiography for the detection of coronary artery disease.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coronary)</code></pre>


<h3>Format</h3>

<p>A data frame with 26 observations on the following 6 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
<dt>NEP</dt><dd><p>the number of non-evaluable positives</p>
</dd>
<dt>NEN</dt><dd><p>the number of non-evaluable negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Schuetz, G. M., Schlattmann, P., and Dewey, M. (2012). Use of 3x2 tables with an intention to diagnose approach to assess clinical performance of diagnostic tests: Meta-analytical evaluation of coronary CT angiography studies. <em>BMJ</em> (Online), <b>345</b>:e6717.
</p>

<hr>
<h2 id='CT'>The computing tomography data</h2><span id='topic+CT'></span>

<h3>Description</h3>

<p>Data on 17 studies of computed tomography (CT) for the diagnosis of lymph node metastasis in women with cervical cancer, one of three imaging techniques in the meta-analysis in Scheidler et al. (1997). Diagnosis of metastatic disease by CT relies on nodal enlargement.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CT)</code></pre>


<h3>Format</h3>

<p>A data frame with 17 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Scheidler, J., H. Hricak, K. K. Yu, L. Subak, and M. R. Segal. (1997) Radiological evaluation of lymph node metastases in patients with cervical cancer: A meta-analysis.  <em>Journal of the American Medical Association</em>,  <b>278</b>, 1096&ndash;1101.
</p>

<hr>
<h2 id='cvinesim'>
Simulation from a trivariate C-vine copula
</h2><span id='topic+cvinesim'></span>

<h3>Description</h3>

<p>Simulation from a trivariate C-vine copula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvinesim(N,param,qcondcop12,qcondcop13,qcondcop23,
                  tau2par12,tau2par13,tau2par23)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvinesim_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_param">param</code></td>
<td>
<p>Kendall's tau values for margins (1,2), (1,3), (23|1)</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_qcondcop12">qcondcop12</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,2) bivariate margin</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_qcondcop13">qcondcop13</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,3) bivariate margin</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_qcondcop23">qcondcop23</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (2,3|1) bivariate margin</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_tau2par12">tau2par12</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_tau2par13">tau2par13</code></td>
<td>
<p>function for maping Kendall's tau at the (1,3) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="cvinesim_+3A_tau2par23">tau2par23</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3|1) bivariate margin to the conditional copula parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices are 'cop' in rcop are bvn, frk, cln, cln90 (rotated by 90 degrees cln), cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>See help page for <code><a href="#topic+dcop">dcop</a></code> for the abbreviations of the copula names.
</p>


<h3>Value</h3>

<p>Nx3 matrix with values in (0,1)
</p>


<h3>References</h3>

<p>Joe H (2011) Dependence comparisons of vine copulae with four or more variables. In: Kurowicka D, Joe H, editors. <em>Dependence Modeling: Handbook on Vine Copulae</em>. Singapore: World Scientific; 2011. p. 139&ndash;164
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcondcop">qcondcop</a></code>
<code><a href="#topic+dcop">dcop</a></code>
<code><a href="#topic+rcop">rcop</a></code>
</p>

<hr>
<h2 id='dcop'>
Bivariate copula densities
</h2><span id='topic+dcop'></span><span id='topic+dbvn'></span><span id='topic+dfrk'></span><span id='topic+dcln'></span><span id='topic+dcln90'></span><span id='topic+dcln180'></span><span id='topic+dcln270'></span>

<h3>Description</h3>

<p>Bivariate copula densities for parametric families.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbvn(u,v,cpar)
dfrk(u,v,cpar)
dcln(u,v,cpar)
dcln90(u,v,cpar)
dcln270(u,v,cpar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcop_+3A_u">u</code></td>
<td>
<p>value in interval 0,1; could be a vector</p>
</td></tr>
<tr><td><code id="dcop_+3A_v">v</code></td>
<td>
<p>value in interval 0,1; could be a vector</p>
</td></tr>
<tr><td><code id="dcop_+3A_cpar">cpar</code></td>
<td>
<p>copula parameter: scalar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices are 'cop' in dcop are bvn, frk, cln, cln90 (rotated by 90 degrees cln), 
cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>The copula names are abbreviations for:
</p>
<p>bvn = bivariate normal or Gaussian
</p>
<p>frk = Frank
</p>
<p>cln = Clayton or Mardia-Takahasi-Cook-Johnson
</p>


<h3>Value</h3>

<p>pdf value(s).
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcondcop">qcondcop</a></code>
<code><a href="#topic+rcop">rcop</a></code>
</p>

<hr>
<h2 id='dvinesim'>
Simulation from a (truncated) quadrivariate D-vine copula
</h2><span id='topic+dvinesim'></span><span id='topic+dtrvinesim'></span>

<h3>Description</h3>

<p>Simulation from a (truncated) quadrivariate D-vine copula. Lower-order trees (if any) are composed with BVN copulas. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvinesim(nsim,param,qcond1,pcond1,tau2par1,qcond2,pcond2,tau2par2)
dtrvinesim(nsim,trparam,qcond1,pcond1,tau2par1,qcond2,pcond2,tau2par2)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dvinesim_+3A_nsim">nsim</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_param">param</code></td>
<td>
<p>Kendall's tau values for margins (1,2), (2,3), (3,4), (1,3|2), (2,4|3), (1,4|23)</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_trparam">trparam</code></td>
<td>
<p>Kendall's tau values for margins (1,2), (2,3), (3,4)</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (1,2) and (3,4) bivariate margins</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_pcond1">pcond1</code></td>
<td>
<p>function for the conditional copula cdf at the (1,2) and  and (3,4) bivariate margins</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) and (3,4) bivariate margins to copula parameter</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_pcond2">pcond2</code></td>
<td>
<p>function for the conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="dvinesim_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3) bivariate margin to copula parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices are 'cop' in rcop are bvn, frk, cln, cln90 (rotated by 90 degrees cln), cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>See help page for <code><a href="#topic+dcop">dcop</a></code> for the abbreviations of the copula names.
</p>


<h3>Value</h3>

<p>Nx4 matrix with values in (0,1)
</p>


<h3>References</h3>

<p>Joe H (2011) Dependence comparisons of vine copulae with four or more variables. In: Kurowicka D, Joe H, editors. <em>Dependence Modeling: Handbook on Vine Copulae</em>. Singapore: World Scientific; 2011. p. 139&ndash;164
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>
<p>Nikoloulopoulos, A.K. (2018) A D-vine copula mixed model for joint meta-analysis and comparison of  diagnostic tests.  <em>Statistical Methods in Medical Research</em>, in press. doi: <a href="https://doi.org/10.1177/0962280218796685">10.1177/0962280218796685</a>. 
</p>
<p>Nikoloulopoulos, A.K. (2018) A multinomial quadrivariate D-vine copula mixed model for diagnostic studies meta-analysis accounting for non-evaluable subjects.  <em>ArXiv e-prints</em>, arXiv:1812.05915. <a href="https://arxiv.org/abs/1812.05915">https://arxiv.org/abs/1812.05915</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcondcop">qcondcop</a></code>
<code><a href="#topic+dcop">dcop</a></code>
<code><a href="#topic+rcop">rcop</a></code>
</p>

<hr>
<h2 id='FactorCopulaREMADA'>
Maximum likelihood estimation  of 1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests
</h2><span id='topic+FactorCopulaREMADA'></span><span id='topic+FactorCopulaREMADA.norm'></span><span id='topic+FactorCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FactorCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
                               
FactorCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FactorCopulaREMADA_+3A_tp">TP</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_fn">FN</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of false negatives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_fp">FP</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of false positives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_tn">TN</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of true negatives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing two matrices with the rows of the output matrix x are copies of the vector <code>gl$nodes</code>; columns of the output matrix y are copies of the vector <code>gl$nodes</code>. For more details see also <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent sensitivities</p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent sensitivities</p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent specificities</p>
</td></tr>
<tr><td><code id="FactorCopulaREMADA_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent specificities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022) An one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>,  185 (3), 1398&ndash;1423. doi: <a href="https://doi.org/10.1111/rssa.12838">10.1111/rssa.12838</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(arthritis)
attach(arthritis)
TP=cbind(TP1,TP2)
TN=cbind(TN1,TN2)
FP=cbind(FP1,FP2)
FN=cbind(FN1,FN2)


nq=25
gl=gauss.quad.prob(nq,"uniform")
mgrid=meshgrid(gl$n,gl$n)
qcond1=qcondcln
qcond2=qcondcln270
tau2par1=tau2par.cln
tau2par2=tau2par.cln270

out=FactorCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
se=sqrt(diag(solve(out$hessian)))

detach(arthritis)
</code></pre>

<hr>
<h2 id='hybridCopulaREMADA'>
Maximum likelhood estimation  for hybrid copula mixed models for combining case-control and cohort studies in meta-analysis of diagnostic tests
</h2><span id='topic+hybridCopulaREMADA'></span><span id='topic+hybridCopulaREMADA.norm'></span><span id='topic+hybridCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hybridCopulaREMADA.norm(TP,FN,FP,TN,type,gl,mgrid1,mgrid2,
               qcondcop12,qcondcop13,
               tau2par12,tau2par13,qcond,tau2par)
hybridCopulaREMADA.beta(TP,FN,FP,TN,type,gl,mgrid1,mgrid2,
               qcondcop12,qcondcop13,
               tau2par12,tau2par13,qcond,tau2par) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hybridCopulaREMADA_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_type">type</code></td>
<td>
<p>a scalar indicating the study type: 
1: Cohort study;
2: Case-control study.</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_mgrid1">mgrid1</code></td>
<td>

<p>a list containing three-dimensional arrays. For more details see <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_mgrid2">mgrid2</code></td>
<td>

<p>a list containing two matrices with the rows of the output matrix x are copies of the vector <code>gl$nodes</code>; columns of the output matrix y are copies of the vector <code>gl$nodes</code>. For more details see also <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_qcondcop12">qcondcop12</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,2) bivariate margin of the vine</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_qcondcop13">qcondcop13</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,3) bivariate margin of the vine</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_tau2par12">tau2par12</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin of the vine to copula parameter</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_tau2par13">tau2par13</code></td>
<td>
<p>function for maping Kendall's tau at the (1,3) bivariate margin of the vine to copula parameter</p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_qcond">qcond</code></td>
<td>
<p>function for the inverse of conditional copula cdf </p>
</td></tr>
<tr><td><code id="hybridCopulaREMADA_+3A_tau2par">tau2par</code></td>
<td>
<p>function for maping Kendall's tau to the bivariate copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2018) Hybrid copula mixed models for combining case-control and cohort studies in meta-analysis of diagnostic tests. <em>Statistical Methods in Medical Research</em>, <b>27</b>, 2540&ndash;2553. doi: <a href="https://doi.org/10.1177/0962280216682376">10.1177/0962280216682376</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VineCopulaREMADA">VineCopulaREMADA</a></code>, <code><a href="#topic+CopulaREMADA">CopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simulate the data from N=25 cohort studies
N=25
p=c(0.8,0.7,0.4)
g=c(0.1,0.1,0.05)
taus=c(-0.5,-0.3,-0.0001)
qcondcop12=qcondcop23=qcondcop13=qcondcln90
tau2par12=tau2par23=tau2par13=tau2par.cln90
simdat1=rVineCopulaREMADA.beta(N,p,g,taus,0,0,
qcondcop12,qcondcop13,qcondcop23,tau2par12,tau2par13,tau2par23)
# simulate data from the N=25 case-control studies
tau=0.5
p=p[-3]
g=g[-3]
simdat2=rCopulaREMADA.beta(N,p,g,tau,rcln,tau2par.cln)
# combine the data
TP=c(simdat1$TP,simdat2$TP)
TN=c(simdat1$TN,simdat2$TN)
FP=c(simdat1$FP,simdat2$FP)
FN=c(simdat1$FN,simdat2$FN)
type=rep(c(1,2),each=N)

# fit the hybrid copula mixed model
nq=21
gl=gauss.quad.prob(nq,"uniform")
mgrid1&lt;- meshgrid(gl$n,gl$n,gl$n,nargout=3)
mgrid2&lt;- meshgrid(gl$n,gl$n)

qcond=qcondcln
tau2par=tau2par.cln
est=hybridCopulaREMADA.beta(TP,FN,FP,TN,type,gl,mgrid1,mgrid2,
qcondcop12,qcondcop13,tau2par12,tau2par13,qcond,tau2par)

</code></pre>

<hr>
<h2 id='LAG'>The lymphangiography data</h2><span id='topic+LAG'></span>

<h3>Description</h3>

<p>Data on 17 studies of lymphangiography (LAG) for the diagnosis of lymph node metastasis in women with cervical cancer, one of three imaging techniques in the meta-analysis in Scheidler et al. (1997). Diagnosis of metastatic disease by LAG is based on the presence of nodal-filling defects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LAG)</code></pre>


<h3>Format</h3>

<p>A data frame with 17 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>


<h3>References</h3>

<p>Scheidler, J., H. Hricak, K. K. Yu, L. Subak, and M. R. Segal. (1997) Radiological evaluation of lymph node metastases in patients with cervical cancer: A meta-analysis.  <em>Journal of the American Medical Association</em>,  <b>278</b>, 1096&ndash;1101.
</p>

<hr>
<h2 id='mgrid'>A list containing four-dimensional arrays</h2><span id='topic+mgrid'></span><span id='topic+mgrid15'></span><span id='topic+mgrid30'></span><span id='topic+mgrid50'></span>

<h3>Description</h3>

<p>A list containing four-dimensional arrays.  Replicates of the quadrature points  that produce an 4-dimensional full grid.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mgrid15)
dim(mgrid15$x)
dim(mgrid15$y)
dim(mgrid15$z)
dim(mgrid15$w)

data(mgrid30)
dim(mgrid30$x)
dim(mgrid30$y)
dim(mgrid30$z)
dim(mgrid30$w)

data(mgrid50)
dim(mgrid50$x)
dim(mgrid50$y)
dim(mgrid50$z)
dim(mgrid50$w)
</code></pre>

<hr>
<h2 id='MK2016'>The coronary CT angiography data in Menke and Kowalski (2016).</h2><span id='topic+MK2016'></span>

<h3>Description</h3>

<p>Data on 30 studies from a systematic review for diagnostic accuracy studies of coronary computed tomography angiography for the detection of coronary artery disease.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MK2016)</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 6 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
<dt>NEP</dt><dd><p>the number of non-evaluable positives</p>
</dd>
<dt>NEN</dt><dd><p>the number of non-evaluable negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Menke, J. and Kowalski, J. (2016). Diagnostic accuracy and utility of coronary ct angiography with consideration of unevaluable results: A systematic review and multivariate bayesian random-effects meta-analysis with intention to diagnose. <em>European Radiology</em>, <b>26</b>(2):451&ndash;458.
</p>

<hr>
<h2 id='MRI'>The magnetic resonance imaging data</h2><span id='topic+MRI'></span>

<h3>Description</h3>

<p>Data on 10 studies of magnetic resonance imaging (MRI) for the diagnosis of lymph node metastasis in women with cervical cancer, the last imaging technique in the meta-analysis in Scheidler et al. (1997). Diagnosis of metastatic disease by MRI relies on nodal enlargement. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MRI)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>


<h3>References</h3>

<p>Scheidler, J., H. Hricak, K. K. Yu, L. Subak, and M. R. Segal. (1997) Radiological evaluation of lymph node metastases in patients with cervical cancer: A meta-analysis.  <em>Journal of the American Medical Association</em>,  <b>278</b>, 1096&ndash;1101.
</p>

<hr>
<h2 id='mutinomVineCopulaREMADA'>
Maximum likelhood estimation  for multinomial quadrivariate (truncated) D-vine copula mixed models for diagnostic test accurracy studies accounting for non-evaluable outcomes
</h2><span id='topic+multinomVineCopulaREMADA'></span><span id='topic+multinomVineCopulaREMADA.norm'></span><span id='topic+multinomVineCopulaREMADA.beta'></span><span id='topic+tmultinomVineCopulaREMADA'></span><span id='topic+tmultinomVineCopulaREMADA.norm'></span><span id='topic+tmultinomVineCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinomVineCopulaREMADA.norm(TP,FN,FP,TN,NEP,NEN,
                                 gl,mgrid,qcond1,pcond1,tau2par1,
                                 qcond2,pcond2,tau2par2)
multinomVineCopulaREMADA.beta(TP,FN,FP,TN,NEP,NEN,
                                 gl,mgrid,qcond1,pcond1,tau2par1,
                                 qcond2,pcond2,tau2par2)
tmultinomVineCopulaREMADA.norm(TP,FN,FP,TN,NEP,NEN,
                                 gl,mgrid,
                                 qcond1,pcond1,tau2par1,
                                 qcond2,pcond2,tau2par2)
tmultinomVineCopulaREMADA.beta(TP,FN,FP,TN,NEP,NEN,
                                 gl,mgrid,
                                 qcond1,pcond1,tau2par1,
                                 qcond2,pcond2,tau2par2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_nep">NEP</code></td>
<td>
<p>the number of non-evaluable positives in the presence of non-evaluable subjects</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_nen">NEN</code></td>
<td>
<p>the number of non-evaluable negatives in the presence of non-evaluable subjects</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing 4-dimensional arrays.</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (1,2) and (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_pcond1">pcond1</code></td>
<td>
<p>function for the conditional copula cdf at the (1,2) and (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) and (3,4) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_pcond2">pcond2</code></td>
<td>
<p>function for the conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="mutinomVineCopulaREMADA_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3) bivariate margin to copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2020) A multinomial quadrivariate D-vine copula mixed model for diagnostic studies meta-analysis in the presence of non-evaluable subjects.  <em>Statistical Methods in Medical Research</em>, 29 (10), 2988&ndash;3005. doi: <a href="https://doi.org/10.1177/0962280220913898">10.1177/0962280220913898</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmultinomVineCopulaREMADA">rmultinomVineCopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nq=15
gl=gauss.quad.prob(nq,"uniform")
data(mgrid15)

data(MK2016)
attach(MK2016)

out=tmultinomVineCopulaREMADA.beta(TP,FN,FP,TN,NEP,NEN,
gl,mgrid15,qcondcln180,pcondcln180,tau2par.cln180,
qcondcln90,pcondcln90,tau2par.cln90)

detach(MK2016)
</code></pre>

<hr>
<h2 id='OGT'>The orale glucose tolerance data</h2><span id='topic+OGT'></span>

<h3>Description</h3>

<p>Data on 10 studies of  the oral glucose tolerance test for the diagnosis of diabetes mellitus in patients during acute coronary syndrome hospitalization in Ye et al. (2012). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(OGT)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>


<h3>References</h3>

<p>Ye, Y., Xie, H., Zhao, X., Zhang, S. (2012) The oral glucose tolerance test for the diagnosis of diabetes mellitus in patients during acute coronary syndrome hospitalization: a meta-analysis of diagnostic test accuracy. <em>Cardiovascular Diabetology</em>, <b>11</b>(5):155.
</p>

<hr>
<h2 id='pcondcop'>
Bivariate copula conditional distribution functions
</h2><span id='topic+pcondcop'></span><span id='topic+pcondbvn'></span><span id='topic+pcondfrk'></span><span id='topic+pcondcln'></span><span id='topic+pcondcln90'></span><span id='topic+pcondcln180'></span><span id='topic+pcondcln270'></span>

<h3>Description</h3>

<p>Bivariate copula conditional distribution functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcondbvn(v,u,cpar)
pcondfrk(v,u,cpar)
pcondcln(v,u,cpar)
pcondcln90(v,u,cpar)
pcondcln270(v,u,cpar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcondcop_+3A_v">v</code></td>
<td>
<p>conditioning value in interval 0,1; could be a vector </p>
</td></tr>
<tr><td><code id="pcondcop_+3A_u">u</code></td>
<td>
<p>value in interval 0,1; could be a vector </p>
</td></tr>
<tr><td><code id="pcondcop_+3A_cpar">cpar</code></td>
<td>
<p>copula parameter: scalar. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices appending 'cop'
are bvn, frk, cln, cln90 (rotated by 90 degrees cln), cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>See help page for <code><a href="#topic+dcop">dcop</a></code> for the abbreviations of the copula names.
</p>


<h3>Value</h3>

<p>inverse conditional cdf value(s)
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcop">dcop</a></code>
<code><a href="#topic+rcop">rcop</a></code>
</p>

<hr>
<h2 id='qcondcop'>
Bivariate copula conditional quantile functions
</h2><span id='topic+qcondcop'></span><span id='topic+qcondbvn'></span><span id='topic+qcondfrk'></span><span id='topic+qcondcln'></span><span id='topic+qcondcln90'></span><span id='topic+qcondcln180'></span><span id='topic+qcondcln270'></span>

<h3>Description</h3>

<p>Bivariate copula conditional quantile functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcondbvn(p,u,cpar)
qcondfrk(p,u,cpar)
qcondcln(p,u,cpar)
qcondcln90(p,u,cpar)
qcondcln270(p,u,cpar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcondcop_+3A_u">u</code></td>
<td>
<p>conditioning value in interval 0,1; could be a vector </p>
</td></tr>
<tr><td><code id="qcondcop_+3A_p">p</code></td>
<td>
<p>quantile in interval 0,1; could be a vector </p>
</td></tr>
<tr><td><code id="qcondcop_+3A_cpar">cpar</code></td>
<td>
<p>copula parameter: scalar. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices appending 'cop'
are bvn, frk, cln, cln90 (rotated by 90 degrees cln), cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>See help page for <code><a href="#topic+dcop">dcop</a></code> for the abbreviations of the copula names.
</p>


<h3>Value</h3>

<p>inverse conditional cdf value(s)
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcop">dcop</a></code>
<code><a href="#topic+rcop">rcop</a></code>
</p>

<hr>
<h2 id='quadVineCopulaREMADA'>
Maximum likelihood estimation  of quadrivariate  D-vine copula mixed models for joint meta-analysis and comparison of  two diagnostic tests
</h2><span id='topic+quadVineCopulaREMADA'></span><span id='topic+quadVineCopulaREMADA.norm'></span><span id='topic+quadVineCopulaREMADA.beta'></span><span id='topic+quadVineCopulaREMADA.norm.beta'></span>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadVineCopulaREMADA.norm(TP1,FN1,FP1,TN1,TP2,FN2,FP2,TN2,
                               gl,mgrid,qcond1,pcond1,tau2par1,
                               qcond2,pcond2,tau2par2)
                               
quadVineCopulaREMADA.beta(TP1,FN1,FP1,TN1,TP2,FN2,FP2,TN2,
                               gl,mgrid,qcond1,pcond1,tau2par1,
                               qcond2,pcond2,tau2par2) 
quadVineCopulaREMADA.norm.beta(TP1,FN1,FP1,TN1,TP2,FN2,FP2,TN2,
                               gl,mgrid,qcond1,pcond1,tau2par1,
                               qcond2,pcond2,tau2par2)              
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quadVineCopulaREMADA_+3A_tp1">TP1</code></td>
<td>
<p>the number of true positives for test 1</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_fn1">FN1</code></td>
<td>
<p>the number of false negatives for test 1</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_fp1">FP1</code></td>
<td>
<p>the number of false positives for test 1</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_tn1">TN1</code></td>
<td>
<p>the number of true negatives for test 1</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_tp2">TP2</code></td>
<td>
<p>the number of true positives for test 2</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_fn2">FN2</code></td>
<td>
<p>the number of false negatives for test 2</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_fp2">FP2</code></td>
<td>
<p>the number of false positives for test 2</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_tn2">TN2</code></td>
<td>
<p>the number of true negatives for test 2</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing 4-dimensional arrays.</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (1,2) bivariate margin</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_pcond1">pcond1</code></td>
<td>
<p>function for the conditional copula cdf at the (1,2) bivariate margin</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_pcond2">pcond2</code></td>
<td>
<p>function for the conditional copula cdf at the (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="quadVineCopulaREMADA_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau at the (3,4) bivariate margin to copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2019) A D-vine copula mixed model for joint meta-analysis and comparison of  diagnostic tests.  <em>Statistical Methods in Medical Research</em>, 28(10-11):3286&ndash;3300. doi: <a href="https://doi.org/10.1177/0962280218796685">10.1177/0962280218796685</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nq=15
gl=gauss.quad.prob(nq,"uniform")
data(mgrid15)

data(arthritis)
attach(arthritis)

qcond1=qcondcln270
pcond1=pcondcln270
tau2par1=tau2par.cln270

qcond2=qcondfrk
pcond2=pcondfrk
tau2par2=tau2par.frk

out&lt;-quadVineCopulaREMADA.norm(TP1,FN1,FP1,TN1,TP2,FN2,FP2,TN2,
gl,mgrid15,qcond1,pcond1,tau2par1,qcond2,pcond2,tau2par2)

detach(arthritis)
</code></pre>

<hr>
<h2 id='rcop'>
Simulation from parametric bivariate copula families
</h2><span id='topic+rcop'></span><span id='topic+rbvn'></span><span id='topic+rfrk'></span><span id='topic+rcln'></span><span id='topic+rcln90'></span><span id='topic+rcln180'></span><span id='topic+rcln270'></span>

<h3>Description</h3>

<p>Simulation from parametric bivariate copula families
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbvn(N,cpar)
rfrk(N,cpar)
rcln(N,cpar)
rcln90(N,cpar)
rcln270(N,cpar) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcop_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rcop_+3A_cpar">cpar</code></td>
<td>
<p>copula parameter: scalar</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Choices are 'cop' in rcop are bvn, frk, cln, cln90 (rotated by 90 degrees cln), cln180 (rotated by 180 degrees cln), cln270 (rotated by 270 degrees cln).
</p>
<p>See help page for <code><a href="#topic+dcop">dcop</a></code> for the abbreviations of the copula names.
</p>


<h3>Value</h3>

<p>nx2 matrix with values in (0,1)
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcondcop">qcondcop</a></code>
<code><a href="#topic+dcop">dcop</a></code>
</p>

<hr>
<h2 id='rCopulaREMADA'>
Simulation from copula mixed models for diagnostic test accuaracy studies
</h2><span id='topic+rCopulaREMADA'></span><span id='topic+rCopulaREMADA.norm'></span><span id='topic+rCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>To simulate the data we have used the following steps:
</p>
<p>1. Simulate the study size <code class="reqn">n</code> from a shifted gamma distribution with parameters <code class="reqn">\alpha=1.2,\beta=0.01,lag=30</code> and round off to the nearest integer. 
</p>
<p>2. Simulate <code class="reqn">(u_1,u_2)</code> from a parametric family of copulas 'cop'.  
</p>
<p>3. Convert to beta realizations  or normal realizations. 
</p>
<p>4. Draw the number of diseased <code class="reqn">n_1</code> from a <code class="reqn">B(n,0.43)</code> distribution.
</p>
<p>5. Set  <code class="reqn">n_2=n-n_1, y_j=n_jx_j</code> and then round <code class="reqn">y_j</code> for <code class="reqn">j=1,2</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rCopulaREMADA.norm(N,p,si,tau,rcop,tau2par)
rCopulaREMADA.beta(N,p,g,tau,rcop,tau2par) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rCopulaREMADA_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_p">p</code></td>
<td>
<p>Pair <code class="reqn">(\pi_1,\pi_2)</code> of sensitivity/specificity</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_si">si</code></td>
<td>
<p>Pair <code class="reqn">(\sigma_1,\sigma_2)</code> of variability; normal margins</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_g">g</code></td>
<td>
<p>Pair <code class="reqn">(\gamma_1,\gamma_2)</code> of variability; beta margins</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_tau">tau</code></td>
<td>
<p>Kendall's tau value</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_rcop">rcop</code></td>
<td>
<p>function for copula generation</p>
</td></tr>
<tr><td><code id="rCopulaREMADA_+3A_tau2par">tau2par</code></td>
<td>
<p>function for mapping from Kendall's tau to copula parameter </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following simulated components:
</p>
<table>
<tr><td><code>TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code>FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code>FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code>TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842&ndash;3865. doi: <a href="https://doi.org/10.1002/sim.6595">10.1002/sim.6595</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CopulaREMADA">CopulaREMADA</a></code> <code><a href="#topic+rcop">rcop</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid&lt;- meshgrid(gl$n,gl$n)

N=20
tau=-0.5
p=c(0.7,0.9)
g=c(0.2,0.1)
simDat=rCopulaREMADA.beta(N,p,g,tau,rcln270,tau2par.cln270)
TP=simDat$TP
TN=simDat$TN
FP=simDat$FP
FN=simDat$FN
c270est.b=CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)

si=c(2,1)
tau=0.5
simDat=rCopulaREMADA.norm(N,p,si,tau,rcln,tau2par.cln)
TP=simDat$TP
TN=simDat$TN
FP=simDat$FP
FN=simDat$FN
cest.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondcln,tau2par.cln)
</code></pre>

<hr>
<h2 id='rFactorCopulaREMADA'>
Simulation from  1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests</h2><span id='topic+rFactorCopulaREMADA'></span><span id='topic+rFactorCopulaREMADA.norm'></span><span id='topic+rFactorCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>Simulation from  1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rFactorCopulaREMADA.norm(N,p,si,taus,qcond1,tau2par1,qcond2,tau2par2)
rFactorCopulaREMADA.beta(N,p,g,taus,qcond1,tau2par1,qcond2,tau2par2)      </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rFactorCopulaREMADA_+3A_n">N</code></td>
<td>
<p>number of studies</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_p">p</code></td>
<td>
<p>vector  of sensitivities and specificities</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_si">si</code></td>
<td>
<p>vector of variabilities; normal margins</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_g">g</code></td>
<td>
<p>vector of variabilities; beta margins</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_taus">taus</code></td>
<td>
<p>Kendall's tau values</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent sensitivities</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent sensitivities</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent specificities</p>
</td></tr>
<tr><td><code id="rFactorCopulaREMADA_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent specificities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the simulated data in matrices with <code class="reqn">T</code> columns and <code class="reqn">N</code> rows. </p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022) An one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>,  185 (3), 1398&ndash;1423. doi: <a href="https://doi.org/10.1111/rssa.12838">10.1111/rssa.12838</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N=50

qcond1=qcondcln
tau2par1=tau2par.cln
qcond2=qcondcln270
tau2par2=tau2par.cln270

p=c(0.8,0.7,0.8,0.7,0.8,0.7)
mu=log(p/(1-p))
si=rep(1,6)
taus=c(0.6,0.7,0.5,-0.3,-0.4,-0.2)

out=rFactorCopulaREMADA.norm(N,p,si,taus,qcond1,tau2par1,qcond2,tau2par2)
  
TP=out$TP
FN=out$FN
TN=out$TN
FP=out$FP
</code></pre>

<hr>
<h2 id='rmultinomVineCopulaREMADA'>
Simulation from  multinomial quadrivariate (truncated) D-vine copula mixed models for diagnostic test accurracy studies accounting for non-evaluable outcomes
</h2><span id='topic+rmultinomVineCopulaREMADA'></span><span id='topic+rmultinomVineCopulaREMADA.norm'></span><span id='topic+rmultinomVineCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>Simulation from   multinomial quadrivariate (truncated) D-vine copula mixed models for diagnostic test accurracy studies accounting for non-evaluable outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmultinomVineCopulaREMADA.norm(N,p,si,taus,qcond1,
                                    pcond1,tau2par1,qcond2,
                                    pcond2,tau2par2)
rmultinomVineCopulaREMADA.beta(N,p,g,taus,qcond1,
                                    pcond1,tau2par1,qcond2,
                                    pcond2,tau2par2)                                    
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_p">p</code></td>
<td>
<p>Vector <code class="reqn">(\pi_1,\pi_2,\pi_3)</code> of sensitivity/specificity/prevalence</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_si">si</code></td>
<td>
<p>Vector <code class="reqn">(\sigma_1,\sigma_2,\sigma_3)</code> of variability; normal margins</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_g">g</code></td>
<td>
<p>Vector <code class="reqn">(\gamma_1,\gamma_2,\gamma_3)</code> of variability; beta margins</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_taus">taus</code></td>
<td>
<p>Kendall's tau values</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_qcond1">qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (1,2) and (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_pcond1">pcond1</code></td>
<td>
<p>function for the conditional copula cdf at the (1,2) and (3,4) bivariate margin</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_tau2par1">tau2par1</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) and (3,4) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_qcond2">qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_pcond2">pcond2</code></td>
<td>
<p>function for the conditional copula cdf at the (2,3) bivariate margin</p>
</td></tr>
<tr><td><code id="rmultinomVineCopulaREMADA_+3A_tau2par2">tau2par2</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3) bivariate margin to copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simulated data with 6 columns and <code class="reqn">N</code> rows. </p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
<dt>NEP</dt><dd><p>the number of non-evaluable positives</p>
</dd>
<dt>NEN</dt><dd><p>the number of non-evaluable negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2020) A multinomial quadrivariate D-vine copula mixed model for diagnostic studies meta-analysis in the presence of non-evaluable subjects.  <em>Statistical Methods in Medical Research</em>, 29 (10), 2988&ndash;3005. doi: <a href="https://doi.org/10.1177/0962280220913898">10.1177/0962280220913898</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dvinesim">dvinesim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>N=30
p=c(0.898745016,0.766105342,0.059168715,0.109217888)
g=c(0.090270947,0.079469009,0.367463579,0.154976269)
taus=c(	0.82050793,-0.51867629,0.26457961)

qcond1=qcondcln180
pcond1=pcondcln180
tau2par1=tau2par.cln180

qcond2=qcondcln90
pcond2=pcondcln90
tau2par2=tau2par.cln90

out=rmultinomVineCopulaREMADA.beta(N,p,g,taus,qcond1,pcond1,tau2par1,qcond2,pcond2,tau2par2)
  
TP=out[,1]
NEP=out[,2]
FN=out[,3]
TN=out[,4]
NEN=out[,5]
FP=out[,6]
</code></pre>

<hr>
<h2 id='rVineCopulaREMADA'>
Simulation from trivariate vine copula mixed models for diagnostic test accuaracy studies accounting for disease prevalence and non-evaluable results
</h2><span id='topic+rVineCopulaREMADA'></span><span id='topic+rVineCopulaREMADA.norm'></span><span id='topic+rVineCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>Simulation from trivariate vine copula mixed models for diagnostic test accuaracy studies accounting for disease prevalence and non-evaluable results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rVineCopulaREMADA.beta(N,p,g,taus,omega1,omega0,qcondcop12,qcondcop13,
qcondcop23,tau2par12,tau2par13,tau2par23)
rVineCopulaREMADA.norm(N,p,si,taus,omega1,omega0,qcondcop12,qcondcop13,
qcondcop23,tau2par12,tau2par13,tau2par23)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rVineCopulaREMADA_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_p">p</code></td>
<td>
<p>Vector <code class="reqn">(\pi_1,\pi_2,\pi_3)</code> of sensitivity/specificity/prevalence</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_si">si</code></td>
<td>
<p>Vector <code class="reqn">(\sigma_1,\sigma_2,\sigma_3)</code> of variability; normal margins</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_g">g</code></td>
<td>
<p>Vector <code class="reqn">(\gamma_1,\gamma_2,\gamma_3)</code> of variability; beta margins</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_taus">taus</code></td>
<td>
<p>Kendall's tau values</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_omega1">omega1</code></td>
<td>
<p>the probability for non-evaluable positives</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_omega0">omega0</code></td>
<td>
<p>the probability for non-evaluable negatives</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_qcondcop12">qcondcop12</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,2) bivariate margin</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_qcondcop13">qcondcop13</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,3) bivariate margin</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_qcondcop23">qcondcop23</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (2,3|1) bivariate margin</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_tau2par12">tau2par12</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_tau2par13">tau2par13</code></td>
<td>
<p>function for maping Kendall's tau at the (1,3) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="rVineCopulaREMADA_+3A_tau2par23">tau2par23</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3|1) bivariate margin to the conditional copula parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simuated data with 6 columns and <code class="reqn">N</code> rows. </p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
<dt>NEP</dt><dd><p>the number of non-evaluable positives</p>
</dd>
<dt>NEN</dt><dd><p>the number of non-evaluable negatives</p>
</dd>
</dl>



<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2017) A vine copula mixed effect model for trivariate meta-analysis of diagnostic test accuracy studies accounting for disease prevalence. <em>Statistical Methods in Medical Research</em>, <b>26</b>, 2270&ndash;2286. doi: <a href="https://doi.org/10.1177/0962280215596769">10.1177/0962280215596769</a>.
</p>
<p>Nikoloulopoulos, A.K.  (2018) A vine copula mixed  model for trivariate meta-analysis of diagnostic studies accounting for disease prevalence and non-evaluable subjects.  <em>ArXiv e-prints</em>, arXiv:1812.03685. <a href="https://arxiv.org/abs/1812.03685">https://arxiv.org/abs/1812.03685</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rCopulaREMADA">rCopulaREMADA</a></code> <code><a href="#topic+rcop">rcop</a></code>  <code><a href="#topic+cvinesim">cvinesim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p=c(0.8,0.7,0.4)
g=c(0.1,0.1,0.05)
taus=c(-0.5,-0.3,-0.0001)
qcondcop12=qcondcop23=qcondcop13=qcondcln90
tau2par12=tau2par23=tau2par13=tau2par.cln90
# in the absence of non-evaluable results
omega1=0
omega0=0
rVineCopulaREMADA.beta(50,p,g,taus,omega1,omega0,
qcondcop12,qcondcop13,qcondcop23,tau2par12,
tau2par13,tau2par23)
# in the presence of non-evaluable results
omega1=0.1
omega0=0.2
rVineCopulaREMADA.beta(50,p,g,taus,omega1,omega0,
qcondcop12,qcondcop13,qcondcop23,tau2par12,
tau2par13,tau2par23)
</code></pre>

<hr>
<h2 id='SROC'>
Summary receiver operating characteristic   curves for copula mixed effect models for bivariate meta-analysis of diagnostic test accuracy studies
</h2><span id='topic+SROC.norm'></span><span id='topic+SROC.beta'></span><span id='topic+SROC'></span>

<h3>Description</h3>

<p>Summary receiver operating characteristic (SROC) curves are demonstrated for the proposed models through quantile regression techniques and different characterizations of the estimated bivariate random effects distribution  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SROC.norm(param,dcop,qcondcop,tau2par,TP,FN,FP,TN,
          points=TRUE,curves=TRUE,
          NEP=rep(0,length(TP)),NEN=rep(0,length(TP)))
SROC.beta(param,dcop,qcondcop,tau2par,TP,FN,FP,TN,
          points=TRUE,curves=TRUE,
          NEP=rep(0,length(TP)),NEN=rep(0,length(TP)))
SROC(param.beta,param.normal,TP,FN,FP,TN,
          NEP=rep(0,length(TP)),NEN=rep(0,length(TP)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SROC_+3A_param">param</code></td>
<td>
<p>A vector with the sensitivities, specifities, variabilities and Kendall's tau value (the latter only for <code><a href="#topic+SROC.norm">SROC.norm</a></code> and <code><a href="#topic+SROC.beta">SROC.beta</a></code>)</p>
</td></tr>
<tr><td><code id="SROC_+3A_param.beta">param.beta</code></td>
<td>
<p>A vector with the sensitivity, specifity and variabilities of the countermonotonic CopulaREMADA with beta margins</p>
</td></tr>
<tr><td><code id="SROC_+3A_param.normal">param.normal</code></td>
<td>
<p>A vector with the sensitivity, specifity and variabilities of the countermonotonic CopulaREMADA with normal margins</p>
</td></tr>
<tr><td><code id="SROC_+3A_dcop">dcop</code></td>
<td>
<p>function for copula density</p>
</td></tr>
<tr><td><code id="SROC_+3A_qcondcop">qcondcop</code></td>
<td>
<p>function for the inverse of conditional copula cdf</p>
</td></tr>
<tr><td><code id="SROC_+3A_tau2par">tau2par</code></td>
<td>
<p>function for maping Kendall's tau to copula parameter</p>
</td></tr>
<tr><td><code id="SROC_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="SROC_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="SROC_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="SROC_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="SROC_+3A_points">points</code></td>
<td>
<p>logical: print individual studies</p>
</td></tr>
<tr><td><code id="SROC_+3A_curves">curves</code></td>
<td>
<p>logical: print quantile regression curves</p>
</td></tr>
<tr><td><code id="SROC_+3A_nep">NEP</code></td>
<td>
<p>the number of non-evaluable positives in the presence of non-evaluable subjects</p>
</td></tr>
<tr><td><code id="SROC_+3A_nen">NEN</code></td>
<td>
<p>the number of non-evaluable negatives in the presence of non-evaluable subjects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary receiver operating characteristic   curves
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842&ndash;3865. doi: <a href="https://doi.org/10.1002/sim.6595">10.1002/sim.6595</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CopulaREMADA">CopulaREMADA</a></code>
<code><a href="#topic+rCopulaREMADA">rCopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid&lt;- meshgrid(gl$n,gl$n)

data(telomerase) 
attach(telomerase)
est.n=countermonotonicCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid)
est.b=countermonotonicCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid)
SROC(est.b$e,est.n$e,TP,FN,FP,TN)
detach(telomerase)

data(LAG)
attach(LAG)
c180est.b=CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcondcln180,tau2par.cln180)
SROC.beta(c180est.b$e,dcln180,qcondcln180,tau2par.cln180,TP,FN,FP,TN)
detach(LAG)

data(MRI)
attach(MRI)
c270est.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)
SROC.norm(c270est.n$e,dcln270,qcondcln270,tau2par.cln270,TP,FN,FP,TN)
detach(MRI)

data(MK2016)
attach(MK2016)
p=c(0.898745016,0.766105342,0.059168715,0.109217888)
g=c(0.090270947,0.079469009,0.367463579,0.154976269)
taus=c(0.82050793,-0.51867629,0.26457961)
SROC.beta(c(p[1:2],g[1:2],taus[1]),
          dcln180,qcondcln180,tau2par.cln180,
          TP,FN,FP,TN,points=TRUE,curves=TRUE,NEP,NEN)
detach(MK2016)


</code></pre>

<hr>
<h2 id='tau2par'>
Mapping of Kendall's tau and copula parameter 
</h2><span id='topic+tau2par'></span><span id='topic+tau2par.bvn'></span><span id='topic+tau2par.frk'></span><span id='topic+tau2par.cln'></span><span id='topic+tau2par.cln90'></span><span id='topic+tau2par.cln180'></span><span id='topic+tau2par.cln270'></span>

<h3>Description</h3>

<p>Bivariate copulas: mapping of Kendall's tau and copula parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau2par.bvn(tau)
tau2par.frk(tau)
tau2par.cln(tau)
tau2par.cln90(tau)
tau2par.cln180(tau)
tau2par.cln270(tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tau2par_+3A_tau">tau</code></td>
<td>
<p>Kendall's tau for the copula </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For abbreviations of names of copula families (after the dot in function
names), see <code><a href="#topic+dcop">dcop</a></code> help page.
</p>


<h3>Value</h3>

<p>copula parameter
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcop">dcop</a></code>
</p>

<hr>
<h2 id='telomerase'>The telomerase data</h2><span id='topic+telomerase'></span>

<h3>Description</h3>

<p>In Glas et al. (2003) the telomerase marker for the diagnosis of bladder cancer is evaluated using 10 studies. The interest was to define if this non-invasive and cheap marker could replace the standard of cystoscopy or histopathology. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(telomerase)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 4 variables.
</p>

<dl>
<dt>TP</dt><dd><p>the number of true positives</p>
</dd>
<dt>FN</dt><dd><p>the number of false negatives</p>
</dd>
<dt>FP</dt><dd><p>the number of false positives</p>
</dd>
<dt>TN</dt><dd><p>the number of true negatives</p>
</dd>
</dl>


<h3>References</h3>

<p>Glas A.S., Roos D., Deutekom M., Zwinderman A.H., Bossuyt P.M., Kurth K.H. (2003) Tumor markers in the diagnosis of primary bladder cancer. A systematic review. <em>Journal of Urology</em>,  <b>169</b>(6), 1975&ndash;82.
</p>

<hr>
<h2 id='vine.vuong'>
Vuong's test for the comparison of non-nested vine copula mixed models for diagnostic test accuaracy studies
</h2><span id='topic+vine.vuong'></span><span id='topic+vine.vuong.norm'></span><span id='topic+vine.vuong.beta'></span><span id='topic+tvine.vuong.norm'></span><span id='topic+tvine.vuong.beta'></span><span id='topic+tvine2.vuong.norm'></span><span id='topic+tvine2.vuong.beta'></span>

<h3>Description</h3>

<p>Vuong (1989)'s test for the comparison of non-nested vine copula mixed models for diagnostic test accuaracy studies.  
It shows if a vine copula mixed model provides better fit than the standard GLMM. We compute the Vuong's test with Model 1 being the vine copula mixed model with BVN copula and normal margins, i.e., the standard GLMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vine.vuong.beta(qcondcop12,qcondcop13,qcondcop23,
tau2par12,tau2par13,tau2par23,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN)
vine.vuong.norm(qcondcop12,qcondcop13,qcondcop23,
tau2par12,tau2par13,tau2par23,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN) 
tvine.vuong.beta(qcondcop12,qcondcop13,
tau2par12,tau2par13,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN)
tvine.vuong.norm(qcondcop12,qcondcop13,
tau2par12,tau2par13,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN) 
tvine2.vuong.beta(qcondcop12,qcondcop13,
tau2par12,tau2par13,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN)
tvine2.vuong.norm(qcondcop12,qcondcop13,
tau2par12,tau2par13,param1,param2,TP,FN,FP,TN,gl,mgrid,NEP,NEN) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vine.vuong_+3A_qcondcop12">qcondcop12</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,2) bivariate margin for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_qcondcop13">qcondcop13</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,3) bivariate margin for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_qcondcop23">qcondcop23</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (2,3|1) bivariate margin for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_tau2par12">tau2par12</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin to copula parameter for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_tau2par13">tau2par13</code></td>
<td>
<p>function for maping Kendall's tau at the (1,3) bivariate margin to copula parameter for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_tau2par23">tau2par23</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3|1) bivariate margin to the conditional copula parameter for Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_param1">param1</code></td>
<td>
<p>parameters for the Model 1. i.e., the GLMM</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_param2">param2</code></td>
<td>
<p>parameters for the Model 2</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing three-dimensional arrays. For more details see <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_nep">NEP</code></td>
<td>
<p>the number of non-evaluable positives in the presence of non-evaluable subjects</p>
</td></tr>
<tr><td><code id="vine.vuong_+3A_nen">NEN</code></td>
<td>
<p>the number of non-evaluable negatives in the presence of non-evaluable subjects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>the <code class="reqn">p</code>-value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2017) A vine copula mixed effect model for trivariate meta-analysis of diagnostic test accuracy studies accounting for disease prevalence. <em>Statistical Methods in Medical Research</em>, <b>26</b>, 2270&ndash;2286. doi: <a href="https://doi.org/10.1177/0962280215596769">10.1177/0962280215596769</a>.
</p>
<p>Nikoloulopoulos, A.K. (2020) An extended trivariate vine copula mixed model for meta-analysis of diagnostic studies in the presence of non-evaluable outcomes.  <em>The International Journal of Biostatistics</em>, 16(2). doi: <a href="https://doi.org/10.1515/ijb-2019-0107">10.1515/ijb-2019-0107</a>.
</p>
<p>Vuong Q.H. (1989) Likelihood ratio tests for model selection and non-nested hypotheses. <em>Econometrica</em>, <b>57</b>, 307&ndash;333.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CopulaREMADA">CopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid=meshgrid(gl$n,gl$n,gl$n,nargout=3)

data(betaDG)
attach(betaDG)
#nest.n2=VineCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,
#qcondbvn,qcondbvn,qcondbvn,
#tau2par.bvn,tau2par.bvn,tau2par.bvn)
nest.n2.est= #nest.n2$e
c(0.87186926,  0.13696066,  0.70614956,  0.69152133,  
0.51780203,  0.70883558, -0.41354870,0.07701287, -0.12111253)
#c090est.b2=VineCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,
#qcondcln90,qcondcln,qcondcln90,tau2par.cln90,tau2par.cln,tau2par.cln90)
c090est.b2.est= #c090est.b2$e
c(0.85528463,  0.14667571,  0.68321231,  0.04897466,
0.02776290,  0.08561436, -0.34639172, 0.04621924, -0.21627977)
c090vuong.b2=vine.vuong.beta(qcondcln90,qcondcln,qcondcln90,
tau2par.cln90,tau2par.cln,tau2par.cln90,
nest.n2.est,c090est.b2.est,TP,FN,FP,TN,gl,mgrid)
c090vuong.b2
detach(betaDG)
</code></pre>

<hr>
<h2 id='VineCopulaREMADA'>
Maximum likelhood estimation  for (truncated) vine copula mixed models for diagnostic test accurracy studies accounting for disease prevalence and non-evaluable outcomes
</h2><span id='topic+VineCopulaREMADA'></span><span id='topic+VineCopulaREMADA.norm'></span><span id='topic+VineCopulaREMADA.beta'></span><span id='topic+tVineCopulaREMADA'></span><span id='topic+tVineCopulaREMADA.norm'></span><span id='topic+tVineCopulaREMADA.beta'></span>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VineCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,
                               qcondcop12,qcondcop13,qcondcop23,
                               tau2par12,tau2par13,tau2par23,
                               NEP,NEN)
VineCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,
                               qcondcop12,qcondcop13,qcondcop23,
                               tau2par12,tau2par13,tau2par23,
                               NEP,NEN)
tVineCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,
                               qcondcop12,qcondcop13,
                               tau2par12,tau2par13,
                               NEP,NEN)
tVineCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,
                               qcondcop12,qcondcop13,
                               tau2par12,tau2par13,
                               NEP,NEN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VineCopulaREMADA_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing three-dimensional arrays. For more details see <code>meshgrid</code></p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_qcondcop12">qcondcop12</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,2) bivariate margin</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_qcondcop13">qcondcop13</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (1,3) bivariate margin</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_qcondcop23">qcondcop23</code></td>
<td>
<p>function for the inverse of conditional copula cdf at the (2,3|1) bivariate margin</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_tau2par12">tau2par12</code></td>
<td>
<p>function for maping Kendall's tau at the (1,2) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_tau2par13">tau2par13</code></td>
<td>
<p>function for maping Kendall's tau at the (1,3) bivariate margin to copula parameter</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_tau2par23">tau2par23</code></td>
<td>
<p>function for maping Kendall's tau at the (2,3|1) bivariate margin to the conditional copula parameter</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_nep">NEP</code></td>
<td>
<p>the number of non-evaluable positives in the presence of non-evaluable subjects</p>
</td></tr>
<tr><td><code id="VineCopulaREMADA_+3A_nen">NEN</code></td>
<td>
<p>the number of non-evaluable negatives in the presence of non-evaluable subjects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td></tr>
</table>
<p>For more details see  <code><a href="stats.html#topic+nlm">nlm</a></code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2017) A vine copula mixed effect model for trivariate meta-analysis of diagnostic test accuracy studies accounting for disease prevalence. <em>Statistical Methods in Medical Research</em>, <b>26</b>, 2270&ndash;2286. doi: <a href="https://doi.org/10.1177/0962280215596769">10.1177/0962280215596769</a>. 
</p>
<p>Nikoloulopoulos, A.K. (2020) An extended trivariate vine copula mixed model for meta-analysis of diagnostic studies in the presence of non-evaluable outcomes.  <em>The International Journal of Biostatistics</em>, 16(2). doi: <a href="https://doi.org/10.1515/ijb-2019-0107">10.1515/ijb-2019-0107</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rVineCopulaREMADA">rVineCopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid=meshgrid(gl$n,gl$n,gl$n,nargout=3)

data(OGT)
attach(OGT)
out=tVineCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,
qcondbvn,qcondbvn,tau2par.bvn,tau2par.bvn)
detach(OGT)
############################################
# In the precence of non-evaluable results #
data(coronary)
attach(coronary)
out=tVineCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,
qcondbvn,qcondbvn,tau2par.bvn,tau2par.bvn,NEP,NEN)
detach(coronary)
</code></pre>

<hr>
<h2 id='vuong'>
Vuong's test for the comparison of non-nested copula mixed models for diagnostic test accuaracy studies
</h2><span id='topic+vuong'></span><span id='topic+countermonotonicity.vuong'></span><span id='topic+vuong.norm'></span><span id='topic+vuong.beta'></span>

<h3>Description</h3>

<p>Vuong (1989)'s test for the comparison of non-nested copula mixed models for diagnostic test accuaracy studies.  
It shows if a copula mixed model provides better fit than the standard GLMM. We compute the Vuong's test with Model 1 being the copula mixed model with BVN copula and normal margins, i.e., the standard GLMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vuong.norm(qcond,tau2par,param1,param2,TP,FN,FP,TN,gl,mgrid)
vuong.beta(qcond,tau2par,param1,param2,TP,FN,FP,TN,gl,mgrid)
countermonotonicity.vuong(param1,param2,TP,FN,FP,TN,gl,mgrid)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vuong_+3A_qcond">qcond</code></td>
<td>
<p>function for conditional copula cdf for Model 2</p>
</td></tr>
<tr><td><code id="vuong_+3A_tau2par">tau2par</code></td>
<td>
<p>function for maping Kendall's tau to copula parameter for Model 2</p>
</td></tr>
<tr><td><code id="vuong_+3A_param1">param1</code></td>
<td>
<p>parameters for the Model 1. i.e., the GLMM</p>
</td></tr>
<tr><td><code id="vuong_+3A_param2">param2</code></td>
<td>
<p>parameters for the Model 2</p>
</td></tr>
<tr><td><code id="vuong_+3A_tp">TP</code></td>
<td>
<p>the number of true positives</p>
</td></tr>
<tr><td><code id="vuong_+3A_fn">FN</code></td>
<td>
<p>the number of false negatives</p>
</td></tr>
<tr><td><code id="vuong_+3A_fp">FP</code></td>
<td>
<p>the number of false positives</p>
</td></tr>
<tr><td><code id="vuong_+3A_tn">TN</code></td>
<td>
<p>the number of true negatives</p>
</td></tr>
<tr><td><code id="vuong_+3A_gl">gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td></tr>
<tr><td><code id="vuong_+3A_mgrid">mgrid</code></td>
<td>

<p>a list containing two matrices with the rows of the output matrix X are copies of the vector <code>gl$nodes</code>; columns of the output matrix Y are copies of the vector <code>gl$nodes</code>. For more details see <code>meshgrid</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>the test statistic</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>the <code class="reqn">p</code>-value</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842&ndash;3865. doi: <a href="https://doi.org/10.1002/sim.6595">10.1002/sim.6595</a>.
</p>
<p>Vuong Q.H. (1989) Likelihood ratio tests for model selection and non-nested hypotheses. <em>Econometrica</em>, <b>57</b>:307&ndash;333.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CopulaREMADA">CopulaREMADA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid&lt;- meshgrid(gl$n,gl$n)

data(MRI)
attach(MRI)
c270est.b=CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)
nest.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondbvn,tau2par.bvn)
c90est.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondcln90,tau2par.cln90)
vuong.beta(qcondcln270,tau2par.cln270,nest.n$e,c270est.b$e,TP,FN,FP,TN,gl,mgrid)
vuong.norm(qcondcln90,tau2par.cln90,nest.n$e,c90est.n$e,TP,FN,FP,TN,gl,mgrid)
detach(MRI)

data(CT)
attach(CT)
est.n=countermonotonicCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid)
est.b=countermonotonicCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid)
countermonotonicity.vuong(est.n$e,est.b$e,TP,FN,FP,TN,gl,mgrid)
detach(CT)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
