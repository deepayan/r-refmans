<!DOCTYPE html><html><head><title>Help for package WARN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WARN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#WARN-package'>
<p>Weaning Age Reconstruction with Nitrogen isotope analysis</p></a></li>
<li><a href='#lerna'>
<p>Stable isotopic data of the Lerna population</p></a></li>
<li><a href='#plot.warn'>
<p>Plot for posterior weaning parameters</p></a></li>
<li><a href='#plot.warnCI'>
<p>Plot for CI of posterior probabilities of weaning parameters</p></a></li>
<li><a href='#plot.warnProb'>
<p>Plot for probabilities of posterior weaning parameters</p></a></li>
<li><a href='#summary.warn'>
<p>Summaries of posterior weaning parameters</p></a></li>
<li><a href='#summary.warnProb'>
<p>Summaries of probabilities of posterior weaning parameters</p></a></li>
<li><a href='#warn'>
<p>Weaning parameter estimation with approximate Bayesian computation</p></a></li>
<li><a href='#warnCI'>
<p>Calculate credible intervals for posterior probability of the weaning parameters</p></a></li>
<li><a href='#warnOptim'>
<p>Optimize the weaning parameters</p></a></li>
<li><a href='#warnProb'>
<p>Calculate posterior probability of the weaning parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weaning Age Reconstruction with Nitrogen Isotope Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Takumi Tsutaya</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Takumi Tsutaya &lt;tsutayatakumi@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, MASS, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>This estimates precise weaning ages
	for a given skeletal population
	by analyzing the stable nitrogen isotope ratios of them.
	Bone collagen turnover rates estimated anew and
	the approximate Bayesian computation (ABC)
	were adopted in this package.</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-18 08:04:51 UTC; sagi</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-18 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='WARN-package'>
Weaning Age Reconstruction with Nitrogen isotope analysis
</h2><span id='topic+WARN-package'></span><span id='topic+WARN'></span>

<h3>Description</h3>

<p><code>WARN</code> is a package to estimate precise weaning ages for a given skeletal population by analyzing the measured stable nitrogen isotope ratios (d15Ns) of them. Bone collagen turnover rates in non-adults estimated anew and the approximate Bayesian computation (ABC) were adopted in the model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> WARN</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.2-4</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2019-10-18</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Function <code><a href="#topic+warn">warn</a></code> esimates the age at the start and end of weaning, enrichment of d15N through maternal to infant tissue, and d15N value of collagen synthesized entirely from weaning foods with their posterior probabilities. Other geochemical values that change with breastfeeding and weaning can also be analyzed (e.g., d18O, Sr/Ca, and Ba/Ca). The <code>warn</code> performs approximate Bayesian computation (ABC) for a given set of estimated ages and measured d15N of non-adults from the skeletal population. Function <code><a href="#topic+warnCI">warnCI</a></code> calculates credible intervals (CIs) of posterior probabilities under a given class <code>"warn"</code> object and a given threshold of CIs. Function <code><a href="#topic+warnProb">warnProb</a></code> calculate posterior probabilities under a given class <code>"warn"</code> object and given parameter ranges.  This package adopts S3 class. The detail of mathematical models is described in Tsutaya and Yoneda (2013).
</p>


<h3>Author(s)</h3>

<p>Takumi Tsutaya &lt;tsutayatakumi@gmail.com&gt;
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnOptim">warnOptim</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warn, ?warnCI, and ?warnProb for examples.
</code></pre>

<hr>
<h2 id='lerna'>
Stable isotopic data of the Lerna population
</h2><span id='topic+lerna'></span>

<h3>Description</h3>

<p>This data set gives the stable carbons and nitrogen isotope ratios of the 39 human bone samples from Middle Bronze Age (ca. 2100&ndash;1700 BC) Lerna, Greece reported in Triantaphyllou et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lerna</code></pre>


<h3>Format</h3>

<p><code>lerna</code> is a data frame with 39 individuals (rows) and 5 variables (columns) of ID (skeletal number), sex, estimated age at death, and carbon and nitrogen isotope ratios, named <code>id</code>, <code>sex</code>, <code>age</code>, <code>d13C</code>, and <code>d15N</code>, respectively. <code>sex</code> is a factor with levels <code>f</code>, <code>m</code>, and <code>u</code>, which corresponds to famale, male, unknown, respectively. The estimated ages at death were midpoint values. 
</p>


<h3>Details</h3>

<p>See detail for Triantaphyllou et al. (2008).
</p>


<h3>Source</h3>

<p>Triantaphyllou, S., Richards, M. P., Zerner, C., and Voutsaki, S. (2008). Isotopic dietary reconstruction of humans from Middle Bronze Age Lerna, Argolid, Greece. <em>J. Archaeol. Sci.</em> <b>35</b>, 3028&ndash;3034.
</p>

<hr>
<h2 id='plot.warn'>
Plot for posterior weaning parameters
</h2><span id='topic+plot.warn'></span>

<h3>Description</h3>

<p><code>plot.warn</code> is a plotting utile for quick visualization of the result of weaning age reconstruction from an object of class <code>"warn"</code>. The measured and modeled bone collagen nitrogen isotope ratios (d15Ns) are plotted ageinst estimated ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'warn'
plot(x, hline.female = TRUE, hline.adult = FALSE, 
  adult.mean = NA, adult.sd = 0,
  is.legend = TRUE, is.female = TRUE, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.warn_+3A_x">x</code></td>
<td>
<p>an object of class <code>"warn"</code> generated by <code><a href="#topic+warn">warn</a></code>.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_hline.female">hline.female</code>, <code id="plot.warn_+3A_hline.adult">hline.adult</code></td>
<td>
<p>logical; if <code>TRUE</code>, horizontal dotted lines indicating one standard deviation ranges of adult females and all adults are plotted on the figure; the default is <code>TRUE</code> for female and <code>FALSE</code> for adult.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_adult.mean">adult.mean</code></td>
<td>
<p>the mean d15N of all adults, an optional single value.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_adult.sd">adult.sd</code></td>
<td>
<p>the one standard deviation of all adult d15N, an optional single value. Utilized later in <code><a href="#topic+plot.warn">plot.warn</a></code>.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_is.legend">is.legend</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), legend is plotted on the figure.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_is.female">is.female</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), female mean d15N is plotted on the figure.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), a figure is plotted, otherwise a list of d15N changes in modeled bone and modeled diet is returned.</p>
</td></tr>
<tr><td><code id="plot.warn_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following three results on d15N are plotted against age, the original measured ratios of non-adult bone collagen (Measured d15N), modeled ratios of non-adult bone collagen (Modeled d15N), and modeled ratios of collagen synthesized entirely from consumed foods in the last half year (Modeld diet). These results are calculated in <code><a href="#topic+warn">warn</a></code>. Mean d15Ns of adult females and all adults can also be plotted.
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+summary.warn">summary.warn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warn for examples.
</code></pre>

<hr>
<h2 id='plot.warnCI'>
Plot for CI of posterior probabilities of weaning parameters
</h2><span id='topic+plot.warnCI'></span>

<h3>Description</h3>

<p><code>plot.warnCI</code> is a plotting utile for quick visualization of credible interval (CI) of posterior probabilities of the weaning parameters from an object of class <code>"warnCI"</code>. Results of kernel density estimation for the posteriors are plotted as a form of <code><a href="graphics.html#topic+contour">contour</a></code> or one-dimensional distribution with CIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'warnCI'
plot(x, weaning.par = "age", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.warnCI_+3A_x">x</code></td>
<td>
<p>an object of class <code>"warnCI"</code> generated by <code><a href="#topic+warnCI">warnCI</a></code>.</p>
</td></tr>
<tr><td><code id="plot.warnCI_+3A_weaning.par">weaning.par</code></td>
<td>
<p>character for the intended weanig parameter. The allowed values are <code>"age"</code> (the default), <code>"enrich"</code>, and <code>"wnfood"</code>.</p>
</td></tr>
<tr><td><code id="plot.warnCI_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+plot.warnProb">plot.warnProb</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values on the contour lines indicate relative probabilities based on that of the maximum density estimator.
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+plot.warnProb">plot.warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warnCI for examples.
</code></pre>

<hr>
<h2 id='plot.warnProb'>
Plot for probabilities of posterior weaning parameters
</h2><span id='topic+plot.warnProb'></span>

<h3>Description</h3>

<p><code>plot.warnProb</code> is a plotting utile for quick visualization of the posterior weaning parameters from an object of class <code>"warnProb"</code>. Results of kernel density estimation for the posteriors are plotted as a form of <code><a href="graphics.html#topic+contour">contour</a></code> with designated parameter ranges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'warnProb'
plot(x, is.legend = TRUE, is.contour = TRUE,
  is.image = FALSE, is.prior = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.warnProb_+3A_x">x</code></td>
<td>
<p>an object of class <code>"warnProb"</code> generated by <code><a href="#topic+warnProb">warnProb</a></code>.</p>
</td></tr>
<tr><td><code id="plot.warnProb_+3A_is.legend">is.legend</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), legend is plotted on the figure.</p>
</td></tr>
<tr><td><code id="plot.warnProb_+3A_is.contour">is.contour</code></td>
<td>
<p>logical; if <code>TRUE</code> (the default), contour lines corresponding to the probabilirties are plotted with <code><a href="graphics.html#topic+contour">contour</a></code>. Only used if the intended weanig parameter is weaning ages (i.e., <code>weaning.par = "age"</code> in <code><a href="#topic+warnProb">warnProb</a></code>).</p>
</td></tr>
<tr><td><code id="plot.warnProb_+3A_is.image">is.image</code></td>
<td>
<p>logical; if <code>TRUE</code>, grid of gray-scale rectangles with color strength corresponding to the probabilirties is plotted with <code><a href="graphics.html#topic+image">image</a></code>. The default is <code>FALSE</code>, and only used if the intended weanig parameter is weaning ages (i.e., <code>weaning.par = "age"</code> in <code><a href="#topic+warnProb">warnProb</a></code>).</p>
</td></tr>
<tr><td><code id="plot.warnProb_+3A_is.prior">is.prior</code></td>
<td>
<p>logical; if <code>TRUE</code>, prior density of the paramter is also plotted with dotted line. The default is <code>FALSE</code>, and only used if the intended weanig parameter is enrichment or weaning food (i.e., <code>weaning.par = "enrich"</code> or <code>"wnfood"</code> in <code><a href="#topic+warnProb">warnProb</a></code>).</p>
</td></tr>
<tr><td><code id="plot.warnProb_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values on the contour lines indicate relative probabilities based on that of the maximum density estimator.
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+summary.warnProb">summary.warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warnProb for examples.
</code></pre>

<hr>
<h2 id='summary.warn'>
Summaries of posterior weaning parameters
</h2><span id='topic+summary.warn'></span>

<h3>Description</h3>

<p><code>summary.warn</code> calculates simple summaries of posterior samples for the four weaning parameters, which is the maximum density estimators and its marginal probabilities, a joint probability for the combination of the maximum density weaning ages, mean squared distance between the measured and modeled nitrogen isotope ratio (d15N), number of non-adult individuals used, and number of particles used in sequential Monte Carlo (SMC) sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'warn'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.warn_+3A_object">object</code></td>
<td>
<p>an object of class <code>"warn"</code> generated by <code><a href="#topic+warn">warn</a></code>.</p>
</td></tr>
<tr><td><code id="summary.warn_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.warn</code> returns a list containing following components and those succeeded from <code>"warn"</code>:<br />
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>mde</code></td>
<td>
<p>the maximum density estimators and the marginal probabilities.</p>
</td></tr>
<tr><td><code>prob.2d.age</code></td>
<td>
<p>the joint probability for the combination of the maximum density weaning ages.</p>
</td></tr>
<tr><td><code>dist.mde</code></td>
<td>
<p>the mean squared distance between the measured and modeled d15Ns.</p>
</td></tr>
<tr><td><code>individual</code></td>
<td>
<p>the number of non-adult individuals used.</p>
</td></tr>
<tr><td><code>particle</code></td>
<td>
<p>the number of particles used in SMC sampling.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+plot.warn">plot.warn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warn for examples.
</code></pre>

<hr>
<h2 id='summary.warnProb'>
Summaries of probabilities of posterior weaning parameters
</h2><span id='topic+summary.warnProb'></span>

<h3>Description</h3>

<p><code>summary.warnProb</code> calculates simple summaries of probabilities of posterior samples for the four weaning parameters, which is the intended weaning paramter, designated parameter range, and calculate posterior probability of the weaning parameter that ranges between the range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'warnProb'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.warnProb_+3A_object">object</code></td>
<td>
<p>an object of class <code>"warnProb"</code> generated by <code><a href="#topic+warnProb">warnProb</a></code>.</p>
</td></tr>
<tr><td><code id="summary.warnProb_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.warnProb</code> returns a list containing following components and those succeeded from <code>"warnProb"</code>:<br />
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>a vector giving the range of the intended weanig parameter.</p>
</td></tr>
<tr><td><code>probability</code></td>
<td>
<p>posterior probability of parameter in the designated range.</p>
</td></tr>
<tr><td><code>weaning.par</code></td>
<td>
<p>a character indicating the weaning parameter used.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>,  <code><a href="#topic+plot.warnProb">plot.warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See ?warnProb for examples.
</code></pre>

<hr>
<h2 id='warn'>
Weaning parameter estimation with approximate Bayesian computation
</h2><span id='topic+warn'></span><span id='topic+warn.default'></span>

<h3>Description</h3>

<p><code>warn</code> estimates weaning parameters (i.e., weaning ages, enrichment factor, and nitrogen isotope ratio (d15N) of weaning food derived collagen) for a given skeletal population under the flamework of approximate Bayesian computation (ABC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
warn(age, d15N, female.mean, female.sd = NA,
  fraction = "collagen",
  prior = c(0.5, 3, 3, 3, 1.9, 0.9, female.mean, 3, 0, 1),
  num.particle = 10000, form = "parabolic",
  tolerances = c(2.0, 1.0, 0.5, 0.25, 0.125, 0.0625, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warn_+3A_age">age</code></td>
<td>
<p>a vector of estimated ages in year of the non-adult skeletons. Ages greater than 10 years are not allowed.</p>
</td></tr>
<tr><td><code id="warn_+3A_d15n">d15N</code></td>
<td>
<p>a vector of bone collagen d15N of non-adult skeletons. Other geochemical values (e.g., d18O, Sr/Ca, and Ba/Ca) can be used with this argument.</p>
</td></tr>
<tr><td><code id="warn_+3A_female.mean">female.mean</code></td>
<td>
<p>the mean d15N of the adult females, single value.</p>
</td></tr>
<tr><td><code id="warn_+3A_female.sd">female.sd</code></td>
<td>
<p>the one standard deviation of adult female d15Ns, an optional single value. Utilized later in <code><a href="#topic+plot.warn">plot.warn</a></code>.</p>
</td></tr>
<tr><td><code id="warn_+3A_fraction">fraction</code></td>
<td>
<p>fraction of bone analyzed. The allowed values are <code>collagen</code> and <code>mineral</code>. The turnover rate specific to each fraction will be used.</p>
</td></tr>
<tr><td><code id="warn_+3A_prior">prior</code></td>
<td>
<p>a vector of hyper parameter values for prior distributions of the weaning parameters and the individual error term. Mean and SD for t1 (age at the start of weaning), t2 (age at the end of weaning), enrichment of d15N, d15N of weaning food derived collagen, and sigma used in ABC-SMC, in sequence. The values are succeeded to <code>mean</code> and <code>sd</code> arguments of <code><a href="stats.html#topic+rnorm">rnorm</a></code>. The default is <code>c(0.5, 3, 3, 3, 1.9, 0.9, female.mean, 3, 0, 1)</code>.</p>
</td></tr>
<tr><td><code id="warn_+3A_num.particle">num.particle</code></td>
<td>
<p>number of particles in sequential Monte Carlo (SMC) sampling; defaults to 10000.</p>
</td></tr>
<tr><td><code id="warn_+3A_form">form</code></td>
<td>
<p>form of the model curve for the weaning process. The allowed values are <code>"linear"</code>, <code>"parabolic"</code> (the default), <code>"reverse"</code>, and <code>"sigmoid"</code>.</p>
</td></tr>
<tr><td><code id="warn_+3A_tolerances">tolerances</code></td>
<td>
<p>a vector of decreasing torelances used in the SMC sampling. The default is <code>c(2.0, 1.0, 0.5, 0.25, 0.125, 0.0625, 0)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>warn</code> esimates the age at the start and end of weaning, enrichment of d15N through maternal to infant tissue, and d15N value of collagen synthesized entirely from weaning foods with their posterior probabilities. Other geochemical values that change with breastfeeding and weaning can also be analyzed (e.g., d18O, Sr/Ca, and Ba/Ca). Probabilities are estimated by SMC with partial rejection control, and the algorithm was derived from Sisson et al. (2007, 2009). The posterior probabilities are obtained as a result of kernel density estimation, a product of <code><a href="MASS.html#topic+kde2d">kde2d</a></code> in <span class="pkg">MASS</span> package for weaning ages, and <code><a href="stats.html#topic+density">density</a></code> for enrichment and weaning foods. The model used to describe the change in d15N during weaning contains a new estimate of bone collagen turnover rates in non-adults, and is shown in Tsutaya and Yoneda (2013).
</p>


<h3>Value</h3>

<p><code>warn</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"warn"</code>.<br />
The function <code><a href="base.html#topic+summary">summary</a></code> and <code><a href="base.html#topic+plot">plot</a></code> are used to obtain and indicate a summary and figure of the results, respectively.<br />
An object of class <code>"warn"</code> is a list containing at least the following components:<br />
</p>
<table>
<tr><td><code>mde</code></td>
<td>
<p>the maximum density estimators and their marginal probabilities for the weaning parameters.</p>
</td></tr>
<tr><td><code>prob.2d.age</code></td>
<td>
<p>the joint probability for combination of the maximum density weaning ages.</p>
</td></tr>
<tr><td><code>dist.mde</code></td>
<td>
<p>the mean squared distance between the measured and modeled d15Ns of non-adults.</p>
</td></tr>
<tr><td><code>kde.age</code></td>
<td>
<p>two-dimensional kernel density estimates of the weaning ages. A product of <code><a href="MASS.html#topic+kde2d">kde2d</a></code> in <span class="pkg">MASS</span> package.</p>
</td></tr>
<tr><td><code>kde.enrich</code></td>
<td>
<p>kernel density estimates of the enrichment factor from mother to infant. A product of <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>
<tr><td><code>kde.wnfood</code></td>
<td>
<p>kernel density estimates of the d15N of collagen synthesized entirely form weaning foods. A product of <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a matrix of final particles in SMC sampling.</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>the non-adult ages used.</p>
</td></tr>
<tr><td><code>d15N</code></td>
<td>
<p>the measuerd d15Ns of non-adult bone collagen used.</p>
</td></tr>
<tr><td><code>female.mean</code></td>
<td>
<p>the mean d15N of adult females used.</p>
</td></tr>
<tr><td><code>female.sd</code></td>
<td>
<p>the one standard deviation of adult female d15Ns used.</p>
</td></tr>
<tr><td><code>fraction</code></td>
<td>
<p>the fraction of bone analyzed.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>a vector of the hyper parameter values for the prior distributions used.</p>
</td></tr>
<tr><td><code>particle</code></td>
<td>
<p>the number of particles used.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>the form of the model curve used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr></table>
<p><br />
The band-width of kernel density estimation (i.e., <code>h</code> in <code><a href="MASS.html#topic+kde2d">kde2d</a></code> and <code>bw</code> in <code><a href="stats.html#topic+density">density</a></code>) is selected by SJ method, <code><a href="MASS.html#topic+width.SJ">width.SJ</a></code> in <span class="pkg">MASS</span>, with &quot;direct plug-in&quot;.
</p>


<h3>Author(s)</h3>

<p>Takumi Tsutaya developed this model.
</p>


<h3>References</h3>

<p>Sisson, S. A., Fan, Y., and Tanaka, M. M. (2007, 2009). Sequential Monte Carlo without likelihoods. <em>Proc. Natl. Acad. Sci.</em> <b>104</b>, 1760&ndash;1765.<br />
<br />
Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+summary.warn">summary.warn</a></code>, <code><a href="#topic+plot.warn">plot.warn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from the Lerna population.
nonadult &lt;- subset(lerna, lerna$age &lt;= 10)
adult &lt;- subset(lerna, lerna$age &gt; 17)
female &lt;- subset(adult, adult$sex == "f")

## Calculate maximum density estimators using ABC.
warn.lerna &lt;- warn(
  age = nonadult$age,
  d15N = nonadult$d15N,
  female.mean = mean(female$d15N),
  num.particle = 500,
  female.sd = sd(female$d15N),
  prior = c(0.2, 0.2, 1.6, 0.2, 2.5, 0.2, 8.1, 0.2, 0, 0.7),
  tolerances = c(1.5, 0.7))

## Indicate summary.
summary(warn.lerna)

## Plot.
plot(warn.lerna)

## Plot with adult mean.
plot(warn.lerna,
  hline.adult = TRUE,
  adult.mean = mean(adult$d15N),
  adult.sd = sd(adult$d15N),
  is.female = FALSE)
</code></pre>

<hr>
<h2 id='warnCI'>
Calculate credible intervals for posterior probability of the weaning parameters
</h2><span id='topic+warnCI'></span><span id='topic+warnCI.default'></span>

<h3>Description</h3>

<p><code>warnCI</code> calculate credible intervals (CIs) of posterior probabilities under a given class <code>"warn"</code> object and a given threshold of CIs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
warnCI(object, threshold = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warnCI_+3A_object">object</code></td>
<td>
<p>an object of class <code>"warn"</code>.</p>
</td></tr>
<tr><td><code id="warnCI_+3A_threshold">threshold</code></td>
<td>
<p>numeric scalar or vector giving the threshold of CI for posterior probabilities of weaning ages, nitrogen isotope ratios (d15Ns) of enrichment factor, and d15Ns of collagen derived entirely from weaning foods. Minimum range with over (<code>threshold * 100</code>)% of summed posterior probability is calculated. If scalar is given, value is repeated. Values between 0 and 1 must be given.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>warnCI</code> calculates minimum ranges with over (<code>threshold * 100</code>)% of summed posterior probability of the weaning parameters. Posterior probabilities are represented as the product of kernel density estimation performed in <code><a href="#topic+warn">warn</a></code>. CIs of weaning ages are obtained from two-dimensional probability distribution, and those of d15Ns of enrichment factor and collagen derived entirely from weaning foods are from one-dimensional. Posterior probability distributions with multiple notable peaks are not supported by <code>warnCI</code>.
</p>


<h3>Value</h3>

<p><code>warnCI</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"warnCI"</code> which is a subclass of <code>"warn"</code>.<br />
The function <code><a href="base.html#topic+plot">plot</a></code> is used to indicate figures of the results.<br />
An object of class <code>"warnCI"</code> has following list components in addition to those succeeded from <code>"warn"</code>:<br />
</p>
<table>
<tr><td><code>ci.age</code></td>
<td>
<p>a list containing the CIs for the combination of t1 and t2, and its summed posterior probability.</p>
</td></tr>
<tr><td><code>ci.enrich</code></td>
<td>
<p>a list containing the CI for the d15N-enrichment from mother to infant, and its summed posterior probability.</p>
</td></tr>
<tr><td><code>ci.wnfood</code></td>
<td>
<p>a list containing the CI for the d15N value of collagen derived entirelly from weaning foods, and its summed posterior probability.</p>
</td></tr>
<tr><td><code>ci.threshold</code></td>
<td>
<p>a vector showing the thresholds used to calculate the CIs.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takumi Tsutaya developed this model.
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>, <code><a href="#topic+plot.warnCI">plot.warnCI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from the Lerna population.
nonadult &lt;- subset(lerna, lerna$age &lt;= 10)
adult &lt;- subset(lerna, lerna$age &gt; 17)
female &lt;- subset(adult, adult$sex == "f")

## Calculate maximum density estimators using ABC.
warn.lerna &lt;- warn(
  age = nonadult$age,
  d15N = nonadult$d15N,
  female.mean = mean(female$d15N),
  num.particle = 500,
  female.sd = sd(female$d15N),
  prior = c(0.2, 0.2, 1.6, 0.2, 2.5, 0.2, 8.1, 0.2, 0, 0.7),
  tolerances = c(1.5, 0.7))

## Calculate over (&gt;=) 50% CIs.
warn.lerna.50ci &lt;- warnCI(warn.lerna, 0.50)

## Indicate result.
warn.lerna.50ci

## Plot.
plot(warn.lerna.50ci, "age")
plot(warn.lerna.50ci, "enrich")

</code></pre>

<hr>
<h2 id='warnOptim'>
Optimize the weaning parameters
</h2><span id='topic+warnOptim'></span><span id='topic+warnOptim.default'></span>

<h3>Description</h3>

<p><code>warnOptim</code> optimzes the weaning parameters for a given skeletal population. This function can be preliminaly used in order to set efficient priors of the weaning parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
warnOptim(age, d15N, female.mean,
  fraction = "collagen",
  par.initial = c(0.5, 3, 1.9, female.mean), 
  form = "parabolic", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warnOptim_+3A_age">age</code></td>
<td>
<p>a vector of estimated ages of non-adult skeletons. Ages greater than 10 years are not allowed.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_d15n">d15N</code></td>
<td>
<p>a vector of bone collagen nitrogen isotope ratio (d15N) of non-adult skeletons. Other geochemical values (e.g., d18O, Sr/Ca, and Ba/Ca) can be used with this argument.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_fraction">fraction</code></td>
<td>
<p>fraction of bone analyzed. The allowed values are <code>collagen</code> and <code>mineral</code>.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_par.initial">par.initial</code></td>
<td>
<p>a vector of the initial parameter values for optimizetion: t1, t2, enrichment, and weaning food, in sequence. The values are succeeded to the <code>par</code> arguments of <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_female.mean">female.mean</code></td>
<td>
<p>the mean d15N (or other geochemical value) of adult females, single value.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_form">form</code></td>
<td>
<p>form of the model curve for the weaning process. The allowed values are <code>"linear"</code>, <code>"parabolic"</code> (the default), <code>"reverse"</code>, and <code>"sigmoid"</code>.</p>
</td></tr>
<tr><td><code id="warnOptim_+3A_...">...</code></td>
<td>
<p>additional argunemts passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>warnOptim</code> calculates the weaning parameters (i.e., weaning ages, enrichment factor, and d15N of bone collagen synthesized entirely from the weaning foods), which minimize the mean squared distance between the measured and modeled d15Ns using <code><a href="stats.html#topic+optim">optim</a></code>. Result of this function is just a rough indication and initial parameter dependent, and can be preliminaly used in order to set efficient priors of the weaning parameters.
</p>


<h3>Value</h3>

<p><code>warnOptim</code> directly returns a result list of <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+warnProb">warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from the Lerna population.
nonadult &lt;- subset(lerna, lerna$age &lt;= 10)
adult &lt;- subset(lerna, lerna$age &gt; 17)
female &lt;- subset(adult, adult$sex == "f")

## Simple optimization without probability.
(opt.lerna &lt;- warnOptim(
  age = nonadult$age,
  d15N = nonadult$d15N,
  female.mean = mean(female$d15N),
  control = list(maxit = 10000, ndeps = 1e-2, reltol = 1e-7)))
</code></pre>

<hr>
<h2 id='warnProb'>
Calculate posterior probability of the weaning parameters
</h2><span id='topic+warnProb'></span><span id='topic+warnProb.default'></span>

<h3>Description</h3>

<p><code>warnProb</code> calculate posterior probabilities under a given class <code>"warn"</code> object and a given parameter range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
warnProb(object, weaning.par = "age", range.x, range.y = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warnProb_+3A_object">object</code></td>
<td>
<p>an object of class <code>"warn"</code>.</p>
</td></tr>
<tr><td><code id="warnProb_+3A_weaning.par">weaning.par</code></td>
<td>
<p>character for the intended weanig parameter. The allowed values are <code>"age"</code> (the default), <code>"enrich"</code>, and <code>"wnfood"</code>.</p>
</td></tr>
<tr><td><code id="warnProb_+3A_range.x">range.x</code>, <code id="warnProb_+3A_range.y">range.y</code></td>
<td>
<p>numeric vectors of length 2, giving the range of the intended weanig parameters. For example, <code>range.x</code> corresponds to the age at the start of weaning if <code>weaning.par = "age"</code>. <code>range.y</code> is used only if <code>weaning.par = "age"</code>, and corresponds to the age at the end of weaning. Fractional point lower than e-002 is rounded.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>warnProb</code> calculates posterior probability of the weaning parameter that ranges between designated range. Parameter distribution is represented as the product of kernel density estimation performed in <code><a href="#topic+warn">warn</a></code>. Weaning ages are estimated from two-dimensional probability distribution, and nitrogen isotope ratios (d15Ns) of enrichment factor and weaning food derived collagen are from one-dimensional.
</p>


<h3>Value</h3>

<p><code>warnProb</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"warnProb"</code> which is a subclass of <code>"warn"</code>.<br />
The functions <code><a href="base.html#topic+summary">summary</a></code> and <code><a href="base.html#topic+plot">plot</a></code> are used to obtain and indicate a summary and figure of the results, respectively.<br />
An object of class <code>"warnProb"</code> at least has following list components in addition to those succeeded from <code>"warn"</code>:<br />
</p>
<table>
<tr><td><code>probability</code></td>
<td>
<p>posterior probability of parameter that range between the designated range.</p>
</td></tr>
<tr><td><code>range</code></td>
<td>
<p>a vector giving the range of the intended weanig parameter.</p>
</td></tr>
<tr><td><code>weaning.par</code></td>
<td>
<p>a character indicating the weaning parameter used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takumi Tsutaya developed this model.
</p>


<h3>References</h3>

<p>Tsutaya, T., and Yoneda, M. (2013). Quantitative reconstruction of weaning ages in archaeological human populations using bone collagen nitrogen isotope ratios and approximate Bayesian computation. <em>PLoS ONE</em> <b>8</b>, e72327.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WARN">WARN</a></code>, <code><a href="#topic+warn">warn</a></code>, <code><a href="#topic+warnCI">warnCI</a></code>, <code><a href="#topic+summary.warnProb">summary.warnProb</a></code>, <code><a href="#topic+plot.warnProb">plot.warnProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from the Lerna population.
nonadult &lt;- subset(lerna, lerna$age &lt;= 10)
adult &lt;- subset(lerna, lerna$age &gt; 17)
female &lt;- subset(adult, adult$sex == "f")

## Calculate maximum density estimators using ABC.
warn.lerna &lt;- warn(
  age = nonadult$age,
  d15N = nonadult$d15N,
  female.mean = mean(female$d15N),
  num.particle = 500,
  female.sd = sd(female$d15N),
  prior = c(0.2, 0.2, 1.6, 0.2, 2.5, 0.2, 8.1, 0.2, 0, 0.7),
  tolerances = c(1.5, 0.7))

## Calculate probabilities for a given parameter range.
warnprob.age &lt;- warnProb(warn.lerna, "age", c(0.0, 1.1), c(0.8, 2.3))
warnprob.enrich &lt;- warnProb(warn.lerna, "enrich", c(1.5, 3.5))
warnprob.wnfood &lt;- warnProb(warn.lerna, "wnfood", c(7.3, 8.8))

## Indicate summary.
summary(warnprob.age)
summary(warnprob.enrich)

## Plot.
plot(warnprob.age)
plot(warnprob.wnfood)

## Plot with image.
plot(warnprob.age, is.image = TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
