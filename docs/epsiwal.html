<!DOCTYPE html><html lang="en"><head><title>Help for package epsiwal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epsiwal}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#epsiwal'><p>Exact Post Selection Inference with Applications to the Lasso.</p></a></li>
<li><a href='#ci_connorm'><p>ci_connorm .</p></a></li>
<li><a href='#epsiwal-NEWS'><p>News for package 'epsiwal':</p></a></li>
<li><a href='#pconnorm'><p>pconnorm .</p></a></li>
<li><a href='#ptruncnorm'><p>ptruncnorm .</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-06-28</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Exact Post Selection Inference with Applications to the Lasso</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shabbychef/epsiwal/issues">https://github.com/shabbychef/epsiwal/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the conditional estimation procedure of
  Lee, Sun, Sun and Taylor (2016) &lt;<a href="https://doi.org/10.1214%2F15-AOS1371">doi:10.1214/15-AOS1371</a>&gt;.
  This procedure allows hypothesis testing on the mean of
  a normal random vector subject to linear constraints.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shabbychef/epsiwal">https://github.com/shabbychef/epsiwal</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'ci_connorm.r' 'epsiwal.r' 'pconnorm.r' 'ptruncnorm.r'
'utils.r'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-29 04:39:33 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven E. Pav <a href="https://orcid.org/0000-0002-4197-6195"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven E. Pav &lt;shabbychef@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-02 12:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='epsiwal'>Exact Post Selection Inference with Applications to the Lasso.</h2><span id='topic+epsiwal'></span><span id='topic+epsiwal-package'></span>

<h3>Description</h3>

<p>Exact Post Selection Inference with Applications to the Lasso.
</p>


<h3>Details</h3>

<p>This simple package supports the simple procedure outlined in 
Lee <em>et al.</em> where one observes a normal random variable,
then performs inference conditional on some linear inequalities.
</p>
<p>Suppose <code class="reqn">y</code> is multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>. Conditional on <code class="reqn">Ay \le b</code>,
one can perform inference on <code class="reqn">\eta^{\top}\mu</code> by
transforming <code class="reqn">y</code> to a truncated normal. 
Similarly one can invert this procedure and find confidence intervals on
<code class="reqn">\eta^{\top}\mu</code>.
</p>


<h3>Legal Mumbo Jumbo</h3>

<p>epsiwal is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.
</p>


<h3>Note</h3>

<p>This package is maintained as a hobby.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, J. D., Sun, D. L., Sun, Y. and Taylor, J. E. &quot;Exact post-selection inference, 
with application to the Lasso.&quot; Ann. Statist. 44, no. 3 (2016): 907-927.
doi:10.1214/15-AOS1371. <a href="https://arxiv.org/abs/1311.6238">https://arxiv.org/abs/1311.6238</a>
</p>
<p>Pav, S. E. &quot;Conditional inference on the asset with maximum Sharpe ratio.&quot;
Arxiv e-print (2019). <a href="http://arxiv.org/abs/1906.00573">http://arxiv.org/abs/1906.00573</a>
</p>

<hr>
<h2 id='ci_connorm'>ci_connorm .</h2><span id='topic+ci_connorm'></span>

<h3>Description</h3>

<p>Confidence intervals on normal mean, subject to linear constraints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci_connorm(y, A, b, eta, Sigma = NULL, p = c(level/2, 1 - (level/2)),
  level = 0.05, Sigma_eta = Sigma %*% eta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ci_connorm_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code> vector, assumed multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_a">A</code></td>
<td>
<p>an <code class="reqn">k \times n</code> matrix of constraints.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_b">b</code></td>
<td>
<p>a <code class="reqn">k</code> vector of inequality limits.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_eta">eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the test contrast, <code class="reqn">\eta</code>.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_sigma">Sigma</code></td>
<td>
<p>an <code class="reqn">n \times n</code> matrix of the population covariance, <code class="reqn">\Sigma</code>.
Not needed if <code>Sigma_eta</code> is given.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_p">p</code></td>
<td>
<p>a vector of probabilities for which we return
equivalent <code class="reqn">\eta^{\top}\mu</code>.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_level">level</code></td>
<td>
<p>if <code>p</code> is not given, we set it by default to
<code>c(level/2,1-level/2)</code>.</p>
</td></tr>
<tr><td><code id="ci_connorm_+3A_sigma_eta">Sigma_eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of <code class="reqn">\Sigma \eta</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inverts the constrained normal inference procedure described
by Lee <em>et al.</em>
</p>
<p>Let <code class="reqn">y</code> be multivariate normal with unknown mean <code class="reqn">\mu</code>
and known covariance <code class="reqn">\Sigma</code>. Conditional on <code class="reqn">Ay \le b</code>
for conformable matrix <code class="reqn">A</code> and vector <code class="reqn">b</code>, and given
constrast vector <code class="reqn">eta</code> and level <code class="reqn">p</code>, we compute
<code class="reqn">\eta^{\top}\mu</code> such that the cumulative distribution of
<code class="reqn">\eta^{\top}y</code> equals <code class="reqn">p</code>.
</p>


<h3>Value</h3>

<p>The values of <code class="reqn">\eta^{\top}\mu</code> which have the corresponding
CDF.
</p>


<h3>Note</h3>

<p>An error will be thrown if we do not observe <code class="reqn">A y \le b</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, J. D., Sun, D. L., Sun, Y. and Taylor, J. E. &quot;Exact post-selection inference, 
with application to the Lasso.&quot; Ann. Statist. 44, no. 3 (2016): 907-927.
doi:10.1214/15-AOS1371. <a href="https://arxiv.org/abs/1311.6238">https://arxiv.org/abs/1311.6238</a>
</p>


<h3>See Also</h3>

<p>the CDF function, <code>pconnorm</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 10
y &lt;- rnorm(n)
A &lt;- matrix(rnorm(n*(n-3)),ncol=n)
b &lt;- A%*%y + runif(nrow(A))
Sigma &lt;- diag(runif(n))
mu &lt;- rnorm(n)
eta &lt;- rnorm(n)

pval &lt;- pconnorm(y=y,A=A,b=b,eta=eta,mu=mu,Sigma=Sigma)
cival &lt;- ci_connorm(y=y,A=A,b=b,eta=eta,Sigma=Sigma,p=pval)
stopifnot(abs(cival - sum(eta*mu)) &lt; 1e-4)

</code></pre>

<hr>
<h2 id='epsiwal-NEWS'>News for package 'epsiwal':</h2><span id='topic+epsiwal-NEWS'></span>

<h3>Description</h3>

<p>News for package &lsquo;epsiwal&rsquo;
</p>




<h3><a href="https://cran.r-project.org/package=epsiwal"><span class="pkg">epsiwal</span></a> Initial Version 0.1.0 (2019-06-28) </h3>


<ul>
<li><p> first CRAN release.
</p>
</li></ul>


<hr>
<h2 id='pconnorm'>pconnorm .</h2><span id='topic+pconnorm'></span>

<h3>Description</h3>

<p>CDF of the conditional normal variate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pconnorm(y, A, b, eta, mu = NULL, Sigma = NULL, Sigma_eta = Sigma
  %*% eta, eta_mu = as.numeric(t(eta) %*% mu), lower.tail = TRUE,
  log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pconnorm_+3A_y">y</code></td>
<td>
<p>an <code class="reqn">n</code> vector, assumed multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_a">A</code></td>
<td>
<p>an <code class="reqn">k \times n</code> matrix of constraints.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_b">b</code></td>
<td>
<p>a <code class="reqn">k</code> vector of inequality limits.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_eta">eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the test contrast, <code class="reqn">\eta</code>.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_mu">mu</code></td>
<td>
<p>an <code class="reqn">n</code> vector of the population mean, <code class="reqn">\mu</code>.
Not needed if <code>eta_mu</code> is given.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_sigma">Sigma</code></td>
<td>
<p>an <code class="reqn">n \times n</code> matrix of the population covariance, <code class="reqn">\Sigma</code>.
Not needed if <code>Sigma_eta</code> is given.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_sigma_eta">Sigma_eta</code></td>
<td>
<p>an <code class="reqn">n</code> vector of <code class="reqn">\Sigma \eta</code>.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_eta_mu">eta_mu</code></td>
<td>
<p>the scalar <code class="reqn">\eta^{\top}\mu</code>.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="pconnorm_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the CDF of the truncated normal conditional
on linear constraints, as described in section 5 of Lee <em>et al.</em>
</p>
<p>Let <code class="reqn">y</code> be multivariate normal with mean <code class="reqn">\mu</code>
and covariance <code class="reqn">\Sigma</code>. Conditional on <code class="reqn">Ay \le b</code>
for conformable matrix <code class="reqn">A</code> and vector <code class="reqn">b</code> we compute the
CDF of a truncated normal maximally aligned with <code class="reqn">\eta</code>. 
Inference depends on the population parameters only via 
<code class="reqn">\eta^{\top}\mu</code> and <code class="reqn">\Sigma \eta</code>,
and only these need to be given.
</p>
<p>The test statistic is aligned with <code class="reqn">y</code>, meaning that an output
p-value near one casts doubt on the null hypothesis that 
<code class="reqn">\eta^{\top}\mu</code> is less than the posited value.
</p>


<h3>Value</h3>

<p>The CDF.
</p>


<h3>Note</h3>

<p>An error will be thrown if we do not observe <code class="reqn">A y \le b</code>.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, J. D., Sun, D. L., Sun, Y. and Taylor, J. E. &quot;Exact post-selection inference, 
with application to the Lasso.&quot; Ann. Statist. 44, no. 3 (2016): 907-927.
doi:10.1214/15-AOS1371. <a href="https://arxiv.org/abs/1311.6238">https://arxiv.org/abs/1311.6238</a>
</p>


<h3>See Also</h3>

<p>the confidence interval function, <code>ci_connorm</code>.
</p>

<hr>
<h2 id='ptruncnorm'>ptruncnorm .</h2><span id='topic+ptruncnorm'></span>

<h3>Description</h3>

<p>Cumulative distribution of the truncated normal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptruncnorm(q, mean = 0, sd = 1, a = -Inf, b = Inf,
  lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptruncnorm_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_mean">mean</code></td>
<td>
<p>vector of means.</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_sd">sd</code></td>
<td>
<p>vector of standard deviations.</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_a">a</code></td>
<td>
<p>vector of the left truncation value(s).</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_b">b</code></td>
<td>
<p>vector of the right truncation value(s).</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="ptruncnorm_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The distribution function of the truncated normal.
</p>
<p>Invalid arguments will result in return value <code>NaN</code> with a warning.
</p>


<h3>Note</h3>

<p>Input are recycled as possible.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Hattaway, James T. &quot;Parameter estimation and hypothesis testing for the truncated normal distribution 
with applications to introductory statistics grades.&quot; BYU Masters Thesis (2010).
<a href="https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?referer=&amp;httpsredir=1&amp;article=3052&amp;context=etd">https://scholarsarchive.byu.edu/cgi/viewcontent.cgi?referer=&amp;httpsredir=1&amp;article=3052&amp;context=etd</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- ptruncnorm(seq(-5,5,length.out=101), a=-1, b=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
