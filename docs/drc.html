<!DOCTYPE html><html><head><title>Help for package drc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {drc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acidiq'><p>Acifluorfen and diquat tested on Lemna minor.</p></a></li>
<li><a href='#algae'><p>Volume of algae as function of increasing concentrations of a herbicide</p></a></li>
<li><a href='#anova.drc'><p>ANOVA for dose-response model fits</p></a></li>
<li><a href='#AR'><p>Asymptotic regression model</p></a></li>
<li><a href='#auxins'><p>Effect of technical grade and commercially formulated auxin herbicides</p></a></li>
<li><a href='#backfit'>
<p>Calculation of backfit values from a fitted dose-response model</p></a></li>
<li><a href='#baro5'><p>The modified baro5 function</p></a></li>
<li><a href='#BC.5'><p>The Brain-Cousens hormesis models</p></a></li>
<li><a href='#boxcox.drc'><p>Transform-both-sides Box-Cox transformation</p></a></li>
<li><a href='#braincousens'><p>The Brain-Cousens hormesis models</p></a></li>
<li><a href='#bread.drc'><p>Bread and meat for the sandwich</p></a></li>
<li><a href='#cedergreen'><p>The Cedergreen-Ritz-Streibig model</p></a></li>
<li><a href='#chickweed'>
<p>Germination of common chickweed (<em>Stellaria media</em>)</p></a></li>
<li><a href='#CIcompX'>
<p>Calculation of combination index for binary mixtures</p></a></li>
<li><a href='#coef.drc'><p>Extract Model Coefficients</p></a></li>
<li><a href='#comped'><p>Comparison of effective dose values</p></a></li>
<li><a href='#compParm'><p>Comparison of parameters</p></a></li>
<li><a href='#confint.drc'><p>Confidence Intervals for model parameters</p></a></li>
<li><a href='#CRS.4a'><p>The Cedergreen-Ritz-Streibig model</p></a></li>
<li><a href='#CRS.5a'><p>Cedergreen-Ritz-Streibig dose-reponse model for describing hormesis</p></a></li>
<li><a href='#daphnids'><p>Daphnia test</p></a></li>
<li><a href='#decontaminants'>
<p>Performance of decontaminants used in the culturing of a micro-organism</p></a></li>
<li><a href='#deguelin'><p>Deguelin applied to chrysanthemum aphis</p></a></li>
<li><a href='#drm'><p>Fitting dose-response models</p></a></li>
<li><a href='#drmc'><p>Sets control arguments</p></a></li>
<li><a href='#earthworms'><p>Earthworm toxicity test</p></a></li>
<li><a href='#ED.drc'><p>Estimating effective doses</p></a></li>
<li><a href='#EDcomp'><p>Comparison of relative potencies between dose-response curves</p></a></li>
<li><a href='#etmotc'><p>Effect of erythromycin on mixed sewage microorganisms</p></a></li>
<li><a href='#EXD'><p>Exponential decay model</p></a></li>
<li><a href='#finney71'><p>Example from Finney (1971)</p></a></li>
<li><a href='#fitted.drc'><p>Extract fitted values from model</p></a></li>
<li><a href='#fplogistic'><p>Fractional polynomial-logistic dose-response models</p></a></li>
<li><a href='#G.aparine'><p>Herbicide applied to Galium aparine</p></a></li>
<li><a href='#gammadr'>
<p>Gamma dose-response model</p></a></li>
<li><a href='#gaussian'>
<p>Normal and log-normal biphasic dose-response models</p></a></li>
<li><a href='#germination'>
<p>Germination of three crops</p></a></li>
<li><a href='#getInitial'>
<p>Showing starting values used</p></a></li>
<li><a href='#getMeanFunctions'><p>Display available dose-response models</p></a></li>
<li><a href='#glymet'><p>Glyphosate and metsulfuron-methyl tested on algae.</p></a></li>
<li><a href='#gompertz'><p>Mean function for the Gompertz dose-response or growth curve</p></a></li>
<li><a href='#gompertzd'><p>The derivative of the Gompertz function</p></a></li>
<li><a href='#H.virescens'><p>Mortality of tobacco budworms</p></a></li>
<li><a href='#hatvalues.drc'>
<p>Model diagnostics for nonlinear dose-response models</p></a></li>
<li><a href='#heartrate'><p>Heart rate baroreflexes for rabbits</p></a></li>
<li><a href='#isobole'><p>Creating isobolograms</p></a></li>
<li><a href='#leaflength'><p>Leaf length of barley</p></a></li>
<li><a href='#lepidium'><p>Dose-response profile of degradation of agrochemical using lepidium</p></a></li>
<li><a href='#lettuce'><p>Hormesis in lettuce plants</p></a></li>
<li><a href='#lin.test'>
<p>Lack-of-fit test for the mean structure based on cumulated residuals</p></a></li>
<li><a href='#LL.2'><p>The two-parameter log-logistic function</p></a></li>
<li><a href='#LL.3'><p>The three-parameter log-logistic function</p></a></li>
<li><a href='#LL.4'><p>The four-parameter log-logistic function</p></a></li>
<li><a href='#LL.5'><p>The five-parameter log-logistic function</p></a></li>
<li><a href='#llogistic'><p>The log-logistic function</p></a></li>
<li><a href='#lnormal'><p>Log-normal dose-response model</p></a></li>
<li><a href='#logistic'><p>The logistic model</p></a></li>
<li><a href='#logLik.drc'><p>Extracting the log likelihood</p></a></li>
<li><a href='#M.bahia'><p>Effect of an effluent on the growth of mysid shrimp</p></a></li>
<li><a href='#maED'><p>Estimation of ED values using model-averaging</p></a></li>
<li><a href='#MAX'><p>Maximum mean response</p></a></li>
<li><a href='#mecter'><p>Mechlorprop and terbythylazine tested on Lemna minor</p></a></li>
<li><a href='#metals'>
<p>Data from heavy metal mixture experiments</p></a></li>
<li><a href='#methionine'><p>Weight gain for different methionine sources</p></a></li>
<li><a href='#mixture'><p>Fitting binary mixture models</p></a></li>
<li><a href='#MM'><p>Michaelis-Menten model</p></a></li>
<li><a href='#modelFit'><p>Assessing the model fit</p></a></li>
<li><a href='#mr.test'>
<p>Mizon-Richard test for dose-response models</p></a></li>
<li><a href='#mselect'><p>Dose-response model selection</p></a></li>
<li><a href='#multi2'>
<p>Multistage dose-response model with quadratic terms</p></a></li>
<li><a href='#nasturtium'><p>Dose-response profile of degradation of agrochemical using nasturtium</p></a></li>
<li><a href='#NEC'>
<p>Dose-response model for estimation of no effect concentration (NEC).</p></a></li>
<li><a href='#neill.test'>
<p>Neill's lack-of-fit test for dose-response models</p></a></li>
<li><a href='#noEffect'>
<p>Testing if there is a dose effect at all</p></a></li>
<li><a href='#O.mykiss'><p>Test data from a 21 day fish test</p></a></li>
<li><a href='#P.promelas'><p>Effect of sodium pentachlorophenate on growth of fathead minnow</p></a></li>
<li><a href='#plot.drc'><p>Plotting fitted dose-response curves</p></a></li>
<li><a href='#PR'><p>Expected or predicted response</p></a></li>
<li><a href='#predict.drc'><p>Prediction</p></a></li>
<li><a href='#print.drc'><p>Printing key features</p></a></li>
<li><a href='#print.summary.drc'><p>Printing summary of non-linear model fits</p></a></li>
<li><a href='#rdrm'><p>Simulating a dose-response curve</p></a></li>
<li><a href='#residuals.drc'><p>Extracting residuals from the fitted dose-response model</p></a></li>
<li><a href='#RScompetition'><p>Competition between two biotypes</p></a></li>
<li><a href='#ryegrass'><p>Effect of ferulic acid on growth of ryegrass</p></a></li>
<li><a href='#S.alba'><p>Potency of two herbicides</p></a></li>
<li><a href='#S.capricornutum'><p>Effect of cadmium on growth of green alga</p></a></li>
<li><a href='#searchdrc'><p>Searching through a range of initial parameter values to obtain convergence</p></a></li>
<li><a href='#secalonic'><p>Root length measurements</p></a></li>
<li><a href='#selenium'>
<p>Data from toxicology experiments with selenium</p></a></li>
<li><a href='#simDR'><p>Simulating ED values under various scenarios</p></a></li>
<li><a href='#spinach'><p>Inhibition of photosynthesis</p></a></li>
<li><a href='#summary.drc'><p>Summarising non-linear model fits</p></a></li>
<li><a href='#terbuthylazin'><p>The effect of terbuthylazin on growth rate</p></a></li>
<li><a href='#twophase'>
<p>Two-phase dose-response model</p></a></li>
<li><a href='#update.drc'><p>Updating and re-fitting a model</p></a></li>
<li><a href='#ursa'>
<p>Model function for the universal response surface approach (URSA) for the quantitative assessment of drug interaction</p></a></li>
<li><a href='#vcov.drc'><p>Calculating variance-covariance matrix for objects of class 'drc'</p></a></li>
<li><a href='#vinclozolin'><p>Vinclozolin from AR in vitro assay</p></a></li>
<li><a href='#W1.2'><p>The two-parameter Weibull functions</p></a></li>
<li><a href='#W1.3'><p>The three-parameter Weibull functions</p></a></li>
<li><a href='#W1.4'><p>The four-parameter Weibull functions</p></a></li>
<li><a href='#weibull1'><p>Weibull model functions</p></a></li>
<li><a href='#yieldLoss'><p>Calculating yield loss parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-08-25</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Dose-Response Curves</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Ritz &lt;ritz@bioassay.dk&gt;, Jens C. Strebig &lt;streibig@bioassay.dk&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Ritz &lt;ritz@bioassay.dk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0), MASS, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>car, gtools, multcomp, plotrix, scales</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of dose-response data is made available through a suite of flexible and versatile model fitting and after-fitting functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file LICENCE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.r-project.org">http://www.r-project.org</a>, <a href="http://www.bioassay.dk">http://www.bioassay.dk</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-24 23:24:51 UTC; mwr165</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-30 01:33:38</td>
</tr>
</table>
<hr>
<h2 id='acidiq'>Acifluorfen and diquat tested on Lemna minor.</h2><span id='topic+acidiq'></span>

<h3>Description</h3>

<p>Data from an experiment where the chemicals acifluorfen and diquat tested on Lemna minor. The dataset has 7 mixtures used in
8 dilutions with three replicates and 12 common controls, in total 180 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(acidiq)</code></pre>


<h3>Format</h3>

<p>A data frame with 180 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose values</p>
</dd>
<dt><code>pct</code></dt><dd><p>a numeric vector denoting the grouping according to the mixtures percentages</p>
</dd>
<dt><code>rgr</code></dt><dd><p>a numeric vector of response values (relative growth rates)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset is analysed in Soerensen et al (2007). 
Hewlett's symmetric model seems appropriate for this dataset. 
</p>


<h3>Source</h3>

<p>The dataset is kindly provided by Nina Cedergreen, Department of Agricultural Sciences, 
Royal Veterinary and Agricultural University, Denmark.
</p>


<h3>References</h3>

<p>Soerensen, H. and Cedergreen, N. and Skovgaard, I. M. and Streibig, J. C. (2007) 
An isobole-based statistical model and test for synergism/antagonism in binary mixture toxicity experiments, 
<em>Environmental and Ecological Statistics</em>, <b>14</b>, 383&ndash;397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the model with freely varying ED50 values
## Ooops: Box-Cox transformation is needed
acidiq.free &lt;- drm(rgr ~ dose, pct, data = acidiq, fct = LL.4(),
pmodels = list(~factor(pct), ~1, ~1, ~factor(pct) - 1))

## Lack-of-fit test
modelFit(acidiq.free)
summary(acidiq.free)

## Plotting isobole structure
isobole(acidiq.free, xlim = c(0, 400), ylim = c(0, 450))

## Fitting the concentration addition model
acidiq.ca &lt;- mixture(acidiq.free, model = "CA")

## Comparing to model with freely varying e parameter
anova(acidiq.ca, acidiq.free)  # rejected

## Plotting isobole based on concentration addition -- poor fit
isobole(acidiq.free, acidiq.ca, xlim = c(0, 420), ylim = c(0, 450))  # poor fit

## Fitting the Hewlett model
acidiq.hew &lt;- mixture(acidiq.free, model = "Hewlett")

## Comparing to model with freely varying e parameter
anova(acidiq.free, acidiq.hew)  # accepted
summary(acidiq.hew)

## Plotting isobole based on the Hewlett model
isobole(acidiq.free, acidiq.hew, xlim = c(0, 400), ylim = c(0, 450))  # good fit

</code></pre>

<hr>
<h2 id='algae'>Volume of algae as function of increasing concentrations of a herbicide</h2><span id='topic+algae'></span>

<h3>Description</h3>

<p>Dataset from an experiment exploring the effect of increasing concentrations of a herbicide on 
the volume of the treated algae.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(algae)</code></pre>


<h3>Format</h3>

<p>A data frame with 14 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations.</p>
</dd>
<dt><code>vol</code></dt><dd><p>a numeric vector of response values, that is relative change in volume.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This datasets requires a cubic root transformation in order to stabilise the variance.
</p>


<h3>Source</h3>

<p>Meister, R. and van den Brink, P. (2000)
<em>The Analysis of Laboratory Toxicity Experiments</em>,  
Chapter 4 in <em>Statistics in Ecotoxicology</em>, Editor: T. Sparks, 
New York: John Wiley \&amp; Sons, (pp. 114&ndash;116). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
algae.m1 &lt;- drm(vol~conc, data=algae, fct=LL.3())
summary(algae.m1)

algae.m2 &lt;- boxcox(algae.m1)
summary(algae.m2)

</code></pre>

<hr>
<h2 id='anova.drc'>ANOVA for dose-response model fits</h2><span id='topic+anova.drc'></span>

<h3>Description</h3>

<p>'anova' produces an analysis of variance table for one or two non-linear model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
anova(object, ..., details = TRUE, test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="anova.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="anova.drc_+3A_details">details</code></td>
<td>
<p>logical indicating whether or not details on the models compared should be displayed. 
Default is TRUE (details are displayed).</p>
</td></tr>
<tr><td><code id="anova.drc_+3A_test">test</code></td>
<td>
<p>a character string specifying the test statistic to be applied.
Use &quot;od&quot; to assess overdispersion for binomial data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifying only a single object gives a test for lack-of-fit, comparing the non-linear regression
model to a more general one-way or two-way ANOVA model.
</p>
<p>If two objects are specified a test for reduction from the larger to the smaller model is given. (This only makes statistical 
sense if the models are nested, that is: one model is a submodel of the other model.)
</p>


<h3>Value</h3>

<p>An object of class 'anova'.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Bates, D. M. and Watts, D. G. (1988) 
<em>Nonlinear Regression Analysis and Its Applications</em>, 
New York: Wiley \&amp; Sons (pp. 103&ndash;104)
</p>


<h3>See Also</h3>

<p>For comparison of nested or non-nested model the function <code><a href="#topic+mselect">mselect</a></code>can also be used.
</p>
<p>The function <code><a href="stats.html#topic+anova.lm">anova.lm</a></code> for linear models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Comparing a Gompertz three- and four-parameter models using an F test
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.4())
ryegrass.m2 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.3())
anova(ryegrass.m2, ryegrass.m1)  # reduction to 'W1.3' not possible (highly significant)   

anova(ryegrass.m2, ryegrass.m1, details = FALSE)  # without details

</code></pre>

<hr>
<h2 id='AR'>Asymptotic regression model</h2><span id='topic+AR.2'></span><span id='topic+AR.3'></span>

<h3>Description</h3>

<p>Providing the mean function and the corresponding self starter function for the asymptotic regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  AR.2(fixed = c(NA, NA), names = c("d", "e"), ...)

  AR.3(fixed = c(NA, NA, NA), names = c("c", "d", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AR_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="AR_+3A_names">names</code></td>
<td>
<p>vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).</p>
</td></tr>
<tr><td><code id="AR_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>     
</table>


<h3>Details</h3>

<p>The asymptotic regression model is a three-parameter model with mean function:
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c)(1-\exp(-x/e))</code>
</p>

<p>The parameter <code class="reqn">c</code> is the lower limit (at <code class="reqn">x=0</code>), the parameter <code class="reqn">d</code> is the upper limit 
and the parameter <code class="reqn">e&gt;0</code> is determining the steepness of the increase as <code class="reqn">x</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>drcMean</code>, containing the mean function, the self starter function,
the parameter names and other components such as derivatives and a function for calculating ED values.
</p>


<h3>Note</h3>

<p>The functions are for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>A very similar, but monotonously decreasing model is the exponential decay model:
<code><a href="#topic+EXD.2">EXD.2</a></code> and <code><a href="#topic+EXD.3">EXD.3</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## First model
met.as.m1&lt;-drm(gain ~ dose, product, data = methionine, fct = AR.3(), 
pmodels = list(~1, ~factor(product), ~factor(product)))
plot(met.as.m1, log = "", ylim = c(1450, 1800))
summary(met.as.m1)

## Calculating bioefficacy: approach 1
coef(met.as.m1)[5] / coef(met.as.m1)[4] * 100

## Calculating bioefficacy: approach 2
EDcomp(met.as.m1, c(50,50))

## Simplified models
met.as.m2&lt;-drm(gain ~ dose, product, data = methionine, fct = AR.3(), 
pmodels = list(~1, ~1, ~factor(product)))
anova(met.as.m2, met.as.m1)  # simplification not possible

met.as.m3 &lt;- drm(gain ~ dose, product, data = methionine, fct = AR.3(), 
pmodels = list(~1, ~factor(product), ~1))
anova(met.as.m3, met.as.m1)  # simplification not possible

</code></pre>

<hr>
<h2 id='auxins'>Effect of technical grade and commercially formulated auxin herbicides</h2><span id='topic+auxins'></span>

<h3>Description</h3>

<p>MCPA, 2,4-D, mecorprop and dichorlprop were applied either as technical grades
materials  (h = 1, 2, 3, 4) or as commercial formulations (herb = 5, 6, 7, 8). 
Each experimental unit consisted of five 1-week old seedlings grown together
in a pot of nutrient solution during 14 days. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(auxins)</code></pre>


<h3>Format</h3>

<p>A data frame with 150 observations on the following 5 variables.
</p>

<dl>
<dt><code>r</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>h</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>w</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>y</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dose</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data are parts of a larger joint action experiment with various herbicides.
</p>
<p>The eight herbicide preparations are naturally grouped into four pairs:
(1, 5), (2, 6), (3, 7), and (4, 8), and in each pair of herbicides
should have the same active ingredients but different formulation
constituents, which were assumed to be biologically inert. The data consist
of the 150 observations y of dry weights, each observation being the weight
of five plants grown in the same pot. All the eight herbicide preparations have
essentially the same mode of action in the plant; they all act like the plant 
auxins, which are plant regulators that affect cell enlongation an other 
essential metabolic pathways. One of the objects of the experiment was to test
if the response functions were identical except for a multiplicative factor in 
the dose. This is a necessary, but not a sufficient, condition for a similar
mode of action for the herbicides. 
</p>


<h3>Source</h3>

<p>Streibig, J. C. (1987). Joint action of root-absorbed mixtures of auxin 
herbicides in Sinapis alba L. and barley (Hordeum vulgare L.) 
<em>Weed Research</em>, <b>27</b>, 337&ndash;347.
</p>


<h3>References</h3>

<p>Rudemo, M., Ruppert, D., and Streibig, J. C. (1989). Random-Effect Models 
in Nonlinear Regression with Applications to Bioassay.
<em>Biometrics</em>, <b>45</b>, 349&ndash;362.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting model with varying lower limits
auxins.m1 &lt;- boxcox(drm(y ~ dose, h, 
pmodels = data.frame(h, h, 1, h), fct = LL.4(), data = auxins), method = "anova")

## Fitting model with common lower limit
auxins.m2 &lt;- boxcox(drm(y ~ dose, h, 
pmodels = data.frame(h, 1, 1, h), fct = LL.4(), data = auxins), method = "anova")

## Comparing the two models
anova(auxins.m2, auxins.m1)

</code></pre>

<hr>
<h2 id='backfit'>
Calculation of backfit values from a fitted dose-response model
</h2><span id='topic+backfit'></span>

<h3>Description</h3>

<p>By inverse regression backfitted dose values are calculated for the mean response per dose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backfit(drcObject)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backfit_+3A_drcobject">drcObject</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two columns with the original dose values and the corresponding backfitted values using the fitted dose-response model. 
For extreme dose values (e.g., high dose ) the backfitted values may not be well-defined (see the example below). 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz after a suggestion from Keld Sorensen.
</p>


<h3>References</h3>

<p>??
</p>


<h3>See Also</h3>

<p>A related function is <code><a href="#topic+ED.drc">ED.drc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.LL.4 &lt;- drm(rootl~conc, data=ryegrass, fct=LL.4())

backfit(ryegrass.LL.4)

</code></pre>

<hr>
<h2 id='baro5'>The modified baro5 function</h2><span id='topic+baro5'></span>

<h3>Description</h3>

<p>'baro5' allows specification of the baroreflex 5-parameter dose response function,
under various constraints on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  baro5(fixed = c(NA, NA, NA, NA, NA), names = c("b1", "b2", "c", "d", "e"),
  method = c("1", "2", "3", "4"), ssfct = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="baro5_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="baro5_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;). 
The order of the parameters is: b1, b2, c, d, e (see under 'Details').</p>
</td></tr>
<tr><td><code id="baro5_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="baro5_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>                 
</table>


<h3>Details</h3>

<p>The five-parameter function given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> y = c + \frac{d-c}{1+f\exp(b1(\log(x)-\log(e))) + (1-f)\exp(b2(\log(x)-\log(e)))}</code>
</p>

<p style="text-align: center;"><code class="reqn"> f = 1/( 1 + \exp((2b1b2/|b1+b2|)(\log(x)-\log(e))))</code>
</p>

<p>If the difference between the parameters b1 and b2 is different from 0 then the function is asymmetric.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear model function, the self starter function
and the parameter names.    
</p>


<h3>Note</h3>

<p>See the example for the dataset <code><a href="#topic+heartrate">heartrate</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Ricketts, J. H. and Head, G. A. (1999) 
A five-parameter logistic equation for investigating asymmetry of curvature in baroreflex studies. 
<em>Am. J. Physiol. (Regulatory Integrative Comp. Physiol. 46)</em>, <b>277</b>, 441&ndash;454.
</p>

<hr>
<h2 id='BC.5'>The Brain-Cousens hormesis models</h2><span id='topic+BC.5'></span><span id='topic+bcl4'></span><span id='topic+BC.4'></span><span id='topic+bcl3'></span>

<h3>Description</h3>

<p>'BC.4' and 'BC.5' provide the Brain-Cousens modified log-logistic models for describing u-shaped hormesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  BC.5(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), ...)

  BC.4(fixed = c(NA, NA, NA, NA), names = c("b", "d", "e", "f"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BC.5_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector specifying which parameters are fixed and at which values they are fixed. 
NAs designate parameters that are not fixed.</p>
</td></tr>
<tr><td><code id="BC.5_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters.</p>
</td></tr>
<tr><td><code id="BC.5_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The model function for the Brain-Cousens model (Brain and Cousens, 1989) is
</p>
<p style="text-align: center;"><code class="reqn"> f(x, b,c,d,e,f) = c + \frac{d-c+fx}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>
<p>,
</p>
<p>and it is a five-parameter model, obtained by extending the four-parameter log-logistic model (<code><a href="#topic+LL.4">LL.4</a></code>
to take into account inverse u-shaped hormesis effects.
</p>
<p>The parameters have the following interpretations
</p>

<ul>
<li> <p><code class="reqn">b</code>: Not direct interpretation
</p>
</li>
<li> <p><code class="reqn">c</code>: Lower horizontal asymptote
</p>
</li>
<li> <p><code class="reqn">d</code>: Upper horizontal asymptote
</p>
</li>
<li> <p><code class="reqn">e</code>: Not direct interpretation
</p>
</li>
<li> <p><code class="reqn">f</code>: Size of the hormesis effect: the larger the value the larger is the hormesis effect. <code class="reqn">f=0</code>
corresponds to no hormesis effect and the resulting model is the four-parameter log-logistic model. 
This parameter should be positive in order for the model to make sense.
</p>
</li></ul>

<p>Fixing the lower limit at 0 yields the four-parameter model 
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + \frac{d-0+fx}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>used by van Ewijk and Hoekstra (1993).
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+braincousens">braincousens</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Brain, P. and Cousens, R. (1989) An equation to describe dose responses 
where there is stimulation of growth at low doses, 
<em>Weed Research</em>, <b>29</b>, 93&ndash;96.
</p>
<p>van Ewijk, P. H. and Hoekstra, J. A. (1993) 
Calculation of the EC50 and its Confidence Interval When Subtoxic Stimulus Is Present,
<em>Ecotoxicology and Environmental Safety</em>, <b>25</b>, 25&ndash;32.  
</p>


<h3>See Also</h3>

<p>More details are found for the general model function <code><a href="#topic+braincousens">braincousens</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the data in van Ewijk and Hoekstra (1993)
lettuce.bcm1 &lt;- drm(weight ~ conc, data = lettuce, fct=BC.5())
modelFit(lettuce.bcm1)
plot(lettuce.bcm1)

lettuce.bcm2 &lt;- drm(weight ~conc, data = lettuce, fct=BC.4())
summary(lettuce.bcm2)
ED(lettuce.bcm2, c(50))  
# compare the parameter estimate and 
# its estimated standard error 
# to the values in the paper by 
# van Ewijk and Hoekstra (1993)


## Brain-Cousens model with the constraint b&gt;3
ryegrass.bcm1 &lt;- drm(rootl ~conc, data = ryegrass, fct = BC.5(), 
lower = c(3, -Inf, -Inf, -Inf, -Inf), control = drmc(constr=TRUE))

summary(ryegrass.bcm1)

## Brain-Cousens model with the constraint f&gt;0 
## (no effect as the estimate of f is positive anyway)
ryegrass.bcm2 &lt;- drm(rootl ~conc, data = ryegrass, fct = BC.5(), 
lower = c(-Inf, -Inf, -Inf, -Inf, 0), control = drmc(constr=TRUE))

summary(ryegrass.bcm2)

</code></pre>

<hr>
<h2 id='boxcox.drc'>Transform-both-sides Box-Cox transformation</h2><span id='topic+boxcox.drc'></span>

<h3>Description</h3>

<p>Finds the optimal Box-Cox transformation for non-linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'drc'
boxcox(object, lambda = seq(-2, 2, by = 0.25), plotit = TRUE, bcAdd = 0, 
method = c("ml", "anova"),  level = 0.95, eps = 1/50, 
xlab = expression(lambda), ylab = "log-Likelihood", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxcox.drc_+3A_object">object</code></td>
<td>
<p>object of class <code>drc</code>.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_lambda">lambda</code></td>
<td>
<p>numeric vector of lambda values; the default is (-2, 2) in steps of 0.25.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_plotit">plotit</code></td>
<td>
<p>logical which controls whether the result should be plotted.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_bcadd">bcAdd</code></td>
<td>
<p>numeric value specifying the constant to be added on both sides prior to Box-Cox transformation. 
The default is 0.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_method">method</code></td>
<td>
<p>character string specifying the estimation method for lambda: maximum likelihood or ANOVA-based 
(optimal lambda inherited from more general ANOVA model fit.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_eps">eps</code></td>
<td>
<p>numeric value: the tolerance for lambda = 0; defaults to 0.02.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_level">level</code></td>
<td>
<p>numeric value: the confidence level required.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_xlab">xlab</code></td>
<td>
<p>character string: the label on the x axis, defaults to &quot;lambda&quot;.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_ylab">ylab</code></td>
<td>
<p>character string: the label on the y axis, defaults to &quot;log-likelihood&quot;.</p>
</td></tr>
<tr><td><code id="boxcox.drc_+3A_...">...</code></td>
<td>
<p>additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimal lambda value is determined using a profile likelihood approach: 
For each lambda value the dose-response regression model is fitted and the lambda value (and corresponding model fit) resulting in the largest
value of the log likelihood function is chosen.
</p>


<h3>Value</h3>

<p>An object of class &quot;drc&quot; (returned invisibly). 
If plotit = TRUE a plot of loglik vs lambda is shown indicating a confidence interval (by default 95
the optimal lambda value.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Carroll, R. J. and Ruppert, D. (1988) <em>Transformation and Weighting in Regression</em>, 
New York: Chapman and Hall (Chapter 4).
</p>


<h3>See Also</h3>

<p>For linear regression the analogue is <code><a href="MASS.html#topic+boxcox">boxcox</a></code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting log-logistic model without transformation
ryegrass.m1 &lt;- drm(ryegrass, fct = LL.4())
summary(ryegrass.m1)

## Fitting the same model with the optimal Box-Cox transformation
ryegrass.m2 &lt;- boxcox(ryegrass.m1)
summary(ryegrass.m2)

</code></pre>

<hr>
<h2 id='braincousens'>The Brain-Cousens hormesis models</h2><span id='topic+braincousens'></span>

<h3>Description</h3>

<p>'braincousens' provides a very general way of specifying Brain-Cousens' 
modified log- logistic model for describing hormesis, under various constraints on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  braincousens(fixed = c(NA, NA, NA, NA, NA), 
  names = c("b", "c", "d", "e", "f"),
  method = c("1", "2", "3", "4"), ssfct = NULL,
  fctName, fctText)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="braincousens_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="braincousens_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;). 
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e, f (see under 'Details').</p>
</td></tr> 
<tr><td><code id="braincousens_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="braincousens_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="braincousens_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="braincousens_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>                            
</table>


<h3>Details</h3>

<p>The Brain-Cousens model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c+fx}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>which is a five-parameter model.
</p>
<p>It is a modification of the four-parameter logistic curve to take hormesis into account proposed
by Brain and Cousens (1989).
</p>


<h3>Value</h3>

<p>The value returned is a list containing the non-linear function, the self starter function, 
the parameter names and additional model specific objects.  
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>
<p>The convenience functions of <code>braincousens</code> are <code><a href="#topic+BC.4">BC.4</a></code> and <code><a href="#topic+BC.5">BC.5</a></code>. These functions
should be used rather than <code>braincousens</code> directly.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Brain, P. and Cousens, R. (1989) An equation to describe dose responses 
where there is stimulation of growth at low doses, 
<em>Weed Research</em>, <b>29</b>, 93&ndash;96.
</p>

<hr>
<h2 id='bread.drc'>Bread and meat for the sandwich</h2><span id='topic+bread.drc'></span><span id='topic+estfun.drc'></span>

<h3>Description</h3>

<p>Bread and meat for the sandwich estimator of the variance-covariance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  bread.drc(x, ...)
  
  estfun.drc(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bread.drc_+3A_x">x</code></td>
<td>
<p>object of class <code>drc</code></p>
</td></tr>
<tr><td><code id="bread.drc_+3A_...">...</code></td>
<td>
<p>additional arguments. At the moment none are supported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The details are provided by Zeileis (2006).
</p>


<h3>Value</h3>

<p>The unscaled hessian is returned by <code>bread.drc</code>, whereas <code>estfun.drc</code> 
returns the estimating function evaluated at the data and the parameter estimates.
</p>
<p>By default no clustering is assumed, corresponding to robust standard errors under independence.
If a cluster variable is provided the log likelihood contributions provided by <code>estfun</code>
are summed up for each cluster.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Zeileis, A. (2006) Object-oriented Computation of Sandwich Estimators,
<em>J. Statist. Software</em>, <b>16</b>, Issue 9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The lines below requires that the packages
## 'lmtest' and 'sandwich' are installed
# library(lmtest)
# library(sandwich)

# ryegrass.m1&lt;-drm(rootl ~ conc, data = ryegrass, fct = LL.4())

# Standard summary output
# coeftest(ryegrass.m1)  

# Output with robust standard errors
# coeftest(ryegrass.m1, vcov = sandwich)

</code></pre>

<hr>
<h2 id='cedergreen'>The Cedergreen-Ritz-Streibig model</h2><span id='topic+cedergreen'></span><span id='topic+CRS.6'></span><span id='topic+ucedergreen'></span>

<h3>Description</h3>

<p>'cedergreen' provides a very general way of specifying then Cedergreen-Ritz-Streibig 
modified log-logistic model for describing hormesis, under various constraints on the parameters.
</p>
<p><code><a href="#topic+CRS.6">CRS.6</a></code> is the extension of <code>link{cedergreen}</code> with freely varying alpha parameter.
</p>
<p>For u-shaped hormesis data 'ucedergreen' provides a very general way of specifying the 
Cedergreen-Ritz-Streibig modified log-logistic model, under various constraints on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  cedergreen(fixed = c(NA, NA, NA, NA, NA), 
  names = c("b", "c", "d", "e", "f"), 
  method = c("1", "2", "3", "4"), ssfct = NULL,
  alpha, fctName, fctText)
  
  CRS.6(fixed = c(NA, NA, NA, NA, NA, NA), 
  names = c("b","c","d","e","f","g"),
  method = c("1", "2", "3", "4"), ssfct = NULL)
  
  ucedergreen(fixed = c(NA, NA, NA, NA, NA), 
  names = c("b", "c", "d", "e", "f"), 
  method = c("1", "2", "3", "4"), ssfct = NULL,
  alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cedergreen_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="cedergreen_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;). 
The order of the parameters is: b, c, d, e, f (see under 'Details').</p>
</td></tr>
<tr><td><code id="cedergreen_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="cedergreen_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>                 
<tr><td><code id="cedergreen_+3A_alpha">alpha</code></td>
<td>
<p>numeric value between 0 and 1, reflecting the steepness of the hormesis peak. 
This argument needs to be specified.</p>
</td></tr>
<tr><td><code id="cedergreen_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="cedergreen_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c+f exp(-1/(x^{\alpha}))}{1+exp(b(log(x)-log(e)))}</code>
</p>

<p>which is a five-parameter model (alpha is fixed or freely varying). Not all features (eg EC/ED calculation) 
are available for the model with freely varying alpha.
</p>
<p>It is a modification of the four-parameter logistic curve to take hormesis into account.
</p>
<p>The u-shaped model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = cd - \frac{d-c+f \exp(-1/x^{\alpha})}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>



<h3>Value</h3>

<p>The value returned is a list containing the non-linear function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>The functions are for use with the functions <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Cedergreen, N. and Ritz, C. and Streibig, J. C. (2005) 
Improved empirical models describing hormesis, 
<em>Environmental Toxicology and Chemistry</em> 
<b>24</b>, 3166&ndash;3172.
</p>


<h3>See Also</h3>

<p>For fixed alpha, several special cases are handled by the following convenience functions 
<code><a href="#topic+CRS.4a">CRS.4a</a></code>, <code><a href="#topic+CRS.4b">CRS.4b</a></code>, 
<code><a href="#topic+CRS.4c">CRS.4c</a></code>, <code><a href="#topic+CRS.5a">CRS.5a</a></code>, <code><a href="#topic+CRS.5b">CRS.5b</a></code>, <code><a href="#topic+CRS.5c">CRS.5c</a></code>,
<code><a href="#topic+UCRS.4a">UCRS.4a</a></code>, <code><a href="#topic+UCRS.4b">UCRS.4b</a></code>, <code><a href="#topic+UCRS.4c">UCRS.4c</a></code>, <code><a href="#topic+UCRS.5a">UCRS.5a</a></code>,
<code><a href="#topic+UCRS.5b">UCRS.5b</a></code>, <code><a href="#topic+UCRS.5c">UCRS.5c</a></code> where a, b and c correspond to 
the pre-specified alpha values 1, 0.5 and 0.25, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Estimating CRS model with alpha unknown
lettuce.crsm1 &lt;- drm(weight~conc, data = lettuce, fct = CRS.6())
summary(lettuce.crsm1)
plot(lettuce.crsm1)  # oops: not increasing until hormesis peak

</code></pre>

<hr>
<h2 id='chickweed'>
Germination of common chickweed (<em>Stellaria media</em>)
</h2><span id='topic+chickweed'></span><span id='topic+chickweed0'></span>

<h3>Description</h3>

<p>Germination data from tests of chickweed seeds from chlorsulfuron resistant and sensitive biotypes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(chickweed)</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 3 variables.
</p>

<dl>
<dt><code>start</code></dt><dd><p>a numeric vector of left endpoints of the monitoring intervals</p>
</dd>
<dt><code>end</code></dt><dd><p>a numeric vector of right endpoints of the monitoring intervals</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector of the number of seeds germinated in the interval between start and end</p>
</dd>
<dt><code>time</code></dt><dd><p>a numeric vector of the non-zero left endpoints of the monitoring intervals (often used for recording in practice)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The germination tests of chickweed seeds from chlorsulfuron resistant and sensitive biotypes in central Zealand were 
done in petri dishes (diameter: 9.0cm) in a dark growth cabinet at a temperature of 5 degrees Celsius. The seeds were incubated for 
24 hours in a 0.3% solution of potassium nitrate in order to imbibe seeds prior to the test. A total of 200 seeds were placed on filter plate. 
After initialization of the tests, the number of germinated seeds was recorded and removed at 34 consecutive inspection times. 
Definition of a germinated seed was the breakthrough of the seed testa by the radicle. 
</p>
<p>Chickweed is known to have dormant seeds and therefore we would not expect 100% germination. It means that the upper limit 
of the proportion germinated has to be incorporated as a parameter into a model, which adequately reflects the experimental design 
as well as any expectations about the resulting outcome.
</p>


<h3>Source</h3>

<p>Data are kindly provided by Lisa Borggaard (formerly at the Faculty of Life Sciences, University of Copenhagen).
</p>


<h3>References</h3>

<p>Ritz, C., Pipper, C. B. and Streibig, J. C. (2013) Analysis of germination data from agricultural experiments, <em>Europ. J. Agronomy</em>, <b>45</b>, 1&ndash;6.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Incorrect analysis using a logistic regression model
## (treating event times as binomial data)
## The argument "type" specifies that binomial data are supplied 
chickweed.m0a &lt;- drm(count/200 ~ time, weights = rep(200, 34), 
data = chickweed0, fct = LL.3(), type = "binomial")
summary(chickweed.m0a) # showing a summmary of the model fit (including parameter estimates)

## Incorrect analysis based on nonlinear regression
## LL.3() refers to the three-parameter log-logistic model
## As the argument "type" is not specified it is assumed that the data type
##  is continuous and nonlinear regression based on least squares estimation is carried out
chickweed.m0b &lt;- drm(count/200 ~ time, data = chickweed0, fct = LL.3())
summary(chickweed.m0b)  # showing a summmary of the model fit (including parameter estimates)

## How to re-arrange the data for fitting the event-time model
## (only for illustration of the steps needed for converting a dataset, 
##  but in this case not needed as both datasets are already provided in "drc")
#chickweed &lt;- data.frame(start = c(0, chickweed0$time), end = c(chickweed0$time, Inf)) 
#chickweed$count &lt;- c(0, diff(chickweed0$count), 200 - tail(chickweed0$count, 1))
#head(chickweed)  # showing top 6 lines of the dataset
#tail(chickweed)  # showing bottom 6 lines

## Fitting the event-time model (by specifying the argument type explicitly)
chickweed.m1 &lt;- drm(count~start+end, data = chickweed, fct = LL.3(), type = "event")
summary(chickweed.m1)  # showing a summmary of the model fit (including parameter estimates)

## Summary output with robust standard errors
## library(lmtest)
## library(sandwich)
## coeftest(chickweed.m1, vcov = sandwich)

## Calculating t10, t50, t90 for the distribution of viable seeds
ED(chickweed.m1, c(10, 50, 90))

## Plotting data and fitted regression curve
plot(chickweed.m1, xlab = "Time (hours)", ylab = "Proportion germinated", 
xlim=c(0, 340), ylim=c(0, 0.25), log="", lwd=2, cex=1.2)  
## Adding the fitted curve obtained using nonlinear regression
plot(chickweed.m0b, add = TRUE, lty = 2, xlim=c(0, 340), 
ylim=c(0, 0.25), log="", lwd=2, cex=1.2)
# Note: the event-time model has slightly better fit at the upper limit

## Enhancing the plot (to look like in the reference paper)
abline(h = 0.20011, lty = 3, lwd = 2)
text(-15, 0.21, "Upper limit: d", pos = 4, cex = 1.5)

segments(0,0.1,196,0.1, lty = 3, lwd = 2)
segments(196,0.1, 196, -0.1, lty = 3, lwd = 2)
text(200, -0.004, expression(paste("50% germination: ", t[50])), pos = 4, cex = 1.5)

abline(a = 0.20011/2-0.20011*20.77/4, b = 0.20011*20.77/4/196, lty = 3, lwd = 2)
#text(200, 0.1, expression(paste("Slope: ", b*(-d/(4*t[50])))), pos = 4, cex = 1.5)
text(200, 0.1, expression("Slope: b" %.% "constant"), pos = 4, cex = 1.5)
points(196, 0.1, cex = 2, pch = 0)


## Adding confidence intervals

## Predictions from the event-time model
#coefVec &lt;- coef(chickweed.m1)
#names(coefVec) &lt;- c("b","d","e")
#
#predFct &lt;- function(tival)
#{
#    as.numeric(deltaMethod(coefVec, paste("d/(1+exp(b*(log(",tival,")-log(e))))"), 
#    vcov(chickweed.m1)))
#}
#predFctv &lt;- Vectorize(predFct, "tival")
#
#etpred &lt;- t(predFctv(0:340))
#lines(0:340, etpred[,1]-1.96*etpred[,2], lty=1, lwd=2, col="darkgray")
#lines(0:340, etpred[,1]+1.96*etpred[,2], lty=1, lwd=2, col="darkgray")
#
### Predictions from the nonlinear regression model
#nrpred &lt;- predict(chickweed.m0b, data.frame(time=0:340), interval="confidence")
#lines(0:340, nrpred[,2], lty=2, lwd=2, col="darkgray")
#lines(0:340, nrpred[,3], lty=2, lwd=2, col="darkgray")

</code></pre>

<hr>
<h2 id='CIcompX'>
Calculation of combination index for binary mixtures
</h2><span id='topic+CIcompX'></span><span id='topic+CIcomp'></span><span id='topic+plotFACI'></span>

<h3>Description</h3>

<p>For single mixture data combination indices for effective doses as well as effects may be calculated and visualized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIcomp(mixProp, modelList, EDvec)

CIcompX(mixProp, modelList, EDvec, EDonly = FALSE)

plotFACI(effList, indAxis = c("ED", "EF"), caRef = TRUE, 
showPoints = FALSE, add = FALSE, ylim, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIcompX_+3A_mixprop">mixProp</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the mixture proportion/ratio for
the single mixture considered.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_modellist">modelList</code></td>
<td>
<p>a list contained 3 models fits using <code><a href="#topic+drm">drm</a></code> with the model fit
for single mixture ratio being the first element, followed by the 2 model fits of the pure
substances.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_edvec">EDvec</code></td>
<td>
<p> a vector of numeric values between 0 and 100 (percentages) coresponding to the
effect levels of interest.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_edonly">EDonly</code></td>
<td>
<p>a logical value indicating whether or not only combination indices for 
effective doses should be calculated.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_efflist">effList</code></td>
<td>
<p>a list returned by <code><a href="#topic+CIcompX">CIcompX</a></code>.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_indaxis">indAxis</code></td>
<td>
<p>a character indicating whether effective doses (&quot;ED&quot;) or effects
(&quot;EF&quot;) should be plotted.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_caref">caRef</code></td>
<td>
<p>a logical value indicating whether or not a reference line for concentration
addition should be drawn.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_showpoints">showPoints</code></td>
<td>
<p>A logical value indicating whether or not estimated combination indices
should be plotted.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_add">add</code></td>
<td>
<p>a logical value specifying if the plot should be added to the existing plot.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector of length 2 giving the range for the y axis.</p>
</td></tr>
<tr><td><code id="CIcompX_+3A_...">...</code></td>
<td>
<p>additional graphical arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+CIcomp">CIcomp</a></code> calculates the classical combination index for effective doses whereas <code><a href="#topic+CIcompX">CIcompX</a></code> calculates the combination index also for effects as proposed by
Martin-Betancor et al. (2015); for details and examples using &quot;drc&quot; see the supplementary material of this paper. The function <code><a href="#topic+plotFACI">plotFACI</a></code> may be used to visualize the
calculated combination index as a function of the fraction affected.
</p>


<h3>Value</h3>

<p><code><a href="#topic+CIcomp">CIcomp</a></code> returns a matrix which one row per ED value. Columns contain
estimated combination indices, their standard errors and 95% confidence intervals,
p-value for testing CI=1, estimated ED values for the mixture data and assuming 
concentration addition (CA) with corresponding standard errors.
</p>
<p><code><a href="#topic+CIcompX">CIcompX</a></code> returns similar output both for effective doses and effects (as a
list of matrices). 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz and Ismael Rodea-Palomares
</p>


<h3>References</h3>

<p>Martin-Betancor, K. and Ritz, C. and Fernandez-Pinas, F. and Leganes, F. and Rodea-Palomares, I. (2015) 
Defining an additivity framework for mixture research in inducible whole-cell biosensors,
<em>Scientific Reports</em>
<b>17200</b>.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mixture">mixture</a></code> for simultaneous modelling of several mixture ratios, but only at the ED50 level.
</p>
<p>See also the help page for <code><a href="#topic+metals">metals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fitting marginal models for the 2 pure substances
acidiq.0 &lt;- drm(rgr ~ dose, data = subset(acidiq, pct == 999 | pct == 0), fct = LL.4())
acidiq.100 &lt;- drm(rgr ~ dose, data = subset(acidiq, pct == 999 | pct == 100), fct = LL.4())

## Fitting model for single mixture with ratio 17:83
acidiq.17 &lt;- drm(rgr ~ dose, data = subset(acidiq, pct == 17 | pct == 0), fct = LL.4())
    
## Calculation of combination indices based on ED10, ED20, ED50
CIcomp(0.17, list(acidiq.17, acidiq.0, acidiq.100), c(10, 20, 50))  
## CI&gt;1 significantly for ED10 and ED20, but not so for ED50

</code></pre>

<hr>
<h2 id='coef.drc'>Extract Model Coefficients</h2><span id='topic+coef.drc'></span>

<h3>Description</h3>

<p>Extract parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="coef.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameter coefficients which are extracted from the model object 'object'.
</p>


<h3>Note</h3>

<p>This function may work even in cases where 'summary' does not, because the parameter estimates 
are retrieved directly from the model fit object without any additional computations of summary statistics and standard errors.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>A more comprehensive summary is obtained using <code><a href="#topic+summary.drc">summary.drc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())
coef(ryegrass.m1)

</code></pre>

<hr>
<h2 id='comped'>Comparison of effective dose values</h2><span id='topic+comped'></span>

<h3>Description</h3>

<p>Comparison of a pair of effective dose values from independent experiments 
where only the estimates and their standard errors are reported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  comped(est, se, log = TRUE, interval = TRUE, operator = c("-", "/"), 
  level = 0.95, df = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comped_+3A_est">est</code></td>
<td>
<p>a numeric vector of length 2 containing the two estimated ED values</p>
</td></tr>
<tr><td><code id="comped_+3A_se">se</code></td>
<td>
<p>a numeric vector of length 2 containing the two standard errors</p>
</td></tr>
<tr><td><code id="comped_+3A_log">log</code></td>
<td>
<p>logical indicating whether or not estimates and standard errors are on log scale</p>
</td></tr>
<tr><td><code id="comped_+3A_interval">interval</code></td>
<td>
<p>logical indicating whether or not a confidence interval should be returned</p>
</td></tr>
<tr><td><code id="comped_+3A_operator">operator</code></td>
<td>
<p>character string taking one of the two values &quot;-&quot; (default) or &quot;/&quot; corresponding to a comparison
based on the difference or the ratio.</p>
</td></tr>
<tr><td><code id="comped_+3A_level">level</code></td>
<td>
<p>numeric value giving the confidence level</p>
</td></tr>
<tr><td><code id="comped_+3A_df">df</code></td>
<td>
<p>numeric value specifying the degrees of freedom for the percentile used in the confidence interval (optional)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice &quot;/&quot; for the argument <code>operator</code> and FALSE for <code>log</code> will result in estimation of a socalled
relative potency (sometimes also called a selectivity index).
</p>
<p>The combination TRUE for <code>log</code> and &quot;/&quot; for <code>operator</code> only influences the confidence interval, 
that is no ratio is calculated based on logarithm-transformed effective dose values.
</p>
<p>By default confidence interval relies on percentiles in the normal distribution.  
</p>
<p>In case the entire dataset is available the functions <code><a href="#topic+drm">drm</a></code> and (subsequently) <code><a href="#topic+EDcomp">EDcomp</a></code>
should be used instead.
</p>


<h3>Value</h3>

<p>A matrix with the estimated difference or ratio and the associated standard error and the resulting confidence
interval (unless not requested).
</p>


<h3>Note</h3>

<p>The development of the function <code>comped</code> is a side effect of the project on statistical analysis of 
toxicity data funded by the Danish EPA (&quot;Statistisk analyse og biologisk tolkning af toksicitetsdata&quot;, 
MST j.nr. 669-00079).
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Wheeler, M. W. and Park, R. M. and Bailer, A. J. (2006)
Comparing median lethal concentration values using confidence interval overlap or ratio tests,
<em>Environmental Toxicology and Chemistry</em>, <b>25</b>, 1441&ndash;1441.
</p>


<h3>See Also</h3>

<p>The function <code><a href="#topic+ED.drc">ED.drc</a></code> calculates arbitrary effective dose values based on a model fit. The function
<code><a href="#topic+EDcomp">EDcomp</a></code> calculates relative potencies based on arbitrary effective dose values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the model
S.alba.m1 &lt;- boxcox(drm(DryMatter~Dose, Herbicide, data=S.alba, fct = LL.4(),
pmodels=data.frame(Herbicide,1,1,Herbicide)), method = "anova") 

## Displaying estimated ED values
ED(S.alba.m1, c(10, 90))

## Making comparisons of ED50 in two ways and for both differences and ratios
compParm(S.alba.m1, "e", "/")

comped(c(28.396147, 65.573335), c(1.874598, 5.618945), log=FALSE, operator = "/")
# similar result

compParm(S.alba.m1, "e", "-")

comped(c(28.396147, 65.573335), c(1.874598, 5.618945), log=FALSE, operator = "-")
# similar result

## Making comparisons of ED10 and ED90
comped(c(21.173, 44.718), c(11.87, 8.42), log=FALSE, operator = "/")

comped(c(21.173, 44.718), c(11.87, 8.42), log=FALSE, operator = "/", interval = FALSE)

comped(c(21.173, 44.718), c(11.87, 8.42), log=FALSE, operator = "-")

</code></pre>

<hr>
<h2 id='compParm'>Comparison of parameters</h2><span id='topic+compParm'></span>

<h3>Description</h3>

<p>Compare parameters from different assays, either by means of ratios or differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  compParm(object, strVal, operator = "/", vcov. = vcov, od = FALSE, 
  pool = TRUE, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compParm_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="compParm_+3A_strval">strVal</code></td>
<td>
<p>a name of parameter to compare.</p>
</td></tr>
<tr><td><code id="compParm_+3A_operator">operator</code></td>
<td>
<p>a character. If equal to &quot;/&quot; (default) parameter ratios are compared. If equal to &quot;-&quot; parameter differences are compared.</p>
</td></tr>
<tr><td><code id="compParm_+3A_vcov.">vcov.</code></td>
<td>
<p>function providing the variance-covariance matrix. <code><a href="stats.html#topic+vcov">vcov</a></code> is the default, 
but <code>sandwich</code> is also an option (for obtaining robust standard errors).</p>
</td></tr>  
<tr><td><code id="compParm_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used.</p>
</td></tr>
<tr><td><code id="compParm_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr>
<tr><td><code id="compParm_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The function compares actual parameter estimates, and therefore the results depend on the parameterisation used. Probably it is most useful
in combination with the argument <code>collapse</code> in <code><a href="#topic+drm">drm</a></code> for specifying parameter constraints in models, either through 
data frames or lists with formulas without intercept (-1). 
</p>


<h3>Value</h3>

<p>A matrix with columns containing the estimates, estimated standard errors, values of t-statistics and p-values for the null hypothesis that 
the ratio equals 1 or that the difference equals 0 (depending on the <code>operator</code> argument). 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Fitting a model with names assigned to the parameters!
spinach.m1 &lt;- drm(SLOPE~DOSE, CURVE, data = spinach,
fct = LL.4(names = c("b", "lower", "upper", "ed50")))

## Calculating ratios of parameter estimates for the parameter named "ed50"
compParm(spinach.m1, "ed50")      

## Calculating differences between parameter estimates for the parameter named "ed50"
compParm(spinach.m1, "ed50", "-")  

</code></pre>

<hr>
<h2 id='confint.drc'>Confidence Intervals for model parameters</h2><span id='topic+confint.drc'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a model of class 'drc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
confint(object, parm, level = 0.95, pool = TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.drc_+3A_object">object</code></td>
<td>
<p>a model object of class 'drc'.</p>
</td></tr>
<tr><td><code id="confint.drc_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector
of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.drc_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.drc_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr>  
<tr><td><code id="confint.drc_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods. Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For binomial and Poisson data the confidence intervals are based on the normal distribution, whereas <em>t</em> distributions
are used of for continuous/quantitative data.
</p>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence limits for each parameter. These will be labelled as
(1-level)/2 and 1 - (1-level)/2 in 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())

## Confidence intervals for all parameters
confint(ryegrass.m1)

## Confidence interval for a single parameter
confint(ryegrass.m1, "e")

</code></pre>

<hr>
<h2 id='CRS.4a'>The Cedergreen-Ritz-Streibig model</h2><span id='topic+CRS.4a'></span><span id='topic+CRS.4b'></span><span id='topic+CRS.4c'></span><span id='topic+ml3a'></span><span id='topic+ml3b'></span><span id='topic+ml3c'></span><span id='topic+UCRS.4a'></span><span id='topic+UCRS.4b'></span><span id='topic+UCRS.4c'></span><span id='topic+uml3a'></span><span id='topic+uml3b'></span><span id='topic+uml3c'></span>

<h3>Description</h3>

<p>'CRS.4a', 'CRS.4b' and 'CRS.4c' provide the Cedergreen-Ritz-Streibig modified log-logistic model 
for describing hormesis with the lower limit equal to 0.
</p>
<p>'UCRS.4a', 'UCRS.4b' and 'UCRS.4c' provide the Cedergreen-Ritz-Streibig modified log-logistic model 
for describing u-shaped hormesis with the lower limit equal to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  CRS.4a(names = c("b", "d", "e", "f"), ...)

  UCRS.4a(names = c("b", "d", "e", "f"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CRS.4a_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. 
The default is reasonable (see above).</p>
</td></tr>
<tr><td><code id="CRS.4a_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + \frac{d-0+f \exp(-1/x)}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>which is a five-parameter model.
</p>
<p>It is a modification of the four-parameter logistic curve to take hormesis into account.
</p>
<p>The u-shaped model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + d - \frac{d-0+f \exp(-1/x^{\alpha})}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>The a,b,c models are obtained by setting alpha equal to 1, 0.5 and 0.25, respectively.    
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+cedergreen">cedergreen</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>See the reference under <code><a href="#topic+cedergreen">cedergreen</a></code>.
</p>


<h3>See Also</h3>

<p>Similar functions are <code><a href="#topic+CRS.5a">CRS.5a</a></code> and <code><a href="#topic+UCRS.5a">UCRS.5a</a></code>, 
but with an extra parameter for the lower limit.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting modified logistic models
lettuce.crsm1 &lt;- drm(lettuce[,c(2,1)], fct=CRS.4a())
summary(lettuce.crsm1)
ED(lettuce.crsm1, c(50))

## Need to explicitly specify that the upper limit
## is the reference in order to get ED10 and ED90 right
ED(lettuce.crsm1, c(10, 50, 90), reference = "upper")

lettuce.crsm2 &lt;- drm(lettuce[,c(2,1)], fct=CRS.4b())
summary(lettuce.crsm2)
ED(lettuce.crsm2, c(50))

lettuce.crsm3 &lt;- drm(lettuce[,c(2,1)], fct=CRS.4c())
summary(lettuce.crsm3)
ED(lettuce.crsm3, c(50))

</code></pre>

<hr>
<h2 id='CRS.5a'>Cedergreen-Ritz-Streibig dose-reponse model for describing hormesis</h2><span id='topic+CRS.5a'></span><span id='topic+CRS.5b'></span><span id='topic+CRS.5c'></span><span id='topic+ml4a'></span><span id='topic+ml4b'></span><span id='topic+ml4c'></span><span id='topic+UCRS.5a'></span><span id='topic+UCRS.5b'></span><span id='topic+UCRS.5c'></span><span id='topic+uml4a'></span><span id='topic+uml4b'></span><span id='topic+uml4c'></span>

<h3>Description</h3>

<p>'CRS.5a', 'CRS.5b' and 'CRS.5c' provide the Cedergreen-Ritz-Streibig modified log-logistic model for describing
(inverse u-shaped or j-shaped) hormesis.
</p>
<p>'UCRS.5a', 'UCRS.5b' and 'UCRS.5c' provide the Cedergreen-Ritz-Streibig modified log-logistic model for
describing u-shaped hormesis. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  CRS.5a(names = c("b", "c", "d", "e", "f"), ...)

  UCRS.5a(names = c("b", "c", "d", "e", "f"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CRS.5a_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters.</p>
</td></tr>
<tr><td><code id="CRS.5a_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The model function for inverse u-shaped hormetic patterns is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c+f \exp(-1/x^{\alpha})}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>
<p>,
</p>
<p>which is a five-parameter model. It is a modification of the four-parameter log-logistic curve 
to take hormesis into account.
</p>
<p>The parameters have the following interpretations
</p>

<ul>
<li> <p><code class="reqn">b</code>: Not direct interpretation
</p>
</li>
<li> <p><code class="reqn">c</code>: Lower horizontal asymptote
</p>
</li>
<li> <p><code class="reqn">d</code>: Upper horizontal asymptote
</p>
</li>
<li> <p><code class="reqn">e</code>: Not direct interpretation
</p>
</li>
<li> <p><code class="reqn">f</code>: Size of the hormesis effect: the larger the value the larger is the hormesis effect. <code class="reqn">f=0</code>
corresponds to no hormesis effect and the resulting model is the four-parameter log-logistic model. 
This parameter should be positive in order for the model to make sense.
</p>
</li></ul>
  
<p>The model function for u-shaped hormetic patterns is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + d - \frac{d-c+f \exp(-1/x^{\alpha})}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>This model also simplifies to the four-parameter log-logistic model in case <code class="reqn">f=0</code> (in a slightly
different parameterization as compared to the one used in <code><a href="#topic+LL.4">LL.4</a></code>).
</p>
<p>The models denoted a,b,c are obtained by fixing the alpha parameter at 1, 0.5 and 0.25, respectively.  
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+cedergreen">cedergreen</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.  
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>See the reference under <code><a href="#topic+cedergreen">cedergreen</a></code>.
</p>


<h3>See Also</h3>

<p>Similar functions are <code><a href="#topic+CRS.4a">CRS.4a</a></code> and <code><a href="#topic+UCRS.4a">UCRS.4a</a></code>, but with the
lower limit (the parameter <code class="reqn">c</code>) fixed at 0 (one parameter less to be estimated).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Modified logistic model
lettuce.m1 &lt;- drm(lettuce[,c(2,1)], fct=CRS.5a())
summary(lettuce.m1)
ED(lettuce.m1, c(50))

lettuce.m2 &lt;- drm(lettuce[,c(2,1)], fct=CRS.5b())
summary(lettuce.m2)
ED(lettuce.m2, c(50))

lettuce.m3 &lt;- drm(lettuce[,c(2,1)], fct=CRS.5c())
summary(lettuce.m3)
ED(lettuce.m3, c(50))

</code></pre>

<hr>
<h2 id='daphnids'>Daphnia test</h2><span id='topic+daphnids'></span>

<h3>Description</h3>

<p>The number of immobile daphnids &ndash;in contrast to mobile daphnids&ndash; out of a total of 20 daphnids was counted 
for several concentrations of a toxic substance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(daphnids)</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 4 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>no</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>total</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>time</code></dt><dd><p>a factor with levels <code>24h</code> <code>48h</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>The same daphnids were counted at 24h and later again at 48h.
</p>


<h3>Source</h3>

<p>Nina Cedergreen, Faculty of Life Sciences, University of Copenhagen, Denmark.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a model with different parameters
## for different curves
daphnids.m1 &lt;- drm(no/total~dose, time, weights = total, 
data = daphnids, fct = LL.2(), type = "binomial")

## Goodness-of-fit test
modelFit(daphnids.m1)

## Summary of the data
summary(daphnids.m1)

## Fitting a model with a common intercept parameter
daphnids.m2 &lt;- drm(no/total~dose, time, weights = total, 
data = daphnids, fct = LL.2(), type = "binomial", 
pmodels = list(~1, ~time))

</code></pre>

<hr>
<h2 id='decontaminants'>
Performance of decontaminants used in the culturing of a micro-organism
</h2><span id='topic+decontaminants'></span>

<h3>Description</h3>

<p>The two decontaminants 1-hexadecylpyridium chloride and oxalic acid were used. Additionally there was a control group (coded as concentration 0 and only included under oxalic acid).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("decontaminants")</code></pre>


<h3>Format</h3>

<p>A data frame with 128 observations on the following 3 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of percentage weight per volume</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector of numbers of M. bovis colonies at stationarity</p>
</dd>
<dt><code>group</code></dt><dd><p>a factor with levels <code>hpc</code> and <code>oxalic</code> of the decontaminants used</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data examplify Wadley's problem: counts where the maximum number is not known. The data were analyzed by Trajstman (1989) using a three-parameter logistic model and then re-analyzed by Morgan and Smith (1992) using a three-parameter Weibull type II model. In both cases the authors adjusted for overdispersion (in different ways).
</p>
<p>It seems that Morgan and Smith (1992) fitted separate models for the two decontaminants and using the control group for both model fits. In the example below a joint model is fitted where the control group is used once to determine a shared upper limit at concentration 0.
</p>


<h3>Source</h3>

<p>Trajstman, A. C. (1989) Indices for Comparing Decontaminants when Data Come from Dose-Response Survival and Contamination Experiments, <em>Applied Statistics</em>, <b>38</b>, 481&ndash;494. 
</p>


<h3>References</h3>

<p>Morgan, B. J. T. and Smith, D. M. (1992) A Note on Wadley's Problem with Overdispersion, <em>Applied Statistics</em>, <b>41</b>, 349&ndash;354.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Wadley's problem using a three-parameter log-logistic model
decon.LL.3.1 &lt;- drm(count~conc, group, data = decontaminants, fct = LL.3(), 
type = "Poisson", pmodels = list(~group, ~1, ~group))

summary(decon.LL.3.1)

plot(decon.LL.3.1)


## Same model fit in another parameterization (no intercepts)
decon.LL.3.2 &lt;- drm(count~conc, group, data = decontaminants, fct=LL.3(), 
type = "Poisson", pmodels = list(~group-1, ~1, ~group-1))

summary(decon.LL.3.2)

</code></pre>

<hr>
<h2 id='deguelin'>Deguelin applied to chrysanthemum aphis</h2><span id='topic+deguelin'></span>

<h3>Description</h3>

<p>Quantal assay data from an experiment where the insectide deguelin was applied to
<em>Macrosiphoniella sanborni</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(deguelin)</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 4 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of doses applied</p>
</dd>
<dt><code>log10dose</code></dt><dd><p>a numeric vector of logarithm-transformed doses</p>
</dd>
<dt><code>r</code></dt><dd><p>a numeric vector contained number of dead insects</p>
</dd>
<dt><code>n</code></dt><dd><p>a numeric vector contained the total number of insects</p>
</dd>
</dl>



<h3>Details</h3>

<p>The log-logistic model provides an inadequate fit.
</p>
<p>The dataset is used in Nottingham and Birch (2000) to illustrate a semiparametric approach to dose-response
modelling.
</p>


<h3>Source</h3>

 
<p>Morgan, B. J. T. (1992) <em>Analysis of Quantal Response Data</em>, London: Chapman \&amp; Hall/CRC (Table 3.9, p. 117).
</p>


<h3>References</h3>

<p>Notttingham, Q. J. and Birch, J. B. (2000) A semiparametric approach to analysing dose-response data, <em>Statist. Med.</em>, <b>19</b>, 389&ndash;404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Log-logistic fit
deguelin.m1 &lt;- drm(r/n~dose, weights=n, data=deguelin, fct=LL.2(), type="binomial")
modelFit(deguelin.m1)
summary(deguelin.m1)

## Loess fit
deguelin.m2 &lt;- loess(r/n~dose, data=deguelin, degree=1)

## Plot of data with fits superimposed
plot(deguelin.m1, ylim=c(0.2,1))
lines(1:60, predict(deguelin.m2, newdata=data.frame(dose=1:60)), col = 2, lty = 2)

lines(1:60, 0.95*predict(deguelin.m2, 
newdata=data.frame(dose=1:60))+0.05*predict(deguelin.m1, newdata=data.frame(dose=1:60), se = FALSE),
col = 3, lty=3)

</code></pre>

<hr>
<h2 id='drm'>Fitting dose-response models</h2><span id='topic+drm'></span>

<h3>Description</h3>

<p>A general model fitting function for analysis of concentration/dose/time-effect/response data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  drm(formula, curveid, pmodels, weights, data = NULL, subset, fct, 
  type = c("continuous", "binomial", "Poisson", "quantal", "event"), 
  bcVal = NULL, bcAdd = 0, 
  start, na.action = na.omit, robust = "mean", logDose = NULL, 
  control = drmc(), lowerl = NULL, upperl = NULL, separate = FALSE, pshifts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drm_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit. Either of the form 'response <code class="reqn">~</code> dose' 
or as a data frame with response values in first column and dose values in second column.</p>
</td></tr>
<tr><td><code id="drm_+3A_curveid">curveid</code></td>
<td>
<p>a numeric vector or factor containing the grouping of the data.</p>
</td></tr>
<tr><td><code id="drm_+3A_pmodels">pmodels</code></td>
<td>
<p>a data frame with a many columns as there are parameters in the non-linear function. 
Or a list containing a formula for each parameter in the nonlinear function.</p>
</td></tr>
<tr><td><code id="drm_+3A_weights">weights</code></td>
<td>

<p>a numeric vector containing weights. For continuous/quantitative responses weights are multiplied inside the squared errors (see the details below).
For binomial reponses weights provide information about the total number of binary observations used to obtain the response (which is a proportion): 
1/2 and 10/20 lead to different analyses due to the different totals (2 vs. 20) even though the proportion in both cases is 0.5.
</p>
</td></tr>
<tr><td><code id="drm_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="drm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="drm_+3A_fct">fct</code></td>
<td>
<p>a list with three or more elements specifying the non-linear
function, the accompanying self starter function, the names of the parameter in the non-linear function and, 
optionally, the first and second derivatives as well as information used for calculation of ED values.
Currently available functions include, among others, the four- and five-parameter log-logistic models 
<code><a href="#topic+LL.4">LL.4</a></code>, <code><a href="#topic+LL.5">LL.5</a></code> and the Weibull model <code><a href="#topic+W1.4">W1.4</a></code>. Use
<code><a href="#topic+getMeanFunctions">getMeanFunctions</a></code> for a full list.</p>
</td></tr>
<tr><td><code id="drm_+3A_type">type</code></td>
<td>
<p>a character string specifying the data type (parameter estimation will depend on the data type as different log likelihood function will be used).</p>
</td></tr>
<tr><td><code id="drm_+3A_bcval">bcVal</code></td>
<td>
<p>a numeric value specifying the lambda parameter to be used in the Box-Cox transformation.</p>
</td></tr>
<tr><td><code id="drm_+3A_bcadd">bcAdd</code></td>
<td>
<p>a numeric value specifying the constant to be added on both sides prior to Box-Cox transformation. 
The default is 0.</p>
</td></tr>  
<tr><td><code id="drm_+3A_start">start</code></td>
<td>
<p>an optional numeric vector containing starting values for all mean parameters in the model. 
Overrules any self starter function.</p>
</td></tr>
<tr><td><code id="drm_+3A_na.action">na.action</code></td>
<td>
<p>a function for treating mising values ('NA's). Default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="drm_+3A_robust">robust</code></td>
<td>
<p>a character string specifying the rho function for robust estimation. Default is non-robust 
least squares estimation (&quot;mean&quot;). Available robust methods are: median estimation (&quot;median&quot;), 
least median of squares (&quot;lms&quot;), least trimmed squares (&quot;lts&quot;), metric trimming (&quot;trimmed&quot;), 
metric winsorizing (&quot;winsor&quot;) and Tukey's biweight (&quot;tukey&quot;).</p>
</td></tr>
<tr><td><code id="drm_+3A_logdose">logDose</code></td>
<td>
<p>a numeric value or NULL. If log doses value are provided the base of the logarithm should be specified (exp(1) for the natural logarithm
and 10 for 10-logarithm).</p>
</td></tr>
<tr><td><code id="drm_+3A_control">control</code></td>
<td>
<p>a list of arguments controlling constrained optimisation (zero as boundary), 
maximum number of iteration in the optimisation,
relative tolerance in the optimisation, warnings issued during the optimisation.</p>
</td></tr>
<tr><td><code id="drm_+3A_lowerl">lowerl</code></td>
<td>
<p>a numeric vector of lower limits for all parameters in the model 
(the default corresponds to minus infinity for all parameters).</p>
</td></tr>  
<tr><td><code id="drm_+3A_upperl">upperl</code></td>
<td>
<p>a numeric vector of upper limits for all parameters in the model 
(the default corresponds to plus infinity for all parameters).</p>
</td></tr>
<tr><td><code id="drm_+3A_separate">separate</code></td>
<td>
<p>logical value indicating whether curves should be fit separately (independent of each other).</p>
</td></tr>
<tr><td><code id="drm_+3A_pshifts">pshifts</code></td>
<td>
<p>a matrix of constants to be added to the matrix of parameters. Default is no shift for all parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function relies on the general optimiser function <code><a href="stats.html#topic+optim">optim</a></code> for the minimisation of negative log likelihood function. 
For a continuous response this reduces to least squares estimation, which is carried out by minimising the following sums of squares
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^N [w_i (y_i-f_i)]^2</code>
</p>

<p>where <code class="reqn">y_i</code>, <code class="reqn">f_i</code>, and <code class="reqn">w_i</code> correspond to the observed value, expected value, and the weight respectively, for the ith observation (from 1 to <code class="reqn">N</code>).
</p>
<p>The control arguments are specified using the function <code><a href="#topic+drmc">drmc</a></code>.
</p>
<p>Setting <code>lowerl</code> and/or <code>upperl</code> automatically invokes constrained optimisation.
</p>
<p>The columns of a data frame argument to <code>pmodels</code> are automatically converted into factors. 
This does not happen if a list is specified.   
</p>


<h3>Value</h3>

<p>An object of class 'drc'. 
</p>


<h3>Note</h3>

<p>For robust estimation MAD (median abslolute deviance) is used to estimate the residual variance.  
</p>


<h3>Author(s)</h3>

<p>Christian Ritz and Jens C. Streibig</p>


<h3>See Also</h3>

<p>Examples using <code><a href="#topic+drm">drm</a></code> found in the help pages of <code><a href="#topic+ryegrass">ryegrass</a></code> (continuous data), 
<code><a href="#topic+secalonic">secalonic</a></code> (continuous data), and <code><a href="#topic+selenium">selenium</a></code> (binomial data), 
as well as for a number of other datasets and functions in <code>drc</code>.
</p>

<hr>
<h2 id='drmc'>Sets control arguments</h2><span id='topic+drmc'></span>

<h3>Description</h3>

<p>Set control arguments in the control argument in the function 'drm'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  drmc(constr = FALSE, errorm = TRUE, maxIt = 500, method="BFGS", 
  noMessage = FALSE, relTol = 1e-07, rmNA=FALSE, useD = FALSE, 
  trace = FALSE, otrace = FALSE, warnVal = -1, dscaleThres = 1e-15, rscaleThres = 1e-15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drmc_+3A_constr">constr</code></td>
<td>
<p>logical. If TRUE optimisation is constrained, only yielding non-negative parameters.</p>
</td></tr>
<tr><td><code id="drmc_+3A_errorm">errorm</code></td>
<td>
<p>logical specifying whether failed convergence in <code><a href="#topic+drm">drm</a></code> should result 
in an error or only a warning.</p>
</td></tr>
<tr><td><code id="drmc_+3A_maxit">maxIt</code></td>
<td>
<p>numeric. The maximum number of iterations in the optimisation procedure.</p>
</td></tr>
<tr><td><code id="drmc_+3A_method">method</code></td>
<td>
<p>character string. The method used in the optimisation procedure. 
See <code><a href="stats.html#topic+optim">optim</a></code> for available methods.</p>
</td></tr>
<tr><td><code id="drmc_+3A_nomessage">noMessage</code></td>
<td>
<p>logical, specifying whether or not messages should be displayed.</p>
</td></tr>
<tr><td><code id="drmc_+3A_reltol">relTol</code></td>
<td>
<p>numeric. The relative tolerance in the optimisation procedure.</p>
</td></tr>
<tr><td><code id="drmc_+3A_rmna">rmNA</code></td>
<td>
<p>logical. Should NAs be removed from sum of squares used for estimation? 
Default is FALSE (not removed).</p>
</td></tr>
<tr><td><code id="drmc_+3A_used">useD</code></td>
<td>
<p>logical. If TRUE derivatives are used for estimation (if available).</p>
</td></tr>  
<tr><td><code id="drmc_+3A_trace">trace</code></td>
<td>
<p>logical. If TRUE the trace from <code><a href="stats.html#topic+optim">optim</a></code> is displayed.</p>
</td></tr>  
<tr><td><code id="drmc_+3A_otrace">otrace</code></td>
<td>
<p>logical. If TRUE the output from <code><a href="stats.html#topic+optim">optim</a></code> is displayed.</p>
</td></tr>  
<tr><td><code id="drmc_+3A_warnval">warnVal</code></td>
<td>
<p>numeric. If equal to 0 then the warnings are stored and displayed at the end. 
See under 'warn' in <code><a href="base.html#topic+options">options</a></code>. The default results in suppression of warnings.</p>
</td></tr>
<tr><td><code id="drmc_+3A_dscalethres">dscaleThres</code></td>
<td>
<p>numeric value specifying the threshold for dose scaling.</p>
</td></tr>
<tr><td><code id="drmc_+3A_rscalethres">rscaleThres</code></td>
<td>
<p>numeric value specifying the threshold for response scaling.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 8 components, one for each of the above arguments.
</p>


<h3>Note</h3>

<p>The use of a non-zero constant <code>bcAdd</code> may in some cases 
make it more difficult to obtain convergence of the estimation procedure.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Displaying the default settings
drmc()  

### Using 'method' argument
model1 &lt;- drm(ryegrass, fct = LL.4())

model2 &lt;- drm(ryegrass, fct = LL.4(),
control = drmc(method = "Nelder-Mead"))

</code></pre>

<hr>
<h2 id='earthworms'>Earthworm toxicity test</h2><span id='topic+earthworms'></span>

<h3>Description</h3>

<p>The dataset was obtained from a toxicity test using earthworms, and it contains the number of earthworms 
remaining in a container that was contaminated with a toxic substance (not disclosed) at various doses; so the number of earthworms not migrating to the neighbouring uncontaminated container.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(earthworms)</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose values</p>
</dd>
<dt><code>number</code></dt><dd><p>a numeric vector containing counts of remaining earthworms in the container</p>
</dd>
<dt><code>total</code></dt><dd><p>a numeric vector containing total number of earthworms put in the containers</p>
</dd>
</dl>



<h3>Details</h3>

<p>At dose 0 around half of the earthworms is expected be in each of the two containers. Thus it is not 
appropriate to fit an ordinary logistic regression with log(dose) as explanatory variable to these data
as it implies an upper limit of 1 at dose 0 and in fact this model does not utilise the observations
at dose 0 (see the example section below). 
</p>


<h3>Source</h3>

<p>The dataset is kindly provided by Nina Cedergreen, Faculty of Life Sciences, University of Copenhagen, 
Denmark.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a logistic regression model
earthworms.m1 &lt;- drm(number/total~dose, weights = total, data = earthworms,
fct = LL.2(), type = "binomial")
modelFit(earthworms.m1)  # a crude goodness-of-fit test

## Fitting an extended logistic regression model 
##  where the upper limit is estimated
earthworms.m2 &lt;- drm(number/total~dose, weights = total, data = earthworms,
fct = LL.3(), type = "binomial")
modelFit(earthworms.m2)  # goodness-of-fit test
# improvement not visible in test!!!

## Comparing model1 and model2 
## (Can the first model be reduced to the second model?)
anova(earthworms.m1, earthworms.m2)

</code></pre>

<hr>
<h2 id='ED.drc'>Estimating effective doses</h2><span id='topic+ED'></span><span id='topic+ED.drc'></span>

<h3>Description</h3>

<p><code>ED</code> estimates effective doses (ECp/EDp/ICp) for given reponse levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drc'
ED(object, respLev, interval = c("none", "delta", "fls", "tfls"), 
  clevel = NULL, level = ifelse(!(interval == "none"), 0.95, NULL),
  reference = c("control", "upper"), type = c("relative", "absolute"), lref, uref,
  bound = TRUE, od = FALSE, vcov. = vcov, display = TRUE, pool = TRUE, logBase = NULL, 
  multcomp = FALSE, ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ED.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_resplev">respLev</code></td>
<td>
<p>a numeric vector containing the response levels.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_interval">interval</code></td>
<td>
<p>character string specifying the type of confidence intervals to be supplied. The default is &quot;none&quot;. 
Use &quot;delta&quot; for asymptotics-based confidence intervals (using the delta method and the t-distribution).
Use &quot;fls&quot; for from logarithm scale based confidence intervals (in case the parameter in the model is log(ED50) as for
the <code><a href="#topic+llogistic2">llogistic2</a></code>) models. The only alternative for model-robust fits is using inverse regression.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_clevel">clevel</code></td>
<td>
<p>character string specifying the curve id in case on estimates for a specific curve or compound is requested. By default estimates
are shown for all curves.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_reference">reference</code></td>
<td>
<p>character string. Is the upper limit or the control level the reference?</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_type">type</code></td>
<td>
<p>character string. Whether the specified response levels are absolute or relative (default).</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_lref">lref</code></td>
<td>
<p>numeric value specifying the lower limit to serve as reference.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_uref">uref</code></td>
<td>
<p>numeric value specifying the upper limit to serve as reference (e.g., 100%).</p>
</td></tr>  
<tr><td><code id="ED.drc_+3A_bound">bound</code></td>
<td>
<p>logical. If TRUE only ED values between 0 and 100% are allowed. FALSE is useful for hormesis models.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_vcov.">vcov.</code></td>
<td>
<p>function providing the variance-covariance matrix. <code><a href="stats.html#topic+vcov">vcov</a></code> is the default, 
but <code>sandwich</code> is also an option (for obtaining robust standard errors).</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_logbase">logBase</code></td>
<td>
<p>numeric. The base of the logarithm in case logarithm transformed dose values are used.</p>
</td></tr>  
<tr><td><code id="ED.drc_+3A_multcomp">multcomp</code></td>
<td>
<p>logical to switch on output for use with the package multcomp (which needs to be activated first). Default is FALSE (corresponding to the original output).</p>
</td></tr>
<tr><td><code id="ED.drc_+3A_...">...</code></td>
<td>
<p>see the details section below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For hormesis models (<code><a href="#topic+braincousens">braincousens</a></code> and <code><a href="#topic+cedergreen">cedergreen</a></code>), the additional 
arguments <code>lower</code> and <code>upper</code> may be supplied. These arguments specify the lower and upper limits 
of the bisection method used to find the ED values.  The lower and upper limits need to be smaller/larger 
than the EDx level to be calculated. The default limits are 0.001 and 1000 for <code>braincousens</code> and 
0.0001 and 10000 for <code>cedergreen</code> and <code><a href="#topic+ucedergreen">ucedergreen</a></code>, but this may need to be modified 
(for <code><a href="#topic+cedergreen">cedergreen</a></code> the upper limit may need to be increased and for <code><a href="#topic+ucedergreen">ucedergreen</a></code> 
the lower limit may need to be increased). Note that the lower limit should not be set to 0 (use instead 
something like 1e-3, 1e-6, ...).
</p>


<h3>Value</h3>

<p>An invisible matrix containing the shown matrix with two or more columns, containing the estimates 
and the corresponding estimated standard errors and possibly lower and upper confidence limits.
Or, alternatively, a list with elements that may be plugged directly into <code>parm</code> 
in the package <em>multcomp</em> (in case the argument <code>multcomp</code> is TRUE).
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p><code><a href="#topic+backfit">backfit</a></code>, <code><a href="#topic+isobole">isobole</a></code>, and <code><a href="#topic+maED">maED</a></code> use <code><a href="#topic+ED">ED</a></code> for specific calculations involving estimated ED values.
</p>
<p>The related function <code><a href="#topic+EDcomp">EDcomp</a></code> may be used for estimating differences and ratios of ED values, 
whereas <code><a href="#topic+compParm">compParm</a></code> may be used to compare other model parameters. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting 4-parameter log-logistic model
ryegrass.m1 &lt;- drm(ryegrass, fct = LL.4())

## Calculating EC/ED values
ED(ryegrass.m1, c(10, 50, 90)) 
## first column: the estimates of ED10, ED50 and ED90
## second column: the corresponding estimated standard errors 

### How to use the argument 'ci'

## Also displaying 95% confidence intervals
ED(ryegrass.m1, c(10, 50, 90), interval = "delta")

## Comparing delta method and back-transformed 
##  confidence intervals for ED values

## Fitting 4-parameter log-logistic 
##  in different parameterisation (using LL2.4)
ryegrass.m2 &lt;- drm(ryegrass, fct = LL2.4())  

ED(ryegrass.m1, c(10, 50, 90), interval = "fls")
ED(ryegrass.m2, c(10, 50, 90), interval = "delta")


### How to use the argument 'bound'

## Fitting the Brain-Cousens model
lettuce.m1 &lt;- drm(weight ~ conc, 
data = lettuce, fct = BC.4())

### Calculating ED[-10]

# This does not work
#ED(lettuce.m1, -10)  

## Now it does work
ED(lettuce.m1, -10, bound = FALSE)  # works
ED(lettuce.m1, -20, bound = FALSE)  # works

## The following does not work for another reason: ED[-30] does not exist 
#ED(lettuce.m1, -30, bound = FALSE)  

</code></pre>

<hr>
<h2 id='EDcomp'>Comparison of relative potencies between dose-response curves</h2><span id='topic+EDcomp'></span><span id='topic+relpot'></span>

<h3>Description</h3>

<p>Relative potencies (also called selectivity indices) for arbitrary doses are compared between
fitted dose-response curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  EDcomp(object, percVec, percMat = NULL, compMatch = NULL, od = FALSE, vcov. = vcov, 
  reverse = FALSE, 
  interval = c("none", "delta", "fieller", "fls"), 
  level = ifelse(!(interval == "none"), 0.95, NULL),
  reference = c("control", "upper"),  
  type = c("relative", "absolute"),
  display = TRUE, pool = TRUE, logBase = NULL, 
  multcomp = FALSE, ...)
  
  relpot(object, plotit = TRUE, compMatch = NULL, percVec = NULL, interval = "none", 
  type = c("relative", "absolute"), 
  scale = c("original", "percent", "unconstrained"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EDcomp_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_percvec">percVec</code></td>
<td>
<p>a numeric vector of dosage values.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_percmat">percMat</code></td>
<td>
<p>a matrix with 2 columns providing the pairs of indices <code>percVec</code> to be compared. 
By default all pairs are compared.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_compmatch">compMatch</code></td>
<td>
<p>an optional character vector of names of assays to be compared. If not specified all comparisons are supplied.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used. This argument only makes a difference for
binomial data.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_vcov.">vcov.</code></td>
<td>
<p>function providing the variance-covariance matrix. <code><a href="stats.html#topic+vcov">vcov</a></code> is the default, 
but <code>sandwich</code> is also an option (for obtaining robust standard errors).</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_reverse">reverse</code></td>
<td>
<p>logical. If TRUE the order of comparison of two curves is reversed.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_interval">interval</code></td>
<td>
<p>character string specifying the type of confidence intervals to be supplied. The default is &quot;none&quot;. 
Use &quot;delta&quot; for asymptotics-based confidence intervals (using the delta method and the t-distribution).
Use &quot;fieller&quot; for confidence intervals based on Fieller's theorem (with help from the delta method).
Use &quot;fls&quot; for confidence interval back-transformed from logarithm scale (in case the parameter in the model fit is 
log(ED50) as is the case for the <code><a href="#topic+logistic">logistic</a></code> or <code><a href="#topic+llogistic2">llogistic2</a></code> models); currently
the argument <code>logBase</code> then also needs to be specified.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. Default is 0.95.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_reference">reference</code></td>
<td>
<p>character string. Is the upper limit or the control level the reference?</p>
</td></tr>  
<tr><td><code id="EDcomp_+3A_type">type</code></td>
<td>
<p>character string specifying whether absolute or relative response levels are supplied.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_logbase">logBase</code></td>
<td>
<p>numeric. The base of the logarithm in case logarithm transformed dose values are used.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr>
<tr><td><code id="EDcomp_+3A_multcomp">multcomp</code></td>
<td>
<p>logical to switch on output for use with the package multcomp (which needs to be activated first). Default is FALSE (corresponding to the original output).</p>
</td></tr>  
<tr><td><code id="EDcomp_+3A_...">...</code></td>
<td>
<p>In <code>SI</code>: additional arguments to the function doing the calculations. 
For instance the upper limit for the bisection method 
needs to be larger than the ED values used in the required relative pontency.
In <code>relpot</code>: additional graphical parameters.</p>
</td></tr>  
<tr><td><code id="EDcomp_+3A_plotit">plotit</code></td>
<td>
<p>logical. If TRUE the relative potencies are plotted as a function of the response level.</p>
</td></tr>    
<tr><td><code id="EDcomp_+3A_scale">scale</code></td>
<td>
<p>character string indicating the scale to be used on the x axis: original or percent response level
(only having an effect for type=&quot;relative&quot;).</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>The function <code>relpot</code> is a convenience function, which is useful for assessing how the relative potency
changes as a function of the response level (e.g., for plotting as outlined by Ritz <em>et al</em> (2006)).
</p>
<p>Fieller's theorem is incorporated using the formulas provided by Kotz and Johnson (1983) and Finney (1978).
</p>
<p>For objects of class 'braincousens' or 'mlogistic' the additional argument may be the 'upper' argument
or the 'interval' argument. The 'upper' argument specifies the upper limit of the bisection method. 
The upper limits needs to be larger than the EDx level to be calculated. The default limit is 1000.
The 'interval' argument should specify a rough interval in which the dose
yielding the maximum hormetical response lies. The default interval is 'c(0.001, 1000)'. 
Notice that the lower limit should not be set to 0 (use something like 1e-3, 1e-6, ...).
</p>


<h3>Value</h3>

  
<p>An invisible matrix containing the shown matrix with two or more columns, containing the estimates 
and the corresponding estimated standard errors and possibly lower and upper confidence limits.
Or, alternatively, a list with elements that may be plugged directly into <code>parm</code> 
in the package <em>multcomp</em> (in case the argument <code>multcomp</code> is TRUE).
</p>


<h3>Note</h3>

<p>This function only works for the following built-in functions available in the package <em>drc</em>: 
<code><a href="#topic+braincousens">braincousens</a></code>, <code><a href="#topic+cedergreen">cedergreen</a></code>, <code><a href="#topic+ucedergreen">ucedergreen</a></code>, <code><a href="#topic+llogistic">llogistic</a></code>,
and <code><a href="#topic+weibull1">weibull1</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Finney, D. J. (1978) <em>Statistical method in Biological Assay</em>, London: Charles Griffin House, 
3rd edition (pp. 80&ndash;82).
</p>
<p>Kotz, S. and Johnson, N. L. (1983) <em>Encyclopedia of Statistical Sciences Volume 3</em>, 
New York: Wiley \&amp; Sons (pp. 86&ndash;87).
</p>
<p>Ritz, C. and Cedergreen, N. and Jensen, J. E. and Streibig, J. C. (2006) 
Relative potency in nonsimilar dose-response curves, <em>Weed Science</em>, <b>54</b>, 407&ndash;412.
</p>


<h3>See Also</h3>

<p>A related function is <code><a href="#topic+ED.drc">ED.drc</a></code> (used for calculating effective doses).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spinach.LL.4 &lt;- drm(SLOPE~DOSE, CURVE, data = spinach, fct = LL.4())

EDcomp(spinach.LL.4, c(50,50))
EDcomp(spinach.LL.4, c(10,50))
EDcomp(spinach.LL.4, c(10,50), reverse = TRUE)

## Using the package multcomp
#sires &lt;- SI(spinach.LL.4, c(25, 50, 75))
#library(multcomp)
#summary(glht(parm(sires[[2]][[1]], sires[[2]][[2]]), rhs = 1))

## Comparing specific ratios: 25/25, 50/50, 75/75
#sires2 &lt;- SI(spinach.LL.4, c(25, 50, 75), matrix(c(1, 1, 2, 2, 3, 3), 3, 2, byrow = TRUE))
#library(multcomp)
#summary(glht(parm(sires2[[2]][[1]], sires2[[2]][[2]]), rhs = 1))


## Relative potency of two herbicides
m2 &lt;- drm(DryMatter~Dose, Herbicide, 
data = S.alba, fct = LL.3())

EDcomp(m2, c(50, 50))  
EDcomp(m2, c(50, 50), interval = "delta")
EDcomp(m2, c(50, 50), interval = "fieller")

## Comparison based on an absolute
##  response level

m3 &lt;- drm(SLOPE~DOSE, CURVE,
data = spinach, fct = LL.4())

EDcomp(m3, c(0.5,0.5), compMatch = c(2,4), type = "absolute", interval = "fieller")

EDcomp(m3, c(55,80), compMatch = c(2,4))  
# same comparison using a relative response level


## Relative potency transformed from log scale
m4 &lt;- drm(drymatter~log(dose), treatment, data=G.aparine[-c(1:40), ], 
pmodels = data.frame(treatment,treatment,1,treatment), fct = LL2.4())

EDcomp(m4, c(50,50), interval = "fls", logBase = exp(1))

</code></pre>

<hr>
<h2 id='etmotc'>Effect of erythromycin on mixed sewage microorganisms</h2><span id='topic+etmotc'></span>

<h3>Description</h3>

<p>Relative growth rate in biomass of mixed sewage microorganisms (per hour) as a function of
increasing concentrations of the antibiotic erythromycin (mg/l).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(etmotc)</code></pre>


<h3>Format</h3>

<p>A data frame with 57 observations on the following 4 variables.
</p>

<dl>
<dt><code>cell</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>dose1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>pct1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>rgr1</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data stem from an experiment investigating the effect of pharmaceuticals,
that are used in human and veterinary medicine and that are being released into the aquatic environment through
waste water or through manure used for fertilising agricultural land. The experiment constitutes a typical
dose-response situation. The dose is concentration of the antibiotic erythromycin (mg/l), which is an antibiotic
that can be used by persons or animals showing allergy to penicillin, and the measured response is the relative
growth rate in biomass of mixed sewage microorganisms (per hour), measured as turbidity two hours after exposure
by means of a spectrophotometer. The experiment was designed in such a way that eight replicates were assigned
to the control (dose 0), but no replicates were assigned to the 7 non-zero doses. Further details are found in
Christensen et al (2006).
</p>


<h3>Source</h3>

<p>Christensen, A. M. and Ingerslev, F. and Baun, A. 2006 
Ecotoxicity of mixtures of antibiotics used in aquacultures, 
<em>Environmental Toxicology and Chemistry</em>, <b>25</b>, 2208&ndash;2215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
etmotc.m1&lt;-drm(rgr1~dose1, data=etmotc[1:15,], fct=LL.4())
plot(etmotc.m1)
modelFit(etmotc.m1)
summary(etmotc.m1)

etmotc.m2&lt;-drm(rgr1~dose1, data=etmotc[1:15,], fct=W2.4())
plot(etmotc.m2, add = TRUE)
modelFit(etmotc.m2)
summary(etmotc.m2)

etmotc.m3&lt;-drm(rgr1~dose1, data=etmotc[1:15,], fct=W2.3())
plot(etmotc.m3, add = TRUE)
modelFit(etmotc.m3)
summary(etmotc.m3)

</code></pre>

<hr>
<h2 id='EXD'>Exponential decay model</h2><span id='topic+EXD.2'></span><span id='topic+EXD.3'></span>

<h3>Description</h3>

<p>Exponential decay model with or without a nonzero lower limit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  EXD.2(fixed = c(NA, NA), names = c("d", "e"), ...)

  EXD.3(fixed = c(NA, NA, NA), names = c("c", "d", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EXD_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="EXD_+3A_names">names</code></td>
<td>
<p>vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default parameter names are: init, plateau, k.</p>
</td></tr>
<tr><td><code id="EXD_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>The exponential decay model is a three-parameter model with mean function:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = c + (d-c)(\exp(-x/e))</code>
</p>

<p>The parameter init is the upper limit (attained at <code class="reqn">x=0</code>), the parameter plateau is the lower limit 
reached for x going to infinity and the parameter <code class="reqn">e&gt;0</code> is determining the steepness of the 
decay. The curve is monotonously decreasing in <code class="reqn">x</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>drcMean</code>, containing the mean function, the self starter function,
the parameter names and other components such as derivatives and a function for calculating ED values.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Organisation for Economic Co-operation and Development (OECD) (2006)
<em>Current approaches in the statistical analysis of ecotoxicity data: A guidance to application - annexes</em>,
Paris: OECD (p. 80).
</p>


<h3>See Also</h3>

<p>Similar models giving exponential increasing curves are <code><a href="#topic+AR.2">AR.2</a></code> and <code><a href="#topic+AR.3">AR.3</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting an exponential decay model
ryegrass.m1&lt;-drm(rootl~conc, data=ryegrass, fct=EXD.3())

plot(ryegrass.m1)

summary(ryegrass.m1)

</code></pre>

<hr>
<h2 id='finney71'>Example from Finney (1971)</h2><span id='topic+finney71'></span>

<h3>Description</h3>

<p>For each of six concentration of an insecticid the number of insects affected (out of the number of insects)
was recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(finney71)</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>total</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>affected</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Finney, D. J. (1971) <em>Probit Analysis</em>, Cambridge: Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Model with ED50 as a parameter
finney71.m1 &lt;- drm(affected/total ~ dose, weights = total,
data = finney71, fct = LL.2(), type = "binomial")

summary(finney71.m1)
plot(finney71.m1, broken = TRUE, bp = 0.1, lwd = 2)

ED(finney71.m1, c(10, 20, 50), interval = "delta", reference = "control")

## Model fitted with 'glm'
#fitl.glm &lt;- glm(cbind(affected, total-affected) ~ log(dose),
#family=binomial(link = logit), data=finney71[finney71$dose != 0, ])
#summary(fitl.glm)  # p-value almost agree for the b parameter
#
#xp &lt;- dose.p(fitl.glm, p=c(0.50, 0.90, 0.95))  # from MASS
#xp.ci &lt;- xp + attr(xp, "SE") %*% matrix(qnorm(1 - 0.05/2)*c(-1,1), nrow=1)
#zp.est &lt;- exp(cbind(xp.ci[,1],xp,xp.ci[,2]))
#dimnames(zp.est)[[2]] &lt;- c("zp.lcl","zp","zp.ucl")
#zp.est  # not far from above results with 'ED'

## Model with log(ED50) as a parameter
finney71.m2 &lt;- drm(affected/total ~ dose, weights = total,
data = finney71, fct = LL2.2(), type = "binomial")

## Confidence intervals based on back-transformation
##  complete agreement with results based on 'glm'
ED(finney71.m2, c(10, 20, 50), interval = "fls", reference = "control")

</code></pre>

<hr>
<h2 id='fitted.drc'>Extract fitted values from model</h2><span id='topic+fitted.drc'></span>

<h3>Description</h3>

<p>Extracts fitted values from an object of class 'drc'. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
fitted(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="fitted.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted values extracted from 'object'.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())
plot(fitted(ryegrass.m1), residuals(ryegrass.m1))  # a residual plot

</code></pre>

<hr>
<h2 id='fplogistic'>Fractional polynomial-logistic dose-response models</h2><span id='topic+fplogistic'></span><span id='topic+FPL.4'></span>

<h3>Description</h3>

<p>Model function for specifying dose-response models that are a combination of a logistic model and an appropriate 
class of fractional polynomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fplogistic(p1, p2, fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), 
method = c("1", "2", "3", "4"), ssfct = NULL, fctName, fctText)

FPL.4(p1, p2, fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fplogistic_+3A_p1">p1</code></td>
<td>
<p>numeric denoting the negative power of log(dose+1) in the fractional polynomial.</p>
</td></tr>
<tr><td><code id="fplogistic_+3A_p2">p2</code></td>
<td>
<p>numeric denoting the positive power of log(dose+1) in the fractional polynomial.</p>
</td></tr>
<tr><td><code id="fplogistic_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="fplogistic_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e, f 
(see under 'Details').</p>
</td></tr>
<tr><td><code id="fplogistic_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="fplogistic_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="fplogistic_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="fplogistic_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr> 
<tr><td><code id="fplogistic_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+fplogistic">fplogistic</a></code>).</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The fractional polynomial dose-response models introduced by Namata <em>et al.</em> (2008) are implemented
using the logistic model as base.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Namata, Harriet and Aerts, Marc and Faes, Christel and Teunis, Peter (2008)
Model Averaging in Microbial Risk Assessment Using Fractional Polynomials,
<em>Risk Analysis</em> <b>28</b>, 891&ndash;905.
</p>


<h3>See Also</h3>

<p>Examples are found <code><a href="#topic+maED">maED</a></code>.
</p>

<hr>
<h2 id='G.aparine'>Herbicide applied to Galium aparine</h2><span id='topic+G.aparine'></span>

<h3>Description</h3>

<p>Small plants of <em>Galium aparine</em>, growing in pots in a green house, were sprayed with the technical 
grade phenmidipham herbicide either alone or in mixture with an ester of oleic acid. 
The plants were allowed to grow in the green house for 14 days after herbicide treatment. 
Then the dry matter was measured per pot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(G.aparine)</code></pre>


<h3>Format</h3>

<p>A data frame with 240 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose value (g/ha)</p>
</dd>
<dt><code>drymatter</code></dt><dd><p>a numeric vector of dry matter weights (mg/pot)</p>
</dd>
<dt><code>treatment</code></dt><dd><p>a numeric vector giving the grouping: 0: control, 1,2: herbicide formulations</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cabanne, F., Gaudry, J. C. and Streibig, J. C. (1999) Influence of alkyl oleates on efficacy 
of phenmedipham applied as an acetone:water solution on Galium aparine, 
<em>Weed Research</em>, <b>39</b>, 57&ndash;67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a model with a common control (so a single upper limit: "1")
G.aparine.m1 &lt;- drm(drymatter ~ dose, treatment, data = G.aparine, 
pmodels = data.frame(treatment, treatment, 1, treatment), fct = LL.4())

## Visual inspection of fit
plot(G.aparine.m1, broken = TRUE)

## Lack of fit test
modelFit(G.aparine.m1)

## Summary output
summary(G.aparine.m1)

## Predicted values with se and confidence intervals
#predict(G.aparine.m1, interval = "confidence")
# long output

## Calculating the relative potency
EDcomp(G.aparine.m1, c(50,50))

## Showing the relative potency as a
## function of the response level
relpot(G.aparine.m1)
relpot(G.aparine.m1, interval = "delta")
# appears constant!

## Response level in percent
relpot(G.aparine.m1, scale = "percent")

## Fitting a reduced model (with a common slope parameter)
G.aparine.m2 &lt;- drm(drymatter ~ dose, treatment, data = G.aparine, 
pmodels = data.frame(1, treatment, 1, treatment), fct = LL.4())

anova(G.aparine.m2, G.aparine.m1)

## Showing the relative potency 
relpot(G.aparine.m2)

## Fitting the same model in a different parameterisation
G.aparine.m3 &lt;- drm(drymatter ~ dose, treatment, data = G.aparine, 
pmodels = data.frame(treatment, treatment, 1, treatment), fct = LL2.4())

EDcomp(G.aparine.m3, c(50, 50), logBase = exp(1))

</code></pre>

<hr>
<h2 id='gammadr'>
Gamma dose-response model
</h2><span id='topic+gammadr'></span>

<h3>Description</h3>

<p>The gamma dose-response model is a four-parameter model derived from the cumulative distribution function of the gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gammadr(fixed = c(NA, NA, NA, NA), 
  names = c("b", "c", "d", "e"), fctName, fctText)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gammadr_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector specifying which parameters are fixed and at what value they are fixed. 
NAs are used for parameters that are not fixed.</p>
</td></tr>
<tr><td><code id="gammadr_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage').</p>
</td></tr>
<tr><td><code id="gammadr_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="gammadr_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Following Wheeler and Bailer (2009) the model function is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = c + (d-c) * pgamma(b*x, e, 1)</code>
</p>

<p>This model is only suitable for increasing dose-response data.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Wheeler, M. W., Bailer, A. J. (2009)
Comparing model averaging with other model selection strategies for benchmark dose estimation,
<em>Environmental and Ecological Statistics</em>, <b>16</b>, 37&ndash;51.
</p>

<hr>
<h2 id='gaussian'>
Normal and log-normal biphasic dose-response models
</h2><span id='topic+gaussian'></span><span id='topic+lgaussian'></span>

<h3>Description</h3>

<p>Model functions for fitting symmetric or skewed bell-shaped/biphasic dose-response patterns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    gaussian(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), 
    method = c("1", "2", "3", "4"), ssfct = NULL, fctName, fctText, loge = FALSE)
    
    lgaussian(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", 
    "d", "e", "f"), method = c("1", "2", "3", "4"), ssfct = NULL, 
    fctName, fctText, loge = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gaussian_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="gaussian_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e, f 
(see under 'Details').</p>
</td></tr>
<tr><td><code id="gaussian_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr> 
<tr><td><code id="gaussian_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="gaussian_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="gaussian_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr> 
<tr><td><code id="gaussian_+3A_loge">loge</code></td>
<td>
<p>logical indicating whether or not e or log(e) should be a parameter in the model. By default e is a model parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details yet to be provided.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>The functions are for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>

<hr>
<h2 id='germination'>
Germination of three crops
</h2><span id='topic+germination'></span>

<h3>Description</h3>

<p>Germination data were obtained from experiments involving the three species mungbean, rice, and wheat, which were opposed
to different temperatures between 10 and 40 degrees Celsius. Experiments lasted at most 18 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(germination)</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 5 variables.
</p>

<dl>
<dt><code>temp</code></dt><dd><p>a numeric vector of temperatures that seeds were exposed to</p>
</dd>
<dt><code>species</code></dt><dd><p>a factor with levels <code>mungbean</code> <code>rice</code> <code>wheat</code></p>
</dd>
<dt><code>start</code></dt><dd><p>a numeric vector of left endpoints of the monitoring intervals</p>
</dd>
<dt><code>end</code></dt><dd><p>a numeric vector of right endpoints of the monitoring intervals</p>
</dd>
<dt><code>germinated</code></dt><dd><p>a numeric vector giving the numbers of seeds germinated</p>
</dd>
</dl>



<h3>Details</h3>

<p>For each of the three species mungbean, rice, and wheat, a total of 20 seeds were uniformly distributed on filter paper in a petri dish (diameter: 9.0cm) 
and then placed in dark climate cabinets with different temperatures (10, 16, 22, 28, 34, 40 degrees Celsius). Not all of the temperatures were applied to all species. 
The germinated seeds were counted and removed from the petri dish on a daily basis up to 18 days (or until all seeds had germinated). I
</p>
<p>n this experiment we also assume that the upper limit of the proportion germinated is a parameter that has to be estimated from the data. Moreover, we assume 
that different combinations of species and temperature may lead to different germination curves with respect to slope, time required for 50% germination, and upper limit.
</p>


<h3>References</h3>

<p>Ritz, C., Pipper, C. B. and Streibig, J. C. (2013) Analysis of germination data from agricultural experiments, <em>Europ. J. Agronomy</em>, <b>45</b>, 1&ndash;6.  
</p>


<h3>See Also</h3>

<p>Analysis of a single germination curve is shown for <code><a href="#topic+chickweed">chickweed</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting two-parameter log-logistic curves to each combination of species and temperature 
##  (upper limit fixed at 1)
## Note: Rows 24 and 62 are omitted from the dataset (all mungbean seeds germinated 
##  and thus no right-censoring in this case)

## germLL.2 &lt;- drm(germinated ~ start + end, species:factor(temp), 
## data = germination[c(1:23, 25:61, 63:192), ], fct = LL.2(), type = "event")
## plot(germLL.2, ylim=c(0, 1.5), legendPos=c(2.5,1.5))  # plotting the fitted curves and the data
## summary(germLL.2)  # showing the parameter estimates

## Fitting two-parameter log-logistic curves to each combination of species and temperature
## Note: the argument "start" may be used for providing sensible initial 
##  parameter values for estimation procedure (is needed occasionally)
##  (initial values were obtained from the model fit germLL.2)
## Note also: the argument "upper" ensures that the upper limit cannot exceed 1
## (however, no restrictions are imposed on the two remaining parameters 
## (as indicated by an infinite value)

## germLL.3 &lt;- drm(germinated~start+end, species:factor(temp), 
## data = germination[c(1:23, 25:61, 63:192), ], fct = LL.3(), type = "event",
## start = c(coef(germLL.2)[1:13], rep(0.7,13), coef(germLL.2)[14:26]), 
## upper = c(rep(Inf, 13), rep(1, 13), rep(Inf, 13)))

## Plotting the fitted curves and the data
## plot(germLL.3, ylim = c(0, 1.5), legendPos = c(2.5,1.5))

## Showing the parameter estimates
## summary(germLL.3)

## Showing the parameter estimates with robust standard errors
## library(lmtest)
## coeftest(germLL.3, vcov = sandwich) 

## Calculating t50 with associated standard errors
## ED(germLL.3, 50)

## Calculating t10, t20, t50 with 95% confidence intervals
## ED(germLL.3, c(10, 20, 50), interval = "delta")

## Comparing t50 between combinations by means of approximate t-tests
## compParm(germLL.3, "e", "-")

## Making plots of fitted regression curves for each species

## Plot for mungbean
#plot(germLL.3, log="", ylim=c(0, 1), xlim=c(0, 20), 
#level=c("mungbean:10", "mungbean:16"), 
#lty=2:3, lwd = 1.5,
#xlab="Time (days)", 
#ylab="Proportion germinated",  
#main="Mungbean",
#legendPos=c(3, 1.05), legendText=c(expression(10*degree), expression(16*degree)))

## Plot for rice
#plot(germLL.3, log="", ylim=c(0, 1), xlim=c(0, 20), 
#level=c("rice:16", "rice:22", "rice:28", "rice:34", "rice:40"), 
#lty=2:6, lwd = 1.5,
#xlab="Time (days)", 
#ylab="Proportion germinated",
#main="Rice",   
#pch=2:6,
#legendPos=c(3, 1.05), legendText=c(expression(16*degree), expression(22*degree), 
#expression(28*degree), expression(34*degree), expression(40*degree)))

## Plot for wheat
#plot(germLL.3, log="", ylim=c(0, 1), xlim=c(0, 20), 
#level=c("wheat:10", "wheat:16", "wheat:22", "wheat:28", "wheat:34", "wheat:40"), 
#lty=c("dashed","dotted","dotdash","longdash","twodash","232A"), lwd = 1.5,
#xlab="Time (days)", 
#ylab="Proportion germinated", 
#main="Wheat",
#legendPos=c(3, 1.05), 
#legendText=c(expression(10*degree), expression(16*degree), expression(22*degree), 
#expression(28*degree), expression(34*degree), expression(40*degree)))

</code></pre>

<hr>
<h2 id='getInitial'>
Showing starting values used
</h2><span id='topic+getInitial'></span>

<h3>Description</h3>

<p>Function for showing the starting values of the model parameters used when fitting a dose-response model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  getInitial(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInitial_+3A_object">object</code></td>
<td>
<p>object of class 'drc'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of starting values for the model parameters used to initialize the estimation procedure.
</p>


<h3>Note</h3>

<p>This function is masking the standard function in the stats package.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>

<hr>
<h2 id='getMeanFunctions'>Display available dose-response models</h2><span id='topic+getMeanFunctions'></span>

<h3>Description</h3>

<p>Display information about available, built-in dose-response models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  getMeanFunctions(noParm = NA, fname = NULL, flist = NULL, display =TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMeanFunctions_+3A_noparm">noParm</code></td>
<td>
<p>numeric specifying the number of parameters of the models to be displayed.
The default (NA) results in display of all models, regardless of number of parameters.</p>
</td></tr>
<tr><td><code id="getMeanFunctions_+3A_fname">fname</code></td>
<td>
<p>character string or vector of character strings specifying the short name(s) 
of the models to be displayed (need to match exactly).</p>
</td></tr>
<tr><td><code id="getMeanFunctions_+3A_flist">flist</code></td>
<td>
<p>list of built-in functions to be displayed.</p>
</td></tr>
<tr><td><code id="getMeanFunctions_+3A_display">display</code></td>
<td>
<p>logical indicating whether or not the requested models should be displayed on the R console.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The arguments <code>noParm</code> and <code>fname</code> can be combined.
</p>


<h3>Value</h3>

<p>An invisible list of functions or a list of strings with brief function descriptions is returned. 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Listing all functions
getMeanFunctions()

## Listing all functions with 4 parameters
getMeanFunctions(4)

## Listing all (log-)logistic functions
getMeanFunctions(fname = "L")

## Listing all three-parameter (log-)logistic or Weibull functions
getMeanFunctions(3, fname = c("LL", "W"))

## Listing all four-parameter (log-)logistic or Weibull functions
getMeanFunctions(4, fname = c("LL", "W"))

</code></pre>

<hr>
<h2 id='glymet'>Glyphosate and metsulfuron-methyl tested on algae.</h2><span id='topic+glymet'></span>

<h3>Description</h3>

<p>The dataset has 7 mixtures, 8 dilutions, two replicates and 5 common control controls. 
Four observations are missing, giving a total of 113 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(glymet)</code></pre>


<h3>Format</h3>

<p>A data frame with 113 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose values</p>
</dd>
<dt><code>pct</code></dt><dd><p>a numeric vector denoting the grouping according to the mixtures percentages</p>
</dd>
<dt><code>rgr</code></dt><dd><p>a numeric vector of response values (relative growth rates)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset is analysed in Soerensen et al (2007). 
The concentration addition model can be entertained for this dataset.
</p>


<h3>Source</h3>

<p>The dataset is kindly provided by Nina Cedergreen, Department of Agricultural Sciences, 
Royal Veterinary and Agricultural University, Denmark.
</p>


<h3>References</h3>

<p>Soerensen, H. and Cedergreen, N. and Skovgaard, I. M. and Streibig, J. C. (2007) 
An isobole-based statistical model and test for synergism/antagonism in binary mixture toxicity experiments, 
<em>Environmental and Ecological Statistics</em>, <b>14</b>, 383&ndash;397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Fitting the model with freely varying ED50 values
glymet.free &lt;- drm(rgr~dose, pct, data = glymet, 
fct = LL.3(), pmodels = list(~factor(pct) , ~1, ~factor(pct))) 

## Lack-of-fit test
modelFit(glymet.free)  # acceptable
summary(glymet.free)

## Plotting isobole structure
isobole(glymet.free, exchange=0.01)

## Fitting the concentration addition model
glymet.ca &lt;- mixture(glymet.free, model = "CA")

## Comparing to model with freely varying e parameter
anova(glymet.ca, glymet.free)  # borderline accepted

## Plotting isobole based on concentration addition
isobole(glymet.free, glymet.ca, exchange = 0.01)  # acceptable fit

## Fitting the Hewlett model
glymet.hew &lt;- mixture(glymet.free, model = "Hewlett")

### Comparing to model with freely varying e parameter
anova(glymet.ca, glymet.hew)  
# borderline accepted
# the Hewlett model offers no improvement over concentration addition

## Plotting isobole based on the Hewlett model
isobole(glymet.free, glymet.hew, exchange = 0.01)  
# no improvement over concentration addition

</code></pre>

<hr>
<h2 id='gompertz'>Mean function for the Gompertz dose-response or growth curve</h2><span id='topic+gompertz'></span><span id='topic+G.2'></span><span id='topic+G.3'></span><span id='topic+G.3u'></span><span id='topic+G.4'></span>

<h3>Description</h3>

<p>This function provides a very general way of specifying the mean function of the decreasing or incresing 
Gompertz dose-response or growth curve models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gompertz(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), 
  method = c("1", "2", "3", "4"), ssfct = NULL,
  fctName, fctText)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gompertz_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="gompertz_+3A_names">names</code></td>
<td>
<p>vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The order of the parameters is: b, c, d, e (see under 'Details' for the precise meaning of each parameter).</p>
</td></tr>
<tr><td><code id="gompertz_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="gompertz_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="gompertz_+3A_fctname">fctName</code></td>
<td>
<p>character string used internally by convenience functions (optional).</p>
</td></tr>  
<tr><td><code id="gompertz_+3A_fcttext">fctText</code></td>
<td>
<p>character string used internally by convenience functions (optional).</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The Gompertz model is given by the mean function
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c)(\exp(-\exp(b(x-e)))) </code>
</p>
  
<p>and it is a dose-response/growth curve on the entire real axis, that is it is not limited to
non-negative values even though this is the range for most dose-response and growth data. One consequence is
that the curve needs not reach the lower asymptote at dose 0.
</p>
<p>If </p>
<p style="text-align: center;"><code class="reqn">b&lt;0</code>
</p>
<p> the mean function is increasing and it is decreasing for </p>
<p style="text-align: center;"><code class="reqn">b&gt;0</code>
</p>
<p>. The decreasing Gompertz model is
not a well-defined dose-response model and other dose-response models such as the Weibull models 
should be used instead.
</p>
<p>Various re-parameterisations of the model are used in practice.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the non-linear function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>The function is for use with the function <code><a href="#topic+drm">drm</a></code>, but typically the convenience functions
<code><a href="#topic+G.2">G.2</a></code>, <code><a href="#topic+G.3">G.3</a></code>, <code><a href="#topic+G.3u">G.3u</a></code>, and <code><a href="#topic+G.4">G.4</a></code> should be used.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Seber, G. A. F. and Wild, C. J. (1989) <em>Nonlinear Regression</em>, New York: Wiley \&amp; Sons (p. 331).
</p>


<h3>See Also</h3>

<p>The Weibull model <code><a href="#topic+weibull2">weibull2</a></code> is closely related to the Gompertz model.</p>

<hr>
<h2 id='gompertzd'>The derivative of the Gompertz function</h2><span id='topic+gompertzd'></span>

<h3>Description</h3>

<p>'gompertzd' provides a way of specifying the derivative of the Gompertz function
as a dose-response model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gompertzd(fixed = c(NA, NA), names = c("a", "b"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gompertzd_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="gompertzd_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is (notice the order): a, b.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The derivative of the Gompertz function is defined as
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = a \exp(bx-a/b(exp(bx)-1))</code>
</p>

<p>For <code class="reqn">a&gt;0</code> and <code class="reqn">b</code> not 0, the function is decreasing, equaling <code class="reqn">a</code> at <code class="reqn">x=0</code> 
and approaching 0 at plus infinity.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the model function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>

<hr>
<h2 id='H.virescens'>Mortality of tobacco budworms</h2><span id='topic+H.virescens'></span>

<h3>Description</h3>

<p>For three days, moths of the tobacco budworm (<em>Heliothis virescens</em>) were exposed 
to doses of the pyrethroid trans-cypermethrin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(H.virescens)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 4 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose values (<code class="reqn">\mu g</code>)</p>
</dd>
<dt><code>numdead</code></dt><dd><p>a numeric vector of dead or knocked-down moths</p>
</dd>
<dt><code>total</code></dt><dd><p>a numeric vector of total number of moths</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>F</code> <code>M</code> denoting a grouping according to sex</p>
</dd>
</dl>



<h3>Details</h3>

<p>In Venables and Ripley (2002), these data are analysed using a logistic regression with base-2 logarithm of dose 
as explanatory variable.
</p>


<h3>Source</h3>

<p>Venables, W. N. and Ripley, B. D (2002) <em>Modern Applied Statistics with S</em>, New York: Springer (fourth edition).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting dose-response model (log-logistic with common slope)
Hv.m1 &lt;- drm(numdead/total~dose, sex, weights = total, data = H.virescens, fct = LL.2(), 
pmodels = list(~ 1, ~ sex - 1), type = "binomial")
summary(Hv.m1)

## Fitting the same model as in Venables and Riply (2002)
Hv.m2 &lt;- glm(cbind(numdead, total-numdead) ~ sex + I(log2(dose)) - 1, data = H.virescens, 
family = binomial)

## Comparing the fits
logLik(Hv.m1)
logLik(Hv.m2)

## Estimated ED values (matching those given in MASS)
ED(Hv.m1, c(25, 50, 75))


</code></pre>

<hr>
<h2 id='hatvalues.drc'>
Model diagnostics for nonlinear dose-response models
</h2><span id='topic+hatvalues.drc'></span><span id='topic+cooks.distance.drc'></span>

<h3>Description</h3>

<p>Hat values (leverage values) and Cook's distance are provided for nonlinear dose-response model fits using the same formulas
as in linear regression but based on the corresponding but approximate quantities available for nonlinear models.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drc'
cooks.distance(model, ...)

  ## S3 method for class 'drc'
hatvalues(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hatvalues.drc_+3A_model">model</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="hatvalues.drc_+3A_...">...</code></td>
<td>
<p>additional arguments (not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hat values and Cook's distance are calculated using the formula given by Cook et al. (1986) and McCullagh and Nelder (1989). 
</p>
<p>The output values can be assessed in the same way as in linear regression.
</p>


<h3>Value</h3>

<p>A vector of leverage values (hat values) or values of Cook's distance (one value per observation).
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Cook, R. D. and Tsai, C.-L. and Wei, B. C. (1986)
Bias in Nonlinear Regression,
<em>Biometrika</em>
<b>73</b>, 615&ndash;623.
</p>
<p>McCullagh, P. and Nelder, J. A. (1989)
emphGeneralized Linear Models, 
Second edition, Chapman \&amp; Hall/CRC.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.LL.4 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())

hatvalues(ryegrass.LL.4)

cooks.distance(ryegrass.LL.4)

</code></pre>

<hr>
<h2 id='heartrate'>Heart rate baroreflexes for rabbits</h2><span id='topic+heartrate'></span>

<h3>Description</h3>

<p>The dataset contains measurements of mean arterial pressure (mmHG) and heart rate (b/min) for a baroreflex curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heartrate)</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 2 variables.
</p>

<dl>
<dt><code>pressure</code></dt><dd><p>a numeric vector containing measurements of arterial pressure.</p>
</dd>
<dt><code>rate</code></dt><dd><p>a numeric vector containing measurements of heart rate.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset is an example of an asymmetric dose-response curve, that is not
easily handled using the log-logistic or Weibull models (<code><a href="#topic+LL.4">LL.4</a></code>, <code><a href="#topic+LL.5">LL.5</a></code>, 
<code><a href="#topic+W1.4">W1.4</a></code> and <code><a href="#topic+W2.4">W2.4</a></code>), whereas the <code>baro5</code> model provides a nice fit.
</p>


<h3>Source</h3>

<p>Ricketts, J. H. and Head, G. A. (1999) A five-parameter logistic equation for investigating asymmetry of
curvature in baroreflex studies, 
<em>Am. J. Physiol. (Regulatory Integrative Comp. Physiol. 46)</em>, <b>277</b>, 441&ndash;454.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the baro5 model
heartrate.m1 &lt;- drm(rate~pressure, data=heartrate, fct=baro5())
plot(heartrate.m1)

coef(heartrate.m1)

#Output:
#b1:(Intercept) b2:(Intercept)  c:(Intercept)  d:(Intercept)  e:(Intercept)
#      11.07984       46.67492      150.33588      351.29613       75.59392

## Inserting the estimated baro5 model function in deriv()
baro5Derivative &lt;- deriv(~ 150.33588 + ((351.29613 - 150.33588)/
(1 + (1/(1 + exp((2 * 11.07984 * 46.67492/(11.07984 + 46.67492)) * 
(log(x) - log(75.59392 ))))) * (exp(11.07984 * (log(x) - log(75.59392)))) + 
(1 - (1/(1 + exp((2 * 11.07984 * 46.67492/(11.07984 + 46.67492)) * 
(log(x) - log(75.59392 )))))) * (exp(46.67492 * (log(x) - log(75.59392 )))))), "x", function(x){})

## Plotting the derivative
#pressureVector &lt;- 50:100
pressureVector &lt;- seq(50, 100, length.out=300)
derivativeVector &lt;- attr(baro5Derivative(pressureVector), "gradient")
plot(pressureVector, derivativeVector, type = "l")

## Finding the minimum
pressureVector[which.min(derivativeVector)]


</code></pre>

<hr>
<h2 id='isobole'>Creating isobolograms</h2><span id='topic+isobole'></span>

<h3>Description</h3>

<p>'isobole' displays isobole based on EC/ED50 estimates from a log-logistic model.
Additionally isoboles determined by the concentration addition model, Hewlett's
model and Voelund's model can be added to the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isobole(object1, object2, exchange = 1, cifactor = 2, ename = "e", 
xaxis = "100", xlab, ylab, xlim, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isobole_+3A_object1">object1</code></td>
<td>
<p>object of class 'drc' where EC/ED50 parameters vary freely.</p>
</td></tr>
<tr><td><code id="isobole_+3A_object2">object2</code></td>
<td>
<p>object of class 'drc' where EC/ED50 parameters vary according to Hewlett's model.</p>
</td></tr>
<tr><td><code id="isobole_+3A_ename">ename</code></td>
<td>
<p>character string. The name of the EC/ED50 variable.</p>
</td></tr>
<tr><td><code id="isobole_+3A_xaxis">xaxis</code></td>
<td>
<p>character string. Is the mixture &quot;0:100&quot; or &quot;100:0&quot; on the x axis?</p>
</td></tr>
<tr><td><code id="isobole_+3A_exchange">exchange</code></td>
<td>
<p>numeric. The exchange rate between the two substances.</p>
</td></tr>
<tr><td><code id="isobole_+3A_cifactor">cifactor</code></td>
<td>
<p>numeric. The factor to be used in the confidence intervals. 
Default is 2, but 1 has been used in publications.</p>
</td></tr>  
<tr><td><code id="isobole_+3A_xlab">xlab</code></td>
<td>
<p>an optional label for the x axis.</p>
</td></tr>
<tr><td><code id="isobole_+3A_ylab">ylab</code></td>
<td>
<p>an optional label for the y axis.</p>
</td></tr>
<tr><td><code id="isobole_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the x axis.</p>
</td></tr>
<tr><td><code id="isobole_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the y axis.</p>
</td></tr>
<tr><td><code id="isobole_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model fits to be supplied as first and optionally second argument are obtained
using <code><a href="#topic+mixture">mixture</a></code> and <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Value</h3>

<p>No value is returned. Only used for the side effect: the isobologram shown.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Ritz, C. and Streibig, J. C. (2014)
From additivity to synergism - A modelling perspective
<em>Synergy</em>, <b>1</b>, 22&ndash;29.
</p>


<h3>See Also</h3>

<p>The examples in <code><a href="#topic+acidiq">acidiq</a></code>, <code><a href="#topic+glymet">glymet</a></code> and <code><a href="#topic+mecter">mecter</a></code>.
</p>

<hr>
<h2 id='leaflength'>Leaf length of barley</h2><span id='topic+leaflength'></span>

<h3>Description</h3>

<p>In an experiment barley was grown in a hydroponic solution with a herbicide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(leaflength)</code></pre>


<h3>Format</h3>

<p>A data frame with 42 observations on the following 2 variables.
</p>

<dl>
<dt><code>Dose</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>DW</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset exhibits a large hormetical effect.
</p>


<h3>Source</h3>

<p>Nina Cedergreen, Royal Veterinary and Agricultural University, Denmark.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a hormesis model
leaflength.crs4c1 &lt;- drm(DW ~ Dose, data = leaflength, fct = CRS.4c())
plot(fitted(leaflength.crs4c1), residuals(leaflength.crs4c1))

leaflength.crs4c2 &lt;- boxcox(drm(DW ~ Dose, data = leaflength, fct = CRS.4c()), 
method = "anova", plotit = FALSE)
summary(leaflength.crs4c2)

## Plottinf fitted curve and original data
plot(leaflength.crs4c2, broken = TRUE, conLevel = 0.001, type = "all", legend = FALSE, 
ylab = "Produced leaf length (cm)", xlab = "Metsulfuron-methyl (mg/l)",
main = "Hormesis: leaf length of barley")

</code></pre>

<hr>
<h2 id='lepidium'>Dose-response profile of degradation of agrochemical using lepidium</h2><span id='topic+lepidium'></span>

<h3>Description</h3>

<p>Estimation of the degradation profile of an agrochemical based on soil samples at depth 0-10cm
from a calibration experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lepidium)</code></pre>


<h3>Format</h3>

<p>A data frame with 42 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations (g/ha)</p>
</dd>
<dt><code>weight</code></dt><dd><p>a numeric vector of plant weight (g) after 3 weeks' growth</p>
</dd>
</dl>



<h3>Details</h3>

<p>It is an experiment with seven concentrations and six replicates per concentration. <em>Lepidium</em>
is rather robust as it only responds to high concentrations.
</p>


<h3>Source</h3>

<p>Racine-Poon, A. (1988) A Bayesian Approach to Nonlinear Calibration Problems, 
<em>J. Am. Statist. Ass.</em>, <b>83</b>, 650&ndash;656.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lepidium.m1 &lt;- drm(weight~conc, data=lepidium, fct = LL.4())

modelFit(lepidium.m1)

plot(lepidium.m1, type = "all", log = "")
</code></pre>

<hr>
<h2 id='lettuce'>Hormesis in lettuce plants</h2><span id='topic+lettuce'></span>

<h3>Description</h3>

<p>Data are from an experiment where isobutylalcohol was dissolved in a nutrient solution in which lettuce
(<em>Lactuca sativa</em>) plants were grown. The plant biomass of the shoot was determined af 21 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lettuce)</code></pre>


<h3>Format</h3>

<p>A data frame with 14 observations on the following 2 variables.
</p>

<dl>
<dt>conc</dt><dd><p>a numeric vector of concentrations of isobutylalcohol (mg/l)</p>
</dd>
<dt>weight</dt><dd><p>a numeric vector of biomass of shoot (g)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set illustrates hormesis, presence of a subtoxic stimulus at low concentrations.
</p>


<h3>Source</h3>

<p>van Ewijk, P. H. and Hoekstra, J. A. (1993) 
Calculation of the EC50 and its Confidence Interval When Subtoxic Stimulus Is Present,
<em>ECOTOXICOLOGY AND ENVIRONMENTAL SAFETY</em>, <b>25</b>, 25&ndash;32.
</p>


<h3>References</h3>

<p>van Ewijk, P. H. and Hoekstra, J. A. (1994) 
Curvature Measures and Confidence Intervals for the Linear Logistic Model,
<em>Appl. Statist.</em>, <b>43</b>, 477&ndash;487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Look at data
lettuce

## Monotonous dose-response model
lettuce.m1 &lt;- drm(weight~conc, data=lettuce, fct=LL.3())

plot(lettuce.m1, broken = TRUE)

## Model fit in van Ewijk and Hoekstra (1994)
lettuce.m2 &lt;- drm(weight~conc, data=lettuce, fct=BC.4())
modelFit(lettuce.m2)

plot(lettuce.m2, add = TRUE, broken = TRUE, type = "none", lty = 2)

## Hormesis effect only slightly significant
summary(lettuce.m2)

## Hormesis effect highly significant
##  compare with t-test for the "f" parameter in the summary output)
anova(lettuce.m1, lettuce.m2)

</code></pre>

<hr>
<h2 id='lin.test'>
Lack-of-fit test for the mean structure based on cumulated residuals
</h2><span id='topic+lin.test'></span>

<h3>Description</h3>

<p>The function provides a lack-of-fit test for the mean structure based on cumulated residuals from the model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  lin.test(object, noksSim = 20, seed = 20070325, plotit = TRUE, 
  log = "", bp = 0.01, xlab, ylab, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lin.test_+3A_object">object</code></td>
<td>

<p>object of class 'drc'.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_nokssim">noksSim</code></td>
<td>

<p>numeric specifying the number of simulations used to obtain the p-value.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_seed">seed</code></td>
<td>

<p>numeric specifying the seed value for the random number generator.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_plotit">plotit</code></td>
<td>

<p>logical indicating whether or not the observed cumulated residual process should be plotted. Default is to
plot the process.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_log">log</code></td>
<td>

<p>character string which should contains '&quot;x&quot;' if the x axis is to be logarithmic, '&quot;y&quot;' if the y axis is to be 
logarithmic and '&quot;xy&quot;' or '&quot;yx&quot;' if both axes are to be logarithmic. The default is &quot;x&quot;. 
The empty string &quot;&quot; yields the original axes.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_bp">bp</code></td>
<td>

<p>numeric value specifying the break point below which the dose is zero (the amount of stretching on 
the dose axis above zero in order to create the visual illusion of a logarithmic scale <em>including</em> 0).
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_xlab">xlab</code></td>
<td>

<p>string character specifying an optional label for the x axis.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_ylab">ylab</code></td>
<td>

<p>character string specifying an optional label for the y axis.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_ylim">ylim</code></td>
<td>

<p>numeric vector of length two, containing the lower and upper limit for the y axis.
</p>
</td></tr>
<tr><td><code id="lin.test_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed further to the basic <code><a href="base.html#topic+plot">plot</a></code> method.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides a graphical model checking of the mean structure in a dose-response model. The graphical
display is supplemented by a p-value based on a supremum-type test.
</p>
<p>The test is applicable even in cases where data are non-normal or exhibit variance heterogeneity.
</p>


<h3>Value</h3>

<p>A p-value for test of the null hypothesis that the mean structure is appropriate. 
Ritz and Martinussen (2009) provide the details.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Ritz, C and Martinussen, T. (2009) 
Lack-of-fit tests for assessing mean structures for continuous dose-response data, 
<em>Submitted manuscript</em>
</p>


<h3>See Also</h3>

<p>Other available lack-of-fit tests are the Neill test (<code><a href="#topic+neill.test">neill.test</a></code>) and 
ANOVA-based test (<code><a href="#topic+modelFit">modelFit</a></code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a log-logistic model to the dataset 'etmotc'
etmotc.m1&lt;-drm(rgr1~dose1, data=etmotc[1:15,], fct=LL.4())

## Test based on umulated residuals
lin.test(etmotc.m1, 1000)
#lin.test(etmotc.m1, 10000, plotit = FALSE)  # more precise

## Fitting an exponential model to the dataset 'O.mykiss'
O.mykiss.m1&lt;-drm(weight~conc, data=O.mykiss, fct=EXD.2(), na.action=na.omit)

## ANOVA-based test
modelFit(O.mykiss.m1)

## Test based on umulated residuals
lin.test(O.mykiss.m1, log = "", cl = 0.2, xlab = "Dose (mg/l)", main = "B", ylim = c(-0.6, 0.6))
#lin.test(O.mykiss.m1, noksSim = 10000, plotit = FALSE)  # more precise

</code></pre>

<hr>
<h2 id='LL.2'>The two-parameter log-logistic function</h2><span id='topic+LL.2'></span><span id='topic+l2'></span><span id='topic+LL2.2'></span>

<h3>Description</h3>

<p>'LL.2' and 'LL2.2' provide the two-parameter log-logistic function where the lower limit is fixed at 0 and the upper limit
is fixed at 1, mostly suitable for binomial/quantal responses. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  LL.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
  
  l2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
  
  LL2.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LL.2_+3A_upper">upper</code></td>
<td>
<p>numeric value. The fixed, upper limit in the model. Default is 1.</p>
</td></tr>
<tr><td><code id="LL.2_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="LL.2_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="LL.2_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+llogistic">llogistic</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two-parameter log-logistic function is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = \frac{1}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>or in another parameterisation
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = \frac{1}{1+\exp(b(\log(x)-e))}</code>
</p>
  
<p>The model function is symmetric about the inflection point (<code class="reqn">e</code>).  
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>Related functions are <code><a href="#topic+LL.3">LL.3</a></code>, <code><a href="#topic+LL.4">LL.4</a></code>, <code><a href="#topic+LL.5">LL.5</a></code> and the more general 
<code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a two-parameter logistic model 
##  to binomial responses (a logit model)
earthworms.m1 &lt;- drm(number/total~dose, weights=total, 
data = earthworms, fct = LL.2(), type = "binomial")

plot(earthworms.m1)  # not fitting at the upper limit!

</code></pre>

<hr>
<h2 id='LL.3'>The three-parameter log-logistic function</h2><span id='topic+LL.3'></span><span id='topic+LL.3u'></span><span id='topic+l3'></span><span id='topic+l3u'></span><span id='topic+LL2.3'></span><span id='topic+LL2.3u'></span>

<h3>Description</h3>

<p>'LL.3' and 'LL2.3' provide the three-parameter log-logistic function where the lower limit is equal to 0. 
</p>
<p>'LL.3u' and 'LL2.3u' provide three-parameter logistic function where the upper limit is equal to 1, mainly
for use with binomial/quantal response. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  
  LL.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  LL.3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)
  
  l3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)

  l3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)  
  
  LL2.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  LL2.3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LL.3_+3A_upper">upper</code></td>
<td>
<p>numeric value. The fixed, upper limit in the model. Default is 1.</p>
</td></tr>
<tr><td><code id="LL.3_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="LL.3_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="LL.3_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+llogistic">llogistic</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three-parameter log-logistic function with lower limit 0 is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + \frac{d-0}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>or in another parameterisation
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + \frac{d-0}{1+\exp(b(\log(x)-e))}</code>
</p>

<p>The three-parameter log-logistic function with upper limit 1 is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{1-c}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>or in another parameterisation
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{1-c}{1+\exp(b(\log(x)-e))}</code>
</p>

<p>Both functions are symmetric about the inflection point (<code class="reqn">e</code>).  
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Finney, D. J. (1971) <em>Probit Analysis</em>, Cambridge: Cambridge University Press.
</p>


<h3>See Also</h3>

<p>Related functions are <code><a href="#topic+LL.2">LL.2</a></code>, <code><a href="#topic+LL.4">LL.4</a></code>, <code><a href="#topic+LL.5">LL.5</a></code> and the more general 
<code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting model with lower limit equal 0
ryegrass.model1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.3())
summary(ryegrass.model1)

## Fitting binomial response
##  with non-zero control response

## Example dataset from Finney (1971) - example 19
logdose &lt;- c(2.17, 2,1.68,1.08,-Inf,1.79,1.66,1.49,1.17,0.57)
n &lt;- c(142,127,128,126,129,125,117,127,51,132)
r &lt;- c(142,126,115,58,21,125,115,114,40,37)
treatment &lt;- factor(c("w213","w213","w213","w213",
"w214","w214","w214","w214","w214","w214"))
# Note that the control is included in one of the two treatment groups
finney.ex19 &lt;- data.frame(logdose, n, r, treatment)

## Fitting model where the lower limit is estimated
fe19.model1 &lt;- drm(r/n~logdose, treatment, weights = n, data = finney.ex19, 
logDose = 10, fct = LL.3u(), type="binomial", 
pmodels = data.frame(treatment, 1, treatment))

summary(fe19.model1)
modelFit(fe19.model1)
plot(fe19.model1, ylim = c(0, 1.1), bp = -1, broken = TRUE, legendPos = c(0, 1))
abline(h = 1, lty = 2)

</code></pre>

<hr>
<h2 id='LL.4'>The four-parameter log-logistic function</h2><span id='topic+LL.4'></span><span id='topic+l4'></span><span id='topic+LL2.4'></span>

<h3>Description</h3>

<p>'LL.4' and 'LL2.4' provide the four-parameter log-logistic function, self starter function, names of the parameters and, optionally,
first and second derivatives for a faster estimation.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  LL.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)

  l4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
  
  LL2.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LL.4_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="LL.4_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="LL.4_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+llogistic">llogistic</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The four-parameter log-logistic function is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{1+\exp(b(\log(x)-\log(e)))}</code>
</p>

<p>or in another parameterisation (converting the term <code class="reqn">\log(e)</code> into a parameter)
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{1+\exp(b(\log(x)-\tilde{e}))}</code>
</p>
  
<p>The function is symmetric about the inflection point (<code class="reqn">e</code>).  
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz and Jens C. Streibig</p>


<h3>References</h3>

<p>Seber, G. A. F. and Wild, C. J (1989) <em>Nonlinear Regression</em>, New York: Wiley \&amp; Sons (p. 330).
</p>


<h3>See Also</h3>

<p>Setting <code class="reqn">c=0</code> yields <code><a href="#topic+LL.3">LL.3</a></code>. See also <code><a href="#topic+LL.5">LL.5</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spinach.m1 &lt;- drm(SLOPE~DOSE, CURVE, data = spinach, fct = LL.4())
spinach.m1


</code></pre>

<hr>
<h2 id='LL.5'>The five-parameter log-logistic function</h2><span id='topic+LL.5'></span><span id='topic+l5'></span><span id='topic+LL2.5'></span>

<h3>Description</h3>

<p>'LL.5' and 'LL2.5' provide the five-parameter log-logistic function, self starter function and names of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  LL.5(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), ...)

  l5(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), ...)
  
  LL2.5(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LL.5_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="LL.5_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="LL.5_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+llogistic">llogistic</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The five-parameter logistic function is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{(1+\exp(b(\log(x)-\log(e))))^f}</code>
</p>

<p>or in another parameterisation
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{(1+\exp(b(\log(x)-e)))^f}</code>
</p>

<p>The function is asymmetric for <code class="reqn">f</code> different from 1.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+llogistic">llogistic</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Finney, D. J. (1979) Bioassay and the Practise of Statistical Inference, 
<em>Int. Statist. Rev.</em>, <b>47</b>, 1&ndash;12.
</p>


<h3>See Also</h3>

<p>Related functions are <code><a href="#topic+LL.4">LL.4</a></code> and <code><a href="#topic+LL.3">LL.3</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.5())
summary(ryegrass.m1)

</code></pre>

<hr>
<h2 id='llogistic'>The log-logistic function</h2><span id='topic+llogistic'></span><span id='topic+llogistic2'></span>

<h3>Description</h3>

<p>'llogistic' provides a very general way of specifying log-logistic models,
under various constraints on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  llogistic(fixed = c(NA, NA, NA, NA, NA), 
  names = c("b", "c", "d", "e", "f"),
  method = c("1", "2", "3", "4"), ssfct = NULL,
  fctName, fctText)

  llogistic2(fixed = c(NA, NA, NA, NA, NA), 
  names = c("b", "c", "d", "e", "f"),
  ss = c("1", "2", "3"), ssfct = NULL,
  fctName, fctText)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="llogistic_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="llogistic_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e, f 
(see under 'Details').</p>
</td></tr>
<tr><td><code id="llogistic_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr> 
<tr><td><code id="llogistic_+3A_ss">ss</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr> 
<tr><td><code id="llogistic_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="llogistic_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="llogistic_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The default arguments yields the five-parameter log-logistic function given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{(1+\exp(b(\log(x)-\log(e))))^f}</code>
</p>

<p>If the parameter <code class="reqn">f</code> differs from 1 then the function is asymmetric; otherwise it
is symmetric (on log scale). This function is fitted using <code><a href="#topic+llogistic">llogistic</a></code>.
</p>
<p>The log-logistic function with log(e) rather than e as a parameter, that is using the parameterisation
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{(1+\exp(b(\log(x)-e)))^f}</code>
</p>

<p>is fitted using <code><a href="#topic+llogistic2">llogistic2</a></code>.
</p>
<p>Sometimes the log-logistic models are also called Hill models.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>The functions are for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Finney, D. J. (1979) Bioassay and the Practise of Statistical Inference, 
<em>Int. Statist. Rev.</em>, <b>47</b>, 1&ndash;12.
</p>
<p>Seber, G. A. F. and Wild, C. J. (1989) <em>Nonlinear Regression</em>, New York: Wiley \&amp; Sons (p. 330).
</p>


<h3>See Also</h3>

<p>For convenience several special cases are available: 
<code><a href="#topic+LL.2">LL.2</a></code>, <code><a href="#topic+LL.3">LL.3</a></code>, <code><a href="#topic+LL.4">LL.4</a></code> and <code><a href="#topic+LL.5">LL.5</a></code>. 
Examples are provided in the help pages for these functions.
</p>

<hr>
<h2 id='lnormal'>Log-normal dose-response model</h2><span id='topic+lnormal'></span><span id='topic+LN.2'></span><span id='topic+LN.3'></span><span id='topic+LN.3u'></span><span id='topic+LN.4'></span>

<h3>Description</h3>

<p><code>lnormal</code> and the accompanying convenience functions provide a general framework for specifying 
the mean function of the decreasing or incresing log-normal dose-response model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  lnormal(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), 
  method = c("1", "2", "3", "4"), ssfct = NULL,
  fctName, fctText, loge = FALSE)
  
  LN.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
  
  LN.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  LN.3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)
  
  LN.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lnormal_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="lnormal_+3A_names">names</code></td>
<td>
<p>vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e, f 
(see under 'Details' for the precise meaning of each parameter).</p>
</td></tr>
<tr><td><code id="lnormal_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="lnormal_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="lnormal_+3A_fctname">fctName</code></td>
<td>
<p>character string used internally by convenience functions (optional).</p>
</td></tr>  
<tr><td><code id="lnormal_+3A_fcttext">fctText</code></td>
<td>
<p>character string used internally by convenience functions (optional).</p>
</td></tr>  
<tr><td><code id="lnormal_+3A_loge">loge</code></td>
<td>
<p>logical indicating whether or not ED50 or log(ED50) should be a parameter in the model. 
By default ED50 is a model parameter.</p>
</td></tr>
<tr><td><code id="lnormal_+3A_upper">upper</code></td>
<td>
<p>numeric specifying the upper horizontal asymptote in the convenience function. 
The default is 1.</p>
</td></tr>
<tr><td><code id="lnormal_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions to <code>lnormal</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the case where log(ED50), denoted <code class="reqn">e</code> in the equation below, is a parameter in the model, 
the mean function is:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = c + (d-c)(\Phi(b(\log(x)-e)))</code>
</p>

<p>and the mean function is:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = c + (d-c)(\Phi(b(\log(x)-\log(e))))</code>
</p>
  
<p>in case ED50, which is also denoted <code class="reqn">e</code>, is a parameter in the model. If the former model is fitted
any estimated ED values will need to be back-transformed subsequently in order to obtain effective doses
on the original scale.
</p>
<p>The mean functions above yield the same models as those described by Bruce and Versteeg (1992),
but in a different parameterisations (among other things the natural logarithm is used).
</p>
<p>For the case <code class="reqn">c=0</code> and <code class="reqn">d=1</code>, the log-normal model reduces the classic probit model (Finney, 1971) 
with log dose as explanatory variable (mostly used for quantal data). This special case is available through
the convenience function <code>LN.2</code>.
</p>
<p>The case <code class="reqn">c=0</code> is available as the function <code>LN.3</code>, whereas the <code>LN.3u</code> corresponds to the special
case where the upper horizontal asymptote is fixed (default is 1). The full four-parameter model is available
through <code>LN.4</code>.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the non-linear function, the self starter function
and the parameter names.
</p>


<h3>Note</h3>

<p>The function is for use with the function <code><a href="#topic+drm">drm</a></code>, but typically the convenience functions
<code>link{LN.2}</code>, <code>link{LN.3}</code>, <code>link{LN.3u}</code>, and <code>link{LN.4}</code> should be used.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Finney, D. J. (1971) <em>Probit analysis</em>, London: Cambridge University Press.
</p>
<p>Bruce, R. D. and Versteeg, D. J. (1992) A statistical procedure for modeling continuous toxicity data,
<em>Environ. Toxicol. Chem.</em>, <b>11</b>, 1485&ndash;1494.
</p>


<h3>See Also</h3>

<p>The log-logistic model (<code><a href="#topic+llogistic">llogistic</a></code>) is very similar to the log-normal model at least in the middle,
but they may differ in the tails and thus provide different estimates of low effect concentrations EC/ED.
</p>
<p>Examples are provided in the help pages of the datasets <code><a href="#topic+S.capricornutum">S.capricornutum</a></code>, <code><a href="#topic+P.promelas">P.promelas</a></code>,
and <code><a href="#topic+M.bahia">M.bahia</a></code>.
</p>

<hr>
<h2 id='logistic'>The logistic model</h2><span id='topic+logistic'></span><span id='topic+L.3'></span><span id='topic+L.4'></span><span id='topic+L.5'></span>

<h3>Description</h3>

<p>The general asymmetric five-parameter logistic model for describing dose-response relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  logistic(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"),
  method = c("1", "2", "3", "4"), ssfct = NULL, 
  fctName, fctText) 

  L.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  L.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
  L.5(fixed = c(NA, NA, NA, NA, NA), names = c("b", "c", "d", "e", "f"), ...)  

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logistic_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="logistic_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;). 
The order of the parameters is: b, c, d, e, f (see under 'Details').</p>
</td></tr>
<tr><td><code id="logistic_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="logistic_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>    
<tr><td><code id="logistic_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="logistic_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>
<tr><td><code id="logistic_+3A_...">...</code></td>
<td>
<p>Additional arguments (see <code><a href="#topic+llogistic">llogistic</a></code>).</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>The default arguments yields the five-parameter logistic mean function given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d-c}{(1+\exp(b(x - e)))^f}</code>
</p>

<p>The model is different from the log-logistic models <code><a href="#topic+llogistic">llogistic</a></code> and <code><a href="#topic+llogistic2">llogistic2</a></code>
where the term </p>
<p style="text-align: center;"><code class="reqn">log(x)</code>
</p>
<p> is used instead of </p>
<p style="text-align: center;"><code class="reqn">x</code>
</p>
<p>.
</p>
<p>The model is sometimes referred to as the Boltzmann model.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the four-parameter logistic model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = L.4())
summary(ryegrass.m1)

## Fitting an asymmetric logistic model
##  requires installing the package 'NISTnls'
# Ratkowsky3.m1 &lt;- drm(y~x, data = Ratkowsky3, 
# fct = L.5(fixed = c(NA, 0, NA, NA, NA)))
# plot(Ratkowsky3.m1)
# summary(Ratkowsky3.m1)  
## okay agreement with NIST values
##  for the two parameters that are the same

</code></pre>

<hr>
<h2 id='logLik.drc'>Extracting the log likelihood</h2><span id='topic+logLik.drc'></span>

<h3>Description</h3>

<p><code>loglik</code> extracts the value of the log likelihood function evaluated at the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drc'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="logLik.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The evaluated log likelihood as a numeric value and the corresponding degrees of freedom as well as the number of observations as attributes.
</p>


<h3>Note</h3>

<p>The value of the log likelihood could be used to compare model fits of the same data based on different 
dose-response models or based on the same model but fitted different algorithms, software programmes, or 
starting values. For comparisons: Larger is better.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~conc, data = ryegrass, fct = LL.4()) 
logLik(ryegrass.m1)

</code></pre>

<hr>
<h2 id='M.bahia'>Effect of an effluent on the growth of mysid shrimp</h2><span id='topic+M.bahia'></span>

<h3>Description</h3>

<p>Juvenile mysid shrimp (<em>Mysidopsis bahia</em>) were exposed to up to 32% effluent
in a 7-day survival and growth test. The average weight per treatment replicate of
surviving organisms was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(M.bahia)</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of effluent concentrations (%)</p>
</dd>
<dt><code>dryweight</code></dt><dd><p>a numeric vector of average dry weights (mg)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are analysed in Bruce and Versteeg (1992) using a log-normal 
dose-response model (using the logarithm with base 10).
</p>
<p>At 32% there was complete mortality, and this justifies using a model where a lower asymptote
of 0 is assumed.
</p>


<h3>Source</h3>

<p>Bruce, R. D. and Versteeg, D. J. (1992) A statistical procedure for modeling continuous toxicity data,
<em>Environ. Toxicol. Chem.</em>, <b>11</b>, 1485&ndash;1494.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
M.bahia.m1 &lt;- drm(dryweight~conc, data=M.bahia, fct=LN.3())

## Variation increasing
plot(fitted(M.bahia.m1), residuals(M.bahia.m1))

## Using transform-both-sides approach
M.bahia.m2 &lt;- boxcox(M.bahia.m1, method = "anova")
summary(M.bahia.m2)  # logarithm transformation

## Variation roughly constant, but still not a great fit
plot(fitted(M.bahia.m2), residuals(M.bahia.m2))

## Visual comparison of fits
plot(M.bahia.m1, type="all", broken=TRUE)
plot(M.bahia.m2, add=TRUE, type="none", broken=TRUE, lty=2)

ED(M.bahia.m2, c(10,20,50), ci="fls")

## A better fit
M.bahia.m3 &lt;- boxcox(update(M.bahia.m1, fct = LN.4()), method = "anova")
#plot(fitted(M.bahia.m3), residuals(M.bahia.m3))
plot(M.bahia.m3, add=TRUE, type="none", broken=TRUE, lty=3, col=2)
ED(M.bahia.m3, c(10,20,50), ci="fls")

</code></pre>

<hr>
<h2 id='maED'>Estimation of ED values using model-averaging</h2><span id='topic+maED'></span>

<h3>Description</h3>

<p>Estimates and confidence intervals for ED values are estimated using model-averaging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maED(object, fctList = NULL, respLev, interval = c("none", "buckland", "kang"), 
linreg = FALSE, clevel = NULL, level = 0.95, type = c("relative", "absolute"), 
display = TRUE, na.rm = FALSE, extended = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maED_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="maED_+3A_fctlist">fctList</code></td>
<td>
<p>a list of non-linear functions to be compared.</p>
</td></tr>
<tr><td><code id="maED_+3A_resplev">respLev</code></td>
<td>
<p>a numeric vector containing the response levels.</p>
</td></tr>
<tr><td><code id="maED_+3A_interval">interval</code></td>
<td>
<p>character string specifying the type of confidence intervals to be supplied. The default is &quot;none&quot;. 
The choices &quot;buckland&quot; and &quot;kang&quot; are explained in the Details section.</p>
</td></tr>
<tr><td><code id="maED_+3A_linreg">linreg</code></td>
<td>
<p>logical indicating whether or not additionally a simple linear regression model 
should be fitted.</p>
</td></tr>
<tr><td><code id="maED_+3A_clevel">clevel</code></td>
<td>
<p>character string specifying the curve id in case on estimates for a specific curve or compound is requested. By default estimates
are shown for all curves.</p>
</td></tr>
<tr><td><code id="maED_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="maED_+3A_type">type</code></td>
<td>
<p>character string. Whether the specified response levels are absolute or relative (default).</p>
</td></tr>
<tr><td><code id="maED_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>
<tr><td><code id="maED_+3A_na.rm">na.rm</code></td>
<td>
<p>logical indicating whether or not NA occurring during model fitting should be left out of
subsequent calculations.</p>
</td></tr>
<tr><td><code id="maED_+3A_extended">extended</code></td>
<td>
<p>logical specifying whether or not an extended output (including fit summaries) should be
returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model-averaging of individual estimates is carried out as described by Buckland <em>et al.</em> (1997) and 
Kang <em>et al.</em> (2000) using AIC-based weights. The two approaches differ w.r.t. the calculation of confidence
intervals: Buckland <em>et al.</em> (1997) provide an approximate variance formula under the assumption of
perfectly correlated estimates (so, confidence intervals will tend to be too wide). 
Kang <em>et al.</em> (2000) use the model weights to calculate confidence limits as weighted means of 
the confidence limits for the individual fits; this procedure corresponds to using the standard error in Equation (3) 
given by Buckland <em>et al.</em> (1997) (assuming symmetric confidence intervals based on the same percentile).
</p>


<h3>Value</h3>

<p>A matrix with two or more columns, containing the estimates 
and the corresponding estimated standard errors and possibly lower and upper confidence limits.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

 
<p>Buckland, S. T. and Burnham, K. P. and Augustin, N. H. (1997)
Model Selection: An Integral Part of Inference,
<em>Biometrics</em> <b>53</b>, 603&ndash;618.
</p>
<p>Kang, Seung-Ho and Kodell, Ralph L. and Chen, James J. (2000)
Incorporating Model Uncertainties along with Data Uncertainties in Microbial Risk Assessment,
<em>Regulatory Toxicology and Pharmacology</em> <b>32</b>, 68&ndash;72.
</p>


<h3>See Also</h3>

<p>The function <code><a href="#topic+mselect">mselect</a></code> provides a summary of fit statistics for several models fitted to the same data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting an example dose-response model
ryegrass.m1 &lt;- drm(rootl~conc, data = ryegrass, fct = LL.4())
  
## Comparing models (showing the AIC values)  
mselect(ryegrass.m1, 
list(LL.5(), LN.4(), W1.4(), W2.4(), FPL.4(-1,1), FPL.4(-2,3), FPL.4(-0.5,0.5)))
  
## Doing the actual model-averaging  
maED(ryegrass.m1, 
list(LL.5(), LN.4(), W1.4(), W2.4(), FPL.4(-1,1), FPL.4(-2,3), FPL.4(-0.5,0.5)), 
c(10, 50, 90))  
  
## With confidence intervals according to Buckland et al. (1997)  
maED(ryegrass.m1, 
list(LL.5(), LN.4(), W1.4(), W2.4(), FPL.4(-1,1), FPL.4(-2,3), FPL.4(-0.5,0.5)), 
c(10, 50, 90), "buckland")

## With confidence intervals according to Kang et al. (2000)
maED(ryegrass.m1, 
list(LL.5(), LN.4(), W1.4(), W2.4(), FPL.4(-1,1), FPL.4(-2,3), FPL.4(-0.5,0.5)), 
c(10, 50, 90), "kang")

## Comparing to model-averaged ED values with simple linear regression included
maED(ryegrass.m1, 
list(LL.5(), LN.4(), W1.4(), W2.4(), FPL.4(-1,1), FPL.4(-2,3), FPL.4(-0.5,0.5)), 
c(10, 50, 90), interval = "buckland", linreg = TRUE)



## Example with a model fit involving two compounds/curves
S.alba.m1 &lt;- drm(DryMatter~Dose, Herbicide, data=S.alba, fct = LL.4(),
pmodels=data.frame(Herbicide,1,1,Herbicide)) 

## Model-averaged ED50 for both compounds
maED(S.alba.m1, list(LL.3(), LN.4()), 50)

## Model-averaged ED50 only for one compound (glyphosate)
maED(S.alba.m1, list(LL.3(), LN.4()), 50, clevel="Glyphosate")

## With confidence intervals
maED(S.alba.m1, list(LL.3(), LN.4()), 50, interval="buckland")

## For comparison model-specific confidence intervals
ED(S.alba.m1, 50, interval="delta")  # wider!

</code></pre>

<hr>
<h2 id='MAX'>Maximum mean response</h2><span id='topic+MAX'></span>

<h3>Description</h3>

<p><code>MAX</code> estimates the maximum mean response and the dose at which it occurs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAX(object, lower = 1e-3, upper = 1000, pool = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAX_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="MAX_+3A_lower">lower</code></td>
<td>
<p>numeric. Lower limit for bisection method. Need to be smaller than EDx level to be calculated.</p>
</td></tr>  
<tr><td><code id="MAX_+3A_upper">upper</code></td>
<td>
<p>numeric. Upper limit for bisection method. Need to be larger than EDx level to be calculated.</p>
</td></tr>
<tr><td><code id="MAX_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function is only implemented for the built-in functions of class <code><a href="#topic+braincousens">braincousens</a></code> and 
<code><a href="#topic+cedergreen">cedergreen</a></code>.
</p>
<p>This function was used for obtaining the results on hormesis effect size reported in Cedergreen et al. (2005).
</p>


<h3>Value</h3>

<p>A matrix with one row per curve in the data set and two columns: 
one containing the dose at which the maximum occurs 
and one containing the corresponding maximum response.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Cedergreen, N. and Ritz, C. and Streibig, J. C. (2005) Improved empirical models describing hormesis, 
<em>Environmental Toxicology and Chemistry</em> <b>24</b>, 3166&ndash;3172. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a Cedergreen-Ritz-Streibig model
lettuce.m1 &lt;- drm(weight~conc, data = lettuce, fct = CRS.4c())

## Finding maximum average response and the corrresponding dose
MAX(lettuce.m1)

</code></pre>

<hr>
<h2 id='mecter'>Mechlorprop and terbythylazine tested on Lemna minor</h2><span id='topic+mecter'></span>

<h3>Description</h3>

<p>Data consist of 5 mixture, 6 dilutions, three replicates, and 12 common controls; in total 102 onservations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mecter)</code></pre>


<h3>Format</h3>

<p>A data frame with 102 observations on the following 3 variables.
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector of dose values</p>
</dd>
<dt><code>pct</code></dt><dd><p>a numeric vector denoting the grouping according to the mixtures percentages</p>
</dd>
<dt><code>rgr</code></dt><dd><p>a numeric vector of response values (relative growth rates)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset is analysed in Soerensen et al (2007). 
The asymmetric Voelund model is appropriate, whereas the symmetric Hewlett model is not.
</p>


<h3>Source</h3>

<p>The dataset is kindly provided by Nina Cedergreen, Department of Agricultural Sciences, 
Royal Veterinary and Agricultural University, Denmark.
</p>


<h3>References</h3>

<p>Soerensen, H. and Cedergreen, N. and Skovgaard, I. M. and Streibig, J. C. (2007) 
An isobole-based statistical model and test for synergism/antagonism in binary mixture toxicity experiments, 
<em>Environmental and Ecological Statistics</em>, <b>14</b>, 383&ndash;397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting the model with freely varying ED50 values
mecter.free &lt;- drm(rgr ~ dose, pct, data = mecter, 
fct = LL.4(), pmodels = list(~1, ~1, ~1, ~factor(pct) - 1)) 

## Lack-of-fit test
modelFit(mecter.free)  # not really acceptable
summary(mecter.free)

## Plotting isobole structure
isobole(mecter.free, exchange = 0.02)

## Fitting the concentration addition model
mecter.ca &lt;- mixture(mecter.free, model = "CA")

## Comparing to model with freely varying e parameter
anova(mecter.ca, mecter.free)  # rejected

## Plotting isobole based on concentration addition
isobole(mecter.free, mecter.ca, exchange = 0.02)  # poor fit

## Fitting the Hewlett model
mecter.hew &lt;- mixture(mecter.free, model = "Hewlett")

## Comparing to model with freely varying e parameter
anova(mecter.hew, mecter.free)  # rejected

## Plotting isobole based on the Hewlett model
isobole(mecter.free, mecter.hew, exchange = 0.02)  # poor fit

## Fitting the Voelund model
mecter.voe&lt;-mixture(mecter.free, model = "Voelund")

## Comparing to model with freely varying e parameter
anova(mecter.voe, mecter.free)  # accepted

## Plotting isobole based on the Voelund model
isobole(mecter.free, mecter.voe, exchange = 0.02)  # good fit

</code></pre>

<hr>
<h2 id='metals'>
Data from heavy metal mixture experiments
</h2><span id='topic+metals'></span>

<h3>Description</h3>

<p>Data are from a study of the response of the cyanobacterial self-luminescent metallothionein-based whole-cell biosensor Synechoccocus elongatus PCC 7942 pBG2120 to binary mixtures of 6 heavy metals (Zn, Cu, Cd, Ag, Co and Hg).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("metals")</code></pre>


<h3>Format</h3>

<p>A data frame with 543 observations on the following 3 variables.
</p>

<dl>
<dt><code>metal</code></dt><dd><p>a factor with levels <code>Ag</code> <code>AgCd</code> <code>Cd</code> <code>Co</code> <code>CoAg</code> <code>CoCd</code> <code>Cu</code> <code>CuAg</code> <code>CuCd</code> <code>CuCo</code> <code>CuHg</code> <code>CuZn</code> <code>Hg</code> <code>HgCd</code> <code>HgCo</code> <code>Zn</code> <code>ZnAg</code> <code>ZnCd</code> <code>ZnCo</code> <code>ZnHg</code></p>
</dd>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations</p>
</dd>
<dt><code>BIF</code></dt><dd><p>a numeric vector of luminescence induction factors</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data are from the study described by Martin-Betancor et al. (2015).
</p>


<h3>Source</h3>

<p>Martin-Betancor, K. and Ritz, C. and Fernandez-Pinas, F. and Leganes, F. and Rodea-Palomares, I. (2015) 
Defining an additivity framework for mixture research in inducible whole-cell biosensors,
<em>Scientific Reports</em>
<b>17200</b>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## One example from the paper by Martin-Betancor et al (2015)

## Figure 2

## Fitting a model for "Zn"
Zn.lgau &lt;- drm(BIF ~ conc, data = subset(metals, metal == "Zn"), 
fct = lgaussian(), bcVal = 0, bcAdd = 10)

## Plotting data and fitted curve
plot(Zn.lgau, log = "", type = "all", 
xlab = expression(paste(plain("Zn")^plain("2+"), " ", mu, "", plain("M"))))

## Calculating effective doses
ED(Zn.lgau, 50, interval = "delta")
ED(Zn.lgau, -50, interval = "delta", bound = FALSE)
ED(Zn.lgau, 99.999,interval = "delta")  # approx. for ED0

## Fitting a model for "Cu"
Cu.lgau &lt;- drm(BIF ~ conc, data = subset(metals, metal == "Cu"), 
fct = lgaussian()) 

## Fitting a model for the mixture Cu-Zn
CuZn.lgau &lt;- drm(BIF ~ conc, data = subset(metals, metal == "CuZn"), 
fct = lgaussian()) 

## Calculating effects needed for the FA-CI plot
CuZn.effects &lt;- CIcompX(0.015, list(CuZn.lgau, Cu.lgau, Zn.lgau), 
c(-5, -10, -20, -30, -40, -50, -60, -70, -80, -90, -99, 99, 90, 80, 70, 60, 50, 40, 30, 20, 10))

## Reproducing the FA-cI plot shown in Figure 5d
plotFACI(CuZn.effects, "ED", ylim = c(0.8, 1.6), showPoints = TRUE)

</code></pre>

<hr>
<h2 id='methionine'>Weight gain for different methionine sources</h2><span id='topic+methionine'></span>

<h3>Description</h3>

<p>Data consist of average body weight gain of chickens being treated 
with one of the two methionine sources DLM and HMTBA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(methionine)</code></pre>


<h3>Format</h3>

<p>A data frame with 9 observations on the following 3 variables:
</p>

<dl>
<dt><code>product</code></dt><dd><p>a factor with levels <code>control</code>, <code>DLM</code> and <code>MHA</code> denoting the treatments</p>
</dd>
<dt><code>dose</code></dt><dd><p>a numeric vector of methionine dose</p>
</dd>
<dt><code>gain</code></dt><dd><p>a numeric vector of average body weight gain</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset contains a common control measurement for the two treatments. More examples using this
dataset are found under <code><a href="#topic+AR.2">AR.2</a></code> and <code><a href="#topic+MM.2">MM.2</a></code>.
</p>


<h3>Source</h3>

<p>Kratzer. D. D. and Littell, R. C. (2006) Appropriate Statistical Methods to Compare 
Dose Responses of Methionine Sources, <em>Poultry Science</em>, <b>85</b>, 947&ndash;954.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting model with constraint on one parameter 
met.ar.m1 &lt;- drm(gain~dose, product, data = methionine, 
fct = AR.3(), pmodels = list(~1, ~factor(product), ~factor(product)), 
upperl = c(Inf, Inf, 1700, Inf, Inf)) 

plot(met.ar.m1, xlim=c(0,0.3), ylim=c(1450, 1800))
abline(h=1700, lty=1)

summary(met.ar.m1)

</code></pre>

<hr>
<h2 id='mixture'>Fitting binary mixture models</h2><span id='topic+mixture'></span>

<h3>Description</h3>

<p>'mixture' fits a concentration addition, Hewlett or Voelund model to data from binary mixture toxicity experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mixture(object, model = c("CA", "Hewlett", "Voelund"), start, startm, control = drmc())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixture_+3A_object">object</code></td>
<td>
<p>object of class 'drc' corresponding to the model with freely varying EC50 values.</p>
</td></tr>
<tr><td><code id="mixture_+3A_model">model</code></td>
<td>
<p>character string. It can be &quot;CA&quot;, &quot;Hewlett&quot; or &quot;Voelund&quot;.</p>
</td></tr>
<tr><td><code id="mixture_+3A_start">start</code></td>
<td>
<p>optional numeric vector supplying starting values for all parameters in the mixture model.</p>
</td></tr>
<tr><td><code id="mixture_+3A_startm">startm</code></td>
<td>
<p>optional numeric vector supplying the lambda parameter in the Hewlett model or 
the eta parameters (two parameters) in the Voelund model.</p>
</td></tr>  
<tr><td><code id="mixture_+3A_control">control</code></td>
<td>
<p>list of arguments controlling constrained optimisation (zero as boundary), 
maximum number of iteration in the optimisation,
relative tolerance in the optimisation, warnings issued during the optimisation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is a wrapper to <code><a href="#topic+drm">drm</a></code>, implementing the models described in Soerensen et al. (2007). 
See the paper for a discussion of the merits of the different models.
</p>
<p>Currently only the log-logistic models are available. Application of Box-Cox transformation is not yet available.
</p>


<h3>Value</h3>

<p>An object of class 'drc' with a few additional components. 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Ritz, C. and Streibig, J. C. (2014)
From additivity to synergism - A modelling perspective
<em>Synergy</em>, <b>1</b>, 22&ndash;29.
</p>


<h3>See Also</h3>

<p>The examples in <code><a href="#topic+acidiq">acidiq</a></code> (the Hewlett model), <code><a href="#topic+glymet">glymet</a></code> (dose/concentration addition) 
and <code><a href="#topic+mecter">mecter</a></code> (the Voelund model).
</p>

<hr>
<h2 id='MM'>Michaelis-Menten model</h2><span id='topic+MM.2'></span><span id='topic+MM.3'></span>

<h3>Description</h3>

<p>The functions can be used to fit (shifted) Michaelis-Menten models that are used
for modeling enzyme kinetics, weed densities etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
  MM.2(fixed = c(NA, NA), names = c("d", "e"), ...)
  
  MM.3(fixed = c(NA, NA, NA), names = c("c", "d", "e"), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MM_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="MM_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).</p>
</td></tr>
<tr><td><code id="MM_+3A_...">...</code></td>
<td>
<p>additional arguments from convenience functions to <code><a href="#topic+llogistic">llogistic</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is defined by the three-parameter model function
</p>
<p style="text-align: center;"><code class="reqn">f(x, (c, d, e)) = c + \frac{d-c}{1+(e/x)}</code>
</p>

<p>It is an increasing as a function of the dose <code class="reqn">x</code>, attaining the lower limit <code class="reqn">c</code> at dose 0 (<code class="reqn">x=0</code>) 
and the upper limit <code class="reqn">d</code> for infinitely large doses. The parameter <code class="reqn">e</code> corresponds to the dose yielding a response
halfway between <code class="reqn">c</code> and <code class="reqn">d</code>. 
</p>
<p>The common two-parameter Michaelis-Menten model (<code>MM.2</code>) is obtained by
setting <code class="reqn">c</code> equal to 0.
</p>


<h3>Value</h3>

<p>A list of class <code>drcMean</code>, containing the mean function, the self starter function,
the parameter names and other components such as derivatives and a function for calculating ED values.
</p>


<h3>Note</h3>

<p>At the moment the implementation cannot deal with infinite concentrations.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>Related models are the asymptotic regression models <code><a href="#topic+AR.2">AR.2</a></code> and <code><a href="#topic+AR.3">AR.3</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting Michaelis-Menten model
met.mm.m1 &lt;- drm(gain~dose, product, data=methionine, fct=MM.3(), 
pmodels = list(~1, ~factor(product), ~factor(product)))
plot(met.mm.m1, log = "", ylim=c(1450, 1800))
summary(met.mm.m1)
ED(met.mm.m1, c(10, 50))

## Calculating bioefficacy: approach 1
coef(met.mm.m1)[4] / coef(met.mm.m1)[5] * 100

## Calculating bioefficacy: approach 2
EDcomp(met.mm.m1, c(50,50))

## Simplified models
met.mm.m2a &lt;- drm(gain~dose, product, data=methionine, fct=MM.3(), 
pmodels = list(~1, ~factor(product), ~1))
anova(met.mm.m2a, met.mm.m1)  # model reduction not possible

met.mm.m2b &lt;- drm(gain~dose, product, data=methionine, fct=MM.3(), 
pmodels = list(~1, ~1, ~factor(product)))
anova(met.mm.m2b, met.mm.m1)  # model reduction not possible

</code></pre>

<hr>
<h2 id='modelFit'>Assessing the model fit</h2><span id='topic+modelFit'></span>

<h3>Description</h3>

<p>Checking the fit of dose-response model by means of formal significance tests or graphical procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  modelFit(object, test = NULL, method = c("gof", "cum"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelFit_+3A_object">object</code></td>
<td>
<p>object of class 'drc'</p>
</td></tr>
<tr><td><code id="modelFit_+3A_test">test</code></td>
<td>
<p>character string defining the test method to apply</p>
</td></tr>
<tr><td><code id="modelFit_+3A_method">method</code></td>
<td>
<p>character string specifying the method to be used for assessing the model fit</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently two methods are available. For continuous data the clasical lack-of-fit test is applied 
(Bates and Watts, 1988). The test compares the dose-response model to a more general ANOVA model 
using an approximate F-test. For quantal data the crude goodness-of-fit test based on Pearson's statistic is used. 
</p>
<p>None of these tests are very powerful. A significant test result is more alarming than a non-significant one. 
</p>


<h3>Value</h3>

<p>An object of class 'anova' which will be displayed in much the same way as an ordinary ANOVA table.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Bates, D. M. and Watts, D. G. (1988) 
<em>Nonlinear Regression Analysis and Its Applications</em>, 
New York: Wiley \&amp; Sons (pp. 103&ndash;104).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Comparing the four-parameter log-logistic model 
##  to a one-way ANOVA model using an approximate F test
## in other words applying a lack-of-fit test
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.4())
modelFit(ryegrass.m1)   

</code></pre>

<hr>
<h2 id='mr.test'>
Mizon-Richard test for dose-response models 
</h2><span id='topic+mr.test'></span>

<h3>Description</h3>

<p>The function provides a lack-of-fit test for the mean structure based on the Mizon-Richard test as compared to a
specific alternative model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mr.test(object1, object2, object, x, var.equal = TRUE, component = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mr.test_+3A_object1">object1</code></td>
<td>

<p>object of class 'drc' (null model).
</p>
</td></tr>
<tr><td><code id="mr.test_+3A_object2">object2</code></td>
<td>

<p>object of class 'drc' (alternative model).
</p>
</td></tr>
<tr><td><code id="mr.test_+3A_object">object</code></td>
<td>

<p>object of class 'drc' (fitted model under alternative).
</p>
</td></tr>
<tr><td><code id="mr.test_+3A_x">x</code></td>
<td>

<p>numeric vector of dose values.
</p>
</td></tr>
<tr><td><code id="mr.test_+3A_var.equal">var.equal</code></td>
<td>

<p>logical indicating whether or not equal variances can be assumed across doses.
</p>
</td></tr>
<tr><td><code id="mr.test_+3A_component">component</code></td>
<td>

<p>numeric vector specifying the component(s) in the parameter vector to use in the test.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides a p-value indicating whether or not the mean structure is appropriate.
</p>
<p>The test is applicable even in cases where data are non-normal or exhibit variance heterogeneity.
</p>


<h3>Value</h3>

<p>A p-value for test of the null hypothesis that the chosen mean structure is appropriate as compared
to the alternative mean structure provided (see Ritz and Martinussen (2011) for a detailed explanation).
</p>


<h3>Note</h3>

<p>This functionality is still experimental: Currently, the null and alternative models are hardcoded!
In the future the function will be working for null and alternative models specified by the user.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Ritz, C and Martinussen, T. (2011)   
Lack-of-fit tests for assessing mean structures for continuous dose-response data,
<em>Environmental and Ecological Statistics</em>, <b>18</b>, 349&ndash;366
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+modelFit">modelFit</a></code> for details on the related lack-of-fit test against an ANOVA model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting log-logistic and Weibull models 
## The Weibull model is the alternative
etmotc.m1&lt;-drm(rgr1~dose1, data=etmotc[1:15,], fct=LL.4())
etmotc.m2 &lt;- update(etmotc.m1, fct=W1.4())

## Fitting the fitted model (using the alternative model)
etmotc.m3 &lt;- drm(fitted(etmotc.m1)~dose1, data=etmotc[1:15,], fct=W1.4())

## Handling missing values
xVec &lt;- etmotc[1:15,]$dose1
xVec[1:8] &lt;- 1e-10  # avoiding 0's

## Obtaining the Mizon-Richard test
mr.test(etmotc.m1, etmotc.m2, etmotc.m3, xVec, var.equal = FALSE)

</code></pre>

<hr>
<h2 id='mselect'>Dose-response model selection</h2><span id='topic+mselect'></span>

<h3>Description</h3>

<p>Model selection by comparison of different models using the following criteria: the log likelihood value, 
Akaike's information criterion (AIC), the estimated residual standard error 
or the p-value from a lack-of-fit test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mselect(object, fctList = NULL, nested = FALSE, 
  sorted = c("IC", "Res var", "Lack of fit", "no"), linreg = FALSE, icfct = AIC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mselect_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="mselect_+3A_fctlist">fctList</code></td>
<td>
<p>a list of dose-response functions to be compared.</p>
</td></tr>
<tr><td><code id="mselect_+3A_nested">nested</code></td>
<td>
<p>logical. TRUE results in F tests between adjacent models (in 'fctList'). 
Only sensible for nested models.</p>
</td></tr>
<tr><td><code id="mselect_+3A_sorted">sorted</code></td>
<td>
<p>character string determining according to which criterion the model fits are ranked.</p>
</td></tr>
<tr><td><code id="mselect_+3A_linreg">linreg</code></td>
<td>
<p>logical indicating whether or not additionally polynomial regression models (linear, quadratic, and cubic models) 
should be fitted (they could be useful for a kind of informal lack-of-test consideration for the models specified, 
capturing unexpected departures).</p>
</td></tr>
<tr><td><code id="mselect_+3A_icfct">icfct</code></td>
<td>
<p>function for supplying the information criterion to be used. <code><a href="stats.html#topic+AIC">AIC</a></code> and <code><a href="stats.html#topic+BIC">BIC</a></code> are two options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Akaike's information criterion and the residual standard error: the smaller the better and 
for lack-of-fit test (against a one-way ANOVA model): the larger (the p-value) the better. Note that the residual standard error is only available for 
continuous dose-response data.
</p>
<p>Log likelihood values cannot be used for comparison unless the models are nested.
</p>


<h3>Value</h3>

<p>A matrix with one row for each model and one column for each criterion.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example with continuous/quantitative data
## Fitting initial four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())

## Model selection
mselect(ryegrass.m1, list(LL.3(), LL.5(), W1.3(), W1.4(), W2.4(), baro5()))

## Model selection including linear, quadratic, and cubic regression models
mselect(ryegrass.m1, list(LL.3(), LL.5(), W1.3(), W1.4(), W2.4(), baro5()), linreg = TRUE)

## Comparing nested models
mselect(ryegrass.m1, list(LL.5()), nested = TRUE)

### Example with quantal data
## Fitting initial two-parameter log-logistic model
earthworms.m1 &lt;- drm(number/total~dose, weights=total, 
data = earthworms, fct = LL.2(), type = "binomial")

## Comparing 4 models
mselect(earthworms.m1, list(W1.2(), W2.2(), LL.3()))


</code></pre>

<hr>
<h2 id='multi2'>
Multistage dose-response model with quadratic terms
</h2><span id='topic+multi2'></span>

<h3>Description</h3>

<p>The multistage dose-response model is a combination of log-logistic models that should be useful for describing
more complex dose-response patterns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  multi2(
  fixed = c(NA, NA, NA, NA, NA), 
  names = c("b1", "b2", "b3", "c", "d"), 
  ssfct = NULL, 
  fctName, 
  fctText)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi2_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector specifying which parameters are fixed and at what value they are fixed. 
NAs are used for parameters that are not fixed.</p>
</td></tr>
<tr><td><code id="multi2_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage').</p>
</td></tr>
<tr><td><code id="multi2_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>    
<tr><td><code id="multi2_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="multi2_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multistage model function with quadratic terms is defined as follows
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c)\exp(-b1-b2x-b3x^2)</code>
</p>

<p>where x denotes the dose or the logarithm-transformed dose.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Wheeler, M. W., Bailer, A. J. (2009)
Comparing model averaging with other model selection strategies for benchmark dose estimation,
<em>Environmental and Ecological Statistics</em>, <b>16</b>, 37&ndash;51.
</p>

<hr>
<h2 id='nasturtium'>Dose-response profile of degradation of agrochemical using nasturtium</h2><span id='topic+nasturtium'></span>

<h3>Description</h3>

<p>Estimation of the degradation profile of an agrochemical based on soil samples at depth 0-10cm
from a calibration experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nasturtium)</code></pre>


<h3>Format</h3>

<p>A data frame with 42 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations (g/ha)</p>
</dd>
<dt><code>weight</code></dt><dd><p>a numeric vector of plant weight (mg) after 3 weeks' growth</p>
</dd>
</dl>



<h3>Details</h3>

<p>It is an experiment with seven concentrations and six replicates per concentration. <em>Nasturtium</em>
is sensitive and its weight reduces noticeable at low concentrations.
</p>
<p>Racine-Poon (1988) suggests using a three-parameter log-logistic model.
</p>


<h3>Source</h3>

<p>Racine-Poon, A. (1988) A Bayesian Approach to Nonlinear Calibration Problems, 
<em>J. Am. Statist. Ass.</em>, <b>83</b>, 650&ndash;656.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nasturtium.m1 &lt;- drm(weight~conc, data=nasturtium, fct = LL.3())

modelFit(nasturtium.m1)

plot(nasturtium.m1, type = "all", log = "", xlab = "Concentration (g/ha)", ylab = "Weight (mg)")
</code></pre>

<hr>
<h2 id='NEC'>
Dose-response model for estimation of no effect concentration (NEC).
</h2><span id='topic+NEC'></span><span id='topic+NEC.2'></span><span id='topic+NEC.3'></span><span id='topic+NEC.4'></span>

<h3>Description</h3>

<p>The no effect concentration has been proposed as an alternative to both the classical no observed effect concentration
(NOEC) and the regression-based EC/ED approach. The NEC model is a dose-response model with a threshold below 
which the response is assumed constant and equal to the control response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  NEC(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), fctName, fctText)

  NEC.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
  
  NEC.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  NEC.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NEC_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector specifying which parameters are fixed and at what value they are fixed. 
NAs are used for parameters that are not fixed.</p>
</td></tr>
<tr><td><code id="NEC_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage').</p>
</td></tr>
<tr><td><code id="NEC_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="NEC_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>
<tr><td><code id="NEC_+3A_upper">upper</code></td>
<td>
<p>numeric value. The fixed, upper limit in the model. Default is 1.</p>
</td></tr>
<tr><td><code id="NEC_+3A_...">...</code></td>
<td>
<p>additional arguments in <code><a href="#topic+NEC">NEC</a></code></p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The NEC model function proposed by Pires <em>et al</em> (2002) is defined as follows
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c)\exp(-b(x-e)I(x-e)) + \frac{d2}{1+\exp(b2(\log(x)-\log(e2)))}</code>
</p>

<p>where <code class="reqn">I(x-e)</code> is the indicator function. It is equal to 0 for <code class="reqn">x&lt;=e</code> and equal 1 for <code class="reqn">x&gt;e</code>.
</p>
<p>In other words: The parameter e in <code>NEC</code> in &quot;drc&quot; corresponds to the parameter c' in Pires <em>et al</em> (2002),
the parameter b in <code>NEC</code> in &quot;drc&quot; corresponds to the parameter m' in Pires <em>et al</em> (2002), the parameter d 
in <code>NEC</code> in &quot;drc&quot; corresponds to the parameter l' in Pires <em>et al</em> (2002), and finally the parameter c in 
<code>NEC</code> in &quot;drc&quot; (the lower horizontal limit) is (implictly) fixed at 0 in Pires <em>et al</em> (2002)
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Pires, A. M., Branco, J. A., Picado, A., Mendonca, E. (2002)
Models for the estimation of a 'no effect concentration',
<em>Environmetrics</em>, <b>13</b>, 15&ndash;27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
nec.m1 &lt;- drm(rootl~conc, data=ryegrass, fct=NEC.4())

summary(nec.m1)

plot(nec.m1)

abline(v=coef(nec.m1)[4], lty=2)  # showing the estimated threshold 

</code></pre>

<hr>
<h2 id='neill.test'>
Neill's lack-of-fit test for dose-response models
</h2><span id='topic+neill.test'></span>

<h3>Description</h3>

<p>'neill.test' provides a lack-of-fit test for non-linear regression models. It is applicable both in cases 
where there are replicates (in which case it reduces to the standard lack-of-fit test against an ANOVA
model) and in cases where there are no replicates, though then a grouping has to be provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  neill.test(object, grouping, method = c("c-finest", "finest", "percentiles"), 
  breakp = NULL, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neill.test_+3A_object">object</code></td>
<td>

<p>object of class 'drc' or 'nls'.
</p>
</td></tr>
<tr><td><code id="neill.test_+3A_grouping">grouping</code></td>
<td>

<p>character or numeric vector that provides the grouping of the dose values.
</p>
</td></tr>
<tr><td><code id="neill.test_+3A_method">method</code></td>
<td>

<p>character string specifying the method to be used to generate a grouping of the dose values.
</p>
</td></tr>
<tr><td><code id="neill.test_+3A_breakp">breakp</code></td>
<td>

<p>numeric vector of break points for generating dose intervals that form a grouping.
</p>
</td></tr>
<tr><td><code id="neill.test_+3A_display">display</code></td>
<td>

<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions used the methods <code><a href="stats.html#topic+df.residual">df.residual</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code> and the 'data'
component of <code>object</code> (only for determining the number of observations).
</p>


<h3>Value</h3>

<p>The function returns an object of class anova which is displayed using <code>print.anova</code>.
</p>


<h3>Note</h3>

<p>A clustering technique could be employed to determine the grouping to be used in cases where there are
no replicates. There should at most be ceiling(n/2) clusters as otherwise some observations will not be used
in the test. At the other end there need to be more clusters than parameters in the model.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Neill, J. W. (1988) Testing for lack of fit in nonlinear regression, 
<em>Ann. Statist.</em>, <b>16</b>, 733&ndash;740  
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+modelFit">modelFit</a></code> for details on the lack-of-fit test against an ANOVA model.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example with 'drc' object

## Lack-of-fit test against ANOVA
ryegrass.m1 &lt;-drm(rootl~conc, data = ryegrass, fct = LL.4())
modelFit(ryegrass.m1)

## The same test using 'neill.test'
neill.test(ryegrass.m1, ryegrass$conc)

## Generating a grouping
neill.test(ryegrass.m1, method="c-finest")
neill.test(ryegrass.m1, method="finest")
neill.test(ryegrass.m1, method="perc")


</code></pre>

<hr>
<h2 id='noEffect'>
Testing if there is a dose effect at all
</h2><span id='topic+noEffect'></span>

<h3>Description</h3>

<p>A significance test is provided for the comparison of the dose-response model considered and the simple linear regression
model with slope 0 (a horizontal regression line corresponding to no dose effect)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noEffect(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noEffect_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perhaps useful for screening purposes.
</p>


<h3>Value</h3>

<p>The likelihood ratio test statistic and the corresponding degrees of freedom and p-value are reported.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.LL.4 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())

noEffect(ryegrass.LL.4)
# p-value &lt; 0.0001: there is a highly significant dose effect!

</code></pre>

<hr>
<h2 id='O.mykiss'>Test data from a 21 day fish test</h2><span id='topic+O.mykiss'></span>

<h3>Description</h3>

<p>Test data from a 21 day fish test following the guidelines OECD GL204, 
using the test organism Rainbow trout <em>Oncorhynchus mykiss</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(O.mykiss)</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations (mg/l)</p>
</dd>
<dt><code>weight</code></dt><dd><p>a numeric vector of wet weights (g)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Weights are measured after 28 days.
</p>


<h3>Source</h3>

<p>Organisation for Economic Co-operation and Development (OECD) (2006)
<em>CURRENT APPROACHES IN THE STATISTICAL ANALYSIS OF ECOTOXICITY DATA: A GUIDANCE TO APPLICATION - ANNEXES</em>,
Paris (p. 65).
</p>


<h3>References</h3>

<p>Organisation for Economic Co-operation and Development (OECD) (2006)
<em>CURRENT APPROACHES IN THE STATISTICAL ANALYSIS OF ECOTOXICITY DATA: A GUIDANCE TO APPLICATION - ANNEXES</em>,
Paris (pp. 80&ndash;85).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(O.mykiss)

## Fitting exponential model
O.mykiss.m1 &lt;- drm(weight ~ conc, data = O.mykiss, fct = EXD.2(), na.action = na.omit)
modelFit(O.mykiss.m1)
summary(O.mykiss.m1)

## Fitting same model with transform-both-sides approach
O.mykiss.m2 &lt;- boxcox(O.mykiss.m1 , method = "anova")
summary(O.mykiss.m2)
# no need for a transformation

## Plotting the fit
plot(O.mykiss.m1, type = "all", xlim = c(0, 500), ylim = c(0,4),
xlab = "Concentration (mg/l)", ylab = "Weight (g)", broken = TRUE)

</code></pre>

<hr>
<h2 id='P.promelas'>Effect of sodium pentachlorophenate on growth of fathead minnow</h2><span id='topic+P.promelas'></span>

<h3>Description</h3>

<p>Fathead minnows (<em>Pimephales promelas</em>) were exposed to sodium pentachlorophenate
concentrations ranging from 32 to 512 micro g/L in a 7-day larval survival and growth test.
The average dry weight was measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(P.promelas)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of sodium pentachlorophenate concentrations (micro g/L).</p>
</dd>
<dt><code>dryweight</code></dt><dd><p>a numeric vector dry weights (mg)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are analysed in Bruce and Versteeg (1992) using a log-normal 
dose-response model (using the logarithm with base 10).
</p>


<h3>Source</h3>

<p>Bruce, R. D. and Versteeg, D. J. (1992) A statistical procedure for modeling continuous toxicity data,
<em>Environ. Toxicol. Chem.</em>, <b>11</b>, 1485&ndash;1494.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Model with ED50 on log scale as parameter
p.prom.m1&lt;-drm(dryweight~conc, data=P.promelas, fct=LN.3())

plot(fitted(p.prom.m1), residuals(p.prom.m1))

plot(p.prom.m1, type="all", broken=TRUE, xlim=c(0,1000))
summary(p.prom.m1)
ED(p.prom.m1, c(10,20,50), interval="delta")

## Model with ED50 as parameter
p.prom.m2&lt;-drm(dryweight~conc, data=P.promelas, fct=LN.3(loge=TRUE))
summary(p.prom.m2)
ED(p.prom.m2, c(10,20,50), interval="fls")

</code></pre>

<hr>
<h2 id='plot.drc'>Plotting fitted dose-response curves</h2><span id='topic+plot.drc'></span>

<h3>Description</h3>

<p><code>plot</code> displays fitted curves and observations in the same plot window, 
distinguishing between curves by different plot symbols and line types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  
  ## S3 method for class 'drc'
plot(x, ..., add = FALSE, level = NULL, 
  type = c("average", "all", "bars", "none", "obs", "confidence"),  
  broken = FALSE, bp, bcontrol = NULL, conName = NULL, axes = TRUE, 
  gridsize = 100, log = "x", xtsty, xttrim = TRUE, 
  xt = NULL, xtlab = NULL, xlab, xlim, 
  yt = NULL, ytlab = NULL, ylab, ylim,
  cex, cex.axis = 1, col = FALSE, lty, pch, 
  legend, legendText, legendPos, cex.legend = 1,
  normal = FALSE, normRef = 1, confidence.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.drc_+3A_x">x</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_...">...</code></td>
<td>
<p>additional graphical arguments. For instance, use <code>lwd=2</code> or <code>lwd=3</code> to increase the width of plot symbols.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_add">add</code></td>
<td>
<p>logical. If TRUE then add to already existing plot.</p>
</td></tr> 
<tr><td><code id="plot.drc_+3A_level">level</code></td>
<td>
<p>vector of character strings. To plot only the curves specified by their names.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_type">type</code></td>
<td>
<p>a character string specifying how to plot the data. There are currently
5 options:  &quot;average&quot; (averages and fitted curve(s); default), 
&quot;none&quot; (only the fitted curve(s)), &quot;obs&quot; (only the data points), 
&quot;all&quot; (all data points and fitted curve(s)),
&quot;bars&quot; (averages and fitted curve(s) with model-based standard errors (see Details)), and
&quot;confidence&quot; (confidence bands for fitted curve(s)).</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_broken">broken</code></td>
<td>
<p>logical. If TRUE the x axis is broken provided this axis is logarithmic 
(using functionality in the CRAN package 'plotrix').</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_bp">bp</code></td>
<td>
<p>numeric value specifying the break point below which the dose is zero (the amount of stretching on 
the dose axis above zero in order to create the visual illusion of a logarithmic scale <em>including</em> 0). 
The default is the base-10 value corresponding to the rounded value of the minimum of the log10 values of 
all positive dose values. This argument is only working for logarithmic dose axes.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_bcontrol">bcontrol</code></td>
<td>
<p>a list with components <code>factor</code>, <code>style</code> and <code>width</code>. 
Controlling the appearance of the break (in case <code>broken</code> is <code>TRUE</code>). 
The component <code>factor</code> is the distance from the control to the break as a 
multiple of the value of <code>bp</code> (default is 2).
The component <code>style</code> can take the values: <code>gap</code>, <code>slash</code> or <code>zigzag</code>.
The component <code>width</code> is the width of the break symbol (default is 0.02).</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_conname">conName</code></td>
<td>
<p>character string. Name on x axis for dose zero. Default is '&quot;0&quot;'.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_axes">axes</code></td>
<td>
<p>logical indicating whether both axes should be drawn on the plot.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_gridsize">gridsize</code></td>
<td>
<p>numeric. Number of points in the grid used for plotting the fitted curves.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_log">log</code></td>
<td>
<p>a character string which contains '&quot;x&quot;' if the x axis is to be logarithmic, '&quot;y&quot;' if the y axis is to be logarithmic and '&quot;xy&quot;' or
'&quot;yx&quot;' if both axes are to be logarithmic. The default is &quot;x&quot;. The empty string &quot;&quot; yields the original axes.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xtsty">xtsty</code></td>
<td>
<p>a character string specifying the dose axis style for arrangement of tick marks. By default (&quot;base10&quot;) 
For a logarithmic axis by default only base 10 tick marks are shown (&quot;base10&quot;). Otherwise sensible 
equidistantly located tick marks are shown (&quot;standard&quot;), relying on <code><a href="graphics.html#topic+axTicks">axTicks</a></code>.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xttrim">xttrim</code></td>
<td>
<p>logical specifying if the number of tick marks should be trimmed in case too many tick marks 
are initially determined.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xt">xt</code></td>
<td>
<p>a numeric vector containing the positions of the tick marks on the x axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xtlab">xtlab</code></td>
<td>
<p>a vector containing the tick marks on the x axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xlab">xlab</code></td>
<td>
<p>an optional label for the x axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the x axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_yt">yt</code></td>
<td>
<p>a numeric vector, containing the positions of the tick marks on the y axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_ytlab">ytlab</code></td>
<td>
<p>a vector containing the tick marks on the y axis.</p>
</td></tr> 
<tr><td><code id="plot.drc_+3A_ylab">ylab</code></td>
<td>
<p>an optional label for the y axis.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the y axis.</p>
</td></tr>  
<tr><td><code id="plot.drc_+3A_cex">cex</code></td>
<td>
<p>numeric or numeric vector specifying the size of plotting symbols and text 
(see <code><a href="graphics.html#topic+par">par</a></code> for details).</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric value specifying the magnification to be used for axis annotation 
relative to the current setting of cex.</p>
</td></tr>  
<tr><td><code id="plot.drc_+3A_col">col</code></td>
<td>
<p>either logical or a vector of colours. If TRUE default colours are used. 
If FALSE (default) no colours are used.</p>
</td></tr>  
<tr><td><code id="plot.drc_+3A_legend">legend</code></td>
<td>
<p>logical. If TRUE a legend is displayed.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_legendtext">legendText</code></td>
<td>
<p>a character string or vector of character strings specifying the legend text 
(the position of the upper right corner of the legend box).</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_legendpos">legendPos</code></td>
<td>
<p>numeric vector of length 2 giving the position of the legend.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_cex.legend">cex.legend</code></td>
<td>
<p>numeric specifying the legend text size.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_lty">lty</code></td>
<td>
<p>a numeric vector specifying the line types.</p>
</td></tr>
<tr><td><code id="plot.drc_+3A_pch">pch</code></td>
<td>
<p>a vector of plotting characters or symbols (see <code><a href="graphics.html#topic+points">points</a></code>).</p>
</td></tr>  
<tr><td><code id="plot.drc_+3A_normal">normal</code></td>
<td>
<p>logical. If TRUE the plot of the normalized data and fitted curves are shown
(for details see Weimer et al. (2012) for details).</p>
</td></tr> 
<tr><td><code id="plot.drc_+3A_normref">normRef</code></td>
<td>
<p>numeric specifying the reference for the normalization (default is 1).</p>
</td></tr>  
<tr><td><code id="plot.drc_+3A_confidence.level">confidence.level</code></td>
<td>
<p>confidence level for error bars. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The use of <code>xlim</code> allows changing the range of the x axis, extrapolating the fitted dose-response curves. 
Note that changing the range on the x axis may also entail a change of the range on the y axis. Sometimes
it may be useful to extend the upper limit on the y axis (using <code>ylim</code>) in order to fit a legend into 
the plot.
</p>
<p>See <code><a href="grDevices.html#topic+colors">colors</a></code> for the available colours.
</p>
<p>Suitable labels are automatically provided.
</p>
<p>The arguments <code>broken</code> and <code>bcontrol</code> rely on the function 
<code>link{axis.break}</code> with arguments 
<code>style</code> and <code>brw</code> in the package <code>plotrix</code>.
</p>
<p>The model-based standard errors used for the error bars are calculated
as the fitted value plus/minus the estimated error times the
1-(alpha/2) quantile in the t distribution with degrees of freedom
equal to the residual degrees of freedom for the model (or using a
standard normal distribution in case of binomial and poisson data),
where alpha=1-confidence.level. The standard errors are obtained using
the predict method with the arguments interval = &quot;confidence&quot;
and level=confidence.level.
</p>


<h3>Value</h3>

<p>An invisible data frame with the values used for plotting the fitted curves. The first column contains the dose values,
and the following columns (one for each curve) contain the fitted response values.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz and Jens C. Streibig. Contributions from Xiaoyan Wang and Greg Warnes. 
</p>


<h3>References</h3>

<p>Weimer, M., Jiang, X., Ponta, O., Stanzel, S., Freyberger, A., Kopp-Schneider, A. (2012)
The impact of data transformations on concentration-response modeling.
<em>Toxicology Letters</em>, <b>213</b>, 292&ndash;298.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting models to be plotted below
ryegrass.m1 &lt;- drm(rootl~conc, data = ryegrass, fct = LL.4())
ryegrass.m2 &lt;- drm(rootl~conc, data = ryegrass, fct = LL.3())  # lower limit fixed at 0

## Plotting observations and fitted curve for the first model
plot(ryegrass.m1, broken = TRUE) 

## Adding fitted curve for the second model (not much difference)
plot(ryegrass.m2, broken = TRUE, add = TRUE, type = "none", col = 2, lty = 2)

## Add confidence region for the first model.
plot(ryegrass.m1, broken = TRUE, type="confidence", add=TRUE) 

## Finetuning the axis break
plot(ryegrass.m1, broken = TRUE, bcontrol = list(style = "gap"))
plot(ryegrass.m1, broken = TRUE, bcontrol = list(style = "slash"))
plot(ryegrass.m1, broken = TRUE, bcontrol = list(style = "zigzag"))

## Plot without axes
plot(ryegrass.m1, axes = FALSE)

## Fitting model to be plotted below
spinach.m1 &lt;- drm(SLOPE~DOSE, CURVE, data = spinach, fct = LL.4())

## Plot with no colours
plot(spinach.m1, main = "Different line types (default)")

## Plot with default colours
plot(spinach.m1, col = TRUE, main = "Default colours")

## Plot with specified colours
plot(spinach.m1, col = c(2,6,3,23,56), main = "User-specified colours")

## Plot of curves 1 and 2 only
plot(spinach.m1, level = c(1,2), main = "User-specified curves")

## Plot with symbol of different sizes
plot(spinach.m1, cex = c(1,2,3,4,5), main = "User-specified symbil sizes")

## Plot with confidence regions
plot(spinach.m1, col = TRUE, main = "Confidence Regions", type = "confidence")

## Add points
plot(spinach.m1, col = TRUE, add=TRUE)

## Fitting another model to be plotted below
lettuce.m1 &lt;- drm(weight~conc, data = lettuce, fct = LL.4())

## Using the argument 'bp'. Compare the plots!
par(mfrow = c(2, 2))
plot(lettuce.m1, main = "bp = default")  # using the default
plot(lettuce.m1, bp = 1e-4, main = "bp = 1e-4")
plot(lettuce.m1, bp = 1e-6, main = "bp = 1e-6")
plot(lettuce.m1, bp = 1e-8, main = "bp = 1e-8")
par(mfrow = c(1,1))

## User-specified position of legend
S.alba.m1 &lt;- drm(DryMatter~Dose, Herbicide, data = S.alba, fct = LL.4())

plot(S.alba.m1)
plot(S.alba.m1, legendPos = c(0.3, 4.8))

</code></pre>

<hr>
<h2 id='PR'>Expected or predicted response</h2><span id='topic+PR'></span>

<h3>Description</h3>

<p>The function returns the expected or predicted response for specified dose values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  PR(object, xVec, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PR_+3A_object">object</code></td>
<td>
<p>object of class <code>drc</code> obtaining fitting a dose-response model.</p>
</td></tr>
<tr><td><code id="PR_+3A_xvec">xVec</code></td>
<td>
<p>numeric vector of dose values.</p>
</td></tr>
<tr><td><code id="PR_+3A_...">...</code></td>
<td>
<p>additional arguments to be supplied to <code><a href="#topic+predict.drc">predict.drc</a></code>. No effect at the moment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a convenience function for easy access to predicted values.
</p>


<h3>Value</h3>

<p>A numeric vector of predicted values or possibly a matrix of predicted values and corresponding standard errors.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz after a suggestion from Andrew Kniss.
</p>


<h3>See Also</h3>

<p>Predictions can also be obtained using <code><a href="#topic+predict.drc">predict.drc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.m1 &lt;- drm(ryegrass, fct = LL.4())
PR(ryegrass.m1, c(5, 10))

ryegrass.m2 &lt;- drm(ryegrass, fct = LL2.4())
PR(ryegrass.m2, c(5, 10))

spinach.m1 &lt;- drm(SLOPE~DOSE, CURVE, data=spinach, fct = LL.4())
PR(spinach.m1, c(5, 10))

</code></pre>

<hr>
<h2 id='predict.drc'>Prediction</h2><span id='topic+predict.drc'></span><span id='topic+predict.mrdrc'></span>

<h3>Description</h3>

<p>Predicted values for models of class 'drc' or class 'mrdrc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
predict(object, newdata, se.fit = FALSE, 
  interval = c("none", "confidence", "prediction"), 
  level = 0.95, na.action = na.pass, od = FALSE, vcov. = vcov, ...)

  ## S3 method for class 'mrdrc'
predict(object, newdata, se.fit = FALSE, 
  interval = c("none", "confidence", "prediction"), 
  level = 0.95, pava = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with which to predict.
If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_se.fit">se.fit</code></td>
<td>
<p>logical. If TRUE standard errors are required.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_interval">interval</code></td>
<td>
<p>character string. Type of interval calculation: &quot;none&quot;, &quot;confidence&quot; or &quot;prediction&quot;.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_level">level</code></td>
<td>
<p>Tolerance/confidence level.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_na.action">na.action</code></td>
<td>
<p>function determining what should be done with missing values in 'newdata'. 
The default is to predict 'NA'.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_vcov.">vcov.</code></td>
<td>
<p>function providing the variance-covariance matrix. <code><a href="stats.html#topic+vcov">vcov</a></code> is the default, 
but <code>sandwich</code> is also an option (for obtaining robust standard errors).</p>
</td></tr>  
<tr><td><code id="predict.drc_+3A_pava">pava</code></td>
<td>
<p>logical. If TRUE the fit is monotoniosed using pool adjacent violators algorithm.</p>
</td></tr>
<tr><td><code id="predict.drc_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the built-in log-logistics and Weibull-type models standard errors and confidence/prediction intervals 
can be calculated. At the moment it only works for the situations where all observations are assumed to 
have a common variance.
</p>


<h3>Value</h3>

<p>A matrix with as many rows as there are dose values provided in 'newdata' or in the original dataset 
(in case 'newdata' is not specified) and columns with fitted, standard errors, lower and upper limits
of confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>For details are found in the help page for <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a model
spinach.model1 &lt;- drm(SLOPE~DOSE, CURVE, data = spinach, fct = LL.4())

## Predicting values a dose=2 (with standard errors)
predict(spinach.model1, data.frame(dose=2, CURVE=c("1", "2", "3")), se.fit = TRUE)

## Getting confidence intervals
predict(spinach.model1, data.frame(dose=2, CURVE=c("1", "2", "3")), 
interval = "confidence")

## Getting prediction intervals
predict(spinach.model1, data.frame(dose=2, CURVE=c("1", "2", "3")), 
interval = "prediction")

</code></pre>

<hr>
<h2 id='print.drc'>Printing key features</h2><span id='topic+print.drc'></span>

<h3>Description</h3>

<p>'print' displays brief information on an object of class 'drc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
print(x, ..., digits = max(3, getOption("digits") - 3))

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.drc_+3A_x">x</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="print.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="print.drc_+3A_digits">digits</code></td>
<td>
<p>an integer giving the number of digits of the parameter coefficients. Default is 3.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~conc, data = ryegrass, fct = LL.4())

## Displaying the model fit
print(ryegrass.m1)
ryegrass.m1  # gives the same output as the previous line

</code></pre>

<hr>
<h2 id='print.summary.drc'>Printing summary of non-linear model fits</h2><span id='topic+print.summary.drc'></span>

<h3>Description</h3>

<p>This method produces formatted output of the summary statistics: parameter estimates, estimated standard errors, 
z-test statistics and corresponding p-values.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'summary.drc'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.drc_+3A_x">x</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="print.summary.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The object (argument <code>x</code>) is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.m1 &lt;- drm(rootl~conc, data=ryegrass, fct= LL.4())

summary(ryegrass.m1)  

</code></pre>

<hr>
<h2 id='rdrm'>Simulating a dose-response curve</h2><span id='topic+rdrm'></span>

<h3>Description</h3>

<p>Simulation of a dose-response curve with user-specified dose values and error distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  rdrm(nosim, fct, mpar, xerror, xpar = 1, yerror = "rnorm", ypar = c(0, 1), 
  onlyY = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdrm_+3A_nosim">nosim</code></td>
<td>
<p>numeric. The number of simulated curves to be returned.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_fct">fct</code></td>
<td>
<p>list. Any built-in function in the package <em>drc</em> or a list with similar components.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_mpar">mpar</code></td>
<td>
<p>numeric. The model parameters to be supplied to <code>fct</code>.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_xerror">xerror</code></td>
<td>
<p>numeric or character. The distribution for the dose values.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_xpar">xpar</code></td>
<td>
<p>numeric vector supplying the parameter values defining the distribution for the dose values. 
If <code>xerror</code> is a distribution then remember that the number of dose values also is part of this argument 
(the first argument).</p>
</td></tr>
<tr><td><code id="rdrm_+3A_yerror">yerror</code></td>
<td>
<p>numeric or character. The error distribution for the response values.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_ypar">ypar</code></td>
<td>
<p>numeric vector supplying the parameter values defining the error distribution for the 
response values.</p>
</td></tr>
<tr><td><code id="rdrm_+3A_onlyy">onlyY</code></td>
<td>
<p>logical. If TRUE then only the response values are returned (useful in simulations). 
Otherwise both dose values and response values (and for binomial data also the weights) are returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distribution for the dose values can either be a fixed set of dose values (a numeric vector)
used repeatedly for creating all curves or be a distribution specified as a character string resulting in
varying dose values from curve to curve.
</p>
<p>The error distribution for the response values can be any continuous distribution
like <code><a href="stats.html#topic+rnorm">rnorm</a></code> or <code><a href="stats.html#topic+rgamma">rgamma</a></code>. Alternatively it can be the binomial distribution 
<code><a href="stats.html#topic+rbinom">rbinom</a></code>.
</p>


<h3>Value</h3>

<p>A list with up to 3 components (depending on the value of the <code>onlyY</code> argument).
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p> ~put references to the literature/web site here ~ </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simulating normally distributed dose-response data

## Model fit to simulate from
ryegrass.m1 &lt;- drm(rootl~conc, data = ryegrass, fct = LL.4())

## 10 random dose-response curves based on the model fit
sim10a &lt;- rdrm(10, LL.4(), coef(ryegrass.m1), xerror = ryegrass$conc)
sim10a


## Simulating binomial dose-response data

## Model fit to simulate from
deguelin.m1 &lt;- drm(r/n~dose, weights=n, data=deguelin, fct=LL.2(), type="binomial")

## 10 random dose-response curves
sim10b &lt;- rdrm(10, LL.2(), coef(deguelin.m1), deguelin$dose, yerror="rbinom", ypar=deguelin$n)
sim10b

</code></pre>

<hr>
<h2 id='residuals.drc'>Extracting residuals from the fitted dose-response model</h2><span id='topic+residuals.drc'></span>

<h3>Description</h3>

<p>'residuals' extracts different types of residuals from an object of class 'drc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
residuals(object, typeRes = c("working", "standardised", "studentised"), 
  trScale = TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="residuals.drc_+3A_typeres">typeRes</code></td>
<td>
<p>character string specifying the type of residual to be returned: raw/working residuals, 
residuals standardised using the estimated residual standard error,
or studentised residuals based on the H matrix of partial derivatives of the model function.</p>
</td></tr>
<tr><td><code id="residuals.drc_+3A_trscale">trScale</code></td>
<td>
<p>logical value indicating whether or not to return residuals on the transformed scale (in case a Box-Cox transformation was applied).</p>
</td></tr>
<tr><td><code id="residuals.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standardised residuals are the raw residuals divided by a scale estimate (if available). 
</p>
<p>Studentised residuals are obtained by dividing by a scale estimate and in
addition a correction factor (square root of 1 minus h with h is a diagonal element in the hat matrix). 
</p>


<h3>Value</h3>

<p>The raw (also called working) residuals or some kind of scaled residuals extracted from 'object'. 
</p>


<h3>Note</h3>

<p>The 'standardised' residuals are available for least squares estimation
with or without Box-Cox transformation or variance as a power of the
mean.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~conc, data = ryegrass, fct = LL.4())

## Displaying the residual plot (raw residuals)
plot(fitted(ryegrass.m1), residuals(ryegrass.m1))

## Using the standardised residuals
plot(fitted(ryegrass.m1), residuals(ryegrass.m1, typeRes = "standard"))

## Overlayering the studentised residuals ... not much of a difference
points(fitted(ryegrass.m1), residuals(ryegrass.m1, typeRes = "student"), col = 2)

</code></pre>

<hr>
<h2 id='RScompetition'>Competition between two biotypes</h2><span id='topic+RScompetition'></span>

<h3>Description</h3>

<p>To assess the competitive ability between two biotypes of <em>Lolium rigidum</em>, one resistant to glyphosate
and the other a sensitive wild type, the density of resistant and sensitive biotypes was counted after
germination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RScompetition)</code></pre>


<h3>Format</h3>

<p>A data frame with 49 observations on the following 3 variables.
</p>

<dl>
<dt><code>z</code></dt><dd><p>a numeric vector with densities of the resistant biotype (plants/m2)</p>
</dd>
<dt><code>x</code></dt><dd><p>a numeric vector with densities of the sensitive biotype (plants/m2)</p>
</dd>
<dt><code>biomass</code></dt><dd><p>a numeric vector of biomass weight (g/plant)</p>
</dd>
</dl>



<h3>Details</h3>

<p>A hyperbolic model (Jensen, 1993) is describing the data reasonably well.
</p>


<h3>Source</h3>

<p>The dataset is from Pedersen et al (2007).
</p>


<h3>References</h3>

<p>Jensen, J. E. (1993) Fitness of herbicide-resistant weed biotypes described by competition models, 
<em>Proceedings of the 8th EWRS Symposium, 14-16 June, Braunschweig, Germany</em>, 
<b>1</b>, 25&ndash;32.
</p>
<p>Pedersen, B. P. and Neve, P. and Andreasen, C. and Powles, S. (2007) Ecological fitness of a glyphosate 
resistant <em>Lolium rigidum</em> population: Growth and seed production along a competition gradient,
<em>Basic and Applied Ecology</em>, <b>8</b>, 258&ndash;268.
</p>

<hr>
<h2 id='ryegrass'>Effect of ferulic acid on growth of ryegrass</h2><span id='topic+ryegrass'></span>

<h3>Description</h3>

<p>A single dose-response curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ryegrass)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 2 variables.
</p>

<dl>
<dt>rootl</dt><dd><p>a numeric vector of root lengths</p>
</dd>  
<dt>conc</dt><dd><p>a numeric vector of concentrations of ferulic acid</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are part of a study to investigate the joint action
of phenolic acids on root growth inhibition of perennial ryegrass (<em>Lolium perenne L</em>).
</p>
<p><code>conc</code> is the concentration of ferulic acid is in mM, and <code>rootl</code> is the root length 
of perennial ryegrass measured in cm. 
</p>


<h3>Source</h3>

<p>Inderjit and J. C. Streibig, and M. Olofsdotter (2002) Joint action of
phenolic acid mixtures and its significance in allelopathy
research, <em>Physiologia Plantarum</em>, <b>114</b>, 422&ndash;428, 2002.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Displaying the data set
ryegrass

## Fitting a four-parameter Weibull model (type 2)
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W2.4())

## Displaying a summary of the model fit
summary(ryegrass.m1)

## Plotting the fitted curve together with the original data
plot(ryegrass.m1)

## Fitting a four-parameter Weibull model (type 1)
ryegrass.m2 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.4())
plot(ryegrass.m2)

## Fitting a four-parameter log-logistic model
## with user-defined parameter names
ryegrass.m3 &lt;- drm(rootl ~ conc, data = ryegrass, 
fct = LL.4(names = c("Slope", "Lower Limit", "Upper Limit", "ED50")))
summary(ryegrass.m3)

## Comparing log-logistic and Weibull models
## (Figure 2 in Ritz (2009))
ryegrass.m0 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.4())
ryegrass.m2 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W2.4())

plot(ryegrass.m0, broken=TRUE, xlab="Dose (mM)", ylab="Root length (cm)", lwd=2, 
cex=1.2, cex.axis=1.2, cex.lab=1.2)
plot(ryegrass.m1, add=TRUE, broken=TRUE, lty=2, lwd=2)
plot(ryegrass.m2, add=TRUE, broken=TRUE, lty=3, lwd=2)

arrows(3, 7.5, 1.4, 7.5, 0.15, lwd=2)
text(3,7.5, "Weibull-2", pos=4, cex=1.2)

arrows(2.5, 0.9, 5.7, 0.9, 0.15, lwd=2)
text(3,0.9, "Weibull-1", pos=2, cex=1.2)


</code></pre>

<hr>
<h2 id='S.alba'>Potency of two herbicides</h2><span id='topic+S.alba'></span>

<h3>Description</h3>

<p>Data are from an experiment, comparing the potency of the two herbicides glyphosate and bentazone in
white mustard <em>Sinapis alba</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(S.alba)</code></pre>


<h3>Format</h3>

<p>A data frame with 68 observations on the following 3 variables.
</p>

<dl>
<dt><code>Dose</code></dt><dd><p>a numeric vector containing the dose in g/ha.</p>
</dd>
<dt><code>Herbicide</code></dt><dd><p>a factor with levels <code>Bentazone</code> <code>Glyphosate</code> (the two herbicides applied).</p>
</dd>
<dt><code>DryMatter</code></dt><dd><p>a numeric vector containing the response (dry matter in g/pot).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The lower and upper limits for the two herbicides can be assumed identical, whereas slopes and ED50 values 
are different (in the log-logistic model).
</p>


<h3>Source</h3>

<p>Christensen, M. G. and Teicher, H. B., and Streibig, J. C. (2003) Linking fluorescence 
induction curve and biomass in herbicide screening, <em>Pest Management Science</em>,
<b>59</b>,  1303&ndash;1310.
</p>


<h3>See Also</h3>

<p>See the examples sections for <code><a href="#topic+drm">drm</a></code> and <code><a href="#topic+EDcomp">EDcomp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a log-logistic model with
##  common lower and upper limits
S.alba.LL.4.1 &lt;- drm(DryMatter~Dose, Herbicide, data=S.alba, fct = LL.4(),
pmodels=data.frame(Herbicide,1,1,Herbicide)) 
summary(S.alba.LL.4.1)

## Applying the optimal transform-both-sides Box-Cox transformation
## (using the initial model fit)  
S.alba.LL.4.2 &lt;- boxcox(S.alba.LL.4.1, method = "anova") 
summary(S.alba.LL.4.2)

## Plotting fitted regression curves together with the data
plot(S.alba.LL.4.2)

</code></pre>

<hr>
<h2 id='S.capricornutum'>Effect of cadmium on growth of green alga</h2><span id='topic+S.capricornutum'></span>

<h3>Description</h3>

<p>Green alga (<em>Selenastrum capricornutum</em>) was exposed to cadmium chloride concentrations
ranging from 5 to 80 micro g/L in geometric progression in 4-day population growth test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(S.capricornutum)</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 2 variables.
</p>

<dl>
<dt><code>conc</code></dt><dd><p>a numeric vector of cadmium chloride concentrations (micro g/L)</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector of algal counts (10000 x cells /ml)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are analysed in Bruce and Versteeg (1992) using a log-normal 
dose-response model (using the logarithm with base 10).
</p>


<h3>Source</h3>

<p>Bruce, R. D. and Versteeg, D. J. (1992) A statistical procedure for modeling continuous toxicity data,
<em>Environ. Toxicol. Chem.</em>, <b>11</b>, 1485&ndash;1494.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting 3-parameter log-normal model
s.cap.m1 &lt;- drm(count ~ conc, data = S.capricornutum, fct = LN.3())

## Residual plot
plot(fitted(s.cap.m1), residuals(s.cap.m1))

## Fitting model with transform-both-sides approach
s.cap.m2 &lt;- boxcox(s.cap.m1, method = "anova")
summary(s.cap.m2)

## Residual plot after transformation (looks better)
plot(fitted(s.cap.m2), residuals(s.cap.m2))

## Calculating ED values on log scale
ED(s.cap.m2, c(10, 20, 50), interval="delta")

## Fitting model with ED50 as parameter
## (for comparison)
s.cap.m3 &lt;- drm(count ~ conc, data = S.capricornutum, fct = LN.3(loge=TRUE))
s.cap.m4 &lt;- boxcox(s.cap.m3, method = "anova")
summary(s.cap.m4)
ED(s.cap.m4, c(10, 20, 50), interval = "fls")

</code></pre>

<hr>
<h2 id='searchdrc'>Searching through a range of initial parameter values to obtain convergence</h2><span id='topic+searchdrc'></span>

<h3>Description</h3>

<p>'searchdrc' provides a facility for searching through a range of parameter values (one-dimensional)
in order to obtain convergence of the estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchdrc(object, which, range, len = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="searchdrc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'. The object can be from a model that could not fitted.</p>
</td></tr>
<tr><td><code id="searchdrc_+3A_which">which</code></td>
<td>
<p>a character string containing the parameter name</p>
</td></tr>
<tr><td><code id="searchdrc_+3A_range">range</code></td>
<td>
<p>a numeric vector of length 2 specifying the interval endpoints for the range.</p>
</td></tr>
<tr><td><code id="searchdrc_+3A_len">len</code></td>
<td>
<p>numeric. The number of points in the interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function goes through the range with increments such that in total at most <code>len</code> sets of parameter values
are used as initial values for the estimation procedure. You would need to identify the parameter which is most likely to
cause problems for the estimation procedure.
</p>


<h3>Value</h3>

<p>An object of class 'drc'. 
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## No example yet

</code></pre>

<hr>
<h2 id='secalonic'>Root length measurements</h2><span id='topic+secalonic'></span>

<h3>Description</h3>

<p>Data stem from an experiment assessing the inhibitory effect of secalonic acids on plant growth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(secalonic)</code></pre>


<h3>Format</h3>

<p>A data frame with 7 observations on the following 2 variables:
</p>

<dl>
<dt><code>dose</code></dt><dd><p>a numeric vector containing dose values (mM)</p>
</dd>
<dt><code>rootl</code></dt><dd><p>a numeric vector containing root lengths (cm)</p>
</dd>
</dl>



<h3>Details</h3>

<p>For each dose the root length is an average three measurements.
</p>


<h3>Source</h3>

<p>Gong, X. and Zeng, R. and Luo, S. and Yong, C. and Zheng, Q. (2004) Two new 
secalonic acids from <em>Aspergillus Japonicus</em> and their allelopathic effects on higher plants,
<em>Proceedings of International Symposium on Allelopathy Research and Application, 27-29 April, 
Shanshui, Guangdong, China (Editors: R. Zeng and S. Luo)</em>, 209&ndash;217.
</p>
<p>Ritz, C (2009)
Towards a unified approach to dose-response modeling in ecotoxicology
<em>To appear in Environ Toxicol Chem</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
secalonic.m1 &lt;- drm(rootl ~ dose, data = secalonic, fct = LL.4())
summary(secalonic.m1)

## Fitting a three-parameter log-logistic model
##  lower limit fixed at 0
secalonic.m2 &lt;- drm(rootl ~ dose, data = secalonic, fct = LL.3())
summary(secalonic.m1)

## Comparing logistic and log-logistic models
## (Figure 1 in Ritz (2009))
secalonic.LL4 &lt;- drm(rootl ~ dose, data = secalonic, fct = LL.4())
secalonic.L4 &lt;- drm(rootl ~ dose, data = secalonic, fct = L.4())

plot(secalonic.LL4, broken=TRUE, ylim=c(0,7), xlab="Dose (mM)", ylab="Root length (cm)", 
cex=1.2, cex.axis=1.2, cex.lab=1.2, lwd=2)

plot(secalonic.L4, broken=TRUE, ylim=c(0,7), add=TRUE, type="none", lty=2, lwd=2)

abline(h=coef(secalonic.L4)[3], lty=3, lwd=2)

</code></pre>

<hr>
<h2 id='selenium'>
Data from toxicology experiments with selenium
</h2><span id='topic+selenium'></span>

<h3>Description</h3>

<p>Comparison of toxicity of four types of selenium by means of dose-response analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(selenium)</code></pre>


<h3>Format</h3>

<p>A data frame with 25 observations on the following 4 variables.
</p>

<dl>
<dt><code>type</code></dt><dd><p>a numeric vector indicating the form of selenium applied</p>
</dd>
<dt><code>conc</code></dt><dd><p>a numeric vector of (total) selenium concentrations</p>
</dd>
<dt><code>total</code></dt><dd><p>a numeric vector containing the total number of flies</p>
</dd>
<dt><code>dead</code></dt><dd><p>a numeric vector containing the number of dead flies</p>
</dd>
</dl>



<h3>Details</h3>

<p>The experiment is described in more details by Jeske et al. (2009).
</p>


<h3>Source</h3>

<p>Jeske, D. R., Xu, H. K., Blessinger, T., Jensen, P. and Trumble, J. (2009) Testing for the Equality of EC50 Values in the Presence of 
Unequal Slopes With Application to Toxicity of Selenium Types, <em>Journal of Agricultural, Biological, and Environmental Statistics</em>,
<b>14</b>, 469&ndash;483</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Analysis similar to what is proposed in Jeske et al (2009)
##  but simply using existing functionality in "drc"

## Fitting the two-parameter log-logistic model with unequal ED50 and slope
sel.m1 &lt;- drm(dead/total~conc, type, weights=total, data=selenium, fct=LL.2(), 
type="binomial")
#sel.m1b &lt;- drm(dead/total~conc, type, weights=total, data=selenium, fct=LN.2(), 
# type="binomial", start=c(1,1,1,1,50,50,50,50))
plot(sel.m1, ylim = c(0, 1.3))
summary(sel.m1)

## Testing for equality of slopes
sel.m2 &lt;- drm(dead/total~conc, type, weights=total, data=selenium, fct=LL.2(), 
type="binomial", pmodels=list(~1, ~factor(type)-1))
sel.m2b &lt;- drm(dead/total~conc, type, weights=total, data=selenium, fct=LN.2(), 
type="binomial", pmodels=list(~1, ~factor(type)-1))
plot(sel.m2, ylim = c(0, 1.3))
summary(sel.m2)
anova(sel.m2, sel.m1)  # 48.654
#anova(sel.m2b, sel.m1b)
# close to the value 48.46 reported in the paper

## Testing for equality of ED50
sel.m3&lt;-drm(dead/total~conc, type, weights=total, data=selenium, fct=LL.2(), 
type="binomial", pmodels=list(~factor(type)-1, ~1))
#sel.m3b&lt;-drm(dead/total~conc, type, weights=total, data=selenium, fct=LN.2(), 
# type="binomial", pmodels=list(~factor(type)-1, ~1), start=c(1,1,1,1,50))
plot(sel.m3, ylim = c(0, 1.3))
summary(sel.m3)

anova(sel.m3, sel.m1)  # 123.56
#anova(sel.m3b, sel.m1b) 
# not too far from the value 138.45 reported in the paper
# (note that the estimation procedure is not exactly the same)
# (and we use the log-logistic model instead of the log-normal model)

</code></pre>

<hr>
<h2 id='simDR'>Simulating ED values under various scenarios</h2><span id='topic+simDR'></span>

<h3>Description</h3>

<p>Simulating ED values for a given model and given dose values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  simDR(mpar, sigma, fct, noSim = 1000, conc, edVec = c(10, 50), seedVal = 20070723)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDR_+3A_mpar">mpar</code></td>
<td>
<p>numeric vector of model parameters</p>
</td></tr>
<tr><td><code id="simDR_+3A_sigma">sigma</code></td>
<td>
<p>numeric specifying the residual standard deviation</p>
</td></tr>
<tr><td><code id="simDR_+3A_fct">fct</code></td>
<td>
<p>list supplying the chosen mean function</p>
</td></tr>
<tr><td><code id="simDR_+3A_conc">conc</code></td>
<td>
<p>numeric vector of concentration/dose values</p>
</td></tr>
<tr><td><code id="simDR_+3A_edvec">edVec</code></td>
<td>
<p>numeric vector of ED values to estimate in each simulation</p>
</td></tr>
<tr><td><code id="simDR_+3A_nosim">noSim</code></td>
<td>
<p>numeric giving the number of simulations</p>
</td></tr>
<tr><td><code id="simDR_+3A_seedval">seedVal</code></td>
<td>
<p>numeric giving the seed used to initiate the random number generator</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>mpar</code> and <code>sigma</code> are typically obtained from a previous model fit.
</p>
<p>Only dose-response models assuming normally distributed errors can be used.
</p>


<h3>Value</h3>

<p>A list of matrices with as many components as there are chosen ED values. The entries in the matrices are
empirical standard deviations of the estimated ED values. Row-wise from top to bottom more and more
concentration/dose values are included in the simulations; top row starting with 5 concentrations. The
number of replicates increases column by column from left to right. 
</p>
<p>The list is returned invisbly as the matrices also are displayed.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ryegrass.m1 &lt;- drm(ryegrass, fct=LL.4())

simDR(coef(ryegrass.m1), sqrt(summary(ryegrass.m1)$resVar), LL.4(), 2, 
c(1.88, 3.75, 7.50, 0.94, 15, 0.47, 30, 0.23, 60), seedVal = 200710291)

</code></pre>

<hr>
<h2 id='spinach'>Inhibition of photosynthesis</h2><span id='topic+spinach'></span>

<h3>Description</h3>

<p>Data from an experiment investigating the inhibition of photosynthesis in response to two synthetic 
photosystem II inhibitors, the herbicides diuron and bentazon.
More specifically, the effect of oxygen consumption of thylakoid membranes (chloroplasts) from spinach
was measured after incubation with the synthetic inhibitors in 5 assays, resulting in 5 dose-response curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spinach)</code></pre>


<h3>Format</h3>

<p>A data frame with 105 observations on the following four variables:
</p>

<dl>
<dt>CURVE</dt><dd><p>a numeric vector specifying the assay or curve (a total of 5 independent assays where used in this experiment).</p>
</dd>
<dt>HERBICIDE</dt><dd><p>a character vector specifying the herbicide applied: bentazon or diuron.</p>
</dd>
<dt>DOSE</dt><dd><p>a numeric vector giving the herbicide concentration in muMol.</p>
</dd>
<dt>SLOPE</dt><dd><p>a numeric vector with the measured response: oxygen consumption of thylakoid membranes.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The experiment is described in more details by Streibig (1998).
</p>


<h3>Source</h3>

<p>Streibig, J. C. (1998) Joint action of natural and synthetic photosystem II inhibitors, <em>Pesticide Science</em>, <b>55</b>, 137&ndash;146.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Displaying the first rows in the dataset
head(spinach)  # displaying first 6 rows in the data set

</code></pre>

<hr>
<h2 id='summary.drc'>Summarising non-linear model fits</h2><span id='topic+summary.drc'></span>

<h3>Description</h3>

<p>'summary' compiles a comprehensive summary for objects of class 'drc'. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
summary(object, od = FALSE, pool = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="summary.drc_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used.</p>
</td></tr>  
<tr><td><code id="summary.drc_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr> 
<tr><td><code id="summary.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summary statistics that includes parameter estimates and estimated standard errors.
</p>


<h3>Note</h3>

<p>Examples on usage are for instance found in the help pages of <code><a href="#topic+ryegrass">ryegrass</a></code> and <code><a href="#topic+secalonic">secalonic</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>

<hr>
<h2 id='terbuthylazin'>The effect of terbuthylazin on growth rate</h2><span id='topic+terbuthylazin'></span>

<h3>Description</h3>

<p>Test on the effect of terbuthylazin on  <em>Lemna minor</em>, performed on an aseptic
culture according to the OECD-guidelines.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(terbuthylazin)</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 2 variables.
</p>

<dl>
<dt>dose</dt><dd><p>a numeric vector of dose values.</p>
</dd>
<dt>rgr</dt><dd><p>a numeric vector of relative growth rates.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Dose is </p>
<p style="text-align: center;"><code class="reqn">\mu l^{-1}</code>
</p>
<p> and rgr is the relative growth rate of <em>Lemna</em>.  
</p>


<h3>Source</h3>

<p>Cedergreen N. (2004). Unpublished bioassay data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## displaying first 6 rows of the data set
head(terbuthylazin)

## Fitting log-logistic model
terbuthylazin.m1 &lt;- drm(rgr~dose, data = terbuthylazin, fct = LL.4())
summary(terbuthylazin.m1)

## Fitting log-logistic model
##  with Box-Cox transformation
terbuthylazin.m2 &lt;- boxcox(terbuthylazin.m1, method = "anova")
summary(terbuthylazin.m2)

</code></pre>

<hr>
<h2 id='twophase'>
Two-phase dose-response model
</h2><span id='topic+twophase'></span>

<h3>Description</h3>

<p>The two-phase dose-response model is a combination of log-logistic models that should be useful for describing
more complex dose-response patterns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  twophase(fixed = c(NA, NA, NA, NA, NA, NA, NA), 
  names = c("b1", "c1", "d1", "e1", "b2", "d2", "e2"), fctName, fctText)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twophase_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector specifying which parameters are fixed and at what value they are fixed. 
NAs are used for parameters that are not fixed.</p>
</td></tr>
<tr><td><code id="twophase_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;).
The default is reasonable (see under 'Usage').</p>
</td></tr>
<tr><td><code id="twophase_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="twophase_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Following Groot <em>et al</em> (1996) the two-phase model function is defined as follows
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + \frac{d1-c}{1+\exp(b1(\log(x)-\log(e1)))} + \frac{d2}{1+\exp(b2(\log(x)-\log(e2)))}</code>
</p>

<p>For each of the two phases, the parameters have the same interpretation as in the ordinary log-logistic
model.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function
and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz
</p>


<h3>References</h3>

<p>Groot, J. C. J., Cone, J. W., Williams, B. A., Debersaques, F. M. A., Lantinga, E. A. (1996)
Multiphasic analysis of gas production kinetics for in vitro fermentation of ruminant feeds,
<em>Animal Feed Science Technology</em>, <b>64</b>, 77&ndash;89.  
</p>


<h3>See Also</h3>

<p>The basic component in the two-phase model is the log-logistic model
<code><a href="#topic+llogistic">llogistic</a></code>.
</p>

<hr>
<h2 id='update.drc'>Updating and re-fitting a model</h2><span id='topic+update.drc'></span>

<h3>Description</h3>

<p>'update' updates and re-fits a model on the basis of an object of class 'drc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drc'
update(object, ..., evaluate = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="update.drc_+3A_...">...</code></td>
<td>
<p>arguments to alter in object.</p>
</td></tr>
<tr><td><code id="update.drc_+3A_evaluate">evaluate</code></td>
<td>
<p>logical. If TRUE model is re-fit; otherwise an unevaluated call is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'drc'.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter Weibull model
model1 &lt;- drm(ryegrass, fct = W1.4())

## Updating 'model1' by fitting a three-parameter Weibull model instead
model2 &lt;- update(model1, fct = W1.3())
anova(model2, model1)


</code></pre>

<hr>
<h2 id='ursa'>
Model function for the universal response surface approach (URSA) for the quantitative assessment of drug interaction
</h2><span id='topic+ursa'></span><span id='topic+genursa'></span><span id='topic+actimL'></span><span id='topic+genLoewe'></span><span id='topic+genLoewe2'></span><span id='topic+iceLoewe.1'></span><span id='topic+iceLoewe2.1'></span><span id='topic+genBliss'></span><span id='topic+genBliss2'></span>

<h3>Description</h3>

<p>URSA provides a parametric approach for modelling the joint action of several agents. The model allows quantification of synergistic effects through a single parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ursa(fixed = rep(NA, 7), names = c("b1", "b2", "c", "d", "e1", "e1", "f"), 
  ssfct = NULL)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ursa_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="ursa_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="ursa_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used (optional).</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The model function is defined implicitly through an appropriate equation. More details are provided by Greco et al (1990, 1995).
</p>


<h3>Value</h3>

<p>A list containing the nonlinear function, the self starter function, and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz after an idea by Hugo Ceulemans.
</p>


<h3>References</h3>

<p>Greco, W. R. and Park H. S. and Rustum, Y. M. (1990) Application of a New Approach for the Quantitation of Drug Synergism
to the Combination of cis-Diamminedichloroplatinum and 1-beta-D-Arabinofuranosylcytosine, <em>Cancer Research</em>, <b>50</b>, 5318&ndash;5327.
</p>
<p>Greco, W. R. Bravo, G. and Parsons, J. C. (1995) The Search for Synergy: A Critical Review from a Response Surface Perspective,
<em>Pharmacological Reviews</em>, <b>47</b>, Issue 2, 331&ndash;385.
</p>


<h3>See Also</h3>

<p>Other models for fitting mixture data are the Hewlett and Voelund models <code><a href="#topic+mixture">mixture</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Here is the complete statistical analysis of the data 
##  from Greco et al. (1995) by means of the URSA model
if (FALSE)
{
d1 &lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 2, 5, 10, 20, 50, 2, 2, 2, 
2, 2, 5, 5, 5, 5, 5, 10, 10, 10, 10, 10, 20, 20, 20, 20, 
20, 50, 50, 50, 50, 50)

d2 &lt;- c(0, 0, 0, 0.2, 0.5, 1, 2, 5, 0, 0, 0, 0, 0, 0.2, 
0.5, 1, 2, 5, 0.2, 0.5,  1, 2, 5, 0.2, 0.5, 1, 2, 5, 0.2, 
0.5, 1, 2, 5, 0.2, 0.5, 1, 2, 5)

effect &lt;- c(106.00, 99.20, 115.00, 79.20, 70.10, 49.00, 
21.00, 3.83, 74.20, 71.50,48.10, 30.90, 16.30, 76.30, 
48.80, 44.50, 15.50, 3.21, 56.70, 47.50, 26.80, 16.90, 
3.25, 46.70, 35.60, 21.50, 11.10, 2.94, 24.80, 21.60, 
17.30, 7.78, 1.84, 13.60, 11.10, 6.43, 3.34, 0.89)

greco &lt;- data.frame(d1, d2, effect)

greco.m1 &lt;- drm(effect ~ d1 + d2, data = greco, fct = ursa(fixed = c(NA, NA, 0, NA, NA, NA, NA)))

plot(fitted(greco.m1), residuals(greco.m1)) # wedge-shaped

summary(greco.m1)
 
## Transform-both-sides approach using a logarithm transformation
greco.m2 &lt;- drm(effect ~ d1 + d2, data = greco, fct = ursa(fixed = c(NA, NA, 0, NA, NA, NA, NA)), 
bcVal = 0, control = drmc(relTol = 1e-12))

plot(fitted(greco.m2), residuals(greco.m2))  # looks okay

summary(greco.m2)
# close to the estimates reported by Greco et al. (1995)
}

</code></pre>

<hr>
<h2 id='vcov.drc'>Calculating variance-covariance matrix for objects of class 'drc'</h2><span id='topic+vcov.drc'></span>

<h3>Description</h3>

<p>'vcov' returns the estimated variance-covariance matrix for the parameters in the non-linear function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drc'
vcov(object, ..., corr = FALSE, od = FALSE, pool = TRUE, unscaled = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.drc_+3A_object">object</code></td>
<td>
<p>an object of class 'drc'.</p>
</td></tr>
<tr><td><code id="vcov.drc_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="vcov.drc_+3A_corr">corr</code></td>
<td>
<p>logical. If TRUE a correlation matrix is returned.</p>
</td></tr>
<tr><td><code id="vcov.drc_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used. This argument only makes a difference for
binomial data.</p>
</td></tr>
<tr><td><code id="vcov.drc_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with
independently fitted curves as specified in <code><a href="#topic+drm">drm</a></code>.</p>
</td></tr> 
<tr><td><code id="vcov.drc_+3A_unscaled">unscaled</code></td>
<td>
<p>logical. If TRUE the unscaled variance-covariance is returned. This argument only makes a difference
for continuous data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of estimated variances and covariances.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter log-logistic model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = LL.4())
vcov(ryegrass.m1)
vcov(ryegrass.m1, corr = TRUE)

</code></pre>

<hr>
<h2 id='vinclozolin'>Vinclozolin from AR in vitro assay</h2><span id='topic+vinclozolin'></span>

<h3>Description</h3>

<p>Dose-response experiment with vinclozolin in an AR reporter gene assay
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vinclozolin)</code></pre>


<h3>Format</h3>

<p>A data frame with 53 observations on the following 3 variables.
</p>

<dl>
<dt><code>exper</code></dt><dd><p>a factor with levels <code>10509</code> <code>10821</code> <code>10828</code> <code>10904</code> <code>11023</code> <code>11106</code></p>
</dd>
<dt><code>conc</code></dt><dd><p>a numeric vector of concentrations of vinclozolin</p>
</dd>
<dt><code>effect</code></dt><dd><p>a numeric vector of luminescense effects</p>
</dd>
</dl>



<h3>Details</h3>

<p>The basic dose-response experiment was repeated 6 times on different days. Chinese Hamster Ovary cells 
were exposed to various concentrations of vinclozolin for 22 hours and the resulting luminescense effects
were recorded.
</p>
<p>Data are part of mixture experiment reported in Nellemann <em>et al</em> (2003).  
</p>


<h3>Source</h3>

<p>Nellemann C., Dalgaard M., Lam H.R. and Vinggaard A.M. (2003)
The combined effects of vinclozolin and procymidone do not deviate from expected additivity <em>in vitro</em> 
and <em>in vivo</em>, <em>Toxicological Sciences</em>, <b>71</b>, 251&ndash;262.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

vinclozolin.m1 &lt;- drm(effect~conc, exper, data=vinclozolin, fct = LL.3())
plot(vinclozolin.m1, xlim=c(0,50), ylim=c(0,2800), conLevel=1e-4)

vinclozolin.m2 &lt;- drm(effect~conc, data=vinclozolin, fct = LL.3())
plot(vinclozolin.m2, xlim=c(0,50), conLevel=1e-4, add=TRUE, type="none", col="red")

## Are the ED50 values indetical across experiments?
vinclozolin.m3 &lt;- update(vinclozolin.m1, pmodels=data.frame(exper, exper, 1))
anova(vinclozolin.m3, vinclozolin.m1)  # No!

</code></pre>

<hr>
<h2 id='W1.2'>The two-parameter Weibull functions</h2><span id='topic+W1.2'></span><span id='topic+w2'></span><span id='topic+W2.2'></span>

<h3>Description</h3>

<p>'W1.2' is the two-parameter Weibull function where the lower limit is fixed at 0 and the upper limit
is fixed at 1, mostly suitable for binomial/quantal responses.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  W1.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
  
  W2.2(upper = 1, fixed = c(NA, NA), names = c("b", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="W1.2_+3A_upper">upper</code></td>
<td>
<p>numeric value. The fixed, upper limit in the model. Default is 1.</p>
</td></tr>
<tr><td><code id="W1.2_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="W1.2_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="W1.2_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The two-parameter Weibull model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = \exp(-\exp(b(\log(x)-e))).</code>
</p>

<p>The function is asymmetric about the inflection point, that is the parameter <code class="reqn">\exp(e)</code>.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+weibull1">weibull1</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>Related functions are <code><a href="#topic+W1.3">W1.3</a></code>, <code><a href="#topic+W1.4">W1.4</a></code>, <code><a href="#topic+weibull1">weibull1</a></code> and <code><a href="#topic+weibull2">weibull2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a two-parameter Weibull model
earthworms.m1 &lt;- drm(number/total~dose, weights = total,
data = earthworms, fct = W1.2(), type = "binomial")

summary(earthworms.m1)

</code></pre>

<hr>
<h2 id='W1.3'>The three-parameter Weibull functions</h2><span id='topic+W1.3'></span><span id='topic+w3'></span><span id='topic+W2.3'></span><span id='topic+W2x.3'></span><span id='topic+W1.3u'></span><span id='topic+W2.3u'></span>

<h3>Description</h3>

<p>'W1.3' and <code>W2.3</code> provide the three-parameter Weibull function, self starter function and names of the parameters.
</p>
<p>'W1.3u' and 'W2.3u' provide three-parameter Weibull function where the upper limit is equal to 1, mainly
for use with binomial/quantal response.     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  W1.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  W2.3(fixed = c(NA, NA, NA), names = c("b", "d", "e"), ...)
  
  W2x.3(fixed = c(NA, NA, NA), names = c("d", "e", "t0"), ...)
  
  W1.3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)  
  
  W2.3u(upper = 1, fixed = c(NA, NA, NA), names = c("b", "c", "e"), ...)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="W1.3_+3A_upper">upper</code></td>
<td>
<p>numeric value. The fixed, upper limit in the model. Default is 1.</p>
</td></tr>
<tr><td><code id="W1.3_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="W1.3_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="W1.3_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>The three-parameter Weibull model is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + (d-0)\exp(-\exp(b(\log(x)-e))).</code>
</p>

<p>The function is asymmetric about the inflection point, that is the parameter <code class="reqn">\exp(e)</code>.
</p>
<p>The three-parameter Weibull model with upper limit 1 is given by the expression
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = 0 + (1-0)\exp(-\exp(b(\log(x)-e))).</code>
</p>



<h3>Value</h3>

<p>See <code><a href="#topic+weibull1">weibull1</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the function <code><a href="#topic+drm">drm</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>See Also</h3>

<p>Related functions are <code><a href="#topic+W1.4">W1.4</a></code> and <code><a href="#topic+weibull1">weibull1</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a three-parameter Weibull model
ryegrass.m1 &lt;- drm(rootl ~ conc, data = ryegrass, fct = W1.3())
ryegrass.m1

</code></pre>

<hr>
<h2 id='W1.4'>The four-parameter Weibull functions</h2><span id='topic+W1.4'></span><span id='topic+w4'></span><span id='topic+W2.4'></span><span id='topic+W2x.4'></span>

<h3>Description</h3>

<p>'W1.4' and 'W2.4' provide the four-parameter Weibull functions, self starter function and 
names of the parameters.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  W1.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
  
  W2.4(fixed = c(NA, NA, NA, NA), names = c("b", "c", "d", "e"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="W1.4_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="W1.4_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.</p>
</td></tr>
<tr><td><code id="W1.4_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed from the convenience functions.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>The equations for the mean functions are given at <code><a href="#topic+weibull1">weibull1</a></code>.
</p>


<h3>Value</h3>

<p>See <code><a href="#topic+weibull1">weibull1</a></code>.
</p>


<h3>Note</h3>

<p>This function is for use with the model fitting function <code><a href="#topic+drm">drm</a></code>.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Seber, G. A. F. and Wild, C. J (1989) <em>Nonlinear Regression</em>, New York: Wiley \&amp; Sons (pp. 330&ndash;331).
</p>
<p>Ritz, C (2009)
Towards a unified approach to dose-response modeling in ecotoxicology
<em>To appear in Environ Toxicol Chem</em>.
</p>


<h3>See Also</h3>

<p>Setting <code class="reqn">c=0</code> yields <code><a href="#topic+W1.3">W1.3</a></code>. A more flexible function, allowing 
fixing or constraining parameters, is available through <code><a href="#topic+weibull1">weibull1</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting a four-parameter Weibull (type 1) model
terbuthylazin.m1 &lt;- drm(rgr~dose, data = terbuthylazin, fct = W1.4())
summary(terbuthylazin.m1)

## Fitting a first-order multistage model
## to data from BMDS by EPA
## (Figure 3 in Ritz (2009))
bmds.ex1 &lt;- data.frame(ad.dose=c(0,50,100), dose=c(0, 2.83, 5.67), 
num=c(6,10,19), total=c(50,49,50))

bmds.ex1.m1&lt;-drm(num/total~dose, weights=total, data=bmds.ex1, 
fct=W2.4(fixed=c(1,NA,1,NA)), type="binomial")

modelFit(bmds.ex1.m1)  # same as in BMDS

summary(bmds.ex1.m1)  # same background estimate as in BMDS

logLik(bmds.ex1.m1)

## BMD estimate identical to BMDS result
## BMDL estimate differs from BMDS result (different method)
ED(bmds.ex1.m1, 10, ci="delta")

## Better fit

bmds.ex1.m2&lt;-drm(num/total~dose, weights=total, data=bmds.ex1, 
fct=W1.4(fixed=c(-1,NA,1,NA)), type="binomial")
modelFit(bmds.ex1.m2)
summary(bmds.ex1.m2)

ED(bmds.ex1.m2, 50, ci = "delta")

## Creating Figure 3 in Ritz (2009)
bmds.ex1.m3 &lt;- drm(num/total~dose, weights=total, data=bmds.ex1, 
fct=LL.4(fixed=c(-1,NA,1,NA)), type="binomial")

plot(bmds.ex1.m1, ylim = c(0.05, 0.4), log = "", lty = 3, lwd = 2, 
xlab = "Dose (mg/kg/day)", ylab = "",
cex=1.2, cex.axis=1.2, cex.lab=1.2)

mtext("Tumor incidence", 2, line=4, cex=1.2)  # tailored y axis label

plot(bmds.ex1.m2, ylim = c(0.05, 0.4), log = "", add = TRUE, lty = 2, lwd = 2)

plot(bmds.ex1.m3, ylim = c(0.05, 0.4), log = "", add = TRUE, lty = 1, lwd = 2)

arrows(2.6 , 0.14, 2, 0.14, 0.15, lwd=2)
text(2.5, 0.14, "Weibull-1", pos=4, cex=1.2)

</code></pre>

<hr>
<h2 id='weibull1'>Weibull model functions</h2><span id='topic+weibull1'></span><span id='topic+weibull2'></span><span id='topic+weibull2x'></span>

<h3>Description</h3>

<p>'weibull' and 'weibull2' provide a very general way of specifying Weibull dose response functions,
under various constraints on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  weibull1(fixed = c(NA, NA, NA, NA), 
           names = c("b", "c", "d", "e"),
           method = c("1", "2", "3", "4"), 
           ssfct = NULL,
           fctName, fctText)
 
  weibull2(fixed = c(NA, NA, NA, NA), 
           names = c("b", "c", "d", "e"),
           method = c("1", "2", "3", "4"), 
           ssfct = NULL,
           fctName, fctText)

  weibull2x(fixed = rep(NA, 5), 
           names = c("b", "c", "d", "e", "t0"),
           method = c("1", "2", "3", "4"), 
           ssfct = NULL,
           fctName, fctText)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull1_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. 
NAs for parameter that are not fixed.</p>
</td></tr>
<tr><td><code id="weibull1_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters (should not contain &quot;:&quot;). 
The default is reasonable (see under 'Usage'). The order of the parameters is: b, c, d, e (see under 'Details').</p>
</td></tr>
<tr><td><code id="weibull1_+3A_method">method</code></td>
<td>
<p>character string indicating the self starter function to use.</p>
</td></tr>  
<tr><td><code id="weibull1_+3A_ssfct">ssfct</code></td>
<td>
<p>a self starter function to be used.</p>
</td></tr>  
<tr><td><code id="weibull1_+3A_fctname">fctName</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>  
<tr><td><code id="weibull1_+3A_fcttext">fctText</code></td>
<td>
<p>optional character string used internally by convenience functions.</p>
</td></tr>                    
</table>


<h3>Details</h3>

<p>As pointed out in Seber and Wild (1989), there exist two different parameterisations of the Weibull model. They
do not yield the same fitted curve for a given dataset (see under Examples).
</p>
<p>One four-parameter Weibull model ('weibull1') is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c) \exp(-\exp(b(\log(x)-\log(e)))).</code>
</p>

<p>Another four-parameter Weibull model ('weibull2') is
</p>
<p style="text-align: center;"><code class="reqn"> f(x) = c + (d-c) (1 - \exp(-\exp(b(\log(x)-\log(e))))).</code>
</p>
  
<p>Both four-parameter functions are asymmetric with inflection point at the dose <code class="reqn">e</code>. 
</p>


<h3>Value</h3>

<p>The value returned is a list containing the non-linear function, the self starter function
and the parameter names.  
</p>


<h3>Note</h3>

<p>The functions are for use with the function <code><a href="#topic+drm">drm</a></code>.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Seber, G. A. F. and Wild, C. J (1989) 
<em>Nonlinear Regression</em>, 
New York: Wiley \&amp; Sons (pp. 338&ndash;339).
</p>


<h3>See Also</h3>

<p>For convenience several special cases of the function 'weibull1' are available: 
<code><a href="#topic+W1.2">W1.2</a></code>, <code><a href="#topic+W1.3">W1.3</a></code> and <code><a href="#topic+W1.4">W1.4</a></code>.  
</p>
<p>Special cases of 'weibull2' are: 
<code><a href="#topic+W2.2">W2.2</a></code>, <code><a href="#topic+W2.3">W2.3</a></code> and <code><a href="#topic+W2.4">W2.4</a></code>.  
</p>
<p>These convenience functions should be used rather than the underlying functions 
<code>weibull1</code> and <code>weibull2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting two different Weibull models
ryegrass.m1 &lt;- drm(ryegrass, fct = W1.4())
plot(ryegrass.m1, conLevel=0.5)

ryegrass.m2 &lt;- drm(ryegrass, fct = W2.4())
plot(ryegrass.m2, conLevel=0.5, add = TRUE, type = "none", col = 2)
# you could also look at the ED values to see the difference

## A four-parameter Weibull model with b fixed at 1
ryegrass.m3 &lt;- drm(ryegrass, fct = W1.4(fixed = c(1, NA, NA, NA)))
summary(ryegrass.m3)

## A four-parameter Weibull model with the constraint b&gt;3
ryegrass.m4 &lt;- drm(ryegrass, fct = W1.4(), lowerl = c(3, -Inf, -Inf, -Inf), 
control = drmc(constr=TRUE))
summary(ryegrass.m4)

</code></pre>

<hr>
<h2 id='yieldLoss'>Calculating yield loss parameters</h2><span id='topic+yieldLoss'></span>

<h3>Description</h3>

<p>Calculation of parameters in the re-parameterization of the Michaelis-Menten model that is commonly
used to assess yield loss (the rectangular hyperbola model)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  yieldLoss(object, interval = c("none", "as"), level = 0.95, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yieldLoss_+3A_object">object</code></td>
<td>
<p>object of class 'drc</p>
</td></tr>
<tr><td><code id="yieldLoss_+3A_interval">interval</code></td>
<td>
<p>character string specifying the type of confidence intervals to be supplied. The default is &quot;none&quot;. 
Use &quot;as&quot; for asymptotically-based confidence intervals.</p>
</td></tr>
<tr><td><code id="yieldLoss_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="yieldLoss_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rectangular hyperbola model is a reparameterization of the Michaelis-Menten in terms of parameters
<code class="reqn">A</code> and <code class="reqn">I</code>
</p>
<p style="text-align: center;"><code class="reqn"> Y_L = \frac{Id}{1+Id/A}</code>
</p>

<p>where <code class="reqn">d</code> denotes the weed density and <code class="reqn">Y_L</code> the resulting yield loss.
</p>


<h3>Value</h3>

<p>For each of the two parameters, a matrix with two or more columns, containing the estimates 
and the corresponding estimated standard errors and possibly lower and upper confidence limits.
</p>


<h3>Note</h3>

<p>This function is only for use with model fits based on Michaelis-Menten models.
</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>References</h3>

<p>Cousens, R. (1985). A simple model relating yield loss to weed density,
<em>Ann. Appl. Biol.</em>, <b>107</b>, 239&ndash;252.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Fitting Michaelis-Menten model
met.mm.m1 &lt;- drm(gain~dose, product, data = methionine, fct = MM.3(), 
pmodels = list(~1, ~factor(product), ~factor(product)))

## Yield loss parameters with standard errrors
yieldLoss(met.mm.m1)

## Also showing confidence intervals
yieldLoss(met.mm.m1, "as")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
