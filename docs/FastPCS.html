<!DOCTYPE html><html lang="en"><head><title>Help for package FastPCS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FastPCS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FastPCS-package'><p>FastPCS estimator of location and scatter.</p></a></li>
<li><a href='#FastPCS'><p>Computes the FastPCS multivariate outlyingness index.</p></a></li>
<li><a href='#FPCSnumStarts'><p>Computes the number of starting p-subsets</p></a></li>
<li><a href='#plot.FastPCS'><p>Distance plot for FastPCS</p></a></li>
<li><a href='#quanf'><p>Converts alpha values to h-values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>FastPCS Robust Fit of Multivariate Location and Scatter</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-13</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), matrixStats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Description:</td>
<td>The FastPCS algorithm of Vakili and Schmitt (2014) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2013.07.021">doi:10.1016/j.csda.2013.07.021</a>&gt; for robust estimation of multivariate location and scatter and multivariate outliers detection. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaveh Vakili [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 14:02:25 UTC; kaveh</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-06 14:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='FastPCS-package'>FastPCS estimator of location and scatter.</h2><span id='topic+FastPCS-package'></span>

<h3>Description</h3>

<p>Uses the FastPCS algorithm to compute the robust PCS estimator of location and scatter.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FastPCS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.0.9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-13</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> mvtnorm</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
FastPCS                 Function to compute the robust FastPCS estimator of location and scatter.
FPCSnumStarts               Internal function used to compute the number of starting points used by FastPCS.
quanf                   Internal function used to compute h, the minimum number of observations expected to be uncontaminated.
plot.FastPCS		Plots the robust distances outputted by a FastPCS model.
</pre>


<h3>Author(s)</h3>

<p>Kaveh Vakili [aut, cre],
Maintainer: Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;
</p>


<h3>References</h3>

<p>Vakili, K. and Schmitt, E. (2014).
Finding multivariate outliers with FastPCS.
<em>Computational Statistics &amp; Data Analysis</em>.
Vol. 69, pp 54&ndash;66.
(http://arxiv.org/abs/1301.2053)
</p>

<hr>
<h2 id='FastPCS'>Computes the FastPCS multivariate outlyingness index.</h2><span id='topic+FastPCS'></span>

<h3>Description</h3>

<p>Computes a fast and robust multivariate outlyingness index for a n by p matrix of 
multivariate continuous data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  FastPCS(x,nSamp,alpha=0.5,seed=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FastPCS_+3A_x">x</code></td>
<td>
<p>A numeric n (n&gt;5*p) by p (p&gt;1) matrix or data frame.</p>
</td></tr>
<tr><td><code id="FastPCS_+3A_nsamp">nSamp</code></td>
<td>
<p>A positive integer giving the number of resamples required;
<code>"nSamp"</code> may not be reached if too many of the p-subsets,
chosen out of the observed vectors, lie on a hyperplane.  If <code>"nSamp"</code> is
omitted, it is calculated so that the probability of getting at least one
uncontaminated starting point is always at least 99 percent when there are n/2 outliers.</p>
</td></tr>
<tr><td><code id="FastPCS_+3A_alpha">alpha</code></td>
<td>
<p>Numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
<tr><td><code id="FastPCS_+3A_seed">seed</code></td>
<td>
<p>Starting value for random generator. A positive integer. Default is seed = 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version of FastPCS includes the use of a C-step procedure to improve efficiency (Rousseeuw and van Driessen (1999)). C-steps are taken after the raw subset (H*) as been chosen (according to the I-index) and before reweighting. In experiments, we found that carrying C-Steps 
starting from the members of <code>$rawBest</code> improves the speed of convergence without increasing the bias
of the final estimates. FastPCS is affine equivariant (Schmitt et al. (2014)) and thus consistent at the 
elliptical model (Maronna et al., (2006) p. 217).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>The value of alpha used.</p>
</td></tr>
<tr><td><code>nSamp</code></td>
<td>
<p>The value of nSamp used.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>The value of the FastPCS objective function of the optimal h subset.</p>
</td></tr>
<tr><td><code>rawBest</code></td>
<td>
<p>The index of the h observation with smallest outlyingness indexes.</p>
</td></tr>
<tr><td><code>best</code></td>
<td>
<p>The index of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>The mean vector of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>Covariance matrix of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td></tr>
<tr><td><code>distance</code></td>
<td>
<p>The statistical distance of each observation wrt the center vector and cov matrix of the observations with outlyingness smaller than the rejection threshold after C-steps are taken.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>References</h3>

<p>Maronna, R. A., Martin R. D. and Yohai V. J. (2006). Robust Statistics: Theory and Methods. Wiley, New York.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999). A fast algorithm for the minimum covariance determinant estimator. Technometrics 41, 212&ndash;223.
</p>
<p>Eric Schmitt, Viktoria Oellerer, Kaveh Vakili (2014).
The finite sample breakdown point of PCS Statistics and Probability Letters, Volume 94, Pages 214-220.
</p>
<p>Vakili, K. and Schmitt, E. (2014).
Finding multivariate outliers with FastPCS.
<em>Computational Statistics &amp; Data Analysis</em>.
Vol. 69, pp 54&ndash;66.
(http://arxiv.org/abs/1301.2053)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## testing outlier detection 
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:30,]&lt;-matrix(rnorm(30*p,4.5,1/100),nc=p)
z&lt;-c(rep(0,30),rep(1,70))
nstart&lt;-FPCSnumStarts(p=p,eps=0.4)
results&lt;-FastPCS(x=x0,nSamp=nstart)
z[results$best]

## testing outlier detection, different value of alpha
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:20,]&lt;-matrix(rnorm(20*p,4.5,1/100),nc=p)
z&lt;-c(rep(0,20),rep(1,80))
nstart&lt;-FPCSnumStarts(p=p,eps=0.25)
results&lt;-FastPCS(x=x0,nSamp=nstart,alpha=0.75)
z[results$best]

#testing exact fit
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:30,]&lt;-matrix(rnorm(30*p,5,1/100),nc=p)
x0[31:100,3]&lt;-x0[31:100,2]*2+1
z&lt;-c(rep(0,30),rep(1,70))
nstart&lt;-FPCSnumStarts(p=p,eps=0.4)
results&lt;-FastPCS(x=x0,nSamp=nstart)
z[results$rawBest]
results$obj

#testing affine equivariance
n&lt;-100
p&lt;-3
set.seed(123)
x0&lt;-matrix(rnorm(n*p),nc=p)
nstart&lt;-500
results1&lt;-FastPCS(x=x0,nSamp=nstart,seed=1)
a1&lt;-matrix(0.9,p,p)
diag(a1)&lt;-1
x1&lt;-x0%*%a1
results2&lt;-FastPCS(x=x1,nSamp=nstart,seed=1)
results2$center
results2$cov
#should be the same
results1$center%*%a1
a1

</code></pre>

<hr>
<h2 id='FPCSnumStarts'>Computes the number of starting p-subsets</h2><span id='topic+FPCSnumStarts'></span>

<h3>Description</h3>

<p>Computes the number of starting p-subsets so that the desired probability of selecting at least one clean one is achieved.
This is an internal function not intended to be called 
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  FPCSnumStarts(p,gamma=0.99,eps=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FPCSnumStarts_+3A_p">p</code></td>
<td>
<p>number of dimensions of the data matrix X.</p>
</td></tr>
<tr><td><code id="FPCSnumStarts_+3A_gamma">gamma</code></td>
<td>
<p>desired probability of having at least one 
clean starting p-subset.</p>
</td></tr>
<tr><td><code id="FPCSnumStarts_+3A_eps">eps</code></td>
<td>
<p>suspected contamination rate of the sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer number of starting p-subsets.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FPCSnumStarts(p=3,gamma=0.99,eps=0.4)
</code></pre>

<hr>
<h2 id='plot.FastPCS'>Distance plot for FastPCS</h2><span id='topic+plot.FastPCS'></span>

<h3>Description</h3>

<p>Plots the robust distance values from a FastPCS model fit, and their parametric cut-off. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FastPCS'
plot(x,col="black",pch=16,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FastPCS_+3A_x">x</code></td>
<td>
<p>For the <code>plot()</code> method, a <code>FastPCS</code> object, typically
resulting as output from <code><a href="#topic+FastPCS">FastPCS</a></code>.</p>
</td></tr>	
<tr><td><code id="plot.FastPCS_+3A_col">col</code></td>
<td>
<p> A specification for the default plotting color. Vectors of values are recycled.</p>
</td></tr>
<tr><td><code id="plot.FastPCS_+3A_pch">pch</code></td>
<td>
<p> Either an integer specifying a symbol, or a single character
to be used as the default in plotting points. Note that only
integers and single-character strings can be set as
graphics parameters.
Vectors of values are recycled.</p>
</td></tr>
<tr><td><code id="plot.FastPCS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the plot function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaveh Vakili, Eric Schmitt</p>


<h3>See Also</h3>

<p><code><a href="#topic+FastPCS">FastPCS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate data
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
x0[1:30,]&lt;-matrix(rnorm(30*p,4.5,1/100),nc=p)
z&lt;-c(rep(0,30),rep(1,70))
nstart&lt;-FPCSnumStarts(p=p,eps=0.4)
results&lt;-FastPCS(x=x0,nSamp=nstart)
colvec&lt;-rep("orange",length(z))
colvec[z==1]&lt;-"blue"
plot.FastPCS(results,col=colvec,pch=16)
</code></pre>

<hr>
<h2 id='quanf'>Converts alpha values to h-values</h2><span id='topic+quanf'></span>

<h3>Description</h3>

<p>FastPCS selects the subset of size h that minimizes the I-index criterion. The function <code>quanf</code> determines the size of h based on the rate of contamination the user expects is present in the data.
This is an internal function not intended to be called 
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  quanf(n,p,alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quanf_+3A_n">n</code></td>
<td>
<p>Number of rows of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_p">p</code></td>
<td>
<p>Number of columns of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_alpha">alpha</code></td>
<td>
<p>Numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer number of the size of the starting p-subsets.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quanf(p=3,n=500,alpha=0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
