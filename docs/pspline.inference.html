<!DOCTYPE html><html><head><title>Help for package pspline.inference</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pspline.inference}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check.scalars'><p>Assess whether scalar estimates fall within their intended confidence intervals</p></a></li>
<li><a href='#confints.outcomes'><p>Calculate confidence intervals of model outcome variables</p></a></li>
<li><a href='#ecdf.outcomes'><p>Return empirical CDF for model outcome variables</p></a></li>
<li><a href='#eval.model'><p>Eval model prediction with given model params at given predictors</p></a></li>
<li><a href='#observed.results.scalars'><p>Run simulation study on one set of observations</p></a></li>
<li><a href='#pspline.confints.scalars'><p>Calculates confidence intervals and medians for scalar samples obtained from <code>pspline.sample.scalars</code></p></a></li>
<li><a href='#pspline.confints.timeseries'><p>Calculates confidence intervals for results of simulation performed by <code>pspline.sample.timeseries</code></p></a></li>
<li><a href='#pspline.estimate.scalars'><p>Calculates confidence intervals for scalars estimated from generalized additive (mixed) model of an outbreak</p></a></li>
<li><a href='#pspline.estimate.timeseries'><p>Calculates confidence intervals for time series sampled from generalized additive (mixed) model of an outbreak</p></a></li>
<li><a href='#pspline.inference'><p>Inference using penalized basis splines (P-splines) in a generalized additive model (GAM), with applications in</p>
infectious disease outbreak modeling</a></li>
<li><a href='#pspline.outbreak.calc.cumcases'><p>Calculate cumulative incidence time series from incidence time series</p></a></li>
<li><a href='#pspline.outbreak.cases'><p>Calculate cumulative incidence for an outbreak</p></a></li>
<li><a href='#pspline.outbreak.cumcases'><p>Calculate cumulative incidence for an outbreak</p></a></li>
<li><a href='#pspline.outbreak.cumcases.relative'><p>Calculate relative incidence for an outbreak</p></a></li>
<li><a href='#pspline.outbreak.thresholds'><p>Calculate outbreak thresholds for an outbreak</p></a></li>
<li><a href='#pspline.sample.scalars'><p>Runs simulations on an outbreak GAM/GAMM for the purpose of estimating</p>
scalar outbreak outcomes, and returns estimated scalar outcome values for each simulation.</a></li>
<li><a href='#pspline.sample.timeseries'><p>Runs simulations on an outbreak GAM/GAMM for the purpose of estimating time series outbreak outcomes, and</p>
returns estimated time series outcomes for each simulation.</a></li>
<li><a href='#pspline.validate.scalars'><p>Run a simulation study to validate a scalar estimator</p></a></li>
<li><a href='#quantile.outcomes'><p>Calculate quantiles of model outcome variables</p></a></li>
<li><a href='#sample.params'><p>Sample spline parameters</p></a></li>
<li><a href='#truth.results.scalars'><p>Run simulation study on one truth</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimation of Characteristics of Seasonal and Sporadic
Infectious Disease Outbreaks Using Generalized Additive
Modeling with Penalized Basis Splines</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-18</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Inference of infectious disease outcomes using generalized additive
    (mixed) models with penalized basis splines (P-Splines). See 
    <a href="https://medrxiv.org/cgi/content/short/2020.07.14.20138180v1">https://medrxiv.org/cgi/content/short/2020.07.14.20138180v1</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, mgcv, dplyr, magrittr, assertthat, plyr,
reshape2, plotrix, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>import, ggplot2, data.table, ggstance, knitr, rmarkdown,
roxygen2, kableExtra, doParallel, parallel, stringr, scales,
testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/weinbergerlab/pspline.inference">https://github.com/weinbergerlab/pspline.inference</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/weinbergerlab/pspline.inference/issues">https://github.com/weinbergerlab/pspline.inference/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-19 14:24:18 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Ben Artin [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Artin &lt;ben@artins.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-19 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='check.scalars'>Assess whether scalar estimates fall within their intended confidence intervals</h2><span id='topic+check.scalars'></span>

<h3>Description</h3>

<p>Assess whether scalar estimates fall within their intended confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.scalars(ecdfs, expected, level)
</code></pre>

<hr>
<h2 id='confints.outcomes'>Calculate confidence intervals of model outcome variables</h2><span id='topic+confints.outcomes'></span>

<h3>Description</h3>

<p>Calculate confidence intervals of model outcome variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confints.outcomes(data, model, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confints.outcomes_+3A_data">data</code></td>
<td>
<p>data frame containing predictor and outcome variables</p>
</td></tr>
<tr><td><code id="confints.outcomes_+3A_model">model</code></td>
<td>
<p>associated model</p>
</td></tr>
<tr><td><code id="confints.outcomes_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of predictors and associated lower CL, median, and upper CL
</p>

<hr>
<h2 id='ecdf.outcomes'>Return empirical CDF for model outcome variables</h2><span id='topic+ecdf.outcomes'></span>

<h3>Description</h3>

<p>Return empirical CDF for model outcome variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecdf.outcomes(data, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecdf.outcomes_+3A_data">data</code></td>
<td>
<p>data.frame containing predictor variables and outcome variables</p>
</td></tr>
<tr><td><code id="ecdf.outcomes_+3A_model">model</code></td>
<td>
<p>associated model (its formula is used to determine which variables in <code>data</code> are predictors and which are outcomes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of ECDFs
</p>

<hr>
<h2 id='eval.model'>Eval model prediction with given model params at given predictors</h2><span id='topic+eval.model'></span>

<h3>Description</h3>

<p>Eval model prediction with given model params at given predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval.model(params, model, predictors, outcome)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval.model_+3A_params">params</code></td>
<td>
<p>model params</p>
</td></tr>
<tr><td><code id="eval.model_+3A_model">model</code></td>
<td>
<p>model to evaluate</p>
</td></tr>
<tr><td><code id="eval.model_+3A_predictors">predictors</code></td>
<td>
<p>predictor values at which to evaluate</p>
</td></tr>
<tr><td><code id="eval.model_+3A_outcome">outcome</code></td>
<td>
<p>outcome function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of model evaluated with params at predictors
</p>

<hr>
<h2 id='observed.results.scalars'>Run simulation study on one set of observations</h2><span id='topic+observed.results.scalars'></span>

<h3>Description</h3>

<p>Run simulation study on one set of observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observed.results.scalars(
  observed,
  truth,
  expected,
  fun.model,
  fun.outcome,
  n.samples,
  level
)
</code></pre>

<hr>
<h2 id='pspline.confints.scalars'>Calculates confidence intervals and medians for scalar samples obtained from <code><a href="#topic+pspline.sample.scalars">pspline.sample.scalars</a></code></h2><span id='topic+pspline.confints.scalars'></span>

<h3>Description</h3>

<p>Calculates confidence intervals and medians for scalar samples obtained from <code><a href="#topic+pspline.sample.scalars">pspline.sample.scalars</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.confints.scalars(samples, model, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.confints.scalars_+3A_samples">samples</code></td>
<td>
<p>data frame of samples as returned by <code><a href="#topic+pspline.sample.scalars">pspline.sample.scalars</a></code></p>
</td></tr>
<tr><td><code id="pspline.confints.scalars_+3A_level">level</code></td>
<td>
<p>confidence level for calculated confidence intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of confidence intervals and medians
</p>

<hr>
<h2 id='pspline.confints.timeseries'>Calculates confidence intervals for results of simulation performed by <code><a href="#topic+pspline.sample.timeseries">pspline.sample.timeseries</a></code></h2><span id='topic+pspline.confints.timeseries'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for results of simulation performed by <code><a href="#topic+pspline.sample.timeseries">pspline.sample.timeseries</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.confints.timeseries(samples, model, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.confints.timeseries_+3A_samples">samples</code></td>
<td>
<p>data frame of samples as returned by <code><a href="#topic+pspline.sample.timeseries">pspline.sample.timeseries</a></code></p>
</td></tr>
<tr><td><code id="pspline.confints.timeseries_+3A_level">level</code></td>
<td>
<p>confidence level for calculated confidence intervals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of confidence intervals
</p>

<hr>
<h2 id='pspline.estimate.scalars'>Calculates confidence intervals for scalars estimated from generalized additive (mixed) model of an outbreak</h2><span id='topic+pspline.estimate.scalars'></span>

<h3>Description</h3>

<p>This function performs Monte Carlo sampling of a GAM/GAMM outbreak model.
For each sampled curve, it calls <code>outcomess</code> to calculate scalar outcomes
It then calculates and returns the confidence interval of each scalar outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.estimate.scalars(
  model,
  predictors,
  outcomes,
  samples = 100,
  level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.estimate.scalars_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code></p>
</td></tr>
<tr><td><code id="pspline.estimate.scalars_+3A_predictors">predictors</code></td>
<td>
<p>data.frame of predictor values at which the model will be evaluated</p>
</td></tr>
<tr><td><code id="pspline.estimate.scalars_+3A_outcomes">outcomes</code></td>
<td>
<p>function returning calculated scalar outcomes, as described above</p>
</td></tr>
<tr><td><code id="pspline.estimate.scalars_+3A_samples">samples</code></td>
<td>
<p>number of samples of outcomes to draw</p>
</td></tr>
<tr><td><code id="pspline.estimate.scalars_+3A_level">level</code></td>
<td>
<p>confidence level for estimates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>outcomes</code> function must accept (<code>model</code>, <code>params</code>, <code>predictors</code>) and return a one-row data frame
in which each column lists the value of a single scalar outcome calculated from the model
estimates.
</p>
<p>A typical implementation of the <code>outcomes</code> function would call <code>predict</code> on
<code>model</code> and <code>predictors</code> to obtain model variable estimates at predictor values, then
calculate the scalar outcomes of interest and return them in a data frame.
</p>
<p>For example, to calculate the time of outbreak peak, you might use this function for <code>outcomes</code>:
</p>
<p><code>
calc_peak = function(model, params, time) {
  incidence = predict(model, data.frame(time=time), type="response")
  data.frame(peak=time[which.max(incidence)])
}
</code>
</p>
<p>The data frame returned by <code>pspline.estimate.scalars</code> contains three columns for each
outcome calculated by <code>outcomes</code>: for outcome <code>x</code> returned by <code>outcomes</code>,
<code>pspline.estimate.scalars</code> returns columns <code>x.lower</code>, <code>x.median</code>, and <code>x.upper</code>, corresponding
to lower confidence limit, median, and upper confidence limit of <code>x</code>.
</p>


<h3>Value</h3>

<p>data frame of estimates, as described above
</p>

<hr>
<h2 id='pspline.estimate.timeseries'>Calculates confidence intervals for time series sampled from generalized additive (mixed) model of an outbreak</h2><span id='topic+pspline.estimate.timeseries'></span>

<h3>Description</h3>

<p>This function performs a series of Monte Carlo simulations of a GAM/GAMM outbreak model.
For each simulated outbreak, it calls <code>outcome</code> to calculate a time series for the
simulated outbreak (for example, the number of cumulative cases vs time).
It then calculates and returns the confidence interval of the simulated time series at
each time point across all simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.estimate.timeseries(
  model,
  predictors,
  outcome,
  samples = 1000,
  level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.estimate.timeseries_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code>, with a single parameter (time)</p>
</td></tr>
<tr><td><code id="pspline.estimate.timeseries_+3A_predictors">predictors</code></td>
<td>
<p>data frame of predictor values at which the model will be evaluated</p>
</td></tr>
<tr><td><code id="pspline.estimate.timeseries_+3A_outcome">outcome</code></td>
<td>
<p>function returning calculated outcome time series, as described above</p>
</td></tr>
<tr><td><code id="pspline.estimate.timeseries_+3A_samples">samples</code></td>
<td>
<p>number of simulations to run</p>
</td></tr>
<tr><td><code id="pspline.estimate.timeseries_+3A_level">level</code></td>
<td>
<p>confidence level for returned estimates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>outcome</code> function must accept (<code>model</code>, <code>params</code>, <code>time</code>) and return a vector
containing the outcome time series obtained by evaluating the model at the time points given in <code>time</code> and
using the model parameters given in <code>params</code>.
</p>
<p>A typical implementation of the <code>outcome</code> function would call <code>predict</code> on
<code>model</code> and <code>time</code> to obtain the linear predictor matrix, and then post-multiply
that matrix by <code>params</code>. Having thus obtained model prediction at every time point,
it would calculate the desired time series outcome and return it in a vector.
</p>
<p>For example, to calculate the time series of the first derivative of incidence,
you might use this function for <code>outcome</code>:
</p>
<p><code>
calc_deriv = function(model, params, time) {
  eps = 0.001
  predictors = predict(model, data.frame(time=time), type="lpmatrix")
  fit = model$family$linkinv(predictors 
  predictors_eps = predict(model, data.frame(time=time + eps), type="lpmatrix")
  fit_eps = model$family$linkinv(predictors_eps 
  (fit_eps - fit) / eps
}
</code>
</p>
<p>The data frame returned by <code>pspline.estimate.timeseries</code> contains three columns and
one row for each time point in <code>time</code>. The columns are <code>lower</code>, <code>median</code>, and
<code>upper</code>, containing the median and the confidence interval for the computed
outcome time series at each time point.
</p>


<h3>Value</h3>

<p>data frame of estimates, as described above
</p>

<hr>
<h2 id='pspline.inference'>Inference using penalized basis splines (P-splines) in a generalized additive model (GAM), with applications in
infectious disease outbreak modeling</h2><span id='topic+pspline.inference'></span>

<h3>Description</h3>

<p>This package lets you make point and interval estimates of outcomes modeled with a non-linear P-spline GAM.
</p>


<h3>Details</h3>

<p>Applications in infectious disease outbreak modeling include estimating of outbreak onset, peak, or offset,
as well as outbreak cumulative incidence over time.
</p>
<p>The package can model two types of outcomes: scalar outcomes, which are single-value
outcome measures (for example, timing of outbreak peak) and time series characteristics, which are functions of
time (for example, infection incidence over time)
</p>
<p>For each outcome measure, the package produces median and confidence interval estimates.
</p>
<p>Typical use of this package begins by using the package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code> to obtain
a GAM/GAMM model of the process under investigation (such as an infectious disease outbreak), followed by
calling either <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code> or <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code> to
obtain confidence intervals on the desired outcome measure
</p>
<p>Both <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code> and <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code>
allow computation of arbitrary outcome measures, by passing a function that calculates
the desired outcome measure into <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code> or <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code>.
</p>
<p>For convenience, this package also includes several utilities specifically aimed at modeling of
infectious disease outbreaks, such as <code><a href="#topic+pspline.outbreak.cases">pspline.outbreak.cases</a></code> and <code><a href="#topic+pspline.outbreak.cumcases">pspline.outbreak.cumcases</a></code>
(for estimation of incidence and cumulative incidence), and <code><a href="#topic+pspline.outbreak.thresholds">pspline.outbreak.thresholds</a></code>, for estimation
of outbreak onset and offset.
</p>


<h3>Author(s)</h3>

<p>Ben Artin <a href="mailto:ben@artins.org">ben@artins.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate an outbreak for analysis
cases = data.frame(
  time=seq(0, 51),
  cases=rpois(52, c(rep(1, 13), seq(1, 50, length.out=13), seq(50, 1, length.out=13), rep(1, 13)))
)

# Generate GAM model for outbreak; see mgcv for details
library(mgcv)
model = gam(cases ~ s(time, k=10, bs="cp", m=3), family=poisson, data=cases)

# Generate time series at which model will be evaluated for estimates
# Usually you want this to be the same as the time interval that your observations are in, except
# divided into small increments (here, eps). Using a smaller eps gives more accurate estimates, 
# but takes longer to run. A value smaller than 0.5 would be better for final analysis
eps = 0.5
estTimes = data.frame(time=seq(min(cases$time) - 0.5, max(cases$time) + 0.5 - eps, by=eps))

# Estimate incidence
estCases = pspline.estimate.timeseries(
  model, estTimes,
  pspline.outbreak.cases,
  # Using a large number of samples makes the analysis more robust; 
  # using only 15 samples makes this example run fast (default is 2000)
  samples=15, 
  level=.95
)

# Estimate time when outbreak crosses 5\% and 95\% of cumulative case count
onsetThreshold = 0.025
offsetThreshold = 1 - onsetThreshold
thresholds = pspline.estimate.scalars(
  model, estTimes,
  pspline.outbreak.thresholds(onset=onsetThreshold, offset=offsetThreshold), 
  # Using a large number of samples makes the analysis more robust; 
  # using only 15 samples makes this example run fast (default is 2000)
  samples=15, 
  level=.95
)

# Plot cumulative incidence estimates and threshold estimates
library(ggplot2)
ggplot() +
  geom_ribbon(data=estCases, aes(x=time, ymin=cases.lower, ymax=cases.upper), fill=grey(.75)) +
  geom_line(data=estCases, aes(x=time, y=cases.median)) +
  geom_point(data=cases, aes(x=time, y=cases)) +
  annotate("rect",
    xmin=thresholds$onset.lower,
    xmax=thresholds$onset.upper,
    ymin=-Inf, ymax=Inf, alpha=.25) +
  annotate("rect",
    xmin=thresholds$offset.lower,
    xmax=thresholds$offset.upper,
    ymin=-Inf, ymax=Inf, alpha=.25) +
 labs(x="Time", y="Incidence")

</code></pre>

<hr>
<h2 id='pspline.outbreak.calc.cumcases'>Calculate cumulative incidence time series from incidence time series</h2><span id='topic+pspline.outbreak.calc.cumcases'></span>

<h3>Description</h3>

<p>Correctly handles accumulating over time intervals different from 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.outbreak.calc.cumcases(time, cases)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.outbreak.calc.cumcases_+3A_time">time</code></td>
<td>
<p>vector of times</p>
</td></tr>
<tr><td><code id="pspline.outbreak.calc.cumcases_+3A_cases">cases</code></td>
<td>
<p>vector of corresponding incidences</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of corresponding cumulative incidences
</p>

<hr>
<h2 id='pspline.outbreak.cases'>Calculate cumulative incidence for an outbreak</h2><span id='topic+pspline.outbreak.cases'></span>

<h3>Description</h3>

<p>This is useful as <code>outcome</code> for <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.outbreak.cases(model, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.outbreak.cases_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code>, with a single parameter (time)</p>
</td></tr>
<tr><td><code id="pspline.outbreak.cases_+3A_data">data</code></td>
<td>
<p>data frame of predictor values at which the model will be evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of predictor values with corresponding cumulative incidence estimates in <code>$cumcases</code>
</p>

<hr>
<h2 id='pspline.outbreak.cumcases'>Calculate cumulative incidence for an outbreak</h2><span id='topic+pspline.outbreak.cumcases'></span>

<h3>Description</h3>

<p>This is useful as <code>outcome</code> for <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.outbreak.cumcases(model, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.outbreak.cumcases_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code>, with a single parameter (time)</p>
</td></tr>
<tr><td><code id="pspline.outbreak.cumcases_+3A_data">data</code></td>
<td>
<p>data frame of predictor values at which the model will be evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of predictor values with corresponding cumulative incidence estimates in <code>$cumcases</code>
</p>

<hr>
<h2 id='pspline.outbreak.cumcases.relative'>Calculate relative incidence for an outbreak</h2><span id='topic+pspline.outbreak.cumcases.relative'></span>

<h3>Description</h3>

<p>This is useful as <code>outcome</code> for <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.outbreak.cumcases.relative(model, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.outbreak.cumcases.relative_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code>, with a single parameter (time)</p>
</td></tr>
<tr><td><code id="pspline.outbreak.cumcases.relative_+3A_data">data</code></td>
<td>
<p>data frame of predictor values at which the model will be evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of predictor values with corresponding relative cumulative incidence estimates in <code>$cumcases.relative</code>
</p>

<hr>
<h2 id='pspline.outbreak.thresholds'>Calculate outbreak thresholds for an outbreak</h2><span id='topic+pspline.outbreak.thresholds'></span>

<h3>Description</h3>

<p>The result of calling this is useful as <code>outcomes</code> for <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.outbreak.thresholds(onset = NA, offset = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.outbreak.thresholds_+3A_onset">onset</code></td>
<td>
<p>onset threshold (as fraction of total outbreak case count)</p>
</td></tr>
<tr><td><code id="pspline.outbreak.thresholds_+3A_offset">offset</code></td>
<td>
<p>offset threshold (as fraction of total outbreak case count)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>function suitable as outcome estimator parameter of <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code>
</p>

<hr>
<h2 id='pspline.sample.scalars'>Runs simulations on an outbreak GAM/GAMM for the purpose of estimating
scalar outbreak outcomes, and returns estimated scalar outcome values for each simulation.</h2><span id='topic+pspline.sample.scalars'></span>

<h3>Description</h3>

<p>This is mainly used internally by <code>pspline.estimate.scalars</code>, but it's
useful if you want to calculate summary statistics of simulation results other than
the ones returned by <code>pspline.estimate.scalars</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.sample.scalars(model, predictors, calc.outcomes, samples = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.sample.scalars_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code></p>
</td></tr>
<tr><td><code id="pspline.sample.scalars_+3A_samples">samples</code></td>
<td>
<p>number of simulations to run</p>
</td></tr>
<tr><td><code id="pspline.sample.scalars_+3A_time">time</code></td>
<td>
<p>time values at which the model will be evaluated during simulation</p>
</td></tr>
<tr><td><code id="pspline.sample.scalars_+3A_outcomes">outcomes</code></td>
<td>
<p>scalar outcome generator function; see <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code> for more info</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with one row for each simulation; each row has <code>pspline.sample</code> column giving
a unique ID for the simulation, and one column for each scalar outcome returned by <code>outcomes</code>
</p>

<hr>
<h2 id='pspline.sample.timeseries'>Runs simulations on an outbreak GAM/GAMM for the purpose of estimating time series outbreak outcomes, and
returns estimated time series outcomes for each simulation.</h2><span id='topic+pspline.sample.timeseries'></span>

<h3>Description</h3>

<p>This is mainly used internally by <code>pspline.estimate.timeseries</code>, but
it's useful if you want to calculate summary statistics of simulation results other
than the ones returned by <code>pspline.estimate.timeseries</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.sample.timeseries(model, predictors, outcome, samples = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.sample.timeseries_+3A_model">model</code></td>
<td>
<p>model returned by <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+gamm">gamm</a></code></p>
</td></tr>
<tr><td><code id="pspline.sample.timeseries_+3A_outcome">outcome</code></td>
<td>
<p>time series outcome generator function; see <code><a href="#topic+pspline.estimate.timeseries">pspline.estimate.timeseries</a></code> for more info</p>
</td></tr>
<tr><td><code id="pspline.sample.timeseries_+3A_samples">samples</code></td>
<td>
<p>number of simulations to run</p>
</td></tr>
<tr><td><code id="pspline.sample.timeseries_+3A_time">time</code></td>
<td>
<p>time values at which the model will be evaluated during simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with one row for each simulation; each row contains the
time series calculated by <code>outcome</code> for the corresponding simulation run
</p>

<hr>
<h2 id='pspline.validate.scalars'>Run a simulation study to validate a scalar estimator</h2><span id='topic+pspline.validate.scalars'></span>

<h3>Description</h3>

<p>Run a simulation study to validate a scalar estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pspline.validate.scalars(
  fun.truth,
  n.truths,
  fun.observations,
  n.observations,
  fun.model,
  fun.outcomes,
  n.samples,
  level
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pspline.validate.scalars_+3A_fun.truth">fun.truth</code></td>
<td>
<p>function that generates a true state of the system. Takes no arguments, returns data frame of true values for model variables</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_n.truths">n.truths</code></td>
<td>
<p>number of different truths to generate for simulation study</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_fun.observations">fun.observations</code></td>
<td>
<p>function that generates a set of observations from truth. Takes one argument (truth data frame) and returns data frame of observations</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_n.observations">n.observations</code></td>
<td>
<p>number of sets of observations to generate for each truth in the simulation study</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_fun.model">fun.model</code></td>
<td>
<p>function that returns a model to be used for estimation. Takes one argument (observations data frame) and returns the model</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_fun.outcomes">fun.outcomes</code></td>
<td>
<p>function that calculates the outcomes of interest. Same as outcomes function in <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code>.</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_n.samples">n.samples</code></td>
<td>
<p>number of samples to use for estimation. See <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code>.</p>
</td></tr>
<tr><td><code id="pspline.validate.scalars_+3A_level">level</code></td>
<td>
<p>confidence level to use for estimation. See <code><a href="#topic+pspline.estimate.scalars">pspline.estimate.scalars</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of summary (which is a data frame specifying the fraction of true values that were contained in their estimated confidence interval) and results (which is a data frame specifying the quantile of the true value in the estimated sampled distribution for each simulation)
</p>

<hr>
<h2 id='quantile.outcomes'>Calculate quantiles of model outcome variables</h2><span id='topic+quantile.outcomes'></span>

<h3>Description</h3>

<p>Calculate quantiles of model outcome variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'outcomes'
quantile(data, model, probs, prob.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile.outcomes_+3A_data">data</code></td>
<td>
<p>data.frame containing predictor variables and outcome variables</p>
</td></tr>
<tr><td><code id="quantile.outcomes_+3A_model">model</code></td>
<td>
<p>associated model (its formula is used to determine which variables in <code>data</code> are predictors and which are outcomes)</p>
</td></tr>
<tr><td><code id="quantile.outcomes_+3A_probs">probs</code></td>
<td>
<p>probabilities at which quantiles will be calculated (same as for 'quantile')</p>
</td></tr>
<tr><td><code id="quantile.outcomes_+3A_prob.names">prob.names</code></td>
<td>
<p>format strings used to construct names of the new data columns. For example, if <code>probs</code> is 0.05 and
<code>prob.names</code> is <code>%s.lower</code>, then the 5th percentile of each outcome variable <code>var</code> will be returned in <code>var.lower</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of predictors and associated outcome quantiles.
</p>

<hr>
<h2 id='sample.params'>Sample spline parameters</h2><span id='topic+sample.params'></span>

<h3>Description</h3>

<p>Sample spline parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample.params(model, samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample.params_+3A_model">model</code></td>
<td>
<p>spline GAM</p>
</td></tr>
<tr><td><code id="sample.params_+3A_samples">samples</code></td>
<td>
<p>number of samples</p>
</td></tr>
</table>

<hr>
<h2 id='truth.results.scalars'>Run simulation study on one truth</h2><span id='topic+truth.results.scalars'></span>

<h3>Description</h3>

<p>Run simulation study on one truth
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truth.results.scalars(
  truth,
  fun.observations,
  n.observations,
  fun.model,
  fun.outcome,
  n.samples,
  level
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
