<!DOCTYPE html><html><head><title>Help for package shapeNA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shapeNA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#barplot.shapeNA'><p>Barplot Showcasing Missingness Proportion of the Original Data</p></a></li>
<li><a href='#naBlocks'><p>Reorder Data with Missing Values</p></a></li>
<li><a href='#plot.naBlocks'><p>Plot Missingness Pattern of Data</p></a></li>
<li><a href='#plot.shapeNA'><p>Visualization of Shape Estimate</p></a></li>
<li><a href='#powerShape'><p>M-estimators of Shape from the Power Family.</p></a></li>
<li><a href='#powerShapeNA'><p>M-estimators of the Shape from the Power Family when Data is Missing</p></a></li>
<li><a href='#print.naBlocks'><p>Print Missingness Pattern</p></a></li>
<li><a href='#print.shapeNA'><p>Print Method for Objects of Class <code>shapeNA</code></p></a></li>
<li><a href='#print.summary.shapeNA'><p>Print Method for Class <code>summary.shapeNA</code></p></a></li>
<li><a href='#shape2scatter'><p>Scatter Estimates from <code>shapeNA</code> Objects</p></a></li>
<li><a href='#summary.shapeNA'><p>Summary Method for Class <code>shapeNA</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>M-Estimation of Shape for Data with Missing Values</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>M-estimators of location and shape following the power family 
    (Frahm, Nordhausen, Oja (2020) &lt;<a href="https://doi.org/10.1016%2Fj.jmva.2019.104569">doi:10.1016/j.jmva.2019.104569</a>&gt;) are 
    provided in the case of complete data and also when observations have 
    missing values together with functions aiding their visualization.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mvtnorm, mice</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-12 12:19:46 UTC; kathi</td>
</tr>
<tr>
<td>Author:</td>
<td>Katharina Riemer [cre, aut],
  Gabriel Frahm <a href="https://orcid.org/0000-0001-7507-730X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Klaus Nordhausen <a href="https://orcid.org/0000-0002-3758-8501"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Una Radojicic <a href="https://orcid.org/0000-0003-0329-0595"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Katharina Riemer &lt;kathariemer.maintainer@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-15 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='barplot.shapeNA'>Barplot Showcasing Missingness Proportion of the Original Data</h2><span id='topic+barplot.shapeNA'></span>

<h3>Description</h3>

<p>Visualize the proportion of missingness per variable in a barplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapeNA'
barplot(height, sortNA = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot.shapeNA_+3A_height">height</code></td>
<td>
<p>A <code>shapeNA</code> object.</p>
</td></tr>
<tr><td><code id="barplot.shapeNA_+3A_sortna">sortNA</code></td>
<td>
<p>A logical. If <code>FALSE</code>, the original variable order is kept.
Otherwise the variables are ordered from least to most missingness.</p>
</td></tr>
<tr><td><code id="barplot.shapeNA_+3A_...">...</code></td>
<td>
<p>Additional graphical arguments passed to
<code><a href="graphics.html#topic+barplot">barplot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a named vector holding the proportion of
missingness per variable.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+barplot">barplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    S &lt;- toeplitz(seq(1, 0.1, length.out = 3))
    x &lt;- mvtnorm::rmvt(100, S, df = 5)
    y &lt;- mice::ampute(x, mech='MCAR')$amp
    res &lt;- classicShapeNA(y)
    barplot(res)
</code></pre>

<hr>
<h2 id='naBlocks'>Reorder Data with Missing Values</h2><span id='topic+naBlocks'></span>

<h3>Description</h3>

<p>Reorder a data set with <code>NA</code> entries to form blocks of missing values. The
resulting data will have increasing missingness along the rows and along the
columns. The rows are ordered such that the first block consists of complete
observations, and the following blocks are ordered from most frequent
missingness pattern to least frequent missingness pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naBlocks(x, cleanup = TRUE, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naBlocks_+3A_x">x</code></td>
<td>
<p>A matrix with missing values.</p>
</td></tr>
<tr><td><code id="naBlocks_+3A_cleanup">cleanup</code></td>
<td>
<p>A logical flag. If <code>TRUE</code>, observations with less than 2 responses
are discarded.</p>
</td></tr>
<tr><td><code id="naBlocks_+3A_plot">plot</code></td>
<td>
<p>A logical flag. If <code>TRUE</code>, a plot of the missingness pattern is produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of ties, that is if two patterns occur with the same frequency, the block
whose pattern occurs first will be ordered in front of the other block.
</p>
<p>This method may fail if the missingness is too strong or if the number of
observations is too low (the number of observations has to exceed the number
of variables), as it has been designed as a preprocessing step for shape
estimations.
</p>


<h3>Value</h3>

<p>A list of class <code>naBlocks</code> with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The reordered data matrix.</p>
</td></tr>
<tr><td><code>permutation</code></td>
<td>
<p>The permutation of the columns that was applied to reorder the columns according to the number of <code>NA</code>s.</p>
</td></tr>
<tr><td><code>rowPermutation</code></td>
<td>
<p>The permutation of the rows that generates the blocks.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>A vector of all row indices. Each row number points to the beginning of a new missingness pattern.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>A vector specifying the missingness pattern for each block.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>A vector specifying the number of observed variables per block.</p>
</td></tr>
<tr><td><code>kn</code></td>
<td>
<p>A vector specifying the percentage of observed responses per variable.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.naBlocks'>Plot Missingness Pattern of Data</h2><span id='topic+plot.naBlocks'></span>

<h3>Description</h3>

<p>Function to visualize the missingness patterns for objects of class <code>naBlocks</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naBlocks'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.naBlocks_+3A_x">x</code></td>
<td>
<p>A <code>naBlocks</code> object.</p>
</td></tr>
<tr><td><code id="plot.naBlocks_+3A_...">...</code></td>
<td>
<p>Additional parameters passed on to <code><a href="graphics.html#topic+rect">rect</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    x &lt;- mvtnorm::rmvt(100, toeplitz(seq(1, 0.1, length.out = 3)), df = 5)
    y &lt;- mice::ampute(x, mech='MCAR')$amp
    res &lt;- classicShapeNA(y)
    plot(res$naBlocks)
</code></pre>

<hr>
<h2 id='plot.shapeNA'>Visualization of Shape Estimate</h2><span id='topic+plot.shapeNA'></span>

<h3>Description</h3>

<p>Function to visualize the shape matrix from objects of class <code>shapeNA</code> by
plotting a heatmap where light colored cells indicate small values and dark
colored cells indicate high values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapeNA'
plot(x, message = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.shapeNA_+3A_x">x</code></td>
<td>
<p>A <code>shapeNA</code> oopbject</p>
</td></tr>
<tr><td><code id="plot.shapeNA_+3A_message">message</code></td>
<td>
<p>A logical, If <code>TRUE</code>, the percentage of observed values per
variable is printed in the console.</p>
</td></tr>
<tr><td><code id="plot.shapeNA_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the proportion of observed values for each variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    x &lt;- mvtnorm::rmvt(100, toeplitz(seq(1, 0.1, length.out = 3)), df = 5)
    y &lt;- mice::ampute(x, mech='MCAR')$amp
    res &lt;- tylerShapeNA(y)
    ## default plot
    plot(res)
    ## plot result in gray scale - reverse order to get a palette starting
    ## with the lightest instead of the darkest color
    plot(res, col = gray.colors(9, rev = TRUE))
</code></pre>

<hr>
<h2 id='powerShape'>M-estimators of Shape from the Power Family.</h2><span id='topic+powerShape'></span><span id='topic+tylerShape'></span><span id='topic+classicShape'></span>

<h3>Description</h3>

<p>Power M-estimators of shape and location were recently suggested in
Frahm et al. (2020). They have a tuning parameter <code>alpha</code> taking values in
<code>[0,1]</code>. The extreme case <code>alpha</code> = 1 corresponds to Tyler's shape
matrix and <code>alpha</code> = 0 to the classical covariance matrix. These special
cases have their own, more efficient functions <code><a href="#topic+tylerShape">tylerShape</a></code> and
<code><a href="#topic+classicShape">classicShape</a></code>, respectively.
If the true location is known, it should be supplied as <code>center</code>, otherwise
it is estimated simultaneously with the shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerShape(x, alpha, center = NULL,
    normalization = c("det", "trace", "one"), maxiter = 1e4, eps = 1e-6)

tylerShape(x, center = NULL,
    normalization = c("det", "trace", "one"), maxiter = 1e4, eps = 1e-6)

classicShape(x, center = NULL,
    normalization = c("det", "trace", "one"), maxiter = 1e4, eps = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerShape_+3A_x">x</code></td>
<td>
<p>A numeric data matrix or data.frame without missing data.</p>
</td></tr>
<tr><td><code id="powerShape_+3A_alpha">alpha</code></td>
<td>
<p>Tail index, a numeric value in the interval <code>[0, 1]</code>.
Determines the power function. For more information see 'Details'.</p>
</td></tr>
<tr><td><code id="powerShape_+3A_center">center</code></td>
<td>
<p>An optional vector of the data's center. If <code>NULL</code> the center
will be estimated simultaneously with the shape.</p>
</td></tr>
<tr><td><code id="powerShape_+3A_normalization">normalization</code></td>
<td>
<p>A string determining how the shape matrix is standardized.
The possible values are
</p>

<ul>
<li><p><code>'det'</code>such that the returned shape estimate has determinant 1.
</p>
</li>
<li><p><code>'trace'</code>such that the returned shape estimate has trace <code>ncol(x)</code>.
</p>
</li>
<li><p><code>'one'</code>such that the returned shape estimate's top left entry
(<code>S[1, 1]</code>) is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="powerShape_+3A_maxiter">maxiter</code></td>
<td>
<p>A positive integer, restricting the maximum number of iterations.</p>
</td></tr>
<tr><td><code id="powerShape_+3A_eps">eps</code></td>
<td>
<p>A numeric, specifying the tolerance level of when the iteration stops.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions assume that the data were generated from an
elliptical distribution, for Tyler's estimate this can be relaxed to
generalized elliptical distributions.
</p>
<p>For multivariate normally distributed data, <code><a href="#topic+classicShape">classicShape</a></code> is the maximum
likelihood estimator of location and scale. It is a special case of the
power M-estimator with tail index <code>alpha</code> = 0, which returns the empirical
covariance matrix and the empirical mean vector.
</p>
<p>The function <code><a href="#topic+tylerShape">tylerShape</a></code> maximizes the likelihood function after projecting
the observed data of each individual onto the unit hypersphere, in which case
we obtain an angular central Gaussian distribution. It is a special case of
the power M-estimator with tail index <code>alpha</code> = 1, which returns Tyler's
M-estimator of scatter and an affine equivariant multivariate median
according to Hettmansperger and Randles (2002).
</p>
<p>The function <code><a href="#topic+powerShape">powerShape</a></code> requires an additional parameter, the so-called
tail index <code>alpha</code>. For heavy tailed data, the index should be chosen closer
to 1, whereas for light tailed data the index should be chosen closer to 0.
</p>


<h3>Value</h3>

<p>A list with class 'shapeNA' containing the following components:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>The estimated shape matrix.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>The scale with which the shape matrix may be scaled to obtain
a scatter estimate. If <code>alpha</code> = 1, then this value is <code>NA</code>, as Tyler's
shape matrix has no natural scale.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>The location parameter, either provided by the user or estimated.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The tail index with which the Power M-estimator has been called.</p>
</td></tr>
<tr><td><code>naBlocks</code></td>
<td>
<p><code>NULL</code>, since <code><a href="#topic+powerShape">powerShape</a></code> operates only on complete data.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>Number of computed iterations before convergence.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Tyler, D.E. (1987). A Distribution-Free M-Estimator of Multivariate Scatter. The Annals of Statistics, 15, 234.251. doi: <a href="https://doi.org/10.1214/aos/1176350263">10.1214/aos/1176350263</a>.
</p>
<p>Frahm, G., Nordhausen, K., &amp; Oja, H. (2020). M-estimation with incomplete and dependent multivariate data. Journal of Multivariate Analysis, 176, 104569. doi: <a href="https://doi.org/10.1016/j.jmva.2019.104569">10.1016/j.jmva.2019.104569</a>.
</p>
<p>Hettmansperger, T. P., &amp; Randles, R. H. (2002). A practical affine equivariant multivariate median. Biometrika, 89(4), 851-860. doi: <a href="https://doi.org/10.1093/biomet/89.4.851">10.1093/biomet/89.4.851</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+powerShapeNA">powerShapeNA</a>, <a href="#topic+tylerShapeNA">tylerShapeNA</a> and <a href="#topic+classicShapeNA">classicShapeNA</a> for the
corresponding functions for data with missing values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Generate example data
    S &lt;- toeplitz(c(1, 0.1))
    x &lt;- mvtnorm::rmvt(100, S)
    ## Compute some M-estimators
    res0 &lt;- classicShape(x, center = c(0, 0))
    res1 &lt;- powerShape(x, alpha = 0.67, normalization = 'one')
    res2 &lt;- tylerShape(x, normalization = 'trace')
    ## Get location estimates
    res1$mu
    res2$mu
    ## Get shape estimates
    res0$S
    res1$S
    res2$S
    ## Print summary
    summary(res0)
</code></pre>

<hr>
<h2 id='powerShapeNA'>M-estimators of the Shape from the Power Family when Data is Missing</h2><span id='topic+powerShapeNA'></span><span id='topic+classicShapeNA'></span><span id='topic+tylerShapeNA'></span>

<h3>Description</h3>

<p>Power M-estimators of shape and location were recently suggested in
Frahm et al. (2020). They have a tuning parameter <code>alpha</code> taking values in
<code>[0,1]</code>. The extreme case <code>alpha</code> = 1 corresponds to Tyler's shape
matrix and <code>alpha</code> = 0 to the classical covariance matrix. These special
cases have their own, more efficient functions <code><a href="#topic+tylerShapeNA">tylerShapeNA</a></code> and
<code><a href="#topic+classicShapeNA">classicShapeNA</a></code>, respectively.
If the true location is known, it should be supplied as <code>center</code>, otherwise
it is estimated simultaneously with the shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerShapeNA(x, alpha, center = NULL, normalization = c("det", "trace", "one"),
         maxiter = 1e4, eps = 1e-6)

tylerShapeNA(x, center = NULL, normalization = c("det", "trace", "one"),
          maxiter = 1e4, eps = 1e-6)

classicShapeNA(x, center = NULL, normalization = c("det", "trace", "one"),
         maxiter = 1e4, eps = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerShapeNA_+3A_x">x</code></td>
<td>
<p>A data matrix or data.frame with missing data and <code>p</code> &gt; 2 columns.</p>
</td></tr>
<tr><td><code id="powerShapeNA_+3A_alpha">alpha</code></td>
<td>
<p>Tail index, a numeric value in the interval <code>[0, 1]</code>.
Determines the power function. For more information see 'Details'.</p>
</td></tr>
<tr><td><code id="powerShapeNA_+3A_center">center</code></td>
<td>
<p>An optional vector of the data's center, if <code>NULL</code> the center
will be estimated simultaneously with the shape.</p>
</td></tr>
<tr><td><code id="powerShapeNA_+3A_normalization">normalization</code></td>
<td>
<p>A string determining how the shape matrix is standardized.
The possible values are
</p>

<ul>
<li><p><code>'det'</code>such that the returned shape estimate has determinant 1.
</p>
</li>
<li><p><code>'trace'</code>such that the returned shape estimate has trace <code>ncol(x)</code>.
</p>
</li>
<li><p><code>'one'</code>such that the returned shape estimate's top left entry
(<code>S[1, 1]</code>) is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="powerShapeNA_+3A_maxiter">maxiter</code></td>
<td>
<p>A positive integer, restricting the maximum number of iterations.</p>
</td></tr>
<tr><td><code id="powerShapeNA_+3A_eps">eps</code></td>
<td>
<p>A numeric, specifying tolerance level of when the iteration stops.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions assume that the data were generated from an
elliptical distribution, for Tyler's estimate this can be relaxed to
generalized elliptical distributions
The missingness mechanism should be MCAR or, under
stricter distributional assumptions, MAR. See the references for details.
</p>
<p>For multivariate normally distributed data, <code><a href="#topic+classicShapeNA">classicShapeNA</a></code> is the maximum
likelihood estimator of the location and scale. It is a special case of the
power M-estimator with tail index <code>alpha</code> = 0, which returns the
empirical covariance matrix and the empirical mean vector.
</p>
<p>The function <code><a href="#topic+tylerShapeNA">tylerShapeNA</a></code> maximizes the likelihood function after projecting
the observed data of each individual onto the unit hypersphere, in which case
we obtain an angular central Gaussian distribution. It is a special case of
the power M-estimator with tail index <code>alpha</code> = 1, which returns Tyler's
M-estimator of scatter and an affine equivariant multivariate median
according to Hettmansperger and Randles (2002).
</p>
<p>The function <code><a href="#topic+powerShapeNA">powerShapeNA</a></code> requires an additional parameter, the so-called
tail index <code>alpha</code>. For heavy tailed data, the index should be chosen closer
to 1, whereas for light tailed data the index should be chosen closer to 0.
</p>


<h3>Value</h3>

<p>A list with class 'shapeNA' containing the following components:
</p>

<dl>
<dt>S</dt><dd><p>The estimated shape matrix.</p>
</dd>
<dt>scale</dt><dd><p>The scale with which the shape matrix may be scaled to obtain
a scatter estimate. If <code>alpha</code> = 1, then this value will be <code>NA</code>, as
Tyler's shape matrix has no natural scale.</p>
</dd>
<dt>mu</dt><dd><p>The location parameter, either provided by the user or estimated.</p>
</dd>
<dt>alpha</dt><dd><p>The tail index with which the Power M-estimator has been called.</p>
</dd>
<dt>naBlocks</dt><dd><p>An <code>naBlocks</code> object, with information about the missingness
of the data.</p>
</dd>
<dt>iterations</dt><dd><p>Number of computed iterations before convergence.</p>
</dd>
<dt>call</dt><dd><p>The matched call.</p>
</dd>
</dl>



<h3>References</h3>

<p>Frahm, G., &amp; Jaekel, U. (2010). A generalization of Tyler's M-estimators to the case of incomplete data. Computational Statistics &amp; Data Analysis, 54, 374-393. doi: <a href="https://doi.org/10.1016/j.csda.2009.08.019">10.1016/j.csda.2009.08.019</a>.
</p>
<p>Frahm, G., Nordhausen, K., &amp; Oja, H. (2020). M-estimation with incomplete and dependent multivariate data. Journal of Multivariate Analysis, 176, 104569. doi: <a href="https://doi.org/10.1016/j.jmva.2019.104569">10.1016/j.jmva.2019.104569</a>.
</p>
<p>Hettmansperger, T. P., &amp; Randles, R. H. (2002). A practical affine equivariant multivariate median. Biometrika, 89(4), 851-860. doi: <a href="https://doi.org/10.1093/biomet/89.4.851">10.1093/biomet/89.4.851</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+powerShape">powerShape</a>, <a href="#topic+tylerShape">tylerShape</a> and <a href="#topic+classicShape">classicShape</a> for the
corresponding functions for data without missing values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    ## Generate a data set with missing values
    x &lt;- mvtnorm::rmvt(100, toeplitz(seq(1, 0.1, length.out = 3)), df = 5)
    y &lt;- mice::ampute(x, mech = 'MCAR')$amp

    ## Compute some M-estimators
    res0 &lt;- classicShapeNA(y, center = c(0, 0, 0))
    res1 &lt;- powerShapeNA(y, alpha = 0.67, normalization = 'one')
    res2 &lt;- tylerShapeNA(y, normalization = 'trace')

    ## Get location estimates
    res1$mu
    res2$mu
    ## Get shape estimates
    res0$S
    res1$S
    res2$S

    ## Print summary
    summary(res0)
    ## Inspect missingness pattern
    plot(res0$naBlocks)
    barplot(res0)
</code></pre>

<hr>
<h2 id='print.naBlocks'>Print Missingness Pattern</h2><span id='topic+print.naBlocks'></span>

<h3>Description</h3>

<p>Print the pattern of missingness in the supplied data, as a block matrix.
Observed data are represented by 1, missing values by 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'naBlocks'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.naBlocks_+3A_x">x</code></td>
<td>
<p>An <code>naBlocks</code> object.</p>
</td></tr>
<tr><td><code id="print.naBlocks_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code><a href="base.html#topic+print">print</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first row shows the column names. The leftmost column, without column
name, shows the number of rows per block and the rightmost column with name
<code style="white-space: pre;">&#8288;#&#8288;</code> shows the number of observed variables in the block.
</p>


<h3>Value</h3>

<p>A named matrix representing the missingness pattern of the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    x &lt;- mvtnorm::rmvt(100, toeplitz(seq(1, 0.1, length.out = 3)), df = 5)
    y &lt;- mice::ampute(x, mech='MCAR')$amp
    res &lt;- classicShapeNA(y)
    print(res$naBlocks)
</code></pre>

<hr>
<h2 id='print.shapeNA'>Print Method for Objects of Class <code>shapeNA</code></h2><span id='topic+print.shapeNA'></span>

<h3>Description</h3>

<p>Prints the chosen value of <code>alpha</code> as well as the estimated shape and
location for objects of class <code>shapeNA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapeNA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.shapeNA_+3A_x">x</code></td>
<td>
<p>A <code>shapeNA</code> object</p>
</td></tr>
<tr><td><code id="print.shapeNA_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to lower level <code><a href="base.html#topic+print">print</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    x &lt;- mvtnorm::rmvt(100, toeplitz(seq(1, 0.1, length.out = 3)), df = 5)
    res &lt;- tylerShape(x)
    res ## equivalent to call print(res)
</code></pre>

<hr>
<h2 id='print.summary.shapeNA'>Print Method for Class <code>summary.shapeNA</code></h2><span id='topic+print.summary.shapeNA'></span>

<h3>Description</h3>

<p>Print Method for Class <code>summary.shapeNA</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.shapeNA'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.shapeNA_+3A_x">x</code></td>
<td>
<p>Object returned from <code><a href="#topic+summary.shapeNA">summary.shapeNA</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.shapeNA_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    obj &lt;- tylerShape(mvtnorm::rmvt(100, diag(3)))
    print(summary(obj))
</code></pre>

<hr>
<h2 id='shape2scatter'>Scatter Estimates from <code>shapeNA</code> Objects</h2><span id='topic+shape2scatter'></span>

<h3>Description</h3>

<p>For Power M-estimates with tail index <code>alpha &lt; 1</code>, the resulting estimate
has a scale. For these shape estimates, scatter matrices can be computed.
Results from
<code><a href="#topic+tylerShape">tylerShape</a></code> and <code><a href="#topic+tylerShapeNA">tylerShapeNA</a></code> give no scatter
estimates. In these cases the function returns <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape2scatter(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shape2scatter_+3A_obj">obj</code></td>
<td>
<p><code>shapeNA</code> object, resulting from a call to
<code><a href="#topic+powerShape">powerShape</a></code> and other functions from the same family.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scatter matrix estimate, or only <code>NA</code> if <code>alpha</code> = 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    S &lt;- toeplitz(c(1, 0.3, 0.7))
    set.seed(123)
    x &lt;- mvtnorm::rmvt(100, S, df = 3)
    obj_det &lt;- powerShape(x, alpha = 0.85, normalization = 'det')
    shape2scatter(obj_det)
    obj_tr &lt;- powerShape(x, alpha = 0.85, normalization = 'trace')
    shape2scatter(obj_tr)
    obj_one &lt;- powerShape(x, alpha = 0.85, normalization = 'one')
    shape2scatter(obj_one)
</code></pre>

<hr>
<h2 id='summary.shapeNA'>Summary Method for Class <code>shapeNA</code></h2><span id='topic+summary.shapeNA'></span>

<h3>Description</h3>

<p>Summary methods for objects from class <code>shapeNA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shapeNA'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.shapeNA_+3A_object">object</code></td>
<td>
<p>An object of class <code>shapeNA</code>, usually from a call to
<code><a href="#topic+powerShape">powerShape</a></code> or similar functions.</p>
</td></tr>
<tr><td><code id="summary.shapeNA_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>summary.shapeNA</code> object. For objects of this class, the <code>print</code>
method tries to format the location and shape estimate in a readable format
and also shows the number of iterations, before the algorithm converged.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    obj &lt;- tylerShape(mvtnorm::rmvt(100, diag(3)))
    summary(obj)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
