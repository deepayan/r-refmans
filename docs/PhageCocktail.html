<!DOCTYPE html><html><head><title>Help for package PhageCocktail</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PhageCocktail}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PhageCocktail'><p>Design of the Best Phage Cocktail</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design of the Best Phage Cocktail</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>There are 4 possible methods: "ExhaustiveSearch"; "ExhaustivePhi";    "ClusteringSearch"; and "ClusteringPhi". 
    "ExhaustiveSearch"&ndash;&gt; gives you the best phage cocktail from a phage-bacteria
	infection network. It checks different phage cocktail sizes from 1 to 7 and
	only stops before if it lyses all bacteria. Other option is when users have
	decided not to obtain a phage cocktail size higher than a limit value.
    "ExhaustivePhi"&ndash;&gt; firstly, it finds Phi out. Phi is a formula
	indicating the necessary phage cocktail size. Phi needs nestedness temperature
	and fill, which are internally calculated. This function will only look for the
	best combination (phage cocktail) with a Phi size.
    "ClusteringSearch"&ndash;&gt; firstly, an agglomerative hierarchical clustering using
	Ward's algorithm is calculated for phages. They will be clustered according to
	bacteria lysed by them. PhageCocktail() chooses how many clusters are needed in
	order to select 1 phage per cluster. Using the phages selected during the
	clustering, it checks different phage cocktail sizes from 1 to 7 and only stops
	before if it lyses all bacteria. Other option is when users have decided not to
	obtain a phage cocktail size higher than a limit value.
    "ClusteringPhi"&ndash;&gt; firstly, an agglomerative hierarchical clustering using Ward's
	algorithm is calculated for phages. They will be clustered according to bacteria
	lysed by them. PhageCocktail() chooses how many clusters are needed in order to
	select 1 phage per cluster. Once the function has one phage per cluster, it
	calculates Phi. If the number of clusters is less than Phi number, it will be
	changed to obtain, as minimum, this quantity of candidates (phages). Then, it
	calculates the best combination of Phi phages using those selected during the
	clustering with Ward algorithm.
	  If you use PhageCocktail, please cite it as:
  "PhageCocktail: An R Package to Design Phage Cocktails from Experimental 
  Phage-Bacteria Infection Networks". María Victoria Díaz-Galián, Miguel A. 
  Vega-Rodríguez, Felipe Molina. Computer Methods and Programs in Biomedicine,
  221, 106865, Elsevier Ireland, Clare, Ireland, 2022, pp. 1-9, ISSN: 0169-2607.
  &lt;<a href="https://doi.org/10.1016%2Fj.cmpb.2022.106865">doi:10.1016/j.cmpb.2022.106865</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>readxl, stringr, factoextra, bipartite, smerc, RJSONIO</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1.9001</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-13 21:16:35 UTC; MVDia</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria Victoria Diaz-Galian
    <a href="https://orcid.org/0000-0003-2543-6081"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Miguel A. Vega-Rodriguez
    <a href="https://orcid.org/0000-0002-3003-758X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Felipe Molina <a href="https://orcid.org/0000-0002-9167-7097"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria Victoria Diaz-Galian &lt;mvdiazgalian@unex.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-13 21:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PhageCocktail'>Design of the Best Phage Cocktail</h2><span id='topic+PhageCocktail'></span>

<h3>Description</h3>

<p>It gives you the best phage cocktail which lyses the maximum
number of bacteria.
</p>
<p>There are 4 possible methods within the function PhageCocktail():
&quot;ExhaustiveSearch&quot;; &quot;ExhaustivePhi&quot;; &quot;ClusteringSearch&quot;; and &quot;ClusteringPhi&quot;.
</p>
<p><code class="reqn">"ExhaustiveSearch"</code> gives you the best phage cocktail from a
phage bacteria infection network. It checks different phage cocktail sizes
from 1 to 7 and only stops before if it lyses all bacteria. Other option is
when users have decided not to obtain a phage cocktail size higher than a limit
value.
</p>
<p><code class="reqn">"ExhaustivePhi"</code> firstly, the function PhageCoctail() finds Phi out. Phi is
a formula indicating the necessary phage cocktail size [Molina et al. (2021)
doi: <a href="https://doi.org/10.3389/fmicb.2021.564532">10.3389/fmicb.2021.564532</a>]. Phi needs nestedness temperature and fill
[Molina et al. (2021)doi: <a href="https://doi.org/10.3389/fmicb.2021.564532">10.3389/fmicb.2021.564532</a>][Rodríguez Gironés et al.
(2006) doi: <a href="https://doi.org/10.1111/j.1365-2699.2006.01444.x">10.1111/j.1365-2699.2006.01444.x</a>],
which are internally calculated. This method will only look for the best
combination (phage cocktail) with a Phi size.
</p>
<p><code class="reqn">"ClusteringSearch"</code> firstly, an agglomerative hierarchical clustering
using Ward's algorithm is calculated for phages [Strauss et al. (2017)
doi: <a href="https://doi.org/10.1371/journal.pone.0168288">10.1371/journal.pone.0168288</a>]. They will be clustered according to
bacteria lysed by them. 'PhageCocktail' chooses how many clusters are needed in
order to select 1 phage per cluster [Kodinariya et al. (2013)].
Using the phages selected during the clustering, it checks different phage
cocktail sizes from 1 to 7 and only stops before if it lyses all bacteria. Other
option is when users have decided not to obtain a phage cocktail size higher
than a limit value.
</p>
<p><code class="reqn">"ClusteringPhi"</code> firstly, an agglomerative hierarchical clustering using
Ward's algorithm is calculated for phages
[Strauss et al. (2017) doi: <a href="https://doi.org/10.1371/journal.pone.0168288">10.1371/journal.pone.0168288</a>]. They will be
clustered according to bacteria lysed by them. 'PhageCocktail' chooses how many
clusters are needed in order to select 1 phage per cluster [Kodinariya et al.
(2013)]. Once the function (PhageCocktail()) has one phage per cluster, it
calculates Phi [Molina et al. (2021) doi: <a href="https://doi.org/10.3389/fmicb.2021.564532">10.3389/fmicb.2021.564532</a>]. If the
number of clusters is less than Phi number, it will be changed to obtain, as
minimum, this quantity of candidates (phages). Then, it calculates the best
combination of Phi phages using those selected during the clustering with Ward
algorithm.
</p>
<p>If you use PhageCocktail, please cite it as:
&quot;PhageCocktail: An R Package to Design Phage Cocktails from Experimental
Phage-Bacteria Infection Networks&quot;. María Victoria Díaz-Galián, Miguel A.
Vega-Rodríguez, Felipe Molina. Computer Methods and Programs in Biomedicine,
Volume 221, 106865, Elsevier Ireland, Clare, Ireland, 2022, pp. 1-9,
ISSN: 0169-2607.
doi: <a href="https://doi.org/10.1016/j.cmpb.2022.106865">10.1016/j.cmpb.2022.106865</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default method:
PhageCocktail(pathway,FUN="ClusteringSearch",file.output=FALSE,
file.name="output.txt",limit=7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhageCocktail_+3A_pathway">pathway</code></td>
<td>
<p>string with the input file pathway. The input file must be in
.xlsx format and must contain one PhageBacteria Infection Network (PBIN). This
PBIN must be in matrix format, that is, the input file must have only one sheet
with a matrix, whose rows are the bacteria and whose columns are the phages. It
is important to say that the first row must be devoted to the names/codes of the
phages. In the same way, the first column must be devoted to the names/codes of
the bacteria. Only the values 0 and 1 are considered to reflect the infection
relationship between involved phages and bacteria (0 = does not lyse and 1 =
lyses). In this way, the infection relationship can be represented by the names
of phages and bacteria, and by the position of the value (0 or 1) in the matrix.</p>
</td></tr>
<tr><td><code id="PhageCocktail_+3A_fun">FUN</code></td>
<td>
<p>string indicating the function/method to execute:
<code class="reqn">"ExhaustiveSearch"</code>
;<code class="reqn">"ExhaustivePhi"</code>;<code class="reqn">"ClusteringSearch"</code> (default option)
;<code class="reqn">"ClusteringPhi"</code>.</p>
</td></tr>
<tr><td><code id="PhageCocktail_+3A_file.output">file.output</code></td>
<td>
<p>logical. If <code class="reqn">FALSE</code> (default option), the program
will not create an output file. If <code class="reqn">TRUE</code>, the program will write a file with
the results.</p>
</td></tr>
<tr><td><code id="PhageCocktail_+3A_file.name">file.name</code></td>
<td>
<p>string with the filename of the output file. Default option
is &quot;output.txt&quot;</p>
</td></tr>
<tr><td><code id="PhageCocktail_+3A_limit">limit</code></td>
<td>
<p>Positive integer number indicating maximum phage cocktail size
desired.
The range of options is: (1:7). Default option is 7. It is desirable to use
limit when the number of phages and/or bacteria is extremely high.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>$file</code></td>
<td>
<p>string indicating the input file used.</p>
</td></tr>
<tr><td><code>$method</code></td>
<td>
<p>string indicating the function chosen.</p>
</td></tr>
<tr><td><code>$maxCocktailSize</code></td>
<td>
<p>integer. Maximum phage cocktail size.</p>
</td></tr>
<tr><td><code>$allBacteriaLysed</code></td>
<td>
<p>logical. If TRUE indicates that the set of phages
lyses all bacteria. If FALSE, not all bacteria are lysed by the phage
cocktail.</p>
</td></tr>
<tr><td><code>$Result</code></td>
<td>
<p>dataframe composed of the information of each phage
cocktail size (phage cocktail and number of bacteria lysed) and the list
of lysed bacteria.
</p>
<p>An example (&quot;ClusteringPhi&quot;):
</p>
<p>&quot;Result&quot;: 
</p>
<p>&quot;Size3&quot;: [ &quot;SajbenNagyP16&quot;, &quot;SajbenNagyP3&quot;, &quot;SajbenNagyP10&quot;, &quot;18&quot; ]
,
</p>
<p>&quot;BacteriaLysed&quot;: 
</p>
<p>&quot;Size3&quot;: [ &quot;SajbenNagyB1&quot;, &quot;SajbenNagyB2&quot;, &quot;SajbenNagyB3&quot;, &quot;SajbenNagyB4&quot;,
&quot;SajbenNagyB5&quot;, &quot;SajbenNagyB6&quot;, &quot;SajbenNagyB10&quot;, &quot;SajbenNagyB11&quot;, &quot;Sajben
NagyB13&quot;, &quot;SajbenNagyB15&quot;, &quot;SajbenNagyB16&quot;, &quot;SajbenNagyB18&quot;, &quot;Sajben
NagyB19&quot;, &quot;SajbenNagyB23&quot;, &quot;SajbenNagyB24&quot;, &quot;SajbenNagyB30&quot;, &quot;Sajben
NagyB31&quot;, &quot;SajbenNagyB32&quot; ]

</p>
<p>As it is an output of executing &quot;ClusteringPhi&quot;, there is only one phage
cocktail.
The meaning is that the best Phage Cocktail of three phages is composed by
&quot;Sajben-NagyP16&quot;, &quot;Sajben-NagyP3&quot; and &quot;Sajben-NagyP10&quot; lysing 18 bacteria
shown in the list called &quot;BacteriaLysed&quot;.
</p>
</td></tr>
<tr><td><code>$non_usefulPhages</code></td>
<td>
<p>vector of phages removed because they do not lyse
any bacterium. If all of them lyse some bacterium, this message will appear:
&quot;All the phages are useful (all of them lyse some bacterium)&quot;</p>
</td></tr>
<tr><td><code>$non_lysedBacteria</code></td>
<td>
<p>vector of bacteria not lysed by any phage. If
there is no one, this message will appear: &quot;All the bacteria are lysed by
some phage&quot;</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Díaz-Galián, María Victoria <a href="mailto:mvdiazgalian@unex.es">mvdiazgalian@unex.es</a>
</p>
<p>Vega-Rodríguez, Miguel A. <a href="mailto:mavega@unex.es">mavega@unex.es</a>
</p>
<p>Molina, Felipe <a href="mailto:fmolina@unex.es">fmolina@unex.es</a>
</p>
<p>University of Extremadura, Spain
</p>


<h3>References</h3>

<p>**If you use PhageCocktail, please cite it as:
</p>
<p>&quot;PhageCocktail: An R Package to Design Phage Cocktails from Experimental
Phage-Bacteria Infection Networks&quot;. María Victoria Díaz-Galián, Miguel A.
Vega-Rodríguez, Felipe Molina. Computer Methods and Programs in Biomedicine,
Volume 221, 106865, Elsevier Ireland, Clare, Ireland, 2022, pp. 1-9,
ISSN: 0169-2607.
doi: <a href="https://doi.org/10.1016/j.cmpb.2022.106865">10.1016/j.cmpb.2022.106865</a>
</p>
<p>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;
</p>
<p>Molina, F., Simancas, A., Ramírez, M., Tabla, R., Roa, I., &amp; Rebollo, J. E.
(2021). A new pipeline for designing phage cocktails based on phage-bacteria
infection networks. Frontiers in Microbiology, 12, 149.
doi: <a href="https://doi.org/10.3389/fmicb.2021.564532">10.3389/fmicb.2021.564532</a>
</p>
<p>Strauss, T., &amp; von Maltitz, M. J. (2017). Generalising Ward's method for use
with Manhattan distances. PloS ONE, 12(1), e0168288.
doi: <a href="https://doi.org/10.1371/journal.pone.0168288">10.1371/journal.pone.0168288</a>
</p>
<p>Rodríguez Gironés, M. A., &amp; Santamaría, L. (2006). A new algorithm to
calculate the nestedness temperature of presence–absence matrices.
Journal of Biogeography, 33(5), 924-935.
doi: <a href="https://doi.org/10.1111/j.1365-2699.2006.01444.x">10.1111/j.1365-2699.2006.01444.x</a>
</p>
<p>Kodinariya, T. M., &amp; Makwana, P. R. (2013). Review on determining number of
cluster in K-means clustering. International Journal of Advance
Research in Computer Science and Management Studies, 1(6), 90-95.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(readxl)
x&lt;-system.file("extdata","Sajben-Nagy.xlsx",package="PhageCocktail",mustWork=TRUE)


PhageCocktail(x,"ExhaustiveSearch")

PhageCocktail(x,"ExhaustivePhi")



  #If the number of phages and/or bacteria is extremely high, it is
  #recommended to use limit option starting by 1 for "ExhaustiveSearch"
  #avoiding that the result takes too much time. If process took a short
  #period of time and it was desirable to test with a higher number of
  #phages, it could be done.

PhageCocktail(x,"ExhaustiveSearch",limit=1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
