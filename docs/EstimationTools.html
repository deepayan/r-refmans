<!DOCTYPE html><html><head><title>Help for package EstimationTools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EstimationTools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bootstrap_maxlogL'><p>Bootstrap computation of standard error for <code>maxlogL</code> class objects.</p></a></li>
<li><a href='#coef.maxlogL'><p>Extract Model Coefficients in a <code>maxlogL</code> Fits</p></a></li>
<li><a href='#Fibers'><p>Tensile strengths</p></a></li>
<li><a href='#formula2Surv'><p>Internal functions for formula and data handle</p></a></li>
<li><a href='#gauss_quad'><p>Numerical integration through Gaussian Quadrature</p></a></li>
<li><a href='#half_norm_key'><p>Half normal key function</p></a></li>
<li><a href='#hazard_fun'><p>Hazard functions in <code>maxlogL</code> framework</p></a></li>
<li><a href='#hazard_rate_key'><p>Hazard rate key function</p></a></li>
<li><a href='#Hazard_Shape'><p>Hazard shape extracted from <code>HazardShape</code> objects</p></a></li>
<li><a href='#integration'><p>Integration</p></a></li>
<li><a href='#interp.options'><p>Configure various aspects of interpolating function in <code>TTT_hazard_shape</code></p></a></li>
<li><a href='#is.maxlogL'><p>Is return of any object of <code>EstimationTools</code>?</p></a></li>
<li><a href='#legend.HazardShape'><p>Customize legend for <code>plot.HazardShape</code> outputs</p></a></li>
<li><a href='#loess.options'><p>Configure various aspects of LOESS in <code>TTT_hazard_shape</code></p></a></li>
<li><a href='#log_link'><p>Logarithmic link function (for estimation with <code>maxlogL</code> object)</p></a></li>
<li><a href='#logit_link'><p>Logit link function (for estimation with <code>maxlogL</code> object)</p></a></li>
<li><a href='#maxlogL'><p>Maximum Likelihood Estimation for parametric distributions</p></a></li>
<li><a href='#maxlogLreg'><p>Maximum Likelihood Estimation for parametric linear regression models</p></a></li>
<li><a href='#NegInv_link'><p>Negative inverse link function (for estimation with <code>maxlogL</code> object)</p></a></li>
<li><a href='#plot.EmpiricalTTT'><p>Plot method for <code>EmpiricalTTT</code> objects</p></a></li>
<li><a href='#plot.HazardShape'><p>Plot of <code>HazardShape</code> objects</p></a></li>
<li><a href='#predict.maxlogL'><p>Predict Method for <code>maxlogL</code> Fits</p></a></li>
<li><a href='#print.HazardShape'><p>Print method for <code>HazardShape</code> objects</p></a></li>
<li><a href='#reduction_cells'><p>Reduction cells</p></a></li>
<li><a href='#residuals.maxlogL'><p>Extract Residuals from <code>maxlogL</code> model.</p></a></li>
<li><a href='#summary.maxlogL'><p>Summarize Maximum Likelihood Estimation</p></a></li>
<li><a href='#summate'><p>Summation of One-Dimensional Functions</p></a></li>
<li><a href='#TTT_hazard_shape'><p>Hazard Shape estimation from TTT plot</p></a></li>
<li><a href='#TTTE_Analytical'><p>Empirical Total Time on Test (TTT), analytic version.</p></a></li>
<li><a href='#uniform_key'><p>Uniform key function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Estimation for Probability Functions from
Data Sets</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), survival, DEoptim, BBmisc, GA, gaussquad</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack, utils, stats, numDeriv, boot, autoimage, graphics,
stringr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>gamlss.dist, knitr, rmarkdown, AdequacyModel, readr, covr,
testthat (&ge; 3.0.0), vdiffr, spelling, lifecycle, matrixStats,
lintr, V8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, utils</td>
</tr>
<tr>
<td>Description:</td>
<td>Total Time on Test plot and routines for parameter estimation of
    any lifetime distribution implemented in R via maximum likelihood (ML) given
    a data set. It is implemented thinking on parametric survival analysis, but
    it feasible to use in parameter estimation of probability density or mass
    functions in any field. The main routines 'maxlogL' and 'maxlogLreg' are
    wrapper functions specifically developed for ML estimation. There are
    included optimization procedures such as 'nlminb' and 'optim' from base
    package, and 'DEoptim' Mullen (2011) &lt;<a href="https://doi.org/10.18637%2Fjss.v040.i06">doi:10.18637/jss.v040.i06</a>&gt;. Standard
    errors are estimated with 'numDeriv' Gilbert (2011)
    <a href="https://CRAN.R-project.org/package=numDeriv">https://CRAN.R-project.org/package=numDeriv</a> or the option 'Hessian = TRUE'
    of 'optim' function.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jaimemosg.github.io/EstimationTools/">https://jaimemosg.github.io/EstimationTools/</a>,
<a href="https://github.com/Jaimemosg/EstimationTools">https://github.com/Jaimemosg/EstimationTools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Jaimemosg/EstimationTools/issues">https://github.com/Jaimemosg/EstimationTools/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-10 00:45:00 UTC; jaime</td>
</tr>
<tr>
<td>Author:</td>
<td>Jaime Mosquera <a href="https://orcid.org/0000-0002-1684-4756"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Freddy Hernandez <a href="https://orcid.org/0000-0001-7459-3329"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jaime Mosquera &lt;jmosquerag@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-10 07:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bootstrap_maxlogL'>Bootstrap computation of standard error for <code>maxlogL</code> class objects.</h2><span id='topic+bootstrap_maxlogL'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>bootstrap_maxlogL</code> computes standard errors of
<code><a href="#topic+maxlogL">maxlogL</a></code> class objects by non-parametric bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_maxlogL(object, R = 2000, silent = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_maxlogL_+3A_object">object</code></td>
<td>
<p>an object of <code><a href="#topic+maxlogL">maxlogL</a></code> class whose standard errors
are going to be computed by bootstrap.</p>
</td></tr>
<tr><td><code id="bootstrap_maxlogL_+3A_r">R</code></td>
<td>
<p>numeric. It is the number of resamples performed with the dataset
in bootstrap computation. Default value is 2000.</p>
</td></tr>
<tr><td><code id="bootstrap_maxlogL_+3A_silent">silent</code></td>
<td>
<p>logical. If TRUE, notifications of <code>bootstrap_maxlogL</code> are suppressed.</p>
</td></tr>
<tr><td><code id="bootstrap_maxlogL_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="boot.html#topic+boot">boot</a></code> used in this routine
for estimation of standard errors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computation performed by this function may be
invoked when Hessian from <code><a href="stats.html#topic+optim">optim</a></code> and
<code><a href="numDeriv.html#topic+hessian">hessian</a></code> fail in  <code><a href="#topic+maxlogL">maxlogL</a></code> or
in <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>.
</p>
<p>However, this function can be run even if Hessian matrix calculation
does not fails. In this case, standard errors in the <code><a href="#topic+maxlogL">maxlogL</a></code>
class object is replaced.
</p>


<h3>Value</h3>

<p>A modified object of class <code>maxlogL</code>.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Canty A, Ripley BD (2017).
<em>boot: Bootstrap R (S-Plus) Functions</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxlogL">maxlogL</a></code>, <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>, <code><a href="boot.html#topic+boot">boot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# First example: Comparison between standard error computation via Hessian matrix
# and standard error computation via bootstrap

N &lt;- rbinom(n = 100, size = 10, prob = 0.3)
phat1 &lt;- maxlogL(x = N, dist = 'dbinom', fixed = list(size = 10),
                link = list(over = "prob", fun = "logit_link"))

## Standard error computation method and results
print(phat1$outputs$StdE_Method)   # Hessian
summary(phat1)

## 'bootstrap_maxlogL' implementation
phat2 &lt;- phat1                   # Copy the first 'maxlogL' object
bootstrap_maxlogL(phat2, R = 100)

## Standard error computation method and results
print(phat2$outputs$StdE_Method)   # Bootstrap
summary(phat2)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='coef.maxlogL'>Extract Model Coefficients in a <code>maxlogL</code> Fits</h2><span id='topic+coef.maxlogL'></span><span id='topic+oefficients'></span><span id='topic+coefMany'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p><code>coef.maxlogL</code> is the specific method for the generic function <code>coef</code>
which extracts model coefficients from objects returned by <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>.
<code>coefficients</code> is an alias for <code>coef</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'maxlogL'
coef(object, parameter = object$outputs$par_names, ...)

coefMany(object, parameter = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.maxlogL_+3A_object">object</code></td>
<td>
<p>an object of <code>maxlogL</code> class generated by <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>
function.</p>
</td></tr>
<tr><td><code id="coef.maxlogL_+3A_parameter">parameter</code></td>
<td>
<p>a character which specifies the parameter is required. In
<code>coefMany</code> this argument can be an atomic vector
with two or more names of parameters.</p>
</td></tr>
<tr><td><code id="coef.maxlogL_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector with coefficients of the specified distribution parameter.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# Example 1: coefficients from a model using a simulated normal distribution
n &lt;- 1000
x &lt;- runif(n = n, -5, 6)
y &lt;- rnorm(n = n, mean = -2 + 3 * x, sd = exp(1 + 0.3* x))
norm_data &lt;- data.frame(y = y, x = x)

# It does not matter the order of distribution parameters
formulas &lt;- list(sd.fo = ~ x, mean.fo = ~ x)

norm_mod &lt;- maxlogLreg(formulas, y_dist = y ~ dnorm, data = norm_data,
                       link = list(over = "sd", fun = "log_link"))
coef(norm_mod)
coef(norm_mod, parameter = 'sd')
a &lt;- coefMany(norm_mod, parameter = c('mean', 'sd'))
b &lt;- coefMany(norm_mod)
identical(a, b)


#--------------------------------------------------------------------------------
# Example 2: Parameters in estimation with one fixed parameter
x &lt;- rnorm(n = 10000, mean = 160, sd = 6)
theta_1 &lt;- maxlogL(x = x, dist = 'dnorm', control = list(trace = 1),
                 link = list(over = "sd", fun = "log_link"),
                 fixed = list(mean = 160))
coef(theta_1)


#--------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='Fibers'>Tensile strengths</h2><span id='topic+Fibers'></span>

<h3>Description</h3>

<p>Tensile strengths (in GPa) of 69 specimens of carbon fiber tested under tension
at gauge lengths of 20 mm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fibers
</code></pre>


<h3>Format</h3>

<p>A data frame with 69 observations.
</p>


<h3>References</h3>

<p>Ghitany ME, Al-Mutairi DK, Balakrishnan N, Al-Enezi LJ (2013).
&ldquo;Power Lindley distribution and associated inference.&rdquo;
<em>Computational Statistics and Data Analysis</em>, <b>64</b>, 20&ndash;33.
ISSN 01679473, <a href="https://doi.org/10.1016/j.csda.2013.02.026">doi:10.1016/j.csda.2013.02.026</a>, <a href="http://dx.doi.org/10.1016/j.csda.2013.02.026">http://dx.doi.org/10.1016/j.csda.2013.02.026</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Fibers)
hist(Fibers$Strenght, main="", xlab="Strength (GPa)")

</code></pre>

<hr>
<h2 id='formula2Surv'>Internal functions for formula and data handle</h2><span id='topic+formula2Surv'></span><span id='topic+fo_and_data'></span><span id='topic+extract_fun_args'></span><span id='topic+saturated_maxlogL'></span><span id='topic+null_maxlogL'></span>

<h3>Description</h3>

<p>Utility functions useful for passing data from functions
inside others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula2Surv(model_frame)

fo_and_data(y, fo, model_frame, data, fo2Surv = TRUE)

extract_fun_args(fun, exclude, ...)

saturated_maxlogL(object, silent = TRUE)

null_maxlogL(object, silent = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula2Surv_+3A_model_frame">model_frame</code></td>
<td>
<p>a model frame build internally in some functions on
<strong>EstimationTools</strong> package</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>

<hr>
<h2 id='gauss_quad'>Numerical integration through Gaussian Quadrature</h2><span id='topic+gauss_quad'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This family of functions use quadratures for solving integrals. The user can
create a custom integration routine, see <em>details</em> for further
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gauss_quad(
  fun,
  lower,
  upper,
  kind = "legendre",
  n = 10,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gauss_quad_+3A_fun">fun</code></td>
<td>
<p>an <strong>R</strong> function which should take a numeric argument x and
possibly some parameters. The function returns a numerical vector
value for the given argument <code>x</code>.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_lower">lower</code></td>
<td>
<p>a numeric value for the lower limit of the integral.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_upper">upper</code></td>
<td>
<p>a numeric value for the upper limit of the integral.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_kind">kind</code></td>
<td>
<p>character specifying the weight (polynomial) function for the
quadrature.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_n">n</code></td>
<td>
<p>integer with the highest order of the polynomial of the selected
rule.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_normalized">normalized</code></td>
<td>
<p>logical. If TRUE, rules are for orthonormal polynomials,
otherwise they are for orthogonal polynomials.</p>
</td></tr>
<tr><td><code id="gauss_quad_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>fun</code> and to the
quadrature routine specified in argument <code>kind</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gauss_quad</code> uses the implementation of Gaussian quadratures from
<strong>gaussquad</strong> package.This is a wrapper that implements <code>rules</code>
and integration routine in the same place.
</p>


<h3>Value</h3>

<p>The value of the integral of the function specified in <code>fun</code>
argument.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="gaussquad.html#topic+laguerre.quadrature">laguerre.quadrature</a></code>,
<code><a href="gaussquad.html#topic+legendre.quadrature">legendre.quadrature</a></code>,
<code><a href="gaussquad.html#topic+chebyshev.c.quadrature">chebyshev.c.quadrature</a></code>,
<code><a href="gaussquad.html#topic+gegenbauer.quadrature">gegenbauer.quadrature</a></code>,
<code><a href="gaussquad.html#topic+hermite.h.quadrature">hermite.h.quadrature</a></code>, etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example 1: Mean of X ~ N(2,1) (Gauss-Hermitie quadrature).
g &lt;- function(x, mu, sigma) sqrt(2)*sigma*x + mu
i2 &lt;- gauss_quad(g, lower = -Inf, upper = Inf, kind = 'hermite.h',
                 normalized = FALSE, mu = 2, sigma = 1)
i2 &lt;- i2/sqrt(pi)
i2


#----------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='half_norm_key'>Half normal key function</h2><span id='topic+half_norm_key'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function provides the half normal key function for model fitting in
distance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>half_norm_key(x, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="half_norm_key_+3A_x">x</code></td>
<td>
<p>vector of perpendicular distances from the transect.</p>
</td></tr>
<tr><td><code id="half_norm_key_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the half normal key function with parameter
<code>sigma</code>. Its expression is given by
</p>
<p><code class="reqn">g(x) = \exp(\frac{-x^2}{2*\sigma^2},</code>
</p>
<p>for x &gt; 0.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to a given value of <code>x</code> and
<code>sigma</code>.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p>Other key functions: 
<code><a href="#topic+hazard_rate_key">hazard_rate_key</a>()</code>,
<code><a href="#topic+uniform_key">uniform_key</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example: Half normal function
half_norm_key(x=1, sigma=4.1058)
curve(half_norm_key(x, sigma=4.1058), from=0, to=20, ylab='g(x)')

#----------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='hazard_fun'>Hazard functions in <code>maxlogL</code> framework</h2><span id='topic+hazard_fun'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function takes the name of a probability density/mass function as an
argument and creates a hazard function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hazard_fun(dist, support)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard_fun_+3A_dist">dist</code></td>
<td>
<p>a length-one character vector with the name of density/mass function
of interest.</p>
</td></tr>
<tr><td><code id="hazard_fun_+3A_support">support</code></td>
<td>
<p>a list with the following entries:
</p>

<ul>
<li> <p><code>interval</code>: a two dimensional atomic vector indicating the
set of possible values of a random variable having the
distribution specified in <code>y_dist</code>.
</p>
</li>
<li> <p><code>type</code>: character indicating if distribution has a
<code>discrete</code> or a <code>continous</code> random variable.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A function with the folling input arguments:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>vector of (non-negative) quantiles.</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Arguments of the probability density/mass function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p>Other maxlogL: 
<code><a href="#topic+maxlogLreg">maxlogLreg</a>()</code>,
<code><a href="#topic+maxlogL">maxlogL</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# Example 1: Hazard function of Weibull distribution.
hweibull1 &lt;- hazard_fun('dweibull', list(interval=c(0, Inf), type='continuous'))
hweibull2 &lt;- function(x){
  ans &lt;- dweibull(x, shape = 2, scale = 1)/
    pweibull(x, shape = 2, scale = 1, lower.tail = FALSE)
  ans
}
hweibull1(0.2, shape = 2, scale = 1)
hweibull2(0.2)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='hazard_rate_key'>Hazard rate key function</h2><span id='topic+hazard_rate_key'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function provides the hazard rate key function for model fitting in
distance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hazard_rate_key(x, sigma, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard_rate_key_+3A_x">x</code></td>
<td>
<p>vector of perpendicular distances from the transect.</p>
</td></tr>
<tr><td><code id="hazard_rate_key_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter.</p>
</td></tr>
<tr><td><code id="hazard_rate_key_+3A_beta">beta</code></td>
<td>
<p>shape parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the hazard rate key function with parameters
<code>sigma</code> and <code>beta</code>. Its expression is given by
</p>
<p><code class="reqn">g(x) = 1 - \exp((\frac{-x}{\sigma})^{-\beta},</code>
</p>
<p>for x &gt; 0.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to a given value of <code>x</code>,
<code>sigma</code> and <code>beta</code>.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p>Other key functions: 
<code><a href="#topic+half_norm_key">half_norm_key</a>()</code>,
<code><a href="#topic+uniform_key">uniform_key</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example: Hazard rate function
hazard_rate_key(x=1, sigma=2, beta=3)
curve(hazard_rate_key(x, sigma=2, beta=3), from=0, to=10, ylab='g(x)')

#----------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='Hazard_Shape'>Hazard shape extracted from <code>HazardShape</code> objects</h2><span id='topic+Hazard_Shape'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>This function displays the estimated hazard shape given a
data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hazard_Shape(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hazard_Shape_+3A_object">object</code></td>
<td>
<p>an object of class <code>HazardShape</code>, generated with
<code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------------------------------
# Example 1: Increasing hazard and its corresponding TTT plot with simulated data

hweibull &lt;- function(x, shape, scale){
  dweibull(x, shape, scale)/pweibull(x, shape, scale, lower.tail = FALSE)
  }
curve(hweibull(x, shape = 2.5, scale = pi), from = 0, to = 42,
               col = "red", ylab = "Hazard function", las = 1, lwd = 2)

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
my_initial_guess &lt;- TTT_hazard_shape(formula = y ~ 1)
Hazard_Shape(my_initial_guess)


#--------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='integration'>Integration</h2><span id='topic+integration'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This is a wrapper routine for integration in <code>maxlogL</code> framework. It is
used in integration for compute detectability density functions and in
computation of mean values, but it is also a general purpose integrator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integration(fun, lower, upper, routine = "integrate", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integration_+3A_fun">fun</code></td>
<td>
<p>an <strong>R</strong> function which should take a numeric argument x and
possibly some parameters. The function returns a numerical vector
value for the given argument <code>x</code>.</p>
</td></tr>
<tr><td><code id="integration_+3A_lower">lower</code></td>
<td>
<p>a numeric value for the lower limit of the integral.</p>
</td></tr>
<tr><td><code id="integration_+3A_upper">upper</code></td>
<td>
<p>a numeric value for the upper limit of the integral.</p>
</td></tr>
<tr><td><code id="integration_+3A_routine">routine</code></td>
<td>
<p>a character specifying the integration routine.
<code>integrate</code> and <code>gauss_quad</code> are available, but the
custom routines can be defined.</p>
</td></tr>
<tr><td><code id="integration_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>fun</code> and to the
integration routine specified in <code>routine</code> argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user can create custom integration routines through implementation
of a wrapper function using three arguments
</p>

<ul>
<li><p>funa function which should take a numeric argument x and possibly
some parameters.
</p>
</li>
<li><p>lowera numeric value for the lower limit of the integral.
</p>
</li>
<li><p>uppera numeric value for the upper limit of the integral.
</p>
</li>
<li><p>...furthermore, the user must define additional arguments to be
passed to <code>fun</code>.
</p>
</li></ul>

<p>The output must be a numeric atomic value with the result of the integral.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="#topic+gauss_quad">gauss_quad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)


#----------------------------------------------------------------------------
# Example 1: Mean of X ~ N(2,1) using 'integrate'.
mynorm &lt;- function(x, mu, sigma) x*dnorm(x, mean = mu, sd = sigma)
i1 &lt;- integration(mynorm, lower = -Inf, upper = Inf, mu = 2, sigma = 1)
i1

#----------------------------------------------------------------------------
# Example 2: Mean of X ~ N(2,1) using 'gauss_quad' (Gauss-Hermitie
#            quadrature).
g &lt;- function(x, mu, sigma) sqrt(2)*sigma*x + mu
i2 &lt;- integration(g, lower = -Inf, upper = Inf, routine = 'gauss_quad',
                  kind = 'hermite.h', normalized = FALSE,
                  mu = 2, sigma = 1)
i2 &lt;- i2/sqrt(pi)
i2


#----------------------------------------------------------------------------
# Example 3: replicating integrate
i3 &lt;- integrate(dnorm, lower=-1.96, upper=1.96)
i4 &lt;- integration(dnorm, lower=-1.96, upper=1.96)
identical(i3$value, i4)

#----------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='interp.options'>Configure various aspects of interpolating function in <code>TTT_hazard_shape</code></h2><span id='topic+interp.options'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>This function allows the user to set the parameters of any of the following
interpolating functions which can be used inside <code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interp.options(interp.fun = "splinefun", length.out = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interp.options_+3A_interp.fun">interp.fun</code></td>
<td>
<p>character. This argument defines the interpolating
function used. Default value is <code>"splinefun"</code>. Visit the
<strong>Details</strong> section for further information.</p>
</td></tr>
<tr><td><code id="interp.options_+3A_length.out">length.out</code></td>
<td>
<p>numeric. Number of points interpolated. Default value is 10.</p>
</td></tr>
<tr><td><code id="interp.options_+3A_...">...</code></td>
<td>
<p>further arguments passed to the interpolating function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each interpolating function has its particular arguments. The following
interpolating functions are  recommended:
</p>

<ul>
<li> <p><code><a href="stats.html#topic+approxfun">approxfun</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+splinefun">splinefun</a></code>
</p>
</li>
<li> <p><code><a href="stats.html#topic+spline">spline</a></code>
</p>
</li></ul>

<p>The user can also implement a custom interpolating function.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+approxfun">approxfun</a></code>, <code><a href="stats.html#topic+splinefun">splinefun</a></code>,
<code><a href="stats.html#topic+smooth">smooth</a></code>, <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>,
<code><a href="stats.html#topic+loess">loess</a></code>, <code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>
</p>

<hr>
<h2 id='is.maxlogL'>Is return of any object of <code>EstimationTools</code>?</h2><span id='topic+is.maxlogL'></span><span id='topic+is.EmpiricalTTT'></span><span id='topic+is.HazardShape'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Checks if an object is any of the classes implemented in <code>EstimationTools</code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.maxlogL(x)

is.EmpiricalTTT(x)

is.HazardShape(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.maxlogL_+3A_x">x</code></td>
<td>
<p>Any object of <code>EstimationTools</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>

<hr>
<h2 id='legend.HazardShape'>Customize legend for <code><a href="#topic+plot.HazardShape">plot.HazardShape</a></code> outputs</h2><span id='topic+legend.HazardShape'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>Put legend after run <code><a href="#topic+plot.HazardShape">plot.HazardShape</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.HazardShape(
  x,
  y = NULL,
  legend = c("Empirical TTT", "Spline curve"),
  fill = NULL,
  col = 1,
  border = "white",
  lty = NA,
  lwd = NA,
  pch = c(1, NA),
  angle = 45,
  density = NULL,
  bty = "o",
  bg = par("bg"),
  box.lwd = par("lwd"),
  box.lty = par("lty"),
  box.col = par("fg"),
  pt.bg = NA,
  cex = 1,
  pt.cex = cex,
  pt.lwd = lwd,
  xjust = 0,
  yjust = 1,
  x.intersp = 1,
  y.intersp = 1,
  adj = c(0, 0.5),
  text.width = NULL,
  text.col = par("col"),
  text.font = NULL,
  merge = TRUE,
  trace = FALSE,
  plot = TRUE,
  ncol = 1,
  horiz = FALSE,
  title = NULL,
  inset = 0,
  xpd = TRUE,
  title.col = text.col[1],
  title.adj = 0.5,
  title.cex = cex[1],
  title.font = text.font[1],
  seg.len = 2,
  curve_options = list(col = 2, lwd = 2, lty = 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="legend.HazardShape_+3A_x">x</code>, <code id="legend.HazardShape_+3A_y">y</code></td>
<td>
<p>the x and y co-ordinates to be used to position the legend.
They can be specified by keyword or in any way which is accepted by
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>: See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_legend">legend</code></td>
<td>
<p>a character or <a href="base.html#topic+expression">expression</a> vector
of length <code class="reqn">\ge 1</code> to appear in the legend.  Other
objects will be coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_fill">fill</code></td>
<td>
<p>if specified, this argument will cause boxes filled
with the specified colors (or shaded in the specified colors)
to appear beside the legend text.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_col">col</code></td>
<td>
<p>the color of points or lines appearing in the legend.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_border">border</code></td>
<td>
<p>the border color for the boxes (used only if
<code>fill</code> is specified).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_lty">lty</code>, <code id="legend.HazardShape_+3A_lwd">lwd</code></td>
<td>
<p>the line types and widths for lines appearing in the
legend.  One of these two <em>must</em> be specified for line drawing.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_pch">pch</code></td>
<td>
<p>the plotting symbols appearing in the legend, as
numeric vector or a vector of 1-character strings (see
<code><a href="graphics.html#topic+points">points</a></code>). Unlike <code>points</code>, this can all be
specified as a single multi-character string.  <em>Must</em> be
specified for symbol drawing.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_angle">angle</code></td>
<td>
<p>angle of shading lines.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_density">density</code></td>
<td>
<p>the density of shading lines, if numeric and
positive. If <code>NULL</code> or negative or <code>NA</code> color filling
is assumed.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_bty">bty</code></td>
<td>
<p>the type of box to be drawn around the legend.  The allowed
values are <code>"o"</code> (the default) and <code>"n"</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_bg">bg</code></td>
<td>
<p>the background color for the legend box.  (Note that this is
only used if <code>bty != "n"</code>.)</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_box.lty">box.lty</code>, <code id="legend.HazardShape_+3A_box.lwd">box.lwd</code>, <code id="legend.HazardShape_+3A_box.col">box.col</code></td>
<td>
<p>the line type, width and color for
the legend box (if <code>bty = "o"</code>).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_pt.bg">pt.bg</code></td>
<td>
<p>the background color for the <code><a href="graphics.html#topic+points">points</a></code>,
corresponding to its argument <code>bg</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_cex">cex</code></td>
<td>
<p>character expansion factor <b>relative</b> to current
<code>par("cex")</code>.  Used for text, and provides the default for
<code>pt.cex</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_pt.cex">pt.cex</code></td>
<td>
<p>expansion factor(s) for the points.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_pt.lwd">pt.lwd</code></td>
<td>
<p>line width for the points, defaults to the one for
lines, or if that is not set, to <code>par("lwd")</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_xjust">xjust</code></td>
<td>
<p>how the legend is to be justified relative to the legend
x location.  A value of 0 means left justified, 0.5 means centered
and 1 means right justified.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_yjust">yjust</code></td>
<td>
<p>the same as <code>xjust</code> for the legend y location.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_x.intersp">x.intersp</code></td>
<td>
<p>character interspacing factor for horizontal (x) spacing
between symbol and legend text.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_y.intersp">y.intersp</code></td>
<td>
<p>vertical (y) distances (in lines of text shared above/below each legend entry).
A vector with one element for each row of the legend can be used.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_adj">adj</code></td>
<td>
<p>numeric of length 1 or 2; the string adjustment for legend
text.  Useful for y-adjustment when <code>labels</code> are
<a href="grDevices.html#topic+plotmath">plotmath</a> expressions.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_text.width">text.width</code></td>
<td>
<p>the width of the legend text in x (<code>"user"</code>)
coordinates.  (Should be positive even for a reversed x axis.)
Can be a single positive numeric value (same width for each column of the legend),
a vector (one element for each column of the legend),
<code>NULL</code> (default) for computing a proper maximum value of <code><a href="graphics.html#topic+strwidth">strwidth</a>(legend)</code>),
or <code>NA</code> for computing a proper column wise maximum value of <code><a href="graphics.html#topic+strwidth">strwidth</a>(legend)</code>).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_text.col">text.col</code></td>
<td>
<p>the color used for the legend text.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_text.font">text.font</code></td>
<td>
<p>the font used for the legend text, see <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_merge">merge</code></td>
<td>
<p>logical; if <code>TRUE</code>, merge points and lines but
not filled boxes.  Defaults to <code>TRUE</code> if there are points and lines.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_trace">trace</code></td>
<td>
<p>logical; if <code>TRUE</code>, shows how <code>legend</code> does all
its magical computations.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>FALSE</code>, nothing is plotted but the
sizes are returned.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_ncol">ncol</code></td>
<td>
<p>the number of columns in which to set the legend items
(default is 1, a vertical legend).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_horiz">horiz</code></td>
<td>
<p>logical; if <code>TRUE</code>, set the legend horizontally
rather than vertically (specifying <code>horiz</code> overrides the <code>ncol</code>
specification).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_title">title</code></td>
<td>
<p>a character string or length-one expression giving a
title to be placed at the top of the legend.  Other objects will be
coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_inset">inset</code></td>
<td>
<p>inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_xpd">xpd</code></td>
<td>
<p>if supplied, a value of the <a href="graphics.html#topic+graphical+20parameter">graphical parameter</a> <code>xpd</code>
to be used while the legend is being drawn.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_title.col">title.col</code></td>
<td>
<p>color for <code>title</code>, defaults to <code>text.col[1]</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_title.adj">title.adj</code></td>
<td>
<p>horizontal adjustment for <code>title</code>: see the help
for <code><a href="graphics.html#topic+par">par</a>("adj")</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_title.cex">title.cex</code></td>
<td>
<p>expansion factor(s) for the title, defaults to <code>cex[1]</code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_title.font">title.font</code></td>
<td>
<p>the font used for the legend title, defaults to <code>text.font[1]</code>,
see <code><a href="graphics.html#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_seg.len">seg.len</code></td>
<td>
<p>the length of lines drawn to illustrate <code>lty</code>
and/or <code>lwd</code> (in units of character widths).</p>
</td></tr>
<tr><td><code id="legend.HazardShape_+3A_curve_options">curve_options</code></td>
<td>
<p>a list whose names are curve graphical parameters, and whose
values are the corresponding graphical parameters values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper for the <code><a href="graphics.html#topic+legend">legend</a></code> function.
It just adds two features:
</p>

<ul>
<li> <p><code>legend</code> has a default value, regarding that <code>HazardShape</code> objects
produces the TTT plot and its LOESS estimation.
</p>
</li>
<li> <p><code>curve_options</code> is used to set legend parameters for the LOESS
curve. We encourage you to define first a list with curve parameters, and then
pass it to <code><a href="#topic+plot.HazardShape">plot.HazardShape</a></code> and <code>legend.HazardShape</code> (see example 2).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

data("reduction_cells")
TTT_IG &lt;- TTTE_Analytical(Surv(days, status) ~ 1, data = reduction_cells,
                          method = 'censored')
HS_IG &lt;- TTT_hazard_shape(TTT_IG, data = reduction_cells)

#----------------------------------------------------------------------------
# Example 1: put legend to the TTT plot of the reduction cells data set.

# Run `plot.HazardShape` method.
par(
  cex.lab=1.8,
  cex.axis=1.8,
  mar=c(4.8,5.4,1,1),
  las = 1,
  mgp=c(3.4,1,0)
)
plot(HS_IG, pch = 16, cex = 1.8)

# Finally, put the legend
legend.HazardShape(
  x = "bottomright",
  box.lwd = NA,
  cex = 1.8,
  pt.cex = 1.8,
  bty = 'n',
  pch = c(16, NA)
)
#----------------------------------------------------------------------------
# Example 2: example 1 with custom options for the curve

# This is the list with curve parameters
loess_options &lt;- list(
  col = 3, lwd = 4, lty = 2
)
par(
  cex.lab=1.8,
  cex.axis=1.8,
  mar=c(4.8,5.4,1,1),
  las = 1,
  mgp=c(3.4,1,0)
)

plot(HS_IG, pch = 16, cex = 1.8, curve_options = loess_options)
legend.HazardShape(
  x = "bottomright",
  box.lwd = NA,
  cex = 1.8,
  pt.cex = 1.8,
  bty = 'n',
  pch = c(16, NA),
  curve_options = loess_options
)

</code></pre>

<hr>
<h2 id='loess.options'>Configure various aspects of LOESS in <code>TTT_hazard_shape</code></h2><span id='topic+loess.options'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>This function allows the user to set the parameters of <code>loess</code> function
used inside <code>TTT_hazard_shape</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loess.options(span = 2/3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loess.options_+3A_span">span</code></td>
<td>
<p>the parameter which controls the degree of smoothing.</p>
</td></tr>
<tr><td><code id="loess.options_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+loess">loess</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please, visit <code><a href="stats.html#topic+loess">loess</a></code> to know further possible arguments.
The following arguments are not available for passing to the LOESS estimation:
</p>

<ul>
<li><p>dataThe only data handled inside <code>TTT_hazard_shape</code> is the
computed empirical TTT.
</p>
</li>
<li><p>subsetThis argument is used in <code>loess</code> to take a subset of data.
In this context, it is not necessary.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+loess">loess</a></code>, <code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>
</p>

<hr>
<h2 id='log_link'>Logarithmic link function (for estimation with <code>maxlogL</code> object)</h2><span id='topic+log_link'></span>

<h3>Description</h3>

<p><code>log_link</code> object provides a way to implement logarithmic link function that
<code><a href="#topic+maxlogL">maxlogL</a></code> needs to perform estimation. See documentation for
<code><a href="#topic+maxlogL">maxlogL</a></code> for further information on parameter estimation and implementation
of link objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_link()
</code></pre>


<h3>Details</h3>

<p><code>log_link</code> is part of a family of generic functions with no input arguments that
defines and returns a list with details of the link function:
</p>

<ol>
<li> <p><code>name</code>: a character string with the name of the link function.
</p>
</li>
<li> <p><code>g</code>: implementation of the link function as a generic function in <code>R</code>.
</p>
</li>
<li> <p><code>g_inv</code>: implementation of the inverse link function as a generic function
in <code>R</code>.
</p>
</li></ol>

<p>There is a way to add new mapping functions. The user must specify the details aforesaid.
</p>


<h3>Value</h3>

<p>A list with logit link function, its inverse and its name.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxlogL">maxlogL</a></code>
</p>
<p>Other link functions: 
<code><a href="#topic+NegInv_link">NegInv_link</a>()</code>,
<code><a href="#topic+logit_link">logit_link</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># One parameters of normal distribution mapped with logarithmic function
x &lt;- rnorm(n = 10000, mean = 50, sd = 4)
theta_2 &lt;- maxlogL( x = x, link = list(over = "sd",
                                       fun = "log_link") )
summary(theta_2)

# Link function name
fun &lt;- log_link()$name
print(fun)

# Link function
g &lt;- log_link()$g
curve(g(x), from = 0, to = 1)

# Inverse link function
ginv &lt;- log_link()$g_inv
curve(ginv(x), from = -5, to = 5)

</code></pre>

<hr>
<h2 id='logit_link'>Logit link function (for estimation with <code>maxlogL</code> object)</h2><span id='topic+logit_link'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>log_link</code> object provides a way to implement logit link function that
<code><a href="#topic+maxlogL">maxlogL</a></code> needs to perform estimation. See documentation for
<code><a href="#topic+maxlogL">maxlogL</a></code> for further information on parameter estimation and implementation
of link objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logit_link()
</code></pre>


<h3>Details</h3>

<p><code>logit_link</code> is part of a family of generic functions with no input arguments that
defines and returns a list with details of the link function:
</p>

<ol>
<li> <p><code>name</code>: a character string with the name of the link function.
</p>
</li>
<li> <p><code>g</code>: implementation of the link function as a generic function in <code>R</code>.
</p>
</li>
<li> <p><code>g_inv</code>: implementation of the inverse link function as a generic function
in <code>R</code>.
</p>
</li></ol>

<p>There is a way to add new mapping functions. The user must specify the details aforesaid.
</p>


<h3>Value</h3>

<p>A list with logit link function, its inverse and its name.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxlogL">maxlogL</a></code>
</p>
<p>Other link functions: 
<code><a href="#topic+NegInv_link">NegInv_link</a>()</code>,
<code><a href="#topic+log_link">log_link</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------------------------------
# Estimation of proportion in binomial distribution with 'logit' function
# 10 trials, probability of success equals to 30%)
N &lt;- rbinom(n = 100, size = 10, prob = 0.3)
phat &lt;- maxlogL(x = N, dist = 'dbinom', fixed = list(size=10),
                link = list(over = "prob", fun = "logit_link"))
summary(phat)

# Link function name
fun &lt;- logit_link()$name
print(fun)

# Link function
g &lt;- logit_link()$g
curve(g(x), from = 0, to = 1)

# Inverse link function
ginv &lt;- logit_link()$g_inv
curve(ginv(x), from = -10, to = 10)

#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='maxlogL'>Maximum Likelihood Estimation for parametric distributions</h2><span id='topic+maxlogL'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>Wrapper function to compute maximum likelihood estimators (MLE)
of any distribution implemented in <code>R</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxlogL(
  x,
  dist = "dnorm",
  fixed = NULL,
  link = NULL,
  start = NULL,
  lower = NULL,
  upper = NULL,
  optimizer = "nlminb",
  control = NULL,
  StdE_method = c("optim", "numDeriv"),
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxlogL_+3A_x">x</code></td>
<td>
<p>a vector with data to be fitted. This argument must be a matrix
with hierarchical distributions.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_dist">dist</code></td>
<td>
<p>a length-one character vector with the name of density/mass function
of interest. The default value is <code>'dnorm'</code>, to compute maximum
likelihood estimators of normal distribution.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_fixed">fixed</code></td>
<td>
<p>a list with fixed/known parameters of distribution of interest.
Fixed parameters must be passed with its name.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_link">link</code></td>
<td>
<p>a list with names of parameters to be linked, and names of the link
function object. For names of parameters, please visit documentation
of density/mass function. There are three link functions available:
<code><a href="#topic+log_link">log_link</a></code>, <code><a href="#topic+logit_link">logit_link</a></code> and
<code><a href="#topic+NegInv_link">NegInv_link</a></code>.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_start">start</code></td>
<td>
<p>a numeric vector with initial values for the parameters to be estimated.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_lower">lower</code></td>
<td>
<p>a numeric vector with lower bounds, with the same length of argument
<code>start</code> (for box-constrained optimization).</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_upper">upper</code></td>
<td>
<p>a numeric vector with upper bounds, with the same length of argument
<code>start</code> (for box-constrained optimization).</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_optimizer">optimizer</code></td>
<td>
<p>a length-one character vector with the name of optimization routine.
<code><a href="stats.html#topic+nlminb">nlminb</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>,
<code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code> and <code><a href="GA.html#topic+ga">ga</a></code>are available;
custom optimization routines can also be implemented.
<code><a href="stats.html#topic+nlminb">nlminb</a></code> is the default routine.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_control">control</code></td>
<td>
<p>control parameters of the optimization routine. Please, visit
documentation of selected optimizer for further information.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_stde_method">StdE_method</code></td>
<td>
<p>a length-one character vector with the routine for Hessian matrix
computation. The This is needed for standard error estimation. The
options available are <code>"optim"</code> and <code>"numDeriv"</code>. For
further information, visit <code><a href="stats.html#topic+optim">optim</a></code> or
<code><a href="numDeriv.html#topic+hessian">hessian</a></code>.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_silent">silent</code></td>
<td>
<p>logical. If TRUE, warnings of <code>maxlogL</code> are suppressed.</p>
</td></tr>
<tr><td><code id="maxlogL_+3A_...">...</code></td>
<td>
<p>further arguments to be supplied to the optimizer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>maxlogL</code> computes the likelihood function corresponding to
the distribution specified in argument <code>dist</code> and maximizes it through
<code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlminb">nlminb</a></code> or <code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code>. <code>maxlogL</code>
generates an S3 object of class <code>maxlogL</code>.
</p>
<p>Noncentrality parameters must be named as <code>ncp</code> in the distribution.
</p>


<h3>Value</h3>

<p>A list with class <code>"maxlogL"</code> containing the following lists:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>A list with output information about estimation.</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p>A list with all input arguments.</p>
</td></tr>
<tr><td><code>outputs</code></td>
<td>
<p>A list with some output additional information:
</p>

<ul>
<li><p> Number of parameters.
</p>
</li>
<li><p> Sample size
</p>
</li>
<li><p> Standard error computation method.
</p>
</li></ul>

</td></tr>
</table>


<h3>Note</h3>

<p>The following generic functions can be used with a <code>maxlogL</code> object:
<code>summary, print, AIC, BIC, logLik</code>.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Nelder JA, Mead R (1965).
&ldquo;A Simplex Method for Function Minimization.&rdquo;
<em>The Computer Journal</em>, <b>7</b>(4), 308&ndash;313.
ISSN 0010-4620, <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>, <a href="https://academic.oup.com/comjnl/article-lookup/doi/10.1093/comjnl/7.4.308">https://academic.oup.com/comjnl/article-lookup/doi/10.1093/comjnl/7.4.308</a>.
</p>
<p>Fox PA, Hall AP, Schryer NL (1978).
&ldquo;The PORT Mathematical Subroutine Library.&rdquo;
<em>ACM Transactions on Mathematical Software</em>, <b>4</b>(2), 104&ndash;126.
ISSN 00983500, <a href="https://doi.org/10.1145/355780.355783">doi:10.1145/355780.355783</a>, <a href="https://dl.acm.org/doi/10.1145/355780.355783">https://dl.acm.org/doi/10.1145/355780.355783</a>.
</p>
<p>Nash JC (1979).
<em>Compact Numerical Methods for Computers. Linear Algebra and Function Minimisation</em>, 2nd Edition edition.
Adam Hilger, Bristol.
</p>
<p>Dennis JE, Gay DM, Walsh RE (1981).
&ldquo;An Adaptive Nonlinear Least-Squares Algorithm.&rdquo;
<em>ACM Transactions on Mathematical Software</em>, <b>7</b>(3), 348&ndash;368.
ISSN 00983500, <a href="https://doi.org/10.1145/355958.355965">doi:10.1145/355958.355965</a>, <a href="https://dl.acm.org/doi/10.1145/355958.355965">https://dl.acm.org/doi/10.1145/355958.355965</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.maxlogL">summary.maxlogL</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code>, <code><a href="DEoptim.html#topic+DEoptim.control">DEoptim.control</a></code>,
<code><a href="#topic+maxlogLreg">maxlogLreg</a></code>, <code><a href="#topic+bootstrap_maxlogL">bootstrap_maxlogL</a></code>
</p>
<p>Other maxlogL: 
<code><a href="#topic+hazard_fun">hazard_fun</a>()</code>,
<code><a href="#topic+maxlogLreg">maxlogLreg</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example 1: estimation with one fixed parameter
x &lt;- rnorm(n = 10000, mean = 160, sd = 6)
theta_1 &lt;- maxlogL(x = x, dist = 'dnorm', control = list(trace = 1),
                 link = list(over = "sd", fun = "log_link"),
                 fixed = list(mean = 160))
summary(theta_1)


#----------------------------------------------------------------------------
# Example 2: both parameters of normal distribution mapped with logarithmic
# function
theta_2 &lt;- maxlogL(x = x, dist = "dnorm",
                   link = list(over = c("mean","sd"),
                               fun = c("log_link","log_link")))
summary(theta_2)


#--------------------------------------------------------------------------------
# Example 3: parameter estimation in ZIP distribution
if (!require('gamlss.dist')) install.packages('gamlss.dist')
library(gamlss.dist)
z &lt;- rZIP(n=1000, mu=6, sigma=0.08)
theta_3  &lt;- maxlogL(x = z, dist = 'dZIP', start = c(0, 0),
                   lower = c(-Inf, -Inf), upper = c(Inf, Inf),
                   optimizer = 'optim',
                   link = list(over=c("mu", "sigma"),
                   fun = c("log_link", "logit_link")))
summary(theta_3)


#--------------------------------------------------------------------------------
# Example 4: parameter estimation with fixed noncentrality parameter.
y_2 &lt;- rbeta(n = 1000, shape1 = 2, shape2 = 3)
theta_41 &lt;- maxlogL(x = y_2, dist = "dbeta",
                    link = list(over = c("shape1", "shape2"),
                    fun = c("log_link","log_link")))
summary(theta_41)

# It is also possible define 'ncp' as fixed parameter
theta_42 &lt;- maxlogL(x = y_2, dist = "dbeta", fixed = list(ncp = 0),
                    link = list(over = c("shape1", "shape2"),
                    fun = c("log_link","log_link")) )
summary(theta_42)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='maxlogLreg'>Maximum Likelihood Estimation for parametric linear regression models</h2><span id='topic+maxlogLreg'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Function to compute maximum likelihood estimators (MLE) of regression parameters
of any distribution implemented in <code>R</code> with covariates (linear predictors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxlogLreg(
  formulas,
  y_dist,
  support = NULL,
  data = NULL,
  subset = NULL,
  fixed = NULL,
  link = NULL,
  start = NULL,
  lower = NULL,
  upper = NULL,
  optimizer = "nlminb",
  control = NULL,
  silent = FALSE,
  StdE_method = c("optim", "numDeriv"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxlogLreg_+3A_formulas">formulas</code></td>
<td>
<p>a list of formula objects. Each element must have an <code>~</code>,
with the terms on the right separated by <code>+</code> operators. The response
variable on the left side is optional. Linear predictor of each parameter must
be specified with the name of the parameter followed by the suffix <code>'.fo'</code>.
See the examples below for further illustration.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_y_dist">y_dist</code></td>
<td>
<p>a formula object that specifies the distribution of the response
variable. On the left side of <code>~</code> must be the response,
and in the right side must be the name o de probability
density/mass function. See the section <strong>Details</strong> and the
examples below for further illustration.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_support">support</code></td>
<td>
<p>a list with the following entries:
</p>

<ul>
<li> <p><code>interval</code>: a two dimensional atomic vector indicating
the set of possible values of a random variable having the
distribution specified in <code>y_dist</code>.
</p>
</li>
<li> <p><code>type</code>: character indicating if distribution has a
<code>discrete</code> or a <code>continous</code> random variable.
</p>
</li></ul>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
If data is not specified, the variables are taken from the
environment from which <code>maxlogLreg</code> is called.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used
in the fitting process.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_fixed">fixed</code></td>
<td>
<p>a list with fixed/known parameters of distribution of interest.
Fixed parameters must be passed with its name and its value (known).</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_link">link</code></td>
<td>
<p>a list with names of parameters to be linked, and names of the
link function object. For names of parameters, please visit
documentation of density/mass function. There are three link
functions available: <code><a href="#topic+log_link">log_link</a></code>, <code><a href="#topic+logit_link">logit_link</a></code>
and <code><a href="#topic+NegInv_link">NegInv_link</a></code>. Take into account: the order
used in argument <code>over</code> corresponds to the order in argument
<code>link</code>.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_start">start</code></td>
<td>
<p>a numeric vector with initial values for the parameters to be
estimated. Zero is the default value.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_lower">lower</code></td>
<td>
<p>a numeric vector with lower bounds, with the same lenght of
argument <code>start</code> (for box-constrained optimization). <code>-Inf</code>
is the default value.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_upper">upper</code></td>
<td>
<p>a numeric vector with upper bounds, with the same lenght of
argument <code>start</code> (for box-constrained optimization). <code>Inf</code>
is the default value.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_optimizer">optimizer</code></td>
<td>
<p>a length-one character vector with the name of optimization
routine.  <code><a href="stats.html#topic+nlminb">nlminb</a></code>, <code><a href="stats.html#topic+optim">optim</a></code> and
<code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code> are available; <code><a href="stats.html#topic+nlminb">nlminb</a></code>
is the default routine.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_control">control</code></td>
<td>
<p>control parameters of the optimization routine. Please, visit
documentation of selected optimizer for further information.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_silent">silent</code></td>
<td>
<p>logical. If TRUE, warnings of <code>maxlogL</code> are suppressed.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_stde_method">StdE_method</code></td>
<td>
<p>a length-one character vector with the routine for Hessian
matrix computation. The This is needed for standard error
estimation. The options available are <code>"optim"</code> and
<code>"numDeriv"</code>. For further information, visit
<code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="numDeriv.html#topic+hessian">hessian</a></code>.</p>
</td></tr>
<tr><td><code id="maxlogLreg_+3A_...">...</code></td>
<td>
<p>Further arguments to be supplied to the optimization routine.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>maxlogLreg</code> computes programmatically the log-likelihood
(log L) function corresponding for the following model:
</p>
<p style="text-align: center;"><code class="reqn">
  y_i \stackrel{iid.}{\sim} \mathcal{D}(\theta_{i1},\theta_{i2},\dots,
  \theta_{ij}, \dots, \theta_{ik})
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  g(\boldsymbol{\theta}_{j}) = \boldsymbol{\eta}_{j} = \mathbf{X}_j^\top
  \boldsymbol{\beta}_j,
</code>
</p>

<p>where,
</p>

<ul>
<li> <p><code class="reqn">g_k(\cdot)</code> is the <code class="reqn">k</code>-th link function.
</p>
</li>
<li> <p><code class="reqn">\boldsymbol{\eta}_{j}</code> is the value of the linear predictor for the
$j^th$ for all the observations.
</p>
</li>
<li> <p><code class="reqn">\boldsymbol{\beta}_j = (\beta_{0j}, \beta_{1j},\dots,
        \beta_{(p_j-1)j})^\top</code> are the fixed effects vector, where <code class="reqn">p_j</code>
is the number of parameters in linear predictor <code class="reqn">j</code> and
<code class="reqn">\mathbf{X}_j</code> is a known design matrix of order <code class="reqn">n\times p_j</code>.
These terms are specified in <code>formulas</code> argument.
</p>
</li>
<li> <p><code class="reqn">\mathcal{D}</code> is the distribution specified in argument
<code>y_dist</code>.
</p>
</li></ul>

<p>Then, <code>maxlogLreg</code> maximizes the log L through <code><a href="stats.html#topic+optim">optim</a></code>,
<code><a href="stats.html#topic+nlminb">nlminb</a></code> or <code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code>. <code>maxlogLreg</code> generates
an S3 object of class <code>maxlogL</code>.
</p>
<p>Estimation with censorship can be handled with <code>Surv</code> objects
(see example 2). The output object stores the corresponding censorship matrix,
defined as <code class="reqn">r_{il} = 1</code> if sample unit <code class="reqn">i</code> has status <code class="reqn">l</code>, or
<code class="reqn">r_{il} = 0</code> in other case. <code class="reqn">i=1,2,\dots,n</code> and <code class="reqn">l=1,2,3</code>
(<code class="reqn">l=1</code>: observation status, <code class="reqn">l=2</code>: right censorship status,
<code class="reqn">l=3</code>: left censorship status).
</p>


<h3>Value</h3>

<p>A list with class <code>maxlogL</code> containing the following
lists:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>A list with output information about estimation and method used.</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p>A list with all input arguments.</p>
</td></tr>
<tr><td><code>outputs</code></td>
<td>
<p>A list with additional information. The most important outputs
are:
</p>

<ul>
<li> <p><code>npar</code>: number of parameters.
</p>
</li>
<li> <p><code>n</code>: sample size
</p>
</li>
<li> <p><code>Stde_method</code>: standard error computation method.
</p>
</li>
<li> <p><code>b_lenght</code>: a list with the number of regression parameters.
</p>
</li>
<li> <p><code>design_matrix</code>: a list with the <code class="reqn">\mathbf{X}</code> matrix
for each parameter, the response values (called <code>y</code>) and
the censorship matrix (called <code>status</code>). See the Details
section for further information.
</p>
</li></ul>

</td></tr>
</table>


<h3>Note</h3>


<ul>
<li><p> The following generic functions can be used with a <code>maxlogL</code>
object: <code>summary, print, logLik, AIC</code>.
</p>
</li>
<li><p> Noncentrality parameters must be named as <code>ncp</code> in the
distribution.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Nelder JA, Mead R (1965).
&ldquo;A Simplex Method for Function Minimization.&rdquo;
<em>The Computer Journal</em>, <b>7</b>(4), 308&ndash;313.
ISSN 0010-4620, <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>, <a href="https://academic.oup.com/comjnl/article-lookup/doi/10.1093/comjnl/7.4.308">https://academic.oup.com/comjnl/article-lookup/doi/10.1093/comjnl/7.4.308</a>.
</p>
<p>Fox PA, Hall AP, Schryer NL (1978).
&ldquo;The PORT Mathematical Subroutine Library.&rdquo;
<em>ACM Transactions on Mathematical Software</em>, <b>4</b>(2), 104&ndash;126.
ISSN 00983500, <a href="https://doi.org/10.1145/355780.355783">doi:10.1145/355780.355783</a>, <a href="https://dl.acm.org/doi/10.1145/355780.355783">https://dl.acm.org/doi/10.1145/355780.355783</a>.
</p>
<p>Nash JC (1979).
<em>Compact Numerical Methods for Computers. Linear Algebra and Function Minimisation</em>, 2nd Edition edition.
Adam Hilger, Bristol.
</p>
<p>Dennis JE, Gay DM, Walsh RE (1981).
&ldquo;An Adaptive Nonlinear Least-Squares Algorithm.&rdquo;
<em>ACM Transactions on Mathematical Software</em>, <b>7</b>(3), 348&ndash;368.
ISSN 00983500, <a href="https://doi.org/10.1145/355958.355965">doi:10.1145/355958.355965</a>, <a href="https://dl.acm.org/doi/10.1145/355958.355965">https://dl.acm.org/doi/10.1145/355958.355965</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.maxlogL">summary.maxlogL</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="DEoptim.html#topic+DEoptim">DEoptim</a></code>, <code><a href="DEoptim.html#topic+DEoptim.control">DEoptim.control</a></code>,
<code><a href="#topic+maxlogL">maxlogL</a></code>, <code><a href="#topic+bootstrap_maxlogL">bootstrap_maxlogL</a></code>
</p>
<p>Other maxlogL: 
<code><a href="#topic+hazard_fun">hazard_fun</a>()</code>,
<code><a href="#topic+maxlogL">maxlogL</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# Example 1: Estimation in simulated normal distribution
n &lt;- 1000
x &lt;- runif(n = n, -5, 6)
y &lt;- rnorm(n = n, mean = -2 + 3 * x, sd = exp(1 + 0.3* x))
norm_data &lt;- data.frame(y = y, x = x)

# It does not matter the order of distribution parameters
formulas &lt;- list(sd.fo = ~ x, mean.fo = ~ x)
support &lt;- list(interval = c(-Inf, Inf), type = 'continuous')

norm_mod &lt;- maxlogLreg(formulas, y_dist = y ~ dnorm, support = support,
                       data = norm_data,
                       link = list(over = "sd", fun = "log_link"))
summary(norm_mod)


#--------------------------------------------------------------------------------
# Example 2: Fitting with censorship
# (data from https://www.itl.nist.gov/div898/handbook/apr/section4/apr413.htm)

failures &lt;- c(55, 187, 216, 240, 244, 335, 361, 373, 375, 386)
fails &lt;- c(failures, rep(500, 10))
status &lt;- c(rep(1, length(failures)), rep(0, 10))
Wei_data &lt;- data.frame(fails = fails, status = status)

# Formulas with linear predictors
formulas &lt;- list(scale.fo=~1, shape.fo=~1)
support &lt;- list(interval = c(0, Inf), type = 'continuous')

# Bounds for optimization. Upper bound set with default values (Inf)
start &lt;- list(
  scale = list(Intercept = 100),
  shape = list(Intercept = 10)
)
lower &lt;- list(
  scale = list(Intercept = 0),
  shape = list(Intercept = 0)
)

mod_weibull &lt;- maxlogLreg(formulas, y_dist = Surv(fails, status) ~ dweibull,
                          support = c(0, Inf), start = start,
                          lower = lower, data = Wei_data)
summary(mod_weibull)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='NegInv_link'>Negative inverse link function (for estimation with <code>maxlogL</code> object)</h2><span id='topic+NegInv_link'></span>

<h3>Description</h3>

<p><code>NegInv_link</code> object provides a way to implement negative inverse link function that
<code><a href="#topic+maxlogL">maxlogL</a></code> needs to perform estimation. See documentation for
<code><a href="#topic+maxlogL">maxlogL</a></code> for further information on parameter estimation and implementation
of link objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NegInv_link()
</code></pre>


<h3>Details</h3>

<p><code>NegInv_link</code> is part of a family of generic functions with no input arguments that
defines and returns a list with details of the link function:
</p>

<ol>
<li> <p><code>name</code>: a character string with the name of the link function.
</p>
</li>
<li> <p><code>g</code>: implementation of the link function as a generic function in <code>R</code>.
</p>
</li>
<li> <p><code>g_inv</code>: implementation of the inverse link function as a generic function
in <code>R</code>.
</p>
</li></ol>

<p>There is a way to add new mapping functions. The user must specify the details aforesaid.
</p>


<h3>Value</h3>

<p>A list with negative inverse link function, its inverse and its name.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxlogL">maxlogL</a></code>
</p>
<p>Other link functions: 
<code><a href="#topic+log_link">log_link</a>()</code>,
<code><a href="#topic+logit_link">logit_link</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Estimation of rate parameter in exponential distribution
T &lt;- rexp(n = 1000, rate = 3)
lambda &lt;- maxlogL(x = T, dist = "dexp", start = 5,
                  link = list(over = "rate", fun = "NegInv_link"))
summary(lambda)

# Link function name
fun &lt;- NegInv_link()$name
print(fun)

# Link function
g &lt;- NegInv_link()$g
curve(g(x), from = 0.1, to = 1)

# Inverse link function
ginv &lt;- NegInv_link()$g_inv
curve(ginv(x), from = 0.1, to = 1)

</code></pre>

<hr>
<h2 id='plot.EmpiricalTTT'>Plot method for <code>EmpiricalTTT</code> objects</h2><span id='topic+plot.EmpiricalTTT'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Draws a TTT plot of an <code>EmpiricalTTT</code> object, one for each strata.
</p>
<p>TTT plots are graphed in the same order in which they appear in the list
element <code>strata</code> or in the list element <code>phi_n</code> of
the <code>EmpiricalTTT</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EmpiricalTTT'
plot(
  x,
  add = FALSE,
  grid = FALSE,
  type = "l",
  pch = 1,
  xlab = "i/n",
  ylab = expression(phi[n](i/n)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.EmpiricalTTT_+3A_x">x</code></td>
<td>
<p>an object of class <code>EmpiricalTTT</code>.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_add">add</code></td>
<td>
<p>logical. If TRUE, <code>plot.EmpiricalTTT</code> add a TTT plot to an
already existing plot.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_grid">grid</code></td>
<td>
<p>logical. If <code>TRUE</code>, plot appears with grid.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_type">type</code></td>
<td>
<p>character string (length 1 vector) or vector of 1-character strings
indicating the type of plot for each TTT graph. See <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_pch">pch</code></td>
<td>
<p>numeric (integer). A vector of plotting characters or symbols when
<code>type = "p"</code>. See <code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_xlab">xlab</code>, <code id="plot.EmpiricalTTT_+3A_ylab">ylab</code></td>
<td>
<p>titles for x and y axes, as in <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.EmpiricalTTT_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+matplot">matplot</a></code>. See
the examples and <strong>Details</strong> section for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is based on <code><a href="graphics.html#topic+matplot">matplot</a></code>. Our function
sets some default values for graphic parameters: <code>type = "l"</code>, <code>pch = 1</code>,
<code>xlab = "i/n"</code> and <code>ylab = expression(phi[n](i/n))</code>. This arguments
can be modified by the user.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TTTE_Analytical">TTTE_Analytical</a></code>, <code><a href="graphics.html#topic+matplot">matplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# First example: Scaled empirical TTT from 'mgus1' data from 'survival' package.

TTT_1 &lt;- TTTE_Analytical(Surv(stop, event == 'pcm') ~1, method = 'cens',
                         data = mgus1, subset=(start == 0))
plot(TTT_1, type = "p")


#--------------------------------------------------------------------------------
# Second example: Scaled empirical TTT using a factor variable with 'aml' data
# from 'survival' package.

TTT_2 &lt;- TTTE_Analytical(Surv(time, status) ~ x, method = "cens", data = aml)
plot(TTT_2, type = "l", lty = c(1,1), col = c(2,4))
plot(TTT_2, add = TRUE, type = "p", lty = c(1,1), col = c(2,4), pch = 16)

#--------------------------------------------------------------------------------
# Third example: Non-scaled empirical TTT without a factor (arbitrarily simulated
# data).

y &lt;- rweibull(n=20, shape=1, scale=pi)
TTT_3 &lt;- TTTE_Analytical(y ~ 1, scaled = FALSE)
plot(TTT_3, type = "s", col = 3, lwd = 3)


#--------------------------------------------------------------------------------
# Fourth example: TTT plot for 'carbone' data from 'AdequacyModel' package

if (!require('AdequacyModel')) install.packages('AdequacyModel')
library(AdequacyModel)
data(carbone)
TTT_4 &lt;- TTTE_Analytical(response = carbone, scaled = TRUE)
plot(TTT_4, type = "l", col = "red", lwd = 2, grid = TRUE)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='plot.HazardShape'>Plot of <code>HazardShape</code> objects</h2><span id='topic+plot.HazardShape'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>Draws the empirical total time on test (TTT) plot and its non-parametric
(LOESS) estimated curve useful for identifying hazard shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HazardShape'
plot(
  x,
  xlab = "i/n",
  ylab = expression(phi[n](i/n)),
  xlim = c(0, 1),
  ylim = c(0, 1),
  col = 1,
  lty = NULL,
  lwd = NA,
  main = "",
  curve_options = list(col = 2, lwd = 2, lty = 1),
  par_plot = lifecycle::deprecated(),
  legend_options = lifecycle::deprecated(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.HazardShape_+3A_x">x</code></td>
<td>
<p>an object of class <code>initValOW</code>, generated with
<code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_xlab">xlab</code>, <code id="plot.HazardShape_+3A_ylab">ylab</code></td>
<td>
<p>titles for x and y axes, as in <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_xlim">xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_ylim">ylim</code></td>
<td>
<p>the y limits (x1, x2) of the plot.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_col">col</code></td>
<td>
<p>the colors for lines and points. Multiple colors can be specified.
This is the usual color argument of
<code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_lty">lty</code></td>
<td>
<p>a vector of line types, see <code><a href="graphics.html#topic+par">par</a></code> for further
information.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_lwd">lwd</code></td>
<td>
<p>a vector of line widths, see <code><a href="graphics.html#topic+par">par</a></code> for further
information.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_main">main</code></td>
<td>
<p>a main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_curve_options">curve_options</code></td>
<td>
<p>a list with further arguments useful for customization
of non-parametric estimate plot.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_par_plot">par_plot</code></td>
<td>
<p>(deprecated) some graphical parameters which can be passed to the plot.
See <strong>Details</strong> section for further information.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_legend_options">legend_options</code></td>
<td>
<p>(deprecated) a list with fur further arguments useful for
customization. See <strong>Details</strong> section for further information.
of the legend of the plot.</p>
</td></tr>
<tr><td><code id="plot.HazardShape_+3A_...">...</code></td>
<td>
<p>further arguments passed to empirical TTT plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot complements the use of <code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>. It is always
advisable to use this function in order to check the result of non-parametric
estimate of TTT plot. See the first example in <strong>Examples</strong> section for
an illustration.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example 1: Increasing hazard and its corresponding TTT plot with simulated
# data
hweibull &lt;- function(x, shape, scale) {
  dweibull(x, shape, scale) / pweibull(x, shape, scale, lower.tail = FALSE)
}
curve(hweibull(x, shape = 2.5, scale = pi),
  from = 0, to = 42,
  col = "red", ylab = "Hazard function", las = 1, lwd = 2
)

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
my_initial_guess &lt;- TTT_hazard_shape(formula = y ~ 1)

par(mar = c(3.7, 3.7, 1, 2), mgp = c(2.5, 1, 0))
plot(my_initial_guess)

#----------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='predict.maxlogL'>Predict Method for <code>maxlogL</code> Fits</h2><span id='topic+predict.maxlogL'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>This function computes predictions and optionally the estimated standard errors
of those predictions from a model fitted with <code>maxlogLreg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'maxlogL'
predict(
  object,
  parameter = NULL,
  newdata = NULL,
  type = c("link", "response", "terms"),
  se.fit = FALSE,
  terms = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.maxlogL_+3A_object">object</code></td>
<td>
<p>an object of <code>maxlogL</code> class generated by <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>
function.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_parameter">parameter</code></td>
<td>
<p>a character which specifies the parameter to predict.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_newdata">newdata</code></td>
<td>
<p>a data frame with covariates with which to predict. It is an
optional argument, if omitted, the fitted linear predictors or
the (distribution) parameter predictions are used.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_type">type</code></td>
<td>
<p>a character with the type of prediction required. The default
(<code>type = "link"</code>) is on the scale of the linear predictors;
the alternative <code>type = "response"</code> is on the scale of the
distribution parameter.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_se.fit">se.fit</code></td>
<td>
<p>logical switch indicating if standard errors of predictions
are required.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_terms">terms</code></td>
<td>
<p>A character vector that specifies which terms are required if
<code>type = "terms"</code>. All terms are returned by default.</p>
</td></tr>
<tr><td><code id="predict.maxlogL_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <code>predict</code> method computes predictions for values of any
distribution parameter in link or original scale.
</p>


<h3>Value</h3>

<p>If <code>se.fit = FALSE</code>, a vector of predictions is returned.
For <code>type = "terms"</code>, a matrix with a column per term and an attribute &quot;constant&quot;
is returned.
</p>
<p>If <code>se.fit = TRUE</code>, a list with the following components is obtained:
</p>

<ol>
<li> <p><code>fit</code>: Predictions.
</p>
</li>
<li> <p><code>se.fit</code>: Estimated standard errors.
</p>
</li></ol>



<h3>Note</h3>

<p>Variables are first looked for in <code>newdata</code> argument and then searched
in the usual way (which will include the environment of the formula used in
the fit). A warning will be given if the variables found are not of the same
length as those in <code>newdata</code> if it is supplied.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# Example 1: Predictions from a model using a simulated normal distribution
n &lt;- 1000
x &lt;- runif(n = n, -5, 6)
y &lt;- rnorm(n = n, mean = -2 + 3 * x, sd = exp(1 + 0.3* x))
norm_data &lt;- data.frame(y = y, x = x)

# It does not matter the order of distribution parameters
formulas &lt;- list(sd.fo = ~ x, mean.fo = ~ x)

norm_mod &lt;- maxlogLreg(formulas, y_dist = y ~ dnorm, data = norm_data,
                       link = list(over = "sd", fun = "log_link"))
predict(norm_mod)


#--------------------------------------------------------------------------------
# Example 2: Predictions using new values for covariates
predict(norm_mod, newdata = data.frame(x=0:6))


#--------------------------------------------------------------------------------
# Example 3: Predictions for another parameter
predict(norm_mod, newdata = data.frame(x=0:6), param = "sd",
       type = "response")

#--------------------------------------------------------------------------------
# Example 4: Model terms
predict(norm_mod, param = "sd", type = "terms")


#--------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='print.HazardShape'>Print method for <code>HazardShape</code> objects</h2><span id='topic+print.HazardShape'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Displays the estimated hazard shape given a <code>HazardShape</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HazardShape'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.HazardShape_+3A_x">x</code></td>
<td>
<p>an object of class <code>HazardShape</code>, generated with
<code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code>.</p>
</td></tr>
<tr><td><code id="print.HazardShape_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------------------------------
# Example 1: Increasing hazard and its corresponding TTT plot with simulated data

hweibull &lt;- function(x, shape, scale){
  dweibull(x, shape, scale)/pweibull(x, shape, scale, lower.tail = FALSE)
  }
curve(hweibull(x, shape = 2.5, scale = pi), from = 0, to = 42,
               col = "red", ylab = "Hazard function", las = 1, lwd = 2)

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
my_initial_guess &lt;- TTT_hazard_shape(formula = y ~ 1)
print(my_initial_guess)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='reduction_cells'>Reduction cells</h2><span id='topic+reduction_cells'></span>

<h3>Description</h3>

<p>Times to failure (in units of 1000 days) of 20 aluminum reduction cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reduction_cells
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations.
</p>


<h3>References</h3>

<p>Whitmore GA (1983).
&ldquo;A regression method for censored inverse-Gaussian data.&rdquo;
<em>Canadian Journal of Statistics</em>, <b>11</b>(4), 305&ndash;315.
ISSN 03195724, <a href="https://doi.org/10.2307/3314888">doi:10.2307/3314888</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(reduction_cells)
par(mfrow = c(1,2))
hist(reduction_cells$days, main="", xlab="Time (Days)")
plot(reduction_cells$status, xlab = "Status", lty = 3, type="h")
points(reduction_cells$status, pch = 16)

</code></pre>

<hr>
<h2 id='residuals.maxlogL'>Extract Residuals from <code>maxlogL</code> model.</h2><span id='topic+residuals.maxlogL'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>residuals.,axlogL</code> is the <code>maxlogLreg</code> specific method for the
generic function residuals which extracts the residuals from a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'maxlogL'
residuals(object, parameter = NULL, type = c("deviance", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.maxlogL_+3A_object">object</code></td>
<td>
<p>an object of <code><a href="#topic+maxlogL">maxlogL</a></code> class which summary is desired.</p>
</td></tr>
<tr><td><code id="residuals.maxlogL_+3A_parameter">parameter</code></td>
<td>
<p>a character which specifies the parameter whose normalized
quantile residuals will be computed.</p>
</td></tr>
<tr><td><code id="residuals.maxlogL_+3A_type">type</code></td>
<td>
<p>a character with the type of residuals to be computed required.
The default value is <code>type = "rqres"</code>, which is used to
compute the normalized randomized quantile residuals.</p>
</td></tr>
<tr><td><code id="residuals.maxlogL_+3A_...">...</code></td>
<td>
<p>for extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>type = "deviance"</code>, the residuals are computed using the following
expression
</p>
<p style="text-align: center;"><code class="reqn">r^D_i = \mbox{sign}(y_i - \hat{\mu}_i) d_i^{1/2},</code>
</p>

<p>where <code class="reqn">d_i</code> is the residual deviance of each data point. In this context,
<code class="reqn">\hat{\mu}</code> is the estimated mean, computed as the expected value using
the estimated parameters of a fitted <code>maxlogLreg</code> model.
</p>
<p>On the other hand, for <code>type = "response"</code> the computation is simpler
</p>
<p style="text-align: center;"><code class="reqn">r^R_i = (y_i - \hat{\mu}_i).</code>
</p>



<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>

<hr>
<h2 id='summary.maxlogL'>Summarize Maximum Likelihood Estimation</h2><span id='topic+summary.maxlogL'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>Displays maximum likelihood estimates computed with <code><a href="#topic+maxlogL">maxlogL</a></code> with
its standard errors, AIC and BIC.
This is a <code>summary</code> method for <code><a href="#topic+maxlogL">maxlogL</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'maxlogL'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.maxlogL_+3A_object">object</code></td>
<td>
<p>an object of <code><a href="#topic+maxlogL">maxlogL</a></code> class which summary is desired.</p>
</td></tr>
<tr><td><code id="summary.maxlogL_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <code>summary</code> method computes and displays AIC, BIC,
estimates and standard errors from a estimated model stored i a <code>maxlogL</code>
class object. It  also displays and computes Z-score and p values of significance
test of parameters.
</p>


<h3>Value</h3>

<p>A list with information that summarize results of a <code>maxlogL</code> class object.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+maxlogL">maxlogL</a></code>, <code><a href="#topic+maxlogLreg">maxlogLreg</a></code>,
<code><a href="#topic+bootstrap_maxlogL">bootstrap_maxlogL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
### First example: One known parameter

x &lt;- rnorm(n = 10000, mean = 160, sd = 6)
theta_1 &lt;- maxlogL(x = x, dist = 'dnorm', control = list(trace = 1),
                 link = list(over = "sd", fun = "log_link"),
                 fixed = list(mean = 160))
summary(theta_1)


#--------------------------------------------------------------------------------
# Second example: Binomial probability parameter estimation with variable
# creation

N &lt;- rbinom(n = 100, size = 10, prob = 0.3)
phat &lt;- maxlogL(x = N, dist = 'dbinom', fixed = list(size = 10),
                link = list(over = "prob", fun = "logit_link"))

## Standard error calculation method
print(phat$outputs$StdE_Method)

## 'summary' method
summary(phat)

#--------------------------------------------------------------------------------
# Third example: Binomial probability parameter estimation with no variable
# creation

N &lt;- rbinom(n = 100, size = 10, prob = 0.3)
summary(maxlogL(x = N, dist = 'dbinom', fixed = list(size = 10),
                link = list(over = "prob", fun = "logit_link")))

#--------------------------------------------------------------------------------
# Fourth example: Estimation in a regression model with simulated normal data
n &lt;- 1000
x &lt;- runif(n = n, -5, 6)
y &lt;- rnorm(n = n, mean = -2 + 3 * x, sd = exp(1 + 0.3* x))
norm_data &lt;- data.frame(y = y, x = x)
formulas &lt;- list(sd.fo = ~ x, mean.fo = ~ x)

norm_mod &lt;- maxlogLreg(formulas, y_dist = y ~ dnorm, data = norm_data,
                       link = list(over = "sd", fun = "log_link"))

## 'summary' method
summary(norm_mod)


#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='summate'>Summation of One-Dimensional Functions</h2><span id='topic+summate'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Discrete summation of functions of one variable over a finite or semi-infinite
interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summate(fun, lower, upper, tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summate_+3A_fun">fun</code></td>
<td>
<p>an <strong>R</strong> function which should take a numeric argument x and
possibly some parameters. The function returns a numerical vector
value for the given argument <code>x</code>.</p>
</td></tr>
<tr><td><code id="summate_+3A_lower">lower</code></td>
<td>
<p>a numeric value for the lower limit of the integral.</p>
</td></tr>
<tr><td><code id="summate_+3A_upper">upper</code></td>
<td>
<p>a numeric value for the upper limit of the integral.</p>
</td></tr>
<tr><td><code id="summate_+3A_tol">tol</code></td>
<td>
<p>a numeric value indicating the accuracy of the result (useful in
infinite summations).</p>
</td></tr>
<tr><td><code id="summate_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>fun</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments after <code>...</code> must be matched exactly. If both limits are infinite,
the function fails. For semi-infinite intervals, the summation must be convergent.
This is accomplished in manny probability mass functions.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)


#----------------------------------------------------------------------------
# Example 1: Poisson expected value computation, X ~ Poisson(lambda = 15)
Poisson_integrand &lt;- function(x, lambda) {
  x * lambda^x * exp(-lambda)/factorial(x)
}

summate(fun = Poisson_integrand, lower = 0, upper = Inf, lambda = 15)


#----------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='TTT_hazard_shape'>Hazard Shape estimation from TTT plot</h2><span id='topic+TTT_hazard_shape'></span><span id='topic+TTT_hazard_shape.formula'></span><span id='topic+TTT_hazard_shape.EmpiricalTTT'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function can be used so as to estimate hazard shape corresponding
to a given data set. This is a wrapper for
<code><a href="#topic+TTTE_Analytical">TTTE_Analytical</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTT_hazard_shape(object, ...)

## S3 method for class 'formula'
TTT_hazard_shape(
  formula,
  data = NULL,
  local_reg = loess.options(),
  interpolation = interp.options(),
  silent = FALSE,
  ...
)

## S3 method for class 'EmpiricalTTT'
TTT_hazard_shape(
  object,
  local_reg = loess.options(),
  interpolation = interp.options(),
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTT_hazard_shape_+3A_object">object</code></td>
<td>
<p>An alternative way for getting the hazard shape
estimation in passing directly the <code>EmpiricalTTT</code> object
generated with <code><a href="#topic+TTTE_Analytical">TTTE_Analytical</a></code>.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_...">...</code></td>
<td>
<p>further arguments passed to
<code><a href="#topic+TTTE_Analytical">TTTE_Analytical</a></code>.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_formula">formula</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+formula">formula</a></code> with the response on
the left of an operator <code>~</code>. The right side must be
<code>1</code>.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the response variables. If
data is not specified, the variables are taken from the
environment from which <code><a href="#topic+TTT_hazard_shape">TTT_hazard_shape</a></code> is called.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_local_reg">local_reg</code></td>
<td>
<p>a list of control parameters for LOESS. See
<code><a href="#topic+loess.options">loess.options</a></code>.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_interpolation">interpolation</code></td>
<td>
<p>a list of control parameters for interpolation function. See
<code><a href="#topic+interp.options">interp.options</a></code>.</p>
</td></tr>
<tr><td><code id="TTT_hazard_shape_+3A_silent">silent</code></td>
<td>
<p>logical. If TRUE, warnings of <code>TTT_hazard_shape</code> are suppressed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a non-parametric estimation of the empirical total
time on test (TTT) plot. Then, this estimated curve can be used so as to
get suggestions about initial values and the search region for parameters
based on hazard shape associated to the  shape of empirical TTT plot.
</p>
<p>Use <code><a href="#topic+Hazard_Shape">Hazard_Shape</a></code> function to get the results for shape estimation.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.HazardShape">print.HazardShape</a></code>, <code><a href="#topic+plot.HazardShape">plot.HazardShape</a></code>,
<code><a href="#topic+TTTE_Analytical">TTTE_Analytical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#--------------------------------------------------------------------------------
# Example 1: Increasing hazard and its corresponding TTT statistic with
#            simulated data

hweibull &lt;- function(x, shape, scale){
  dweibull(x, shape, scale)/pweibull(x, shape, scale, lower.tail = FALSE)
  }
curve(hweibull(x, shape = 2.5, scale = pi), from = 0, to = 42,
               col = "red", ylab = "Hazard function", las = 1, lwd = 2)

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
status &lt;- c(rep(1, 48), rep(0, 2))
my_initial_guess1 &lt;- TTT_hazard_shape(Surv(y, status) ~ 1)
my_initial_guess1$hazard_type


#--------------------------------------------------------------------------------
# Example 2: Same example using an 'EmpiricalTTT' object

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
TTT_wei &lt;- TTTE_Analytical(y ~ 1)
my_initial_guess2 &lt;- TTT_hazard_shape(TTT_wei)
my_initial_guess2$hazard_type


#--------------------------------------------------------------------------------
# Example 3: Increasing hazard with simulated censored data

hweibull &lt;- function(x, shape, scale){
  dweibull(x, shape, scale)/pweibull(x, shape, scale, lower.tail = FALSE)
  }
curve(hweibull(x, shape = 2.5, scale = pi), from = 0, to = 42,
               col = "red", ylab = "Hazard function", las = 1, lwd = 2)

y &lt;- rweibull(n = 50, shape = 2.5, scale = pi)
y &lt;- sort(y)
status &lt;- c(rep(1, 45), rep(0, 5))
my_initial_guess1 &lt;- TTT_hazard_shape(Surv(y, status) ~ 1)
my_initial_guess1$hazard_type


#--------------------------------------------------------------------------------
</code></pre>

<hr>
<h2 id='TTTE_Analytical'>Empirical Total Time on Test (TTT), analytic version.</h2><span id='topic+TTTE_Analytical'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function allows to compute the TTT curve from a formula
containing a factor type variable (classification variable).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TTTE_Analytical(
  formula,
  response = NULL,
  scaled = TRUE,
  data = NULL,
  method = c("Barlow", "censored"),
  partition_method = NULL,
  silent = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TTTE_Analytical_+3A_formula">formula</code></td>
<td>
<p>an object of class <code><a href="stats.html#topic+formula">formula</a></code> with the response on
the left of an operator <code>~</code>. The right side can be a factor
variable as term or an <code>1</code> if a classification by factor
levels is not desired.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_response">response</code></td>
<td>
<p>an optional numeric vector with data of the response variable.
Using this argument is equivalent to define a formula with the
right side such as <code>~ 1</code>. See the fourth example below.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_scaled">scaled</code></td>
<td>
<p>logical. If <code>TRUE</code> (default value), scaled TTT is computed.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables (response and the
factor, if it is desired). If data is not specified, the variables
are taken from the environment from which <code>TTT_analytical</code>
is called.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_method">method</code></td>
<td>
<p>a character specifying the method of computation. There are two
options available: <code>'Barlow'</code> and <code>'censored'</code>. Further
information can be found in the <strong>Details</strong> section.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_partition_method">partition_method</code></td>
<td>
<p>a list specifying cluster formation when the covariate in
<code>formula</code> is numeric, or when the data has several
covariates. 'quantile-based' method is the only one
currently available (See the last example).</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_silent">silent</code></td>
<td>
<p>logical. If TRUE, warnings of <code>TTTE_Analytical</code> are suppressed.</p>
</td></tr>
<tr><td><code id="TTTE_Analytical_+3A_...">...</code></td>
<td>
<p>further arguments passing to <code><a href="survival.html#topic+survfit">survfit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>method</code> argument is set as <code>'Barlow'</code>, this function
uses the original expression of empirical TTT presented by
Barlow (1979)  and used by
Aarset (1987):
</p>
<p style="text-align: center;"><code class="reqn">\phi_n\left( \frac{r}{n}\right) = \frac{\left( \sum_{i=1}^{r} T_{(i)} \right) +
(n-r)T_{(r)}}{\sum_{i=1}^{n} T_i}</code>
</p>

<p>where <code class="reqn">T_{(r)}</code> is the <code class="reqn">r^{th}</code> order statistic, with
<code class="reqn">r=1,2,\dots, n</code>, and <code class="reqn">n</code> is the sample size. On the other hand, the option
<cite>'censored'</cite> is an implementation based on integrals presented in
Westberg and Klefsjö (1994), and using
<code><a href="survival.html#topic+survfit">survfit</a></code> to compute the Kaplan-Meier estimator:
</p>
<p style="text-align: center;"><code class="reqn">\phi_n\left( \frac{r}{n}\right) = \sum_{j=1}^{r} \left[ \prod_{i=1}^{j}
\left( 1 - \frac{d_i}{n_i}\right) \right] \left(T_{(j)} - T_{(j-1)} \right)</code>
</p>



<h3>Value</h3>

<p>A list with class object <code>Empirical.TTT</code> containing a list with the
following information:
</p>
<table>
<tr><td><code>i/n`</code></td>
<td>
<p>A matrix containing the empirical quantiles. This matrix has the
number of columns equals to the number of levels of the factor
considered (number of strata).</p>
</td></tr>
<tr><td><code>phi_n</code></td>
<td>
<p>A matrix containing the values of empirical TTT. his matrix has the
number of columns equals to the number of levels of the factor
considered (number of strata).</p>
</td></tr>
<tr><td><code>strata</code></td>
<td>
<p>A numeric named vector storing the number of observations per strata,
and the name of each strata (names of the levels of the factor).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Barlow RE (1979).
&ldquo;Geometry of the total time on test transform.&rdquo;
<em>Naval Research Logistics Quarterly</em>, <b>26</b>(3), 393&ndash;402.
ISSN 00281441, <a href="https://doi.org/10.1002/nav.3800260303">doi:10.1002/nav.3800260303</a>.
</p>
<p>Aarset MV (1987).
&ldquo;How to Identify a Bathtub Hazard Rate.&rdquo;
<em>IEEE Transactions on Reliability</em>, <b>R-36</b>(1), 106&ndash;108.
ISSN 15581721, <a href="https://doi.org/10.1109/TR.1987.5222310">doi:10.1109/TR.1987.5222310</a>.
</p>
<p>Klefsjö B (1991).
&ldquo;TTT-plotting - a tool for both theoretical and practical problems.&rdquo;
<em>Journal of Statistical Planning and Inference</em>, <b>29</b>(1-2), 99&ndash;110.
ISSN 03783758, <a href="https://doi.org/10.1016/0378-3758%2892%2990125-C">doi:10.1016/0378-3758(92)90125-C</a>, <a href="https://linkinghub.elsevier.com/retrieve/pii/037837589290125C">https://linkinghub.elsevier.com/retrieve/pii/037837589290125C</a>.
</p>
<p>Westberg U, Klefsjö B (1994).
&ldquo;TTT-plotting for censored data based on the piecewise exponential estimator.&rdquo;
<em>International Journal of Reliability, Quality and Safety Engineering</em>, <b>01</b>(01), 1&ndash;13.
ISSN 0218-5393, <a href="https://doi.org/10.1142/S0218539394000027">doi:10.1142/S0218539394000027</a>, <a href="https://www.worldscientific.com/doi/abs/10.1142/S0218539394000027">https://www.worldscientific.com/doi/abs/10.1142/S0218539394000027</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.EmpiricalTTT">plot.EmpiricalTTT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#--------------------------------------------------------------------------------
# Example 1: Scaled empirical TTT from 'mgus1' data from 'survival' package.

TTT_1 &lt;- TTTE_Analytical(Surv(stop, event == 'pcm') ~1, method = 'cens',
                         data = mgus1, subset=(start == 0))
head(TTT_1$`i/n`)
head(TTT_1$phi_n)
print(TTT_1$strata)


#--------------------------------------------------------------------------------
# Example 2: Scaled empirical TTT using a factor variable with 'aml' data
# from 'survival' package.

TTT_2 &lt;- TTTE_Analytical(Surv(time, status) ~ x, method = "cens", data = aml)
head(TTT_2$`i/n`)
head(TTT_2$phi_n)
print(TTT_2$strata)

#--------------------------------------------------------------------------------
# Example 3: Non-scaled empirical TTT without a factor (arbitrarily simulated
# data).

set.seed(911211)
y &lt;- rweibull(n=20, shape=1, scale=pi)
TTT_3 &lt;- TTTE_Analytical(y ~ 1, scaled = FALSE)
head(TTT_3$`i/n`)
head(TTT_3$phi_n)
print(TTT_3$strata)


#--------------------------------------------------------------------------------
# Example 4: non-scaled empirical TTT without a factor (arbitrarily simulated
# data) using the 'response' argument (this is equivalent to Third example).

set.seed(911211)
y &lt;- rweibull(n=20, shape=1, scale=pi)
TTT_4 &lt;- TTTE_Analytical(response = y, scaled = FALSE)
head(TTT_4$`i/n`)
head(TTT_4$phi_n)
print(TTT_4$strata)

#--------------------------------------------------------------------------------
# Eample 5: empirical TTT with a continuously variant term for the shape
# parameter in Weibull distribution.

x &lt;- runif(50, 0, 10)
shape &lt;- 0.1 + 0.1*x
y &lt;- rweibull(n = 50, shape = shape, scale = pi)

partitions &lt;- list(method='quantile-based',
                   folds=5)
TTT_5 &lt;- TTTE_Analytical(y ~ x, partition_method = partitions)
head(TTT_5$`i/n`)
head(TTT_5$phi_n)
print(TTT_5$strata)
plot(TTT_5) # Observe changes in Empirical TTT

#--------------------------------------------------------------------------------

</code></pre>

<hr>
<h2 id='uniform_key'>Uniform key function</h2><span id='topic+uniform_key'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function provides the uniform key function for model fitting in
distance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniform_key(x, w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniform_key_+3A_x">x</code></td>
<td>
<p>vector of perpendicular distances from the transect.</p>
</td></tr>
<tr><td><code id="uniform_key_+3A_w">w</code></td>
<td>
<p>half width of the strip transect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the uniform key function with parameter
<code>sigma</code>. Its expression is given by
</p>
<p><code class="reqn">g(x) = \frac{1}{w},</code>
</p>
<p>for x &gt; 0.
</p>


<h3>Value</h3>

<p>A numeric value corresponding to a given value of <code>x</code> and
<code>w</code>.
</p>


<h3>Author(s)</h3>

<p>Jaime Mosquera Gutiérrez, <a href="mailto:jmosquerag@unal.edu.co">jmosquerag@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p>Other key functions: 
<code><a href="#topic+half_norm_key">half_norm_key</a>()</code>,
<code><a href="#topic+hazard_rate_key">hazard_rate_key</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(EstimationTools)

#----------------------------------------------------------------------------
# Example: Uniform function
uniform_key(x=1, w=100)
curve(uniform_key(x, w=100), from=0, to=10, ylab='g(x)')

#----------------------------------------------------------------------------
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
