<!DOCTYPE html><html><head><title>Help for package cosinor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cosinor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cosinor_analyzer'><p>Shiny application to demonstrate cosinor fit</p></a></li>
<li><a href='#cosinor.lm'><p>Fit cosinor model</p></a></li>
<li><a href='#cosinor.lm.default'><p>Fit cosinor model</p></a></li>
<li><a href='#get_varnames'><p>Extract variable names from terms object, handling specials</p></a></li>
<li><a href='#ggplot_cosinor.lm'><p>Plot a cosinor model</p></a></li>
<li><a href='#predict.cosinor.lm'><p>Predict from a cosinor model</p></a></li>
<li><a href='#print.cosinor.lm'><p>Print cosinor model</p></a></li>
<li><a href='#print.summary.cosinor.lm'><p>Print the summary of a cosinor model</p></a></li>
<li><a href='#print.test'><p>Print test of model</p></a></li>
<li><a href='#print.test_cosinor'><p>Print results of test of cosinor model</p></a></li>
<li><a href='#simulate_cosinor'><p>Simulate data from a cosinor model</p></a></li>
<li><a href='#summary.cosinor.lm'><p>Summarize a cosinor model</p></a></li>
<li><a href='#test_cosinor'><p>Test for differences in a cosinor model</p></a></li>
<li><a href='#update_covnames'><p>Replace covariate names with descriptive text</p></a></li>
<li><a href='#vitamind'><p>Vitamin D</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Estimating and Predicting the Cosinor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Sachs &lt;sachsmc@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Sachs &lt;sachsmc@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of simple functions that transforms longitudinal
    data to estimate the cosinor linear model as described in Tong (1976).
    Methods are given to summarize the mean, amplitude and acrophase, to
    predict the mean annual outcome value, and to test the coefficients.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sachsmc/cosinor">https://github.com/sachsmc/cosinor</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.11.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, shiny</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-21 07:55:13 UTC; sachsmc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-21 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cosinor_analyzer'>Shiny application to demonstrate cosinor fit</h2><span id='topic+cosinor_analyzer'></span>

<h3>Description</h3>

<p>Given a dataset, specify the outcome, time variable, and optional covariates. The app will then perform a cosinor analysis and plot the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor_analyzer(data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor_analyzer_+3A_data">data</code></td>
<td>
<p>Data frame to analyze</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(shiny)
cosinor_analyzer(vitamind)

## End(Not run)

</code></pre>

<hr>
<h2 id='cosinor.lm'>Fit cosinor model</h2><span id='topic+cosinor.lm'></span>

<h3>Description</h3>

<p>Given an outcome and time variable, fit the cosinor model with optional
covariate effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor.lm(formula, period = 12, data, na.action = na.omit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor.lm_+3A_formula">formula</code></td>
<td>
<p>Formula specifying the model. Indicate the time variable with
<code>time()</code> and covariate effects on the amplitude and acrophase with
<code>amp.acro()</code>. See details for more information.</p>
</td></tr>
<tr><td><code id="cosinor.lm_+3A_period">period</code></td>
<td>
<p>Length of time for a complete period of the sine curve.</p>
</td></tr>
<tr><td><code id="cosinor.lm_+3A_data">data</code></td>
<td>
<p>Data frame where variable can be found</p>
</td></tr>
<tr><td><code id="cosinor.lm_+3A_na.action">na.action</code></td>
<td>
<p>What to do with missing data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This defines special functions that are used in the formula to
indicate the time variable and which covariates effect the amplitude. To
indicate the time variable wrap the name of it in the function
<code>time()</code>. To indicate a variable which affects the
acrophase/amplitude, wrap the name in <code>amp.acro()</code>. This will then do
all the transformations for you. See examples for usage.
</p>


<h3>References</h3>

<p>Tong, YL. Parameter Estimation in Studying Circadian Rhythms, Biometrics (1976). 32(1):85&ndash;94.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)

</code></pre>

<hr>
<h2 id='cosinor.lm.default'>Fit cosinor model</h2><span id='topic+cosinor.lm.default'></span>

<h3>Description</h3>

<p>Given an outcome and time variable, fit the cosinor model with optional covariate effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor.lm.default(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor.lm.default_+3A_formula">formula</code></td>
<td>
<p>Forumla specifying the model. Indicate the time variable with <code>time()</code> and covariate effects on the
amplitude and acrophase with <code>amp.acro()</code>. See details.</p>
</td></tr>
<tr><td><code id="cosinor.lm.default_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This defines special functions that are used in the formula to indicate the time variable
and which covariates effect the amplitude. To indicate the time variable wrap the name of it in the function
<code>time()</code>. To indicate a variable which affects the acrophase/amplitude, wrap the name in
<code>amp.acro()</code>. This will then do all the transformations for you. See examples for usage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)

</code></pre>

<hr>
<h2 id='get_varnames'>Extract variable names from terms object, handling specials</h2><span id='topic+get_varnames'></span>

<h3>Description</h3>

<p>Extract variable names from terms object, handling specials
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_varnames(Terms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_varnames_+3A_terms">Terms</code></td>
<td>
<p>a terms object</p>
</td></tr>
</table>

<hr>
<h2 id='ggplot_cosinor.lm'>Plot a cosinor model</h2><span id='topic+ggplot_cosinor.lm'></span>

<h3>Description</h3>

<p>Given a cosinor.lm model fit, generate a plot of the data with the fitted values.
Optionally allows for plotting by covariate levels 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggplot_cosinor.lm(object, x_str = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggplot_cosinor.lm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosinor.lm</code></p>
</td></tr>
<tr><td><code id="ggplot_cosinor.lm_+3A_x_str">x_str</code></td>
<td>
<p>Character vector naming the covariate(s) to be plotted. May be NULL to plot overall curve</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)
ggplot_cosinor.lm(fit, "X")

</code></pre>

<hr>
<h2 id='predict.cosinor.lm'>Predict from a cosinor model</h2><span id='topic+predict.cosinor.lm'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate predicted values from
a cosinor fit. Default prediction is the mean value, optionally can predict
at a given month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosinor.lm'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.cosinor.lm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosinor.lm</code></p>
</td></tr>
<tr><td><code id="predict.cosinor.lm_+3A_newdata">newdata</code></td>
<td>
<p>Optional new data</p>
</td></tr>
<tr><td><code id="predict.cosinor.lm_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)
predict(fit)

</code></pre>

<hr>
<h2 id='print.cosinor.lm'>Print cosinor model</h2><span id='topic+print.cosinor.lm'></span>

<h3>Description</h3>

<p>Given an outcome and time variable, fit the cosinor model with optional covariate effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosinor.lm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cosinor.lm_+3A_x">x</code></td>
<td>
<p>cosinor.lm object</p>
</td></tr>
<tr><td><code id="print.cosinor.lm_+3A_...">...</code></td>
<td>
<p>passed to summary</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.cosinor.lm'>Print the summary of a cosinor model</h2><span id='topic+print.summary.cosinor.lm'></span>

<h3>Description</h3>

<p>Print the summary of a cosinor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.cosinor.lm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.cosinor.lm_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.cosinor.lm</code></p>
</td></tr>
<tr><td><code id="print.summary.cosinor.lm_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)
summary(fit)

</code></pre>

<hr>
<h2 id='print.test'>Print test of model</h2><span id='topic+print.test'></span>

<h3>Description</h3>

<p>Print test of model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'test'
print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.test_+3A_x">x</code></td>
<td>
<p>test object</p>
</td></tr>
</table>

<hr>
<h2 id='print.test_cosinor'>Print results of test of cosinor model</h2><span id='topic+print.test_cosinor'></span>

<h3>Description</h3>

<p>Print results of test of cosinor model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'test_cosinor'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.test_cosinor_+3A_x">x</code></td>
<td>
<p>test_cosinor object</p>
</td></tr>
<tr><td><code id="print.test_cosinor_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>print</code></p>
</td></tr>
</table>

<hr>
<h2 id='simulate_cosinor'>Simulate data from a cosinor model</h2><span id='topic+simulate_cosinor'></span>

<h3>Description</h3>

<p>This function simulates data from a cosinor model with a single covariate,
where the time scale is month, and optionally
allows for single covariate effects on the mean,
amplitude, and acrophase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_cosinor(n, beta.mean = 2, beta.amp = 0, beta.acro = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_cosinor_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.mean">beta.mean</code></td>
<td>
<p>Effect on the mean (intercept)</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.amp">beta.amp</code></td>
<td>
<p>Effect on the amplitude</p>
</td></tr>
<tr><td><code id="simulate_cosinor_+3A_beta.acro">beta.acro</code></td>
<td>
<p>Effect on the acrophase</p>
</td></tr>
</table>

<hr>
<h2 id='summary.cosinor.lm'>Summarize a cosinor model</h2><span id='topic+summary.cosinor.lm'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate inference a cosinor
fit. Gives estimates, confidence intervals, and tests for the raw parameters,
and for the mean, amplitude, and acrophase parameters. If the model includes
covariates, the function returns the estimates of the mean, amplitude, and
acrophase for the group with covariates equal to 1 and equal to 0. This may
not be the desired result for continuous covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosinor.lm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cosinor.lm_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosinor.lm</code></p>
</td></tr>
<tr><td><code id="summary.cosinor.lm_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)
summary(fit)

</code></pre>

<hr>
<h2 id='test_cosinor'>Test for differences in a cosinor model</h2><span id='topic+test_cosinor'></span>

<h3>Description</h3>

<p>Given a time variable and optional covariates, generate inference a cosinor
fit. For the covariate named (or vector of covariates), this function
performs a Wald test comparing the group with covariates equal to 1 to the
group with covariates equal to 0. This may not be the desired result for
continuous covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_cosinor(object, x_str, param = "amp")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_cosinor_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosinor.lm</code></p>
</td></tr>
<tr><td><code id="test_cosinor_+3A_x_str">x_str</code></td>
<td>
<p>Character naming the covariate whose amplitude/acrophase will be tested</p>
</td></tr>
<tr><td><code id="test_cosinor_+3A_param">param</code></td>
<td>
<p>Character string naming the parameter to test, either &quot;amp&quot; for
amplitude or &quot;acr&quot; for acrophase</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- cosinor.lm(Y ~ time(time) + X + amp.acro(X), data = vitamind)
test_cosinor(fit, "X", "amp")

</code></pre>

<hr>
<h2 id='update_covnames'>Replace covariate names with descriptive text</h2><span id='topic+update_covnames'></span>

<h3>Description</h3>

<p>Replace covariate names with descriptive text
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_covnames(names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_covnames_+3A_names">names</code></td>
<td>
<p>Coefficient names to update</p>
</td></tr>
</table>

<hr>
<h2 id='vitamind'>Vitamin D</h2><span id='topic+vitamind'></span>

<h3>Description</h3>

<p>Simulated data set to illustrate the cosinor model. <code>Y</code>
is an outcome variable that varies of time <code>time</code> according
to a cosine curve. The binary covariate <code>X</code> is associated with the
mean and amplitude of the cosine curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vitamind
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables: <code>X</code>, <code>Y</code>,
<code>time</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
