<!DOCTYPE html><html lang="en"><head><title>Help for package avotrex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {avotrex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AvoBind'><p>AvoBind - Bind extinct species to the tree</p></a></li>
<li><a href='#AvoPhylo'><p>AvoPhylo: Building phylogenies based on the AvoTrex extinct bird trait</p>
database and BirdTree backbone</a></li>
<li><a href='#AvotrexPhylo'>
<p>Avotrex phylo dataset</p></a></li>
<li><a href='#BirdTree_tax'>
<p>Bird Tree taxonomic data</p></a></li>
<li><a href='#BirdTree_trees'>
<p>Bird Tree trees</p></a></li>
<li><a href='#plot.avophylo'><p>Plot Model Fits for an 'avophylo' Object</p></a></li>
<li><a href='#plot.multiAvophylo'><p>Plot Model Fits for an 'multiAvophylo' Object</p></a></li>
<li><a href='#treesEx'><p>A set of three AvoPhylo trees</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Global Dataset of Anthropogenic Extinct Birds and their
Traits: Phylogeny Builder</td>
</tr>
<tr>
<td>Description:</td>
<td>Grafts the extinct bird species from the 'Avotrex' database (Sayol et al., in review) on to the 'BirdTree' phylogenies <a href="https://birdtree.org">https://birdtree.org</a>, using a set of different commands.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, doParallel, doSNOW, dplyr, foreach, parallel, phytools,
snow, stringr, tidytree (&ge; 0.4.6), TreeTools, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, markdown, knitr, rmarkdown, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-30 14:26:42 UTC; Joe</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Wayman <a href="https://orcid.org/0000-0002-3122-8070"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Thomas J. Matthews
    <a href="https://orcid.org/0000-0002-7624-244X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Paul Dufour [ctb],
  Ferran Sayol [ctb],
  Pedro Cardoso [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Wayman &lt;j.wayman@bham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-30 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AvoBind'>AvoBind - Bind extinct species to the tree</h2><span id='topic+AvoBind'></span>

<h3>Description</h3>

<p>Binds an extinct species at either (1) a randomly selected point
along a branch, after truncating either end, (2) a specific fraction along
a branch, or (3) a specific time point along a branch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AvoBind(tree, node, per, per_fixed = FALSE, sp_name,
 time_graft = FALSE, terminal = FALSE, mindist = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AvoBind_+3A_tree">tree</code></td>
<td>
<p>Tree object (i.e., phylogeny)</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_node">node</code></td>
<td>
<p>Target node</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_per">per</code></td>
<td>
<p>The fraction (0-1) of total branch length to truncate at either
end of the branch for grafting (e.g. 0.2 cuts of 20% of the total branch
length from either end) if <code>per_fixed == FALSE</code>. If <code>per_fixed
== TRUE</code>, then the point along the branch where the grafting occurs: value
between 0-1, with a larger number meaning the grafting occurs closer to the
rootward end of the branch. If <code>time_graft = TRUE</code>, the specific point
(in millions of years, if BirdTree trees are used) for the grafting to
occur.</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_per_fixed">per_fixed</code></td>
<td>
<p>Logical argument: whether to graft a species on at an exact
point (as a fraction) along a branch (TRUE), which is chosen using the
<code>per</code> argument, rather than random (FALSE; default). Is ignored if
<code>time_graft = TRUE</code>.</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_sp_name">sp_name</code></td>
<td>
<p>Name of the grafted species.</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_time_graft">time_graft</code></td>
<td>
<p>Should the grafting occur at a particular time point (in
millions of years if BirdTree trees provided) along a given branch, using
<code>avotrex:::AgeBind()</code>. The specific point is provided using the
<code>per</code> argument.</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_terminal">terminal</code></td>
<td>
<p>Logical value: if <code>time_graft = TRUE</code>, is the species
being grafted to a terminal branch.</p>
</td></tr>
<tr><td><code id="AvoBind_+3A_mindist">mindist</code></td>
<td>
<p>If <code>time_graft = TRUE</code>, but the provided grafting time
point (<code>per</code>) is too old (i.e., older than the parent node) or too
young (i.e., younger than the child node) relative to the focal branch,
grafting will occur <code>mindist</code> below the parent node or above the child
node.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a tree of class &quot;phylo&quot;, with the extinct species grafted on.
</p>


<h3>Author(s)</h3>

<p>Joe Wayman, Tom Matthews and Pedro Cardoso (AgeBind)
</p>

<hr>
<h2 id='AvoPhylo'>AvoPhylo: Building phylogenies based on the AvoTrex extinct bird trait
database and BirdTree backbone</h2><span id='topic+AvoPhylo'></span>

<h3>Description</h3>

<p>Grafting extinct species onto BirdTree phylogenies using the AvoTrex database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AvoPhylo(ctrees, avotrex, tax, PER = 0.2, PER_FIXED = 0.75, mindist =
  0.1, ord = FALSE, Ntree, n.cores = 1, cluster.ips = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AvoPhylo_+3A_ctrees">ctrees</code></td>
<td>
<p>Either (i) object (of class multiPhylo) containing multiple
BirdTree phylogenies. Individual trees within the multiPhylo object must be
of class 'phylo', see the <code>ape</code> package. Or (ii) an individual tree
object of class 'phylo'.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_avotrex">avotrex</code></td>
<td>
<p>The AvoTrex extinct species phylogeny database. This database
contains the information and commands required to graft the extinct species
on to the BirdTree trees. If edited, column names must remain unchanged.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_tax">tax</code></td>
<td>
<p>The Jetz et al. (2012) BirdTree taxonomy .csv. Supplied as data
within the package.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_per">PER</code></td>
<td>
<p>Percentage/fraction for branch truncation based on random grafting
(see <code><a href="#topic+AvoBind">AvoBind</a></code> for more details). Can be left at the default
value.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_per_fixed">PER_FIXED</code></td>
<td>
<p>Point along a branch (expressed as a fraction
of the branch length, rootward) to graft the species in the
phylogeny database (<code>avotrex</code> argument) which are set
to TRUE in the per_fixed column (to reduce very short branch
lengths) (see <code><a href="#topic+AvoBind">AvoBind</a></code> for more details). Can
be left at the default value.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_mindist">mindist</code></td>
<td>
<p>When fixing the grafting of a given species at
a specific time point, but the provided grafting time point
is too old (i.e., older than the parent node) or too young
(i.e., younger than the child node) relative to the focal
branch, grafting will occur <code>mindist</code> below the parent
node or above the child node.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_ord">ord</code></td>
<td>
<p>Should the trees within <code>ctrees</code> be kept in
order (TRUE) and all used (i.e., the output list of trees is
in the same order as <code>ctrees</code>) in the grafting, or
should trees be randomly sampled from <code>ctrees</code> (FALSE;
the default) prior to grafting. If <code>ord == TRUE</code>,
<code>Ntree</code> must equal the length of <code>ctrees</code>. If only
a single tree is provided, this argument does nothing.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_ntree">Ntree</code></td>
<td>
<p>The number of trees to sample from the supplied
number of BirdTree trees (i.e., <code>ctrees</code>), if <code>ord
  == FALSE</code>. Value must be greater or equal to the number of
supplied trees (<code>length(ctrees))</code>. If <code>ord ==
  TRUE</code>, <code>Ntree</code> must equal the length of <code>ctrees</code>.</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_n.cores">n.cores</code></td>
<td>
<p>Number of cores used to build the phylogeny.
Default is one (will run with parallel processing)</p>
</td></tr>
<tr><td><code id="AvoPhylo_+3A_cluster.ips">cluster.ips</code></td>
<td>
<p>Cluster location. Keep as default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to build phylogenies incorporating the extinct species from the
AvoTrex extinct birds database (Sayol et al.). AvoTrex provides data on
geographical location, island endemicity, volancy, body size and standard
external and skeleton morphological measurements for 610 extinct bird
species. The AvoPhylo function provides a pipeline to incorporate the extinct
species from AvoTrex into the &quot;BirdTree&quot; phylogenies of extant birds (Jetz et
al. 2012). Utilising codes assigned to each species based on their known
taxonomic affinities, the function binds each species in turn to a provided
BirdTree phylogeny. Input phylogenies (i.e., BirdTree trees) must be of class
'phylo', see <code><a href="ape.html#topic+phylo">phylo</a></code>.
</p>
<p>BirdTree phylogenies can be sourced from: https://birdtree.org/
</p>
<p>As certain species need to be grafted onto the tree before
other species, a number of the species are grafted in a set
order. This ordering is controlled through the “sp_id”,
“phylo_id” and “group” columns in the extinct species
phylogeny database. Before grafting, the database is ordered
by the “sp_id” column, with the “phylo_id” and “group” columns
used to filter out particular groups of species (i.e., those
classified as &quot;xS&quot; in the &quot;phylo_id&quot; column) to be grafted in
different orders (i.e., either a randomised order within
groups, or a fixed order within groups). See the package
vignette, as  well as Sayol et al. and Matthews et al., for
further details.
</p>
<p>For a subset of species (primarily those in older clades), we
have constrained the grafting to take place at a specific time
point (value in the 'time_fixed' column) along a given branch,
rather than at a randomly selected point. If, due to the
topology of the underlying BirdTree tree, it is not possible
to undertake this grafting along a given branch (i.e., the
time point for grafting is either older than the parent node
or younger than the child node, in respect to a given focal
branch), we graft the species just below the parent node or
just above the child node (using a branch length set by
<code>mindist</code> - if <code>mindist</code> is longer than the focal
branch in a given grafting event, it is adjusted accordingly).
</p>
<p>As some of the grafting codes (see table below) randomly place
the given species within a group of species, a genus, or a
family, and some species groups are randomised before grafting
(see above), it is useful to run the grafting procedure over a
a number of trees to average out the randomisation. Therefore,
the function can be run in parallel using the argument
<code>n.cores</code>. Note that the function will run on one core as
default and if only one tree is supplied. Trees for grafting
can be randomly selected from a number of input trees by
giving the function a group of input trees using the argument
<code>ctrees</code> and then defining a smaller number using
<code>Ntree</code>. If the maximum number of input trees is to be
used, <code>Ntree</code> should equal <code>length(ctrees)</code>. If you
want the outputted list of trees to match the order of trees
in <code>ctrees</code>, set <code>ord = TRUE</code>.
</p>
<p>If <code>Ntree</code> &gt; 1, a progress bar will be displayed.
</p>
<p>A variety of different plotting options are available, see
the <code><a href="#topic+plot.avophylo">plot.avophylo</a></code> documentation.</p>

<table>
<tr>
 <td style="text-align: left;">
   Codes </td><td style="text-align: left;"> Full name </td><td style="text-align: left;"> Definition </td>
</tr>
<tr>
 <td style="text-align: left;">
   S </td><td style="text-align: left;"> Sister </td><td style="text-align: left;"> Grafted as a sister to a known extant or extinct species already in the tree </td>
</tr>
<tr>
 <td style="text-align: left;">
   SSG </td><td style="text-align: left;"> Sister species group </td><td style="text-align: left;"> Grafted as a sister to a group of extant and/or extinct species already in the tree </td>
</tr>
<tr>
 <td style="text-align: left;">
   SGG </td><td style="text-align: left;"> Sister genus group </td><td style="text-align: left;"> Grafted as a sister to an entire extant or extinct genus (i.e., for the first grafted representative of an extinct genus) </td>
</tr>
<tr>
 <td style="text-align: left;">
   SGG2 </td><td style="text-align: left;"> Sister genus group 2 </td><td style="text-align: left;"> Grafted as sister to multiple genera. This was for when a species was sister to a subfamily or some other large specific clade </td>
</tr>
<tr>
 <td style="text-align: left;">
   SFG </td><td style="text-align: left;"> Sister family group </td><td style="text-align: left;"> Grafted as a sister to an entire extant or extinct family already present in the  tree (i.e., for the first grafted representative of an extinct family) </td>
</tr>
<tr>
 <td style="text-align: left;">
   SOG </td><td style="text-align: left;"> Sister order group </td><td style="text-align: left;"> Grafted as a sister to an entire order already present in the tree (i.e., for the first grafted representative of an extinct order) </td>
</tr>
<tr>
 <td style="text-align: left;">
   RSG </td><td style="text-align: left;"> Random species group </td><td style="text-align: left;"> Grafted to a randomly selected species from a pre-defined group of species (i.e., from which is believed to have close affinities </td>
</tr>
<tr>
 <td style="text-align: left;">
   RGG </td><td style="text-align: left;"> Random genus group </td><td style="text-align: left;"> Grafted to a randomly selected species from a given genus. For example, if an  extinct species was believed to be a finch derived from a European finch species, but the exact sister species is unknown. </td>
</tr>
<tr>
 <td style="text-align: left;">
   RGG2 </td><td style="text-align: left;"> Random genus group 2 </td><td style="text-align: left;"> Grafted to a randomly selected species from a group of genera (e.g. when all that is known is that the species is from a specific subfamily). Currently not used in the database, but the relevant functionality has been kept in the R script, as it could be useful for future studies. </td>
</tr>
<tr>
 <td style="text-align: left;">
   RFG </td><td style="text-align: left;"> Random family group </td><td style="text-align: left;"> Grafted to a randomly selected species from a given family </td>
</tr>
<tr>
 <td style="text-align: left;">
   RSGG </td><td style="text-align: left;"> Random sister genus group </td><td style="text-align: left;"> Grafted as sister to a randomly selected genus from a pre-defined group of genera </td>
</tr>
<tr>
 <td style="text-align: left;">
   RSGG2 </td><td style="text-align: left;"> Random sister genus group 2 </td><td style="text-align: left;"> Grafted as sister to a randomly selected genus from a pre-defined family </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>The function returns an object of class
'multiAvophylo', which is a list consisting of N trees (each
of class 'avophylo' and 'phylo') that were selected from the
supplied set of input trees. These ouput trees have all had
the extinct species from AvoTrex grafted on.
</p>


<h3>References</h3>

<p>Matthews et al. (IN REVIEW) The global loss of avian functional and phylogenetic diversity from extinctions in
the Holocene and Late Pleistocene
</p>
<p>Sayol et al. (IN PREP) The global loss of avian functional and phylogenetic diversity
from extinctions in the Holocene and Late Pleistocene
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data(BirdTree_trees)
# data(BirdTree_tax)
# data(AvotrexPhylo)
# trees &lt;- AvoPhylo(ctrees = BirdTree_trees,
# avotrex = AvotrexPhylo, PER = 0.2, PER_FIXED = 0.75,
# mindist = 0.1, ord = FALSE, 
# tax = BirdTree_tax, Ntree = 1, n.cores = 1, cluster.ips = NULL)
# class(trees)
# trees[[1]]
# class(trees[[1]])

#See the plot.avophylo documentation for the different available
#plotting options.
</code></pre>

<hr>
<h2 id='AvotrexPhylo'>
Avotrex phylo dataset 
</h2><span id='topic+AvotrexPhylo'></span>

<h3>Description</h3>

<p>The dataset provides instructions to graft extinct bird species from Sayol et al. (IN PREP) on to existing BirdTree phylogenies using the AvoPhylo function from the Avotrex package. Instructions are provided in various columns 
(see format). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AvotrexPhylo")</code></pre>


<h3>Format</h3>

<p>A data frame with 610 rows and the following variables:
</p>

<dl>
<dt><code>sp_id</code></dt><dd><p>a character vector detailing the order in which species are joined</p>
</dd>
<dt><code>phylo_id</code></dt><dd><p>a character vector detailing the order in which species are joined and whether a species is part of a group (see details)</p>
</dd>
<dt><code>per_fixed</code></dt><dd><p>a logical vector</p>
</dd>
<dt><code>time_fixed</code></dt><dd><p>a numeric vector detailing a specific time point for grafting or NA</p>
</dd>
<dt><code>group</code></dt><dd><p>a numeric vector detailing a group code or NA (see details)</p>
</dd>
<dt><code>species</code></dt><dd><p>a character vector detailing species name with an underscore</p>
</dd>
<dt><code>order</code></dt><dd><p>a character vector detailing species order</p>
</dd>
<dt><code>family</code></dt><dd><p>a character vector detailing species family</p>
</dd>
<dt><code>genus</code></dt><dd><p>a character vector detailing species genus</p>
</dd>
<dt><code>jetz_order</code></dt><dd><p>a character vector detailing species order within the Jetz phylogeny</p>
</dd>
<dt><code>jetz_family</code></dt><dd><p>a character vector detailing species family within the Jetz phylogeny</p>
</dd>
<dt><code>jetz_genus</code></dt><dd><p>a character vector detailing species genus within the Jetz phylogeny</p>
</dd>
<dt><code>type</code></dt><dd><p>a character vector of codes. The codes determine how and where the species is grafted to the tree. See details and function &quot;AvoPhylo&quot;</p>
</dd>
<dt><code>sister_order</code></dt><dd><p>a character vector. Provides the order within the BirdTree backbone tree to join the extinct species to, or randomly within, depending on the code within the column &quot;type&quot;</p>
</dd>
<dt><code>sister_clade</code></dt><dd><p>a character vector. Provides the clade within the BirdTree backbone tree to join the extinct species to, or randomly within, depending on the code within the column &quot;type&quot;</p>
</dd>
<dt><code>sister_family</code></dt><dd><p>a character vector. Provides the family within the BirdTree backbone tree to join the extinct species to, or randomly within, depending on the code within the column &quot;type&quot;</p>
</dd>
<dt><code>sister_genus</code></dt><dd><p>a character vector. Provides the genus within the BirdTree backbone tree to join the extinct species to, or randomly within, depending on the code within the column &quot;type&quot;</p>
</dd>
<dt><code>sister_species</code></dt><dd><p>a character vector. Provides the species within the BirdTree backbone tree to join the extinct species to depending on the code within the column &quot;type&quot;</p>
</dd>
<dt><code>sister_species_group</code></dt><dd><p>a character vector. Provides the group of species within the BirdTree backbone tree to join the extinct species to, or randomly within, depending on the code within the column &quot;type&quot;</p>
</dd>
</dl>



<h3>Details</h3>

<p>As certain species need to be grafted onto the tree before
other species, a number of the species are grafted in a set
order. This ordering is controlled through the “sp_id”,
“phylo_id” and “group” columns in the extinct species
phylogeny database. Before grafting, the database is ordered
by the “sp_id” column, with the “phylo_id” and “group” columns
used to filter out particular groups of species (i.e., those
classified as &quot;xS&quot; in the &quot;phylo_id&quot; column) to be grafted in
different orders (i.e., either a randomised order within
groups, or a fixed order within groups). See the package
vignette for
further details. 
</p>
<p>Some species are grafted at specific time points along a branch (column &quot;time_fixed&quot;).
</p>
<p>As some of the codes within the column &quot;type&quot; (see table below) randomly place the given species within a group of species, a genus, or a family, and some species groups are randomised before grafting (see above), it is useful to run the grafting proceedure over a a number of trees to average out the randomisation (see function &quot;AvoPhylo&quot;). 
</p>
<p>See the package vignette, and the help file for AvoPhylo() for more information.
</p>


<h3>References</h3>

<p>Matthews et al. (IN REVIEW) The global loss of avian functional and phylogenetic diversity from extinctions in the Holocene and Late Pleistocene.
</p>
<p>Sayol et al. (IN PREP) The global loss of avian functional and phylogenetic diversity from extinctions in the Holocene and Late Pleistocene
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AvotrexPhylo)
</code></pre>

<hr>
<h2 id='BirdTree_tax'>
Bird Tree taxonomic data
</h2><span id='topic+BirdTree_tax'></span>

<h3>Description</h3>

<p>Dataset from Jetz et al. (2012) detailing the BirdTree taxonomy used in the BirdTree backbone phylogenetic trees. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BirdTree_tax")</code></pre>


<h3>Format</h3>

<p>A data frame with 9993 observations on the following 11 variables.
</p>

<dl>
<dt><code>Genus</code></dt><dd><p>a character vector detailing the Bird Tree genus</p>
</dd>
<dt><code>Species</code></dt><dd><p>a character vector detailing the Bird Tree species name</p>
</dd>
<dt><code>TipLabel</code></dt><dd><p>a character vector detailing the tip label (genus and species name separated by an underscore)</p>
</dd>
<dt><code>English</code></dt><dd><p>a character vector detailing the common name for the species</p>
</dd>
<dt><code>Taxonomy</code></dt><dd><p>a character vector detailing the Bird Tree taxonomy</p>
</dd>
<dt><code>Clade</code></dt><dd><p>a character vector detailing the Bird Tree clade</p>
</dd>
<dt><code>BLFamilyLatin</code></dt><dd><p>a character vector detailing the Bird Tree family name (latin)</p>
</dd>
<dt><code>BLFamilyEnglish</code></dt><dd><p>a character vector detailing the Bird Tree family name (common)</p>
</dd>
<dt><code>FamSequID</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Order</code></dt><dd><p>a character vector detailing the Bird Tree order</p>
</dd>
<dt><code>OscSubOsc</code></dt><dd><p>a character vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>If necessary, more details than the __description__ above ~~
</p>


<h3>Source</h3>

<p>Jetz, W., Thomas, G., Joy, J. et al. The global diversity of birds in space and time. Nature 491, 444–448 (2012). https://doi.org/10.1038/nature11631
</p>


<h3>References</h3>

<p>Jetz, W., Thomas, G., Joy, J. et al. The global diversity of birds in space and time. Nature 491, 444–448 (2012). https://doi.org/10.1038/nature11631
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BirdTree_tax)
</code></pre>

<hr>
<h2 id='BirdTree_trees'>
Bird Tree trees
</h2><span id='topic+BirdTree_trees'></span>

<h3>Description</h3>

<p>Two Bird Tree backbone trees obtained from Jetz et al. (2012). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BirdTree_trees")</code></pre>


<h3>Format</h3>

<p>A multiPhylo object consisting of two elements. 
</p>


<h3>Details</h3>

<p>If necessary, more details than the __description__ above
</p>


<h3>Source</h3>

<p>Jetz, W., Thomas, G., Joy, J. et al. The global diversity of birds in space and time. Nature 491, 444–448 (2012). https://doi.org/10.1038/nature11631
</p>


<h3>References</h3>

<p>Jetz, W., Thomas, G., Joy, J. et al. The global diversity of birds in space and time. Nature 491, 444–448 (2012). https://doi.org/10.1038/nature11631
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BirdTree_trees)
</code></pre>

<hr>
<h2 id='plot.avophylo'>Plot Model Fits for an 'avophylo' Object</h2><span id='topic+plot.avophylo'></span>

<h3>Description</h3>

<p>S3 method for class 'avophylo'.
<code>plot.avophylo</code> creates plots for objects of class
'avophylo'. The exact plot(s) constructed depends on the
argument values provided (see examples below and also the
package vignette). The function uses the ape package's
<a href="ape.html#topic+plot.phylo">plot.phylo</a> and can take any argument from that
function (e.g. the <code>type</code> argument).
</p>
<p>If <code><a href="#topic+AvoPhylo">AvoPhylo</a></code> is used to produce a list of trees
of class 'multiAvophylo', then <code>plot.multiAvophylo</code> is
first called. This plots individual trees in turn (with the
user required to press 'enter' to move to the next plot).
</p>
<p>The user will need to play around with plotting
window size, and/or export the image, particularly if many
tips are included.
</p>
<p>Note - if using the <code>lvls</code> argument, a warning is
provided. This comes from the <code>tidytree::tree_subset</code>
function and appears to be a bug (but the plot should be
checked for sense).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'avophylo'
plot(
  x,
  tips = "extinct",
  tips_col = NULL,
  order = NULL,
  family = NULL,
  genus = NULL,
  species = NULL,
  avotrex,
  tax,
  lvls = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.avophylo_+3A_x">x</code></td>
<td>
<p>An object of class 'avophylo'.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_tips">tips</code></td>
<td>
<p>What tip labels to present. Can be one of
&quot;extinct&quot; (just tip labels of extinct species), &quot;none&quot; (no
tip labels) or &quot;all_same&quot; (show all labels, with same colour
labels for all species), or &quot;all_dif&quot; (show all labels, with
different colour labels for extant and extinct species).
The latter needs to be used in combination with the
<code>tips_col</code> argument.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_tips_col">tips_col</code></td>
<td>
<p>Colour of tip labels. If <code>tips =
"all_dif"</code> this needs to be a vector of length two, with the
first value being the colour for extinct species, and the
second for extant species.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_order">order</code></td>
<td>
<p>Prune the tree to only show a specific order
(should be a character vector of length = 1). Taxonomy
follows BirdTree, see the <code>data(BirdTree_taxa)</code> file.
For extinct order names, see the <code>data(AvotrexPhylo)</code>
file.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_family">family</code></td>
<td>
<p>As for <code>order</code>, but for families.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_genus">genus</code></td>
<td>
<p>As for <code>order</code>, but for genera.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_species">species</code></td>
<td>
<p>Prune the tree to only show a specific set of
species. Should be a vector of at least length = 1. If only
a single species name is provided, the <code>lvls</code> argument
also needs to be provided.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_avotrex">avotrex</code></td>
<td>
<p>The Avotrex phylo dataset used to generate the
trees. For most use cases, this will have been loaded using
<code>data(AvotrexPhylo)</code>.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_tax">tax</code></td>
<td>
<p>The Jetz et al. (2012) BirdTree taxonomy .csv.
Supplied as data within the package.</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_lvls">lvls</code></td>
<td>
<p>If <code>species</code> is just a single species, how
many levels back (rootward) should be plotted. Uses the
<code>tidytree::tree_subset</code> function (see help
documentation of that function for further info).</p>
</td></tr>
<tr><td><code id="plot.avophylo_+3A_...">...</code></td>
<td>
<p>Other plotting arguments from the ape package's
<a href="ape.html#topic+plot.phylo">plot.phylo</a> can be provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates a phylogeny plot of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a set of trees
# data(BirdTree_trees)
# data(BirdTree_tax)
# data(AvotrexPhylo)
# trees &lt;- AvoPhylo(ctrees = BirdTree_trees,
# avotrex = AvotrexPhylo, PER = 0.2, PER_FIXED = 0.75,
# tax = BirdTree_tax, Ntree = 2, n.cores = 2, 
# cluster.ips = NULL)

#For here, we can load in an example set of two trees 
#generated using the above code

data(treesEx)

#order (owls) - just show extinct tip names (in red) and using
#a fan plot
plot(treesEx[[1]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     order = "Strigiformes", tips = "extinct",
     type = "fan", tip.color = "red", cex = 0.4)

#family (plot all three trees this time)
plot(treesEx, avotrex = AvotrexPhylo, tax = BirdTree_tax,
     family = "Threskiornithidae", tips = "extinct",
     tip.color = "red", cex = 0.5)

#genus - cladogram plot
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     genus = "Aplonis", tips = "extinct",
     type = "cladogram",
     tip.color = "red", cex = 0.5)

#species (&amp; show all tip names in same colour)
species2 &lt;- c("Anas_itchtucknee", "Anas_sp_VitiLevu",
              "Anas_platyrhynchos", "Ara_tricolor")

plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = species2, tips = "all_same",
     type = "cladogram",
     tip.color = "blue", cex = 0.5)

#same as previous, but extinct and extant diff colours
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = species2,
     cex = 0.5, tips = "all_dif",
     tips_col = c("red", "darkgreen"),
     type = "cladogram")

##single species 2 levels back
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = "Ara_tricolor",
     tips = "all_dif",
     tips_col = c("red", "darkgreen"),
     lvls = 2,
     type = "phylogram",
     cex = 0.6)
</code></pre>

<hr>
<h2 id='plot.multiAvophylo'>Plot Model Fits for an 'multiAvophylo' Object</h2><span id='topic+plot.multiAvophylo'></span>

<h3>Description</h3>

<p>S3 method for class 'multiAvophylo'. See the
<code><a href="#topic+plot.avophylo">plot.avophylo</a></code> documentation for more
information.
</p>
<p>Plots individual trees in turn (with the user required to
press 'enter' to move to the next plot).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiAvophylo'
plot(
  x,
  tips = "extinct",
  tips_col = NULL,
  order = NULL,
  family = NULL,
  genus = NULL,
  species = NULL,
  avotrex,
  tax,
  lvls = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.multiAvophylo_+3A_x">x</code></td>
<td>
<p>An object of class 'multiAvophylo'.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_tips">tips</code></td>
<td>
<p>What tip labels to present. Can be one of
&quot;extinct&quot; (just tip labels of extinct species), &quot;none&quot; (no
tip labels) or &quot;all_same&quot; (show all labels, with same colour
labels for all species), or &quot;all_dif&quot; (show all labels, with
different colour labels for extant and extinct species).
The latter needs to be used in combination with the
<code>tips_col</code> argument.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_tips_col">tips_col</code></td>
<td>
<p>Colour of tip labels. If <code>tips =
"all_dif"</code> this needs to be a vector of length two, with the
first value being the colour for extinct species, and the
second for extant species.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_order">order</code></td>
<td>
<p>Prune the tree to only show a specific order
(should be a character vector of length = 1). Taxonomy
follows BirdTree, see the <code>data(BirdTree_taxa)</code> file.
For extinct order names, see the <code>data(AvotrexPhylo)</code>
file.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_family">family</code></td>
<td>
<p>As for <code>order</code>, but for families.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_genus">genus</code></td>
<td>
<p>As for <code>order</code>, but for genera.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_species">species</code></td>
<td>
<p>Prune the tree to only show a specific set of
species. Should be a vector of at least length = 1. If only
a single species name is provided, the <code>lvls</code> argument
also needs to be provided.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_avotrex">avotrex</code></td>
<td>
<p>The Avotrex phylo dataset used to generate the
trees. For most use cases, this will have been loaded using
<code>data(AvotrexPhylo)</code>.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_tax">tax</code></td>
<td>
<p>The Jetz et al. (2012) BirdTree taxonomy .csv.
Supplied as data within the package.</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_lvls">lvls</code></td>
<td>
<p>If <code>species</code> is just a single species, how
many levels back (rootward) should be plotted. Uses the
<code>tidytree::tree_subset</code> function (see help
documentation of that function for further info).</p>
</td></tr>
<tr><td><code id="plot.multiAvophylo_+3A_...">...</code></td>
<td>
<p>Other plotting arguments from the ape package's
<a href="ape.html#topic+plot.phylo">plot.phylo</a> can be provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates a phylogeny plot for each tree in <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See the plot.avophylo documentation for further examples
data(treesEx)
#family (plot both trees in turn)
plot(treesEx, avotrex = AvotrexPhylo, tax = BirdTree_tax,
     family = "Threskiornithidae", tips = "extinct",
     tip.color = "red", cex = 0.5)
</code></pre>

<hr>
<h2 id='treesEx'>A set of three AvoPhylo trees</h2><span id='topic+treesEx'></span>

<h3>Description</h3>

<p>A &quot;multiAvophylo&quot; object containing two AvoPhylo trees,
generated using the AvoPhylo function. Includes 610 extinct
species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(treesEx)
</code></pre>


<h3>Format</h3>

<p>An object of class 'multiAvophylo'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(treesEx)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
