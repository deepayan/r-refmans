<!DOCTYPE html><html lang="en"><head><title>Help for package AntMAN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AntMAN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AM_clustering'><p>Return the clustering matrix</p></a></li>
<li><a href='#AM_coclustering'><p>Return the co-clustering matrix</p></a></li>
<li><a href='#AM_demo_mvb_poi'><p>Returns an example of <code>AM_mcmc_fit</code> output produced by the multivariate bernoulli model</p></a></li>
<li><a href='#AM_demo_mvn_poi'><p>Returns an example of <code>AM_mcmc_fit</code> output produced by the multivariate gaussian model</p></a></li>
<li><a href='#AM_demo_uvn_poi'><p>Returns an example of <code>AM_mcmc_fit</code> output produced by the univariate Gaussian model</p></a></li>
<li><a href='#AM_demo_uvp_poi'><p>Returns an example of <code>AM_mcmc_fit</code> output produced by the univariate Poisson model</p></a></li>
<li><a href='#AM_emp_bayes_uninorm'><p>compute the hyperparameters of an Normal-Inverse-Gamma distribution using an empirical Bayes approach</p></a></li>
<li><a href='#AM_extract'><p>Extract values within a <code>AM_mcmc_output</code> object</p></a></li>
<li><a href='#AM_find_gamma_Delta'><p>Given that the prior on M is a dirac delta, find the <code class="reqn">\gamma</code> hyperparameter of the weights prior to match <code class="reqn">E(K)=K*</code>,</p>
where <code class="reqn">K*</code> is user-specified</a></li>
<li><a href='#AM_find_gamma_NegBin'><p>Given that the prior on M is a Negative Binomial, find the <code class="reqn">\gamma</code> hyperparameter of the weights</p>
prior to match <code class="reqn">E(K)=K*</code>, where <code class="reqn">K*</code> is user-specified</a></li>
<li><a href='#AM_find_gamma_Pois'><p>Given that the prior on M is a shifted Poisson, find the <code class="reqn">\gamma</code> hyperparameter of the weights prior to match <code class="reqn">E(K)=K^{*}</code>, where <code class="reqn">K^{*}</code> is user-specified</p></a></li>
<li><a href='#AM_mcmc_configuration'><p>S3 class AM_mcmc_configuration</p></a></li>
<li><a href='#AM_mcmc_fit'><p>Performs a Gibbs sampling</p></a></li>
<li><a href='#AM_mcmc_output'><p>S3 class AM_mcmc_output</p></a></li>
<li><a href='#AM_mcmc_parameters'><p>MCMC Parameters</p></a></li>
<li><a href='#AM_mcmc_refit'><p>Performs a Gibbs sampling reusing previous configuration</p></a></li>
<li><a href='#AM_mix_components_prior'><p>S3 class AM_mix_components_prior</p></a></li>
<li><a href='#AM_mix_components_prior_dirac'><p>Generate a configuration object that contains a Point mass prior</p></a></li>
<li><a href='#AM_mix_components_prior_negbin'><p>Generate a configuration object for a Shifted Negative Binomial prior on the number of mixture components</p></a></li>
<li><a href='#AM_mix_components_prior_pois'><p>Generate a configuration object for a Poisson prior on the number of mixture components</p></a></li>
<li><a href='#AM_mix_hyperparams'><p>S3 class AM_mix_hyperparams</p></a></li>
<li><a href='#AM_mix_hyperparams_multiber'><p>multivariate Bernoulli mixture hyperparameters (Latent Class Analysis)</p></a></li>
<li><a href='#AM_mix_hyperparams_multinorm'><p>multivariate Normal mixture hyperparameters</p></a></li>
<li><a href='#AM_mix_hyperparams_uninorm'><p>univariate Normal mixture hyperparameters</p></a></li>
<li><a href='#AM_mix_hyperparams_unipois'><p>univariate Poisson mixture hyperparameters</p></a></li>
<li><a href='#AM_mix_weights_prior'><p>S3 class AM_mix_weights_prior</p></a></li>
<li><a href='#AM_mix_weights_prior_gamma'><p>specify a prior on the hyperparameter <code class="reqn">\gamma</code> for the Dirichlet mixture weights prior</p></a></li>
<li><a href='#AM_plot_chaincor'><p>Plot the Autocorrelation function</p></a></li>
<li><a href='#AM_plot_density'><p>Plot the density of variables from <code>AM_mcmc_output</code> object</p></a></li>
<li><a href='#AM_plot_mvb_cluster_frequency'><p>Visualise the cluster frequency plot for the multivariate bernoulli model</p></a></li>
<li><a href='#AM_plot_pairs'><p>Plot <code>AM_mcmc_output</code> scatterplot matrix</p></a></li>
<li><a href='#AM_plot_pmf'><p>Plot the probability mass function of variables from <code>AM_mcmc_output</code> object</p></a></li>
<li><a href='#AM_plot_similarity_matrix'><p>Plot the Similarity Matrix</p></a></li>
<li><a href='#AM_plot_traces'><p>Plot traces of variables from an <code>AM_mcmc_output</code> object</p></a></li>
<li><a href='#AM_plot_values'><p>Plot posterior interval estimates obtained from MCMC draws</p></a></li>
<li><a href='#AM_prior'><p>S3 class AM_prior</p></a></li>
<li><a href='#AM_prior_K_Delta'><p>Computes the prior on the number of clusters</p></a></li>
<li><a href='#AM_prior_K_NegBin'><p>computes the prior number of clusters</p></a></li>
<li><a href='#AM_prior_K_Pois'><p>Computes the prior number of clusters</p></a></li>
<li><a href='#AM_salso'><p>Sequentially Allocated Latent Structure Optimisation</p></a></li>
<li><a href='#AM_sample_multibin'><p>AM_sample_multibin</p></a></li>
<li><a href='#AM_sample_multinorm'><p>AM_sample_multinorm</p></a></li>
<li><a href='#AM_sample_uninorm'><p>AM_sample_uninorm</p></a></li>
<li><a href='#AM_sample_unipois'><p>AM_sample_unipois</p></a></li>
<li><a href='#AntMAN'><p>AntMAN: A package for fitting finite Bayesian Mixture models with a random number of components</p></a></li>
<li><a href='#brain'><p>Teen Brain Images from the National Institutes of Health, U.S.</p></a></li>
<li><a href='#carcinoma'><p>Carcinoma dataset</p></a></li>
<li><a href='#galaxy'><p>Galaxy velocities dataset</p></a></li>
<li><a href='#IAM_compute_stirling_ricor_abs'><p>Compute the logarithm of the absolute value of the  generalized Sriling number of second Kind (mi pare) See charambeloides, using a recursive formula Devo vedere la formula</p></a></li>
<li><a href='#IAM_compute_stirling_ricor_log'><p>Compute stirling ricor log</p></a></li>
<li><a href='#IAM_mcmc_error'><p>Internal function used to compute the MCMC Error as a batch mean.</p></a></li>
<li><a href='#IAM_mcmc_neff'><p>IAM_mcmc_neff MCMC Parameters</p></a></li>
<li><a href='#IAM_VnkDelta'><p>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts</p>
of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) )
when the number of component are fixed to <code>M^*</code>, i.e. a Dirac prior assigning mass only to <code>M^*</code> is assumed.
See Section 9.1.1 of the Paper Argiento de Iorio 2019 for more details.</a></li>
<li><a href='#IAM_VnkNegBin'><p>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) ) when the prior on the number of componet is Negative Binomial with parameter <code>r</code> and <code>p</code>with  mean is mu =1+ r*p/(1-p) TODO: CHECK THIS FORMULA!!!. See Section 9.1.1 of the Paper Argiento de Iorio 2019 for more details</p></a></li>
<li><a href='#IAM_VnkPoisson'><p>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) ) when the prior on the number of componet is Shifted Poisson of parameter <code>Lambda</code>. See Section 9.1.1 of the Paper Argiento de Iorio 2019.</p></a></li>
<li><a href='#list_values'><p>Internal function that produces a string from a list of values</p></a></li>
<li><a href='#plot.AM_mcmc_output'><p>plot AM_mcmc_output</p></a></li>
<li><a href='#plot.AM_prior'><p>plot AM_prior</p></a></li>
<li><a href='#said'><p>Usage frequency of the word &quot;said&quot; in the Brown corpus</p></a></li>
<li><a href='#summary.AM_mcmc_configuration'><p>summary information of the AM_mcmc_configuration object</p></a></li>
<li><a href='#summary.AM_mcmc_output'><p>summary information of the AM_mcmc_output object</p></a></li>
<li><a href='#summary.AM_mix_components_prior'><p>summary information of the AM_mix_components_prior object</p></a></li>
<li><a href='#summary.AM_mix_hyperparams'><p>summary information of the AM_mix_hyperparams object</p></a></li>
<li><a href='#summary.AM_mix_weights_prior'><p>summary information of the AM_mix_weights_prior object</p></a></li>
<li><a href='#summary.AM_prior'><p>summary information of the AM_prior object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-01</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Anthology of Mixture Analysis Tools</td>
</tr>
<tr>
<td>Author:</td>
<td>Priscilla Ong [aut, edt],
  Raffaele Argiento [aut],
  Bruno Bodin [aut, cre],
  Maria De Iorio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bruno Bodin &lt;bruno.bodin@yale-nus.edu.sg&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits finite Bayesian mixture models with a random number of components. The MCMC algorithm implemented is based on point processes as proposed by Argiento and De Iorio (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1904.09733">doi:10.48550/arXiv.1904.09733</a>&gt; and offers a more computationally efficient alternative to reversible jump. Different mixture kernels can be specified: univariate Gaussian, multivariate Gaussian, univariate Poisson, and multivariate Bernoulli (latent class analysis). For the parameters characterising the mixture kernel, we specify conjugate priors, with possibly user specified hyper-parameters. We allow for different choices for the prior on the number of components: shifted Poisson, negative binomial, and point masses (i.e. mixtures with fixed number of components).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bbodin/AntMAN">https://github.com/bbodin/AntMAN</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices, Rcpp (&ge; 0.12.3), salso, mvtnorm,
mcclust, GGally, bayesplot, Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dendextend, ggdendro, ggplot2, jpeg</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-23 07:22:05 UTC; toky</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-23 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AM_clustering'>Return the clustering matrix</h2><span id='topic+AM_clustering'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function returns the clustering matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_clustering(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_clustering_+3A_fit">fit</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The clustering matrix is an M by n matrix. Each of the M rows represents a clustering of n items
using cluster labels. Items i and j are in the same cluster if fit[m,i] == fit[m,j] for the mth clustering.
</p>


<h3>Value</h3>

<p>A numeric clustering matrix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_coclustering">AM_coclustering</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit = AM_demo_uvp_poi()$fit
ccm &lt;- AM_clustering(fit)

</code></pre>

<hr>
<h2 id='AM_coclustering'>Return the co-clustering matrix</h2><span id='topic+AM_coclustering'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function returns the co-clustering matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_coclustering(fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_coclustering_+3A_fit">fit</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The co-clustering matrix is produced by the simultaneous clustering of the rows and columns. Each entry denotes the (posterior) probability
that items <code class="reqn">i</code> and <code class="reqn">j</code> are together.  This technique is also known as
bi-clustering and block clustering (Govaert and Nadif 2013), and is useful for understanding the number of clusters in the dataset.
</p>


<h3>Value</h3>

<p>A numeric co-clustering matrix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_clustering">AM_clustering</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit = AM_demo_uvp_poi()$fit
ccm &lt;- AM_coclustering(fit)

</code></pre>

<hr>
<h2 id='AM_demo_mvb_poi'>Returns an example of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> output produced by the multivariate bernoulli model</h2><span id='topic+AM_demo_mvb_poi'></span>

<h3>Description</h3>

<p>This function allows us to generate a sample output of fitting the multivariate Bernoulli model. No arguments are needed to be passed.
The purpose of this function is to serve as a demo for users to understand the model's output, without diving too deep into details. By default,
this demo generates a sample dataset of dimension 500x4, where the MCMC sampler is specified to run for 2000 iterations, with a burn-in of 1000, and a thinning interval of 10. All possible outputs
that can be produced by <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> are returned (see return value below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_demo_mvb_poi()
</code></pre>


<h3>Value</h3>

<p>A list containing the following items:
</p>

<ul>
<li><p> the vector (or matrix) containing the synthetic data used to fit the model.
</p>
</li>
<li><p> the vector containing the final cluster assignment of each observation.
</p>
</li>
<li><p> an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, which is the typical output of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
 mvb_output &lt;- AM_demo_mvb_poi()

</code></pre>

<hr>
<h2 id='AM_demo_mvn_poi'>Returns an example of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> output produced by the multivariate gaussian model</h2><span id='topic+AM_demo_mvn_poi'></span>

<h3>Description</h3>

<p>This function allows us to generate a sample output of fitting the multivariate Gaussian model. No arguments are needed to be passed.
The purpose of this function is to serve as a demo for users to understand the model's output, without diving too deep into details. By default,
this demo generates a sample dataset of dimension 500x2, where the MCMC sampler is specified to run for 2000 iterations, with a burn-in of 1000, and a thinning interval of 10. All possible outputs
that can be produced by <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> are returned (see return value below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_demo_mvn_poi()
</code></pre>


<h3>Value</h3>

<p>A list containing the following items:
</p>

<ul>
<li><p> the vector (or matrix) containing the synthetic data used to fit the model.
</p>
</li>
<li><p> the vector containing the final cluster assignment of each observation.
</p>
</li>
<li><p> an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, which is the typical output of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
 mvn_output &lt;- AM_demo_mvn_poi()

</code></pre>

<hr>
<h2 id='AM_demo_uvn_poi'>Returns an example of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> output produced by the univariate Gaussian model</h2><span id='topic+AM_demo_uvn_poi'></span>

<h3>Description</h3>

<p>This function allows us to generate a sample output of fitting the univariate gaussian model. No arguments are needed to be passed.
The purpose of this function is to serve as a demo for users to understand the model's output, without diving too deep into details. By default,
this demo generates a sample dataset of dimension 500x1, where the MCMC sampler is specified to run for 2000 iterations, with a burn-in of 1000, and a thinning interval of 10. All possible outputs
that can be produced by <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> are returned (see return value below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_demo_uvn_poi()
</code></pre>


<h3>Value</h3>

<p>A list containing the following items:
</p>

<ul>
<li><p> the vector (or matrix) containing the synthetic data used to fit the model.
</p>
</li>
<li><p> the vector containing the final cluster assignment of each observation.
</p>
</li>
<li><p> an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, which is the typical output of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
 mvn_output &lt;- AM_demo_uvn_poi()

</code></pre>

<hr>
<h2 id='AM_demo_uvp_poi'>Returns an example of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> output produced by the univariate Poisson model</h2><span id='topic+AM_demo_uvp_poi'></span>

<h3>Description</h3>

<p>This function allows us to generate a sample output of fitting the univariate poisson model. No arguments are needed to be passed.
The purpose of this function is to serve as a demo for users to understand the model's output, without diving too deep into details. By default,
this demo generates a sample dataset of dimension 500x1, where the MCMC sampler is specified to run for 2000 iterations, with a burn-in of 1000, and a thinning interval of 10. All possible outputs
that can be produced by <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> are returned (see return value below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_demo_uvp_poi()
</code></pre>


<h3>Value</h3>

<p>A list containing the following items:
</p>

<ul>
<li><p> the vector (or matrix) containing the synthetic data used to fit the model.
</p>
</li>
<li><p> the vector containing the final cluster assignment of each observation.
</p>
</li>
<li><p> an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, which is the typical output of <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
 mvn_output &lt;- AM_demo_uvn_poi()

</code></pre>

<hr>
<h2 id='AM_emp_bayes_uninorm'>compute the hyperparameters of an Normal-Inverse-Gamma distribution using an empirical Bayes approach</h2><span id='topic+AM_emp_bayes_uninorm'></span>

<h3>Description</h3>

<p>This function computes the hyperparameters of a Normal Inverse-Gamma distribution using an empirical Bayes approach.
More information about how these hyperparameters are determined can be found here:
<em>Bayes and empirical Bayes: do they merge?</em> (Petrone et al. 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_emp_bayes_uninorm(y, scEmu = 1, scEsig2 = 3, CVsig2 = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_emp_bayes_uninorm_+3A_y">y</code></td>
<td>
<p>The data y. If y is univariate, a vector is expected. Otherwise, y should be a matrix.</p>
</td></tr>
<tr><td><code id="AM_emp_bayes_uninorm_+3A_scemu">scEmu</code></td>
<td>
<p>a positive value (default=1) such that marginally E(<code class="reqn">\mu</code>) = <code class="reqn">s^2</code>*scEmu, where <code class="reqn">s^2</code> is the
sample variance.</p>
</td></tr>
<tr><td><code id="AM_emp_bayes_uninorm_+3A_scesig2">scEsig2</code></td>
<td>
<p>a positive value (default=3) such that marginally E(<code class="reqn">\sigma^2</code>) = <code class="reqn">s^2</code>*scEsig2, where <code class="reqn">s^2</code> is the
sample variance.</p>
</td></tr>
<tr><td><code id="AM_emp_bayes_uninorm_+3A_cvsig2">CVsig2</code></td>
<td>
<p>The coefficient of variation of <code class="reqn">\sigma^2</code> (default=3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code>, in which hyperparameters <code>m0</code>, <code>k0</code>,
<code>nu0</code> and <code>sig02</code> are specified. To understand the usage of these hyperparameters, please refer to
<code><a href="#topic+AM_mix_hyperparams_uninorm">AM_mix_hyperparams_uninorm</a></code>.
</p>

<hr>
<h2 id='AM_extract'>Extract values within a <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object</h2><span id='topic+AM_extract'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, as well as the target variable names,
AM_extract will return a list of the variables of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_extract(object, targets, iterations = NULL, debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_extract_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.</p>
</td></tr>
<tr><td><code id="AM_extract_+3A_targets">targets</code></td>
<td>
<p>List of variables to extract (ie. K, M, mu).</p>
</td></tr>
<tr><td><code id="AM_extract_+3A_iterations">iterations</code></td>
<td>
<p>Can specify particular iterations to extracts, NULL for all.</p>
</td></tr>
<tr><td><code id="AM_extract_+3A_debug">debug</code></td>
<td>
<p>Activate log to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to the complexity of AntMAN outputs, <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object can be difficult
to handle. The AM_extract function eases access of particular variables within the
<code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object. Variables of varying dimension are expected to result from the transdimensional moves. When considering such
variables, the extracted list would correspond to an nx1 list, where n refers to the number of extracted iterations. Each of these nx1 entries consists
of another list of dimension mx1, where m specifies the number of components inferred for that iteration.
</p>


<h3>Value</h3>

<p>a list of variables specified in <code>targets</code>.
</p>

<hr>
<h2 id='AM_find_gamma_Delta'>Given that the prior on M is a dirac delta, find the <code class="reqn">\gamma</code> hyperparameter of the weights prior to match <code class="reqn">E(K)=K*</code>,
where <code class="reqn">K*</code> is user-specified</h2><span id='topic+AM_find_gamma_Delta'></span>

<h3>Description</h3>

<p>Once a fixed value of the number of components <code class="reqn">M^*</code> is specified, this function  adopts a <em>bisection method</em> to find the value of <code class="reqn">\gamma</code>
such that the induced distribution on the number of clusters is centered around a user specifed value <code class="reqn">K^*</code>, i.e. the function uses
a bisection method to solve for <code class="reqn">\gamma</code> (Argiento and Iorio 2019). The user can provide a lower <code class="reqn">\gamma_{l}</code> and
an upper <code class="reqn">\gamma_{u}</code> bound for the possible values of <code class="reqn">\gamma</code>. The default values are <code class="reqn">\gamma_l= 10^{-3}</code> and <code class="reqn">\gamma_{u}=10</code>.
A default value for the tolerance is <code class="reqn">\epsilon=0.1</code>. Moreover, after a maximum number of iteration (default is 31), the function
stops warning that convergence has not been reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_find_gamma_Delta(
  n,
  Mstar,
  Kstar = 6,
  gam_min = 1e-04,
  gam_max = 10,
  tolerance = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_find_gamma_Delta_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Delta_+3A_mstar">Mstar</code></td>
<td>
<p>number of components of the mixture.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Delta_+3A_kstar">Kstar</code></td>
<td>
<p>mean number of clusters the user wants to specify.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Delta_+3A_gam_min">gam_min</code></td>
<td>
<p>lower bound of the interval in which <code>gamma</code> should lie (default 1e-4).</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Delta_+3A_gam_max">gam_max</code></td>
<td>
<p>upper bound of the interval in which <code>gamma</code> should lie (default 10).</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Delta_+3A_tolerance">tolerance</code></td>
<td>
<p>Level of tolerance for the method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of <code>gamma</code> such that <code class="reqn">E(K)=K^*</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 82
Mstar &lt;- 12
gam_de &lt;- AM_find_gamma_Delta(n,Mstar,Kstar=6, gam_min=1e-4,gam_max=10, tolerance=0.1)
prior_K_de &lt;-  AM_prior_K_Delta(n,gam_de,Mstar)
prior_K_de%*%1:n
</code></pre>

<hr>
<h2 id='AM_find_gamma_NegBin'>Given that the prior on M is a Negative Binomial, find the <code class="reqn">\gamma</code> hyperparameter of the weights
prior to match <code class="reqn">E(K)=K*</code>, where <code class="reqn">K*</code> is user-specified</h2><span id='topic+AM_find_gamma_NegBin'></span>

<h3>Description</h3>

<p>Once the prior on the number of mixture components M is assumed to be a Negative Binomial with
parameter <code>r&gt;0</code> and <code>0&lt;p&lt;1</code>, with  mean is 1+ r*p/(1-p), this function adopts a <em>bisection method</em>
to find the value of <code>gamma</code> such that the induced distribution on the number of clusters is centered around a
user specifed value <code class="reqn">K^{*}</code>, i.e. the function uses a bisection method to solve for <code class="reqn">\gamma</code> (Argiento and Iorio 2019).
The user can provide a lower <code class="reqn">\gamma_{l}</code> and an upper <code class="reqn">\gamma_{u}</code> bound for the possible values of <code class="reqn">\gamma</code>. The default values
are <code class="reqn">\gamma_l= 10^{-3}</code> and <code class="reqn">\gamma_{u}=10</code>.  A defaault value for the tolerance is <code class="reqn">\epsilon=0.1</code>. Moreover, after a
maximum number of iteration (default is 31), the function stops warning that convergence has not bee reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_find_gamma_NegBin(
  n,
  r,
  p,
  Kstar = 6,
  gam_min = 0.001,
  gam_max = 10000,
  tolerance = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_find_gamma_NegBin_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_r">r</code></td>
<td>
<p>The dispersion parameter <code>r</code> of the Negative Binomial.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_p">p</code></td>
<td>
<p>The probability of failure parameter <code>p</code> of the Negative Binomial.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_kstar">Kstar</code></td>
<td>
<p>The mean number of clusters the user wants to specify.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_gam_min">gam_min</code></td>
<td>
<p>The lower bound of the interval in which <code>gamma</code> should lie.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_gam_max">gam_max</code></td>
<td>
<p>The upper bound of the interval in which <code>gamma</code> should lie.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_NegBin_+3A_tolerance">tolerance</code></td>
<td>
<p>Level of tolerance of the method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of <code>gamma</code> such that <code class="reqn">E(K)=K^{*}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 82
r &lt;- 1
p &lt;- 0.8571
gam_nb= AM_find_gamma_NegBin(n,r,p,Kstar=6, gam_min=0.001,gam_max=10000, tolerance=0.1)
prior_K_nb= AM_prior_K_NegBin(n,gam_nb, r, p)
prior_K_nb%*%1:n
</code></pre>

<hr>
<h2 id='AM_find_gamma_Pois'>Given that the prior on M is a shifted Poisson, find the <code class="reqn">\gamma</code> hyperparameter of the weights prior to match <code class="reqn">E(K)=K^{*}</code>, where <code class="reqn">K^{*}</code> is user-specified</h2><span id='topic+AM_find_gamma_Pois'></span>

<h3>Description</h3>

<p>Once the prior on the number of mixture components M is assumed to be a Shifted Poisson of parameter <code>Lambda</code>,
this function  adopts a <em>bisection method</em> to find the value of <code class="reqn">\gamma</code> such that the induced distribution
on the number of clusters is centered around a user specifed value <code class="reqn">K^{*}</code>, i.e. the function uses a bisection
method to solve for <code class="reqn">\gamma</code> (Argiento and Iorio 2019). The user can provide a lower <code class="reqn">\gamma_{l}</code>
and an upper <code class="reqn">\gamma_{u}</code> bound for the possible values of <code class="reqn">\gamma</code>. The default values are <code class="reqn">\gamma_l= 10^{-3}</code> and <code class="reqn">\gamma_{u}=10</code>.
A defaault value for the tolerance is <code class="reqn">\epsilon=0.1</code>. Moreover, after a maximum number of iteration (default is 31),
the function stops warning that convergence has not bee reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_find_gamma_Pois(
  n,
  Lambda,
  Kstar = 6,
  gam_min = 1e-04,
  gam_max = 10,
  tolerance = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_find_gamma_Pois_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Pois_+3A_lambda">Lambda</code></td>
<td>
<p>The parameter of the Shifted Poisson for the number of components of the mixture.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Pois_+3A_kstar">Kstar</code></td>
<td>
<p>The mean number of clusters the user wants to specify.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Pois_+3A_gam_min">gam_min</code></td>
<td>
<p>The lower bound of the interval in which <code>gamma</code> should lie.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Pois_+3A_gam_max">gam_max</code></td>
<td>
<p>The upper bound of the interval in which <code>gamma</code> should lie.</p>
</td></tr>
<tr><td><code id="AM_find_gamma_Pois_+3A_tolerance">tolerance</code></td>
<td>
<p>Level of tolerance of the method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of <code>gamma</code> such that <code class="reqn">E(K)=K^{*}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 82
Lam  &lt;- 11
gam_po &lt;-  AM_find_gamma_Pois(n,Lam,Kstar=6, gam_min=0.0001,gam_max=10, tolerance=0.1)
prior_K_po &lt;-  AM_prior_K_Pois(n,gam_po,Lam)
prior_K_po%*%1:n
</code></pre>

<hr>
<h2 id='AM_mcmc_configuration'>S3 class AM_mcmc_configuration</h2><span id='topic+AM_mcmc_configuration'></span>

<h3>Description</h3>

<p>Output type of return values from  <code><a href="#topic+AM_mcmc_parameters">AM_mcmc_parameters</a></code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_mcmc_configuration">AM_mcmc_configuration</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>
</p>

<hr>
<h2 id='AM_mcmc_fit'>Performs a Gibbs sampling</h2><span id='topic+AM_mcmc_fit'></span>

<h3>Description</h3>

<p>The <code>AM_mcmc_fit</code> function performs a Gibbs sampling in order to estimate the mixture comprising the sample data <code>y</code>.
The mixture selected must be of a predefined type <code>mix_kernel_hyperparams</code> (defined with <code>AM_mix_hyperparams_*</code> functions, where star
<code>*</code> denotes the chosen kernel).
Additionally, a prior distribution on the number of mixture components
must be specified through <code>mix_components_prior</code>
(generated with  <code>AM_mix_components_prior_*</code> functions, where <code>*</code>  denotes the chosen prior). Similarly,
a prior on the weights of the mixture should be specified through <code>mix_weight_prior</code>
(defined with  <code>AM_mix_weights_prior_*</code> functions). Finally, with <code>mcmc_parameters</code>, the user sets
the MCMC parameters for the Gibbs sampler (defined with <code><a href="#topic+AM_mcmc_parameters">AM_mcmc_parameters</a></code> functions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mcmc_fit(
  y,
  mix_kernel_hyperparams,
  initial_clustering = NULL,
  init_K = NULL,
  fixed_clustering = NULL,
  mix_components_prior = AM_mix_components_prior_pois(),
  mix_weight_prior = AM_mix_weights_prior_gamma(),
  mcmc_parameters = AM_mcmc_parameters()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mcmc_fit_+3A_y">y</code></td>
<td>
<p>input data, can be a vector or a matrix.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_mix_kernel_hyperparams">mix_kernel_hyperparams</code></td>
<td>
<p>is a configuration list, defined by *_mix_hyperparams functions, where * denotes the chosen kernel.
See <code><a href="#topic+AM_mix_hyperparams_multiber">AM_mix_hyperparams_multiber</a></code>, <code><a href="#topic+AM_mix_hyperparams_multinorm">AM_mix_hyperparams_multinorm</a></code>, <code><a href="#topic+AM_mix_hyperparams_uninorm">AM_mix_hyperparams_uninorm</a></code>, <code><a href="#topic+AM_mix_hyperparams_unipois">AM_mix_hyperparams_unipois</a></code> for more details.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_initial_clustering">initial_clustering</code></td>
<td>
<p>is a vector CI of initial cluster assignement. If no clustering is specified (either as <code>init_K</code> or <code>init_clustering</code>), then every observation is
assigned to its own cluster.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_init_k">init_K</code></td>
<td>
<p>initial value for  the number of cluster. When this is specified, AntMAN intitialises the clustering assign usng K-means.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_fixed_clustering">fixed_clustering</code></td>
<td>
<p>if specified, this is the vector CI containing the cluster assignments. This will remain unchanged for every iteration.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_mix_components_prior">mix_components_prior</code></td>
<td>
<p>is a configuration list defined by AM_mix_components_prior_* functions, where * denotes the chosen prior.
See <code><a href="#topic+AM_mix_components_prior_dirac">AM_mix_components_prior_dirac</a></code>,
<br /> <code><a href="#topic+AM_mix_components_prior_negbin">AM_mix_components_prior_negbin</a></code>, <code><a href="#topic+AM_mix_components_prior_pois">AM_mix_components_prior_pois</a></code> for more <br />
details.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_mix_weight_prior">mix_weight_prior</code></td>
<td>
<p>is a configuration list defined by AM_weight_prior_* functions, where * denotes the chosen prior specification.
See <code><a href="#topic+AM_mix_weights_prior_gamma">AM_mix_weights_prior_gamma</a></code> for more <br /> details.</p>
</td></tr>
<tr><td><code id="AM_mcmc_fit_+3A_mcmc_parameters">mcmc_parameters</code></td>
<td>
<p>is a configuration list defined by AM_mcmc_parameters. See <code><a href="#topic+AM_mcmc_parameters">AM_mcmc_parameters</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no initial clustering is specified (either as <code>init_K</code> or <code>init_clustering</code>),
then every observation is allocated to a different cluster.
If <code>init_K</code> is specified then AntMAN initialises the clustering through K-means.
</p>
<p><strong>Warning</strong>: if the user does not specify init_K or initial_cluster, the first steps can be be time-consuming because of default setting of the initial clustering.
</p>


<h3>Value</h3>

<p>The return value is an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 AM_mcmc_fit( AM_sample_unipois()$y, 
              AM_mix_hyperparams_unipois (alpha0=2, beta0=0.2), 
              mcmc_parameters = AM_mcmc_parameters(niter=50, burnin=0, thin=1, verbose=0))

</code></pre>

<hr>
<h2 id='AM_mcmc_output'>S3 class AM_mcmc_output</h2><span id='topic+AM_mcmc_output'></span>

<h3>Description</h3>

<p>Output type of return values from  <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>
</p>

<hr>
<h2 id='AM_mcmc_parameters'>MCMC Parameters</h2><span id='topic+AM_mcmc_parameters'></span>

<h3>Description</h3>

<p>This function generates an MCMC parameters list to be used as <code>mcmc_parameters</code> argument within <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mcmc_parameters(
  niter = 5000,
  burnin = 2500,
  thin = 1,
  verbose = 1,
  output = c("CI", "K"),
  parallel = TRUE,
  output_dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mcmc_parameters_+3A_niter">niter</code></td>
<td>
<p>Total number of MCMC iterations to be carried out.</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations to be considered as burn-in. Samples from this burn-in period are discarded.</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_thin">thin</code></td>
<td>
<p>Thinning rate. This argument specifies how often a draw from the posterior distribution is stored after
burnin, i.e. one every -th samples is saved. Therefore, the toral number of MCMC samples saved is
(<code>niter</code> -<code>burnin</code>)/<code>thin</code>. If thin =1, then AntMAN stores every iteration.</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_verbose">verbose</code></td>
<td>
<p>A value from 0 to 4, that specifies the desired level of verbosity (0:None, 1:Warnings, 2:Debug, 3:Extras).</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_output">output</code></td>
<td>
<p>A list of parameters output to return.</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_parallel">parallel</code></td>
<td>
<p>Some of the algorithms can be run in parallel using OpenMP. When set to True, this parameter triggers the parallelism.</p>
</td></tr>
<tr><td><code id="AM_mcmc_parameters_+3A_output_dir">output_dir</code></td>
<td>
<p>Path to an output dir, where to store all the outputs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mcmc_configuration">AM_mcmc_configuration</a></code> Object. This is a list to be used as <code>mcmc_parameters</code> argument with <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AM_mcmc_parameters (niter=1000, burnin=10000, thin=50)
AM_mcmc_parameters (niter=1000, burnin=10000, thin=50, output=c("CI","W","TAU"))
</code></pre>

<hr>
<h2 id='AM_mcmc_refit'>Performs a Gibbs sampling reusing previous configuration</h2><span id='topic+AM_mcmc_refit'></span>

<h3>Description</h3>

<p>Similar to <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>, the <code>AM_mcmc_refit</code> function performs a Gibbs sampling in order to estimate
a mixture. However parameters will be reused from a previous result from <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mcmc_refit(y, fit, fixed_clustering, mcmc_parameters = AM_mcmc_parameters())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mcmc_refit_+3A_y">y</code></td>
<td>
<p>input data, can be a vector or a matrix.</p>
</td></tr>
<tr><td><code id="AM_mcmc_refit_+3A_fit">fit</code></td>
<td>
<p>previous output from <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code> that is used to setup kernel and priors.</p>
</td></tr>
<tr><td><code id="AM_mcmc_refit_+3A_fixed_clustering">fixed_clustering</code></td>
<td>
<p>is a vector CI of cluster assignment that will remain unchanged for every iterations.</p>
</td></tr>
<tr><td><code id="AM_mcmc_refit_+3A_mcmc_parameters">mcmc_parameters</code></td>
<td>
<p>is a configuration list defined by <code><a href="#topic+AM_mcmc_parameters">AM_mcmc_parameters</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In practice this function will call AM_mcmc_fit(y, fixed_clustering = fixed_clustering, ...); with the same parameters as previously
specified.
</p>


<h3>Value</h3>

<p>The return value is an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 y = AM_sample_unipois()$y
 fit = AM_mcmc_fit( y , 
              AM_mix_hyperparams_unipois (alpha0=2, beta0=0.2), 
              mcmc_parameters = AM_mcmc_parameters(niter=20, burnin=0, thin=1, verbose=0))
 eam = AM_coclustering(fit)
 cluster = AM_salso(eam, "binder")
 refit = AM_mcmc_refit(y , fit, cluster, 
         mcmc_parameters = AM_mcmc_parameters(niter=20, burnin=0, thin=1, verbose=0));

</code></pre>

<hr>
<h2 id='AM_mix_components_prior'>S3 class AM_mix_components_prior</h2><span id='topic+AM_mix_components_prior'></span>

<h3>Description</h3>

<p>Object returned by <code>AM_mix_components_prior_*</code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_components_prior_dirac">AM_mix_components_prior_dirac</a></code>,
<code><a href="#topic+AM_mix_components_prior_negbin">AM_mix_components_prior_negbin</a></code>,
<code><a href="#topic+AM_mix_components_prior_pois">AM_mix_components_prior_pois</a></code>
</p>

<hr>
<h2 id='AM_mix_components_prior_dirac'>Generate a configuration object that contains a Point mass prior</h2><span id='topic+AM_mix_components_prior_dirac'></span>

<h3>Description</h3>

<p>Generate a configuration object that assigns a Point mass prior to the number of mixture components.
This is the simplest option and it requires users to specify a value <code class="reqn">M^*</code>
such that <code class="reqn">Pr(M=M^* =1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_components_prior_dirac(Mstar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_components_prior_dirac_+3A_mstar">Mstar</code></td>
<td>
<p>Fixed value  <code class="reqn">M^*</code> for the number of components.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code> object. This is a configuration list to be used as <code>mix_components_prior</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
AM_mix_components_prior_dirac (Mstar=3)
</code></pre>

<hr>
<h2 id='AM_mix_components_prior_negbin'>Generate a configuration object for a Shifted Negative Binomial prior on the number of mixture components</h2><span id='topic+AM_mix_components_prior_negbin'></span>

<h3>Description</h3>

<p>This generates a configuration object for a Shifted Negative Binomial prior on the number of mixture components such that
</p>
<p style="text-align: center;"><code class="reqn">q_M(m)=Pr(M=m) =\frac{\Gamma(r+m-1)}{(m-1)!\Gamma(r)} p^{m-1}(1-p)^r, \quad m=1,2,3,\ldots</code>
</p>

<p>The hyperparameters <code class="reqn">p\in (0,1)</code>  (probability of success) and <code class="reqn">r&gt;0</code> (size) can either be fixed using <code>r</code> and <code>p</code>
or assigned appropriate prior distributions.
In the latter case, we assume <code class="reqn">p \sim Beta(a_P,b_P)</code> and <code class="reqn">r \sim  Gamma(a_R,b_R)</code>. In AntMAN we assume the following
parametrization of the Gamma density:
</p>
<p style="text-align: center;"><code class="reqn">p(x\mid a,b )= \frac{b^a x^{a-1}}{\Gamma(a)} \exp\{ -bx \}, \quad x&gt;0.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_components_prior_negbin(
  a_R = NULL,
  b_R = NULL,
  a_P = NULL,
  b_P = NULL,
  R = NULL,
  P = NULL,
  init_R = NULL,
  init_P = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_components_prior_negbin_+3A_a_r">a_R</code></td>
<td>
<p>The shape parameter <code class="reqn">a</code>  of the <code class="reqn">Gamma(a,b)</code> prior distribution for <code class="reqn">r</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_b_r">b_R</code></td>
<td>
<p>The  rate parameter <code class="reqn">b</code> of the <code class="reqn">Gamma(a,b)</code> prior distribution for <code class="reqn">r</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_a_p">a_P</code></td>
<td>
<p>The parameter <code class="reqn">a</code>  of the <code class="reqn">Beta(a,b)</code> prior distribution for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_b_p">b_P</code></td>
<td>
<p>The parameter <code class="reqn">b</code>  of the <code class="reqn">Beta(a,b)</code> prior distribution for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_r">R</code></td>
<td>
<p>It allows  to fix  <code class="reqn">r</code> to a specific value.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_p">P</code></td>
<td>
<p>It allows  to fix  <code class="reqn">p</code> to a specific value.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_init_r">init_R</code></td>
<td>
<p>The initial value of <code class="reqn">r</code>, when specifying <code>a_R</code> and <code>b_R</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_negbin_+3A_init_p">init_P</code></td>
<td>
<p>The inivial  value of <code class="reqn">p</code>, when specifying <code>a_P</code> and <code>b_P</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no arguments are provided, the default is <code class="reqn">r = 1 , a_P = 1, b_P = 1</code>.
</p>
<p>Additionally, when init_R and init_P are not specified, there are default values:
<code class="reqn">init_R = 1</code> and <code class="reqn">init_P = 0.5</code>.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code> object. This is a configuration list to be used as <code>mix_components_prior</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
AM_mix_components_prior_negbin (R=1, P=1)
AM_mix_components_prior_negbin ()
</code></pre>

<hr>
<h2 id='AM_mix_components_prior_pois'>Generate a configuration object for a Poisson prior on the number of mixture components</h2><span id='topic+AM_mix_components_prior_pois'></span>

<h3>Description</h3>

<p>This function generates a configuration object for a Shifted Poisson prior on the number
of mixture components such that
</p>
<p style="text-align: center;"><code class="reqn">q_M(m)=     Pr (M=m)= \frac{e^{-\Lambda}\Lambda^{m-1} }{(m-1)!}    ,      \quad m=1,2,3,\ldots</code>
</p>

<p>The hyperparameter <code class="reqn">\Lambda</code> can either be fixed using <code>Lambda</code>
or assigned a <code class="reqn">Gamma(a,b)</code> prior distribution with <code>a</code> and <code>b</code>.
In AntMAN we assume the following parametrization of the Gamma density:
</p>
<p style="text-align: center;"><code class="reqn">p(x\mid a,b )= \frac{b^a x^{a-1}}{\Gamma(a)} \exp\{ -bx \}, \quad x&gt;0.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_components_prior_pois(a = NULL, b = NULL, Lambda = NULL, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_components_prior_pois_+3A_a">a</code></td>
<td>
<p>The shape parameter <code>a</code> of  the <code class="reqn">Gamma(a,b)</code> prior distribution.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_pois_+3A_b">b</code></td>
<td>
<p>The rate  parameter <code>b</code> of the <code class="reqn">Gamma(a,b)</code> prior distribution.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_pois_+3A_lambda">Lambda</code></td>
<td>
<p>It allows to set the  hyperparameter <code class="reqn">\Lambda</code> to be assigned a fixed value.</p>
</td></tr>
<tr><td><code id="AM_mix_components_prior_pois_+3A_init">init</code></td>
<td>
<p>The  initial value for <code class="reqn">\Lambda</code>, when specifying <code>a</code> and <code>b</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no arguments are provided, the default is a prior distribution with <code>a = 1</code> and <code>b = 1</code>.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code> object. This is a configuration list to be used as <code>mix_components_prior</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
components_prior = AM_mix_components_prior_pois (init=3,  a=1, b=1) 

</code></pre>

<hr>
<h2 id='AM_mix_hyperparams'>S3 class AM_mix_hyperparams</h2><span id='topic+AM_mix_hyperparams'></span>

<h3>Description</h3>

<p>Object type returned by <code>AM_mix_hyperparams_*</code> commands.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_hyperparams_unipois">AM_mix_hyperparams_unipois</a></code>, <code><a href="#topic+AM_mix_hyperparams_uninorm">AM_mix_hyperparams_uninorm</a></code>, <code><a href="#topic+AM_mix_hyperparams_multiber">AM_mix_hyperparams_multiber</a></code>,
<code><a href="#topic+AM_mix_hyperparams_multinorm">AM_mix_hyperparams_multinorm</a></code>
</p>

<hr>
<h2 id='AM_mix_hyperparams_multiber'>multivariate Bernoulli mixture hyperparameters (Latent Class Analysis)</h2><span id='topic+AM_mix_hyperparams_multiber'></span>

<h3>Description</h3>

<p>Generate a configuration object that defines the prior hyperparameters for a mixture of multivariate Bernoulli.
If the dimension of the data is P, then the prior is a product of P independent Beta distributions, Beta(<code class="reqn">a_{0i},b_{0i}</code>). Therefore,
the vectors of hyperparameters, a0 and b0,  are P-dimensional. Default is (a0= c(1,....,1),b0= c(1,....,1)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_hyperparams_multiber(a0, b0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_hyperparams_multiber_+3A_a0">a0</code></td>
<td>
<p>The a0 hyperparameters.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_multiber_+3A_b0">b0</code></td>
<td>
<p>The b0 hyperparameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object. This is a configuration list to be used as <code>mix_kernel_hyperparams</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AM_mix_hyperparams_multiber (a0= c(1,1,1,1),b0= c(1,1,1,1))
</code></pre>

<hr>
<h2 id='AM_mix_hyperparams_multinorm'>multivariate Normal mixture hyperparameters</h2><span id='topic+AM_mix_hyperparams_multinorm'></span>

<h3>Description</h3>

<p>Generate a configuration object that specifies a multivariate Normal mixture kernel, where users can specify the hyperparameters for the conjugate prior of the multivariate
Normal mixture. We assume that the data are d-dimensional vectors <code class="reqn">\boldsymbol{y}_i</code>, where <code class="reqn">\boldsymbol{y}_i</code> are i.i.d
Normal random variables with mean <code class="reqn">\boldsymbol{\mu}</code> and covariance matrix <code class="reqn">\boldsymbol{\Sigma}</code>.
The conjugate prior is
</p>
<p style="text-align: center;"><code class="reqn">\pi(\boldsymbol \mu, \boldsymbol \Sigma\mid\boldsymbol m_0,\kappa_0,\nu_0,\boldsymbol \Lambda_0)= 
\pi_{\mu}(\boldsymbol \mu|\boldsymbol \Sigma,\boldsymbol m_0,\kappa_0)\pi_{\Sigma}(\boldsymbol \Sigma \mid \nu_0,\boldsymbol \Lambda_0),</code>
</p>

<p style="text-align: center;"><code class="reqn"> \pi_{\mu}(\boldsymbol \mu|\boldsymbol \Sigma,\boldsymbol m_0,\kappa_0)  = 
 \frac{\sqrt{\kappa_0^d}}{\sqrt {(2\pi )^{d}|{\boldsymbol \Sigma }|}} \exp \left(-{\frac {\kappa_0}{2}}(\boldsymbol\mu -{\boldsymbol m_0 })^{\mathrm {T} }{\boldsymbol{\Sigma }}^{-1}(\boldsymbol\mu-{\boldsymbol m_0 })\right),
\qquad \boldsymbol \mu\in\mathcal{R}^d,</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi_{\Sigma}(\boldsymbol \Sigma\mid \nu_0,\boldsymbol \Lambda_0)= {\frac {\left|{\boldsymbol \Lambda_0 }\right|^{\nu_0 /2}}{2^{\nu_0 d/2}\Gamma _{d}({\frac {\nu_0 }{2}})}}\left|\boldsymbol \Sigma \right|^{-(\nu_0 +d+1)/2}e^{-{\frac {1}{2}}\mathrm {tr} (\boldsymbol \Lambda_0 \boldsymbol \Sigma^{-1})}
, \qquad \boldsymbol \Sigma^2&gt;0,</code>
</p>

<p>where <code>mu0</code> corresponds to <code class="reqn">\boldsymbol m_0</code>, <code>ka0</code> corresponds to  <code class="reqn">\kappa_0</code>,
<code>nu0</code> to <code class="reqn">\nu_0</code>, and <code>Lam0</code> to <code class="reqn">\Lambda_0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_hyperparams_multinorm(mu0 = NULL, ka0 = NULL, nu0 = NULL, Lam0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_hyperparams_multinorm_+3A_mu0">mu0</code></td>
<td>
<p>The hyperparameter <code class="reqn">\boldsymbol m_0</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_multinorm_+3A_ka0">ka0</code></td>
<td>
<p>The hyperparameter <code class="reqn">\kappa_0</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_multinorm_+3A_nu0">nu0</code></td>
<td>
<p>The hyperparameter <code class="reqn">\nu_0</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_multinorm_+3A_lam0">Lam0</code></td>
<td>
<p>The hyperparameter <code class="reqn">\Lambda_0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default is <code>(mu0=c(0,..,0)</code>, <code>ka0=1</code>, <code>nu0=Dim+2</code>, <code>Lam0=diag(Dim))</code> with <code>Dim</code> is the dimension of the data <code>y</code>.
We advise the user to set <code class="reqn">\nu_0</code> equal to at least the dimension of the data, <code>Dim</code>, plus 2.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object. This is a configuration list to be used as <code>mix_kernel_hyperparams</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AM_mix_hyperparams_multinorm ()
</code></pre>

<hr>
<h2 id='AM_mix_hyperparams_uninorm'>univariate Normal mixture hyperparameters</h2><span id='topic+AM_mix_hyperparams_uninorm'></span>

<h3>Description</h3>

<p>Generate a configuration object that specifies a univariate Normal mixture kernel, where users can specify the hyperparameters of the Normal-InverseGamma conjugate prior.
As such, the kernel is a Gaussian distribution with mean <code class="reqn">\mu</code> and variance <code class="reqn">\sigma^2</code>. The prior on <code class="reqn">(\mu,\sigma^2)</code> the Normal-InverseGamma:
</p>
<p style="text-align: center;"><code class="reqn">\pi(\mu,\sigma^2\mid m_0,\kappa_0,\nu_0,\sigma^2_0) = \pi_{\mu}(\mu|\sigma^2,m_0,\kappa_0)\pi_{\sigma^2}(\sigma^2\mid \nu_0,\sigma^2_0),</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi_{\mu}(\mu|\sigma^2,m_0,\kappa_0)  =\frac{\sqrt{\kappa_0}}{\sqrt{2\pi\sigma^2},} 
 \exp^{-\frac{\kappa_0}{2\sigma^2}(\mu-m_0)^2 }, \qquad \mu\in\mathcal{R},</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi_{\sigma^2}(\sigma^2\mid \nu_0,\sigma^2_0)= {\frac {\sigma_0^{2^{\nu_0 }}}{\Gamma (\nu_0 )}}(1/\sigma^2)^{\nu_0 +1}\exp \left(-\frac{\sigma_0^2}{\sigma^2}\right), \qquad \sigma^2&gt;0.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_hyperparams_uninorm(m0, k0, nu0, sig02)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_hyperparams_uninorm_+3A_m0">m0</code></td>
<td>
<p>The <code class="reqn">m_0</code> hyperparameter.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_uninorm_+3A_k0">k0</code></td>
<td>
<p>The <code class="reqn">\kappa_0</code> hyperparameter.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_uninorm_+3A_nu0">nu0</code></td>
<td>
<p>The <code class="reqn">\nu_0</code> hyperparameter.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_uninorm_+3A_sig02">sig02</code></td>
<td>
<p>The <code class="reqn">\sigma^2_0</code> hyperparameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">m_0</code> corresponds <code>m0</code>,
<code class="reqn">\kappa_0</code> corresponds <code>k0</code>,
<code class="reqn">\nu_0</code> corresponds <code>nu0</code>, and
<code class="reqn">\sigma^2_0</code> corresponds <code>sig02</code>.
</p>
<p>If hyperparameters are not specified, the default is <code>m0=0</code>, <code>k0=1</code>, <code>nu0=3</code>, <code>sig02=1</code>.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object. This is a configuration list to be used as <code>mix_kernel_hyperparams</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     
     #### This example ...
     
     data(galaxy)
     y_uvn = galaxy
     mixture_uvn_params = AM_mix_hyperparams_uninorm  (m0=20.83146, k0=0.3333333,
                                                       nu0=4.222222, sig02=3.661027)
     
     mcmc_params        = AM_mcmc_parameters(niter=2000, burnin=500, thin=10, verbose=0)
     components_prior   = AM_mix_components_prior_pois (init=3,  a=1, b=1) 
     weights_prior      = AM_mix_weights_prior_gamma(init=2, a=1, b=1)
     
     fit &lt;- AM_mcmc_fit(
       y = y_uvn,
       mix_kernel_hyperparams = mixture_uvn_params,
       mix_components_prior =components_prior,
       mix_weight_prior = weights_prior,
       mcmc_parameters = mcmc_params)
     
     summary (fit)
     plot (fit)
     
</code></pre>

<hr>
<h2 id='AM_mix_hyperparams_unipois'>univariate Poisson mixture hyperparameters</h2><span id='topic+AM_mix_hyperparams_unipois'></span>

<h3>Description</h3>

<p>Generate a configuration object that specifies a univariate Poisson mixture kernel, where users can
specify the hyperparameters of the conjugate Gamma prior, i.e. the kernel is a <code class="reqn">Poisson(\tau) </code>
and <code class="reqn">\tau\sim Gamma(\alpha_0,\beta_0)</code>.
In AntMAN we assume the following
parametrization of the Gamma density:
</p>
<p style="text-align: center;"><code class="reqn">p(x\mid a,b )= \frac{b^a x^{a-1}}{\Gamma(a)} \exp\{ -bx \}, \quad x&gt;0.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_hyperparams_unipois(alpha0, beta0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_hyperparams_unipois_+3A_alpha0">alpha0</code></td>
<td>
<p>The shape  hyperparameter <code class="reqn">\alpha_0</code>.</p>
</td></tr>
<tr><td><code id="AM_mix_hyperparams_unipois_+3A_beta0">beta0</code></td>
<td>
<p>The  rate hyperparameter <code class="reqn">\beta_0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that by default, alpha0=1 and beta0=1.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object. This is a configuration list to be used as <code>mix_kernel_hyperparams</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AM_mix_hyperparams_unipois (alpha0=2, beta0=0.2)
</code></pre>

<hr>
<h2 id='AM_mix_weights_prior'>S3 class AM_mix_weights_prior</h2><span id='topic+AM_mix_weights_prior'></span>

<h3>Description</h3>

<p>Object type returned by <code>AM_mix_weights_prior_*</code> commands.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_mix_weights_prior">AM_mix_weights_prior</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_weights_prior_gamma">AM_mix_weights_prior_gamma</a></code>
</p>

<hr>
<h2 id='AM_mix_weights_prior_gamma'>specify a prior on the hyperparameter <code class="reqn">\gamma</code> for the Dirichlet mixture weights prior</h2><span id='topic+AM_mix_weights_prior_gamma'></span>

<h3>Description</h3>

<p>Generate a configuration object to specify a prior on the hyperparameter <code class="reqn">\gamma</code> for the Dirichlet prior on the
mixture weights.
We assume <code class="reqn">\gamma \sim  Gamma(a,b)</code>. Alternatively, we can fix <code class="reqn">\gamma</code> to a specific value.
Default is <code class="reqn">\gamma=1/N</code>, where N is the number of observations.
In AntMAN we assume the following
parametrization of the Gamma density:
</p>
<p style="text-align: center;"><code class="reqn">p(x\mid a,b )= \frac{b^a x^{a-1}}{\Gamma(a)} \exp\{ -bx \}, \quad x&gt;0.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>AM_mix_weights_prior_gamma(a = NULL, b = NULL, gamma = NULL, init = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_mix_weights_prior_gamma_+3A_a">a</code></td>
<td>
<p>The shape parameter a of the Gamma prior.</p>
</td></tr>
<tr><td><code id="AM_mix_weights_prior_gamma_+3A_b">b</code></td>
<td>
<p>The rate parameter b of the Gamma prior.</p>
</td></tr>
<tr><td><code id="AM_mix_weights_prior_gamma_+3A_gamma">gamma</code></td>
<td>
<p>It allows to fix <code class="reqn">\gamma</code>  to a specific value.</p>
</td></tr>
<tr><td><code id="AM_mix_weights_prior_gamma_+3A_init">init</code></td>
<td>
<p>The init value for <code class="reqn">\gamma</code>, when we assume <code class="reqn">\gamma</code> random.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+AM_mix_weights_prior">AM_mix_weights_prior</a></code> object. This is a configuration list to be used as <code>mix_weight_prior</code> argument for <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AM_mix_weights_prior_gamma (a=1, b=1)
AM_mix_weights_prior_gamma (a=1, b=1, init=1)
AM_mix_weights_prior_gamma (gamma = 3)
AM_mix_weights_prior_gamma () 
</code></pre>

<hr>
<h2 id='AM_plot_chaincor'>Plot the Autocorrelation function</h2><span id='topic+AM_plot_chaincor'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function produces the autocorrelation function bars describing the MCMC results. AM_plot_chaincor makes use of bayesplot’s
plotting function mcmc_acf_bar (Gabry et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_chaincor(x, tags = NULL, lags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_chaincor_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_chaincor_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider. This function only produces meaningful plots for variables that have fixed dimension across the draws. If not specified, plots pertaining to M and K will be produced.
This function is built upon bayesplot's <code>mcmc_acf_bar</code>.</p>
</td></tr>
<tr><td><code id="AM_plot_chaincor_+3A_lags">lags</code></td>
<td>
<p>An integer specifying the number of lags to plot. If no value is specified, the default number of lags shown is half the total number of iterations.</p>
</td></tr>
<tr><td><code id="AM_plot_chaincor_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>

<hr>
<h2 id='AM_plot_density'>Plot the density of variables from <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object</h2><span id='topic+AM_plot_density'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, AM_plot_density plots the posterior density of the specified variables of interest. AM_plot_density makes use
of bayesplot's plotting function mcmc_areas (Gabry et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_density(x, tags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_density_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> fit object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_density_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider. This function only produces meaningful plots for variables that have fixed dimension across the draws.</p>
</td></tr>
<tr><td><code id="AM_plot_density_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object visualising the posterior density of the specified variables.
</p>

<hr>
<h2 id='AM_plot_mvb_cluster_frequency'>Visualise the cluster frequency plot for the multivariate bernoulli model</h2><span id='topic+AM_plot_mvb_cluster_frequency'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, and the data the model was fit on, this function will produce a cluster frequency plot for the multivariate bernoulli model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_mvb_cluster_frequency(
  fit,
  y,
  x_lim_param = c(0.8, 7.2),
  y_lim_param = c(0, 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_mvb_cluster_frequency_+3A_fit">fit</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> fit object, produced by calling <code>AM_mcmc_fit</code>.</p>
</td></tr>
<tr><td><code id="AM_plot_mvb_cluster_frequency_+3A_y">y</code></td>
<td>
<p>A matrix containing the y observations which produced fit.</p>
</td></tr>
<tr><td><code id="AM_plot_mvb_cluster_frequency_+3A_x_lim_param">x_lim_param</code></td>
<td>
<p>A vector with two elements describing the plot's x_axis scale, e.g. c(0.8, 7.2).</p>
</td></tr>
<tr><td><code id="AM_plot_mvb_cluster_frequency_+3A_y_lim_param">y_lim_param</code></td>
<td>
<p>A vector with two elements describing the plot's y_axis scale, e.g. c(0, 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for side effects.
</p>

<hr>
<h2 id='AM_plot_pairs'>Plot <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> scatterplot matrix</h2><span id='topic+AM_plot_pairs'></span>

<h3>Description</h3>

<p>visualise a matrix of plots describing the MCMC results. This function is built upon GGally's plotting function ggpairs (Schloerke et al. 2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_pairs(x, tags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_pairs_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_pairs_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider for plotting. This function only produces meaningful plots for variables that have fixed dimension across the draws. If not specified, plots pertaining to M and K will be produced.</p>
</td></tr>
<tr><td><code id="AM_plot_pairs_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Same as ggpairs function, a ggmatrix object that if called, will print.
</p>

<hr>
<h2 id='AM_plot_pmf'>Plot the probability mass function of variables from <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object</h2><span id='topic+AM_plot_pmf'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, AM_plot_pmf plots the posterior probability mass function of the specified variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_pmf(x, tags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_pmf_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_pmf_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider. If not specified, the pmf of both M and K will be plotted.</p>
</td></tr>
<tr><td><code id="AM_plot_pmf_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for side effects.
</p>

<hr>
<h2 id='AM_plot_similarity_matrix'>Plot the Similarity Matrix</h2><span id='topic+AM_plot_similarity_matrix'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function will produce an image of the Similarity Matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_similarity_matrix(x, loss, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_similarity_matrix_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> fit object, produced by calling <code>AM_mcmc_fit</code>.</p>
</td></tr>
<tr><td><code id="AM_plot_similarity_matrix_+3A_loss">loss</code></td>
<td>
<p>Loss function to minimise. Specify either &quot;VI&quot; or &quot;binder&quot;. If not specified, the default loss
to minimise is &quot;binder&quot;.</p>
</td></tr>
<tr><td><code id="AM_plot_similarity_matrix_+3A_...">...</code></td>
<td>
<p>All additional parameters wil lbe pass to the image command.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for side effects.
</p>

<hr>
<h2 id='AM_plot_traces'>Plot traces of variables from an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object</h2><span id='topic+AM_plot_traces'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, <code><a href="#topic+AM_plot_traces">AM_plot_traces</a></code> visualises the traceplots of the specified variables involved in the MCMC inference.
AM_plot_traces is built upon bayesplot's mcmc_trace (Gabry et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_traces(x, tags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_traces_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> fit object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_traces_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider. This function only produces meaningful plots for variables that have fixed dimension across the draws. If not specified, plots pertaining to M and K will be produced.</p>
</td></tr>
<tr><td><code id="AM_plot_traces_+3A_title">title</code></td>
<td>
<p>Title for the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for side effects.
</p>

<hr>
<h2 id='AM_plot_values'>Plot posterior interval estimates obtained from MCMC draws</h2><span id='topic+AM_plot_values'></span>

<h3>Description</h3>

<p>Given an object of class <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>, AM_plot_values visualises the interval estimates of the specified variables involved in the MCMC inference.
AM_plot_values is built upon bayesplot's mcmc_intervals (Gabry et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_plot_values(x, tags = NULL, title = "MCMC Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_plot_values_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> fit object, produced by calling <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>.</p>
</td></tr>
<tr><td><code id="AM_plot_values_+3A_tags">tags</code></td>
<td>
<p>A list of variables to consider. This function only produces meaningful plots for variables that have fixed dimension across the draws. If not specified, plots pertaining to M and K will be produced.</p>
</td></tr>
<tr><td><code id="AM_plot_values_+3A_title">title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Called for side effects.
</p>

<hr>
<h2 id='AM_prior'>S3 class AM_prior</h2><span id='topic+AM_prior'></span>

<h3>Description</h3>

<p>Object type returned by <code>AM_prior_*</code> commands.
</p>


<h3>Value</h3>

<p><code><a href="#topic+AM_prior">AM_prior</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_prior_K_Delta">AM_prior_K_Delta</a></code>, <code><a href="#topic+AM_prior_K_Pois">AM_prior_K_Pois</a></code>,  <code><a href="#topic+AM_prior_K_NegBin">AM_prior_K_NegBin</a></code>
</p>

<hr>
<h2 id='AM_prior_K_Delta'>Computes the prior on the number of clusters</h2><span id='topic+AM_prior_K_Delta'></span>

<h3>Description</h3>

<p>This function computes the prior on the number of clusters, i.e. occupied components of the mixture for a Finite Dirichlet process
when the prior on the component-weights of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormalised weights
are distributed as Gamma(<code class="reqn">\gamma</code>,1)). This function can be used when the number of components is fixed to <code class="reqn">M^*</code>, i.e.
a Dirac prior assigning mass only to <code class="reqn">M^*</code> is assumed. See (Argiento and Iorio 2019) There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_prior_K_Delta(n, gamma, Mstar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_prior_K_Delta_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="AM_prior_K_Delta_+3A_gamma">gamma</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet distribution.</p>
</td></tr>
<tr><td><code id="AM_prior_K_Delta_+3A_mstar">Mstar</code></td>
<td>
<p>The number of component of the mixture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+AM_prior">AM_prior</a></code> object, that is a vector of length n, reporting the values <code>V(n,k)</code> for <code>k=1,...,n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 82
gam_de &lt;- 0.1743555
Mstar &lt;- 12
prior_K_de &lt;- AM_prior_K_Delta(n,gam_de, Mstar)
plot(prior_K_de)
</code></pre>

<hr>
<h2 id='AM_prior_K_NegBin'>computes the prior number of clusters</h2><span id='topic+AM_prior_K_NegBin'></span>

<h3>Description</h3>

<p>This function computes the prior on the number of clusters, i.e. occupied component of the mixture for a Finite Dirichlet process when the
prior on the component-weights of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormalized weights are distributed as
Gamma(<code class="reqn">\gamma</code>,1)). This function can be used when the prior on the number of components is Negative Binomial with parameter <code class="reqn">r&gt;0</code> and
<code class="reqn">0&lt;p&lt;1</code>, with mean <code class="reqn">mu =1+ r*p/(1-p)</code>. See (Argiento and Iorio 2019) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_prior_K_NegBin(n, gamma, r, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_prior_K_NegBin_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="AM_prior_K_NegBin_+3A_gamma">gamma</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet distribution.</p>
</td></tr>
<tr><td><code id="AM_prior_K_NegBin_+3A_r">r</code></td>
<td>
<p>The dispersion parameter <code>r</code> of the Negative Binomial.</p>
</td></tr>
<tr><td><code id="AM_prior_K_NegBin_+3A_p">p</code></td>
<td>
<p>The probability of failure parameter <code>p</code> of the Negative Binomial.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are no default values.
</p>


<h3>Value</h3>

<p>an <code><a href="#topic+AM_prior">AM_prior</a></code> object, that is a vector of length n, reporting the values <code>V(n,k)</code> for <code>k=1,...,n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 50
gamma &lt;- 1
r &lt;- 0.1
p &lt;- 0.91
gam_nb &lt;- 0.2381641
prior_K_nb &lt;-  AM_prior_K_NegBin(n,gam_nb,r,p)
plot(prior_K_nb)
</code></pre>

<hr>
<h2 id='AM_prior_K_Pois'>Computes the prior number of clusters</h2><span id='topic+AM_prior_K_Pois'></span>

<h3>Description</h3>

<p>This function computes the prior on the number of clusters, i.e. occupied components of the mixture for a Finite Dirichlet process when the prior on the component-weights of the mixture is a
Dirichlet with parameter <code>gamma</code> (i.e. when unnormalized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1)). This function can be used when the prior on the number of
components is Shifted Poisson of parameter <code>Lambda</code>. See (Argiento and Iorio 2019) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_prior_K_Pois(n, gamma, Lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_prior_K_Pois_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="AM_prior_K_Pois_+3A_gamma">gamma</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet distribution.</p>
</td></tr>
<tr><td><code id="AM_prior_K_Pois_+3A_lambda">Lambda</code></td>
<td>
<p>The <code>Lambda</code> parameter of the Poisson.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are no default values.
</p>


<h3>Value</h3>

<p>an <code><a href="#topic+AM_prior">AM_prior</a></code> object, that is a vector of length n, reporting the values of the prior on the number of clusters induced by the prior on <code>M</code> and <code>w</code>, i.e. <code>p^*_k</code> for <code>k=1,...,n</code>. See (Argiento and Iorio 2019) for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 82
Lambda &lt;- 10
gam_po &lt;- 0.1550195
prior_K_po &lt;-  AM_prior_K_Pois(n,gam_po,Lambda)
plot(prior_K_po)
</code></pre>

<hr>
<h2 id='AM_salso'>Sequentially Allocated Latent Structure Optimisation</h2><span id='topic+AM_salso'></span>

<h3>Description</h3>

<p>Heuristic partitioning to minimise the expected loss function
with respect to a given expected adjacency matrix. This function is built upon R-package salso's implementation of the
<code>salso</code> function. See salso (Dahl et al. 2021) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_salso(
  eam,
  loss,
  maxNClusters = 0,
  nRuns = 16,
  maxZealousAttempts = 10,
  probSequentialAllocation = 0.5,
  nCores = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AM_salso_+3A_eam">eam</code></td>
<td>
<p>a co-clustering/ clustering matrix. See salso for more information on which matrix to use.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_loss">loss</code></td>
<td>
<p>the recommended loss functions to be used are the &quot;binder&quot; or &quot;VI&quot;. However, other loss functions that are supported
can be found in the R-package salso's salso function.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_maxnclusters">maxNClusters</code></td>
<td>
<p>Maximum number of clusters to be considered.
The actual number of clusters searched may be lower. Default is 0.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_nruns">nRuns</code></td>
<td>
<p>Number of runs to try.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_maxzealousattempts">maxZealousAttempts</code></td>
<td>
<p>Maximum number of tries for zealous updates. See salso for more information.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_probsequentialallocation">probSequentialAllocation</code></td>
<td>
<p>The probability of using sequential allocation instead of random sampling via sample(1:K,ncol(x),TRUE),
where K is maxNClusters. Default is 0.5. See salso for more information.
argument.</p>
</td></tr>
<tr><td><code id="AM_salso_+3A_ncores">nCores</code></td>
<td>
<p>Number of CPU cores to engage. Default is 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector describing the estimated partition. The integer values represent the cluster labels of each item respectively.
</p>


<h3>Source</h3>

<p>David B. Dahl and Devin J. Johnson and Peter Müller (2021). salso: Search Algorithms and Loss Functions for Bayesian Clustering. R package version 0.2.15.
</p>

<hr>
<h2 id='AM_sample_multibin'>AM_sample_multibin</h2><span id='topic+AM_sample_multibin'></span>

<h3>Description</h3>

<p>AM_sample_multibin
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_sample_multibin(n, d, pro, TH)
</code></pre>

<hr>
<h2 id='AM_sample_multinorm'>AM_sample_multinorm</h2><span id='topic+AM_sample_multinorm'></span>

<h3>Description</h3>

<p>AM_sample_multinorm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_sample_multinorm(n, d, pro, MU, SIG)
</code></pre>

<hr>
<h2 id='AM_sample_uninorm'>AM_sample_uninorm</h2><span id='topic+AM_sample_uninorm'></span>

<h3>Description</h3>

<p>AM_sample_uninorm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_sample_uninorm(n, pro, mmu, ssd)
</code></pre>

<hr>
<h2 id='AM_sample_unipois'>AM_sample_unipois</h2><span id='topic+AM_sample_unipois'></span>

<h3>Description</h3>

<p>AM_sample_unipois
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AM_sample_unipois(n = 1000, pro = c(0.2, 0.5, 0.3), mth = c(5, 25, 50))
</code></pre>

<hr>
<h2 id='AntMAN'>AntMAN: A package for fitting finite Bayesian Mixture models with a random number of components</h2><span id='topic+AntMAN'></span>

<h3>Description</h3>

<p>AntMAN: Anthology of Mixture ANalysis tools
AntMan is an R package fitting Finite Bayesian Mixture models with a random number of components.
The MCMC algorithm behind AntMAN is based on point processes and offers a more computationally
efficient alternative to the Reversible Jump.
Different mixture kernels can be specified: univariate Gaussian, multivariate Gaussian, univariate Poisson,
and multivariate Bernoulli (Latent Class Analysis). For the parameters characterising the mixture kernel, we specify
conjugate priors, with possibly user specified hyper-parameters.
We allow for different choices on the prior on the number of components:
Shifted Poisson, Negative Binomial, and Point Masses (i.e. mixtures with fixed number of components).
</p>


<h3>Package Philosophy</h3>

<p>The main function of the AntMAN package is <code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>. AntMAN performs a Gibbs sampling in order to fit,
in a Bayesian framework, a mixture model of a predefined type <code>mix_kernel_hyperparams</code>  given a sample <code>y</code>.
Additionally AntMAN allows the user to specify a prior on the number of components <code>mix_components_prior</code> and on the weights  <code>mix_weight_prior</code> of the mixture.
MCMC parameters <code>mcmc_parameters</code> need to be given as argument for the Gibbs sampler (number of interations, burn-in, ...).
Initial values for the number of clusters (<code>init_K</code>) or a specific clustering allocation (<code>init_clustering</code>) can also be user-specified.
Otherwise, by default, we initialise each element of the sample <code>y</code> to a different cluster allocation. This choice can be computationally inefficient.
</p>
<p>For example, in order to identify clusters over a population of patients given a set of medical assumptions:</p>
<pre>mcmc = AM_mcmc_parameters(niter=20000) 
mix = AM_mix_hyperparams_multiber () 
fit = AM_mcmc_fit (mix, mcmc) 
summary (fit)
</pre>
<p>In this example <code>AM_mix_hyperparams_multiber</code> is one of the possible mixtures to use.
</p>
<p>AntMAN currently support four different mixtures :</p>
<pre>AM_mix_hyperparams_unipois(alpha0, beta0) 
AM_mix_hyperparams_uninorm(m0, k0, nu0, sig02) 
AM_mix_hyperparams_multiber(a0, b0) 
AM_mix_hyperparams_multinorm(mu0, ka0, nu0, Lam0)
</pre>
<p>Additionally, three types of kernels on the prior number of components are available:</p>
<pre>AM_mix_components_prior_pois()
AM_mix_components_prior_negbin() 
AM_mix_components_prior_dirac()
</pre>
<p>For example, in the context of image segmentation, if we know that there are 10 colours present, a prior dirac can be used :</p>
<pre>mcmc = AM_mcmc_parameters(niter=20000) 
mix = AM_mix_hyperparams_multinorm () 
prior_component = AM_mix_components_prior_dirac(10) #  10 colours present
fit = AM_mcmc_fit (mix, prior_component, mcmc) 
summary (fit)
</pre>

<hr>
<h2 id='brain'>Teen Brain Images from the National Institutes of Health, U.S.</h2><span id='topic+brain'></span>

<h3>Description</h3>

<p>Picture of brain activities from a teenager consuming drugs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain
</code></pre>


<h3>Format</h3>

<p>A list that contains <code>dim</code> a (W:width,H:height) pair, and  <code>pic</code> a data frame (W*H pixels image in RGB format).
</p>


<h3>Source</h3>

<p>https://www.flickr.com/photos/nida-nih/29741916012
</p>


<h3>References</h3>

<p>Crowley TJ, Dalwani MS, Mikulich-Gilbertson SK, Young SE, Sakai JT, Raymond KM, et al. (2015) Adolescents' Neural Processing of Risky Decisions: Effects of Sex and Behavioral Disinhibition. PLoS ONE 10(7): e0132322. doi:10.1371/journal.pone.0132322
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(brain)
 
</code></pre>

<hr>
<h2 id='carcinoma'>Carcinoma dataset</h2><span id='topic+carcinoma'></span>

<h3>Description</h3>

<p>The carcinoma data from Agresti (2002, 542) consist of seven dichotomous variables representing
the ratings by seven pathologists of 118 slides on the presence or absence of carcinoma.
The purpose of studying this data is to model &quot;interobserver agreement&quot; by examining how
subjects might be divided into groups depending upon the consistency of their diagnoses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>carcinoma
</code></pre>


<h3>Format</h3>

<p>A data frame with 118 rows and 7 variables (from A to G).
</p>


<h3>References</h3>

<p>Agresti A (2002). Categorical Data Analysis. John Wiley &amp; Sons, Hoboken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(carcinoma)
 
</code></pre>

<hr>
<h2 id='galaxy'>Galaxy velocities dataset</h2><span id='topic+galaxy'></span>

<h3>Description</h3>

<p>This data set considers the physical information of velocities (10^3 km/second) for
82 galaxies reported by Roeder (1990). These are drawn from six well-separated
conic sections of the Corona Borealis region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galaxy
</code></pre>


<h3>Format</h3>

<p>A data frame with X rows and Y variables.
</p>
<p>A numeric vector giving the speed of galaxies (1000*(km/second))
</p>


<h3>Source</h3>

<p>Roeder, K. (1990). Density estimation with confidence sets exemplified by superclusters and voids in the galaxies, Journal of the American Statistical Association, 85: 617-624.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(galaxy)
</code></pre>

<hr>
<h2 id='IAM_compute_stirling_ricor_abs'>Compute the logarithm of the absolute value of the  generalized Sriling number of second Kind (mi pare) See charambeloides, using a recursive formula Devo vedere la formula</h2><span id='topic+IAM_compute_stirling_ricor_abs'></span>

<h3>Description</h3>

<p>There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_compute_stirling_ricor_abs(n, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_compute_stirling_ricor_abs_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="IAM_compute_stirling_ricor_abs_+3A_gamma">gamma</code></td>
<td>
<p>A positive real number <code>gamma</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length n, reporting the values <code>C(gamma,n,k)</code> for <code>k=1,...,n</code>
</p>

<hr>
<h2 id='IAM_compute_stirling_ricor_log'>Compute stirling ricor log</h2><span id='topic+IAM_compute_stirling_ricor_log'></span>

<h3>Description</h3>

<p>There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_compute_stirling_ricor_log(n, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_compute_stirling_ricor_log_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="IAM_compute_stirling_ricor_log_+3A_gamma">gamma</code></td>
<td>
<p>A positive real number <code>gamma</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length n, reporting the values ... for <code>k=1,...,n</code>
</p>

<hr>
<h2 id='IAM_mcmc_error'>Internal function used to compute the MCMC Error as a batch mean.</h2><span id='topic+IAM_mcmc_error'></span>

<h3>Description</h3>

<p>Internal function used to compute the MCMC Error as a batch mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_mcmc_error(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_mcmc_error_+3A_x">X</code></td>
<td>
<p>is a chain</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the MCMC Error (sqrt(sigma2) / sqrt(N))
</p>

<hr>
<h2 id='IAM_mcmc_neff'>IAM_mcmc_neff MCMC Parameters</h2><span id='topic+IAM_mcmc_neff'></span>

<h3>Description</h3>

<p>TBD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_mcmc_neff(unichain)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_mcmc_neff_+3A_unichain">unichain</code></td>
<td>
</td></tr>
</table>


<h3>Value</h3>

<p>Effective Sample Size
</p>

<hr>
<h2 id='IAM_VnkDelta'>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts
of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) )
when the number of component are fixed to <code>M^*</code>, i.e. a Dirac prior assigning mass only to <code>M^*</code> is assumed.
See Section 9.1.1 of the Paper Argiento de Iorio 2019 for more details.</h2><span id='topic+IAM_VnkDelta'></span>

<h3>Description</h3>

<p>There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_VnkDelta(n, Mstar, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_VnkDelta_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="IAM_VnkDelta_+3A_mstar">Mstar</code></td>
<td>
<p>The number of component of the mixture</p>
</td></tr>
<tr><td><code id="IAM_VnkDelta_+3A_gamma">gamma</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length n, reporting the values <code>V(n,k)</code> for <code>k=1,...,n</code>
</p>

<hr>
<h2 id='IAM_VnkNegBin'>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) ) when the prior on the number of componet is Negative Binomial with parameter <code>r</code> and <code>p</code>with  mean is mu =1+ r*p/(1-p) TODO: CHECK THIS FORMULA!!!. See Section 9.1.1 of the Paper Argiento de Iorio 2019 for more details</h2><span id='topic+IAM_VnkNegBin'></span>

<h3>Description</h3>

<p>There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_VnkNegBin(n, r, p, gam)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_VnkNegBin_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="IAM_VnkNegBin_+3A_r">r</code></td>
<td>
<p>The dispersion parameter <code>r</code> of Negative Binomial</p>
</td></tr>
<tr><td><code id="IAM_VnkNegBin_+3A_p">p</code></td>
<td>
<p>The probability of failure parameter <code>p</code> of Negative Binomial</p>
</td></tr>
<tr><td><code id="IAM_VnkNegBin_+3A_gam">gam</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length n, reporting the values <code>V(n,k)</code> for <code>k=1,...,n</code>
</p>

<hr>
<h2 id='IAM_VnkPoisson'>Compute the value V(n,k), needed to caclulate the eppf of a Finite Dirichlet process when the prior on the component-weigts of the mixture is a Dirichlet with parameter <code>gamma</code> (i.e. when unnormailized weights are distributed as Gamma(<code class="reqn">\gamma</code>,1) ) when the prior on the number of componet is Shifted Poisson of parameter <code>Lambda</code>. See Section 9.1.1 of the Paper Argiento de Iorio 2019.</h2><span id='topic+IAM_VnkPoisson'></span>

<h3>Description</h3>

<p>There are no default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IAM_VnkPoisson(n, Lambda, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IAM_VnkPoisson_+3A_n">n</code></td>
<td>
<p>The sample size</p>
</td></tr>
<tr><td><code id="IAM_VnkPoisson_+3A_lambda">Lambda</code></td>
<td>
<p>The <code>Lambda</code> parameter of the Poisson</p>
</td></tr>
<tr><td><code id="IAM_VnkPoisson_+3A_gamma">gamma</code></td>
<td>
<p>The <code>gamma</code> parameter of the Dirichlet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length n, reporting the values <code>V(n,k)</code> for <code>k=1,...,n</code>
</p>

<hr>
<h2 id='list_values'>Internal function that produces a string from a list of values</h2><span id='topic+list_values'></span>

<h3>Description</h3>

<p>Internal function that produces a string from a list of values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_values(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_values_+3A_x">x</code></td>
<td>
<p>a list of values</p>
</td></tr>
</table>

<hr>
<h2 id='plot.AM_mcmc_output'>plot AM_mcmc_output</h2><span id='topic+plot.AM_mcmc_output'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function plots some useful information about the MCMC results
regarding <code class="reqn">M</code> and <code class="reqn">K</code>. Besides the PMFs, some of the diagnostic plots of the MCMC chain are visualised.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mcmc_output'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.AM_mcmc_output_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object.</p>
</td></tr>
<tr><td><code id="plot.AM_mcmc_output_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>

<hr>
<h2 id='plot.AM_prior'>plot AM_prior</h2><span id='topic+plot.AM_prior'></span>

<h3>Description</h3>

<p>plot the prior on the number of clusters for a given <code><a href="#topic+AM_prior">AM_prior</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_prior'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.AM_prior_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+AM_prior">AM_prior</a></code> object. See <code><a href="#topic+AM_prior_K_Delta">AM_prior_K_Delta</a></code>, <code><a href="#topic+AM_prior_K_NegBin">AM_prior_K_NegBin</a></code>,
<code><a href="#topic+AM_prior_K_Pois">AM_prior_K_Pois</a></code> for more details.</p>
</td></tr>
<tr><td><code id="plot.AM_prior_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>

<hr>
<h2 id='said'>Usage frequency of the word &quot;said&quot; in the Brown corpus</h2><span id='topic+said'></span>

<h3>Description</h3>

<p>Usage frequency of the word &quot;said&quot; in the Brown corpus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>said
</code></pre>


<h3>Format</h3>

<p>A list with 500 observations on the frequency of said in different texts.
</p>


<h3>Source</h3>

<p>https://www.kaggle.com/nltkdata/brown-corpus
</p>


<h3>References</h3>

<p>Francis, W., and Kucera, H. (1982) Frequency Analysis of English Usage, Houghton Mifflin Company, Boston.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(said)
</code></pre>

<hr>
<h2 id='summary.AM_mcmc_configuration'>summary information of the AM_mcmc_configuration object</h2><span id='topic+summary.AM_mcmc_configuration'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_configuration">AM_mcmc_configuration</a></code> object, this function prints the summary information
of the specified mcmc configuration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mcmc_configuration'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_mcmc_configuration_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_mcmc_configuration">AM_mcmc_configuration</a></code> object.</p>
</td></tr>
<tr><td><code id="summary.AM_mcmc_configuration_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_parameters">AM_mcmc_parameters</a></code>
</p>

<hr>
<h2 id='summary.AM_mcmc_output'>summary information of the AM_mcmc_output object</h2><span id='topic+summary.AM_mcmc_output'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object, this function prints the summary information
pertaining to the given model output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mcmc_output'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_mcmc_output_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+AM_mcmc_output">AM_mcmc_output</a></code> object</p>
</td></tr>
<tr><td><code id="summary.AM_mcmc_output_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mcmc_fit">AM_mcmc_fit</a></code>, <code><a href="#topic+AM_mcmc_refit">AM_mcmc_refit</a></code>
</p>

<hr>
<h2 id='summary.AM_mix_components_prior'>summary information of the AM_mix_components_prior object</h2><span id='topic+summary.AM_mix_components_prior'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code> object, this function prints the summary information
of the specified prior on the number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mix_components_prior'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_mix_components_prior_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code> object.</p>
</td></tr>
<tr><td><code id="summary.AM_mix_components_prior_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_components_prior">AM_mix_components_prior</a></code>
</p>

<hr>
<h2 id='summary.AM_mix_hyperparams'>summary information of the AM_mix_hyperparams object</h2><span id='topic+summary.AM_mix_hyperparams'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object, this function prints the summary information
of the specified mixture hyperparameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mix_hyperparams'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_mix_hyperparams_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code> object.</p>
</td></tr>
<tr><td><code id="summary.AM_mix_hyperparams_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_hyperparams">AM_mix_hyperparams</a></code>
</p>

<hr>
<h2 id='summary.AM_mix_weights_prior'>summary information of the AM_mix_weights_prior object</h2><span id='topic+summary.AM_mix_weights_prior'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_mix_weights_prior">AM_mix_weights_prior</a></code> object, this function prints the summary information
of the specified mixture weights prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_mix_weights_prior'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_mix_weights_prior_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_mix_weights_prior">AM_mix_weights_prior</a></code> object.</p>
</td></tr>
<tr><td><code id="summary.AM_mix_weights_prior_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_mix_weights_prior">AM_mix_weights_prior</a></code>
</p>

<hr>
<h2 id='summary.AM_prior'>summary information of the AM_prior object</h2><span id='topic+summary.AM_prior'></span>

<h3>Description</h3>

<p>Given an <code><a href="#topic+AM_prior">AM_prior</a></code> object, this function prints the summary information of the specified prior on the number of clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'AM_prior'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.AM_prior_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+AM_prior">AM_prior</a></code> object. See <code><a href="#topic+AM_prior_K_Delta">AM_prior_K_Delta</a></code>, <code><a href="#topic+AM_prior_K_NegBin">AM_prior_K_NegBin</a></code>,
<code><a href="#topic+AM_prior_K_Pois">AM_prior_K_Pois</a></code> for more details.</p>
</td></tr>
<tr><td><code id="summary.AM_prior_+3A_...">...</code></td>
<td>
<p>all additional parameters are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Called for side effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AM_prior">AM_prior</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
