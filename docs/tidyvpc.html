<!DOCTYPE html><html><head><title>Help for package tidyvpc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidyvpc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bininfo'><p>Obtain information about the bins from a <code>tidyvpcobj</code></p></a></li>
<li><a href='#binless'><p>Perform binless Visual Predictive Check (VPC)</p></a></li>
<li><a href='#binning'><p>Binning methods for Visual Predictive Check (VPC)</p></a></li>
<li><a href='#binningfunctions'><p>Different functions that perform binning.</p></a></li>
<li><a href='#censoring'><p>Censoring observed data for Visual Predictive Check (VPC)</p></a></li>
<li><a href='#check_order'><p>Perform a consistency check on observed and simulated data</p></a></li>
<li><a href='#generics'><p>Perform a Visual Predictive Check (VPC) computation</p></a></li>
<li><a href='#nopredcorrect'><p>Remove prediction correction for Visual Predictive Check (VPC)</p></a></li>
<li><a href='#npde'><p>Normalized Prediction Distribution Errors</p></a></li>
<li><a href='#obs_cat_data'><p>Example observed data with categorical DV</p></a></li>
<li><a href='#obs_data'><p>Example observed data with continuous DV</p></a></li>
<li><a href='#observed'><p>Specify observed dataset and variables for VPC</p></a></li>
<li><a href='#plot.tidyvpcobj'><p>Plot a <code>tidyvpcobj</code></p></a></li>
<li><a href='#predcorrect'><p>Prediction corrected Visual Predictive Check (pcVPC)</p></a></li>
<li><a href='#print.tidyvpcobj'><p>Print a <code>tidyvpcobj</code></p></a></li>
<li><a href='#sim_cat_data'><p>Example simulated data with categorical DV</p></a></li>
<li><a href='#sim_data'><p>Example simulated data with continuous DV</p></a></li>
<li><a href='#simulated'><p>Specify simulated dataset and variables for VPC</p></a></li>
<li><a href='#stratify'><p>Stratification for Visual Predictive Check (VPC)</p></a></li>
<li><a href='#vpcstats'><p>Compute VPC statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>VPC Percentiles and Prediction Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform a Visual Predictive Check (VPC), while accounting for 
    stratification, censoring, and prediction correction. Using piping from 
    'magrittr', the intuitive syntax gives users a flexible and powerful method 
    to generate VPCs using both traditional binning and a new binless approach 
    Jamsen et al. (2018) &lt;<a href="https://doi.org/10.1002%2Fpsp4.12319">doi:10.1002/psp4.12319</a>&gt; with Additive Quantile 
    Regression (AQR) and Locally Estimated Scatterplot Smoothing (LOESS) 
    prediction correction. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/certara/tidyvpc">https://github.com/certara/tidyvpc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/certara/tidyvpc/issues">https://github.com/certara/tidyvpc/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.9.8), magrittr, quantreg (&ge; 5.51), rlang (&ge;
0.3.0), methods, mgcv, classInt, cluster, ggplot2, stats,
fastDummies, utils, egg</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, KernSmooth, knitr, nlmixr2, shiny, remotes, vpc,
rmarkdown, testthat (&ge; 2.1.0), vdiffr (&ge; 1.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-18 11:13:45 UTC; jcraig</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Barriere [aut],
  Benjamin Rich [aut],
  James Craig <a href="https://orcid.org/0000-0003-1757-9234"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Samer Mouksassi [aut],
  Bill Denney <a href="https://orcid.org/0000-0002-5759-428X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Kris Jamsen [ctb],
  Certara USA, Inc. [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Craig &lt;james.craig@certara.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-18 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bininfo'>Obtain information about the bins from a <code>tidyvpcobj</code></h2><span id='topic+bininfo'></span><span id='topic+bininfo.tidyvpcobj'></span>

<h3>Description</h3>

<p>Obtain information about the bins from a <code>tidyvpcobj</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bininfo(o, ...)

## S3 method for class 'tidyvpcobj'
bininfo(o, by.strata = o$bin.by.strata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bininfo_+3A_o">o</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="bininfo_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="bininfo_+3A_by.strata">by.strata</code></td>
<td>
<p>Should the calculations be done by strata? Defaults to what
was specified when the binning was done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.table' containing the following columns:
</p>

<ul>
<li> <p><code>nobs</code>: Number of observed data points in the bin
</p>
</li>
<li> <p><code>xmedian</code>: Median x-value of the observed data points in the bin
</p>
</li>
<li> <p><code>xmean</code>: Mean x-value of the observed data points in the bin
</p>
</li>
<li> <p><code>xmax</code>: Maximum x-value of the observed data points in the bin
</p>
</li>
<li> <p><code>xmin</code>: Minimum x-value of the observed data points in the bin
</p>
</li>
<li> <p><code>xmid</code>: Value halfway between 'xmin' and 'xmax'.
x-value of the observed data points in the bin
</p>
</li>
<li> <p><code>xleft</code>: Value halfway between the minimum x-value of the
current bin and the maximum x-value of the previous bin to the left (for
the left-most bin, it is the minimum x-value).
</p>
</li>
<li> <p><code>xright</code>: Value halfway between the maximum x-value of the
current bin and the minimum x-value of the next bin to the right (for the
right-most bin, it is the maximum x-value).
</p>
</li>
<li> <p><code>xcenter</code>: Value halfway between 'xleft' and 'xright'.
</p>
</li></ul>

<p>In addition, if stratification was performed, the stratification columns will
be included as well.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>bininfo(tidyvpcobj)</code>: Method for <code>tidyvpcobj</code>.
</p>
</li></ul>

<hr>
<h2 id='binless'>Perform binless Visual Predictive Check (VPC)</h2><span id='topic+binless'></span><span id='topic+binless.tidyvpcobj'></span>

<h3>Description</h3>

<p>Use this function in place of traditional binning methods to derive VPC. For continuous
VPC, this is obtained using additive quantile regression (<code>quantreg::rqss()</code>) and LOESS for pcVPC. While for categorical
VPC, this is obtained using a generalized additive model (<code>gam(family = "binomial")</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binless(o, ...)

## S3 method for class 'tidyvpcobj'
binless(
  o,
  optimize = TRUE,
  optimization.interval = c(0, 7),
  loess.ypc = NULL,
  lambda = NULL,
  span = NULL,
  sp = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binless_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="binless_+3A_...">...</code></td>
<td>
<p>Other arguments to include will be ignored.</p>
</td></tr>
<tr><td><code id="binless_+3A_optimize">optimize</code></td>
<td>
<p>Logical indicating whether smoothing parameters should be optimized using AIC.</p>
</td></tr>
<tr><td><code id="binless_+3A_optimization.interval">optimization.interval</code></td>
<td>
<p>Numeric vector of length 2 specifying the min/max range of smoothing parameter for optimization. Only applicable if <code>optimize = TRUE</code>.</p>
</td></tr>
<tr><td><code id="binless_+3A_loess.ypc">loess.ypc</code></td>
<td>
<p>(Deprecated) Argument is ignored. For a LOESS pcVPC using the 'binless' method, usage of <code><a href="#topic+predcorrect">predcorrect</a></code> will automatically perform LOESS prediction correction.</p>
</td></tr>
<tr><td><code id="binless_+3A_lambda">lambda</code></td>
<td>
<p>Numeric vector of length 3 specifying lambda values for each quantile. If stratified, specify a <code>data.frame</code> with given strata represented the column name, and value specified as a numeric vector of length 3.
See below examples. Only applicable to continuous VPC with <code>optimize = FALSE</code>.</p>
</td></tr>
<tr><td><code id="binless_+3A_span">span</code></td>
<td>
<p>Numeric between 0,1 specifying smoothing parameter for LOESS prediction correction. Only applicable for continuous VPC with <code>optimize = FALSE</code> and usage of <code><a href="#topic+predcorrect">predcorrect</a></code>.</p>
</td></tr>
<tr><td><code id="binless_+3A_sp">sp</code></td>
<td>
<p>List of smoothing parameters applied to <code>mgcv::gam()</code>. Elements of list must be in the same order as unique values of DV. If one or more stratification variables present, the order of sp
should be specified as unique combination of strata + DV, in ascending order. See below examples. Only applicable for categorical VPC, if <code>optimize = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For continuous VPC, updates <code>tidyvpcobj</code> with additive quantile regression fits for observed and simulated data for quantiles specified in the <code>qpred</code> argument of <code>vpcstats()</code>.
If the <code>optimize = TRUE</code> argument is specified, the resulting <code>tidyvpcobj</code> will contain optimized lambda values according to AIC.  For prediction
corrected VPC (pcVPC), specifying <code>loess.ypc = TRUE</code> will return optimized span value for LOESS smoothing. For categorical VPC,
updates <code>tidyvpcobj</code> with fits obtained by <code>gam(family="binomial")</code> for observed and simulated data for each category of DV (in each stratum if <code>stratify</code> defined).
If <code>optimize = TRUE</code> argument is specified, the resulting <code>tidyvpcobj</code> wil contain optimized <code>sp</code> values according to AIC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

require(magrittr)
require(data.table)

obs_data &lt;- obs_data[MDV == 0]
sim_data &lt;- sim_data[MDV == 0]


 vpc &lt;- observed(obs_data, y = DV, x = TIME) %&gt;%
      simulated(sim_data, y = DV) %&gt;%
      binless() %&gt;%
      vpcstats()

 # Binless example with LOESS prediction correction

 obs_data$PRED &lt;- sim_data[REP == 1, PRED]

 vpc &lt;- observed(obs_data, y = DV, x = TIME) %&gt;%
      simulated(sim_data, y = DV) %&gt;%
      binless(optimize = TRUE) %&gt;%
      predcorrect(pred = PRED) %&gt;% 
      vpcstats()

# Binless example with user specified lambda values stratified on
# "GENDER" with 2 levels ("M", "F"), 10%, 50%, 90% quantiles.

 lambda_strat &lt;- data.table(
 GENDER_M = c(3,5,2),
 GENDER_F = c(1,3,4)
 )

 vpc &lt;- observed(obs_data, y = DV, x = TIME) %&gt;%
      simulated(sim_data, y = DV) %&gt;%
      stratify(~ GENDER) %&gt;%
      binless(optimize = FALSE, lambda = lambda_strat) %&gt;%
      vpcstats(qpred = c(0.1, 0.5, 0.9))

 # Binless example for categorical DV with optimized smoothing
 vpc &lt;- observed(obs_cat_data, x = agemonths, yobs = zlencat) %&gt;%
       simulated(sim_cat_data, ysim = DV) %&gt;%
       stratify(~ Country_ID_code) %&gt;%
       binless() %&gt;%
       vpcstats(vpc.type = "cat", quantile.type = 6)

 # Binless example for categorical DV with user specified sp values
 user_sp &lt;- list(
 Country1_prob0 = 100,
 Country1_prob1 = 3,
 Country1_prob2 = 4,
 Country2_prob0 = 90,
 Country2_prob1 = 3,
 Country2_prob2 = 4,
 Country3_prob0 = 55,
 Country3_prob1 = 3,
 Country3_prob2 = 200)

 vpc &lt;- observed(obs_cat_data, x = agemonths, yobs = zlencat) %&gt;%
        simulated(sim_cat_data, ysim = DV) %&gt;%
        stratify(~ Country_ID_code) %&gt;%
        binless(optimize = FALSE, sp = user_sp) %&gt;%
        vpcstats(vpc.type = "categorical", conf.level = 0.9, quantile.type = 6)


</code></pre>

<hr>
<h2 id='binning'>Binning methods for Visual Predictive Check (VPC)</h2><span id='topic+binning'></span><span id='topic+binning.tidyvpcobj'></span>

<h3>Description</h3>

<p>This function executes binning methods available in classInt i.e. &quot;jenks&quot;, &quot;kmeans&quot;, &quot;sd&quot;, &quot;pretty&quot;, &quot;pam&quot;, &quot;kmeans&quot;, &quot;hclust&quot;, &quot;bclust&quot;, &quot;fisher&quot;, &quot;dpih&quot;, &quot;box&quot;, &quot;headtails&quot;, and &quot;maximum&quot;.
You may also bin directly on x-variable or alternatively specify &quot;centers&quot; or &quot;breaks&quot;. For explanation of binning methods see <code><a href="classInt.html#topic+classIntervals">classIntervals</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binning(o, ...)

## S3 method for class 'tidyvpcobj'
binning(
  o,
  bin,
  data = o$data,
  xbin = "xmedian",
  centers,
  breaks,
  nbins,
  altx,
  stratum = NULL,
  by.strata = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binning_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="binning_+3A_...">...</code></td>
<td>
<p>Other arguments to include for <code>classIntervals</code>. See <code>...</code> usage for <code>style</code> in <code>?classIntervals</code>.</p>
</td></tr>
<tr><td><code id="binning_+3A_bin">bin</code></td>
<td>
<p>Character string indicating binning method or unquoted variable name if binning on x-variable.</p>
</td></tr>
<tr><td><code id="binning_+3A_data">data</code></td>
<td>
<p>Observed data supplied in <code>observed()</code> function.</p>
</td></tr>
<tr><td><code id="binning_+3A_xbin">xbin</code></td>
<td>
<p>Character string indicating midpoint type for binning.</p>
</td></tr>
<tr><td><code id="binning_+3A_centers">centers</code></td>
<td>
<p>Numeric vector of centers for binning. Use <code>bin = "centers"</code>, if supplying centers.</p>
</td></tr>
<tr><td><code id="binning_+3A_breaks">breaks</code></td>
<td>
<p>Numeric vector of breaks for binning. Use <code>bin = "breaks"</code>, if supplying breaks.</p>
</td></tr>
<tr><td><code id="binning_+3A_nbins">nbins</code></td>
<td>
<p>Numeric number indicating the number of bins to use.</p>
</td></tr>
<tr><td><code id="binning_+3A_altx">altx</code></td>
<td>
<p>Unquoted variable name in observed data for alternative x-variable binning.</p>
</td></tr>
<tr><td><code id="binning_+3A_stratum">stratum</code></td>
<td>
<p>List indicating the name of stratification variable and level, if using different binning methods by strata.</p>
</td></tr>
<tr><td><code id="binning_+3A_by.strata">by.strata</code></td>
<td>
<p>Logical indicating whether binning should be performed by strata.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updates <code>tidyvpcobj</code> with <code>data.frame</code> containing bin information including left/right boundaries and midpoint, as specified in <code>xbin</code> argument.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(magrittr)

 # Binning on x-variable NTIME
vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    binning(bin = NTIME) %&gt;%
    vpcstats()

 # Binning using ntile and xmean for midpoint
vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    binning(bin = "ntile", nbins = 8, xbin = "xmean") %&gt;%
    vpcstats()

 # Binning using centers
vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    binning(bin = "centers", centers = c(1,3,5,7)) %&gt;%
    vpcstats()

 # Different Binning for each level of Strata
vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    stratify(~ GENDER) %&gt;%
    binning(stratum = list(GENDER = "M"), bin = "jenks", nbins = 5, by.strata = TRUE) %&gt;%
    binning(stratum = list(GENDER = "F"), bin = "kmeans", nbins = 4, by.strata = TRUE) %&gt;%
    vpcstats()

 # Binning Categorical DV using rounded time variable

  vpc &lt;- observed(obs_cat_data, x = agemonths, y = zlencat ) %&gt;%
      simulated(sim_cat_data, y = DV) %&gt;%
      binning(bin = round(agemonths, 0)) %&gt;%
      vpcstats(vpc.type = "categorical")


</code></pre>

<hr>
<h2 id='binningfunctions'>Different functions that perform binning.</h2><span id='topic+binningfunctions'></span><span id='topic+cut_at'></span><span id='topic+nearest'></span><span id='topic+bin_by_ntile'></span><span id='topic+bin_by_eqcut'></span><span id='topic+bin_by_pam'></span><span id='topic+bin_by_classInt'></span>

<h3>Description</h3>

<p>Different functions that perform binning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_at(breaks)

nearest(centers)

bin_by_ntile(nbins)

bin_by_eqcut(nbins)

bin_by_pam(nbins)

bin_by_classInt(style, nbins = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binningfunctions_+3A_breaks">breaks</code></td>
<td>
<p>A numeric vector of values that designate cut points between bins.</p>
</td></tr>
<tr><td><code id="binningfunctions_+3A_centers">centers</code></td>
<td>
<p>A numeric vector of values that designate the center of each bin.</p>
</td></tr>
<tr><td><code id="binningfunctions_+3A_nbins">nbins</code></td>
<td>
<p>The number of bins to split the data into.</p>
</td></tr>
<tr><td><code id="binningfunctions_+3A_style">style</code></td>
<td>
<p>a binning style (see <a href="classInt.html#topic+classIntervals">classIntervals</a> for details).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Each of these functions returns a function of a single numeric
vector 'x' that assigns each value of 'x' to a bin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- c(rnorm(10, 1, 1), rnorm(10, 3, 2), rnorm(20, 5, 3))
centers &lt;- c(1, 3, 5)
nearest(centers)(x)

breaks &lt;- c(2, 4)
cut_at(breaks)(x)

bin_by_eqcut(nbins=4)(x)
bin_by_ntile(nbins=4)(x)

bin_by_pam(nbins=4)(x)
bin_by_classInt("pretty", nbins=4)(x)

</code></pre>

<hr>
<h2 id='censoring'>Censoring observed data for Visual Predictive Check (VPC)</h2><span id='topic+censoring'></span><span id='topic+censoring.tidyvpcobj'></span>

<h3>Description</h3>

<p>Specify censoring variable or censoring value for VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censoring(o, ...)

## S3 method for class 'tidyvpcobj'
censoring(o, blq, lloq, alq, uloq, data = o$data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censoring_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="censoring_+3A_...">...</code></td>
<td>
<p>Other arguments to include.</p>
</td></tr>
<tr><td><code id="censoring_+3A_blq">blq</code></td>
<td>
<p>blq variable if present in observed data.</p>
</td></tr>
<tr><td><code id="censoring_+3A_lloq">lloq</code></td>
<td>
<p>Numeric value or numeric variable in data indicating the upper limit of quantification.</p>
</td></tr>
<tr><td><code id="censoring_+3A_alq">alq</code></td>
<td>
<p>Logical variable indicating above limit of quantification.</p>
</td></tr>
<tr><td><code id="censoring_+3A_uloq">uloq</code></td>
<td>
<p>Numeric value or numeric variable in data indicating the upper limit of quantification.</p>
</td></tr>
<tr><td><code id="censoring_+3A_data">data</code></td>
<td>
<p>Observed data supplied in <code>observed()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updates <code>obs</code> <code>data.frame</code> in <code>tidypcobj</code> with censored values for observed data which includes <code>lloq</code> and <code>uloq</code> specified
values for lower/upper limit of quantification. Logicals for <code>blq</code> and <code>alq</code> are returned that indicate whether the DV value lies below/above limit
of quantification.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(magrittr)

vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    censoring(blq=(DV &lt; 50), lloq=50) %&gt;%
    binning(bin = "pam", nbins = 5) %&gt;%
    vpcstats()

#Using LLOQ variable in data with different values of LLOQ by Study:

obs_data$LLOQ &lt;- obs_data[, ifelse(STUDY == "Study A", 50, 25)]

vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    censoring(blq=(DV &lt; LLOQ), lloq=LLOQ) %&gt;%
    stratify(~ STUDY) %&gt;%
    binning(bin = "kmeans", nbins = 4) %&gt;%
    vpcstats()


</code></pre>

<hr>
<h2 id='check_order'>Perform a consistency check on observed and simulated data</h2><span id='topic+check_order'></span>

<h3>Description</h3>

<p>This function performs a simple consistency check on an observed and
simulated dataset to make sure they are consistent with respect to ordering
as required by the other functions used in the VPC calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_order(obs, sim, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_order_+3A_obs">obs</code>, <code id="check_order_+3A_sim">sim</code></td>
<td>
<p>A 'data.frame' with 2 columns (see Details).</p>
</td></tr>
<tr><td><code id="check_order_+3A_tol">tol</code></td>
<td>
<p>A tolerance for comparing time values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The consistency check is performed by comparing a combination of unique
subject identifier (ID) and time. Both <code>data.frame</code> objects must be given with
those in positions 1 and 2, respectively.
</p>


<h3>Value</h3>

<p>The number of replicates contained in 'sim'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code>, <code><a href="#topic+simulated">simulated</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


 require(data.table)

check_order(obs_data[, .(ID, TIME)], sim_data[, .(ID, TIME)])

</code></pre>

<hr>
<h2 id='generics'>Perform a Visual Predictive Check (VPC) computation</h2><span id='topic+generics'></span>

<h3>Description</h3>

<p>These functions work together to calculate the statistics that are plotted
in a VPC. They would typically be chained together using the &quot;pipe&quot; operator
(see Examples).
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="generics_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="generics_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='nopredcorrect'>Remove prediction correction for Visual Predictive Check (VPC)</h2><span id='topic+nopredcorrect'></span><span id='topic+nopredcorrect.tidyvpcobj'></span>

<h3>Description</h3>

<p>Optional function to use indicating no pred correction for VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nopredcorrect(o, ...)

## S3 method for class 'tidyvpcobj'
nopredcorrect(o, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nopredcorrect_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="nopredcorrect_+3A_...">...</code></td>
<td>
<p>Other arguments to include.</p>
</td></tr>
</table>

<hr>
<h2 id='npde'>Normalized Prediction Distribution Errors</h2><span id='topic+npde'></span><span id='topic+npde.tidyvpcobj'></span>

<h3>Description</h3>

<p>Normalized Prediction Distribution Errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npde(o, ...)

## S3 method for class 'tidyvpcobj'
npde(o, id, data = o$data, smooth = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npde_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="npde_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="npde_+3A_id">id</code></td>
<td>
<p>A vector of IDs. Used to associate observations (<code>y</code>) that
originate from the same individual. Evaluated in the <code>data.frame</code>
<code>data</code>.</p>
</td></tr>
<tr><td><code id="npde_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="npde_+3A_smooth">smooth</code></td>
<td>
<p>Should a uniform random perturbation be used to smooth the pd/pde values?</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brendel, K., Comets, E., Laffont, C., Laveille, C. &amp; Mentrée, F. Metrics
for external model evaluation with an application to the population
pharmacokinetics of gliclazide.  Pharm. Res. (2006) 23(9), 2036–2049.
</p>
<p>Nguyen, T.H.T., et al. Model evaluation of continuous data pharmacometric
models: metrics and graphics.  CPT Pharmacometrics Syst. Pharmacol. (2017)
6(2), 87–109; doi:10.1002/psp4.12161.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(magrittr)
require(ggplot2)

obs &lt;- obs_data[MDV==0]
sim &lt;- sim_data[MDV==0]

npde &lt;- observed(obs, x=NULL, y=DV) %&gt;%
    simulated(sim, y=DV) %&gt;%
    npde(id=ID)

vpc &lt;- observed(npde$npdeobs, x=epred, y=npde) %&gt;%
    simulated(npde$npdesim, y=npde) %&gt;%
    binning("eqcut", nbins=10) %&gt;%
    vpcstats()

plot(vpc) + 
labs(x="Simulation-based Population Prediction", y="Normalized Prediction Distribution Error")


</code></pre>

<hr>
<h2 id='obs_cat_data'>Example observed data with categorical DV</h2><span id='topic+obs_cat_data'></span>

<h3>Description</h3>

<p>An observed dataset with 3 levels of categorical DV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs_cat_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 4014 rows and 4 variables:
</p>

<dl>
<dt>PID_code</dt><dd><p>Subject identifier</p>
</dd>
<dt>agemonths</dt><dd><p>Time</p>
</dd>
<dt>zlencat</dt><dd><p>Categorical DV with the 3 levels</p>
</dd>
<dt>Country_ID_code</dt><dd><p>Country code for stratification</p>
</dd>
</dl>



<h3>Source</h3>

<p>Certara University
</p>

<hr>
<h2 id='obs_data'>Example observed data with continuous DV</h2><span id='topic+obs_data'></span>

<h3>Description</h3>

<p>An observed dataset from a hypothetical PK model, altered to include NTIME, GROUP, GENDER.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs_data
</code></pre>


<h3>Format</h3>

<p>A data.table with 600 rows and 7 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Subject identifier</p>
</dd>
<dt>TIME</dt><dd><p>Time</p>
</dd>
<dt>DV</dt><dd><p>Concentration of drug</p>
</dd>
<dt>AMT</dt><dd><p>Amount of dosage initially administered at DV = 0, TIME = 0</p>
</dd>
<dt>DOSE</dt><dd><p>Dosage amount</p>
</dd>
<dt>MDV</dt><dd><p>Dummy indicating missing dependent variable value</p>
</dd>
<dt>NTIME</dt><dd><p>Nominal Time</p>
</dd>
<dt>GENDER</dt><dd><p>Character variable indicating subject's gender (&quot;M&quot;, &quot;F&quot;)</p>
</dd>
<dt>STUDY</dt><dd><p>Character variable indicating study type (&quot;Study A&quot;, &quot;Study B&quot;)</p>
</dd>
</dl>



<h3>Source</h3>

<p><code><a href="vpc.html#topic+simple_data">simple_data</a></code>
</p>

<hr>
<h2 id='observed'>Specify observed dataset and variables for VPC</h2><span id='topic+observed'></span><span id='topic+observed.data.frame'></span>

<h3>Description</h3>

<p>The observed function is the first function in the vpc piping chain and is used for specifying observed data and variables for VPC. Note: Observed
data must not contain missing DV and may require filtering <code>MDV == 0</code> before generating VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observed(o, ...)

## S3 method for class 'data.frame'
observed(
  o,
  x,
  yobs,
  pred = NULL,
  blq = NULL,
  lloq = -Inf,
  alq = NULL,
  uloq = Inf,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observed_+3A_o">o</code></td>
<td>
<p>A <code>data.frame</code> of observation data.</p>
</td></tr>
<tr><td><code id="observed_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
<tr><td><code id="observed_+3A_x">x</code></td>
<td>
<p>Numeric x-variable, typically named TIME.</p>
</td></tr>
<tr><td><code id="observed_+3A_yobs">yobs</code></td>
<td>
<p>Numeric y-variable, typically named DV.</p>
</td></tr>
<tr><td><code id="observed_+3A_pred">pred</code></td>
<td>
<p>Population prediction variable, typically named PRED.</p>
</td></tr>
<tr><td><code id="observed_+3A_blq">blq</code></td>
<td>
<p>Logical variable indicating below limit of quantification.</p>
</td></tr>
<tr><td><code id="observed_+3A_lloq">lloq</code></td>
<td>
<p>Number or numeric variable in data indicating the lower limit of quantification.</p>
</td></tr>
<tr><td><code id="observed_+3A_alq">alq</code></td>
<td>
<p>Logical variable indicating above limit of quantification .</p>
</td></tr>
<tr><td><code id="observed_+3A_uloq">uloq</code></td>
<td>
<p>Number or numeric variable in data indicating the upper limit of quantification.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tidyvpcobj</code> containing both original data and observed data formatted with <code>x</code> and <code>y</code> variables as specified in function.
Resulting data is of class <code>data.frame</code> and <code>data.table</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
obs_data &lt;- obs_data[MDV == 0]
sim_data &lt;- sim_data[MDV == 0]

vpc &lt;- observed(obs_data, x=TIME, y=DV)

</code></pre>

<hr>
<h2 id='plot.tidyvpcobj'>Plot a <code>tidyvpcobj</code></h2><span id='topic+plot.tidyvpcobj'></span>

<h3>Description</h3>

<p>Use ggplot2 graphics to plot and customize the appearance of VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tidyvpcobj'
plot(
  x,
  facet = FALSE,
  show.points = TRUE,
  show.boundaries = TRUE,
  show.stats = !is.null(x$stats),
  show.binning = isFALSE(show.stats),
  xlab = NULL,
  ylab = NULL,
  color = c("red", "blue", "red"),
  linetype = c("dotted", "solid", "dashed"),
  point.alpha = 0.4,
  point.size = 1,
  point.shape = "circle-fill",
  point.stroke = 1,
  ribbon.alpha = 0.1,
  legend.position = "top",
  facet.scales = "free",
  custom.theme = NULL,
  censoring.type = c("none", "both", "blq", "alq"),
  censoring.output = c("grid", "list"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tidyvpcobj_+3A_x">x</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_facet">facet</code></td>
<td>
<p>Set to <code>TRUE</code> to facet plot by quantile (continuous VPC) or
category (categorical VPC).</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_show.points">show.points</code></td>
<td>
<p>Should the observed data points be plotted?</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_show.boundaries">show.boundaries</code></td>
<td>
<p>Should the bin boundary be displayed?</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_show.stats">show.stats</code></td>
<td>
<p>Should the VPC stats be displayed?</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_show.binning">show.binning</code></td>
<td>
<p>Should the binning be displayed by coloring the observed data points by bin?</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_xlab">xlab</code></td>
<td>
<p>A character label for the x-axis.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_ylab">ylab</code></td>
<td>
<p>A character label for the y-axis.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_color">color</code></td>
<td>
<p>A character vector of colors for the percentiles, from low to high.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_linetype">linetype</code></td>
<td>
<p>A character vector of line type for the percentiles, from low to high.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_point.alpha">point.alpha</code></td>
<td>
<p>Numeric value specifying transparency of points.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_point.size">point.size</code></td>
<td>
<p>Numeric value specifying size of point.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_point.shape">point.shape</code></td>
<td>
<p>Character one of <code>"circle", "circle-fill", "diamond", "diamond-fill",
"square", "square-fill", "triangle-fill" , "triangle")</code>. Defaults to <code>"circle-fill"</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_point.stroke">point.stroke</code></td>
<td>
<p>Numeric value specifying size of point stroke.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_ribbon.alpha">ribbon.alpha</code></td>
<td>
<p>Numeric value specifying transparency of ribbon.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_legend.position">legend.position</code></td>
<td>
<p>A character string specifying the position of the legend. Options are
<code>"top", "bottom", "left", "right"</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_facet.scales">facet.scales</code></td>
<td>
<p>A character string specifying the <code>scales</code> argument to use for faceting. Options
are <code>"free", "fixed"</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_custom.theme">custom.theme</code></td>
<td>
<p>A custom ggplot2 theme supplied either as a character string, function, or object of class <code>"theme"</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_censoring.type">censoring.type</code></td>
<td>
<p>A character string specifying additional blq/alq plots to include. Only applicable if
<code><a href="#topic+censoring">censoring</a></code> was performed.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_censoring.output">censoring.output</code></td>
<td>
<p>A character string specifying whether to return percentage of blq/alq plots as an
arranged <code>"grid"</code> or as elements in a <code>"list"</code>. Only applicable if <code>censoring.type != "none"</code>.</p>
</td></tr>
<tr><td><code id="plot.tidyvpcobj_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="egg.html#topic+ggarrange">ggarrange</a></code> e.g., <code>ncol</code> and <code>nrow</code>.
Only used if <code>censoring.type != "none"</code> and <code>censoring.output == "grid"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>See Also</h3>

<p><code>ggplot</code>
</p>

<hr>
<h2 id='predcorrect'>Prediction corrected Visual Predictive Check (pcVPC)</h2><span id='topic+predcorrect'></span><span id='topic+predcorrect.tidyvpcobj'></span>

<h3>Description</h3>

<p>Specify prediction variable for pcVPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predcorrect(o, ...)

## S3 method for class 'tidyvpcobj'
predcorrect(o, pred, data = o$data, ..., log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predcorrect_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="predcorrect_+3A_...">...</code></td>
<td>
<p>Other arguments to include.</p>
</td></tr>
<tr><td><code id="predcorrect_+3A_pred">pred</code></td>
<td>
<p>Prediction variable in observed data.</p>
</td></tr>
<tr><td><code id="predcorrect_+3A_data">data</code></td>
<td>
<p>Observed data supplied in <code>observed()</code> function.</p>
</td></tr>
<tr><td><code id="predcorrect_+3A_log">log</code></td>
<td>
<p>Logical indicating whether DV was modeled in logarithmic scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updates <code>tidyvpcobj</code> with required information to performing prediction correction, which includes the <code>predcor</code> logical indicating whether
prediction corrected VPC is to be performed, the <code>predcor.log</code> logical indicating whether the DV is on a log-scale, and the <code>pred</code> prediction
column from the original data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(magrittr)

obs_data &lt;- obs_data[MDV == 0]
sim_data &lt;- sim_data[MDV == 0]

 # Add PRED variable to observed data from first replicate of
 # simulated data

obs_data$PRED &lt;- sim_data[REP == 1, PRED]

  vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
       simulated(sim_data, y=DV) %&gt;%
       binning(bin = NTIME) %&gt;%
       predcorrect(pred=PRED) %&gt;%
       vpcstats()

 # For binless loess prediction corrected, use predcorrect() before
 # binless() and set loess.ypc = TRUE

  vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
       simulated(sim_data, y=DV) %&gt;%
       predcorrect(pred=PRED) %&gt;%
       binless(loess.ypc = TRUE) %&gt;%
       vpcstats()
       

</code></pre>

<hr>
<h2 id='print.tidyvpcobj'>Print a <code>tidyvpcobj</code></h2><span id='topic+print.tidyvpcobj'></span>

<h3>Description</h3>

<p>Print generic used to return information about VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tidyvpcobj'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tidyvpcobj_+3A_x">x</code></td>
<td>
<p>An <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="print.tidyvpcobj_+3A_...">...</code></td>
<td>
<p>Further arguments can be specified but are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns <code>x</code> invisibly.
</p>

<hr>
<h2 id='sim_cat_data'>Example simulated data with categorical DV</h2><span id='topic+sim_cat_data'></span>

<h3>Description</h3>

<p>A simulated dataset with the 3 levels of categorical DV across 100 replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_cat_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 401400 rows and 4 variables:
</p>

<dl>
<dt>PID_code</dt><dd><p>Subject identifier</p>
</dd>
<dt>IVAR</dt><dd><p>Time</p>
</dd>
<dt>DV</dt><dd><p>Categorical DV with 3 levels</p>
</dd>
<dt>Replicate</dt><dd><p>Replicate num for simulation</p>
</dd>
</dl>



<h3>Source</h3>

<p>Certara University
</p>

<hr>
<h2 id='sim_data'>Example simulated data with continuous DV</h2><span id='topic+sim_data'></span>

<h3>Description</h3>

<p>A simulated dataset from a hypothetical PK model with 100 replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_data
</code></pre>


<h3>Format</h3>

<p>A data.table with 60000 rows and 10 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Subject identifier</p>
</dd>
<dt>REP</dt><dd><p>Replicate num for simulation</p>
</dd>
<dt>TIME</dt><dd><p>Time</p>
</dd>
<dt>DV</dt><dd><p>Concentration of drug</p>
</dd>
<dt>IPRED</dt><dd><p>Individual prediction variable</p>
</dd>
<dt>PRED</dt><dd><p>Population prediction variable</p>
</dd>
<dt>AMT</dt><dd><p>Amount of dosage initially administered at DV = 0, TIME = 0</p>
</dd>
<dt>DOSE</dt><dd><p>Dosage amount</p>
</dd>
<dt>MDV</dt><dd><p>Dummy indicating missing dependent variable value</p>
</dd>
<dt>NTIME</dt><dd><p>Nominal Time</p>
</dd>
</dl>



<h3>Source</h3>

<p><code><a href="vpc.html#topic+simple_data">simple_data</a></code>
</p>

<hr>
<h2 id='simulated'>Specify simulated dataset and variables for VPC</h2><span id='topic+simulated'></span><span id='topic+simulated.tidyvpcobj'></span>

<h3>Description</h3>

<p>The simulated function is used for specifying simulated input data and variables for VPC. Note: Simulated data must not
contain missing DV and may require filtering <code>MDV == 0</code> before generating VPC. The ordering of observed and simulated
data must also be consistent, with replicates in simulated data stacked on top of each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated(o, ...)

## S3 method for class 'tidyvpcobj'
simulated(o, data, ysim, ..., xsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulated_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="simulated_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
<tr><td><code id="simulated_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> of simulated data.</p>
</td></tr>
<tr><td><code id="simulated_+3A_ysim">ysim</code></td>
<td>
<p>Numeric y-variable, typically named DV.</p>
</td></tr>
<tr><td><code id="simulated_+3A_xsim">xsim</code></td>
<td>
<p>Numeric x-variable, typically named TIME.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tidyvpcobj</code> containing simulated dataset <code>sim</code> formatted with columns <code>x</code>, <code>y</code>, and <code>repl</code>, which indicates the replicate number.
The column <code>x</code> is used from the <code>observed()</code> function. Resulting dataset is of class <code>data.frame</code> and <code>data.table</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(magrittr)

vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV)

</code></pre>

<hr>
<h2 id='stratify'>Stratification for Visual Predictive Check (VPC)</h2><span id='topic+stratify'></span><span id='topic+stratify.tidyvpcobj'></span>

<h3>Description</h3>

<p>Use to specify stratification variables for VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stratify(o, ...)

## S3 method for class 'tidyvpcobj'
stratify(o, formula, data = o$data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stratify_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="stratify_+3A_...">...</code></td>
<td>
<p>Other arguments to include.</p>
</td></tr>
<tr><td><code id="stratify_+3A_formula">formula</code></td>
<td>
<p>Formula for stratification.</p>
</td></tr>
<tr><td><code id="stratify_+3A_data">data</code></td>
<td>
<p>Observed data supplied in <code>observed()</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns updated <code>tidyvpcobj</code> with stratification formula, stratification column(s), and strat.split datasets, which
is <code>obs</code> split by unique levels of stratification variable(s). Resulting datasets are of class object <code>data.frame</code>
and <code>data.table</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+vpcstats">vpcstats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(magrittr)

vpc &lt;- observed(obs_data, x=TIME, y=DV) %&gt;%
    simulated(sim_data, y=DV) %&gt;%
    stratify(~ GENDER) %&gt;%
    binning(NTIME) %&gt;%
    vpcstats()

# Example with 2-way stratification by GENDER and STUDY.

vpc &lt;- vpc %&gt;%
    stratify(~ GENDER + STUDY) %&gt;%
    binning(bin = "centers", centers = c(1,3,5,7,10)) %&gt;%
    vpcstats()


</code></pre>

<hr>
<h2 id='vpcstats'>Compute VPC statistics</h2><span id='topic+vpcstats'></span><span id='topic+vpcstats.tidyvpcobj'></span>

<h3>Description</h3>

<p>Compute prediction interval statistics for VPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpcstats(o, ...)

## S3 method for class 'tidyvpcobj'
vpcstats(
  o,
  vpc.type = c("continuous", "categorical"),
  qpred = c(0.05, 0.5, 0.95),
  ...,
  conf.level = 0.95,
  quantile.type = 7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpcstats_+3A_o">o</code></td>
<td>
<p>A <code>tidyvpcobj</code>.</p>
</td></tr>
<tr><td><code id="vpcstats_+3A_...">...</code></td>
<td>
<p>Other arguments to include.</p>
</td></tr>
<tr><td><code id="vpcstats_+3A_vpc.type">vpc.type</code></td>
<td>
<p>Character specifying type of VPC (e.g., <code>"continuous"</code> (Default) or <code>"categorical"</code>).</p>
</td></tr>
<tr><td><code id="vpcstats_+3A_qpred">qpred</code></td>
<td>
<p>Numeric vector of length 3 specifying quantile prediction interval. Only applicable for <code>vpc.type = "continuous"</code>.</p>
</td></tr>
<tr><td><code id="vpcstats_+3A_conf.level">conf.level</code></td>
<td>
<p>Numeric specifying confidence level.</p>
</td></tr>
<tr><td><code id="vpcstats_+3A_quantile.type">quantile.type</code></td>
<td>
<p>Numeric indicating quantile type. See <code><a href="stats.html#topic+quantile">quantile</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updates <code>tidyvpcobj</code> with <code>stats</code> <code>data.table</code> object, which contains the following columns:
</p>

<ul>
<li> <p><code>bin</code>: Resulting bin value as specified in <code>binning()</code> function
</p>
</li>
<li> <p><code>xbin</code>: Midpoint x-value of the observed data points in the bin as specified in <code>xbin</code> argument of <code>binning()</code> function
</p>
</li>
<li> <p><code>qname</code>: Quantiles specified in <code>qpred</code>.  Only returned if <code>vpc.type = "continuous"</code>
</p>
</li>
<li> <p><code>pname</code>: Categorical probability names. Only returned if <code>vpc.type = "categorical"</code>
</p>
</li>
<li> <p><code>y</code>: Observed y value for the specified quantile
</p>
</li>
<li> <p><code>lo</code>: Lower bound of specified confidence interval for y value in simulated data
</p>
</li>
<li> <p><code>md</code>: Median y value in simulated data
</p>
</li>
<li> <p><code>hi</code>: Upper bound of specified confidence interval for y value in simulated data
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+observed">observed</a></code> <code><a href="#topic+simulated">simulated</a></code> <code><a href="#topic+censoring">censoring</a></code> <code><a href="#topic+stratify">stratify</a></code> <code><a href="#topic+binning">binning</a></code> <code><a href="#topic+binless">binless</a></code> <code><a href="#topic+predcorrect">predcorrect</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
