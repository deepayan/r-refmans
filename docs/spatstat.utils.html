<!DOCTYPE html><html><head><title>Help for package spatstat.utils</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spatstat.utils}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#articlebeforenumber'>
<p>Indefinite Article Preceding A Number</p></a></li>
<li><a href='#cat.factor'>
<p>Combine Several Factors</p></a></li>
<li><a href='#check.1.integer'>
<p>Check Argument Type and Length</p></a></li>
<li><a href='#check.anyvector'>
<p>Check For Vector or Factor With Correct Length</p></a></li>
<li><a href='#check.named.vector'>
<p>Check Whether Object Has Required Components</p></a></li>
<li><a href='#check.nmatrix'>
<p>Check for Numeric Matrix with Correct Dimensions</p></a></li>
<li><a href='#check.nvector'>
<p>Check For Numeric Vector With Correct Length</p></a></li>
<li><a href='#check.range'>
<p>Utilities for Ranges of Values</p></a></li>
<li><a href='#commasep'>
<p>List of Items Separated By Commas</p></a></li>
<li><a href='#do.call.matched'>
<p>Call a Function, Passing Only Recognised Arguments</p></a></li>
<li><a href='#do.call.without'>
<p>Call a Function, Omitting Certain Arguments</p></a></li>
<li><a href='#exactCutBreaks'>
<p>Determine Breakpoints for Cut</p></a></li>
<li><a href='#expand.polynom'>
<p>Expand Symbolic Polynomials in a Formula</p></a></li>
<li><a href='#fastFindInterval'>
<p>Find Intervals Containing Given Data</p></a></li>
<li><a href='#geomseq'>
<p>Geometric Sequence</p></a></li>
<li><a href='#harmonicmean'>
<p>Harmonic Mean</p></a></li>
<li><a href='#ifelseAB'>
<p>Conditional Selection</p></a></li>
<li><a href='#methods.xypolygon'>
<p>Calculations for Polygons in the Plane</p></a></li>
<li><a href='#optimizeWithTrace'>
<p>One Dimensional Optimization with Tracing</p></a></li>
<li><a href='#orderstats'>
<p>Compute Order Statistics</p></a></li>
<li><a href='#ordinal'>
<p>Ordinal Numbers</p></a></li>
<li><a href='#orifnull'><p>Specify a Default Value</p></a></li>
<li><a href='#paren'>
<p>Add or Remove Parentheses</p></a></li>
<li><a href='#percentage'>
<p>Convert Fraction to Percentage</p></a></li>
<li><a href='#primefactors'>
<p>Primes, Prime Factorization, Common Divisor</p></a></li>
<li><a href='#queueSpatstatLocator'>
<p>Add Coordinates to a Queue for Use by Locator Function</p></a></li>
<li><a href='#RelevantNA'>
<p>Missing Value, Zero-length Vector, or Zero Value of the Appropriate Type</p></a></li>
<li><a href='#resolve.defaults'>
<p>Determine Values of Variables Using Several Default Rules</p></a></li>
<li><a href='#revcumsum'>
<p>Reverse Cumulative Sum</p></a></li>
<li><a href='#simplenumber'>
<p>Simple Rational Number</p></a></li>
<li><a href='#spatstat.utils-internal'><p>Internal Functions of spatstat.utils Package</p></a></li>
<li><a href='#spatstat.utils-package'><p>The spatstat.utils Package</p></a></li>
<li><a href='#spatstatLocator'>
<p>Graphical Input</p></a></li>
<li><a href='#splat'>
<p>Print Text Within Margins</p></a></li>
<li><a href='#taperoff'>
<p>Taper Functions</p></a></li>
<li><a href='#tapplysum'>
<p>Sum By Factor Level</p></a></li>
<li><a href='#termsinformula'>
<p>Manipulate Formulae</p></a></li>
<li><a href='#verbalogic'>
<p>Verbal Logic</p></a></li>
<li><a href='#which.min.fair'>
<p>Where is the Minimum or Maximum</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.0-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>Title:</td>
<td>Utility Functions for 'spatstat'</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrian Baddeley &lt;Adrian.Baddeley@curtin.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), stats, graphics, grDevices, utils, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spatstat.model</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains utility functions for the 'spatstat' family of packages
             which may also be useful for other purposes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://spatstat.org/">http://spatstat.org/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/spatstat/spatstat.utils/issues">https://github.com/spatstat/spatstat.utils/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 01:01:23 UTC; adrian</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrian Baddeley <a href="https://orcid.org/0000-0001-9499-8382"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Rolf Turner <a href="https://orcid.org/0000-0001-5521-5218"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Ege Rubak <a href="https://orcid.org/0000-0002-6675-533X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 04:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='articlebeforenumber'>
Indefinite Article Preceding A Number
</h2><span id='topic+articlebeforenumber'></span>

<h3>Description</h3>

<p>Determines the indefinite article (<em>an</em> or <em>a</em>) which should
precede a given number, if the number is read out in English.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>articlebeforenumber(k, teenhundreds=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="articlebeforenumber_+3A_k">k</code></td>
<td>
<p>A single number.</p>
</td></tr>
<tr><td><code id="articlebeforenumber_+3A_teenhundreds">teenhundreds</code></td>
<td>

<p>Logical value specifying that (for example)
1800 should be read as &ldquo;eighteen hundred&rdquo;
instead of &ldquo;one thousand eight hundred&rdquo;.
See Details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies the rule that,
if the English language word or phrase for the number <code>k</code>
begins with a vowel, then it should be preceded by <em>an</em>,
and otherwise by <em>a</em>.
</p>
<p>If <code>teenhundreds=FALSE</code> (the default),
the numbers 1100 and 1800 will be read as
&lsquo;one thousand one hundred&rsquo; and &lsquo;one thousand eight hundred&rsquo;,
and the indefinite article will be <em>a</em>.
However if <code>teenhundreds=TRUE</code>, the numbers 1100 and 1800 
be read as &lsquo;eleven hundred&rsquo; and &lsquo;eighteen hundred&rsquo;
and the indefinite article will be <em>an</em>.
</p>


<h3>Value</h3>

<p>One of the character strings <code>"an"</code> or <code>"a"</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordinal">ordinal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  f &lt;- function(k) cat(paste(articlebeforenumber(k),
                       paste0(k, "-fold"),
                       "increase\n"))
  f(8)
  f(18)
  f(28)
</code></pre>

<hr>
<h2 id='cat.factor'>
Combine Several Factors
</h2><span id='topic+cat.factor'></span>

<h3>Description</h3>

<p>Combine (concatenate) several factor objects, to produce a factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cat.factor(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cat.factor_+3A_...">...</code></td>
<td>

<p>Any number of arguments. Each argument should be a factor,
or will be converted to a factor.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>...</code> are concatenated as they would be
using <code><a href="base.html#topic+c">c</a>()</code> or <code><a href="base.html#topic+cat">cat</a>()</code>,
except that factor levels are retained
and merged correctly. See the Examples.
</p>


<h3>Value</h3>

<p>A factor, whose length is the sum of the lengths of all
arguments. The levels of the resulting factor are the union of the
levels of the arguments.
</p>


<h3>Author(s)</h3>

<p>Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+c">c</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   f &lt;- factor(letters[1:3])
   g &lt;- factor(letters[3:5])
   f
   g
   cat(f,g)
   c(f,g)
   cat.factor(f, g)
</code></pre>

<hr>
<h2 id='check.1.integer'>
Check Argument Type and Length
</h2><span id='topic+check.1.integer'></span><span id='topic+check.1.real'></span><span id='topic+check.1.string'></span>

<h3>Description</h3>

<p>These utility functions check whether a given argument is a single value
of the required type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.1.real(x, context = "", fatal = TRUE, warn=TRUE)
check.1.integer(x, context = "", fatal = TRUE, warn=TRUE)
check.1.string(x, context = "", fatal = TRUE, warn=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.1.integer_+3A_x">x</code></td>
<td>

<p>The argument to be checked.
</p>
</td></tr>
<tr><td><code id="check.1.integer_+3A_context">context</code></td>
<td>

<p>Optional string describing the context in which the argument
is checked.
</p>
</td></tr>
<tr><td><code id="check.1.integer_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether a fatal error should occur when
<code>x</code> is not of the required type. 
</p>
</td></tr>
<tr><td><code id="check.1.integer_+3A_warn">warn</code></td>
<td>

<p>Logical value indicating whether to issue a warning message
if <code>x</code> is not of the required type. 
</p>
</td></tr>    
</table>


<h3>Details</h3>

<p>These functions check whether the argument <code>x</code> is a single
atomic value of type <code>numeric</code>, <code>integer</code> or
<code>character</code>.
</p>
<p>If <code>x</code> does have the required length and type, the result
of the function is the logical value <code>TRUE</code>.
</p>
<p>Otherwise, if <code>fatal=TRUE</code> (the default) an error occurs,
while if <code>fatal=FALSE</code> a warning is issued (if <code>warn=TRUE</code>)
and the function returns the value <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>A logical value (or an error may occur).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check.named.vector">check.named.vector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- pi
  check.1.real(x)
  check.1.integer(pi, fatal=FALSE, context="In your dreams,")
  check.1.string(x, fatal=FALSE)
  check.1.integer(x, fatal=FALSE, warn=FALSE)
</code></pre>

<hr>
<h2 id='check.anyvector'>
Check For Vector or Factor With Correct Length
</h2><span id='topic+check.anyvector'></span>

<h3>Description</h3>

<p>This is a programmer's utility function
to check whether the argument is a 
vector or factor of the correct length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     check.anyvector(v, npoints = NULL, fatal = TRUE, things = "data points",
                     naok = FALSE, warn = FALSE, vname, oneok = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.anyvector_+3A_v">v</code></td>
<td>

<p>The argument to be checked.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_npoints">npoints</code></td>
<td>

<p>The required length of <code>v</code>.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether to stop with an error message
if <code>v</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_things">things</code></td>
<td>

<p>Character string describing what the entries of <code>v</code> should
correspond to.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_naok">naok</code></td>
<td>

<p>Logical value indicating whether <code>NA</code> values are permitted.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_warn">warn</code></td>
<td>

<p>Logical value indicating whether to issue a warning
if <code>v</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_vname">vname</code></td>
<td>

<p>Character string giving the name of <code>v</code> to be used in messages.
</p>
</td></tr>
<tr><td><code id="check.anyvector_+3A_oneok">oneok</code></td>
<td>

<p>Logical value indicating whether <code>v</code> is permitted to have
length 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks whether <code>v</code> is a vector or factor with
length equal to <code>npoints</code> (or length equal to 1 if
<code>oneok=TRUE</code>), not containing any <code>NA</code> values (unless
<code>naok=TRUE</code>).
</p>
<p>If these requirements are all satisfied, the result is the logical
value <code>TRUE</code>.
</p>
<p>If not, then if <code>fatal=TRUE</code> (the default), an error occurs;
if <code>fatal=FALSE</code>, the result is the logical value <code>FALSE</code>
with an attribute describing the requirement that was not satisfied.
</p>


<h3>Value</h3>

<p>A logical value indicating whether all the requirements were
satisfied. If <code>FALSE</code>, then this value has an attribute
<code>"whinge"</code>, a character string describing the requirements that
were not satisfied.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check.nvector">check.nvector</a></code>,
<code><a href="#topic+check.nmatrix">check.nmatrix</a></code>,
<code><a href="#topic+check.1.real">check.1.real</a></code>, <code><a href="#topic+check.named.vector">check.named.vector</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   z &lt;- factor(letters[1:10])
   y &lt;- z[1]
   check.anyvector(z, 5, fatal=FALSE)
   check.anyvector(y, 5, oneok=TRUE)
   check.anyvector(42, 5, fatal=FALSE)
</code></pre>

<hr>
<h2 id='check.named.vector'>
Check Whether Object Has Required Components
</h2><span id='topic+check.named.vector'></span><span id='topic+check.named.list'></span><span id='topic+check.named.thing'></span>

<h3>Description</h3>

<p>These functions check whether the object <code>x</code> has
components with the required names, and does not have
any unexpected components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.named.vector(x, nam, context = "", namopt = character(0),
                   onError = c("fatal", "null"), xtitle=NULL)

check.named.list(x, nam, context = "", namopt = character(0),
                   onError = c("fatal", "null"), xtitle=NULL)

check.named.thing(x, nam, namopt = character(0),
                  xtitle = NULL, valid = TRUE, type = "object",
                  context = "", fatal = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.named.vector_+3A_x">x</code></td>
<td>

<p>The object to be checked.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_nam">nam</code></td>
<td>

<p>Vector of character strings giving the names of all the
components which must be present.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_namopt">namopt</code></td>
<td>

<p>Vector of character strings giving the names of components
which may optionally be present.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_context">context</code></td>
<td>

<p>Character string describing the context in which <code>x</code> is being
checked, for use in error messages.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_xtitle">xtitle</code></td>
<td>

<p>Optional character string to be used when referring to <code>x</code>
in error messages.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_valid">valid</code></td>
<td>

<p>Logical value indicating whether <code>x</code> belongs to the required
class of objects.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_type">type</code></td>
<td>

<p>Character string describing the required class of objects.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_onerror">onError</code></td>
<td>

<p>Character string indicating what to do if <code>x</code> fails the checks.
</p>
</td></tr>
<tr><td><code id="check.named.vector_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating what to do if <code>x</code> fails the checks.
If <code>fatal=TRUE</code> (the default), an error occurs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>check.named.thing</code> checks whether <code>x</code> has all the
required components, in the sense that <code>names(x)</code>
includes all the names in <code>nam</code>,
and that every entry in <code>names(x)</code> belongs to either <code>nam</code> or
<code>namopt</code>. If all these checks are true, the result is a
zero-length character vector. Otherwise, if <code>fatal=TRUE</code> (the
default), an error occurs; otherwise the result is a character
vector describing the checks which failed.
</p>
<p><code>check.named.vector</code> checks whether <code>x</code> is a numeric vector
and <code>check.named.list</code> checks whether <code>x</code> is a list.
They then call <code>check.named.thing</code> to check whether all the
required components are present. If all these checks are true, the result is
a reordered version of <code>x</code> in which all the compulsory entries
appear first. Otherwise, if <code>onError="fatal"</code> (the default)
an error occurs; otherwise the result is <code>NULL</code>.
</p>


<h3>Value</h3>

<p><code>check.named.vector</code> returns a numeric vector or <code>NULL</code>.
</p>
<p><code>check.named.list</code> returns a list or <code>NULL</code>.
</p>
<p><code>check.named.thing</code> returns a character vector.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check.1.integer">check.1.integer</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  z &lt;- list(a=1, b=2, e=42)
  check.named.list(z, c("a", "b"), namopt=c("c", "d", "e"))
  check.named.thing(z, c("a", "b"), namopt=c("c", "d", "e"))
  zz &lt;- unlist(z)
  check.named.vector(zz, c("a", "b"), namopt=c("c", "d", "e"))
  check.named.thing(z, c("b", "c"), namopt=c("d", "e"), fatal=FALSE)
</code></pre>

<hr>
<h2 id='check.nmatrix'>
Check for Numeric Matrix with Correct Dimensions
</h2><span id='topic+check.nmatrix'></span>

<h3>Description</h3>

<p>This is a programmer's utility function
to check whether the argument is a numeric
vector of the correct length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.nmatrix(m, npoints = NULL, fatal = TRUE, things = "data points",
              naok = FALSE, squarematrix = TRUE, matchto = "nrow",
              warn = FALSE, mname)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.nmatrix_+3A_m">m</code></td>
<td>

<p>The argument to be checked.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_npoints">npoints</code></td>
<td>

<p>The required number of rows and/or columns for the matrix <code>m</code>.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether to stop with an error message
if <code>m</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_things">things</code></td>
<td>

<p>Character string describing what the rows/columns of <code>m</code> should
correspond to.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_naok">naok</code></td>
<td>

<p>Logical value indicating whether <code>NA</code> values are permitted.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_squarematrix">squarematrix</code></td>
<td>

<p>Logical value indicating whether <code>m</code> must be a square matrix.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_matchto">matchto</code></td>
<td>

<p>Character string (either <code>"nrow"</code> or <code>"ncol"</code>)
indicating whether it is the rows or the columns
of <code>m</code> which must correspond to <code>npoints</code>. 
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_warn">warn</code></td>
<td>

<p>Logical value indicating whether to issue a warning
if <code>v</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.nmatrix_+3A_mname">mname</code></td>
<td>

<p>Optional character string giving the name of <code>m</code>
for use in error messages and warnings.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This programmer's utility function checks whether <code>m</code> is a numeric matrix
of the correct dimensions, and checks for <code>NA</code> values.
If <code>matchto="nrow"</code> (the default) then
the number of rows of <code>m</code> must be equal to <code>npoints</code>.
If <code>matchto="ncol"</code> then the number of columns of <code>m</code>
must be equal to <code>npoints</code>. If <code>squarematrix=TRUE</code> (the
default) then the numbers of rows and columns must be equal.
If <code>naok = FALSE</code> (the default) then the entries of <code>m</code>
must not include <code>NA</code>.
</p>
<p>If these requirements are all satisfied, the result is the logical
value <code>TRUE</code>.
</p>
<p>If not, then if <code>fatal=TRUE</code> (the default), an error occurs;
if <code>fatal=FALSE</code>, the result is the logical value <code>FALSE</code>
with an attribute describing the requirement that was not satisfied.
</p>


<h3>Value</h3>

<p>A logical value indicating whether all the requirements were
satisfied. 
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check.nvector">check.nvector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  z &lt;- matrix(1:16, 4, 4)
  check.nmatrix(z, 4)
</code></pre>

<hr>
<h2 id='check.nvector'>
Check For Numeric Vector With Correct Length
</h2><span id='topic+check.nvector'></span>

<h3>Description</h3>

<p>This is a programmer's utility function
to check whether the argument is a numeric
vector of the correct length.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     check.nvector(v, npoints = NULL, fatal = TRUE, things = "data points",
                   naok = FALSE, warn = FALSE, vname, oneok = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.nvector_+3A_v">v</code></td>
<td>

<p>The argument to be checked.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_npoints">npoints</code></td>
<td>

<p>The required length of <code>v</code>.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether to stop with an error message
if <code>v</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_things">things</code></td>
<td>

<p>Character string describing what the entries of <code>v</code> should
correspond to.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_naok">naok</code></td>
<td>

<p>Logical value indicating whether <code>NA</code> values are permitted.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_warn">warn</code></td>
<td>

<p>Logical value indicating whether to issue a warning
if <code>v</code> does not satisfy all requirements.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_vname">vname</code></td>
<td>

<p>Character string giving the name of <code>v</code> to be used in messages.
</p>
</td></tr>
<tr><td><code id="check.nvector_+3A_oneok">oneok</code></td>
<td>

<p>Logical value indicating whether <code>v</code> is permitted to have
length 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks whether <code>v</code> is a numeric vector with
length equal to <code>npoints</code> (or length equal to 1 if
<code>oneok=TRUE</code>), not containing any <code>NA</code> values (unless
<code>naok=TRUE</code>).
</p>
<p>If these requirements are all satisfied, the result is the logical
value <code>TRUE</code>.
</p>
<p>If not, then if <code>fatal=TRUE</code> (the default), an error occurs;
if <code>fatal=FALSE</code>, the result is the logical value <code>FALSE</code>
with an attribute describing the requirement that was not satisfied.
</p>


<h3>Value</h3>

<p>A logical value indicating whether all the requirements were
satisfied. If <code>FALSE</code>, then this value has an attribute
<code>"whinge"</code>, a character string describing the requirements that
were not satisfied.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check.anyvector">check.anyvector</a></code>,
<code><a href="#topic+check.nmatrix">check.nmatrix</a></code>,
<code><a href="#topic+check.1.real">check.1.real</a></code>, <code><a href="#topic+check.named.vector">check.named.vector</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   z &lt;- 1:10
   check.nvector(z, 5, fatal=FALSE)
   y &lt;- 42
   check.nvector(y, 5, fatal=FALSE, oneok=TRUE)
</code></pre>

<hr>
<h2 id='check.range'>
Utilities for Ranges of Values
</h2><span id='topic+check.range'></span><span id='topic+check.in.range'></span><span id='topic+inside.range'></span><span id='topic+intersect.ranges'></span><span id='topic+prange'></span>

<h3>Description</h3>

<p>These simple functions handle an interval or range of numerical
values. <code>check.range(r)</code> checks whether <code>r</code> specifies a
range of values, that is, whether <code>r</code> is a vector of length 2
with <code>r[1] &lt;= r[2]</code>. <code>intersect.ranges(r, s)</code> finds the intersection
of two ranges <code>r</code> and <code>s</code>. <code>inside.range(x, r)</code> returns
a logical vector containing <code>TRUE</code> if the corresponding entry of
<code>x</code> falls inside the range <code>r</code>, and <code>FALSE</code> if it does
not. <code>check.in.range(x, r)</code> checks whether a single number
<code>x</code> falls inside the specified range <code>r</code>.
Finally <code>prange(r)</code> produces a character string that represents
the range <code>r</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.range(r, fatal = TRUE)

check.in.range(x, r, fatal = TRUE)

inside.range(x, r)

intersect.ranges(r, s, fatal = TRUE)

prange(r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.range_+3A_r">r</code></td>
<td>

<p>A numeric vector of length 2 specifying the endpoints of a range of values.
</p>
</td></tr>
<tr><td><code id="check.range_+3A_x">x</code></td>
<td>

<p>Numeric vector of data.
</p>
</td></tr>
<tr><td><code id="check.range_+3A_s">s</code></td>
<td>

<p>A numeric vector of length 2 specifying the endpoints of a range of values.
</p>
</td></tr>
<tr><td><code id="check.range_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether to stop with an error message
if the data do not pass the check. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>check.range</code> checks whether <code>r</code> specifies a
range of values, that is, whether <code>r</code> is a vector of length 2
with <code>r[1] &lt;= r[2]</code>. If so, the result is <code>TRUE</code>. If not,
then if <code>fatal=TRUE</code>, an error occurs, while if
<code>fatal=FALSE</code> the result is <code>FALSE</code>.
</p>
<p><code>intersect.ranges(r, s)</code> finds the intersection
of two ranges <code>r</code> and <code>s</code>. If the intersection is non-empty,
the result is a numeric vector of length 2. If the intersection is empty,
then if <code>fatal=TRUE</code>, an error occurs, while if
<code>fatal=FALSE</code> the result is <code>NULL</code>.
</p>
<p><code>inside.range(x, r)</code> returns
a logical vector containing <code>TRUE</code> if the corresponding entry of
<code>x</code> falls inside the range <code>r</code>, and <code>FALSE</code> if it does
not.
</p>
<p><code>check.in.range(x, r)</code> checks whether a single number
<code>x</code> falls inside the specified range <code>r</code>.
If so, the result is <code>TRUE</code>. If not, then if <code>fatal=TRUE</code>,
an error occurs, while if
<code>fatal=FALSE</code> the result is <code>FALSE</code>.
</p>
<p>Finally <code>prange(r)</code> produces a character string that represents
the range <code>r</code>.
</p>


<h3>Value</h3>

<p>The result of <code>check.range</code>, <code>check.in.range</code>
and <code>inside.range</code>, is
a logical value or logical vector. The result of
<code>intersect.ranges</code> is a numerical vector of length 2, or <code>NULL</code>. 
The result of <code>prange</code> is a character string.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   rr &lt;- c(0, 2)
   ss &lt;- c(1, 3)
   x &lt;- seq(0.5, 3.5, by=1)
   check.range(rr)
   check.range(42, fatal=FALSE)
   inside.range(x, rr)
   intersect.ranges(rr, ss)
   prange(rr)   
</code></pre>

<hr>
<h2 id='commasep'>
List of Items Separated By Commas
</h2><span id='topic+commasep'></span>

<h3>Description</h3>

<p>Convert the elements of a vector into character strings
and paste them together, separated by commas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>commasep(x, join = " and ", flatten = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="commasep_+3A_x">x</code></td>
<td>

<p>Vector of items in the list.
</p>
</td></tr>
<tr><td><code id="commasep_+3A_join">join</code></td>
<td>

<p>The string to be used to separate the last two items in the list.
</p>
</td></tr>
<tr><td><code id="commasep_+3A_flatten">flatten</code></td>
<td>

<p>Logical value indicating whether to return a single character string
(<code>flatten=TRUE</code>, the default) or a list (<code>flatten=FALSE</code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string (if <code>flatten=TRUE</code>, the default)
or a list of character strings. 
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   commasep(letters[1:4])
   y &lt;- commasep(sQuote(letters[1:4]))
   cat(y, fill=TRUE) 
</code></pre>

<hr>
<h2 id='do.call.matched'>
Call a Function, Passing Only Recognised Arguments
</h2><span id='topic+do.call.matched'></span>

<h3>Description</h3>

<p>Call a specified function, using only those arguments which are
known to be acceptable to the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  do.call.matched(fun, arglist, funargs, extrargs = NULL,
                  matchfirst = FALSE, sieve = FALSE, skipargs = NULL,
                  envir=parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.call.matched_+3A_fun">fun</code></td>
<td>

<p>A function, or a character string giving the name of a function,
to be called.
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_arglist">arglist</code></td>
<td>

<p>A named list of arguments.
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_funargs">funargs</code></td>
<td>

<p>Character vector giving the names of arguments that are recognised
by <code>fun</code>. Defaults to the names of the formal arguments of
<code>fun</code>. 
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_extrargs">extrargs</code></td>
<td>

<p>Optional. Character vector giving the names of additional arguments
that can be handled by <code>fun</code>. 
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_skipargs">skipargs</code></td>
<td>

<p>Optional. Character vector giving the names of arguments which should
<b>not</b> be passed to <code>fun</code>.
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_matchfirst">matchfirst</code></td>
<td>

<p>Logical value indicating whether the first entry
of <code>arglist</code> is permitted to have an empty name
and should be matched to the first argument of <code>fun</code>.
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_sieve">sieve</code></td>
<td>

<p>Logical value indicating whether to return the
un-used arguments as well as the result of the function call.
See Details.
</p>
</td></tr>
<tr><td><code id="do.call.matched_+3A_envir">envir</code></td>
<td>

<p>An environment within which to evaluate the call,
if any entries of <code>arglist</code> are quoted expressions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper for <code><a href="base.html#topic+do.call">do.call</a></code>
which avoids passing arguments that are unrecognised by <code>fun</code>.
</p>
<p>In the simplest case <code>do.call.matched(fun, arglist)</code>
is like <code>do.call(fun, arglist)</code>, except that
entries of <code>arglist</code> which do not match any formal
argument of <code>fun</code> are removed.
Extra argument names can be permitted using <code>extrargs</code>,
and argument names can be forbidden using <code>skipargs</code>.
</p>


<h3>Value</h3>

<p>If <code>sieve=FALSE</code> (the default), the result is the
return value from <code>fun</code>.
</p>
<p>If <code>sieve=TRUE</code>, the result is a list with entries
<code>result</code> (the return value from <code>fun</code>) and
<code>otherargs</code> (a list of the arguments that were not passed
to <code>fun</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resolve.defaults">resolve.defaults</a></code>,
<code><a href="#topic+do.call.without">do.call.without</a></code>.
</p>
<p><code><a href="base.html#topic+do.call">do.call</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  f &lt;- function(x=0,y=0, ...) { paste(x, y, ..., sep=", ") }
  f()
  do.call.matched(f, list(y=2))
  do.call.matched(f, list(y=2, z=5), extrargs="z")
  do.call.matched(f, list(y=2, z=5), extrargs="z", skipargs="y")
</code></pre>

<hr>
<h2 id='do.call.without'>
Call a Function, Omitting Certain Arguments
</h2><span id='topic+do.call.without'></span>

<h3>Description</h3>

<p>Call a specified function, omitting some arguments which are
inappropriate to the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  do.call.without(fun, ..., avoid, envir=parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.call.without_+3A_fun">fun</code></td>
<td>

<p>The function to be called. A function name, a
character string giving the name of the function,
or an expression that yields a function.
</p>
</td></tr>
<tr><td><code id="do.call.without_+3A_...">...</code></td>
<td>

<p>Any number of arguments.
</p>
</td></tr>
<tr><td><code id="do.call.without_+3A_avoid">avoid</code></td>
<td>

<p>Vector of character strings, giving the names of arguments that should
<em>not</em> be passed to <code>fun</code>.
</p>
</td></tr>
<tr><td><code id="do.call.without_+3A_envir">envir</code></td>
<td>

<p>An environment within which to evaluate the call,
if any entries of <code>arglist</code> are quoted expressions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple mechanism for preventing some arguments from being 
passed in a function call. The arguments <code>...</code> are collected in
a list. A argument is omitted if its name exactly matches
one of the strings in <code>avoid</code>. 
</p>


<h3>Value</h3>

<p>The return value of <code>fun</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+do.call.matched">do.call.matched</a></code> for a more complicated and flexible call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  do.call.without(paste, 1, 2, z=3, w=4, avoid="z")
</code></pre>

<hr>
<h2 id='exactCutBreaks'>
Determine Breakpoints for Cut
</h2><span id='topic+exactCutBreaks'></span>

<h3>Description</h3>

<p>Computes the numerical breakpoints used by <code>cut.default</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exactCutBreaks(x, breaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exactCutBreaks_+3A_x">x</code></td>
<td>
<p>Numeric vector which would be converted to a factor.</p>
</td></tr>
<tr><td><code id="exactCutBreaks_+3A_breaks">breaks</code></td>
<td>

<p>Either a numeric vector of breakpoints,
or a single integer giving the number of intervals into which
<code>x</code> will be cut.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function contains a copy of the code in
<code><a href="base.html#topic+cut">cut.default</a></code> which determines the
numerical breakpoints used to convert <code>x</code> to a factor.
It returns the breakpoints only.
</p>
<p>The arguments <code>x</code> and <code>breaks</code> have the same interpretation
as in <code><a href="base.html#topic+cut">cut.default</a></code>. Only the range of <code>x</code>
is used in the computation, so <code>x</code> could be replaced by <code>range(x)</code>.
</p>
<p>This function would normally be used when <code>breaks</code> is a single
integer specifying the number of intervals for the cut operation.
It returns the exact numerical values of the breakpoints which are
determined, but not returned, by <code><a href="base.html#topic+cut">cut.default</a></code>).
</p>


<h3>Value</h3>

<p>Numeric vector.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cut">cut.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   exactCutBreaks(c(0,1), 4)
</code></pre>

<hr>
<h2 id='expand.polynom'>
Expand Symbolic Polynomials in a Formula
</h2><span id='topic+expand.polynom'></span><span id='topic+sympoly'></span>

<h3>Description</h3>

<p>Create a formula representing a polynomial,
or expand polynomials in an existing formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  expand.polynom(f)
  sympoly(x, y, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.polynom_+3A_f">f</code></td>
<td>

<p>A formula.
</p>
</td></tr>
<tr><td><code id="expand.polynom_+3A_x">x</code>, <code id="expand.polynom_+3A_y">y</code></td>
<td>

<p>Variable names.
</p>
</td></tr>
<tr><td><code id="expand.polynom_+3A_n">n</code></td>
<td>

<p>Integer specifying the degree of the polynomial.
(If <code>n</code> is missing, <code>y</code> will be interpreted as the degree.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions expand a polynomial into its homogeneous terms
and return a model formula.
</p>
<p><code>sympoly(x, n)</code> creates a formula whose right-hand side represents the
polynomial of degree <code>n</code> in the variable <code>x</code>. Each
homogeneous term <code>x^k</code> is a separate term in the formula.
</p>
<p><code>sympoly(x, y, n)</code> creates a formula representing the
polynomial of degree <code>n</code> in the two variables <code>x</code> and
<code>y</code>.
</p>
<p>If <code>f</code> is a formula containing a term of the form
<code>polynom(...)</code> then <code>expand.polynom(f)</code> replaces this term
by its expansion as a sum of homogeneous terms, as defined in
the help for <code><a href="spatstat.model.html#topic+polynom">polynom</a></code>.
</p>


<h3>Value</h3>

<p>A <code>formula</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.model.html#topic+polynom">polynom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   sympoly(A, 4)
   sympoly(A, B, 3)
   expand.polynom(U ~ A + polynom(B, 2))
</code></pre>

<hr>
<h2 id='fastFindInterval'>
Find Intervals Containing Given Data
</h2><span id='topic+fastFindInterval'></span>

<h3>Description</h3>

<p>A faster alternative to <code>findInterval</code>
for intervals which are equally-spaced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastFindInterval(x, b, labels = FALSE, reltol = 0.001, dig.lab = 3L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastFindInterval_+3A_x">x</code></td>
<td>

<p>Data. Numeric vector of values that are to be classified.
</p>
</td></tr>
<tr><td><code id="fastFindInterval_+3A_b">b</code></td>
<td>

<p>Breakpoints. Numeric vector of increasing values that are the
endpoints of the intervals.
</p>
</td></tr>
<tr><td><code id="fastFindInterval_+3A_labels">labels</code></td>
<td>

<p>Logical value specifying whether to return a factor,
whose levels are the string labels of the intervals.
</p>
</td></tr>
<tr><td><code id="fastFindInterval_+3A_reltol">reltol</code></td>
<td>

<p>Relative tolerance. A positive number.
</p>
</td></tr>
<tr><td><code id="fastFindInterval_+3A_dig.lab">dig.lab</code></td>
<td>

<p>Integer. Maximum number of digits to use in the labels
for the intervals, when <code>labels=TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an alternative to
<code><a href="base.html#topic+findInterval">findInterval</a>(x, b, rightmost.closed=TRUE)</code>
which seems to be faster when <code>b</code> is equally spaced
and the length of <code>x</code> is large.
</p>
<p>If <code>labels=FALSE</code> (the default), the result is an integer vector
giving, for each value <code>x[i]</code>, the index <code>j</code> of the interval that
contains <code>x[i]</code>, such that <code>b[j] &lt;= x[i] &lt; b[j + 1]</code>.
</p>
<p>If <code>labels=TRUE</code>, the result is a factor, and the levels are
synthetic labels for the intervals, similar to those produced by
<code><a href="base.html#topic+findInterval">findInterval</a></code>.
</p>


<h3>Value</h3>

<p>Integer vector, or factor.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+findInterval">findInterval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- runif(10)
  b &lt;- seq(0, 1, by=0.2)
  fastFindInterval(x, b, labels=TRUE)
</code></pre>

<hr>
<h2 id='geomseq'>
Geometric Sequence 
</h2><span id='topic+geomseq'></span>

<h3>Description</h3>

<p>Generate a geometric sequence between two endpoints.
The sequence is equally spaced on a logarithmic scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geomseq(from, to, length.out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geomseq_+3A_from">from</code></td>
<td>

<p>Starting value. A positive number.
</p>
</td></tr>
<tr><td><code id="geomseq_+3A_to">to</code></td>
<td>

<p>Ending value. A positive number.
</p>
</td></tr>
<tr><td><code id="geomseq_+3A_length.out">length.out</code></td>
<td>

<p>Number of elements in the sequence. A positive integer.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper for <code><a href="base.html#topic+seq.default">seq.default</a></code> which generates
a geometric sequence between the two endpoints. 
</p>


<h3>Value</h3>

<p>Numeric vector.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq.default">seq.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  geomseq(1, 32, length.out=6)
</code></pre>

<hr>
<h2 id='harmonicmean'>
Harmonic Mean
</h2><span id='topic+harmonicmean'></span><span id='topic+harmonicsum'></span>

<h3>Description</h3>

<p>Calculates the harmonic mean of a numeric vector,
robustly handling special cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harmonicmean(x, na.rm = TRUE)
harmonicsum(x, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="harmonicmean_+3A_x">x</code></td>
<td>

<p>Numeric vector.
</p>
</td></tr>
<tr><td><code id="harmonicmean_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical value specifying whether to remove <code>NA</code> values
before processing.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The harmonic mean of a set of numbers is the reciprocal
of the mean of the reciprocals of the numbers.
</p>
<p>The function <code>harmonicmean</code> calculates the harmonic mean
of <code>x</code>. The algorithm robustly handles special cases
where some of the values in <code>x</code> are very small or are
exactly equal to zero.
</p>
<p>The function <code>harmonicsum</code> calculates the reciprocal of the
<em>sum</em> of the reciprocals of the <code>x</code> values.
</p>


<h3>Value</h3>

<p>A single numeric value.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   harmonicmean(1:3)
</code></pre>

<hr>
<h2 id='ifelseAB'>
Conditional Selection
</h2><span id='topic+ifelse0NA'></span><span id='topic+ifelse1NA'></span><span id='topic+ifelseAB'></span><span id='topic+ifelseAX'></span><span id='topic+ifelseXB'></span><span id='topic+ifelseXY'></span><span id='topic+ifelseNegPos'></span>

<h3>Description</h3>

<p>These low-level functions provide faster alternatives to
some uses of <code>ifelse</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifelseAB(test, a, b)
ifelseAX(test, a, x)
ifelseXB(test, x, b)
ifelseXY(test, x, y)
ifelseNegPos(test, x)
ifelse0NA(test)
ifelse1NA(test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifelseAB_+3A_test">test</code></td>
<td>
<p>A logical vector.</p>
</td></tr>
<tr><td><code id="ifelseAB_+3A_a">a</code></td>
<td>
<p>A single atomic value.</p>
</td></tr>
<tr><td><code id="ifelseAB_+3A_b">b</code></td>
<td>
<p>A single atomic value.</p>
</td></tr>
<tr><td><code id="ifelseAB_+3A_x">x</code></td>
<td>
<p>A vector of values, of the same length as <code>test</code>.</p>
</td></tr>
<tr><td><code id="ifelseAB_+3A_y">y</code></td>
<td>
<p>A vector of values, of the same length as <code>test</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These low-level functions provide faster alternatives to
some uses of <code><a href="base.html#topic+ifelse">ifelse</a></code>. They were developed by
trial-and-error comparison of computation times of different expressions.
</p>
<p><code>ifelse0NA(test)</code> is equivalent to <code>ifelse(test, 0, NA)</code>.
</p>
<p><code>ifelse1NA(test)</code> is equivalent to <code>ifelse(test, 1, NA)</code>.
</p>
<p><code>ifelseAB(test, a, b)</code> is equivalent to <code>ifelse(test, a, b)</code>
where <code>a</code> and <code>b</code> must be single values.
</p>
<p><code>ifelseAX(test, a, x)</code> is equivalent to <code>ifelse(test, a, x)</code>
where <code>a</code> must be a single value, and <code>x</code> a vector of the
same length as <code>test</code>.
</p>
<p><code>ifelseXB(test, x, b)</code> is equivalent to <code>ifelse(test, x, b)</code>
where <code>b</code> must be a single value, and <code>x</code> a vector of the
same length as <code>test</code>.
</p>
<p><code>ifelseXY(test, x, y)</code> is equivalent to <code>ifelse(test, x, y)</code>
where <code>x</code> and <code>y</code> must be vectors of the
same length as <code>test</code>.
</p>
<p><code>ifelseNegPos(test, x)</code> is equivalent to <code>ifelse(test, x, -x)</code>
where <code>x</code> must be a vector of the same length as <code>test</code>.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>test</code> containing values of the
same type as <code>a,b,x,y</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+ifelse">ifelse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   x &lt;- runif(4e5)
   u &lt;- (x &lt; 0.5)
   system.time(ifelse(u, 2, x))
   system.time(ifelseAX(u, 2, x))
</code></pre>

<hr>
<h2 id='methods.xypolygon'>
Calculations for Polygons in the Plane
</h2><span id='topic+methods.xypolygon'></span><span id='topic+verify.xypolygon'></span><span id='topic+is.hole.xypolygon'></span><span id='topic+Area.xypolygon'></span><span id='topic+bdrylength.xypolygon'></span><span id='topic+reverse.xypolygon'></span><span id='topic+overlap.xypolygon'></span><span id='topic+simplify.xypolygon'></span><span id='topic+inside.xypolygon'></span>

<h3>Description</h3>

<p>Compute the area or boundary length of a polygon,
determine whether a point falls inside a polygon,
compute the area of overlap between two polygons,
and related tasks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify.xypolygon(p, fatal = TRUE)
is.hole.xypolygon(polly)
Area.xypolygon(polly)
bdrylength.xypolygon(polly)
reverse.xypolygon(p, adjust=FALSE)
overlap.xypolygon(P, Q)
simplify.xypolygon(p, dmin)
inside.xypolygon(pts, polly, test01, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="methods.xypolygon_+3A_p">p</code>, <code id="methods.xypolygon_+3A_polly">polly</code>, <code id="methods.xypolygon_+3A_p">P</code>, <code id="methods.xypolygon_+3A_q">Q</code></td>
<td>

<p>Data representing a polygon. See Details.
</p>
</td></tr>
<tr><td><code id="methods.xypolygon_+3A_dmin">dmin</code></td>
<td>

<p>Single numeric value giving the minimum permissible
length of an edge in the simplified polygon.
</p>
</td></tr>
<tr><td><code id="methods.xypolygon_+3A_fatal">fatal</code></td>
<td>

<p>Logical value indicating whether failure is a fatal error.
</p>
</td></tr>
<tr><td><code id="methods.xypolygon_+3A_pts">pts</code></td>
<td>

<p>Coordinates of points to be tested.
A named list with entries <code>x,y</code> which are numeric vectors
of coordinates.
</p>
</td></tr>
<tr><td><code id="methods.xypolygon_+3A_adjust">adjust</code></td>
<td>

<p>Logical value indicating whether internal data should be adjusted.
See Details.
</p>
</td></tr>
<tr><td><code id="methods.xypolygon_+3A_test01">test01</code>, <code id="methods.xypolygon_+3A_method">method</code></td>
<td>

<p>For developer use only.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the <span class="pkg">spatstat</span> family of packages, a polygon in the
Euclidean plane is represented as a named list 
with the following entries:
</p>

<dl>
<dt><code>x</code>,<code>y</code></dt><dd>
<p>Numeric vectors giving the coordinates of the vertices.
The vertices should be traversed in anti-clockwise order
(unless the polygon is a hole, when they should be traversed
in clockwise order) and the last vertex should <b>not</b> repeat
the first vertex.
</p>
</dd>
<dt>hole</dt><dd>
<p>Optional. A logical value indicating whether the
polygon is a hole. 
</p>
</dd>
<dt>area</dt><dd>
<p>Optional. Single numeric value giving the area of the polygon
(negative if it is a hole).
</p>
</dd>
</dl>

<p>The function <code>verify.xypolygon</code> checks whether its argument
satisfies this format. If so, it returns <code>TRUE</code>; if not,
it returns <code>FALSE</code> or (if <code>fatal=TRUE</code>) generates a fatal error.
</p>
<p>The other functions listed here perform basic calculations for
polygons using elementary Cartesian analytic geometry in <span class="rlang"><b>R</b></span>.
</p>
<p><code>is.hole.xypolygon</code> determines whether a polygon is a hole or not.
</p>
<p><code>Area.xypolygon</code> computes the area of the polygon using the
discrete Green's formula.
</p>
<p><code>bdrylength.xypolygon</code> calculates the total length of edges
of the polygon.
</p>
<p><code>reverse.xypolygon</code> reverses the order of the
coordinate vectors <code>x</code> and <code>y</code>. If <code>adjust=TRUE</code>,
the other entries <code>hole</code> and <code>area</code> will be adjusted as well.
</p>
<p><code>overlap.xypolygon</code> computes the area of overlap between two
polygons using the discrete Green's formula. It is slow compared
to the code in the <span class="pkg">polyclip</span> package.
</p>
<p><code>simplify.xypolygon</code> removes vertices of the polygon until
every edge is longer than <code>dmin</code>.
</p>
<p><code>inside.xypolygon(pts, polly)</code> determines whether each point
in <code>pts</code> lies inside the polygon <code>polly</code> and returns a
logical vector.
</p>


<h3>Value</h3>

<p><code>verify.xypolygon</code> and 
<code>is.hole.xypolygon</code> return a single logical value.
</p>
<p><code>inside.xypolygon</code> returns a logical vector.
</p>
<p><code>Area.xypolygon</code>, <code>bdrylength.xypolygon</code>
and <code>overlap.xypolygon</code>    
return a single numeric value.
</p>
<p><code>reverse.xypolygon</code> and <code>simplify.xypolygon</code>
return another polygon object.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  p &lt;- list(x=c(0,1,4,2), y=c(0,0,2,3))
  is.hole.xypolygon(p)
  Area.xypolygon(p)
  bdrylength.xypolygon(p)
  overlap.xypolygon(p, list(x=p$x+1, y=p$y+1))
  reverse.xypolygon(p)

  plot(c(0,5),c(0,3),type="n",xlab="x", ylab="y")
  polygon(p)
  polygon(simplify.xypolygon(p, 1.1), lty=3)

  plot(c(0,5),c(0,3),type="n",xlab="x", ylab="y")
  polygon(p)
  xx &lt;- runif(10, max=5)
  yy &lt;- runif(10, max=3)
  points(xx, yy)
  ok &lt;- as.logical(inside.xypolygon(list(x=xx, y=yy), p))
  points(xx[ok], yy[ok], pch=16)
</code></pre>

<hr>
<h2 id='optimizeWithTrace'>
One Dimensional Optimization with Tracing 
</h2><span id='topic+optimizeWithTrace'></span>

<h3>Description</h3>

<p>Find the minimum or maximum of a function over an interval
of real numbers, keeping track of the function arguments and
function values that were evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimizeWithTrace(f, interval, ...,
                  lower = min(interval), upper = max(interval))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimizeWithTrace_+3A_f">f</code></td>
<td>

<p>The function to be minimized or maximized.
</p>
</td></tr>
<tr><td><code id="optimizeWithTrace_+3A_interval">interval</code></td>
<td>

<p>Numeric vector of length 2 containing the end-points of the interval
to be searched.
</p>
</td></tr>
<tr><td><code id="optimizeWithTrace_+3A_lower">lower</code>, <code id="optimizeWithTrace_+3A_upper">upper</code></td>
<td>

<p>The lower and upper endpoints of the interval to be searched.
</p>
</td></tr>
<tr><td><code id="optimizeWithTrace_+3A_...">...</code></td>
<td>

<p>Other arguments passed to <code><a href="stats.html#topic+optimize">optimize</a></code>,
including arguments to the function <code>f</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple wrapper for the optimization routine
<code><a href="stats.html#topic+optimize">optimize</a></code>. The function <code>f</code> will be
optimized by computing its value at several locations in the interval,
as described in the help for <code><a href="stats.html#topic+optimize">optimize</a></code>.
This wrapper function stores the locations and
resulting function values, and returns them along with the
result of the optimization.
</p>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li> <p><code>minimum</code> (or <code>maximum</code>), the location in the
search interval which yielded the optimum value;
</p>
</li>
<li> <p><code>objective</code>, the value of the function at this
location;
</p>
</li>
<li> <p><code>x</code>, the sequence of locations in the interval that
were considered (in the order considered);
</p>
</li>
<li> <p><code>y</code>, the function values corresponding to <code>x</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optimize">optimize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  f &lt;- function (x, a) (x - a)^2
  result &lt;- optimizeWithTrace(f, c(0, 1), tol = 0.0001, a = 1/3)
  result
  curve(f(x, 1/3))
  with(result, points(x, y, pch=16))
</code></pre>

<hr>
<h2 id='orderstats'>
Compute Order Statistics
</h2><span id='topic+orderstats'></span><span id='topic+orderwhich'></span>

<h3>Description</h3>

<p>Compute the <code>k</code>-th smallest value in a dataset,
or find which entry in a dataset is the <code>k</code>-th smallest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orderstats(x, k, decreasing = FALSE)
orderwhich(x, k, decreasing = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orderstats_+3A_x">x</code></td>
<td>

<p>Data whose order statistics will be computed. A numeric vector.
</p>
</td></tr>
<tr><td><code id="orderstats_+3A_k">k</code></td>
<td>

<p>Rank. An integer, or vector of integers.
</p>
</td></tr>
<tr><td><code id="orderstats_+3A_decreasing">decreasing</code></td>
<td>

<p>Logical value specifing whether a rank of 1
is assigned to the highest value (<code>decreasing=TRUE</code>)
or the lowest value (<code>decreasing=FALSE</code>, the default).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are low-level functions for efficiently computing order statistics:
<code>orderstats(x, k)</code> returns the <code>k</code>-th smallest value in <code>x</code>,
and <code>orderwhich(x, k)</code> returns the <em>position</em> of the
<code>k</code>-th smallest value in <code>x</code>.
</p>
<p>Given a dataset of values <code class="reqn">x_1, \dots, x_n</code>,
the <em>order statistic</em> of rank <code class="reqn">k</code> is the <code class="reqn">k</code>-th smallest
value in the dataset. The order statistic of rank 1 is the smallest
value, and the order statistic of rank <code class="reqn">n</code> is the largest value.
The order statistic of rank <code class="reqn">k</code> is denoted <code class="reqn">x_{[k]}</code>.
</p>
<p>The full sequence of order statistics
</p>
<p style="text-align: center;"><code class="reqn">
    x_{[1]} \le x_{[2]} \le \dots \le x_{[n]}
  </code>
</p>

<p>can simply be obtained by sorting the original values
into increasing order.
</p>
<p>The command <code>orderstats(x, k)</code> is equivalent to
<code><a href="base.html#topic+sort">sort</a>(x)[k]</code>; it calculates the
<code>k</code>-th smallest value in <code>x</code>. 
</p>
<p>The command <code>orderwhich(x, k)</code> is equivalent to
<code><a href="base.html#topic+order">order</a>(x)[k]</code>. It identifies the <em>position</em> of the
<code>k</code>-th smallest value in <code>x</code>, that is, it returns the
index <code>j</code> such that <code>x[j]</code> is the <code>k</code>-th smallest value
in <code>x</code>.
</p>
<p>The functions <code>orderstats</code> and <code>orderwhich</code> are more
efficient than using <code>sort</code> and <code>order</code>
when it is only desired to calculate a few of the
order statistics (for example, only the smallest and second-smallest
values in the dataset).
</p>


<h3>Value</h3>

<p><code>orderstats</code> returns a vector of the same kind as <code>x</code>,
with the same length as <code>k</code>.
<code>orderwhich</code> returns an integer vector 
with the same length as <code>k</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sort">sort</a></code>, <code><a href="base.html#topic+order">order</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- runif(10)
  orderstats(x, 2)
  sort(x)[2]
  orderwhich(x, 2:3)
  order(x)[2:3]
</code></pre>

<hr>
<h2 id='ordinal'>
Ordinal Numbers
</h2><span id='topic+ordinal'></span><span id='topic+ordinalsuffix'></span>

<h3>Description</h3>

<p>Returns the appropriate abbreviation in English for an ordinal number
(for example <code>ordinal(5)</code> is <code>"5th"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordinal(k)
ordinalsuffix(k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordinal_+3A_k">k</code></td>
<td>
<p>An integer or vector of integers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ordinal(k)</code> returns a character string representing the
<code>k</code>th ordinal number. <code>ordinalsuffix(k)</code> determines the
appropriate suffix.
</p>
<p>The suffix can be either <code>"st"</code> (abbreviating
<em>first</em>), <code>"nd"</code> (abbreviating <em>second</em>),
<code>"rd"</code> (abbreviating <em>third</em>) or
<code>"th"</code> (for all other ordinal numbers <code>fourth</code>,
<code>fifth</code>, etc).
</p>


<h3>Value</h3>

<p>A character string or character vector of the same length as <code>k</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+articlebeforenumber">articlebeforenumber</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ordinal(1:7)
  cat(paste("Happy", ordinal(21), "Birthday"), fill=TRUE)
</code></pre>

<hr>
<h2 id='orifnull'>Specify a Default Value</h2><span id='topic++25orifnull+25'></span>

<h3>Description</h3>

<p>Specify a value together with a default to be used when the first value is null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>a %orifnull% b
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="orifnull_+3A_a">a</code></td>
<td>

<p>Any kind of object or expression to be evaluated.
</p>
</td></tr>
<tr><td><code id="orifnull_+3A_b">b</code></td>
<td>

<p>Default value to be used when <code>a</code> is <code>NULL</code>.
Any kind of object or expression to be evaluated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The operator <code>%orifnull%</code> is designed to improve the
readability of code.
</p>
<p><code>a %orifnull% b</code> is equivalent to <code>if(is.null(a)) a else b</code>.
</p>
<p>That is, <code>a %orifnull% b</code> is equal to 
<code>a</code> provided <code>a</code> is not null, and otherwise
the result is equal to <code>b</code>.  
</p>
<p>Expressions are evaluated only when necessary. 
If <code>a</code> is a language expression, it is first evaluated. Then if
<code>is.null(a)</code> is <code>FALSE</code>, the result is <code>a</code>. Otherwise,
<code>b</code> is evaluated, and the result is <code>b</code>.
Note that <code>b</code> is not evaluated unless <code>a</code> is <code>NULL</code>.
</p>
<p>The operator <code>%orifnull%</code> has higher precedence than the arithmetic
operators <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> but lower precedence than <code>^</code>.
</p>
<p>The operator is associative, and can be used repeatedly in an
expression, so that a default value may have its own default. 
See the Examples.
</p>


<h3>Value</h3>

<p>The result is <code>a</code> if <code>a</code> is not <code>NULL</code>,
and otherwise the result is <code>b</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   x &lt;- 7
   y &lt;- 42
   z &lt;- w &lt;- NULL
   x %orifnull% y
   z %orifnull% y
   z %orifnull% x %orifnull% y
   z %orifnull% w %orifnull% y
</code></pre>

<hr>
<h2 id='paren'>
Add or Remove Parentheses
</h2><span id='topic+paren'></span><span id='topic+unparen'></span>

<h3>Description</h3>

<p>Add or remove enclosing parentheses around a string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paren(x, type = "(")
unparen(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paren_+3A_x">x</code></td>
<td>

<p>A character string, or vector of character strings.
</p>
</td></tr>
<tr><td><code id="paren_+3A_type">type</code></td>
<td>

<p>Type of parentheses: either <code>"("</code>, <code>"["</code> or <code>"{"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>paren(x)</code> adds enclosing parentheses to the beginning and end of
the string <code>x</code>.
</p>
<p><code>unparen(x)</code> removes enclosing parentheses if they are present.
</p>


<h3>Value</h3>

<p>A character string, or vector of character strings of the same length
as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+commasep">commasep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  paren("Hello world")
  paren(42, "[")
  paren(letters[1:10])
  unparen(c("(yes)", "[no]", "{42}"))
</code></pre>

<hr>
<h2 id='percentage'>
Convert Fraction to Percentage
</h2><span id='topic+percentage'></span>

<h3>Description</h3>

<p>This is a programmer's utility which converts a fraction to
a percentage and encodes the percentage as a character string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>percentage(x, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="percentage_+3A_x">x</code></td>
<td>

<p>Either a single number, or a logical vector.
</p>
</td></tr>
<tr><td><code id="percentage_+3A_digits">digits</code></td>
<td>

<p>Number of digits accuracy.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is a single number, it should be a fraction between 0 and 1.
It will be converted to a percentage and then converted to a character
string followed by the percentage symbol.
</p>
<p>If <code>x</code> is a logical vector, the fraction of values which are
<code>TRUE</code> will be computed, and used to determine the percentage.
</p>


<h3>Value</h3>

<p>A character string.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>percentage(1/3)
percentage(runif(20) &gt; 0.2)
</code></pre>

<hr>
<h2 id='primefactors'>
Primes, Prime Factorization, Common Divisor
</h2><span id='topic+primefactors'></span><span id='topic+primesbelow'></span><span id='topic+divisors'></span><span id='topic+is.prime'></span><span id='topic+relatively.prime'></span><span id='topic+greatest.common.divisor'></span><span id='topic+least.common.multiple'></span>

<h3>Description</h3>

<p>These functions find prime numbers, 
factorise a composite number into its prime factors,
determine whether a number is prime, and find the least common multiple
or greatest common divisor of two numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>primefactors(n, method=c("C", "interpreted"))
divisors(n)
is.prime(n)
relatively.prime(n, m)
least.common.multiple(n,m)
greatest.common.divisor(n,m)
primesbelow(nmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="primefactors_+3A_n">n</code>, <code id="primefactors_+3A_m">m</code></td>
<td>

<p>Integers to be factorized.
</p>
</td></tr>
<tr><td><code id="primefactors_+3A_nmax">nmax</code></td>
<td>

<p>Integer. Upper limit on prime numbers to be found.
</p>
</td></tr>
<tr><td><code id="primefactors_+3A_method">method</code></td>
<td>

<p>Character string indicating the choice of algorithm.
(Developer use only.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>is.prime(n)</code> returns <code>TRUE</code> if <code>n</code> is a prime number,
and <code>FALSE</code> otherwise.
</p>
<p><code>primefactors(n)</code> factorises the integer <code>n</code>
into its prime number factors, and returns an integer vector
containing these factors. Some factors may be repeated.
</p>
<p><code>divisors(n)</code> finds all the integers which divide
the integer <code>n</code>, and returns them as a sorted vector of integers
(beginning with <code>1</code> and ending with <code>n</code>).
</p>
<p><code>relatively.prime(n, m)</code> returns <code>TRUE</code> if the integers
<code>n</code> and <code>m</code> are relatively prime, that is, if they have no
common factors.
</p>
<p><code>least.common.multiple</code> and <code>greatest.common.divisor</code>
return the least common multiple or greatest common divisor of two
integers <code>n</code> and <code>m</code>.
</p>
<p><code>primesbelow(nmax)</code> returns an integer vector containing all the
prime numbers less than or equal to <code>nmax</code>.
</p>


<h3>Value</h3>

<p><code>is.prime</code> and <code>relatively.prime</code> return a logical value.
</p>
<p><code>least.common.multiple</code> and <code>greatest.common.divisor</code>
return a single integer.
</p>
<p><code>primefactors</code> and <code>primesbelow</code>
return an integer vector.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  is.prime(17)

  relatively.prime(2, 3)
  
  primefactors(24) ## Note repeated factors

  divisors(24)

  greatest.common.divisor(60, 100) 

  least.common.multiple(10, 15) 

  primesbelow(20)
</code></pre>

<hr>
<h2 id='queueSpatstatLocator'>
Add Coordinates to a Queue for Use by Locator Function
</h2><span id='topic+queueSpatstatLocator'></span>

<h3>Description</h3>

<p>Add the coordinates of a spatial location to a queue.
The queue can be accessed by the <code>spatstatLocator</code> function
in a non-interactive session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>queueSpatstatLocator(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="queueSpatstatLocator_+3A_x">x</code>, <code id="queueSpatstatLocator_+3A_y">y</code></td>
<td>

<p>Numeric values, or vectors of the same length,
containing spatial coordinates. Any data acceptable to
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+spatstatLocator">spatstatLocator</a></code> function is a replacement
for the <code><a href="graphics.html#topic+locator">locator</a></code> function
that can be used to test software which depends on user input.
</p>
<p>When <code>queueSpatstatLocator(x,y)</code> is called, the coordinate
data <code>x,y</code> are saved in a queue. The first-listed coordinate
pair <code>x[1], y[1]</code> is at the front of the queue. Subsequently, when
<code><a href="#topic+spatstatLocator">spatstatLocator</a></code> is called, the coordinates are
taken from the front of the queue and returned as if they had been
clicked by the user.
</p>
<p>This only works in a <b>non-</b>interactive
session, that is, when <code><a href="base.html#topic+interactive">interactive</a>()</code> returns <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>Integer (invisible).
The length of the queue, after inclusion of the new points.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spatstatLocator">spatstatLocator</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>queueSpatstatLocator(0.5, 0.7)
queueSpatstatLocator(c(0.3, 0.4), c(0.2, 0.9))
if(!interactive()) {
   spatstatLocator(2)   
   spatstatLocator(1)
}
</code></pre>

<hr>
<h2 id='RelevantNA'>
Missing Value, Zero-length Vector, or Zero Value of the Appropriate Type
</h2><span id='topic+RelevantNA'></span><span id='topic+RelevantEmpty'></span><span id='topic+RelevantZero'></span><span id='topic+isRelevantZero'></span>

<h3>Description</h3>

<p>Given any data <code>x</code>, these functions return 
the missing value <code>NA</code>, the empty vector, or the
equivalent of the number <code>0</code>,
with the same type as <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelevantZero(x)
RelevantNA(x)
RelevantEmpty(x)

isRelevantZero(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RelevantNA_+3A_x">x</code></td>
<td>

<p>Data of any type.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the <span class="rlang"><b>R</b></span> system, missing values may have different types.
For example, if an entry is missing from a numeric vector, it is a
missing numeric value, not a missing logical value, and <span class="rlang"><b>R</b></span>
distinguishes between these two types of missing values.
</p>
<p>The function <code>RelevantNA</code> returns a missing value of the same
type as the input <code>x</code> (as defined by <code><a href="base.html#topic+typeof">typeof</a></code>).
Thus, <code>RelevantNA(3.2)</code> returns a missing numeric value
and <code>RelevantNA(TRUE)</code> returns a missing logical value.
</p>
<p><code>RelevantEmpty(x)</code> returns a vector of length zero which has the
same type as <code>x</code>. Thus, <code>RelevantEmpty(TRUE)</code> is equivalent
to <code>logical(0)</code>.
</p>
<p><code>RelevantZero(x)</code> returns a single value, of the same type as
<code>x</code>, that is equivalent to the number zero. For example,
<code>RelevantZero(TRUE)</code> returns <code>FALSE</code>.
</p>
<p>The function <code>isRelevantZero</code> tests whether <code>x</code> is a single
zero value, by testing whether <code>x</code> is identical to
<code>RelevantZero(x)</code>. 
</p>


<h3>Value</h3>

<p><code>RelevantZero</code> and <code>RelevantNA</code> return a single value
of the same type as <code>x</code>.
</p>
<p><code>RelevantEmpty</code> returns a zero-length vector of the same type
as <code>x</code>.
</p>
<p><code>isRelevantZero</code> returns a single logical value.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+typeof">typeof</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   RelevantZero(42)
   RelevantZero(TRUE)
   RelevantZero("hello world")

   RelevantNA(1:3)
   typeof(RelevantNA(1:3))
   typeof(RelevantNA("hello world"))
</code></pre>

<hr>
<h2 id='resolve.defaults'>
Determine Values of Variables Using Several Default Rules
</h2><span id='topic+resolve.defaults'></span><span id='topic+resolve.1.default'></span>

<h3>Description</h3>

<p>Determine the values of variables by applying
several different default rules in a given order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   resolve.defaults(..., .MatchNull = TRUE, .StripNull = FALSE)

   resolve.1.default(.A, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resolve.defaults_+3A_...">...</code></td>
<td>

<p>Several lists of <code>name=value</code> pairs.
</p>
</td></tr>
<tr><td><code id="resolve.defaults_+3A_.matchnull">.MatchNull</code></td>
<td>

<p>Logical value. If <code>TRUE</code> (the default), an entry of the form
<code>name=NULL</code> will be treated as assigning the value
<code>NULL</code> to the variable <code>name</code>. If <code>FALSE</code>,
such entries will be ignored.
</p>
</td></tr>
<tr><td><code id="resolve.defaults_+3A_.stripnull">.StripNull</code></td>
<td>

<p>Logical value indicating whether 
entries of the form <code>name=NULL</code> should be removed
from the result.
</p>
</td></tr>
<tr><td><code id="resolve.defaults_+3A_.a">.A</code></td>
<td>

<p>Either a character string giving the name of the variable
to be extracted, or a list consisting of one <code>name=value</code> pair
giving the variable name and its fallback default value.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions determine the values of variables by applying a series
of default rules, in the order specified.
</p>
<p>Each of the arguments <code>...</code> should be a list of
<code>name=value</code> pairs giving a value
for a variable <code>name</code>. Each list could represent a
set of arguments given by the user, or a 
rule assigning default values to some variables.
Lists that appear earlier in the sequence of arguments <code>...</code>
take precedence.
</p>
<p>The arguments <code>...</code> will be concatenated into a single list.
The earliest occurrence of each <code>name</code> is then used to
determine the final value of the variable <code>name</code>.
</p>
<p>The function <code>resolve.defaults</code> returns a list of
<code>name=value</code> pairs for all variables encountered.
It is commonly used to decide the values of
arguments to be passed to another function
using <code><a href="base.html#topic+do.call">do.call</a></code>.
</p>
<p>The function <code>resolve.1.default</code> returns the value
of the specified variable as determined by <code>resolve.defaults</code>.
It is commonly used inside a function to determine the value
of an argument.
</p>


<h3>Value</h3>

<p>The result of <code>resolve.defaults</code> is
a list of <code>name=value</code> pairs.
</p>
<p>The result of <code>resolve.1.default</code> can be any kind of value.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+do.call">do.call</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  user &lt;- list(day="Friday")
  ruleA &lt;- list(month="Jan", gravity=NULL)
  ruleB &lt;- list(day="Tuesday", month="May", gravity=42)
  resolve.defaults(user, ruleA, ruleB)
  resolve.defaults(user, ruleA, ruleB, .StripNull=TRUE)
  resolve.defaults(user, ruleA, ruleB, .MatchNull=FALSE)

  resolve.1.default("month", user, ruleA, ruleB)
</code></pre>

<hr>
<h2 id='revcumsum'>
Reverse Cumulative Sum
</h2><span id='topic+revcumsum'></span>

<h3>Description</h3>

<p>Returns a vector of cumulative sums of the input values,
running in reverse order. That is, the <code>i</code>th entry in the output
is the sum of entries <code>i</code> to <code>n</code> in the input,
where <code>n</code> is the length of the input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revcumsum(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revcumsum_+3A_x">x</code></td>
<td>

<p>A numeric or complex vector. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This low-level utility function is a faster alternative to
<code><a href="base.html#topic+rev">rev</a>(<a href="base.html#topic+cumsum">cumsum</a>(<a href="base.html#topic+rev">rev</a>(x)))</code>
under certain conditions.
It computes the reverse cumulative sum of the entries of <code>x</code>.
If <code>y &lt;- revcumsum(x)</code>, then <code>y[i] = sum(x[i:n])</code> where
<code>n = length(x)</code>.
</p>
<p>This function should not be used if <code>x</code> could contain <code>NA</code>
values: this would lead to an error.
</p>


<h3>Value</h3>

<p>A vector of the same length and type as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cumsum">cumsum</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  revcumsum(1:5)
  rev(cumsum(rev(1:5)))
  x &lt;- runif(1e6)
  system.time(rev(cumsum(rev(x))))
  system.time(revcumsum(x))
</code></pre>

<hr>
<h2 id='simplenumber'>
Simple Rational Number
</h2><span id='topic+simplenumber'></span>

<h3>Description</h3>

<p>Given a numeric value, try to express it
as a simple rational number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplenumber(x, unit = "", multiply = "*", tol = .Machine$double.eps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplenumber_+3A_x">x</code></td>
<td>

<p>A single numeric value.
</p>
</td></tr>
<tr><td><code id="simplenumber_+3A_unit">unit</code></td>
<td>

<p>Optional. Character string giving the name of the unit 
in which <code>x</code> is expressed. Typically an irrational number
such as <code>pi</code>. See Examples.
</p>
</td></tr>
<tr><td><code id="simplenumber_+3A_multiply">multiply</code></td>
<td>

<p>Optional. Character string representing multiplication.
</p>
</td></tr>
<tr><td><code id="simplenumber_+3A_tol">tol</code></td>
<td>

<p>Numerical tolerance.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The code tries to express <code>x</code> as an integer <code>x=n</code>, or as
the reciprocal of an integer <code>x=1/n</code>, or
as a simple rational number <code>x = m/n</code>, where <code>m,n</code> are
small integers.
</p>


<h3>Value</h3>

<p>A character string representing the simple number,
or <code>NULL</code> if not successful.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  simplenumber(0.3)
  simplenumber(0.333333333333333333333333)
  x &lt;- pi * 2/3
  simplenumber(x/pi, "pi")
</code></pre>

<hr>
<h2 id='spatstat.utils-internal'>Internal Functions of spatstat.utils Package</h2><span id='topic+adjustthinrange'></span><span id='topic+apply23sum'></span><span id='topic+as2vector'></span><span id='topic+asNumericMatrix'></span><span id='topic+assignDFcolumn'></span><span id='topic+badprobability'></span><span id='topic+blockdiagarray'></span><span id='topic+blockdiagmatrix'></span><span id='topic+check.finite'></span><span id='topic+check.satisfies'></span><span id='topic+choptext'></span><span id='topic+choptextline'></span><span id='topic+complaining'></span><span id='topic+distpl'></span><span id='topic+distppl'></span><span id='topic+distppll'></span><span id='topic+distppllmin'></span><span id='topic+dont.complain.about'></span><span id='topic+dotexpr.to.call'></span><span id='topic+dropifsingle'></span><span id='topic+dround'></span><span id='topic+ensure2vector'></span><span id='topic+ensure3Darray'></span><span id='topic+equispaced'></span><span id='topic+eratosthenes'></span><span id='topic+evenly.spaced'></span><span id='topic+exceedsMaxArraySize'></span><span id='topic+exhibitStringList'></span><span id='topic+explain.ifnot'></span><span id='topic+fakecallstring'></span><span id='topic+fave.order'></span><span id='topic+fillseq'></span><span id='topic+findfirstfactor'></span><span id='topic+firstfactor'></span><span id='topic+flat.deparse'></span><span id='topic+fontify'></span><span id='topic+forbidNA'></span><span id='topic+getSpatstatLocatorQueue'></span><span id='topic+getdataobjects'></span><span id='topic+good.names'></span><span id='topic+graphicsPars'></span><span id='topic+gsubdot'></span><span id='topic+indexCartesian'></span><span id='topic+inject.expr'></span><span id='topic+insertinlist'></span><span id='topic+is.blank'></span><span id='topic+is.parseable'></span><span id='topic+lty2char'></span><span id='topic+makeCutLabels'></span><span id='topic+make.parseable'></span><span id='topic+mapstrings'></span><span id='topic+matchNameOrPosition'></span><span id='topic+matcolall'></span><span id='topic+matcolany'></span><span id='topic+matcolsum'></span><span id='topic+matrixsample'></span><span id='topic+matrowall'></span><span id='topic+matrowany'></span><span id='topic+matrowsum'></span><span id='topic+natozero'></span><span id='topic+niceround'></span><span id='topic+NNdist2segments'></span><span id='topic+numalign'></span><span id='topic+nzpaste'></span><span id='topic+padtowidth'></span><span id='topic+passthrough'></span><span id='topic+paste.expr'></span><span id='topic+pasteFormula'></span><span id='topic+pasteN'></span><span id='topic+prettydiscrete'></span><span id='topic+prettyinside'></span><span id='topic+prolongseq'></span><span id='topic+putSpatstatLocatorQueue'></span><span id='topic+ratiotweak'></span><span id='topic+samefunction'></span><span id='topic+sensiblevarname'></span><span id='topic+short.deparse'></span><span id='topic+singlestring'></span><span id='topic+sortunique'></span><span id='topic+startinrange'></span><span id='topic+strsplitretain'></span><span id='topic+substringcount'></span><span id='topic+there.is.no.try'></span><span id='topic+trap.extra.arguments'></span><span id='topic+truncline'></span><span id='topic+uptrimat'></span><span id='topic+validposint'></span><span id='topic+variablesintext'></span><span id='topic+warn.ignored.args'></span><span id='topic+inside.triangle'></span><span id='topic+overlap.trapezium'></span><span id='topic+xysegXcircle'></span><span id='topic+xysegMcircle'></span><span id='topic+xysegPcircle'></span><span id='topic+matchIntegerDataFrames'></span><span id='topic+grokIndexVector'></span><span id='topic+strictIndexSequence'></span><span id='topic+fullIndexSequence'></span><span id='topic+replacementIndex'></span><span id='topic+positiveIndex'></span><span id='topic+logicalIndex'></span>

<h3>Description</h3>

<p>Internal utility functions of the <code>spatstat.utils</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjustthinrange(ur,vstep,vr)
apply23sum(x)
as2vector(x)
asNumericMatrix(x)
assignDFcolumn(x, name, value, ...)
badprobability(x, NAvalue)
blockdiagarray(...)
blockdiagmatrix(...)
check.finite(x, context, xname, fatal, usergiven, warn)
check.satisfies(cond, xname, should, context, fatal, warn)
choptext(..., prefix, indent)
choptextline(st, w, prefix, indent)
complaining(whinge, fatal, value)
distpl(p, l)               
distppl(p, l)
distppll(p, l, mintype, method, listit)
distppllmin(p, l, big)
dont.complain.about(...)
dotexpr.to.call(expr, dot, evaluator)
dropifsingle(x)
dround(x)
ensure2vector(x)
ensure3Darray(x)
equispaced(z, reltol)
eratosthenes(nmax, startset)
evenly.spaced(x, tol)
exhibitStringList(prefix, strings)
exceedsMaxArraySize(...)
explain.ifnot(expr, context)
fakecallstring(fname, parlist)
fave.order(x)
fillseq(x, step)
findfirstfactor(x)
firstfactor(x)
flat.deparse(x)
fontify(x, font)
forbidNA(x, context, xname, fatal, usergiven, warn)
getSpatstatLocatorQueue()
getdataobjects(nama, envir, datalist, fatal)
good.names(nama, defaults, suffices)
graphicsPars(key)
gsubdot(replacement, x)
indexCartesian(nn)
inject.expr(base, expr)
insertinlist(x, i, y)
is.blank(s)
is.parseable(x)
lty2char(i)
makeCutLabels(breaks, dig.lab, right, include.lowest)
make.parseable(x)
mapstrings(x, map)
matchNameOrPosition(expected, avail)
matcolall(x)
matcolany(x)
matcolsum(x)            
matrixsample(mat, newdim, phase, scale, na.value)
matrowall(x)
matrowany(x)
matrowsum(x)
natozero(x)
niceround(x, m)
NNdist2segments(xp, yp, x0, y0, x1, y1, bigvalue, wantindex)
numalign(i, nmax, zero)
nzpaste(..., sep, collapse)
padtowidth(a, b, justify)
passthrough(.Fun, ..., .Fname)
paste.expr(x)
pasteFormula(f)
pasteN(...)
prettydiscrete(x, n)
prettyinside(x, ...)
prolongseq(x, newrange, step)
putSpatstatLocatorQueue(x)
ratiotweak(a, b, overzero, zerozero)
samefunction(f, g)
sensiblevarname(guess, fallback, maxlen)
short.deparse(x, maxlen)
singlestring(s, coll)
sortunique(x)
startinrange(x0, dx, r)
strsplitretain(x, split)
substringcount(x,y)
there.is.no.try(...)
trap.extra.arguments(..., .Context, .Fatal)
truncline(x, nc)
uptrimat(x)
validposint(n, caller, fatal)
variablesintext(x)
warn.ignored.args(..., context)

inside.triangle(x, y, xx, yy)
overlap.trapezium(xa, ya, xb, yb, verb = FALSE)

xysegXcircle(xcentres, ycentres, radii, x0, y0, x1, y1, check)
xysegMcircle(xcentres, ycentres, radmat, x0, y0, x1, y1, check)
xysegPcircle(xc, yc, rc, x0, y0, x1, y1, check)

matchIntegerDataFrames(X,Y,sort)

grokIndexVector(ind, len, nama)
strictIndexSequence(g)
fullIndexSequence(g)
replacementIndex(ii, stuff)
positiveIndex(i, nama, len)
logicalIndex(i, nama, len)
</code></pre>


<h3>Details</h3>

<p>These internal <span class="pkg">spatstat.utils</span> functions are not usually called
directly by the user. Their names and capabilities may change
without warning from one version of <span class="pkg">spatstat.utils</span> to the next.
</p>

<hr>
<h2 id='spatstat.utils-package'>The spatstat.utils Package</h2><span id='topic+spatstat.utils-package'></span><span id='topic+spatstat.utils'></span>

<h3>Description</h3>

<p>The <span class="pkg">spatstat.utils</span> package contains low-level utilities,
written for the <span class="pkg">spatstat</span> package, which may be useful in
other packages as well.
</p>


<h3>Details</h3>

<p>The functions in <span class="pkg">spatstat.utils</span> were originally written
as internal, undocumented, utility functions in the <span class="pkg">spatstat</span> package.
</p>
<p>Many of these functions could be useful to other programmers,
so we have made them available in a separate package
<span class="pkg">spatstat.utils</span> and provided documentation.
</p>
<p>The functionality contained in <span class="pkg">spatstat.utils</span> includes:
</p>

<dl>
<dt>Factorisation of integers</dt><dd>
<p>Find prime numbers (<code><a href="#topic+primesbelow">primesbelow</a></code>),
factorise a composite number into its prime factors
(<code><a href="#topic+primefactors">primefactors</a></code>),
determine whether a number is prime (<code><a href="#topic+is.prime">is.prime</a></code>)
or whether two numbers are relatively prime 
(<code><a href="#topic+relatively.prime">relatively.prime</a></code>),
and find the least common multiple
or greatest common divisor of two numbers
(<code><a href="#topic+least.common.multiple">least.common.multiple</a></code>,
<code><a href="#topic+greatest.common.divisor">greatest.common.divisor</a></code>).
</p>
</dd>
<dt>Faster versions of basic <span class="rlang"><b>R</b></span> tools</dt><dd>
<p>Faster versions of some basic <span class="rlang"><b>R</b></span> tools and idioms are provided.
These are only faster in particular cases, but if you know that
your data have a particular form, the acceleration can be substantial.
See <code><a href="#topic+ifelseAB">ifelseAB</a></code>, <code><a href="#topic+fave.order">fave.order</a></code>,
<code><a href="#topic+revcumsum">revcumsum</a></code>, <code><a href="#topic+tapplysum">tapplysum</a></code>.
</p>
</dd>
<dt>Grammar</dt><dd>
<p>Use the correct word in English to refer to
an ordinal number (<code><a href="#topic+ordinal">ordinal</a></code>,
<code><a href="#topic+ordinalsuffix">ordinalsuffix</a></code>)
and the correct indefinite article
(<code><a href="#topic+articlebeforenumber">articlebeforenumber</a></code>).
</p>
</dd>
<dt>Tools for generating printed output</dt><dd>
<p>The function <code><a href="#topic+splat">splat</a></code> is a replacement for
<code>cat(paste(...))</code> which ensures that output stays
inside the declared text margin (<code><a href="base.html#topic+getOption">getOption</a>("width")</code>)
and can also perform automatic indentation.
There are useful functions to add or remove parentheses
(<code><a href="#topic+paren">paren</a></code>, <code><a href="#topic+unparen">unparen</a></code>) and
to make comma-separated lists (<code><a href="#topic+commasep">commasep</a></code>).
</p>
</dd>
<dt>Handling intervals (ranges) of real numbers</dt><dd>
<p>Simple functions handle an interval (range) of numerical
values: <code><a href="#topic+check.range">check.range</a></code>,
<code><a href="#topic+intersect.ranges">intersect.ranges</a></code>, 
<code><a href="#topic+inside.range">inside.range</a></code>, 
<code><a href="#topic+check.in.range">check.in.range</a></code>,
<code><a href="#topic+prange">prange</a></code>.
</p>
</dd>
<dt>Handling a formula</dt><dd>
<p>Tools for handling a formula in the <span class="rlang"><b>R</b></span> language include
<code><a href="#topic+lhs.of.formula">lhs.of.formula</a></code>,
<code><a href="#topic+rhs.of.formula">rhs.of.formula</a></code>,
<code><a href="#topic+variablesinformula">variablesinformula</a></code>,
<code><a href="#topic+termsinformula">termsinformula</a></code>,
<code><a href="#topic+offsetsinformula">offsetsinformula</a></code>,
<code><a href="#topic+can.be.formula">can.be.formula</a></code> and
<code><a href="#topic+identical.formulae">identical.formulae</a></code>.
</p>
</dd>
<dt>Polynomials</dt><dd>
<p>There are tools for creating and manipulating symbolic expressions
for polynomials, as they might appear in a formula
(<code><a href="#topic+sympoly">sympoly</a></code>,
<code><a href="#topic+expand.polynom">expand.polynom</a></code>).
</p>
</dd>
<dt>Validating arguments</dt><dd>
<p>There are many tools for validating an argument and
generating a comprehensible error or warning message
if the argument is not valid:
<code><a href="#topic+check.1.integer">check.1.integer</a></code>,
<code><a href="#topic+check.nvector">check.nvector</a></code>,
<code><a href="#topic+check.named.vector">check.named.vector</a></code>.
</p>
</dd>
<dt>Passing arguments</dt><dd>
<p>There are many tools for calling a function while passing
only some of the arguments in a supplied list of arguments:
<code><a href="#topic+do.call.matched">do.call.matched</a></code>, <code><a href="#topic+do.call.without">do.call.without</a></code>,
<code><a href="#topic+resolve.defaults">resolve.defaults</a></code>.
</p>
</dd>
<dt>Traced optimization</dt><dd>
<p><code><a href="#topic+optimizeWithTrace">optimizeWithTrace</a></code> is a simple wrapper for
the one-dimensional optimization routine
<code><a href="stats.html#topic+optimize">optimize</a></code>. It stores the values of the
function argument each time it is called, stores the resulting
function values, and returns them along with the optimal value.
</p>
</dd>
<dt>Workarounds</dt><dd>
<p>There are workarounds for known bugs or undesirable features in
other software.
<code><a href="#topic+spatstatLocator">spatstatLocator</a></code> is a replacement for
<code><a href="graphics.html#topic+locator">locator</a></code> which works around a bug in the
<code>RStudio</code> graphics interface.
<code><a href="#topic+cat.factor">cat.factor</a></code> concatenates several factors,
merging the levels, to produce a new factor.
</p>
</dd>
</dl>



<h3>Licence</h3>

<p>This library and its documentation are usable under the terms of the
&ldquo;GNU General Public License&rdquo;,
a copy of which is distributed with <span class="rlang"><b>R</b></span>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>

<hr>
<h2 id='spatstatLocator'>
Graphical Input
</h2><span id='topic+spatstatLocator'></span>

<h3>Description</h3>

<p>This is an alternative to the <code><a href="graphics.html#topic+locator">locator</a></code>
function. It contains a workaround for a bug that occurs in
<code>RStudio</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatstatLocator(n, type = c("p", "l", "o", "n"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatstatLocator_+3A_n">n</code></td>
<td>

<p>Optional. Maximum number of points to locate.
</p>
</td></tr>
<tr><td><code id="spatstatLocator_+3A_type">type</code></td>
<td>

<p>Character specifying how to plot the locations.
If <code>"p"</code> or <code>"o"</code> the points are plotted;
if <code>"l"</code> or <code>"o"</code> they are joined by lines.
</p>
</td></tr>
<tr><td><code id="spatstatLocator_+3A_...">...</code></td>
<td>

<p>Additional graphics parameters used to plot the locations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a replacement/workaround for the <code><a href="graphics.html#topic+locator">locator</a></code>
function in some versions of <span class="pkg">RStudio</span> which do not seem to
recognise the option <code>type="p"</code>.
</p>
<p>See <code><a href="graphics.html#topic+locator">locator</a></code> for a description of the
behaviour.
</p>


<h3>Value</h3>

<p>A list containing components <code>x</code> and <code>y</code> which are vectors
giving the coordinates of the identified points in the
user coordinate system, i.e., the one specified by <code>par("usr")</code>.
</p>


<h3>Software Testing</h3>

<p>Programmers may like to know that
code which depends on <code>spatstatLocator</code>
can be tested in a non-interactive session,
if the coordinates are previously queued using
<code><a href="#topic+queueSpatstatLocator">queueSpatstatLocator</a></code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+locator">locator</a></code>.
</p>
<p><code><a href="#topic+queueSpatstatLocator">queueSpatstatLocator</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   if(interactive()) locator(1, type="p")
</code></pre>

<hr>
<h2 id='splat'>
Print Text Within Margins
</h2><span id='topic+splat'></span>

<h3>Description</h3>

<p>Prints a given character string or strings
inside the text margin specified by <code>options("width")</code>.
Indents the text if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splat(..., indent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splat_+3A_...">...</code></td>
<td>

<p>Character strings, or other arguments acceptable to
<code><a href="base.html#topic+paste">paste</a></code>.
</p>
</td></tr>
<tr><td><code id="splat_+3A_indent">indent</code></td>
<td>

<p>Optional. Indentation of the text.
Either an integer specifying the number of character positions
by which the text should be indented, or a character string whose
length determines the indentation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>splat</code> stands for &lsquo;split cat&rsquo;.
</p>
<p>The command <code>splat(...)</code> is like <code>cat(paste(...))</code>
except that the output will be split into lines that can be
printed within the current text margin
specified by <code><a href="base.html#topic+getOption">getOption</a>("width")</code>.
</p>
<p>The arguments <code>...</code> are first combined into a character vector
using <code><a href="base.html#topic+paste">paste</a></code>. Then they are split into words
separated by white space. A newline will be inserted whenever the next
word does not fit in the available text area.
(Words will not be broken, so the text margin could be exceeded
if any word is longer than <code><a href="base.html#topic+getOption">getOption</a>("width")</code>).
</p>
<p>If any argument is a vector, each
element of the vector is treated as a separate line.
Existing newline characters in <code>...</code> are also respected.
</p>


<h3>Value</h3>

<p>Null.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  op &lt;- options(width=20)
  splat("There is more than one way to skin a cat.")
  splat("There is more than one", "way to skin a cat.", indent=5)

  options(width=10)
  splat("The value of pi is", pi)
  splat("The value of pi is", signif(pi))
  options(op)
</code></pre>

<hr>
<h2 id='taperoff'>
Taper Functions
</h2><span id='topic+taperoff'></span>

<h3>Description</h3>

<p>Computes a function that tapers smoothly from 0 to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taperoff(x, zeropoint = 0, onepoint = 1,
         type = c("smooth", "cosine", "Gaussian"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taperoff_+3A_x">x</code></td>
<td>

<p>Function argument. A number or a numeric vector.
</p>
</td></tr>
<tr><td><code id="taperoff_+3A_zeropoint">zeropoint</code></td>
<td>

<p>Value of <code>x</code> that should return a function value of 0.
</p>
</td></tr>
<tr><td><code id="taperoff_+3A_onepoint">onepoint</code></td>
<td>

<p>Value of <code>x</code> that should return a function value of 1.
</p>
</td></tr>
<tr><td><code id="taperoff_+3A_type">type</code></td>
<td>

<p>Character string (partially matched) specifying which taper function
to use.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A taper is a mathematical function that exhibits a gradual transition between
the values 0 and 1.
</p>
<p>By default, the function value <code class="reqn">f(x)</code> is equal to 0
if <code class="reqn">x \le 0</code>, is equal to 1 if <code class="reqn">x \ge 1</code>,
and lies between 0 and 1 when <code class="reqn">0 &lt; x &lt; 1</code>.
</p>
<p>If <code>type="cosine"</code>, the function is the cosine taper
<code class="reqn">f(x) = (1 - \cos(\pi x))/2</code>.
</p>
<p>If <code>type="smooth"</code> the function is the smooth partition of unity
<code class="reqn">f(x) = \theta(x)/(\theta(x) + \theta(1-x))</code>
where <code class="reqn">\theta(x) = \exp(-1/x)</code>.
</p>
<p>If <code>type="Gaussian"</code> the function is the cumulative distribution
function of the Gaussian (normal) distribution with mean <code class="reqn">1/2</code>
and standard deviation <code class="reqn">1/6</code>.
</p>
<p>If <code>zeropoint</code> and <code>onepoint</code> are specified, then
the function value is equal to 0 when
<code>x=zeropoint</code>, equal to 1 when <code>x=onepoint</code>, and lies
between 0 and 1 when <code>x</code> lies between <code>zeropoint</code> and
<code>onepoint</code>.
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  curve(taperoff(x, type="smooth"))
  curve(taperoff(x, type="cosine"), add=TRUE, col="green")
  curve(taperoff(x, type="Gaussian"), add=TRUE, col="blue")
</code></pre>

<hr>
<h2 id='tapplysum'>
Sum By Factor Level
</h2><span id='topic+tapplysum'></span>

<h3>Description</h3>

<p>A faster equivalent of <code>tapply(FUN=sum)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  tapplysum(x, flist, do.names = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tapplysum_+3A_x">x</code></td>
<td>

<p>Vector of numeric or complex values.
</p>
</td></tr>
<tr><td><code id="tapplysum_+3A_flist">flist</code></td>
<td>

<p>A list of <code>factor</code>s of the same length as <code>x</code>.
</p>
</td></tr>
<tr><td><code id="tapplysum_+3A_do.names">do.names</code></td>
<td>

<p>Logical value indicating whether to attach names to the result.
</p>
</td></tr>
<tr><td><code id="tapplysum_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical value indicating whether to remove <code>NA</code> values
before computing the sums.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to be a faster alternative to
the idiom <code>y &lt;- <a href="base.html#topic+tapply">tapply</a>(x, flist, sum); y[is.na(y)] &lt;- 0</code>.
The result <code>y</code> is a vector, matrix or array of
dimension equal to the number of factors in <code>flist</code>. Each
position in <code>y</code> represents one of the possible combinations
of the factor levels. The resulting value in this position
is the sum of all entries of <code>x</code>
where the factors in <code>flist</code> take this particular combination of
values. The sum is zero if this combination does not occur.
</p>
<p>Currently this is implemented for the cases where <code>flist</code>
has length 1, 2 or 3 (resulting in a vector, matrix or 3D array,
respectively).
For other cases we fall back on <code><a href="base.html#topic+tapply">tapply</a></code>.
</p>


<h3>Value</h3>

<p>A numeric vector, matrix or array.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a> and Tilman Davies.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+tapply">tapply</a></code>, <code><a href="base.html#topic+table">table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   x &lt;- 1:12
   a &lt;- factor(rep(LETTERS[1:2], each=6))
   b &lt;- factor(rep(letters[1:4], times=3))
   ff &lt;- list(a, b)
   tapply(x, ff, sum)
   tapplysum(x, ff, do.names=TRUE)
   tapplysum(x + 2i, ff, do.names=TRUE)
</code></pre>

<hr>
<h2 id='termsinformula'>
Manipulate Formulae
</h2><span id='topic+termsinformula'></span><span id='topic+offsetsinformula'></span><span id='topic+variablesinformula'></span><span id='topic+lhs.of.formula'></span><span id='topic+lhs.of.formula+3C-'></span><span id='topic+rhs.of.formula'></span><span id='topic+rhs.of.formula+3C-'></span><span id='topic+can.be.formula'></span><span id='topic+identical.formulae'></span>

<h3>Description</h3>

<p>Operations for manipulating formulae.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>termsinformula(x)
variablesinformula(x)
offsetsinformula(x)
lhs.of.formula(x)
rhs.of.formula(x, tilde=TRUE)
lhs.of.formula(x) &lt;- value
rhs.of.formula(x) &lt;- value
can.be.formula(x)
identical.formulae(x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="termsinformula_+3A_x">x</code>, <code id="termsinformula_+3A_y">y</code></td>
<td>

<p>Formulae, or character strings representing formulae.
</p>
</td></tr>
<tr><td><code id="termsinformula_+3A_tilde">tilde</code></td>
<td>

<p>Logical value indicating whether to retain the tilde.
</p>
</td></tr>
<tr><td><code id="termsinformula_+3A_value">value</code></td>
<td>

<p>Symbol or expression in the <span class="rlang"><b>R</b></span> language. See Examples.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>variablesinformula(x)</code>
returns a character vector of the names
of all variables which appear in the formula <code>x</code>.
</p>
<p><code>termsinformula(x)</code> returns a character vector of all 
terms in the formula <code>x</code> (after expansion of interaction terms).
</p>
<p><code>offsetsinformula(x)</code> returns a character vector of all
offset terms in the formula.
</p>
<p><code>rhs.of.formula(x)</code> returns the right-hand side of the formula
as another formula (that is, it removes the left-hand side) provided
<code>tilde=TRUE</code> (the default). If <code>tilde=FALSE</code>, then the
right-hand side is returned as a language object.
</p>
<p><code>lhs.of.formula(x)</code> returns the left-hand side of the formula
as a symbol or language object, or <code>NULL</code> if the formula has no
left-hand side.
</p>
<p><code>lhs.of.formula(x) &lt;- value</code>
and <code>rhs.of.formula(x) &lt;- value</code>
change the formula <code>x</code> by replacing the left or right hand side
of the formula by <code>value</code>.
</p>
<p><code>can.be.formula(x)</code> returns <code>TRUE</code> if <code>x</code> is a formula
or a character string that can be parsed as a formula, and returns
<code>FALSE</code> otherwise.
</p>
<p><code>identical.formulae(x,y)</code> returns <code>TRUE</code> if <code>x</code> and
<code>y</code> are identical formulae (ignoring their environments).
</p>


<h3>Value</h3>

<p><code>variablesinformula</code>,
<code>termsinformula</code> and
<code>offsetsinformula</code> return a character vector.
</p>
<p><code>rhs.of.formula</code> returns a formula.
<code>lhs.of.formula</code> returns a symbol or language object, or <code>NULL</code>.
</p>
<p><code>can.be.formula</code> and <code>identical.formulae</code> return
a logical value.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  f &lt;- (y ~ x + z*w + offset(h))
  lhs.of.formula(f)
  rhs.of.formula(f)
  variablesinformula(f)  
  termsinformula(f)
  offsetsinformula(f)
  g &lt;- f
  environment(g) &lt;- new.env()
  identical(f,g)
  identical.formulae(f,g)
  lhs.of.formula(f) &lt;- quote(mork) # or as.name("mork")
  f
  rhs.of.formula(f) &lt;- quote(x+y+z) # or parse(text="x+y+z")[[1]]
  f
</code></pre>

<hr>
<h2 id='verbalogic'>
Verbal Logic
</h2><span id='topic+verbalogic'></span>

<h3>Description</h3>

<p>Perform the specified logical operation
on the character vector <code>x</code>, recognising the
special strings <code>"TRUE"</code> and <code>"FALSE"</code>
and treating other strings as logical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verbalogic(x, op = "and")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verbalogic_+3A_x">x</code></td>
<td>

<p>Character vector.
</p>
</td></tr>
<tr><td><code id="verbalogic_+3A_op">op</code></td>
<td>

<p>Logical operation: one of the character strings
<code>"and"</code>, <code>"or"</code> or <code>"not"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs simple logical operations
on character strings that represent human-readable statements.
</p>
<p>The character vector <code>x</code> may contain any strings:
the special strings <code>"TRUE"</code> and <code>"FALSE"</code> are
treated as the logical values <code>TRUE</code> and <code>FALSE</code>,
while all other strings are treated as if they were
logical variables.
</p>
<p>If <code>op="and"</code>, the result is a single string,
logically equivalent to <code>x[1] &amp;&amp; x[2] &amp;&amp; ... &amp;&amp; x[n]</code>.
First, any entries of <code>x</code> equal to <code>"TRUE"</code> are removed.
The result is <code>"FALSE"</code> if any of the entries of <code>x</code>
is <code>"FALSE"</code>; otherwise it is equivalent to
<code>paste(x, collapse=" and ")</code>.
</p>
<p>If <code>op="or"</code>, the result is a single string, logically equivalent to
<code>x[1] || x[2] || ... || x[n]</code>. 
First, any entries of <code>x</code> equal to <code>"FALSE"</code> are removed.
The result is <code>"TRUE"</code> if any of the entries of <code>x</code>
is <code>"TRUE"</code>; otherwise it is equivalent to
<code>paste(x, collapse=" or ")</code>.
</p>
<p>If <code>op="not"</code>, the result is a character vector <code>y</code>
such that <code>y[i]</code> is the logical negation of <code>x[i]</code>.
</p>
<p>The code does not understand English grammar and cannot expand logical
expressions.
</p>


<h3>Value</h3>

<p>A character string.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   x &lt;- c("The sky is blue", "my name is not Einstein", "FALSE")
   verbalogic(x, "and")
   verbalogic(x, "or")
   verbalogic(x, "not")
</code></pre>

<hr>
<h2 id='which.min.fair'>
Where is the Minimum or Maximum
</h2><span id='topic+which.min.fair'></span><span id='topic+which.max.fair'></span>

<h3>Description</h3>

<p>Determines the index of the minimum or maximum of a vector.
If there are multiple entries which achieve the minimum or maximum,
one of the indices is selected at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>which.min.fair(x)
which.max.fair(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="which.min.fair_+3A_x">x</code></td>
<td>

<p>numeric, logical, integer or double vector.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are alternatives to
the standard <span class="rlang"><b>R</b></span> functions <code><a href="base.html#topic+which.min">which.min</a></code>
and <code><a href="base.html#topic+which.max">which.max</a></code>.
</p>
<p>The standard functions <code><a href="base.html#topic+which.min">which.min</a></code>
and <code><a href="base.html#topic+which.max">which.max</a></code> find the index of the
<b>first</b> entry in the vector <code>x</code> which achieves the minimum
or maximum value. This can cause a bias in some simulation
experiments.
</p>
<p>The functions <code>which.min.fair</code> and <code>which.max.fair</code>
identify all entries of the vector <code>x</code> which achieve the
minimum or maximum respectively, and
<b>select one of them at random</b>. 
</p>


<h3>Value</h3>

<p>A single integer (or <code>integer(0)</code> if all entries of <code>x</code> are
<code>NA</code> or <code>NaN</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+which.min">which.min</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  z &lt;- c(20, 40, 20, 10, 40, 20, 10, 20, 40)
  replicate(5, which.max(z))
  replicate(5, which.max.fair(z))
  replicate(5, which.min.fair(z))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
