<!DOCTYPE html><html><head><title>Help for package surveyplanning</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {surveyplanning}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#surveyplanning-package'>
<p>Survey Planning Tools</p></a></li>
<li><a href='#dom_optimal_allocation'><p>Optimal sample size allocation</p></a></li>
<li><a href='#expsize'><p>Sample size calculation</p></a></li>
<li><a href='#expvar'><p>Expected precision for the estimates of totals</p></a></li>
<li><a href='#min_count'><p>Minimal count of respondents for the given relative margin of error</p></a></li>
<li><a href='#min_prop'><p>Minimal proportion for the given relative margin of error</p></a></li>
<li><a href='#MoE_P'><p>Margin of error for proportion</p></a></li>
<li><a href='#MoE_Y'><p>Margin of error for count</p></a></li>
<li><a href='#optsize'><p>Optimal sample size allocation</p></a></li>
<li><a href='#prop_dom_optimal_allocation'><p>Optimal sample size allocation for proportion</p></a></li>
<li><a href='#round2'><p>Rounding numbers</p></a></li>
<li><a href='#s2'><p>Population variance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Survey Planning Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.11.4), laeken, stats</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juris Breidaks &lt;rcsb@csb.gov.lv&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for sample survey planning, including sample size calculation, estimation of expected precision for the estimates of totals, and calculation of optimal sample size allocation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://csblatvia.github.io/surveyplanning/">https://csblatvia.github.io/surveyplanning/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CSBLatvia/surveyplanning/issues/">https://github.com/CSBLatvia/surveyplanning/issues/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-20 10:45:25 UTC; JBreidaks</td>
</tr>
<tr>
<td>Author:</td>
<td>Juris Breidaks [aut, cre],
  Martins Liberts [aut],
  Janis Jukams [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-20 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='surveyplanning-package'>
Survey Planning Tools
</h2><span id='topic+surveyplanning-package'></span><span id='topic+surveyplanning'></span>

<h3>Description</h3>

<p>Tools for sample survey planning, including sample size calculation,
estimation of expected precision for the estimates of totals, and
calculation of optimal sample size allocation.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> surveyplanning</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-10-26</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.0.0), data.table (&gt;= 1.10.4), stats, laeken </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://github.com/CSBLatvia/surveyplanning/ </td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://github.com/CSBLatvia/surveyplanning/issues/ </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
dom_optimal_allocation  Optimal sample size allocation
expsize                 Sample size calculation
expvar                  Expected precision for the estimates of totals
min_count               Minimal count of respondents for the given relative margin of error
min_prop                Minimal proportion for the given relative margin of error
MoE_Y                   Margin of error for count
MoE_P                   Margin of error for proportion
optsize                 Optimal sample size allocation
s2                      Population variance estimation
surveyplanning-package  Survey Planning Tools

</pre>


<h3>Author(s)</h3>

<p>Juris Breidaks [aut, cre],
Martins Liberts [aut],
Janis Jukams [aut]
</p>
<p>Maintainer: Juris Breidaks &lt;rcsb@csb.gov.lv&gt;
</p>

<hr>
<h2 id='dom_optimal_allocation'>Optimal sample size allocation</h2><span id='topic+dom_optimal_allocation'></span>

<h3>Description</h3>

<p>The function computes optimal sample size allocation over strata and domain for population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dom_optimal_allocation(
  id,
  Dom,
  H,
  Y,
  Rh = NULL,
  deffh = NULL,
  indicator,
  sup_w,
  sup_cv,
  min_size = 3,
  correction_before = FALSE,
  dataset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dom_optimal_allocation_+3A_id">id</code></td>
<td>
<p>Variable for unit ID codes. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_dom">Dom</code></td>
<td>
<p>Optional variables used to define population domains. If supplied, values are calculated for each domain. An object convertible to <code>data.table</code> or variable names as character vector, column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_h">H</code></td>
<td>
<p>The unit stratum variable. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_y">Y</code></td>
<td>
<p>Variable of interest. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_rh">Rh</code></td>
<td>
<p>The expected response rate in each stratum (optional). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_deffh">deffh</code></td>
<td>
<p>The expected design effect for the estimate of variable (optional). If not defined, it is assumed to be 1 for each variable in each stratum. If is defined, then variables is defined the same arrangement as <code>Yh</code>. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_indicator">indicator</code></td>
<td>
<p>Variable for detection fully surveyed units. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_sup_w">sup_w</code></td>
<td>
<p>Variable for weight limit in domain of stratum. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_sup_cv">sup_cv</code></td>
<td>
<p>Variable for maximum coeficient of variation (CV) in percentage for domain. Object convertible to <code>data.table</code> or variable names as character, column numbers.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_min_size">min_size</code></td>
<td>
<p>A numeric value for sample size.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_correction_before">correction_before</code></td>
<td>
<p>by default FALSE; correction of sample size is made before ending, if true, correction of sample size is made at the end.</p>
</td></tr>
<tr><td><code id="dom_optimal_allocation_+3A_dataset">dataset</code></td>
<td>
<p>Optional survey data object convertible to <code>data.table</code> with one row for each stratum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with eights data objects:<br />
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>An object as <code>data.table</code>, with variables:
<code>id</code> - variable with unit ID codes, <br />
<code>Dom</code> - optional variables used to define population domains, <br />
<code>H</code> - the unit stratum variable, <br />
<code>Y</code> - variable of interest, <br />
<code>Rh</code> - the expected response rate in each stratum, <br />
<code>deffh</code> - the expected design effect, <br />
<code>indicator</code> - variable for full surveys, <br />
<code>sup_w</code> - variable for weight limit in domain of stratum, <br />
<code>sup_cv</code> - Variable for maximum coeficient of variation, <br />
<code>poph</code> - population size, <br />
<code>nh</code> - sample size . </p>
</td></tr>
<tr><td><code>nh_larger_then_Nh</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>H</code> - the stratum variable, <br />
<code>nh</code> - sample size,
<code>poph</code> - population size.</p>
</td></tr>
<tr><td><code>dom_strata_size</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>H</code> - the unit stratum variable, <br />
<code>Dom</code> - optional variables used to define population domains, <br />
<code>sup_w</code> - variable for weight limit in domain of stratum, <br />
<code>poph</code> - population size, <br />
<code>nh</code> - sample size, <br />
<code>sample100</code> - sample size for fully surveyed units, <br />
<code>design_weights</code> - design weigts. </p>
</td></tr>
<tr><td><code>dom_size</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>Dom</code> - optional variables used to define population domains, <br />
<code>poph</code> - population size, <br />
<code>nh</code> - sample size, <br />
<code>sample100</code> - sample size for fully surveyed units, <br />
<code>design_weights</code> - design weigts. </p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>poph</code> - population size, <br />
<code>nh</code> - sample size, <br />
<code>sample100</code> - sample size for fully surveyed units. </p>
</td></tr>
<tr><td><code>dom_strata_expected_precision</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>H</code> - stratum, <br />
<code>variable</code> - the name of variable of interest, <br />
<code>estim</code> - total value, <br />
<code>deffh</code> - the expected design effect, <br />
<code>s2h</code> - population variance <code class="reqn">S^2</code>, <br />
<code>nh</code> - sample size, <br />
<code>Rh</code> - the expected response rate, <br />
<code>deffh</code> - the expected design effect, <br />
<code>poph</code> - population size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>var</code> - expected variance, <br />
<code>se</code> - expected standard error, <br />
<code>cv</code> - expected coeficient of variance.</p>
</td></tr>
<tr><td><code>dom_expected_precision</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>Dom</code> - domain, <br />
<code>variable</code> - the name of variable of interest, <br />
<code>poph</code> - the population size, <br />
<code>nh</code> - sample size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>estim</code> - total value, <br />
<code>var</code> - the expected variance, <br />
<code>se</code> - the expected standart error, <br />
<code>cv</code> - the expected coeficient of variance.</p>
</td></tr>
<tr><td><code>total_expected_precision</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>variable</code> - the name of variable of interest, <br />
<code>poph</code> - the population size, <br />
<code>nh</code> - sample size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>estim</code> - total value, <br />
<code>var</code> - the expected variance, <br />
<code>se</code> - the expected standart error, <br />
<code>cv</code> - the expected coeficient of variance.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expsize">expsize</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+prop_dom_optimal_allocation">prop_dom_optimal_allocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("laeken")
library("data.table")
data("ses")
data &lt;- data.table(ses)
data[, H := paste(location, NACE1, size, sep = "_")]
data[, id := .I]
data[, full := 0]
data[, sup_cv := 10]
data[, sup_w := 20]
#vars &lt;- dom_optimal_allocation(id = "id", dom = "sex",
#                                H = "H", Y = "earnings",
#                                indicator = "full",
#                                sup_w = "sup_w",
#                                sup_cv = "sup_cv",
#                                min_size = 3,
#                                correction_before = FALSE,
#                                dataset = data)
#                                dataset=data)
#vars
</code></pre>

<hr>
<h2 id='expsize'>Sample size calculation</h2><span id='topic+expsize'></span>

<h3>Description</h3>

<p>The function computes minimum sample size for each stratum to achieve defined precision (CV) for the estimates of totals in each stratum. The calculation takes into account expected totals, population variance, expected response rate and design effect in each stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expsize(Yh, H, s2h, poph, Rh = NULL, deffh = NULL, CVh, dataset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expsize_+3A_yh">Yh</code></td>
<td>
<p>The expected totals for variables of interest in each stratum. Object convertible to <code>data.table</code>, variable names as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expsize_+3A_h">H</code></td>
<td>
<p>The stratum variable. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expsize_+3A_s2h">s2h</code></td>
<td>
<p>The expected population variance <code class="reqn">S^2</code> for variables of interest in each stratum. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expsize_+3A_poph">poph</code></td>
<td>
<p>Population size in each stratum. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expsize_+3A_rh">Rh</code></td>
<td>
<p>The expected response rate in each stratum (optional). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expsize_+3A_deffh">deffh</code></td>
<td>
<p>The expected design effect for the estimates of totals (optional). If not defined, it is assumed to be 1 for each variable in each stratum. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expsize_+3A_cvh">CVh</code></td>
<td>
<p>Coefficient of variation (in percentage) to be achieved for each stratum. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expsize_+3A_dataset">dataset</code></td>
<td>
<p>Optional survey data object convertible to <code>data.table</code> with one row for each stratum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> is returned by the function, with variables:<br />
<code>H</code> - stratum, <br />
<code>variable</code> - the name of variable of interest, <br />
<code>estim</code> - total value, <br />
<code>deffh</code> - the expected design effect, <br />
<code>s2h</code> - population variance <code class="reqn">S^2</code>, <br />
<code>CVh</code> - the expected coefficient of variation, <br />
<code>Rh</code> - the expected response rate, <br />
<code>poph</code> - population size, <br />
<code>nh</code> - minimal sample size to achieve defined precision (CV).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+MoE_P">MoE_P</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
data &lt;- data.table(H = 1:3, Yh = 10 * 1:3,
                   Yh1 = 10 * 4:6, s2h = 10 * runif(3),
                   s2h2 = 10 * runif(3), CVh = rep(4.9,3),
                   poph = 8 * 1:3, Rh = rep(1, 3),
                   deffh = rep(2, 3), deffh2 = rep(3, 3))

size &lt;- expsize(Yh = c("Yh", "Yh1"), H = "H",
                s2h = c("s2h", "s2h2"), poph = "poph",
                Rh = "Rh", deffh = c("deffh", "deffh2"),
                CVh = "CVh", dataset = data)

size


</code></pre>

<hr>
<h2 id='expvar'>Expected precision for the estimates of totals</h2><span id='topic+expvar'></span>

<h3>Description</h3>

<p>The function computes expected precision as variance, standard error, and coefficient of variation for the estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expvar(
  Yh,
  Zh = NULL,
  H,
  s2h,
  nh,
  poph,
  Rh = NULL,
  deffh = NULL,
  Dom = NULL,
  dataset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expvar_+3A_yh">Yh</code></td>
<td>
<p>The expected totals for variables of interest in each stratum. Object convertible to <code>data.table</code>, variable names as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expvar_+3A_zh">Zh</code></td>
<td>
<p>Optional variables of denominator for the expected ratio estimation in each stratum. Object convertible to <code>data.table</code>, variable names as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expvar_+3A_h">H</code></td>
<td>
<p>The stratum variable. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expvar_+3A_s2h">s2h</code></td>
<td>
<p>The expected population variance <code class="reqn">S^2</code> for variables of interest in each stratum. Variables is defined the same arrangement as <code>Yh</code>. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expvar_+3A_nh">nh</code></td>
<td>
<p>Sample size in each stratum. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expvar_+3A_poph">poph</code></td>
<td>
<p>Population size in each stratum. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expvar_+3A_rh">Rh</code></td>
<td>
<p>The expected response rate in each stratum (optional). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="expvar_+3A_deffh">deffh</code></td>
<td>
<p>The expected design effect for the estimates of totals (optional). If not defined, it is assumed to be 1 for each variable in each stratum. If is defined, then variables is defined the same arrangement as <code>Yh</code>. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expvar_+3A_dom">Dom</code></td>
<td>
<p>Optional variables used to define population domains. Only domains as unions of strata can be defined. If supplied, estimated precision is calculated for each domain. An object convertible to <code>data.table</code>, variable names as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="expvar_+3A_dataset">dataset</code></td>
<td>
<p>Optional survey data object convertible to <code>data.table</code> with one row for each stratum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three data objects:
</p>
<table>
<tr><td><code>resultH</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>H</code> - stratum, <br />
<code>variableY</code> - the name of variable of interest, <br />
<code>variableZ</code> - the name of optional variable of denominator for the expected ratio estimation, <br />
<code>estim</code> - total value, <br />
<code>deffh</code> - the expected design effect, <br />
<code>s2h</code> - population variance <code class="reqn">S^2</code>, <br />
<code>nh</code> - sample size, <br />
<code>Rh</code> - the expected response rate, <br />
<code>poph</code> - population size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>var</code> - expected variance, <br />
<code>se</code> - expected standard error, <br />
<code>cv</code> - expected coeficient of variance.</p>
</td></tr>
<tr><td><code>resultDom</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>Dom</code> - domain, <br />
<code>variableY</code> - the name of variable of interest, <br />
<code>variableZ</code> - the name of optional variable of denominator for the expected ratio estimation, <br />
<code>poph</code> - the population size, <br />
<code>nh</code> - sample size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>estim</code> - total value, <br />
<code>var</code> - the expected variance, <br />
<code>se</code> - the expected standart error, <br />
<code>cv</code> - the expected coeficient of variance.</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>variableY</code> - the name of variable of interest, <br />
<code>variableZ</code> - the name of optional variable of denominator for the expected ratio estimation, <br />
<code>poph</code> - the population size, <br />
<code>nh</code> - sample size, <br />
<code>nrh</code> - expected number of respondents, <br />
<code>estim</code> - total value, <br />
<code>var</code> - the expected variance, <br />
<code>se</code> - the expected standart error, <br />
<code>cv</code> - the expected coeficient of variance.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
data &lt;- data.table(H = 1:3, Yh = 10 * 1:3,
                   Yh1 = 10 * 4:6, s2h = 10 * runif(3),
                   s2h2 = 10 * runif(3), nh = rep(4 * 1:3),
                   poph = 8 * 1:3, Rh = rep(1, 3),
                   deffh = rep(2, 3), deffh2 = rep(3, 3))

vars &lt;- expvar(Yh = c("Yh", "Yh1"), H = "H",
               s2h = c("s2h", "s2h2"),
               nh = "nh", poph = "poph",
               Rh = "Rh", deffh = c("deffh", "deffh2"),
               dataset = data)
vars

</code></pre>

<hr>
<h2 id='min_count'>Minimal count of respondents for the given relative margin of error</h2><span id='topic+min_count'></span>

<h3>Description</h3>

<p>The function computes minimal proportion for the given relative margin of error. The calculation takes into sample size, population size, margin of error, expected response rate and design effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_count(n, pop, RMoE, confidence = 0.95, R = 1, deff_sam = 1, deff_est = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min_count_+3A_n">n</code></td>
<td>
<p>The expected sample size.</p>
</td></tr>
<tr><td><code id="min_count_+3A_pop">pop</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="min_count_+3A_rmoe">RMoE</code></td>
<td>
<p>The expected relative margin of error.</p>
</td></tr>
<tr><td><code id="min_count_+3A_confidence">confidence</code></td>
<td>
<p>Optional positive value for confidence interval. This variable by default is 0.95.</p>
</td></tr>
<tr><td><code id="min_count_+3A_r">R</code></td>
<td>
<p>The expected response rate (optional). If not defined, it is assumed to be 1 (full-response).</p>
</td></tr>
<tr><td><code id="min_count_+3A_deff_sam">deff_sam</code></td>
<td>
<p>The expected design effect of sample design for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
<tr><td><code id="min_count_+3A_deff_est">deff_est</code></td>
<td>
<p>The estimated design effect of estimator for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate of minimal count of respondents for the given relative margin of error.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+MoE_P">MoE_P</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>min_count(n = 15e3, pop = 2e6, RMoE = 0.1)

## Not run: 
library("data.table")
min_count(n = c(10e3, 15e3, 20e3), pop = 2e6, 0.1)

n &lt;- seq(10e3, 30e3, length.out = 11)
# n &lt;- sort(c(n, 22691))
n

RMoE &lt;- seq(.02, .2, length.out = 10)
RMoE

dt &lt;- data.table(n = rep(n, each = length(RMoE)), RMoE = RMoE)
dt[, Y := min_count(n = n, pop = 2.1e6, RMoE = RMoE, R = 1) / 1e3]
dt

## End(Not run)

</code></pre>

<hr>
<h2 id='min_prop'>Minimal proportion for the given relative margin of error</h2><span id='topic+min_prop'></span>

<h3>Description</h3>

<p>The function computes minimal proportion for the given relative margin of error. The calculation takes into sample size, population size, margin of error, expected response rate and design effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_prop(n, pop, RMoE, confidence = 0.95, R = 1, deff_sam = 1, deff_est = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min_prop_+3A_n">n</code></td>
<td>
<p>The expected sample size.</p>
</td></tr>
<tr><td><code id="min_prop_+3A_pop">pop</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="min_prop_+3A_rmoe">RMoE</code></td>
<td>
<p>The expected relative margin of error.</p>
</td></tr>
<tr><td><code id="min_prop_+3A_confidence">confidence</code></td>
<td>
<p>Optional positive value for confidence interval. This variable by default is 0.95.</p>
</td></tr>
<tr><td><code id="min_prop_+3A_r">R</code></td>
<td>
<p>The expected response rate (optional). If not defined, it is assumed to be 1 (full-response).</p>
</td></tr>
<tr><td><code id="min_prop_+3A_deff_sam">deff_sam</code></td>
<td>
<p>The expected design effect of sample design for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
<tr><td><code id="min_prop_+3A_deff_est">deff_est</code></td>
<td>
<p>The estimated design effect of estimator for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate of minimal proportion for the given relative margin of error.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+MoE_P">MoE_P</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>min_prop(n = 100, pop = 1000, RMoE = 0.1)

</code></pre>

<hr>
<h2 id='MoE_P'>Margin of error for proportion</h2><span id='topic+MoE_P'></span>

<h3>Description</h3>

<p>The function computes margin of error for proportion. The calculation takes into proportion, expected response rate and design effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MoE_P(P = 0.5, n, pop, confidence = 0.95, R = 1, deff_sam = 1, deff_est = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MoE_P_+3A_p">P</code></td>
<td>
<p>The expected proportion for variable of interest.</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_n">n</code></td>
<td>
<p>The expected sample size.</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_pop">pop</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_r">R</code></td>
<td>
<p>The expected response rate (optional). If not defined, it is assumed to be 1 (full-response).</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_deff_sam">deff_sam</code></td>
<td>
<p>The expected design effect of sample design for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_deff_est">deff_est</code></td>
<td>
<p>The estimated design effect of estimator for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
<tr><td><code id="MoE_P_+3A_confidence">confidence</code></td>
<td>
<p>Optional</p>
</td></tr></table>
<p>positive value for confidence interval. This variable by default is 0.95.
</p>


<h3>Value</h3>

<p>The estimate of margin of error for proportion.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+MoE_Y">MoE_Y</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
n &lt;- 100
pop &lt;- 1000

MoE_P(P = 0.5, n = n, pop = pop)

DT &lt;- data.table(P = seq(0, 1, 0.01))
DT[, Y := round(pop * P)]
DT[, AMoE := MoE_P(P, n = 100, pop = 1000)]
DT[Y &gt; 0, RMoE := AMoE / Y]
DT

</code></pre>

<hr>
<h2 id='MoE_Y'>Margin of error for count</h2><span id='topic+MoE_Y'></span>

<h3>Description</h3>

<p>The function computes margin of error for count. The calculation takes into proportion, expected response rate and design effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MoE_Y(P = 0.5, n, pop, confidence = 0.95, R = 1, deff_sam = 1, deff_est = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MoE_Y_+3A_p">P</code></td>
<td>
<p>The expected proportion for variable of interest.</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_n">n</code></td>
<td>
<p>The expected sample size.</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_pop">pop</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_confidence">confidence</code></td>
<td>
<p>Optional positive value for confidence interval. This variable by default is 0.95.</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_r">R</code></td>
<td>
<p>The expected response rate (optional). If not defined, it is assumed to be 1 (full-response).</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_deff_sam">deff_sam</code></td>
<td>
<p>The expected design effect of sample design for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
<tr><td><code id="MoE_Y_+3A_deff_est">deff_est</code></td>
<td>
<p>The estimated design effect of estimator for the estimates (optional). If not defined, it is assumed to be 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate of margin of error for count.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expvar">expvar</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+MoE_P">MoE_P</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
n &lt;- 100
pop &lt;- 1000

MoE_Y(P = 0.5, n = n, pop = pop)

DT &lt;- data.table(P = seq(0, 1, 0.01))
DT[, Y := round(pop * P)]
DT[, AMoE := MoE_Y(P, n = 100, pop = 1000)]
DT[Y &gt; 0, RMoE := AMoE / Y]
DT

</code></pre>

<hr>
<h2 id='optsize'>Optimal sample size allocation</h2><span id='topic+optsize'></span>

<h3>Description</h3>

<p>The function computes optimal sample size allocation over strata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optsize(
  H,
  n,
  poph,
  s2h = NULL,
  Rh = NULL,
  deffh = NULL,
  fullsampleh = NULL,
  dataset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optsize_+3A_h">H</code></td>
<td>
<p>The stratum variable. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="optsize_+3A_n">n</code></td>
<td>
<p>Total sample size. One dimensional object with length one.</p>
</td></tr>
<tr><td><code id="optsize_+3A_poph">poph</code></td>
<td>
<p>Population size in each stratum. One dimensional object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="optsize_+3A_s2h">s2h</code></td>
<td>
<p>The expected population variance <code class="reqn">S^2</code> for variables of interest in each stratum (optional). If not defined, it is assumed to be 1 in each stratum. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="optsize_+3A_rh">Rh</code></td>
<td>
<p>The expected response rate in each stratum (optional). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="optsize_+3A_deffh">deffh</code></td>
<td>
<p>The expected design effect for the estimate of variable (optional). If not defined, it is assumed to be 1 for each variable in each stratum. If is defined, then variables is defined the same arrangement as <code>Yh</code>. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.</p>
</td></tr>
<tr><td><code id="optsize_+3A_fullsampleh">fullsampleh</code></td>
<td>
<p>Variable for detection fully surveyed stratum (optinal). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.</p>
</td></tr>
<tr><td><code id="optsize_+3A_dataset">dataset</code></td>
<td>
<p>Optional survey data object convertible to <code>data.table</code> with one row for each stratum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object as <code>data.table</code>, with variables:<br />
<code>H</code> - stratum, <br />
<code>variable</code> - the name of variable for population variance <code class="reqn">S^2</code>, <br />
<code>s2h</code> - population variance <code class="reqn">S^2</code>, <br />
<code>Rh</code> - the expectedresponse rate, <br />
<code>deffh</code> - the expected design effect, <br />
<code>poph</code> - population size, <br />
<code>deffh</code> - design effect, <br />
<code>fullsampleh</code> - full sample indicator, <br />
<code>nh</code> - sample size.
</p>


<h3>Details</h3>

<p>If <code>s2h</code> and <code>Rh</code> is not defined, the sample allocation will be calculated as proportional allocation (proportional to the population size).
If <code>Rh</code> is not defined, the sample allocation will be calculated as Neyman allocation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expsize">expsize</a></code>, <code><a href="#topic+dom_optimal_allocation">dom_optimal_allocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
data &lt;- data.table(H = 1 : 3,
                   s2h=10 * runif(3),
                   s2h2 = 10 * runif(3),
                   poph = 8 * 1 : 3,
                   Rh = rep(1, 3),
                   dd = c(1, 1, 1))

vars &lt;- optsize(H = "H",
                s2h = c("s2h", "s2h2"),
                n = 10, poph = "poph",
                Rh = "Rh",
                fullsampleh = NULL,
                dataset = data)
vars

</code></pre>

<hr>
<h2 id='prop_dom_optimal_allocation'>Optimal sample size allocation for proportion</h2><span id='topic+prop_dom_optimal_allocation'></span>

<h3>Description</h3>

<p>The function computes optimal sample size allocation over strata and domain for proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop_dom_optimal_allocation(
  H,
  Dom,
  pop = NULL,
  R = NULL,
  deff = NULL,
  se_max = 0.5,
  prop = 0.5,
  min_size = 3,
  step = 1,
  unit_level = TRUE,
  dataset = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_h">H</code></td>
<td>
<p>The stratum variable. One dimensional object convertible to one-column <code>data.table</code> or variable name as character, column number.</p>
</td></tr>
<tr><td><code id="prop_dom_optimal_allocation_+3A_dom">Dom</code></td>
<td>
<p>Variables</p>
</td></tr></table>
<p>used to define population domains. An object convertible to <code>data.table</code> or variable names as character vector, column numbers.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_pop">pop</code></td>
<td>
<p>The</p>
</td></tr></table>
<p>population size in each stratum.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_r">R</code></td>
<td>
<p>The</p>
</td></tr></table>
<p>expected response rate in each stratum (optional). If not defined, it is assumed to be 1 in each stratum (full-response). Object convertible to one-column <code>data.table</code>, variable name as character, or column number.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_deff">deff</code></td>
<td>
<p>The</p>
</td></tr></table>
<p>expected design effect for the estimate of variable (optional). If not defined, it is assumed to be 1 for each variable in each stratum. If is defined, then variables is defined the same arrangement as <code>Yh</code>. Object convertible to <code>data.table</code>, variable name as character vector, or column numbers.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_se_max">se_max</code></td>
<td>
<p>Variable</p>
</td></tr></table>
<p>for maximum standarterror (se) in domain.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_prop">prop</code></td>
<td>
<p>The</p>
</td></tr></table>
<p>excepted ratio proportion.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_min_size">min_size</code></td>
<td>
<p>A</p>
</td></tr></table>
<p>numeric value for minimal sample size.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_step">step</code></td>
<td>
<p>A</p>
</td></tr></table>
<p>value for pace.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_unit_level">unit_level</code></td>
<td>
<p>A</p>
</td></tr></table>
<p>logical value, if dataset is prepared for unit level then value TRUE, othercase FALSE.
</p>
<table>
<tr><td><code id="prop_dom_optimal_allocation_+3A_dataset">dataset</code></td>
<td>
<p>Optional</p>
</td></tr></table>
<p>agrregated survey data object convertible to <code>data.table</code> with one row for each stratum.
</p>


<h3>Value</h3>

<p>A list with two data objects:
</p>
<table>
<tr><td><code>datah</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>H</code> - the unit stratum variable, <br />
<code>Dom</code> - variables used to define population domains, <br />
<code>poph</code> - the population size in each stratum, <br />
<code>Rh</code> - the expected response rate in each stratum, <br />
<code>deffh</code> - the expected design effect, <br />
<code>s2h</code> - variance in domain of stratum, <br />
<code>sup_cv</code> - Variable for maximum coeficient of variation, <br />
<code>poph</code> - population size, <br />
<code>nh</code> - sample size .</p>
</td></tr>
<tr><td><code>aggr_Dom</code></td>
<td>
<p>An object as <code>data.table</code>, with variables: <br />
<code>Dom</code> - optional variables used to define population domains, <br />
<code>pop_Dom</code> - population size, <br />
<code>sample_size_Dom</code> - optional variables used to define population domains, <br />
<code>sample_size</code> - optional variables used to define population domains, <br />
<code>pop</code> - sample size</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expsize">expsize</a></code>, <code><a href="#topic+optsize">optsize</a></code>, <code><a href="#topic+dom_optimal_allocation">dom_optimal_allocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("data.table")
library("laeken")
data("eusilc")
eusilc &lt;- data.table(eusilc)
dataset &lt;- eusilc[, .(poph = sum(db090)), by = c("db040")]
dataset[, dom := "1"]
res &lt;- prop_dom_optimal_allocation(H = "db040", Dom = "dom",
                                   pop = "poph", R = NULL,
                                   deff = NULL, se_max = 0.5,
                                   prop = 0.5, min_size = 3,
                                   step = 1, unit_level = FALSE,
                                   dataset = dataset)

</code></pre>

<hr>
<h2 id='round2'>Rounding numbers</h2><span id='topic+round2'></span>

<h3>Description</h3>

<p>The function rounds the values in its first argument to the specified number of decimal places (default 0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round2(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round2_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="round2_+3A_n">n</code></td>
<td>
<p>integer indicating the number of decimal places.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Rounded value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expsize">expsize</a></code>, <code><a href="#topic+dom_optimal_allocation">dom_optimal_allocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dar &lt;- 100 * runif(3)
dar
round2(dar, 1)

</code></pre>

<hr>
<h2 id='s2'>Population variance</h2><span id='topic+s2'></span>

<h3>Description</h3>

<p>The function to estimate population variance <code class="reqn">S^2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s2(y, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s2_+3A_y">y</code></td>
<td>
<p>Study variable.</p>
</td></tr>
<tr><td><code id="s2_+3A_w">w</code></td>
<td>
<p>Survey weight (optional). If not defined, it is assumed to be 1 for each element.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Population variance <code class="reqn">S^2</code> or the estimate of population variance <code class="reqn">s^2</code>.
</p>


<h3>Details</h3>

<p>If <code>w</code> is not defined, the result is equal to the result of the function <code>var</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s2(1:10)
s2(1:10, rep(1:2, each = 5))
all.equal(s2(1:10), var(1:10))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
