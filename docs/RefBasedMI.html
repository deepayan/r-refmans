<!DOCTYPE html><html lang="en"><head><title>Help for package RefBasedMI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RefBasedMI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acupuncture'><p>Sample data: acupuncture trial</p></a></li>
<li><a href='#antidepressant'><p>Sample data: antidepressant trial</p></a></li>
<li><a href='#asthma'><p>Sample data: asthma trial</p></a></li>
<li><a href='#RefBasedMI'><p>Reference-based multiple imputation of longitudinal data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Reference-Based Imputation for Longitudinal Clinical Trials with
Protocol Deviation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Imputation of missing numerical outcomes for a longitudinal trial 
    with protocol deviations.
    The package uses distinct treatment arm-based assumptions for the unobserved data, following 
    the general algorithm of Carpenter, Roger, and Kenward (2013) &lt;<a href="https://doi.org/10.1080%2F10543406.2013.834911">doi:10.1080/10543406.2013.834911</a>&gt;, and the causal model
    of White, Royes and Best (2020) &lt;<a href="https://doi.org/10.1080%2F10543406.2019.1684308">doi:10.1080/10543406.2019.1684308</a>&gt;.
    Sensitivity analyses to departures from these assumptions can be done by the 
    Delta method of Roger.
    The program uses the same algorithm as the 'mimix' 'Stata' package written by Suzie Cro, 
    with additional coding for the causal model and delta method.
    The reference-based methods are jump to reference (J2R), 
    copy increments in reference (CIR), copy reference (CR),
    and the causal model, all of which must specify the reference treatment arm.
    Other methods are
    missing at random (MAR) and the last mean carried forward (LMCF). 
    Individual-specific imputation methods
    (and their reference groups) can be specified.  </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/UCL/RefBasedMI">https://github.com/UCL/RefBasedMI</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, Hmisc, mice, pastecs, assertthat</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-04 10:17:04 UTC; rmjlmqu</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin McGrath [aut],
  Matteo Quartagno [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matteo Quartagno &lt;m.quartagno@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-09 09:10:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='acupuncture'>Sample data: acupuncture trial</h2><span id='topic+acupuncture'></span>

<h3>Description</h3>

<p>A data set containing results of a randomised, double-blind, parallel-group
comparing active treatment with placebo
The primary outcome is head, measured at time 3 and 12
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acupuncture
</code></pre>


<h3>Format</h3>

<p>A data frame with 802 rows and 11 columns
</p>

<dl>
<dt>id</dt><dd></dd>
<dt>time</dt><dd></dd>
<dt>age</dt><dd></dd>
<dt>sex</dt><dd></dd>
<dt>migraine</dt><dd></dd>
<dt>chronicity</dt><dd></dd>
<dt>practice_id</dt><dd></dd>
<dt>treat</dt><dd></dd>
<dt>head_base</dt><dd><p>covariate</p>
</dd>
<dt>head</dt><dd><p>outcome variable</p>
</dd>
<dt>withdrawal_reason</dt><dd></dd>
</dl>


<hr>
<h2 id='antidepressant'>Sample data: antidepressant trial</h2><span id='topic+antidepressant'></span>

<h3>Description</h3>

<p>A data set containing antidepressant trial data as described in paper
by White,Royes,Best (2019)
The primary outcome is HAMD17.TOTAL measured at visit number 4,5,6,7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>antidepressant
</code></pre>


<h3>Format</h3>

<p>dataframe containing 688 rows and 14 columns
</p>

<dl>
<dt>PATIENT.NUMBER</dt><dd></dd>
<dt>HAMA.TOTAL</dt><dd></dd>
<dt>PGI_IMPROVEMENT</dt><dd></dd>
<dt>VISIT...VISIT.3.DATE</dt><dd></dd>
<dt>VISIT.NUMBER</dt><dd></dd>
<dt>TREATMENT.NAME</dt><dd></dd>
<dt>PATIENT.SEX</dt><dd></dd>
<dt>POOLED.INVESTIGATOR</dt><dd></dd>
<dt>basval</dt><dd></dd>
<dt>HAMD17.TOTAL</dt><dd><p>outcome variable</p>
</dd>
<dt>change</dt><dd></dd>
<dt>miss_flag</dt><dd></dd>
<dt>methodcol</dt><dd><p>individual-specific method</p>
</dd>
<dt>referencecol</dt><dd><p>individual-specific reference arm</p>
</dd>
</dl>


<hr>
<h2 id='asthma'>Sample data: asthma trial</h2><span id='topic+asthma'></span>

<h3>Description</h3>

<p>A data set containing  asthma trial data as used in the Stata mimix help file
The primary outcome variable is fev, measured at 2,4,8,12 weeks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asthma
</code></pre>


<h3>Format</h3>

<p>A data frame containing 732 rows and 5 columns
</p>

<dl>
<dt>id</dt><dd><p>patient identifier</p>
</dd>
<dt>time</dt><dd></dd>
<dt>treat</dt><dd></dd>
<dt>base</dt><dd><p>covariate</p>
</dd>
<dt>fev</dt><dd><p>outcome variable</p>
</dd>
</dl>


<hr>
<h2 id='RefBasedMI'>Reference-based multiple imputation of longitudinal data</h2><span id='topic+RefBasedMI'></span>

<h3>Description</h3>

<p>Performs reference-based multiple imputation of longitudinal data where data are missing after treatment discontinuation. Methods available are missing at random, jump to reference, copy reference, copy increments in reference, last mean carried forward, the causal model, and delta-adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RefBasedMI(
  data,
  covar = NULL,
  depvar,
  treatvar,
  idvar,
  timevar,
  method = NULL,
  reference = NULL,
  methodvar = NULL,
  referencevar = NULL,
  K0 = NULL,
  K1 = NULL,
  delta = NULL,
  dlag = NULL,
  M = 1,
  seed = 101,
  prior = "jeffreys",
  burnin = 1000,
  bbetween = NULL,
  mle = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RefBasedMI_+3A_data">data</code></td>
<td>
<p>Dataset in long format</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_covar">covar</code></td>
<td>
<p>Baseline covariate(s): must be complete (no missing values)</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_depvar">depvar</code></td>
<td>
<p>Outcome variable</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_treatvar">treatvar</code></td>
<td>
<p>Treatment group variable: can be numeric or character</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_idvar">idvar</code></td>
<td>
<p>Participant identifiervariable</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_timevar">timevar</code></td>
<td>
<p>Variable indicating time point for repeated measures</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_method">method</code></td>
<td>
<p>Reference-based imputation method: must be &quot;J2R&quot;, &quot;CR&quot;, &quot;CIR&quot;, &quot;MAR&quot;, &quot;Causal&quot; or &quot;LMCF&quot;</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_reference">reference</code></td>
<td>
<p>Reference group for &quot;J2R&quot;, &quot;CIR&quot;, &quot;CR&quot; methods, or control group for causal method: can be numeric or string</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_methodvar">methodvar</code></td>
<td>
<p>Variable in dataset specifying individual method</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_referencevar">referencevar</code></td>
<td>
<p>Variable in dataset specifying reference group for individual method</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_k0">K0</code></td>
<td>
<p>Causal constant for use with Causal method</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_k1">K1</code></td>
<td>
<p>Exponential decaying causal constant for use with Causal method</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_delta">delta</code></td>
<td>
<p>Optional vector of delta values to add onto imputed values (non-mandatory) (a's in Five_Macros user guide), length equal to number of time points</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_dlag">dlag</code></td>
<td>
<p>Optional vector of delta values to add onto imputed values (non-mandatory) (b's in Five_Macros user guide), length equal to number of time points</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_m">M</code></td>
<td>
<p>Number of imputations to be created</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_seed">seed</code></td>
<td>
<p>Seed value: specify this so that a new run of the command will give the same imputed values</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_prior">prior</code></td>
<td>
<p>Prior when fitting multivariate normal distributions: can be one of &quot;jeffreys&quot; (default), &quot;uniform&quot; or &quot;ridge&quot;</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_burnin">burnin</code></td>
<td>
<p>Number of burn-in iterations when fitting multivariate normal distributions</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_bbetween">bbetween</code></td>
<td>
<p>Number of iterations between imputed data sets when fitting multivariate normal distributions</p>
</td></tr>
<tr><td><code id="RefBasedMI_+3A_mle">mle</code></td>
<td>
<p>Use with extreme caution: do improper imputation by drawing from the model using the maximum likelihood estimates. This does not allow for uncertainty in the MLEs and invalidates interval estimates from Rubin's rules.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The program works through the following steps:
</p>

<ol>
<li><p> Set up a summary table based on treatment arm and missing data pattern
(i.e. which timepoints are unobserved)
</p>
</li>
<li><p> Fit a multivariate normal distribution to each treatment arm using MCMC methods in package norm2
</p>
</li>
<li><p> Impute all interim missing values under a MAR assumption, looping over treatments and patterns
</p>
</li>
<li><p> Impute all post-discontinuation missing values under the user-specified assumption,
looping over treatments and patterns (and over methodvar and referencevar if specified)
</p>
</li>
<li><p> Perform delta-adjustment if specified
</p>
</li>
<li><p> Repeat steps 2-5 M times and form into a single data frame
</p>
</li></ol>

<p>The baseline value of the outcome could be handed as an outcome, but this would allow a treatment effect at baseline. We instead recommend handling it as a covariate.
</p>
<p>The program is based on Suzie Cro's Stata program mimix
</p>
<p>The user can use the as.mids() function in the mice package to convert the output data to mids data type and then perform analysis using Rubin's rules.
</p>


<h3>Value</h3>

<p>A data frame containing the original data stacked above the M imputed data sets. The original ID variable (idvar) is renamed as .id. A new variable .imp indicates the original data (.imp=0) or the imputed data sets (.imp=1,...,M).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Perform jump to reference imputation on asthma trial data, with reference arm 1 
asthmaJ2R &lt;- RefBasedMI(data=asthma, depvar=fev, treatvar=treat, 
 idvar=id, timevar=time, method="J2R", reference=1, M=5, seed=54321)
# Fit regression model to each imputed data set by treating output data frame as mids object
library(mice)
fit &lt;- with(data = as.mids(asthmaJ2R), lm(fev ~ factor(treat), subset=(time==12)))
# Find pooled treatment effects using Rubin's rules 
summary(pool(fit))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
