<!DOCTYPE html><html><head><title>Help for package growR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {growR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#growR-package'><p>growR: R implementation of the grass growth model ModVege.</p></a></li>
<li><a href='#*.FunctionalGroup'><p>Scalar multiplication of functional group (order matters: scalar * FG)</p></a></li>
<li><a href='#+.FunctionalGroup'><p>Addition of two functional groups</p></a></li>
<li><a href='#aCO2_inverse'><p>Concentration representative year</p></a></li>
<li><a href='#add_lines'><p>Add data to a ggplot</p></a></li>
<li><a href='#analyze_parameter_scan'><p>Analyze results of a parameter scan</p></a></li>
<li><a href='#append_to_table'><p>Write *data* to supplied file in append mode without generating a warning</p>
message.</a></li>
<li><a href='#atmospheric_CO2'><p>Atmospheric CO2 concentration</p></a></li>
<li><a href='#autocut'><p>autocut</p></a></li>
<li><a href='#box_smooth'><p>Endpoint smoother</p></a></li>
<li><a href='#browse'><p>Debugging utilities</p></a></li>
<li><a href='#build_functional_group'><p>Build the effective functional group as a weighted linear combination.</p></a></li>
<li><a href='#check_for_package'><p>Check if *package* is available</p></a></li>
<li><a href='#Combinator'><p>Combinator</p></a></li>
<li><a href='#compare.R'><p>Compare simulation results</p></a></li>
<li><a href='#create_combinations'><p>Create Valid Combinations</p></a></li>
<li><a href='#create_example_environment'><p>Provide an example ModvegeEnvironment</p></a></li>
<li><a href='#ensure_table_columns'><p>Check if supplied table contains all *required* variables.</p></a></li>
<li><a href='#ensure_unique_filename'><p>Replace given filename by a version that contains an incremental number</p>
in order to prevent overwriting existing files.</a></li>
<li><a href='#fCO2_growth_mod'><p>CO2 growth modifier</p></a></li>
<li><a href='#fCO2_transpiration_mod'><p>CO2 transpiration modifier</p></a></li>
<li><a href='#FG_A'><p>Functional group A</p></a></li>
<li><a href='#FG_B'><p>Functional group B</p></a></li>
<li><a href='#FG_C'><p>Functional group C</p></a></li>
<li><a href='#FG_D'><p>Functional group D</p></a></li>
<li><a href='#fPAR'><p>Radiation limitation</p></a></li>
<li><a href='#fT'><p>Temperature limitation</p></a></li>
<li><a href='#FunctionalGroup'><p>Representation of a grassland plant population</p></a></li>
<li><a href='#fW'><p>Water stress</p></a></li>
<li><a href='#get_annual_gross_yield'><p>Lookup table returning expected annual gross yields as function of</p>
elevation and management intensity.</a></li>
<li><a href='#get_bias'><p>Metric Functions</p></a></li>
<li><a href='#get_end_of_cutting_season'><p>Last day of cutting season</p></a></li>
<li><a href='#get_expected_n_cuts'><p>Get number of expected cuts</p></a></li>
<li><a href='#get_relative_cut_contribution'><p>Relative cut contribution</p></a></li>
<li><a href='#get_site_name'><p>Extract the name of a site from a filename</p></a></li>
<li><a href='#growR_package_options'><p>Default options introduced by package growR</p></a></li>
<li><a href='#growR_run_loop'><p>Run growR simulations</p></a></li>
<li><a href='#load_measured_data'><p>Load experimental data</p></a></li>
<li><a href='#logger'><p>Primitive logger for debugging.</p></a></li>
<li><a href='#make_yearDOY'><p>Create unique DOY + year identifier</p></a></li>
<li><a href='#management_parameters'><p>Management practices for Swiss grasslands</p></a></li>
<li><a href='#ManagementData'><p>Management Data Class</p></a></li>
<li><a href='#metric_map'><p>List of Performance Metrics</p></a></li>
<li><a href='#ModvegeEnvironment'><p>growR environment data</p></a></li>
<li><a href='#ModvegeParameters'><p>Parameter Data Object</p></a></li>
<li><a href='#ModvegeSite'><p>ModvegeSite</p></a></li>
<li><a href='#parameter_scan_example'><p>Example results of a parameter scan</p></a></li>
<li><a href='#parse_year_strings'><p>Parse and generate lists of years.</p></a></li>
<li><a href='#plot_parameter_scan'><p>Plot Parameter Scan Results</p></a></li>
<li><a href='#plot.ModvegeSite'><p>Plot ModVege simulation result overview</p></a></li>
<li><a href='#posieux_weather'><p>Example Weather Data</p></a></li>
<li><a href='#PscanPlotter'><p>Plot Parameter Scan Results</p></a></li>
<li><a href='#read_config'><p>Read simulation run configurations from file</p></a></li>
<li><a href='#run_parameter_scan'><p>Parameter Scan</p></a></li>
<li><a href='#SEA'><p>Seasonal effect on growth</p></a></li>
<li><a href='#set_growR_verbosity'><p>Set verbosity of growR output.</p></a></li>
<li><a href='#setup_directory'><p>Initialize growR directory structure</p></a></li>
<li><a href='#WeatherData'><p>Weather Data Object</p></a></li>
<li><a href='#willmott'><p>Willmott Index</p></a></li>
<li><a href='#yield_parameters'><p>Parameters for expected yields in Switzerland</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Implementation of the Vegetation Model ModVege</td>
</tr>
<tr>
<td>Description:</td>
<td>Run grass growth simulations using a grass growth model based 
    on ModVege (Jouven, M., P. Carrère, and R. Baumont "Model Predicting 
    Dynamics of Biomass, Structure and Digestibility of Herbage in Managed 
    Permanent Pastures. 1. Model Description." (2006) 
    &lt;<a href="https://doi.org/10.1111%2Fj.1365-2494.2006.00515.x">doi:10.1111/j.1365-2494.2006.00515.x</a>&gt;). The implementation in
    this package contains a few additions to the above cited version of ModVege,
    such as simulations of management decisions, and influences of snow cover.
    As such, the model is fit to simulate grass growth in mountainous 
    regions, such as the Swiss Alps. The package also contains routines for 
    calibrating the model and helpful tools for analysing model outputs and 
    performance.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kuadrat/growR">https://github.com/kuadrat/growR</a>, <a href="https://kuadrat.github.io/growR/">https://kuadrat.github.io/growR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kuadrat/growR/issues">https://github.com/kuadrat/growR/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, R6, utils, Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, patchwork, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>setup, pscan, run</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-14 15:13:40 UTC; kevin</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Kramer <a href="https://orcid.org/0000-0001-5523-6924"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Kramer &lt;kevin.pasqual.kramer@protonmail.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-14 23:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='growR-package'>growR: R implementation of the grass growth model ModVege.</h2><span id='topic+growR'></span><span id='topic+growR-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Run grass growth simulations using a grass growth model based on ModVege (Jouven, M., P. Carrère, and R. Baumont &quot;Model Predicting Dynamics of Biomass, Structure and Digestibility of Herbage in Managed Permanent Pastures. 1. Model Description.&quot; (2006) <a href="https://doi.org/10.1111/j.1365-2494.2006.00515.x">doi:10.1111/j.1365-2494.2006.00515.x</a>). The implementation in this package contains a few additions to the above cited version of ModVege, such as simulations of management decisions, and influences of snow cover. As such, the model is fit to simulate grass growth in mountainous regions, such as the Swiss Alps. The package also contains routines for calibrating the model and helpful tools for analysing model outputs and performance.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kevin Kramer <a href="mailto:kevin.pasqual.kramer@protonmail.ch">kevin.pasqual.kramer@protonmail.ch</a> (<a href="https://orcid.org/0000-0001-5523-6924">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/kuadrat/growR">https://github.com/kuadrat/growR</a>
</p>
</li>
<li> <p><a href="https://kuadrat.github.io/growR/">https://kuadrat.github.io/growR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/kuadrat/growR/issues">https://github.com/kuadrat/growR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+2A.FunctionalGroup'>Scalar multiplication of functional group (order matters: scalar * FG)</h2><span id='topic++2A.FunctionalGroup'></span>

<h3>Description</h3>

<p>Scalar multiplication of functional group (order matters: scalar * FG)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FunctionalGroup'
scalar * fg
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B2A.FunctionalGroup_+3A_scalar">scalar</code></td>
<td>
<p>float to multiply all FG parameters with.</p>
</td></tr>
<tr><td><code id="+2B2A.FunctionalGroup_+3A_fg">fg</code></td>
<td>
<p>Functional group whose parameters are to be multiplied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>C A <a href="#topic+FunctionalGroup">FunctionalGroup</a> object that has all its values multiplied by
<em>scalar</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fg = FunctionalGroup$new()
3.1 * fg
0 * fg
</code></pre>

<hr>
<h2 id='+2B.FunctionalGroup'>Addition of two functional groups</h2><span id='topic++2B.FunctionalGroup'></span>

<h3>Description</h3>

<p>Addition occurs by adding all FG parameters separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FunctionalGroup'
A + B
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B2B.FunctionalGroup_+3A_a">A</code></td>
<td>
<p>First functional group.</p>
</td></tr>
<tr><td><code id="+2B2B.FunctionalGroup_+3A_b">B</code></td>
<td>
<p>Second functional group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>C A <a href="#topic+FunctionalGroup">FunctionalGroup</a> object where each value is the sum of the
respective values in <em>A</em> and <em>B</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fg1 = FunctionalGroup$new()
fg2 = FunctionalGroup$new(SLA = 0.02)
fg1 + fg2

</code></pre>

<hr>
<h2 id='aCO2_inverse'>Concentration representative year</h2><span id='topic+aCO2_inverse'></span>

<h3>Description</h3>

<p>Inverse of 'atmospheric_CO2': retrieve the year by which a given CO2 
concentration is reached.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aCO2_inverse(aCO2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aCO2_inverse_+3A_aco2">aCO2</code></td>
<td>
<p>Target CO2 concentration in ppm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Does not give a reasonable result for values below 317ppm, corresponding 
to the year 1949, as this is where the minimum of the parabola is located 
in the second order fit to the data that was used in aCO2.fct.
</p>


<h3>Value</h3>

<p>year Approximate year (as floating point number) by which target 
concentration is reached.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>aCO2_inverse(420)
aCO2_inverse(700)
# Insensible
aCO2_inverse(100)

</code></pre>

<hr>
<h2 id='add_lines'>Add data to a ggplot</h2><span id='topic+add_lines'></span>

<h3>Description</h3>

<p>Add a lineplot of the *x_key* and *y_key* columns in *data* to the 
supplied ggplot object *ax*. If none is supplied, a new one is created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_lines(
  data,
  ax = NULL,
  y_key = "dBM_smooth",
  x_key = "DOY",
  style = "line",
  label = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_lines_+3A_data">data</code></td>
<td>
<p>data.frame or similar object interpretable by ggplot.</p>
</td></tr>
<tr><td><code id="add_lines_+3A_ax">ax</code></td>
<td>
<p>list as returned by ggplot() and related functions.</p>
</td></tr>
<tr><td><code id="add_lines_+3A_x_key">x_key</code>, <code id="add_lines_+3A_y_key">y_key</code></td>
<td>
<p>Column names in *data* to be plotted.</p>
</td></tr>
<tr><td><code id="add_lines_+3A_style">style</code></td>
<td>
<p>XXX in ggplot geom_XXX to use.</p>
</td></tr>
<tr><td><code id="add_lines_+3A_label">label</code></td>
<td>
<p>Codename for this line to be used in legend creation. If 
NULL, use *y_key*.</p>
</td></tr>
<tr><td><code id="add_lines_+3A_...">...</code></td>
<td>
<p>All further arguments are passed to the selected ggplot geom.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ax A ggplot list (like the input *ax*).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
# Add first set of data
ax = add_lines(mtcars, x_key = "wt", y_key = "mpg", label = "First Line")

# Add one more line to the plot
ax = add_lines(mtcars, ax = ax, x_key = "wt", y_key = "qsec", 
label = "Second Line")

print(ax)
</code></pre>

<hr>
<h2 id='analyze_parameter_scan'>Analyze results of a parameter scan</h2><span id='topic+analyze_parameter_scan'></span>

<h3>Description</h3>

<p>Analyze results of a parameter scan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze_parameter_scan(
  parameter_scan_results,
  datafile = "",
  smooth_interval = 28
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze_parameter_scan_+3A_parameter_scan_results">parameter_scan_results</code></td>
<td>
<p>String or List. If a string, it is
interpreted as the name of a <code>rds</code> file that contains the results of a
parameter scan which is then loaded using <code><a href="base.html#topic+readRDS">readRDS()</a></code>. Otherwise, it
should be the output of <code><a href="#topic+run_parameter_scan">run_parameter_scan()</a></code> directly.</p>
</td></tr>
<tr><td><code id="analyze_parameter_scan_+3A_datafile">datafile</code></td>
<td>
<p>Name or path to a file containing measured data. The model
results in <em>parameter_scan_results</em> are compared to the data therein. If
empty, the site is inferred from the <a href="#topic+ModvegeSite">ModvegeSite</a> objects in
<em>parameter_scan_results</em> and a corresponding data file is searched for
in 'getOption(&quot;growR.data_dir&quot;, default = &quot;data&quot;).</p>
</td></tr>
<tr><td><code id="analyze_parameter_scan_+3A_smooth_interval">smooth_interval</code></td>
<td>
<p>Int. Number of days over which the variable <code>dBM</code>
is smoothened. Should be set to make experimental data and simulated
data to be as comparable as possible.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>analyzed A list with five keys: <code>dBM</code>, <code>cBM</code>, <code>cBM_end</code>, <code>metrics</code>
and <code>params</code>.
</p>

<dl>
<dt>dBM</dt><dd><p>A data.frame with <code>1 + n_params + n_metrics</code> columns
where each row represents a different parameter combination.
The first column (<code>n</code>) gives the row number and is used to identify a
parameter combination. The subsequent <code>n_params</code> columns give the
values of the parameters used in this combination. The final <code>n_metrics</code>
columns give the resulting performance score of the model run with
these parameters for each metric applied to model variable <code>dBM</code>.</p>
</dd>
<dt>cBM</dt><dd><p>A data.frame of same format as for the key <em>dBM</em>. The first
<code>n_params + 1</code> columns are identical to the data.frame in <em>dBM</em>. The
difference is that the final <code>n_metrics</code> columns give performance
scores with respect to the model variable <code>cBM</code>.</p>
</dd>
<dt>cBM_end</dt><dd><p>A data.frame analogous to <em>dBM</em> and <em>cBM</em>, only this time
the last <code>n_metrics</code> columns give performance scores with respect to
the variable <code>cBM_end</code>, which is the final value of <code>cBM</code>, i.e. the
cumulative grown biomass at the end of the year.</p>
</dd>
<dt>params</dt><dd><p>A vector containing the names of the scanned parameters.
These are also the column names of columns <code>2:(n_params+1)</code> in
<em>results</em>.</p>
</dd>
<dt>metrics</dt><dd><p>A vector containing the names of the employed
performance metrics. These are also the column names of the last
<code>n_metrics</code> columns in <em>results</em>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+run_parameter_scan">run_parameter_scan()</a></code>, <code><a href="base.html#topic+readRDS">readRDS()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># There needs to be data available with which the model is to be compared.
# For this example, use data provided by the package.
path = system.file("extdata", package = "growR")
datafile = file.path(path, "posieux1.csv")

# We also use example parameter scan data provided by the package.
# In the real world, you would generally create your own data using 
# `run_parameter_scan()`.
analyze_parameter_scan(parameter_scan_example, datafile = datafile)

</code></pre>

<hr>
<h2 id='append_to_table'>Write *data* to supplied file in append mode without generating a warning 
message.</h2><span id='topic+append_to_table'></span>

<h3>Description</h3>

<p>This function essentially wraps 'write.table' with a calling handler that
suppresses appending warnings that would appear with the argument 
'col.names = TRUE'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append_to_table(data, filename, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="append_to_table_+3A_data">data</code></td>
<td>
<p>Any object which can be handled by 'write.table'.</p>
</td></tr>
<tr><td><code id="append_to_table_+3A_filename">filename</code></td>
<td>
<p>Name of file to append to.</p>
</td></tr>
<tr><td><code id="append_to_table_+3A_...">...</code></td>
<td>
<p>All additional arguments are passed to 'write.table'.</p>
</td></tr>
</table>

<hr>
<h2 id='atmospheric_CO2'>Atmospheric CO2 concentration</h2><span id='topic+atmospheric_CO2'></span>

<h3>Description</h3>

<p>Retrieve CO2 concentration (in ppm) for given calendar year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atmospheric_CO2(year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atmospheric_CO2_+3A_year">year</code></td>
<td>
<p>Calender year for which to extract CO2 concentration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function defines the CO2 concentration as a function of calendar
year. it is based on a polynomial fit to the annual CO2 data
published by NOAA
&lt;https://gml.noaa.gov/webdata/ccgg/trends/co2/co2_annmean_gl.txt&gt;
</p>


<h3>Value</h3>

<p>Approximate CO2 concentration in ppm for given year.
</p>


<h3>Note</h3>

<p>This is only approximately valid for years in the range 1949 - 2020
</p>


<h3>Examples</h3>

<pre><code class='language-R'>atmospheric_CO2(1990)
atmospheric_CO2(2020)
# Insensible
atmospheric_CO2(1800)

</code></pre>

<hr>
<h2 id='autocut'>autocut</h2><span id='topic+autocut'></span>

<h3>Description</h3>

<p>Simulation routine to realistically predict grass cutting events.
This follows an implementation described in Petersen et al. (2021).
</p>
<p>The decision to cut is made based on two criteria.
First, it is checked whether a *target biomass* is reached on given 
DOY. The defined target depends on the DOY and is given through 
:func:'get_target_biomass'. If said biomass is present, return 'TRUE'.
</p>
<p>Otherwise, it is checked whether a given amount of time has passed 
since the last cut. Depending on whether this is the first cut of 
the season or not, the relevant parameters are 
:int:'last_DOY_for_initial_cut' and :int:'max_cut_period'.
If that amount of time has passed, return 'TRUE', otherwise return 
'FALSE'.
</p>
<p>The target biomass for a given day is determined following the principles 
described in Petersen et al.
</p>
<p>The exact regression for the target biomass is based on Fig. S2 in the 
supplementary material of Petersen et al.
</p>
<p>A refinement to expected yield as function of altitude has been 
implemented according to Table 1a in Huguenen et al. (2017).
</p>


<h3>References</h3>

<p>Petersen K, Kraus D, Calanca P, Semenov MA, Butterbach-Bahl K, Kiese R (2021).
&ldquo;Dynamic Simulation of Management Events for Assessing Impacts of Climate Change on Pre-Alpine Grassland Productivity.&rdquo;
<em>European Journal of Agronomy</em>, <b>128</b>, 126306.
ISSN 1161-0301, <a href="https://doi.org/10.1016/j.eja.2021.126306">doi:10.1016/j.eja.2021.126306</a>, <a href="https://www.sciencedirect.com/science/article/pii/S1161030121000782">https://www.sciencedirect.com/science/article/pii/S1161030121000782</a>.
</p>
<p>Huguenin-Elie IEMPSALWK, Jeangros B (2017).
&ldquo;Grundlagen für die Düngung landwirtschaftlicher Kulturen in der Schweiz (GRUD), Kapitel 9: Düngung von Grasland.&rdquo;
<em>Agrarforschung Schweiz</em>.
<a href="https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/">https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/</a>.
</p>

<hr>
<h2 id='box_smooth'>Endpoint smoother</h2><span id='topic+box_smooth'></span>

<h3>Description</h3>

<p>Smooth data in vector <em>x</em> to its endpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>box_smooth(x, box_width = 28)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="box_smooth_+3A_x">x</code></td>
<td>
<p>1D data to be smoothed.</p>
</td></tr>
<tr><td><code id="box_smooth_+3A_box_width">box_width</code></td>
<td>
<p>Width (in units of vector steps) of the box used for
smoothing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Employ an endpoint box filter (aka &quot;running mean&quot; or endpoint smoother) to the
1-D data in <em>x</em>:
</p>
<div class="sourceCode"><pre>x_smoothed[i] = mean(x[i-box_width:i])
</pre></div>
<p>Where <em>x</em> is considered to be <em>zero-padded</em> vor values of <em>i-box_width</em> &lt; 1.
</p>


<h3>Value</h3>

<p>x_smooth Smoothened version of <em>x</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a sine wave with noise
x = seq(0, 4*pi, 0.1)
y = sin(x) + runif(length(x))
# Apply endpoint smoothing
y_smooth = box_smooth(y, box_width = 5)

</code></pre>

<hr>
<h2 id='browse'>Debugging utilities</h2><span id='topic+browse'></span><span id='topic+browse_end'></span>

<h3>Description</h3>

<p>Debug specified function <em>func</em> by entering a <code><a href="base.html#topic+browser">browser()</a></code> right at the
beginning (<code><a href="#topic+browse">browse()</a></code>) or end (<code><a href="#topic+browse_end">browse_end()</a></code>) of the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>browse(func, ...)

browse_end(func, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="browse_+3A_func">func</code></td>
<td>
<p>An R function to be browsed.</p>
</td></tr>
<tr><td><code id="browse_+3A_...">...</code></td>
<td>
<p>Arguments to the function <em>func</em> that is to be browsed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are convenience shorthands for R's builtin debug tools, like
<code><a href="base.html#topic+debugonce">debugonce()</a></code> and the <code><a href="base.html#topic+trace">trace()</a></code>/<code><a href="base.html#topic+untrace">untrace()</a></code> combination.
</p>


<h3>Value</h3>

<p>Returns the result of <code>func(...)</code>. Enters a <code><a href="base.html#topic+browser">browser()</a></code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>browse_end()</code>: Enter <code><a href="base.html#topic+browser">browser()</a></code> at the end of the function call to <code>func(...)</code>. This
only works, if the function can execute without error until its end.
Otherwise, the error will be thrown.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="base.html#topic+browser">browser()</a></code>, <code><a href="base.html#topic+debugonce">debugonce()</a></code>, <code><a href="base.html#topic+trace">trace()</a></code>
</p>
<p><code><a href="base.html#topic+trace">trace()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Define a simple function for this example
my_func = function(a) { for (i in 1:5) { a = a + i }; return(a) }

# Enter a browser at the beginning of the function
browse(my_func, 0)

# Enter a browser at the end of the function. This allows us to inspect 
# the function's local variables without having to go through the whole loop.
browse_end(my_func, 0)

</code></pre>

<hr>
<h2 id='build_functional_group'>Build the effective functional group as a weighted linear combination.</h2><span id='topic+build_functional_group'></span>

<h3>Description</h3>

<p>Uses the weights found in :param:<code>P</code> to construct the effective functional
groups and updates functional group parameters in P.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_functional_group(P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_functional_group_+3A_p">P</code></td>
<td>
<p>list; name-value pairs of parameters. Should contain at least one
non-zero functional group weight w_FGX with X in (A, B, C, D). Any
weights not present are assumed to be 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+FunctionalGroup">FunctionalGroup</a> object composed of a linear combination of the
four groups <em>FG_A</em>, <em>FG_B</em>, <em>FG_C</em> and <em>FG_D</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+FunctionalGroup">FunctionalGroup</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parameters = list(w_FGA = 0.5, w_FGB = 0.5)
build_functional_group(parameters)

# The w_FGX weights in the input are interpreted as relative to each other.
# Thus, they do not need to satisfy the sum rule. The following is 
# equivalent to the previous example:
parameters = list(w_FGA = 1, w_FGB = 1)
build_functional_group(parameters)

</code></pre>

<hr>
<h2 id='check_for_package'>Check if *package* is available</h2><span id='topic+check_for_package'></span>

<h3>Description</h3>

<p>Some functions not pertaining to the package core require additional 
libraries. These libraries are listed as *suggested* in the 'DESCRIPTION' 
When such a function is called by a user who does not have the respective 
libraries installed, we should notice that and notify the user. This is the 
purpose of this *function* 'check_for_package'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_for_package(package, stop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_for_package_+3A_package">package</code></td>
<td>
<p>Name of the package to check for.</p>
</td></tr>
<tr><td><code id="check_for_package_+3A_stop">stop</code></td>
<td>
<p>Toggle whether an error should be thrown ('TRUE') or a warning 
generated ('FALSE').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function checks if *package* is installed and loaded. If not, it 
either produces a warning or throws an error, depending on the value of 
*stop*.
</p>


<h3>Value</h3>

<p>&lsquo;TRUE' if the package was found. 'FALSE' if it wasn&rsquo;t found and 
*stop* is 'FALSE'. Otherwise, an error will be thrown.
</p>

<hr>
<h2 id='Combinator'>Combinator</h2><span id='topic+Combinator'></span>

<h3>Description</h3>

<p>Helps to find all possible combinations for a given set of values.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>combinations</code></dt><dd><p>list Once run, holds all valid parameter combinations
as named lists.</p>
</dd>
<dt><code>eps</code></dt><dd><p>float Numerical precision to require when checking the
functional group weight sum criterion.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Combinator-create_combinations"><code>Combinator$create_combinations()</code></a>
</p>
</li>
<li> <p><a href="#method-Combinator-clone"><code>Combinator$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Combinator-create_combinations"></a>



<h4>Method <code>create_combinations()</code></h4>

<p>Find possible combinations
</p>


<h5>Usage</h5>

<div class="r"><pre>Combinator$create_combinations(param_values)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param_values</code></dt><dd><p>A list giving all options for the parameter values
which are to be combined. As an example:
</p>
<div class="sourceCode"><pre>list(w_FGA = c(0, 0.5, 1), w_FGB = c(0, 0.5, 1), NI = c(0.5, 0.9))
</pre></div>
<p>This would generate the combinations</p>

<table>
<tr>
 <td style="text-align: left;">
   w_FGA </td><td style="text-align: left;"> w_FGB </td><td style="text-align: left;"> NI </td>
</tr>
<tr>
 <td style="text-align: left;">
   0 </td><td style="text-align: left;"> 1 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0 </td><td style="text-align: left;"> 1 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0.5 </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0.5 </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> 0 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> 0 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</dd>
<dt><code>eps</code></dt><dd><p>Precision to be used when checking if the sum citerion of the
functional groups (w_FGA + w_FGB + w_FGC + w_FGD = 1) is fulfilled.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>combinations A list containing vectors of parameter value
combinations.
</p>


<hr>
<a id="method-Combinator-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Combinator$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p><code><a href="#topic+create_combinations">create_combinations()</a></code>
</p>

<hr>
<h2 id='compare.R'>Compare simulation results</h2><span id='topic+compare.R'></span>

<h3>Description</h3>

<p>The script <code>compare.R</code> which ships with the growR package and is 
automatically put into the working directory with 
<a href="#topic+setup_directory">setup_directory()</a> 
can be used to compare results of growR simulation runs.
</p>
<p>It is a simple script, so it can and should be adjusted to your personal needs.
</p>


<h3>Details</h3>

<p>The script makes use of the packages ggplot2, patchwork and some growR 
functions which facilitate data loading and plotting, like 
<a href="#topic+load_measured_data">load_measured_data()</a> and 
<a href="#topic+add_lines">add_lines()</a>.
</p>

<hr>
<h2 id='create_combinations'>Create Valid Combinations</h2><span id='topic+create_combinations'></span>

<h3>Description</h3>

<p>Generate a list which contains all possible combinations of the provided
parameter values. This excludes combinations that are invalid because the
sum criterion for functional groups <code>w_FGA + w_FGB + w_FGC + w_FGD = 1</code> is
not fulfilled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_combinations(param_values, eps = 0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_combinations_+3A_param_values">param_values</code></td>
<td>
<p>A list giving all options for the parameter values
which are to be combined. The format is <code>list[[param_name]] =  param_values</code> where <code>param_values</code> is a vector with the values for the
respective parameter. The parameter names for functional group weights
(<code>w_FGX</code> with <code>X</code> in (A, B, C, D)) receive special treatment and
therefore need to be spelled correctly.</p>
</td></tr>
<tr><td><code id="create_combinations_+3A_eps">eps</code></td>
<td>
<p>Float specifying the precision to which the sum criterion for
functional group has to be satisfied. The criterion is considered
satisfied, if &ldquo;'
abs(w_FGA + w_FGB + w_FGC + w_FGD) - 1) &lt;= eps
</p>
<div class="sourceCode"></div></td></tr>
</table>


<h3>Details</h3>

<p>Assume for example the following list as argument <em>param_values</em>:
</p>
<div class="sourceCode"><pre>list(w_FGA = c(0, 0.5, 1), w_FGB = c(0, 0.5, 1), NI = c(0.5, 0.9))
</pre></div>
<p>This would generate the combinations</p>

<table>
<tr>
 <td style="text-align: left;">
   w_FGA </td><td style="text-align: left;"> w_FGB </td><td style="text-align: left;"> NI </td>
</tr>
<tr>
 <td style="text-align: left;">
   0 </td><td style="text-align: left;"> 1 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0 </td><td style="text-align: left;"> 1 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0.5 </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   0.5 </td><td style="text-align: left;"> 0.5 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> 0 </td><td style="text-align: left;"> 0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   1 </td><td style="text-align: left;"> 0 </td><td style="text-align: left;"> 0.9 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>One can see that the input <em>param_values</em> has to be set up carefully: one
has to ensure that the given <code>w_FGX</code> values <em>can</em> actually add up to 1. The
following would be a bad counterexample, where only one single valid
combination is found, even though many values for <code>w_FGA</code> and <code>w_FGB</code> are
provided:
</p>
<div class="sourceCode"><pre>list(w_FGA = seq(0.5, 1, 0.01), w_FGB = c(0.5, 1, 0.01))
</pre></div>
<p>Similarly, if the steps in the <code>w_FGX</code> don't match, we might not end up
with many valid combinations, even though the ranges are reasonabl:
</p>
<div class="sourceCode"><pre>list(w_FGA = seq(0.5, 1, 0.1), w_FGB = c(0, 0.5, 0.25))
</pre></div>
<p>Here, no combination can be made with <code>w_FGA</code> in <code>c(0.6, 0.7, 0.8, 0.9)</code> or
<code>w_FGB = 0.25</code>.
</p>


<h3>Value</h3>

<p>combinations An unnamed list where every entry is a list
containing the parameter values (named as in the input <em>param_values</em>)
for a valid combination.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the parameter steps you want to explore. This is a minimal example.
# A more realistic one follows below.
param_values = list(w_FGA = c(0, 0.5, 1),
                    w_FGB = c(0, 0.5, 1),
                    NI = c(0.5, 0.9)
)
# Create all valid combinations of the defined steps
create_combinations(param_values)

# More realistic example for an initial exploration of parameter space, 
# where we suspect that functional groups A and B should be more prevalent 
# than C and D. This produces 54 parameter combinations, which is a number 
# of model evaluations that can run within a reasonable timeframe 
# (depending on your system).
param_values = list(w_FGA = seq(0, 1, 0.33),
                    w_FGB = seq(0, 1, 0.33),
                    w_FGC = seq(0, 0.7, 0.33),
                    w_FGD = seq(0, 0.7, 0.33),
                    NI = seq(0.5, 1.0, 0.25)
)
length(create_combinations(param_values))

# The default value for *eps* made sure that combinations of 0.33 + 0.66 = 
# 0.99 etc. are considered "valid". If we make *eps* too small, no valid 
# combinations can be found:
length(create_combinations(param_values, eps = 1e-3))

</code></pre>

<hr>
<h2 id='create_example_environment'>Provide an example ModvegeEnvironment</h2><span id='topic+create_example_environment'></span>

<h3>Description</h3>

<p>This is intended for testing and for the examples in the documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_example_environment(site = "posieux")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_example_environment_+3A_site">site</code></td>
<td>
<p>Choose for which example site an environment is to be created.
Options: <code>"posieux"</code>, <code>"sorens"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>E A <code style="white-space: pre;">&#8288;[ModvegeEnvironment]&#8288;</code> instance based on the example data for
<em>site</em> which is shipped with this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extdata = system.file("extdata", package = "growR") 
print(extdata)
list.files(extdata, recursive = TRUE)
create_example_environment()

</code></pre>

<hr>
<h2 id='ensure_table_columns'>Check if supplied table contains all *required* variables.</h2><span id='topic+ensure_table_columns'></span>

<h3>Description</h3>

<p>Logs an error if any variable is missing and lists the missing variables 
in the error message along with *data_name*.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensure_table_columns(required, data, data_name = "the data table")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensure_table_columns_+3A_required">required</code></td>
<td>
<p>List of names of required variables.</p>
</td></tr>
<tr><td><code id="ensure_table_columns_+3A_data">data</code></td>
<td>
<p>data.frame or similar object to be checked.</p>
</td></tr>
<tr><td><code id="ensure_table_columns_+3A_data_name">data_name</code></td>
<td>
<p>Name to be displayed in the error message if any variable 
is missing.</p>
</td></tr>
</table>

<hr>
<h2 id='ensure_unique_filename'>Replace given filename by a version that contains an incremental number 
in order to prevent overwriting existing files.</h2><span id='topic+ensure_unique_filename'></span>

<h3>Description</h3>

<p>Replace given filename by a version that contains an incremental number 
in order to prevent overwriting existing files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensure_unique_filename(path, add_num = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensure_unique_filename_+3A_path">path</code></td>
<td>
<p>string; Filename including path for which to check uniqueness.</p>
</td></tr>
<tr><td><code id="ensure_unique_filename_+3A_add_num">add_num</code></td>
<td>
<p>boolean; if TRUE, add the incremental number anyways, even 
if no filename conflict exists.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A unique filename.
</p>

<hr>
<h2 id='fCO2_growth_mod'>CO2 growth modifier</h2><span id='topic+fCO2_growth_mod'></span>

<h3>Description</h3>

<p>Function describing the effects of elevated CO2 on growth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCO2_growth_mod(c_CO2, b = 0.5, c_ref = 360)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fCO2_growth_mod_+3A_c_co2">c_CO2</code></td>
<td>
<p>numeric Atmospheric CO2 concentration in ppm</p>
</td></tr>
<tr><td><code id="fCO2_growth_mod_+3A_b">b</code></td>
<td>
<p>numeric Strength of CO2 effect on growth. Kellner et al. report
values bewtween 0 and 2 with the interval of highest likelihood
(0.1, 0.3). However, Soltani and Sinclair discuss that b = 0.4 in C4 plants
and b = 0.8 in C3 plants. The difference on the output of this function
of choosing a small (0.1) and large (0.8) value for b has an effect on
the result for an atmospheric concentration of 700 ppm of roughly 40
percent!.</p>
</td></tr>
<tr><td><code id="fCO2_growth_mod_+3A_c_ref">c_ref</code></td>
<td>
<p>numeric Reference CO2 concentration in ppm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function for the effects on growth is as proposed by Soltani et al (2012)
and later adapted by equation (5) in Kellner et al. (2017)
</p>


<h3>References</h3>

<p>Soltani A, Sinclair TR (2012).
<em>Modeling Physiology of Crop Development, Growth and Yield</em>.
CABI.
ISBN 978-1-84593-971-7, xnHT6YOlk00C.
</p>
<p>Kellner J, Multsch S, Houska T, Kraft P, Müller C, Breuer L (2017).
&ldquo;A Coupled Hydrological-Plant Growth Model for Simulating the Effect of Elevated CO2 on a Temperate Grassland.&rdquo;
<em>Agricultural and Forest Meteorology</em>, <b>246</b>, 42&ndash;50.
ISSN 0168-1923, <a href="https://doi.org/10.1016/j.agrformet.2017.05.017">doi:10.1016/j.agrformet.2017.05.017</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0168192317301831">https://www.sciencedirect.com/science/article/pii/S0168192317301831</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fCO2_growth_mod(420)
# The modifier is always relative to *c_ref*. This returns 1.
fCO2_growth_mod(420, c_ref = 420)

</code></pre>

<hr>
<h2 id='fCO2_transpiration_mod'>CO2 transpiration modifier</h2><span id='topic+fCO2_transpiration_mod'></span>

<h3>Description</h3>

<p>Function describing the effects of elevated CO2 on transpiration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCO2_transpiration_mod(c_CO2, c_ref = 360)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fCO2_transpiration_mod_+3A_c_co2">c_CO2</code></td>
<td>
<p>numeric Atmospheric CO2 concentration in ppm</p>
</td></tr>
<tr><td><code id="fCO2_transpiration_mod_+3A_c_ref">c_ref</code></td>
<td>
<p>numeric Reference CO2 concentration in ppm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function for the effect on transpiration is from equations (2-6) in
Kruijt et al.
</p>
<p>It appears in this paper that there is a small formal mistake in said
equations.
With the stated values, it is not possible to reproduce the tabulated
values of $c$ close to 1, as in their table 3. Instead, we conclude that
equation (4) should read:
</p>
<div class="sourceCode"><pre>  c = 1 + s_gs * s_T * F_T * deltaCO2
</pre></div>
<p>with the multiplicative terms giving small negative numbers.
The factors $s_gs$, $s_T$ and $F_T$ for grasslands are taken from pages
260 and 261 in Kruijt et al. where we averaged over the stated ranges to
get:
</p>
<div class="sourceCode"><pre>  c ~= 1 + 0.0001 * deltaCO2
</pre></div>


<h3>References</h3>

<p>Kruijt B, Witte JM, Jacobs CMJ, Kroon T (2008).
&ldquo;Effects of Rising Atmospheric CO2 on Evapotranspiration and Soil Moisture: A Practical Approach for the Netherlands.&rdquo;
<em>Journal of Hydrology</em>, <b>349</b>(3), 257&ndash;267.
ISSN 0022-1694, <a href="https://doi.org/10.1016/j.jhydrol.2007.10.052">doi:10.1016/j.jhydrol.2007.10.052</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0022169407006373">https://www.sciencedirect.com/science/article/pii/S0022169407006373</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fCO2_transpiration_mod(420)
# The modifier is always relative to *c_ref*. This returns 1.
fCO2_transpiration_mod(420, c_ref = 420)

</code></pre>

<hr>
<h2 id='FG_A'>Functional group A</h2><span id='topic+FG_A'></span>

<h3>Description</h3>

<p>Functional group A
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FG_A
</code></pre>


<h3>Format</h3>

<p>An object of class <code>FunctionalGroup</code> (inherits from <code>R6</code>) of length 23.
</p>


<h3>See Also</h3>

<p>[FunctionalGroup]
</p>

<hr>
<h2 id='FG_B'>Functional group B</h2><span id='topic+FG_B'></span>

<h3>Description</h3>

<p>Functional group B
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FG_B
</code></pre>


<h3>Format</h3>

<p>An object of class <code>FunctionalGroup</code> (inherits from <code>R6</code>) of length 23.
</p>


<h3>See Also</h3>

<p>[FunctionalGroup]
</p>

<hr>
<h2 id='FG_C'>Functional group C</h2><span id='topic+FG_C'></span>

<h3>Description</h3>

<p>Functional group C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FG_C
</code></pre>


<h3>Format</h3>

<p>An object of class <code>FunctionalGroup</code> (inherits from <code>R6</code>) of length 23.
</p>


<h3>See Also</h3>

<p>[FunctionalGroup]
</p>

<hr>
<h2 id='FG_D'>Functional group D</h2><span id='topic+FG_D'></span>

<h3>Description</h3>

<p>Functional group D
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FG_D
</code></pre>


<h3>Format</h3>

<p>An object of class <code>FunctionalGroup</code> (inherits from <code>R6</code>) of length 23.
</p>


<h3>See Also</h3>

<p>[FunctionalGroup]
</p>

<hr>
<h2 id='fPAR'>Radiation limitation</h2><span id='topic+fPAR'></span>

<h3>Description</h3>

<p>Threshold function representing growth limitation due to lack of 
photosynthetically active radiation (PAR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fPAR(PAR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fPAR_+3A_par">PAR</code></td>
<td>
<p>float Photosynthetically active radiation in MJ/m^2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value in the range [0, 1], acting as a multiplicative factor to 
plant growth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fPAR(4)

</code></pre>

<hr>
<h2 id='fT'>Temperature limitation</h2><span id='topic+fT'></span>

<h3>Description</h3>

<p>Threshold function representing growth limitation by temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fT(t, T0 = 4, T1 = 10, T2 = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fT_+3A_t">t</code></td>
<td>
<p>float Temperature in degree Celsius.</p>
</td></tr>
<tr><td><code id="fT_+3A_t0">T0</code></td>
<td>
<p>float Photosynthesis activation temperature in degree Celsius.</p>
</td></tr>
<tr><td><code id="fT_+3A_t1">T1</code></td>
<td>
<p>float Photosynthesis plateau temperature in degree Celsius.</p>
</td></tr>
<tr><td><code id="fT_+3A_t2">T2</code></td>
<td>
<p>float Photosynthesis max temperature in degree Celsius.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Photosynthesis is suppressed below <em>T0</em>, increases until it reaches its
maximum at temperatures in the interval (T1, T2). For temperatures exceeding
<em>T2</em>, photosynthetic activity decreases again until it reaches 0 at a
final temperature of 40 degree Celsius.
</p>


<h3>Value</h3>

<p>A value in the range (0, 1), acting as a multiplicative factor to
plant growth.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fT(4)
fT(10)
fT(15)

</code></pre>

<hr>
<h2 id='FunctionalGroup'>Representation of a grassland plant population</h2><span id='topic+FunctionalGroup'></span>

<h3>Description</h3>

<p>A functional group is a representation of a grassland plant population
with certain functional attributes.
</p>
<p>It contains many plant parameters that are collected under the hood of
functional groups. The class implements S3 style operator overloading such
that one can do things like
</p>
<div class="sourceCode"><pre>mixed_functional_group = 0.8 * FG_A + 0.2 * FG_B
</pre></div>


<h3>Public fields</h3>


<ul>
<li> <p><code>SLA</code> Specific Leaf Area in m^2^ per g.
</p>
</li>
<li> <p><code>pcLAM</code> Percentage of laminae (number between 0 and 1).
</p>
</li>
<li> <p><code>ST1</code> Temperature sum in degree Celsiues days after which the
seasonality function <code>SEA</code> starts to decrease from its maximum plateau.
See also <code><a href="#topic+SEA">SEA()</a></code>.
</p>
</li>
<li> <p><code>ST2</code> Temperature sum in degree Celsiues days after which the
seasonality function <code>SEA</code> has decreased back to its minimum value.
See also <code><a href="#topic+SEA">SEA()</a></code>.
</p>
</li>
<li> <p><code>maxSEA</code> Maximum value of the seasonality function <code><a href="#topic+SEA">SEA()</a></code>
</p>
</li>
<li> <p><code>minSEA</code> Minimum value of the seasonality function <code><a href="#topic+SEA">SEA()</a></code>. Usually,
<code>minSEA = 1 - (maxSEA - 1)</code>.
</p>
</li>
<li> <p><code>maxOMDGV</code> Maximum organic matter digestability for green vegetative
matter in arbitrary units.
</p>
</li>
<li> <p><code>minOMDGV</code> Minimum organic matter digestability for green vegetative
matter in arbitrary units.
</p>
</li>
<li> <p><code>maxOMDGR</code> Maximum organic matter digestability for green reproductive
matter in arbitrary units.
</p>
</li>
<li> <p><code>minOMDGR</code> Minimum organic matter digestability for green reproductive
matter in arbitrary units.
</p>
</li>
<li> <p><code>BDGV</code> Bulk density of green vegetative dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDDV</code> Bulk density of dead vegetative dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDGR</code> Bulk density of green reproductive dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDDR</code> Bulk density of dead reproductive dry matter in g per m^3^.
</p>
</li>
<li> <p><code>fg_parameter_names</code> Vector of strings of the variable names of all
vegetation parameters governed by functional group composition.
</p>
</li></ul>

<p>Default values for parameters are taken from functional group A in
Jouven et al.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>fg_parameter_names</code></dt><dd><p>Names of the vegetation parameters governed by
functional group composition.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-FunctionalGroup-new"><code>FunctionalGroup$new()</code></a>
</p>
</li>
<li> <p><a href="#method-FunctionalGroup-get_parameters"><code>FunctionalGroup$get_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-FunctionalGroup-get_parameters_ordered"><code>FunctionalGroup$get_parameters_ordered()</code></a>
</p>
</li>
<li> <p><a href="#method-FunctionalGroup-set_parameters"><code>FunctionalGroup$set_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-FunctionalGroup-set_parameters_ordered"><code>FunctionalGroup$set_parameters_ordered()</code></a>
</p>
</li>
<li> <p><a href="#method-FunctionalGroup-clone"><code>FunctionalGroup$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-FunctionalGroup-new"></a>



<h4>Method <code>new()</code></h4>

<p>Constructor
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$new(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Key-value pairs of parameters to be set.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-FunctionalGroup-get_parameters"></a>



<h4>Method <code>get_parameters()</code></h4>

<p>Convenient getter
</p>
<p>Returns all parameters with their names in a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$get_parameters()</pre></div>


<hr>
<a id="method-FunctionalGroup-get_parameters_ordered"></a>



<h4>Method <code>get_parameters_ordered()</code></h4>

<p>Ordered getter
</p>
<p>Returns all parameters in reproducible order in a vector.
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$get_parameters_ordered()</pre></div>


<hr>
<a id="method-FunctionalGroup-set_parameters"></a>



<h4>Method <code>set_parameters()</code></h4>

<p>Convenient setter
</p>
<p>Set all specified parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$set_parameters(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Key-value pairs of parameters to be set.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-FunctionalGroup-set_parameters_ordered"></a>



<h4>Method <code>set_parameters_ordered()</code></h4>

<p>Efficient setter, assumes parameters come in known order.
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$set_parameters_ordered(ordered_parameter_values)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ordered_parameter_values</code></dt><dd><p>Parameter values to be set. Need to be
in the same order as pFunctionalGroup]<code style="white-space: pre;">&#8288;$fg_parameter_names&#8288;</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-FunctionalGroup-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>FunctionalGroup$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>References</h3>

<p>Jouven M, Carrère P, Baumont R (2006).
&ldquo;Model Predicting Dynamics of Biomass, Structure and Digestibility of Herbage in Managed Permanent Pastures. 1. Model Description.&rdquo;
<em>Grass and Forage Science</em>, <b>61</b>(2), 112&ndash;124.
ISSN 1365-2494, <a href="https://doi.org/10.1111/j.1365-2494.2006.00515.x">doi:10.1111/j.1365-2494.2006.00515.x</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2494.2006.00515.x">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2494.2006.00515.x</a>.
</p>

<hr>
<h2 id='fW'>Water stress</h2><span id='topic+fW'></span>

<h3>Description</h3>

<p>Threshold function representing growth limitation due to water stress.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fW(W, PET)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fW_+3A_w">W</code></td>
<td>
<p>Water stress given as the ratio of water reserves to water
holding capacity.</p>
</td></tr>
<tr><td><code id="fW_+3A_pet">PET</code></td>
<td>
<p>Potential evapotranspiration in mm per day.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After equation (6) in McCall et al. (2003).#'
</p>


<h3>Value</h3>

<p>A value in the range (0, 1), acting as a multiplicative factor to
plant growth.
</p>


<h3>References</h3>

<p>McCall DG, Bishop-Hurley GJ (2003).
&ldquo;A Pasture Growth Model for Use in a Whole-Farm Dairy Production Model.&rdquo;
<em>Agricultural Systems</em>, <b>76</b>(3), 1183&ndash;1205.
ISSN 0308-521X, <a href="https://doi.org/10.1016/S0308-521X%2802%2900104-X">doi:10.1016/S0308-521X(02)00104-X</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0308521X0200104X">https://www.sciencedirect.com/science/article/pii/S0308521X0200104X</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fW(0.5, 7)
fW(0.5, 5)
fW(0.5, 3)

</code></pre>

<hr>
<h2 id='get_annual_gross_yield'>Lookup table returning expected annual gross yields as function of
elevation and management intensity.</h2><span id='topic+get_annual_gross_yield'></span>

<h3>Description</h3>

<p>Based on data from Table 1a in
Lookup Table of expected yield as functions of height and management
intensity after Olivier Huguenin et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_annual_gross_yield(elevation, intensity = "high")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_annual_gross_yield_+3A_elevation">elevation</code></td>
<td>
<p>The elevation of the considered site in meters above sea
level.</p>
</td></tr>
<tr><td><code id="get_annual_gross_yield_+3A_intensity">intensity</code></td>
<td>
<p>One of (&quot;high&quot;, &quot;middle&quot;, &quot;low&quot;, &quot;extensive&quot;). Management
intensity for considered site.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Annual gross yield in t / ha (metric tons per hectare). Note that
1 t/ha = 0.1 kg/m^2.
</p>


<h3>References</h3>

<p>Huguenin-Elie IEMPSALWK, Jeangros B (2017).
&ldquo;Grundlagen für die Düngung landwirtschaftlicher Kulturen in der Schweiz (GRUD), Kapitel 9: Düngung von Grasland.&rdquo;
<em>Agrarforschung Schweiz</em>.
<a href="https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/">https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_annual_gross_yield(1200)
get_annual_gross_yield(1200, intensity = "low")

</code></pre>

<hr>
<h2 id='get_bias'>Metric Functions</h2><span id='topic+get_bias'></span><span id='topic+root_mean_squared'></span><span id='topic+mean_absolute_error'></span>

<h3>Description</h3>

<p>Functions to calculate different performance metrics.
</p>
<p>In the case of <em>get_bias</em>: Calculate the bias <em>b</em>, i.e. the average
difference between predicted <em>y</em> and observed <em>z</em> values:
</p>
<div class="sourceCode"><pre>  bias = mean(y - z)
</pre></div>


<h3>Usage</h3>

<pre><code class='language-R'>get_bias(predicted, observed, ...)

root_mean_squared(predicted, observed, ...)

mean_absolute_error(predicted, observed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_bias_+3A_predicted">predicted</code></td>
<td>
<p>Vector containing the predictions <em>y</em>.</p>
</td></tr>
<tr><td><code id="get_bias_+3A_observed">observed</code></td>
<td>
<p>Vector containing the observations <em>z</em>.</p>
</td></tr>
<tr><td><code id="get_bias_+3A_...">...</code></td>
<td>
<p><strong>relative</strong> Boolean. If true give the result as a ratio to the
average observation <code>mean(ovserved)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>m A number representing the relative or absolute value for the
metric.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>root_mean_squared()</code>: Calculate the square root of the average squared difference between
prediction and observation:
</p>
<div class="sourceCode"><pre>RMSE = sqrt(sum(predicted - observed)^2) / length(predicted)
</pre></div>
</li>
<li> <p><code>mean_absolute_error()</code>: Calculate the average of the absolute differences between
prediction and observation:
</p>
<div class="sourceCode"><pre>MAE = mean(abs(predicted - observed))
</pre></div>
</li></ul>


<h3>Note</h3>

<p>NA values are completely ignored.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+willmott">willmott()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>predicted = c(21.5, 22.2, 19.1)
observed = c(20, 20, 20)
get_bias(predicted, observed)
get_bias(predicted, observed, relative = FALSE)

root_mean_squared(predicted, observed)
root_mean_squared(predicted, observed, relative = FALSE)

mean_absolute_error(predicted, observed)
mean_absolute_error(predicted, observed, relative = FALSE)

</code></pre>

<hr>
<h2 id='get_end_of_cutting_season'>Last day of cutting season</h2><span id='topic+get_end_of_cutting_season'></span>

<h3>Description</h3>

<p>Estimate the last day on which it still makes sense to cut. This is done
by checking at which point the expected target biomass (see
<code><a href="#topic+get_relative_cut_contribution">get_relative_cut_contribution()</a></code>) goes below the minimally harvestable
standing biomass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_end_of_cutting_season(min_biomass, elevation, intensity = "high")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_end_of_cutting_season_+3A_min_biomass">min_biomass</code></td>
<td>
<p>float A standing biomass below this value cannot even
be harvested,</p>
</td></tr>
<tr><td><code id="get_end_of_cutting_season_+3A_elevation">elevation</code></td>
<td>
<p>float Altitude in m.a.s.l.</p>
</td></tr>
<tr><td><code id="get_end_of_cutting_season_+3A_intensity">intensity</code></td>
<td>
<p>string Management intensity. One of &quot;high&quot;, &quot;middle&quot;, &quot;low&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>float Last (fractional) day of the year on which a cut still makes
sense.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_relative_cut_contribution">get_relative_cut_contribution()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_end_of_cutting_season(50, 1200)
get_end_of_cutting_season(50, 1200, intensity = "low")

</code></pre>

<hr>
<h2 id='get_expected_n_cuts'>Get number of expected cuts</h2><span id='topic+get_expected_n_cuts'></span>

<h3>Description</h3>

<p>Return the number of expected cuts for a site at a given <em>elevation</em> and
management <em>intensity</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_expected_n_cuts(elevation, intensity = "high")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_expected_n_cuts_+3A_elevation">elevation</code></td>
<td>
<p>The elevation of the considered site in meters above sea
level.</p>
</td></tr>
<tr><td><code id="get_expected_n_cuts_+3A_intensity">intensity</code></td>
<td>
<p>One of (&quot;high&quot;, &quot;middle&quot;, &quot;low&quot;, &quot;extensive&quot;). Management
intensity for considered site.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This uses data.frame <code>management_parameters</code> as a lookup table and
interpolates linearly in between the specified values.
</p>


<h3>Value</h3>

<p>Number of expected cuts per season.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_expected_n_cuts(1200)
get_expected_n_cuts(1200, intensity = "low")

</code></pre>

<hr>
<h2 id='get_relative_cut_contribution'>Relative cut contribution</h2><span id='topic+get_relative_cut_contribution'></span>

<h3>Description</h3>

<p>Get the fraction of the total annual harvested biomass that a cut at given
<em>DOY</em> is expected to contribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_relative_cut_contribution(DOY)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_relative_cut_contribution_+3A_doy">DOY</code></td>
<td>
<p>Integer representing the day of the year on which a cut occurs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The regression for the target biomass is based on Fig. S2 in the
supplementary material of Petersen et al. (2021).
</p>


<h3>Value</h3>

<p>The fraction (between 0 and 1) of biomass harvested at the cut at
given <em>DOY</em> divided by the total annual biomass.
</p>


<h3>References</h3>

<p>Petersen K, Kraus D, Calanca P, Semenov MA, Butterbach-Bahl K, Kiese R (2021).
&ldquo;Dynamic Simulation of Management Events for Assessing Impacts of Climate Change on Pre-Alpine Grassland Productivity.&rdquo;
<em>European Journal of Agronomy</em>, <b>128</b>, 126306.
ISSN 1161-0301, <a href="https://doi.org/10.1016/j.eja.2021.126306">doi:10.1016/j.eja.2021.126306</a>, <a href="https://www.sciencedirect.com/science/article/pii/S1161030121000782">https://www.sciencedirect.com/science/article/pii/S1161030121000782</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_relative_cut_contribution(1)
get_relative_cut_contribution(150)
get_relative_cut_contribution(365)
# DOYs larger than 365 are insensible
get_relative_cut_contribution(600)

</code></pre>

<hr>
<h2 id='get_site_name'>Extract the name of a site from a filename</h2><span id='topic+get_site_name'></span>

<h3>Description</h3>

<p>This function assumes the filenames to begin with the site name, 
potentially followed by an underscore and further characters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_site_name(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_site_name_+3A_filename">filename</code></td>
<td>
<p>String of a 'ModvegeSite' output filename.</p>
</td></tr>
</table>

<hr>
<h2 id='growR_package_options'>Default options introduced by package growR</h2><span id='topic+growR_package_options'></span>

<h3>Description</h3>

<p>These are the default options, set when the package is loaded 
by 'library(growR)'. To get or change the current value of an option, 
use the 'options()' function.
</p>

<dl>
<dt>growR.verbosity</dt><dd><p>Integer that controls how much console output is 
generated by growR functions. Higher numbers mean more output. 
See [logger()].</p>
</dd>
<dt>growR.input_dir</dt><dd><p>Name of the directory in which to look for 
input files.</p>
</dd>
<dt>growR.output_dir</dt><dd><p>Name of the directory into which output files
are written.</p>
</dd>
<dt>growR.data_dir</dt><dd><p>Name of the directory in which to look for 
measured data files.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>growR_package_options
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.
</p>


<h3>See Also</h3>

<p>[options()]
</p>

<hr>
<h2 id='growR_run_loop'>Run growR simulations</h2><span id='topic+growR_run_loop'></span>

<h3>Description</h3>

<p>Start the loop over runs specified in the config file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growR_run_loop(modvege_environments, output_dir = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growR_run_loop_+3A_modvege_environments">modvege_environments</code></td>
<td>
<p>A list of <a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a> instances.</p>
</td></tr>
<tr><td><code id="growR_run_loop_+3A_output_dir">output_dir</code></td>
<td>
<p>string; name of directory to which output files are to
be written. If <code>output_dir == ""</code> (default), no files are written.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, returns an empty list but writes output to the output files
as specified in the <em>site_name</em> and <em>run_name</em> fields of the supplied
<a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a> instances. Change this behaviour through the
<code>write_files</code> and <code>store_results</code> arguments.
</p>


<h3>Value</h3>

<p>A list of the format <code style="white-space: pre;">&#8288;[[run]][[year]]&#8288;</code> containing clones of
the <a href="#topic+ModvegeSite">ModvegeSite</a> instances that were run. Also write to files, if
<em>output_dir</em> is nonempty.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>env1 = create_example_environment(site = "posieux")
env2 = create_example_environment(site = "sorens")

growR_run_loop(c(env1, env2), output_dir = "")

</code></pre>

<hr>
<h2 id='load_measured_data'>Load experimental data</h2><span id='topic+load_measured_data'></span><span id='topic+load_data_for_sites'></span><span id='topic+load_matching_data'></span>

<h3>Description</h3>

<p>Load all datasets stored in the supplied files.
</p>
<p>Upon loading, the cumulative biomass growth <em>cBM</em> is automatically
calculated from the given daily biomass growth <em>dBM</em> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_measured_data(filenames, sep = ",")

load_data_for_sites(sites)

load_matching_data(filenames)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_measured_data_+3A_filenames">filenames</code></td>
<td>
<p>Vector of strings representing simulation output
filenames for which matching data files are searched and loaded.</p>
</td></tr>
<tr><td><code id="load_measured_data_+3A_sep">sep</code></td>
<td>
<p>String Field separator used in the datafiles.</p>
</td></tr>
<tr><td><code id="load_measured_data_+3A_sites">sites</code></td>
<td>
<p>Vector of site names for which data to load.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>load_matching_data()</code> internally uses <code><a href="#topic+get_site_name">get_site_name()</a></code> and makes the same
assumptions about the output filename formats. It further assumes measured
data to be located in &quot;data/&quot; and adhere to the filename format <code>x.csv</code>
with <code>x</code> being the site name.
</p>


<h3>Value</h3>

<p>measured_data list of data.frame each corresponding to one of
the sites detected in <em>filenames</em>. Each data.frame contains the keys
</p>

<ul>
<li> <p><code>dBM</code>: average daily biomass growth since last observation in kg/ha.
</p>
</li>
<li> <p><code>cBM</code>: cumulative biomass growth up to this DOY in kg/ha.
</p>
</li>
<li> <p><code>year</code>: year of observation.
</p>
</li>
<li> <p><code>DOY</code>: day of year of observation.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>load_data_for_sites()</code>: Data filenames are generated on the convention 'SITE.csv' and are searched 
for in the subdirectory 'getOption(&quot;growR.data_dir&quot;)', which defaults 
to 'data/'.
</p>
</li>
<li> <p><code>load_matching_data()</code>: Accepts a vector of output filenames as generated by
<a href="#topic+ModvegeSite">ModvegeSite</a><code style="white-space: pre;">&#8288;$write_output()&#8288;</code> out of which the site names are inferred.
</p>
</li></ul>


<h3>Data file format</h3>

<p>The input data files are expected to consist of four columns containing
the following fileds, in order: </p>

<dl>
<dt>date</dt><dd><p>Date of measurement in yyyy-mm-dd format.</p>
</dd>
<dt>year</dt><dd><p>Year of measurement. Identical to yyyy in <em>date</em> field.</p>
</dd>
<dt>DOY</dt><dd><p>Day of year of the measurement. Jan 1st corresponds to 1, Dec
31st corresponds to 365 (except in gap years).</p>
</dd>
<dt>dBM</dt><dd><p>Observed <strong>average daily biomass growth</strong> since last cut in
kg/ha.</p>
</dd>
</dl>

<p>The first row is expected to be a header row containing the exact field
names as in the description above.
Columns may be separated by an arbitrary character, specified by the <em>sep</em>
argument.
The example data uses a comma (&quot;,&quot;).
</p>

<hr>
<h2 id='logger'>Primitive logger for debugging.</h2><span id='topic+logger'></span>

<h3>Description</h3>

<p>Primitive logger for debugging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logger(msg = "", level = DEBUG, stop_on_error = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logger_+3A_msg">msg</code></td>
<td>
<p>The message to print.</p>
</td></tr>
<tr><td><code id="logger_+3A_level">level</code></td>
<td>
<p>The message will only be printed if its <em>level</em> is lower
or equal to <code>getOption("growR.verbosity")</code>.</p>
</td></tr>
<tr><td><code id="logger_+3A_stop_on_error">stop_on_error</code></td>
<td>
<p>Can be set to FALSE in order to continue
execution despite emitting a message of <em>level</em> ERROR.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None Prints console output.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_growR_verbosity">set_growR_verbosity()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logger("A standard message", level = 3)
logger("A debug message", level = 4)
logger("A deep debug message", level = 5)

</code></pre>

<hr>
<h2 id='make_yearDOY'>Create unique DOY + year identifier</h2><span id='topic+make_yearDOY'></span>

<h3>Description</h3>

<p>Return numbers of the form YYYYDDD where YYYY is the year and DDD the DOY.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_yearDOY(years, DOYs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_yearDOY_+3A_years">years</code></td>
<td>
<p>int vector.</p>
</td></tr>
<tr><td><code id="make_yearDOY_+3A_doys">DOYs</code></td>
<td>
<p>int vector of same length as *years*.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>int vector of same length as *years* containing numbers of the 
form YYYYDDD, where the first four digits represent a year and the last 
four represent a DOY.
</p>

<hr>
<h2 id='management_parameters'>Management practices for Swiss grasslands</h2><span id='topic+management_parameters'></span>

<h3>Description</h3>

<p>Expected yields, uncertainties and average number of cuts as function of
altitude and management intensity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>management_parameters
</code></pre>


<h3>Format</h3>

<p>A data.frame with 15 rows and 5 variables:
</p>

<dl>
<dt>intensity</dt><dd><p>Management intensity</p>
</dd>
<dt>altitude</dt><dd><p>Altitude in m.a.s.l.</p>
</dd>
<dt>n_cuts</dt><dd><p>Average number of cuts</p>
</dd>
<dt>yield</dt><dd><p>Expected gross dry matter yield in t / ha</p>
</dd>
<dt>sigma_yield</dt><dd><p>Uncertainty on yield in t / ha</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data after table 1b in
</p>
<p>Olivier Huguenin et al.
</p>


<h3>References</h3>

<p>Huguenin-Elie IEMPSALWK, Jeangros B (2017).
&ldquo;Grundlagen für die Düngung landwirtschaftlicher Kulturen in der Schweiz (GRUD), Kapitel 9: Düngung von Grasland.&rdquo;
<em>Agrarforschung Schweiz</em>.
<a href="https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/">https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/</a>.
</p>

<hr>
<h2 id='ManagementData'>Management Data Class</h2><span id='topic+ManagementData'></span>

<h3>Description</h3>

<p>Management Data Class
</p>
<p>Management Data Class
</p>


<h3>Details</h3>

<p>Data structure that contains management data which can serve as input to
a <a href="#topic+ModvegeSite">ModvegeSite</a> simulation run.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>management_file</code></dt><dd><p>string The file that was read.</p>
</dd>
<dt><code>is_empty</code></dt><dd><p>boolean Used to determine if management data is present or
not. In the latter case, <a href="#topic+ModvegeSite">ModvegeSite</a> will simulate management decisions
automatically.</p>
</dd>
<dt><code>years</code></dt><dd><p>List of unique years for which data is available.</p>
</dd>
<dt><code>cut_years</code></dt><dd><p>numeric Vector of length <em>N</em> where <em>N</em> is the total
number of cuts read from the input file. Gives the year in which
corresponding cut was made.</p>
</dd>
<dt><code>cut_DOY</code></dt><dd><p>numeric Vector of length <em>N</em> giving the day of year (as an
integer) on which a cut was made.</p>
</dd>
<dt><code>intensity</code></dt><dd><p>string Management intensity for &quot;autocut&quot;. One of
c(&quot;high&quot;, &quot;middle&quot;, &quot;low&quot;).</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-ManagementData-new"><code>ManagementData$new()</code></a>
</p>
</li>
<li> <p><a href="#method-ManagementData-read_management"><code>ManagementData$read_management()</code></a>
</p>
</li>
<li> <p><a href="#method-ManagementData-ensure_file_integrity"><code>ManagementData$ensure_file_integrity()</code></a>
</p>
</li>
<li> <p><a href="#method-ManagementData-get_management_for_year"><code>ManagementData$get_management_for_year()</code></a>
</p>
</li>
<li> <p><a href="#method-ManagementData-clone"><code>ManagementData$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-ManagementData-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new ManagementData object.
</p>


<h5>Usage</h5>

<div class="r"><pre>ManagementData$new(management_file = NULL, years = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>management_file</code></dt><dd><p>string Path to file containing the management
data to be read.</p>
</dd>
<dt><code>years</code></dt><dd><p>numeric Vector of years for which the management is to be
extracted.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ManagementData-read_management"></a>



<h4>Method <code>read_management()</code></h4>

<p>Read management data from supplied <em>management_file</em>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ManagementData$read_management(management_file, years = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>management_file</code></dt><dd><p>Path to or name of file containing management data.</p>
</dd>
<dt><code>years</code></dt><dd><p>Years for which the management is to be extracted.
Default (NULL) is to read in all found years.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>None The object's field are filled.
</p>


<hr>
<a id="method-ManagementData-ensure_file_integrity"></a>



<h4>Method <code>ensure_file_integrity()</code></h4>

<p>Check that all required columns are present and that cut
DOYs are only increasing in a given year.
</p>


<h5>Usage</h5>

<div class="r"><pre>ManagementData$ensure_file_integrity(cut_data)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>cut_data</code></dt><dd><p>data.frame containing the cut data.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ManagementData-get_management_for_year"></a>



<h4>Method <code>get_management_for_year()</code></h4>

<p>Extract management data for given year
</p>
<p>This simply filters out all data not matching <em>year</em> and returns a
list with the relevant keys.
</p>


<h5>Usage</h5>

<div class="r"><pre>ManagementData$get_management_for_year(year)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>year</code></dt><dd><p>integer Year for which to extract management data.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>M A list containing the keys:
</p>

<dl>
<dt>is_empty</dt><dd><p>boolean Used to determine if management data is
present or not. In the latter case, <a href="#topic+ModvegeSite">ModvegeSite</a> will simulate
management decisions automatically.</p>
</dd>
<dt>cut_years</dt><dd><p>numeric Vector of length <em>N</em> where <em>N</em> is the total
number of cuts for this <em>year</em>, as read from the input file. Gives
the year in which corresponding cut was made.</p>
</dd>
<dt>cut_DOY</dt><dd><p>numeric Vector of length <em>N</em> giving the day of year (as an
integer) on which a cut was made.</p>
</dd>
<dt>intensity</dt><dd><p>string Management intensity for &quot;autocut&quot;. One of
c(&quot;high&quot;, &quot;middle&quot;, &quot;low&quot;).</p>
</dd>
<dt>n_cuts</dt><dd><p>integer Number of cuts occurring in given year.</p>
</dd>
</dl>

<p>The two vectors in <code>cut_DOY</code> and <code>cut_years</code>
differ from this object's respective fields in that only data for
selected year is present.
</p>


<hr>
<a id="method-ManagementData-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>ManagementData$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p><a href="#topic+ManagementData">ManagementData</a><code style="white-space: pre;">&#8288;$read_management()&#8288;</code>
</p>

<hr>
<h2 id='metric_map'>List of Performance Metrics</h2><span id='topic+metric_map'></span>

<h3>Description</h3>

<p>This list provides some common metrics of model performance along with
their &quot;best value&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metric_map
</code></pre>


<h3>Format</h3>

<p>A list where each item is a sublist containing the keys <em>func</em> and
<em>target</em>.
</p>

<dl>
<dt>func</dt><dd><p>The function used to calculate given metric.</p>
</dd>
<dt>target</dt><dd><p>The value that would be reached in the case of optimal
performance.</p>
</dd>
<dt>limits</dt><dd><p>Reasonable limits to be used when plotting.</p>
</dd>
</dl>


<hr>
<h2 id='ModvegeEnvironment'>growR environment data</h2><span id='topic+ModvegeEnvironment'></span>

<h3>Description</h3>

<p>Data structure that contains inputs (parameters pertaining to a site, to
the vegetation, to the weather and to the management) to growR simulations.
</p>


<h3>Details</h3>

<p>This class contains site parameters, weather and management data for
one simulation run of growR on a given site over several years.
Methods are provided to allow access to relevant data for a given year.
</p>
<p>All inputs are read in from data files through the respective data classes
<a href="#topic+WeatherData">WeatherData</a>, <a href="#topic+ManagementData">ManagementData</a> and <a href="#topic+ModvegeParameters">ModvegeParameters</a>. These parameters
can be simultaneously specified through a config file using <code><a href="#topic+read_config">read_config()</a></code>.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>site_name</code></dt><dd><p>Name of site to be simulated.</p>
</dd>
<dt><code>run_name</code></dt><dd><p>Name of simulation run. Allows distinguishing between
different simulations at the same site. Defaults to &quot;-&quot; for <em>no name</em>.</p>
</dd>
<dt><code>run_name_in_filename</code></dt><dd><p>How the run name will be represented in an
output file. If <code>run_name</code> is the default &quot;-&quot;, indicating no name, this
will be an empty string. Otherwise, it will be the <code>run_name</code> prepended
by and underscore <code style="white-space: pre;">&#8288;_&#8288;</code>.</p>
</dd>
<dt><code>years</code></dt><dd><p>Years for which environment data (weather &amp; management) is
present.</p>
</dd>
<dt><code>param_file</code></dt><dd><p>Name of supplied parameter file.</p>
</dd>
<dt><code>weather_file</code></dt><dd><p>Name of supplied weather file.</p>
</dd>
<dt><code>management_file</code></dt><dd><p>Name of supplied management file.</p>
</dd>
<dt><code>parameters</code></dt><dd><p>A <a href="#topic+ModvegeParameters">ModvegeParameters</a> object.</p>
</dd>
<dt><code>weather</code></dt><dd><p>A <a href="#topic+WeatherData">WeatherData</a> object.</p>
</dd>
<dt><code>management</code></dt><dd><p>A <a href="#topic+ManagementData">ManagementData</a> object.</p>
</dd>
<dt><code>input_dir</code></dt><dd><p>Directory in which parameter, weather and management
files are searched for. Defaults to 'getOption(&quot;growR.input_dir&quot;).</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-ModvegeEnvironment-new"><code>ModvegeEnvironment$new()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeEnvironment-set_run_name"><code>ModvegeEnvironment$set_run_name()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeEnvironment-load_inputs"><code>ModvegeEnvironment$load_inputs()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeEnvironment-make_filename_for_run"><code>ModvegeEnvironment$make_filename_for_run()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeEnvironment-get_environment_for_year"><code>ModvegeEnvironment$get_environment_for_year()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeEnvironment-clone"><code>ModvegeEnvironment$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-ModvegeEnvironment-new"></a>



<h4>Method <code>new()</code></h4>

<p>Instantiate a new ModvegeEnvironment
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$new(
  site_name,
  run_name = "-",
  years = NULL,
  param_file = "-",
  weather_file = "-",
  management_file = "-",
  input_dir = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>site_name</code></dt><dd><p>string Name of the simulated site.</p>
</dd>
<dt><code>run_name</code></dt><dd><p>string Name of the simulation run. Used to
differentiate between different simulation conditions at the same site.
Defaults to &quot;-&quot;, which indicates no specific run name.</p>
</dd>
<dt><code>years</code></dt><dd><p>numeric Vector of integer years to be simulated.</p>
</dd>
<dt><code>param_file</code></dt><dd><p>string Name of file that contains site and
vegetation parameters. If default value <code>"-"</code> is  provided, it is
assumed to be &quot;SITENAME_parameters.csv&quot;.</p>
</dd>
<dt><code>weather_file</code></dt><dd><p>string Analogous to <em>param_file</em>.</p>
</dd>
<dt><code>management_file</code></dt><dd><p>string Analogous to <em>param_file</em>.</p>
</dd>
<dt><code>input_dir</code></dt><dd><p>string Path to directory containing input files.
Defaults to <code>getOption("growR.input_dir")</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ModvegeEnvironment-set_run_name"></a>



<h4>Method <code>set_run_name()</code></h4>

<p>Set run name and update <em>run_name_in_filename</em>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$set_run_name(run_name)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>run_name</code></dt><dd><p>Str. New value of <code>self$run_name</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ModvegeEnvironment-load_inputs"></a>



<h4>Method <code>load_inputs()</code></h4>

<p>Load simulation inputs.
</p>
<p>Stores parameters, management and weather data from files specified in
self$parameter_file, self$weather_file and self$management_file,
respectively.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$load_inputs()</pre></div>


<hr>
<a id="method-ModvegeEnvironment-make_filename_for_run"></a>



<h4>Method <code>make_filename_for_run()</code></h4>

<p>Ensure a readable filename for given <em>run_name</em>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$make_filename_for_run(run_name)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>run_name</code></dt><dd><p>Name of run to be converted into a filename.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A version of <em>run_name</em> that can be used in a filename.
</p>


<hr>
<a id="method-ModvegeEnvironment-get_environment_for_year"></a>



<h4>Method <code>get_environment_for_year()</code></h4>

<p>Get weather and environment for given year
</p>
<p>Convenience function to retrieve environmental and management
inputs for given <em>year</em> from multi-year data containers <code>self$weather</code>
and <code>self$management</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$get_environment_for_year(year)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>year</code></dt><dd><p>int; year for which to extract data.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p><code>list(W, M)</code> where <code>W</code> is the WeatherData and <code>M</code> the
ManagementData object for given year.
</p>


<hr>
<a id="method-ModvegeEnvironment-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeEnvironment$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p><code><a href="#topic+read_config">read_config()</a></code>
</p>
<p><a href="#topic+WeatherData">WeatherData</a><code style="white-space: pre;">&#8288;$get_weather_for_year()&#8288;</code>,
<a href="#topic+ManagementData">ManagementData</a><code style="white-space: pre;">&#8288;$get_management_for_year()&#8288;</code>
</p>

<hr>
<h2 id='ModvegeParameters'>Parameter Data Object</h2><span id='topic+ModvegeParameters'></span>

<h3>Description</h3>

<p>Data structure that contains site and vegetation parameters necessary for
the configuration of an growR simulation run.
</p>


<h3>Parameter description</h3>

<p>The following is a list and description of model parameters, including
the vegetation parameters, which are defined through the functional group
composition.
</p>


<h4>Site and model parameters</h4>


<ul>
<li> <p><code>LON</code> geographic longitude of site in degree.
</p>
</li>
<li> <p><code>LAT</code> geographic latitude of site in degree.
</p>
</li>
<li> <p><code>ELV</code> geographic elevation of site in m.a.s.l.
</p>
</li>
<li> <p><code>WHC</code> water-holding capacity of site in mm.
</p>
</li>
<li> <p><code>NI</code> site nutritional index (dimensionless).
</p>
</li>
<li> <p><code>RUEmax</code> maximum radiuation use efficiency in g DM per MJ.
</p>
</li>
<li> <p><code>w_FGA</code> relative weight of functional group A.
</p>
</li>
<li> <p><code>w_FGB</code> relative weight of functional group B.
</p>
</li>
<li> <p><code>w_FGC</code> relative weight of functional group C.
</p>
</li>
<li> <p><code>w_FGD</code> relative weight of functional group D.
</p>
</li>
<li> <p><code>sigmaGV</code> rate of GV respirative biomass loss (dimensionless).
</p>
</li>
<li> <p><code>sigmaGR</code> rate of GR respirative biomass loss (dimensionless).
</p>
</li>
<li> <p><code>T0</code> photosynthesis activation temperature (degree C).
</p>
</li>
<li> <p><code>T1</code> photosynthesis plateau temperature (degree C).
</p>
</li>
<li> <p><code>T2</code> photosynthesis max temperature (degree C).
</p>
</li>
<li> <p><code>KGV</code> basic senescence rate GV (dimensionless).
</p>
</li>
<li> <p><code>KGR</code> basic senescence rate GR (dimensionless).
</p>
</li>
<li> <p><code>KlGV</code> basic abscission rate GV (dimensionless).
</p>
</li>
<li> <p><code>KlGR</code> basic abscission rate GR (dimensionless).
</p>
</li>
<li> <p><code>maxOMDDV</code> organic matter digestibility in gram per gram DV.
</p>
</li>
<li> <p><code>minOMDDR</code> organic matter digestibility in gram per gram DR.
</p>
</li>
<li> <p><code>CO2_growth_factor</code> strength of effect of CO2 concentration on growth. See
parameter <em>b</em> in <code><a href="#topic+fCO2_growth_mod">fCO2_growth_mod()</a></code>.
</p>
</li>
<li> <p><code>crop_coefficient</code> multiplicative factor K~c~ by which
reference evapotranspiration ET~0~ has to be multiplied to get the crop
evapotranspiration ET~c~:
ET~c~ = K~c~ ET~0~
</p>
</li>
<li> <p><code>senescence_cap</code> fraction c~s~ of <em>GRO</em> to which <em>SEN</em> is
limited: SEN~i~^max^ = c~s~ GRO~i~
for <em>i</em> in <em>GV</em>, <em>GR</em>. Makes it less likely for grass population to die out.
Can be set to large values in order to effectively disable senescence capping.
</p>
</li></ul>




<h4>Initial conditions</h4>


<ul>
<li> <p><code>AgeGV</code> Age of green vegetative matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeGR</code> Age of green reproductive matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeDV</code> Age of dead vegetative matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeDR</code> Age of dead reproductive matter in degree Celsius days.
</p>
</li>
<li> <p><code>BMGV</code> biomass of GV (kg DM per ha).
</p>
</li>
<li> <p><code>BMGR</code> biomass of GR (kg DM per ha).
</p>
</li>
<li> <p><code>BMDV</code> biomass of DV (kg DM per ha).
</p>
</li>
<li> <p><code>BMDR</code> biomass of DR (kg DM per ha).
</p>
</li>
<li> <p><code>BMDR</code> biomass of DR (kg DM per ha).
</p>
</li>
<li> <p><code>SENG</code> senescence of GV (kg DM per ha).
</p>
</li>
<li> <p><code>SENG</code> senescence of GR (kg DM per ha).
</p>
</li>
<li> <p><code>ABSG</code> abscission of DV (kg DM per ha).
</p>
</li>
<li> <p><code>ABSG</code> abscission of DR (kg DM per ha).
</p>
</li>
<li> <p><code>ST</code> thermal time (degree days).
</p>
</li>
<li> <p><code>cBM</code> cumulative total biomass (kg per ha).
</p>
</li></ul>




<h4>Vegetation parameters</h4>


<ul>
<li> <p><code>SLA</code> Specific Leaf Area in m^2^ per g.
</p>
</li>
<li> <p><code>pcLAM</code> Percentage of laminae (number between 0 and 1).
</p>
</li>
<li> <p><code>ST1</code> Temperature sum in degree Celsiues days after which the
seasonality function <code>SEA</code> starts to decrease from its maximum plateau.
See also <code><a href="#topic+SEA">SEA()</a></code>.
</p>
</li>
<li> <p><code>ST2</code> Temperature sum in degree Celsiues days after which the
seasonality function <code>SEA</code> has decreased back to its minimum value.
See also <code><a href="#topic+SEA">SEA()</a></code>.
</p>
</li>
<li> <p><code>maxSEA</code> Maximum value of the seasonality function <code><a href="#topic+SEA">SEA()</a></code>
</p>
</li>
<li> <p><code>minSEA</code> Minimum value of the seasonality function <code><a href="#topic+SEA">SEA()</a></code>. Usually,
<code>minSEA = 1 - (maxSEA - 1)</code>.
</p>
</li>
<li> <p><code>maxOMDGV</code> Maximum organic matter digestability for green vegetative
matter in arbitrary units.
</p>
</li>
<li> <p><code>minOMDGV</code> Minimum organic matter digestability for green vegetative
matter in arbitrary units.
</p>
</li>
<li> <p><code>maxOMDGR</code> Maximum organic matter digestability for green reproductive
matter in arbitrary units.
</p>
</li>
<li> <p><code>minOMDGR</code> Minimum organic matter digestability for green reproductive
matter in arbitrary units.
</p>
</li>
<li> <p><code>BDGV</code> Bulk density of green vegetative dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDDV</code> Bulk density of dead vegetative dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDGR</code> Bulk density of green reproductive dry matter in g per m^3^.
</p>
</li>
<li> <p><code>BDDR</code> Bulk density of dead reproductive dry matter in g per m^3^.
</p>
</li>
<li> <p><code>fg_parameter_names</code> Vector of strings of the variable names of all
vegetation parameters governed by functional group composition.
</p>
</li></ul>




<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>required_parameter_names</code></dt><dd><p>Names of parameters that do not have a
default value and are therefore strictly required.</p>
</dd>
<dt><code>parameter_names</code></dt><dd><p>Names of all required and optional parameters and
state variables.</p>
</dd>
<dt><code>n_parameters</code></dt><dd><p>Number of total parameters.</p>
</dd>
<dt><code>functional_group</code></dt><dd><p>The <a href="#topic+FunctionalGroup">FunctionalGroup</a> instance holding the
vegetation parameters.</p>
</dd>
<dt><code>fg_parameter_names</code></dt><dd><p>Names of vegetation parameters defined by the
functional group composition.</p>
</dd>
<dt><code>initial_condition_names</code></dt><dd><p>Names of initial conditions.</p>
</dd>
<dt><code>param_file</code></dt><dd><p>Name of the parameter file from which initial parameter
values were read.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-ModvegeParameters-new"><code>ModvegeParameters$new()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeParameters-read_parameters"><code>ModvegeParameters$read_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeParameters-set_parameters"><code>ModvegeParameters$set_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeParameters-update_functional_group"><code>ModvegeParameters$update_functional_group()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeParameters-check_parameters"><code>ModvegeParameters$check_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeParameters-clone"><code>ModvegeParameters$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-ModvegeParameters-new"></a>



<h4>Method <code>new()</code></h4>

<p>Constructor
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$new(param_file = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param_file</code></dt><dd><p>Name of file containing the site and vegetation
parameters.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ModvegeParameters-read_parameters"></a>



<h4>Method <code>read_parameters()</code></h4>

<p>Read parameters from parameter file
</p>
<p>Reads in parameters from the supplied <em>param_file</em> and stores them in
internal fields.
</p>
<p>This function carries out some basic sanity checks of
the supplied <em>param_file</em> and reports on unidentified and missing
parameter names.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$read_parameters(param_file)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param_file</code></dt><dd><p>Path or name of file to read parameters from.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>P List with field names as in the class variable
<code>parameter_names</code>.
</p>


<hr>
<a id="method-ModvegeParameters-set_parameters"></a>



<h4>Method <code>set_parameters()</code></h4>

<p>Savely update the given parameters
</p>
<p>This is the preferred method for changing the internal parameter
values, because special care is taken to account for potential
changes to functional group weights.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$set_parameters(params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt><dd><p>List of name-value pairs of the parameters to update.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ModvegeParameters-update_functional_group"></a>



<h4>Method <code>update_functional_group()</code></h4>

<p>Update functional group parameters
</p>
<p>Should be run whenever the functional group composition is changed in
order to reflect the changes in the parameter list <code>self$P</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$update_functional_group()</pre></div>


<hr>
<a id="method-ModvegeParameters-check_parameters"></a>



<h4>Method <code>check_parameters()</code></h4>

<p>Parameter Sanity Check
Ensure that the supplied <em>params</em> are valid ModVege parameters and,
if requested, check that all required parameters are present.
Issues a warning for any invalid parameters and throws an error if
completeness is not satisfied (only when <code>check_for_completeness =  TRUE</code>).
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$check_parameters(param_names, check_for_completeness = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param_names</code></dt><dd><p>A list of parameter names to be checked.</p>
</dd>
<dt><code>check_for_completeness</code></dt><dd><p>Boolean Toggle whether only the
validity of supplied <em>param_names</em> is checked or whether we
want to check that all required parameters to be present
(default). In the latter case, if any required parameter is
missing, an error is thrown.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>not_known The list of unrecognized parameter names.
</p>


<hr>
<a id="method-ModvegeParameters-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeParameters$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>Note</h3>

<p>Programmatically speaking, all parameters described under <em>Parameter
description</em> are also fields of this R6Class.
</p>

<hr>
<h2 id='ModvegeSite'>ModvegeSite</h2><span id='topic+ModvegeSite'></span>

<h3>Description</h3>

<p>Implements the ModVege grass growth model based off of Jouven et al. (2006).
</p>
<p>This class contains model and site parameters and state variables as
attributes and has methods for running ModVege with weather and management
input.
</p>
<p>Use the <code>run()</code> method to carry out a simulation for a given year. The
results are stored in the state variables in this instance and can be written
to file using <code>write_output()</code>.
</p>


<h3>Model variables</h3>

<p>See Jouven et al. (2006) for a thorough description of all model variables.
</p>


<h4>State Variables</h4>


<ul>
<li> <p><code>BM</code>
Standing biomass in kg DM per ha.
</p>
</li>
<li> <p><code>BMG</code>
Standing green biomass (kg DM / ha).
</p>
</li>
<li> <p><code>cBM</code>
Cumulativeley grown biomass (kg DM / ha).
</p>
</li>
<li> <p><code>dBM</code>
Daily grown biomass (kg DM / ha).
</p>
</li>
<li> <p><code>hvBM</code>
Cumulative harvested biomass (kg DM / ha).
</p>
</li>
<li> <p><code>OMD</code>
Organic matter digestibility (kg / kg).
</p>
</li>
<li> <p><code>OMDG</code>
OMD of green matter (kg / kg).
</p>
</li>
<li> <p><code>ST</code>
Temperature sum in degree Celsius days.
</p>
</li>
<li> <p><code>REP</code> Reproductive function. Gives the fraction of growth that is
assigned to reproductive growth. The remainder goes into vegetative growth.
Dimensionless.
</p>
</li>
<li> <p><code>PGRO</code>
Potential growth in kg DM / ha.
</p>
</li>
<li> <p><code>GRO</code>
Effective growth in kg DM / ha.
</p>
</li>
<li> <p><code>LAI</code>
Leaf area index, accounting for the proportion of light intercepted by the
sward. Dimensionless.
</p>
</li>
<li> <p><code>LAIGV</code>
LAI of green vegetative biomass. Dimensionless.
</p>
</li>
<li> <p><code>AET</code>
Actual evapotranspiration in mm.
</p>
</li>
<li> <p><code>WR</code>
Water reserves in mm.
</p>
</li>
<li> <p><code>ENV</code>
Function representing environmental effects on growth. Acts as a
multiplicative factor. Dimensionless.
</p>
</li>
<li> <p><code>ENVfPAR</code>
Part of ENV due to strength of incident radiation. Dimensionless.
</p>
</li>
<li> <p><code>ENVfT</code>
Part of ENV due to temperature. Dimensionless.
</p>
</li>
<li> <p><code>ENVfW</code>
Part of ENV due to water limitation. Dimensionless.
</p>
</li></ul>




<h4>Initial conditions</h4>


<ul>
<li> <p><code>AgeGV</code> Age of green vegetative matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeGR</code> Age of green reproductive matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeDV</code> Age of dead vegetative matter in degree Celsius days.
</p>
</li>
<li> <p><code>AgeDR</code> Age of dead reproductive matter in degree Celsius days.
</p>
</li>
<li> <p><code>BMGV</code> biomass of GV (kg DM per ha).
</p>
</li>
<li> <p><code>BMGR</code> biomass of GR (kg DM per ha).
</p>
</li>
<li> <p><code>BMDV</code> biomass of DV (kg DM per ha).
</p>
</li>
<li> <p><code>BMDR</code> biomass of DR (kg DM per ha).
</p>
</li>
<li> <p><code>BMDR</code> biomass of DR (kg DM per ha).
</p>
</li>
<li> <p><code>SENG</code> senescence of GV (kg DM per ha).
</p>
</li>
<li> <p><code>SENG</code> senescence of GR (kg DM per ha).
</p>
</li>
<li> <p><code>ABSG</code> abscission of DV (kg DM per ha).
</p>
</li>
<li> <p><code>ABSG</code> abscission of DR (kg DM per ha).
</p>
</li>
<li> <p><code>ST</code> thermal time (degree days).
</p>
</li>
<li> <p><code>cBM</code> cumulative total biomass (kg per ha).
</p>
</li></ul>




<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>time_step</code></dt><dd><p>Used time step in the model in days (untested).</p>
</dd>
<dt><code>state_variable_names</code></dt><dd><p>Vector containing the names of the model's
state variables.</p>
</dd>
<dt><code>n_state_variables</code></dt><dd><p>Number of state variables.</p>
</dd>
<dt><code>version</code></dt><dd><p>Version number of the growR package. Is written into
output files.</p>
</dd>
<dt><code>site_name</code></dt><dd><p>Name of the site to be simulated.</p>
</dd>
<dt><code>run_name</code></dt><dd><p>Name of the simulation run. Used to distinguish between
different runs at the same site.</p>
</dd>
<dt><code>year</code></dt><dd><p>Year to be simulated.</p>
</dd>
<dt><code>days_per_year</code></dt><dd><p>Number of days in this year.</p>
</dd>
<dt><code>j_start_of_growing_season</code></dt><dd><p>Index (DOY) of the day the growing season
was determined to begin.</p>
</dd>
<dt><code>cut_height</code></dt><dd><p>Height of remaining grass after cut in m.</p>
</dd>
<dt><code>parameters</code></dt><dd><p>A <a href="#topic+ModvegeParameters">ModvegeParameters</a> object.</p>
</dd>
<dt><code>determine_cut</code></dt><dd><p>Function used to decide whether a cut occurs on a
given DOY. Is overloaded depending on whether management data is
provided or not.</p>
</dd>
<dt><code>cut_DOYs</code></dt><dd><p>List of DOYs on which a cut occurred.</p>
</dd>
<dt><code>cut_during_growth_preriod</code></dt><dd><p>Boolean to indicate whether a cut
occurred during the growth period, in which case reproductive growth is
stopped.</p>
</dd>
<dt><code>last_DOY_for_initial_cut</code></dt><dd><p><strong>autocut</strong> Start cutting after this DOY,
even if yield target is not reached.</p>
</dd>
<dt><code>max_cut_period</code></dt><dd><p><strong>autocut</strong> Maximum period to wait between
subsequent cuts.</p>
</dd>
<dt><code>dry_precipitation_limit</code></dt><dd><p><strong>autocut</strong> Maximum amount of allowed
precipitation (mm) to consider a day.</p>
</dd>
<dt><code>dry_days_before_cut</code></dt><dd><p><strong>autocut</strong> Number of days that shold be dry
before a cut is made.</p>
</dd>
<dt><code>dry_days_after_cut</code></dt><dd><p><strong>autocut</strong> Number of days that shold be dry
after a cut is made.</p>
</dd>
<dt><code>max_cut_delay</code></dt><dd><p><strong>autocut</strong> Number of days a farmer is willing to
wait for dry conditions before a cut is made anyways.</p>
</dd>
<dt><code>cut_delays</code></dt><dd><p><strong>autocut</strong> Vector to keep track of cut delay times.
wait for dry conditions before a cut is made anyways.</p>
</dd>
<dt><code>dry_window</code></dt><dd><p><strong>autocut</strong> Logical that indicates if DOY at index is
considered dry enough to cut.</p>
</dd>
<dt><code>target_biomass</code></dt><dd><p><strong>autocut</strong> Biomass amount that should to be reached
by given DOY for a cut to be made.</p>
</dd>
<dt><code>end_of_cutting_season</code></dt><dd><p><strong>autocut</strong> Determined DOY after which no
more cuts are made.</p>
</dd>
<dt><code>BM_after_cut</code></dt><dd><p><strong>autocut</strong> Amount of biomass that remains after a cut
(determined through cut_height and biomass densities BDGV, BDDV, BDGR,
BDDR).</p>
</dd>
<dt><code>weather</code></dt><dd><p>A <a href="#topic+WeatherData">WeatherData</a> object.</p>
</dd>
<dt><code>management</code></dt><dd><p>A <a href="#topic+ManagementData">ManagementData</a> object. If its <code>is_empty</code> field is <code>TRUE</code>,
the autocut routine will be employed.</p>
</dd>
<dt><code>stubble_height</code></dt><dd><p>float. Minimum height the grass can assume. The
biomass will not fall below that height. This can and should therefore
be smaller than <code>self$cut_height</code>.</p>
</dd>
</dl>

</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>stubble_height</code></dt><dd><p>float. Minimum height the grass can assume. The
biomass will not fall below that height. This can and should therefore
be smaller than <code>self$cut_height</code>.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-ModvegeSite-new"><code>ModvegeSite$new()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-get_weather"><code>ModvegeSite$get_weather()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-get_management"><code>ModvegeSite$get_management()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-determine_cut_from_input"><code>ModvegeSite$determine_cut_from_input()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-determine_cut_automatically"><code>ModvegeSite$determine_cut_automatically()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-get_target_biomass"><code>ModvegeSite$get_target_biomass()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-run"><code>ModvegeSite$run()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-write_output"><code>ModvegeSite$write_output()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-set_parameters"><code>ModvegeSite$set_parameters()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot"><code>ModvegeSite$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot_bm"><code>ModvegeSite$plot_bm()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot_limitations"><code>ModvegeSite$plot_limitations()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot_water"><code>ModvegeSite$plot_water()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot_growth"><code>ModvegeSite$plot_growth()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-plot_var"><code>ModvegeSite$plot_var()</code></a>
</p>
</li>
<li> <p><a href="#method-ModvegeSite-clone"><code>ModvegeSite$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-ModvegeSite-new"></a>



<h4>Method <code>new()</code></h4>

<p>Constructor
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$new(parameters, site_name = "-", run_name = "-")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>parameters</code></dt><dd><p>A <a href="#topic+ModvegeParameters">ModvegeParameters</a> object.</p>
</dd>
<dt><code>site_name</code></dt><dd><p>string Name of the simulated site.</p>
</dd>
<dt><code>run_name</code></dt><dd><p>string Name of the simulation run. Used to
differentiate between different simulation conditions at the same site.
Defaults to &quot;-&quot;, which indicates no specific run name.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-ModvegeSite-get_weather"></a>



<h4>Method <code>get_weather()</code></h4>

<p>Return weather data if it exists
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$get_weather()</pre></div>



<h5>Returns</h5>

<p>The WeatherData object, if it exists.
</p>


<hr>
<a id="method-ModvegeSite-get_management"></a>



<h4>Method <code>get_management()</code></h4>

<p>Return management data if it exists
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$get_management()</pre></div>



<h5>Returns</h5>

<p>The ManagementData object, if it exists.
</p>


<hr>
<a id="method-ModvegeSite-determine_cut_from_input"></a>



<h4>Method <code>determine_cut_from_input()</code></h4>

<p>Read from the input whether a cut occurs on day <em>DOY</em>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$determine_cut_from_input(DOY)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>DOY</code></dt><dd><p>Integer day of the year for which to check.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Boolean <code>TRUE</code> if a cut happens on day <em>DOY</em>.
</p>


<hr>
<a id="method-ModvegeSite-determine_cut_automatically"></a>



<h4>Method <code>determine_cut_automatically()</code></h4>

<p>Decide based on simple criteria whether day of year <em>DOY</em> would be a
good day to cut.
</p>
<p>This follows an implementation described in
Petersen, Krischan, David Kraus, Pierluigi Calanca, Mikhail A.
Semenov, Klaus Butterbach-Bahl, and Ralf Kiese. “Dynamic Simulation
of Management Events for Assessing Impacts of Climate Change on
Pre-Alpine Grassland Productivity.” European Journal of Agronomy
128 (August 1, 2021): 126306.
https://doi.org/10.1016/j.eja.2021.126306.
</p>
<p>The decision to cut is made based on two criteria.
First, it is checked whether a <em>target biomass</em> is reached on given
DOY. The defined target depends on the DOY and is given through
:func:<code>get_target_biomass</code>. If said biomass is present, return <code>TRUE</code>.
</p>
<p>Otherwise, it is checked whether a given amount of time has passed
since the last cut. Depending on whether this is the first cut of
the season or not, the relevant parameters are
:int:<code>last_DOY_for_initial_cut</code> and :int:<code>max_cut_period</code>.
If that amount of time has passed, return <code>TRUE</code>, otherwise return
<code>FALSE</code>.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$determine_cut_automatically(DOY)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>DOY</code></dt><dd><p>Integer day of the year for which to make a cut decision.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>Boolean <code>TRUE</code> if a cut happens on day <em>DOY</em>.
</p>


<hr>
<a id="method-ModvegeSite-get_target_biomass"></a>



<h4>Method <code>get_target_biomass()</code></h4>

<p>Get target value of biomass on given <em>DOY</em>, which determines whether
a cut is to occur.
</p>
<p>The regression for the target biomass is based on Fig. S2 in the
supplementary material of
Petersen, Krischan, David Kraus, Pierluigi Calanca, Mikhail A.
Semenov, Klaus Butterbach-Bahl, and Ralf Kiese. “Dynamic Simulation
of Management Events for Assessing Impacts of Climate Change on
Pre-Alpine Grassland Productivity.” European Journal of Agronomy
128 (August 1, 2021): 126306.
https://doi.org/10.1016/j.eja.2021.126306.
</p>
<p>A refinement to expected yield as function of altitude has been
implemented according to Table 1a in
Huguenen-Elie et al. &quot;Düngung von Grasland&quot;, Agrarforschung Schweiz,
8, (6), 2017,
https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$get_target_biomass(DOY, intensity = "high")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>DOY</code></dt><dd><p>Integer day of the year to consider.</p>
</dd>
<dt><code>intensity</code></dt><dd><p>One of (&quot;high&quot;, &quot;middle&quot;, &quot;low&quot;) specifying
management intensity..</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>target Biomass (kg / ha) that should be reached on day <em>DOY</em>
for this management <em>intensity</em>.
</p>


<hr>
<a id="method-ModvegeSite-run"></a>



<h4>Method <code>run()</code></h4>

<p>Carry out a ModVege simulation for one year.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$run(year, weather, management)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>year</code></dt><dd><p>Integer specifying the year to consider.</p>
</dd>
<dt><code>weather</code></dt><dd><p>Weather list for given year as returned by
<a href="#topic+WeatherData">WeatherData</a><code style="white-space: pre;">&#8288;$get_weather_for_year&#8288;</code>.</p>
</dd>
<dt><code>management</code></dt><dd><p>Management list for given year as provided by
<a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a><code style="white-space: pre;">&#8288;$get_environment_for_year()&#8288;</code>.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>None Fills the state variables of this instance with the
simulated values. Access them programmatically or write them to
file using <code>write_output()</code>.
</p>


<hr>
<a id="method-ModvegeSite-write_output"></a>



<h4>Method <code>write_output()</code></h4>

<p>Write values of ModVege results into given file.
</p>
<p>A header with metadata is prepended to the actual data.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$write_output(filename, force = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>filename</code></dt><dd><p>Path or name of filename to be created or overwritten.</p>
</dd>
<dt><code>force</code></dt><dd><p>Boolean If <code>TRUE</code>, do not prompt user before writing.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>None Writes simulation results to file <em>filename</em>.
</p>


<hr>
<a id="method-ModvegeSite-set_parameters"></a>



<h4>Method <code>set_parameters()</code></h4>

<p>Savely update the values in <code>self$parameters</code>.
</p>
<p>This is just a shorthand to the underlying <code>ModvegeParameters</code>
object's <code>set_parameters()</code> function. Special care is taken to
account for potential changes to functional group weights.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$set_parameters(params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt><dd><p>List of name-value pairs of the parameters to update.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>None Updates this object's parameter values.
</p>


<hr>
<a id="method-ModvegeSite-plot"></a>



<h4>Method <code>plot()</code></h4>

<p>Create an overview plot for 16 state variables.
</p>
<p>Creates a simple base R plot showing the temporal evolution of 16
modeled state variables.
</p>
<p>Can only be sensibly run <em>after</em> a simulation has been carried out,
i.e. after this instance's <code>run()</code> method has been called.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Further arguments are discarded.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>NULL Creates a plot of the result in the active device.
</p>


<hr>
<a id="method-ModvegeSite-plot_bm"></a>



<h4>Method <code>plot_bm()</code></h4>

<p>Create an overview plot for biomass.
</p>
<p>Creates a simple base R plot showing the BM with cutting events and,
if applicable, target biomass, dBM, cBM and hvBM.
Can only be sensibly run <em>after</em> a simulation has been carried out,
i.e. after this instance's <code>run()</code> method has been called.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot_bm(smooth_interval = 28, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>smooth_interval</code></dt><dd><p>Int. Number of days over which the variable
<code>dBM</code> is smoothened.</p>
</dd>
<dt><code>...</code></dt><dd><p>Further arguments are discarded.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>NULL Creates a plot of the result in the active device.
</p>


<hr>
<a id="method-ModvegeSite-plot_limitations"></a>



<h4>Method <code>plot_limitations()</code></h4>

<p>Create an overview plot of limiting factors.
</p>
<p>Creates a simple base R plot showing the different environmental
limitation functions over time.
Can only be sensibly run <em>after</em> a simulation has been carried out,
i.e. after this instance's <code>run()</code> method has been called.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot_limitations(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Further arguments are discarded.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>NULL Creates a plot of the result in the active device.
</p>


<hr>
<a id="method-ModvegeSite-plot_water"></a>



<h4>Method <code>plot_water()</code></h4>

<p>Create an overview plot of the water balance.
</p>
<p>Creates a simple base R plot showing different variables pertaining to
the water balance, namely water reserves <em>WR</em>, actual
evapotranspiration <em>AET</em>, leaf area index <em>LAI</em> and LAI of the green
vegetative compartment <em>LAIGV</em>.
</p>
<p>Can only be sensibly run <em>after</em> a simulation has been carried out,
i.e. after this instance's <code>run()</code> method has been called.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot_water(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Further arguments are discarded.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>NULL Creates a plot of the result in the active device.
</p>


<hr>
<a id="method-ModvegeSite-plot_growth"></a>



<h4>Method <code>plot_growth()</code></h4>

<p>Create an overview plot of growth dynamics.
</p>
<p>Creates a simple base R plot showing different variables pertaining to
the growth dynamics, namely potential growth <em>PGRO</em>, effective
growth <em>GRO</em>, the reproductive function <em>REP</em> and the temperature
sum <em>ST</em>.
</p>
<p>Can only be sensibly run <em>after</em> a simulation has been carried out,
i.e. after this instance's <code>run()</code> method has been called.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot_growth(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>Further arguments are discarded.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>NULL Creates a plot of the result in the active device.
</p>


<hr>
<a id="method-ModvegeSite-plot_var"></a>



<h4>Method <code>plot_var()</code></h4>

<p>Plot the temporal evolution of a modeled state variable.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$plot_var(var, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>var</code></dt><dd><p>String. Name of the state variable to plot.</p>
</dd>
<dt><code>...</code></dt><dd><p>Further arguments are passed to the base <code><a href="graphics.html#topic+plot">plot()</a></code> function.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>None, but plots to the current device.
</p>


<hr>
<a id="method-ModvegeSite-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>ModvegeSite$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>References</h3>

<p>Jouven M, Carrère P, Baumont R (2006).
&ldquo;Model Predicting Dynamics of Biomass, Structure and Digestibility of Herbage in Managed Permanent Pastures. 1. Model Description.&rdquo;
<em>Grass and Forage Science</em>, <b>61</b>(2), 112&ndash;124.
ISSN 1365-2494, <a href="https://doi.org/10.1111/j.1365-2494.2006.00515.x">doi:10.1111/j.1365-2494.2006.00515.x</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2494.2006.00515.x">https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2494.2006.00515.x</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+autocut">autocut</a>
</p>
<p><code>get_target_biomass()</code>
</p>
<p><code>ModvegeParameters$set_parameters()</code>
</p>

<hr>
<h2 id='parameter_scan_example'>Example results of a parameter scan</h2><span id='topic+parameter_scan_example'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+run_parameter_scan">run_parameter_scan()</a></code> can take a significant time to
execute, as it typically requires a few dozen model evaluations or more.
In order to still showcase what its output can look like, and to
facilitate testing and giving examples in the documentation of tools that
make use of the output of <code><a href="#topic+run_parameter_scan">run_parameter_scan()</a></code> (such as e.g.
<code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>), this example dataset is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parameter_scan_example
</code></pre>


<h3>Format</h3>

<p>A list containing an entry for each supplied parameter set
in <em>param_values</em>. Each entry is itself a list containing the following
keys:
</p>

<dl>
<dt>params</dt><dd><p>The parameter set that was used to run growR for this
entry.</p>
</dd>
<dt>data</dt><dd><p>A list containing for each simulated year a <a href="#topic+ModvegeSite">ModvegeSite</a>
object which was run for the respective year and therefore carries the
respective results.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The input for the parameter scan that produced this output was:
</p>

<ul>
<li> 
<div class="sourceCode param_values = list(w_FGA = seq(0.25, 1, 0.25),"><pre>                       w_FGB = seq(0.25, 1, 0.25),
                       w_FGC = seq(0, 0.25, 0.25),
                       w_FGD = c(0),
                       NI = seq(0.75, 1.0, 0.25)
</pre></div>
</li></ul>

<div class="sourceCode"><pre>- `eps = 2e-2`
)
</pre></div>


<h3>See Also</h3>

<p><code><a href="#topic+run_parameter_scan">run_parameter_scan()</a></code>
</p>

<hr>
<h2 id='parse_year_strings'>Parse and generate lists of years.</h2><span id='topic+parse_year_strings'></span>

<h3>Description</h3>

<p>Parse and generate lists of years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_year_strings(year_strings)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_year_strings_+3A_year_strings">year_strings</code></td>
<td>
<p>A vector of strings that each either represents a 
single year or a sequence of year in the format 'start:stop'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>run_years List of integer vectors, representing the years to 
simulate for each run.
</p>

<hr>
<h2 id='plot_parameter_scan'>Plot Parameter Scan Results</h2><span id='topic+plot_parameter_scan'></span>

<h3>Description</h3>

<p>Visualize the results of a parameter scan and allow interactive inspection
of model performance in parameter space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_parameter_scan(analyzed, variable = "dBM", interactive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_parameter_scan_+3A_analyzed">analyzed</code></td>
<td>
<p>List; Output of <code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_parameter_scan_+3A_variable">variable</code></td>
<td>
<p>Str; Name of variable in <em>analyzed</em> to visualize. Can
be changed later with <code>PscanPlotter$set_variable()</code>. Allowed values are
the keys in <em>analyzed</em> except for <code>params</code> and <code>metrics</code>.</p>
</td></tr>
<tr><td><code id="plot_parameter_scan_+3A_interactive">interactive</code></td>
<td>
<p>boolean; Toggle between just creating a static plot
(<code>interactive = FALSE</code>) or entering a small, interactive analysis
setting (<code>interactive = TRUE</code>, default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the hood this function just creates a <a href="#topic+PscanPlotter">PscanPlotter</a> object and calls its
<code>analyze</code> method.
</p>


<h3>Value</h3>

<p>A <a href="#topic+PscanPlotter">PscanPlotter</a> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>, <a href="#topic+PscanPlotter">PscanPlotter</a><code style="white-space: pre;">&#8288;$analyze()&#8288;</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# There needs to be data available with which the modle is to be compared.
# For this example, use data provided by the package.
path = system.file("extdata", package = "growR")
datafile = file.path(path, "posieux1.csv")

# Analyze example output of `run_parameter_scan()`.
results = analyze_parameter_scan(parameter_scan_example, datafile = datafile)
# The following plots the results.
psp = plot_parameter_scan(results, interactive = FALSE)

# The interactive session can still be entered later from the returned 
# PscanPlotter object
psp$analyze()

</code></pre>

<hr>
<h2 id='plot.ModvegeSite'>Plot ModVege simulation result overview</h2><span id='topic+plot.ModvegeSite'></span>

<h3>Description</h3>

<p>This wraps the <code>ModvegeSite</code> instance's <code>plot()</code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ModvegeSite'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ModvegeSite_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+ModvegeSite">ModvegeSite</a> instance.</p>
</td></tr>
<tr><td><code id="plot.ModvegeSite_+3A_...">...</code></td>
<td>
<p>Arguments are passed on to <a href="#topic+ModvegeSite">ModvegeSite</a><code style="white-space: pre;">&#8288;$plot()&#8288;</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL, but plots to the active device.
</p>


<h3>See Also</h3>

<p>The different <code style="white-space: pre;">&#8288;[modvegeSite]$plot_XXX()&#8288;</code> methods.
</p>

<hr>
<h2 id='posieux_weather'>Example Weather Data</h2><span id='topic+posieux_weather'></span>

<h3>Description</h3>

<p>Datasets containing the weather input parameters as used by growR. The
same data is made available as plain text files by the package and
automatically found in the <code>input</code> directory created by <code><a href="#topic+setup_directory">setup_directory()</a></code>
if the <code>include_examples</code> option is set to <code>TRUE</code> (default).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posieux_weather
</code></pre>


<h3>Format</h3>

<p>A data.frame with 3652 rows and 10 variables:
</p>

<dl>
<dt>year</dt><dd><p>Year as an integer</p>
</dd>
<dt>DOY</dt><dd><p>Day of year as an integer</p>
</dd>
<dt>Ta</dt><dd><p>Average temperature of the day in degree Celsius</p>
</dd>
<dt>Tmin</dt><dd><p>Minimum temperature of the day in degree Celsius</p>
</dd>
<dt>Tmax</dt><dd><p>Maximum temperature of the day in degree Celsius</p>
</dd>
<dt>precip</dt><dd><p>Daily precipitation in mm</p>
</dd>
<dt>rSSD</dt><dd><p>Relative sunshine duration in percent</p>
</dd>
<dt>SRad</dt><dd><p>Sun irradiance in J / s / m^2. This can be converted into
photosynthetically active radiation (PAR) in MJ / m^2 as:
PAR = SRad * 0.47 * 24 * 60 * 60 / 1e6</p>
</dd>
<dt>ET0</dt><dd><p>Evapotranspiration in mm.</p>
</dd>
<dt>snow</dt><dd><p>Precipitation in the form of snow in mm</p>
</dd>
</dl>



<h3>Details</h3>

<p>For use in growR, a <a href="#topic+WeatherData">WeatherData</a> object has to be created from a plain
text file. Therefore, this dataset is only provided for convenient
inspection. In order to run growR, use the plain text files provided by
the package. Use <code>system.file("extdata", package = "growR")</code> to locate them.
</p>
<p>The <em>snow</em> column is not actually used by growR but rather calculated
through precipitation and temperatures in <a href="#topic+WeatherData">WeatherData</a><code style="white-space: pre;">&#8288;$read_weather()&#8288;</code>.
</p>
<p>Likewise, the <em>rSSD</em> column is deprecated, currently unused and only kept
for backwards compatibility.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setup_directory">setup_directory()</a></code>, <a href="#topic+WeatherData">WeatherData</a>
</p>

<hr>
<h2 id='PscanPlotter'>Plot Parameter Scan Results</h2><span id='topic+PscanPlotter'></span>

<h3>Description</h3>

<p>This class facilitates interactive visual analysis of parameter scan
results.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>analyzed</code></dt><dd><p>List, as output by <code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>.</p>
</dd>
<dt><code>params</code></dt><dd><p>Vector of names of scanned parameters.</p>
</dd>
<dt><code>metrics</code></dt><dd><p>Vector of names of model performance metrics to use.</p>
</dd>
<dt><code>n_params</code></dt><dd><p>Number of scanned parameters.</p>
</dd>
<dt><code>n_metrics</code></dt><dd><p>Number of performance metrics to apply.</p>
</dd>
<dt><code>res</code></dt><dd><p>data.frame holding parameter scan results. It contains
<code>n_params + n_metrics + 1</code> columns: one column for each scanned
parameter, one for each employed metric and an additional column
(name <code>n</code>) to give each parameter combination (i.e. each row) an
identifying number.</p>
</dd>
<dt><code>n_combinations</code></dt><dd><p>Number of rowns in <code>res</code>.</p>
</dd>
<dt><code>sorted</code></dt><dd><p>List containing copies of <code>res</code> which are each sorted by
a different performance metric. List keys are the values in
<code>self$metrics</code>.</p>
</dd>
<dt><code>selection</code></dt><dd><p>Vector of integers corresponding to the ID number of
combinations (column <code>n</code> in <code>self$res</code>) that is to be highlighted.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PscanPlotter-new"><code>PscanPlotter$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PscanPlotter-set_variable"><code>PscanPlotter$set_variable()</code></a>
</p>
</li>
<li> <p><a href="#method-PscanPlotter-analyze"><code>PscanPlotter$analyze()</code></a>
</p>
</li>
<li> <p><a href="#method-PscanPlotter-plot"><code>PscanPlotter$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-PscanPlotter-print_info"><code>PscanPlotter$print_info()</code></a>
</p>
</li>
<li> <p><a href="#method-PscanPlotter-clone"><code>PscanPlotter$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-PscanPlotter-new"></a>



<h4>Method <code>new()</code></h4>

<p>Construct and set up a <a href="#topic+PscanPlotter">PscanPlotter</a> instance.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$new(analyzed, variable = "dBM")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>analyzed</code></dt><dd><p>List; Output of <code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>.</p>
</dd>
<dt><code>variable</code></dt><dd><p>Str; Name of variable in <em>analyzed</em> to visualize. Can
be changed later with <code>set_variable()</code>. Allowed values are the keys
in <em>analyzed</em> except for <code>params</code> and <code>metrics</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PscanPlotter-set_variable"></a>



<h4>Method <code>set_variable()</code></h4>

<p>Choose which variable to visualize.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$set_variable(variable)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>variable</code></dt><dd><p>Chosen variable name. One of &quot;dBM&quot;, &quot;cBM&quot;, &quot;cBM_end&quot;</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PscanPlotter-analyze"></a>



<h4>Method <code>analyze()</code></h4>

<p>Enter analysis loop.
</p>
<p>This plots the analysis results and enters a simple command-line
interface through which more insights can be gathered. Particularly,
it allows highlighting specific parameter combinations, either by
their index number or by selecting the best performers according to a
given metric.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$analyze()</pre></div>


<hr>
<a id="method-PscanPlotter-plot"></a>



<h4>Method <code>plot()</code></h4>

<p>Plot parameter scan results.
</p>
<p>For every combination of scanned parameter and metric, a subplot is
generated in which the parameter values are plotted against
performance score in that metric for every parameter combination.
</p>
<p>The result of this is static. Use <code>PscanPlotter$analyze()</code>
for an interactive version.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$plot()</pre></div>


<hr>
<a id="method-PscanPlotter-print_info"></a>



<h4>Method <code>print_info()</code></h4>

<p>Print information on selected parameter combinations.
</p>
<p>The parameter values and performance scores of all combinations
referred to by the integers in <em>selection</em> are printed to console.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$print_info(selection)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>selection</code></dt><dd><p>Vector of integers representing IDs of parameter
combinations (i.e. column <code>n</code> in <code>self$res</code>).</p>
</dd>
</dl>

</div>


<hr>
<a id="method-PscanPlotter-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PscanPlotter$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p><code><a href="#topic+plot_parameter_scan">plot_parameter_scan()</a></code>
</p>
<p><code><a href="#topic+analyze_parameter_scan">analyze_parameter_scan()</a></code>
</p>
<p><code>PscanPlotter$plot()</code>
</p>

<hr>
<h2 id='read_config'>Read simulation run configurations from file</h2><span id='topic+read_config'></span>

<h3>Description</h3>

<p>The format of the configuration file is expected to contain 6
space-separated columns representing, in order:
</p>

<dl>
<dt>site_name</dt><dd><p>Name of simulated site. This is used, for example,
when an output file is created.</p>
</dd>
<dt>run_name</dt><dd><p>Name of this simulation run. Used to differentiate
between different runs at the same site. Can be <code>-</code> to indicate
no particular name, in which case nothing will be appended in
the resulting output file.</p>
</dd>
<dt>year(s)</dt><dd><p>Specification of years to be simulated. Either a single
number or a sequence in R's <code>:</code> notation, i.e. <code>2013:2022</code> to
indicate all years from 2013 to (including) 2022.</p>
</dd>
<dt>param_file</dt><dd><p>Filename (not full path) of parameter file to use.
The file is assumed to be located in <em>input_dir</em> (confer
documentation for that parameter).</p>
</dd>
<dt>weather_file</dt><dd><p>Filename (not full path) of weather file. See also
<em>param_file</em>.</p>
</dd>
<dt>management_file</dt><dd><p>Filename (not full path) of management file.
See also <em>param_file</em>. Can be set to <code>high</code>, <code>middle</code>, <code>low</code> or
<code>-</code> if no management data is to be used and the <em>autocut</em>
routine shall be employed to simulate cutting events.</p>
</dd>
</dl>

<p>Rows starting with a <code style="white-space: pre;">&#8288;#&#8288;</code> are skipped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_config(config_file, input_dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_config_+3A_config_file">config_file</code></td>
<td>
<p>Path to the configuration file to be read.</p>
</td></tr>
<tr><td><code id="read_config_+3A_input_dir">input_dir</code></td>
<td>
<p>Path to directory where input files are located. Defaults
to <code>getOptions("growR.input_dir", default = file.path("input"))</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a> instances corresponding to the
configurations in the order they appear in <em>config_file</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First, we set up the expected directory structure in a temporary place
tmp = file.path(tempdir(), "test-read_config")
dir.create(tmp)

# We need `force = TRUE` here in order to make the example work in 
# non-interactive settings.
setup_directory(root = tmp, include_examples = TRUE, force = TRUE)

# Now we can test `read_config`.
read_config(file.path(tmp, "example_config.txt"),
            input_dir = file.path(tmp, "input"))


</code></pre>

<hr>
<h2 id='run_parameter_scan'>Parameter Scan</h2><span id='topic+run_parameter_scan'></span>

<h3>Description</h3>

<p>Run ModVege for a different sets of parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_parameter_scan(environment, param_values, force = FALSE, outfilename = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_parameter_scan_+3A_environment">environment</code></td>
<td>
<p>Either a <a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a> instance with all the site,
management and weather inputs expected by <a href="#topic+ModvegeSite">ModvegeSite</a><code style="white-space: pre;">&#8288;$run()&#8288;</code> <strong>or</strong> a
string representing the name of a config file to read in order to
generate the <a href="#topic+ModvegeEnvironment">ModvegeEnvironment</a> with <code><a href="#topic+read_config">read_config()</a></code>. Note that, in
the latter case, only the first found configuration is used if there are
more than one valid uncommented lines in the config file.</p>
</td></tr>
<tr><td><code id="run_parameter_scan_+3A_param_values">param_values</code></td>
<td>
<p>A named list where each key stands for a ModVege
parameter, i.e. a member of <a href="#topic+ModvegeParameters">ModvegeParameters</a><code style="white-space: pre;">&#8288;$parameter_names&#8288;</code>. Each
list entry then has to be a vector containing the allowed values for the
respective parameter. All possible allowed combinations of these
parameter values are then generated and fed into a ModVege run.</p>
</td></tr>
<tr><td><code id="run_parameter_scan_+3A_force">force</code></td>
<td>
<p>Boolean. By default (<code>force = FALSE</code>), the function first
counts the number of parameter combinations that need to be run and asks
the user, if it should proceed. This can be suppressed by letting <code>force  = TRUE</code>.</p>
</td></tr>
<tr><td><code id="run_parameter_scan_+3A_outfilename">outfilename</code></td>
<td>
<p>String. If nonempty, the results are stored as an <code>rds</code>
file with filename <em>outfilename</em> using the <code><a href="base.html#topic+saveRDS">saveRDS()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results A list containing an entry for each supplied parameter set
in <em>param_values</em>. Each entry is itself a list containing the following
keys:
</p>

<dl>
<dt>params</dt><dd><p>The parameter set that was used to run ModVege for this
entry.</p>
</dd>
<dt>data</dt><dd><p>A list containing for each simulated year a <a href="#topic+ModvegeSite">ModvegeSite</a>
object which was run for the respective year and therefore carries the
respective results.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Special care has to be taken in the creation of the <em>param_values</em> argument.
It's possible to choose values that do not allow for any valid combination.
Confer <code><a href="#topic+create_combinations">create_combinations()</a></code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+ModvegeParameters">ModvegeParameters</a>, <code><a href="base.html#topic+saveRDS">saveRDS()</a></code>, <code><a href="#topic+create_combinations">create_combinations()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>env = create_example_environment()
# We're creating a trivial list of parameters to explore here in order to 
# prevent the example from requiring a long time to execute. See 
# [create_combinations()] for more realistic uses of param_values.
param_values = list(w_FGA = c(0, 1), w_FGB = c(0, 1))
run_parameter_scan(env, param_values, force = TRUE)

</code></pre>

<hr>
<h2 id='SEA'>Seasonal effect on growth</h2><span id='topic+SEA'></span>

<h3>Description</h3>

<p>Function representing the strategy of plants adjusting their roots:shoots 
ratios during the season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SEA(ST, minSEA = 0.65, maxSEA = 1.35, ST1 = 800, ST2 = 1450)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEA_+3A_st">ST</code></td>
<td>
<p>float Temperature sum in degree(C)-days.</p>
</td></tr>
<tr><td><code id="SEA_+3A_minsea">minSEA</code></td>
<td>
<p>float &lt; 1. Minimum value of SEA.</p>
</td></tr>
<tr><td><code id="SEA_+3A_maxsea">maxSEA</code></td>
<td>
<p>float &gt; 1. Maximum value of SEA.</p>
</td></tr>
<tr><td><code id="SEA_+3A_st1">ST1</code></td>
<td>
<p>float Temperature sum after which SEA declines from the maximum 
plateau.</p>
</td></tr>
<tr><td><code id="SEA_+3A_st2">ST2</code></td>
<td>
<p>float Temperature sum after which SEA reaches and remains at 
its minimum.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>SEA(800)

</code></pre>

<hr>
<h2 id='set_growR_verbosity'>Set verbosity of growR output.</h2><span id='topic+set_growR_verbosity'></span>

<h3>Description</h3>

<p>Set verbosity of growR output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_growR_verbosity(level = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_growR_verbosity_+3A_level">level</code></td>
<td>
<p>Integer representing one of the following levels:
1: ERROR, 2: WARNING, 3: INFO, 4: DEBUG, 5: TRACE
Messages with a level higher than the specified <em>level</em> are suppressed.
In other words, higher values of <em>level</em> lead to more output and vice
versa.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None Sets the option &ldquo;&quot;growR.verbosity&quot;'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># At level 3, only one of the three following messages are printed.
set_growR_verbosity(3)
logger("Message on level 5.", level = 5)
logger("Message on level 4.", level = 4)
logger("Message on level 3.", level = 3)
# At level 5, all three are printed.
set_growR_verbosity(5)
logger("Message on level 5.", level = 5)
logger("Message on level 4.", level = 4)
logger("Message on level 3.", level = 3)
# Reset to default.
set_growR_verbosity()

</code></pre>

<hr>
<h2 id='setup_directory'>Initialize growR directory structure</h2><span id='topic+setup_directory'></span>

<h3>Description</h3>

<p>Creates directories in which growR by default looks for or deposits
certain files. Also, optionally populates these directories with example
files, which are useful to familiarize oneself with the growR
simulation framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_directory(root, include_examples = TRUE, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_directory_+3A_root">root</code></td>
<td>
<p>Path to directory in which to initialize.</p>
</td></tr>
<tr><td><code id="setup_directory_+3A_include_examples">include_examples</code></td>
<td>
<p>If <code>TRUE</code> (default), include example data and
input parameters in the appropriate directories.</p>
</td></tr>
<tr><td><code id="setup_directory_+3A_force">force</code></td>
<td>
<p>boolean If <code>TRUE</code>, the user will not be asked for permission
before we write to the filesystem.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare a temporary directory to write to
tmp = file.path(tempdir(), "test-setup_directory")
dir.create(tmp)

# We need `force = TRUE` here in order to make the example work in 
# non-interactive settings.
setup_directory(root = tmp, include_examples = FALSE, force = TRUE)

# The `input`, `output` and `data` directories are now present.
list.files(tmp)

# Warnings are issued if directories are already present. Example files 
# are still copied and potentially overwritten.
setup_directory(root = tmp, include_examples = TRUE, force = TRUE)

# Example files are now present
list.files(tmp, recursive = TRUE)

# End of the example. The following code is for cleaning up.
unlink(tmp, recursive = TRUE)

</code></pre>

<hr>
<h2 id='WeatherData'>Weather Data Object</h2><span id='topic+WeatherData'></span>

<h3>Description</h3>

<p>Data structure containing weather data for a given site for several years.
</p>


<h3>Details</h3>

<p>All fields representing weather variables are vectors of length 365 times N,
where <em>N</em> is the number of years for which weather data is stored. In
other words, every variable has one value for each of the 365 of each of
the <em>N</em> years.
</p>


<h3>Weather inputs</h3>

<p>The weather input file should be organized as space separated columns
with a <code>year</code> column and at least the following parameters as headers
(further columns are ignored):
</p>

<ul>
<li> <p><code>DOY</code> day of year in given year
</p>
</li>
<li> <p><code>Ta</code> average temperature of given day (Celsius).
</p>
</li>
<li> <p><code>precip</code> precipitation in millimeter per day.
</p>
</li>
<li> <p><code>PAR</code> photosynthetically active radiation in MJ/m^2^. Can be calculated
from average sunlight irradiance <code>SRad</code> in J/s/m^2^ as:
<code>PAR = SRad * 0.47 * 24 * 60 * 60 / 1e6</code>
</p>
</li>
<li> <p><code>ET0</code> evapotranspiration in mm.
</p>
</li></ul>

<p>These parameters are stored in this object in the respective <code>PARAM_vec</code>
fields.
</p>


<h3>Snow model</h3>

<p>The precipitation and temperature inputs are used in order to estimate the
snow cover for each day by use of a snow model.
The employed model is as formulated by Kokkonen et al. 2006 and makes use
of parameters from Rango and Martinec, 1995.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>weather_file</code></dt><dd><p>Name of provided weather data file.</p>
</dd>
<dt><code>years</code></dt><dd><p>numeric Integer representation of the contained years.</p>
</dd>
<dt><code>vec_size</code></dt><dd><p>Length of the PARAM_vec vectors, which is equal to <em>number
of contained years</em> times 365.</p>
</dd>
<dt><code>year_vec</code></dt><dd><p>Vector of length <em>vec_size</em>, holding the year for the
respective index.</p>
</dd>
<dt><code>W</code></dt><dd><p>A list generated by <code>get_weather_for_year()</code> which contains
weather data only for a given year. The keys in the list are:
</p>

<ul>
<li><p> aCO2 (atmospheric CO2 concentration in ppm)
</p>
</li>
<li><p> year
</p>
</li>
<li><p> DOY
</p>
</li>
<li><p> Ta
</p>
</li>
<li><p> Ta_sm (smoothed daily average temperature)
</p>
</li>
<li><p> PAR
</p>
</li>
<li><p> PP
</p>
</li>
<li><p> PET
</p>
</li>
<li><p> liquidP
</p>
</li>
<li><p> melt
</p>
</li>
<li><p> snow
</p>
</li>
<li><p> ndays (number of days in this year)
</p>
</li></ul>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-WeatherData-new"><code>WeatherData$new()</code></a>
</p>
</li>
<li> <p><a href="#method-WeatherData-read_weather"><code>WeatherData$read_weather()</code></a>
</p>
</li>
<li> <p><a href="#method-WeatherData-ensure_file_integrity"><code>WeatherData$ensure_file_integrity()</code></a>
</p>
</li>
<li> <p><a href="#method-WeatherData-calculate_day_length"><code>WeatherData$calculate_day_length()</code></a>
</p>
</li>
<li> <p><a href="#method-WeatherData-get_weather_for_year"><code>WeatherData$get_weather_for_year()</code></a>
</p>
</li>
<li> <p><a href="#method-WeatherData-clone"><code>WeatherData$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-WeatherData-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new WeatherData object.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$new(weather_file = NULL, years = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>weather_file</code></dt><dd><p>string Path to file containing the weather data to
be read.</p>
</dd>
<dt><code>years</code></dt><dd><p>numeric Vector of years for which the weather is to be
extracted.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-WeatherData-read_weather"></a>



<h4>Method <code>read_weather()</code></h4>

<p>Read weather data from supplied <em>weather_file</em>.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$read_weather(weather_file, years = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>weather_file</code></dt><dd><p>Path to or name of file containing weather data.</p>
</dd>
<dt><code>years</code></dt><dd><p>Years for which the weather is to be extracted.
Default (NULL) is to read in all found years.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-WeatherData-ensure_file_integrity"></a>



<h4>Method <code>ensure_file_integrity()</code></h4>

<p>Check if supplied input file is formatted correctly.
</p>
<p>Check if required column names are present and fix NA entries.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$ensure_file_integrity(weather)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>weather</code></dt><dd><p>data.table of the read input file with <code>header = TRUE</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-WeatherData-calculate_day_length"></a>



<h4>Method <code>calculate_day_length()</code></h4>

<p>Calculate the expected length of day based on a site's
geographical latitude.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$calculate_day_length(latitude)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>latitude</code></dt><dd><p>numeric; geographical latitude in degrees.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-WeatherData-get_weather_for_year"></a>



<h4>Method <code>get_weather_for_year()</code></h4>

<p>Extract state variables to the weather data for given
year and return them as a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$get_weather_for_year(year)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>year</code></dt><dd><p>integer Year for which to extract weather data.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>W List containing the keys aCO2, year, DOY, Ta, Ta_sm, PAR,
PP, PET, liquidP, melt, snow, ndays.
</p>


<hr>
<a id="method-WeatherData-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>WeatherData$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>References</h3>

<p>Rango A, Martinec J (1995).
&ldquo;Revisiting the Degree-Day Method for Snowmelt Computations.&rdquo;
<em>JAWRA Journal of the American Water Resources Association</em>, <b>31</b>(4), 657&ndash;669.
ISSN 1752-1688, <a href="https://doi.org/10.1111/j.1752-1688.1995.tb03392.x">doi:10.1111/j.1752-1688.1995.tb03392.x</a>.
</p>
<p>Kokkonen T, Koivusalo H, Jakeman A, Norton J (2006).
&ldquo;Construction of a Degree-Day Snow Model in the Light of the Ten Iterative Steps in Model Development.&rdquo;
In <em>iEMSs Third Biennial Meeting: &quot;Summit on Environmental Modelling and Software&quot;. International Environmental Modelling and Software Society, Burlington, USA, July 2006</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+WeatherData">WeatherData</a><code style="white-space: pre;">&#8288;$read_weather()&#8288;</code>
</p>

<hr>
<h2 id='willmott'>Willmott Index</h2><span id='topic+willmott'></span>

<h3>Description</h3>

<p>Willmott's index of model performance as described in
Willmott (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>willmott(predicted, observed, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="willmott_+3A_predicted">predicted</code></td>
<td>
<p>Vector containing the predictions <em>y</em>.</p>
</td></tr>
<tr><td><code id="willmott_+3A_observed">observed</code></td>
<td>
<p>Vector containing the observations <em>z</em>.</p>
</td></tr>
<tr><td><code id="willmott_+3A_...">...</code></td>
<td>
<p>Scaling factor <strong>c</strong> in the denominator in the Willmott index.
The originally proposed value of 2 should be fine.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This index takes on values from -1 to 1, where values closer to 1 are
generally indicating better model performance. Values close to -1 can
either mean that the model predictions differ strongly from the
observation, or that the observations show small variance (or both).
</p>


<h3>Value</h3>

<p>willmott Value between -1 and 1
</p>


<h3>References</h3>

<p>Willmott CJ, Robeson SM, Matsuura K (2012).
&ldquo;A Refined Index of Model Performance.&rdquo;
<em>International Journal of Climatology</em>, <b>32</b>(13), 2088&ndash;2094.
ISSN 1097-0088, <a href="https://doi.org/10.1002/joc.2419">doi:10.1002/joc.2419</a>, <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2419">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2419</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_bias">get_bias()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>predicted = c(21.5, 22.2, 19.1)
observed = c(20, 20, 20)
# The Willmott index "fails" in this case, as the variance in the 
# observation is 0.
willmott(predicted, observed)

# Try with more realistic observations
observed = c(20.5, 19.5, 20.0)
willmott(predicted, observed)

</code></pre>

<hr>
<h2 id='yield_parameters'>Parameters for expected yields in Switzerland</h2><span id='topic+yield_parameters'></span>

<h3>Description</h3>

<p>The dataset contains the parameters <em>a</em> and <em>b</em> used to model the expected
gross dry matter yield (in t / ha) as a function of altitude (in m.a.s.l.) as
yield = a + b * altitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yield_parameters
</code></pre>


<h3>Format</h3>

<p>A data.frame with 4 rows and 3 variables:
</p>

<dl>
<dt>intensity</dt><dd><p>Management intensity</p>
</dd>
<dt>a</dt><dd><p>Offset <em>a</em> in t / ha</p>
</dd>
<dt>b</dt><dd><p>Slope <em>b</em> in t / ha / m</p>
</dd>
</dl>



<h3>Details</h3>

<p>Lookup Table of expected yield as functions of height and management
intensity after table 1a in Olivier Huguenin et al.
</p>


<h3>References</h3>

<p>Huguenin-Elie IEMPSALWK, Jeangros B (2017).
&ldquo;Grundlagen für die Düngung landwirtschaftlicher Kulturen in der Schweiz (GRUD), Kapitel 9: Düngung von Grasland.&rdquo;
<em>Agrarforschung Schweiz</em>.
<a href="https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/">https://www.agrarforschungschweiz.ch/2017/06/9-duengung-von-grasland-grud-2017/</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
