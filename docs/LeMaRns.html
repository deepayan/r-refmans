<!DOCTYPE html><html><head><title>Help for package LeMaRns</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LeMaRns}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_growth'><p>Calculate growth</p></a></li>
<li><a href='#calc_LFI'><p>Calculate community indicators</p></a></li>
<li><a href='#calc_M1'><p>Calculate background mortality</p></a></li>
<li><a href='#calc_M2'><p>Calculate predation mortality</p></a></li>
<li><a href='#calc_mature'><p>Calculate the proportion of mature individuals</p></a></li>
<li><a href='#calc_phi'><p>Calculate the proportion of individuals that leave each length class for each species each length class each time step.</p></a></li>
<li><a href='#calc_prefs'><p>Calculate predator-prey size preferences</p></a></li>
<li><a href='#calc_Q'><p>Calculate gear catchability</p></a></li>
<li><a href='#calc_ration_growthfac'><p>Calculate growth increments</p></a></li>
<li><a href='#calc_recruits'><p>Calculate the number of recruits</p></a></li>
<li><a href='#calc_SSB'><p>Calculate Spawning Stock Biomass (SSB) or total biomass</p></a></li>
<li><a href='#calc_suit_vect'><p>Combines prey preference and prey suitability</p></a></li>
<li><a href='#comb_LeMans_run'><p>Combine two <code>LeMans_outputs</code> objects</p></a></li>
<li><a href='#get_annual_catch'><p>Get annual catch for each species, catch per unit effort or catch per gear</p></a></li>
<li><a href='#get_indicators'><p>Calculate indicators</p></a></li>
<li><a href='#get_N0'><p>Generate a starting value for N</p></a></li>
<li><a href='#get_rec_fun'><p>Collate the stock recruitment functions</p></a></li>
<li><a href='#get_SSB'><p>Calculate Spawning Stock Biomass (SSB) or total biomass</p></a></li>
<li><a href='#LeMans_outputs-class'><p>An S4 class representing the outputs of the LeMans model</p></a></li>
<li><a href='#LeMans_param-class'><p>An S4 class representing the inputs of the LeMans model</p></a></li>
<li><a href='#LeMansParam'><p>A constructor for the <code>LeMansParam</code> class</p></a></li>
<li><a href='#make_rec_fun'><p>Generate the stock recruitment functions</p></a></li>
<li><a href='#NS_eta'><p>The steepness of the slope of the catchability curve</p></a></li>
<li><a href='#NS_L50'><p>The length at 50% of the maximum catchability of the catchability curve</p></a></li>
<li><a href='#NS_mixed_fish'><p>Gear selectivity data frame</p></a></li>
<li><a href='#NS_other'><p>Other food for the North Sea</p></a></li>
<li><a href='#NS_par'><p>North Sea data</p></a></li>
<li><a href='#NS_tau'><p>North Sea interaction matrix</p></a></li>
<li><a href='#plot_indicators'><p>Plot indicators</p></a></li>
<li><a href='#plot_SSB'><p>Plot Spawning Stock Biomass (SSB)</p></a></li>
<li><a href='#rec_BH'><p>The Beverton-Holt stock recruitment function</p></a></li>
<li><a href='#rec_const'><p>The constant stock recruitment function</p></a></li>
<li><a href='#rec_hockey'><p>The hockey-stick stock recruitment function</p></a></li>
<li><a href='#rec_linear'><p>The density-independent stock recruitment function</p></a></li>
<li><a href='#rec_Ricker'><p>The Ricker stock recruitment function</p></a></li>
<li><a href='#run_LeMans'><p>Project the LeMans model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Length-Based Multispecies Analysis by Numerical Simulation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-09</td>
</tr>
<tr>
<td>Description:</td>
<td>Set up, run and explore the outputs of the Length-based Multi-species model (LeMans; Hall et al. 2006 &lt;<a href="https://doi.org/10.1139%2Ff06-039">doi:10.1139/f06-039</a>&gt;), focused on the marine environment.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.0</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, abind, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'NS_par.R' 'RcppExports.R' 'calc_M1.R' 'calc_Q.R'
'calc_growth.R' 'calc_indicators.R' 'calc_mature.R'
'param_setup.R' 'run_LeMans.R' 'calc_output.R' 'calc_phi.R'
'calc_prefs.R' 'calc_ration_growthfac.R' 'calc_recruits.R'
'calc_suit_vect.R' 'get_Catch.R' 'get_SSB.R' 'get_indicators.R'
'other.R' 'plot_SSB.R' 'plot_indicators.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-09 13:49:56 UTC; MS23</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael A. Spence <a href="https://orcid.org/0000-0002-3445-7979"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hayley J. Bannister
    <a href="https://orcid.org/0000-0002-2546-5168"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Johnathan E. Ball [aut],
  Paul J. Dolder <a href="https://orcid.org/0000-0002-4179-712X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Robert B. Thorpe <a href="https://orcid.org/0000-0001-8193-6932"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Christopher A. Griffiths [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael A. Spence &lt;michael.spence@cefas.co.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-09 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_growth'>Calculate growth</h2><span id='topic+calc_growth'></span>

<h3>Description</h3>

<p>Calculates the number of individuals of each species in each length class for the next time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_growth(N, phi, nfish, nsc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_growth_+3A_n">N</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class for the current time step.</p>
</td></tr>
<tr><td><code id="calc_growth_+3A_phi">phi</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the proportion of individuals that leave each length class.</p>
</td></tr>
<tr><td><code id="calc_growth_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_growth_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals of each species in each length class for the next time step.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf) * 1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate growth
growth &lt;- calc_growth(N0, phi, nfish, nsc)
</code></pre>

<hr>
<h2 id='calc_LFI'>Calculate community indicators</h2><span id='topic+calc_LFI'></span><span id='topic+calc_LQ'></span><span id='topic+calc_TyL'></span>

<h3>Description</h3>

<p>Calculates the Large Fish Indicator (LFI), Typical Length (TyL) or Length Quantile (LQ) for the community or a subset of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_LFI(wgt, N, bry, prop)

calc_LQ(wgt, u_bound, N, prob)

calc_TyL(wgt, mid, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_LFI_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_n">N</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class for the current time step.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_bry">bry</code></td>
<td>
<p>A numeric vector representing the length classes that are larger than <code>length_LFI</code>.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_prop">prop</code></td>
<td>
<p>A numeric value between 0 and 1 representing how far along, as a proportion, the value of the large indicator threshold is in the length class that contains it.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_prob">prob</code></td>
<td>
<p>A numeric value or vector between 0 and 1 denoting the LQ to be calculated.</p>
</td></tr>
<tr><td><code id="calc_LFI_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>calc_LFI</code> returns a numeric value or vector representing the proportion of the biomass in the length classes above <code>bry</code> and in <code>prop</code> of the biomass in the length class <code>bry</code>.
</p>
<p><code>calc_TYL</code> returns a numeric value or vector representing the biomass-weighted geometric mean length of the community.
</p>
<p><code>calc_LQ</code> returns a numeric value or vector representing the length at which biomass exceeds a given proportion <code>prob</code> of the total biomass.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_indicators">get_indicators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e11)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate the LFI for 40cm
bry &lt;- which(NS_params@l_bound&lt;=40 &amp; NS_params@u_bound&gt;40)
length_LFI &lt;- 40
prop &lt;- (length_LFI-NS_params@l_bound[bry])/(NS_params@u_bound[bry]-NS_params@l_bound[bry])
LFI &lt;- calc_LFI(model_run@N[,,101], NS_params@wgt, bry, prop)

# Calculate TyL for the final time step
calc_TyL(wgt=NS_params@wgt, mid=NS_params@mid, N=model_run@N[,,101])

# Calculate the LQ for the final time step
calc_LQ(wgt=NS_params@wgt, u_bound=NS_params@u_bound, N=model_run@N[,,101], prob=0.5)
</code></pre>

<hr>
<h2 id='calc_M1'>Calculate background mortality</h2><span id='topic+calc_M1'></span><span id='topic+get_M1'></span><span id='topic+calc_M1_stdRNM'></span><span id='topic+calc_M1_lin'></span><span id='topic+calc_M1_constRNM'></span>

<h3>Description</h3>

<p>Calculates the background mortality of each species in each length class per time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_M1(
  nsc,
  sc_Linf,
  phi_min,
  natmort_opt = rep("std_RNM", length(sc_Linf)),
  Nmort = rep(0.8, length(sc_Linf)),
  prop = rep(0.75, length(sc_Linf))
)

get_M1(nsc, sc_Linf, natmort_opt, Nmort, prop)

calc_M1_stdRNM(nsc, sc_Linf, Nmort = 0.8, prop = 0.75)

calc_M1_lin(nsc, sc_Linf, Nmort = 0.8)

calc_M1_constRNM(nsc, sc_Linf, Nmort = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_M1_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_M1_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> for <code>calc_M1</code> and 1 for <code>get_M1</code>, <code>calc_M1_stdRNM</code>, <code>calc_M1_constRNM</code> and <code>calc_M1_lin</code>, representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="calc_M1_+3A_phi_min">phi_min</code></td>
<td>
<p>A numeric value representing the time step of the model.</p>
</td></tr>
<tr><td><code id="calc_M1_+3A_natmort_opt">natmort_opt</code></td>
<td>
<p>A character vector of length <code>nfish</code> for <code>calc_M1</code> and 1 for <code>get_M1</code>, describing the mortality function to be used for each species. By default, <code>natmort_opt</code> takes the value <code>"std_RNM"</code>, but it can also take <code>"constant"</code> or <code>"linear"</code>. See 'Details' for more information.</p>
</td></tr>
<tr><td><code id="calc_M1_+3A_nmort">Nmort</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the maximum background mortality of each species. The default is <code>0.8</code> for all species.</p>
</td></tr>
<tr><td><code id="calc_M1_+3A_prop">prop</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the proportion of length classes that have a non-zero background mortality. This parameter is required only when the <code>natmort_opt</code> mortality function is used. The default is <code>0.75</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The background mortality is defined as the number of individuals that die per year, but not from predation or fishing
</p>
<p><code>N*exp(-M1)</code>
</p>
<p>where <code>N</code> is the total number of individuals. This function allows three different models for background mortality: (1) <code>"constant"</code>, which gives <code>M1=Nmort</code> for all length classes up to and including the <code>sc_Linf</code>-th class; (2) <code>"std_RNM"</code>, which gives <code>M1=Nmort</code> for all length classes between <code>floor(sc_Linf*prop)</code> and the <code>sc_Linf</code>-th class and <code>M1=0</code> for the rest; and (3) <code>"linear"</code>, which gives <code>M1=0</code> for the first length class, followed by a linear increase in <code>M1</code> up to and including the <code>sc_Linf</code>-th length class <code>M1=Nmort</code> and <code>M1=0</code> for the rest.
</p>


<h3>Value</h3>

<p><code>calc_M1</code> returns a matrix of dimensions <code>nsc</code> and <code>nfish</code> representing the background mortality of each species for each length class.
</p>
<p><code>get_M1</code> returns a numeric vector of length <code>nsc</code> representing the background mortality for each length class.
</p>
<p><code>calc_M1_stdRNM</code> returns a numeric vector of length <code>nsc</code> representing the background mortality for each length class. <code>M1=Nmort</code> for all length classes between <code>floor(sc_Linf*prop)</code> and the <code>sc_Linf</code>-th class and <code>M1=0</code> for the rest.
</p>
<p><code>calc_M1_lin</code> returns a numeric vector of length <code>nsc</code> representing the background mortality for each length class. <code>M1=0</code> for the first length class. <code>M1</code> then increases linearly up to and including the <code>sc_Linf</code>-th length class. For all length classes above <code>sc_Linf</code>, <code>M1=0</code>.
</p>
<p><code>calc_M1_constRNM</code> returns a numeric vector of length <code>nsc</code> representing the background mortality for each length class. <code>M1=Nmort</code> for all length classes up to and including the <code>sc_Linf</code>-th class. For all length classes above <code>sc_Linf</code>, <code>M1=0</code>.
</p>


<h3>References</h3>

<p>Thorpe, R.B., Jennings, S., Dolder, P.J. (2017). Risks and benefits of catching pretty good yield in multispecies mixed fisheries. <em>ICES Journal of Marine Science</em>, 74(8):2097-2106.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf

# Calculate background mortality with natmort_opt="std_RNM", Nmort=0.8 and prop=0.75 for all species
M1 &lt;- calc_M1(nsc, sc_Linf, phi_min)

# Get background mortality with natmort_opt="std_RNM", Nmort=0.8 and prop=0.75 for all species
natmort_opt &lt;- "std_RNM"
Nmort &lt;- 0.8
prop &lt;- 0.75
get_M1(nsc, sc_Linf, natmort_opt, Nmort, prop)

# Calculate standard residual background mortality
M1_stdRNM &lt;- calc_M1_stdRNM(nsc, sc_Linf)

# Calculate linear background mortality
M1_lin &lt;- calc_M1_lin(nsc, sc_Linf,Nmort=0.3)

# Calculate constant residual background mortality
M1_constRNM &lt;- calc_M1_constRNM(nsc, sc_Linf)
</code></pre>

<hr>
<h2 id='calc_M2'>Calculate predation mortality</h2><span id='topic+calc_M2'></span>

<h3>Description</h3>

<p>Calculates the predation mortality for each species in each length class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_M2(N, ration, wgt, nfish, nsc, other, sc_Linf, suit_M2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_M2_+3A_n">N</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class for the current time step.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_ration">ration</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the amount of food required for fish of a given species and length class to grow according to the von Bertalanffy growth curve in a time step.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_other">other</code></td>
<td>
<p>A numeric value representing the amount of other food (g) available from prey that is not explicitly represented in the model.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="calc_M2_+3A_suit_m2">suit_M2</code></td>
<td>
<p>A list object of length <code>nfish</code>. Each element in the list is an array of dimensions <code>nsc</code>, <code>nsc</code> and <code>nfish</code> containing a value between zero and 1 representing prey preference and prey suitability for each species and length class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predation mortality of the <code>i</code>th species in the <code>j</code>th length class is
</p>
<p><code>sum_m(sum_n(I[j,i]*N[j,i]*suit_M2[[m]][n,j,i]/</code>
</p>
<p><code>(sum_k(sum_l(suit_M2[[m]][n,l,k]wgt[l,k]N[l,k]))+other)))</code>
</p>
<p>where <code>sum_m</code> represents the sum over all <code>m</code>, <code>sum_n</code> represents the sum over all <code>n</code>, <code>sum_l</code> represents the sum over all <code>l</code> and <code>sum_k</code> represents the sum over all <code>k</code>. This equation corresponds to a Holling type-II functional response. See equation 8 of Hall et al. (2006) for more details.
</p>


<h3>Value</h3>

<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the the predation mortality for each species in each length class.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
ration &lt;- tmp$ration
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt
g_eff &lt;- tmp$g_eff

# Calculate predator-prey size preferences
prefs &lt;- calc_prefs(pred_mu=-2.25, pred_sigma=0.5, wgt, sc_Linf)

# Calculate prey preference and prey suitability
suit_M2 &lt;- calc_suit_vect(nsc, nfish, sc_Linf, prefs, NS_tau)


# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the predation mortality
M2 &lt;- calc_M2(N0, ration, wgt, nfish, nsc, other=1e12, sc_Linf, suit_M2)
</code></pre>

<hr>
<h2 id='calc_mature'>Calculate the proportion of mature individuals</h2><span id='topic+calc_mature'></span>

<h3>Description</h3>

<p>Calculates the proportion of individuals that are mature for each species and length class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_mature(Lmat, nfish, mid, kappa, sc_Linf, eps = 1e-05, force_mature = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_mature_+3A_lmat">Lmat</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the length at which 50% of individuals are mature for each species.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_kappa">kappa</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the rate of change from immaturity to maturity for each species.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_eps">eps</code></td>
<td>
<p>A numeric value specifying a numerical offset. The default is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="calc_mature_+3A_force_mature">force_mature</code></td>
<td>
<p>A logical statement indicating whether to force all fish in the largest length class to be mature. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The proportion of individuals in the <code>j</code>th length class of the <code>i</code>th species that are mature is described by a logistic model
</p>
<p><code>1/(1+exp(-kappa[i]*(mid[j]-Lmat[i])))</code>
</p>


<h3>Value</h3>

<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> and elements in the range 0-1 representing the proportion of individuals that are mature for each species and length class.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf

# Calculate the proportion of mature individuals
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)
</code></pre>

<hr>
<h2 id='calc_phi'>Calculate the proportion of individuals that leave each length class for each species each length class each time step.</h2><span id='topic+calc_phi'></span>

<h3>Description</h3>

<p>Calculate the proportion of individuals of each species that leave each length class at each time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_phi(
  k,
  Linf,
  nsc,
  nfish,
  u_bound,
  l_bound,
  calc_phi_min = FALSE,
  phi_min = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_phi_+3A_k">k</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the von Bertalanffy growth parameter <code>(1/yr)</code> for each species.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_linf">Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the asymptotic length of each species.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_l_bound">l_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_calc_phi_min">calc_phi_min</code></td>
<td>
<p>A logical statement indicating whether <code>phi_min</code> should be calculated within the function. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="calc_phi_+3A_phi_min">phi_min</code></td>
<td>
<p>A fixed numeric value of <code>phi_min</code>, which represents the time step of the model. This is only required if <code>calc_phi_min=FALSE</code>. The default is <code>0.1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the time (yrs) for an average fish to grow from the lower to the upper bound of a length class assuming von Bertalanffy growth. The values are scaled to the fastest growing fish and length class combination in order to calculate the proportion of individuals leaving each length class in a time step.
</p>


<h3>Value</h3>

<p>A list object containing <code>phi</code> and <code>phi_min</code>. <code>phi</code> is a matrix of dimensions <code>nsc</code> and <code>nfish</code> representing the proportion of individuals of each species that leave each length class. <code>phi_min</code> is a numeric value representing the time step of the model.
</p>


<h3>References</h3>

<p>Hilborn, R. &amp; Walters, C.J. (1992). Quantitative Fisheries Stock Assessment. Springer.
</p>
<p>von Bertalanffy, L. (1957). Quantitative Laws in Metabolism and Growth. <em>The Quarterly Review of Biology</em>, 32:217-231.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Calculate the proportion of individuals that leave each length class
# with and without a fixed value for phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min

tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=TRUE) # without fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min
</code></pre>

<hr>
<h2 id='calc_prefs'>Calculate predator-prey size preferences</h2><span id='topic+calc_prefs'></span>

<h3>Description</h3>

<p>Calculates the size preference of each predator species in each length class for each prey species in each length class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_prefs(pred_mu, pred_sigma, wgt, sc_Linf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_prefs_+3A_pred_mu">pred_mu</code></td>
<td>
<p>A numeric value representing the preferred predator-prey mass ratio.</p>
</td></tr>
<tr><td><code id="calc_prefs_+3A_pred_sigma">pred_sigma</code></td>
<td>
<p>A numeric value representing the width of the weight preference function.</p>
</td></tr>
<tr><td><code id="calc_prefs_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="calc_prefs_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A predator of species <code>i</code> in length class <code>j</code> has a size preference for species <code>k</code> in length class <code>l</code> equal to
</p>
<p><code>exp(-(log10(wgt[l, k]/wgt[j, i])-pred_mu)^2/(2*pred_sigma))</code>.
</p>


<h3>Value</h3>

<p>An array of dimensions <code>nsc</code>, <code>nfish</code>, <code>nsc</code> and <code>nfish</code>. The first and second dimensions represent the prey species whereas the third and fourth dimensions represent the predator species.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Ursin, E. (1973). On the prey size preferences of cod and dab. <em>Meddelelser fra Danmarks Fiskeri-og Havundersgelser</em>, 7:85-98.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate predator-prey size preferences
prefs &lt;- calc_prefs(pred_mu=-2.25, pred_sigma=0.5, wgt, sc_Linf)
</code></pre>

<hr>
<h2 id='calc_Q'>Calculate gear catchability</h2><span id='topic+calc_Q'></span><span id='topic+get_Q'></span><span id='topic+logistic_catch'></span><span id='topic+log_gaussian_catch'></span><span id='topic+knife_edge_catch'></span>

<h3>Description</h3>

<p>Calculates the catchability for each fishing gear.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_Q(
  curve = rep("logistic", nfish),
  species = ((0:(length(curve) - 1))%%nfish) + 1,
  max_catchability = rep(1, length(curve)),
  gear_name = paste("gear_", 1:length(curve), sep = ""),
  custom = NULL,
  nsc,
  nfish,
  l_bound,
  u_bound,
  mid,
  eps = 1e-05,
  species_names,
  ...
)

get_Q(curve, species, gear_name, nsc, nfish, l_bound, u_bound, mid, eps, ...)

logistic_catch(species, nsc, nfish, mid, eps, L50 = 50, eta = 0.25, ...)

log_gaussian_catch(species, nsc, nfish, mid, eps, Lmu = 50, Lsigma = 1, ...)

knife_edge_catch(species, nsc, nfish, l_bound, u_bound, Lmin = 50, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_Q_+3A_curve">curve</code></td>
<td>
<p>A character vector of almost any length describing the type of curve to be used to determine the catchability of each species by the fishing gear. By default, <code>curve</code> is a character vector of length <code>nfish</code> that takes the value <code>"logistic"</code> in each element, but it can also take <code>"log-gaussian"</code> or <code>"knife-edge"</code>. If a custom curve is required for a particular species and/or fishing gear, the curve must be specified in <code>custom</code>. See 'Details' for more information.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_species">species</code></td>
<td>
<p>A numeric or character vector of the same length as <code>curve</code> describing the species that each element of <code>curve</code> relates to. By default, <code>species</code> is a numeric vector of length <code>curve</code> that takes the values <code>(0:(length(curve)-1))%%(nfish)+1</code>.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_max_catchability">max_catchability</code></td>
<td>
<p>A numeric vector of length <code>curve</code> describing the maximum catchability for each catchability curve.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_gear_name">gear_name</code></td>
<td>
<p>A character vector of the same length as <code>curve</code> and <code>species</code> describing the fishing gear that each element of <code>curve</code> and <code>species</code> relates to. By default, <code>gear_name</code> is a character vector of length <code>curve</code> that takes the value <code>paste("gear_", 1:length(curve), sep = "")</code>.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_custom">custom</code></td>
<td>
<p>An array of dimensions <code>nsc</code>, <code>nfish</code> and the number of custom catchability curves that are required. <code>custom</code> represents the catchability of each species by the gears specified using custom catchability curves. By default, <code>custom</code> is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of fish species in the model.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_l_bound">l_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_eps">eps</code></td>
<td>
<p>A numeric value specifying a numerical offset. The default is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_species_names">species_names</code></td>
<td>
<p>A character vector of length <code>nfish</code> that is the name of the species in the same order as the species parameters.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_...">...</code></td>
<td>
<p>Vectors of the same length as <code>curve</code> representing the parameters of the catchability curves. See 'Details' for more information.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_l50">L50</code></td>
<td>
<p>A numeric value representing the length at 50% of the maximum catchability of the catchability curve. This is used with the <code>logistic_catch</code> function. The default value is 50.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_eta">eta</code></td>
<td>
<p>A numeric value representing the steepness of the slope of the catchability curve. This is used with the <code>logistic_catch</code> function. The default value is 0.25</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_lmu">Lmu</code></td>
<td>
<p>A numeric value representing the length at the maximum catchability of the catchability curve. This is used with the <code>log_gaussian_catch</code> function. The default value is 50.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_lsigma">Lsigma</code></td>
<td>
<p>A numeric value representing the standard deviation of the catchability curve. See 'Details' for more information. This is used with the <code>log_gaussian_catch</code> function. The default value is 1.</p>
</td></tr>
<tr><td><code id="calc_Q_+3A_lmin">Lmin</code></td>
<td>
<p>A numeric value representing the minimum length that is caught by the catchability curve. This is used with the <code>knife_edge_catch</code> function. The default value is 50.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows three different models for catchability, all of which are rescaled so that their maximum catchability is equal to one:
</p>
<p>(1) <code>"logistic"</code> is proportional to
</p>
<p><code>1/(1+exp(-eta*(mid-L50)))</code>;
</p>
<p>(2) <code>"log-gaussian"</code> is proportional to
</p>
<p><code>dlnorm(mid, log(Lmu), Lsigma)</code>;
</p>
<p>and (3) <code>"knife-edge"</code> is equal to 1 for the length classes indexed by <code>max(which(l_bound&lt;Lmin)):nsc</code> and 0 for all other length classes. This means that all of the individuals in the length class containing <code>Lmin</code> will have a catchability of 1.
</p>
<p>In <code>calc_Q</code> the catchability is rescaled so that the maximum catchability is one.
</p>


<h3>Value</h3>

<p><code>calc_Q</code> returns an array of dimensions <code>nsc</code>, <code>nfish</code> and <code>gear</code> representing the catchability of each species by each of the fishing gears, scaled from 0 to <code>max_catchability</code>.
</p>
<p><code>get_Q</code> returns a catchability curve for a given species and gear scaled from 0 to 1. If an invalid catchability curve is selected, <code>NULL</code> is returned and a warning message is shown.
</p>
<p><code>logistic_catch</code> returns a matrix with dimensions <code>nsc</code> and <code>nfish</code> with all elements set to zero excluding one column that represents the logistic catchability curve for the selected species scaled from 0 to 1.
</p>
<p><code>log_gaussian_catch</code> returns a matrix with dimensions <code>nsc</code> and <code>nfish</code> with all elements set to zero excluding one column that represents the log-gaussian catchability curve for the selected species scaled from 0 to 1.
</p>
<p><code>knife_edge_catch</code> returns a matrix with dimensions <code>nsc</code> and <code>nfish</code> with all elements set to zero excluding one column that represents the knife-edge catchability curve for the selected species scaled from 0 to 1.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Thorpe, R.B., Jennings, S., Dolder, P.J. (2017). Risks and benefits of catching pretty good yield in multispecies mixed fisheries. <em>ICES Journal of Marine Science</em>, 74(8):2097-2106.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dlnorm">dlnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Calculate gear catchability
Qs &lt;- calc_Q(curve=rep("logistic", nfish), species=NS_par$species_names,
             max_catchability=rep(1, nfish), gear_name=NS_par$species_names,
             nsc=nsc, nfish=nfish, mid=mid, l_bound=l_bound, u_bound=u_bound,
             species_names=NS_par$species_names, eta=rep(0.25, nfish), L50=Lmat)

# Calculate logistic catchability for the first species
logistic_catch(species=1, nsc, nfish, mid, eps=1e-5,L50=Lmat[1], eta=0.25)

# Calculate log-gaussian catchability for the first species
log_gaussian_catch(species=1, nsc, nfish, mid, eps=1e-5, Lmu=50, Lsigma=1)

# Calculate knife-edge catchability for the first species
knife_edge_catch(species=1, nsc, nfish, l_bound, u_bound, Lmin=50)
</code></pre>

<hr>
<h2 id='calc_ration_growthfac'>Calculate growth increments</h2><span id='topic+calc_ration_growthfac'></span>

<h3>Description</h3>

<p>Calculates the amount of food required for fish of a given species and length class to grow according to the von Bertalanffy growth curve in a time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_ration_growthfac(
  k,
  Linf,
  nsc,
  nfish,
  l_bound,
  u_bound,
  mid,
  W_a,
  W_b,
  phi_min,
  vary_growth = TRUE,
  growth_eff = 0.5,
  growth_eff_decay = 0.11
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_ration_growthfac_+3A_k">k</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the von Bertalanffy growth parameter <code>(1/yr)</code> for each species.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_linf">Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the asymptotic length of each species.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_l_bound">l_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_w_a">W_a</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the parameter <code>a</code> in the length-weight conversion. See 'Details' for more information.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_w_b">W_b</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the parameter <code>b</code> in the length-weight conversion. See 'Details' for more information.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_phi_min">phi_min</code></td>
<td>
<p>A numeric value representing the time step of the model.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_vary_growth">vary_growth</code></td>
<td>
<p>A logical statement indicating whether growth efficiency should vary for each species (<code>vary_growth=TRUE</code>) or be fixed at the value given by <code>fixed_growth</code> (<code>vary_growth=FALSE</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_growth_eff">growth_eff</code></td>
<td>
<p>If <code>vary_growth==TRUE</code>, <code>growth_eff</code> is a numeric representing the growth efficiencies of a fish of length 0. If <code>vary_growth==FALSE</code>, <code>growth_eff</code> is a numeric value of length <code>1</code> representing a fixed growth efficiency for all fish. The default is 0.5.</p>
</td></tr>
<tr><td><code id="calc_ration_growthfac_+3A_growth_eff_decay">growth_eff_decay</code></td>
<td>
<p>A numeric value specifying the rate at which growth efficiency decreases as length approaches <code>Linf</code>. The default is 0.11.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weight increments of the <code>i</code>th species in the <code>j</code>th length class is calculated by determining the amount an individual will grow in one time step, <code>phi_min</code>, if it were to follow the von Bertalanffy growth curve
</p>
<p><code>L22=(Linf[i]-mid[j])*(1-exp(-k[i]*phi_min))</code>.
</p>
<p>The weight of a fish at the mid-point of the size class is calculated using the length-weight relationship
</p>
<p><code>wgt[j,i] = a[i]*mid[j]^b[i]</code>,
</p>
<p>and similarly the expected change in weight of the the fish is calculated as
</p>
<p><code>growth_inc = (W_a[i]*L22^W_b[i])</code>.
</p>
<p>It also has a growth efficiency
</p>
<p><code>g_eff[j, i]=(1-(wgt[j,i]/(W_a[i]*Linf[i]^W_b[i]))^growth_eff_decay)*growth_eff</code>
</p>
<p>if <code>vary_growth==TRUE</code> or <code>g_eff[j, i]=growth_eff</code> otherwise.
</p>
<p><code>ration</code> is then calculated by
</p>
<p><code>growth_inc*(1/g_eff[j, i])</code>.
</p>


<h3>Value</h3>

<p>A list object containing <code>ration</code>, <code>sc_Linf</code>, <code>wgt</code> and <code>g_eff</code>. <code>ration</code> is a matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the amount of food required for fish of a given species and length class to grow according to the von Bertalanffy growth curve in a time step. <code>sc_Linf</code> is a numeric vector of length <code>nfish</code> representing the length class at which each species reaches <code>Linf</code>. <code>wgt</code> is a matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class. <code>g_eff</code> is a matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the growth efficiency of each species in each length class.
</p>


<h3>References</h3>

<p>von Bertalanffy, L. (1957). Quantitative Laws in Metabolism and Growth. <em>The Quarterly Review of Biology</em>, 32:217-231
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
ration &lt;- tmp$ration
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt
g_eff &lt;- tmp$g_eff
</code></pre>

<hr>
<h2 id='calc_recruits'>Calculate the number of recruits</h2><span id='topic+calc_recruits'></span>

<h3>Description</h3>

<p>Calculates the number of recruits of each species in a year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_recruits(SSB, stored_rec_funs, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_recruits_+3A_ssb">SSB</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the Spawning Stock Biomass (SSB) of each species.</p>
</td></tr>
<tr><td><code id="calc_recruits_+3A_stored_rec_funs">stored_rec_funs</code></td>
<td>
<p>A list object of length <code>nfish</code> that is used to store the generated stock recruitment functions.</p>
</td></tr>
<tr><td><code id="calc_recruits_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code> that is used to store the parameters of the stock recruitment functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length <code>nfish</code> representing the number of new recruits of each species.
</p>


<h3>References</h3>

<p>Barrowman, N.J., Myers, R.A. (2000).  Still more spawner-recruit curves: the hockey stick and its generalisations. <em>Canadian Journal of Fisheries and Aquatic Science</em>, 57:665–676.
</p>
<p>Beverton, R.J.H., Holt, S.J. (1957). On the Dynamics of Exploited Fish Populations, volume 19 of Fisheries Investigations (Series 2). United Kingdom Ministry of Agriculture and Fisheries.
</p>
<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Ogle, D.H. (2016). Introductory Fisheries Analyses with R. CRC Press.
</p>
<p>Ricker, W.E. (1954). Stock and recruitment. <em>Journal of the Fisheries Research Board of Canada</em>, 11:559-623.
</p>
<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

# Calculate the number of recruits
R &lt;- calc_recruits(SSB, stored_rec_funs, recruit_params)
</code></pre>

<hr>
<h2 id='calc_SSB'>Calculate Spawning Stock Biomass (SSB) or total biomass</h2><span id='topic+calc_SSB'></span><span id='topic+calc_biomass'></span>

<h3>Description</h3>

<p>Calculates the spawning stock biomass (SSB) or total biomass of each species in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_SSB(wgt, mature, N)

calc_biomass(wgt, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_SSB_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="calc_SSB_+3A_mature">mature</code></td>
<td>
<p>A matrix with dimensions <code>ncs</code> and <code>nfish</code> with elements in the range 0-1 representing the proportion of mature individuals of each species in each length class.</p>
</td></tr>
<tr><td><code id="calc_SSB_+3A_n">N</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class for the current time step.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Spawning Stock Biomass is equal to <code>colSums(mature*N*wgt)</code> and the total biomass is equal to <code>colSums(mature*N*wgt)</code>.
</p>


<h3>Value</h3>

<p><code>calc_SSB</code> returns a numeric vector of length <code>nfish</code> representing the SSB of each species (g).
</p>
<p><code>calc_biomass</code> returns a numeric vector of length <code>length(species)</code> where the <code>j</code>th element is the biomass (g) of the <code>j</code>th species.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate SSB
calc_SSB(wgt=NS_params@wgt, mature=NS_params@mature, N=model_run@N[,,101])

# Calculate biomass in the last time step
calc_biomass(wgt=NS_params@wgt, N=model_run@N[,,101])
</code></pre>

<hr>
<h2 id='calc_suit_vect'>Combines prey preference and prey suitability</h2><span id='topic+calc_suit_vect'></span>

<h3>Description</h3>

<p>Calculates a combined value for prey preference and prey suitability standardised to a value between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_suit_vect(nsc, nfish, sc_Linf, prefs, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_suit_vect_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="calc_suit_vect_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of species in the model.</p>
</td></tr>
<tr><td><code id="calc_suit_vect_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="calc_suit_vect_+3A_prefs">prefs</code></td>
<td>
<p>An array of dimensions <code>nsc</code>, <code>nfish</code>, <code>nsc</code> and <code>nfish</code>. The first and second dimensions represent the prey whereas the the third and fourth dimensions represent the predator.</p>
</td></tr>
<tr><td><code id="calc_suit_vect_+3A_tau">tau</code></td>
<td>
<p>A matrix of dimensions <code>nfish</code> and <code>nfish</code>. Row indices represent predators and column indices represent prey. A value of 1 at location <code>i</code>, <code>j</code> indicates prey <code>j</code> is eaten by predator <code>i</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tau</code> values are assigned to an array of dimensions <code>nsc</code>, <code>nfish</code>, <code>nsc</code> and <code>nfish</code> and multiplied by the array <code>prefs</code>. This creates an array of dimensions <code>nsc</code>, <code>nfish</code>, <code>nsc</code> and <code>nfish</code> indicating prey suitability. Prey suitability is then standardised to sum to 1 for each predator species in each length class.
</p>


<h3>Value</h3>

<p>A list object of length <code>nfish</code>. Each element in the list is an array of dimensions <code>nsc</code>, <code>nsc</code> and <code>nfish</code> containing a value between 0 and 1 that represents prey preference and prey suitability for each species and length class.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_M2">calc_M2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate predator-prey size preferences
prefs &lt;- calc_prefs(pred_mu=-2.25, pred_sigma=0.5, wgt, sc_Linf)

# Calculate prey preference and prey suitability
suit_M2 &lt;- calc_suit_vect(nsc, nfish, sc_Linf, prefs, NS_tau)
</code></pre>

<hr>
<h2 id='comb_LeMans_run'>Combine two <code>LeMans_outputs</code> objects</h2><span id='topic+comb_LeMans_run'></span>

<h3>Description</h3>

<p>Combines two <a href="#topic+LeMans_outputs-class">LeMans_outputs</a> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comb_LeMans_run(LeMans_run_x, LeMans_run_y, cont = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comb_LeMans_run_+3A_lemans_run_x">LeMans_run_x</code></td>
<td>
<p>A <a href="#topic+LeMans_outputs-class">LeMans_outputs</a> object.</p>
</td></tr>
<tr><td><code id="comb_LeMans_run_+3A_lemans_run_y">LeMans_run_y</code></td>
<td>
<p>A <a href="#topic+LeMans_outputs-class">LeMans_outputs</a> object.</p>
</td></tr>
<tr><td><code id="comb_LeMans_run_+3A_cont">cont</code></td>
<td>
<p>A logical statement indicating whether or not <code>LeMans_run_y</code> is a continuation of <code>LeMans_run_x</code>. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>cont==T</code>, the first years output from <code>LeMans_run_y</code> is removed as this will be the same as the last year of <code>LeMans_run_x</code>.
</p>


<h3>Value</h3>

<p>A <code>LeMans_outputs</code> object.
</p>


<h3>See Also</h3>

<p><a href="#topic+LeMans_outputs-class">LeMans_outputs</a>, <code><a href="#topic+run_LeMans">run_LeMans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=NS_other)

# Define fishing effort
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])

# Run the model for the first time
model_run1 &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Run the model for another 12 years
effort1 &lt;- matrix(0.5, 12, dim(NS_params@Qs)[3])
model_run2 &lt;- run_LeMans(N=model_run1@N[,,101], NS_params, years=12, effort=effort1)

# Combine the two model runs into a single run
out &lt;- comb_LeMans_run(model_run1, model_run2, cont=TRUE)
</code></pre>

<hr>
<h2 id='get_annual_catch'>Get annual catch for each species, catch per unit effort or catch per gear</h2><span id='topic+get_annual_catch'></span><span id='topic+get_annual_catch+2Cmissing+2Cmissing-method'></span><span id='topic+get_annual_catch+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_annual_catch+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_annual_catch+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_CPUE'></span><span id='topic+get_CPUE+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_CPUE+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_CPUE+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_CPUE+2Cmissing+2Cmissing-method'></span><span id='topic+get_CPG'></span><span id='topic+get_CPG+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_CPG+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_CPG+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_CPG+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Get annual catch for each species, the Catch Per Unit Effort (CPUE) or the Catch Per Gear (CPG)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_annual_catch(inputs, outputs, ...)

## S4 method for signature 'missing,missing'
get_annual_catch(
  Catch,
  years = (dim(Catch)[3] + (inc_first - 1)) * phi_min,
  phi_min = 0.1,
  inc_first = FALSE
)

## S4 method for signature 'LeMans_param,missing'
get_annual_catch(
  inputs,
  Catch,
  years = (dim(Catch)[3] + (inc_first - 1)) * inputs@phi_min,
  inc_first = FALSE
)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_annual_catch(
  inputs,
  outputs,
  years = (dim(outputs@Catch)[3] + (inc_first - 1)) * inputs@phi_min,
  inc_first = FALSE
)

## S4 method for signature 'missing,LeMans_outputs'
get_annual_catch(
  outputs,
  years = (dim(outputs@Catch)[3] + (inc_first - 1)) * phi_min,
  phi_min = 0.1,
  inc_first = FALSE
)

get_CPUE(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_CPUE(inputs, outputs, effort, years = nrow(effort), inc_first = FALSE)

## S4 method for signature 'LeMans_param,missing'
get_CPUE(inputs, Catch, effort, years = nrow(effort), inc_first = FALSE)

## S4 method for signature 'missing,LeMans_outputs'
get_CPUE(
  outputs,
  Qs,
  effort,
  years = nrow(effort),
  phi_min = 0.1,
  inc_first = FALSE
)

## S4 method for signature 'missing,missing'
get_CPUE(
  Catch,
  Qs,
  effort,
  years = nrow(effort),
  phi_min = 0.1,
  inc_first = FALSE
)

get_CPG(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_CPG(inputs, outputs, effort, years = nrow(effort), inc_first = FALSE)

## S4 method for signature 'LeMans_param,missing'
get_CPG(inputs, Catch, effort, years = nrow(effort), inc_first = FALSE)

## S4 method for signature 'missing,LeMans_outputs'
get_CPG(
  outputs,
  Qs,
  effort,
  years = nrow(effort),
  phi_min = 0.1,
  inc_first = FALSE
)

## S4 method for signature 'missing,missing'
get_CPG(
  Catch,
  Qs,
  effort,
  years = nrow(effort),
  phi_min = 0.1,
  inc_first = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_annual_catch_+3A_inputs">inputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_param-class">LeMans_param</a></code> object containing the parameter values of the current LeMans model.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_outputs">outputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code> object containing the outputs of the model run.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_catch">Catch</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class for each time step.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_years">years</code></td>
<td>
<p>A numeric value representing the number of years included in <code>Catch</code>.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_phi_min">phi_min</code></td>
<td>
<p>A numeric value representing the time step of the model.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_inc_first">inc_first</code></td>
<td>
<p>A logical statement indicating whether the first time step of <code>Catch</code> should be included. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_effort">effort</code></td>
<td>
<p>A matrix with dimensions <code>years</code> and the number of fishing gears, representing fishing effort in each year for each gear.</p>
</td></tr>
<tr><td><code id="get_annual_catch_+3A_qs">Qs</code></td>
<td>
<p>An array of dimensions <code>nsc</code>, <code>nfish</code> and <code>gear</code> representing the catchability of each species by each of the fishing gears.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>get_annual_catch</code> returns a matrix with dimensions <code>years</code> and <code>length(species)</code> where the <code>i,j</code>th element represents the total catch (g) of the <code>j</code>th <code>species</code> in the <code>i</code>th year.
</p>
<p><code>get_CPUE</code> returns a matrix with dimensions <code>tot_time</code> and <code>nfish</code> where the <code>i,j</code>th element represents the CPUE in the <code>i</code>th time step for the <code>j</code>th species.
</p>
<p><code>get_CPG</code> returns an array with dimensions <code>nfish</code>, <code>dim(Qs[3])</code> and the number of time steps, where the <code>i,j,k</code>th element denotes the total catch of the <code>i</code>th species by the <code>j</code>th gear in the <code>k</code>th time step.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Get annual catch
get_annual_catch(inputs=NS_params, outputs=model_run)

# Calculate the CPUE
get_CPUE(inputs=NS_params, outputs=model_run, effort=effort)

# Calculate Catch Per Gear (CPG)
get_CPG(inputs=NS_params, outputs=model_run, effort=effort)
</code></pre>

<hr>
<h2 id='get_indicators'>Calculate indicators</h2><span id='topic+get_indicators'></span><span id='topic+get_indicators+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_indicators+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_indicators+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_indicators+2Cmissing+2Cmissing-method'></span><span id='topic+get_LFI'></span><span id='topic+get_LFI+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_LFI+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_LFI+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_LFI+2Cmissing+2Cmissing-method'></span><span id='topic+get_MML'></span><span id='topic+get_MML+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_MML+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_MML+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_MML+2Cmissing+2Cmissing-method'></span><span id='topic+get_TyL'></span><span id='topic+get_TyL+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_TyL+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_TyL+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_TyL+2Cmissing+2Cmissing-method'></span><span id='topic+get_LQ'></span><span id='topic+get_LQ+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_LQ+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_LQ+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_LQ+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Calculates Mean Maximum Length (MML), the Large Fish Indicator (LFI), Typical Length (TyL) and Length Quantiles (LQ) of the whole community or a subset of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_indicators(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_indicators(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  prob = 0.5,
  length_LFI = 40
)

## S4 method for signature 'LeMans_param,missing'
get_indicators(
  inputs,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  prob = 0.5,
  length_LFI = 40
)

## S4 method for signature 'missing,LeMans_outputs'
get_indicators(
  wgt,
  mid,
  l_bound,
  u_bound,
  Linf,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL,
  prob = 0.5,
  length_LFI = 40
)

## S4 method for signature 'missing,missing'
get_indicators(
  wgt,
  mid,
  l_bound,
  u_bound,
  Linf,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL,
  prob = 0.5,
  length_LFI = 40
)

get_LFI(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_LFI(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  length_LFI = 40
)

## S4 method for signature 'LeMans_param,missing'
get_LFI(
  inputs,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  length_LFI = 40
)

## S4 method for signature 'missing,LeMans_outputs'
get_LFI(
  wgt,
  l_bound,
  u_bound,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL,
  length_LFI = 40
)

## S4 method for signature 'missing,missing'
get_LFI(
  wgt,
  l_bound,
  u_bound,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL,
  length_LFI = 40
)

get_MML(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_MML(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3]
)

## S4 method for signature 'LeMans_param,missing'
get_MML(inputs, N, species = 1:dim(N)[2], time_steps = 1:dim(N)[3])

## S4 method for signature 'missing,LeMans_outputs'
get_MML(
  wgt,
  Linf,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL
)

## S4 method for signature 'missing,missing'
get_MML(
  wgt,
  Linf,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL
)

get_TyL(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_TyL(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3]
)

## S4 method for signature 'LeMans_param,missing'
get_TyL(inputs, N, species = 1:dim(N)[2], time_steps = 1:dim(N)[3])

## S4 method for signature 'missing,LeMans_outputs'
get_TyL(
  wgt,
  mid,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL
)

## S4 method for signature 'missing,missing'
get_TyL(
  wgt,
  mid,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL
)

get_LQ(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_LQ(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  prob = 0.5
)

## S4 method for signature 'LeMans_param,missing'
get_LQ(inputs, N, species = 1:dim(N)[2], time_steps = 1:dim(N)[3], prob = 0.5)

## S4 method for signature 'missing,LeMans_outputs'
get_LQ(
  wgt,
  u_bound,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL,
  prob = 0.5
)

## S4 method for signature 'missing,missing'
get_LQ(
  wgt,
  u_bound,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL,
  prob = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_indicators_+3A_inputs">inputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_param-class">LeMans_param</a></code> object containing the parameter values of the current LeMans model.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_outputs">outputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code> object containing the outputs of the model run.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_species">species</code></td>
<td>
<p>A numeric value or vector or a character string representing the species that you wish to use to calculate the indicators. The default is <code>1:dim(N)[2]</code>.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_time_steps">time_steps</code></td>
<td>
<p>A numeric vector of the time steps that you wish to use to calculate the indicators. The default is <code>1:dim(N)[3]</code>.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_prob">prob</code></td>
<td>
<p>A numeric value or vector between 0 and 1 denoting the length quantiles to be calculated. The default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_length_lfi">length_LFI</code></td>
<td>
<p>A numeric vector representing the thresholds to be used to calculate the LFI. The default value is <code>40</code>.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_n">N</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class for each time step.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes in the model.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_l_bound">l_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_linf">Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the asymptotic length of each species.</p>
</td></tr>
<tr><td><code id="get_indicators_+3A_species_names">species_names</code></td>
<td>
<p>A character vector of length <code>nfish</code> that denotes the names of the species in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LFI represents the proportion of biomass with a length larger than <code>length_LFI</code>. The MML is the biomass weighted mean of <code>Linf</code>:
</p>
<p><code>sum(biomass[species]*Linf[species])/sum(biomass[species])</code>
</p>
<p>where <code>biomass</code> is a numeric vector of length <code>nfish</code> representing the biomass of each species. TyL is the biomass-weighted geometric mean length of the community:
</p>
<p><code>exp(sum(biomass_*log(mid))/sum(Bio_l))</code>
</p>
<p>where <code>biomass_</code> is a numeric vector of length <code>nsc</code> representing the biomass of all the species in each length class. The LQ is the length at which the biomass exceeds a given proportion <code>prob</code> of the total biomass.
</p>


<h3>Value</h3>

<p><code>get_indicators</code> returns a list object with names 'LFI', 'MML', 'TYL' and 'LQ'. If <code>length(length_LFI)&gt;1</code>, 'LFI' is a matrix with dimensions <code>length(time_steps)</code> by <code>length(length_LFI)</code> where the <code>i,j</code>th element represents the LFI using the <code>j</code>th <code>length_LFI</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(length_LFI)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>. 'MML' is a numeric vector of length <code>time_steps</code> where each element is the MML for the species in <code>species</code>. 'TYL' is a numeric vector of length <code>time_steps</code> where each element is the TyL for the species in <code>species</code>. If <code>length(prob)==1</code>, 'LQ' is a matrix with dimensions <code>length(time_steps)</code> by <code>length(prob)</code> where the <code>i,j</code>th element is the LQ using the<code>j</code>th <code>prob</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(prob)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>.
</p>
<p>If <code>length(length_LFI)==1</code>, <code>get_LFI</code> returns a matrix with dimensions <code>length(time_steps)</code> by <code>length(length_LFI)</code> where the <code>i,j</code>th element is the LFI using the <code>j</code>th <code>length_LFI</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(length_LFI)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>.
</p>
<p><code>get_MML</code> returns a numeric vector of length <code>time_steps</code> where each element is the MML for the species in <code>species</code>.
</p>
<p>If <code>length(prob)&gt;1</code>, <code>get_LQ</code> returns a matrix with dimensions <code>length(time_steps)</code> and <code>length(prob)</code> where the <code>i,j</code>th element is the LQ using the the <code>j</code>th <code>prob</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(prob)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_indicators">plot_indicators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate the indicators
get_indicators(inputs=NS_params, outputs=model_run)

# Calculate the LFI
get_LFI(inputs=NS_params, outputs=model_run)

# Calculate MML
get_MML(inputs=NS_params, outputs=model_run)

# Calculate TyL
get_TyL(inputs=NS_params, outputs=model_run)

# Calculate LQs
get_LQ(inputs=NS_params, outputs=model_run)
</code></pre>

<hr>
<h2 id='get_N0'>Generate a starting value for N</h2><span id='topic+get_N0'></span>

<h3>Description</h3>

<p>Generate a starting value for <code>N</code>, which represents the number of individuals in each length class for each species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept = 1e+10, slope = -5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_N0_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of fish species in the model.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_intercept">intercept</code></td>
<td>
<p>A numeric value representing the number of individuals in the first length class. The default is <code>1e10</code>.</p>
</td></tr>
<tr><td><code id="get_N0_+3A_slope">slope</code></td>
<td>
<p>A numeric value representing the slope of the community size spectrum. The default is -5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The total number of individuals in the community in each length class is equal to <code>intercept*mid^slope</code>. Within each length class, the number of individuals of each species is determined using the proportion of each species' biomass that is found in that length class.
</p>


<h3>Value</h3>

<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class.
</p>


<h3>References</h3>

<p>Andersen, K.H., Blanchard, J.L., Fulton, E.A., Gislason, H., Jacobsen, N.S., van Kooten, T. (2016). Assumptions behind size-based ecosystem models are realistic. <em>ICES Journal of Marine Science</em>, 73(6):1651-1655.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_LeMans">run_LeMans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Get an initial population
get_N0(nsc, nfish, mid, wgt, sc_Linf)
</code></pre>

<hr>
<h2 id='get_rec_fun'>Collate the stock recruitment functions</h2><span id='topic+get_rec_fun'></span>

<h3>Description</h3>

<p>Collates the stock recruitment functions for all of the species in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rec_fun(rec_fun = "hockey-stick")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rec_fun_+3A_rec_fun">rec_fun</code></td>
<td>
<p>A character vector representing the stock recruitment function to be applied to each species. The default is <code>"hockey-stick"</code>, but <code>rec_fun</code> can also take <code>"Ricker"</code>, <code>"Beverton-Holt"</code>, <code>"constant"</code>, or <code>"linear"</code> for each species.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>"Beverton-Holt"</code>, the stock recruitment function is defined as <code>a*SSB/(1+b*SSB)</code>; for <code>"Ricker"</code> it is defined as <code>a*SSB*exp(-b*SSB)</code>; for <code>"hockey-stick"</code> it is defined as <code>min(a*SSB, b)</code>; for <code>"constant"</code> it is defined as <code>a</code>, and for <code>"linear"</code> it is defined as <code>a*SSB</code>. In all cases, <code>SSB</code> is the Spawning Stock Biomass in 1000s of tonnes and <code>a</code> and <code>b</code> are parameters of the specific stock recruitment functions.
</p>


<h3>Value</h3>

<p>A list object of length <code>rec_fun</code> where each element includes the stock recruitment function for a given species. If an invalid recruitment function is selected, <code>NULL</code> is returned and a warning message is shown.
</p>


<h3>References</h3>

<p>Barrowman, N.J., Myers, R.A. (2000).  Still more spawner-recruit curves: the hockey stick and its generalisations. <em>Canadian Journal of Fisheries and Aquatic Science</em>, 57:665–676.
</p>
<p>Beverton, R.J.H., Holt, S.J. (1957). On the Dynamics of Exploited Fish Populations, volume 19 of Fisheries Investigations (Series 2). United Kingdom Ministry of Agriculture and Fisheries.
</p>
<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Ogle, D.H. (2016). Introductory Fisheries Analyses with R. CRC Press.
</p>
<p>Ricker, W.E. (1954). Stock and recruitment. <em>Journal of the Fisheries Research Board of Canada</em>, 11:559-623.
</p>
<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nfish &lt;- nrow(NS_par)
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
</code></pre>

<hr>
<h2 id='get_SSB'>Calculate Spawning Stock Biomass (SSB) or total biomass</h2><span id='topic+get_SSB'></span><span id='topic+get_SSB+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_SSB+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_SSB+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_SSB+2Cmissing+2Cmissing-method'></span><span id='topic+get_biomass'></span><span id='topic+get_biomass+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+get_biomass+2CLeMans_param+2Cmissing-method'></span><span id='topic+get_biomass+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+get_biomass+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Calculates the Spawning Stock Biomass (SSB) or the total biomass of each species in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_SSB(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_SSB(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3]
)

## S4 method for signature 'LeMans_param,missing'
get_SSB(inputs, N, species = 1:dim(N)[2], time_steps = 1:dim(N)[3])

## S4 method for signature 'missing,LeMans_outputs'
get_SSB(
  wgt,
  mature,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL
)

## S4 method for signature 'missing,missing'
get_SSB(
  wgt,
  mature,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL
)

get_biomass(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
get_biomass(
  inputs,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3]
)

## S4 method for signature 'LeMans_param,missing'
get_biomass(inputs, N, species = 1:dim(N)[2], time_steps = 1:dim(N)[3])

## S4 method for signature 'missing,LeMans_outputs'
get_biomass(
  wgt,
  outputs,
  species = 1:dim(outputs@N)[2],
  time_steps = 1:dim(outputs@N)[3],
  species_names = NULL
)

## S4 method for signature 'missing,missing'
get_biomass(
  wgt,
  N,
  species = 1:dim(N)[2],
  time_steps = 1:dim(N)[3],
  species_names = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_SSB_+3A_inputs">inputs</code></td>
<td>
<p>A <a href="#topic+LeMans_param-class">LeMans_param</a> object containing the parameter values of the current LeMans model.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_outputs">outputs</code></td>
<td>
<p>A <a href="#topic+LeMans_outputs-class">LeMans_outputs</a> object containing the outputs of the model run.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_species">species</code></td>
<td>
<p>A numeric value or vector or a character string or vector of the species that you wish to calculate the mean maximum length. The default is <code>1:dim(N)[2]</code>.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_time_steps">time_steps</code></td>
<td>
<p>A numeric vector of the time steps that you wish to calculate the mean maximum length. The default is <code>1:dim(N)[3]</code>.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_n">N</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class for each time step.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_mature">mature</code></td>
<td>
<p>A matrix with dimensions <code>ncs</code> and <code>nfish</code> with elements in the range 0-1 representing the proportion of mature individuals of each species in each length class.</p>
</td></tr>
<tr><td><code id="get_SSB_+3A_species_names">species_names</code></td>
<td>
<p>A character vector of length <code>nfish</code> that denotes the names of the species in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The SSB for each species in <code>species</code> is equal to:
</p>
<p><code>colSums(N[, species]*wgt[, species]*mature[, species])</code>.
</p>
<p>The biomass for each species in <code>species</code> is equal to:
</p>
<p><code>colSums(N[, species]*wgt[, species])</code>
</p>


<h3>Value</h3>

<p>If <code>length(species)&gt;1</code>, <code>get_SSB</code> returns a matrix with dimensions <code>length(time_steps)</code> by <code>length(species)</code> where the <code>i,j</code>th element is the SSB (g) of the <code>j</code>th <code>species</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(species)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>.
</p>
<p>If <code>length(species)&gt;1</code>, <code>get_biomass</code> returns a matrix with dimensions <code>length(time_steps)</code> by <code>length(species)</code> where the <code>i,j</code>th element is the biomass (g) of the <code>j</code>th <code>species</code> in the <code>i</code>th <code>time_steps</code>. If <code>length(species)==1</code>, the function will return a numeric vector of length <code>length(time_steps)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate SSB
get_SSB(inputs=NS_params, outputs=model_run)

# Calculate biomass
get_biomass(inputs=NS_params, outputs=model_run)
</code></pre>

<hr>
<h2 id='LeMans_outputs-class'>An S4 class representing the outputs of the LeMans model</h2><span id='topic+LeMans_outputs-class'></span>

<h3>Description</h3>

<p>An S4 class representing the outputs of the LeMans model
</p>


<h3>Slots</h3>


<dl>
<dt><code>N</code></dt><dd><p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class at each time step of the model.</p>
</dd>
<dt><code>Catch</code></dt><dd><p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the biomass of each species that is caught in each length class at each time step of the model.</p>
</dd>
<dt><code>M2</code></dt><dd><p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the predation mortality of each species in each length class at each time step of the model.</p>
</dd>
<dt><code>R</code></dt><dd><p>A matrix with dimensions <code>tot_time</code> and <code>nfish</code> representing the number of recruits of each species at each time step of the model.</p>
</dd>
</dl>

<hr>
<h2 id='LeMans_param-class'>An S4 class representing the inputs of the LeMans model</h2><span id='topic+LeMans_param-class'></span>

<h3>Description</h3>

<p>An S4 class representing the inputs of the LeMans model
</p>


<h3>Details</h3>

<p>Sets the class of a LeMansParam object, which is then used to run the LeMans model.
</p>


<h3>Slots</h3>


<dl>
<dt><code>nsc</code></dt><dd><p>A numeric value representing the number of length classes in the model.</p>
</dd>
<dt><code>nfish</code></dt><dd><p>A numeric value representing the number of fish species in the model.</p>
</dd>
<dt><code>phi_min</code></dt><dd><p>A numeric value representing the time step of the model.</p>
</dd>
<dt><code>l_bound</code></dt><dd><p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes.</p>
</dd>
<dt><code>u_bound</code></dt><dd><p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes.</p>
</dd>
<dt><code>mid</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</dd>
<dt><code>species_names</code></dt><dd><p>A numeric or character vector of length <code>nfish</code> that denotes the names of the species in the model.</p>
</dd>
<dt><code>Linf</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</dd>
<dt><code>W_a</code></dt><dd><p>A numeric vector representing the parameter <code>a</code> in the length-weight conversion.</p>
</dd>
<dt><code>W_b</code></dt><dd><p>A numeric vector representing the parameter <code>b</code> in the length-weight conversion.</p>
</dd>
<dt><code>k</code></dt><dd><p>k A numeric vector of length <code>nfish</code> representing the von Bertalanffy growth parameter <code>(1/yr)</code> for each species.</p>
</dd>
<dt><code>Lmat</code></dt><dd><p>A numeric vector of length <code>nsc</code> representing the length at which 50% of the individuals are mature.</p>
</dd>
<dt><code>mature</code></dt><dd><p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> with elements in the range 0-1 representing the proportion of mature individuals of each species in each length class.</p>
</dd>
<dt><code>sc_Linf</code></dt><dd><p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</dd>
<dt><code>wgt</code></dt><dd><p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</dd>
<dt><code>phi</code></dt><dd><p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the proportion of individuals that leave each length class.</p>
</dd>
<dt><code>ration</code></dt><dd><p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the amount of food required for fish of a given species and length class to grow according to the von Bertalanffy growth curve in a time step.</p>
</dd>
<dt><code>other</code></dt><dd><p>A numeric value representing the amount of other food (g) available from prey that is not explicitly represented in the model.</p>
</dd>
<dt><code>M1</code></dt><dd><p>A matrix of dimensions <code>nsc</code> and <code>nfish</code> representing the natural mortality of each species for each length class.</p>
</dd>
<dt><code>suit_M2</code></dt><dd><p>A list object of length <code>nfish</code>. Each element in the list is an array of dimensions <code>nsc</code>, <code>nsc</code> and <code>nfish</code> containing a value between 0 and 1 representing prey preference and prey suitability for each species and length class.</p>
</dd>
<dt><code>Qs</code></dt><dd><p>An array of dimensions <code>nsc</code>, <code>nfish</code> and <code>length(gear)</code> representing the catchability of each species by each of the fishing gears.</p>
</dd>
<dt><code>stored_rec_funs</code></dt><dd><p>A list object of length <code>rec_fun</code> where each element includes the stock recruitment function for a given species. If an invalid recruitment function is selected, <code>NULL</code> is returned and a warning message is shown.</p>
</dd>
<dt><code>eps</code></dt><dd><p>A numeric value specifying a numerical offset. The default value is <code>1e-5</code>.</p>
</dd>
<dt><code>recruit_params</code></dt><dd><p>A list object of length <code>nfish</code> specifying the parameters for the recruitment function.</p>
</dd>
</dl>

<hr>
<h2 id='LeMansParam'>A constructor for the <code>LeMansParam</code> class</h2><span id='topic+LeMansParam'></span><span id='topic+LeMansParam+2CANY+2CANY-method'></span><span id='topic+LeMansParam+2Cmissing+2CANY-method'></span><span id='topic+LeMansParam+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>A constructor for the <code><a href="#topic+LeMansParam">LeMansParam</a></code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LeMansParam(df, gdf, ...)

## S4 method for signature 'ANY,ANY'
LeMansParam(
  df,
  gdf,
  nfish = nrow(df),
  nsc = 32,
  pred_mu = -2.25,
  pred_sigma = 0.5,
  other = 1e+12,
  bounds = NULL,
  calc_phi_min = FALSE,
  phi_min = 0.1,
  vary_growth = TRUE,
  growth_eff = 0.5,
  growth_eff_decay = 0.11,
  eps = 1e-05,
  force_mature = TRUE,
  species_names = paste("species", 1:nfish, sep = "_"),
  kappa = rep(10, nfish),
  tau = matrix(1, nfish, nfish),
  rec_fun = rep("hockey-stick", nfish),
  recruit_params = list(a = 18.835 - 4.133 * df$Linf, b = rep(1000/nfish, nfish)),
  natmort_opt = rep("std_RNM", nfish),
  Nmort = rep(0.8, nfish),
  prop = rep(3/4, nfish),
  curve = rep("logistic", nfish),
  catch_species = ((0:(length(curve) - 1))%%nfish) + 1,
  max_catchability = rep(1, length(curve)),
  gear_name = paste("gear_", 1:length(curve), sep = ""),
  custom = NULL,
  ...
)

## S4 method for signature 'missing,ANY'
LeMansParam(
  gdf,
  nfish = length(Linf),
  nsc = 32,
  pred_mu = -2.25,
  pred_sigma = 0.5,
  other = 1e+12,
  bounds = NULL,
  calc_phi_min = FALSE,
  phi_min = 0.1,
  vary_growth = FALSE,
  growth_eff = 0.5,
  growth_eff_decay = 0.11,
  eps = 1e-05,
  force_mature = TRUE,
  Linf,
  k,
  W_a,
  W_b,
  Lmat,
  species_names = paste("species", 1:nfish, sep = "_"),
  kappa = rep(10, nfish),
  tau = matrix(1, nfish, nfish),
  rec_fun = rep("hockey-stick", nfish),
  recruit_params = list(a = 18.835 - 4.133 * Linf, b = rep(1000/nfish, nfish)),
  natmort_opt = rep("std_RNM", nfish),
  Nmort = rep(0.8, nfish),
  prop = rep(3/4, nfish),
  curve = rep("logistic", nfish),
  catch_species = ((0:(length(curve) - 1))%%nfish) + 1,
  max_catchability = rep(1, length(curve)),
  gear_name = paste("gear_", 1:length(curve), sep = ""),
  custom = NULL,
  ...
)

## S4 method for signature 'missing,missing'
LeMansParam(
  df,
  gdf,
  nfish = length(Linf),
  nsc = 32,
  pred_mu = -2.25,
  pred_sigma = 0.5,
  other = 1e+12,
  bounds = NULL,
  calc_phi_min = TRUE,
  phi_min = 0.1,
  vary_growth = FALSE,
  growth_eff = 0.5,
  growth_eff_decay = 0.11,
  eps = 1e-05,
  force_mature = TRUE,
  species_names = paste("species", 1:nfish, sep = "_"),
  Linf,
  k,
  W_a,
  W_b,
  Lmat,
  kappa = rep(10, nfish),
  tau = matrix(1, nfish, nfish),
  rec_fun = rep("hockey-stick", nfish),
  recruit_params = list(a = 18.835 - 4.133 * Linf, b = rep(1000/nfish, nfish)),
  natmort_opt = rep("std_RNM", nfish),
  Nmort = rep(0.8, nfish),
  prop = rep(3/4, nfish),
  curve = rep("logistic", nfish),
  catch_species = ((0:(length(curve) - 1))%%nfish) + 1,
  max_catchability = rep(1, length(curve)),
  gear_name = paste("gear_", 1:length(curve), sep = ""),
  custom = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LeMansParam_+3A_df">df</code></td>
<td>
<p>A data frame with <code>nfish</code> rows and the following columns: <code>Linf</code>, <code>W_a</code>, <code>W_b</code>, <code>k</code> and <code>Lmat</code>. See below for definitions of each of these parameters.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_gdf">gdf</code></td>
<td>
<p>A data frame with <code>nfish</code> rows and the following columns: <code>curve</code>, <code>catch_species</code>, <code>max_catchability</code>, <code>k</code> and <code>gear_name</code>. See below for definitions of each of these parameters.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_...">...</code></td>
<td>
<p>Additional arguments for calculating catchability curves. See <code><a href="#topic+calc_Q">calc_Q</a></code> for more details.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of fish species in the model.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_pred_mu">pred_mu</code></td>
<td>
<p>A numeric value representing the preferred predator-prey mass ratio.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_pred_sigma">pred_sigma</code></td>
<td>
<p>A numeric value representing the width of the weight preference function.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_other">other</code></td>
<td>
<p>A numeric value representing the amount of other food (g) available from prey that is not explicitly represented in the model. The default is <code>1e12</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_bounds">bounds</code></td>
<td>
<p>An optional argument specifying the bounds of the length classes.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_calc_phi_min">calc_phi_min</code></td>
<td>
<p>A logical statement indicating whether <code>phi_min</code> should be calculated within the function. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_phi_min">phi_min</code></td>
<td>
<p>A fixed numeric value of <code>phi_min</code>, which represents the time step of the model. This parameter is only required if <code>calc_phi_min=FALSE</code>. The default is <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_vary_growth">vary_growth</code></td>
<td>
<p>A logical statement indicating whether growth efficiency should vary for each species (<code>vary_growth=TRUE</code>) or be fixed at the value given by <code>fixed_growth</code> (<code>vary_growth=FALSE</code>). The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_growth_eff">growth_eff</code></td>
<td>
<p>If <code>vary_growth==TRUE</code>, <code>growth_eff</code> is a numeric representing the growth efficiencies of a fish of length 0. If <code>vary_growth==FALSE</code>, <code>growth_eff</code> is a numeric value of length <code>1</code> representing a fixed growth efficiency for all fish. The default is 0.5.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_growth_eff_decay">growth_eff_decay</code></td>
<td>
<p>A numeric value specifying the rate at which growth efficiency decreases as length increases to <code>Linf</code>. The default is 0.11.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_eps">eps</code></td>
<td>
<p>A numeric value specifying a numerical offset. The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_force_mature">force_mature</code></td>
<td>
<p>A logical statement indicating whether to force maturity for all fish in the largest length class. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_species_names">species_names</code></td>
<td>
<p>A numeric or character vector of length <code>nfish</code> that denotes the names of the species in the model.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_kappa">kappa</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the rate of change from immature to mature fish.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_tau">tau</code></td>
<td>
<p>A matrix with dimensions <code>nfish</code> and <code>nsc</code>. Row indices represent predators and column indices represent prey. A value of 1 at location <code>i</code>, <code>j</code> indicates prey <code>j</code> is eaten by predator <code>i</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_rec_fun">rec_fun</code></td>
<td>
<p>A character vector representing the stock recruitment function to be applied to each species. The default value is <code>"hockey-stick"</code> but <code>rec_fun</code> can take a value of <code>"Ricker"</code>, <code>"Beverton-Holt"</code>, <code>"constant"</code>, or <code>"linear"</code> for each species.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_recruit_params">recruit_params</code></td>
<td>
<p>A list object of length <code>nfish</code> specifying the parameters for the recruitment function.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_natmort_opt">natmort_opt</code></td>
<td>
<p>A character vector of length <code>1</code> describing the mortality function to be used for the species. The default value is <code>"std_RNM"</code> but can take a value of <code>"constant"</code> or <code>"linear"</code>. See <code>calc_M1</code> for more information.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_nmort">Nmort</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the maximum background mortality of each species. The default is <code>0.8</code> for all species.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_prop">prop</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the proportion of length classes that have a non-zero background mortality. This is required only when the <code>natmort_opt</code> mortality function is used. The default is <code>3/4</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_curve">curve</code></td>
<td>
<p>A character vector of almost any length describing the type of curve to be used to determine the catchability of each species by fishing gear. By default, <code>curve</code> is a character vector of length <code>nfish</code> that takes the value <code>"logistic"</code> in each element, but it can also take a value of <code>"log-gaussian"</code> or <code>"knife-edge"</code>. If a custom curve is required for a particular species and/or fishing gear, the curve must be specified in <code>custom</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_catch_species">catch_species</code></td>
<td>
<p>A numeric value or character string describing the species to apply the catchability curve to.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_max_catchability">max_catchability</code></td>
<td>
<p>A numeric vector of length <code>curve</code> describing the maximum catchability for each catchability curve.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_gear_name">gear_name</code></td>
<td>
<p>A character vector of the same length as <code>curve</code> and <code>species</code> describing the fishing gear that each element of <code>curve</code> and <code>species</code> relates to. By default, <code>gear_name</code> is a character vector of length <code>curve</code> that takes the value <code>paste("gear_", 1:length(curve), sep = "")</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_custom">custom</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and the number of custom catchability curves that are required. <code>custom</code> represents the catchability of each species by the gears specified using custom catchability curves. By default, <code>custom</code> is set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_linf">Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_k">k</code></td>
<td>
<p>k A numeric vector of length <code>nfish</code> representing the von Bertalanffy growth parameter <code>(1/yr)</code> for each species.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_w_a">W_a</code></td>
<td>
<p>A numeric vector representing the parameter <code>a</code> in the length-weight conversion.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_w_b">W_b</code></td>
<td>
<p>A numeric vector representing the parameter <code>b</code> in the length-weight conversion.</p>
</td></tr>
<tr><td><code id="LeMansParam_+3A_lmat">Lmat</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length at which 50% of the individuals are mature.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converts objects of class data frame or vector to class LeMansParams for use in the LeMans model. <code>Linf</code>, <code>W_a</code>, <code>W_b</code>, <code>k</code> and <code>Lmat</code> are required as either a data frame or as vectors.
</p>


<h3>Value</h3>

<p>An object of class <code>LeMansParam</code> for use in the LeMans model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_LeMans">run_LeMans</a></code>, <code><a href="#topic+LeMans_param-class">LeMans_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the model with all inputs specified explicitly:
# Set up species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50% of individuals are mature (cm).

NS_params &lt;- LeMansParam(species_names=NS_par$species_names, Linf=Linf, k=k, W_a=W_a, W_b=W_b,
Lmat=Lmat, tau=NS_tau, recruit_params=list(a=NS_par$a, b=NS_par$b), eta=rep(0.25, 21), L50=Lmat,
other=NS_other)

###############################################
# Alternatively:
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=NS_other)
</code></pre>

<hr>
<h2 id='make_rec_fun'>Generate the stock recruitment functions</h2><span id='topic+make_rec_fun'></span>

<h3>Description</h3>

<p>Generates the stock recruitment function for a given species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_rec_fun(rec_fun = "hockey-stick")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_rec_fun_+3A_rec_fun">rec_fun</code></td>
<td>
<p>A character vector representing the stock recruitment function to be applied to each species. The default is <code>"hockey-stick"</code>, but <code>rec_fun</code> can also take <code>"Ricker"</code>, <code>"Beverton-Holt"</code>, <code>"constant"</code>, or <code>"linear"</code> for each species.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>"Beverton-Holt"</code>, the stock recruitment function is defined as <code>a*SSB/(1+b*SSB)</code>; for <code>"Ricker"</code> it is defined as <code>a*SSB*exp(-b*SSB)</code>; for <code>"hockey-stick"</code> it is defined as <code>min(a*SSB, b)</code>; for <code>"constant"</code> it is defined as <code>a</code>, and for <code>"linear"</code> it is defined as <code>a*SSB</code>. In all cases, <code>SSB</code> is the Spawning Stock Biomass in 1000s of tonnes and <code>a</code> and <code>b</code> are parameters of the specific stock recruitment functions.
</p>


<h3>Value</h3>

<p>The stock recruitment function for a given species. If an invalid recruitment function is selected, <code>NULL</code> is returned and a warning message is shown.
</p>


<h3>References</h3>

<p>Barrowman, N.J., Myers, R.A. (2000).  Still more spawner-recruit curves: the hockey stick and its generalisations. <em>Canadian Journal of Fisheries and Aquatic Science</em>, 57:665–676.
</p>
<p>Beverton, R.J.H., Holt, S.J. (1957). On the Dynamics of Exploited Fish Populations, volume 19 of Fisheries Investigations (Series 2). United Kingdom Ministry of Agriculture and Fisheries.
</p>
<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Ogle, D.H. (2016). Introductory Fisheries Analyses with R. CRC Press.
</p>
<p>Ricker, W.E. (1954). Stock and recruitment. <em>Journal of the Fisheries Research Board of Canada</em>, 11:559-623.
</p>
<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function
make_rec_fun("Ricker")
</code></pre>

<hr>
<h2 id='NS_eta'>The steepness of the slope of the catchability curve</h2><span id='topic+NS_eta'></span>

<h3>Description</h3>

<p>The steepness of the slope of the catchability curve associated with <code>NS_mixed_fish</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_eta
</code></pre>


<h3>Format</h3>

<p>A numeric value representing the steepness of the slope of the catchability curve.</p>


<h3>References</h3>

<p>Thorpe, R.B., Dolder, P.J. , Reeves, S., Robinson, P., Jennings, S. (2015). Assessing fishery and ecological consequences of alternative management options for multispecies fisheries <em>ICES Journal of Marine Science</em>, 73(6):1503-1512.
</p>

<hr>
<h2 id='NS_L50'>The length at 50% of the maximum catchability of the catchability curve</h2><span id='topic+NS_L50'></span>

<h3>Description</h3>

<p>The length at 50% of the maximum catchability of the catchability curve associated with <code>NS_mixed_fish</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_L50
</code></pre>


<h3>Format</h3>

<p>A numeric value representing the length at 50% of the maximum catchability of the catchability curve.</p>


<h3>References</h3>

<p>Thorpe, R.B., Dolder, P.J. , Reeves, S., Robinson, P., Jennings, S. (2015). Assessing fishery and ecological consequences of alternative management options for multispecies fisheries <em>ICES Journal of Marine Science</em>, 73(6):1503-1512.
</p>

<hr>
<h2 id='NS_mixed_fish'>Gear selectivity data frame</h2><span id='topic+NS_mixed_fish'></span>

<h3>Description</h3>

<p>A gear selectivity data frame for the 21 species in <code>NS_par</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_mixed_fish
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 4 variables, including:
</p>

<dl>
<dt><code>catch_species</code></dt><dd><p>A character string describing the species to apply the catchability curve to.</p>
</dd>
<dt><code>curve</code></dt><dd><p>A character vector describing the type of curve to be used to determine the catchability of each species by the fishing gear.</p>
</dd>
<dt><code>gear_name</code></dt><dd><p>A character string describing the name of the gear.</p>
</dd>
<dt><code>max_catchability</code></dt><dd><p>A numeric vector describing the maximum catchability for each catchability curve.</p>
</dd>
</dl>


<h3>References</h3>

<p>Thorpe, R.B., Dolder, P.J. , Reeves, S., Robinson, P., Jennings, S. (2015). Assessing fishery and ecological consequences of alternative management options for multispecies fisheries <em>ICES Journal of Marine Science</em>, 73(6):1503-1512.
</p>

<hr>
<h2 id='NS_other'>Other food for the North Sea</h2><span id='topic+NS_other'></span>

<h3>Description</h3>

<p>Other food for the North Sea dataset, <code>NS_par</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_other
</code></pre>


<h3>Format</h3>

<p>A numerical value representing other food. To be used with <code>NS_par</code>.</p>

<hr>
<h2 id='NS_par'>North Sea data</h2><span id='topic+NS_par'></span>

<h3>Description</h3>

<p>Data for the 21 species in the North Sea version of the LeMans model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_par
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 8 variables, including:
</p>

<dl>
<dt><code>species_names</code></dt><dd><p>A numeric or character vector of length <code>nfish</code> that denotes the names of the species in the model.</p>
</dd>
<dt><code>Linf</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the asymptotic length of each species (cm).</p>
</dd>
<dt><code>W_a</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the parameter <code>a</code> in the length-weight conversion.</p>
</dd>
<dt><code>W_b</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the parameter <code>b</code> in the length-weight conversion.</p>
</dd>
<dt><code>k</code></dt><dd><p>A numeric vector of length <code>nfish</code> representing the von Bertalanffy growth parameter <code>(1/yr)</code> for each species.</p>
</dd>
<dt><code>Lmat</code></dt><dd><p>A numeric vector of length <code>nsc</code> representing the length at which 50% of the individuals are mature (cm).</p>
</dd>
<dt><code>a</code></dt><dd><p>A numeric value representing the density independent part of the hockey-stick recruitment curve.</p>
</dd>
<dt><code>b</code></dt><dd><p>A numeric value representing the density dependent part of the hockey-stick recruitment curve.</p>
</dd>
</dl>


<h3>References</h3>

<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>

<hr>
<h2 id='NS_tau'>North Sea interaction matrix</h2><span id='topic+NS_tau'></span>

<h3>Description</h3>

<p>A predator-prey interaction matrix for the 21 species in <code>NS_par</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NS_tau
</code></pre>


<h3>Format</h3>

<p>A matrix with 21 rows and 21 columns:
</p>

<p>Row indices represent predators and column indices represent prey. A value of 1 at location <code>i</code>, <code>j</code> indicates prey <code>j</code> is eaten by predator <code>i</code>.
</p>


<h3>References</h3>

<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>

<hr>
<h2 id='plot_indicators'>Plot indicators</h2><span id='topic+plot_indicators'></span><span id='topic+plot_indicators+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_indicators+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_indicators+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_indicators+2Cmissing+2Cmissing-method'></span><span id='topic+plot_LFI'></span><span id='topic+plot_LFI+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_LFI+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_LFI+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_LFI+2Cmissing+2Cmissing-method'></span><span id='topic+plot_MML'></span><span id='topic+plot_MML+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_MML+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_MML+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_MML+2Cmissing+2Cmissing-method'></span><span id='topic+plot_TyL'></span><span id='topic+plot_TyL+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_TyL+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_TyL+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_TyL+2Cmissing+2Cmissing-method'></span><span id='topic+plot_LQ'></span><span id='topic+plot_LQ+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_LQ+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_LQ+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_LQ+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plots Mean Maximum Length (MML), the Large Fish Indicator (LFI), Typical Length (TyL) and the Length Quantiles (LQ) of the whole community or a subset of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_indicators(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_indicators(inputs, outputs, species, time_steps, prob, length_LFI, ...)

## S4 method for signature 'LeMans_param,missing'
plot_indicators(inputs, N, species, time_steps, prob, length_LFI, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_indicators(
  wgt,
  mid,
  l_bound,
  u_bound,
  Linf,
  species,
  outputs,
  time_steps,
  species_names = NULL,
  prob,
  length_LFI,
  ...
)

## S4 method for signature 'missing,missing'
plot_indicators(
  wgt,
  mid,
  l_bound,
  u_bound,
  Linf,
  N,
  species,
  time_steps,
  species_names = NULL,
  prob,
  length_LFI,
  MML,
  TyL,
  LFI,
  LQ,
  units = "cm",
  ...
)

plot_LFI(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_LFI(
  inputs,
  outputs,
  species,
  time_steps,
  species_names,
  length_LFI,
  LFI,
  ...
)

## S4 method for signature 'LeMans_param,missing'
plot_LFI(inputs, N, species, time_steps, species_names, length_LFI, LFI, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_LFI(
  wgt,
  l_bound,
  u_bound,
  outputs,
  species,
  time_steps,
  species_names,
  length_LFI,
  LFI,
  ...
)

## S4 method for signature 'missing,missing'
plot_LFI(
  wgt,
  l_bound,
  u_bound,
  N,
  species,
  time_steps,
  species_names,
  length_LFI,
  LFI,
  units = "cm",
  ...
)

plot_MML(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_MML(inputs, outputs, species, species_names, time_steps, MML, ...)

## S4 method for signature 'LeMans_param,missing'
plot_MML(inputs, N, species, time_steps, species_names, MML, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_MML(wgt, Linf, outputs, species, time_steps, species_names, MML, ...)

## S4 method for signature 'missing,missing'
plot_MML(
  wgt,
  Linf,
  N,
  species,
  time_steps,
  species_names,
  MML,
  units = "cm",
  ...
)

plot_TyL(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_TyL(inputs, outputs, species, time_steps, species_names, TyL, ...)

## S4 method for signature 'LeMans_param,missing'
plot_TyL(inputs, N, species, time_steps, species_names, TyL, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_TyL(wgt, mid, outputs, species, time_steps, species_names, TyL, ...)

## S4 method for signature 'missing,missing'
plot_TyL(
  wgt,
  mid,
  N,
  species,
  time_steps,
  species_names,
  TyL,
  units = "cm",
  ...
)

plot_LQ(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_LQ(inputs, outputs, species, time_steps, species_names, LQ, prob, ...)

## S4 method for signature 'LeMans_param,missing'
plot_LQ(inputs, N, species, species_names, time_steps, LQ, prob, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_LQ(
  wgt,
  u_bound,
  outputs,
  species,
  time_steps,
  species_names,
  LQ,
  prob,
  ...
)

## S4 method for signature 'missing,missing'
plot_LQ(
  wgt,
  u_bound,
  N,
  species,
  time_steps,
  species_names,
  LQ,
  prob,
  units = "cm",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_indicators_+3A_inputs">inputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_param-class">LeMans_param</a></code> object containing the parameter values of the current LeMans model.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_outputs">outputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code> object containing the outputs of the model run.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_species">species</code></td>
<td>
<p>A numeric value or vector or a character string or vector denoting the species to be used to calculate the indicators. This option is only required if <code>MML</code>, <code>LFI</code>, <code>TyL</code> and <code>LQ</code> are not provided. The default is <code>1:dim(N)[2]</code>.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_time_steps">time_steps</code></td>
<td>
<p>A numeric vector denoting the time steps to be used to calculate and/or plot the indicators. The default is <code>1:dim(N)[3]</code> or <code>1:length(indicator)</code>.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_prob">prob</code></td>
<td>
<p>A numeric value or vector between 0 and 1 denoting the LQ(s) to be calculated. This option is only required if <code>LQ</code> is not provided. The default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_length_lfi">length_LFI</code></td>
<td>
<p>A numeric value or vector representing the threshold(s) to be used to calculate the LFI. This option is only required if <code>LFI</code> is not provided. The default is <code>40</code>.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_n">N</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class for each time step, where <code>nsc</code> represents the number of length classes in the model, <code>nfish</code> represents the number of species in the model and <code>tot_time</code> represents the number of time steps that the model was run for. This option is only required if <code>outputs</code> or <code>MML</code>, <code>LFI</code>, <code>TyL</code> and <code>LQ</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class. This option is only required if <code>inputs</code> or <code>MML</code>, <code>LFI</code>, <code>TyL</code> and <code>LQ</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_mid">mid</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the mid-point of the length classes in the model, where <code>nfish</code> represents the number of species in the model. This option is only required if <code>inputs</code> or <code>TyL</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_l_bound">l_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the lower bounds of the length classes, where <code>nsc</code> represents the number of length classes in the model. This option is only required if <code>inputs</code> or <code>LFI</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_u_bound">u_bound</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the upper bounds of the length classes, where <code>nsc</code> represents the number of length classes in the model. This option is only required if <code>inputs</code>, <code>LFI</code> and/or <code>LQ</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_linf">Linf</code></td>
<td>
<p>A numeric vector of length <code>nfish</code> representing the asymptotic length of each species, where <code>nfish</code> represents the number of species in the model. This option is only required if <code>inputs</code> or <code>MML</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_species_names">species_names</code></td>
<td>
<p>A character vector of length <code>1:dim(N)[2]</code> that denotes the names of the species in the model. This option is only required if <code>inputs</code> is not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_mml">MML</code></td>
<td>
<p>A numeric vector representing the outputs of the function <code>get_MML()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_tyl">TyL</code></td>
<td>
<p>A numeric vector representing the outputs of the function <code>get_TyL()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_lfi">LFI</code></td>
<td>
<p>A numeric vector or matrix representing the outputs of the function <code>get_LFI()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_lq">LQ</code></td>
<td>
<p>A numeric vector or matrix representing the outputs of the function <code>get_LQ()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_indicators_+3A_units">units</code></td>
<td>
<p>A character string denoting the units of length used in the model. The default is <code>"cm"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot_indicators</code> returns a set of four line plots depicting changes in the MML, LFI, TyL and LQ(s) of the community (including only the selected species) over time.
</p>
<p><code>plot_LFI</code> returns a line plot depicting the LFI of the community (including only the selected species) over time.
</p>
<p><code>plot_MML</code> returns a line plot depicting the MML of the community (including only the selected species) over time.
</p>
<p><code>plot_TYL</code> returns a line plot depicting the TyL of the community (including only the selected species) over time.
</p>
<p><code>plot_LQ</code> returns a line plot depicting the LQ(s) of the community (including only the selected species) over time.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_indicators">get_indicators</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate the indicators
tmp &lt;- get_indicators(NS_params, model_run)
MML &lt;- tmp$MML
LFI &lt;- tmp$LFI
TyL &lt;- tmp$TYL
LQ &lt;- tmp$LQ

# Plot the indicators
plot_indicators(MML=MML, LFI=LFI, TyL=TyL, LQ=LQ)

# Plot the LFI
plot_LFI(LFI=LFI)

# Plot MML
plot_MML(MML=MML)

# Plot the TyL
plot_TyL(TyL=TyL)

# Plot the LQs
plot_LQ(LQ=LQ)
</code></pre>

<hr>
<h2 id='plot_SSB'>Plot Spawning Stock Biomass (SSB)</h2><span id='topic+plot_SSB'></span><span id='topic+plot_SSB+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_SSB+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_SSB+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_SSB+2Cmissing+2Cmissing-method'></span><span id='topic+plot_biomass'></span><span id='topic+plot_biomass+2CLeMans_param+2CLeMans_outputs-method'></span><span id='topic+plot_biomass+2CLeMans_param+2Cmissing-method'></span><span id='topic+plot_biomass+2Cmissing+2CLeMans_outputs-method'></span><span id='topic+plot_biomass+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plots community and/or species-specific Spawning Stock Biomass (SSB) or total biomass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_SSB(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_SSB(inputs, outputs, species, time_steps, species_names, SSB, ...)

## S4 method for signature 'LeMans_param,missing'
plot_SSB(inputs, N, species, time_steps, species_names, SSB, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_SSB(wgt, mature, outputs, species, time_steps, species_names, SSB, ...)

## S4 method for signature 'missing,missing'
plot_SSB(
  wgt,
  mature,
  N,
  species,
  species_names,
  time_steps,
  SSB,
  full_plot_only = TRUE,
  units = "g",
  ...
)

plot_biomass(inputs, outputs, ...)

## S4 method for signature 'LeMans_param,LeMans_outputs'
plot_biomass(inputs, outputs, species, time_steps, species_names, biomass, ...)

## S4 method for signature 'LeMans_param,missing'
plot_biomass(inputs, N, species, time_steps, biomass, species_names, ...)

## S4 method for signature 'missing,LeMans_outputs'
plot_biomass(wgt, outputs, species, time_steps, biomass, species_names, ...)

## S4 method for signature 'missing,missing'
plot_biomass(
  wgt,
  N,
  species,
  time_steps,
  species_names,
  biomass,
  full_plot_only = TRUE,
  units = "g",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_SSB_+3A_inputs">inputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_param-class">LeMans_param</a></code> object containing the parameter values of the current LeMans model. This option is only required if <code>SSB</code> is not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_outputs">outputs</code></td>
<td>
<p>A <code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code> object containing the outputs of the model run. This option is only required if <code>SSB</code> is not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_species">species</code></td>
<td>
<p>A numeric value or vector or a character string or vector denoting the species to be used in the plot(s). The default is <code>1:dim(N)[2]</code>.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_time_steps">time_steps</code></td>
<td>
<p>A numeric vector denoting the time steps to be used to calculate and/or plot SSB. The default is <code>1:dim(N)[3]</code> or <code>1:length(SSB)</code>.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_species_names">species_names</code></td>
<td>
<p>A character vector of length <code>1:dim(N)[2]</code> that denotes the names of the species in the model. This option is only required if <code>inputs</code> is not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_ssb">SSB</code></td>
<td>
<p>A numeric vector or a matrix representing the outputs of the function <code>get_SSB()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_n">N</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the number of individuals in each length class for each time step, where <code>nsc</code> represents the number of length classes in the model, <code>nfish</code> represents the number of species in the model and <code>tot_time</code> represents the number of time steps that the model was run for. This option is only required if <code>outputs</code> and <code>SSB</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class. This option is only required if <code>inputs</code> and <code>SSB</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_mature">mature</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> and elements in the range 0-1 representing the proportion of individuals that are mature for each species and length class, where <code>nsc</code> represents the number of length classes in the model and <code>nfish</code> represents the number of species in the model. This option is only required if <code>outputs</code> and <code>SSB</code> are not provided.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_full_plot_only">full_plot_only</code></td>
<td>
<p>A logical statement indicating whether a single plot depicting the SSB of all of the selected species should be produced (<code>full_plot_only=TRUE</code>) or multiple plots depicting the SSB of individual species should be produced (<code>full_plot_only=FALSE</code>). The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_units">units</code></td>
<td>
<p>A character string denoting the units of weight used in the model. The default is <code>"g"</code>.</p>
</td></tr>
<tr><td><code id="plot_SSB_+3A_biomass">biomass</code></td>
<td>
<p>A numeric vector or a matrix representing the outputs of the function <code>get_biomass()</code>. This option is only required if <code>inputs</code> and <code>outputs</code> are not provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plot_SSB</code> returns line plots of the in SSB of the selected species through time.
</p>
<p><code>plot_biomass</code> returns line plots of the changes in biomass of the selected species through time.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_SSB">get_SSB</a></code>, <code><a href="#topic+get_biomass">get_biomass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up and run the model
NS_params &lt;- LeMansParam(NS_par, tau=NS_tau, eta=rep(0.25, 21), L50=NS_par$Lmat, other=1e12)
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)

# Calculate SSB
SSB &lt;- get_SSB(NS_params, model_run)

# Plot SSB
plot_SSB(SSB=SSB)

# Calculate biomass
biomass &lt;- get_biomass(NS_params, model_run)

# Plot biomass
plot_biomass(biomass=biomass)
</code></pre>

<hr>
<h2 id='rec_BH'>The Beverton-Holt stock recruitment function</h2><span id='topic+rec_BH'></span>

<h3>Description</h3>

<p>Calculates the number of recruits as given by the Beverton-Holt stock recruitment function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec_BH(SSB, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rec_BH_+3A_ssb">SSB</code></td>
<td>
<p>A numeric value representing the Spawning Stock Biomass (SSB) of a given species (g).</p>
</td></tr>
<tr><td><code id="rec_BH_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code>, with each element in the list including a value of <code>a</code> and <code>b</code> for each species. <code>a</code> is a positive numeric value, often referred to as the <em>density-independent</em> parameter. The default is 1. <code>b</code> is a positive numeric value, often referred to as the <em>density-dependent</em> parameter. The default is 0.001.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beverton-Holt stock recruitment function is defined as <code>a*(SSB/1e9))/(1+b*(SSB/1e9))</code>.
</p>


<h3>Value</h3>

<p>A numeric value representing the number of recruits of a given species.
</p>


<h3>References</h3>

<p>Beverton, R.J.H., Holt, S.J. (1957). On the Dynamics of Exploited Fish Populations, volume 19 of Fisheries Investigations (Series 2). United Kingdom Ministry of Agriculture and Fisheries.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

# Run the function
rec_BH(SSB[1], recruit_params[[1]])
</code></pre>

<hr>
<h2 id='rec_const'>The constant stock recruitment function</h2><span id='topic+rec_const'></span>

<h3>Description</h3>

<p>Calculates the number of recruits as given by the constant stock recruitment function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec_const(SSB, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rec_const_+3A_ssb">SSB</code></td>
<td>
<p>A numeric value representing the Spawning Stock Biomass (SSB) of a given species (g).</p>
</td></tr>
<tr><td><code id="rec_const_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code>, with each element in the list including a value of <code>a</code> for each species. <code>a</code> is a positive numeric value, often referred to as the <em>density-independent</em> parameter. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of recruits is defined as the value of <code>a</code>.
</p>


<h3>Value</h3>

<p>A numeric value representing the number of recruits of a given species.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

rec_const(SSB[1], recruit_params[[1]])
</code></pre>

<hr>
<h2 id='rec_hockey'>The hockey-stick stock recruitment function</h2><span id='topic+rec_hockey'></span>

<h3>Description</h3>

<p>Calculates the number of recruits as given by the hockey-stick stock recruitment function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec_hockey(SSB, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rec_hockey_+3A_ssb">SSB</code></td>
<td>
<p>A numeric value representing the Spawning Stock Biomass (SSB) of a given species (g).</p>
</td></tr>
<tr><td><code id="rec_hockey_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code>, with each element in the list including a value of <code>a</code> and <code>b</code> for each species. <code>a</code> is a positive numeric value, often referred to as the <em>density-independent</em> parameter. The default is 1. <code>b</code> is a positive numeric value, often referred to as the <em>density-dependent</em> parameter. The default is 0.001.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The stock recruitment function is defined as <code>min(a*(SSB/1e9), b)</code>.
</p>


<h3>Value</h3>

<p>A numeric value representing the number of recruits of a given species.
</p>


<h3>References</h3>

<p>Barrowman, N.J., Myers, R.A. (2000).  Still more spawner-recruit curves: the hockey stick and its generalisations. <em>Canadian Journal of Fisheries and Aquatic Science</em>, 57:665–676.
</p>
<p>Thorpe, R.B., Le Quesne, W.J.F., Luxford, F., Collie, J.S., Jennings, S. (2015). Evaluation and management implications of uncertainty in a multispecies size-structured model of population and community responses to fishing. <em>Methods in Ecology and Evolution</em>, 6:49-58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

rec_hockey(SSB[1], recruit_params[[1]])
</code></pre>

<hr>
<h2 id='rec_linear'>The density-independent stock recruitment function</h2><span id='topic+rec_linear'></span>

<h3>Description</h3>

<p>Calculates the number of recruits as given by the density-independent stock recruitment function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec_linear(SSB, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rec_linear_+3A_ssb">SSB</code></td>
<td>
<p>A numeric value representing the Spawning Stock Biomass (SSB) of a given species (g).</p>
</td></tr>
<tr><td><code id="rec_linear_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code>, with each element in the list including a value of <code>a</code> for each species. <code>a</code> is a positive numeric value, often referred to as the <em>density-independent</em> parameter. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of recruits is defined as <code>a*(SSB/1e9)</code>.
</p>


<h3>Value</h3>

<p>A numeric value representing the number of recruits of a given species.
</p>


<h3>References</h3>

<p>Ogle, D.H. (2016). Introductory Fisheries Analyses with R. CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_Ricker">rec_Ricker</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

rec_linear(SSB[1], recruit_params[[1]])
</code></pre>

<hr>
<h2 id='rec_Ricker'>The Ricker stock recruitment function</h2><span id='topic+rec_Ricker'></span>

<h3>Description</h3>

<p>Calculates the number of recruits as given by the Ricker stock recruitment function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rec_Ricker(SSB, rec_args)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rec_Ricker_+3A_ssb">SSB</code></td>
<td>
<p>A numeric value representing the Spawning Stock Biomass (SSB) of a given species (g).</p>
</td></tr>
<tr><td><code id="rec_Ricker_+3A_rec_args">rec_args</code></td>
<td>
<p>A list object of length <code>nfish</code>, with each element in the list including a value of <code>a</code> and <code>b</code> for each species. <code>a</code> is a positive numeric value, often referred to as the <em>density-independent</em> parameter. The default is 1. <code>b</code> is a positive numeric value, often referred to as the <em>density-dependent</em> parameter. The default is 0.001.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Ricker stock recruitment function is defined as <code>a*(SSB/1e9))*exp(-b*(SSB/1e9))</code>.
</p>


<h3>Value</h3>

<p>A numeric value representing the number of recruits of a given species.
</p>


<h3>References</h3>

<p>Hall, S. J., Collie, J. S., Duplisea, D. E., Jennings, S., Bravington, M., &amp; Link, J. (2006). A length-based multispecies model for evaluating community responses to fishing. <em>Canadian Journal of Fisheries and Aquatic Sciences</em>, 63(6):1344-1359.
</p>
<p>Ricker, W.E. (1954). Stock and recruitment. <em>Journal of the Fisheries Research Board of Canada</em>, 11:559-623.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_recruits">calc_recruits</a></code>, <code><a href="#topic+make_rec_fun">make_rec_fun</a></code>, <code><a href="#topic+get_rec_fun">get_rec_fun</a></code>, <code><a href="#topic+rec_BH">rec_BH</a></code>, <code><a href="#topic+rec_hockey">rec_hockey</a></code>, <code><a href="#topic+rec_const">rec_const</a></code>, <code><a href="#topic+rec_linear">rec_linear</a></code> and <code><a href="#topic+calc_SSB">calc_SSB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi_min &lt;- tmp$phi_min

# Run calc_ration_growthfac()
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)

# Calculate the SSB
SSB &lt;- calc_SSB(mature, N0, wgt)

rec_Ricker(SSB[1], recruit_params[[1]])
</code></pre>

<hr>
<h2 id='run_LeMans'>Project the LeMans model</h2><span id='topic+run_LeMans'></span><span id='topic+run_LeMans+2Cmissing-method'></span><span id='topic+run_LeMans+2CLeMans_param-method'></span>

<h3>Description</h3>

<p>Project the LeMans model forward in time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_LeMans(params, ...)

## S4 method for signature 'missing'
run_LeMans(
  N0,
  Fs,
  tot_time,
  nsc,
  nfish,
  phi_min,
  mature,
  sc_Linf,
  wgt,
  phi,
  ration,
  other,
  M1,
  suit_M2,
  stored_rec_funs,
  recruit_params,
  eps = 1e-05
)

## S4 method for signature 'LeMans_param'
run_LeMans(
  params,
  years = 10,
  N0 = NULL,
  effort = matrix(0, years, dim(params@Qs)[3]),
  Fs,
  intercept = 1e+10,
  slope = -5,
  tot_time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_LeMans_+3A_params">params</code></td>
<td>
<p>A <a href="#topic+LeMans_param-class">LeMans_param</a> object containing the parameter values of the current LeMans model.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_n0">N0</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the number of individuals in each length class when the model is initialised.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_fs">Fs</code></td>
<td>
<p>An array with dimensions <code>nsc</code>, <code>nfish</code> and <code>tot_time</code> representing the fishing mortality of each species in each length class at each time step.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_tot_time">tot_time</code></td>
<td>
<p>A numeric value representing the number of time steps to run the model for.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_nsc">nsc</code></td>
<td>
<p>A numeric value representing the number of length classes in the model.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_nfish">nfish</code></td>
<td>
<p>A numeric value representing the number of fish species in the model.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_phi_min">phi_min</code></td>
<td>
<p>A numeric value representing the time step of the model.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_mature">mature</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> and elements in the range 0-1 representing the proportion of individuals that are mature for each species and length class.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_sc_linf">sc_Linf</code></td>
<td>
<p>A numeric vector of length <code>nsc</code> representing the length class at which each species reaches its asymptotic length.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_wgt">wgt</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the weight of each species in each length class.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_phi">phi</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the proportion of individuals that leave each length class.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_ration">ration</code></td>
<td>
<p>A matrix with dimensions <code>nsc</code> and <code>nfish</code> representing the amount of food required for fish of a given species and length class to grow according to the von Bertalanffy growth curve in a time step.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_other">other</code></td>
<td>
<p>A numeric value representing the amount of other food (g) available from prey that is not explicitly represented in the model.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_m1">M1</code></td>
<td>
<p>A matrix of dimensions <code>nsc</code> and <code>nfish</code> representing the natural mortality of each species for each length class.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_suit_m2">suit_M2</code></td>
<td>
<p>A list object of length <code>nfish</code>. Each element in the list is an array of dimensions <code>nsc</code>, <code>nsc</code> and <code>nfish</code> containing a value between zero and 1 representing prey preference and prey suitability for each species and length class.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_stored_rec_funs">stored_rec_funs</code></td>
<td>
<p>A list object of length <code>nfish</code> where each element includes the stock recruitment function for each species. If an invalid recruitment function is selected, <code>NULL</code> is returned and a warning message is shown.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_recruit_params">recruit_params</code></td>
<td>
<p>A list object of length <code>nfish</code> specifying the parameters for the recruitment function.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_eps">eps</code></td>
<td>
<p>A numeric value specifying a numerical offset. The default value is <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_years">years</code></td>
<td>
<p>A numeric value representing the number of years that the model is run for. The default is 10.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_effort">effort</code></td>
<td>
<p>A matrix with dimensions <code>years</code> and the number of fishing gears, representing fishing effort in each year for each gear. This parameter is required only if <code>Fs</code> is missing.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_intercept">intercept</code></td>
<td>
<p>A numeric value representing the number of individuals in the first length class. This parameter is only required if <code>N0</code> is missing. The default is <code>1e10</code>.</p>
</td></tr>
<tr><td><code id="run_LeMans_+3A_slope">slope</code></td>
<td>
<p>A numeric value representing the slope of the community size spectrum. This parameter is only required if <code>N0</code> is missing. The default is -5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LeMans_outputs-class">LeMans_outputs</a></code>, <code><a href="#topic+LeMans_param-class">LeMans_param</a></code>, <code><a href="#topic+LeMansParam">LeMansParam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the model with all inputs specified explicitly:
# Set up the inputs to the function - species-independent parameters
nfish &lt;- nrow(NS_par)
nsc &lt;- 32
maxsize &lt;- max(NS_par$Linf)*1.01 # the biggest size is 1% bigger than the largest Linf
l_bound &lt;- seq(0, maxsize, maxsize/nsc); l_bound &lt;- l_bound[-length(l_bound)]
u_bound &lt;- seq(maxsize/nsc, maxsize, maxsize/nsc)
mid &lt;- l_bound+(u_bound-l_bound)/2

# Set up the inputs to the function - species-specific parameters
Linf &lt;- NS_par$Linf # the von-Bertalanffy asymptotic length of each species (cm).
W_a &lt;- NS_par$W_a # length-weight conversion parameter.
W_b &lt;- NS_par$W_b # length-weight conversion parameter.
k &lt;- NS_par$k # the von-Bertalnaffy growth parameter.
Lmat &lt;- NS_par$Lmat # the length at which 50\% of individuals are mature (cm).

# Get phi_min
tmp &lt;- calc_phi(k, Linf, nsc, nfish, u_bound, l_bound, calc_phi_min=FALSE,
                  phi_min=0.1) # fixed phi_min
phi &lt;- tmp$phi
phi_min &lt;- tmp$phi_min

# Calculate growth increments
tmp &lt;- calc_ration_growthfac(k, Linf, nsc, nfish, l_bound, u_bound, mid, W_a, W_b, phi_min)
ration &lt;- tmp$ration
sc_Linf &lt;- tmp$sc_Linf
wgt &lt;- tmp$wgt
g_eff &lt;- tmp$g_eff

# Calculate maturity
mature &lt;- calc_mature(Lmat, nfish, mid, kappa=rep(10, nfish), sc_Linf)

# Create recruitment functions
stored_rec_funs &lt;- get_rec_fun(rep("hockey-stick", nfish))
recruit_params &lt;- do.call("Map", c(c, list(a=NS_par$a, b=NS_par$b)))

# Calculate background mortality
M1 &lt;- calc_M1(nsc, sc_Linf, phi_min)

# Calculate predator-prey size preferences
prefs &lt;- calc_prefs(pred_mu=-2.25, pred_sigma=0.5, wgt, sc_Linf)

# Calculate prey preference and prey suitability
suit_M2 &lt;- calc_suit_vect(nsc, nfish, sc_Linf, prefs, NS_tau)

# Calculate catchability
Qs &lt;- calc_Q(curve=rep("logistic", nfish), species=NS_par$species_names,
             max_catchability=rep(1, nfish), gear_name=NS_par$species_names,
             nsc=nsc, nfish=nfish, mid=mid, l_bound=l_bound, u_bound=u_bound,
             species_names=NS_par$species_names, eta=rep(0.25, nfish), L50=Lmat)

# Get an initial population
N0 &lt;- get_N0(nsc, nfish, mid, wgt, sc_Linf, intercept=1e10, slope=-5)
years &lt;- 10 # run the model for 10 years
tot_time &lt;- years*phi_min # total number of time steps

# Define fishing effort to be 0.5 for all species
effort &lt;- matrix(0.5, tot_time, dim(Qs)[3])

# Calculate F
Fs &lt;- array(0, dim=c(nsc, nfish, tot_time))
for (j in 1:ncol(effort)) {
  for (ts in 1:tot_time) {
    Fs[,,ts] &lt;- Fs[,,ts]+effort[ts, j]*Qs[,,j]
  }
}

# Run the model
model_run &lt;- run_LeMans(N0=N0, tot_time=tot_time, Fs=Fs, nsc=nsc, nfish=nfish,
                        phi_min=phi_min, mature=mature, sc_Linf=sc_Linf, wgt=wgt,
                        phi=phi, ration=ration, other=NS_other, M1=M1, suit_M2=suit_M2,
                        stored_rec_funs=stored_rec_funs, recruit_params=recruit_params,
                        eps=1e-05)

##############################################
# Alternatively:
NS_params &lt;- LeMansParam(NS_par,tau=NS_tau,eta=rep(0.25,21),L50=NS_par$Lmat,other=NS_other)

# Define fishing effort
effort &lt;- matrix(0.5, 10, dim(NS_params@Qs)[3])

# Run the model
model_run &lt;- run_LeMans(NS_params, years=10, effort=effort)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
