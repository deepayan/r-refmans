<!DOCTYPE html><html lang="en"><head><title>Help for package bayesnec</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesnec}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayesnec-package'><p>The 'bayesnec' package.</p></a></li>
<li><a href='#+26quot+3Bbeta_binomial+26quot+3B'><p>Custom beta-binomial family</p></a></li>
<li><a href='#+2B.bnecfit'><p>&quot;Add&quot; multiple <code>bnecfit</code> objects into one single</p>
<code>bayesmanecfit</code> object containing Bayesian model averaging
statistics.</a></li>
<li><a href='#amend'><p>Amends an existing <code>bayesmanecfit</code> object</p></a></li>
<li><a href='#autoplot'><p>bayesnec standard ggplot2 plotting method</p></a></li>
<li><a href='#average_estimates'><p>average_estimates</p></a></li>
<li><a href='#bayesmanecfit-class'><p>Class <code>bayesmanecfit</code> of models fitted with the <span class="pkg">brms</span> package</p></a></li>
<li><a href='#bayesnecfit-class'><p>Class <code>bayesnecfit</code> of models fitted with the <span class="pkg">brms</span> package</p></a></li>
<li><a href='#bayesnecformula'><p>Set up a model formula for use in</p>
<code>bayesnec</code></a></li>
<li><a href='#bnec'><p>bnec</p></a></li>
<li><a href='#bnec_newdata'><p>bnec_newdata</p></a></li>
<li><a href='#bnecfit-class'><p>Class <code>bnecfit</code> of models fitted with function <code>bnec</code></p></a></li>
<li><a href='#c.bnecfit'><p>Concatenate multiple <code>bnecfit</code> objects into one single</p>
<code>bayesmanecfit</code> object containing Bayesian model averaging
statistics.</a></li>
<li><a href='#check_chains'><p>Checking chain convergence</p></a></li>
<li><a href='#check_formula'><p>Check if input model formula is appropriate to use with</p>
<code>bayesnec</code></a></li>
<li><a href='#check_priors'><p>Plots the prior and posterior parameter probability densities from an</p>
object of class <code>bayesnecfit</code> or <code>bayesmanecfit</code>.</a></li>
<li><a href='#compare_estimates'><p>compare_estimates</p></a></li>
<li><a href='#compare_fitted'><p>compare_fitted</p></a></li>
<li><a href='#compare_posterior'><p>compare_posterior</p></a></li>
<li><a href='#dispersion'><p>Posterior dispersion</p></a></li>
<li><a href='#ecx'><p>Extracts the predicted ECx value</p></a></li>
<li><a href='#expand_manec'><p>Extracts a range of statistics from a list of <code>prebayesnecfit</code></p>
objects.</a></li>
<li><a href='#expand_nec'><p>Extracts a range of statistics from a <code>prebayesnecfit</code> object.</p></a></li>
<li><a href='#fitted'><p>Generates mean posterior linear predictions for objects fitted by</p>
<code>bnec</code></a></li>
<li><a href='#formula'><p>Retrieve formulas from models fitted by <code>bnec</code></p></a></li>
<li><a href='#ggbnec_data'><p>Creates the data.frame for plotting with <code>autoplot</code>.</p></a></li>
<li><a href='#herbicide'><p>Herbicide phytotoxicity data</p></a></li>
<li><a href='#is_manecsummary'><p>Checks if argument is a <code>manecsummary</code> object</p></a></li>
<li><a href='#is_necsummary'><p>Checks if argument is a <code>necsummary</code> object</p></a></li>
<li><a href='#make_brmsformula'><p>Expose the final <code>brmsformula</code></p></a></li>
<li><a href='#manec_example'><p>Example bayesmanecfit object</p></a></li>
<li><a href='#manecsummary-class'><p>Class <code>manecsummary</code> of models fitted with the <span class="pkg">brms</span> package</p></a></li>
<li><a href='#model.frame'><p>Model.frame methods in bayesnec.</p></a></li>
<li><a href='#models'><p>models</p></a></li>
<li><a href='#nec'><p>Extracts the predicted NEC value as desired from an object of class</p>
<code>bayesnecfit</code> or <code>bayesmanecfit</code>.</a></li>
<li><a href='#nec_data'><p>Example data of non-linear decay</p></a></li>
<li><a href='#necsummary-class'><p>Class <code>necsummary</code> of models fitted with the <span class="pkg">brms</span> package</p></a></li>
<li><a href='#nsec'><p>Extracts the predicted NSEC value as desired from an</p>
object of class <code>bayesnecfit</code> or <code>bayesmanecfit</code>.</a></li>
<li><a href='#plot'><p>Generates a plot for objects fitted by <code>bnec</code></p></a></li>
<li><a href='#posterior_epred'><p>Generates posterior linear predictions for objects fitted by</p>
<code>bnec</code></a></li>
<li><a href='#posterior_predict'><p>Generates posterior predictions for objects fitted by <code>bnec</code></p></a></li>
<li><a href='#prebayesnecfit-class'><p>Class <code>prebayesnecfit</code> of models fitted with the <span class="pkg">brms</span> package</p></a></li>
<li><a href='#predict'><p>Generates mean posterior predictions for objects fitted by</p>
<code>bnec</code></a></li>
<li><a href='#print'><p>Prints a summary for objects fitted by <code>bnec</code></p></a></li>
<li><a href='#pull_brmsfit.bayesnecfit'><p>Extract and object of class <code>brmsfit</code> from</p>
<code>bayesnecfit</code> or <code>bayesmanecfit</code>.</a></li>
<li><a href='#pull_out'><p>pull_out</p></a></li>
<li><a href='#pull_prior'><p>pull_prior</p></a></li>
<li><a href='#rhat'><p>Extract Diagnostic Quantities of 'brms' Models</p></a></li>
<li><a href='#sample_priors'><p>sample_priors</p></a></li>
<li><a href='#show_params'><p>show_params</p></a></li>
<li><a href='#step'><p>step</p></a></li>
<li><a href='#summary'><p>Generates a summary for objects fitted by <code>bnec</code></p></a></li>
<li><a href='#update.bnecfit'><p>Update an object of class <code>bnecfit</code> as fitted by function</p>
<code>bnec</code>.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Bayesian No-Effect- Concentration (NEC) Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of No-Effect-Concentration estimation that uses 'brms' (see Burkner (2017)&lt;<a href="https://doi.org/10.18637%2Fjss.v080.i01">doi:10.18637/jss.v080.i01</a>&gt;; Burkner (2018)&lt;<a href="https://doi.org/10.32614%2FRJ-2018-017">doi:10.32614/RJ-2018-017</a>&gt;; Carpenter 'et al.' (2017)&lt;<a href="https://doi.org/10.18637%2Fjss.v076.i01">doi:10.18637/jss.v076.i01</a>&gt; to fit concentration(dose)-response data using Bayesian methods for the purpose of estimating 'ECx' values, but more particularly 'NEC' (see Fox (2010)&lt;<a href="https://doi.org/10.1016%2Fj.ecoenv.2009.09.012">doi:10.1016/j.ecoenv.2009.09.012</a>&gt;), 'NSEC' (see Fisher and Fox (2023)&lt;<a href="https://doi.org/10.1002%2Fetc.5610">doi:10.1002/etc.5610</a>&gt;), and 'N(S)EC (see Fisher et al. 2023&lt;<a href="https://doi.org/10.1002%2Fieam.4809">doi:10.1002/ieam.4809</a>&gt;). A full description of this package can be found in Fisher 'et al.' (2024)&lt;<a href="https://doi.org/10.18637%2Fjss.v110.i05">doi:10.18637/jss.v110.i05</a>&gt;. This package expands and supersedes an original version implemented in 'R2jags' (see Su and Yajima (2020)<a href="https://CRAN.R-project.org/package=R2jags">https://CRAN.R-project.org/package=R2jags</a>; Fisher et al. (2020)&lt;<a href="https://doi.org/10.5281%2FZENODO.3966864">doi:10.5281/ZENODO.3966864</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1), brms, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>formula.tools, loo, dplyr, tidyr, purrr, tibble, tidyselect,
evaluate, rlang, chk (&ge; 0.7.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rstan, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://open-aims.github.io/bayesnec/">https://open-aims.github.io/bayesnec/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/open-aims/bayesnec/issues">https://github.com/open-aims/bayesnec/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-19 04:49:12 UTC; dbarneche</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebecca Fisher <a href="https://orcid.org/0000-0001-5148-6731"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Diego R. Barneche <a href="https://orcid.org/0000-0002-4568-2362"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gerard F. Ricardo <a href="https://orcid.org/0000-0002-2220-3971"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David R. Fox <a href="https://orcid.org/0000-0002-3178-7243"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rebecca Fisher &lt;r.fisher@aims.gov.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-19 06:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayesnec-package'>The 'bayesnec' package.</h2><span id='topic+bayesnec-package'></span><span id='topic+bayesnec'></span>

<h3>Description</h3>

<p>A No-Effect toxicity estimation package that uses brms (Bürkner
(2018), https://github.com/paul-buerkner/brms) to fit concentration
(dose)-response data using Bayesian methods for the purpose of estimating
both Effect Concentration (ECx) values, but more particularly 'NEC'
(Fox 2010), 'NSEC' (Fisher and Fox 2023), and 'N(S)EC (Fisher et al. 2023).
A full description of bayesnec can be found in Fisher et al. (2024).
Please see ?bnec for more details. This package expands and supersedes an
original version implemented in R2jags (Su and Yajima 2020), see Fisher et
</p>


<h3>References</h3>

<p>Bürkner P-C (2018) Advanced Bayesian Multilevel Modeling with the R Package
brms. The R Journal, 10: 395-411. doi:10.32614/RJ-2018-017.
</p>
<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fisher R, Ricardo GF, Fox, DR (2020) jagsNEC: A Bayesian No Effect
Concentration (NEC) package. doi:10.5281/ZENODO.3966864.
</p>
<p>Su Y, Yajima M (2020). R2jags: Using R to Run 'JAGS'. R package version
0.6-1, <a href="https://CRAN.R-project.org/package=R2jags">https://CRAN.R-project.org/package=R2jags</a>.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>

<hr>
<h2 id='+26quot+3Bbeta_binomial+26quot+3B'>Custom beta-binomial family</h2><span id='topic++22beta_binomial+22'></span>

<h3>Description</h3>

<p>Custom beta-binomial family
</p>


<h3>Format</h3>

<p>An object of class <code><a href="brms.html#topic+customfamily">customfamily</a></code>
</p>

<hr>
<h2 id='+2B.bnecfit'>&quot;Add&quot; multiple <code><a href="#topic+bnecfit">bnecfit</a></code> objects into one single
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object containing Bayesian model averaging
statistics.</h2><span id='topic++2B.bnecfit'></span>

<h3>Description</h3>

<p>&quot;Add&quot; multiple <code><a href="#topic+bnecfit">bnecfit</a></code> objects into one single
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object containing Bayesian model averaging
statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnecfit'
e1 + e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2B.bnecfit_+3A_e1">e1</code></td>
<td>
<p>An object of class <code><a href="#topic+bnecfit">bnecfit</a></code>.</p>
</td></tr>
<tr><td><code id="+2B2B.bnecfit_+3A_e2">e2</code></td>
<td>
<p>An object of class <code><a href="#topic+bnecfit">bnecfit</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
# Go from two bayesnecfit objects to a bayesmanecfit object.
#   In this example case it is redundant because it recovers the original
#   `manec_example`.
nec4param + ecx4param
# Add a bayesnecfit object to an existing bayesmanecfit object
nechorme4 &lt;- nec_data |&gt;
  dplyr::mutate(y = qlogis(y)) |&gt;
  (\(.)bnec(formula = y ~ crf(x, model = "nechorme4"),
            data = ., iter = 200, warmup = 150, chains = 2,
            stan_model_args = list(save_dso = FALSE)))()
nechorme4 + manec_example

## End(Not run)

</code></pre>

<hr>
<h2 id='amend'>Amends an existing <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object</h2><span id='topic+amend'></span>

<h3>Description</h3>

<p>Amends an existing <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object, for example, by
adding or removing fitted models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>amend(
  object,
  drop,
  add,
  loo_controls,
  x_range = NA,
  resolution = 1000,
  sig_val = 0.01,
  priors
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="amend_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>, as returned
by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="amend_+3A_drop">drop</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector containing the names of
model types you which to exclude for the modified fit.</p>
</td></tr>
<tr><td><code id="amend_+3A_add">add</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector containing the names of
model types you which to include to the modified fit.</p>
</td></tr>
<tr><td><code id="amend_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
<tr><td><code id="amend_+3A_x_range">x_range</code></td>
<td>
<p>A range of predictor values over which to consider extracting
ECx.</p>
</td></tr>
<tr><td><code id="amend_+3A_resolution">resolution</code></td>
<td>
<p>The length of the predictor vector used for posterior
predictions, and over which to extract ECx values. Large values will be
slower but more precise.</p>
</td></tr>
<tr><td><code id="amend_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values against the lowest observed
concentration (assumed to be the control), to estimate NEC as an
interpolated NOEC value from smooth ECx curves.</p>
</td></tr>
<tr><td><code id="amend_+3A_priors">priors</code></td>
<td>
<p>An object of class <code><a href="brms.html#topic+brmsprior">brmsprior</a></code> which
specifies user-desired prior distributions of model parameters.
If missing, <code><a href="#topic+amend">amend</a></code> will figure out a baseline prior for each
parameter. It can also be specified as a named <code><a href="base.html#topic+list">list</a></code>
where each name needs to correspond to the same string as <code>model</code>. See
Details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All successfully fitted <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
data(manec_example)
exmp &lt;- amend(manec_example, drop = "nec4param")

</code></pre>

<hr>
<h2 id='autoplot'>bayesnec standard ggplot2 plotting method</h2><span id='topic+autoplot'></span><span id='topic+autoplot.bayesnecfit'></span><span id='topic+autoplot.bayesmanecfit'></span>

<h3>Description</h3>

<p><code><a href="#topic+bayesnec-package">bayesnec</a></code> standard <span class="pkg">ggplot2</span>
plotting method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
autoplot(object, ..., nec = TRUE, ecx = FALSE, xform = identity)

## S3 method for class 'bayesmanecfit'
autoplot(
  object,
  ...,
  nec = TRUE,
  ecx = FALSE,
  xform = identity,
  all_models = FALSE,
  plot = TRUE,
  ask = TRUE,
  newpage = TRUE,
  multi_facet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="#topic+ggbnec_data">ggbnec_data</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_nec">nec</code></td>
<td>
<p>Should NEC values be added to the plot? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_ecx">ecx</code></td>
<td>
<p>Should ECx values be added to the plot? Defaults to FALSE..</p>
</td></tr>
<tr><td><code id="autoplot_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_all_models">all_models</code></td>
<td>
<p>Should all individual models be plotted separately\
(defaults to FALSE) or should model averaged predictions be plotted instead?</p>
</td></tr>
<tr><td><code id="autoplot_+3A_plot">plot</code></td>
<td>
<p>Should output <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> output be plotted?
Only relevant if <code>all = TRUE</code> and <code>multi_facet = FALSE</code>.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_ask">ask</code></td>
<td>
<p>Indicates if the user is prompted before a new page is plotted.
Only relevant if <code>plot = TRUE</code> and <code>multi_facet = FALSE</code>.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_newpage">newpage</code></td>
<td>
<p>Indicates if the first set of plots should be plotted to a
new page. Only relevant if <code>plot = TRUE</code> and
<code>multi_facet = FALSE</code>.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_multi_facet">multi_facet</code></td>
<td>
<p>Should all plots be plotted in one single panel via
facets? Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(brms)
nec4param &lt;- pull_out(manec_example, "nec4param")
autoplot(nec4param)
autoplot(nec4param, nec = FALSE)
autoplot(nec4param, ecx = TRUE, ecx_val = 50)

# plot model averaged predictions
autoplot(manec_example)
# plot all panels together
autoplot(manec_example, ecx = TRUE, ecx_val = 50, all_models = TRUE)

## End(Not run)
## Not run: 
# plots multiple models, one at a time, with interactive prompt
autoplot(manec_example, ecx = TRUE, ecx_val = 50, all_models = TRUE,
         multi_facet = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='average_estimates'>average_estimates</h2><span id='topic+average_estimates'></span>

<h3>Description</h3>

<p>Extracts posterior predicted estimate values from a list of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits and
calculates a geometric mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>average_estimates(
  x,
  estimate = "nec",
  ecx_val = 10,
  posterior = FALSE,
  type = "absolute",
  hormesis_def = "control",
  sig_val = 0.01,
  resolution = 1000,
  x_range = NA,
  xform = identity,
  prob_vals = c(0.5, 0.025, 0.975)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="average_estimates_+3A_x">x</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of objects of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_estimate">estimate</code></td>
<td>
<p>The type of estimate to use in the mean. Takes values
&quot;nec&quot;, &quot;ecx&quot; or &quot;nsec&quot;.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_ecx_val">ecx_val</code></td>
<td>
<p>The desired percentage effect value. This must be a value
between 1 and 99 (for type = &quot;relative&quot; and &quot;absolute&quot;), defaults to 10.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_posterior">posterior</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the full
posterior sample of calculated ECx values should be returned instead of
just the median and 95 credible intervals.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_type">type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values of
&quot;relative&quot;, &quot;absolute&quot; (the default) or &quot;direct&quot;. See Details.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_hormesis_def">hormesis_def</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values
of &quot;max&quot; or &quot;control&quot;. See Details.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find ECx &ndash;
large values will make the ECx estimate more precise.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting ECx.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="average_estimates_+3A_prob_vals">prob_vals</code></td>
<td>
<p>A vector indicating the probability values over which to
return the estimated ECx value. Defaults to 0.5 (median) and 0.025 and
0.975 (95 percent credible intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The geometric mean of values are simply the mean calculated on a
log scale and back transformed through <code><a href="base.html#topic+exp">exp</a></code>, although we
have added the capacity to accommodate zero values. Note that the function
assumes that <code>x</code> has been modelled on the natural scale. Often CR
models are more stable on a log-transformed or sqrt scaling. If the input
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits are
already based on a re-scaling of the x (concentration) axis, it is important
to pass an appropriate xform argument to ensure these are back transformed
before the the geometric mean calculation is applied.
</p>


<h3>Value</h3>

<p>The geometric mean of the estimates estimate values
of the <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>
model fits contained in <code>x</code>. See Details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(brms)
library(bayesnec)
data(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
average_estimates(list("nec" = ecx4param, "ecx" = nec4param), ecx_val = 50)

## End(Not run)

</code></pre>

<hr>
<h2 id='bayesmanecfit-class'>Class <code>bayesmanecfit</code> of models fitted with the <span class="pkg">brms</span> package</h2><span id='topic+bayesmanecfit-class'></span><span id='topic+bayesmanecfit'></span>

<h3>Description</h3>

<p>Multiple models fitted with the
<code><a href="#topic+bayesnec-package">bayesnec</a></code> package are
represented as a <code>bayesmanecfit</code> object, which contains the original
<code><a href="brms.html#topic+brmsfit">brmsfit</a></code> fitted objects, names of non-linear models that
were fitted, model averaging WAIC stats, sample size, mean posterior
no-effect toxicity values (NEC, NSEC or N(S)EC), mean model averaged
predictions on the data  scale, model averaged residuals, full posterior
distribution of predicated values, and summary statistics of no-effect
toxicity.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "bayesmanecfit")</code> for an overview of
available methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>mod_fits</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> of fitted model outputs of class
<code>prebayesnecfit</code> for each of the fitted models.</p>
</dd>
<dt><code>success_models</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector indicating the
name of the successfully fitted models.</p>
</dd>
<dt><code>mod_stats</code></dt><dd><p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> of model fit statistics.</p>
</dd>
<dt><code>sample_size</code></dt><dd><p>The size of the posterior sample.
Information on the priors used in the model.</p>
</dd>
<dt><code>w_ne_posterior</code></dt><dd><p>The model-weighted posterior estimate of the no-effect
toxicity estimate.</p>
</dd>
<dt><code>w_predicted_y</code></dt><dd><p>The model-weighted predicted values for the observed
data.</p>
</dd>
<dt><code>w_residuals</code></dt><dd><p>Model-weighted residual values
(i.e. observed - w_predicted_y).</p>
</dd>
<dt><code>w_pred_vals</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing model-weighted
posterior predicted values based on the supplied <code>resolution</code> and
<code>x_range</code>.</p>
</dd>
<dt><code>w_ne</code></dt><dd><p>The summary stats (median and 95% credibility intervals) of
w_ne_posterior.</p>
</dd>
<dt><code>ne_type</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector indicating the type of
no-effect toxicity estimate. Where the fitted model(s) are NEC models
(threshold models, containing a step function) the no-effect estimate is
a true no-effect-concentration (<code>NEC</code>, see Fox 2010). Where the fitted
model(s) are
smooth ECx models with no step function, the no-effect estimate is a
no-significant-effect-concentration (<code>NSEC</code>, see Fisher and Fox 2023).
In the
case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> that contains a mixture of both NEC and
ECx models, the no-effect estimate is a model averaged combination of the NEC
and NSEC estimates, and is reported as the <code>N(S)EC</code>
(see Fisher et al. 2023).</p>
</dd>
</dl>


<h3>References</h3>

<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>
</p>

<hr>
<h2 id='bayesnecfit-class'>Class <code>bayesnecfit</code> of models fitted with the <span class="pkg">brms</span> package</h2><span id='topic+bayesnecfit-class'></span><span id='topic+bayesnecfit'></span>

<h3>Description</h3>

<p>Models fitted with the <code><a href="#topic+bayesnec-package">bayesnec</a></code>
package are represented as a <code>bayesnecfit</code> object, which contain the
original <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> fitted object, list of initialisation
values used, the validated <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>, name of non-linear
model that was fitted, posterior predictions, posterior parameter estimates
and a series of other statistics.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "bayesnecfit")</code> for an overview of
available methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>fit</code></dt><dd><p>The fitted Bayesian model of class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code>.</p>
</dd>
<dt><code>model</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string indicating the name of
the fitted model.</p>
</dd>
<dt><code>init</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing the initialisation values
to fit the model.</p>
</dd>
<dt><code>bayesnecformula</code></dt><dd><p>An object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and
<code><a href="stats.html#topic+formula">formula</a></code>.</p>
</dd>
<dt><code>pred_vals</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing a
<code><a href="base.html#topic+data.frame">data.frame</a></code> of summary posterior predicted values
and a vector containing based on the supplied <code>resolution</code> and
<code>x_range</code>.</p>
</dd>
<dt><code>top</code></dt><dd><p>The estimate for parameter &quot;top&quot; in the fitted model.</p>
</dd>
<dt><code>beta</code></dt><dd><p>The estimate for parameter &quot;beta&quot; in the fitted model.</p>
</dd>
<dt><code>ne</code></dt><dd><p>The estimated NEC.</p>
</dd>
<dt><code>f</code></dt><dd><p>The estimate for parameter &quot;f&quot; in the fitted model, NA if
absent for the fitted model type.</p>
</dd>
<dt><code>bot</code></dt><dd><p>The estimate for parameter &quot;bot&quot; in the fitted model, NA if
absent for the fitted model type.</p>
</dd>
<dt><code>d</code></dt><dd><p>The estimate for parameter &quot;d&quot; in the fitted model, NA if absent
for the fitted model type.</p>
</dd>
<dt><code>slope</code></dt><dd><p>The estimate for parameter &quot;slope&quot; in the fitted model, NA if
absent for the fitted model type.</p>
</dd>
<dt><code>ec50</code></dt><dd><p>The estimate for parameter &quot;ec50&quot; in the fitted model, NA if
absent for the fitted model type.</p>
</dd>
<dt><code>dispersion</code></dt><dd><p>An estimate of dispersion.</p>
</dd>
<dt><code>predicted_y</code></dt><dd><p>The predicted values for the observed data.</p>
</dd>
<dt><code>residuals</code></dt><dd><p>Residual values of the observed data from the fitted model.</p>
</dd>
<dt><code>ne_posterior</code></dt><dd><p>A full posterior estimate of the NEC.</p>
</dd>
<dt><code>ne_type</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> vector indicating the type of
no-effect toxicity estimate. Where the fitted model is an NEC model
(threshold model, containing a step function) the no-effect estimate is
a true no-effect-concentration (<code>NEC</code>, see Fox 2010). Where the fitted
model is a smooth ECx model with no step function, the no-effect estimate is
a no-significant-effect-concentration (<code>NSEC</code>, see Fisher and Fox 2023).</p>
</dd>
</dl>


<h3>References</h3>

<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>,
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>
</p>

<hr>
<h2 id='bayesnecformula'>Set up a model formula for use in
<code><a href="#topic+bayesnec-package">bayesnec</a></code></h2><span id='topic+bayesnecformula'></span><span id='topic+bnf'></span>

<h3>Description</h3>

<p>Set up a model formula for use in the
<code><a href="#topic+bayesnec-package">bayesnec</a></code> package, allowing linear
and non-linear (potentially multi-level) concentration-response
models to be defined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayesnecformula(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayesnecformula_+3A_formula">formula</code></td>
<td>
<p>Either a <code><a href="base.html#topic+character">character</a></code> string defining an
R formula or an actual <code><a href="stats.html#topic+formula">formula</a></code> object. See details.</p>
</td></tr>
<tr><td><code id="bayesnecformula_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>methods(class = "bayesnecformula")</code> for an overview of
available methods.
</p>
<p><b>General formula syntax</b>
</p>
<p>The <code>formula</code> argument accepts formulas of the following syntax:
</p>
<p><code>response | aterms ~ crf(x, model) + glterms</code>
</p>
<p><b>The population-level term: <code>crf</code></b>
</p>
<p><code><a href="#topic+bayesnec-package">bayesnec</a></code> uses a special internal
term called <code>crf</code>, which sets the concentration-response equation
to be evaluated based on some <code>x</code> predictor. The equation itself is
defined by the argument <code>"model"</code>: a <code><a href="base.html#topic+character">character</a></code>
vector containing a specific model, a concatenation of specific models,
or a single string defining a particular group of models
(or group of equations, see <code><a href="#topic+models">models</a></code>). Internally
this argument is substituted by an actual <code><a href="brms.html#topic+brmsformula">brmsformula</a></code>,
which is then passed onto <code><a href="brms.html#topic+brm">brm</a></code> for model fitting.
</p>
<p><b>Group-level terms: <code>glterms</code></b>
</p>
<p>The user has three options to define group-level effects in a
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>: 1) a general &quot;offset&quot; group-level effect
defined by the term <code>ogl</code> (as in e.g. <code>ogl(group_variable)</code>). This
adds an additional population-level parameter <code>ogl</code> to the model defined
by <code>crf</code>, analogously to an intercept-only group-level effect
in a classic linear model. 2) A group-level effect applied to all
parameters in a model at once. This is done by the special term <code>pgl</code>,
(as in e.g. <code>pgl(group_variable)</code>), which comes in handy so the user
does not need to know the internal syntax and name of each parameter in the
model. 3) A more classic approach where the user can specify which
specific parameters &mdash; NB: that requires prior knowledge on the model
structure and parameter names &mdash; to vary according to a grouping variable
(as in e.g. <code>(bot | group_variable)</code>). <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>
will ignore this term should the parameter not exist in the specified model
or model suite. For example, the parameter <code>bot</code> exists in model
<code>"nec4param"</code> but not in <code>"nec3param"</code>, so if the user specifies
<code>model = "nec"</code> in <code>crf</code>, the term <code>(bot | group_variable)</code>
will be dropped in models where that parameter does not exist.
</p>
<p><b>Further brms terms (largely untested)</b>
</p>
<p>Currently <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> is quite agnostic about additional
terms that are valid for a <code><a href="brms.html#topic+brmsformula">brmsformula</a></code>. These are
<code>aterms</code> and <code>pterms</code> (see <code>?<a href="brms.html#topic+brmsformula">brmsformula</a></code>).
The only capability that <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> does not allow is
the addition of <code>pterms</code> outside of the term <code>crf</code>. Although
<code>pterms</code> can be passed to predictor <code>x</code> within <code>crf</code>, we
strongly discourage their use because those functionalities have not
been tested yet. If this is extremely important to your work, please
raise an issue on bayesnec GitHub, and we will consider further testing and
development.
Currently, the only two <code>aterms</code> that have validated behaviour are:
</p>

<ol>
<li> <p><code>trials()</code>, which is essential in binomially-distributed data, e.g.
<code>y | trials(trials_variable)</code>, and 2) weights, e.g.
<code>y | weights(weights_variable)</code>, following <span class="pkg">brms</span> formula syntax.
Please note that <span class="pkg">brms</span> does not implement design weights as in other
standard <span class="pkg">base</span> functions. From their help page, <span class="pkg">brms</span> &quot;takes the
weights literally, which means that an observation with weight 2 receives 2
times more weight than an observation with weight 1. It also means that
using a weight of 2 is equivalent to adding the corresponding observation
twice to the data frame&quot;. Other <code>aterms</code> might be added, though we
cannot attest to their functionality within
<code><a href="#topic+bayesnec-package">bayesnec</a></code>, i.e. checks will
be done outside via <code><a href="brms.html#topic+brm">brm</a></code>.
</p>
</li></ol>

<p><strong>NB:</strong> <code>aterms</code> other than <code>trials()</code> and <code>weights()</code> are
currently omitted from <code><a href="#topic+model.frame">model.frame</a></code> output. If you need other
<code>aterms</code> as part of that output please raise an issue on our GitHub
page.
</p>
<p><b>Validation of formula</b>
Please note that the function only checks for the input nature of the
<code>formula</code> argument and adds a new class. This function <strong>does not</strong>
perform any validation on the model nor checks on its adequacy to work with
other functions in the package. For that please refer to the function
<code><a href="#topic+check_formula">check_formula</a></code> which requires the dataset associated with the
formula.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and
<code><a href="stats.html#topic+formula">formula</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+check_formula">check_formula</a></code>,
<code><a href="#topic+model.frame">model.frame</a></code>,
<code><a href="#topic+models">models</a></code>,
<code><a href="#topic+show_params">show_params</a></code>,
<code><a href="#topic+make_brmsformula">make_brmsformula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)

bayesnecformula(y ~ crf(x, "nec3param"))
# or use shot alias bnf
bayesnecformula(y ~ crf(x, "nec3param")) == bnf(y ~ crf(x, "nec3param"))
bnf(y | trials(tr) ~ crf(sqrt(x), "nec3param"))
bnf(y | trials(tr) ~ crf(x, "nec3param") + ogl(group_1) + pgl(group_2))
bnf(y | trials(tr) ~ crf(x, "nec3param") + (nec + top | group_1))


# complex transformations are not advisable because
# they are passed directly to Stan via brms
# and are likely to fail -- transform your variable beforehand!
try(bnf(y | trials(tr) ~ crf(scale(x, scale = TRUE), "nec3param")))

</code></pre>

<hr>
<h2 id='bnec'>bnec</h2><span id='topic+bnec'></span>

<h3>Description</h3>

<p>Fits a variety of NEC models using Bayesian analysis and provides a model
averaged predictions based on WAIC model weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bnec(
  formula,
  data,
  x_range = NA,
  resolution = 1000,
  sig_val = 0.01,
  loo_controls,
  x_var = NULL,
  y_var = NULL,
  trials_var = NULL,
  model = NULL,
  random = NULL,
  random_vars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bnec_+3A_formula">formula</code></td>
<td>
<p>Either a <code><a href="base.html#topic+character">character</a></code> string defining an
R formula or an actual <code><a href="stats.html#topic+formula">formula</a></code> object. See
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="bnec_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the data to use with
the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="bnec_+3A_x_range">x_range</code></td>
<td>
<p>A range of predictor values over which to consider extracting
ECx.</p>
</td></tr>
<tr><td><code id="bnec_+3A_resolution">resolution</code></td>
<td>
<p>The length of the predictor vector used for posterior
predictions, and over which to extract ECx values. Large values will be
slower but more precise.</p>
</td></tr>
<tr><td><code id="bnec_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values against the lowest observed
concentration (assumed to be the control), to estimate NEC as an
interpolated NOEC value from smooth ECx curves.</p>
</td></tr>
<tr><td><code id="bnec_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
<tr><td><code id="bnec_+3A_x_var">x_var</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> indicating the column heading
containing the predictor (concentration) variable.</p>
</td></tr>
<tr><td><code id="bnec_+3A_y_var">y_var</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> indicating the column heading
containing the response variable.</p>
</td></tr>
<tr><td><code id="bnec_+3A_trials_var">trials_var</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> indicating the column
heading for the number of &quot;trials&quot; for binomial or &quot;beta_binomial&quot; response
data, as it appears in &quot;data&quot; (if data is supplied).</p>
</td></tr>
<tr><td><code id="bnec_+3A_model">model</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> vector indicating the model(s)
to fit. See Details for more information.</p>
</td></tr>
<tr><td><code id="bnec_+3A_random">random</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
named <code><a href="base.html#topic+list">list</a></code> containing the random model
formula to apply to model parameters.</p>
</td></tr>
<tr><td><code id="bnec_+3A_random_vars">random_vars</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> vector containing the
names of the columns containing the variables used in the random model
formula.</p>
</td></tr>
<tr><td><code id="bnec_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="brms.html#topic+brm">brm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Overview</b>
</p>
<p><code><a href="#topic+bnec">bnec</a></code> serves as a wrapper for (currently) 23 (mostly) non-linear
equations that are classically applied to concentration(dose)-response
problems. The primary goal of these equations is to provide the user with
estimates of No-Effect-Concentration (NEC),
No-Significant-Effect-Concentration (NSEC), and Effect-Concentration
(of specified percentage 'x', <em>ECx</em>) thresholds.
These in turn are fitted through the <code><a href="brms.html#topic+brm">brm</a></code> function from
package <span class="pkg">brms</span> and therefore further arguments to <code><a href="brms.html#topic+brm">brm</a></code>
are allowed. In the absence of those arguments, <code><a href="#topic+bnec">bnec</a></code> makes
its best attempt to calculate distribution family, priors and initialisation
values for the user based on the characteristics of the data. Moreover, in
the absence of user-specified values, <code><a href="#topic+bnec">bnec</a></code> sets the number of
iterations to 1e4 and warmup period to <code>floor(iterations / 5) * 4</code>.
The chosen models can be extended by the addition of <span class="pkg">brms</span> special
&quot;aterms&quot; as well as group-level effects. See <code>?<a href="#topic+bayesnecformula">bayesnecformula</a></code>
for details.
</p>
<p><b>The available models/equations/formulas</b>
</p>
<p>The available equations (or models) can be found via the <code><a href="#topic+models">models</a></code>
function. Since version 2.0, <code><a href="#topic+bnec">bnec</a></code> requires a specific formula
structure
which is fully explained in the help file of <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.
This formula incorporates the information regarding the chosen model(s). If
one single model is specified, <code><a href="#topic+bnec">bnec</a></code> will return an object of
class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>; otherwise if model is either a concatenation
of multiple models and/or a string indicating a family of models,
<code><a href="#topic+bnec">bnec</a></code> will return an object of class
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>, providing they were successfully fitted. The
major difference being that the output of the latter includes Bayesian model
averaging statistics. These classes come with multiple associated
methods such as <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>,
<code><a href="base.html#topic+summary">summary</a></code>, <code><a href="base.html#topic+print">print</a></code>,
<code><a href="stats.html#topic+model.frame">model.frame</a></code> and <code><a href="stats.html#topic+formula">formula</a></code>.
</p>
<p><code>model</code> may also be one of &quot;all&quot;, meaning all of the available models
will be fit; &quot;ecx&quot; meaning only models excluding a specific NEC step
parameter will be fit; &quot;nec&quot; meaning only models with a specific NEC step
parameter will be fit; &quot;bot_free&quot; meaning only models without a &quot;bot&quot;
parameter (without a bottom plateau) will be fit; &quot;zero_bounded&quot; are models
that are bounded to be zero; or &quot;decline&quot; excludes all hormesis models, i.e.,
only allows a strict decline in response across the whole predictor range.
Notice that if one of these group strings is provided together with a
user-specified named list for the <code><a href="brms.html#topic+brm">brm</a></code>'s argument
<code>prior</code>, the list names need to contain
the actual model names, and not the group string , e.g. if
<code>model = "ecx"</code> and <code>prior = my_priors</code> then
<code>names(my_priors)</code> must contain <code>models("ecx")</code>. To check
available models and associated parameters for each group,
use the function <code><a href="#topic+models">models</a></code> or to check the parameters of a
specific model use the function <code><a href="#topic+show_params">show_params</a></code>.
</p>
<p><b>No-effect toxicity estimates</b>
</p>
<p>Regardless of the model(s) fitted, the resulting object will contain a
no-effect toxicity estimate. Where the fitted model(s) are NEC models (threshold
models, containing a step function - all models with &quot;nec&quot; as a
prefix) the no-effect estimate is a true
no-effect-concentration (NEC, see Fox 2010). Where the fitted model(s) are
smooth ECx models with no step function (all models with &quot;ecx&quot; as a
prefix), the no-effect estimate is a no-significant-effect-concentration
(NSEC, see Fisher and Fox 2023).
In the case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> that contains a mixture of both
NEC and ECx models, the no-effect estimate is a model averaged combination of
the NEC and NSEC estimates, and is reported as the N(S)EC
(see Fisher et al. 2023).
</p>
<p><b>Further argument to <code><a href="brms.html#topic+brm">brm</a></code></b>
</p>
<p>If not supplied via the <code><a href="brms.html#topic+brm">brm</a></code> argument <code>family</code>, the
appropriate distribution will be guessed based on the characteristics of the
input data. Guesses include: &quot;bernoulli&quot; / bernoulli / bernoulli(), &quot;Beta&quot; /
Beta / Beta(), &quot;binomial&quot; / binomial / binomial(), &quot;beta_binomial&quot; /
&quot;beta_binomial&quot;, &quot;Gamma&quot; / Gamma / Gamma(), &quot;gaussian&quot; / gaussian /
gaussian(), &quot;negbinomial&quot; / negbinomial / negbinomial(), or &quot;poisson&quot; /
poisson / poisson(). Note, however, that &quot;negbinomial&quot; and &quot;betabinomimal2&quot;
require knowledge on whether the data is over-dispersed. As
explained below in the Return section, the user can extract the dispersion
parameter from a <code><a href="#topic+bnec">bnec</a></code> call, and if they so wish, can refit the
model using the &quot;negbinomial&quot; family.
</p>
<p>Other families can be considered as required, please raise an
<a href="https://github.com/open-AIMS/bayesnec/issues">issue</a> on the GitHub
development site if your required family is not currently available.
</p>
<p>As a default, <code><a href="#topic+bnec">bnec</a></code> sets the <code><a href="brms.html#topic+brm">brm</a></code> argument
<code>sample_prior</code> to &quot;yes&quot; in order to sample draws from the priors in
addition to the posterior distributions. Among others, these samples can be
used to calculate Bayes factors for point hypotheses via
<code><a href="brms.html#topic+hypothesis">hypothesis</a></code>.
</p>
<p>Model averaging is achieved through a weighted sample of each fitted models
posterior predictions, with weights derived using functions
<code><a href="brms.html#topic+loo">loo</a></code> and <code><a href="brms.html#topic+loo_model_weights">loo_model_weights</a></code> from
<span class="pkg">brms</span>. Argument to both these functions can be passed via the
<code>loo_controls</code> argument. Individual model fits can be pulled out
for examination using function <code><a href="#topic+pull_out">pull_out</a></code>.
</p>
<p><b>Additional technical notes</b>
</p>
<p>As some concentration-response data will use zero concentration
which can cause numerical estimation issues, a small offset is added (1 /
10th of the next lowest value) to zero values of concentration where
<code>x_var</code> are distributed on a continuous scale from 0 to infinity, or
are bounded to 0, or 1.
</p>
<p><b>NAs are thrown away</b>
</p>
<p>Stan's default behaviour is to fail when the input data contains NAs. For
that reason <span class="pkg">brms</span> excludes any NAs from input data prior to fitting,
and does not allow them back in as is the case with e.g. <code>stats::lm</code> and
<code>na.action = exclude</code>. So we advise that you exclude any NAs in your
data prior to fitting because if you so wish that should facilitate merging
predictions back onto your original dataset.
</p>


<h3>Value</h3>

<p>If argument model is a single string, then an object of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>; if many strings or a set,
an object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>References</h3>

<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnecformula">bayesnecformula</a></code>,
<code><a href="#topic+check_formula">check_formula</a></code>,
<code><a href="#topic+models">models</a></code>,
<code><a href="#topic+show_params">show_params</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(nec_data)

# A single model
exmp_a &lt;- bnec(y ~ crf(x, model = "nec4param"), data = nec_data, chains = 2)
# Two models model
exmp_b &lt;- bnec(y ~ crf(x, model = c("nec4param", "ecx4param")),
               data = nec_data, chains = 2)

## End(Not run)

</code></pre>

<hr>
<h2 id='bnec_newdata'>bnec_newdata</h2><span id='topic+bnec_newdata'></span>

<h3>Description</h3>

<p>Create a dataset for predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bnec_newdata(x, resolution = 100, x_range = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bnec_newdata_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> as returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="bnec_newdata_+3A_resolution">resolution</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of length 1 indicating
the number of x values over which to predict values.</p>
</td></tr>
<tr><td><code id="bnec_newdata_+3A_x_range">x_range</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector of length 2 indicating
the range of x values over which to make predictions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> to be used in predictions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
# Make fine resolution, predict out of range
newdata &lt;- bnec_newdata(nec4param, resolution = 200, x_range = c(0, 4))
nrow(newdata) == 200
all(range(newdata$x) == c(0, 4))
newdata2 &lt;- bnec_newdata(manec_example) # default size
nrow(newdata2) == 100

## End(Not run)

</code></pre>

<hr>
<h2 id='bnecfit-class'>Class <code>bnecfit</code> of models fitted with function <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+bnecfit-class'></span><span id='topic+bnecfit'></span>

<h3>Description</h3>

<p>This is a wrapper class which will be attached to both
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> and <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> classes. Useful
for methods which might need to take either class as an input
simultaneously.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "bnecfit")</code> for an overview of
available methods.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>
</p>

<hr>
<h2 id='c.bnecfit'>Concatenate multiple <code><a href="#topic+bnecfit">bnecfit</a></code> objects into one single
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object containing Bayesian model averaging
statistics.</h2><span id='topic+c.bnecfit'></span>

<h3>Description</h3>

<p>Concatenate multiple <code><a href="#topic+bnecfit">bnecfit</a></code> objects into one single
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object containing Bayesian model averaging
statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnecfit'
c(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="c.bnecfit_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bnecfit">bnecfit</a></code>.</p>
</td></tr>
<tr><td><code id="c.bnecfit_+3A_...">...</code></td>
<td>
<p>Additional objects of class <code><a href="#topic+bnecfit">bnecfit</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
# Go from two bayesnecfit objects to a bayesmanecfit object.
#   In this example case it is redundant because it recovers the original
#   `manec_example`.
c(nec4param, ecx4param)
# Add a bayesnecfit object to an existing bayesmanecfit object
nechorme4 &lt;- nec_data |&gt;
  dplyr::mutate(y = qlogis(y)) |&gt;
  (\(.)bnec(formula = y ~ crf(x, model = "nechorme4"),
            data = ., iter = 200, warmup = 150, chains = 2,
            stan_model_args = list(save_dso = FALSE)))()
c(nechorme4, manec_example)

## End(Not run)

</code></pre>

<hr>
<h2 id='check_chains'>Checking chain convergence</h2><span id='topic+check_chains'></span><span id='topic+check_chains.bayesnecfit'></span><span id='topic+check_chains.bayesmanecfit'></span>

<h3>Description</h3>

<p>Plots HMC chains for a <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fit as returned by <code><a href="#topic+bnec">bnec</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_chains(x, ...)

## S3 method for class 'bayesnecfit'
check_chains(x, ...)

## S3 method for class 'bayesmanecfit'
check_chains(x, filename = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_chains_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> as returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="check_chains_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="check_chains_+3A_filename">filename</code></td>
<td>
<p>An optional <code><a href="base.html#topic+character">character</a></code> vector to be used
as a pdf filename in the case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>. Any non
empty character string will indicate the user wants to save the plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, generates a plot or writes a pdf to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
check_chains(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
check_chains(nec4param)

## End(Not run)
</code></pre>

<hr>
<h2 id='check_formula'>Check if input model formula is appropriate to use with
<code><a href="#topic+bayesnec-package">bayesnec</a></code></h2><span id='topic+check_formula'></span>

<h3>Description</h3>

<p>Perform a series of checks to ensure that the input formula is valid
for usage within <code><a href="#topic+bayesnec-package">bayesnec</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_formula(formula, data, run_par_checks = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_formula_+3A_formula">formula</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> as returned
by function <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.</p>
</td></tr>
<tr><td><code id="check_formula_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables
specified in <code>formula</code>.</p>
</td></tr>
<tr><td><code id="check_formula_+3A_run_par_checks">run_par_checks</code></td>
<td>
<p>See details. A <code><a href="base.html#topic+logical">logical</a></code> defining
whether random terms for specific parameters should be checked against the
underlying concentration-response model defined in <code>formula</code>.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the user to make sure that the input formula
will allow for a successful model fit with the function <code><a href="#topic+bnec">bnec</a></code>.
Should all checks pass, the function returns the original formula. Otherwise
it will fail and requires that the user fixes it until they're able to use
it with <code><a href="#topic+bnec">bnec</a></code>.
</p>
<p>The argument <code>run_par_checks</code> is irrelevant for most usages of this
package because it only applies if three conditions are met: 1) the user has
specified a group-level effect; 2) the group-level effects is parameter
specific (e.g. <code>(par | group_variable)</code> rather than <code>pgl/ogl(group_variable)</code>); and 3) The user is keen to learn if the specified parameter
is found in the specified model (via argument <code>model</code> in the <code>crf</code> term &ndash; see details in ?bayesnecformula).
</p>
<p><strong>NB:</strong> <code>aterms</code> other than <code>trials()</code> and <code>weights()</code> are
currently omitted from <code><a href="#topic+model.frame">model.frame</a></code> output. If you need other
<code>aterms</code> as part of that output please raise an issue on our GitHub
page. See details about <code>aterms</code> in ?bayesnecformula.
</p>


<h3>Value</h3>

<p>A validated object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and
<code><a href="stats.html#topic+formula">formula</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
nec3param &lt;- function(beta, nec, top, x) {
  top * exp(-exp(beta) * (x - nec) *
    ifelse(x - nec &lt; 0, 0, 1))
}

data &lt;- data.frame(x = seq(1, 20, length.out = 10), tr = 100, wght = c(1, 2),
                   group_1 = sample(c("a", "b"), 10, replace = TRUE),
                   group_2 = sample(c("c", "d"), 10, replace = TRUE))
data$y &lt;- nec3param(beta = -0.2, nec = 4, top = 100, data$x)

# returns error
# &gt; f_1 &lt;- y ~ crf(x, "nec3param") + z
# regular formula not allowed, wrap it with function bnf
# &gt; check_formula(f_1, data)
# population-level covariates are not allowed
# &gt; check_formula(bnf(f_1), data)


# expect a series of messages for because not all
# nec models have the "bot" parameter
f_2 &lt;- y | trials(tr) ~ crf(x, "nec") + (nec + bot | group_1)
check_formula(bnf(f_2), data, run_par_checks = TRUE)

# runs fine
f_3 &lt;- "y | trials(tr) ~ crf(sqrt(x), \"nec3param\")"
check_formula(bnf(f_3), data)
f_4 &lt;- y | trials(tr) ~ crf(x, "nec3param") + ogl(group_1) + pgl(group_2)
inherits(check_formula(bnf(f_4), data), "bayesnecformula")

</code></pre>

<hr>
<h2 id='check_priors'>Plots the prior and posterior parameter probability densities from an
object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</h2><span id='topic+check_priors'></span>

<h3>Description</h3>

<p>Plots the prior and posterior parameter probability densities from an
object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_priors(object, filename = NA, ask = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_priors_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="check_priors_+3A_filename">filename</code></td>
<td>
<p>An optional <code><a href="base.html#topic+character">character</a></code> vector to be used
as a pdf filename in the case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>. Any non
empty character string will indicate the user wants to save the plots.</p>
</td></tr>
<tr><td><code id="check_priors_+3A_ask">ask</code></td>
<td>
<p>Should the user be asked to hit enter for next page? Defaults to
<code>TRUE</code>. Only relevant if <code>object</code> is of class
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the prior and posterior parameter probability densities.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
check_priors(manec_example)

## End(Not run)

</code></pre>

<hr>
<h2 id='compare_estimates'>compare_estimates</h2><span id='topic+compare_estimates'></span>

<h3>Description</h3>

<p>Extracts posterior predicted values from a list of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits and
compares these via bootstrap re sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_estimates(
  x,
  comparison = "n(s)ec",
  ecx_val = 10,
  type = "absolute",
  hormesis_def = "control",
  sig_val = 0.01,
  resolution = 100,
  x_range = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_estimates_+3A_x">x</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of objects of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_comparison">comparison</code></td>
<td>
<p>The posterior predictions to compare, takes values of
&quot;nec&quot;, &quot;n(s)ec&quot;, &quot;nsec&quot;, &quot;ecx&quot; or &quot;fitted&quot;.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_ecx_val">ecx_val</code></td>
<td>
<p>The desired percentage effect value. This must be a value
between 1 and 99 (for type = &quot;relative&quot; and &quot;absolute&quot;), defaults to 10.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_type">type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values of
&quot;relative&quot;, &quot;absolute&quot; (the default) or &quot;direct&quot;. See Details.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_hormesis_def">hormesis_def</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values
of &quot;max&quot; or &quot;control&quot;. See Details.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find ECx &ndash;
large values will make the ECx estimate more precise.</p>
</td></tr>
<tr><td><code id="compare_estimates_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting ECx.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code> containing bootstrapped differences
in posterior predictions of the <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits contained in <code>x</code>. See Details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
compare_estimates(list("nec" = ecx4param, "ecx" = nec4param), ecx_val = 50,
comparison="ecx")

## End(Not run)

</code></pre>

<hr>
<h2 id='compare_fitted'>compare_fitted</h2><span id='topic+compare_fitted'></span>

<h3>Description</h3>

<p>Extracts posterior predicted values from a list of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits and
compares these across a vector of fitted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_fitted(x, resolution = 50, x_range = NA, make_newdata = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_fitted_+3A_x">x</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of objects of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="compare_fitted_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find ECx &ndash;
large values will make the ECx estimate more precise.</p>
</td></tr>
<tr><td><code id="compare_fitted_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting ECx.</p>
</td></tr>
<tr><td><code id="compare_fitted_+3A_make_newdata">make_newdata</code></td>
<td>
<p>Should the
user allow the package to create <code>newdata</code> for predictions?
If so, arguments <code>resolution</code> and <code>x_range</code> will be used. Defaults
to TRUE. See details.</p>
</td></tr>
<tr><td><code id="compare_fitted_+3A_...">...</code></td>
<td>
<p>Further arguments that control posterior predictions via
<code><a href="brms.html#topic+posterior_epred">posterior_epred</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>make_newdata</code> is relevant to those who want the
package to create a data.frame from which to make predictions. This is done
via <code><a href="#topic+bnec_newdata">bnec_newdata</a></code> and uses arguments <code>resolution</code> and
<code>x_range</code>. If <code>make_newdata = FALSE</code> and no additional
<code>newdata</code> argument is provided (via <code>...</code>), then the predictions
are made for the raw data. Else, to generate predictions for a specific
user-specific data.frame, set <code>make_newdata = FALSE</code> and provide
an additional data.frame via the <code>newdata</code> argument. For guidance
on how to structure <code>newdata</code>, see for example
<code><a href="brms.html#topic+posterior_epred">posterior_epred</a></code>.
</p>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code> containing bootstrapped differences
in posterior predictions of the <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits contained in <code>x</code>. See Details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
compare_fitted(list("nec" = ecx4param, "ecx" = nec4param))

## End(Not run)

</code></pre>

<hr>
<h2 id='compare_posterior'>compare_posterior</h2><span id='topic+compare_posterior'></span>

<h3>Description</h3>

<p>Extracts posterior predicted values from a list of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model fits and
compares these via bootstrap re sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_posterior(
  x,
  comparison = "n(s)ec",
  ecx_val = 10,
  type = "absolute",
  hormesis_def = "control",
  sig_val = 0.01,
  resolution,
  x_range = NA,
  make_newdata = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_posterior_+3A_x">x</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of objects of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_comparison">comparison</code></td>
<td>
<p>The posterior predictions to compare, takes values of
&quot;nec&quot;, &quot;n(s)ec&quot;, &quot;nsec&quot;, &quot;ecx&quot; or &quot;fitted&quot;.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_ecx_val">ecx_val</code></td>
<td>
<p>The desired percentage effect value. This must be a value
between 1 and 99 (for type = &quot;relative&quot; and &quot;absolute&quot;), defaults to 10.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_type">type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values of
&quot;relative&quot;, &quot;absolute&quot; (the default) or &quot;direct&quot;. See Details.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_hormesis_def">hormesis_def</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values
of &quot;max&quot; or &quot;control&quot;. See Details.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find ECx &ndash;
large values will make the ECx estimate more precise.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting ECx.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_make_newdata">make_newdata</code></td>
<td>
<p>Only used if <code>comparison = "fitted"</code>. Should the
user allow the package to create <code>newdata</code> for predictions?
If so, arguments <code>resolution</code> and <code>x_range</code> will be used. Defaults
to TRUE. See details.</p>
</td></tr>
<tr><td><code id="compare_posterior_+3A_...">...</code></td>
<td>
<p>Further arguments that control posterior predictions via
<code><a href="brms.html#topic+posterior_epred">posterior_epred</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type</code> &quot;relative&quot; is calculated as the percentage decrease
from the maximum predicted value of the response (top) to the minimum
predicted value of the response. Type &quot;absolute&quot; (the default) is
calculated as the percentage decrease from the maximum value of the
response (top) to 0 (or bot for a 4 parameter model fit). Type &quot;direct&quot;
provides a direct estimate of the x value for a given y.
Note that for the current version, ECx for an &quot;nechorme&quot; (NEC Hormesis)
model is estimated at a percent decline from the control.
</p>
<p>For <code>hormesis_def</code>, if &quot;max&quot;, then ECx or NSEC values &ndash; i.e.,
depending on argument <code>comparison</code> &ndash; are calculated
as a decline from the maximum estimates (i.e. the peak at NEC);
if &quot;control&quot;, then ECx or NSEC values are calculated relative to the
control, which is assumed to be the lowest observed concentration.
</p>
<p>The argument <code>make_newdata</code> is only used if
<code>comparison = "fitted"</code>. It is relevant to those who want the package
to create a data.frame from which to make predictions. This is done via
<code><a href="#topic+bnec_newdata">bnec_newdata</a></code> and uses arguments <code>resolution</code> and
<code>x_range</code>. If <code>make_newdata = FALSE</code> and no additional
<code>newdata</code> argument is provided (via <code>...</code>), then the predictions
are made for the raw data. Else, to generate predictions for a specific
user-specific data.frame, set <code>make_newdata = FALSE</code> and provide
an additional data.frame via the <code>newdata</code> argument. For guidance
on how to structure <code>newdata</code>, see for example
<code><a href="brms.html#topic+posterior_epred">posterior_epred</a></code>.
</p>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code> containing bootstrapped differences
in posterior predictions of the <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> model fits contained in <code>x</code>. See Details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code> <code><a href="#topic+ecx">ecx</a></code> <code><a href="#topic+nsec">nsec</a></code>
<code><a href="#topic+nec">nec</a></code> <code><a href="#topic+bnec_newdata">bnec_newdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
ecx4param &lt;- pull_out(manec_example, model = "ecx4param")
compare_posterior(list("n(s)ec" = ecx4param, "ecx" = nec4param), ecx_val = 50)

## End(Not run)

</code></pre>

<hr>
<h2 id='dispersion'>Posterior dispersion</h2><span id='topic+dispersion'></span>

<h3>Description</h3>

<p>Calculates a posterior dispersion metric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dispersion(model, summary = FALSE, seed = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dispersion_+3A_model">model</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> whose distribution
family is either <code><a href="stats.html#topic+poisson">poisson</a></code> or
<code><a href="stats.html#topic+binomial">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_summary">summary</code></td>
<td>
<p>Logical. Should summary stats be returned instead of full
vector? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="dispersion_+3A_seed">seed</code></td>
<td>
<p>Change seed for reproducible purposes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates a dispersion metric which takes the ratio
between the observed relative to simulated Pearson residuals sums of
squares.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector. If <code>summary</code> is FALSE, an
n-long vector containing the dispersion metric, where n is the number of post
warm-up posterior draws from the <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> object. If
TRUE, then a <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the summary stats
(mean, median, 95% highest density intervals) of the dispersion metric.
</p>


<h3>References</h3>

<p>Zuur, A. F., Hilbe, J. M., &amp; Ieno, E. N. (2013). A Beginner's Guide to GLM
and GLMM with R: A Frequentist and Bayesian Perspective for Ecologists.
Highland Statistics Limited.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(nec_data)
nec_data$y &lt;- as.integer(round(nec_data$y * 100))
nec4param &lt;- bnec(y ~ crf(x, "nec4param"), data = nec_data, chains = 2)
dispersion(nec4param, summary = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='ecx'>Extracts the predicted ECx value</h2><span id='topic+ecx'></span>

<h3>Description</h3>

<p>Extracts the predicted ECx value as desired from an object of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecx(
  object,
  ecx_val = 10,
  resolution = 1000,
  posterior = FALSE,
  type = "absolute",
  hormesis_def = "control",
  x_range = NA,
  xform = identity,
  prob_vals = c(0.5, 0.025, 0.975)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecx_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="ecx_+3A_ecx_val">ecx_val</code></td>
<td>
<p>The desired percentage effect value. This must be a value
between 1 and 99 (for type = &quot;relative&quot; and &quot;absolute&quot;), defaults to 10.</p>
</td></tr>
<tr><td><code id="ecx_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find ECx &ndash;
large values will make the ECx estimate more precise.</p>
</td></tr>
<tr><td><code id="ecx_+3A_posterior">posterior</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the full
posterior sample of calculated ECx values should be returned instead of
just the median and 95 credible intervals.</p>
</td></tr>
<tr><td><code id="ecx_+3A_type">type</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values of
&quot;relative&quot;, &quot;absolute&quot; (the default) or &quot;direct&quot;. See Details.</p>
</td></tr>
<tr><td><code id="ecx_+3A_hormesis_def">hormesis_def</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values
of &quot;max&quot; or &quot;control&quot;. See Details.</p>
</td></tr>
<tr><td><code id="ecx_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting ECx.</p>
</td></tr>
<tr><td><code id="ecx_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="ecx_+3A_prob_vals">prob_vals</code></td>
<td>
<p>A vector indicating the probability values over which to
return the estimated ECx value. Defaults to 0.5 (median) and 0.025 and
0.975 (95 percent credible intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type</code> &quot;relative&quot; is calculated as the percentage decrease
from the maximum predicted value of the response (top) to the minimum
predicted value of the response. Type &quot;absolute&quot; (the default) is
calculated as the percentage decrease from the maximum value of the
response (top) to 0. Type &quot;direct&quot;
provides a direct estimate of the x value for a given y.
Note that for the current version, ECx for an &quot;nechorme&quot; (NEC Hormesis)
model is estimated at a percent decline from the control.
</p>
<p>For <code>hormesis_def</code>, if &quot;max&quot;, then ECx values are calculated as a
decline from the maximum estimates (i.e. the peak at NEC);
if &quot;control&quot;, then ECx values are calculated relative to the control, which
is assumed to be the lowest observed concentration.
</p>
<p>Calls to functions <code><a href="#topic+ecx">ecx</a></code> and <code><a href="#topic+nsec">nsec</a></code> and
<code><a href="#topic+compare_fitted">compare_fitted</a></code> do not require the same level of flexibility
in the context of allowing argument <code>newdata</code>
(from a <code><a href="brms.html#topic+posterior_predict">posterior_predict</a></code> perspective) to
be supplied manually, as this is and should be handled within the function
itself. The argument <code>resolution</code> controls how precisely the
<code><a href="#topic+ecx">ecx</a></code> or <code><a href="#topic+nsec">nsec</a></code> value is estimated, with
argument <code>x_range</code> allowing estimation beyond the existing range of
the observed data (otherwise the default range) which can be useful in a
small number of cases. There is also no reasonable case where estimating
these from the raw data would be of value, because both functions would
simply return one of the treatment concentrations, making NOEC a better
metric in that case.
</p>


<h3>Value</h3>

<p>A vector containing the estimated ECx value, including upper and
lower 95% credible interval bounds.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(brms)
library(bayesnec)
data(manec_example)
ecx(manec_example, ecx_val = 50)
ecx(manec_example)


</code></pre>

<hr>
<h2 id='expand_manec'>Extracts a range of statistics from a list of <code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code>
objects.</h2><span id='topic+expand_manec'></span>

<h3>Description</h3>

<p>Extracts a range of statistics from a list of <code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code>
objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_manec(
  object,
  formula,
  x_range = NA,
  resolution = 1000,
  sig_val = 0.01,
  loo_controls
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expand_manec_+3A_object">object</code></td>
<td>
<p>A <code><a href="base.html#topic+list">list</a></code> of objects of class
<code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code>.</p>
</td></tr>
<tr><td><code id="expand_manec_+3A_formula">formula</code></td>
<td>
<p>Either a <code><a href="base.html#topic+character">character</a></code> string defining an
R formula or an actual <code><a href="stats.html#topic+formula">formula</a></code> object. See
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and <code><a href="#topic+check_formula">check_formula</a></code>. It could also
be a <code><a href="base.html#topic+list">list</a></code> of formulas if multiple objects are passed to
<code>object</code>.</p>
</td></tr>
<tr><td><code id="expand_manec_+3A_x_range">x_range</code></td>
<td>
<p>A range of predictor values over which to consider extracting
ECx.</p>
</td></tr>
<tr><td><code id="expand_manec_+3A_resolution">resolution</code></td>
<td>
<p>The length of the predictor vector used for posterior
predictions, and over which to extract ECx values. Large values will be
slower but more precise.</p>
</td></tr>
<tr><td><code id="expand_manec_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values against the lowest observed
concentration (assumed to be the control), to estimate NEC as an
interpolated NOEC value from smooth ECx curves.</p>
</td></tr>
<tr><td><code id="expand_manec_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> of model statistical output derived from
the input model list.
</p>

<hr>
<h2 id='expand_nec'>Extracts a range of statistics from a <code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code> object.</h2><span id='topic+expand_nec'></span>

<h3>Description</h3>

<p>Extracts a range of statistics from a <code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_nec(
  object,
  formula,
  x_range = NA,
  resolution = 1000,
  sig_val = 0.01,
  loo_controls,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expand_nec_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+prebayesnecfit">prebayesnecfit</a></code>.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_formula">formula</code></td>
<td>
<p>Either a <code><a href="base.html#topic+character">character</a></code> string defining an
R formula or an actual <code><a href="stats.html#topic+formula">formula</a></code> object. See
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and <code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_x_range">x_range</code></td>
<td>
<p>A range of predictor values over which to consider extracting
ECx.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_resolution">resolution</code></td>
<td>
<p>The length of the predictor vector used for posterior
predictions, and over which to extract ECx values. Large values will be
slower but more precise.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values against the lowest observed
concentration (assumed to be the control), to estimate NEC as an
interpolated NOEC value from smooth ECx curves.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
<tr><td><code id="expand_nec_+3A_...">...</code></td>
<td>
<p>Further arguments to internal function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> of model statistical output derived from
the input model object.
</p>

<hr>
<h2 id='fitted'>Generates mean posterior linear predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+fitted'></span><span id='topic+fitted.bayesnecfit'></span><span id='topic+fitted.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates mean posterior linear predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code>. <code>object</code> should be of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
fitted(object, ...)

## S3 method for class 'bayesmanecfit'
fitted(object, summary = TRUE, robust = FALSE, probs = c(0.025, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="brms.html#topic+fitted.brmsfit">fitted.brmsfit</a></code> if
object is of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>, or to
<code><a href="brms.html#topic+posterior_epred.brmsfit">posterior_epred.brmsfit</a></code> if object is of class
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_summary">summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_robust">robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_probs">probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code>
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code>?brms:fitted.brmsfit</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
# Uses default `resolution` and `x_range` to generate `newdata` internally
fitted(manec_example)
# Provide user-specified `newdata`
nd_ &lt;- data.frame(x = seq(0, 3, length.out = 200))
fits &lt;- fitted(manec_example, ecx_val = 50, newdata = nd_,
               make_newdata = FALSE)
nrow(fits) == 200
# Predictions for raw input data
nec4param &lt;- pull_out(manec_example, model = "nec4param")
fits &lt;- fitted(nec4param, make_newdata = FALSE)
x &lt;- pull_brmsfit(nec4param)$data$x
plot(x, fits[, 1])

## End(Not run)
</code></pre>

<hr>
<h2 id='formula'>Retrieve formulas from models fitted by <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+formula'></span><span id='topic+formula.bayesnecfit'></span><span id='topic+formula.bayesmanecfit'></span>

<h3>Description</h3>

<p>Retrieve formulas from models fitted by <code><a href="#topic+bnec">bnec</a></code>.
<code>x</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
formula(x, ...)

## S3 method for class 'bayesmanecfit'
formula(x, model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formula_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="formula_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="formula_+3A_model">model</code></td>
<td>
<p>A valid model string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
formula(manec_example, model = "nec4param")
nec4param &lt;- pull_out(manec_example, "nec4param")
formula(nec4param)

</code></pre>

<hr>
<h2 id='ggbnec_data'>Creates the data.frame for plotting with <code><a href="#topic+autoplot">autoplot</a></code>.</h2><span id='topic+ggbnec_data'></span>

<h3>Description</h3>

<p>Creates the data.frame for plotting with <code><a href="#topic+autoplot">autoplot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggbnec_data(x, add_nec = TRUE, add_ecx = FALSE, xform = identity, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggbnec_data_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>, as returned by function <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="ggbnec_data_+3A_add_nec">add_nec</code></td>
<td>
<p>Should NEC values be added to the plot? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ggbnec_data_+3A_add_ecx">add_ecx</code></td>
<td>
<p>Should ECx values be added to the plot? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ggbnec_data_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="ggbnec_data_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="#topic+ecx">ecx</a></code>. By
default, function <code><a href="#topic+ecx">ecx</a></code> returns EC10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
options(mc.cores = 2)
data(manec_example)

ggbnec_data(manec_example)
ggbnec_data(manec_example, add_ecx = TRUE, ecx_val = 50)


</code></pre>

<hr>
<h2 id='herbicide'>Herbicide phytotoxicity data</h2><span id='topic+herbicide'></span>

<h3>Description</h3>

<p>Herbicide phytotoxicity dataset from Jones &amp; Kerswell (2003).
</p>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 580 rows and 3 columns.
</p>


<h3>Details</h3>

<p>The response data (Fv/Fm) Chlorophyll fluorescence measurements of symbiotic
dinoflagellates still in the host tissue of the coral
(in hospite or in vivo) were measured using a DIVING-PAM chlorophyll
fluorometer (Walz) on vertical planes of tissue 2 to 3 cm above the base of
the corals, using either a 6 mm (Acropora formosa) or 2 mm
(Seriatopora hystrix) fibre-optic probe. Parameters measured were the
maximum potential quantum yield (Fv/Fm).
</p>
<p>Additional information on each of the herbicides included is available from
the original publication Jones &amp; Kerswell (2003).
</p>
<p>The columns are as follows:
</p>

<dl>
<dt>herbicide</dt><dd><p>The herbicide (chr).</p>
</dd>
<dt>concentration</dt><dd><p>The treatment concentration in µg / L (dbl).</p>
</dd>
<dt>fvfm</dt><dd><p>Maximum effective quantum yield (dbl).</p>
</dd>
</dl>



<h3>References</h3>

<p>Jones RJ, Kerswell AP (2003) Phytotoxicity of Photosystem II (PSII)
herbicides to coral. Marine Ecology Progress Series, 261: 149-159.
doi: 10.3354/meps261149.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(herbicide)

</code></pre>

<hr>
<h2 id='is_manecsummary'>Checks if argument is a <code>manecsummary</code> object</h2><span id='topic+is_manecsummary'></span>

<h3>Description</h3>

<p>Checks if argument is a <code>manecsummary</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_manecsummary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_manecsummary_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+logical">logical</a></code>
</p>

<hr>
<h2 id='is_necsummary'>Checks if argument is a <code>necsummary</code> object</h2><span id='topic+is_necsummary'></span>

<h3>Description</h3>

<p>Checks if argument is a <code>necsummary</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_necsummary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_necsummary_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object</p>
</td></tr>
</table>

<hr>
<h2 id='make_brmsformula'>Expose the final <code><a href="brms.html#topic+brmsformula">brmsformula</a></code></h2><span id='topic+make_brmsformula'></span>

<h3>Description</h3>

<p>Checks the input formula according to
<code><a href="#topic+bayesnec-package">bayesnec</a></code> requirements and
expose the final <code><a href="brms.html#topic+brmsformula">brmsformula</a></code> which is to be fitted via
package <span class="pkg">brms</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_brmsformula(formula, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_brmsformula_+3A_formula">formula</code></td>
<td>
<p>Either a <code><a href="base.html#topic+character">character</a></code> string defining an
R formula or an actual <code><a href="stats.html#topic+formula">formula</a></code> object. See details.</p>
</td></tr>
<tr><td><code id="make_brmsformula_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables
specified in <code>formula</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code><a href="base.html#topic+list">list</a></code>, with each element containing the
final <code><a href="brms.html#topic+brmsformula">brmsformula</a></code> to be passed to
<code><a href="brms.html#topic+brm">brm</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnecformula">bayesnecformula</a></code>,
<code><a href="#topic+check_formula">check_formula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
nec3param &lt;- function(beta, nec, top, x) {
  top * exp(-exp(beta) * (x - nec) *
    ifelse(x - nec &lt; 0, 0, 1))
}

data &lt;- data.frame(x = seq(1, 20, length.out = 10), tr = 100, wght = c(1, 2),
                   group_1 = sample(c("a", "b"), 10, replace = TRUE),
                   group_2 = sample(c("c", "d"), 10, replace = TRUE))
data$y &lt;- nec3param(beta = -0.2, nec = 4, top = 100, data$x)

# make one single model
f_1 &lt;- "y | trials(tr) ~ crf(sqrt(x), \"nec3param\")"
make_brmsformula(f_1, data)
# make an entire class of models
f_2 &lt;- y ~ crf(x, "ecx") + ogl(group_1) + pgl(group_2)
make_brmsformula(f_2, data)

</code></pre>

<hr>
<h2 id='manec_example'>Example bayesmanecfit object</h2><span id='topic+manec_example'></span>

<h3>Description</h3>

<p>Example bayesmanecfit object
</p>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>. This was created
to reduce run time in examples and tests, and to give the user an example
to toy with. This was fitted to <code><a href="#topic+bayesnec">bayesnec</a></code> built-in mock dataset
(see ?<code><a href="#topic+nec_data">nec_data</a></code>), using models &quot;nec4param&quot; and &quot;ecx4param&quot;.
The number of chains were set to 2 and number of iterations were 50 only
to make sure that package size was below 5 Mb. See help files for function
<code><a href="#topic+bnec">bnec</a></code> and class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> for details.
</p>


<h3>Source</h3>

<p>Code used to generate these models can be downloaded from <a href="https://github.com/open-AIMS/bayesnec/blob/master/data-raw/manec_example.R">https://github.com/open-AIMS/bayesnec/blob/master/data-raw/manec_example.R</a>
</p>

<hr>
<h2 id='manecsummary-class'>Class <code>manecsummary</code> of models fitted with the <span class="pkg">brms</span> package</h2><span id='topic+manecsummary-class'></span><span id='topic+manecsummary'></span>

<h3>Description</h3>

<p>Multiple models fitted with the
<code><a href="#topic+bayesnec-package">bayesnec</a></code> package are summarised
as a <code>manecsummary</code> object, which contains the name of the
non-linear models fitted, the family distribution used
to fit all the models, the total post-warm-up sample size, a table
containing the model weights, the method to calculate the weights,
whether this model is an ECx-type model
(see details below), and the ECx summary values should the user decide
to calculate them.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "manecsummary")</code> for an overview of available
methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>models</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string indicating the name of
the fitted non-linear models.</p>
</dd>
<dt><code>family</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> indicating the
family distribution and link function used to fit all the models.</p>
</dd>
<dt><code>sample_size</code></dt><dd><p>The total post-warm-up sample size.</p>
</dd>
<dt><code>mod_weights</code></dt><dd><p>A table containing the model weights.</p>
</dd>
<dt><code>mod_weights_method</code></dt><dd><p>The method to calculate the weights.</p>
</dd>
<dt><code>ecx_mods</code></dt><dd><p>A <code><a href="base.html#topic+logical">logical</a></code> indicating which <code>models</code>
are ECx-type models.</p>
</dd>
<dt><code>nec_vals</code></dt><dd><p>The model-averaged NEC values. Note that if model stack
contains ECx-type models, these will be via NSEC proxies.</p>
</dd>
<dt><code>ecs</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing the ECx values
should the user decide to calculate them (see the non-exported
<code>bayesnec:::summary.bayesnecfit</code> help file for details). Different
from the single-model case of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>, these ECx
estimates will be based on the model weights.</p>
</dd>
<dt><code>bayesr2</code></dt><dd><p>A table containing the Bayesian R2 for all models, as
calculated by <code><a href="brms.html#topic+bayes_R2">bayes_R2</a></code>.</p>
</dd>
<dt><code>rhat_issues</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> detailing whether each fitted
model exhibited convergence issues based on the Rhat evaluation.</p>
</dd>
</dl>


<h3>References</h3>

<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>,
<code><a href="#topic+necsummary">necsummary</a></code>
</p>

<hr>
<h2 id='model.frame'>Model.frame methods in bayesnec.</h2><span id='topic+model.frame'></span><span id='topic+model.frame.bayesnecfit'></span><span id='topic+model.frame.bayesmanecfit'></span><span id='topic+model.frame.bayesnecformula'></span>

<h3>Description</h3>

<p>Retrieve data.frame used to fit models via <code><a href="#topic+bnec">bnec</a></code>, or directly
from a <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.
<code>formula</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> or <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
model.frame(formula, ...)

## S3 method for class 'bayesmanecfit'
model.frame(formula, model, ...)

## S3 method for class 'bayesnecformula'
model.frame(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.frame_+3A_formula">formula</code></td>
<td>
<p>An model object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>, or a formula of class
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.</p>
</td></tr>
<tr><td><code id="model.frame_+3A_...">...</code></td>
<td>
<p>Unused if <code>formula</code> is a <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or a
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>. Else, if <code>formula</code> is a
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>, additional arguments to be passed to
<code><a href="#topic+check_formula">check_formula</a></code>.</p>
</td></tr>
<tr><td><code id="model.frame_+3A_model">model</code></td>
<td>
<p>A valid model string.</p>
</td></tr>
<tr><td><code id="model.frame_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables
specified in <code>formula</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>formula</code> is a <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and it
contains transformations to variables x and y, these are evaluated and
returned as part of the <code><a href="base.html#topic+data.frame">data.frame</a></code>.
</p>


<h3>Value</h3>

<p>If <code>formula</code> is a <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or a
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>, a <code><a href="base.html#topic+data.frame">data.frame</a></code> containing
the data used to fit the model.
</p>
<p>If, instead, <code>formula</code> is a <code><a href="#topic+bayesnecformula">bayesnecformula</a></code>,
a <code><a href="base.html#topic+data.frame">data.frame</a></code> with additional attributes
detailing the population-level variables (attribute <code>"bnec_pop"</code>)
(response y, predictor x, and, if binomial a formula, trials) and, if
applicable, the group-level variables (attribute <code>"bnec_group"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
# if input is of class `bayesnecfit` or `bayesmanecfit`
model.frame(manec_example, model = "nec4param")
nec4param &lt;- pull_out(manec_example, "nec4param")
model.frame(nec4param)
# if input is of class `bayesnecformula`
nec3param &lt;- function(beta, nec, top, x) {
  top * exp(-exp(beta) * (x - nec) *
    ifelse(x - nec &lt; 0, 0, 1))
}

data &lt;- data.frame(x = seq(1, 20, length.out = 10), tr = 100, wght = c(1, 2),
                   group_1 = sample(c("a", "b"), 10, replace = TRUE),
                   group_2 = sample(c("c", "d"), 10, replace = TRUE))
data$y &lt;- nec3param(beta = -0.2, nec = 4, top = 100, data$x)

f_1 &lt;- y ~ crf(x, "nec3param")
f_2 &lt;- "y | trials(tr) ~ crf(sqrt(x), \"nec3param\")"
f_3 &lt;- y | trials(tr) ~ crf(x, "nec3param") + ogl(group_1) + pgl(group_2)
f_4 &lt;- y | trials(tr) ~ crf(x, "nec3param") + (nec + top | group_1)

m_1 &lt;- model.frame(bnf(f_1), data)
attr(m_1, "bnec_pop")
model.frame(bnf(f_2), data)
m_3 &lt;- model.frame(bnf(f_3), data)
attr(m_3, "bnec_group")
model.frame(bnf(f_4), data)

</code></pre>

<hr>
<h2 id='models'>models</h2><span id='topic+models'></span>

<h3>Description</h3>

<p>Lists the fitted or available models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>models(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="models_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> as returned by <code><a href="#topic+bnec">bnec</a></code>,
a <code><a href="base.html#topic+character">character</a></code> vector indicating the type of model set for
which to list the available models, or a <code><a href="base.html#topic+numeric">numeric</a></code> vector
indicating the natural range of values which the models should be able to
handle (see Details). If missing, all available models and their groups are
listed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available models are &quot;nec3param&quot;, &quot;nec4param&quot;, &quot;nechorme&quot;,
&quot;nechorme4&quot;, &quot;necsigm&quot;, &quot;neclin&quot;, &quot;neclinhorme&quot;, &quot;nechormepwr&quot;,
&quot;nechorme4pwr&quot;, &quot;nechormepwr01&quot;, &quot;ecxlin&quot;, &quot;ecxexp&quot;, &quot;ecxsigm&quot;, &quot;ecx4param&quot;,
&quot;ecxwb1&quot;, &quot;ecxwb2&quot;, &quot;ecxwb1p3&quot;, &quot;ecxwb2p3&quot;, &quot;ecxll5&quot;, &quot;ecxll4&quot;, &quot;ecxll3&quot;,
&quot;ecxhormebc4&quot;, and &quot;ecxhormebc5&quot;.
</p>
<p>To see the model formula and parameters for a specific model use the
function <code><a href="#topic+show_params">show_params</a></code>.
</p>
<p>To see all the models in an available set (e.g. &quot;all&quot;, &quot;nec&quot; or ecx&quot;) use
the function <code><a href="#topic+models">models</a></code> specifying the group name.
</p>
<p>To see the model names, model formula and parameters fitted in an existing
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> model object use
the function <code><a href="#topic+models">models</a></code> specifying the fitted object.
</p>
<p>To see what models are available for a given type of data use the function
<code><a href="#topic+models">models</a></code> passing a <code><a href="base.html#topic+numeric">numeric</a></code> vector indicating
the range of possible data types. Models that have an exponential decay
(most models with parameter &quot;beta&quot;) with no &quot;bot&quot; parameter are zero-bounded
and are not suitable for the Gaussian family, or any family modelled using a
logit or log link function. Models with a linear decay
(containing the string &quot;lin&quot; in their name) are not suitable for modelling
families that are zero bounded (Gamma, Poisson, Negative binomial) using an
identity link. Models with a linear decay or hormesis linear increase
(all models with parameter &quot;slope&quot;) are not suitable for modelling families
that are 0, 1 bounded (binomial, beta, beta_binomial). These restrictions do
not need to be controlled by the user and a call to <code><a href="#topic+bnec">bnec</a></code> with
<code>models = "all"</code> will simply exclude inappropriate models.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> of the available or fitted models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
# default to all models and model groups
models()
# single model
show_params("nec3param")
# group of models
models("all")
# models that are suitable for 0,1 bounded data
models(c(0,1))

</code></pre>

<hr>
<h2 id='nec'>Extracts the predicted NEC value as desired from an object of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</h2><span id='topic+nec'></span>

<h3>Description</h3>

<p>Extracts the predicted NEC value as desired from an object of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nec(
  object,
  posterior = FALSE,
  xform = identity,
  prob_vals = c(0.5, 0.025, 0.975)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nec_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="nec_+3A_posterior">posterior</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the full
posterior sample of calculated NEC values should be returned instead of
just the median and 95% credible intervals.</p>
</td></tr>
<tr><td><code id="nec_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="nec_+3A_prob_vals">prob_vals</code></td>
<td>
<p>A vector indicating the probability values over which to
return the estimated NEC value. Defaults to 0.5 (median) and 0.025 and
0.975 (95 percent credible intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NEC is a parameter in a threshold model (for example,
see Fox 2010), and is a true measure
of No-effect-concentration (the minimum concentration above which an effect
is predicted to occur.
</p>


<h3>Value</h3>

<p>A vector containing the estimated NEC value, including upper and
lower 95% credible interval bounds (or other interval as specified by
prob_vals).
</p>


<h3>References</h3>

<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
data(manec_example)
nec(manec_example)

</code></pre>

<hr>
<h2 id='nec_data'>Example data of non-linear decay</h2><span id='topic+nec_data'></span>

<h3>Description</h3>

<p>A simulated dataset containing a series of response
measurements as a function of a concentration axis.
Data simulated by Diego Barneche.
</p>


<h3>Format</h3>

<p>A data frame with 100 rows and 2 variables:
</p>

<ul>
<li><p> x: Concentration (predictor) axis.
</p>
</li>
<li><p> y: Response.
</p>
</li></ul>


<hr>
<h2 id='necsummary-class'>Class <code>necsummary</code> of models fitted with the <span class="pkg">brms</span> package</h2><span id='topic+necsummary-class'></span><span id='topic+necsummary'></span>

<h3>Description</h3>

<p>Single models fitted with the
<code><a href="#topic+bayesnec-package">bayesnec</a></code> package are summarised
as a <code>necsummary</code> object, which contains the original
<code><a href="brms.html#topic+brmsfit">brmsfit</a></code> object summary, the name of the
non-linear model fitted, whether this model is an ECx-type model
(see details below), and the ECx summary values should the user decide
to calculate them.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "necsummary")</code> for an overview of available
methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>brmssummary</code></dt><dd><p>The standard summary for the fitted Bayesian model of
class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code>.</p>
</dd>
<dt><code>model</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string indicating the name of
the fitted non-linear model.</p>
</dd>
<dt><code>is_ecx</code></dt><dd><p>A <code><a href="base.html#topic+logical">logical</a></code> indicating whether <code>model</code>
is an ECx-type model.</p>
</dd>
<dt><code>nec_vals</code></dt><dd><p>The NEC values. Note that if model is an ECx-type model,
this estimate will be a NSEC proxy.</p>
</dd>
<dt><code>ecs</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing the ECx values
should the user decide to calculate them (see the non-exported
<code>bayesnec:::summary.bayesnecfit</code> help file for details).</p>
</dd>
<dt><code>bayesr2</code></dt><dd><p>The model Bayesian R2 as calculated by
<code><a href="brms.html#topic+bayes_R2">bayes_R2</a></code>.</p>
</dd>
</dl>


<h3>References</h3>

<p>Fisher R, Barneche DR, Ricardo GF, Fox, DR (2024) An R Package for
Concentration-Response Modeling and Estimation of Toxicity Metrics
doi:10.18637/jss.v110.i05.
</p>
<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>,
<code><a href="#topic+manecsummary">manecsummary</a></code>
</p>

<hr>
<h2 id='nsec'>Extracts the predicted NSEC value as desired from an
object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</h2><span id='topic+nsec'></span>

<h3>Description</h3>

<p>Extracts the predicted NSEC value as desired from an
object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsec(
  object,
  sig_val = 0.01,
  resolution = 1000,
  x_range = NA,
  hormesis_def = "control",
  xform = identity,
  prob_vals = c(0.5, 0.025, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nsec_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="nsec_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values.</p>
</td></tr>
<tr><td><code id="nsec_+3A_resolution">resolution</code></td>
<td>
<p>The number of unique x values over which to find NSEC -
large values will make the NSEC estimate more precise.</p>
</td></tr>
<tr><td><code id="nsec_+3A_x_range">x_range</code></td>
<td>
<p>A range of x values over which to consider extracting NSEC.</p>
</td></tr>
<tr><td><code id="nsec_+3A_hormesis_def">hormesis_def</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector, taking values
of &quot;max&quot; or &quot;control&quot;. See Details.</p>
</td></tr>
<tr><td><code id="nsec_+3A_xform">xform</code></td>
<td>
<p>A function to apply to the returned estimated concentration
values.</p>
</td></tr>
<tr><td><code id="nsec_+3A_prob_vals">prob_vals</code></td>
<td>
<p>A vector indicating the probability values over which to
return the estimated NSEC value. Defaults to 0.5 (median) and 0.025 and
0.975 (95 percent credible intervals).</p>
</td></tr>
<tr><td><code id="nsec_+3A_...">...</code></td>
<td>
<p>Further arguments to pass to class specific methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NSEC is no-effect toxicity metric that estimates the concentration
at which the modeled mean response is statistically indistinguishable from
the mean control response. See the detailed derivation in
Fisher and Fox (2023).
</p>
<p>For <code>hormesis_def</code>, if &quot;max&quot;, then NSEC values are calculated
as a decline from the maximum estimates (i.e. the peak at NEC);
if &quot;control&quot;, then NSEC values are calculated relative to the control, which
is assumed to be the lowest observed concentration.
</p>
<p>Calls to functions <code><a href="#topic+ecx">ecx</a></code> and <code><a href="#topic+nsec">nsec</a></code> and
<code><a href="#topic+compare_fitted">compare_fitted</a></code> do not require the same level of flexibility
in the context of allowing argument <code>newdata</code>
(from a <code><a href="brms.html#topic+posterior_predict">posterior_predict</a></code> perspective) to
be supplied manually, as this is and should be handled within the function
itself. The argument <code>resolution</code> controls how precisely the
<code><a href="#topic+ecx">ecx</a></code> or <code><a href="#topic+nsec">nsec</a></code> value is estimated, with
argument <code>x_range</code> allowing estimation beyond the existing range of
the observed data (otherwise the default range) which can be useful in a
small number of cases. There is also no reasonable case where estimating
these from the raw data would be of value, because both functions would
simply return one of the treatment concentrations, making NOEC a better
metric in that case.
</p>


<h3>Value</h3>

<p>A vector containing the estimated NSEC value, including upper and
lower 95% credible interval bounds.
</p>


<h3>References</h3>

<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)

data(manec_example)
nsec(manec_example)


</code></pre>

<hr>
<h2 id='plot'>Generates a plot for objects fitted by <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+plot'></span><span id='topic+plot.bayesnecfit'></span><span id='topic+plot.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates a plot for objects fitted by <code><a href="#topic+bnec">bnec</a></code>.
<code>x</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
plot(
  x,
  ...,
  CI = TRUE,
  add_nec = TRUE,
  position_legend = "topright",
  add_ec10 = FALSE,
  xform = identity,
  lxform = identity,
  jitter_x = FALSE,
  jitter_y = FALSE,
  ylab = "Response",
  xlab = "Predictor",
  xticks = NA
)

## S3 method for class 'bayesmanecfit'
plot(
  x,
  ...,
  CI = TRUE,
  add_nec = TRUE,
  position_legend = "topright",
  add_ec10 = FALSE,
  xform = identity,
  lxform = identity,
  jitter_x = FALSE,
  jitter_y = FALSE,
  ylab = "Response",
  xlab = "Predictor",
  xticks = NA,
  all_models = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_ci">CI</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if credibility
intervals on the model fit should be plotted, calculated as the upper and
lower bounds of the individual predicted values from all posterior samples.</p>
</td></tr>
<tr><td><code id="plot_+3A_add_nec">add_nec</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the
estimated NEC value and 95% credible intervals should be added to the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_position_legend">position_legend</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector indicating the
location of the NEC or EC10 legend, as per a call to legend.</p>
</td></tr>
<tr><td><code id="plot_+3A_add_ec10">add_ec10</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if an
estimated EC10 value and 95% credible intervals should be added to the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_xform">xform</code></td>
<td>
<p>A function to be applied as a transformation of the x data.</p>
</td></tr>
<tr><td><code id="plot_+3A_lxform">lxform</code></td>
<td>
<p>A function to be applied as a transformation only to axis
labels and the annotated NEC / EC10 values.</p>
</td></tr>
<tr><td><code id="plot_+3A_jitter_x">jitter_x</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the x
data points on the plot should be jittered.</p>
</td></tr>
<tr><td><code id="plot_+3A_jitter_y">jitter_y</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if the y
data points on the plot should be jittered.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylab">ylab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector to use for the y-axis
label.</p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> vector to use for the x-axis
label.</p>
</td></tr>
<tr><td><code id="plot_+3A_xticks">xticks</code></td>
<td>
<p>A numeric vector indicate where to place the tick marks of
the x-axis.</p>
</td></tr>
<tr><td><code id="plot_+3A_all_models">all_models</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code> value indicating if all
models in the model set should be plotted simultaneously, or if a model
average plot should be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="graphics.html#topic+plot">plot</a></code> of the fitted model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
nec4param &lt;- pull_out(manec_example, "nec4param")
# plot single models (bayesnecfit)
plot(nec4param)
plot(nec4param, add_nec = FALSE)
plot(nec4param, add_ec10 = TRUE)

# plot model averaged predictions (bayesmanecfit)
plot(manec_example)
# plot all panels together
plot(manec_example, add_ec10 = TRUE, all_models = TRUE)

</code></pre>

<hr>
<h2 id='posterior_epred'>Generates posterior linear predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+posterior_epred'></span><span id='topic+posterior_epred.bayesnecfit'></span><span id='topic+posterior_epred.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates posterior linear predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code>. <code>object</code> should be of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
posterior_epred(object, ...)

## S3 method for class 'bayesmanecfit'
posterior_epred(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_epred_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_epred_+3A_...">...</code></td>
<td>
<p>Additional arguments to
<code><a href="brms.html#topic+posterior_epred">posterior_epred</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code>?brms:posterior_epred</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
# Uses default `resolution` and `x_range` to generate `newdata` internally
posterior_epred(manec_example)
# Provide user-specified `newdata`
nd_ &lt;- data.frame(x = seq(0, 3, length.out = 200))
ppreds &lt;- posterior_epred(manec_example, ecx_val = 50, newdata = nd_,
                            make_newdata = FALSE)
ncol(ppreds) == 200 # cols are x, rows are iterations
# Predictions for raw input data
nec4param &lt;- pull_out(manec_example, model = "nec4param")
preds &lt;- posterior_epred(nec4param, make_newdata = FALSE)
x &lt;- pull_brmsfit(nec4param)$data$x
plot(sort(x), preds[1, order(x)], type = "l", col = alpha("black", 0.1),
     ylim = c(-6, 3))
for (i in seq_len(nrow(preds))[-1]) {
  lines(sort(x), preds[i, order(x)], type = "l", col = alpha("black", 0.1))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='posterior_predict'>Generates posterior predictions for objects fitted by <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+posterior_predict'></span><span id='topic+posterior_predict.bayesnecfit'></span><span id='topic+posterior_predict.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates posterior predictions for objects fitted by <code><a href="#topic+bnec">bnec</a></code>.
<code>object</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
posterior_predict(object, ...)

## S3 method for class 'bayesmanecfit'
posterior_predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_predict_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_...">...</code></td>
<td>
<p>Additional arguments to
<code><a href="brms.html#topic+posterior_predict">posterior_predict</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code>?brms::posterior_predict</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
# Uses default `resolution` and `x_range` to generate `newdata` internally
posterior_predict(manec_example)
# Provide user-specified `newdata`
nd_ &lt;- data.frame(x = seq(0, 3, length.out = 200))
ppreds &lt;- posterior_predict(manec_example, ecx_val = 50, newdata = nd_,
                            make_newdata = FALSE)
ncol(ppreds) == 200 # cols are x, rows are iterations
# Posterior predictions for raw input data
nec4param &lt;- pull_out(manec_example, model = "nec4param")
preds &lt;- posterior_predict(nec4param, make_newdata = FALSE)
x &lt;- pull_brmsfit(nec4param)$data$x
plot(sort(x), preds[1, order(x)], type = "l", col = alpha("black", 0.1),
     ylim = c(-8, 5))
for (i in seq_len(nrow(preds))[-1]) {
  lines(sort(x), preds[i, order(x)], type = "l", col = alpha("black", 0.1))
}

## End(Not run)
</code></pre>

<hr>
<h2 id='prebayesnecfit-class'>Class <code>prebayesnecfit</code> of models fitted with the <span class="pkg">brms</span> package</h2><span id='topic+prebayesnecfit-class'></span><span id='topic+prebayesnecfit'></span>

<h3>Description</h3>

<p>This is an intermediate class that was created to make both
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> and <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> objects lighter
to handle. It contains the original <code><a href="brms.html#topic+brmsfit">brmsfit</a></code>
fitted object, name of non-linear model that was fitted, the list of
initialisation values applied, and the validated
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>.
</p>


<h3>Details</h3>

<p>See <code>methods(class = "prebayesnecfit")</code> for an overview of
available methods.
</p>


<h3>Slots</h3>


<dl>
<dt><code>fit</code></dt><dd><p>The fitted Bayesian model of class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code>.</p>
</dd>
<dt><code>model</code></dt><dd><p>A <code><a href="base.html#topic+character">character</a></code> string indicating the name of
the fitted model.</p>
</dd>
<dt><code>init</code></dt><dd><p>A <code><a href="base.html#topic+list">list</a></code> containing the initialisation values
for to fit the model.</p>
</dd>
<dt><code>bayesnecformula</code></dt><dd><p>An object of class <code><a href="#topic+bayesnecformula">bayesnecformula</a></code> and
<code><a href="stats.html#topic+formula">formula</a></code>.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+bayesnec">bayesnec</a></code>,
<code><a href="#topic+bnec">bnec</a></code>,
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code>,
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>,
<code><a href="#topic+bayesnecformula">bayesnecformula</a></code>
</p>

<hr>
<h2 id='predict'>Generates mean posterior predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+predict'></span><span id='topic+predict.bayesnecfit'></span><span id='topic+predict.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates mean posterior predictions for objects fitted by
<code><a href="#topic+bnec">bnec</a></code>. <code>object</code> should be of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
predict(object, ...)

## S3 method for class 'bayesmanecfit'
predict(object, summary = TRUE, robust = FALSE, probs = c(0.025, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="brms.html#topic+predict.brmsfit">predict.brmsfit</a></code> if
object is of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>, or to
<code><a href="brms.html#topic+posterior_predict.brmsfit">posterior_predict.brmsfit</a></code> if object is of class
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_summary">summary</code></td>
<td>
<p>Should summary statistics be returned
instead of the raw values? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_robust">robust</code></td>
<td>
<p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.
Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_probs">probs</code></td>
<td>
<p>The percentiles to be computed by the <code>quantile</code>
function. Only used if <code>summary</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code>?brms::predict.brmsfit</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
# Uses default `resolution` and `x_range` to generate `newdata` internally
predict(manec_example)
# Provide user-specified `newdata`
nd_ &lt;- data.frame(x = seq(0, 3, length.out = 200))
predict(manec_example, ecx_val = 50, newdata = nd_, make_newdata = FALSE)
# Predictions for raw input data
nec4param &lt;- pull_out(manec_example, model = "nec4param")
preds &lt;- predict(nec4param, make_newdata = FALSE)
x &lt;- pull_brmsfit(nec4param)$data$x
plot(x, preds[, 1])

## End(Not run)
</code></pre>

<hr>
<h2 id='print'>Prints a summary for objects fitted by <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+print'></span><span id='topic+print.bayesnecfit'></span><span id='topic+print.bayesmanecfit'></span>

<h3>Description</h3>

<p>Prints a summary for objects fitted by <code><a href="#topic+bnec">bnec</a></code>.
<code>x</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
print(x, ...)

## S3 method for class 'bayesmanecfit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary print of the fitted model as returned for a
<code><a href="brms.html#topic+brmsfit">brmsfit</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
print(manec_example)
nec4param &lt;- pull_out(manec_example, "nec4param")
print(nec4param)

</code></pre>

<hr>
<h2 id='pull_brmsfit.bayesnecfit'>Extract and object of class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> from
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</h2><span id='topic+pull_brmsfit.bayesnecfit'></span><span id='topic+pull_brmsfit.bayesmanecfit'></span><span id='topic+pull_brmsfit'></span>

<h3>Description</h3>

<p>Extract and object of class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> from
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
pull_brmsfit(object, ...)

## S3 method for class 'bayesmanecfit'
pull_brmsfit(object, model = NA, ...)

pull_brmsfit(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pull_brmsfit.bayesnecfit_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="pull_brmsfit.bayesnecfit_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="pull_brmsfit.bayesnecfit_+3A_model">model</code></td>
<td>
<p>An optional <code><a href="base.html#topic+character">character</a></code> vector specifying
the model to extract.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="brms.html#topic+brmsfit">brmsfit</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
data(manec_example)
brms_fit &lt;- pull_brmsfit(manec_example, model = "nec4param")

</code></pre>

<hr>
<h2 id='pull_out'>pull_out</h2><span id='topic+pull_out'></span>

<h3>Description</h3>

<p>Subsets model(s) from an existing object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pull_out(manec, model, loo_controls, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pull_out_+3A_manec">manec</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> as returned by
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="pull_out_+3A_model">model</code></td>
<td>
<p>A <code><a href="base.html#topic+character">character</a></code> string indicating
which model or suite of models to pull out.</p>
</td></tr>
<tr><td><code id="pull_out_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
<tr><td><code id="pull_out_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="#topic+expand_nec">expand_nec</a></code> or
<code><a href="#topic+expand_manec">expand_manec</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>model</code> is a string representing a single model, an object
of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>; If <code>model</code> is instead a string
depicting a suite of models, and object of class <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>, <code><a href="#topic+models">models</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
# use "ecx" to get all ECx-containing models
# (only one ["ecx4param"] in this minimal example)
ecx_models &lt;- pull_out(manec_example, model = "ecx")

## End(Not run)

</code></pre>

<hr>
<h2 id='pull_prior'>pull_prior</h2><span id='topic+pull_prior'></span>

<h3>Description</h3>

<p>Extracts the priors from an object of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pull_prior(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pull_prior_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>
or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> returned by <code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> containing the priors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
data(manec_example)
pull_prior(manec_example)

</code></pre>

<hr>
<h2 id='rhat'>Extract Diagnostic Quantities of 'brms' Models</h2><span id='topic+rhat'></span><span id='topic+rhat.bayesnecfit'></span><span id='topic+rhat.bayesmanecfit'></span>

<h3>Description</h3>

<p>Extract Rhat statistic that can be used to diagnose sampling behaviour
of the algorithms applied by 'Stan' at the back-end of 'brms'.
<code>x</code> should be of class
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
rhat(x, rhat_cutoff = 1.05, ...)

## S3 method for class 'bayesmanecfit'
rhat(x, rhat_cutoff = 1.05, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rhat_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="rhat_+3A_rhat_cutoff">rhat_cutoff</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector indicating the Rhat
cut-off used to test for model convergence.</p>
</td></tr>
<tr><td><code id="rhat_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> containing a vector or Rhat values
returned for each parameter for a <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> object,
for each of the fitted models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
rhat(manec_example)
nec4param &lt;- pull_out(manec_example, model = "nec4param")
rhat(nec4param)

## End(Not run)
</code></pre>

<hr>
<h2 id='sample_priors'>sample_priors</h2><span id='topic+sample_priors'></span>

<h3>Description</h3>

<p>Creates list or generates a plot of prior samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_priors(priors, n_samples = 10000, plot = "ggplot")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_priors_+3A_priors">priors</code></td>
<td>
<p>An object of class <code><a href="brms.html#topic+brmsprior">brmsprior</a></code> from package
<span class="pkg">brms</span>.</p>
</td></tr>
<tr><td><code id="sample_priors_+3A_n_samples">n_samples</code></td>
<td>
<p>The number of prior samples to return.</p>
</td></tr>
<tr><td><code id="sample_priors_+3A_plot">plot</code></td>
<td>
<p>NA returns a <code><a href="base.html#topic+list">list</a></code> of numeric vectors of
sampled priors, &quot;ggplot&quot; (default) returns a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
and &quot;base&quot; returns a histogram in base R.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> containing the initialisation values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bnec">bnec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
data(manec_example)
exmp &lt;- pull_brmsfit(manec_example, model = "nec4param")
sample_priors(exmp$prior)

</code></pre>

<hr>
<h2 id='show_params'>show_params</h2><span id='topic+show_params'></span>

<h3>Description</h3>

<p>Displays non-linear equation and parameter names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_params(model = "all")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_params_+3A_model">model</code></td>
<td>
<p>Removed in version 2.0. Use formula instead. Used to be a
<code><a href="base.html#topic+character">character</a></code> vector indicating the model(s)
to fit. See Details for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="base.html#topic+list">list</a></code> of <code><a href="brms.html#topic+brmsformula">brmsformula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(bayesnec)
# default to all models (i.e. model = "all")
show_params()
# single model
show_params(model = "nec3param")
# group of models
show_params(model = c("nec3param", "ecx"))

</code></pre>

<hr>
<h2 id='step'>step</h2><span id='topic+step'></span>

<h3>Description</h3>

<p>step
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="step_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
the new range of values in x.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is currently exported to allow for non-linear
formula evaluation in brms.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> vector.
</p>

<hr>
<h2 id='summary'>Generates a summary for objects fitted by <code><a href="#topic+bnec">bnec</a></code></h2><span id='topic+summary'></span><span id='topic+summary.bayesnecfit'></span><span id='topic+summary.bayesmanecfit'></span>

<h3>Description</h3>

<p>Generates a summary for objects fitted by <code><a href="#topic+bnec">bnec</a></code>.
<code>object</code> should be of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayesnecfit'
summary(object, ..., ecx = FALSE, ecx_vals = c(10, 50, 90))

## S3 method for class 'bayesmanecfit'
summary(object, ..., ecx = FALSE, ecx_vals = c(10, 50, 90))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> or
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="summary_+3A_ecx">ecx</code></td>
<td>
<p>Should summary ECx values be calculated? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="summary_+3A_ecx_vals">ecx_vals</code></td>
<td>
<p>ECx targets (between 1 and 99). Only relevant if ecx = TRUE.
If no value is specified by the user, returns calculations for EC10, EC50,
and EC90.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary method for both <code><a href="#topic+bayesnecfit">bayesnecfit</a></code> and
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> also returns a no-effect toxicity
estimate. Where the fitted model(s) are NEC models (threshold models,
containing a step function) the no-effect estimate is a true
no-effect-concentration (NEC, see Fox 2010). Where the fitted model(s) are
smooth ECx models with no step function, the no-effect estimate is a
no-significant-effect-concentration (NSEC, see Fisher and Fox 2023). In the
case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> that contains a mixture of both NEC and
ECx models, the no-effect estimate is a model averaged combination of the NEC
and NSEC estimates, and is reported as the N(S)EC (see Fisher et al. 2023).
</p>


<h3>Value</h3>

<p>A summary of the fitted model. In the case of a
<code><a href="#topic+bayesnecfit">bayesnecfit</a></code> object, the summary contains most of the original
contents of a <code><a href="brms.html#topic+brmsfit">brmsfit</a></code> object with the addition of
an R2. In the case of a <code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code> object, summary
displays the family distribution information, model weights and averaging
method, and Bayesian R2 estimates for each individual model.
Warning messages are also printed to screen in case
model fits are not satisfactory with regards to their Rhats.
</p>


<h3>References</h3>

<p>Fisher R, Fox DR (2023). Introducing the no significant effect concentration
(NSEC).Environmental Toxicology and Chemistry, 42(9), 2019–2028.
doi: 10.1002/etc.5610.
</p>
<p>Fisher R, Fox DR, Negri AP, van Dam J, Flores F, Koppel D (2023). Methods for
estimating no-effect toxicity concentrations in ecotoxicology. Integrated
Environmental Assessment and Management. doi:10.1002/ieam.4809.
</p>
<p>Fox DR (2010). A Bayesian Approach for Determining the No Effect
Concentration and Hazardous Concentration in Ecotoxicology. Ecotoxicology
and Environmental Safety, 73(2), 123–131. doi: 10.1016/j.ecoenv.2009.09.012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(bayesnec)
summary(manec_example)
nec4param &lt;- pull_out(manec_example, "nec4param")
summary(nec4param)

</code></pre>

<hr>
<h2 id='update.bnecfit'>Update an object of class <code><a href="#topic+bnecfit">bnecfit</a></code> as fitted by function
<code><a href="#topic+bnec">bnec</a></code>.</h2><span id='topic+update.bnecfit'></span>

<h3>Description</h3>

<p>Update an object of class <code><a href="#topic+bnecfit">bnecfit</a></code> as fitted by function
<code><a href="#topic+bnec">bnec</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bnecfit'
update(
  object,
  newdata = NULL,
  recompile = NULL,
  x_range = NA,
  resolution = 1000,
  sig_val = 0.01,
  loo_controls,
  force_fit = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update.bnecfit_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+bnecfit">bnecfit</a></code> as fitted by function
<code><a href="#topic+bnec">bnec</a></code>.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_newdata">newdata</code></td>
<td>
<p>Optional <code><a href="base.html#topic+data.frame">data.frame</a></code> to update the model
with new data. Data-dependent default priors will not be updated
automatically.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_recompile">recompile</code></td>
<td>
<p>A <code><a href="base.html#topic+logical">logical</a></code>, indicating whether the Stan
model should be recompiled. If <code>NULL</code> (the default), <code>update</code>
tries to figure out internally, if recompilation is necessary. Setting it to
<code>FALSE</code> will cause all Stan code changing arguments to be ignored.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_x_range">x_range</code></td>
<td>
<p>A range of predictor values over which to consider extracting
ECx.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_resolution">resolution</code></td>
<td>
<p>The length of the predictor vector used for posterior
predictions, and over which to extract ECx values. Large values will be
slower but more precise.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_sig_val">sig_val</code></td>
<td>
<p>Probability value to use as the lower quantile to test
significance of the predicted posterior values against the lowest observed
concentration (assumed to be the control), to estimate NEC as an
interpolated NOEC value from smooth ECx curves.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_loo_controls">loo_controls</code></td>
<td>
<p>A named <code><a href="base.html#topic+list">list</a></code> of two elements
(&quot;fitting&quot; and/or &quot;weights&quot;), each being a named <code><a href="base.html#topic+list">list</a></code>
containing the desired arguments to be passed on to <code><a href="brms.html#topic+loo">loo</a></code>
(via &quot;fitting&quot;) or to <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> (via &quot;weights&quot;).
If &quot;weights&quot; is
not provided by the user, <code><a href="#topic+bnec">bnec</a></code> will set the default
<code>method</code> argument in <code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> to
&quot;pseudobma&quot;. See ?<code><a href="loo.html#topic+loo_model_weights">loo_model_weights</a></code> for further info.</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_force_fit">force_fit</code></td>
<td>
<p>Should model truly be updated in case either
<code>newdata</code> of a new family is provided?</p>
</td></tr>
<tr><td><code id="update.bnecfit_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="brms.html#topic+brm">brm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+bnecfit">bnecfit</a></code>. If one single model is
returned, then also an object of class <code><a href="#topic+bayesnecfit">bayesnecfit</a></code>; otherwise,
if multiple models are returned, also an object of class
<code><a href="#topic+bayesmanecfit">bayesmanecfit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(bayesnec)
data(manec_example)
# due to package size issues, `manec_example` does not contain original
# stanfit DSO, so need to recompile here
smaller_manec &lt;- update(manec_example, chains = 2, iter = 50,
                        recompile = TRUE)
# original `manec_example` is fit with a Gaussian
# change to Beta distribution by adding newdata with original `nec_data$y`
# function will throw informative message.
beta_manec &lt;- update(manec_example, newdata = nec_data, recompile = TRUE,
                     chains = 2, iter = 50,
                     family = Beta(link = "identity"), force_fit = TRUE)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
