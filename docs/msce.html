<!DOCTYPE html><html lang="en"><head><title>Help for package msce</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {msce}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lungCancerRadon'><p>Exemplary person year table</p></a></li>
<li><a href='#lungCancerSmoking'><p>Exemplary person year table</p></a></li>
<li><a href='#msce'><p>msce: A package to compute hazard and survival function for</p>
Multi-Stage Clonal Expansion models</a></li>
<li><a href='#msce_numerical'><p>Numerical solution of the Multi-Stage Clonal Expansion Model</p></a></li>
<li><a href='#tsce'><p>Exact solution of the Two-Stage Clonal Expansion Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hazard of Multi-Stage Clonal Expansion Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Cristoforo Simonetto [aut, cre],
    Jan Christian Kaiser [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristoforo Simonetto &lt;Cristoforo.Simonetto@helmholtz-muenchen.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate hazard and survival function of Multi-Stage Clonal Expansion Models used in cancer epidemiology. For the Two-Stage Clonal Expansion Model an exact solution is implemented assuming piecewise constant parameters. Numerical solutions are provided for its extensions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.3), RcppParallel (&ge; 5.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppParallel</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-20 15:14:23 UTC; cristoforo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-29 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lungCancerRadon'>Exemplary person year table</h2><span id='topic+lungCancerRadon'></span>

<h3>Description</h3>

<p>Data set of fatal lung cancer in rats exposed to Radon at Pacific Northwest National Laboratory.
For each rat, the age at start of Radon exposure, the age at end of exposure and the age at end of follow-up/death
is provided in weeks.
The Radon dose rate is given in WL (working level).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lungCancerRadon)
</code></pre>


<h3>Format</h3>

<p>Data frame with 5 variables.
</p>


<h3>Source</h3>

<p>Pacific Northwest National Laboratory, see 
Heidenreich, W, Jacob P, Paretzke H., et al. (1999). Radiation research, 151 2, 209-17 DOI:10.2307/3579772.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lungCancerRadon)
lungCancerRadon[1000,]
</code></pre>

<hr>
<h2 id='lungCancerSmoking'>Exemplary person year table</h2><span id='topic+lungCancerSmoking'></span>

<h3>Description</h3>

<p>Fictitious data set providing the number of lung cancer cases and person years 
in some population stratified according to age, age of smoking start,
age of smoking cessation, and average number of cigarettes per day during the active smoking period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lungCancerSmoking)
</code></pre>


<h3>Format</h3>

<p>Data frame with 6 variables.
</p>


<h3>Source</h3>

<p>Fictitious data set, only for illustration and test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lungCancerSmoking)
lungCancerSmoking[1000,]
</code></pre>

<hr>
<h2 id='msce'>msce: A package to compute hazard and survival function for 
Multi-Stage Clonal Expansion models</h2><span id='topic+msce'></span>

<h3>Description</h3>

<p>Functions <code><a href="#topic+tsce">tsce</a></code> and <code><a href="#topic+msce_numerical">msce_numerical</a></code> are provided
to compute hazard and survival function for the Two- and the more general
Multi-Stage Clonal Expansion model.
Models can be evaluated for time-dependent parameters.
However, parameters are assumed to be constant within the time intervals
specified by the user.
To allow parameter fits on many strata or cohort members, the models are
implemented with RcppParallel.
For details, see the package vignette.
</p>

<hr>
<h2 id='msce_numerical'>Numerical solution of the Multi-Stage Clonal Expansion Model</h2><span id='topic+msce_numerical'></span>

<h3>Description</h3>

<p>This function aims to solve the general multi-stage model 
with piecewise constant parameters approximatively
by integrating the characteristic equations with Euler's method.
For sufficiently small time intervalls, this approximation often 
yields reasonable results.
Small time intervals can either be provided explicitly with many columns
in argument <code>t</code>.
An alternative is the optional parameter <code>innerSteps</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msce_numerical(t, parameterList, innerSteps = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msce_numerical_+3A_t">t</code></td>
<td>
<p>Each element in a row of <code>t</code> defines the endpoint of a 
time interval.
The first time interval starts at time <code>0</code>.
The last element is the time point for which hazard and survival
function are evaluated.
Elements in a row have to be in monotonously increasing order.
In order to achieve a different number of time intervals for
different rows, rows may start with an arbitrary number of zeros
(i.e. time intervals of length zero).</p>
</td></tr>
<tr><td><code id="msce_numerical_+3A_parameterlist">parameterList</code></td>
<td>
<p>List of Matrices.
Each list member has to be named. Allowed names are <code>Nnu0</code>,
<code>alphaX</code>, <code>gammaX</code>, and <code>nuX</code> where <code>X</code>
can be any positive integer value.
The number of stages is deduced from <code>nuX</code>
with the highest <code>X</code>.
Matrices <code>Nnu0</code> and successive <code>nuX</code> must be provided.
Missing other matrices are assumed to be zero.
For each matrix it has to hold that the number of columns 
must be equal to the ones in <code>t</code>.
The number of rows can either equal to the number of rows
in <code>t</code>, or only one row is provided, 
which then is applied to all rows of <code>t</code>.
</p>
<p>Values in matrices <code>Nnu0</code>, <code>alphaX</code>, <code>gammaX</code>,
<code>nuX</code> correspond to parameters for each time interval,
see the figure and explanations in the package vignette.
Here, <code>Nnu0</code> is the product of <code class="reqn">N</code> and <code class="reqn">\nu_0</code>
and <code class="reqn">\gamma_X</code> is defined by
<code class="reqn">\alpha_X-\beta_X</code>.</p>
</td></tr>
<tr><td><code id="msce_numerical_+3A_innersteps">innerSteps</code></td>
<td>
<p>Positive integer.
To improve accuracy, each time interval is internally
divided into <code>innerSteps</code> time intervals of equal length.
Defaults to 1000.
Note, however, that even in the limit of infinite innerSteps,
there will always be a finite discrepancy to the exact result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><img src="../help/figures/MSCE.jpg" alt="Schematic depiction of the MSCE model.
        See the package vignette for details." />
</p>


<h3>Value</h3>

<p>The output list contains all used arguments of the
<code>parameterList</code> and vectors of the model results for
hazard and logarithm of the survival function
for each row of the input.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsce">tsce</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t &lt;-matrix(data=c(10,20,65,10,20,70),nrow=2,byrow=TRUE)
Nnu0 &lt;- matrix(c(0.3,0.7,1),nrow = 1)
nu1  &lt;- matrix(1e-6,nrow=1,ncol=3)
alpha1&lt;- matrix(1,nrow=1,ncol=3)
gamma1&lt;- matrix(c(0.13,0.13,0.13, 0.15,0.15,0.15),nrow=2,byrow=TRUE)
pars = list(Nnu0=Nnu0, nu1=nu1,alpha1=alpha1,gamma1=gamma1) 

msce_numerical(t,pars)
</code></pre>

<hr>
<h2 id='tsce'>Exact solution of the Two-Stage Clonal Expansion Model</h2><span id='topic+tsce'></span>

<h3>Description</h3>

<p>For piecewise constant parameters <code>tsce(t,parameterList)</code>
returns the exact hazard and logarithm of the survival function
of the Two-Stage Clonal Expansion Model.
All arguments are matrices.
Evaluation is performed separately for each row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsce(t, parameterList)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsce_+3A_t">t</code></td>
<td>
<p>Each element in a row of <code>t</code> defines the endpoint of a
time interval.
The first time interval starts at time <code>0</code>.
The last element is the time point for which hazard and survival
function are evaluated.
Elements in a row have to be in monotonously increasing order.
In order to achieve a different number of time intervals for
different rows, rows may start with an arbitrary number of zeros
(i.e. time intervals of length zero).</p>
</td></tr>
<tr><td><code id="tsce_+3A_parameterlist">parameterList</code></td>
<td>
<p>List of Matrices.
Each list member has to be named. Allowed names are <code>Nnu0</code>,
<code>alpha</code>, <code>gamma</code>, and <code>nu1</code>.
Matrices <code>Nnu0</code> and <code>nu1</code> must be provided.
If <code>alpha</code> or <code>gamma</code> are missing,
they are assumed to be zero.
For each matrix it has to hold that the number of columns 
must be equal to the ones in <code>t</code>.
The number of rows can either equal to the number of rows in
<code>t</code>, or only one row is provided,
which then is applied to all rows of <code>t</code>.
</p>
<p>Values in matrices <code>Nnu0</code>, <code>alpha</code>, <code>gamma</code>,
<code>nu1</code> correspond to parameters for each time interval,
see the figure and explanations in the package vignette.
Here, <code>Nnu0</code> is the product of <code class="reqn">N</code> and <code class="reqn">\nu_0</code>
and <code class="reqn">\gamma</code> is defined by
<code class="reqn">\alpha-\beta</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><img src="../help/figures/TSCE.jpg" alt="Schematic depiction of the TSCE model.
        See the package vignette for details." />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+msce_numerical">msce_numerical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t &lt;-matrix(data=c(10,20,65,10,20,70),nrow=2,byrow=TRUE)
Nnu0 &lt;- matrix(c(0.3,0.7,1),nrow = 1)
alpha&lt;- matrix(1,nrow=1,ncol=3)
gamma&lt;- matrix(c(0.13,0.13,0.13, 0.15,0.15,0.15),nrow=2,byrow=TRUE)
nu1  &lt;- matrix(1e-6,nrow=1,ncol=3)
pars = list(Nnu0=Nnu0, alpha=alpha,gamma=gamma,nu1=nu1) 

tsce(t,pars)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
