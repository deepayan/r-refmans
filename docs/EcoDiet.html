<!DOCTYPE html><html><head><title>Help for package EcoDiet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EcoDiet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EcoDiet-package'><p>EcoDiet: Estimating a Diet Matrix from Biotracer and Stomach Content Data</p></a></li>
<li><a href='#diagnose_model'><p>Diagnose EcoDiet model</p></a></li>
<li><a href='#example_biotracer_data'><p>Example biotracer data</p></a></li>
<li><a href='#example_literature_diets'><p>Example literature diets</p></a></li>
<li><a href='#example_stomach_data'><p>Example stomach data</p></a></li>
<li><a href='#mcmc_output_example'><p>The MCMC output for running the example dataset</p></a></li>
<li><a href='#plot_data'><p>Plot the input data</p></a></li>
<li><a href='#plot_prior'><p>Plot the prior means or probability distribution(s)</p></a></li>
<li><a href='#plot_results'><p>Plot the posterior means or probability distribution(s)</p></a></li>
<li><a href='#preprocess_data'><p>Check and preprocess the data</p></a></li>
<li><a href='#realistic_biotracer_data'><p>Realistic biotracer data</p></a></li>
<li><a href='#realistic_literature_diets'><p>Realistic literature diets</p></a></li>
<li><a href='#realistic_stomach_data'><p>Realistic stomach data</p></a></li>
<li><a href='#run_model'><p>Run the EcoDiet model</p></a></li>
<li><a href='#write_model'><p>Write the EcoDiet model in BUGS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating a Diet Matrix from Biotracer and Stomach Content Data</td>
</tr>
<tr>
<td>Description:</td>
<td>Biotracers and stomach content analyses are combined in a Bayesian hierarchical model
    to estimate a probabilistic topology matrix (all trophic link probabilities) and a diet matrix 
    (all diet proportions).
    The package relies on the JAGS software and the 'jagsUI' package to run a Markov chain Monte Carlo 
    approximation of the different variables.</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.2), coda (&ge; 0.19), stats (&ge; 3.6), utils (&ge;
3.6), jagsUI (&ge; 1.5.2), ggmcmc (&ge; 1.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, devtools, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pyhernvann/EcoDiet">https://github.com/pyhernvann/EcoDiet</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pyhernvann/EcoDiet/issues">https://github.com/pyhernvann/EcoDiet/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 16:51:09 UTC; pyher</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre-Yves Hernvann [cre, aut],
  Didier Gascuel [aut],
  Dorothee Kopp [aut],
  Marianne Robert [aut],
  Jerome Guitton [aut],
  Etienne Rivot [aut],
  Heloise Thero [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre-Yves Hernvann &lt;pierre.yves.hernvann@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 20:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='EcoDiet-package'>EcoDiet: Estimating a Diet Matrix from Biotracer and Stomach Content Data</h2><span id='topic+EcoDiet'></span><span id='topic+EcoDiet-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Biotracers and stomach content analyses are combined in a Bayesian hierarchical model to estimate a probabilistic topology matrix (all trophic link probabilities) and a diet matrix (all diet proportions). The package relies on the JAGS software and the 'jagsUI' package to run a Markov chain Monte Carlo approximation of the different variables.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pierre-Yves Hernvann <a href="mailto:pierre.yves.hernvann@gmail.com">pierre.yves.hernvann@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Didier Gascuel
</p>
</li>
<li><p> Dorothee Kopp
</p>
</li>
<li><p> Marianne Robert
</p>
</li>
<li><p> Jerome Guitton
</p>
</li>
<li><p> Etienne Rivot
</p>
</li>
<li><p> Heloise Thero
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/pyhernvann/EcoDiet">https://github.com/pyhernvann/EcoDiet</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/pyhernvann/EcoDiet/issues">https://github.com/pyhernvann/EcoDiet/issues</a>
</p>
</li></ul>


<hr>
<h2 id='diagnose_model'>Diagnose EcoDiet model</h2><span id='topic+diagnose_model'></span>

<h3>Description</h3>

<p>This function operates a diagnostic of the fit EcoDiet model.
</p>
<p>A message is printed to provide the number of variables for which the Gelman-Rubin diagnostic exceeds
specific thresholds (&gt; 1.01, &gt; 1.05, &gt;1.1). The list of the 10 worst variables in terms of convergence
is also printed.
</p>
<p>You need to have run the <code>run_model</code> function before using this function.
</p>
<p>The design of this function is substantially inspired from a function with a similar objective
in the MixSIAR package [(Stock et al. 2018)](https://doi.org/10.7717/peerj.5096), for which code is available online on
the [MixSIAR GitHub repository](https://github.com/brianstock/MixSIAR).
The diagnostic plots are generated using the <code>ggmcmc</code> package [(Fernández-i-Marín, 2016)](https://CRAN.R-project.org/package=ggmcmc).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnose_model(jags_output, var.to.diag = "all", save = FALSE, save_path = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnose_model_+3A_jags_output">jags_output</code></td>
<td>
<p>The MCMC output summarized in the class jagsUI object
output by <code>run_model</code> function</p>
</td></tr>
<tr><td><code id="diagnose_model_+3A_var.to.diag">var.to.diag</code></td>
<td>
<p>The list of variables for which diagnostic plots should be produced and save. By default, this
argument is &quot;all&quot; hence is run for all the variables.</p>
</td></tr>
<tr><td><code id="diagnose_model_+3A_save">save</code></td>
<td>
<p>Indicates whether diagnostic plots should be produced and saved.</p>
</td></tr>
<tr><td><code id="diagnose_model_+3A_save_path">save_path</code></td>
<td>
<p>The path indicating where to save the diagnostic plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the Gelman diagnostic for all the variables monitored by the <code><a href="#topic+run_model">run_model</a></code> function (<code>variables_to_save argument</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_model">run_model</a></code> to run the model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

realistic_biotracer_data &lt;- read.csv(system.file("extdata", "realistic_biotracer_data.csv",
                                               package = "EcoDiet"))
realistic_stomach_data &lt;- read.csv(system.file("extdata", "realistic_stomach_data.csv",
                                             package = "EcoDiet"))

data &lt;- preprocess_data(biotracer_data = realistic_biotracer_data,
                        trophic_discrimination_factor = c(0.8, 3.4),
                        literature_configuration = FALSE,
                        stomach_data = realistic_stomach_data)
                        
write_model(literature_configuration = FALSE)

mcmc_output &lt;- run_model("EcoDiet_model.txt", data, run_param="test")

Gelman_test &lt;- diagnose_model(mcmc_output)
Gelman_test



</code></pre>

<hr>
<h2 id='example_biotracer_data'>Example biotracer data</h2><span id='topic+example_biotracer_data'></span>

<h3>Description</h3>

<p>This is an artificial and simple biotracer dataset, more specifically stable isotope analyses,
made to illustrate the package on a simple case. All tables whose name start by &quot;example&quot; are describing
different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 15 rows and 3 columns. Each row is an isotopic sample from one individual.
The columns are:
</p>

<dl>
<dt>group</dt><dd><p>the trophic group the individual belonged to</p>
</dd>
<dt>d13C</dt><dd><p>the d13C measurement made on that individual</p>
</dd>
<dt>d15N</dt><dd><p>the d15N measurement made on that individual</p>
</dd>
</dl>


<hr>
<h2 id='example_literature_diets'>Example literature diets</h2><span id='topic+example_literature_diets'></span>

<h3>Description</h3>

<p>This is an artificial and simple literature diets dataset, made to illustrate the package on a simple case.
All tables whose name start by &quot;example&quot; are describing different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 5 rows and 5 columns.
The headers contain the predators' names, the first column contains the preys' names.
Each cell contains the average diet proportions fond in the literature for the corresponding predator.
The last row contains the average pedigree score for the literature on each predator.
</p>

<hr>
<h2 id='example_stomach_data'>Example stomach data</h2><span id='topic+example_stomach_data'></span>

<h3>Description</h3>

<p>This is an artificial and simple stomachal dataset, made to illustrate the package on a simple case.
All tables whose name start by &quot;example&quot; are describing different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 5 rows and 5 columns.
The headers contain the predators' names, the first column contains the preys' names.
Each cell contains the number of the predator's stomachs in which this prey was found.
The last row contains the total number of non-empty stomachs for each predator.
</p>

<hr>
<h2 id='mcmc_output_example'>The MCMC output for running the example dataset</h2><span id='topic+mcmc_output_example'></span>

<h3>Description</h3>

<p>This is the MCMC output for running the example dataset as illustrated in the introduction 
vignette (with 1e6 iterations, 1e3 adaptation steps) and with priors informed 
from the literature study.
This data is here so that the plot_results fonction can be illustrated on 
results that have converged.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_output_example
</code></pre>


<h3>Format</h3>

<p>An object of class <code>jagsUI</code> of length 24.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mcmc_output_example")
</code></pre>

<hr>
<h2 id='plot_data'>Plot the input data</h2><span id='topic+plot_data'></span>

<h3>Description</h3>

<p>This function is used to plot the input biotracer and/or the stomach content data.
You can use the function with only one parameter to plot only one kind of data.
</p>
<p>The figure(s) can be saved as PNG using: <code>save = TRUE</code>, and the directory path to which
the figures are saved can be precised with: <code>save_path = "."</code>.
</p>
<p>If only the stomach content data is entered, there will be a single raster plot containing the proportions
of occurences in the stomachs. 
</p>
<p>For the biotracer data, there will be as many plots as the number of
combinations of elements. For example if only two isotopes are entered, there will be a single biplot
plotted. If three elements are entered (element A, B and C), three biplots will be shown : A vs. B, 
B vs. C and A vs. C.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data(
  biotracer_data = NULL,
  stomach_data = NULL,
  save = FALSE,
  save_path = "."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_+3A_biotracer_data">biotracer_data</code></td>
<td>
<p>A dataframe containing the biotracer data in the specific format: the first column
corresponds to the trophic group or latin species and the remaining columns contains the biotracer
measures</p>
</td></tr>
<tr><td><code id="plot_data_+3A_stomach_data">stomach_data</code></td>
<td>
<p>A dataframe containing the stomach content data in a specific format: the first row
contains the names of the prey trophic groups, the headers contains the names of the consumer / 
predator trophic groups, and the rest are the number of the predator's stomachs in which this prey
was found. The last row contains the total number of non-empty stomach for the corresponding
predator.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_save">save</code></td>
<td>
<p>A boolean describing whether the figure should be saved as PNG. 
By default the figures are not saved.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_save_path">save_path</code></td>
<td>
<p>A string describing the path to which the figures should be saved.
By default the figures are saved in a temporary directory.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot_prior">plot_prior</a></code> to plot the prior means or probability distribution(s), 
<code><a href="#topic+plot_results">plot_results</a></code> to plot the posterior means or probability distribution(s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
example_biotracer_data &lt;- read.csv(system.file("extdata", "example_biotracer_data.csv",
                                               package = "EcoDiet"))
plot_data(biotracer_data = example_biotracer_data)

example_stomach_data &lt;- read.csv(system.file("extdata", "example_stomach_data.csv",
                                             package = "EcoDiet"))

plot_data(biotracer_data = example_biotracer_data,
          stomach_data = example_stomach_data)
          
     
</code></pre>

<hr>
<h2 id='plot_prior'>Plot the prior means or probability distribution(s)</h2><span id='topic+plot_prior'></span>

<h3>Description</h3>

<p>This function plots the prior means or probability distribution(s) for one or the two
variable(s) of interest : the trophic link probabilities (&quot;eta&quot;) and/or the diet proportions (&quot;PI&quot;).
</p>
<p>The figure(s) can be saved as PNG using: <code>save = TRUE</code>, and the directory path to which
the figures are saved can be precised with: <code>save_path = "."</code>.
</p>
<p>If no &quot;pred&quot; nor &quot;prey&quot; parameter is entered, the plot will be a raster plot with the mean priors for 
all the trophic groups.
</p>
<p>If one predator name is entered as &quot;pred&quot;, the probability distribution(s) will be plotted for all its 
prey(s) by default. Some specific prey(s) name(s) can also be entered because if a predator has 
22 preys, plotting them all will make the plot hard to read. So you can specify the one or many prey(s) 
of interest and only display their corresponding probability distribution(s).
</p>
<p>The &quot;variable&quot; parameter can be specified if one wants to plot the priors for only one variable 
(&quot;PI&quot; or &quot;eta&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_prior(
  data,
  literature_configuration,
  pred = NULL,
  prey = NULL,
  variable = c("eta", "PI"),
  save = FALSE,
  save_path = "."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_prior_+3A_data">data</code></td>
<td>
<p>the preprocessed data list output by the preprocess_data() function</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_literature_configuration">literature_configuration</code></td>
<td>
<p>A boolean (TRUE or FALSE) indicating whether the model will have
prior distributions informed by a literature study</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_pred">pred</code></td>
<td>
<p>the predator name for which we want to plot the probability densities</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_prey">prey</code></td>
<td>
<p>the prey(s) name(s) for which we want to plot the probability densities</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_variable">variable</code></td>
<td>
<p>the variable(s) for which we want to plot the probability densities. By default
we will plot the two variables of interest: eta and PI.</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_save">save</code></td>
<td>
<p>A boolean describing whether the figure should be saved as PNG. 
By default the figures are not saved.</p>
</td></tr>
<tr><td><code id="plot_prior_+3A_save_path">save_path</code></td>
<td>
<p>A string describing the path to which the figures should be saved.
By default the figures are saved in a temporary directory.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot_results">plot_results</a></code> to plot the posterior means or probability distribution(s),
<code><a href="#topic+plot_data">plot_data</a></code> to plot the input data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
realistic_biotracer_data &lt;- read.csv(system.file("extdata", "realistic_biotracer_data.csv",
                                               package = "EcoDiet"))
realistic_stomach_data &lt;- read.csv(system.file("extdata", "realistic_stomach_data.csv",
                                             package = "EcoDiet"))

data &lt;- preprocess_data(biotracer_data = realistic_biotracer_data,
                        trophic_discrimination_factor = c(0.8, 3.4),
                        literature_configuration = FALSE,
                        stomach_data = realistic_stomach_data)
                        
plot_prior(data, literature_configuration = FALSE)
plot_prior(data, literature_configuration = FALSE, pred = "Cod")
plot_prior(data, literature_configuration = FALSE, pred = "Cod", 
           prey = c("Crabs", "Shrimps"), variable = "eta")
           
</code></pre>

<hr>
<h2 id='plot_results'>Plot the posterior means or probability distribution(s)</h2><span id='topic+plot_results'></span>

<h3>Description</h3>

<p>This function plots the posterior means or probability distribution(s) for one 
or the two variable(s) of interest : the trophic link probabilities (&quot;eta&quot;) and/or 
the diet proportions (&quot;PI&quot;).
</p>
<p>The figure(s) can be saved as PNG using: <code>save = TRUE</code>, and the directory path to which
the figures are saved can be precised with: <code>save_path = "."</code>.
</p>
<p>If no &quot;pred&quot; nor &quot;prey&quot; parameter is entered, the plot will be a raster plot with the mean priors for 
all the trophic groups.
</p>
<p>If one predator name is entered as &quot;pred&quot;, the probability distribution(s) will be plotted for all its 
prey(s) by default. Some specific prey(s) name(s) can also be entered because if a predator has 
22 preys, plotting them all will make the plot hard to read. So you can specify the one or many prey(s) 
of interest and only display their corresponding probability distribution(s).
</p>
<p>The &quot;variable&quot; parameter can be specified if one wants to plot the priors for only one variable 
(&quot;PI&quot; or &quot;eta&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_results(
  jags_output,
  data,
  pred = NULL,
  prey = NULL,
  variable = c("eta", "PI"),
  save = FALSE,
  save_path = "."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_results_+3A_jags_output">jags_output</code></td>
<td>
<p>the mcmc.list object output by the run_model() function</p>
</td></tr>
<tr><td><code id="plot_results_+3A_data">data</code></td>
<td>
<p>the preprocessed data list output by the preprocess_data() function</p>
</td></tr>
<tr><td><code id="plot_results_+3A_pred">pred</code></td>
<td>
<p>the predator name for which we want to plot the probability densities</p>
</td></tr>
<tr><td><code id="plot_results_+3A_prey">prey</code></td>
<td>
<p>the prey(s) name(s) for which we want to plot the probability densities</p>
</td></tr>
<tr><td><code id="plot_results_+3A_variable">variable</code></td>
<td>
<p>the variable(s) for which we want to plot the probability densities. By default
we will plot the two variables of interest: eta and PI.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_save">save</code></td>
<td>
<p>A boolean describing whether the figure should be saved as PNG. 
By default the figures are not saved.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_save_path">save_path</code></td>
<td>
<p>A string describing the path to which the figures should be saved.
By default the figures are saved in a temporary directory.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot_prior">plot_prior</a></code> to plot the prior means or probability distribution(s),
<code><a href="#topic+plot_data">plot_data</a></code> to plot the input data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

realistic_biotracer_data &lt;- read.csv(system.file("extdata", "realistic_biotracer_data.csv",
                                               package = "EcoDiet"))
realistic_stomach_data &lt;- read.csv(system.file("extdata", "realistic_stomach_data.csv",
                                             package = "EcoDiet"))

data &lt;- preprocess_data(biotracer_data = realistic_biotracer_data,
                        trophic_discrimination_factor = c(0.8, 3.4),
                        literature_configuration = FALSE,
                        stomach_data = realistic_stomach_data)
                        
write_model(literature_configuration = FALSE)

mcmc_output &lt;- run_model("EcoDiet_model.txt", data, run_param="test")
                        
plot_results(mcmc_output, data)
plot_results(mcmc_output, data, pred = "Crabs")
plot_results(mcmc_output, data, pred = "Crabs",
             variable = "PI", prey = c("Bivalves", "Shrimps"))
             


</code></pre>

<hr>
<h2 id='preprocess_data'>Check and preprocess the data</h2><span id='topic+preprocess_data'></span>

<h3>Description</h3>

<p>This function preprocesses the data input by the user, checks that the different inputs 
have the right format, and creates the data list that will feed the JAGS model.
</p>
<p>If an error appears with a clear message, it means that the input needs to be reformatted. Please 
follow the instructions in the error message. You can also look at the data examples to guide you.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess_data(
  biotracer_data,
  trophic_discrimination_factor,
  literature_configuration = FALSE,
  topology = NULL,
  element_concentration = 1,
  stomach_data = NULL,
  rescale_stomach = FALSE,
  literature_diets = NULL,
  nb_literature,
  literature_slope
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess_data_+3A_biotracer_data">biotracer_data</code></td>
<td>
<p>A dataframe containing the biotracer data in the specific format: the first column
corresponds to the trophic group or latin species and the remaining columns contains the biotracer
measures</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_trophic_discrimination_factor">trophic_discrimination_factor</code></td>
<td>
<p>A vector containing the trophic discrimination factors 
corresponding to each column found in the biotracer data (except the group column of course)</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_literature_configuration">literature_configuration</code></td>
<td>
<p>A boolean (TRUE or FALSE) indicating whether the model will have
prior distributions informed by a literature study</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_topology">topology</code></td>
<td>
<p>A matrix that the user may input if she wants the model to investigate some 
additionnal trophic links (by-default it is set on NULL and defined later from the stomach content 
data and the literature diets if present)</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_element_concentration">element_concentration</code></td>
<td>
<p>A matrix containing the element concentration for each trophic group and
each biotracer element (listed in the biotracer data). It is a matrix with as many columns
as the number of trophic groups and as many rows as the number of elements. By default the matrix
is filled with ones.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_stomach_data">stomach_data</code></td>
<td>
<p>A dataframe containing the stomach content data in a specific format: the first row
contains the names of the prey trophic groups, the headers contains the names of the consumer / 
predator trophic groups, and the rest are the number of the predator's stomachs in which this prey
was found. The last row contains the total number of non-empty stomach for the corresponding
predator.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_rescale_stomach">rescale_stomach</code></td>
<td>
<p>A boolean (TRUE or FALSE) indicating whether the stomach content data will be rescaled.
If TRUE, the stomach occurences are upscaled by dividing them by the maximum occurrences / the number
of non-empty stomach.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_literature_diets">literature_diets</code></td>
<td>
<p>A dataframe containing the diet proportions found in the literature
in a format similar to the stomach content data: the first row contains the names of the prey 
trophic groups, the headers contains the names of the consumer / predator trophic groups, 
and the rest are the average proportions of this prey in the predator's diet according to a 
literature study. The last row contains the pedigree score associated to the literature findings 
for each predators, a number between 0 and 1 indicating how much the literature findings are relevant
estimates for the input data.</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_nb_literature">nb_literature</code></td>
<td>
<p>A vector of one number containing the equivalent number of stomach 
for the literature priors on the eta variable</p>
</td></tr>
<tr><td><code id="preprocess_data_+3A_literature_slope">literature_slope</code></td>
<td>
<p>A vector of one number containing the slope of the linear relationship 
between the pedigree scores and the PIs' coefficients of variation (CVs)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of preprocessed data, ready to be fed to the EcoDiet model through the
'rjags' package. This list contains a different number of elements, depending on
which configuration is chosen by the user (literature_configuration = TRUE or FALSE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
example_biotracer_data &lt;- read.csv(system.file("extdata", "example_biotracer_data.csv",
                                               package = "EcoDiet"))
example_stomach_data &lt;- read.csv(system.file("extdata", "example_stomach_data.csv",
                                             package = "EcoDiet"))

data &lt;- preprocess_data(biotracer_data = example_biotracer_data,
                        trophic_discrimination_factor = c(0.8, 3.4),
                        literature_configuration = FALSE,
                        stomach_data = example_stomach_data)
                        
example_literature_diets &lt;- read.csv(system.file("extdata", "example_literature_diets.csv",
                                                 package = "EcoDiet"))
                        
data2 &lt;- preprocess_data(biotracer_data = example_biotracer_data,
                         trophic_discrimination_factor = c(0.8, 3.4),
                         literature_configuration = TRUE,
                         stomach_data = example_stomach_data,
                         literature_diets = example_literature_diets,
                         nb_literature = 10,
                         literature_slope = 0.5)

</code></pre>

<hr>
<h2 id='realistic_biotracer_data'>Realistic biotracer data</h2><span id='topic+realistic_biotracer_data'></span>

<h3>Description</h3>

<p>This is an artificial and realistic biotracer dataset, more specifically stable isotope analyses,
made to illustrate the package on a complex dataset. All tables whose name start by &quot;realistic&quot; are
describing different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 300 rows and 3 columns. Each row is an isotopic sample from one individual, and
there are 30 individuals sampled in each trophic group.
The columns are:
</p>

<dl>
<dt>group</dt><dd><p>the trophic group the individual belonged to</p>
</dd>
<dt>d13C</dt><dd><p>the d13C measurement made on that individual</p>
</dd>
<dt>d15N</dt><dd><p>the d15N measurement made on that individual</p>
</dd>
</dl>


<hr>
<h2 id='realistic_literature_diets'>Realistic literature diets</h2><span id='topic+realistic_literature_diets'></span>

<h3>Description</h3>

<p>This is an artificial and realistic literature diets dataset, made to illustrate the package on a complex dataset.
All tables whose name start by &quot;realistic&quot; are describing different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 11 rows and 11 columns.
The headers contain the predators' names, the first column contains the preys' names.
Each cell contains the average diet proportions fond in the literature for the corresponding predator.
The last row contains the average pedigree score for the literature on each predator.
</p>

<hr>
<h2 id='realistic_stomach_data'>Realistic stomach data</h2><span id='topic+realistic_stomach_data'></span>

<h3>Description</h3>

<p>This is an artificial and realistic stomachal dataset, made to illustrate the package on a complex dataset.
All tables whose name start by &quot;realistic&quot; are describing different data from the same trophic groups.
</p>


<h3>Format</h3>

<p>A table with 11 rows and 11 columns.
The headers contain the predators' names, the first column contains the preys' names.
Each cell contains the number of the predator's stomachs in which this prey was found.
The last row contains the total number of non-empty stomachs for each predator.
</p>

<hr>
<h2 id='run_model'>Run the EcoDiet model</h2><span id='topic+run_model'></span>

<h3>Description</h3>

<p>This function runs the EcoDiet model using a Markov chain Monte Carlo approximation 
through the 'jagsUI' package to provide an approximated distribution for the variables of interest.
</p>
<p>Depending on the <code>nb_iter</code> entered, this function may take hours, or even days 
to run. We advise you to first test whether your model is compiling properly with the by-default parameters,
as this should take 1-2 min to run depending on your data size.
</p>
<p>To save time, this function can solicit several cores (if available) to parallelize chains. Note that progress bars
won't be displayed if chains are parallelized. 
</p>
<p>A warning message is printed if the model has not converged in the end (if the Gelman-Rubin diagnostic
of at least one variable is &gt; 1.1). For each run, the default 'jagsUI' package messages summarize
the '.txt' file used for the definition of the BUGS model, the configuration of the model (iteration, adaptation, 
burnin, thin rate), the time required to run the model, and main statistics for the variables.
</p>
<p>You need to have run the <code>preprocess_data</code> and the <code>write_model</code> functions 
before using this function, as their outputs are used as the inputs for <code>run_model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_model(
  model_file,
  data,
  inits = NULL,
  run_param = "test",
  variables_to_save = c("eta", "PI"),
  parallelize = FALSE,
  DIC.out = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_model_+3A_model_file">model_file</code></td>
<td>
<p>The file containing the BUGS definition of the EcoDiet model 
output by the <code>write_model</code> function</p>
</td></tr>
<tr><td><code id="run_model_+3A_data">data</code></td>
<td>
<p>The preprocessed data list output by the preprocess_data() function</p>
</td></tr>
<tr><td><code id="run_model_+3A_inits">inits</code></td>
<td>
<p>A list containing the initial values of the variables.
By default the initialisation values are NULL, which means that the chain initial values
are drawn from the prior distributions.</p>
</td></tr>
<tr><td><code id="run_model_+3A_run_param">run_param</code></td>
<td>
<p>A object that can be a list of the parameters to configure the JAGS model or a string acting as
a shortcut characterizing the overall length of the run requested (e.g. &quot;short&quot; or &quot;long&quot;). If run_param is 
provided as a list, the user should provide at least nb_iter, i.e. the number of iterations to run (the more
iterations, the better are the chances that the model will converge; very small by default to test if the model
compiles properly), and nb_burnin, i.e. the number of burn-in steps to run (so that the variable approximations
are not too influenced by the first initial random values). nb_thin, the thinning rate, is by default defined by
the function. The number of adaptation steps nb_adapt can be specified but is not required (see jasgUI documentation 
for more details). If set manually, it should be at least set at 1000.</p>
</td></tr>
<tr><td><code id="run_model_+3A_variables_to_save">variables_to_save</code></td>
<td>
<p>A vector of variable names defining the variables to output. 
The number has a big number of variables but by default we only save the variables of interest
that are the trophic link probabilities <code>eta</code> and the diet proportions <code>PI</code>.
Only these saved variables are used to compute the Gelman-Rubin statistics that indicate whether
the model has converged or not.</p>
</td></tr>
<tr><td><code id="run_model_+3A_parallelize">parallelize</code></td>
<td>
<p>Indicates whether chains should be parallelized using several cores. Recommended in case of complex models.</p>
</td></tr>
<tr><td><code id="run_model_+3A_dic.out">DIC.out</code></td>
<td>
<p>Indicates whether the DIC (Deviance Information Criterion) should be reported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A MCMC output formatted as a jagsUI object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preprocess_data">preprocess_data</a></code> to preprocess the data, and 
<code><a href="#topic+write_model">write_model</a></code> to define the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

realistic_biotracer_data &lt;- read.csv(system.file("extdata", "realistic_biotracer_data.csv",
                                               package = "EcoDiet"))
realistic_stomach_data &lt;- read.csv(system.file("extdata", "realistic_stomach_data.csv",
                                             package = "EcoDiet"))

data &lt;- preprocess_data(biotracer_data = realistic_biotracer_data,
                        trophic_discrimination_factor = c(0.8, 3.4),
                        literature_configuration = FALSE,
                        stomach_data = realistic_stomach_data)
                        
write_model(literature_configuration = FALSE)

mcmc_output &lt;- run_model("EcoDiet_model.txt", data, run_param="test")


</code></pre>

<hr>
<h2 id='write_model'>Write the EcoDiet model in BUGS</h2><span id='topic+write_model'></span>

<h3>Description</h3>

<p>This function writes the EcoDiet model in the BUGS syntax as a several line long string.
</p>
<p>The model definition depends on whether or not literature data will be used to inform the priors,
hence the parameter <code>literature_configuration</code>.
</p>
<p>To know more about what is inside the model, please read the reference article.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_model(
  file.name = "EcoDiet_model.txt",
  literature_configuration = FALSE,
  print.model = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_model_+3A_file.name">file.name</code></td>
<td>
<p>The name and location under which the '.txt' BUGS definition
of the model will be saved. If not provided, the file will be saved in the
current repository under the &quot;EcoDiet_model.txt&quot; name.</p>
</td></tr>
<tr><td><code id="write_model_+3A_literature_configuration">literature_configuration</code></td>
<td>
<p>A boolean (TRUE or FALSE) indicating whether the model will have
prior distributions informed by a literature study</p>
</td></tr>
<tr><td><code id="write_model_+3A_print.model">print.model</code></td>
<td>
<p>Indicates whether the user wants to print the written model in the console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string containing the model definition in BUGS
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_model">run_model</a></code> to run the model after it has been defined
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
write_model(file.name="my_model_with_priors.txt", literature_configuration = TRUE)

write_model(literature_configuration = FALSE, print.model = TRUE)

unlink('my_model_with_priors.txt')
unlink('EcoDiet_model.txt')


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
