<!DOCTYPE html><html lang="en"><head><title>Help for package acp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {acp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acp'><p>Autoregressive Conditional Poisson (ACP) Regression</p></a></li>
<li><a href='#Berkowitz'><p>Berkowitz test</p></a></li>
<li><a href='#evaluation'><p>acp Evaluation</p></a></li>
<li><a href='#polio'>
<p>Polio cases in USA from Jan 1970 till Dec 1983</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Autoregressive Conditional Poisson</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-11-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Siakoulis Vasileios</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Siakoulis Vasilios &lt;Siakoulis.Vasilios@atticabank.gr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of count data exhibiting autoregressive properties, using the Autoregressive Conditional Poisson model (ACP(p,q)) proposed by Heinen (2003).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>tseries,quantmod</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-12-03 18:32:43 UTC; siakbill</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-12-04 00:03:26</td>
</tr>
</table>
<hr>
<h2 id='acp'>Autoregressive Conditional Poisson (ACP) Regression</h2><span id='topic+acp'></span><span id='topic+acp.default'></span><span id='topic+acp.formula'></span><span id='topic+print.acp'></span><span id='topic+predict.acp'></span><span id='topic+summary.acp'></span><span id='topic+print.summary.acp'></span>

<h3>Description</h3>

<p>Fit an ACP(p,q) regression model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acp(x, ...)
## Default S3 method:
acp(x, y, p, q ,startval, varopt,...)
## S3 method for class 'formula'
acp(formula, data=list(), p, q ,startval=NULL, varopt=T, family="acp",...)
## S3 method for class 'acp'
print(x, ...)
## S3 method for class 'acp'
summary(object, ...)
## S3 method for class 'acp'
predict(object, newydata=NULL, newxdata=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acp_+3A_x">x</code></td>
<td>
<p> a numeric design matrix for the model. </p>
</td></tr>
<tr><td><code id="acp_+3A_y">y</code></td>
<td>
<p> a numeric vector of responses. </p>
</td></tr>
<tr><td><code id="acp_+3A_p">p</code></td>
<td>
<p> number of lags for the dependent variable. </p>
</td></tr>
<tr><td><code id="acp_+3A_q">q</code></td>
<td>
<p> number of lags for the conditional mean. </p>
</td></tr>
<tr><td><code id="acp_+3A_startval">startval</code></td>
<td>
<p> a numeric vector of starting values. If not provided the package 
will obtain starting values for the covariate parameters from a poisson regression 
and for the autoregressive parameters from an arma(1,1) regression.</p>
</td></tr>
<tr><td><code id="acp_+3A_family">family</code></td>
<td>
<p> A description of the specification to be used. If family=&quot;acp&quot; or not provided an Autoregressive Poisson regression 
will be estimated whereas if family=&quot;poisson&quot; a plain Poisson regression is provided.</p>
</td></tr>
<tr><td><code id="acp_+3A_formula">formula</code></td>
<td>
<p> a symbolic description of the model to be fit. </p>
</td></tr>
<tr><td><code id="acp_+3A_data">data</code></td>
<td>
<p> an optional data frame containing the variables in the model. </p>
</td></tr>
<tr><td><code id="acp_+3A_varopt">varopt</code></td>
<td>
<p> an optional logical operator T (TRUE) or F (FALSE) determining whether the covariance 
matrix will be calculated (T) or not (F).</p>
</td></tr>
<tr><td><code id="acp_+3A_object">object</code></td>
<td>
<p> an object of class <code>"acp"</code>, i.e., a fitted model. </p>
</td></tr>
<tr><td><code id="acp_+3A_newxdata">newxdata</code></td>
<td>
<p> a data frame containing the covariates data upon which a static forecast will be performed.</p>
</td></tr> 
<tr><td><code id="acp_+3A_newydata">newydata</code></td>
<td>
<p> a data frame containing the dependent variable upon which a static forecast will be performed.</p>
</td></tr> 
<tr><td><code id="acp_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This model has been proposed by Heinen (2003) for cases of count data exhibiting autoregressive behaviour.
As pointed by Cameron and Trivedi (1998), when a count data set exhibits time dependence the plain Poisson 
regression is not adequate. Heinen (2003) proposed the ACP model in close analogy to the Autoregressive Conditional Duration model (ACD) of 
Engle and Russel (1998) and the GARCH model of Bollerslev (1986). The model can be also found in the international bibliography 
as Integer GARCH (Fokianos and Fried, 2010). 
</p>


<h3>Value</h3>

<p>An object of class <code>logreg</code>, basically a list including elements
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> a named vector of coefficients </p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> covariance matrix of coefficients </p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> fitted values </p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> residuals </p>
</td></tr>
<tr><td><code>logl</code></td>
<td>
<p> log-likelihood </p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> AKAIKE information criterion </p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p> Bayesian information criterion </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Siakoulis Vasileios</p>


<h3>References</h3>


<ul>
<li> <p>Bollerslev, T., 1986. Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics 31, 307-327.
</p>
</li>
<li> <p>Cameron, A., and Trivedi, P., 1998. Regression Analysis of Count Data. New York: Cambridge University Press.
</p>
</li>
<li> <p>Engle, RF., Russell, JR., 1998. Autoregressive conditional duration: a new model for irregularly spaced transaction data. Econometrica 66, 1127-1162.
</p>
</li>
<li> <p>Fokianos, K., Fried, R., 2010. Interventions in INGARCH processes. Journal of Time Series Analysis 31/3, 210-225.
</p>
</li>
<li> <p>Heinen, A., 2003. Modelling Time Series Count Data: An Autoregressive Conditional Poisson Model. University Library of Munich.MPRA paper, 8113.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data(polio)

trend=(1:168/168)
cos12=cos((2*pi*(1:168))/12)
sin12=sin((2*pi*(1:168))/12)
cos6=cos((2*pi*(1:168))/6)
sin6=sin((2*pi*(1:168))/6)


#Autoregressive Conditional Poisson Model with explaning covariates
polio_data&lt;-data.frame(polio, trend , cos12, sin12, cos6, sin6)
mod1 &lt;- acp(polio~-1+trend+cos12+sin12+cos6+sin6,data=polio_data, p = 1 ,q = 2)
summary(mod1)

#Static out-of-sample fit example
train&lt;-data.frame(polio_data[c(1: 119),])
mod1t &lt;- acp(polio~-1+trend+cos12+sin12+cos6+sin6,data=train, p = 1  ,q = 2)
xpolio_data&lt;-data.frame(trend , cos12, sin12, cos6, sin6)
test&lt;-xpolio_data[c(120:nrow(xpolio_data)),]
yfor&lt;-polio_data[120:nrow(polio_data),1]
predict(mod1t,yfor,test)

#Autoregressive Conditional Poisson Model without explaning covariates
polio_data&lt;-data.frame(polio)
mod2 &lt;- acp(polio~-1,data=polio_data, p = 3 ,q = 1)
summary(mod2)

#Poisson Model with explaning covariates
polio_data&lt;-data.frame(polio, trend , cos12, sin12, cos6, sin6)
mod3 &lt;- acp(polio~trend+cos12+sin12+cos6+sin6,data=polio_data,family="poisson")
summary(mod3)

#Default method for ACP regression
X&lt;-cbind(trend , cos12, sin12, cos6, sin6)
mod4&lt;-acp(X,polio,3,1,startval=NULL,varopt=TRUE)
print(mod4)
summary(mod4)
residuals(mod4)
mod4$vcov
mod4$AIC
mod4$BIC
</code></pre>

<hr>
<h2 id='Berkowitz'>Berkowitz test</h2><span id='topic+Berkowitz'></span>

<h3>Description</h3>

<p>Implements Berkowitz test (2001) for density evaluation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Berkowitz(ydata, yhatdata, rep, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Berkowitz_+3A_ydata">ydata</code></td>
<td>
<p> a data frame containing the real values of the dependent varible. </p>
</td></tr>
<tr><td><code id="Berkowitz_+3A_yhatdata">yhatdata</code></td>
<td>
<p> a data frame containing the fitted values of the dependent varible. </p>
</td></tr>
<tr><td><code id="Berkowitz_+3A_rep">rep</code></td>
<td>
<p> number of uniform distirbution drawings. </p>
</td></tr>
<tr><td><code id="Berkowitz_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Diebold et al. (1998) proposed a density evaluation method which consists in computing the sequence of cumulative probability
of the observed counts under the assumed forecast distribution (Probability Transform Integral-PIT). If the density fit is adequate this sequence will be uniformly distributed and will have no-autocorrelation 
left neither in level nor when raised to integer powers. For this purpose intuitive graphical methods such as correlograms on the basis of the usual Bartlett confidence intervals, histograms and quantile-quantile (QQ) plots
are used. In the case of discrete data Heinen et al. (2007) propose the use of a uniform zero-one continued extension as suggested by Denuit and Lambert (2005). 
Finally instead of using graphical tools for detecting uniformity and independence, Berkowitz (2001) applied a formal test for normality and independence of the inverse standard cumulative normal transform of the PIT sequence 
through the estimation of an AR(1) specification and the use of an LR test to the coefficients. 
</p>


<h3>Value</h3>

<p>P-value of the Likelihood Ratio test statistic based on the chi-square distribution with 3 degress of freedom.
</p>


<h3>Author(s)</h3>

<p>Siakoulis Vasileios</p>


<h3>References</h3>


<ul>
<li> <p>Berkowitz, J., 2001. Testing density forecasts with applications to risk management. American Statistical Association.Journal of Business and Economics Statistics, 19, 4.
</p>
</li>
<li> <p>Denuit , M., and Lambert, P., 2005. Constraints on concordance measures in bivariate discrete data. Journal of Multivariate Analysis, 93, 40-57.
</p>
</li>
<li> <p>Diebold, F., Gunther, T., and Tay, A., 1998. Evaluating density forecasts with applications financial to risk management. International Economic Review,39, 4, 863-883.  
</p>
</li>
<li> <p>Heinen,A., Rengifo, E., 2007. Multivariate autoregressive modeling of time series count data using copulas. Journal of empirical finance 14 (2007) 564-583.
</p>
</li></ul>
 


<h3>Examples</h3>

<pre><code class='language-R'>
data(polio)

#Create time trend and seasonality variables
trend=(1:168/168)
cos12=cos((2*pi*(1:168))/12)
sin12=sin((2*pi*(1:168))/12)
cos6=cos((2*pi*(1:168))/6)
sin6=sin((2*pi*(1:168))/6)

polio_data&lt;-data.frame(polio, trend , cos12, sin12, cos6, sin6)
mod1 &lt;- acp(polio~-1+trend+cos12+sin12+cos6+sin6,data=polio_data, p = 1 ,q = 2)
summary(mod1)
Berkowitz(polio_data[[1]],fitted(mod1),50)
</code></pre>

<hr>
<h2 id='evaluation'>acp Evaluation</h2><span id='topic+evaluation'></span>

<h3>Description</h3>

<p>Evaluation of an acp regression model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluation(ydata, yhatdata,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluation_+3A_ydata">ydata</code></td>
<td>
<p> a data frame containing the real values of the dependent varible. </p>
</td></tr>
<tr><td><code id="evaluation_+3A_yhatdata">yhatdata</code></td>
<td>
<p> a data frame containing the fitted values of the dependent varible. </p>
</td></tr>
<tr><td><code id="evaluation_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Diebold et al. (1998) proposed a density evaluation method which consists in computing the sequence of cumulative probability
of the observed counts under the assumed forecast distribution (Probability Transform Integral-PIT). If the density fit is adequate this sequence will be uniformly distributed and will have no-autocorrelation 
left neither in level nor when raised to integer powers. For this purpose intuitive graphical methods such as correlograms on the basis of the usual Bartlett confidence intervals, histograms and quantile-quantile (QQ) plots
are used. In the case of discrete data Heinen et al. (2007) propose the use of a uniform zero-one continued extension of the PIT as suggested by Denuit and Lambert (2005). 
</p>


<h3>Value</h3>

<p>A group of scores for count model evaluation proposed by Czado et al (2009) along with a series of evaluation plots. 
More precisely the measures calculated are logarithmic score, quadratic score, spherical score, ranked probability score, 
Dawid-Sebastiani score, squared error score, mean absolute error score and root squared error score. Relatively to the
graphical evaluation, sub-plot 1 depicts the predicted relatively to the real values, sub-plot 2 the non-randomized PIT histogram
(Czado et al, 2009), sub-plots 3 and 4 the first two powers of the demeaned randomized PIT and sub-plots 5 to 7 the first
three powers of the Pearson standardized residuals. 
</p>


<h3>Author(s)</h3>

<p>Siakoulis Vasileios</p>


<h3>References</h3>


<ul>
<li> <p>Czado,C., Erhardt, V., Min, A., and Wagner, S., 2007. Zero-inflated generalized Poisson models with regression effects on the mean,dispersion and zero-inflation level applied to patent outsourcing rates. Statistical Modelling, 2007, 125.
</p>
</li>
<li> <p>Denuit , M., and Lambert, P., 2005. Constraints on concordance measures in bivariate discrete data. Journal of Multivariate Analysis, 93, 40-57.
</p>
</li>
<li> <p>Diebold, F., Gunther, T., and Tay, A., 1998. Evaluating density forecasts with applications financial to risk management. International Economic Review,39, 4, 863-883.
</p>
</li>
<li> <p>Heinen,A., Rengifo, E., 2007. Multivariate autoregressive modeling of time series count data using copulas. Journal of empirical finance 14 (2007) 564-583.
</p>
</li></ul>
 


<h3>Examples</h3>

<pre><code class='language-R'>
data(polio)

#Create time trend and seasonality variables
trend=(1:168/168)
cos12=cos((2*pi*(1:168))/12)
sin12=sin((2*pi*(1:168))/12)
cos6=cos((2*pi*(1:168))/6)
sin6=sin((2*pi*(1:168))/6)
polio_data&lt;-data.frame(polio, trend , cos12, sin12, cos6, sin6)

mod1 &lt;- acp(polio~-1+trend+cos12+sin12+cos6+sin6,data=polio_data, p = 1 ,q = 2)
summary(mod1)
evaluation(polio_data[[1]],fitted(mod1))
</code></pre>

<hr>
<h2 id='polio'>
Polio cases in USA from Jan 1970 till Dec 1983
</h2><span id='topic+polio'></span>

<h3>Description</h3>

<p>The data set contains the monthly number of cases of poliomyelitis in the United States between 1970 and 1983.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(polio)</code></pre>


<h3>Format</h3>

<p>The dataset consists of one variable of 168 monthly observations.
</p>

<dl>
<dt><code>polio</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Zeger, S. A Regression Model for Time Series of Counts. Biometrica, Vol. 75, No 4 (Dec., 1988), pp. 621-629  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(polio)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
