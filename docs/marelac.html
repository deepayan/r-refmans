<!DOCTYPE html><html lang="en"><head><title>Help for package marelac</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {marelac}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#marelac-package'><p>Tools for Aquatic Sciences</p></a></li>
<li><a href='#air_density'><p>Air Density</p></a></li>
<li><a href='#air_spechum'><p>Air specific humidity</p></a></li>
<li><a href='#atmComp'><p>Atmospheric Gas Composition</p></a></li>
<li><a href='#AtomicWeight'><p>The Atomic Weights of Chemical Elements</p></a></li>
<li><a href='#Bathymetry'><p>World Bathymetric Data</p></a></li>
<li><a href='#Constants'><p>Useful Physical and Chemical Constants</p></a></li>
<li><a href='#convert_p'><p>Conversion Between Different Barometric Units</p></a></li>
<li><a href='#convert_RtoS'><p>Conductivity-Salinity Conversion</p></a></li>
<li><a href='#convert_salinity'><p>Practical - Absolute Salinity Conversions</p></a></li>
<li><a href='#convert_StoCl'><p>Salinity-Chlorinity Conversion</p></a></li>
<li><a href='#convert_StoR'><p>Salinity-Conductivity Conversion</p></a></li>
<li><a href='#convert_T'><p>Conversion Between Different Temperature Units</p></a></li>
<li><a href='#coriolis'><p>The Coriolis Force as a Function of Latitude</p></a></li>
<li><a href='#diffcoeff'><p>Molecular Diffusion Coefficients</p></a></li>
<li><a href='#earth_surf'><p>Surface of 1 dg by 1 dg Cells of the Earth</p></a></li>
<li><a href='#gas_O2sat'><p>Saturation Concentration of Oxygen in Water</p></a></li>
<li><a href='#gas_satconc'><p>Saturated Concentrations of Gases in Water</p></a></li>
<li><a href='#gas_schmidt'><p>The Schmidt Number for Gases in Seawater</p></a></li>
<li><a href='#gas_solubility'>
<p>Solubility Parameters</p></a></li>
<li><a href='#gas_transfer'><p>The Gas Transfer Coefficient in m/sec</p></a></li>
<li><a href='#gravity'><p>Gravity on Earth</p></a></li>
<li><a href='#marelac-internal'><p>Internal Functions of the marelac Package</p></a></li>
<li><a href='#molvol'><p>Mol to Liter Conversion for a Gas</p></a></li>
<li><a href='#molweight'><p>Molecular Weight of a Chemical Species</p></a></li>
<li><a href='#Oceans'><p>Useful Characteristics of the Oceans</p></a></li>
<li><a href='#redfield'><p>Redfield Ratio Calculator</p></a></li>
<li><a href='#ssd2rad'><p>Estimate Global Radiation from Measured Sunshine Duration Time</p></a></li>
<li><a href='#sw_adtgrad'><p>Adiabatic Temperature Gradient in Seawater</p></a></li>
<li><a href='#sw_alpha'><p>Thermal Expansion Coefficient of Seawater</p></a></li>
<li><a href='#sw_beta'><p>Haline Contraction Coefficient of Seawater</p></a></li>
<li><a href='#sw_comp'><p>Reference Sea Salt Composition</p></a></li>
<li><a href='#sw_conserv'><p>Concentrations of (Conservative) Species in Seawater</p></a></li>
<li><a href='#sw_cp'><p>Heat Capacity of Sea Water</p></a></li>
<li><a href='#sw_dens'><p>Density of Sea Water</p></a></li>
<li><a href='#sw_depth'><p>Water Depth</p></a></li>
<li><a href='#sw_enthalpy'><p>Specific Enthalpy of Seawater</p></a></li>
<li><a href='#sw_entropy'><p>Specific Entropy of Seawater</p></a></li>
<li><a href='#sw_gibbs'><p>Gibbs Function of Seawater</p></a></li>
<li><a href='#sw_kappa'><p>Isentropic Compressibility of Seawater</p></a></li>
<li><a href='#sw_kappa_t'><p>Isothermal Compressibility of Seawater</p></a></li>
<li><a href='#sw_sfac'><p>Salinity conversion factors</p></a></li>
<li><a href='#sw_svel'><p>Velocity of the Sound in Seawater</p></a></li>
<li><a href='#sw_tfreeze'><p>Freezing Temperature of Seawater</p></a></li>
<li><a href='#sw_tpot'><p>Potential Temperature of Seawater</p></a></li>
<li><a href='#vapor'><p>Saturation Water Vapor Pressure</p></a></li>
<li><a href='#vapor.hPa'><p>Vapor Pressure</p></a></li>
<li><a href='#vertmean'>
<p>Vertical Volume Weighted Mean of Matter Concentrations in Water</p>
Bodies</a></li>
<li><a href='#viscosity'><p>Shear Viscosity of Water</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.1.11</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Aquatic Sciences</td>
</tr>
<tr>
<td>Author:</td>
<td>Karline Soetaert [aut, cre],
  Thomas Petzoldt [aut],
  Filip Meysman [cph],
  Lorenz Meire [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2), shape</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, seacarb</td>
</tr>
<tr>
<td>Description:</td>
<td>Datasets, constants, conversion factors, and utilities for 'MArine', 'Riverine',
             'Estuarine', 'LAcustrine' and 'Coastal' science. 
             The package contains among others: (1) chemical and
             physical constants and datasets, e.g. atomic weights, gas
             constants, the earths bathymetry; (2) conversion factors
             (e.g. gram to mol to liter, barometric units,
             temperature, salinity); (3) physical functions, e.g. to
             estimate concentrations of conservative substances, gas
             transfer and diffusion coefficients, the Coriolis force
             and gravity; (4) thermophysical properties of the
             seawater, as from the UNESCO polynomial or from the more
             recent derivation based on a Gibbs function.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-25 10:04:59 UTC; karlines</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-25 12:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='marelac-package'>Tools for Aquatic Sciences</h2><span id='topic+marelac-package'></span><span id='topic+marelac'></span>

<h3>Description</h3>

<p>R-package marelac has been designed as a tool for use by scientists
working in the MArine, Riverine, Estuarine, LAcustrine and Coastal
sciences.
</p>
<p>It contains:
</p>

<ul>
<li><p> chemical and physical constants, e.g. atomic weights, gas constants.
</p>
</li>
<li><p> conversion factors, e.g. from salinity to chlorinity, from mol to gram,
etc.,
</p>
</li>
<li><p> utility functions, e.g. to estimate concentrations of conservative
substances as a function of salinity, ...
</p>
</li></ul>

<p>About the symbols used.
</p>
<p>Here we adopt the symbolism as in McDougall et al., 2009:
</p>

<ul>
<li><p> S for practical (-) or absolute salinity, (g/kg)
</p>
</li>
<li><p> P for absolute (total) pressure (bar)
</p>
</li>
<li><p> p for sea pressure (also called gauge or applied pressure (bar), the
pressure relative to P0, one standard atmosphere (=1.01325 bar)
</p>
</li>
<li><p> t for temperature in <code class="reqn">^\circ</code>C
</p>
</li>
<li><p> T for absolute temperature, in <code class="reqn">^\circ</code>K; T = t + 273.15
</p>
</li></ul>

<p>Many of the functions are from the UNESCO 1983 paper, or from Feistel, 2008.
Note that in these papers, pressure is expressed in dbar.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert (Maintainer)
</p>
<p>Thomas Petzoldt
</p>
<p>with contributions from Lorenz Meire and Filip Meysman
</p>


<h3>References</h3>

<p>For solubilities, atmospheric composition, gas exchange coefficients:
</p>
<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>For diffusion coefficients, viscosity
</p>
<p>Boudreau BP, 1996.  A method-of-lines code for carbon and nutrient
diagenesis in aquatic sediments.  Computers &amp; Geosciences 22 (5),
479-496.
</p>
<p>For many other fundamental properties of seawater, either the UNESCO
report (1983):
</p>
<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>
<p>or the more recent report and papers:
</p>
<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>
<p>Millero FJ, Feistel R, Wright DG, and McDougall TJ, 2008.
The composition of Standard Seawater and the definition of the
Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.
</p>


<h3>See Also</h3>

<p>for seawater properties:
</p>
<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p>for atmospheric gasses:
</p>
<p><code><a href="#topic+gas_satconc">gas_satconc</a></code>, <code><a href="#topic+gas_O2sat">gas_O2sat</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>, <code><a href="#topic+gas_transfer">gas_transfer</a></code>,
<code><a href="#topic+atmComp">atmComp</a></code>, <code><a href="#topic+vapor">vapor</a></code>, <code><a href="#topic+air_spechum">air_spechum</a></code>,
<code><a href="#topic+air_density">air_density</a></code>
</p>
<p>conversions:
</p>
<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_RtoS">convert_RtoS</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>, <code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>, <code><a href="#topic+convert_T">convert_T</a></code>
</p>
<p>datasets:
</p>
<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+Bathymetry">Bathymetry</a></code>,
<code><a href="#topic+Constants">Constants</a></code>, <code><a href="#topic+Oceans">Oceans</a></code>
</p>
<p>physical properties:
</p>
<p><code><a href="#topic+earth_surf">earth_surf</a></code>, <code><a href="#topic+coriolis">coriolis</a></code>, <code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+ssd2rad">ssd2rad</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>
<p>molecular properties:
</p>
<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+molvol">molvol</a></code>, <code><a href="#topic+molweight">molweight</a></code>,
<code><a href="#topic+redfield">redfield</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## show examples (see respective help pages for details)
example(Constants)
example(molvol)

## open the directory with documents
browseURL(paste(system.file(package="marelac"), "/doc", sep=""))


## End(Not run)
</code></pre>

<hr>
<h2 id='air_density'>Air Density</h2><span id='topic+air_density'></span>

<h3>Description</h3>

<p>The density of the air, in kg/m3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>air_density(t = 25, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="air_density_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C.</p>
</td></tr>
<tr><td><code id="air_density_+3A_p">P</code></td>
<td>
<p>True pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The air density, in kg/m3
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;,
Lorenz Meire &lt;lorenz.meire@nioz.nl&gt;</p>


<h3>References</h3>

<p><a href="http://www.cactus2000.de/uk/unit/masshum.shtml">http://www.cactus2000.de/uk/unit/masshum.shtml</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vapor">vapor</a></code>, <code><a href="#topic+air_spechum">air_spechum</a></code>,
<code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+gas_transfer">gas_transfer</a></code>, <code><a href="#topic+atmComp">atmComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>air_density(t = 25) # 1.183894
plot(0:30, air_density(t = 0:30), xlab = "Temperature, dgC", ylab = "kg/m3")
plot(x= seq(0.8,1.2, 0.01), y = air_density(P = seq(0.8,1.2, 0.01)),
     xlab = "pressure, bar", ylab = "kg/m3")
</code></pre>

<hr>
<h2 id='air_spechum'>Air specific humidity</h2><span id='topic+air_spechum'></span>

<h3>Description</h3>

<p>The specific humidity of air (mass mixing ratio in wet air), in kg/kg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>air_spechum(t = 25, rh = 50, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="air_spechum_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C.</p>
</td></tr>
<tr><td><code id="air_spechum_+3A_rh">rh</code></td>
<td>
<p>Relative humidity, %</p>
</td></tr>
<tr><td><code id="air_spechum_+3A_p">P</code></td>
<td>
<p>True pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The specific humidity, in kg/kg.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;,
Lorenz Meire &lt;lorenz.meire@nioz.nl&gt;</p>


<h3>References</h3>

<p>Lowe, P.R. and J.M. Ficke, 1974: The computation of saturation vapor pressure. Tech.
Paper No. 4-74, Environmental Prediction Research Facility, Naval Postgraduate School,
Monterey, CA, 27 pp.
</p>
<p><a href="http://www.cactus2000.de/uk/unit/masshum.shtml">http://www.cactus2000.de/uk/unit/masshum.shtml</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vapor">vapor</a></code>, <code><a href="#topic+air_density">air_density</a></code>,
<code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+gas_transfer">gas_transfer</a></code>, <code><a href="#topic+atmComp">atmComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>air_spechum(t = 25, rh = 50)*1000     # 9.7778
plot(0:30, air_spechum(t = 0:30), xlab = "Temperature, dgC", ylab = "kg/kg")
plot(0:100, air_spechum(rh = 0:100), xlab = "percent humidity", ylab = "kg/kg")
</code></pre>

<hr>
<h2 id='atmComp'>Atmospheric Gas Composition</h2><span id='topic+atmComp'></span>

<h3>Description</h3>

<p>Provides the global average atmospheric composition at present day conditions
(year 1998). The mixing ratio is generally defined as the ratio of the mass
of an atmospheric constituent to the total mass of dry air. If not otherwise
indicated, the term mixing ratio normally refers to water vapor. Here however
the mixing ratio is provided for all constituents other than water. The mixing
ratio is given as a mole fraction, i.e. the mass of each constituent gas
(expressed in moles) divided by the total mass of dry air (also expressed
in moles).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atmComp(species = c("He", "Ne", "N2", "O2", "Ar", "Kr", "CH4", "CO2",
  "N2O", "H2", "Xe", "CO", "O3"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="atmComp_+3A_species">species</code></td>
<td>
<p>character vector selecting the gases whose composition should be
provided.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector providing the mixing ratio of the selected gases.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;, Filip Meysman &lt;filip.meysman@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>They cite Weast
and Astle (1982) for all gasses except CO2, CH4 and N2O. For the latter
three greenhouse gases, the 1998 concentrations are taken from Ramaswamy
et al., 2001. Note that the sum of all mixing ratios is slightly larger
than one, presumably due to the use of increased greenhouse gases values
as compared to Weast and Astle (1982). In fact, the mixing ratio are
changing slightly each year due to increases in greenhouse gas
concentrations.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+gas_transfer">gas_transfer</a></code>, <code><a href="#topic+vapor">vapor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>atmComp("O2")
atmComp(c("O2", "CH4", "CO2", "N2O"))
atmComp()
sum(atmComp()) # note this is not =1!
</code></pre>

<hr>
<h2 id='AtomicWeight'>The Atomic Weights of Chemical Elements</h2><span id='topic+AtomicWeight'></span><span id='topic+atomicweight'></span>

<h3>Description</h3>

<p>Atomic weights of chemical elements according to the IUPAC table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AtomicWeight
atomicweight
</code></pre>


<h3>Format</h3>

<p>The capitalized version <code>AtomicWeight</code> is a data frame containing
the IUPAC table of atomic weights.
This data frame has following colums: Number, Name,
Symbol, Weight, Footnotes.
</p>
<p>Note that as in the IUPAC table, the Weight is
given as a text rather than as numeric objects. It comprises the standard
values and the uncertainties (in parentheses, following the last significant
figure to which they are attributed).
See IUPAC report for explanation of the Footnotes.
</p>
<p>The lower case version <code>atomicweight</code> is a simplified list that only
contains the weights (as numeric values) and allows symbolic
computations with elements to arrive at molecular weights.
</p>


<h3>Details</h3>

<p>Molecular weights of chemical elements may vary due to different isotope
compositions, depending on geology, industrial processes or biological activity.
Please consult the IUPAC Technical report about the details.
The data set contains <code>NA</code> for elements that have no stable isotopes
(except U, Th, Pa).
</p>


<h3>Author(s)</h3>

<p>Thomas Petzoldt</p>


<h3>References</h3>

<p>Wieser ME, 2006. Atomic weights of the elements 2005 (IUPAC
Technical Report). Pure Appl. Chem. 78 (11), 2051&ndash;2066.,
2006. DOI: 10.1351/pac200678112051
</p>


<h3>See Also</h3>

<p>other datasets:  <code><a href="#topic+Bathymetry">Bathymetry</a></code>,
<code><a href="#topic+Constants">Constants</a></code>, <code><a href="#topic+Oceans">Oceans</a></code>,
</p>
<p><code><a href="#topic+molweight">molweight</a></code> for molecular weight calculations with
molecular formulae.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## assess the data in the IUPAC table (with all footnotes)
AtomicWeight[1:20,]
AtomicWeight[AtomicWeight$Symbol == "C",]

## use the lower case version for simple calculations:
atomicweight$C
with(atomicweight, C)

## it can also be used to calculate molecular weights
## via symbolic computation
with(atomicweight, H * 2 + O)
</code></pre>

<hr>
<h2 id='Bathymetry'>World Bathymetric Data</h2><span id='topic+Bathymetry'></span>

<h3>Description</h3>

<p>This dataset contains the elevation of sea (bathymetry) and land
(hypsometry) across the globe at 1 degree intervals. Dataset as used
by Andersson et al. (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bathymetry</code></pre>


<h3>Format</h3>

  
<p>A list with the bathymetry (depth) and hypsometry (altitude) of the
world.  It contains:
</p>

<dl>
<dt>x</dt><dd><p>the latitude,</p>
</dd>
<dt>y</dt><dd><p>the longitude,</p>
</dd>
<dt>z</dt><dd><p>the height (m).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Andersson H, Wijsman J, Herman PMJ, Middelburg J, Soetaert K and Heip
C, 2004. Respiration patterns in the deep ocean.  Geophysical Research
Letters 31, LO3304.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar = c(2,2,2,2))
image(Bathymetry$x, Bathymetry$y, Bathymetry$z, col = femmecol(100),
      asp = TRUE, xlab = "dg", ylab = "dg")
contour(Bathymetry$x, Bathymetry$y, Bathymetry$z, asp = TRUE, add = TRUE)


# remove land
zz       &lt;- Bathymetry$z
zz[zz&gt;0] &lt;- 0

image(Bathymetry$x, Bathymetry$y, zz, col = c(femmecol(100), "black"),
      asp = TRUE)
contour(Bathymetry$x, Bathymetry$y, zz, asp = TRUE, add = TRUE)
</code></pre>

<hr>
<h2 id='Constants'>Useful Physical and Chemical Constants</h2><span id='topic+Constants'></span>

<h3>Description</h3>

<p>Physical and chemical constants useful for aquatic sciences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Constants</code></pre>


<h3>Format</h3>

<p>A list specifying the value, the units, and a description for each
physical constant.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Mohr PJ and Taylor BN, 2005.
CODATA recommended values of the fundamental physical constants: 2002,
Review of Modern Physics 77, 1 - 107.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+Bathymetry">Bathymetry</a></code>,
<code><a href="#topic+Oceans">Oceans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.frame(cbind(acronym = names(Constants),
           matrix(ncol = 3, byrow = TRUE, data = unlist(Constants),
           dimnames = list(NULL, c("value", "units", "description")))))
</code></pre>

<hr>
<h2 id='convert_p'>Conversion Between Different Barometric Units</h2><span id='topic+convert_p'></span>

<h3>Description</h3>

<p>The function converts between different units of pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_p(x, unit = c("Pa", "bar", "at", "atm", "torr"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_p_+3A_x">x</code></td>
<td>
<p>vector of given pressure values,</p>
</td></tr>
<tr><td><code id="convert_p_+3A_unit">unit</code></td>
<td>
<p>measurement unit of the given value(s).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with converted values.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Bar_(unit)">https://en.wikipedia.org/wiki/Bar_(unit)</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_RtoS">convert_RtoS</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>, <code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_T">convert_T</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_p(1, "atm")
convert_p(c(2, 3, 4.5), "bar")

convert_p(1, "atm")$Pa

</code></pre>

<hr>
<h2 id='convert_RtoS'>Conductivity-Salinity Conversion</h2><span id='topic+convert_RtoS'></span>

<h3>Description</h3>

 
<p>Estimates the salinity of seawater from conductivity, temperature and
pressure. The equation is valid over ranges: temperature from -2 to 35
<code class="reqn">^\circ</code>C, pressure from 0 to 1000 bar, and salinity
from 2 to 42.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_RtoS(R = 1, t = 25, p = max(0, P-1.013253), P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_RtoS_+3A_r">R</code></td>
<td>
<p>Conductivity ratio, the conductivity at (S, t, P) divided
by the conductivity at S = 35, t = 15, p = 0 [-]</p>
</td></tr>
<tr><td><code id="convert_RtoS_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C</p>
</td></tr>
<tr><td><code id="convert_RtoS_+3A_p">p</code></td>
<td>
<p>Gauge (or applied) pressure, the pressure referenced against the local
atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="convert_RtoS_+3A_p">P</code></td>
<td>
<p>True pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The salinity.
</p>


<h3>Note</h3>

<p>The conductivity ratio for Salinity = 40.0000, t = 40, p = 1000 is
1.888091.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>, <code><a href="#topic+convert_T">convert_T</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_RtoS(R = 1.888091, t = 40, p = 1000)

## Salinity = 40.0000, t = 40, p = 1000, cond = 1.888091
convert_RtoS(R = 1, t = 15, p = 0)

## Check values
convert_RtoS(R = 0.6990725, t = 10, p = 0)  # 26.8609
convert_RtoS(R = 0.6990725, t = 10, p = 100)  # 26.5072
convert_RtoS(R = 1.1651206, t = 20, p = 100)  # 36.3576

</code></pre>

<hr>
<h2 id='convert_salinity'>Practical - Absolute Salinity Conversions</h2><span id='topic+convert_PStoAS'></span><span id='topic+convert_AStoPS'></span>

<h3>Description</h3>

<p>Conversion from practical to absolute salinity and vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_PStoAS(S = 35, p = max(0, P - 1.013253), P = 1.013253,
  lat = NULL, lon = NULL, DSi = NULL,
  Ocean = c("Global", "Atlantic", "Pacific", "Indian", "Southern"))

convert_AStoPS(S = 35, p = max(0, P - 1.013253), P = 1.013253,
  lat = NULL, lon = NULL, DSi = NULL,
   Ocean = c("Global","Atlantic","Pacific","Indian","Southern"))

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_salinity_+3A_s">S</code></td>
<td>
<p>Salinity, either practical salinity (<code>convert_PStoAS</code>),
dimensionless or absolute salinity (<code>convert_AStoPS</code>, g/kg)
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_p">P</code></td>
<td>
<p>true pressure, bar
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_lat">lat</code></td>
<td>
<p>latitude (-90 to +90)
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_lon">lon</code></td>
<td>
<p>longitude (0 to 360)
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_dsi">DSi</code></td>
<td>
<p>the silicate concentration, in micromol/kg
</p>
</td></tr>
<tr><td><code id="convert_salinity_+3A_ocean">Ocean</code></td>
<td>
<p>the ocean in which the measurement was taken; only
used if <code>DSi</code> is not <code>NULL</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Absolute salinity (g kg-1) is estimated from Practical salinity as:
</p>
<p>AS= 35.16504 /35 * PS + delt()
</p>
<p>where delt is the absolute salinity anomaly. There are two ways in which to
estimate the salinity anomaly
</p>
<p>1. If DSi is not given a value, then the anomaly is estimated as a function of
longitude <code>lon</code>, latitude <code>lat</code> and pressure <code>p</code>, using the
lookup table as in <code>sw_sfac</code>.
</p>
<p>2. If <code>DSi</code> is given a value, then a regression on it is used, based on the
values of <code>Ocean</code> and -except for the &quot;global&quot; ocean- the latitute
<code>lat</code>:
</p>

<dl>
<dt>&quot;Global&quot;</dt><dd><p>a global estimate is used,
</p>
<p>delt= 9.824e-5 *DSi, </p>
</dd>
<dt>&quot;Southern&quot;</dt><dd><p>the Southern Ocean (<code>lat</code> &lt; -30),
</p>
<p>delt= 7.4884e-5 *DSi, </p>
</dd>
<dt>&quot;Pacific&quot;</dt><dd><p>the Pacific Ocean ,
</p>
<p>delt= 7.4884e-5 *(1 + 0.3622[<code>lat</code>/30 + 1])*DSi, </p>
</dd>
<dt>&quot;Indian&quot;</dt><dd><p>the Indian Ocean ,
</p>
<p>delt= 7.4884e-5 *(1 + 0.3861[<code>lat</code>/30 + 1])*DSi, </p>
</dd>
<dt>&quot;Atlantic&quot;</dt><dd><p>the Atlantic Ocean ,
</p>
<p>delt= 7.4884e-5 *(1 + 1.0028[<code>lat</code>/30 + 1])*DSi, </p>
</dd>
</dl>

<p>Note that for the Pacific, Indian and Atlantic Ocean regression,
the latitude is needed. If <code>lat</code> is <code>NULL</code> then the <code>Global</code>
regression will be used.
</p>


<h3>Value</h3>

<p>The absolute salinity (<code>convert_PStoAS</code>) or practical salinity
(<code>convert_AStoPS</code>).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Millero FJ, Feistel R, Wright DG and McDougall TJ, 2008.
The composition of Standard Seawater and the definition of the
Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.
</p>
<p>McDougall TJ, Jackett DR and Millero FJ, 2009. An algorithm
for estimating Absolute Salinity in the global ocean. Ocean Science
Discussions 6, 215-242.
<a href="http://www.ocean-sci-discuss.net/6/215/2009/">http://www.ocean-sci-discuss.net/6/215/2009/</a>
</p>
<p>Uses the Fortran code written by David Jackett.
<a href="http://www.teos-10.org/">http://www.teos-10.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_RtoS">convert_RtoS</a></code>, <code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>, <code><a href="#topic+convert_T">convert_T</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># check values: should be 35.7
convert_PStoAS(S = 35.52764437773386, p = 102.3, lon = 201, lat = -21)

# check values: should be 35.52764437773386
convert_AStoPS(S = 35.7, p = 102.3, lon = 201, lat = -21)

#
convert_PStoAS(S = 35)
convert_AStoPS(S = 35)
convert_PStoAS(S = 35, lat = 10, lon = 10, p = 0)

# Based on Si concentration
DSi &lt;- seq(from = 0, to = 200, by = 10)
Global   &lt;-  convert_PStoAS(30, DSi = DSi, Ocean = "Global")
Atlantic &lt;-  convert_PStoAS(30, DSi = DSi, Ocean = "Atlantic", lat = 0)
Pacific  &lt;-  convert_PStoAS(30, DSi = DSi, Ocean = "Pacific", lat = 0)
Indian   &lt;-  convert_PStoAS(30, DSi = DSi, Ocean = "Indian", lat = 0)
Southern &lt;-  convert_PStoAS(30, DSi = DSi, Ocean = "Southern")

matplot(x = DSi, y = cbind(Global, Atlantic, Pacific, Indian, Southern),
  pch = 1, xlab = "DSi, micromol/kg", ylab = "Absolute salinity (PS=30)")
legend("topleft",c("Global", "Atlantic", "Pacific", "Indian", "Southern"),
       col = 1:5, pch = 1)
</code></pre>

<hr>
<h2 id='convert_StoCl'>Salinity-Chlorinity Conversion</h2><span id='topic+convert_StoCl'></span>

<h3>Description</h3>

<p>Estimates the chlorinity concentration based on salinity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_StoCl(S = 35)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_StoCl_+3A_s">S</code></td>
<td>
<p>salinity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The chlorinity concentration, g/kg
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Cox RA, Culkin F, Riley JP, 1967. The electrical
conductivity &ndash; chlorinity relationship in natural seawater.
Deep&ndash;Sea Research 14, 203&ndash;220.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_RtoS">convert_RtoS</a></code>, <code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>, <code><a href="#topic+convert_T">convert_T</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_StoCl(20)
</code></pre>

<hr>
<h2 id='convert_StoR'>Salinity-Conductivity Conversion</h2><span id='topic+convert_StoR'></span>

<h3>Description</h3>

<p>Estimates the conductivity ratio from salinity, temperature and
pressure.
</p>
<p>The equation is valid over ranges of temperature from -2 to 35
<code class="reqn">^\circ</code>C, pressure of 0 - 1000 bar and salinity 2-42
in the world ocean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_StoR(S = 35, t = 25, p = max(0, P-1.013253), P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_StoR_+3A_s">S</code></td>
<td>
<p>(practical) Salinity, -,</p>
</td></tr>
<tr><td><code id="convert_StoR_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="convert_StoR_+3A_p">P</code></td>
<td>
<p>True Pressure, bar,</p>
</td></tr>
<tr><td><code id="convert_StoR_+3A_p">p</code></td>
<td>
<p>Gauge (or applied) pressure, the pressure referenced against the local
atmospheric pressure, bar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The conductivity ratio (-), this is the conductivity at (S, t, p),
divided by the conductivity at S = 35, t = 15, p = 0.
</p>


<h3>Note</h3>

<p>Pressure here is true pressure, 1 bar (at sea surface), in contrast to
hydrostatic pressure in dbar of original formula.
</p>
<p>The conductivity ratio for Salinity = 40, t = 40, <code>p</code> =
1000 is 1.888091.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_RtoS">convert_RtoS</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>, <code><a href="#topic+convert_T">convert_T</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_StoR(S = 40, t = 40, p = 1000)

convert_StoR(S = 35, t = 15, p = 0)

# Check values:
convert_StoR(S = 25, t = 10, p = 0)    #  0.654990
convert_StoR(S = 25, t = 10, p = 100)  #  0.662975
convert_StoR(S = 25, t = 10, p = 1000) #  0.712912

convert_StoR(S = 35, t = 10, p = 100) #  0.897778
convert_StoR(S = 40, t = 10, p = 100) #  1.011334

</code></pre>

<hr>
<h2 id='convert_T'>Conversion Between Different Temperature Units</h2><span id='topic+convert_T'></span>

<h3>Description</h3>

<p>The function converts between different units of temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_T(x, unit = c("K", "C", "F"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_T_+3A_x">x</code></td>
<td>
<p>Vector of given temperature values,
</p>
</td></tr>
<tr><td><code id="convert_T_+3A_unit">unit</code></td>
<td>
<p>Measurement unit of the given value(s).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with converted values.
</p>


<h3>References</h3>

<p>Mangum BW and Furukawa GT, 1990. Guidelines for Realizing the
International Temperature Scale of 1990 (ITS-90). NIST Technical Note
1265.
and the url 
</p>
<p>http://www.cstl.nist.gov/div836/836.05/papers/magnum90ITS90guide.pdf
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, <code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>,
<code><a href="#topic+convert_RtoS">convert_RtoS</a></code>, <code><a href="#topic+convert_StoR">convert_StoR</a></code>,
<code><a href="#topic+convert_StoCl">convert_StoCl</a></code>,
<code><a href="#topic+convert_p">convert_p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_T(0, "K")
convert_T(0, "C")
convert_T(0, "F")

convert_T(273.15, "K")
convert_T(-273.15, "C")
convert_T(c(-459.67, 0, 32), "F")

convert_T(32, "F")$C # 0 degrees C

</code></pre>

<hr>
<h2 id='coriolis'>The Coriolis Force as a Function of Latitude</h2><span id='topic+coriolis'></span>

<h3>Description</h3>

<p>Estimates the coriolis factor, f (in <code class="reqn">s^{-1}</code>), where
<code class="reqn">f = 2 \cdot \omega \cdot sin(lat)</code>, where
<code class="reqn">\omega = 7.292e^{-5}</code> radians/sec, the
rotation of the earth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coriolis(lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coriolis_+3A_lat">lat</code></td>
<td>
<p>latitude in degrees north (-90 to +90).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The coriolis factor (<code class="reqn">s^{-1}</code>).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt; karline.soetaert@nioz.nl &gt; </p>


<h3>References</h3>

<p>Pond S and Pickard G, 1986. Introductory Dynamical
Oceanography, Pergamon Press, Sydney, 2nd Ed.
</p>
<p>Griffies SM, 2004. Fundamentals of Ocean Climate Models. Princeton, NJ,
Princeton University Press, 518 pp.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+ssd2rad">ssd2rad</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(-90:90, coriolis(-90:90), xlab = "latitude, dg North", 
  ylab = "/s", main = "coriolis factor", type = "l", lwd = 2)
</code></pre>

<hr>
<h2 id='diffcoeff'>Molecular Diffusion Coefficients</h2><span id='topic+diffcoeff'></span>

<h3>Description</h3>

<p>Calculates the molecular and ionic diffusion coefficients in 
<code class="reqn">m^2 s^{-1}</code>, for several inorganic species in seawater 
at a given salinity, temperature, and pressure.
</p>
<p>Based on Chapter 4 in Boudreau (1997)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diffcoeff(S = 35, t = 25, P = 1.013253,
      species = c("H2O", "O2", "CO2", "H2", "CH4", "DMS",
      "He", "Ne", "Ar", "Kr", "Xe", "Rn",
      "N2", "H2S", "NH3", "NO", "N2O", "CO", "SO2",
      "OH", "F", "Cl", "Br", "I",
      "HCO3", "CO3", "H2PO4", "HPO4", "PO4",
      "HS", "HSO3", "SO3", "HSO4", "SO4", "IO3", "NO2", "NO3",
      "H", "Li", "Na", "K", "Cs","Ag","NH4",
      "Ca", "Mg", "Fe", "Mn", "Ba", "Be", "Cd", "Co",
      "Cu", "Hg", "Ni", "Sr", "Pb", "Ra", "Zn", "Al", "Ce",
      "La", "Pu", "H3PO4", "BOH3", "BOH4", "H4SiO4"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diffcoeff_+3A_s">S</code></td>
<td>
<p>Salinity, -,
</p>
</td></tr>
<tr><td><code id="diffcoeff_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,
</p>
</td></tr>
<tr><td><code id="diffcoeff_+3A_p">P</code></td>
<td>
<p>True pressure, bar,
</p>
</td></tr>
<tr><td><code id="diffcoeff_+3A_species">species</code></td>
<td>
<p>character vector with the names of the chemical species whose
diffusion coefficient should be calculated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To correct for salinity, the Stokes-Einstein relationship is used.
This is not quite accurate, but is at least consistent.
</p>
<p><code class="reqn">H_3PO_4</code> : Least (1984) determined D(H3PO4) at 25 deg C and 0 S.
Assume that this value can be scaled by the Stokes-Einstein
relationship to any other temperature.
</p>
<p><code class="reqn">B(OH)_3</code> : Mackin (1986) determined D(B(OH)3) at 25 deg C and
about 29.2 S. Assume that this value can be scaled by the
Stokes-Einstein relationship to any other temperature.
</p>
<p><code class="reqn">B(OH)_4</code> : No information on this species.  Boudreau and Canfield
(1988) assume it is 12.5% smaller than B(OH)3.
</p>
<p><code class="reqn">H_4SiO_4</code> : Wollast and Garrels (1971) found D(H4SiO4) at 25 deg
C and 36.1 ppt S.  Assume that this value can be scaled by the
Stokes-Einstein relationship to any other temperature.
</p>
<p>Arguments salinity, temperature or pressure can be vectors. In order to avoid 
confusion, S, t and P must have either same length or length 1. More flexible 
combinations are of course possible with <code>expand.grid</code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the diffusion coefficients <code class="reqn">m^2 s^{-1}</code>
of the selected chemical species.
</p>


<h3>Author(s)</h3>

<p>Filip Meysman &lt;filip.meysman@nioz.nl&gt;,
Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Based on Chapter 4 in Boudreau (1997) :
</p>
<p>Boudreau BP, 1997. Diagenetic Models and their Implementation. Modelling
Transport and Reactions in Aquatic Sediments. Springer. Berlin.
</p>
<p>who cites:
</p>
<p>for self-diffusion coefficient H2O:
</p>
<p>Cohen MH and Turnbull D. 1959. Molecular transport in liquids and
glasses.  Journal of chemical physics 31 (5): 1164-1169
</p>
<p>Krynicki K, Green CD and Sawyer DW, 1978.  Pressure and
temperature-dependence of self-diffusion in water.  Faraday
discussions 66: 199-208
</p>
<p>for gases O2 and CO2:
</p>
<p>Novel relation by Boudreau (1997) based on new compilation of data
</p>
<p>for gases He, Ne, Kr, Xe, Rn, H2, CH4:
</p>
<p>Jahne B, Heinz G, and Dietrich W, 1987. Measurements of the
diffusion coefficients of sparingly soluble gases in water.
J. Geophys. Res., 92:10,767-10,776.
</p>
<p>for Ar:
</p>
<p>Ohsumi T and Horibe Y, 1984. Diffusivity of He and Ar in deep-sea sediments,
Earth and Planetary Science Letters 70, 61-68.
</p>
<p>for DMS:
</p>
<p>Saltzman ES, King DB, Holmen K, and Leck C, 1993. Experimental Determination
of the Diffusion Coefficient of Dimethylsulfide in Water, J. Geophys. Res.,
98(C9), 16, 481-486.
</p>
<p>for other gases (N2, H2S, NH3, NO, N2O, CO, SO2):
</p>
<p>Wilke CR and Chang P, 1955. Correlation of diffusion coefficients in
dilute solutions. Aiche journal 1 (2): 264-270
</p>
<p>with the correction proposed by
</p>
<p>Hayduk W and Laudie H, 1974.  Prediction of diffusion-coefficients for
nonelectrolytes in dilute aqueous-solutions. Aiche journal 20 (3):
611-615
</p>
<p>for ions:
</p>
<p>Hayduk W and Laudie H, 1974.  Prediction of diffusion-coefficients for
nonelectrolytes in dilute aqueous-solutions. Aiche journal 20 (3):
611-615
</p>
<p>for H3PO4, B(OH)3, B(OH)4, H4SiO4 : see details
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coriolis">coriolis</a></code>, <code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+ssd2rad">ssd2rad</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>diffcoeff(S = 15, t = 15)*1e4*3600*24         # cm2/day
diffcoeff(t = 10, species = "O2")             # m2/s
difftemp &lt;- diffcoeff(t = 0:30)[,1:13]
matplot(0:30, difftemp, xlab = "temperature", ylab = "m2/s",
        main = "Molecular/ionic diffusion", type = "l",
        col = 1:13, lty = 1:13)
legend("topleft", ncol = 2, cex = 0.8, title = "mean", 
       col = 1:13, lty = 1:13,
       legend = cbind(names(difftemp),
       format(colMeans(difftemp), digits = 4)))

## vector-valued salinity
select &lt;- c("O2", "CO2", "NH3", "NH4", "NO3")
diffsal &lt;- diffcoeff(S = 0:35, species = select)
matplot(0:35, diffsal, xlab = "salinity", ylab = "m2/s",
         main = "Molecular/ionic diffusion", type = "l",
         col = 1:length(select), lty = 1:length(select))
legend("topleft", ncol = 2, cex = 0.8, title = "mean",
       col = 1:length(select), lty = 1:length(select),
       legend = cbind(select, format(colMeans(diffsal), digits = 4)))

## vector-valued temperature
difftemp &lt;- diffcoeff(S = 1, t=1:20, species = select)
matplot(1:20, difftemp, xlab = "temperature", ylab = "m2/s",
        main = "Molecular/ionic diffusion", type = "l",
        col = 1:length(select), lty = 1:length(select))
legend("topleft", ncol = 2, cex = 0.8, title = "mean",
       col = 1:length(select), lty = 1:length(select),
       legend = cbind(select, format(colMeans(difftemp), digits = 4)))

## combination of S and t
diffsaltemp &lt;- diffcoeff(S = rep(c(1, 35), each = 20), 
                         t = rep(1:20, 2), species = select)
       
</code></pre>

<hr>
<h2 id='earth_surf'>Surface of 1 dg by 1 dg Cells of the Earth</h2><span id='topic+earth_surf'></span><span id='topic+earth_dist'></span>

<h3>Description</h3>

<p><code>earth_surf</code> computes the surface of 1d by 1dg grid cells as a function of latitude.
</p>
<p>Based on data that give the surface distance per 1 dg change in lat/lon
from <a href="https://en.wikipedia.org/wiki/Latitude">https://en.wikipedia.org/wiki/Latitude</a>
</p>
<p><code>earth_dist</code> calculates the distance between two (lat, lon) points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>earth_surf(lat = 0, lon = 0)
earth_dist(alat, alon, blat, blon, method = 1) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="earth_surf_+3A_lat">lat</code></td>
<td>
<p>latitude (-90 - +90).</p>
</td></tr>
<tr><td><code id="earth_surf_+3A_lon">lon</code></td>
<td>
<p>longitude - not used. </p>
</td></tr>
<tr><td><code id="earth_surf_+3A_alat">alat</code></td>
<td>
<p>first latitude (-90 - +90).</p>
</td></tr>
<tr><td><code id="earth_surf_+3A_alon">alon</code></td>
<td>
<p>first longitude (-180, 180).</p>
</td></tr>
<tr><td><code id="earth_surf_+3A_blat">blat</code></td>
<td>
<p>second latitude (-90 - +90).</p>
</td></tr>
<tr><td><code id="earth_surf_+3A_blon">blon</code></td>
<td>
<p>second longitude (-180, 180).</p>
</td></tr>
<tr><td><code id="earth_surf_+3A_method">method</code></td>
<td>
<p>an integer indicating the formula to use, either the 
spherical law of cosines (<code>1</code>) or the haversine formula (<code>2</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Surface of the grid cell, in <code class="reqn">m^2</code>.
</p>
<p>Distance between the points (alat, alon), (blat, blon), m.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bathymetry">Bathymetry</a></code>, <code><a href="#topic+Oceans">Oceans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 earth_surf(seq(0, 90, by = 15))

 SURF &lt;- outer(X = Bathymetry$x,
               Y = Bathymetry$y,
               FUN &lt;- function(X, Y) earth_surf(Y, X))

 earth_dist(10, 80, 10, 81)
 earth_dist(20, 80, 20, 81)

 SURF &lt;- outer(X = Bathymetry$x,
               Y = Bathymetry$y,
               FUN &lt;- function(X, Y) earth_surf(Y, X))

 sum(SURF)                                   #is: 510,072,000  km2

# the surface of the Oceans, m2
 sum(SURF*(Bathymetry$z &lt; 0))                  # is: 3.58e14

# the volume of the Oceans, m3
- sum(SURF*Bathymetry$z*(Bathymetry$z &lt; 0))    # is: 1.34e+18

# the surface area at several depths
SurfDepth &lt;- vector()

dseq &lt;- seq(-7500, -250, by = 250)

for (i in 2:length(dseq)) {
  ii &lt;- which (Bathymetry$z &gt; dseq[i-1] &amp; Bathymetry$z &lt;= dseq[i])
  SurfDepth[i-1]&lt;-sum(SURF[ii])
}

plot(dseq[-1], SurfDepth, xlab = "depth, m", log = "y",
     ylab = "m2", main = "Surface at ocean depths")

</code></pre>

<hr>
<h2 id='gas_O2sat'>Saturation Concentration of Oxygen in Water</h2><span id='topic+gas_O2sat'></span>

<h3>Description</h3>

<p>Empirical formulae that can be used to compute saturation
concentration of oxygen in water in <code class="reqn">mg/L</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gas_O2sat(S = 35, t = 25, masl = 0, method = c("Weiss", "APHA", "Paul"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gas_O2sat_+3A_s">S</code></td>
<td>
<p>salinity (dimensionless, for method &quot;Weiss&quot; only),</p>
</td></tr>
<tr><td><code id="gas_O2sat_+3A_t">t</code></td>
<td>
<p>Temperature in <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="gas_O2sat_+3A_masl">masl</code></td>
<td>
<p>height above sea level (in m, for method &quot;Paul&quot; only),</p>
</td></tr>
<tr><td><code id="gas_O2sat_+3A_method">method</code></td>
<td>
<p>formula to be used, see references for correct
application.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method APHA is the standard formula in Limnology, method Weiss the
standard formula in marine sciences. The method after Paul is a simple
formula fitted on available tables. To avoid confusion between the
arguments (S, t, masl) it is advisable to use named arguments in
general, e.g. <code>O2sat(t = 4)</code>.
</p>


<h3>Value</h3>

<p>Vector with oxygen saturation concentration in <code class="reqn">mg L^{-1}</code>.
</p>


<h3>References</h3>

<p>American Public Health Association, Inc. (1985): Standard Methods for
the Examination of Water and Wastewater. 18th edition, 1992.
</p>
<p>Benson BB and Krause D, 1980. The concentration and isotopic
fractionation of gases dissolved in freshwater in equilibrium with the
atmosphere. I. Oxygen.  Limnology and Oceanography 25, 662-671.
</p>
<p>Brown LC and Barnwell TO Jr, 1987. The Enhanced Stream Water
Quality Models QUAL2E and QUAL2E-UNCAS: Documentation and User
Manual. U.S. Environmental Protection Agency, Athens,
Georgia. EPA/600/3-87/007, p. 41. http://www.epa.gov)
</p>
<p>DIN 38408-23, Ausgabe:1987-11: Deutsche Einheitsverfahren zur Wasser-,
Abwasser- und Schlammuntersuchung; Gasf?rmige Bestandteile
(Gruppe G); Bestimmung des Sauerstoffs?ttigungsindex (G 23).
</p>
<p>Paul L, 1985. Das thermische Regime der Talsperre Saidenbach und
einige Beziehungen zwischen abiotischen und biotischen
Komponenten. Dissertation, TU Dresden, Fakult?t Bau-, Wasser-
und Forstwesen. 84 pp.
</p>
<p>Weiss R, 1970. The solubility of nitrogen, oxygen, and argon in water
and seawater. Deep-Sea Research 17, 721-35.
</p>
<p>Wagner R, 1979. Die Praxis der Bestimmung des biochemischen
Sauerstoffbedarfs - Ergebnisse einer Umfrage (Berichtigung und
Erg?nzung zur Ver?ffentlichung). Vom Wasser 53,
S. 283-285.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_satconc">gas_satconc</a></code> for other gas species and explicit
consideration of pressure.</p>


<h3>Examples</h3>

<pre><code class='language-R'>gas_O2sat(S = 0, t = 20)                  # fresh water, Weiss formula
gas_O2sat(S = 0, t = 20, method = "APHA") # fresh water, APHA formula

## compare this with
gas_satconc(S = 0, t = 20, species = "O2") * molweight("O2") / 1000

T &lt;- seq(0, 30, 0.1)
plot(T, gas_O2sat(S = 0, t = T, method = "APHA"),
  ylab="O2 sat (mg/L)", type = "l", ylim = c(0, 15))
lines(T, gas_O2sat(S = 0, t = T, method = "Weiss"),
  col = "blue", lwd = 2, lty = "dashed")
lines(T, gas_O2sat(S = 5, t = T, method = "Weiss"), col = "green")
lines(T, gas_O2sat(S = 10, t = T, method = "Weiss"), col = "yellow")
lines(T, gas_O2sat(S = 20, t = T, method = "Weiss"), col = "orange")
lines(T, gas_O2sat(S = 35, t = T, method = "Weiss"), col = "red")

legend("bottomleft", 
  col = c("black", "white", "blue", "green", "yellow", "orange", "red"),
  lty = c(1, 0, 2, 1, 1, 1, 1), lwd = c(1,0 ,2, 1, 1, 1, 1),
  legend=c("freshwater formula", "marine formula:", 
          "S = 0", "S = 5", "S = 10", "S = 20", "S = 35"))
</code></pre>

<hr>
<h2 id='gas_satconc'>Saturated Concentrations of Gases in Water</h2><span id='topic+gas_satconc'></span>

<h3>Description</h3>

<p>Calculates the saturated concentration of several gases in water for a
given temperature, salinity and pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gas_satconc(S = 35, t = 25, P = 1.013253,
        species =c("He","Ne","N2","O2","Ar","Kr","CH4","CO2","N2O"),
        atm = atmComp(species))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gas_satconc_+3A_s">S</code></td>
<td>
<p>Salinity (dimensionless),</p>
</td></tr>
<tr><td><code id="gas_satconc_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>

<tr><td><code id="gas_satconc_+3A_p">P</code></td>
<td>
<p>True pressure, bar</p>
</td></tr>
<tr><td><code id="gas_satconc_+3A_species">species</code></td>
<td>
<p>character vector with gasses whose saturated concentration
should be estimated.
</p>
</td></tr>
<tr><td><code id="gas_satconc_+3A_atm">atm</code></td>
<td>
<p>The number of moles of the gas per unit mole of air in the
atmosphere, the &quot;mixing ratio&quot;.  When present, this overrules the
<code>species</code> argument. When unspecified, the value from <code>atmComp</code>
for the <code>species</code> is taken.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The saturated concentration of the gas in <code class="reqn">mmol m^{-3}</code>.
</p>


<h3>Note</h3>

<p>Compared to the table in Sarmiento and Gruber, there is a slight
deviation for N2O, and He.
</p>
<p>CO2 is OK for temperature 0 only.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>who cite:
</p>
<p>for He and Ne: Weiss R, 1971. Solubility of helium and neon in water
and seawater. Journ. Chem. Eng. Data 16, 235-241.
</p>
<p>N2, O2 and Ar: Weiss R, 1970. The solubility of nitrogen, oxygen, and
argon in water and seawater. Deep-Sea Res. 17, 721-35.
</p>
<p>Kr: Weiss R and Kyser TK, 1978. Solubility of Krypton in water
and seawater. Journ. Chem. Eng. Data 23, 69-72.
</p>
<p>Rn: Hackbusch 1979. Eine Methode zur Bestimmung der Diffusions-,
L?slichkeits un Permeabilitats Konstanten von Radon-222 in
Wasser und Meereswasser. Dissertation, University of Heidelberg,
Germany.
</p>
<p>CH4: Wiesenburg DA and  Guinasso JNL, 1979. Equilibrium
solubilities of methane, carbon monoxide and hydrogen in water and sea
water. Journ. Chem. Eng. Data 24, 256-360.
</p>
<p>CO2 and N2O: Weiss R and Price BA, 1980. Nitrous oxide solubility
in wate and sewater. Mar. Chem. 8, 347-359.
</p>
<p>CFC-11 and CFC-12: Warner MJ and Weiss R, 1985. Solubilities of
chlorofluorocarbons 11 and 12 in water and sewater. Deep-Sea Res. 32,
1485-1497.
</p>
<p>SF6: Bullister et al., 2002. The solubility of sulfur hexafluroide in
water and sewater. Deep-Sea Res. I, 49, 175-188.
</p>
<p>CCl4: Bullister JL and Wisegarver DP, 1998.  The solubility of
carbon tetrachloride in water and seawater. Deep-Sea Res. I,
1285-1302.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>,<code><a href="#topic+gas_solubility">gas_solubility</a></code>,<code><a href="#topic+gas_transfer">gas_transfer</a></code>,
<code><a href="#topic+atmComp">atmComp</a></code>, <code><a href="#topic+vapor">vapor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gas_satconc(species = "O2")
Temp &lt;- seq(from = 0, to = 30, by = 0.1)
Sal  &lt;- seq(from = 0, to = 35, by = 0.1)

mf  &lt;- par(mfrow = c(1,2))

species &lt;- c("N2", "CO2", "O2", "CH4", "N2O")
gsat  &lt;- gas_satconc(t = Temp, species = species)

matplot(Temp, gsat, type = "l", xlab = "temperature", log = "y", lty = 1,
     ylab = "mmol/m3", main = "Saturated conc (S=35)", lwd = 2)
legend("right", col = 1:5, lwd = 2, legend = species)

gsat  &lt;- gas_satconc(S = Sal, species = species)
matplot(Sal, gsat, type = "l", xlab = "salinity", log = "y", lty = 1,
     ylab = "mmol/m3", main = "Saturated conc (T=20)", lwd = 2)
legend("right", col = 1:5, lwd = 2, legend = species)


par(mfrow = mf)

## generate table 3.2.4 from Sarmiento and Gruber
Temp &lt;- seq (0, 30, by = 5)
## saturated concentrations in mmol/m3, at 1 atm.
A &lt;- data.frame(cbind( t = Temp,
            N2  = gas_satconc(t = Temp, species = "N2"),
            O2  = gas_satconc(t = Temp, species = "O2"),
            CO2 = gas_satconc(t = Temp, species = "CO2"),
            Ar  = gas_satconc(t = Temp, species = "Ar")))
format(A, digits = 4)
## table values
## at  0 dg C: 635.6   359.1  23.37  17.44
## at 20 dg C: 425.7   230.5  11.61  11.29
## note the deviations for CO2 (20dg)!

## saturated concentrations in micromol/m3, at 1 atm.
AA &lt;- data.frame(cbind(t = Temp,
            N2O = gas_satconc(t = Temp, species = "N2O")*1000,
            Ne  = gas_satconc(t = Temp, species = "Ne" )*1000,
            Kr  = gas_satconc(t = Temp, species = "Kr" )*1000,
            CH4 = gas_satconc(t = Temp, species = "CH4")*1000,
            He  = gas_satconc(t = Temp, species = "He" )*1000))
format(AA, digits = 4)
## table values
## at  0 dgC: 14.84 8.11  4.33  3.44  1.81
## at 20 dgC: 7.16  6.94  2.50  2.12  1.70
## Note: different for N2O
</code></pre>

<hr>
<h2 id='gas_schmidt'>The Schmidt Number for Gases in Seawater</h2><span id='topic+gas_schmidt'></span>

<h3>Description</h3>

<p>The Schmidt number as a function of temperature (0-30dgC) and for a
salinity of 35.
</p>
<p><code class="reqn">Sc = v/D = Mu/(rho+D)</code>
</p>
<p>where v is the kinematic viscosity of the water and D is the mass
diffusivity, rho is density and mu is the viscosity.
</p>
<p>Schmidt numbers are used to estimate the gas transfer velocity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gas_schmidt(t = 25, species = c("He", "Ne", "N2", "O2", "Ar",
        "Kr", "Rn", "CH4","CO2", "N2O", "CCl2F2", "CCL3F",
        "SF6", "CCl4"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gas_schmidt_+3A_t">t</code></td>
<td>
<p>Temperature in <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="gas_schmidt_+3A_species">species</code></td>
<td>
<p>character vector with gasses whose schmidt number
should be estimated.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Schmidt number, a dimensionless quantity.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>who cite:
</p>
<p>Wanninkhof R, 1992. Relationship between wind speed and gas exchange
over the ocean. Journ. Geophys. Res. 97, 7373-7383.
</p>
<p>except for <code class="reqn">O_2</code>:
</p>
<p>Keeling et al., 1998. Seasonal variation in the atmospheric O2/N2 ratio
in relation to the kinetics of air-sea gas exchange. Global
Biogeochemical Cycles 12, 141-164.
</p>
<p>CFC-11 (<code class="reqn">CCl_2F_2</code>), and CFC-12 (<code class="reqn">CCl_3F</code>):
</p>
<p>Zheng et al., 1998. Measurements of the diffusion coefficients of
CF-11 and CF-12 in pure water and seawater.  Journ. Geophys. Res. 103,
1375-1379.
</p>
<p>and <code class="reqn">CCl_4</code> (Wanninkhof, pers.comm).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_solubility">gas_solubility</a></code>, <code><a href="#topic+gas_transfer">gas_transfer</a></code>,
<code><a href="#topic+atmComp">atmComp</a></code>, <code><a href="#topic+vapor">vapor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gas_schmidt(species = "CO2", t = 20) # about660
</code></pre>

<hr>
<h2 id='gas_solubility'>
Solubility Parameters
</h2><span id='topic+gas_solubility'></span>

<h3>Description</h3>

<p>Solubility parameters SA, <code class="reqn">mmol m^{-3} bar^{-1}</code>,
calculated from the Bunsen solubility coefficients and the volumetric
solubility coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gas_solubility(S = 35, t = 25, 
      species = c("He", "Ne", "N2", "O2", "Ar", "Kr", "Rn", "CH4", 
                  "CO2", "N2O", "CCl2F2", "CCl3F", "SF6", "CCl4"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gas_solubility_+3A_s">S</code></td>
<td>
<p>salinity, -</p>
</td></tr>
<tr><td><code id="gas_solubility_+3A_t">t</code></td>
<td>
<p>temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="gas_solubility_+3A_species">species</code></td>
<td>
<p>The gas  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The solubility, mmol/m3/bar.
</p>


<h3>Note</h3>

<p>The molar volume used for the Bensen coefficient conversion is the
ideal gas value of 22.4136 l/mol.
</p>
<p>These coefficients are to be used with pAmoist, the partial pressure
of the gas in moist air.
</p>
<p>To convert them for use with partial pressure in dry air, divide by
(1-vapor(S,t)).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>who cite:
</p>
<p>for He and Ne: Weiss R, 1971. Solubility of helium and neon in water
and seawater. Journ. Chem. Eng. Data 16, 235-241.
</p>
<p>N2, O2 and Ar: Weiss R, 1970. The solubility of nitrogen, oxygen, and
argon in water and seawater. Deep-Sea Res. 17, 721-35.
</p>
<p>Kr: Weiss R and Kyser TK, 1978. Silubility of Krypton in water
and seawater. Journ. Chem. Eng. Data 23, 69-72.
</p>
<p>Rn: Hackbusch 1979. Eine Methode zur Bestimmung der Diffusions,
Loeslichkeits un Permeabilitats Konstanten von Radon-222 in Wasser und
Meereswasser. Dissertation, University of Heidelberg, Germany.
</p>
<p>CH4: Wiesenburg DA and  Guinasso JNL, 1979. Equilibrium
solubilities of methane, carbon monoxide and hydrogen in water and sea
water. Journ. Chem. Eng. Data 24, 256-360.
</p>
<p>CO2 and N2O: Weiss R and  Price BA, 1980. Nitrous oxide solubility
in wate and sewater. Mar. Chem. 8, 347-359.
</p>
<p>CFC-11 and CFC-12: Warner MJ and Weiss R, 1985. Solubilities of
chlorofluorocarbons 11 and 12 in water and sewater. Deep-Sea Res. 32,
1485-1497.
</p>
<p>SF6: Bullister et al., 2002. The solubility of sulfur hexafluroide in
water and sewater. Deep-Sea Res. I, 49, 175-188.
</p>
<p>CCl4: Bullister JL and  Wisegarver DP, 1998.  The solubility of
carbon tetrachloride in water and seawater. Deep-Sea Res. I,
1285-1302.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_transfer">gas_transfer</a></code>,
<code><a href="#topic+atmComp">atmComp</a></code>, <code><a href="#topic+vapor">vapor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gas_solubility(t = 1:20,S = 35, species = "CO2")
gas_solubility(t = 0:5,S = 35,species = "O2")

Temp &lt;- seq(from = 0, to = 30, by = 0.1)
mf &lt;- par(mfrow = c(1, 2))
gs  &lt;- gas_solubility(t = Temp)
species   &lt;- c("CCl4", "CO2", "N2O", "Rn", "CCl2F2")
matplot(Temp, gs[, species], type = "l", lty = 1, lwd = 2,
     xlab = "temperature", ylab = "mmol/m3", main = "solubility (S=35)")
legend("topright", col = 1:5, lwd = 2, legend = species)

species2 &lt;- c("Kr", "CH4", "Ar", "O2", "N2", "Ne")
matplot(Temp, gs[, species2], type = "l", lty = 1, lwd = 2,
     xlab = "temperature", ylab = "mmol/m3", main = "solubility (S=35)")
legend("topright", col = 1:6, lwd = 2, legend = species2)




plot(Temp,gas_solubility(t = Temp, species = "CCl4"), xlab = "temperature",
     ylab = "mmol/m3/atm", main = "solubility (S=35)",
     type = "l", lwd = 2, ylim = c(0, 100000))
lines(Temp,gas_solubility(t = Temp, species = "CO2"), col = "red", lwd = 2)
lines(Temp,gas_solubility(t = Temp, species = "N2O"), col = "blue", lwd = 2)
lines(Temp,gas_solubility(t = Temp, species = "Rn"), col = "green", lwd = 2)
lines(Temp,gas_solubility(t = Temp, species = "CCl2F2"), col = "yellow", lwd = 2)

legend("topright", col = c("black", "red", "blue", "green", "yellow"), lwd = 2,
       legend = c("CCl4", "CO2", "N2O", "Rn", "CCl2F2"))

plot(Temp, gas_solubility(t = Temp, species = "Kr"), xlab = "temperature",
     ylab = "mmol/m3/atm", main = "solubility (S=35)", type = "l",
     lwd = 2, ylim = c(0, 4000))
lines(Temp, gas_solubility(t = Temp, species = "CH4"), col = "red", lwd = 2)
lines(Temp, gas_solubility(t = Temp, species = "Ar"), col = "blue", lwd = 2)
lines(Temp, gas_solubility(t = Temp, species = "O2"), col = "green", lwd = 2)
lines(Temp, gas_solubility(t = Temp, species = "N2"), col = "yellow", lwd = 2)
lines(Temp, gas_solubility(t = Temp, species = "Ne"), col = "grey", lwd = 2)

legend("topright",col = c("black", "red", "blue", "green", "yellow", "grey"),
       lwd = 2, legend = c("Kr", "CH4", "Ar", "O2", "N2", "Ne"))

par(mfrow = mf)

## generate table 3.2.3 from Sarmiento and Gruber
Temp &lt;- seq (0,30,by = 5)

## saturated concentrations in mmol/m3 at at 1 atm;
# convert from /bar to /atm using 1.013253

A &lt;- data.frame(cbind( t = Temp,
            He = gas_solubility(t = Temp,species = "He")*1.013253,
            Ne = gas_solubility(t = Temp,species = "Ne")*1.013253,
            N2 = gas_solubility(t = Temp,species = "N2")*1.013253,
            O2 = gas_solubility(t = Temp,species = "O2")*1.013253,
            Ar = gas_solubility(t = Temp,species = "Ar")*1.013253,
            Kr = gas_solubility(t = Temp,species = "Kr")*1.013253,
            Rn = gas_solubility(t = Temp,species = "Rn")*1.013253)  )
format(A,digits = 4)
## table values at
## 0   dgC:  349.4   448.6   818.8  1725  1879  3820  31150
## 20 dg C:  332.9   390.7   557.9  1126  1236  2241  14130
## note the (very) slight deviations for Rn

## saturated concentrations in micromol/m3 at 1 atm
AA &lt;- data.frame(cbind( t = Temp,
            CH4    = gas_solubility(t = Temp,species = "CH4")   *1.013253,
            CO2    = gas_solubility(t = Temp,species = "CO2")   *1.013253,
            N2O    = gas_solubility(t = Temp,species = "N2O")   *1.013253,
            CCL2F2 = gas_solubility(t = Temp,species = "CCl2F2")*1.013253,
            CCL3F  = gas_solubility(t = Temp,species = "CCl3F") *1.013253,
            SF6    = gas_solubility(t = Temp,species = "SF6")   *1.013253,
            CCl4   = gas_solubility(t = Temp,species = "CCl4")  *1.013253))
format(AA,digits = 4)

## Table values at
##  0 dgC: 1984  64400 47840  6686 27380   425.2  97114
## 20 dgC: 1241  33110 23870  2566  9242   195.8  30307
## Note: there are slight deviations for CO2, and N2O!
</code></pre>

<hr>
<h2 id='gas_transfer'>The Gas Transfer Coefficient in m/sec</h2><span id='topic+gas_transfer'></span>

<h3>Description</h3>

<p>The gas transfer coefficient, in <code class="reqn">m s^{-1}</code>, for certain
gases in seawater (S = 35).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gas_transfer(t = 25, u10 = 1, species = c("He", "Ne", "N2", "O2", "Ar",
        "Kr", "Rn", "CH4","CO2", "N2O", "CCl2F2", "CCL3F",
        "SF6", "CCl4"),
  method = c("Liss", "Nightingale", "Wanninkhof1", "Wanninkhof2"),
  Schmidt = gas_schmidt(t = t, species = species))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gas_transfer_+3A_t">t</code></td>
<td>
<p>Temperature in <code class="reqn">^\circ</code>C,
</p>
</td></tr>
<tr><td><code id="gas_transfer_+3A_u10">u10</code></td>
<td>
<p>wind speed, in m/sec at a nominal height of 10 m above sea
level,
</p>
</td></tr>
<tr><td><code id="gas_transfer_+3A_species">species</code></td>
<td>
<p>character vector with gasses whose gas transfer coefficient
should be estimated.
</p>
</td></tr>
<tr><td><code id="gas_transfer_+3A_method">method</code></td>
<td>
<p>one of &quot;Liss&quot;, for Liss and Merlivat, 1986;
&quot;Nightingale&quot;, for Nightingale et al., 2000; &quot;Wanninkhof1&quot;, for
Wanninkhof 1992, or &quot;Wanninkhof2&quot; for Wanninkhof and McGills 1999.
</p>
</td></tr>
<tr><td><code id="gas_transfer_+3A_schmidt">Schmidt</code></td>
<td>
<p>the Schmidt number, when given this overrules the
arguments <code>gas</code> and <code>t</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The gas transfer velocity, for seawater, in <code class="reqn">m s^{-1}</code>.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>
<p>Liss PS and Merlivat L, 1986. Air-sea gas exchange rates:
introduction and synthesis.  In: the role of air-sea exchange in
Geochemical cycling, edited by P. Buat-Menard, pp 113-127.  D. Reidel,
Dordrecht, the Netherlands.
</p>
<p>Nightingale et al., 2000. In situ evaluation of air-sea gas exchange
prameterizations using novel conservative and volatile tracers. Global
biogeochemical cycles 14, 373-387.
</p>
<p>Wanninkhof R, 1992. Relationship between wind speed and gas exchange
over the ocean. Journ. Geophys. Res. 97, 7373-7383.
</p>
<p>Wanninkhof R and McGillis W, 1999. A cubic relationshp between
air-sea CO2 exchange and wind speed.  Geophys. Res. Lett. 26,
1889-1892.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>,<code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>,<code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+atmComp">atmComp</a></code>, <code><a href="#topic+vapor">vapor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>useq &lt;- 0:15
plot(useq, gas_transfer(u10 = useq, species = "O2"), type = "l", lwd = 2, xlab = "u10, m/s",
     ylab = "m/s", main = "O2 gas transfer velocity", , ylim = c(0, 0.0003))
lines(useq, gas_transfer(u10 = useq, species = "O2", method = "Nightingale"), lwd = 2, lty = 2)
lines(useq, gas_transfer(u10 = useq, species = "O2", method = "Wanninkhof1"), lwd = 2, lty = 3)
lines(useq, gas_transfer(u10 = useq, species = "O2", method = "Wanninkhof2"), lwd = 2, lty = 4)

legend("topleft", lty = 1:4, lwd = 2,
  legend = c("Liss and Merlivat 1986", "Nightingale et al. 2000",
  "Wanninkhof 1992", "Wanninkhof and McGills 1999"))
</code></pre>

<hr>
<h2 id='gravity'>Gravity on Earth</h2><span id='topic+gravity'></span>

<h3>Description</h3>

<p>Computes the gravity, based on latitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gravity(lat = 0, method = c("Moritz", "UNESCO"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gravity_+3A_lat">lat</code></td>
<td>
<p>latitude (-90 - +90).</p>
</td></tr>
<tr><td><code id="gravity_+3A_method">method</code></td>
<td>
<p>When &quot;UNESCO&quot;, uses the UNESCO (1983) polynomial, else
according to Moritz, 2000
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gravity, in <code class="reqn">\rm m\,sec^{-2}</code>.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>The UNESCO polynomial:
</p>
<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>
<p>Moritz H, 2000. Geodetic reference system 1980. Journal of Geodesy 74,
128-133.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coriolis">coriolis</a></code>, <code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+ssd2rad">ssd2rad</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gravity(lat = 30)</code></pre>

<hr>
<h2 id='marelac-internal'>Internal Functions of the marelac Package</h2><span id='topic+rhoH2O_Chen'></span><span id='topic+AtomicWeightIUPAC'></span><span id='topic+waalscoef'></span>

<h3>Description</h3>

<p>Internal functions of package marelac.
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='molvol'>Mol to Liter Conversion for a Gas</h2><span id='topic+molvol'></span>

<h3>Description</h3>

<p>Converts from liter to moles for a gas.</p>


<h3>Usage</h3>

<pre><code class='language-R'>molvol(t = 25, P = 1.013253,
   species = c("ideal", "Ar", "CO2", "CS2", "CO", "CCl4", "Cl2",
         "C2H6S", "C2H5OH", "C6H5F", "CH3F", "CH4", "CH3OH", "C5H12",
          "C3H8", "H2O", "He", "H2", "HBr", "HCl", "H2S", "Hg",
          "Kr", "NH3", "Ne", "NO", "N2", "NO2", "N2O", "O2", "PH3",
          "SiH4", "SiF4", "SO2", "Xe"),
    quantity = 1, a = 0, b = 0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="molvol_+3A_t">t</code></td>
<td>
<p>temperature, <code class="reqn">^\circ</code>C
</p>
</td></tr>
<tr><td><code id="molvol_+3A_p">P</code></td>
<td>
<p>True pressure, bar.
</p>
</td></tr>
<tr><td><code id="molvol_+3A_species">species</code></td>
<td>
<p>character vector with gasses whose molecular volume
should be estimated. if <code>NULL</code> then the coefficients <code>a</code> and
<code>b</code> are used.
</p>
</td></tr>
<tr><td><code id="molvol_+3A_quantity">quantity</code></td>
<td>
<p> mol of the gas.
</p>
</td></tr>
<tr><td><code id="molvol_+3A_a">a</code></td>
<td>
<p>Van der Waals constant a, a species-specific coefficient,
<code class="reqn">dm^6*bar/mol^2</code>.
</p>
</td></tr>
<tr><td><code id="molvol_+3A_b">b</code></td>
<td>
<p>Van der Waals constant b, a species-specific coefficient,
<code class="reqn">dm^3/mol</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>volume of the gas, liter
</p>


<h3>Note</h3>

<p>The coefficients a and b are species-specific; values of 0 assume an
ideal gas and in general give good estimates.
</p>
<p>Use <code>1/molvol</code> to convert from liter to moles.
</p>
<p>The default calculates the molar volume of an ideal gas
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>The values of the van der Waals constants are from:
</p>
<p>Weast RC (Ed.) 1972. Handbook of Chemistry and Physics (53rd Edn.),
Cleveland:Chemical Rubber Co.
</p>
<p>as found in:
<a href="https://en.wikipedia.org/wiki/Van_der_Waals_constants_(data_page)">https://en.wikipedia.org/wiki/Van_der_Waals_constants_(data_page)</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+molweight">molweight</a></code>,
<code><a href="#topic+redfield">redfield</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#molecular volume of an ideal gas.
molvol(species = "ideal", P = 1, t = 0)    # 22.710 980
molvol(species = "ideal", P = 1, t = 25)   # 24.789 598

plot(0:30, molvol(t = 0:30, species = NULL),
    xlab = "Temperature, dgC", ylab = "Molar volume")

#
molvol(a = 1.382, b = 0.03186, species = NULL, t = 0)

molvol(t = 0, species = "O2")

# the same but for all gasses
molvol(t = 0)

# table for different pressures
molvol(P = 1:5, species = "O2")

# the inverse function
1/molvol(species = "O2")

# contour plot
P    &lt;- seq(1, 100, by = 1)
Temp &lt;- seq(-5, 40, by = 1)

Val &lt;- outer(X = P, Y = Temp,
      FUN = function(X, Y) molvol(P = X,  t = Y, species = "O2"))
contour(P, Temp, Val, xlab = "pressure", ylab = "temperature",
        main = "molvol", nlevel = 20, log = "x", axes = FALSE)
axis(1); axis(2); box()

</code></pre>

<hr>
<h2 id='molweight'>Molecular Weight of a Chemical Species</h2><span id='topic+molweight'></span>

<h3>Description</h3>

<p>Calculates the molecular weight of chemical species.</p>


<h3>Usage</h3>

<pre><code class='language-R'>molweight(species)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="molweight_+3A_species">species</code></td>
<td>
<p>character vector with chemical species whose molecular
weight is requested.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Molecular weights of chemical elements may vary due to different
isotope compositions, depending on geology, industrial processes or
biological activity.  Please consult the IUPAC Technical report about
the details.  The function returns NA for elements (and their
compounds) which have no stable isotopes (except U, Th, Pa).
</p>


<h3>Value</h3>

<p>Vector with the molecular weights in g/mol.
</p>


<h3>Note</h3>

<p>This function uses text parsing of chemical formulae, it is
strictly case sensitive.
</p>


<h3>Author(s)</h3>

<p>Thomas Petzoldt</p>


<h3>References</h3>

<p>Wieser ME, 2006. Atomic weights of the elements 2005 (IUPAC
Technical Report).  Pure Appl. Chem. 78(11), 2051&ndash;2066.
doi:10.1351/pac200678112051
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+molvol">molvol</a></code>,
<code><a href="#topic+redfield">redfield</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molweight("CO2")
molweight("HCO3")
molweight("H")
molweight("H3PO4")

## eicosapentaenoic acid (EPA)
molweight("CH3CH2CHCHCH2CHCHCH2CHCHCH2CHCHCH2CHCH(CH2)3COOH")
molweight("C20H30O2")

## works also with vectors
molweight(c("C2H5OH", "CO2", "H2O"))
molweight(c("SiOH4", "NaHCO3", "C6H12O6", "Ca(HCO3)2", "Pb(NO3)2", "(NH4)2SO4"))

## note that chemical formulae are case-sensitive
molweight("Co") # cobalt
molweight("CO") # carbon monoxide


## from gram to mol
1/molweight("CO3")

</code></pre>

<hr>
<h2 id='Oceans'>Useful Characteristics of the Oceans</h2><span id='topic+Oceans'></span>

<h3>Description</h3>

<p>Surface area and volume of the world's oceans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oceans</code></pre>


<h3>Format</h3>

<p>A list specifying the value, units, and a
description of each quantity.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 85.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+Bathymetry">Bathymetry</a></code>,
<code><a href="#topic+Constants">Constants</a></code>, <code><a href="#topic+earth_surf">earth_surf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data.frame(cbind(acronym = names(Oceans),
           matrix(ncol = 3, byrow = TRUE, data = unlist(Oceans),
           dimnames = list(NULL, c("value", "units", "description")))))
</code></pre>

<hr>
<h2 id='redfield'>Redfield Ratio Calculator</h2><span id='topic+redfield'></span>

<h3>Description</h3>

<p>Estimate elemental composition of biomass (or media) according to the
Redfield ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redfield(q, species, method = c("mol", "mass"), 
         ratio = c(C=106, H=263, O=110, N=16, P=1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="redfield_+3A_q">q</code></td>
<td>
<p>amount of substance of that element (in mol or mass units),</p>
</td></tr>
<tr><td><code id="redfield_+3A_species">species</code></td>
<td>
<p>The element that is given (&quot;C&quot;, &quot;H&quot;, &quot;O&quot;, &quot;N&quot;, &quot;P&quot;),</p>
</td></tr>
<tr><td><code id="redfield_+3A_method">method</code></td>
<td>
<p>measurement unit (&quot;mol&quot; or &quot;mass&quot;),</p>
</td></tr>
<tr><td><code id="redfield_+3A_ratio">ratio</code></td>
<td>
<p>average elemental composition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The average elemental composition of marine plankton (Redfield ratio)
is traditionally assumed to be
<code class="reqn">\mathrm {C_{106}H_{263}O_{110}N_{16}P_{1}}</code>
(Redfield 1934, 1963, Richards 1965). Note that while the C:N:P ratio
is widely agreed there is still discussion about the average of O and
H, e.g. <code class="reqn">\mathrm{C_{106}H_{180}O_{45}N_{16}P_{1}}</code>
(Stumm, 1964).
</p>
<p>Note also that there are, of course, large differences depending on
species and physiological state.
</p>


<h3>Value</h3>

<p> A data frame with the estimated ratio of the main elements.</p>


<h3>References</h3>

<p>Redfield AC, 1934. On the proportions of organic derivations in sea
water and their relation to the composition of plankton.  In: James
Johnstone Memorial Volume. (ed. R.J. Daniel).  University Press of
Liverpool, 177-192.
</p>
<p>Redfield, AC, Ketchum, BH and Richards FA, 1963. The influence of
organisms on the composition of seawater. In: Hill, MN, Editor, The
Sea vol. 2, Interscience, New York (1963), pp.26-77.
</p>
<p>Richards FA, 1965. Anoxic basins and fjords. In: Riley JP, Skirrow
D. (Eds.), Chemical Oceanography, vol. 1. Academic Press, New York,
611-645. (cited in Hedges et al, 2002).
</p>
<p>Stumm W, 1964. Discussion (Methods for the removal of phosphorus and
nitrogen from sewage plant effluents by G. A. Rohlich). In
Eckenfelder, WW (ed.), Advances in water pollution research. Proc. 1st
Int. Conf. London 1962, volume 2, pp. 216-229. Pergamon.
</p>
<p>Vollenweider RA, 1985. Elemental and biochemical composition of
plankton biomass: some comments and explorations. Arch.
Hydrobiol. 105, 11-29.
</p>
<p>Anderson LA, 1995. On the hydrogen and oxygen content of marine
plankton. Deep-Sea Res. 42, 1675-1680.
</p>
<p>Hedges JI., Baldock JA, Gelinas Y, Lee C, Peterson ML and 
Wakeham SG, 2002. The biochemical and elemental compositions of
marine plankton: A NMR perspective. Marine Chemistry 78, 47-63.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AtomicWeight">AtomicWeight</a></code>, <code><a href="#topic+molvol">molvol</a></code>, <code><a href="#topic+molweight">molweight</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Redfield ratio
redfield(1, "P")
## returns the molar Redfield ratio, rescaled to nitrogen
redfield(1, "N")
## how many mass units are related to 2 mass units (e.g. mg) P
redfield(2, "P", "mass")
redfield(c(1, 2, 3), "N", "mass")

## mass percentage of elements
x &lt;- redfield(1, "P", "mass")
x / sum(x)

## with alternative elemental composition (Stumm, 1964)
x &lt;- redfield(1, "P", "mass", 
              ratio = c(C = 106, H = 180, O = 45, N = 16, P = 1))
x / sum(x)

## rule of thumb for fresh mass (in mg) formed by 1 microgram P
redfield(1, "P", "mass")$C * 2 * 10 / 1000
sum(redfield(1, "P", "mass",
  ratio = c(C = 106, H = 180, O = 45, N = 16, P = 1))) * 10 / 1000

</code></pre>

<hr>
<h2 id='ssd2rad'>Estimate Global Radiation from Measured Sunshine Duration Time</h2><span id='topic+ssd2rad'></span>

<h3>Description</h3>

<p>The function converts values of sunshine duration (in hours) to global
radiation (in <code class="reqn">J m^{-2} s^{-1}</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssd2rad(S, doy, a = 0.25, b = 0.5, rho = 50.29)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ssd2rad_+3A_s">S</code></td>
<td>
<p>Sunshine duration (hours)</p>
</td></tr>
<tr><td><code id="ssd2rad_+3A_doy">doy</code></td>
<td>
<p>Julian day (for northern hemisphere only)</p>
</td></tr>
<tr><td><code id="ssd2rad_+3A_a">a</code>, <code id="ssd2rad_+3A_b">b</code>, <code id="ssd2rad_+3A_rho">rho</code></td>
<td>
<p>site specific conversion parameters, must be fitted
to measured data.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated value of global radiaton in <code class="reqn">J m^{-2} s^{-1}</code>.
</p>


<h3>Note</h3>

<p>Don't forget to fit the function parameters to site specific values!
</p>


<h3>References</h3>

<p>Dyck S and Peschke G., 1995. Grundlagen der Hydrologie. 3. Auflage.
Verlag f?r Bauwesen, Berlin 1995, ISBN 3-345-00586-7.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coriolis">coriolis</a></code>, <code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ssd2rad(8, 120)
</code></pre>

<hr>
<h2 id='sw_adtgrad'>Adiabatic Temperature Gradient in Seawater</h2><span id='topic+sw_adtgrad'></span>

<h3>Description</h3>

<p>Computes the adiabatic temperature gradient in seawater,
using the UNESCO 1983 polynomial.<br />
</p>
<p>Also known as the adiabatic lapse rate, the change of temperature per
unit pressure for an adiabatic change of pressure of an element of
seawater. It is assumed that no heat or salt is exchanged with the
surroundings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_adtgrad(S = 35, t = 25, p = P-1.013253, P = 1.013253 )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_adtgrad_+3A_s">S</code></td>
<td>
<p>Practical salinity (-),</p>
</td></tr>
<tr><td><code id="sw_adtgrad_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C</p>
</td></tr>
<tr><td><code id="sw_adtgrad_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_adtgrad_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>adiabatic temperature gradient, in dg K / bar
</p>


<h3>Note</h3>

<p>Note: in the original formula, the units of <code>sw_adtgrad</code> are dg
K/dbar (here: dg K/bar).
</p>
<p><code>sw_adtgrad</code> for S = 40, t = 40, p = 1000 is 3.255976e-3
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_adtgrad(t = 40, S = 40, p = 1000)  #3.255976e-4

## Check values
sw_adtgrad(S = 25, t = 10, p = 0)    # 0.1002e-3
sw_adtgrad(S = 25, t = 10, p = 100)  # 0.1135e-3
sw_adtgrad(S = 25, t = 10, p = 1000) # 0.2069e-3

sw_adtgrad(S = 25, t = 30, p = 0)    # 0.2417e-3
sw_adtgrad(S = 40, t = 30, p = 0)    # 0.2510e-3
sw_adtgrad(S = 40, t = 0,  p = 100)  # 0.0630e-3

</code></pre>

<hr>
<h2 id='sw_alpha'>Thermal Expansion Coefficient of Seawater</h2><span id='topic+sw_alpha'></span>

<h3>Description</h3>

<p>Computes the seawater thermal expansion coefficient with respect
to in situ temperature, 1/K
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_alpha(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_alpha_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_alpha_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_alpha_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_alpha_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Thermal expansion coefficient, 1/K.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>,
<code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_alpha(35.7, 25.5, 102.3)#0.000309837839319264
</code></pre>

<hr>
<h2 id='sw_beta'>Haline Contraction Coefficient of Seawater</h2><span id='topic+sw_beta'></span>

<h3>Description</h3>

<p>Computes the seawater haline contraction coefficient with respect
to constant, in situ temperature, kg/g
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_beta(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_beta_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_beta_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_beta_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_beta_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Haline contraction coefficient, kg/g.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_beta(35.7, 25.5, 102.3)    #0.000725729797838666
</code></pre>

<hr>
<h2 id='sw_comp'>Reference Sea Salt Composition</h2><span id='topic+sw_comp'></span>

<h3>Description</h3>

<p>The sea salt composition definition for reference salinity of the standard
ocean at 25 dgC and 1.01325 bar (atmospheric pressure),
given in mass fractions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_comp(species = c("Na", "Mg", "Ca", "K", "Sr", "Cl", "SO4", "HCO3",
                    "Br", "CO3", "BOH4", "F", "OH", "BOH3", "CO2"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_comp_+3A_species">species</code></td>
<td>
<p>character vector with components whose composition should be
estimated.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the mass fractions.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Millero FJ, Waters J, Woosley R, Huang F and Chanson M, 2008.
The effect of composition of the density of Indian Ocean waters,
Deep-Sea Res. I, 55, 960-470.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_comp("CO2")
sw_comp()
sum(sw_comp())
</code></pre>

<hr>
<h2 id='sw_conserv'>Concentrations of (Conservative) Species in Seawater</h2><span id='topic+sw_conserv'></span>

<h3>Description</h3>

<p>Estimates the concentration of Borate,Calcite, Sulphate and Fluoride
in seawater, as a function of salinity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_conserv(S = 35)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_conserv_+3A_s">S</code></td>
<td>
<p>Practical salinity, (-).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The borate and calcite concentration as in Millero (1995),
</p>
<p>Sulphate as in Morris and Riley, 1966,
</p>
<p>Fluoride as in Riley, 1965.
</p>


<h3>Value</h3>

<p>A data frame with the concentrations in micromol/kg.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Millero FJ, 1995. Thermodynamics of the carbon dioxide system in
the oceans. Geochim. Cosmochim. Acta 59, 661 677.
</p>
<p>Riley JP, 1965. The occurrence of anomalously high fluoride
concentrations in the North Atlantic. Deep-Sea Res. 12, 219 220.
</p>
<p>Morris AW, Riley JP, 1966. The bromide- chlorinity and sulphate-
chlorinity ratio in seawater. Deep-Sea Res. 13, 699 706.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.frame(salinity = 1:35, sw_conserv(1:35) )
</code></pre>

<hr>
<h2 id='sw_cp'>Heat Capacity of Sea Water</h2><span id='topic+sw_cp'></span>

<h3>Description</h3>

<p>Estimates the heat capacity of seawater.
</p>
<p>Valid for S = 0 to 40, T = 0 to 35 dg C
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_cp(S = 35, t = 25, p = P-1.013253, P = 1.013253,
      method = c("Gibbs", "UNESCO"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_cp_+3A_s">S</code></td>
<td>
<p>Salinity, when <code>method</code> = <code>"UNESCO"</code>: practical salinity (-)
else absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_cp_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_cp_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_cp_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
<tr><td><code id="sw_cp_+3A_method">method</code></td>
<td>
<p>When &quot;UNESCO&quot;, uses the UNESCO (1983) polynomial,
when &quot;Gibbs&quot;, based on the gibbs functions as in Feistel, 2008 </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Heat capacity, in <code class="reqn">J kg^{-1} dgC^{-1}</code>
</p>


<h3>Note</h3>

<p><code>p</code> is applied pressure, 0 bar at sea surface.
</p>
<p>when using UNESCO polynomial, <code>cp</code> for S = 40, T = 40, P = 1000
is 3849.5 J/(kg dg C).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>
<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>
<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, to convert from absolute salinity (g/kg) to
practical salinity (-)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_cp(S = 40, t = 40, p = 1000, method="UNESCO")  # 3849.5

# Check value Gibbs function
sw_cp(35.7,25.5,102.3)#3974.42541259729

# Check values UNESCO
sw_cp(S = 25, t = 10, p = 0,    method = "UNESCO")  # 4041.8
sw_cp(S = 25, t = 10, p = 1000, method = "UNESCO")  # 3842.3
sw_cp(S = 25, t = 30, p = 0,    method = "UNESCO")  # 4049.1

sw_cp(S = 40, t = 10, p = 0, method = "UNESCO")  # 3959.3

</code></pre>

<hr>
<h2 id='sw_dens'>Density of Sea Water</h2><span id='topic+sw_dens'></span>

<h3>Description</h3>

<p>Density of sea water in <code class="reqn">kg m^{-3}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_dens(S = 35, t = 25, p = max(0, P-1.013253), P = 1.013253,
        method=c("Gibbs","UNESCO","Chen"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_dens_+3A_s">S</code></td>
<td>
<p>Salinity, when <code>method</code> = <code>"UNESCO"</code>: practical
salinity (-) else absolute salinity (g/kg),</p>
</td></tr> 
<tr><td><code id="sw_dens_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_dens_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_dens_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
<tr><td><code id="sw_dens_+3A_method">method</code></td>
<td>
<p>When &quot;UNESCO&quot;, uses the UNESCO (1983) polynomial, when
&quot;Gibbs&quot;, based on the Gibbs functions as in Feistel, 2008 &quot;Chen&quot;
for the limnological range (i.e. fresh water systems).  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>To avoid confusion between the arguments (S, t, p) it is advisable to
use named arguments in general (e.g. <code>rho(t = 4)</code>.
The UNESCO formula is imported from package <span class="pkg">seacarb</span>.
</p>


<h3>Value</h3>

<p>Density of water in <code class="reqn">kg m^{-3}</code>.
</p>


<h3>Note</h3>

<p>Pressure used here is 1 bar (true pressure), in contrast to
hydrostatic pressure (0 bar at surface) in original formula.
</p>
<p>The coefficients from McDougall et al., 2009 were used.
For temperature, they differ slightly from Feistel 2003 and Feistel 2008,
which is why, for temparatures different from 0, there is a slight offset
from the estimates as from table 22 or 21 from Feistel (2008).
</p>


<h3>References</h3>

<p>Chen Ch.-T. and Millero FJ, 1986. Thermodynamic properties
of natural waters covering only the limnological
range. Limnol. Oceanogr. 31 No. 3, 657 - 662. <a href="https://doi.org/10.4319/lo.1986.31.3.0657">doi:10.4319/lo.1986.31.3.0657</a>
</p>
<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>
<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code>rho</code> in package seacarb.
</p>
<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity to
absolute salinity
</p>
<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, to convert from absolute salinity to
practical salinity
</p>


<h3>Examples</h3>

<pre><code class='language-R'># table 22 Feistel 2008
sw_dens(0, 0, 0)               #0.999843086e3
sw_dens(0, 79.85, 0)           #0.97188383e3   - deviates
sw_dens(0, 0,998.98675)        #0.104527796e4

# table 21 Feistel 2008
sw_dens(35.16504, 0, 0)        #0.10281072e4
sw_dens(100, 79.85, 0)         #0.102985888e4
sw_dens(35.16504, 0,998.98675) #0.10709264e4

sw_dens(35.7, 25.5, 102.3)     #1027.95249315662

S &lt;- 0:40
plot(S, sw_dens(S = S, t = 4, method = "UNESCO"))

lines(S, sw_dens(S = S, t = 4, method = "Gibbs"), col = "red")

lines(S, sw_dens(S = S, t = 4, method = "Chen"), col = "blue")

</code></pre>

<hr>
<h2 id='sw_depth'>Water Depth</h2><span id='topic+sw_depth'></span>

<h3>Description</h3>

<p>Computes the water depth for water of salinity 35, and temperature 0
dg C, based on latitude and hydrostatic pressure, using the UNESCO 1983
polynomial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_depth(p = P-1.013253, P = 1.013253, lat = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_depth_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="sw_depth_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
<tr><td><code id="sw_depth_+3A_lat">lat</code></td>
<td>
<p>latitude (-90 to +90), -,</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Water depth in m.
</p>


<h3>Note</h3>

<p><code>sw_depth</code> for  p = 1000, lat = 30 is 9712.653 m.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_depth(p = 1000, lat = 30:40)

## Check values
sw_depth(p = 1000, lat = 30)     #9712.65
sw_depth(p = 50,   lat = 30)     #496.00
sw_depth(p = 50,   lat = 60)     #494.69
sw_depth(p = 500,  lat = 60)     #4895.60

</code></pre>

<hr>
<h2 id='sw_enthalpy'>Specific Enthalpy of Seawater</h2><span id='topic+sw_enthalpy'></span>

<h3>Description</h3>

<p>Computes the seawater specific enthalpy, J/kg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_enthalpy(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_enthalpy_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_enthalpy_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_enthalpy_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_enthalpy_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Specific enthalpy, J/kg.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_enthalpy(35.7,25.5,102.3) #110776.712408975
</code></pre>

<hr>
<h2 id='sw_entropy'>Specific Entropy of Seawater</h2><span id='topic+sw_entropy'></span>

<h3>Description</h3>

<p>Computes the seawater specific entropy, J/(kg*K)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_entropy(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_entropy_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_entropy_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_entropy_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_entropy_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Specific entropy, J/(kg*K).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_entropy(35.7, 25.5, 102.3) #352.81879771528
</code></pre>

<hr>
<h2 id='sw_gibbs'>Gibbs Function of Seawater</h2><span id='topic+sw_gibbs'></span>

<h3>Description</h3>

<p>Calculates the seawater specific gibbs free energy, including
derivatives up to order 2, for a
given temperature, salinity and pressure.
</p>
<p>The Gibbs function of seawater g(S,t,p) is related to the specific
enthalpy h and entropy s, by g = h - (273.15 K + t) s
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_gibbs(S = 35, t = 25, p = P-1.013253, 
         P = 1.013253, dS = 0, dt = 0, dp = 0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_gibbs_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_ds">dS</code></td>
<td>
<p>order of the S derivative</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_dt">dt</code></td>
<td>
<p>order of the t derivative</p>
</td></tr>
<tr><td><code id="sw_gibbs_+3A_dp">dp</code></td>
<td>
<p>order of the p derivative</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Gibbs function, J/kg, or its derivative
</p>


<h3>Note</h3>

<p>The gibbs function is defined as the sum of a pure water part and the
saline part (IAPWS-08)
</p>
<p>The coefficients from McDougall et al., 2009 were used.
For temperature, they differ slightly from Feistel 2003 and Feistel 2008,
which is why, for temperatures different from 0, there is a slight offset
from the estimates as from table 22 or 21 from Feistel (2008).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># table 22 Feistel 2008
sw_gibbs(0, 0, 0)                             #= 101.34274
sw_gibbs(0, 0, 0, dS = 1)                     # 0
sw_gibbs(0, 0, 0, dt = 1)                     #0.147643376
sw_gibbs(0, 0, 0, dp = 1)                     #0.1000015694e-2
sw_gibbs(0, 0, 0, dS = 1, dp = 1)             #0
sw_gibbs(0, 0, 0, dt = 1, dp = 1)             #-0.677700318e-7

sw_gibbs(0, 79.85, 0)                         #-0.446114969e5 differs (see note)
sw_gibbs(0, 79.85, 0, dt = 1)                 #-0.107375993e4 differs
sw_gibbs(0, 79.85, 0, dp = 1)                 #0.102892956e-2 differs
sw_gibbs(0, 79.85, 0, dS = 1, dp = 1)         #0
sw_gibbs(0, 79.85, 0, dt = 1, dp = 1)         #0.659051552e-6


sw_gibbs(0, 0, 998.98675)                     #0.977303862e5
sw_gibbs(0, 0, 998.98675, dt = 1)             #0.851466502e1
sw_gibbs(0, 0, 998.98675, dp = 1)             #0.956683329e-3
sw_gibbs(0, 0, 998.98675, dS = 1, dp = 1)     #0
sw_gibbs(0, 0, 998.98675, dt = 1, dp = 1)     #0.199079571e-6

# table 21 Feistel 2008
sw_gibbs(35.16504, 0, 0)                      #=0
sw_gibbs(35.16504, 0, 0, dS = 1)              #0.639974067e2      differs
sw_gibbs(35.16504, 0, 0, dt = 1)              #=0
sw_gibbs(35.16504, 0, 0, dp = 1)              #0.972661217e-3
sw_gibbs(35.16504, 0, 0, dS = 1, dp = 1)      #-0.759615412e-6
sw_gibbs(35.16504, 0, 0, dt = 1, dp = 1)      #0.515167556e-7    !!!

sw_gibbs(100, 79.85, 0)                       #=-0.295243229e5   differs
sw_gibbs(100, 79.85, 0, dS = 1)               #0.251957276e3
sw_gibbs(100, 79.85, 0, dt = 1)               #-0.917529024e3    differs
sw_gibbs(100, 79.85, 0, dp = 1)               #0.971006828e-3    differs
sw_gibbs(100, 79.85, 0, dS = 1, dp = 1)       #-0.305957802e-6
sw_gibbs(100, 79.85, 0, dt = 1, dp = 1)       #0.146211315e-5

sw_gibbs(35.16504, 0, 998.98675)                 #=0.951294557e5
sw_gibbs(35.16504, 0, 998.98675, dS = 1)         #-0.545861581e1
sw_gibbs(35.16504, 0, 998.98675, dt = 1)         #0.160551219e2
sw_gibbs(35.16504, 0, 998.98675, dp = 1)         #0.933770945e-3
sw_gibbs(35.16504, 0, 998.98675, dS = 1, dp = 1) #-0.640757619e-6
sw_gibbs(35.16504, 0, 998.98675, dt = 1, dp = 1) #0.245708012e-6

</code></pre>

<hr>
<h2 id='sw_kappa'>Isentropic Compressibility of Seawater</h2><span id='topic+sw_kappa'></span>

<h3>Description</h3>

<p>Computes the seawater isentropic compressibility, 1/bar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_kappa(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_kappa_+3A_s">S</code></td>
<td>
<p>Salinity (dimensionless),</p>
</td></tr>
<tr><td><code id="sw_kappa_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_kappa_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_kappa_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Isentropic compressibility, 1/bar
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_kappa(35.7, 25.5, 102.3) #4.03386268546478e-6
</code></pre>

<hr>
<h2 id='sw_kappa_t'>Isothermal Compressibility of Seawater</h2><span id='topic+sw_kappa_t'></span>

<h3>Description</h3>

<p>Computes the seawater isothermal compressibility, 1/Pa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_kappa_t(S = 35, t = 25, p = P-1.013253, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_kappa_t_+3A_s">S</code></td>
<td>
<p>Absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_kappa_t_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_kappa_t_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the
local atmospheric pressure, bar</p>
</td></tr>
<tr><td><code id="sw_kappa_t_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>isothermal compressibility, 1/Pa.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_kappa_t(35.7, 25.5, 102.3) #4.10403794615135e-6
</code></pre>

<hr>
<h2 id='sw_sfac'>Salinity conversion factors</h2><span id='topic+sw_sfac'></span>

<h3>Description</h3>

<p>Factors to convert from practical to absolute salinity and
vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_sfac</code></pre>


<h3>Format</h3>

<p>A list with the following:
</p>

<dl>
<dt>longs</dt><dd><p> the longitude, a vector with 91 elements, range (0,360),
third dimension in <code>del_sa</code>,
</p>
</dd>
<dt>lats</dt><dd><p> the latitude, second dimension in <code>del_sa</code>, a vector
with 44 elements, range (-82,90),
</p>
</dd>
<dt>p</dt><dd><p> dbar , the first dimension in <code>del_sa</code>, a vector
with 45 elements, range(0,6131),
</p>
</dd>
<dt>ndepth</dt><dd><p> the number of depth intervals at a certain lat,long,
a matrix of dimension (4,91),
</p>
</dd>
<dt>del_sa</dt><dd><p> the salinity anomaly, an array with dimension (45,44,91),
i.e. for (p, lats, longs) values.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Millero FJ, Feistel R, Wright DG and McDougall TJ, 2008.
The composition of Standard Seawater and the definition of the
Reference-Composition Salinity Scale, Deep-Sea Res. I, 55, 50-72.
</p>
<p>McDougall TJ, Jackett DR  and Millero FJ, 2009. An algorithm
for estimating Absolute Salinity in the global ocean. Ocean Science
Discussions 6, 215-242.
<a href="http://www.ocean-sci-discuss.net/6/215/2009/">http://www.ocean-sci-discuss.net/6/215/2009/</a> 
</p>
<p>Uses the Fortran code written by David Jackett
<a href="http://www.teos-10.org/">http://www.teos-10.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity to
absolute salinity
</p>
<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, to convert from absolute salinity to
practical salinity
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mf &lt;- par(mfrow = c(2, 1))
ma &lt;- par(mar = c(3, 5, 2, 5))

dsal &lt;- t(sw_sfac$del_sa[1, , ])
dsal [dsal &lt; -90] &lt;- NA
image(sw_sfac$longs, sw_sfac$lats, dsal, col = femmecol(100),
      asp = TRUE, xlab = "dg", ylab = "dg",
      main = "salinity conversion - p = 0 bar")
contour(sw_sfac$longs, sw_sfac$lats, dsal, asp = TRUE, add = TRUE)

dsal &lt;- t(sw_sfac$del_sa[5,,])  # 5th depth level sw_sfac$p[5]
dsal [dsal &lt; -90]&lt;-NA
image(sw_sfac$longs, sw_sfac$lats, dsal, col = femmecol(100),
      asp = TRUE, xlab = "dg", ylab = "dg",
      main = "salinity conversion - p = 4 bar")
contour(sw_sfac$longs, sw_sfac$lats, dsal, asp = TRUE, add = TRUE)

par("mfrow" = mf)
par("mar" = ma)
</code></pre>

<hr>
<h2 id='sw_svel'>Velocity of the Sound in Seawater</h2><span id='topic+sw_svel'></span>

<h3>Description</h3>

<p>Computes the velocity of the sound in seawater,
using the UNESCO 1983 polynomial or based on the Gibbs function.
</p>
<p>Valid for salinity from 0 to 40, temperature from 0 to 40 dgC, pressure
from 1 to 1000 bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_svel(S = 35, t = 25, p = P-1.013253, P = 1.013253,
  method = c("Gibbs", "UNESCO"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_svel_+3A_s">S</code></td>
<td>
<p>Salinity, when <code>method</code> = <code>"UNESCO"</code>: practical salinity (-)
else absolute salinity (g/kg),</p>
</td></tr>
<tr><td><code id="sw_svel_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C,</p>
</td></tr>
<tr><td><code id="sw_svel_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="sw_svel_+3A_p">P</code></td>
<td>
<p>true pressure, bar</p>
</td></tr>
<tr><td><code id="sw_svel_+3A_method">method</code></td>
<td>
<p>When &quot;UNESCO&quot;, uses the UNESCO (1983) polynomial,
when &quot;Gibbs&quot;, based on the gibbs functions as in Feistel, 2008 </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sound velocity, in m / sec.
</p>


<h3>Note</h3>

<p>Sound velocity for S = 40, t = 40, p = 1000 is 1731.995 using UNESCO
polynomial.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>
<p>Feistel R, 2008. A Gibbs function for seawater thermodynamics for -6 to
80 dgC and salinity up to 120 g/kg. Deep-Sea Research I, 55, 1639-1671.
</p>
<p>McDougall TJ, Feistel R, Millero FJ, Jackett DR, Wright DG,
King BA, Marion GM, Chen C-T A and Spitzer P, 2009. Calculation
of the Thermophysical Properties of Seawater, Global Ship-based Repeat
Hydrography Manual, IOCCP Report No. 14, ICPO Publication Series no. 134.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>
<p><code><a href="#topic+convert_PStoAS">convert_PStoAS</a></code>, to convert from practical salinity (-) to
absolute salinity (g/kg)
</p>
<p><code><a href="#topic+convert_AStoPS">convert_AStoPS</a></code>, to convert from absolute salinity (g/kg) to
practical salinity (-)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_svel(t = 40, S = 40, p = 10:20, method = "UNESCO")

# Check value UNESCO
sw_svel(t = 40, S = 40, p = 1000, method = "UNESCO")  # 1731.995
sw_svel(t = 0, S = 40, p = 0, method = "UNESCO")      # 1455.8

sw_svel(t = 40, S = 25, p = 1000, method = "UNESCO")  # 1719.2
sw_svel(t = 40, S = 25, p = 0, method = "UNESCO")     # 1553.4
sw_svel(t = 0, S = 25, p = 0, method = "UNESCO")      # 1435.8


# Check value Gibbs
sw_svel(S = 35.7, t = 25.5, p = 102.3)              # 1552.93372863425

</code></pre>

<hr>
<h2 id='sw_tfreeze'>Freezing Temperature of Seawater</h2><span id='topic+sw_tfreeze'></span>

<h3>Description</h3>

<p>Estimates the freezing temperature of seawater, using the UNESCO 1983
polynomial.
</p>
<p>Valid for salinity 4-40
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_tfreeze(S=35, p = P-1.013253, P = 1.013253 )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_tfreeze_+3A_s">S</code></td>
<td>
<p>practical salinity, -,
</p>
</td></tr>
<tr><td><code id="sw_tfreeze_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="sw_tfreeze_+3A_p">P</code></td>
<td>
<p>true pressure, bar
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Temperature, <code class="reqn">^\circ</code>C
</p>


<h3>Note</h3>

<p>freezing temperature for S = 40, <code>p</code> = 50 is -2.588567 dgC.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tpot">sw_tpot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_tfreeze(S = 40,p = 50)

## Check values
sw_tfreeze(S = 10,p = 0)  #-0.542
sw_tfreeze(S = 10,p = 10) #-0.618
sw_tfreeze(S = 30,p = 0)  #-1.638
sw_tfreeze(S = 40,p = 50) #-2.589

</code></pre>

<hr>
<h2 id='sw_tpot'>Potential Temperature of Seawater</h2><span id='topic+sw_tpot'></span>

<h3>Description</h3>

<p>Estimates the potential temperature of seawater, using the UNESCO 1983
polynomial.
</p>
<p>It is the temperature an element of seawater would have if raised
adiabatically with no change of salinity, to atmospheric pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw_tpot(S = 35, t = 25, p, pref = 0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sw_tpot_+3A_t">t</code></td>
<td>
<p>temperature, <code class="reqn">^\circ</code>C,
</p>
</td></tr>
<tr><td><code id="sw_tpot_+3A_s">S</code></td>
<td>
<p>practical salinity, -,
</p>
</td></tr>
<tr><td><code id="sw_tpot_+3A_p">p</code></td>
<td>
<p>gauge or applied pressure, pressure referenced against the local
atmospheric pressure, bar
</p>
</td></tr>
<tr><td><code id="sw_tpot_+3A_pref">pref</code></td>
<td>
<p>reference hydrostatic pressure, bar.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Temperature, <code class="reqn">^\circ</code>C.
</p>


<h3>Note</h3>

<p><code>sw_tpot</code> for S = 40, t = 40, p = 1000 is 36.89073 dgC
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Fofonoff NP and Millard RC Jr, 1983. Algorithms for computation of
fundamental properties of seawater. UNESCO technical papers in marine
science, 44, 53 pp.<br />
<a href="http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf">http://unesdoc.unesco.org/images/0005/000598/059832EB.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sw_adtgrad">sw_adtgrad</a></code>, <code><a href="#topic+sw_alpha">sw_alpha</a></code>, <code><a href="#topic+sw_beta">sw_beta</a></code>,
<code><a href="#topic+sw_comp">sw_comp</a></code>, <code><a href="#topic+sw_conserv">sw_conserv</a></code>, <code><a href="#topic+sw_cp">sw_cp</a></code>,
<code><a href="#topic+sw_dens">sw_dens</a></code>,
<code><a href="#topic+sw_depth">sw_depth</a></code>, <code><a href="#topic+sw_enthalpy">sw_enthalpy</a></code>, <code><a href="#topic+sw_entropy">sw_entropy</a></code>,
<code><a href="#topic+sw_gibbs">sw_gibbs</a></code>, <code><a href="#topic+sw_kappa">sw_kappa</a></code>,
<code><a href="#topic+sw_kappa_t">sw_kappa_t</a></code>, <code><a href="#topic+sw_sfac">sw_sfac</a></code>,
<code><a href="#topic+sw_svel">sw_svel</a></code>, <code><a href="#topic+sw_tfreeze">sw_tfreeze</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw_tpot(S = 40, t = 40:45, p = 1000)

## check values
sw_tpot(S = 25, t = 40, p = 0)      #40
sw_tpot(S = 25, t = 40, p = 100)    #36.6921
sw_tpot(S = 25, t = 10, p = 1000)   #8.4684
sw_tpot(S = 25, t = 0, p = 100)     #-0.0265

sw_tpot(S = 40, t = 40, p = 1000)  #36.89073
</code></pre>

<hr>
<h2 id='vapor'>Saturation Water Vapor Pressure</h2><span id='topic+vapor'></span>

<h3>Description</h3>

<p>The partial pressure of water in saturated air (pH20/P), as in Weiss
and Price (1980), where P is the total atmospheric pressure, (1
atmosphere), and pH2O is the partial pressure of the water vapor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vapor(S = 35, t = 25)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vapor_+3A_s">S</code></td>
<td>
<p>Salinity (-),</p>
</td></tr>
<tr><td><code id="vapor_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The saturation vapor pressure (-).
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Sarmiento JL and Gruber N, 2006. Ocean Biogeochemical
Dynamics. Princeton University Press, Princeton. p 74
</p>
<p>Weiss R and Price BA, 1980. Nitrous oxide solubility in water and
seawater. Mar. Chem. 8, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+gas_transfer">gas_transfer</a></code>, <code><a href="#topic+atmComp">atmComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(0:30, vapor(t = 0:30), xlab = "Temperature, dgC", ylab = "pH2O/P")
</code></pre>

<hr>
<h2 id='vapor.hPa'>Vapor Pressure</h2><span id='topic+vapor.hPa'></span>

<h3>Description</h3>

<p>The vapor pressure of water, in hPa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vapor.hPa(t = 25)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vapor.hPa_+3A_t">t</code></td>
<td>
<p>Temperature, <code class="reqn">^\circ</code>C.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vapor pressure of water, in hecto Pascal; valid for temperature of
[-50,100] dgC.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;,
Lorenz Meire &lt;lorenz.meire@nioz.nl&gt;</p>


<h3>References</h3>

<p>Lowe, P.R. and J.M. Ficke, 1974: The computation of saturation vapor pressure. Tech.
Paper No. 4-74, Environmental Prediction Research Facility, Naval Postgraduate School,
Monterey, CA, 27 pp.
</p>
<p><a href="http://www.cactus2000.de/uk/unit/masshum.shtml">http://www.cactus2000.de/uk/unit/masshum.shtml</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vapor">vapor</a></code>, <code><a href="#topic+air_spechum">air_spechum</a></code>, <code><a href="#topic+air_density">air_density</a></code>,
<code><a href="#topic+gas_O2sat">gas_O2sat</a></code>, <code><a href="#topic+gas_satconc">gas_satconc</a></code>,
<code><a href="#topic+gas_schmidt">gas_schmidt</a></code>, <code><a href="#topic+gas_solubility">gas_solubility</a></code>,
<code><a href="#topic+gas_transfer">gas_transfer</a></code>, <code><a href="#topic+atmComp">atmComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vapor.hPa(t = 25)
plot(0:30, vapor.hPa(t = 0:30), xlab = "Temperature, dgC", ylab = "hPa")
</code></pre>

<hr>
<h2 id='vertmean'>
Vertical Volume Weighted Mean of Matter Concentrations in Water
Bodies
</h2><span id='topic+vertmean'></span>

<h3>Description</h3>

<p>Calculate vertical mean values which respect to depths of different
layers or lake morphometry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vertmean(depth, vari, level, top, bot, vol, total=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vertmean_+3A_depth">depth</code></td>
<td>
<p>sorted vector of sampled depths,</p>
</td></tr>
<tr><td><code id="vertmean_+3A_vari">vari</code></td>
<td>
<p>measurements corresponding to <code>depth</code> (concentration,
temperature, ...), </p>
</td></tr>
<tr><td><code id="vertmean_+3A_level">level</code></td>
<td>
<p>surface water level (above ground or above sea level (m
a.s.l.), depending on bathymetric function used,</p>
</td></tr>
<tr><td><code id="vertmean_+3A_top">top</code></td>
<td>
<p>top water level of requested layer over which to average or
integrate,</p>
</td></tr>
<tr><td><code id="vertmean_+3A_bot">bot</code></td>
<td>
<p>bottom water level of requested layer over which to average or
intgrate,</p>
</td></tr>
<tr><td><code id="vertmean_+3A_vol">vol</code></td>
<td>
<p>hypsographic function to be used (e.g. <code>vol.depth</code>),</p>
</td></tr>
<tr><td><code id="vertmean_+3A_total">total</code></td>
<td>
<p>if <code>TRUE</code> the total sum over the water body is
returned (integrated value), instead of the volumetric mean.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Volumetric average respectively total value (for total =<code>TRUE</code>) for a
given quantity (concentration, energy, temperature) in the requested
layer between depths <code>top</code> and <code>bottom</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas Petzoldt</p>


<h3>See Also</h3>

<p><code><a href="#topic+coriolis">coriolis</a></code>, <code><a href="#topic+viscosity">viscosity</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+ssd2rad">ssd2rad</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## define a bathymetric formula for a given lake or basin
## z:     water depth  (m below surface)
## zz:    water column (m above ground)
## level: total water depth (m above ground or above reference level)
weight.vol &lt;- function(z, level) {
  zz  &lt;- level - z
  if (any(zz &lt; 0)) stop("depth &gt; maximum depth")
  vol &lt;- 175947 * zz^2 + 2686 * zz^3 # m^3
}

## area is first derivative
area &lt;- function(z, level) {
  zz  &lt;- level - z
  A   &lt;-   0.5 * 175947 * zz + 1/3 * 2686 * zz^2 # m^2
}

## dummy formula for depth-weighted averaging
## (water column, instead of bathymetric curve)
weight.column &lt;- function(z, level) {z}

## Plot of lake volume (bathymetric curve)
par(mfrow = c(1, 2))
z &lt;- 0:12
V &lt;- weight.vol(z, 12)
plot(V, z, type = "l", ylim = c(12, 0), xlab = "Volume (m3)",
  ylab = "Depth (m)")
polygon(c(V, 0), c(z, 0), col = "cyan")

## Test Data
level &lt;- 12
depth &lt;- c(0, 1, 3.5, 5, 7, 10, 10.5, 11.5)
pconc &lt;- c(3.7, 4.2, 6.1, 8.9, 7.8, 9.7, 11.4, 11.4)

## Plot test data
plot(pconc, depth, xlim=range(c(0, pconc)), ylim=c(12,0), type="n",
  xlab="P concentration (mu g / L)", ylab="Depth (m)")
segments(rep(0, 13), depth, pconc, depth, lwd=3)

## simple means
m &lt;- mean(pconc[depth &lt;= 4])
lines(c(m, m), c(0, 4), col="blue", lwd=2)

m &lt;- mean(pconc[depth &gt;= 4])
lines(c(m, m), c(4, 12), col="blue", lwd=2)

## depth weighted
m &lt;- vertmean(depth, pconc, level, top=0, bot=4, weight.column)
lines(c(m, m), c(0, 4), col="red", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.column)
lines(c(m, m), c(4, 12), col="red", lwd=2)

## volume weighted
m &lt;- vertmean(depth, pconc, level, top=0, bot=4, weight.vol)
lines(c(m, m), c(0, 4), col="green", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.vol)
lines(c(m, m), c(4, 12), col="green", lwd=2)

m &lt;- vertmean(depth, pconc, level, top=4, bot=12, weight.vol)
lines(c(m, m), c(4, 12), col="green", lwd=2)

legend("topright", col=c("blue", "red", "green"), lwd=2, cex=0.7,
  legend=c("non weighted", "depth weighted", "volume weighted"))

## total sum over the whole water column
vertmean(depth, pconc, level, top=0, bot=12, weight.vol, total=TRUE)
</code></pre>

<hr>
<h2 id='viscosity'>Shear Viscosity of Water</h2><span id='topic+viscosity'></span>

<h3>Description</h3>

<p>Calculates the shear viscosity of water, in centipoise (g/m/sec).
Valid for 0 &lt; t &lt; 30 <code class="reqn">^\circ</code>C, 0 &lt; S &lt; 36, 1
&lt; P &lt; 1000 bars.
</p>
<p>Based on the code &quot;CANDI&quot; by B.P. Boudreau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viscosity(S = 35, t = 25, P = 1.013253)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="viscosity_+3A_s">S</code></td>
<td>
<p>salinity, -,
</p>
</td></tr>
<tr><td><code id="viscosity_+3A_t">t</code></td>
<td>
<p>temperature, <code class="reqn">^\circ</code>C,
</p>
</td></tr>
<tr><td><code id="viscosity_+3A_p">P</code></td>
<td>
<p>True pressure, bar.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The details given in the original code by B. Boudreau are repeated here:
</p>
<p>Uses the equation given by Kukulka et al. (1987).
</p>


<h3>Value</h3>

<p>Shear visocisity in centipoise.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>References</h3>

<p>Based on the FORTRAN implementation of the diagenetic model &quot;CANDI&quot; of
B.P. Boudreau:
</p>
<p>Boudreau BP, 1996. A method-of-lines code for carbon and
nutrient diagenesis in aquatic sediments.  Computers &amp; Geosciences 22
(5), 479-496.
</p>
<p>Kulkula DJ, Gebhart B and Mollendorf JC, 1987. Thermodynamic and
transport properties of pure and saline water. Adv. Heat transfer 18,
325-363.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coriolis">coriolis</a></code>,
<code><a href="#topic+diffcoeff">diffcoeff</a></code>, <code><a href="#topic+ssd2rad">ssd2rad</a></code>, <code><a href="#topic+vertmean">vertmean</a></code>,
<code><a href="#topic+gravity">gravity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(0:30, viscosity(t = 0:30, S = 35, P = 1),
      xlab = "temperature", ylab = "g/m/s",
      main = "shear viscosity of water", type = "l")
lines(0:30, viscosity(t = 0:30, S = 0, P = 1), col = "red")
lines(0:30, viscosity(t = 0:30, S = 35, P = 100), col = "blue")
legend("topright", col = c("black","red","blue"), lty = 1,
        legend = c("S=35, P=1", "S=0, P=1", "S=35, P=100"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
