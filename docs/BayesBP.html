<!DOCTYPE html><html><head><title>Help for package BayesBP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesBP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bin'><p>Binomial function</p></a></li>
<li><a href='#BP2D'><p>Bayesian estimation using two dimensions Bernstein polynomial</p></a></li>
<li><a href='#BP2D_coef'><p>Getting coefficeint from BP2D result.</p></a></li>
<li><a href='#BP2D_table'><p>Table and Criterion.</p></a></li>
<li><a href='#BPbasis'><p>Bernstein polynomial basis.</p></a></li>
<li><a href='#BPFhat'><p>Two dimensional Bernstein polynomial</p></a></li>
<li><a href='#Credible_interval'><p>Credible interval.</p></a></li>
<li><a href='#gen_data'><p>Generated data</p></a></li>
<li><a href='#M'><p>Risky population function</p></a></li>
<li><a href='#PD_BPbasis'><p>Partial differential Bernstein polynomial basis.</p></a></li>
<li><a href='#PD_BPFhat'><p>Two dimensional Bernstein polynomial</p></a></li>
<li><a href='#PD_Credible_interval'><p>Credible interval.</p></a></li>
<li><a href='#Rhat'><p>Gelman Rubin statistics.</p></a></li>
<li><a href='#scale_to_01'><p>Scale to [0,1]</p></a></li>
<li><a href='#simulated_data_1'><p>Generate simulated data 1</p></a></li>
<li><a href='#simulated_data_2'><p>Generate simulated data 2</p></a></li>
<li><a href='#write.BP'><p>Write xlsx file</p></a></li>
<li><a href='#write.BPtable'><p>Write BPtalbe as xlsx file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Estimation using Bernstein Polynomial Fits Rate Matrix</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Li-Syuan Hong [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Li-Syuan Hong &lt;lisyuan@nhri.org.tw&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Smoothed lexis diagrams with Bayesian method specifically tailored to cancer 
             incidence data. Providing to calculating slope and constructing credible interval.
             LC Chien et al. (2015) &lt;<a href="https://doi.org/10.1080%2F01621459.2015.1042106">doi:10.1080/01621459.2015.1042106</a>&gt;. 
             LH Chien et al. (2017) &lt;<a href="https://doi.org/10.1002%2Fcam4.1102">doi:10.1002/cam4.1102</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-08-17</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),parallel,iterators,utils,stats,openxlsx</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-27 01:25:38 UTC; LiSyuan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-08-27 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bin'>Binomial function</h2><span id='topic+bin'></span>

<h3>Description</h3>

<p>Binomial function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin(n, i, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_+3A_n">n</code></td>
<td>
<p>Integer.</p>
</td></tr>
<tr><td><code id="bin_+3A_i">i</code></td>
<td>
<p>Integer(i &lt; n).</p>
</td></tr>
<tr><td><code id="bin_+3A_x">x</code></td>
<td>
<p>Numeric(0&lt;= x &lt;=1).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>bin(5,3,.5)
</code></pre>

<hr>
<h2 id='BP2D'>Bayesian estimation using two dimensions Bernstein polynomial</h2><span id='topic+BP2D'></span>

<h3>Description</h3>

<p>This function runs Metropolis-Hasting algorithm which is given setting prior and data.This algorithm starts storing coefficients when it runs halfway,so we use second halves of coefficients compute Rhat to check convergence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP2D(
  prior,
  ages,
  years,
  disease,
  population,
  Iterations = 2e+05,
  n_chain = 5,
  n_cluster = 1,
  nn = 2,
  interval = 100,
  RJC = 0.35,
  seed = TRUE,
  set = 1,
  double = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP2D_+3A_prior">prior</code></td>
<td>
<p>prior=(n0,alpha,L) where alpha is a Poisson parameter,n0 is upper bound of alpha
L can be every number which is bigger than one.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_ages">ages</code></td>
<td>
<p>Range of ages.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_years">years</code></td>
<td>
<p>Range of years.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_disease">disease</code></td>
<td>
<p>Disease matrix.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_population">population</code></td>
<td>
<p>Population matrix.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_iterations">Iterations</code></td>
<td>
<p>Iterations of chain.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_n_chain">n_chain</code></td>
<td>
<p>Number of Markov chain.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_n_cluster">n_cluster</code></td>
<td>
<p>This parameter means number of cores, five cores is recommended.(default: n_cluster=1).</p>
</td></tr>
<tr><td><code id="BP2D_+3A_nn">nn</code></td>
<td>
<p>The parameter nn is lower bound of alpha.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_interval">interval</code></td>
<td>
<p>Each hundreds save one coefficient.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_rjc">RJC</code></td>
<td>
<p>Control parameter for transfer dimension.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_seed">seed</code></td>
<td>
<p>Set seed yes or not.</p>
</td></tr>
<tr><td><code id="BP2D_+3A_set">set</code></td>
<td>
<p>Choose seed.(defaults:set=1)</p>
</td></tr>
<tr><td><code id="BP2D_+3A_double">double</code></td>
<td>
<p>If R.hat &gt;1.1 then double the iterations of times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function will return Bayesian estimate of incidence,Stored parameters,posterior mean,posterior max and table.
</p>
<table>
<tr><td><code>Fhat</code></td>
<td>
<p>Bayesian estimate of incidence.</p>
</td></tr>
<tr><td><code>chain</code></td>
<td>
<p>Bayesian estimate of posterior p-value mean.</p>
</td></tr>
<tr><td><code>maxchain</code></td>
<td>
<p>Bayesian estimate of posterior p-value max.</p>
</td></tr>
<tr><td><code>store_coefficients</code></td>
<td>
<p>Two dimensional Bernstein coefficients.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>When M-H algorithm ends,contruct the table which contains norm,mean of Fhat,maximum of Fhat,R.hat,iterations,P-value and elasped time.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Li-Chu Chien,Yuh-Jenn Wu,Chao A. Hsiung,Lu-Hai Wang,I-Shou Chang(2015).Smoothed Lexis Diagrams With Applications to Lung and Breast Cancer Trends in Taiwan,Journal of the American Statistical Association, Taylor &amp; Francis Journals, vol. 110(511), pages 1000-1012, September.
</p>


<h3>See Also</h3>

<p>Other Bayesain estimate: 
<code><a href="#topic+BP2D_coef">BP2D_coef</a>()</code>,
<code><a href="#topic+BP2D_table">BP2D_table</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ---------------------------------------- #
library(BayesBP)
ages&lt;-35:85
years&lt;-1988:2007
prior&lt;-c(10,5,2)
data(simulated_data_1)
disease&lt;-simulated_data_1$disease
population&lt;-simulated_data_1$population
result&lt;-BP2D(prior,ages,years,disease,population)
# ---------------------------------------- #
# Bernstein basis
basis&lt;-BPbasis(ages,years,10)
pdbasis1&lt;-PD_BPbasis(ages,years,10,by = 1)
pdbasis2&lt;-PD_BPbasis(ages,years,10,by = 2)
# Bernstein polynomial
coef&lt;-result$store_coefficients$chain_1[[1]]
BPFhat(coef,ages,years,basis)
PD_BPFhat(coef,ages,years,pdbasis1,by = 1)
PD_BPFhat(coef,ages,years,pdbasis2,by = 2)
# Credible interval
Credible_interval(result)
PD_Credible_interval(result,by = 1)
PD_Credible_interval(result,by = 2)
# ---------------------------------------- #
# Given four prior set
ages&lt;-35:85
years&lt;-1988:2007
data(simulated_data_2)
disease&lt;-simulated_data_2$disease
population&lt;-simulated_data_2$population
p&lt;-expand.grid(n0=c(10,20),alpha=c(5,10),LL=c(2,4))
prior_set&lt;-p[p$n0==p$alpha*2,]
result_list&lt;-paste0('result',1:nrow(prior_set))
for (i in seq_len(nrow(prior_set))) {
   prior&lt;-prior_set[i,]
   assign(result_list[i],BP2D(prior,ages,years,disease,population))
   write.BP(get(result_list[i]),sprintf('%s.xlsx',result_list[i]))
}
tab&lt;-BP2D_table(result_list)
write.BPtable(tab,'result_table.xlsx')
# ---------------------------------------- #

</code></pre>

<hr>
<h2 id='BP2D_coef'>Getting coefficeint from BP2D result.</h2><span id='topic+BP2D_coef'></span>

<h3>Description</h3>

<p>This function will return coefficient and length of each set of coefficeint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP2D_coef(result)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP2D_coef_+3A_result">result</code></td>
<td>
<p>This is output of BP2D.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Coefficients table.
</p>


<h3>See Also</h3>

<p>Other Bayesain estimate: 
<code><a href="#topic+BP2D_table">BP2D_table</a>()</code>,
<code><a href="#topic+BP2D">BP2D</a>()</code>
</p>

<hr>
<h2 id='BP2D_table'>Table and Criterion.</h2><span id='topic+BP2D_table'></span>

<h3>Description</h3>

<p>If you give more groups of prior,you can use this function to get the table and T criterion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP2D_table(results_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP2D_table_+3A_results_list">results_list</code></td>
<td>
<p>A vector of characters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table and criterion T.
</p>


<h3>See Also</h3>

<p>Other Bayesain estimate: 
<code><a href="#topic+BP2D_coef">BP2D_coef</a>()</code>,
<code><a href="#topic+BP2D">BP2D</a>()</code>
</p>

<hr>
<h2 id='BPbasis'>Bernstein polynomial basis.</h2><span id='topic+BPbasis'></span>

<h3>Description</h3>

<p>This function build two dimensional Bernstein polynomial basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BPbasis(ages, years, n0, N = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BPbasis_+3A_ages">ages</code></td>
<td>
<p>Range of ages.</p>
</td></tr>
<tr><td><code id="BPbasis_+3A_years">years</code></td>
<td>
<p>Range of years.</p>
</td></tr>
<tr><td><code id="BPbasis_+3A_n0">n0</code></td>
<td>
<p>Upper bound of possion random variable.</p>
</td></tr>
<tr><td><code id="BPbasis_+3A_n">N</code></td>
<td>
<p>Lower bound of possion random variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bernstein basis.
</p>


<h3>See Also</h3>

<p>Other Bernstein basis: 
<code><a href="#topic+PD_BPbasis">PD_BPbasis</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ages &lt;- 35:85
years &lt;- 1988:2007
list.basis &lt;- BPbasis(ages,years,10)
list.basis
</code></pre>

<hr>
<h2 id='BPFhat'>Two dimensional Bernstein polynomial</h2><span id='topic+BPFhat'></span>

<h3>Description</h3>

<p>Given Bernstein polynomial coeffients to compute Fhat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BPFhat(coef, ages, years, basis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BPFhat_+3A_coef">coef</code></td>
<td>
<p>Bernstein polynomial coefficients.</p>
</td></tr>
<tr><td><code id="BPFhat_+3A_ages">ages</code></td>
<td>
<p>Range of ages.</p>
</td></tr>
<tr><td><code id="BPFhat_+3A_years">years</code></td>
<td>
<p>Range of years.</p>
</td></tr>
<tr><td><code id="BPFhat_+3A_basis">basis</code></td>
<td>
<p>Bernstein polynomial basis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function return outer Bernstein polynomial using coefficients.
</p>


<h3>See Also</h3>

<p>Other outer Bernstein polynomial: 
<code><a href="#topic+PD_BPFhat">PD_BPFhat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coef &lt;- runif(9)
ages &lt;- 35:85
years &lt;- 1988:2007
list.basis &lt;- BPbasis(ages,years,10)
BPFhat(coef,ages,years,list.basis)
</code></pre>

<hr>
<h2 id='Credible_interval'>Credible interval.</h2><span id='topic+Credible_interval'></span>

<h3>Description</h3>

<p>Builing two dimensional Bernstein polynomial credible interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Credible_interval(result, n_cluster = 1, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Credible_interval_+3A_result">result</code></td>
<td>
<p>This is output of BP2D.</p>
</td></tr>
<tr><td><code id="Credible_interval_+3A_n_cluster">n_cluster</code></td>
<td>
<p>Muticores is remmended.(default:n_cluster=1)</p>
</td></tr>
<tr><td><code id="Credible_interval_+3A_alpha">alpha</code></td>
<td>
<p>Level of significance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bayesian credible interval with level of significance.
</p>


<h3>References</h3>

<p>L.H. Chien, T.J. Tseng, C.H. Chen, H.F. Jiang, F.Y. Tsai, T.W. Liu, C.A. Hsiung, I.S. Chang Comparison of annual percentage change in breast cancer incidence rate between Taiwan and the United States-A smoothed Lexis diagram approach.
</p>


<h3>See Also</h3>

<p>Other Credible interval: 
<code><a href="#topic+PD_Credible_interval">PD_Credible_interval</a>()</code>
</p>

<hr>
<h2 id='gen_data'>Generated data</h2><span id='topic+gen_data'></span>

<h3>Description</h3>

<p>Generated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_data(ages, years, FT, M)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_data_+3A_ages">ages</code></td>
<td>
<p>Ages.</p>
</td></tr>
<tr><td><code id="gen_data_+3A_years">years</code></td>
<td>
<p>Years.</p>
</td></tr>
<tr><td><code id="gen_data_+3A_ft">FT</code></td>
<td>
<p>Rate function.</p>
</td></tr>
<tr><td><code id="gen_data_+3A_m">M</code></td>
<td>
<p>Population function.</p>
</td></tr>
</table>

<hr>
<h2 id='M'>Risky population function</h2><span id='topic+M'></span>

<h3>Description</h3>

<p>Risky population function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M_+3A_x">x</code></td>
<td>
<p>Numeric.</p>
</td></tr>
<tr><td><code id="M_+3A_y">y</code></td>
<td>
<p>Numeric.</p>
</td></tr>
</table>

<hr>
<h2 id='PD_BPbasis'>Partial differential Bernstein polynomial basis.</h2><span id='topic+PD_BPbasis'></span>

<h3>Description</h3>

<p>This function build two dimensional Bernstein polynomial basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PD_BPbasis(ages, years, n0, N = 1, by = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PD_BPbasis_+3A_ages">ages</code></td>
<td>
<p>Range of ages.</p>
</td></tr>
<tr><td><code id="PD_BPbasis_+3A_years">years</code></td>
<td>
<p>Range of years.</p>
</td></tr>
<tr><td><code id="PD_BPbasis_+3A_n0">n0</code></td>
<td>
<p>Upper bound of possion random variable.</p>
</td></tr>
<tr><td><code id="PD_BPbasis_+3A_n">N</code></td>
<td>
<p>Lower bound of possion random variable.</p>
</td></tr>
<tr><td><code id="PD_BPbasis_+3A_by">by</code></td>
<td>
<p>1: partial differential by ages; 2: partial differential by years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Partial differential Bernstein basis.
</p>


<h3>See Also</h3>

<p>Other Bernstein basis: 
<code><a href="#topic+BPbasis">BPbasis</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ages &lt;- 35:85
years &lt;- 1988:2007
pdbasis &lt;- PD_BPbasis(ages,years,10,by = 1)
pdbasis
</code></pre>

<hr>
<h2 id='PD_BPFhat'>Two dimensional Bernstein polynomial</h2><span id='topic+PD_BPFhat'></span>

<h3>Description</h3>

<p>Given Bernstein polynomial coeffients to compute Fhat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PD_BPFhat(coef, ages, years, pdbasis, by = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PD_BPFhat_+3A_coef">coef</code></td>
<td>
<p>Bernstein polynomial coefficients.</p>
</td></tr>
<tr><td><code id="PD_BPFhat_+3A_ages">ages</code></td>
<td>
<p>Range of ages.</p>
</td></tr>
<tr><td><code id="PD_BPFhat_+3A_years">years</code></td>
<td>
<p>Range of years.</p>
</td></tr>
<tr><td><code id="PD_BPFhat_+3A_pdbasis">pdbasis</code></td>
<td>
<p>Partial differential Bernstein polynomial basis.</p>
</td></tr>
<tr><td><code id="PD_BPFhat_+3A_by">by</code></td>
<td>
<p>1: partial differential by ages; 2: partial differential by years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Partial differential Bernstein polynomial given coefficients.
</p>


<h3>See Also</h3>

<p>Other outer Bernstein polynomial: 
<code><a href="#topic+BPFhat">BPFhat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coef &lt;- runif(9)
ages &lt;- 35:85
years &lt;- 1988:2007
pdbasis &lt;- PD_BPbasis(ages,years,10,N=1,by=1)
PD_BPFhat(coef,ages,years,pdbasis,by=1)
</code></pre>

<hr>
<h2 id='PD_Credible_interval'>Credible interval.</h2><span id='topic+PD_Credible_interval'></span>

<h3>Description</h3>

<p>Builing two dimensional Bernstein polynomial credible interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PD_Credible_interval(result, n_cluster = 1, alpha = 0.05, by = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PD_Credible_interval_+3A_result">result</code></td>
<td>
<p>This is output of BP2D.</p>
</td></tr>
<tr><td><code id="PD_Credible_interval_+3A_n_cluster">n_cluster</code></td>
<td>
<p>Muticores is remmended.(default:n_cluster=1)</p>
</td></tr>
<tr><td><code id="PD_Credible_interval_+3A_alpha">alpha</code></td>
<td>
<p>Level of significance.</p>
</td></tr>
<tr><td><code id="PD_Credible_interval_+3A_by">by</code></td>
<td>
<p>1: partial differential by ages; 2: partial differential by years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bayesian credible interval with level of significance.
</p>


<h3>References</h3>

<p>L.H. Chien, T.J. Tseng, C.H. Chen, H.F. Jiang, F.Y. Tsai, T.W. Liu, C.A. Hsiung, I.S. Chang Comparison of annual percentage change in breast cancer incidence rate between Taiwan and the United States-A smoothed Lexis diagram approach.
</p>


<h3>See Also</h3>

<p>Other Credible interval: 
<code><a href="#topic+Credible_interval">Credible_interval</a>()</code>
</p>

<hr>
<h2 id='Rhat'>Gelman Rubin statistics.</h2><span id='topic+Rhat'></span>

<h3>Description</h3>

<p>Check Markov chains for convergence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rhat(M, burn.in = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rhat_+3A_m">M</code></td>
<td>
<p>An n x m numeric matrix of Markov Chains.</p>
</td></tr>
<tr><td><code id="Rhat_+3A_burn.in">burn.in</code></td>
<td>
<p>The default value 0.5 means that the second halves of chains will be used to compute.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gelman Rubin statistics.
</p>


<h3>References</h3>

<p>Gelman A.,Carlin J.B.,Stern H.S.,and Rubin D.B.(2004),Bayesian Data Analysis,Boca Raton,FL:Chapman&amp;Hall/CRC.
</p>

<hr>
<h2 id='scale_to_01'>Scale to [0,1]</h2><span id='topic+scale_to_01'></span>

<h3>Description</h3>

<p>Scale to [0,1]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_to_01(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_to_01_+3A_x">x</code></td>
<td>
<p>Vector.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>scale_to_01(35:85)
(35:85-35)/(85-35)
scale_to_01(runif(10))
</code></pre>

<hr>
<h2 id='simulated_data_1'>Generate simulated data 1</h2><span id='topic+simulated_data_1'></span>

<h3>Description</h3>

<p>Given rate function 1 generated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simulated_data_1)
</code></pre>


<h3>Format</h3>

<p>list of matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ages &lt;- 35:85
years &lt;- 1988:2007
FT1 &lt;- function(x,y){0.00148*sin(0.5*pi*x*y)+0.00002}
simulated_data_1 &lt;- gen_data(ages,years,FT1,M)
</code></pre>

<hr>
<h2 id='simulated_data_2'>Generate simulated data 2</h2><span id='topic+simulated_data_2'></span>

<h3>Description</h3>

<p>Given rate function 2 generated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simulated_data_2)
</code></pre>


<h3>Format</h3>

<p>list of matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ages &lt;- 35:85
years &lt;- 1988:2007
FT2 &lt;- function(x,y){0.00148*sin(0.5*pi*x*(y+0.2))+0.00002}
simulated_data_2 &lt;- gen_data(ages,years,FT2,M)
</code></pre>

<hr>
<h2 id='write.BP'>Write xlsx file</h2><span id='topic+write.BP'></span>

<h3>Description</h3>

<p>This function will write result of BP2D to xlsx file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.BP(writedata, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.BP_+3A_writedata">writedata</code></td>
<td>
<p>result of BP2D(character or list).</p>
</td></tr>
<tr><td><code id="write.BP_+3A_filename">filename</code></td>
<td>
<p>xlsx file name.</p>
</td></tr>
</table>

<hr>
<h2 id='write.BPtable'>Write BPtalbe as xlsx file</h2><span id='topic+write.BPtable'></span>

<h3>Description</h3>

<p>If your environment has some result of BP2D,then you can use this function to store BPTable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.BPtable(BPtable, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.BPtable_+3A_bptable">BPtable</code></td>
<td>
<p>output of BP2D_table.</p>
</td></tr>
<tr><td><code id="write.BPtable_+3A_filename">filename</code></td>
<td>
<p>xlsx file name.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
