<!DOCTYPE html><html><head><title>Help for package moveHMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {moveHMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.moveHMM'><p>AIC</p></a></li>
<li><a href='#allProbs'><p>Matrix of all probabilities</p></a></li>
<li><a href='#angleCI'><p>Confidence intervals for angle parameters</p></a></li>
<li><a href='#CI'><p>Confidence intervals</p></a></li>
<li><a href='#dexp_rcpp'><p>Exponential density function</p></a></li>
<li><a href='#dgamma_rcpp'><p>Gamma density function</p></a></li>
<li><a href='#dlnorm_rcpp'><p>Log-normal density function</p></a></li>
<li><a href='#dvm_rcpp'><p>Von Mises density function</p></a></li>
<li><a href='#dweibull_rcpp'><p>Weibull density function</p></a></li>
<li><a href='#dwrpcauchy_rcpp'><p>Wrapped Cauchy density function</p></a></li>
<li><a href='#elk_data'><p>Elk data set from Morales et al. (2004, Ecology)</p></a></li>
<li><a href='#example'><p>Example dataset</p></a></li>
<li><a href='#exGen'><p>Example data simulation</p></a></li>
<li><a href='#fitHMM'><p>Fit an HMM to the data</p></a></li>
<li><a href='#getPalette'><p>Discrete colour palette for states</p></a></li>
<li><a href='#getPlotData'><p>Data to produce plots of fitted model</p></a></li>
<li><a href='#haggis_data'><p>Wild haggis data set from Michelot et al. (2016, Methods Eco Evol)</p></a></li>
<li><a href='#is.moveData'><p>Is moveData</p></a></li>
<li><a href='#is.moveHMM'><p>Is moveHMM</p></a></li>
<li><a href='#logAlpha'><p>Forward log-probabilities</p></a></li>
<li><a href='#logBeta'><p>Backward log-probabilities</p></a></li>
<li><a href='#moveData'><p>Constructor of <code>moveData</code> objects</p></a></li>
<li><a href='#moveHMM'><p>Constructor of <code>moveHMM</code> objects</p></a></li>
<li><a href='#n2w'><p>Scaling function: natural to working parameters.</p></a></li>
<li><a href='#nLogLike'><p>Negative log-likelihood function</p></a></li>
<li><a href='#nLogLike_rcpp'><p>Negative log-likelihood</p></a></li>
<li><a href='#parDef'><p>Parameters definition</p></a></li>
<li><a href='#plot.moveData'><p>Plot <code>moveData</code></p></a></li>
<li><a href='#plot.moveHMM'><p>Plot <code>moveHMM</code></p></a></li>
<li><a href='#plotPR'><p>Plot pseudo-residuals</p></a></li>
<li><a href='#plotSat'><p>Plot observations on satellite image</p></a></li>
<li><a href='#plotStates'><p>Plot states</p></a></li>
<li><a href='#plotStationary'><p>Plot stationary state probabilities</p></a></li>
<li><a href='#predictStationary'><p>Predict stationary state probabilities</p></a></li>
<li><a href='#predictTPM'><p>Predict transition probabilities for new covariate values</p></a></li>
<li><a href='#prepData'><p>Preprocessing of the tracking data</p></a></li>
<li><a href='#print.moveHMM'><p>Print <code>moveHMM</code></p></a></li>
<li><a href='#pseudoRes'><p>Pseudo-residuals</p></a></li>
<li><a href='#simData'><p>Simulation tool</p></a></li>
<li><a href='#stateProbs'><p>State probabilities</p></a></li>
<li><a href='#stationary'><p>Stationary state probabilities</p></a></li>
<li><a href='#summary.moveData'><p>Summary <code>moveData</code></p></a></li>
<li><a href='#trMatrix_rcpp'><p>Transition probability matrix</p></a></li>
<li><a href='#turnAngle'><p>Turning angle</p></a></li>
<li><a href='#viterbi'><p>Viterbi algorithm</p></a></li>
<li><a href='#w2n'><p>Scaling function: working to natural parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Animal Movement Modelling using Hidden Markov Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Theo Michelot (aut, cre), Roland Langrock (aut, cre), 
    Toby Patterson (aut, cre), Brett McClintock (ctb), Eric Rexstad (ctb)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Theo Michelot &lt;theo.michelot@dal.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for animal movement modelling using hidden Markov
    models. These include processing of tracking data, fitting hidden Markov models
    to movement data, visualization of data and fitted model, decoding of the state
    process, etc. &lt;<a href="https://doi.org/10.1111%2F2041-210X.12578">doi:10.1111/2041-210X.12578</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/TheoMichelot/moveHMM">https://github.com/TheoMichelot/moveHMM</a>,
<a href="https://cran.r-project.org/package=moveHMM">https://cran.r-project.org/package=moveHMM</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>CircStats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, boot, MASS, sp, geosphere, ggplot2, ggmap, numDeriv</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-08 14:06:30 UTC; theo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-08 18:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.moveHMM'>AIC</h2><span id='topic+AIC.moveHMM'></span>

<h3>Description</h3>

<p>Akaike information criterion of a moveHMM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moveHMM'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.moveHMM_+3A_object">object</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
<tr><td><code id="AIC.moveHMM_+3A_...">...</code></td>
<td>
<p>Optional additional <code>moveHMM</code> objects, to compare AICs of the different models.</p>
</td></tr>
<tr><td><code id="AIC.moveHMM_+3A_k">k</code></td>
<td>
<p>Penalty per parameter. Default: 2; for classical AIC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The AIC of the model(s) provided. If several models are provided, the AICs are output
in ascending order.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m
AIC(m)

</code></pre>

<hr>
<h2 id='allProbs'>Matrix of all probabilities</h2><span id='topic+allProbs'></span>

<h3>Description</h3>

<p>Used in functions <code><a href="#topic+viterbi">viterbi</a></code>, <code><a href="#topic+logAlpha">logAlpha</a></code>, <code><a href="#topic+logBeta">logBeta</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>allProbs(
  data,
  nbStates,
  stepDist,
  angleDist,
  stepPar,
  anglePar = NULL,
  zeroInflation = FALSE,
  knownStates = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="allProbs_+3A_data">data</code></td>
<td>
<p>Object <code>moveData</code>.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states of the HMM.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_stepdist">stepDist</code></td>
<td>
<p>Name of the distribution of the step lengths.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_angledist">angleDist</code></td>
<td>
<p>Name of the distribution of the turning angles.
Set to &quot;none&quot; if the angle distribution should not be estimated.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_steppar">stepPar</code></td>
<td>
<p>Parameters of the step length distribution. Must be provided in a
matrix with one row for each parameter (in the order expected by the pdf of <code>stepDist</code>),
and one column for each state.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_anglepar">anglePar</code></td>
<td>
<p>Parameters of the turning angle distribution. Must be provided in a
matrix with one row for each parameter (in the order expected by the pdf of <code>angleDist</code>),
and one column for each state. Default: <code>NULL</code> ; if the turning angles distribution
is not estimated.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_zeroinflation">zeroInflation</code></td>
<td>
<p><code>TRUE</code> if the step length distribution is inflated in zero.
Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="allProbs_+3A_knownstates">knownStates</code></td>
<td>
<p>Vector of values of the state process which are known prior to fitting the
model (if any). Default: NULL (states are not known). This should be a vector with length the number
of rows of 'data'; each element should either be an integer (the value of the known states) or NA if
the state is not known.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of all probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
stepPar &lt;- c(1,10,1,5,0.2,0.3)
anglePar &lt;- c(0,pi,0.5,2)
stepDist &lt;- "gamma"
angleDist &lt;- "vm"
data &lt;- simData(nbAnimals=5,nbStates=2,stepDist=stepDist,angleDist=angleDist,stepPar=stepPar,
                 anglePar=anglePar,nbCovs=2,zeroInflation=TRUE)
P &lt;- allProbs(data=data,nbStates=2,stepDist=stepDist,angleDist=angleDist,
               stepPar=matrix(stepPar,ncol=2,byrow=TRUE),anglePar=matrix(anglePar,ncol=2,
               byrow=TRUE),zeroInflation=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='angleCI'>Confidence intervals for angle parameters</h2><span id='topic+angleCI'></span>

<h3>Description</h3>

<p>Simulation-based computation of confidence intervals for the parameters of the angle distribution.
Used in <code><a href="#topic+CI">CI</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>angleCI(m, alpha, nbSims = 10^6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="angleCI_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object</p>
</td></tr>
<tr><td><code id="angleCI_+3A_alpha">alpha</code></td>
<td>
<p>Range of the confidence intervals. Default: 0.95 (i.e. 95% CIs).</p>
</td></tr>
<tr><td><code id="angleCI_+3A_nbsims">nbSims</code></td>
<td>
<p>Number of simulations. Default: 10^6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following objects:
</p>
<table>
<tr><td><code>lower</code></td>
<td>
<p>Lower bound of the confidence interval for the parameters of the angle distribution</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>Upper bound of the confidence interval for the parameters of the angle distribution</p>
</td></tr>
</table>

<hr>
<h2 id='CI'>Confidence intervals</h2><span id='topic+CI'></span>

<h3>Description</h3>

<p>Computes the confidence intervals of the step length and turning angle parameters,
as well as for the transition probabilities regression parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CI(m, alpha = 0.95, nbSims = 10^6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CI_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object</p>
</td></tr>
<tr><td><code id="CI_+3A_alpha">alpha</code></td>
<td>
<p>Range of the confidence intervals. Default: 0.95 (i.e. 95% CIs).</p>
</td></tr>
<tr><td><code id="CI_+3A_nbsims">nbSims</code></td>
<td>
<p>Number of simulations in the computation of the CIs for the angle parameters.
Default: 10^6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following objects:
</p>
<table>
<tr><td><code>stepPar</code></td>
<td>
<p>Confidence intervals for the parameters of the step lengths distribution</p>
</td></tr>
<tr><td><code>anglePar</code></td>
<td>
<p>Confidence intervals for the parameters of the turning angles distribution</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Confidence intervals for the regression coefficients of the transition probabilities.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

CI(m)

</code></pre>

<hr>
<h2 id='dexp_rcpp'>Exponential density function</h2><span id='topic+dexp_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the exponential distribution (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dexp_rcpp(x, rate, foo = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dexp_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dexp_rcpp_+3A_rate">rate</code></td>
<td>
<p>Rate</p>
</td></tr>
<tr><td><code id="dexp_rcpp_+3A_foo">foo</code></td>
<td>
<p>Unused (for compatibility with template)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='dgamma_rcpp'>Gamma density function</h2><span id='topic+dgamma_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the gamma distribution (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgamma_rcpp(x, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgamma_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dgamma_rcpp_+3A_mu">mu</code></td>
<td>
<p>Mean</p>
</td></tr>
<tr><td><code id="dgamma_rcpp_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='dlnorm_rcpp'>Log-normal density function</h2><span id='topic+dlnorm_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the log-normal distribution (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlnorm_rcpp(x, meanlog, sdlog)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlnorm_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dlnorm_rcpp_+3A_meanlog">meanlog</code></td>
<td>
<p>Mean of the distribution on the log-scale</p>
</td></tr>
<tr><td><code id="dlnorm_rcpp_+3A_sdlog">sdlog</code></td>
<td>
<p>Standard deviation of the distribution on the log-scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='dvm_rcpp'>Von Mises density function</h2><span id='topic+dvm_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the Von Mises distribution, defined as a function
of the modified Bessel function of order 0 (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvm_rcpp(x, mu, kappa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dvm_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dvm_rcpp_+3A_mu">mu</code></td>
<td>
<p>Mean</p>
</td></tr>
<tr><td><code id="dvm_rcpp_+3A_kappa">kappa</code></td>
<td>
<p>Concentration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='dweibull_rcpp'>Weibull density function</h2><span id='topic+dweibull_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the Weibull distribution (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dweibull_rcpp(x, shape, scale)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dweibull_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dweibull_rcpp_+3A_shape">shape</code></td>
<td>
<p>Shape</p>
</td></tr>
<tr><td><code id="dweibull_rcpp_+3A_scale">scale</code></td>
<td>
<p>Scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='dwrpcauchy_rcpp'>Wrapped Cauchy density function</h2><span id='topic+dwrpcauchy_rcpp'></span>

<h3>Description</h3>

<p>Probability density function of the wrapped Cauchy distribution (written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwrpcauchy_rcpp(x, mu, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwrpcauchy_rcpp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dwrpcauchy_rcpp_+3A_mu">mu</code></td>
<td>
<p>Mean</p>
</td></tr>
<tr><td><code id="dwrpcauchy_rcpp_+3A_rho">rho</code></td>
<td>
<p>Concentration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of densities
</p>

<hr>
<h2 id='elk_data'>Elk data set from Morales et al. (2004, Ecology)</h2><span id='topic+elk_data'></span>

<h3>Description</h3>

<p>It is a data frame with the following columns:
</p>

<ul>
<li> <p><code>ID</code> Track identifier
</p>
</li>
<li> <p><code>Easting</code> Easting coordinate of locations
</p>
</li>
<li> <p><code>Northing</code> Northing coordinate of locations
</p>
</li>
<li> <p><code>dist_water</code> Distance of elk to water (in metres)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>elk_data
</code></pre>

<hr>
<h2 id='example'>Example dataset</h2><span id='topic+example'></span>

<h3>Description</h3>

<p>This data is generated by the function <code><a href="#topic+exGen">exGen</a></code>, and used in the examples and tests of
other functions to keep them as short as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example
</code></pre>


<h3>Details</h3>

<p>It is a list of the following objects:
</p>

<ul>
<li> <p><code>data</code> A <code><a href="#topic+moveData">moveData</a></code> object
</p>
</li>
<li> <p><code>m</code> A <code><a href="#topic+moveHMM">moveHMM</a></code> object
</p>
</li>
<li> <p><code>simPar</code> The parameters used to simulate <code>data</code>
</p>
</li>
<li> <p><code>par0</code> The initial parameters in the optimization to fit <code>m</code>
</p>
</li></ul>


<hr>
<h2 id='exGen'>Example data simulation</h2><span id='topic+exGen'></span>

<h3>Description</h3>

<p>Generate the file <code>data/example.RData</code>, used in other functions' examples and unit tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exGen()
</code></pre>

<hr>
<h2 id='fitHMM'>Fit an HMM to the data</h2><span id='topic+fitHMM'></span>

<h3>Description</h3>

<p>Fit an hidden Markov model to the data provided, using numerical optimization of the log-likelihood
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitHMM(
  data,
  nbStates,
  stepPar0,
  anglePar0 = NULL,
  beta0 = NULL,
  delta0 = NULL,
  formula = ~1,
  stepDist = c("gamma", "weibull", "lnorm", "exp"),
  angleDist = c("vm", "wrpcauchy", "none"),
  angleMean = NULL,
  stationary = FALSE,
  knownStates = NULL,
  verbose = 0,
  nlmPar = NULL,
  fit = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitHMM_+3A_data">data</code></td>
<td>
<p>An object <code>moveData</code>.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states of the HMM.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_steppar0">stepPar0</code></td>
<td>
<p>Vector of initial state-dependent step length distribution parameters.
The parameters should be in the order expected by the pdf of <code>stepDist</code>, and the zero-mass
parameter should be the last. Note that zero-mass parameters are mandatory if there are steps of
length zero in the data.
For example, for a 2-state model using the gamma distribution and
including zero-inflation, the vector of initial parameters would be something like:
<code>c(mu1,mu2,sigma1,sigma2,zeromass1,zeromass2)</code>.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_anglepar0">anglePar0</code></td>
<td>
<p>Vector of initial state-dependent turning angle distribution parameters.
The parameters should be in the order expected by the pdf of <code>angleDist</code>. For example, for a 2-state
model using the Von Mises (vm) distribution, the vector of initial parameters would be something like:
<code>c(mu1,mu2,kappa1,kappa2)</code>.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_beta0">beta0</code></td>
<td>
<p>Initial matrix of regression coefficients for the transition probabilities (more
information in &quot;Details&quot;).
Default: <code>NULL</code>. If not specified, <code>beta0</code> is initialized such that the diagonal elements
of the transition probability matrix are dominant.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_delta0">delta0</code></td>
<td>
<p>Initial value for the initial distribution of the HMM. Default: <code>rep(1/nbStates,nbStates)</code>.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_formula">formula</code></td>
<td>
<p>Regression formula for the covariates. Default: <code>~1</code> (no covariate effect).</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_stepdist">stepDist</code></td>
<td>
<p>Name of the distribution of the step lengths (as a character string).
Supported distributions are: gamma, weibull, lnorm, exp. Default: gamma.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_angledist">angleDist</code></td>
<td>
<p>Name of the distribution of the turning angles (as a character string).
Supported distributions are: vm, wrpcauchy. Set to <code>"none"</code> if the angle distribution should
not be estimated. Default: vm.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_anglemean">angleMean</code></td>
<td>
<p>Vector of means of turning angles if not estimated (one for each state).
Default: <code>NULL</code> (the angle mean is estimated).</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_stationary">stationary</code></td>
<td>
<p><code>FALSE</code> if there are covariates. If <code>TRUE</code>, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_knownstates">knownStates</code></td>
<td>
<p>Vector of values of the state process which are known prior to fitting the
model (if any). Default: NULL (states are not known). This should be a vector with length the number
of rows of 'data'; each element should either be an integer (the value of the known states) or NA if
the state is not known.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_verbose">verbose</code></td>
<td>
<p>Determines the print level of the optimizer. The default value of 0 means that no
printing occurs, a value of 1 means that the first and last iterations of the optimization are
detailed, and a value of 2 means that each iteration of the optimization is detailed.</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_nlmpar">nlmPar</code></td>
<td>
<p>List of parameters to pass to the optimization function <code>nlm</code> (which should be either
'<code>gradtol</code>', '<code>stepmax</code>', '<code>steptol</code>', or '<code>iterlim</code>' &ndash; see <code>nlm</code>'s documentation
for more detail)</p>
</td></tr>
<tr><td><code id="fitHMM_+3A_fit">fit</code></td>
<td>
<p><code>TRUE</code> if an HMM should be fitted to the data, <code>FALSE</code> otherwise.
If fit=<code>FALSE</code>, a model is returned with the MLE replaced by the initial parameters given in
input. This option can be used to assess the initial parameters. Default: <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The matrix <code>beta</code> of regression coefficients for the transition probabilities has
one row for the intercept, plus one row for each covariate, and one column for
each non-diagonal element of the transition probability matrix. For example, in a 3-state
HMM with 2 covariates, the matrix <code>beta</code> has three rows (intercept + two covariates)
and six columns (six non-diagonal elements in the 3x3 transition probability matrix -
filled in row-wise).
In a covariate-free model (default), <code>beta</code> has one row, for the intercept.
</p>
</li>
<li><p> The choice of initial parameters is crucial to fit a model. The algorithm might not find
the global optimum of the likelihood function if the initial parameters are poorly chosen.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>moveHMM</code> object, i.e. a list of:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>The maximum likelihood estimates of the parameters of the model
(if the numerical algorithm has indeed identified the global maximum of the
likelihood function), which is a list of: <code>stepPar</code> (step distribution
parameters), <code>anglePar</code> (angle distribution parameters), <code>beta</code>
(transition probabilities regression coefficients - more information in
&quot;Details&quot;), and <code>delta</code> (initial distribution).</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The movement data</p>
</td></tr>
<tr><td><code>mod</code></td>
<td>
<p>The object returned by the numerical optimizer <code>nlm</code></p>
</td></tr>
<tr><td><code>conditions</code></td>
<td>
<p>A few conditions used to fit the model (<code>stepDist</code>,
<code>angleDist</code>, <code>zeroInflation</code>, <code>estAngleMean</code>,
<code>stationary</code>, and <code>formula</code>)</p>
</td></tr>
<tr><td><code>rawCovs</code></td>
<td>
<p>Raw covariate values, as found in the data (if any). Used in
<code><a href="#topic+plot.moveHMM">plot.moveHMM</a></code>.</p>
</td></tr>
<tr><td><code>knownStates</code></td>
<td>
<p>Vector of states known a priori, as provided in input (if
any, <code>NULL</code> otherwise).
Used in <code><a href="#topic+viterbi">viterbi</a></code>,<code><a href="#topic+logAlpha">logAlpha</a></code>, and
<code><a href="#topic+logBeta">logBeta</a></code></p>
</td></tr>
<tr><td><code>nlmTime</code></td>
<td>
<p>Computing time for optimisation, obtained with <a href="base.html#topic+system.time">system.time</a></p>
</td></tr>
</table>


<h3>References</h3>

<p>Patterson T.A., Basson M., Bravington M.V., Gunn J.S. 2009.
Classifying movement behaviour in relation to environmental conditions using hidden Markov models.
Journal of Animal Ecology, 78 (6), 1113-1123.
</p>
<p>Langrock R., King R., Matthiopoulos J., Thomas L., Fortin D., Morales J.M. 2012.
Flexible and practical modeling of animal telemetry data: hidden Markov models and extensions.
Ecology, 93 (11), 2336-2342.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### 1. simulate data
# define all the arguments of simData
nbAnimals &lt;- 2
nbStates &lt;- 2
nbCovs &lt;- 2
mu&lt;-c(15,50)
sigma&lt;-c(10,20)
angleMean &lt;- c(pi,0)
kappa &lt;- c(0.7,1.5)
stepPar &lt;- c(mu,sigma)
anglePar &lt;- c(angleMean,kappa)
stepDist &lt;- "gamma"
angleDist &lt;- "vm"
zeroInflation &lt;- FALSE
obsPerAnimal &lt;- c(50,100)

data &lt;- simData(nbAnimals=nbAnimals,nbStates=nbStates,stepDist=stepDist,angleDist=angleDist,
                 stepPar=stepPar,anglePar=anglePar,nbCovs=nbCovs,zeroInflation=zeroInflation,
                 obsPerAnimal=obsPerAnimal)

### 2. fit the model to the simulated data
# define initial values for the parameters
mu0 &lt;- c(20,70)
sigma0 &lt;- c(10,30)
kappa0 &lt;- c(1,1)
stepPar0 &lt;- c(mu0,sigma0) # no zero-inflation, so no zero-mass included
anglePar0 &lt;- kappa0 # the angle mean is not estimated, so only the concentration parameter is needed
formula &lt;- ~cov1+cos(cov2)

m &lt;- fitHMM(data=data,nbStates=nbStates,stepPar0=stepPar0,anglePar0=anglePar0,formula=formula,
              stepDist=stepDist,angleDist=angleDist,angleMean=angleMean)

print(m)

</code></pre>

<hr>
<h2 id='getPalette'>Discrete colour palette for states</h2><span id='topic+getPalette'></span>

<h3>Description</h3>

<p>Discrete colour palette for states
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPalette(nbStates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPalette_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of colours, of length nbStates.
</p>

<hr>
<h2 id='getPlotData'>Data to produce plots of fitted model</h2><span id='topic+getPlotData'></span>

<h3>Description</h3>

<p>Data to produce plots of fitted model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPlotData(m, type, format = "wide", alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPlotData_+3A_m">m</code></td>
<td>
<p>Fitted HMM object, as output by fitHMM.</p>
</td></tr>
<tr><td><code id="getPlotData_+3A_type">type</code></td>
<td>
<p>Type of plot, one of: &quot;dist&quot;, &quot;tpm&quot;, &quot;stat&quot;</p>
</td></tr>
<tr><td><code id="getPlotData_+3A_format">format</code></td>
<td>
<p>Format of data, either &quot;wide&quot; (for base graphics)
or &quot;long&quot; (for ggplot)</p>
</td></tr>
<tr><td><code id="getPlotData_+3A_alpha">alpha</code></td>
<td>
<p>Level of confidence intervals. Default: 0.95, i.e.,
95% confidence intervals</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>If type = &quot;dist&quot;, the function evaluates each state-dependent
distribution over the range of observed variable (step length or
turning angle), and weighs them by the proportion of time spent
in each state (obtained from Viterbi state sequence).
</p>
</li>
<li><p>If type = &quot;tpm&quot;, the function returns transition probabilities
estimated over a range of covariate values. Other covariates are
fixed to their mean values.
</p>
</li></ul>



<h3>Value</h3>

<p>Data frame (or list of data frames) containing data in a format
that can easily be plotted. If type = &quot;dist&quot;, the output is a list with
two elements, &quot;step&quot; and &quot;angle&quot;. If type = &quot;tpm&quot; or &quot;stat&quot;, the output
is a list with one element for each covariate. See details for more
extensive description of output.
</p>

<hr>
<h2 id='haggis_data'>Wild haggis data set from Michelot et al. (2016, Methods Eco Evol)</h2><span id='topic+haggis_data'></span>

<h3>Description</h3>

<p>Data frame of the first three tracks from Michelot et al. (2016),
with columns:
</p>

<ul>
<li> <p><code>ID</code> Track identifier
</p>
</li>
<li> <p><code>x</code> Easting coordinate of locations
</p>
</li>
<li> <p><code>y</code> Northing coordinate of locations
</p>
</li>
<li> <p><code>slope</code> Terrain slope (in degrees)
</p>
</li>
<li> <p><code>temp</code> Air temperature (in degrees Celsius)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>haggis_data
</code></pre>

<hr>
<h2 id='is.moveData'>Is moveData</h2><span id='topic+is.moveData'></span>

<h3>Description</h3>

<p>Check that an object is of class <code><a href="#topic+moveData">moveData</a></code>. Used in <code><a href="#topic+fitHMM">fitHMM</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.moveData(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.moveData_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if <code>x</code> is of class <code><a href="#topic+moveData">moveData</a></code>, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='is.moveHMM'>Is moveHMM</h2><span id='topic+is.moveHMM'></span>

<h3>Description</h3>

<p>Check that an object is of class <code><a href="#topic+moveHMM">moveHMM</a></code>. Used in <code><a href="#topic+CI">CI</a></code>,
<code><a href="#topic+plotPR">plotPR</a></code>, <code><a href="#topic+plotStates">plotStates</a></code>, <code><a href="#topic+pseudoRes">pseudoRes</a></code>, <code><a href="#topic+stateProbs">stateProbs</a></code>,
and <code><a href="#topic+viterbi">viterbi</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.moveHMM(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.moveHMM_+3A_x">x</code></td>
<td>
<p>An R object</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if <code>x</code> is of class <code><a href="#topic+moveHMM">moveHMM</a></code>, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='logAlpha'>Forward log-probabilities</h2><span id='topic+logAlpha'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+stateProbs">stateProbs</a></code> and <code><a href="#topic+pseudoRes">pseudoRes</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logAlpha(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logAlpha_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of forward log-probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

la &lt;- logAlpha(m)

## End(Not run)
</code></pre>

<hr>
<h2 id='logBeta'>Backward log-probabilities</h2><span id='topic+logBeta'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+stateProbs">stateProbs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logBeta(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logBeta_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of backward log-probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

lb &lt;- logBeta(m)

## End(Not run)
</code></pre>

<hr>
<h2 id='moveData'>Constructor of <code>moveData</code> objects</h2><span id='topic+moveData'></span>

<h3>Description</h3>

<p>Constructor of <code>moveData</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moveData(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moveData_+3A_data">data</code></td>
<td>
<p>A dataframe containing: <code>ID</code> (the ID(s) of the observed animal(s)), <code>step</code>
(the step lengths), <code>angle</code> (the turning angles, if any), <code>x</code> (either easting or longitude),
<code>y</code> (either norting or latitude), and covariates, if any.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object <code>moveData</code>.
</p>

<hr>
<h2 id='moveHMM'>Constructor of <code>moveHMM</code> objects</h2><span id='topic+moveHMM'></span>

<h3>Description</h3>

<p>Constructor of <code>moveHMM</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moveHMM(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moveHMM_+3A_m">m</code></td>
<td>
<p>A list of attributes of the fitted model: <code>mle</code> (the maximum likelihood estimates of
the parameters of the model), <code>data</code> (the movement data), <code>mod</code> (the object
returned by the numerical optimizer <code>nlm</code>), <code>conditions</code> (a few conditions used to fit
the model: <code>stepDist</code>, <code>angleDist</code>, <code>zeroInflation</code>, <code>estAngleMean</code>,
<code>stationary</code>, and <code>formula</code>), <code>rawCovs</code> (optional &ndash; only if there are covariates
in the data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object <code>moveHMM</code>.
</p>

<hr>
<h2 id='n2w'>Scaling function: natural to working parameters.</h2><span id='topic+n2w'></span>

<h3>Description</h3>

<p>Scales each parameter from its natural interval to the set of real numbers, to allow for
unconstrained optimization. Used during the optimization of the log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n2w(par, bounds, beta, delta = NULL, nbStates, estAngleMean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n2w_+3A_par">par</code></td>
<td>
<p>Vector of state-dependent distributions parameters.</p>
</td></tr>
<tr><td><code id="n2w_+3A_bounds">bounds</code></td>
<td>
<p>Matrix with 2 columns and as many rows as there are elements in <code>par</code>. Each row
contains the lower and upper bound for the correponding parameter.</p>
</td></tr>
<tr><td><code id="n2w_+3A_beta">beta</code></td>
<td>
<p>Matrix of regression coefficients for the transition probabilities.</p>
</td></tr>
<tr><td><code id="n2w_+3A_delta">delta</code></td>
<td>
<p>Initial distribution. Default: <code>NULL</code> ; if the initial distribution is not estimated.</p>
</td></tr>
<tr><td><code id="n2w_+3A_nbstates">nbStates</code></td>
<td>
<p>The number of states of the HMM.</p>
</td></tr>
<tr><td><code id="n2w_+3A_estanglemean">estAngleMean</code></td>
<td>
<p><code>TRUE</code> if the angle mean is estimated, <code>FALSE</code> otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of unconstrained parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nbStates &lt;- 3
par &lt;- c(0.001,0.999,0.5,0.001,1500.3,7.1)
bounds &lt;- matrix(c(0,1, # bounds for first parameter
                   0,1, # bounds for second parameter
                   0,1, # ...
                   0,Inf,
                   0,Inf,
                   0,Inf),
                 byrow=TRUE,ncol=2)
beta &lt;- matrix(rnorm(18),ncol=6,nrow=3)
delta &lt;- c(0.6,0.3,0.1)

# vector of working parameters
wpar &lt;- n2w(par=par,bounds=bounds,beta=beta,delta=delta,nbStates=nbStates,
           estAngleMean=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='nLogLike'>Negative log-likelihood function</h2><span id='topic+nLogLike'></span>

<h3>Description</h3>

<p>Negative log-likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nLogLike(
  wpar,
  nbStates,
  bounds,
  parSize,
  data,
  stepDist = c("gamma", "weibull", "lnorm", "exp"),
  angleDist = c("vm", "wrpcauchy", "none"),
  angleMean = NULL,
  zeroInflation = FALSE,
  stationary = FALSE,
  knownStates = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nLogLike_+3A_wpar">wpar</code></td>
<td>
<p>Vector of working parameters.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states of the HMM.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_bounds">bounds</code></td>
<td>
<p>Matrix with 2 columns and as many rows as there are elements in <code>wpar</code>. Each row
contains the lower and upper bound for the correponding parameter.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_parsize">parSize</code></td>
<td>
<p>Vector of two values: number of parameters of the step length distribution,
number of parameters of the turning angle distribution.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_data">data</code></td>
<td>
<p>An object <code>moveData</code>.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_stepdist">stepDist</code></td>
<td>
<p>Name of the distribution of the step lengths (as a character string).
Supported distributions are: gamma, weibull, lnorm, exp. Default: gamma.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_angledist">angleDist</code></td>
<td>
<p>Name of the distribution of the turning angles (as a character string).
Supported distributions are: vm, wrpcauchy. Set to <code>"none"</code> if the angle distribution should
not be estimated. Default: vm.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_anglemean">angleMean</code></td>
<td>
<p>Vector of means of turning angles if not estimated (one for each state).
Default: <code>NULL</code> (the angle mean is estimated).</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_zeroinflation">zeroInflation</code></td>
<td>
<p><code>TRUE</code> if the step length distribution is inflated in zero.
Default: <code>FALSE</code>. If <code>TRUE</code>, initial values for the zero-mass parameters should be
included in <code>stepPar0</code>.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_stationary">stationary</code></td>
<td>
<p><code>FALSE</code> if there are covariates. If <code>TRUE</code>, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="nLogLike_+3A_knownstates">knownStates</code></td>
<td>
<p>Vector of values of the state process which are known prior to fitting the
model (if any). Default: NULL (states are not known). This should be a vector with length the number
of rows of 'data'; each element should either be an integer (the value of the known states) or NA if
the state is not known.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative log-likelihood of the parameters given the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# data is a moveData object (as returned by prepData), automatically loaded with the package
data &lt;- example$data
simPar &lt;- example$simPar
par0 &lt;- example$par0

estAngleMean &lt;- is.null(simPar$angleMean)
bounds &lt;- parDef(simPar$stepDist,simPar$angleDist,simPar$nbStates,
                 estAngleMean,simPar$zeroInflation)$bounds
parSize &lt;- parDef(simPar$stepDist,simPar$angleDist,simPar$nbStates,
                  estAngleMean,simPar$zeroInflation)$parSize

par &lt;- c(par0$stepPar0,par0$anglePar0)
wpar &lt;- n2w(par,bounds,par0$beta0,par0$delta0,simPar$nbStates,FALSE)

l &lt;- nLogLike(wpar=wpar,nbStates=simPar$nbStates,bounds=bounds,parSize=parSize,data=data,
             stepDist=simPar$stepDist,angleDist=simPar$angleDist,angleMean=simPar$angleMean,
             zeroInflation=simPar$zeroInflation)

## End(Not run)

</code></pre>

<hr>
<h2 id='nLogLike_rcpp'>Negative log-likelihood</h2><span id='topic+nLogLike_rcpp'></span>

<h3>Description</h3>

<p>Computation of the negative log-likelihood (forward algorithm - written in C++)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nLogLike_rcpp(
  nbStates,
  beta,
  covs,
  data,
  stepDist,
  angleDist,
  stepPar,
  anglePar,
  delta,
  aInd,
  zeroInflation,
  stationary,
  knownStates
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nLogLike_rcpp_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_beta">beta</code></td>
<td>
<p>Matrix of regression coefficients for the transition probabilities</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_covs">covs</code></td>
<td>
<p>Covariates</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_data">data</code></td>
<td>
<p>A <code><a href="#topic+moveData">moveData</a></code> object of the observations</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_stepdist">stepDist</code></td>
<td>
<p>The name of the step length distribution</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_angledist">angleDist</code></td>
<td>
<p>The name of the turning angle distribution</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_steppar">stepPar</code></td>
<td>
<p>State-dependent parameters of the step length distribution</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_anglepar">anglePar</code></td>
<td>
<p>State-dependent parameters of the turning angle distribution</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_delta">delta</code></td>
<td>
<p>Stationary distribution</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_aind">aInd</code></td>
<td>
<p>Vector of indices of the rows at which the data switches to another animal</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_zeroinflation">zeroInflation</code></td>
<td>
<p><code>true</code> if zero-inflation is included in the step length distribution,
<code>false</code> otherwise.</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_stationary">stationary</code></td>
<td>
<p><code>false</code> if there are covariates. If <code>true</code>, the initial distribution
is considered equal to the stationary distribution.</p>
</td></tr>
<tr><td><code id="nLogLike_rcpp_+3A_knownstates">knownStates</code></td>
<td>
<p>Vector of values of the state process which are known prior to fitting the
model (if any). Default: NULL (states are not known). This should be a vector with length the number
of rows of 'data'; each element should either be an integer (the value of the known states) or NA if
the state is not known.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Negative log-likelihood
</p>

<hr>
<h2 id='parDef'>Parameters definition</h2><span id='topic+parDef'></span>

<h3>Description</h3>

<p>Parameters definition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parDef(stepDist, angleDist, nbStates, estAngleMean, zeroInflation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parDef_+3A_stepdist">stepDist</code></td>
<td>
<p>Name of the distribution of the step lengths.</p>
</td></tr>
<tr><td><code id="parDef_+3A_angledist">angleDist</code></td>
<td>
<p>Name of the distribution of the turning angles.
Set to <code>"none"</code> if the angle distribution should not be estimated.</p>
</td></tr>
<tr><td><code id="parDef_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states of the HMM.</p>
</td></tr>
<tr><td><code id="parDef_+3A_estanglemean">estAngleMean</code></td>
<td>
<p><code>TRUE</code> if the mean of the turning angles distribution is estimated,
<code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="parDef_+3A_zeroinflation">zeroInflation</code></td>
<td>
<p><code>TRUE</code> if the step length distribution is inflated in zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of:
</p>
<table>
<tr><td><code>parSize</code></td>
<td>
<p>Vector of two values: number of parameters of the step length distribution,
number of parameters of the turning angle distribution</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>
<p>Matrix with 2 columns and <code>sum(parSize)</code> rows - each row contains the lower and upper
bound for the correponding parameter)</p>
</td></tr>
<tr><td><code>parNames</code></td>
<td>
<p>Names of parameters of step distribution (the names of the parameters of the
angle distribution are always the same).</p>
</td></tr>
</table>

<hr>
<h2 id='plot.moveData'>Plot <code>moveData</code></h2><span id='topic+plot.moveData'></span>

<h3>Description</h3>

<p>Plot <code>moveData</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moveData'
plot(x, animals = NULL, compact = FALSE, ask = TRUE, breaks = "Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.moveData_+3A_x">x</code></td>
<td>
<p>An object <code>moveData</code></p>
</td></tr>
<tr><td><code id="plot.moveData_+3A_animals">animals</code></td>
<td>
<p>Vector of indices or IDs of animals for which information will be plotted.
Default: <code>NULL</code> ; all animals are plotted.</p>
</td></tr>
<tr><td><code id="plot.moveData_+3A_compact">compact</code></td>
<td>
<p><code>TRUE</code> for a compact plot (all individuals at once), <code>FALSE</code> otherwise
(default &ndash; one individual at a time).</p>
</td></tr>
<tr><td><code id="plot.moveData_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code>, the execution pauses between each plot.</p>
</td></tr>
<tr><td><code id="plot.moveData_+3A_breaks">breaks</code></td>
<td>
<p>Histogram parameter. See <code>hist</code> documentation.</p>
</td></tr>
<tr><td><code id="plot.moveData_+3A_...">...</code></td>
<td>
<p>Currently unused. For compatibility with generic method.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># data is a moveData object (as returned by prepData), automatically loaded with the package
data &lt;- example$data

plot(data,compact=TRUE,breaks=20,ask=FALSE)

</code></pre>

<hr>
<h2 id='plot.moveHMM'>Plot <code>moveHMM</code></h2><span id='topic+plot.moveHMM'></span>

<h3>Description</h3>

<p>Plot the fitted step and angle densities over histograms of the data, transition probabilities
as functions of the covariates, and maps of the animals' tracks colored by the decoded states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moveHMM'
plot(
  x,
  animals = NULL,
  ask = TRUE,
  breaks = "Sturges",
  col = NULL,
  plotTracks = TRUE,
  plotCI = FALSE,
  alpha = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.moveHMM_+3A_x">x</code></td>
<td>
<p>Object <code>moveHMM</code></p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_animals">animals</code></td>
<td>
<p>Vector of indices or IDs of animals for which information will be plotted.
Default: <code>NULL</code>; all animals are plotted.</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code>, the execution pauses between each plot.</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_breaks">breaks</code></td>
<td>
<p>Histogram parameter. See <code>hist</code> documentation.
See <code>hist</code> documentation. Default: <code>NULL</code> ; the function sets default values.</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_col">col</code></td>
<td>
<p>Vector or colors for the states (one color per state).</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_plottracks">plotTracks</code></td>
<td>
<p>If <code>TRUE</code>, the Viterbi-decoded tracks are plotted (default).</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_plotci">plotCI</code></td>
<td>
<p>If <code>TRUE</code>, confidence intervals are plotted on the transition
probabilities (default: FALSE).</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_alpha">alpha</code></td>
<td>
<p>Significance level of the confidence intervals if plotCI=TRUE.
Default: 0.95 (i.e. 95% CIs).</p>
</td></tr>
<tr><td><code id="plot.moveHMM_+3A_...">...</code></td>
<td>
<p>Currently unused. For compatibility with generic method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The state-dependent densities are weighted by the frequency of each state in the most
probable state sequence (decoded with the function <code><a href="#topic+viterbi">viterbi</a></code>). For example, if the
most probable state sequence indicates that one third of observations correspond to the first
state, and two thirds to the second state, the plots of the densities in the first state are
weighted by a factor 1/3, and in the second state by a factor 2/3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

plot(m,ask=TRUE,animals=1,breaks=20)

</code></pre>

<hr>
<h2 id='plotPR'>Plot pseudo-residuals</h2><span id='topic+plotPR'></span>

<h3>Description</h3>

<p>Plots time series, qq-plots (against the standard normal distribution), and sample
ACF functions of the pseudo-residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPR(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPR_+3A_m">m</code></td>
<td>
<p>A <code><a href="#topic+moveHMM">moveHMM</a></code> object</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If some turning angles in the data are equal to pi, the corresponding pseudo-residuals
will not be included. Indeed, given that the turning angles are defined on (-pi,pi], an angle of pi
results in a pseudo-residual of +Inf (check Section 6.2 of reference for more information on the
computation of pseudo-residuals).
</p>
</li>
<li><p> If some steps are of length zero (i.e. if there is zero-inflation), the corresponding pseudo-
residuals are shown as segments, because pseudo-residuals for discrete data are defined as
segments (see Zucchini and MacDonald, 2009, Section 6.2).
</p>
</li></ul>



<h3>References</h3>

<p>Zucchini, W. and MacDonald, I.L. 2009.
Hidden Markov Models for Time Series: An Introduction Using R.
Chapman &amp; Hall (London).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

plotPR(m)

</code></pre>

<hr>
<h2 id='plotSat'>Plot observations on satellite image</h2><span id='topic+plotSat'></span>

<h3>Description</h3>

<p>Plot tracking data on a satellite map. This function only works with longitude
and latitude values (not with UTM coordinates), and uses the package <code>ggmap</code>
to fetch a satellite image from Google. An Internet connection is required to use
this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSat(
  data,
  zoom = NULL,
  location = NULL,
  segments = TRUE,
  compact = TRUE,
  col = NULL,
  alpha = 1,
  size = 1,
  states = NULL,
  animals = NULL,
  ask = TRUE,
  return = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSat_+3A_data">data</code></td>
<td>
<p>Data frame of the data, with necessary fields 'x' (longitude values) and
'y' (latitude values).</p>
</td></tr>
<tr><td><code id="plotSat_+3A_zoom">zoom</code></td>
<td>
<p>The zoom level, as defined for <code><a href="ggmap.html#topic+get_map">get_map</a></code>. Integer value between
3 (continent) and 21 (building).</p>
</td></tr>
<tr><td><code id="plotSat_+3A_location">location</code></td>
<td>
<p>Location of the center of the map to be plotted.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_segments">segments</code></td>
<td>
<p><code>TRUE</code> if segments should be plotted between the observations (default),
<code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_compact">compact</code></td>
<td>
<p><code>FALSE</code> if tracks should be plotted separately, <code>TRUE</code>
otherwise (default).</p>
</td></tr>
<tr><td><code id="plotSat_+3A_col">col</code></td>
<td>
<p>Palette of colours to use for the dots and segments. If not specified, uses default palette.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_alpha">alpha</code></td>
<td>
<p>Transparency argument for <code><a href="ggplot2.html#topic+geom_point">geom_point</a></code>.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_size">size</code></td>
<td>
<p>Size argument for <code><a href="ggplot2.html#topic+geom_point">geom_point</a></code>.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_states">states</code></td>
<td>
<p>A sequence of integers, corresponding to the decoded states for these data
(such that the observations are colored by states).</p>
</td></tr>
<tr><td><code id="plotSat_+3A_animals">animals</code></td>
<td>
<p>Vector of indices or IDs of animals/tracks to be plotted.
Default: <code>NULL</code>; all animals are plotted.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code>, the execution pauses between each plot.</p>
</td></tr>
<tr><td><code id="plotSat_+3A_return">return</code></td>
<td>
<p>If <code>TRUE</code>, the function returns a ggplot object (which can be edited and
plotted manually). If <code>FALSE</code>, the function automatically plots the map (default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the plot displays the message &quot;Sorry, we have no imagery here&quot;, try a
lower level of zoom.
</p>


<h3>References</h3>

<p>D. Kahle and H. Wickham. ggmap: Spatial Visualization with ggplot2.
The R Journal, 5(1), 144-161.
URL: http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
</p>

<hr>
<h2 id='plotStates'>Plot states</h2><span id='topic+plotStates'></span>

<h3>Description</h3>

<p>Plot the states and states probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStates(m, animals = NULL, ask = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotStates_+3A_m">m</code></td>
<td>
<p>A <code><a href="#topic+moveHMM">moveHMM</a></code> object</p>
</td></tr>
<tr><td><code id="plotStates_+3A_animals">animals</code></td>
<td>
<p>Vector of indices or IDs of animals for which states will be plotted.</p>
</td></tr>
<tr><td><code id="plotStates_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code>, the execution pauses between each plot.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

# plot states for first and second animals
plotStates(m,animals=c(1,2))

</code></pre>

<hr>
<h2 id='plotStationary'>Plot stationary state probabilities</h2><span id='topic+plotStationary'></span>

<h3>Description</h3>

<p>Plot stationary state probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStationary(m, col = NULL, plotCI = FALSE, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotStationary_+3A_m">m</code></td>
<td>
<p>An object <code>moveHMM</code></p>
</td></tr>
<tr><td><code id="plotStationary_+3A_col">col</code></td>
<td>
<p>Vector or colors for the states (one color per state).</p>
</td></tr>
<tr><td><code id="plotStationary_+3A_plotci">plotCI</code></td>
<td>
<p>Logical. Should 95% confidence intervals be plotted? (Default: FALSE)</p>
</td></tr>
<tr><td><code id="plotStationary_+3A_alpha">alpha</code></td>
<td>
<p>Significance level of the confidence intervals if plotCI=TRUE.
Default: 0.95 (i.e. 95% CIs).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

plotStationary(m)

</code></pre>

<hr>
<h2 id='predictStationary'>Predict stationary state probabilities</h2><span id='topic+predictStationary'></span>

<h3>Description</h3>

<p>Predict stationary state probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictStationary(
  m,
  newData,
  beta = m$mle$beta,
  returnCI = FALSE,
  alpha = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictStationary_+3A_m">m</code></td>
<td>
<p>Fitted moveHMM object, as returned by <code><a href="#topic+fitHMM">fitHMM</a></code></p>
</td></tr>
<tr><td><code id="predictStationary_+3A_newdata">newData</code></td>
<td>
<p>Data frame with columns for the covariates</p>
</td></tr>
<tr><td><code id="predictStationary_+3A_beta">beta</code></td>
<td>
<p>Optional matrix of regression coefficients for the transition
probability model. By default, uses estimates in <code>m</code>.</p>
</td></tr>
<tr><td><code id="predictStationary_+3A_returnci">returnCI</code></td>
<td>
<p>Logical indicating whether confidence intervals should
be returned. Default: FALSE.</p>
</td></tr>
<tr><td><code id="predictStationary_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level if returnCI = TRUE. Default: 0.95, i.e.,
95% confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with elements 'mle', 'lci', and 'uci' (the last two only if
returnCI = TRUE). Each element is a matrix of stationary state probabilities
with one row for each row of newData and one column for each state.
</p>

<hr>
<h2 id='predictTPM'>Predict transition probabilities for new covariate values</h2><span id='topic+predictTPM'></span>

<h3>Description</h3>

<p>Predict transition probabilities for new covariate values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictTPM(m, newData, beta = m$mle$beta, returnCI = FALSE, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictTPM_+3A_m">m</code></td>
<td>
<p>Fitted moveHMM object, as returned by <code><a href="#topic+fitHMM">fitHMM</a></code></p>
</td></tr>
<tr><td><code id="predictTPM_+3A_newdata">newData</code></td>
<td>
<p>Data frame with columns for the covariates</p>
</td></tr>
<tr><td><code id="predictTPM_+3A_beta">beta</code></td>
<td>
<p>Optional matrix of regression coefficients for the transition
probability model. By default, uses estimates in <code>m</code>.</p>
</td></tr>
<tr><td><code id="predictTPM_+3A_returnci">returnCI</code></td>
<td>
<p>Logical indicating whether confidence intervals should
be returned. Default: FALSE.</p>
</td></tr>
<tr><td><code id="predictTPM_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level if returnCI = TRUE. Default: 0.95, i.e.,
95% confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with elements 'mle', 'lci', and 'uci' (the last two only if
returnCI = TRUE). Each element is an array, where each layer is a
transition probability matrix corresponding to a row of newData.
</p>

<hr>
<h2 id='prepData'>Preprocessing of the tracking data</h2><span id='topic+prepData'></span>

<h3>Description</h3>

<p>Preprocessing of the tracking data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepData(
  trackData,
  type = c("LL", "UTM"),
  coordNames = c("x", "y"),
  LLangle = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepData_+3A_trackdata">trackData</code></td>
<td>
<p>A dataframe of the tracking data, including at least coordinates
(either longitude/latitude values or cartesian coordinates), and optionnaly a field <code>ID</code>
(identifiers for the observed individuals). Additionnal fields are considered as covariates.
Note that, if the names of the coordinates are not &quot;x&quot; and &quot;y&quot;, the <code>coordNames</code> argument
should specified. Tracking data should be structured so that the rows for each track (or each animal)
are grouped together, and ordered by date, in the data frame.</p>
</td></tr>
<tr><td><code id="prepData_+3A_type">type</code></td>
<td>
<p><code>'LL'</code> if longitude/latitude provided (default), <code>'UTM'</code> if easting/northing.</p>
</td></tr>
<tr><td><code id="prepData_+3A_coordnames">coordNames</code></td>
<td>
<p>Names of the columns of coordinates in the data frame. Default: <code>c("x","y")</code>.</p>
</td></tr>
<tr><td><code id="prepData_+3A_llangle">LLangle</code></td>
<td>
<p>Logical. If TRUE, the turning angle is calculated with <code>geosphere::bearing</code>
(default), else calculated with <code>atan2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object <code>moveData</code>, i.e. a dataframe of:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>The ID(s) of the observed animal(s)</p>
</td></tr>
<tr><td><code>step</code></td>
<td>
<p>The step lengths - in kilometers if longitude/latitude provided, and in the metrics of
the data otherwise</p>
</td></tr>
<tr><td><code>angle</code></td>
<td>
<p>The turning angles (if any) - in radians</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Either Easting or longitude (or e.g. depth for 1D data)</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Either Northing or latitude (all zero if 1D data)</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Covariates (if any)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>coord1 &lt;- c(1,2,3,4,5,6,7,8,9,10)
coord2 &lt;- c(1,1,1,2,2,2,1,1,1,2)
trackData &lt;- data.frame(coord1=coord1,coord2=coord2)
d &lt;- prepData(trackData,type='UTM',coordNames=c("coord1","coord2"))

</code></pre>

<hr>
<h2 id='print.moveHMM'>Print <code>moveHMM</code></h2><span id='topic+print.moveHMM'></span>

<h3>Description</h3>

<p>Print <code>moveHMM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moveHMM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.moveHMM_+3A_x">x</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
<tr><td><code id="print.moveHMM_+3A_...">...</code></td>
<td>
<p>Currently unused. For compatibility with generic method.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

print(m)

</code></pre>

<hr>
<h2 id='pseudoRes'>Pseudo-residuals</h2><span id='topic+pseudoRes'></span>

<h3>Description</h3>

<p>The pseudo-residuals of a moveHMM model, as described in Zucchini and McDonad (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudoRes(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudoRes_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If some turning angles in the data are equal to pi, the corresponding pseudo-residuals
will not be included. Indeed, given that the turning angles are defined on (-pi,pi], an angle of pi
results in a pseudo-residual of +Inf (check Section 6.2 of reference for more information on the
computation of pseudo-residuals).
</p>


<h3>Value</h3>

<p>A list of:
</p>
<table>
<tr><td><code>stepRes</code></td>
<td>
<p>The pseudo-residuals for the step lengths</p>
</td></tr>
<tr><td><code>angleRes</code></td>
<td>
<p>The pseudo-residuals for the turning angles</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zucchini, W. and MacDonald, I.L. 2009.
Hidden Markov Models for Time Series: An Introduction Using R.
Chapman &amp; Hall (London).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m
res &lt;- pseudoRes(m)
qqnorm(res$stepRes)
qqnorm(res$angleRes)

</code></pre>

<hr>
<h2 id='simData'>Simulation tool</h2><span id='topic+simData'></span>

<h3>Description</h3>

<p>Simulates movement data from an HMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simData(
  nbAnimals = 1,
  nbStates = 2,
  stepDist = c("gamma", "weibull", "lnorm", "exp"),
  angleDist = c("vm", "wrpcauchy", "none"),
  stepPar = NULL,
  anglePar = NULL,
  beta = NULL,
  covs = NULL,
  nbCovs = 0,
  zeroInflation = FALSE,
  obsPerAnimal = c(500, 1500),
  model = NULL,
  states = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simData_+3A_nbanimals">nbAnimals</code></td>
<td>
<p>Number of observed individuals to simulate.</p>
</td></tr>
<tr><td><code id="simData_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of behavioural states to simulate.</p>
</td></tr>
<tr><td><code id="simData_+3A_stepdist">stepDist</code></td>
<td>
<p>Name of the distribution of the step lengths (as a character string).
Supported distributions are: gamma, weibull, lnorm, exp. Default: gamma.</p>
</td></tr>
<tr><td><code id="simData_+3A_angledist">angleDist</code></td>
<td>
<p>Name of the distribution of the turning angles (as a character string).
Supported distributions are: vm, wrpcauchy. Set to <code>"none"</code> if the angle distribution should
not be estimated. Default: vm.</p>
</td></tr>
<tr><td><code id="simData_+3A_steppar">stepPar</code></td>
<td>
<p>Parameters of the step length distribution.</p>
</td></tr>
<tr><td><code id="simData_+3A_anglepar">anglePar</code></td>
<td>
<p>Parameters of the turning angle distribution.</p>
</td></tr>
<tr><td><code id="simData_+3A_beta">beta</code></td>
<td>
<p>Matrix of regression parameters for the transition probabilities (more information
in &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="simData_+3A_covs">covs</code></td>
<td>
<p>Covariate values to include in the model, as a dataframe. Default: <code>NULL</code>.
Covariates can also be simulated according to a standard normal distribution, by setting
<code>covs</code> to <code>NULL</code>, and specifying <code>nbCovs&gt;0</code>.</p>
</td></tr>
<tr><td><code id="simData_+3A_nbcovs">nbCovs</code></td>
<td>
<p>Number of covariates to simulate (0 by default). Does not need to be specified of
<code>covs</code> is specified.</p>
</td></tr>
<tr><td><code id="simData_+3A_zeroinflation">zeroInflation</code></td>
<td>
<p><code>TRUE</code> if the step length distribution is inflated in zero.
Default: <code>FALSE</code>. If <code>TRUE</code>, values for the zero-mass parameters should be
included in <code>stepPar</code>.</p>
</td></tr>
<tr><td><code id="simData_+3A_obsperanimal">obsPerAnimal</code></td>
<td>
<p>Either the number of the number of observations per animal (if single value),
or the bounds of the number of observations per animal (if vector of two values). In the latter case,
the numbers of obervations generated for each animal are uniformously picked from this interval.
Default: <code>c(500,1500)</code>.</p>
</td></tr>
<tr><td><code id="simData_+3A_model">model</code></td>
<td>
<p>A moveHMM object. This option can be used to simulate from a fitted model.  Default: NULL.
Note that, if this argument is specified, most other arguments will be ignored &ndash; except for nbAnimals,
obsPerAnimal, covs (if covariate values different from those in the data should be specified),
and states.</p>
</td></tr>
<tr><td><code id="simData_+3A_states">states</code></td>
<td>
<p><code>TRUE</code> if the simulated states should be returned, <code>FALSE</code> otherwise (default).</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The matrix <code>beta</code> of regression coefficients for the transition probabilities has
one row for the intercept, plus one row for each covariate, and one column for
each non-diagonal element of the transition probability matrix. For example, in a 3-state
HMM with 2 covariates, the matrix <code>beta</code> has three rows (intercept + two covariates)
and six columns (six non-diagonal elements in the 3x3 transition probability matrix - filled in
row-wise).
In a covariate-free model (default), <code>beta</code> has one row, for the intercept.
</p>
</li>
<li><p> If the length of covariate values passed (either through 'covs', or 'model') is not the same
as the number of observations suggested by 'nbAnimals' and 'obsPerAnimal', then the series of
covariates is either shortened (removing last values - if too long) or extended (starting
over from the first values - if too short).
</p>
</li></ul>



<h3>Value</h3>

<p>An object moveData, i.e. a dataframe of:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>The ID(s) of the observed animal(s)</p>
</td></tr>
<tr><td><code>step</code></td>
<td>
<p>The step lengths</p>
</td></tr>
<tr><td><code>angle</code></td>
<td>
<p>The turning angles (if any)</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Either easting or longitude</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Either northing or latitude</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Covariates (if any)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># 1. Pass a fitted model to simulate from
# (m is a moveHMM object - as returned by fitHMM - automatically loaded with the package)
# We keep the default nbAnimals=1.
m &lt;- example$m
obsPerAnimal=c(50,100)
data &lt;- simData(model=m,obsPerAnimal=obsPerAnimal)

# 2. Pass the parameters of the model to simulate from
stepPar &lt;- c(1,10,1,5,0.2,0.3) # mean1, mean2, sd1, sd2, z1, z2
anglePar &lt;- c(pi,0,0.5,2) # mean1, mean2, k1, k2
stepDist &lt;- "gamma"
angleDist &lt;- "vm"
data &lt;- simData(nbAnimals=5,nbStates=2,stepDist=stepDist,angleDist=angleDist,stepPar=stepPar,
               anglePar=anglePar,nbCovs=2,zeroInflation=TRUE,obsPerAnimal=obsPerAnimal)

stepPar &lt;- c(1,10,1,5) # mean1, mean2, sd1, sd2
anglePar &lt;- c(pi,0,0.5,0.7) # mean1, mean2, k1, k2
stepDist &lt;- "weibull"
angleDist &lt;- "wrpcauchy"
data &lt;- simData(nbAnimals=5,nbStates=2,stepDist=stepDist,angleDist=angleDist,stepPar=stepPar,
               anglePar=anglePar,obsPerAnimal=obsPerAnimal)

# step length only and zero-inflation
stepPar &lt;- c(1,10,1,5,0.2,0.3) # mean1, mean2, sd1, sd2, z1, z2
stepDist &lt;- "gamma"
data &lt;- simData(nbAnimals=5,nbStates=2,stepDist=stepDist,angleDist="none",stepPar=stepPar,
               nbCovs=2,zeroInflation=TRUE,obsPerAnimal=obsPerAnimal)

# include covariates
# (note that it is useless to specify "nbCovs", which is determined
# by the number of columns of "cov")
cov &lt;- data.frame(temp=rnorm(500,20,5))
stepPar &lt;- c(1,10,1,5) # mean1, mean2, sd1, sd2
anglePar &lt;- c(pi,0,0.5,2) # mean1, mean2, k1, k2
stepDist &lt;- "gamma"
angleDist &lt;- "vm"
data &lt;- simData(nbAnimals=5,nbStates=2,stepDist=stepDist,angleDist=angleDist,stepPar=stepPar,
                anglePar=anglePar,covs=cov)

</code></pre>

<hr>
<h2 id='stateProbs'>State probabilities</h2><span id='topic+stateProbs'></span>

<h3>Description</h3>

<p>For a given model, computes the probability of the process being in the different states
at each time point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stateProbs(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stateProbs_+3A_m">m</code></td>
<td>
<p>A <code>moveHMM</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of state probabilities, with element [i,j] the probability
of being in state j in observation i.
</p>


<h3>References</h3>

<p>Zucchini, W. and MacDonald, I.L. 2009.
Hidden Markov Models for Time Series: An Introduction Using R.
Chapman &amp; Hall (London).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

sp &lt;- stateProbs(m)

</code></pre>

<hr>
<h2 id='stationary'>Stationary state probabilities</h2><span id='topic+stationary'></span>

<h3>Description</h3>

<p>Calculates the stationary probabilities of each state, for given
covariate values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stationary(m, covs, beta = m$mle$beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stationary_+3A_m">m</code></td>
<td>
<p>Fitted model (as output by <code><a href="#topic+fitHMM">fitHMM</a></code>).</p>
</td></tr>
<tr><td><code id="stationary_+3A_covs">covs</code></td>
<td>
<p>Either a data frame or a design matrix of covariates.</p>
</td></tr>
<tr><td><code id="stationary_+3A_beta">beta</code></td>
<td>
<p>Optional matrix of regression coefficients for the transition
probability model. By default, uses estimates in <code>m</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of stationary state probabilities. Each row corresponds to
a row of covs, and each column corresponds to a state.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

# data frame of covariates
stationary(m, covs = data.frame(cov1 = 0, cov2 = 0))

# design matrix (each column corresponds to row of m$mle$beta)
stationary(m, covs = matrix(c(1,0,cos(0)),1,3))

</code></pre>

<hr>
<h2 id='summary.moveData'>Summary <code>moveData</code></h2><span id='topic+summary.moveData'></span>

<h3>Description</h3>

<p>Summary <code>moveData</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moveData'
summary(object, details = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.moveData_+3A_object">object</code></td>
<td>
<p>A <code>moveData</code> object.</p>
</td></tr>
<tr><td><code id="summary.moveData_+3A_details">details</code></td>
<td>
<p><code>TRUE</code> if quantiles of the covariate values should be printed (default),
<code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="summary.moveData_+3A_...">...</code></td>
<td>
<p>Currently unused. For compatibility with generic method.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveData object (as returned by prepData), automatically loaded with the package
data &lt;- example$data

summary(data)

</code></pre>

<hr>
<h2 id='trMatrix_rcpp'>Transition probability matrix</h2><span id='topic+trMatrix_rcpp'></span>

<h3>Description</h3>

<p>Computation of the transition probability matrix, as a function of the covariates and the regression
parameters. Written in C++. Used in <code><a href="#topic+fitHMM">fitHMM</a></code>, <code><a href="#topic+logAlpha">logAlpha</a></code>, <code><a href="#topic+logBeta">logBeta</a></code>,
<code><a href="#topic+plot.moveHMM">plot.moveHMM</a></code>, <code><a href="#topic+pseudoRes">pseudoRes</a></code>, and <code><a href="#topic+viterbi">viterbi</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trMatrix_rcpp(nbStates, beta, covs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trMatrix_rcpp_+3A_nbstates">nbStates</code></td>
<td>
<p>Number of states</p>
</td></tr>
<tr><td><code id="trMatrix_rcpp_+3A_beta">beta</code></td>
<td>
<p>Matrix of regression parameters</p>
</td></tr>
<tr><td><code id="trMatrix_rcpp_+3A_covs">covs</code></td>
<td>
<p>Matrix of covariate values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Three dimensional array <code>trMat</code>, such that <code>trMat[,,t]</code> is the transition matrix at
time t.
</p>

<hr>
<h2 id='turnAngle'>Turning angle</h2><span id='topic+turnAngle'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+prepData">prepData</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>turnAngle(x, y, z, LLangle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="turnAngle_+3A_x">x</code></td>
<td>
<p>First point</p>
</td></tr>
<tr><td><code id="turnAngle_+3A_y">y</code></td>
<td>
<p>Second point</p>
</td></tr>
<tr><td><code id="turnAngle_+3A_z">z</code></td>
<td>
<p>Third point</p>
</td></tr>
<tr><td><code id="turnAngle_+3A_llangle">LLangle</code></td>
<td>
<p>Logical. If TRUE, the turning angle is calculated with
<code>geosphere::bearing</code>, else calculated with <code>atan2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The angle between vectors (x,y) and (y,z)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
x &lt;- c(0,0)
y &lt;- c(4,6)
z &lt;- c(10,7)
turnAngle(x,y,z,LLangle=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='viterbi'>Viterbi algorithm</h2><span id='topic+viterbi'></span>

<h3>Description</h3>

<p>For a given model, reconstructs the most probable states sequence,
using the Viterbi algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>viterbi(m, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="viterbi_+3A_m">m</code></td>
<td>
<p>An object <code>moveHMM</code></p>
</td></tr>
<tr><td><code id="viterbi_+3A_newdata">newdata</code></td>
<td>
<p>An object <code>moveData</code> (optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sequence of most probable states.
</p>


<h3>References</h3>

<p>Zucchini, W. and MacDonald, I.L. 2009.
Hidden Markov Models for Time Series: An Introduction Using R.
Chapman &amp; Hall (London).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># m is a moveHMM object (as returned by fitHMM), automatically loaded with the package
m &lt;- example$m

# reconstruction of states sequence
states &lt;- viterbi(m)

</code></pre>

<hr>
<h2 id='w2n'>Scaling function: working to natural parameters</h2><span id='topic+w2n'></span>

<h3>Description</h3>

<p>Scales each parameter from the set of real numbers, back to its natural interval.
Used during the optimization of the log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w2n(wpar, bounds, parSize, nbStates, nbCovs, estAngleMean, stationary)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w2n_+3A_wpar">wpar</code></td>
<td>
<p>Vector of state-dependent distributions unconstrained parameters.</p>
</td></tr>
<tr><td><code id="w2n_+3A_bounds">bounds</code></td>
<td>
<p>Matrix with 2 columns and as many rows as there are elements in <code>wpar</code>. Each row
contains the lower and upper bound for the correponding parameter.</p>
</td></tr>
<tr><td><code id="w2n_+3A_parsize">parSize</code></td>
<td>
<p>Vector of two values: number of parameters of the step length distribution,
number of parameters of the turning angle distribution.</p>
</td></tr>
<tr><td><code id="w2n_+3A_nbstates">nbStates</code></td>
<td>
<p>The number of states of the HMM.</p>
</td></tr>
<tr><td><code id="w2n_+3A_nbcovs">nbCovs</code></td>
<td>
<p>The number of covariates.</p>
</td></tr>
<tr><td><code id="w2n_+3A_estanglemean">estAngleMean</code></td>
<td>
<p><code>TRUE</code> if the angle mean is estimated, <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="w2n_+3A_stationary">stationary</code></td>
<td>
<p><code>FALSE</code> if there are covariates. If TRUE, the initial distribution is considered
equal to the stationary distribution. Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of:
</p>
<table>
<tr><td><code>stepPar</code></td>
<td>
<p>Matrix of natural parameters of the step length distribution</p>
</td></tr>
<tr><td><code>anglePar</code></td>
<td>
<p>Matrix of natural parameters of the turning angle distribution</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Matrix of regression coefficients of the transition probabilities</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>Initial distribution</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nbStates &lt;- 3
nbCovs &lt;- 2
par &lt;- c(0.001,0.999,0.5,0.001,1500.3,7.1)
parSize &lt;- c(1,1)
bounds &lt;- matrix(c(0,1,0,1,0,1,
                   0,Inf,0,Inf,0,Inf),
                 byrow=TRUE,ncol=2)
beta &lt;- matrix(rnorm(18),ncol=6,nrow=3)
delta &lt;- c(0.6,0.3,0.1)
wpar &lt;- n2w(par,bounds,beta,delta,nbStates,FALSE)
print(w2n(wpar,bounds,parSize,nbStates,nbCovs,estAngleMean=FALSE,stationary=FALSE))

## End(Not run)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
