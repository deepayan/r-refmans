<!DOCTYPE html><html><head><title>Help for package AzureVM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AzureVM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#autoscaler_config'><p>Autoscaler configuration</p></a></li>
<li><a href='#az_vm_resource'><p>Virtual machine resource class</p></a></li>
<li><a href='#az_vm_template'><p>Virtual machine template class</p></a></li>
<li><a href='#az_vmss_resource'><p>Virtual machine scaleset resource class</p></a></li>
<li><a href='#az_vmss_template'><p>Virtual machine scaleset (cluster) template class</p></a></li>
<li><a href='#build_template_definition.vm_config'><p>Build template definition and parameters</p></a></li>
<li><a href='#centos_7.5'><p>VM configuration functions</p></a></li>
<li><a href='#centos_7.5_ss'><p>Virtual machine scaleset configuration functions</p></a></li>
<li><a href='#create_vm'><p>Create a new virtual machine or scaleset of virtual machines</p></a></li>
<li><a href='#defunct'><p>Defunct methods</p></a></li>
<li><a href='#delete_vm'><p>Delete virtual machine</p></a></li>
<li><a href='#get_vm'><p>Get existing virtual machine(s)</p></a></li>
<li><a href='#ip_config'><p>Public IP address configuration</p></a></li>
<li><a href='#is_vm'><p>Is an object an Azure VM</p></a></li>
<li><a href='#lb_config'><p>Load balancer configuration</p></a></li>
<li><a href='#lb_rule_ssh'><p>Load balancing rules</p></a></li>
<li><a href='#list_vm_sizes'><p>List available VM sizes</p></a></li>
<li><a href='#nic_config'><p>Network interface configuration</p></a></li>
<li><a href='#nsg_config'><p>Network security group configuration</p></a></li>
<li><a href='#nsg_rule_allow_ssh'><p>Network security rules</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#scaleset_options'><p>Virtual machine scaleset options</p></a></li>
<li><a href='#user_config'><p>Resource configuration functions for a virtual machine deployment</p></a></li>
<li><a href='#vnet_config'><p>Virtual network configuration</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Virtual Machines in 'Azure'</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Functionality for working with virtual machines (VMs) in Microsoft's 'Azure' cloud: <a href="https://azure.microsoft.com/en-us/services/virtual-machines/">https://azure.microsoft.com/en-us/services/virtual-machines/</a>. Includes facilities to deploy, startup, shutdown, and cleanly delete VMs and VM clusters. Deployment configurations can be highly customised, and can make use of existing resources as well as creating new ones. A selection of predefined configurations is provided to allow easy deployment of commonly used Linux and Windows images, including Data Science Virtual Machines. With a running VM, execute scripts and install optional extensions. Part of the 'AzureR' family of packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/AzureVM">https://github.com/Azure/AzureVM</a> <a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/AzureVM/issues">https://github.com/Azure/AzureVM/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6 (&ge; 2.4.1), AzureRMR (&ge; 2.3.0), jsonlite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, parallel, AzureKeyVault,
AzureVMmetadata</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-14 14:38:47 UTC; hongo</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut, cre],
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Ooi &lt;hongooi73@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-14 23:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='autoscaler_config'>Autoscaler configuration</h2><span id='topic+autoscaler_config'></span><span id='topic+autoscaler_profile'></span>

<h3>Description</h3>

<p>Autoscaler configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoscaler_config(profiles = list(autoscaler_profile()), ...)

autoscaler_profile(name = "Profile", minsize = 1, maxsize = NA,
  default = NA, scale_out = 0.75, scale_in = 0.25, interval = "PT1M",
  window = "PT5M")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoscaler_config_+3A_profiles">profiles</code></td>
<td>
<p>A list of autoscaling profiles, each obtained via a call to <code>autoscaler_profile</code>.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_name">name</code></td>
<td>
<p>For <code>autoscaler_profile</code>, a name for the profile.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_minsize">minsize</code>, <code id="autoscaler_config_+3A_maxsize">maxsize</code>, <code id="autoscaler_config_+3A_default">default</code></td>
<td>
<p>For <code>autoscaler_profile</code>, the minimum, maximum and default number of instances.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_scale_out">scale_out</code>, <code id="autoscaler_config_+3A_scale_in">scale_in</code></td>
<td>
<p>For <code>autoscaler_profile</code>, the CPU usage (a fraction between 0 and 1) at which to scale out and in, respectively.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_interval">interval</code></td>
<td>
<p>For <code>autoscaler_profile</code>, The interval between samples, in ISO 8601 format. The default is 1 minute.</p>
</td></tr>
<tr><td><code id="autoscaler_config_+3A_window">window</code></td>
<td>
<p>For <code>autoscaler_profile</code>, the window width over which to compute the percentage CPU. The default is 5 minutes.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm_scaleset">create_vm_scaleset</a>, <a href="#topic+vmss_config">vmss_config</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>autoscaler_config()
autoscaler_config(list(
    autoscaler_profile(minsize=2, maxsize=50, scale_out=0.9, scale_in=0.1)
))
</code></pre>

<hr>
<h2 id='az_vm_resource'>Virtual machine resource class</h2><span id='topic+az_vm_resource'></span>

<h3>Description</h3>

<p>Class representing a virtual machine resource. In general, the methods in this class should not be called directly, nor should objects be directly instantiated from it. Use the <code>az_vm_template</code> class for interacting with VMs instead.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_vm_resource</code>, inheriting from <code>AzureRMR::az_resource</code>.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>start(wait=TRUE)</code>: Start the VM. By default, wait until the startup process is complete.
</p>
</li>
<li> <p><code>stop(deallocate=TRUE, wait=FALSE)</code>: Stop the VM. By default, deallocate it as well.
</p>
</li>
<li> <p><code>restart(wait=TRUE)</code>: Restart the VM.
</p>
</li>
<li> <p><code>run_deployed_command(command, parameters, script)</code>: Run a PowerShell command on the VM.
</p>
</li>
<li> <p><code>run_script(script, parameters)</code>: Run a script on the VM. For a Linux VM, this will be a shell script; for a Windows VM, a PowerShell script. Pass the script as a character vector.
</p>
</li>
<li> <p><code>sync_vm_status()</code>: Check the status of the VM.
</p>
</li>
<li> <p><code>resize(size, deallocate=FALSE, wait=FALSE)</code>: Resize the VM. Optionally stop and deallocate it first (may sometimes be necessary).
</p>
</li>
<li> <p><code>redeploy()</code>: Redeploy the VM.
</p>
</li>
<li> <p><code>reimage()</code>: Reimage the VM.
</p>
</li>
<li> <p><code>get_public_ip_address(nic=1, config=1)</code>: Get the public IP address of the VM. Returns NA if the VM is shut down, or is not publicly accessible.
</p>
</li>
<li> <p><code>get_private_ip_address(nic=1, config=1)</code>: Get the private IP address of the VM.
</p>
</li>
<li> <p><code>get_public_ip_resource(nic=1, config=1)</code>: Get the Azure resource for the VM's public IP address.
</p>
</li>
<li> <p><code>get_nic(nic=1)</code>: Get the VM's network interface resource.
</p>
</li>
<li> <p><code>get_vnet(nic=1, config=1)</code>: Get the VM's virtual network resource.
</p>
</li>
<li> <p><code>get_nsg(nic=1, config=1)</code>: Get the VM's network security group resource. Note that an NSG can be attached to either the VM's network interface or to its virtual network subnet; if there is an NSG attached to both, this method returns a list containing the two NSG resource objects.
</p>
</li>
<li> <p><code>get_disk(disk="os")</code>: Get a managed disk resource attached to the VM. The <code>disk</code> argument can be &quot;os&quot; for the OS disk, or a number indicating the LUN of a data disk. AzureVM only supports managed disks.
</p>
</li>
<li> <p><code>add_extension(publisher, type, version, settings=list(), protected_settings=list(), key_vault_settings=list())</code>: Add an extension to the VM.
</p>
</li>
<li> <p><code>do_vm_operation(...)</code>: Carry out an arbitrary operation on the VM resource. See the <code>do_operation</code> method of the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class for more details.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a>, <a href="#topic+get_vm_resource">get_vm_resource</a>, <a href="#topic+az_vm_template">az_vm_template</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines">VM API reference</a>
</p>

<hr>
<h2 id='az_vm_template'>Virtual machine template class</h2><span id='topic+az_vm_template'></span>

<h3>Description</h3>

<p>Class representing a virtual machine deployment template. This class keeps track of all resources that are created as part of deploying a VM, and exposes methods for managing them.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_vm_template</code>, inheriting from <code>AzureRMR::az_template</code>.
</p>


<h3>Details</h3>

<p>A single virtual machine in Azure is actually a collection of resources, including any and all of the following.
</p>

<ul>
<li><p> Network interface (Azure resource type <code>Microsoft.Network/networkInterfaces</code>)
</p>
</li>
<li><p> Network security group (Azure resource type <code>Microsoft.Network/networkSecurityGroups</code>)
</p>
</li>
<li><p> Virtual network (Azure resource type <code>Microsoft.Network/virtualNetworks</code>)
</p>
</li>
<li><p> Public IP address (Azure resource type <code>Microsoft.Network/publicIPAddresses</code>)
</p>
</li>
<li><p> The VM itself (Azure resource type <code>Microsoft.Compute/virtualMachines</code>)
</p>
</li></ul>

<p>By wrapping the deployment template used to create these resources, the <code>az_vm_template</code> class allows managing them all as a single entity.
</p>


<h3>Fields</h3>

<p>The following fields are exposed, in addition to those provided by the <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> class.
</p>

<ul>
<li> <p><code>dns_name</code>: The DNS name for the VM. Will be NULL if the VM is not publicly visible, or doesn't have a domain name assigned to its public IP address.
</p>
</li>
<li> <p><code>identity</code>: The managed identity details for the VM. Will be NULL if the VM doesn't have an identity assigned.
</p>
</li></ul>



<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> class.
</p>

<ul>
<li> <p><code>start(wait=TRUE)</code>: Start the VM. By default, wait until the startup process is complete.
</p>
</li>
<li> <p><code>stop(deallocate=TRUE, wait=FALSE)</code>: Stop the VM. By default, deallocate it as well.
</p>
</li>
<li> <p><code>restart(wait=TRUE)</code>: Restart the VM.
</p>
</li>
<li> <p><code>run_deployed_command(command, parameters, script)</code>: Run a PowerShell command on the VM.
</p>
</li>
<li> <p><code>run_script(script, parameters)</code>: Run a script on the VM. For a Linux VM, this will be a shell script; for a Windows VM, a PowerShell script. Pass the script as a character vector.
</p>
</li>
<li> <p><code>sync_vm_status()</code>: Check the status of the VM.
</p>
</li>
<li> <p><code>resize(size, deallocate=FALSE, wait=FALSE)</code>: Resize the VM. Optionally stop and deallocate it first (may sometimes be necessary).
</p>
</li>
<li> <p><code>redeploy()</code>: Redeploy the VM.
</p>
</li>
<li> <p><code>reimage()</code>: Reimage the VM.
</p>
</li>
<li> <p><code>get_public_ip_address(nic=1, config=1)</code>: Get the public IP address of the VM. Returns NA if the VM is stopped, or is not publicly accessible.
</p>
</li>
<li> <p><code>get_private_ip_address(nic=1, config=1)</code>: Get the private IP address of the VM.
</p>
</li>
<li> <p><code>get_public_ip_resource(nic=1, config=1)</code>: Get the Azure resource for the VM's public IP address.
</p>
</li>
<li> <p><code>get_nic(nic=1)</code>: Get the VM's network interface resource.
</p>
</li>
<li> <p><code>get_vnet(nic=1, config=1)</code>: Get the VM's virtual network resource.
</p>
</li>
<li> <p><code>get_nsg(nic=1, config=1)</code>: Get the VM's network security group resource. Note that an NSG can be attached to either the VM's network interface or to its virtual network subnet; if there is an NSG attached to both, this method returns a list containing the two NSG resource objects.
</p>
</li>
<li> <p><code>get_disk(disk="os")</code>: Get a managed disk resource attached to the VM. The <code>disk</code> argument can be &quot;os&quot; for the OS disk, or a number indicating the LUN of a data disk. AzureVM only supports managed disks.
</p>
</li>
<li> <p><code>add_extension(publisher, type, version, settings=list(), protected_settings=list(), key_vault_settings=list())</code>: Add an extension to the VM.
</p>
</li>
<li> <p><code>do_vm_operation(...)</code>: Carries out an arbitrary operation on the VM resource. See the <code>do_operation</code> method of the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class for more details.
</p>
</li></ul>

<p>Many of these methods are actually provided by the <a href="#topic+az_vm_resource">az_vm_resource</a> class, and propagated to the template as active bindings.
</p>


<h3>See Also</h3>

<p><a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a>, <a href="#topic+create_vm">create_vm</a>, <a href="#topic+get_vm">get_vm</a>, <a href="#topic+delete_vm">delete_vm</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines">VM API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

vm &lt;- sub$get_vm("myvm")

vm$identity

vm$start()
vm$get_private_ip_address()
vm$get_public_ip_address()

vm$run_script("echo hello world! &gt; /tmp/hello.txt")

vm$stop()
vm$get_private_ip_address()
vm$get_public_ip_address()  # NA, assuming VM has a dynamic IP address

vm$resize("Standard_DS13_v2")
vm$sync_vm_status()


## End(Not run)
</code></pre>

<hr>
<h2 id='az_vmss_resource'>Virtual machine scaleset resource class</h2><span id='topic+az_vmss_resource'></span>

<h3>Description</h3>

<p>Class representing a virtual machine scaleset resource. In general, the methods in this class should not be called directly, nor should objects be directly instantiated from it. Use the <code>az_vmss_template</code> class for interacting with scalesets instead.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_vmss_resource</code>, inheriting from <code>AzureRMR::az_resource</code>.
</p>


<h3>Details</h3>

<p>A single virtual machine scaleset in Azure is actually a collection of resources, including any and all of the following.
</p>

<ul>
<li><p> Network security group (Azure resource type <code>Microsoft.Network/networkSecurityGroups</code>)
</p>
</li>
<li><p> Virtual network (Azure resource type <code>Microsoft.Network/virtualNetworks</code>)
</p>
</li>
<li><p> Load balancer (Azure resource type <code>Microsoft.Network/loadBalancers</code>)
</p>
</li>
<li><p> Public IP address (Azure resource type <code>Microsoft.Network/publicIPAddresses</code>)
</p>
</li>
<li><p> Autoscaler (Azure resource type <code>Microsoft.Insights/autoscaleSettings</code>)
</p>
</li>
<li><p> The scaleset itself (Azure resource type <code>Microsoft.Compute/virtualMachineScaleSets</code>)
</p>
</li></ul>

<p>By wrapping the deployment template used to create these resources, the <code>az_vmss_template</code> class allows managing them all as a single entity.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> class.
</p>

<ul>
<li> <p><code>sync_vmss_status</code>: Check the status of the scaleset.
</p>
</li>
<li> <p><code>list_instances()</code>: Return a list of <a href="#topic+az_vm_resource">az_vm_resource</a> objects, one for each VM instance in the scaleset. Note that if the scaleset has a load balancer attached, the number of instances will vary depending on the load.
</p>
</li>
<li> <p><code>get_instance(id)</code>: Return a specific VM instance in the scaleset.
</p>
</li>
<li> <p><code>start(id=NULL, wait=FALSE)</code>: Start the scaleset. In this and the other methods listed here, <code>id</code> can be an optional character vector of instance IDs; if supplied, only carry out the operation for those instances.
</p>
</li>
<li> <p><code>restart(id=NULL, wait=FALSE)</code>: Restart the scaleset.
</p>
</li>
<li> <p><code>stop(deallocate=TRUE, id=NULL, wait=FALSE)</code>: Stop the scaleset.
</p>
</li>
<li> <p><code>get_public_ip_address()</code>: Get the public IP address of the scaleset (technically, of the load balancer). If the scaleset doesn't have a load balancer attached, returns NA.
</p>
</li>
<li> <p><code>get_vm_public_ip_addresses(id=NULL, nic=1, config=1)</code>: Get the public IP addresses for the instances in the scaleset. Returns NA for the instances that are stopped or not publicly accessible.
</p>
</li>
<li> <p><code>get_vm_private_ip_addresses(id=NULL, nic=1, config=1)</code>: Get the private IP addresses for the instances in the scaleset.
</p>
</li>
<li> <p><code>get_vnet(nic=1, config=1)</code>: Get the scaleset's virtual network resource.
</p>
</li>
<li> <p><code>get_nsg(nic=1, config=1)</code>: Get the scaleset's network security group resource.
</p>
</li>
<li> <p><code>run_deployed_command(command, parameters=NULL, script=NULL, id=NULL)</code>: Run a PowerShell command on the instances in the scaleset.
</p>
</li>
<li> <p><code>run_script(script, parameters=NULL, id=NULL)</code>: Run a script on the VM. For a Linux VM, this will be a shell script; for a Windows VM, a PowerShell script. Pass the script as a character vector.
</p>
</li>
<li> <p><code>reimage(id=NULL, datadisks=FALSE)</code>: Reimage the instances in the scaleset. If <code>datadisks</code> is TRUE, reimage any attached data disks as well.
</p>
</li>
<li> <p><code>redeploy(id=NULL)</code>: Redeploy the instances in the scaleset.
</p>
</li>
<li> <p><code>mapped_vm_operation(..., id=NULL)</code>: Carry out an arbitrary operation on the instances in the scaleset. See the <code>do_operation</code> method of the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class for more details.
</p>
</li>
<li> <p><code>add_extension(publisher, type, version, settings=list(), protected_settings=list(), key_vault_settings=list())</code>: Add an extension to the scaleset.
</p>
</li>
<li> <p><code>do_vmss_operation(...)</code> Carry out an arbitrary operation on the scaleset resource (as opposed to the instances in the scaleset).
</p>
</li></ul>



<h3>Instance operations</h3>

<p>AzureVM has the ability to parallelise scaleset instance operations using a background process pool provided by AzureRMR. This can lead to significant speedups when working with scalesets with high instance counts. The pool is created automatically the first time that it is required, and remains persistent for the session. You can control the size of the process pool with the <code>azure_vm_minpoolsize</code> and <code>azure_vm_maxpoolsize</code> options, which have default values 2 and 10 respectively.
</p>
<p>The <code>id</code> argument lets you specify a subset of instances on which to carry out an operation. This can be a character vector of instance IDs; a list of instance objects such as returned by <code>list_instances</code>; or a single instance object. The default (NULL) is to carry out the operation on all instances.
</p>


<h3>See Also</h3>

<p><a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a>, <a href="#topic+get_vm_scaleset_resource">get_vm_scaleset_resource</a>, <a href="#topic+az_vmss_template">az_vmss_template</a>, <a href="AzureRMR.html#topic+pool">AzureRMR::init_pool</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/rest/api/compute/virtualmachinescalesets">VM scaleset API reference</a>
</p>

<hr>
<h2 id='az_vmss_template'>Virtual machine scaleset (cluster) template class</h2><span id='topic+az_vmss_template'></span>

<h3>Description</h3>

<p>Class representing a virtual machine scaleset deployment template. This class keeps track of all resources that are created as part of deploying a scaleset, and exposes methods for managing them.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>az_vmss_template</code>, inheriting from <code>AzureRMR::az_template</code>.
</p>


<h3>Details</h3>

<p>A virtual machine scaleset in Azure is actually a collection of resources, including any and all of the following.
</p>

<ul>
<li><p> Network security group (Azure resource type <code>Microsoft.Network/networkSecurityGroups</code>)
</p>
</li>
<li><p> Virtual network (Azure resource type <code>Microsoft.Network/virtualNetworks</code>)
</p>
</li>
<li><p> Load balancer (Azure resource type <code>Microsoft.Network/loadBalancers</code>)
</p>
</li>
<li><p> Public IP address (Azure resource type <code>Microsoft.Network/publicIPAddresses</code>)
</p>
</li>
<li><p> Autoscaler (Azure resource type <code>Microsoft.Insights/autoscaleSettings</code>)
</p>
</li>
<li><p> The scaleset itself (Azure resource type <code>Microsoft.Compute/virtualMachineScaleSets</code>)
</p>
</li></ul>

<p>By wrapping the deployment template used to create these resources, the <code>az_vmss_template</code> class allows managing them all as a single entity.
</p>


<h3>Fields</h3>

<p>The following fields are exposed, in addition to those provided by the <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> class.
</p>

<ul>
<li> <p><code>dns_name</code>: The DNS name for the scaleset (technically, the name for its load balancer). Will be NULL if the scaleset is not publicly visible, or doesn't have a load balancer attached.
</p>
</li>
<li> <p><code>identity</code>: The managed identity details for the scaleset. Will be NULL if the scaleset doesn't have an identity assigned.
</p>
</li></ul>



<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> class.
</p>

<ul>
<li> <p><code>sync_vmss_status</code>: Check the status of the scaleset.
</p>
</li>
<li> <p><code>list_instances()</code>: Return a list of <a href="#topic+az_vm_resource">az_vm_resource</a> objects, one for each VM instance in the scaleset. Note that if the scaleset has an autoscaler attached, the number of instances will vary depending on the load.
</p>
</li>
<li> <p><code>get_instance(id)</code>: Return a specific VM instance in the scaleset.
</p>
</li>
<li> <p><code>start(id=NULL, wait=FALSE)</code>: Start the scaleset. In this and the other methods listed here, <code>id</code> can be an optional character vector of instance IDs; if supplied, only carry out the operation for those instances.
</p>
</li>
<li> <p><code>restart(id=NULL, wait=FALSE)</code>: Restart the scaleset.
</p>
</li>
<li> <p><code>stop(deallocate=TRUE, id=NULL, wait=FALSE)</code>: Stop the scaleset.
</p>
</li>
<li> <p><code>get_public_ip_address()</code>: Get the public IP address of the scaleset (technically, of the load balancer). If the scaleset doesn't have a load balancer attached, returns NA.
</p>
</li>
<li> <p><code>get_vm_public_ip_addresses(id=NULL, nic=1, config=1)</code>: Get the public IP addresses for the instances in the scaleset. Returns NA for the instances that are stopped or not publicly accessible.
</p>
</li>
<li> <p><code>get_vm_private_ip_addresses(id=NULL, nic=1, config=1)</code>: Get the private IP addresses for the instances in the scaleset.
</p>
</li>
<li> <p><code>get_public_ip_resource()</code>: Get the Azure resource for the load balancer's public IP address.
</p>
</li>
<li> <p><code>get_vnet(nic=1, config=1)</code>: Get the scaleset's virtual network resource.
</p>
</li>
<li> <p><code>get_nsg(nic=1, config=1)</code>: Get the scaleset's network security group resource.
</p>
</li>
<li> <p><code>get_load_balancer()</code>: Get the scaleset's load balancer resource.
</p>
</li>
<li> <p><code>get_autoscaler()</code>: Get the scaleset's autoscaler resource.
</p>
</li>
<li> <p><code>run_deployed_command(command, parameters=NULL, script=NULL, id=NULL)</code>: Run a PowerShell command on the instances in the scaleset.
</p>
</li>
<li> <p><code>run_script(script, parameters=NULL, id=NULL)</code>: Run a script on the VM. For a Linux VM, this will be a shell script; for a Windows VM, a PowerShell script. Pass the script as a character vector.
</p>
</li>
<li> <p><code>reimage(id=NULL, datadisks=FALSE)</code>: Reimage the instances in the scaleset. If <code>datadisks</code> is TRUE, reimage any attached data disks as well.
</p>
</li>
<li> <p><code>redeploy(id=NULL)</code>: Redeploy the instances in the scaleset.
</p>
</li>
<li> <p><code>mapped_vm_operation(..., id=NULL)</code>: Carry out an arbitrary operation on the instances in the scaleset. See the <code>do_operation</code> method of the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class for more details.
</p>
</li>
<li> <p><code>add_extension(publisher, type, version, settings=list(), protected_settings=list(), key_vault_settings=list())</code>: Add an extension to the scaleset.
</p>
</li>
<li> <p><code>do_vmss_operation(...)</code> Carry out an arbitrary operation on the scaleset resource (as opposed to the instances in the scaleset).
</p>
</li></ul>

<p>Many of these methods are actually provided by the <a href="#topic+az_vmss_resource">az_vmss_resource</a> class, and propagated to the template as active bindings.
</p>


<h3>Instance operations</h3>

<p>AzureVM has the ability to parallelise scaleset instance operations using a background process pool provided by AzureRMR. This can lead to significant speedups when working with scalesets with high instance counts. The pool is created automatically the first time that it is required, and remains persistent for the session. You can control the size of the process pool with the <code>azure_vm_minpoolsize</code> and <code>azure_vm_maxpoolsize</code> options, which have default values 2 and 10 respectively.
</p>
<p>The <code>id</code> argument lets you specify a subset of instances on which to carry out an operation. This can be a character vector of instance IDs; a list of instance objects such as returned by <code>list_instances</code>; or a single instance object. The default (NULL) is to carry out the operation on all instances.
</p>


<h3>See Also</h3>

<p><a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a>, <a href="#topic+create_vm_scaleset">create_vm_scaleset</a>, <a href="#topic+get_vm_scaleset">get_vm_scaleset</a>, <a href="#topic+delete_vm_scaleset">delete_vm_scaleset</a>, <a href="AzureRMR.html#topic+pool">AzureRMR::init_pool</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/rest/api/compute/virtualmachinescalesets">VM scaleset API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

vmss &lt;- sub$get_vm_scaleset("myscaleset")

vmss$identity

vmss$get_public_ip_address()  # NA if the scaleset doesn't have a load balancer

vmss$start()
vmss$get_vm_private_ip_addresses()
vmss$get_vm_public_ip_addresses()  # NA if scaleset nodes are not publicly visible

instances &lt;- vmss$list_instances()
first &lt;- instances[1]
vmss$run_script("echo hello world! &gt; /tmp/hello.txt", id=first)
vmss$stop(id=first)
vmss$reimage(id=first)

vmss$sync_vmss_status()


## End(Not run)
</code></pre>

<hr>
<h2 id='build_template_definition.vm_config'>Build template definition and parameters</h2><span id='topic+build_template_definition.vm_config'></span><span id='topic+build_template'></span><span id='topic+build_template_definition.vmss_config'></span><span id='topic+build_template_parameters.vm_config'></span><span id='topic+build_template_parameters.vmss_config'></span>

<h3>Description</h3>

<p>Build template definition and parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vm_config'
build_template_definition(config, ...)

## S3 method for class 'vmss_config'
build_template_definition(config, ...)

## S3 method for class 'vm_config'
build_template_parameters(config, name, login_user, size, ...)

## S3 method for class 'vmss_config'
build_template_parameters(config, name, login_user, size, instances, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="build_template_definition.vm_config_+3A_config">config</code></td>
<td>
<p>An object of class <code>vm_config</code> or <code>vmss_config</code> representing a virtual machine or scaleset deployment.</p>
</td></tr>
<tr><td><code id="build_template_definition.vm_config_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="build_template_definition.vm_config_+3A_name">name</code></td>
<td>
<p>The VM or scaleset name. Will also be used for the domain name label, if a public IP address is included in the deployment.</p>
</td></tr>
<tr><td><code id="build_template_definition.vm_config_+3A_login_user">login_user</code></td>
<td>
<p>An object of class <code>user_config</code> representing the login details for the admin user account on the VM.</p>
</td></tr>
<tr><td><code id="build_template_definition.vm_config_+3A_size">size</code></td>
<td>
<p>The VM (instance) size.</p>
</td></tr>
<tr><td><code id="build_template_definition.vm_config_+3A_instances">instances</code></td>
<td>
<p>For <code>vmss_config</code>, the number of (initial) instances in the VM scaleset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for the generics defined in the AzureRMR package.
</p>


<h3>Value</h3>

<p>Objects of class <code>json</code>, which are JSON character strings representing the deployment template and its parameters.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+vm_config">vm_config</a>, <a href="#topic+vmss_config">vmss_config</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
vm &lt;- ubuntu_18.04()
build_template_definition(vm)
build_template_parameters(vm, "myubuntuvm",
    user_config("username", "~/.ssh/id_rsa.pub"), "Standard_DS3_v2")

</code></pre>

<hr>
<h2 id='centos_7.5'>VM configuration functions</h2><span id='topic+centos_7.5'></span><span id='topic+centos_7.6'></span><span id='topic+centos_8.1'></span><span id='topic+debian_8_backports'></span><span id='topic+debian_9_backports'></span><span id='topic+debian_10_backports'></span><span id='topic+debian_10_backports_gen2'></span><span id='topic+ubuntu_dsvm'></span><span id='topic+ubuntu_dsvm_gen2'></span><span id='topic+windows_dsvm'></span><span id='topic+rhel_7.6'></span><span id='topic+rhel_8'></span><span id='topic+rhel_8.1'></span><span id='topic+rhel_8.1_gen2'></span><span id='topic+rhel_8.2'></span><span id='topic+rhel_8.2_gen2'></span><span id='topic+ubuntu_16.04'></span><span id='topic+ubuntu_18.04'></span><span id='topic+ubuntu_20.04'></span><span id='topic+ubuntu_20.04_gen2'></span><span id='topic+windows_2016'></span><span id='topic+windows_2019'></span><span id='topic+windows_2019_gen2'></span><span id='topic+vm_config'></span>

<h3>Description</h3>

<p>VM configuration functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centos_7.5(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

centos_7.6(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

centos_8.1(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

debian_8_backports(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

debian_9_backports(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

debian_10_backports(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

debian_10_backports_gen2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

ubuntu_dsvm(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh,
  nsg_rule_allow_jupyter, nsg_rule_allow_rstudio)), ...)

ubuntu_dsvm_gen2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh,
  nsg_rule_allow_jupyter, nsg_rule_allow_rstudio)), ...)

windows_dsvm(keylogin = FALSE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_rdp)), ...)

rhel_7.6(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

rhel_8(keylogin = TRUE, managed_identity = TRUE, datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

rhel_8.1(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

rhel_8.1_gen2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

rhel_8.2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

rhel_8.2_gen2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

ubuntu_16.04(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

ubuntu_18.04(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

ubuntu_20.04(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

ubuntu_20.04_gen2(keylogin = TRUE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_ssh)), ...)

windows_2016(keylogin = FALSE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_rdp)), ...)

windows_2019(keylogin = FALSE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_rdp)), ...)

windows_2019_gen2(keylogin = FALSE, managed_identity = TRUE,
  datadisks = numeric(0), nsg = nsg_config(list(nsg_rule_allow_rdp)), ...)

vm_config(image, keylogin, managed_identity = TRUE,
  os_disk_type = c("Premium_LRS", "StandardSSD_LRS", "Standard_LRS"),
  datadisks = numeric(0), nsg = nsg_config(), ip = ip_config(),
  vnet = vnet_config(), nic = nic_config(), other_resources = list(),
  variables = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centos_7.5_+3A_keylogin">keylogin</code></td>
<td>
<p>Whether to use an SSH public key to login (TRUE) or a password (FALSE). Note that Windows does not support SSH key logins.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_managed_identity">managed_identity</code></td>
<td>
<p>Whether to provide a managed system identity for the VM.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_datadisks">datadisks</code></td>
<td>
<p>The data disks to attach to the VM. Specify this as either a vector of numeric disk sizes in GB, or a list of <code>datadisk_config</code> objects for more control over the specification.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_nsg">nsg</code></td>
<td>
<p>The network security group for the VM. Can be a call to <code>nsg_config</code> to create a new NSG; an AzureRMR resource object or resource ID to reuse an existing NSG; or NULL to not use an NSG (not recommended).</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_...">...</code></td>
<td>
<p>For the specific VM configurations, other customisation arguments to be passed to <code>vm_config</code>. For <code>vm_config</code>, named arguments that will be folded into the VM resource definition in the template. In particular use <code style="white-space: pre;">&#8288;properties=list(*)&#8288;</code> to set additional properties for the VM, beyond those set by the various configuration functions.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_image">image</code></td>
<td>
<p>For <code>vm_config</code>, the VM image to deploy. This should be an object of class <code>image_config</code>, created by the function of the same name.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_os_disk_type">os_disk_type</code></td>
<td>
<p>The type of primary disk for the VM. Can be &quot;Premium_LRS&quot; (the default), &quot;StandardSSD_LRS&quot;, or &quot;Standard_LRS&quot;. Of these, &quot;Standard_LRS&quot; uses hard disks and the others use SSDs as the underlying hardware. Change this to &quot;StandardSSD_LRS&quot; or &quot;Standard_LRS&quot; if the VM size doesn't support premium storage.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_ip">ip</code></td>
<td>
<p>The public IP address for the VM. Can be a call to <code>ip_config</code> to create a new IP address; an AzureRMR resource object or resource ID to reuse an existing address resource; or NULL if the VM should not be accessible from outside its subnet.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_vnet">vnet</code></td>
<td>
<p>The virtual network for the VM. Can be a call to <code>vnet_config</code> to create a new virtual network, or an AzureRMR resource object or resource ID to reuse an existing virtual network. Note that by default, AzureVM will associate the NSG with the virtual network/subnet, not with the VM's network interface.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_nic">nic</code></td>
<td>
<p>The network interface for the VM. Can be a call to <code>nic_config</code> to create a new interface, or an AzureRMR resource object or resource ID to reuse an existing interface.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_other_resources">other_resources</code></td>
<td>
<p>An optional list of other resources to include in the deployment.</p>
</td></tr>
<tr><td><code id="centos_7.5_+3A_variables">variables</code></td>
<td>
<p>An optional named list of variables to add to the template.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are for specifying the details of a new virtual machine deployment: the VM image and related options, along with the Azure resources that the VM may need. These include the datadisks, network security group, public IP address (if the VM is to be accessible from outside its subnet), virtual network, and network interface. <code>vm_config</code> is the base configuration function, and the others call it to create VMs with specific operating systems and other image details.
</p>

<ul>
<li> <p><code>ubuntu_dsvm</code>: Data Science Virtual Machine, based on Ubuntu 18.04
</p>
</li>
<li> <p><code>windows_dsvm</code>: Data Science Virtual Machine, based on Windows Server 2019
</p>
</li>
<li> <p><code>ubuntu_16.04</code>, <code>ubuntu_18.04</code>, <code>ubuntu_20.04</code>, <code>ubuntu_20.04_gen2</code>: Ubuntu LTS
</p>
</li>
<li> <p><code>windows_2016</code>, <code>windows_2019</code>: Windows Server Datacenter edition
</p>
</li>
<li> <p><code>rhel_7.6</code>, <code>rhel_8</code>, <code>rhel_8.1</code>, <code>rhel_8.1_gen2</code>, <code>rhel_8.2</code>, &ldquo;rhel_8.2_gen2: Red Hat Enterprise Linux
</p>
</li>
<li> <p><code>centos_7.5</code>, <code>centos_7.6</code>, <code>centos_8.1</code>: CentOS
</p>
</li>
<li> <p><code>debian_8_backports</code>, <code>debian_9_backports</code>, <code>debian_10_backports</code>, <code>debian_10_backports_gen2</code>: Debian with backports
</p>
</li></ul>

<p>The VM configurations with <code>gen2</code> in the name are <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/generation-2">generation 2 VMs</a>, which feature several technical improvements over the earlier generation 1. Consider using these for greater efficiency, however note that gen2 VMs are only available for select images and do not support all possible VM sizes.
</p>
<p>Each resource can be specified in a number of ways:
</p>

<ul>
<li><p> To <em>create</em> a new resource as part of the deployment, call the corresponding <code style="white-space: pre;">&#8288;*_config&#8288;</code> function.
</p>
</li>
<li><p> To use an <em>existing</em> resource, supply either an <code>AzureRMR::az_resource</code> object (recommended) or a string containing the resource ID.
</p>
</li>
<li><p> If the resource is not needed, specify it as NULL.
</p>
</li>
<li><p> For the <code>other_resources</code> argument, supply a list of resources, each of which should be a list of resource fields (name, type, properties, sku, etc).
</p>
</li></ul>

<p>A VM configuration defines the following template variables by default, depending on its resources. If a particular resource is created, the corresponding <code style="white-space: pre;">&#8288;*Name&#8288;</code>, <code style="white-space: pre;">&#8288;*Id&#8288;</code> and <code style="white-space: pre;">&#8288;*Ref&#8288;</code> variables will be available. If a resource is referred to but not created, the <code style="white-space: pre;">&#8288;*Name*&#8288;</code> and <code style="white-space: pre;">&#8288;*Id&#8288;</code> variables will be available. Other variables can be defined via the <code>variables</code> argument.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Variable name</strong> </td><td style="text-align: left;"> <strong>Contents</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>location</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceGroup().location]&#8288;</code> </td><td style="text-align: left;"> Region to deploy resources </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vmId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]&#8288;</code> </td><td style="text-align: left;"> VM resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vmRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]&#8288;</code> </td><td style="text-align: left;"> VM template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-nsg')]&#8288;</code> </td><td style="text-align: left;"> Network security group resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsgName'))]&#8288;</code> </td><td style="text-align: left;"> NSG resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/networkSecurityGroups/', variables('nsgName'))]&#8288;</code> </td><td style="text-align: left;"> NSG template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-ip')]&#8288;</code> </td><td style="text-align: left;"> Public IP address resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/publicIPAddresses', variables('ipName'))]&#8288;</code> </td><td style="text-align: left;"> IP resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/publicIPAddresses/', variables('ipName'))]&#8288;</code> </td><td style="text-align: left;"> IP template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-vnet')]&#8288;</code> </td><td style="text-align: left;"> Virtual network resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/virtualNetworks', variables('vnetName'))]&#8288;</code> </td><td style="text-align: left;"> Vnet resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/virtualNetworks/', variables('vnetName'))]&#8288;</code> </td><td style="text-align: left;"> Vnet template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>subnet</code> </td><td style="text-align: left;"> <code>subnet</code> </td><td style="text-align: left;"> Subnet name. Only defined if a Vnet was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>subnetId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(variables('vnetId'), '/subnets/', variables('subnet'))]&#8288;</code> </td><td style="text-align: left;"> Subnet resource ID. Only defined if a Vnet was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nicName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-nic')]&#8288;</code> </td><td style="text-align: left;"> Network interface resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nicId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/networkInterfaces', variables('nicName'))]&#8288;</code> </td><td style="text-align: left;"> NIC resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nicRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/networkInterfaces/', variables('nicName'))]&#8288;</code> </td><td style="text-align: left;"> NIC template reference
</td>
</tr>

</table>

<p>Thus, for example, if you are creating a VM named &quot;myvm&quot; along with all its associated resources, the NSG is named &quot;myvm-nsg&quot;, the public IP address is &quot;myvm-ip&quot;, the virtual network is &quot;myvm-vnet&quot;, and the network interface is &quot;myvm-nic&quot;.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>vm_config</code>, that can be used by the <code>create_vm</code> method.
</p>


<h3>See Also</h3>

<p><a href="#topic+image_config">image_config</a>, <a href="#topic+user_config">user_config</a>, <a href="#topic+datadisk_config">datadisk_config</a> for options relating to the VM resource itself
</p>
<p><a href="#topic+nsg_config">nsg_config</a>, <a href="#topic+ip_config">ip_config</a>, <a href="#topic+vnet_config">vnet_config</a>, <a href="#topic+nic_config">nic_config</a> for other resource configs
</p>
<p><a href="#topic+build_template">build_template</a> for template builder methods
</p>
<p><a href="#topic+vmss_config">vmss_config</a> for configuring a virtual machine scaleset
</p>
<p><a href="#topic+create_vm">create_vm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# basic Linux (Ubuntu) and Windows configs
ubuntu_18.04()
windows_2019()

# Windows DSVM with 500GB data disk, no public IP address
windows_dsvm(datadisks=500, ip=NULL)

# RHEL VM exposing ports 80 (HTTP) and 443 (HTTPS)
rhel_8(nsg=nsg_config(nsg_rule_allow_http, nsg_rule_allow_https))

# exposing no ports externally, spot (low) priority
rhel_8(nsg=nsg_config(list()), properties=list(priority="spot"))

# deploying an extra resource: storage account
ubuntu_18.04(
    variables=list(storName="[concat(parameters('vmName'), 'stor')]"),
    other_resources=list(
        list(
            type="Microsoft.Storage/storageAccounts",
            name="[variables('storName')]",
            apiVersion="2018-07-01",
            location="[variables('location')]",
            properties=list(supportsHttpsTrafficOnly=TRUE),
            sku=list(name="Standard_LRS"),
            kind="Storage"
        )
    )
)

## custom VM configuration: Windows 10 Pro 1903 with data disks
## this assumes you have a valid Win10 desktop license
user &lt;- user_config("myname", password="Use-strong-passwords!")
image &lt;- image_config(
     publisher="MicrosoftWindowsDesktop",
     offer="Windows-10",
     sku="19h1-pro"
)
datadisks &lt;- list(
    datadisk_config(250, type="Premium_LRS"),
    datadisk_config(1000, type="Standard_LRS")
)
nsg &lt;- nsg_config(
    list(nsg_rule_allow_rdp)
)
vm_config(
    image=image,
    keylogin=FALSE,
    datadisks=datadisks,
    nsg=nsg,
    properties=list(licenseType="Windows_Client")
)


## Not run: 

# reusing existing resources: placing multiple VMs in one vnet/subnet
rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("sub_id")$
    get_resource_group("rgname")

vnet &lt;- rg$get_resource(type="Microsoft.Network/virtualNetworks", name="myvnet")

# by default, the NSG is associated with the subnet, so we don't need a new NSG either
vmconfig1 &lt;- ubuntu_18.04(vnet=vnet, nsg=NULL)
vmconfig2 &lt;- debian_9_backports(vnet=vnet, nsg=NULL)
vmconfig3 &lt;- windows_2019(vnet=vnet, nsg=NULL)


## End(Not run)
</code></pre>

<hr>
<h2 id='centos_7.5_ss'>Virtual machine scaleset configuration functions</h2><span id='topic+centos_7.5_ss'></span><span id='topic+centos_7.6_ss'></span><span id='topic+centos_8.1_ss'></span><span id='topic+debian_8_backports_ss'></span><span id='topic+debian_9_backports_ss'></span><span id='topic+debian_10_backports_ss'></span><span id='topic+debian_10_backports_gen2_ss'></span><span id='topic+ubuntu_dsvm_ss'></span><span id='topic+ubuntu_dsvm_gen2_ss'></span><span id='topic+windows_dsvm_ss'></span><span id='topic+rhel_7.6_ss'></span><span id='topic+rhel_8_ss'></span><span id='topic+rhel_8.1_ss'></span><span id='topic+rhel_8.1_gen2_ss'></span><span id='topic+rhel_8.2_ss'></span><span id='topic+rhel_8.2_gen2_ss'></span><span id='topic+ubuntu_16.04_ss'></span><span id='topic+ubuntu_18.04_ss'></span><span id='topic+ubuntu_20.04_ss'></span><span id='topic+ubuntu_20.04_gen2_ss'></span><span id='topic+windows_2016_ss'></span><span id='topic+windows_2019_ss'></span><span id='topic+windows_2019_gen2_ss'></span><span id='topic+vmss_config'></span>

<h3>Description</h3>

<p>Virtual machine scaleset configuration functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centos_7.5_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

centos_7.6_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

centos_8.1_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

debian_8_backports_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

debian_9_backports_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

debian_10_backports_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

debian_10_backports_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

ubuntu_dsvm_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh, nsg_rule_allow_jupyter,
  nsg_rule_allow_rstudio)), load_balancer = lb_config(rules =
  list(lb_rule_ssh, lb_rule_jupyter, lb_rule_rstudio), probes =
  list(lb_probe_ssh, lb_probe_jupyter, lb_probe_rstudio)), ...)

ubuntu_dsvm_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh, nsg_rule_allow_jupyter,
  nsg_rule_allow_rstudio)), load_balancer = lb_config(rules =
  list(lb_rule_ssh, lb_rule_jupyter, lb_rule_rstudio), probes =
  list(lb_probe_ssh, lb_probe_jupyter, lb_probe_rstudio)), ...)

windows_dsvm_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_rdp)),
  load_balancer = lb_config(rules = list(lb_rule_rdp), probes =
  list(lb_probe_rdp)), options = scaleset_options(keylogin = FALSE), ...)

rhel_7.6_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

rhel_8_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

rhel_8.1_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

rhel_8.1_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

rhel_8.2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

rhel_8.2_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

ubuntu_16.04_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

ubuntu_18.04_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

ubuntu_20.04_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

ubuntu_20.04_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_ssh)),
  load_balancer = lb_config(rules = list(lb_rule_ssh), probes =
  list(lb_probe_ssh)), ...)

windows_2016_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_rdp)),
  load_balancer = lb_config(rules = list(lb_rule_rdp), probes =
  list(lb_probe_rdp)), options = scaleset_options(keylogin = FALSE), ...)

windows_2019_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_rdp)),
  load_balancer = lb_config(rules = list(lb_rule_rdp), probes =
  list(lb_probe_rdp)), options = scaleset_options(keylogin = FALSE), ...)

windows_2019_gen2_ss(datadisks = numeric(0),
  nsg = nsg_config(list(nsg_rule_allow_rdp)),
  load_balancer = lb_config(rules = list(lb_rule_rdp), probes =
  list(lb_probe_rdp)), options = scaleset_options(keylogin = FALSE), ...)

vmss_config(image, options = scaleset_options(), datadisks = numeric(0),
  nsg = nsg_config(), vnet = vnet_config(), load_balancer = lb_config(),
  load_balancer_address = ip_config(), autoscaler = autoscaler_config(),
  other_resources = list(), variables = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centos_7.5_ss_+3A_datadisks">datadisks</code></td>
<td>
<p>The data disks to attach to the VM. Specify this as either a vector of numeric disk sizes in GB, or a list of <code>datadisk_config</code> objects for more control over the specification.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_nsg">nsg</code></td>
<td>
<p>The network security group for the scaleset. Can be a call to <code>nsg_config</code> to create a new NSG; an AzureRMR resource object or resource ID to reuse an existing NSG; or NULL to not use an NSG (not recommended).</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_load_balancer">load_balancer</code></td>
<td>
<p>The load balancer for the scaleset. Can be a call to <code>lb_config</code> to create a new load balancer;  an AzureRMR resource object or resource ID to reuse an existing load balancer; or NULL if load balancing is not required.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_...">...</code></td>
<td>
<p>For the specific VM configurations, other customisation arguments to be passed to <code>vm_config</code>. For <code>vmss_config</code>, named arguments that will be folded into the scaleset resource definition in the template.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_options">options</code></td>
<td>
<p>Scaleset options, as obtained via a call to <code>scaleset_options</code>.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_image">image</code></td>
<td>
<p>For <code>vmss_config</code>, the VM image to deploy. This should be an object of class <code>image_config</code>, created by the function of the same name.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_vnet">vnet</code></td>
<td>
<p>The virtual network for the scaleset. Can be a call to <code>vnet_config</code> to create a new virtual network, or an AzureRMR resource object or resource ID to reuse an existing virtual network. Note that by default, AzureVM will associate the NSG with the virtual network/subnet, not with the VM's network interface.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_load_balancer_address">load_balancer_address</code></td>
<td>
<p>The public IP address for the load balancer. Can be a call to <code>ip_config</code> to create a new IP address, or an AzureRMR resource object or resource ID to reuse an existing address resource. Ignored if <code>load_balancer</code> is NULL.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_autoscaler">autoscaler</code></td>
<td>
<p>The autoscaler for the scaleset. Can be a call to <code>autoscaler_config</code> to create a new autoscaler; an AzureRMR resource object or resource ID to reuse an existing autoscaler; or NULL if autoscaling is not required.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_other_resources">other_resources</code></td>
<td>
<p>An optional list of other resources to include in the deployment.</p>
</td></tr>
<tr><td><code id="centos_7.5_ss_+3A_variables">variables</code></td>
<td>
<p>An optional named list of variables to add to the template.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are for specifying the details of a new virtual machine scaleset deployment: the base VM image and related options, along with the Azure resources that the scaleset may need. These include the network security group, virtual network, load balancer and associated public IP address, and autoscaler.
</p>
<p>Each resource can be specified in a number of ways:
</p>

<ul>
<li><p> To <em>create</em> a new resource as part of the deployment, call the corresponding <code style="white-space: pre;">&#8288;*_config&#8288;</code> function.
</p>
</li>
<li><p> To use an <em>existing</em> resource, supply either an <code>AzureRMR::az_resource</code> object (recommended) or a string containing the resource ID.
</p>
</li>
<li><p> If the resource is not needed, specify it as NULL.
</p>
</li>
<li><p> For the <code>other_resources</code> argument, supply a list of resources, each of which should be a list of resource fields (name, type, properties, sku, etc).
</p>
</li></ul>

<p>The <code>vmss_config</code> function is the base configuration function, and the others call it to create VM scalesets with specific operating systems and other image details.
</p>

<ul>
<li> <p><code>ubuntu_dsvm_ss</code>: Data Science Virtual Machine, based on Ubuntu 18.04
</p>
</li>
<li> <p><code>windows_dsvm_ss</code>: Data Science Virtual Machine, based on Windows Server 2019
</p>
</li>
<li> <p><code>ubuntu_16.04_ss</code>, <code>ubuntu_18.04_ss</code>, <code>ubuntu_20.04_ss</code>, <code>ubuntu_20.04_gen2_ss</code>: Ubuntu LTS
</p>
</li>
<li> <p><code>windows_2016_ss</code>, <code>windows_2019_ss</code>: Windows Server Datacenter edition
</p>
</li>
<li> <p><code>rhel_7.6_ss</code>, <code>rhel_8_ss</code>, <code>rhel_8.1_ss</code>, <code>rhel_8.1_gen2_ss</code>, <code>rhel_8.2_ss</code>, <code>rhel_8.2_gen2_ss</code>: Red Hat Enterprise Linux
</p>
</li>
<li> <p><code>centos_7.5_ss</code>, <code>centos_7.6_ss</code>, <code>centos_8.1_ss</code>: CentOS
</p>
</li>
<li> <p><code>debian_8_backports_ss</code>, <code>debian_9_backports_ss</code>, <code>debian_10_backports_ss</code>, <code>debian_10_backports_gen2_ss</code>: Debian with backports
</p>
</li></ul>

<p>The VM scaleset configurations with <code>gen2</code> in the name use <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/generation-2">generation 2 VMs</a>, which feature several technical improvements over the earlier generation 1. Consider using these for greater efficiency, however note that gen2 VMs are only available for select images and do not support all possible VM sizes.
</p>
<p>A VM scaleset configuration defines the following template variables by default, depending on its resources. If a particular resource is created, the corresponding <code style="white-space: pre;">&#8288;*Name&#8288;</code>, <code style="white-space: pre;">&#8288;*Id&#8288;</code> and <code style="white-space: pre;">&#8288;*Ref&#8288;</code> variables will be available. If a resource is referred to but not created, the <code style="white-space: pre;">&#8288;*Name*&#8288;</code> and <code style="white-space: pre;">&#8288;*Id&#8288;</code> variables will be available. Other variables can be defined via the <code>variables</code> argument.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Variable name</strong> </td><td style="text-align: left;"> <strong>Contents</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>location</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceGroup().location]&#8288;</code> </td><td style="text-align: left;"> Region to deploy resources </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vmId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Compute/virtualMachines', parameters('vmName'))]&#8288;</code> </td><td style="text-align: left;"> VM scaleset resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vmRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]&#8288;</code> </td><td style="text-align: left;"> Scaleset template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-nsg')]&#8288;</code> </td><td style="text-align: left;"> Network security group resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/networkSecurityGroups', variables('nsgName'))]&#8288;</code> </td><td style="text-align: left;"> NSG resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nsgRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/networkSecurityGroups/', variables('nsgName'))]&#8288;</code> </td><td style="text-align: left;"> NSG template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-vnet')]&#8288;</code> </td><td style="text-align: left;"> Virtual network resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/virtualNetworks', variables('vnetName'))]&#8288;</code> </td><td style="text-align: left;"> Vnet resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>vnetRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/virtualNetworks/', variables('vnetName'))]&#8288;</code> </td><td style="text-align: left;"> Vnet template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>subnet</code> </td><td style="text-align: left;"> <code>subnet</code> </td><td style="text-align: left;"> Subnet name. Only defined if a Vnet was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>subnetId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(variables('vnetId'), '/subnets/', variables('subnet'))]&#8288;</code> </td><td style="text-align: left;"> Subnet resource ID. Only defined if a Vnet was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-lb')]&#8288;</code> </td><td style="text-align: left;"> Load balancer resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/loadBalancers', variables('lbName'))]&#8288;</code> </td><td style="text-align: left;"> Load balancer resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/loadBalancers/', variables('lbName'))]&#8288;</code> </td><td style="text-align: left;"> Load balancer template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbFrontendName</code> </td><td style="text-align: left;"> <code>frontend</code> </td><td style="text-align: left;"> Load balancer frontend IP configuration name. Only defined if a load balancer was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbBackendName</code> </td><td style="text-align: left;"> <code>backend</code> </td><td style="text-align: left;"> Load balancer backend address pool name. Only defined if a load balancer was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbFrontendId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(variables('lbId'), '/frontendIPConfigurations/', variables('lbFrontendName'))]&#8288;</code> </td><td style="text-align: left;"> Load balancer frontend resource ID. Only defined if a load balancer was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lbBackendId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(variables('lbId'), '/backendAddressPools/', variables('lbBackendName'))]&#8288;</code> </td><td style="text-align: left;"> Load balancer backend resource ID. Only defined if a load balancer was created or supplied as an <code>az_resource</code> object. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-ip')]&#8288;</code> </td><td style="text-align: left;"> Public IP address resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Network/publicIPAddresses', variables('ipName'))]&#8288;</code> </td><td style="text-align: left;"> IP resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ipRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Network/publicIPAddresses/', variables('ipName'))]&#8288;</code> </td><td style="text-align: left;"> IP template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>asName</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat(parameters('vmName'), '-as')]&#8288;</code> </td><td style="text-align: left;"> Autoscaler resource name </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>asId</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[resourceId('Microsoft.Insights/autoscaleSettings', variables('asName'))]&#8288;</code> </td><td style="text-align: left;"> Autoscaler resource ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>asRef</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[concat('Microsoft.Insights/autoscaleSettings/', variables('asName'))]&#8288;</code> </td><td style="text-align: left;"> Autoscaler template reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>asMaxCapacity</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[mul(int(parameters('instanceCount')), 10)]&#8288;</code> </td><td style="text-align: left;"> Maximum capacity for the autoscaler. Only defined if an autoscaler was created. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>asScaleValue</code> </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;[max(div(int(parameters('instanceCount')), 5), 1)]&#8288;</code> </td><td style="text-align: left;"> Default capacity for the autoscaler. Only defined if an autoscaler was created.
</td>
</tr>

</table>

<p>Thus, for example, if you are creating a VM scaleset named &quot;myvmss&quot; along with all its associated resources, the NSG is named &quot;myvmss-nsg&quot;, the virtual network is &quot;myvmss-vnet&quot;, the load balancer is &quot;myvmss-lb&quot;, the public IP address is &quot;myvmss-ip&quot;, and the autoscaler is &quot;myvm-as&quot;.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>vmss_config</code>, that can be used by the <code>create_vm_scaleset</code> method.
</p>


<h3>See Also</h3>

<p><a href="#topic+scaleset_options">scaleset_options</a> for options relating to the scaleset resource itself
</p>
<p><a href="#topic+nsg_config">nsg_config</a>, <a href="#topic+ip_config">ip_config</a>, <a href="#topic+vnet_config">vnet_config</a>, <a href="#topic+lb_config">lb_config</a>, <a href="#topic+autoscaler_config">autoscaler_config</a> for other resource configs
</p>
<p><a href="#topic+build_template">build_template</a> for template builder methods
</p>
<p><a href="#topic+vm_config">vm_config</a> for configuring an individual virtual machine
</p>
<p><a href="#topic+create_vm_scaleset">create_vm_scaleset</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# basic Linux (Ubuntu) and Windows configs
ubuntu_18.04_ss()
windows_2019_ss()

# Windows DSVM scaleset, no load balancer and autoscaler
windows_dsvm_ss(load_balancer=NULL, autoscaler=NULL)

# RHEL VM exposing ports 80 (HTTP) and 443 (HTTPS)
rhel_8_ss(nsg=nsg_config(nsg_rule_allow_http, nsg_rule_allow_https))

# exposing no ports externally
rhel_8_ss(nsg=nsg_config(list()))

# low-priority (spot) VMs, large scaleset (&gt;100 instances allowed), no managed identity
rhel_8_ss(options=scaleset_options(priority="spot", large_scaleset=TRUE, managed_identity=FALSE))


## Not run: 

# reusing existing resources: placing a scaleset in an existing vnet/subnet
# we don't need a new network security group either
vnet &lt;- AzureRMR::get_azure_login()$
    get_subscription("sub_id")$
    get_resource_group("rgname")$
    get_resource(type="Microsoft.Network/virtualNetworks", name="myvnet")

ubuntu_18.04_ss(vnet=vnet, nsg=NULL)


## End(Not run)
</code></pre>

<hr>
<h2 id='create_vm'>Create a new virtual machine or scaleset of virtual machines</h2><span id='topic+create_vm'></span><span id='topic+create_vm_scaleset'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_resource_group'
create_vm(name, login_user, size = "Standard_DS3_v2", config = "ubuntu_dsvm",
          managed_identity = TRUE, datadisks = numeric(0), ...,
          template, parameters, mode = "Incremental", wait = TRUE)

## R6 method for class 'az_subscription'
create_vm(name, ..., resource_group = name, location)

## R6 method for class 'az_resource_group'
create_vm_scaleset(name, login_user, instances, size = "Standard_DS1_v2",
                   config = "ubuntu_dsvm_ss", ...,
                   template, parameters, mode = "Incremental", wait = TRUE)

## R6 method for class 'az_subscription'
create_vm_scaleset(name, ..., resource_group = name, location)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the VM or scaleset.
</p>
</li>
<li> <p><code>location</code>: For the subscription methods, the location for the VM or scaleset. Use the <code>list_locations()</code> method of the <code>AzureRMR::az_subscription</code> class to see what locations are available.
</p>
</li>
<li> <p><code>resource_group</code>: For the subscription methods, the resource group in which to place the VM or scaleset. Defaults to a new resource group with the same name as the VM.
</p>
</li>
<li> <p><code>login_user</code>: The details for the admin login account. An object of class <code>user_config</code>, obtained by a call to the <code>user_config</code> function.
</p>
</li>
<li> <p><code>size</code>: The VM (instance) size. Use the <a href="#topic+list_vm_sizes">list_vm_sizes</a> method to see what sizes are available.
</p>
</li>
<li> <p><code>config</code>: The VM or scaleset configuration. See 'Details' below for how to specify this. The default is to use an Ubuntu Data Science Virtual Machine.
</p>
</li>
<li> <p><code>managed_identity</code>: For <code>create_vm</code>, whether the VM should have a managed identity attached.
</p>
</li>
<li> <p><code>datadisks</code>: Any data disks to attach to the VM or scaleset. See 'Details' below.
</p>
</li>
<li> <p><code>instances</code>: For <code>create_vm_scaleset</code>, the initial number of instances in the scaleset.
</p>
</li>
<li> <p><code>...</code> For the subscription methods, any of the other arguments listed here, which will be passed to the resource group method. For the resource group method, additional arguments to pass to the VM/scaleset configuration functions <a href="#topic+vm_config">vm_config</a> and <a href="#topic+vmss_config">vmss_config</a>. See the examples below.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;template,parameters&#8288;</code>: The template definition and parameters to deploy. By default, these are constructed from the values of the other arguments, but you can supply your own template and/or parameters as well.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deployment is complete.
</p>
</li>
<li> <p><code>mode</code>: The template deployment mode. If &quot;Complete&quot;, any existing resources in the resource group will be deleted.
</p>
</li></ul>



<h3>Details</h3>

<p>These methods deploy a template to create a new virtual machine or scaleset.
</p>
<p>The <code>config</code> argument can be specified in the following ways:
</p>

<ul>
<li><p> As the name of a supplied VM or scaleset configuration, like &quot;ubuntu_dsvm&quot; or &quot;ubuntu_dsvm_ss&quot;. AzureVM comes with a number of supplied configurations to deploy commonly used images, which can be seen at <a href="#topic+vm_config">vm_config</a> and <a href="#topic+vmss_config">vmss_config</a>. Any arguments in <code>...</code> will be passed to the configuration, allowing you to customise the deployment.
</p>
</li>
<li><p> As a call to the <code>vm_config</code> or <code>vmss_config</code> functions, to deploy a custom VM image.
</p>
</li>
<li><p> As an object of class <code>vm_config</code> or <code>vmss_config</code>.
</p>
</li></ul>

<p>The data disks for the VM can be specified as either a vector of numeric disk sizes in GB, or as a list of <code>datadisk_config</code> objects, created via calls to the <code>datadisk_config</code> function. Currently, AzureVM only supports creating data disks at deployment time for single VMs, not scalesets.
</p>
<p>You can also supply your own template definition and parameters for deployment, via the <code>template</code> and <code>parameters</code> arguments. See <a href="AzureRMR.html#topic+az_template">AzureRMR::az_template</a> for information how to create templates.
</p>
<p>The <code>AzureRMR::az_subscription</code> methods will by default create the VM in <em>exclusive</em> mode, meaning a new resource group is created solely to hold the VM or scaleset. This simplifies managing the VM considerably; in particular deleting the resource group will also automatically delete all the deployed resources.
</p>


<h3>Value</h3>

<p>For <code>create_vm</code>, an object of class <code>az_vm_template</code> representing the created VM. For <code>create_vm_scaleset</code>, an object of class <code>az_vmss_template</code> representing the scaleset.
</p>


<h3>See Also</h3>

<p><a href="#topic+az_vm_template">az_vm_template</a>, <a href="#topic+az_vmss_template">az_vmss_template</a>
</p>
<p><a href="#topic+vm_config">vm_config</a>, <a href="#topic+vmss_config">vmss_config</a>, <a href="#topic+user_config">user_config</a>, <a href="#topic+datadisk_config">datadisk_config</a>
</p>
<p><a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a>, <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a>,
<a href="https://azure.microsoft.com/en-us/services/virtual-machines/data-science-virtual-machines/">Data Science Virtual Machine</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

# default Ubuntu 18.04 VM:
# SSH key login, Standard_DS3_v2, publicly accessible via SSH
sub$create_vm("myubuntuvm", user_config("myname", "~/.ssh/id_rsa.pub"),
              location="australiaeast")

# Windows Server 2019, with a 500GB datadisk attached, not publicly accessible
sub$create_vm("mywinvm", user_config("myname", password="Use-strong-passwords!"),
              size="Standard_DS4_v2", config="windows_2019", datadisks=500, ip=NULL,
              location="australiaeast")

# Ubuntu DSVM, GPU-enabled
sub$create_vm("mydsvm", user_config("myname", "~/.ssh/id_rsa.pub"), size="Standard_NC12",
              config="ubuntu_dsvm_ss",
              location="australiaeast")

## custom VM configuration: Windows 10 Pro 1903 with data disks
## this assumes you have a valid Win10 desktop license
user &lt;- user_config("myname", password="Use-strong-passwords!")
image &lt;- image_config(
     publisher="MicrosoftWindowsDesktop",
     offer="Windows-10",
     sku="19h1-pro"
)
datadisks &lt;- list(
    datadisk_config(250, type="Premium_LRS"),
    datadisk_config(1000, type="Standard_LRS")
)
nsg &lt;- nsg_config(
    list(nsg_rule_allow_rdp)
)
config &lt;- vm_config(
    image=image,
    keylogin=FALSE,
    datadisks=datadisks,
    nsg=nsg,
    properties=list(licenseType="Windows_Client")
)
sub$create_vm("mywin10vm", user, size="Standard_DS2_v2", config=config,
              location="australiaeast")


# default Ubuntu scaleset:
# load balancer and autoscaler enabled, Standard_DS1_v2
sub$create_vm_scaleset("mydsvmss", user_config("myname", "~/.ssh/id_rsa.pub"),
                       instances=5,
                       location="australiaeast"))

# Ubuntu DSVM scaleset with public GPU-enabled instances, no load balancer or autoscaler
sub$create_vm_scaleset("mydsvmss", user_config("myname", "~/.ssh/id_rsa.pub"),
                       instances=5, size="Standard_NC12", config="ubuntu_dsvm_ss",
                       options=scaleset_options(public=TRUE),
                       load_balancer=NULL, autoscaler=NULL,
                       location="australiaeast")

# RHEL scaleset, allow http/https access
sub$create_vm_scaleset("myrhelss", user_config("myname", "~/.ssh/id_rsa.pub"),
                        instances=5, config="rhel_8_ss",
                        nsg=nsg_config(list(nsg_rule_allow_http, nsg_rule_allow_https)),
                        location="australiaeast")

# Large Debian scaleset, using low-priority (spot) VMs
# need to set the instance size to something that supports low-pri
sub$create_vm_scaleset("mydebss", user_config("myname", "~/.ssh/id_rsa.pub"),
                       instances=50, size="Standard_DS3_v2", config="debian_9_backports_ss",
                       options=scaleset_options(priority="spot", large_scaleset=TRUE),
                       location="australiaeast")


## VM and scaleset in the same resource group and virtual network
# first, create the resgroup
rg &lt;- sub$create_resource_group("rgname", "australiaeast")

# create the master
rg$create_vm("mastervm", user_config("myname", "~/.ssh/id_rsa.pub"))

# get the vnet resource
vnet &lt;- rg$get_resource(type="Microsoft.Network/virtualNetworks", name="mastervm-vnet")

# create the scaleset
rg$create_vm_scaleset("slavess", user_config("myname", "~/.ssh/id_rsa.pub"),
                      instances=5, vnet=vnet, nsg=NULL, load_balancer=NULL, autoscaler=NULL)


## End(Not run)
</code></pre>

<hr>
<h2 id='defunct'>Defunct methods</h2><span id='topic+defunct'></span><span id='topic+get_vm_cluster'></span><span id='topic+create_vm_cluster'></span><span id='topic+delete_vm_cluster'></span>

<h3>Description</h3>

<p>Defunct methods
</p>


<h3>Usage</h3>

<pre>get_vm_cluster(...)
create_vm_cluster(...)
delete_vm_cluster(...)
</pre>
<p>These methods for the <code>az_subscription</code> and <code>az_resource_group</code> classes are defunct in AzureVM 2.0. To work with virtual machine clusters, call the <a href="#topic+get_vm_scaleset">get_vm_scaleset</a>, <a href="#topic+create_vm_scaleset">create_vm_scaleset</a> and <a href="#topic+delete_vm_scaleset">delete_vm_scaleset</a> methods instead.
</p>

<hr>
<h2 id='delete_vm'>Delete virtual machine</h2><span id='topic+delete_vm'></span><span id='topic+delete_vm_scaleset'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_resource_group'
delete_vm(name, confirm = TRUE, free_resources = TRUE)

## R6 method for class 'az_subscription'
delete_vm(name, confirm = TRUE, free_resources = TRUE,
          resource_group = name)

## R6 method for class 'az_resource_group'
delete_vm_scaleset(name, confirm = TRUE, free_resources = TRUE)

## R6 method for class 'az_subscription'
delete_vm_scaleset(name, confirm = TRUE, free_resources = TRUE,
                  resource_group = name)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the VM or scaleset.
</p>
</li>
<li> <p><code>confirm</code>: Whether to confirm the delete.
</p>
</li>
<li> <p><code>free_resources</code>: If this was a deployed template, whether to free all resources created during the deployment process.
</p>
</li>
<li> <p><code>resource_group</code>: For the <code>AzureRMR::az_subscription</code> method, the resource group containing the VM or scaleset.
</p>
</li></ul>



<h3>Details</h3>

<p>For the subscription methods, deleting the VM or scaleset will also delete its resource group.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+az_vm_template">az_vm_template</a>, <a href="#topic+az_vm_resource">az_vm_resource</a>,
<a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a>, <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

sub$delete_vm("myvm")
sub$delete_vm_scaleset("myscaleset")


## End(Not run)
</code></pre>

<hr>
<h2 id='get_vm'>Get existing virtual machine(s)</h2><span id='topic+get_vm'></span><span id='topic+get_vm_scaleset'></span><span id='topic+get_vm_resource'></span><span id='topic+get_vm_scaleset_resource'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_subscription'
get_vm(name, resource_group = name)

## R6 method for class 'az_resource_group'
get_vm(name)

## R6 method for class 'az_subscription'
get_vm_scaleset(name, resource_group = name)

## R6 method for class 'az_resource_group'
get_vm_scaleset(name)

## R6 method for class 'az_resource_group')
get_vm_resource(name)
get_vm_scaleset_resource(name)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the VM or scaleset.
</p>
</li>
<li> <p><code>resource_group</code>: For the <code>az_subscription</code> methods, the resource group in which <code>get_vm()</code> and <code>get_vm_scaleset()</code>  will look for the VM or scaleset. Defaults to the VM name.
</p>
</li></ul>



<h3>Value</h3>

<p>For <code>get_vm()</code>, an object representing the VM deployment. This will include other resources besides the VM itself, such as the network interface, virtual network, etc.
</p>
<p>For <code>get_vm_scaleset()</code>, an object representing the scaleset deployment. Similarly to <code>get_vm()</code>, this includes other resources besides the scaleset.
</p>
<p>For <code>get_vm_resource()</code> and <code>get_vm_scaleset_resource()</code>, the VM or scaleset resource itself.
</p>


<h3>See Also</h3>

<p><a href="#topic+az_vm_template">az_vm_template</a>, <a href="#topic+az_vm_resource">az_vm_resource</a>, <a href="#topic+az_vmss_template">az_vmss_template</a>, <a href="#topic+az_vmss_resource">az_vmss_resource</a> for the methods available for working with VMs and VM scalesets.
</p>
<p><a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a>, <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

sub$get_vm("myvirtualmachine")
sub$get_vm_scaleset("myscaleset")

rg &lt;- sub$get_resource_group("rgname")
rg$get_vm("myothervirtualmachine")
rg$get_vm_scaleset("myotherscaleset")


## End(Not run)
</code></pre>

<hr>
<h2 id='ip_config'>Public IP address configuration</h2><span id='topic+ip_config'></span>

<h3>Description</h3>

<p>Public IP address configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ip_config(type = NULL, dynamic = NULL, ipv6 = FALSE,
  domain_name = "[parameters('vmName')]", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ip_config_+3A_type">type</code></td>
<td>
<p>The SKU of the IP address resource: &quot;basic&quot; or &quot;standard&quot;. If NULL (the default), this will be determined based on the VM's configuration.</p>
</td></tr>
<tr><td><code id="ip_config_+3A_dynamic">dynamic</code></td>
<td>
<p>Whether the IP address should be dynamically or statically allocated. Note that the standard SKU only supports standard allocation. If NULL (the default) this will be determined based on the VM's configuration.</p>
</td></tr>
<tr><td><code id="ip_config_+3A_ipv6">ipv6</code></td>
<td>
<p>Whether to create an IPv6 address. The default is IPv4.</p>
</td></tr>
<tr><td><code id="ip_config_+3A_domain_name">domain_name</code></td>
<td>
<p>The domain name label to associate with the address.</p>
</td></tr>
<tr><td><code id="ip_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+vm_config">vm_config</a>, <a href="#topic+vmss_config">vmss_config</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ip_config()
ip_config(type="basic", dynamic=TRUE)

# if you don't want a domain name associated with the IP address
ip_config(domain_name=NULL)
</code></pre>

<hr>
<h2 id='is_vm'>Is an object an Azure VM</h2><span id='topic+is_vm'></span><span id='topic+is_vm_template'></span><span id='topic+is_vm_resource'></span><span id='topic+is_vm_scaleset'></span><span id='topic+is_vm_scaleset_template'></span><span id='topic+is_vm_scaleset_resource'></span>

<h3>Description</h3>

<p>Is an object an Azure VM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_vm(object)

is_vm_template(object)

is_vm_resource(object)

is_vm_scaleset(object)

is_vm_scaleset_template(object)

is_vm_scaleset_resource(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_vm_+3A_object">object</code></td>
<td>
<p>an R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>is_vm</code> and <code>is_vm_template</code> return TRUE for an object representing a virtual machine deployment (which will include other resources besides the VM itself).
</p>
<p><code>is_vm_resource</code> returns TRUE for an object representing the specific VM resource.
</p>
<p><code>is_vm_scaleset</code> and <code>is_vm_scaleset_template</code> return TRUE for an object representing a VM scaleset deployment.
</p>
<p><code>is_vm_scaleset_resource</code> returns TRUE for an object representing the specific VM scaleset resource.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+create_vm_scaleset">create_vm_scaleset</a>, <a href="#topic+az_vm_template">az_vm_template</a>, <a href="#topic+az_vm_resource">az_vm_resource</a>, <a href="#topic+az_vmss_template">az_vmss_template</a>, <a href="#topic+az_vmss_resource">az_vmss_resource</a>
</p>

<hr>
<h2 id='lb_config'>Load balancer configuration</h2><span id='topic+lb_config'></span><span id='topic+lb_probe'></span><span id='topic+lb_rule'></span>

<h3>Description</h3>

<p>Load balancer configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lb_config(type = NULL, rules = list(), probes = list(), ...)

lb_probe(name, port, interval = 5, fail_on = 2, protocol = "Tcp")

lb_rule(name, frontend_port, backend_port = frontend_port,
  protocol = "Tcp", timeout = 5, floating_ip = FALSE, probe_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lb_config_+3A_type">type</code></td>
<td>
<p>The SKU of the load balancer resource: &quot;basic&quot; or &quot;standard&quot;. If NULL (the default), this will be determined based on the VM scaleset's configuration. Note that the load balancer SKU must be the same as that of its public IP address.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_rules">rules</code></td>
<td>
<p>A list of load balancer rules, each obtained via a call to <code>lb_rule</code>.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_probes">probes</code></td>
<td>
<p>A list of health checking probes, each obtained via a call to <code>lb_probe</code>. There must be a probe corresponding to each rule.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_name">name</code></td>
<td>
<p>For <code>lb_rule</code>, a name for the load balancing rule.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_port">port</code></td>
<td>
<p>For <code>lb_probe</code>, the port to probe.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_interval">interval</code></td>
<td>
<p>For <code>lb_probe</code>, the time interval between probes in seconds.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_fail_on">fail_on</code></td>
<td>
<p>For <code>lb_probe</code>, the probe health check will fail after this many non-responses.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_protocol">protocol</code></td>
<td>
<p>For <code>lb_probe</code> and <code>lb_rule</code>, the protocol: either &quot;Tcp&quot; or &quot;Ip&quot;.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_frontend_port">frontend_port</code>, <code id="lb_config_+3A_backend_port">backend_port</code></td>
<td>
<p>For <code>lb_rule</code>, the ports for this rule.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_timeout">timeout</code></td>
<td>
<p>The timeout interval for the rule. The default is 5 minutes.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_floating_ip">floating_ip</code></td>
<td>
<p>Whether to use floating IP addresses (direct server return). Only needed for specific scenarios, and when the frontend and backend ports don't match.</p>
</td></tr>
<tr><td><code id="lb_config_+3A_probe_name">probe_name</code></td>
<td>
<p>The name of the corresponding health check probe.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm_scaleset">create_vm_scaleset</a>, <a href="#topic+vmss_config">vmss_config</a>, <a href="#topic+lb_rules">lb_rules</a> for some predefined load balancing rules and probes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lb_config()
lb_config(type="basic")
lb_config(
    rules=list(lb_rule_ssh, lb_rule_rdp),
    probes=list(lb_probe_ssh, lb_probe_rdp)
)
</code></pre>

<hr>
<h2 id='lb_rule_ssh'>Load balancing rules</h2><span id='topic+lb_rule_ssh'></span><span id='topic+lb_rules'></span><span id='topic+lb_rule_http'></span><span id='topic+lb_rule_https'></span><span id='topic+lb_rule_rdp'></span><span id='topic+lb_rule_jupyter'></span><span id='topic+lb_rule_rstudio'></span><span id='topic+lb_rule_mssql'></span><span id='topic+lb_rule_mssql_browser'></span><span id='topic+lb_probe_ssh'></span><span id='topic+lb_probe_http'></span><span id='topic+lb_probe_https'></span><span id='topic+lb_probe_rdp'></span><span id='topic+lb_probe_jupyter'></span><span id='topic+lb_probe_rstudio'></span><span id='topic+lb_probe_mssql'></span><span id='topic+lb_probe_mssql_browser'></span>

<h3>Description</h3>

<p>Load balancing rules
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lb_rule_ssh

lb_rule_http

lb_rule_https

lb_rule_rdp

lb_rule_jupyter

lb_rule_rstudio

lb_rule_mssql

lb_rule_mssql_browser

lb_probe_ssh

lb_probe_http

lb_probe_https

lb_probe_rdp

lb_probe_jupyter

lb_probe_rstudio

lb_probe_mssql

lb_probe_mssql_browser
</code></pre>


<h3>Format</h3>

<p>Objects of class <code>lb_rule</code> and <code>lb_probe</code>.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_rule</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>
<p>An object of class <code>lb_probe</code> of length 2.
</p>


<h3>Details</h3>

<p>Some predefined load balancing objects, for commonly used ports. Each load balancing rule comes with its own health probe.
</p>

<ul>
<li><p> HTTP: TCP port 80
</p>
</li>
<li><p> HTTPS: TCP port 443
</p>
</li>
<li><p> JupyterHub: TCP port 8000
</p>
</li>
<li><p> RDP: TCP port 3389
</p>
</li>
<li><p> RStudio Server: TCP port 8787
</p>
</li>
<li><p> SSH: TCP port 22
</p>
</li>
<li><p> SQL Server: TCP port 1433
</p>
</li>
<li><p> SQL Server browser service: TCP port 1434
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+lb_config">lb_config</a>
</p>

<hr>
<h2 id='list_vm_sizes'>List available VM sizes</h2><span id='topic+list_vm_sizes'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_subscription'
list_vm_sizes(location, name_only = FALSE)

## R6 method for class 'az_resource_group'
list_vm_sizes(name_only = FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>location</code>: For the subscription class method, the location/region for which to obtain available VM sizes.
</p>
</li>
<li> <p><code>name_only</code>: Whether to return only a vector of names, or all information on each VM size.
</p>
</li></ul>



<h3>Value</h3>

<p>If <code>name_only</code> is TRUE, a character vector of names, suitable for passing to <code>create_vm</code>. If FALSE, a data frame containing the following information for each VM size: the name, number of cores, OS disk size, resource disk size, memory, and maximum data disks.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login$
    get_subscription("subscription_id")

sub$list_vm_sizes("australiaeast")

# same output as above
rg &lt;- sub$create_resource_group("rgname", location="australiaeast")
rg$list_vm_sizes()


## End(Not run)
</code></pre>

<hr>
<h2 id='nic_config'>Network interface configuration</h2><span id='topic+nic_config'></span><span id='topic+nic_ip_config'></span>

<h3>Description</h3>

<p>Network interface configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nic_config(nic_ip = list(nic_ip_config()), ...)

nic_ip_config(name = "ipconfig", private_alloc = "dynamic",
  subnet = "[variables('subnetId')]",
  public_address = "[variables('ipId')]", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nic_config_+3A_nic_ip">nic_ip</code></td>
<td>
<p>For <code>nic_config</code>, a list of IP configuration objects, each obtained via a call to <code>nic_ip_config</code>.</p>
</td></tr>
<tr><td><code id="nic_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
<tr><td><code id="nic_config_+3A_name">name</code></td>
<td>
<p>For <code>nic_ip_config</code>, the name of the IP configuration.</p>
</td></tr>
<tr><td><code id="nic_config_+3A_private_alloc">private_alloc</code></td>
<td>
<p>For <code>nic_ip_config</code>, the allocation method for a private IP address. Can be &quot;dynamic&quot; or &quot;static&quot;.</p>
</td></tr>
<tr><td><code id="nic_config_+3A_subnet">subnet</code></td>
<td>
<p>For <code>nic_ip_config</code>, the subnet to associate with this private IP address.</p>
</td></tr>
<tr><td><code id="nic_config_+3A_public_address">public_address</code></td>
<td>
<p>For <code>nic_ip_config</code>, the public IP address. Defaults to the public IP address created or used as part of this VM deployment. Ignored if the deployment does not include a public address.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+vm_config">vm_config</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nic_config()
</code></pre>

<hr>
<h2 id='nsg_config'>Network security group configuration</h2><span id='topic+nsg_config'></span><span id='topic+nsg_rule'></span>

<h3>Description</h3>

<p>Network security group configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsg_config(rules = list(), ...)

nsg_rule(name, dest_port = "*", dest_addr = "*", dest_asgs = NULL,
  source_port = "*", source_addr = "*", source_asgs = NULL,
  access = "allow", direction = "inbound", protocol = "Tcp",
  priority = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nsg_config_+3A_rules">rules</code></td>
<td>
<p>for <code>nsg_config</code>, a list of security rule objects, each obtained via a call to <code>nsg_rule</code>.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_name">name</code></td>
<td>
<p>For <code>nsg_rule</code>, a name for the rule.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_dest_port">dest_port</code>, <code id="nsg_config_+3A_dest_addr">dest_addr</code>, <code id="nsg_config_+3A_dest_asgs">dest_asgs</code></td>
<td>
<p>For <code>nsg_rule</code>, the destination port, address range, and application security groups for a rule.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_source_port">source_port</code>, <code id="nsg_config_+3A_source_addr">source_addr</code>, <code id="nsg_config_+3A_source_asgs">source_asgs</code></td>
<td>
<p>For <code>nsg_rule</code>, the source port, address range, and application security groups for a rule.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_access">access</code></td>
<td>
<p>For <code>nsg_rule</code>, the action to take: &quot;allow&quot; or &quot;deny&quot;.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_direction">direction</code></td>
<td>
<p>For <code>nsg_rule</code>, the direction of traffic: &quot;inbound&quot; or &quot;outbound&quot;.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_protocol">protocol</code></td>
<td>
<p>For <code>nsg_rule</code>, the network protocol: either &quot;Tcp&quot; or &quot;Udp&quot;.</p>
</td></tr>
<tr><td><code id="nsg_config_+3A_priority">priority</code></td>
<td>
<p>For <code>nsg_rule</code>, the rule priority. If NULL, this will be set automatically by AzureVM.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+vm_config">vm_config</a>, <a href="#topic+vmss_config">vmss_config</a>, <a href="#topic+nsg_rules">nsg_rules</a> for some predefined security rules
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nsg_config()
nsg_config(list(nsg_rule_allow_ssh))  # for Linux
nsg_config(list(nsg_rule_allow_rdp))  # for Windows
nsg_config(list(nsg_rule_allow_http, nsg_rule_allow_https))

# a custom rule
nsg_config(list(
    nsg_rule(
        name="whitelist",
        source_addr="114.198.100.0/24",
        access="allow",
        protocol="*"
    )
))
</code></pre>

<hr>
<h2 id='nsg_rule_allow_ssh'>Network security rules</h2><span id='topic+nsg_rule_allow_ssh'></span><span id='topic+nsg_rules'></span><span id='topic+nsg_rule_allow_http'></span><span id='topic+nsg_rule_allow_https'></span><span id='topic+nsg_rule_allow_rdp'></span><span id='topic+nsg_rule_allow_jupyter'></span><span id='topic+nsg_rule_allow_rstudio'></span><span id='topic+nsg_rule_allow_mssql'></span><span id='topic+nsg_rule_allow_mssql_browser'></span>

<h3>Description</h3>

<p>Network security rules
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsg_rule_allow_ssh

nsg_rule_allow_http

nsg_rule_allow_https

nsg_rule_allow_rdp

nsg_rule_allow_jupyter

nsg_rule_allow_rstudio

nsg_rule_allow_mssql

nsg_rule_allow_mssql_browser
</code></pre>


<h3>Format</h3>

<p>Objects of class <code>nsg_rule</code>.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>
<p>An object of class <code>nsg_rule</code> of length 2.
</p>


<h3>Details</h3>

<p>Some predefined network security rule objects, to unblock commonly used ports.
</p>

<ul>
<li><p> HTTP: TCP port 80
</p>
</li>
<li><p> HTTPS: TCP port 443
</p>
</li>
<li><p> JupyterHub: TCP port 8000
</p>
</li>
<li><p> RDP: TCP port 3389
</p>
</li>
<li><p> RStudio Server: TCP port 8787
</p>
</li>
<li><p> SSH: TCP port 22
</p>
</li>
<li><p> SQL Server: TCP port 1433
</p>
</li>
<li><p> SQL Server browser service: TCP port 1434
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+nsg_config">nsg_config</a>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+build_template_definition'></span><span id='topic+build_template_parameters'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>AzureRMR</dt><dd><p><code><a href="AzureRMR.html#topic+build_template">build_template_definition</a></code>, <code><a href="AzureRMR.html#topic+build_template">build_template_parameters</a></code></p>
</dd>
</dl>

<hr>
<h2 id='scaleset_options'>Virtual machine scaleset options</h2><span id='topic+scaleset_options'></span>

<h3>Description</h3>

<p>Virtual machine scaleset options
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleset_options(keylogin = TRUE, managed_identity = TRUE,
  public = FALSE, priority = c("regular", "spot"),
  delete_on_evict = FALSE, network_accel = FALSE, large_scaleset = FALSE,
  overprovision = TRUE, upgrade_policy = list(mode = "manual"),
  os_disk_type = c("Premium_LRS", "StandardSSD_LRS", "Standard_LRS"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaleset_options_+3A_keylogin">keylogin</code></td>
<td>
<p>Whether to use an SSH public key to login (TRUE) or a password (FALSE). Note that Windows does not support SSH key logins.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_managed_identity">managed_identity</code></td>
<td>
<p>Whether to provide a managed system identity for the VM.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_public">public</code></td>
<td>
<p>Whether the instances (nodes) of the scaleset should be visible from the public internet.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_priority">priority</code></td>
<td>
<p>The priority of the VM scaleset, either <code>regular</code> or <code>spot</code>. Spot VMs are considerably cheaper but subject to eviction if other, higher-priority workloads require compute resources.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_delete_on_evict">delete_on_evict</code></td>
<td>
<p>If spot-priority VMs are being used, whether evicting (shutting down) a VM should delete it, as opposed to just deallocating it.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_network_accel">network_accel</code></td>
<td>
<p>Whether to enable accelerated networking. This option is only available for certain VM sizes.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_large_scaleset">large_scaleset</code></td>
<td>
<p>Whether to enable scaleset sizes &gt; 100 instances.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_overprovision">overprovision</code></td>
<td>
<p>Whether to overprovision the scaleset on creation.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_upgrade_policy">upgrade_policy</code></td>
<td>
<p>A list, giving the VM upgrade policy for the scaleset.</p>
</td></tr>
<tr><td><code id="scaleset_options_+3A_os_disk_type">os_disk_type</code></td>
<td>
<p>The type of primary disk for the VM. Change this to &quot;StandardSSD_LRS&quot; or &quot;Standard_LRS&quot; if the VM size doesn't support premium storage.</p>
</td></tr>
</table>

<hr>
<h2 id='user_config'>Resource configuration functions for a virtual machine deployment</h2><span id='topic+user_config'></span><span id='topic+datadisk_config'></span><span id='topic+image_config'></span>

<h3>Description</h3>

<p>Resource configuration functions for a virtual machine deployment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>user_config(username, sshkey = NULL, password = NULL)

datadisk_config(size, name = "datadisk", create = "empty",
  type = c("StandardSSD_LRS", "Premium_LRS", "Standard_LRS", "UltraSSD_LRS"),
  write_accelerator = FALSE)

image_config(publisher = NULL, offer = NULL, sku = NULL,
  version = "latest", id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="user_config_+3A_username">username</code></td>
<td>
<p>For <code>user_config</code>, the name for the admin user account.</p>
</td></tr>
<tr><td><code id="user_config_+3A_sshkey">sshkey</code></td>
<td>
<p>For <code>user_config</code>, the SSH public key. This can be supplied in a number of ways: as a string with the key itself; the name of the public key file; or an <code>AzureRMR::az_resource</code> object pointing to an SSH public key resource (of type &quot;Microsoft.Compute/sshPublicKeys&quot;). See the examples below.</p>
</td></tr>
<tr><td><code id="user_config_+3A_password">password</code></td>
<td>
<p>For <code>user_config</code>, the admin password. Supply either <code>sshkey</code> or <code>password</code>, but not both; also, note that Windows does not support SSH logins.</p>
</td></tr>
<tr><td><code id="user_config_+3A_size">size</code></td>
<td>
<p>For <code>datadisk_config</code>, the size of the data disk in GB. St this to NULL for a disk that will be created from an image.</p>
</td></tr>
<tr><td><code id="user_config_+3A_name">name</code></td>
<td>
<p>For <code>datadisk_config</code>, the disk name. Duplicate names will automatically be disambiguated prior to VM deployment.</p>
</td></tr>
<tr><td><code id="user_config_+3A_create">create</code></td>
<td>
<p>For <code>datadisk_config</code>, the creation method. Can be &quot;empty&quot; (the default) to create a blank disk, or &quot;fromImage&quot; to use an image.</p>
</td></tr>
<tr><td><code id="user_config_+3A_type">type</code></td>
<td>
<p>For <code>datadisk_config</code>, the disk type (SKU). Can be &quot;Standard_LRS&quot;, &quot;StandardSSD_LRS&quot; (the default), &quot;Premium_LRS&quot; or &quot;UltraSSD_LRS&quot;. Of these, &quot;Standard_LRS&quot; uses hard disks and the others use SSDs as the underlying hardware.</p>
</td></tr>
<tr><td><code id="user_config_+3A_write_accelerator">write_accelerator</code></td>
<td>
<p>For <code>datadisk_config</code>, whether the disk should have write acceleration enabled.</p>
</td></tr>
<tr><td><code id="user_config_+3A_publisher">publisher</code>, <code id="user_config_+3A_offer">offer</code>, <code id="user_config_+3A_sku">sku</code>, <code id="user_config_+3A_version">version</code></td>
<td>
<p>For <code>image_config</code>, the details for a marketplace image.</p>
</td></tr>
<tr><td><code id="user_config_+3A_id">id</code></td>
<td>
<p>For <code>image_config</code>, the resource ID for a disk to use as a custom image.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## user_config: SSH public key resource in Azure
# create the resource
keyres &lt;- rg$create_resource(type="Microsoft.Compute/sshPublicKeys", name="mysshkey")

# generate the public and private keys
keys &lt;- keyres$do_operation("generateKeyPair", http_verb="POST")
keyres$sync_fields()

# save the private key (IMPORTANT)
writeBin(keys$privateKey, "mysshkey.pem")

# create a new VM using the public key resource for authentication
# you can then login to the VM with ssh -i mysshkey.pem &lt;username@vmaddress&gt;
rg$create_vm("myvm", user_config("username", sshkey=keyres), config="ubuntu_20.04")


## user_config: SSH public key as a file
rg$create_vm("myvm", user_config("username", sshkey="mysshkey.pub"), config="ubuntu_20.04")


## user_config: SSH public key as a string (read from a file)
pubkey &lt;- readLines("mysshkey.pub")
rg$create_vm("myvm", user_config("username", sshkey=pubkey), config="ubuntu_20.04")


## End(Not run)

</code></pre>

<hr>
<h2 id='vnet_config'>Virtual network configuration</h2><span id='topic+vnet_config'></span><span id='topic+subnet_config'></span>

<h3>Description</h3>

<p>Virtual network configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vnet_config(address_space = "10.0.0.0/16", subnets = list(subnet_config()),
  ...)

subnet_config(name = "subnet", addresses = "10.0.0.0/16",
  nsg = "[variables('nsgId')]", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vnet_config_+3A_address_space">address_space</code></td>
<td>
<p>For <code>vnet_config</code>, the address range accessible by the virtual network, expressed in CIDR block format.</p>
</td></tr>
<tr><td><code id="vnet_config_+3A_subnets">subnets</code></td>
<td>
<p>For <code>vnet_config</code>, a list of subnet objects, each obtained via a call to <code>subnet_config</code>.</p>
</td></tr>
<tr><td><code id="vnet_config_+3A_...">...</code></td>
<td>
<p>Other named arguments that will be treated as resource properties.</p>
</td></tr>
<tr><td><code id="vnet_config_+3A_name">name</code></td>
<td>
<p>For <code>subnet_config</code>, the name of the subnet. Duplicate names will automatically be disambiguated prior to VM deployment.</p>
</td></tr>
<tr><td><code id="vnet_config_+3A_addresses">addresses</code></td>
<td>
<p>For <code>subnet_config</code>, the address ranges spanned by this subnet. Must be a subset of the address space available to the parent virtual network.</p>
</td></tr>
<tr><td><code id="vnet_config_+3A_nsg">nsg</code></td>
<td>
<p>The network security group associated with this subnet. Defaults to the NSG created as part of this VM deployment.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+create_vm">create_vm</a>, <a href="#topic+vm_config">vm_config</a>, <a href="#topic+vmss_config">vmss_config</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vnet_config()
vnet_config(address_space="10.1.0.0/16")
vnet_config(subnets=list(
    subnet_config("subnet", "10.0.0.0/24")
))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
