<!DOCTYPE html><html><head><title>Help for package timeROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {timeROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compare'>
<p>Compute tests for comparing two time-dependent AUC</p></a></li>
<li><a href='#confint'>
<p>Confidence intervals for areas under time-dependent ROC curves</p></a></li>
<li><a href='#Melano'>
<p>Malignant melanoma data</p></a></li>
<li><a href='#Paquid'>
<p>Paquid cohort data</p></a></li>
<li><a href='#plot'>
<p>Plot function for time-dependent ROC curve</p></a></li>
<li><a href='#plotAUCcurve'>
<p>Plot time-dependent AUC curve</p></a></li>
<li><a href='#plotAUCcurveDiff'>
<p>Plot the curve of the difference of two time-dependent AUCs over time</p></a></li>
<li><a href='#print'><p>Print objects in the timeROC library</p></a></li>
<li><a href='#SeSpPPVNPV'>
<p>Time-dependent Sensitivity (Se), Specificity (Sp), Positive Predictive</p>
Value (PPV) and Negative Predictive Value (NPV) estimation</a></li>
<li><a href='#timeROC'>
<p>Time-dependent ROC curve estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time-Dependent ROC Curve and AUC for Censored Survival Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Blanche</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Blanche &lt;paulfblanche@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of time-dependent ROC curve and area under time dependent ROC curve (AUC) in the presence of censored data, with or without competing risks. Confidence intervals of AUCs and tests for comparing AUCs of two rival markers measured on the same subjects can be computed, using the iid-representation of the AUC estimator. Plot functions for time-dependent ROC curves and AUC curves are provided. Time-dependent Positive Predictive Values (PPV) and Negative Predictive Values (NPV) can also be computed. See Blanche et al. (2013) &lt;<a href="https://doi.org/10.1002%2Fsim.5958">doi:10.1002/sim.5958</a>&gt; and references therein for the details of the methods implemented in the package.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.9.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>pec (&ge; 2.4.4), mvtnorm (&ge; 1.0-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>survival, timereg</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-18 14:35:44 UTC; paul</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-18 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compare'>
Compute tests for comparing two time-dependent AUC
</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>This function computes the p-value for testing the null hypothesis that asserts that two time-dependent AUCs of two markers are equal. 
The two markers must have been measured on the same subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(x, y, adjusted = FALSE, abseps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_x">x</code></td>
<td>

<p>An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;. The object <code>x</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <br />
<code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_y">y</code></td>
<td>

<p>An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;. The object <code>y</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <br />
<code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_adjusted">adjusted</code></td>
<td>

<p>A logical value that indicates if we also want to compute adjusted p-values, for accounting for the mutiplicity of tests (as many tests as there are time points for which we have estimated the AUCs of the two markers). 
</p>
</td></tr>
<tr><td><code id="compare_+3A_abseps">abseps</code></td>
<td>

<p>relative error tolerance as double. This optional technical argument is the argument of function <code><a href="mvtnorm.html#topic+GenzBretz">GenzBretz</a></code> that is used when <code>adjusted = TRUE</code>. Default is <code>1e-06</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each time points, the function computes the difference between estimated AUCs of both markers, the variance of the difference using the iid-representation of the AUC estimators, and return the p-value of the comparison test. For each time point &quot;t&quot;, the null hypothesis that is tested is : &quot;AUC of both markers are equal at time &quot;t&quot; &quot;.
When option <code>adjusted = TRUE</code> is chosen, then the function also computes the adjusted p-values, to account for the fact that we compute as many p-values as there as time points. The computation is based on the fact that (i) the vector of the differences of AUCs are asymptotically normally distributed, and  that (ii)  the variance-covariance matrix can be consistently estimated using the iid-representations of the AUC estimators at all time points.
</p>


<h3>Value</h3>

<p>The function <code>compare</code> returns a list. The list contains p-values of the comparison tests computed at all time points. If <code>adjusted = TRUE</code>, then it also contains the correlation matrix of the test statistics, that was used to compute adjusted p-values, to account for multiple testing.
</p>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Chiang CT, Hung H.(2010). Non-parametric estimation for time-dependent AUC. Journal of Statistical Planning and Inference, 140:1162-1174.
</p>
<p>Bretz, F., Hothorn, T., and Westfall, P. (2010). Multiple comparisons using R. Chapman \&amp; Hall/CRC.
</p>
<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeROC">timeROC</a></code>, <code><a href="#topic+confint.ipcwsurvivalROC">confint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored

# we evaluate bilirubin as a prognostic biomarker. 
ROC.bili&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=pbc$bili,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)),
                  iid=TRUE)

# we evaluate albumin as a prognostic biomarker.
ROC.albumin&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=-pbc$albumin,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)),
                  iid=TRUE)

# we compare albumin and bilirubin as prognostic biomarkers.
ROC.albumin #print results for albumin
ROC.bili    #print results for bilirubin
compare(ROC.albumin,ROC.bili) #compute p-values of comparison tests
compare(ROC.albumin,ROC.bili,adjusted=TRUE)

##-------------With competing risks-------------------

data(Melano)
head(Melano)

# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$thick,cause=1,
                   times=quantile(Melano$time,probs=seq(0.2,0.8,0.2)),
                   iid=TRUE)

# Evaluate age at operation as a prognostic tool for
# death from malignant melanoma.
ROC.age&lt;-timeROC(T=Melano$time,delta=Melano$status,
                 marker=Melano$age,cause=1,
                 times=quantile(Melano$time,probs=seq(0.2,0.8,0.2)),
                 ROC=TRUE,iid=TRUE)

# compare the predictive abilities of tumor thickness and 
# age at operation for death from malignant melanoma.
ROC.thick
ROC.age
compare(ROC.age,ROC.thick,adjusted=TRUE)



## Not run: 
	data(Paquid)
	head(Paquid)

	# Computation requires approximately   1 minute 
	# (because n=2561 subjects, iid=TRUE, and times=c(3,5,10))
	# evaluate DDST cognitive score as a prognostic tool for
	# dementia onset, accounting for death without dementia competing risk.
	ROC.DSST&lt;-timeROC(T=Paquid$time,delta=Paquid$status,
    		              marker=-Paquid$DSST,cause=1,
        		          times=c(3,5,10),ROC=TRUE,iid=TRUE)
	ROC.DSST

	# Computation requires approximately   1 minute 
	# (because n=2561 subjects, iid=TRUE, and times=c(3,5,10))
	# evaluate MMSE cognitive score as a prognostic tool for
	# dementia onset, accounting for death without dementia competing risk.
	ROC.MMSE&lt;-timeROC(T=Paquid$time,delta=Paquid$status,
    		              marker=-Paquid$MMSE,cause=1,
        		          times=c(3,5,10),ROC=TRUE,iid=TRUE)
	
	# we compare MMSE and DSST cognitive tests as prognostic tools
	# for dementia, accounting for death without dementia competing risk.
	ROC.DSST
	ROC.MMSE
	compare(ROC.DSST,ROC.MMSE,adjusted=TRUE)

## End(Not run)



</code></pre>

<hr>
<h2 id='confint'>
Confidence intervals for areas under time-dependent ROC curves
</h2><span id='topic+confint.ipcwsurvivalROC'></span><span id='topic+confint.ipcwcompetingrisksROC'></span>

<h3>Description</h3>

<p>This function computes pointwise confidence interval and simultaneous
confidence bands for areas under time-dependent ROC curves
(time-dependent AUC). Pointwise confidence intervals and simultaneous
confidence bands are computed from the asymptotic normality of
time-dependent AUC estimators. Standard errors are estimated from the iid-representation of the
estimator. The method is at present only implemented for inverse
probability of censoring weights computed from a Kaplan-Meier estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipcwsurvivalROC'
confint(object, parm=NULL, level = 0.95,n.sim=2000, ...)
## S3 method for class 'ipcwcompetingrisksROC'
confint(object, parm=NULL, level = 0.95,n.sim=2000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_+3A_object">object</code></td>
<td>
<p> An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;. The object <code>object</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="confint_+3A_parm">parm</code></td>
<td>
<p> Dummy argument. (Not used).
</p>
</td></tr>
<tr><td><code id="confint_+3A_level">level</code></td>
<td>
<p> The confidence level required. Default is <code>0.95</code>. 
</p>
</td></tr>
<tr><td><code id="confint_+3A_n.sim">n.sim</code></td>
<td>
<p> The number of simulations for computing simultaneous
confidence bands.
</p>
</td></tr>
<tr><td><code id="confint_+3A_...">...</code></td>
<td>
<p> Dummy argument. (Not used).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time-dependent AUC estimators are asymptotically normally distributed. Then, confidence intervals are computed using an estimate of the variance and the quantiles of the standard normal distribution.
To compute the variance estimates, the function computes  the empirical
variance estimates of the estimated iid-representations of the
time-dependent AUC estimators.
A simulation technique is used for computing appropriate quantiles of
simultaneous confidence bands.
</p>


<h3>Value</h3>

<p><b>Without competing risks,</b> a list containing :
</p>

<ul>
<li> <p><code>CI_AUC</code> : a matrix.   Columns correspond to the lower
and the upper bounds of the pointwise confidence intervals of AUC. Rows
correspond to the  time points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>CB_AUC</code> : a matrix.   Columns correspond to the lower
and the upper bounds of the simultaneous confidence band of the AUC curve. Rows
correspond to the  time points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>C.alpha</code> : a numeric value corresponding to the quantile
required for simultaneous confidence band computation (estimated by
simulations).
</p>
</li></ul>

<p><b>With competing risks,</b> a list containing :
</p>

<ul>
<li> <p><code>CI_AUC_1</code> : a matrix.   Columns correspond to the lower
and the upper bounds of the pointwise confidence intervals of AUC
with definition <b>(i)</b> of controls. Rows correspond to the  time
points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>CB_AUC_1</code> : a matrix.   Columns correspond to the lower
and the upper bounds of  the simultaneous confidence band of the AUC curve
with definition <b>(i)</b> of controls. Rows correspond to the  time
points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>C.alpha.1</code> : a numeric value corresponding to the quantile
required for simultaneous confidence bands computation <code>CB_AUC_1</code> (estimated by
simulations).
</p>
</li></ul>


<ul>
<li> <p><code>CI_AUC_2</code> : a matrix.   Columns correspond to the lower
and the upper bounds of the pointwise confidence intervals of AUC
with definition <b>(ii)</b> of controls. Rows correspond to the  time
points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>CB_AUC_2</code> : a matrix.   Columns correspond to the lower
and the upper bounds of the simultaneous confidence band  of the AUC curve
with definition <b>(ii)</b> of controls. Rows correspond to the  time
points for which time-dependent AUC estimator was computed.
</p>
</li>
<li> <p><code>C.alpha.2</code> : a numeric value corresponding to the quantile
required for simultaneous confidence band computation <code>CB_AUC_2</code> (estimated by
simulations).
</p>
</li></ul>

<p>For AUC definitions <b>(i)</b> and <b>(ii)</b>, see details about <code><a href="#topic+timeROC">timeROC</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Hung, H. and Chiang, C. (2010). Estimation methods for time-dependent AUC with survival data.
Canadian Journal of Statistics, 38(1):8-26
</p>
<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeROC">timeROC</a></code>, <code><a href="#topic+compare">compare</a></code>, <code><a href="#topic+plotAUCcurve">plotAUCcurve</a></code>, <code><a href="#topic+plotAUCcurveDiff">plotAUCcurveDiff</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored

# we evaluate bilirubin as a prognostic biomarker for death.
ROC.bili&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=pbc$bili,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)),
                  iid=TRUE)
ROC.bili
confint(ROC.bili)


##-------------With competing risks-------------------

data(Melano)
head(Melano)

# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$thick,cause=1,
                   times=quantile(Melano$time,probs=seq(0.2,0.8,0.2)),
                   iid=TRUE)
ROC.thick
confint(ROC.thick)

## Not run: 
	data(Paquid)
	head(Paquid)
	
	# Computation requires approximately 30 seconds 
	# (because iid=TRUE and n=2561 subjects)	
	# evaluate DDST cognitive score as a prognostic tool for
	# dementia onset, accounting for death without dementia competing risk.	
	ROC.DSST&lt;-timeROC(T=Paquid$time,
                      delta=Paquid$status,marker=-Paquid$DSST,
                      cause=1,weighting="marginal",times=c(3,5),
                      ROC=TRUE,iid=TRUE)
	ROC.DSST
	confint(ROC.DSST)

## End(Not run) 
</code></pre>

<hr>
<h2 id='Melano'>
Malignant melanoma data
</h2><span id='topic+Melano'></span>

<h3>Description</h3>

<p>In the period 1962-77, 205 patients with malignant melanoma (skin cancer) had a radical operation performed at Odense University
Hospital, Denmark. All patients were followed until the end of 1977 by 
which time 134 were still alive while 71 had died (of out whom 57 had
died from cancer and 14 from other causes).
</p>
<p>The object of the study was to assess the effect of risk factors on
survival. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Melano)</code></pre>


<h3>Format</h3>

<p>A data frame with 205 observations on the following 4 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p> : time in days from operation.</p>
</dd>
<dt><code>status</code></dt><dd><p> : the status indicator :  <code>0</code> = censored, <code>1</code> = death from malignant melanoma and <code>2</code> = death from other causes. </p>
</dd>
<dt><code>thick</code></dt><dd><p> : tumour thickness (in 1/100 mm).</p>
</dd>
<dt><code>age</code></dt><dd><p> : age at operation (years).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://192.38.117.59/~linearpredictors/?page=datasets&amp;dataset=Melano">http://192.38.117.59/~linearpredictors/?page=datasets&amp;dataset=Melano</a>
</p>


<h3>References</h3>

<p>Regression with linear predictors (2010)
</p>
<p>Andersen, P.K. and Skovgaard, L.T.
</p>
<p>Springer Verlag
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Melano)
head(Melano)
</code></pre>

<hr>
<h2 id='Paquid'>
Paquid cohort data 
</h2><span id='topic+Paquid'></span>

<h3>Description</h3>

<p>PAQUID is a prospective cohort study initiated in 1988 in South Western
France to explore functional and cerebral ageing. This sample includes
n=2561 subjects. Data contains a time-to-event (minimum between time
from enrolment to dementia onset and time from enrolment to death
without dementia), a status indicator, and two cognitive scores measured
at baseline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Paquid)</code></pre>


<h3>Format</h3>

<p>A data frame with 2561 observations on the following 4 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p> : the time-to-event (in years). It is defined as the minimum between time from enrolment to dementia onset and time from enrolment to death without dementia.</p>
</dd>
<dt><code>status</code></dt><dd><p> : the status indicator : <code>0</code> = censored, <code>1</code> = dementia onset and <code>2</code> = death without dementia.</p>
</dd>
<dt><code>DSST</code></dt><dd><p> : score at the Digit Symbol Substitution Score Test measured at baseline. This test explores attention and psychomotor speed.</p>
</dd>
<dt><code>MMSE</code></dt><dd><p> : score at the Mini Mental State Examination measured at baseline. This test is often used as an index of global cognitive performance.</p>
</dd>
</dl>



<h3>References</h3>

	
<p>Dartigues, J., Gagnon, M., Barberger-Gateau, P., Letenneur, L., Commenges, D.,
Sauvel, C., Michel, P., and Salamon, R. (1992).
The paquid epidemiological program on brain ageing.
Neuroepidemiology, 11(1):14&ndash;18.
</p>
<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Paquid)
head(Paquid)
</code></pre>

<hr>
<h2 id='plot'>
Plot function for time-dependent ROC curve
</h2><span id='topic+plot.ipcwsurvivalROC'></span><span id='topic+plot.ipcwcompetingrisksROC'></span>

<h3>Description</h3>

<p>This function plots time-dependent ROC curve estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipcwsurvivalROC'
plot(x, time, col = "red", add = FALSE, title = TRUE, ...)
## S3 method for class 'ipcwcompetingrisksROC'
plot(x, FP = 2, time, col = "red", add = FALSE, title = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>

<p>An object of class &quot;ipcwcompetingrisksROC&quot;. The object <code>x</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with argument <code>ROC = TRUE</code> (default argument).
</p>
</td></tr>
<tr><td><code id="plot_+3A_fp">FP</code></td>
<td>

<p>A numeric value that indicates which definition of controls the ROC
curve is plotted in the competing risks setting. <code>1</code> for definition
<b>(i)</b> and <code>2</code>  for definition <b>(ii)</b>. See details of
<code><a href="#topic+timeROC">timeROC</a></code> function for definitions <b>(i)</b> and
<b>(ii)</b>.
Default is <code>FP = 2</code> and this argument is ignored when there is no
competing risks.
</p>
</td></tr>
<tr><td><code id="plot_+3A_time">time</code></td>
<td>

<p>A numeric value that indicates the time point at which the ROC curve is plotted.
</p>
</td></tr>
<tr><td><code id="plot_+3A_col">col</code></td>
<td>

<p>The color to plot the ROC curve. Default is <code>col = "red"</code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_add">add</code></td>
<td>

<p>A logical value that indicates if  you only want to  add the ROC curve estimate to a pre-existing plot. Default is <code>add = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_title">title</code></td>
<td>

<p>A logical value that indicates if  you  want to  add a generic title, that indicates the chosen time point and the AUC estimate. Default is <code>title = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to plot method. (See <code><a href="graphics.html#topic+plot">plot</a></code>).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeROC">timeROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks----------------
library(survival)
data(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored

# we evaluate bilirubin as a prognostic biomarker
#(weights computed using an additive Aalen model 
# with covariates bili, chol and albumin). 
library(timereg)
ROC.bili.aalen&lt;-timeROC(T=pbc$time,
                      delta=pbc$status,marker=pbc$bili,
                      other_markers=as.matrix(pbc[,c("chol","albumin")]),
                      cause=1,weighting="aalen",
                      times=c(1800,2000,2200))
#print estimates
ROC.bili.aalen
#plot the ROC curve  at time t=2000
plot(ROC.bili.aalen,time=2000)

# we evaluate albumin and  cholesterol as a prognostic biomarker.
#(weights computed using an additive Aalen model
# with covariates bili, chol and albumin).
ROC.albu.aalen&lt;-timeROC(T=pbc$time,
                        delta=pbc$status,marker=-pbc$albumin,
                        other_markers=as.matrix(pbc[,c("chol","bili")]),
                        cause=1,weighting="aalen",
                        times=c(1800,2000,2200))

ROC.chol.aalen&lt;-timeROC(T=pbc$time,
                        delta=pbc$status,marker=pbc$chol,
                        other_markers=as.matrix(pbc[,c("bili","albumin")]),
                        cause=1,weighting="aalen",
                        times=c(1800,2000,2200))
# print estimates
ROC.albu.aalen
ROC.chol.aalen

# plot all ROC curves at time t=2000
plot(ROC.bili.aalen,time=2000,lwd=2,title=FALSE)
plot(ROC.albu.aalen,time=2000,col="blue",add=TRUE,lwd=2,lty=2)
plot(ROC.chol.aalen,time=2000,col="black",add=TRUE,lwd=2,lty=3)
# add legend
legend("bottomright",c("bilirubin","albumin","cholesterol"),
       col=c("red","blue","black"),lty=1:3)



##-------------With competing risks-------------------

#---------Example with Melano data------------- 
data(Melano)

# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   weighting="aalen",
                   marker=Melano$thick,cause=1,
                   times=c(1800,2000,2200))
plot(ROC.thick,time=1800)

#---------Example with Paquid data------------- 
data(Paquid)

# evaluate DDST cognitive score as a prognostic tool for
# dementia onset, accounting for death without dementia competing risk.
ROC.DSST&lt;-timeROC(T=Paquid$time,delta=Paquid$status,
                  marker=-Paquid$DSST,cause=1,
                  weighting="cox",
                  other_markers=as.matrix(Paquid$MMSE),
                  times=c(3,5,10),ROC=TRUE)

# we compare MMSE and DSST cognitive tests as prognostic tools
# for dementia, accounting for death without dementia competing risk.
ROC.MMSE&lt;-timeROC(T=Paquid$time,delta=Paquid$status,
                  marker=-Paquid$MMSE,cause=1,
                  weighting="cox",
                  other_markers=as.matrix(Paquid$DSST),
                  times=c(3,5,10),ROC=TRUE)

plot(ROC.DSST,time=5,title=FALSE,lwd=2)
plot(ROC.MMSE,time=5,col="blue",add=TRUE,title=FALSE,lwd=2)
legend("right",c("DSST","MMSE"),col=c("red","blue"),lwd=2)
</code></pre>

<hr>
<h2 id='plotAUCcurve'>
Plot time-dependent AUC curve
</h2><span id='topic+plotAUCcurve'></span>

<h3>Description</h3>

<p>This function plots the curve of time-dependent-AUC: AUC(t) versus t.
Pointwise and simultaneous confidence bands for this curve can also be plotted
when inverse probability of censoring weights are computed from a Kaplan-Meier estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAUCcurve(object, FP = 2, add = FALSE, conf.int = FALSE,
             conf.band = FALSE, col = "black")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAUCcurve_+3A_object">object</code></td>
<td>

<p>An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;
previously estimated from the <code><a href="#topic+timeROC">timeROC</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotAUCcurve_+3A_fp">FP</code></td>
<td>

<p>In the competing risks setting, a numeric value that indicates which
definition of AUC is plotted. <code>1</code> for definition <b>(i)</b> and
<code>2</code>  for definition <b>(ii)</b>. 
(See details of <code><a href="#topic+timeROC">timeROC</a></code> function for definitions <b>(i)</b> and <b>(ii)</b>). Default is <code>FP = 2</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurve_+3A_add">add</code></td>
<td>

<p>A logical value that indicates if  you want to  add the AUC curve to a pre-existing plot. Default is <code>add = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurve_+3A_conf.int">conf.int</code></td>
<td>

<p>A logical value that indicates whether or not you want to plot the bands
of pointwise confidence intervals. Default is  <code>conf.int = FALSE</code>.
For choosing <code>conf.int = TRUE</code>, the object <code>object</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurve_+3A_conf.band">conf.band</code></td>
<td>

<p>A logical value that indicates whether or not you want to plot the simultaneous confidence bands. Default is  <code>conf.band = FALSE</code>.
For choosing <code>conf.band = TRUE</code>, the object <code>object</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurve_+3A_col">col</code></td>
<td>

<p>The color to plot the AUC curve. Default is <code>col = "black"</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>
<p>Hung, H. and Chiang, C. (2010). Estimation methods for time-dependent AUC with survival data.
Canadian Journal of Statistics, 38(1):8-26
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+confint.ipcwsurvivalROC">confint</a></code> for confidence intervals and confidence bands computation of time-dependentAUC.
</p>
</li>
<li> <p><code><a href="#topic+plotAUCcurveDiff">plotAUCcurveDiff</a></code> for plotting  the curve of the
difference of two time-dependent AUCs over time 
with eventually confidence intervals and
simultaneous confidence bands.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## computation times is roughly 10 seconds

##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored     
# we evaluate bilirubin as a prognostic biomarker for death.
ROC.bili&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=pbc$bili,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.02)),
                  iid=TRUE)
ROC.bili    
# we evaluate bilirubin as a prognostic biomarker for death.
ROC.albumin&lt;-timeROC(T=pbc$time,
                     delta=pbc$status,marker=-pbc$albumin,
                     cause=1,weighting="marginal",
                     times=quantile(pbc$time,probs=seq(0.2,0.8,0.02)),
                     iid=TRUE)
ROC.albumin
# plot AUC curve for albumin only with pointwise confidence intervals
# and simultaneous confidence bands
plotAUCcurve(ROC.albumin,conf.int=TRUE,conf.band=TRUE)
# plot AUC curve for albumin and bilirunbin  with pointwise confidence intervals
plotAUCcurve(ROC.albumin,conf.int=TRUE,col="red")
plotAUCcurve(ROC.bili,conf.int=TRUE,col="blue",add=TRUE)
legend("bottomright",c("albumin","bilirunbin"),col=c("red","blue"),lty=1,lwd=2)


##-------------With competing risks-------------------     
data(Melano)
head(Melano)     
# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$thick,cause=1,
                   times=quantile(Melano$time,probs=seq(0.2,0.8,0.01)),
                   iid=TRUE)
ROC.thick
# plot AUC curve for tumor thickness with pointwise confidence intervals
# and simultaneous confidence bands
plotAUCcurve(ROC.thick,FP=2,conf.int=TRUE,conf.band=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotAUCcurveDiff'>
Plot the curve of the difference of two time-dependent AUCs over time
</h2><span id='topic+plotAUCcurveDiff'></span>

<h3>Description</h3>

<p>This function plots the curve of the difference of two time-dependent
AUCs over time.  Pointwise and simultaneous confidence bands for this curve can also be plotted
when inverse probability of censoring weights are computed from a Kaplan-Meier estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAUCcurveDiff(object1, object2, FP = 2, add = FALSE, conf.int = FALSE,
                 conf.band = FALSE, col = "black", ylim = c(-0.5, 0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAUCcurveDiff_+3A_object1">object1</code></td>
<td>

<p>An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;
previously estimated from the <code><a href="#topic+timeROC">timeROC</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_object2">object2</code></td>
<td>

<p>An object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;
previously estimated from the <code><a href="#topic+timeROC">timeROC</a></code> function.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_fp">FP</code></td>
<td>

<p>In the competing risks setting, a numeric value that indicates which
definition of AUC is plotted. <code>1</code> for definition <b>(i)</b> and
<code>2</code>  for definition <b>(ii)</b>. 
(See details of <code><a href="#topic+timeROC">timeROC</a></code> function for definitions <b>(i)</b> and <b>(ii)</b>). Default is <code>FP = 2</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_add">add</code></td>
<td>

<p>A logical value that indicates if  you want to  add the AUC curve to a pre-existing plot. Default is <code>add = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_conf.int">conf.int</code></td>
<td>

<p>A logical value that indicates whether or not you want to plot the bands
of pointwise confidence intervals. Default is  <code>conf.int = FALSE</code>.
For choosing <code>conf.int = TRUE</code>, the objects <code>object1</code> and
<code>object2</code> must have been estimated by 
the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_conf.band">conf.band</code></td>
<td>

<p>A logical value that indicates whether or not you want to plot the simultaneous confidence bands. Default is  <code>conf.band = FALSE</code>.
For choosing <code>conf.band = TRUE</code>, the objects <code>object1</code> and
<code>object2</code> must have been estimated by the <code><a href="#topic+timeROC">timeROC</a></code> function with arguments <code>weighting="marginal"</code> and <code>iid = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_col">col</code></td>
<td>

<p>The color to plot the AUC curve. Default is <code>col = "black"</code>.
</p>
</td></tr>
<tr><td><code id="plotAUCcurveDiff_+3A_ylim">ylim</code></td>
<td>

<p>The range of the y-axis.  Default is <code>ylim = c(-0.5,0.5)</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simultaneous confidence bands can be of particular interest for testing
null hypotheses such as &quot;for all time t within an interval, AUC(t) for
both markers are equal&quot;, by observing whether or not the zero line is contained within the band.
</p>


<h3>Note</h3>

<p>The two markers evluated in objects <code>object1</code> and
<code>object2</code> must have been measured on the same subjects.
</p>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>
<p>Hung, H. and Chiang, C. (2010). Estimation methods for time-dependent AUC with survival data.
Canadian Journal of Statistics, 38(1):8-26
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+confint.ipcwsurvivalROC">confint</a></code> for confidence intervals  and confidence bands computation  of  time-dependentAUC.
</p>
</li>
<li> <p><code><a href="#topic+plotAUCcurve">plotAUCcurve</a></code> for plotting  the curve of time-dependent-AUC: AUC(t) versus t.  Confidence intervals and simultaneous confidence bands can also be plotted.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## computation times is roughly 10 seconds

##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored     
# we evaluate bilirubin as a prognostic biomarker for death.
ROC.bili&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=pbc$bili,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.02)),
                  iid=TRUE)
ROC.bili    
# we evaluate bilirubin as a prognostic biomarker for death.
ROC.albumin&lt;-timeROC(T=pbc$time,
                     delta=pbc$status,marker=-pbc$albumin,
                     cause=1,weighting="marginal",
                     times=quantile(pbc$time,probs=seq(0.2,0.8,0.02)),
                     iid=TRUE)
ROC.albumin
# plot AUC curve for albumin and bilirunbin  with pointwise confidence interval
plotAUCcurve(ROC.albumin,conf.int=TRUE,col="red")
plotAUCcurve(ROC.bili,conf.int=TRUE,col="blue",add=TRUE)
legend("bottomright",c("albumin","bilirunbin"),col=c("red","blue"),lty=1,lwd=2)
#plot the curve of the difference of the two time-dependent AUCs over time
plotAUCcurveDiff(ROC.bili,ROC.albumin,conf.int=TRUE,conf.band=TRUE,ylim=c(-0.2,0.5))

##-------------With competing risks-------------------     
data(Melano)
head(Melano)     
# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$thick,cause=1,
                   times=quantile(Melano$time,probs=seq(0.2,0.8,0.01)),
                   iid=TRUE)
ROC.thick
ROC.age&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$age,cause=1,
                   times=quantile(Melano$time,probs=seq(0.2,0.8,0.01)),
                   iid=TRUE)
ROC.age
# plot the two AUC curves on the same plot
plotAUCcurve(ROC.thick,FP=2,conf.int=TRUE,col="blue")
plotAUCcurve(ROC.age,FP=2,conf.int=TRUE,col="red",add=TRUE)
legend("bottomright",c("thickness","age"),col=c("blue","red"),lty=1,lwd=2)
# plot the curve of the difference of the two time-dependent AUCs over time
plotAUCcurveDiff(ROC.thick,ROC.age,FP=2,conf.int=TRUE,conf.band=TRUE,col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='print'>Print objects in the timeROC library</h2><span id='topic+print.ipcwsurvivalROC'></span><span id='topic+print.ipcwcompetingrisksROC'></span><span id='topic+print.ipcwcompetingrisksSeSpPPVNPV'></span><span id='topic+print.ipcwsurvivalSeSpPPVNPV'></span>

<h3>Description</h3>

<p>Printing of objects created with the timeROC function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ipcwsurvivalROC'
print(x, No.lines=5,digits=2, ...)
## S3 method for class 'ipcwcompetingrisksROC'
print(x, No.lines=5,digits=2, ...)
## S3 method for class 'ipcwsurvivalSeSpPPVNPV'
print(x, No.lines=5,digits=2, ...)
## S3 method for class 'ipcwcompetingrisksSeSpPPVNPV'
print(x, No.lines=5,digits=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>

<p>Object of class &quot;ipcwsurvivalROC&quot;, &quot;ipcwcompetingrisksROC&quot;,
&quot;ipcwsurvivalSeSpPPVNPV&quot; or &quot;ipcwcompetingrisksSeSpPPVNPV&quot;.
</p>
</td></tr>
<tr><td><code id="print_+3A_no.lines">No.lines</code></td>
<td>

<p>The (maximum) number of lines printed. Each line corresponds to a time point included in the vector <code>times</code> of the object <code>x</code>. 
For example, if <code>No.lines=5</code>, then the function chooses the five time points corresponding to the quantiles of the vector  <code>times</code> of the object <code>x</code>. If <code>No.lines=10</code>, it chooses the deciles, etc...
</p>
</td></tr>
<tr><td><code id="print_+3A_digits">digits</code></td>
<td>

<p>The number of significant digits. Default value is <code>digits = 2</code>.
</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The print function recalls the sample size (after having removed missing data), the AUC estimates, and  the estimated standard errors (only if they have been estimated) for at maximum <code>No.lines</code> time points. In addition, it displays the frequencies of :
</p>

<ul>
<li><p> observed cases: subjects for which we know they undergo the (main) event prior the time &quot;t&quot; of interest.
</p>
</li>
<li><p> survivors : event-free subjects at time &quot;t&quot; of interest.
</p>
</li>
<li><p> censored subjects : censored subjects prior the time &quot;t&quot; of interest, for which we cannot know if they undergo an event or not prior time &quot;t&quot; (and so for which we cannot know if they are cases or controls at time &quot;t&quot;).
</p>
</li>
<li><p> other events:  (in the competing risks setting only) subjects for which we know that they undergo an event different from the main event prior the time &quot;t&quot; of interest.
</p>
</li></ul>

<p>Furthermore, the function recalls the method used to compute the inverse probability of censoring weights.
</p>


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeROC">timeROC</a></code>, <code><a href="#topic+SeSpPPVNPV">SeSpPPVNPV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored

ROC.bili.cox&lt;-timeROC(T=pbc$time,
                      delta=pbc$status,marker=pbc$bili,
                      other_markers=as.matrix(pbc[,c("chol","albumin")]),
                      cause=1,weighting="cox",
                      times=quantile(pbc$time,probs=seq(0.2,0.8,0.01)))

# prints descriptive statistics and AUC estimates (5,10 and 20 lines)
print(ROC.bili.cox)
print(ROC.bili.cox,No.lines=10)
print(ROC.bili.cox,No.lines=20,digits=1)

# Se, Sp, PPV and NPV computation for serum bilirunbin at threshold c=0.9(mg/dl) 
res.SeSpPPVNPV.bili &lt;- SeSpPPVNPV(cutpoint=0.9,
                                  T=pbc$time,
                                  delta=pbc$status,marker=pbc$bili,
                                  other_markers=as.matrix(pbc[,c("chol","albumin")]),
                                  cause=1,weighting="cox",
                                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)))

# prints descriptive statistics and Se, Sp, PPV and NPV
#  estimates for serum bilirunbin at threshold c=0.9(mg/dl) 
print(res.SeSpPPVNPV.bili,No.lines=20,digits=1)

ROC.bili.marginal&lt;-timeROC(T=pbc$time,
                           delta=pbc$status,marker=pbc$bili,
                           cause=1,weighting="marginal",
                           times=quantile(pbc$time,probs=seq(0.1,0.9,0.2)),
                           iid=TRUE)

# prints descriptive statistics, AUC estimates and also standard errors
# of AUCs because weighting="marginal" and iid=TRUE were used.
print(ROC.bili.marginal)

##-------------With competing risks-------------------
data(Melano)
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   marker=Melano$thick,cause=1,
                   weighting="marginal",
                   times=c(1500,2000,2500),iid=TRUE)

# prints descriptive statistics, AUC estimates and also standard errors
# of AUCs because weighting="marginal" and iid=TRUE were used.
print(ROC.thick)


# Se, Sp, PPV and NPV computation for tumor thickness at
#threshold c=3 (1/100 mm)
res.SeSpPPVNPV.thick &lt;- SeSpPPVNPV(cutpoint=3,
                                  T=Melano$time,delta=Melano$status,
                                  weighting="marginal",
                                  marker=Melano$thick,cause=1,
                                  times=c(1800,2000,2200),
                                  iid=TRUE)
print(res.SeSpPPVNPV.thick,digits=1)
</code></pre>

<hr>
<h2 id='SeSpPPVNPV'>
Time-dependent Sensitivity (Se), Specificity (Sp), Positive Predictive
Value (PPV) and Negative Predictive Value (NPV) estimation
</h2><span id='topic+SeSpPPVNPV'></span>

<h3>Description</h3>

<p>This function aim at estimating time-dependent Sensitivity (Se),
Specificity (Sp), Positive Predictive Value (PPV) and Negative
Predictive Value (NPV) at a given cutpoint.
Standard error computation via iid-representation of the estimator is also implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SeSpPPVNPV(cutpoint, T, delta, marker, other_markers = NULL, cause,
           weighting = "marginal", times, iid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SeSpPPVNPV_+3A_cutpoint">cutpoint</code></td>
<td>

<p>The cutpoint for maker value at  which we aim at estimating Se, Sp, PPV and NPV.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_t">T</code></td>
<td>

<p>The vector of (censored) event-times.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_delta">delta</code></td>
<td>

<p>The vector of event indicators at the corresponding value of the vector
<code>T</code>. Censored observations must be denoted by the value <code>0</code>.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_marker">marker</code></td>
<td>

<p>The vector of the marker values for which we want to compute the time-dependent ROC curves. 
Without loss of generality, the function assumes that larger values of
the marker are associated with higher risks of events. If lower values of the marker are
associated with higher risks of events, then reverse the association
adding a minus to the marker values.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_other_markers">other_markers</code></td>
<td>

<p>A matrix that contains values of other markers that we want to take into
account for computing the inverse probability of censoring
weights. The different columns 
represent the different markers. This argument is optional, and
ignored if <code>method="marginal"</code>. Default value is <code>other_markers=NULL</code>.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_cause">cause</code></td>
<td>

<p>The value of the event indicator that represents the event of interest
for which we aim to compute the time-dependent ROC curve. Without
competing risks, it must be the value that indicates a non-censored
obsevation (usually <code>1</code>). With competing risks, subjects can
undergo different type of events; then, it must be the value
corresponding to the event of interest, for which we aim to compute the
ROC curve (usually <code>1</code> or <code>2</code>).
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_weighting">weighting</code></td>
<td>

<p>The method used to compute the weights. <code>weighting="marginal"</code> uses
the Kaplan-Meier estimator of the censoring distribution. <code>weighting="cox"</code> and
<code>weighting="aalen"</code> model the censoring by the Cox model and the
additive Aalen model respectively. Default value is <code>weighting="marginal"</code>.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_times">times</code></td>
<td>

<p>The vector of times points &quot;t&quot; at which we want to compute the
time-dependent ROC curve. If vector <code>times</code> contains only a single
value, then value zero is added.
</p>
</td></tr>
<tr><td><code id="SeSpPPVNPV_+3A_iid">iid</code></td>
<td>

<p>A logical value that indicates if we want to compute the
iid-representation of the area under time-dependent ROC curve
estimator. <code>iid = TRUE</code> is required for computation of all
inference procedures (Confidence intervals or test for comparing AUCs).
For large sample size (greater than 2000, say) and/or large length of
vector <code>times</code>, the computation of the iid representations might be
time-consuming. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes Inverse Probability of Censoring Weighting (IPCW)
estimates of Sensitivity (Se), Specificity (Sp), Positive Predictive
Value (PPV) and Negative Predictive Value (NPV) for Cumulative/Dynamic
definition of cases and controls.
</p>
<p>Let <code class="reqn">T_i</code> denote the event time of the subject <code class="reqn">i</code>.
</p>
<p><b>Without competing risks :</b>  A case is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i \leq t</code>. A control is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i &gt; t</code>.
</p>
<p><b>With competing risks :</b> In this setting, subjects may undergo different type of events, denoted by <code class="reqn">\delta_i</code> in the following. Let suppose that we are interested in the event <code class="reqn">\delta_i=1</code>. Then, a case is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i \leq t</code> and <code class="reqn">\delta_i=1</code>.
With competing risks, two definitions of controls were suggested: <b>(i)</b> a control is defined as a subject <code class="reqn">i</code> that is free of any event, i.e with   <code class="reqn">T_i &gt; t</code>, and <b>(ii)</b> a control is defined as a subject <code class="reqn">i</code> that is not a case, i.e with <code class="reqn">T_i &gt; t</code> or with <code class="reqn">T_i \leq t</code> and <code class="reqn">\delta_i \neq 1</code>.
For all outputs of this package, objects named with <code>_1</code> refer to definition <b>(i)</b>. For instance <code>AUC_1</code> or <code>se_1</code> refer to time-dependent area under the ROC curve and its estimated standard error according to the definition <b>(i)</b>. Objects named with <code>_2</code> refer to definition <b>(ii)</b> .
</p>


<h3>Value</h3>

<p>Object of class &quot;ipcwsurvivalSeSpPPVNPV&quot; or &quot;ipcwcompetingrisksSeSpPPVNPV&quot;, depending on if there is competing risk or not, that is a list. For these classes, there are print, plot and confint methods. Most objects that they contain are similar, but some are specific to each class.
</p>
<p><b>Specific objects of class &quot;ipcwsurvivalSeSpPPVNPV&quot; :</b>
</p>

<ul>
<li> <p><code>TP</code> : vector of time-dependent True Positive fraction
(sensitivity) estimates at each time points.
</p>
</li>
<li> <p><code>FP</code> : vector of time-dependent False Positive fraction
(1-specificity) estimates at each time points. 
</p>
</li>
<li> <p><code>PPV</code> : vector of time-dependent Positive Predictive Value
estimates at each time points. 
</p>
</li>
<li> <p><code>NPV</code> : vector of time-dependent Negative Predictive Value
estimates at each time points. 
</p>
</li></ul>

<p><b>Specific objects of class &quot;ipcwcompetingrisksSeSpPPVNPV&quot; :</b>
</p>

<ul>
<li> <p><code>TP</code> : vector of time-dependent True Positive fraction
(sensitivity) estimates at each time points.
</p>
</li>
<li> <p><code>FP_1</code> : vector of time-dependent False Positive fraction
(1-specificity) estimates at each time points with definition
<b>(i)</b> of controls (see Details).
</p>
</li>
<li> <p><code>FP_2</code> : vector of time-dependent False Positive fraction
(1-specificity) estimates at each time points with definition
<b>(ii)</b> of controls (see Details).  
</p>
</li>
<li> <p><code>PPV_1</code> : vector of time-dependent Positive Predictive Value
estimates at each time points with definition
<b>(i)</b> of controls (see Details).
</p>
</li>
<li> <p><code>NPV_2</code> : vector of time-dependent Negative Predictive Value
estimates at each time points with definition
<b>(ii)</b> of controls (see Details).
</p>
</li></ul>

<p><b>Objects common to  both classes :</b>
</p>
  
<ul>
<li> <p><code>times</code> : the time points for which Se, Sp,
PPV, etc.. were computed. 
</p>
</li>
<li> <p><code>cutpoint</code> : the cutpoint for which Se, Sp,
PPV, etc.. were computed. 
</p>
</li>
<li> <p><code>weights</code> : a object of class &quot;IPCW&quot;, containing all informations about the weights. See <code><a href="pec.html#topic+ipcw">ipcw</a></code> function of <code>pec</code> package.
</p>
</li>
<li> <p><code>computation_time</code> : the total computation time.  
</p>
</li>
<li> <p><code>Stats</code> : a matrix containing descriptive statistics at each time points (like numbers of observed cases or censored observations before each time points).
</p>
</li>
<li> <p><code>iid</code> : the logical value of parameter <code>iid</code> used in argument.
</p>
</li>
<li> <p><code>n</code> : the sample size, after having omitted missing vaues. 
</p>
</li>
<li> <p><code>inference</code> : a list that contains, among other things, iid-representations and estimated standard errors of the estimators.
</p>
</li>
<li> <p><code>computation_time</code> : the computation time, in seconds.
</p>
</li></ul>
    


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeROC">timeROC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored     
# Se, Sp, PPV and NPV computation for serum bilirunbin at threshold c=0.9(mg/dl) 
res.SeSpPPVNPV.bili &lt;- SeSpPPVNPV(cutpoint=0.9,
                                  T=pbc$time,
                                  delta=pbc$status,marker=pbc$bili,
                                  cause=1,weighting="marginal",
                                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)),
                                  iid=TRUE)
res.SeSpPPVNPV.bili

##-------------With competing risks-------------------

#---------Example with Paquid data--------
data(Paquid)
# Se, Sp, PPV and NPV computation for DSST at threshold c=22
res.SeSpPPVNPV.DSST &lt;- SeSpPPVNPV(cutpoint=22,
                                  T=Paquid$time,
                                  delta=Paquid$status,marker=Paquid$DSST,
                                  cause=1,weighting="cox",
                                  times=c(3,5,8,10))
res.SeSpPPVNPV.DSST

#---------Example with Melano data-------
data(Melano)
# Se, Sp, PPV and NPV computation for tumor thickness at threshold c=3 (1/100 mm)
res.SeSpPPVNPV.thick &lt;- SeSpPPVNPV(cutpoint=3,
                                  T=Melano$time,delta=Melano$status,
                                  weighting="marginal",
                                  marker=Melano$thick,cause=1,
                                  times=c(1800,2000,2200),
                                  iid=TRUE)
res.SeSpPPVNPV.thick
</code></pre>

<hr>
<h2 id='timeROC'>
Time-dependent ROC curve estimation
</h2><span id='topic+timeROC'></span>

<h3>Description</h3>

<p>Inverse Probability of Censoring Weighting (IPCW) estimation of Cumulative/Dynamic time-dependent ROC curve. The function works in the usual survival setting as well as in the competing risks setting. Computation of the iid-representation of areas under time-dependent ROC curves is implemented. This enables computation of inference procedures: Confidence intervals and tests for comparing two AUCs of two different markers measured on the same subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeROC(T, delta, marker, other_markers = NULL, cause,
	    weighting = "marginal", times, ROC = TRUE, iid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timeROC_+3A_t">T</code></td>
<td>

<p>The vector of (censored) event-times.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_delta">delta</code></td>
<td>

<p>The vector of event indicators at the corresponding value of the vector <code>T</code>. Censored observations must be denoted by the value <code>0</code>.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_marker">marker</code></td>
<td>

<p>The vector of the marker values for which we want to compute the time-dependent ROC curves. 
Without loss of generality, the function assumes that larger values of the marker are associated with higher risks of events. If lower values of the marker are associated with higher risks of events, then reverse the association adding a minus to the marker values.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_other_markers">other_markers</code></td>
<td>

<p>A matrix that contains values of other markers that we want to take into account for computing the inverse probability of censoring weights. The different columns represent the different markers. This argument is optional, and ignored if <code>method="marginal"</code>. Default value is <code>other_markers=NULL</code>.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_cause">cause</code></td>
<td>

<p>The value of the event indicator that represents the event of interest for which we aim to compute the time-dependent ROC curve. Without competing risks, it must be the value that indicates a non-censored obsevation (usually <code>1</code>). With competing risks, subjects can undergo different type of events; then, it must be the value corresponding to the event of interest, for which we aim to compute the ROC curve (usually <code>1</code> or <code>2</code>).
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_weighting">weighting</code></td>
<td>

<p>The method used to compute the weights. <code>weighting="marginal"</code> uses the Kaplan-Meier estimator of the censoring distribution. <code>weighting="cox"</code> and <code>weighting="aalen"</code> model the censoring by the Cox model and the additive Aalen model respectively. Default value is <code>weighting="marginal"</code>.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_times">times</code></td>
<td>

<p>The vector of times points &quot;t&quot; at which we want to compute the time-dependent ROC curve. If vector <code>times</code> contains only a single value, then value zero is added.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_roc">ROC</code></td>
<td>

<p>A logical value that indicates if we want to save the estimates of
sensitivities and specificties. Default value is <code>ROC = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="timeROC_+3A_iid">iid</code></td>
<td>

<p>A logical value that indicates if we want to compute the iid-representation of the area under time-dependent ROC curve estimator. <code>iid = TRUE</code> is required for computation of all inference procedures (Confidence intervals or test for comparing AUCs). For large sample size (greater than 2000, say) and/or large length of vector <code>times</code>, the computation of the iid representations might be time-consuming.  Default value is <code>iid = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes Inverse Probability of Censoring Weighting (IPCW) estimates of Cumulative/Dynamic time-dependent ROC curve. 
By definition, time-dependent ROC curve intrinsically depends on the definitions of time-dependent cases and controls.<br />
Let <code class="reqn">T_i</code> denote the event time of the subject <code class="reqn">i</code>.
</p>
<p><b>Without competing risks :</b>  A case is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i \leq t</code>. A control is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i &gt; t</code>.
</p>
<p><b>With competing risks :</b> In this setting, subjects may undergo different type of events, denoted by <code class="reqn">\delta_i</code> in the following. Let suppose that we are interested in the event <code class="reqn">\delta_i=1</code>. Then, a case is defined as a subject <code class="reqn">i</code> with <code class="reqn">T_i \leq t</code> and <code class="reqn">\delta_i=1</code>.
With competing risks, two definitions of controls were suggested: <b>(i)</b> a control is defined as a subject <code class="reqn">i</code> that is free of any event, i.e with   <code class="reqn">T_i &gt; t</code>, and <b>(ii)</b> a control is defined as a subject <code class="reqn">i</code> that is not a case, i.e with <code class="reqn">T_i &gt; t</code> or with <code class="reqn">T_i \leq t</code> and <code class="reqn">\delta_i \neq 1</code>.
For all outputs of this package, objects named with <code>_1</code> refer to definition <b>(i)</b>. For instance <code>AUC_1</code> or <code>se_1</code> refer to time-dependent area under the ROC curve and its estimated standard error according to the definition <b>(i)</b>. Objects named with <code>_2</code> refer to definition <b>(ii)</b> .
</p>


<h3>Value</h3>

<p>Object of class &quot;ipcwsurvivalROC&quot; or &quot;ipcwcompetingrisksROC&quot;, depending on if there is competing risk or not, that is a list. For these classes, there are print, plot and confint methods. Most objects that they contain are similar, but some are specific to each class.
</p>
<p><b>Specific objects of class &quot;ipcwsurvivalROC&quot; :</b>
</p>

<ul>
<li> <p><code>AUC</code> : vector of time-dependent AUC estimates at each time points.
</p>
</li>
<li> <p><code>TP</code> : matrix of time-dependent True Positive fraction (sensitivity) estimates. 
</p>
</li>
<li> <p><code>FP</code> : matrix of time-dependent False Positive fraction (1-specificity) estimates. 
</p>
</li></ul>

<p><b>Specific objects of class &quot;ipcwcompetingrisksROC&quot; :</b>
</p>

<ul>
<li> <p><code>AUC_1</code> : vector of time-dependent AUC estimates at each time points with definition <b>(i)</b> of controls (see Details). 
</p>
</li>
<li> <p><code>AUC_2</code> : vector of time-dependent AUC estimates at each time points with definition <b>(ii)</b>  of controls (see Details).  
</p>
</li>
<li> <p><code>TP</code> : matrix of time-dependent True Positive fraction (sensitivity) estimates. 
</p>
</li>
<li> <p><code>FP_1</code> : matrix of time-dependent False Positive fraction (1-specificity) estimates with definition <b>(i)</b> of controls (see Details). 
</p>
</li>
<li> <p><code>FP_2</code> : matrix of time-dependent False Positive fraction (1-specificity) estimates with definition <b>(ii)</b>  of controls (see Details). 
</p>
</li></ul>

<p><b>Objects common to  both classes :</b>
</p>
  
<ul>
<li> <p><code>times</code> : the time points for which the time-dependent ROC curves were computed. 
</p>
</li>
<li> <p><code>weights</code> : a object of class &quot;IPCW&quot;, containing all informations about the weights. See <code><a href="pec.html#topic+ipcw">ipcw</a></code> function of <code>pec</code> package.
</p>
</li>
<li> <p><code>computation_time</code> : the total computation time.  
</p>
</li>
<li> <p><code>CumulativeIncidence</code> : the vector of estimated probabilities of being a case at each time points.
</p>
</li>
<li> <p><code>survProb</code> : the vector of estimated probabilities of being event-free at each time points.
</p>
</li>
<li> <p><code>Stats</code> : a matrix containing descriptive statistics at each time points (like numbers of observed cases or censored observations before each time points).
</p>
</li>
<li> <p><code>iid</code> : the logical value of parameter <code>iid</code> used in argument.
</p>
</li>
<li> <p><code>n</code> : the sample size, after having omitted missing vaues. 
</p>
</li>
<li> <p><code>inference</code> : a list that contains, among other things, iid-representations and estimated standard errors of the estimators, and that is used for computation of comparison tests and confidence intervals.
</p>
</li>
<li> <p><code>computation_time</code> : the computation time, in seconds.
</p>
</li></ul>
    


<h3>Author(s)</h3>

<p>Paul Blanche <a href="mailto:pabl@sund.ku.dk">pabl@sund.ku.dk</a>
</p>


<h3>References</h3>

<p>Hung, H. and Chiang, C. (2010). Estimation methods for time-dependent AUC with survival data.
Canadian Journal of Statistics, 38(1):8-26
</p>
<p>Uno, H., Cai, T., Tian, L. and Wei, L. (2007). Evaluating prediction rules for t-years survivors with censored regression models.
Journal of the American Statistical Association, 102(478):527-537.
</p>
<p>Blanche, P., Dartigues, J. F., &amp; Jacqmin-Gadda,	H. (2013). Estimating and comparing time-dependent areas under
receiver operating characteristic curves for censored event times with competing risks. 
Statistics in medicine, 32(30), 5381-5397.
</p>
<p>P. Blanche, A. Latouche, V. Viallon (2013). Time-dependent AUC with right-censored data: A Survey.
Risk Assessment and Evaluation of Predictions, 239-251,
Springer, <a href="http://arxiv.org/abs/1210.6805">http://arxiv.org/abs/1210.6805</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+compare">compare</a></code> for testing a difference of time-dependent AUCs.
</p>
</li>
<li> <p><code><a href="#topic+confint.ipcwsurvivalROC">confint</a></code> for confidence intervals of  time-dependent AUC.
</p>
</li>
<li> <p><code><a href="#topic+SeSpPPVNPV">SeSpPPVNPV</a></code> for estimating Sensitivity (Se), Specificity (Sp), Positive Predictive
Value (PPV) and Negative Predictive Value (NPV) at a given cutpoint
marker value.
</p>
</li>
<li> <p><code><a href="#topic+plot.ipcwsurvivalROC">plot</a></code> for plotting  time-dependent ROC curves.
</p>
</li>
<li> <p><code><a href="#topic+plotAUCcurve">plotAUCcurve</a></code> for plotting time-dependent AUC curve.
</p>
</li>
<li> <p><code><a href="#topic+plotAUCcurveDiff">plotAUCcurveDiff</a></code> for  plotting the curve of the
difference of two time-dependent AUCs over time.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>##-------------Without competing risks-------------------
library(survival)
data(pbc)
head(pbc)
pbc&lt;-pbc[!is.na(pbc$trt),] # select only randomised subjects
pbc$status&lt;-as.numeric(pbc$status==2) # create event indicator: 1 for death, 0 for censored

# we evaluate bilirubin as a prognostic biomarker for death.

# 1) with the Kaplan-Meier estimator for computing the weights (default).
ROC.bili.marginal&lt;-timeROC(T=pbc$time,
                  delta=pbc$status,marker=pbc$bili,
                  cause=1,weighting="marginal",
                  times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)),
                  iid=TRUE)
ROC.bili.marginal

# 2) with a Cox model (with covariates bili, chol and albumin) for computing the weights.
ROC.bili.cox&lt;-timeROC(T=pbc$time,
                      delta=pbc$status,marker=pbc$bili,
                      other_markers=as.matrix(pbc[,c("chol","albumin")]),
                      cause=1,weighting="cox",
                      times=quantile(pbc$time,probs=seq(0.2,0.8,0.1)))
ROC.bili.cox

##-------------With competing risks-------------------


#---------Example with Melano data-------
data(Melano)

# Evaluate tumor thickness as a prognostic biomarker for
# death from malignant melanoma.
ROC.thick&lt;-timeROC(T=Melano$time,delta=Melano$status,
                   weighting="aalen",
                   marker=Melano$thick,cause=1,
                   times=c(1800,2000,2200))
ROC.thick

#---------Example with Paquid data--------
data(Paquid)

# evaluate DDST cognitive score as a prognostic tool for
# dementia onset, accounting for death without dementia competing risk.
ROC.DSST&lt;-timeROC(T=Paquid$time,delta=Paquid$status,
                  marker=-Paquid$DSST,cause=1,
                  weighting="cox",
                  other_markers=as.matrix(Paquid$MMSE),
                  times=c(3,5,10),ROC=TRUE)
ROC.DSST 
plot(ROC.DSST,time=5)        
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
