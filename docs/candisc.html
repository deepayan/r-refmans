<!DOCTYPE html><html><head><title>Help for package candisc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {candisc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#candisc-package'>
<p>Visualizing Generalized Canonical Discriminant and Canonical Correlation Analysis</p></a></li>
<li><a href='#can_lm'>
<p>Transform a Multivariate Linear model mlm to a Canonical Representation</p></a></li>
<li><a href='#cancor'>
<p>Canonical Correlation Analysis</p></a></li>
<li><a href='#candisc'><p>Canonical discriminant analysis</p></a></li>
<li><a href='#candiscList'><p>Canonical discriminant analyses</p></a></li>
<li><a href='#dataIndex'><p>Indices of observations in a model data frame</p></a></li>
<li><a href='#Grass'><p>Yields from Nitrogen nutrition of grass species</p></a></li>
<li><a href='#heplot.cancor'><p> Canonical Correlation HE plots</p></a></li>
<li><a href='#heplot.candisc'><p> Canonical Discriminant HE plots</p></a></li>
<li><a href='#heplot.candiscList'><p>Canonical Discriminant HE plots</p></a></li>
<li><a href='#HSB'><p>High School and Beyond Data</p></a></li>
<li><a href='#plot.cancor'>
<p>Canonical Correlation Plots</p></a></li>
<li><a href='#redundancy'>
<p>Canonical Redundancy Analysis</p></a></li>
<li><a href='#varOrder'>
<p>Order variables according to canonical structure or other criteria</p></a></li>
<li><a href='#vecscale'>
<p>Scale vectors to fill the current plot</p></a></li>
<li><a href='#vectors'>
<p>Draw Labeled Vectors in 2D or 3D</p></a></li>
<li><a href='#Wilks'>
<p>Wilks Lambda Tests for Canonical Correlations</p></a></li>
<li><a href='#Wine'>
<p>Chemical composition of three cultivars of wine</p></a></li>
<li><a href='#Wolves'><p>Wolf skulls</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualizing Generalized Canonical Discriminant and Canonical
Correlation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-06</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), car, heplots (&ge; 0.8-6), graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rgl, corrplot, knitr, rmarkdown, MASS, rpart, rpart.plot</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Friendly [aut, cre],
  John Fox [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Friendly &lt;friendly@yorku.ca&gt;</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for computing and visualizing 
	generalized canonical discriminant analyses and canonical correlation analysis
	for a multivariate linear model.
	Traditional canonical discriminant analysis is restricted to a one-way 'MANOVA'
	design and is equivalent to canonical correlation analysis between a set of quantitative
	response variables and a set of dummy variables coded from the factor variable.
	The 'candisc' package generalizes this to higher-way 'MANOVA' designs
	for all factors in a multivariate linear model,
	computing canonical scores and vectors for each term. The graphic functions provide low-rank (1D, 2D, 3D) 
	visualizations of terms in an 'mlm' via the 'plot.candisc' and 'heplot.candisc' methods. Related plots are
	now provided for canonical correlation analysis when all predictors are quantitative.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-07 16:46:01 UTC; friendly</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/friendly/candisc/issues">https://github.com/friendly/candisc/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-07 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='candisc-package'>
Visualizing Generalized Canonical Discriminant and Canonical Correlation Analysis
</h2><span id='topic+candisc-package'></span>

<h3>Description</h3>

<p>This package includes functions for computing and visualizing 
generalized canonical discriminant analyses 
and canonical correlation analysis
for a multivariate linear model.  The goal is to provide ways of visualizing
such models in a low-dimensional space corresponding to dimensions
(linear combinations of the response variables) of maximal relationship
to the predictor variables. 
</p>
<p>Traditional canonical discriminant analysis is restricted to a one-way MANOVA
design and is equivalent to canonical correlation analysis between a set of quantitative
response variables and a set of dummy variables coded from the factor variable.
The <code>candisc</code> package generalizes this to multi-way MANOVA designs
for all terms in a multivariate linear model (i.e., an <code>mlm</code> object),
computing canonical scores and vectors for each term (giving a <code>candiscList</code> object).
</p>
<p>The graphic functions are designed to provide low-rank (1D, 2D, 3D) visualizations of
terms in a <code>mlm</code> via the <code><a href="#topic+plot.candisc">plot.candisc</a></code> method, 
and the HE plot <code><a href="#topic+heplot.candisc">heplot.candisc</a></code> and <code><a href="#topic+heplot3d.candisc">heplot3d.candisc</a></code>
methods.
For <code>mlm</code>s with more than a few response variables, these methods often provide a 
much simpler interpretation of the nature of effects in canonical space than
heplots for pairs of responses or an HE plot matrix of all responses in variable space.
</p>
<p>Analogously, a multivariate linear (regression) model with quantitative predictors can also be
represented in a reduced-rank space by means of a canonical correlation
transformation of the Y and X variables to uncorrelated canonical variates,
Ycan and Xcan.  Computation for this analysis is provided by <code><a href="#topic+cancor">cancor</a></code>
and related methods.  Visualization of these results in canonical space
are provided by the <code><a href="#topic+plot.cancor">plot.cancor</a></code>,  <code><a href="#topic+heplot.cancor">heplot.cancor</a></code> 
and <code><a href="#topic+heplot3d.cancor">heplot3d.cancor</a></code> methods.
</p>
<p>These relations among response variables in linear models can also be
useful for &ldquo;effect ordering&rdquo;
(Friendly &amp; Kwan (2003)
for <em>variables</em> in other multivariate data displays to make the
displayed relationships more coherent.  The function <code><a href="#topic+varOrder">varOrder</a></code>
implements a collection of these methods.
</p>
<p>A new vignette, <code>vignette("diabetes", package="candisc")</code>,
illustrates some of these methods.
A more comprehensive collection of examples is contained in the vignette for the <span class="pkg">heplots</span> package,
</p>
<p><code>vignette("HE-examples", package="heplots")</code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> candisc</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.8-6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-10-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The organization of functions in this package and the <span class="pkg">heplots</span> package
may change in a later version.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly and John Fox
</p>
<p>Maintainer: Michael Friendly &lt;friendly@yorku.ca&gt;
</p>


<h3>References</h3>

<p>Friendly, M. (2007).
HE plots for Multivariate General Linear Models.
<em>Journal of Computational and Graphical Statistics</em>, <b>16</b>(2) 421&ndash;444.
<a href="http://datavis.ca/papers/jcgs-heplots.pdf">http://datavis.ca/papers/jcgs-heplots.pdf</a> 
</p>
<p>Friendly, M. &amp; Kwan, E. (2003).
Effect Ordering for Data Displays,
<em>Computational Statistics and Data Analysis</em>, <b>43</b>, 509-539.
doi: <a href="https://doi.org/10.1016/S0167-9473(02)00290-6">10.1016/S0167-9473(02)00290-6</a>
</p>
<p>Friendly, M. &amp; Sigal, M. (2014). Recent Advances in Visualizing Multivariate Linear Models. <em>Revista Colombiana de Estadistica</em> , <b>37</b>(2), 261-283. doi: <a href="https://doi.org/10.15446/rce.v37n2spe.47934">10.15446/rce.v37n2spe.47934</a>.
</p>
<p>Friendly, M. &amp; Sigal, M. (2017). Graphical Methods for Multivariate Linear Models in Psychological Research: An R Tutorial, <em>The Quantitative Methods for Psychology</em>, 13 (1), 20-45. doi: <a href="https://doi.org/10.20982/tqmp.13.1.p020">10.20982/tqmp.13.1.p020</a>.
</p>
<p>Gittins, R. (1985). <em>Canonical Analysis: A Review with Applications in Ecology</em>,
Berlin: Springer.
</p>


<h3>See Also</h3>

 
<p><code><a href="heplots.html#topic+heplot">heplot</a></code> for details about HE plots.
</p>
<p><code><a href="#topic+candisc">candisc</a></code>, <code><a href="#topic+cancor">cancor</a></code> for details about canonical discriminant analysis
and canonical correlation analysis.
</p>

<hr>
<h2 id='can_lm'>
Transform a Multivariate Linear model mlm to a Canonical Representation
</h2><span id='topic+can_lm'></span>

<h3>Description</h3>

<p>This function uses <code><a href="#topic+candisc">candisc</a></code> to transform the responses in a
multivariate linear model to scores on canonical variables for a given term and then uses
those scores as responses in a linear (lm) or multivariate linear model (mlm).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>can_lm(mod, term, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="can_lm_+3A_mod">mod</code></td>
<td>

<p>A <code>mlm</code> object
</p>
</td></tr>
<tr><td><code id="can_lm_+3A_term">term</code></td>
<td>

<p>One term in that model
</p>
</td></tr>
<tr><td><code id="can_lm_+3A_...">...</code></td>
<td>

<p>Arguments passed to <code><a href="#topic+candisc">candisc</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs a model formula of the form <code>Can ~ terms</code>
where Can is the canonical score(s) and terms are the terms in the original mlm,
then runs lm() with that formula.
</p>


<h3>Value</h3>

<p>A <code>lm</code> object if <code>term</code> is a rank 1 hypothesis, otherwise a <code>mlm</code> object
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>See Also</h3>

<p><code><a href="#topic+candisc">candisc</a></code>, <code><a href="#topic+cancor">cancor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iris.mod &lt;- lm(cbind(Petal.Length, Sepal.Length, Petal.Width, Sepal.Width) ~ Species, data=iris)
iris.can &lt;- can_lm(iris.mod, "Species")
iris.can
Anova(iris.mod)
Anova(iris.can)
</code></pre>

<hr>
<h2 id='cancor'>
Canonical Correlation Analysis
</h2><span id='topic+cancor'></span><span id='topic+cancor.default'></span><span id='topic+cancor.formula'></span><span id='topic+print.cancor'></span><span id='topic+summary.cancor'></span><span id='topic+coef.cancor'></span><span id='topic+scores'></span><span id='topic+scores.cancor'></span>

<h3>Description</h3>

<p>The function <code>cancor</code> generalizes and regularizes computation
for canonical correlation analysis in a way conducive to visualization
using methods in the <code><a href="heplots.html#topic+heplots">heplots</a></code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
cancor(x, ...)

## S3 method for class 'formula'
cancor(formula, data, subset, weights, na.rm=TRUE, method = "gensvd", ...)

## Default S3 method:
cancor(x, y, weights,
    X.names = colnames(x), Y.names = colnames(y), 
    row.names = rownames(x), 
    xcenter = TRUE, ycenter = TRUE, xscale = FALSE, yscale = FALSE, 
    ndim = min(p, q), 
    set.names = c("X", "Y"), 
    prefix = c("Xcan", "Ycan"), 
    na.rm = TRUE, use = if (na.rm) "complete" else "pairwise",
    method = "gensvd",
	...
	)

## S3 method for class 'cancor'
print(x, digits = max(getOption("digits") - 2, 3), ...)

## S3 method for class 'cancor'
summary(object, digits = max(getOption("digits") - 2, 3), ...)

## S3 method for class 'cancor'
coef(object, type = c("x", "y", "both", "list"), standardize=FALSE, ...)

scores(x, ...)

## S3 method for class 'cancor'
scores(x, type = c("x", "y", "both", "list", "data.frame"), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cancor_+3A_formula">formula</code></td>
<td>

<p>A two-sided formula of the form <code>cbind(y1, y2, y3, ...) ~ x1 + x2 + x3 + ...</code>
</p>
</td></tr>
<tr><td><code id="cancor_+3A_data">data</code></td>
<td>

<p>The data.frame within which the formula is evaluated
</p>
</td></tr>
<tr><td><code id="cancor_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used in the calculations.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_weights">weights</code></td>
<td>

<p>Observation weights. If supplied, this must be a vector of length equal to the number of
observations in X and Y, typically within [0,1].  In that case, the variance-covariance
matrices are computed using <code><a href="stats.html#topic+cov.wt">cov.wt</a></code>, and the number of observations
is taken as the number of non-zero weights.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_na.rm">na.rm</code></td>
<td>

<p>logical, determining whether observations with missing cases are excluded in the computation
of the variance matrix of (X,Y).  See Notes for details on missing data.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_method">method</code></td>
<td>

<p>the method to be used for calculation; currently only <code>method = "gensvd"</code> is supported;
</p>
</td></tr>
<tr><td><code id="cancor_+3A_x">x</code></td>
<td>

<p>Varies depending on method. For the <code>cancor.default</code> method, this should be
a matrix or data.frame whose columns contain the X variables
</p>
</td></tr>
<tr><td><code id="cancor_+3A_y">y</code></td>
<td>

<p>For the <code>cancor.default</code> method,
a matrix or data.frame whose columns contain the Y variables
</p>
</td></tr>
<tr><td><code id="cancor_+3A_x.names">X.names</code>, <code id="cancor_+3A_y.names">Y.names</code></td>
<td>

<p>Character vectors of names for the X and Y variables.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_row.names">row.names</code></td>
<td>

<p>Observation names in <code>x</code>, <code>y</code>
</p>
</td></tr>
<tr><td><code id="cancor_+3A_xcenter">xcenter</code>, <code id="cancor_+3A_ycenter">ycenter</code></td>
<td>

<p>logical. Center the X, Y variables? [not yet implemented]
</p>
</td></tr>
<tr><td><code id="cancor_+3A_xscale">xscale</code>, <code id="cancor_+3A_yscale">yscale</code></td>
<td>

<p>logical. Scale the X, Y variables to unit variance? [not yet implemented]
</p>
</td></tr>
<tr><td><code id="cancor_+3A_ndim">ndim</code></td>
<td>

<p>Number of canonical dimensions to retain in the result, for scores, coefficients, etc.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_set.names">set.names</code></td>
<td>

<p>A vector of two character strings, giving names for the collections of
the X, Y variables.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_prefix">prefix</code></td>
<td>

<p>A vector of two character strings, giving prefixes used to name the X and Y
canonical variables, respectively.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_use">use</code></td>
<td>

<p>argument passed to <code>var</code> determining how missing data
are handled.  Only the default, <code>use="complete"</code> is allowed 
when observation weights are supplied.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_object">object</code></td>
<td>

<p>A <code>cancor</code> object for related methods.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_digits">digits</code></td>
<td>

<p>Number of digits passed to <code>print</code> and <code>summary</code> methods
</p>
</td></tr>
<tr><td><code id="cancor_+3A_...">...</code></td>
<td>

<p>Other arguments, passed to methods
</p>
</td></tr>
<tr><td><code id="cancor_+3A_type">type</code></td>
<td>

<p>For the <code>coef</code> method, the type of coefficients returned, 
one of <code>"x"</code>, <code>"y"</code>, <code>"both"</code>. For the <code>scores</code>
method, the same list,  or <code>"data.frame"</code>, which returns
a data.frame containing the X and Y canonical scores.
</p>
</td></tr>
<tr><td><code id="cancor_+3A_standardize">standardize</code></td>
<td>

<p>For the <code>coef</code> method, whether coefficients should be standardized
by dividing by the standard deviations of the X and Y variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Canonical correlation analysis (CCA), as traditionally presented is used to identify and measure the
associations between two sets of quantitative variables, X and Y.  
It is often used in the same situations for which a multivariate multiple regression analysis (MMRA)
would be used. 
However, CCA is is &ldquo;symmetric&rdquo; in that the sets X and Y have equivalent status,
and the goal is to find orthogonal linear combinations of each having maximal
(canonical) correlations.
On the other hand,  MMRA is &ldquo;asymmetric&rdquo;, in that the Y set is considered as responses,
<em>each one</em> to be explained by <em>separate</em> linear combinations of the Xs.
</p>
<p>This implementation of <code>cancor</code> provides the basic computations for CCA, together with
some extractor functions and methods for working with the results in a 
convenient fashion.  
</p>
<p>However, for visualization using HE plots, it is most natural to consider plots representing
the relations among the canonical variables for the Y variables in terms of a 
multivariate linear model predicting the Y canonical scores, using either the X variables
or the X canonical scores as predictors.  Such plots, using <code><a href="#topic+heplot.cancor">heplot.cancor</a></code>
provide a low-rank (1D, 2D, 3D) visualization of the relations between the two sets,
and so are useful in cases when there are more than 2 or 3 variables in each of X and Y.
</p>
<p>The connection between CCA and HE plots for MMRA models can be developed as follows.
CCA can also be viewed as a principal component transformation of the predicted values of 
one set of variables from a regression on the other set of variables, 
in the metric of the error covariance matrix. 
</p>
<p>For example, regress the Y variables on the X variables,
giving predicted values <code class="reqn">\hat{Y} = X (X'X)^{-1} X' Y</code>
and residuals <code class="reqn">R = Y - \hat{Y}</code>.
The error covariance matrix is <code class="reqn">E = R'R/(n-1)</code>. 
Choose a transformation Q
that orthogonalizes the error covariance matrix to an identity, that is,
<code class="reqn">(RQ)'(RQ) = Q' R' R Q = (n-1) I</code>,
and apply the same transformation to the predicted values to yield, say, <code class="reqn">Z = \hat{Y} Q</code>.
Then, a principal component analysis on the covariance matrix of Z gives eigenvalues of 
<code class="reqn">E^{-1} H</code>, and so is equivalent to the MMRA analysis of <code>lm(Y ~ X)</code> statistically,
but visualized here in canonical space.
</p>


<h3>Value</h3>

<p>An object of class <code>cancorr</code>, a list with the following components:
</p>
<table>
<tr><td><code>cancor</code></td>
<td>
<p>Canonical correlations, i.e., the correlations between each canonical variate for
the Y variables with the corresponding canonical variate for the X variables.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>Names for various items, a list of 4 components: <code>X</code>, <code>Y</code>, <code>row.names</code>, <code>set.names</code></p>
</td></tr>
<tr><td><code>ndim</code></td>
<td>
<p>Number of canonical dimensions extracted, <code>&lt;= min(p,q)</code></p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>Problem dimensions, a list of 3 components: <code>p</code> (number of X variables), 
<code>q</code> (number of Y variables), <code>n</code> (sample size)</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Canonical coefficients, a list of 2 components: <code>X</code>, <code>Y</code></p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>Canonical variate scores, a list of 2 components: 
</p>

<dl>
<dt><code>X</code></dt><dd><p>Canonical variate scores for the X variables</p>
</dd>
<dt><code>Y</code></dt><dd><p>Canonical variate scores for the Y variables</p>
</dd>
</dl>

</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The matrix X</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The matrix Y</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Observation weights, if supplied, else <code>NULL</code></p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>Structure correlations (&quot;loadings&quot;), a list of 4 components: 
</p>

<dl>
<dt>X.xscores</dt><dd><p>Structure correlations of the X variables with the Xcan canonical scores</p>
</dd>
<dt>Y.xscores</dt><dd><p>Structure correlations of the Y variables with the Xcan canonical scores</p>
</dd>
<dt>X.yscores</dt><dd><p>Structure correlations of the X variables with the Ycan canonical scores</p>
</dd>
<dt>Y.yscores</dt><dd><p>Structure correlations of the Y variables with the Ycan canonical scores</p>
</dd>
</dl>

<p>The formula method also returns components <code>call</code> and <code>terms</code>
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Not all features of CCA are presently implemented: standardized vs. raw scores, 
more flexible handling of missing data, other plot methods, ...
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Gittins, R. (1985). <em>Canonical Analysis: A Review with Applications in Ecology</em>,
Berlin: Springer.
</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).
<em>Multivariate Analysis</em>. London: Academic Press.
</p>


<h3>See Also</h3>

<p>Other implementations of CCA: <code><a href="stats.html#topic+cancor">cancor</a></code> (very basic), 
<code><a href="yacca.html#topic+cca">cca</a></code> in the <span class="pkg">yacca</span> (fairly complete, but very messy return structure),
<code><a href="CCA.html#topic+cc">cc</a></code> in <span class="pkg">CCA</span> (fairly complete, very messy return structure, no longer maintained).
</p>
<p><code><a href="#topic+redundancy">redundancy</a></code>, for redundancy analysis;
<code><a href="#topic+plot.cancor">plot.cancor</a></code>, for enhanced scatterplots of the canonical variates.
</p>
<p><code><a href="#topic+heplot.cancor">heplot.cancor</a></code> for CCA HE plots and
<code><a href="heplots.html#topic+heplots">heplots</a></code> for generic heplot methods.
</p>
<p><code><a href="#topic+candisc">candisc</a></code> for related methods focused on multivariate linear models with
one or more factors among the X variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Rohwer, package="heplots")
X &lt;- as.matrix(Rohwer[,6:10])  # the PA tests
Y &lt;- as.matrix(Rohwer[,3:5])   # the aptitude/ability variables

# visualize the correlation matrix using corrplot()
if (require(corrplot)) {
M &lt;- cor(cbind(X,Y))
corrplot(M, method="ellipse", order="hclust", addrect=2, addCoef.col="black")
}


(cc &lt;- cancor(X, Y, set.names=c("PA", "Ability")))

## Canonical correlation analysis of:
##       5   PA  variables:  n, s, ns, na, ss 
##   with        3   Ability  variables:  SAT, PPVT, Raven 
## 
##     CanR  CanRSQ   Eigen percent    cum                          scree
## 1 0.6703 0.44934 0.81599   77.30  77.30 ******************************
## 2 0.3837 0.14719 0.17260   16.35  93.65 ******                        
## 3 0.2506 0.06282 0.06704    6.35 100.00 **                            
## 
## Test of H0: The canonical correlations in the 
## current row and all that follow are zero
## 
##      CanR  WilksL      F df1   df2  p.value
## 1 0.67033 0.44011 3.8961  15 168.8 0.000006
## 2 0.38366 0.79923 1.8379   8 124.0 0.076076
## 3 0.25065 0.93718 1.4078   3  63.0 0.248814


# formula method
cc &lt;- cancor(cbind(SAT, PPVT, Raven) ~  n + s + ns + na + ss, data=Rohwer, 
    set.names=c("PA", "Ability"))

# using observation weights
set.seed(12345)
wts &lt;- sample(0:1, size=nrow(Rohwer), replace=TRUE, prob=c(.05, .95))
(ccw &lt;- cancor(X, Y, set.names=c("PA", "Ability"), weights=wts) )

# show correlations of the canonical scores 
zapsmall(cor(scores(cc, type="x"), scores(cc, type="y")))

# standardized coefficients
coef(cc, type="both", standardize=TRUE)

plot(cc, smooth=TRUE)

##################
data(schooldata)
##################

#fit the MMreg model
school.mod &lt;- lm(cbind(reading, mathematics, selfesteem) ~ 
education + occupation + visit + counseling + teacher, data=schooldata)
Anova(school.mod)
pairs(school.mod)

# canonical correlation analysis
school.cc &lt;- cancor(cbind(reading, mathematics, selfesteem) ~ 
education + occupation + visit + counseling + teacher, data=schooldata)
school.cc
heplot(school.cc, xpd=TRUE, scale=0.3)

</code></pre>

<hr>
<h2 id='candisc'>Canonical discriminant analysis</h2><span id='topic+candisc'></span><span id='topic+candisc.mlm'></span><span id='topic+coef.candisc'></span><span id='topic+plot.candisc'></span><span id='topic+print.candisc'></span><span id='topic+summary.candisc'></span>

<h3>Description</h3>

<p><code>candisc</code> performs a generalized canonical discriminant analysis for
one term in a multivariate linear model (i.e., an <code>mlm</code> object),
computing canonical scores and vectors.  It represents a transformation
of the original variables into a canonical space of maximal differences
for the term, controlling for other model terms.
</p>
<p>In typical usage,
the <code>term</code> should be a factor or interaction corresponding to a
multivariate test with 2 or more degrees of freedom for the
null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>candisc(mod, ...)

## S3 method for class 'mlm'
candisc(mod, term, type = "2", manova, ndim = rank, ...)

## S3 method for class 'candisc'
coef(object, type = c("std", "raw", "structure"), ...)

## S3 method for class 'candisc'
plot(x, which = 1:2, conf = 0.95, col, pch, scale, asp = 1,
    var.col = "blue", var.lwd = par("lwd"), var.labels, var.cex = 1, var.pos,
    rev.axes=c(FALSE, FALSE),
		ellipse=FALSE, ellipse.prob = 0.68, fill.alpha=0.1,
    prefix = "Can", suffix=TRUE, 
    titles.1d = c("Canonical scores", "Structure"),
    points.1d = FALSE, ...)
    
## S3 method for class 'candisc'
print(x, digits=max(getOption("digits") - 2, 3), LRtests=TRUE, ...)

## S3 method for class 'candisc'
summary(object, means = TRUE, scores = FALSE, coef = c("std"),
    ndim, digits = max(getOption("digits") - 2, 4), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="candisc_+3A_mod">mod</code></td>
<td>
<p>An mlm object, such as computed by <code>lm()</code> with a multivariate response</p>
</td></tr>
<tr><td><code id="candisc_+3A_term">term</code></td>
<td>
<p>the name of one term from <code>mod</code> for which the canonical analysis is performed.</p>
</td></tr>
<tr><td><code id="candisc_+3A_type">type</code></td>
<td>
<p>type of test for the model <code>term</code>, one of: &quot;II&quot;, &quot;III&quot;, &quot;2&quot;, or &quot;3&quot;</p>
</td></tr>
<tr><td><code id="candisc_+3A_manova">manova</code></td>
<td>
<p>the <code>Anova.mlm</code> object corresponding to <code>mod</code>.  Normally,
this is computed internally by  <code>Anova(mod)</code></p>
</td></tr>
<tr><td><code id="candisc_+3A_ndim">ndim</code></td>
<td>
<p>Number of dimensions to store in (or retrieve from, for the <code>summary</code> method)
the <code>means</code>, <code>structure</code>, <code>scores</code> and
<code>coeffs.*</code> components.  The default is the rank of the H matrix for the hypothesis
term.</p>
</td></tr>
<tr><td><code id="candisc_+3A_object">object</code>, <code id="candisc_+3A_x">x</code></td>
<td>
<p>A candisc object</p>
</td></tr>
<tr><td><code id="candisc_+3A_which">which</code></td>
<td>
<p>A vector of one or two integers, selecting the canonical dimension(s) to plot. If the canonical
structure for a <code>term</code> has <code>ndim==1</code>, or <code>length(which)==1</code>, a 1D representation of canonical scores
and structure coefficients is produced by the <code>plot</code> method.  Otherwise, a 2D plot is produced. </p>
</td></tr>
<tr><td><code id="candisc_+3A_conf">conf</code></td>
<td>
<p>Confidence coefficient for the confidence circles around canonical means plotted in the <code>plot</code> method</p>
</td></tr>
<tr><td><code id="candisc_+3A_col">col</code></td>
<td>
<p>A vector of the unique colors to be used for the levels of the term in the <code>plot</code> method, one for each
level of the <code>term</code>.
In this version, you should assign colors and point symbols explicitly, rather than relying on
the somewhat arbitrary defaults, based on <code><a href="grDevices.html#topic+palette">palette</a></code> </p>
</td></tr>
<tr><td><code id="candisc_+3A_pch">pch</code></td>
<td>
<p>A vector of the unique point symbols to be used for the levels of the term in the <code>plot</code> method</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="candisc_+3A_scale">scale</code></td>
<td>
<p>Scale factor for the variable vectors in canonical space.  If not specified, a scale
factor is calculated to make the variable vectors approximately fill the plot space. </p>
</td></tr>
<tr><td><code id="candisc_+3A_asp">asp</code></td>
<td>
<p>Aspect ratio for the <code>plot</code> method.  The <code>asp=1</code> (the default) assures that
the units on the horizontal and vertical axes are the same, so that lengths and angles of the
variable vectors are interpretable.</p>
</td></tr>
<tr><td><code id="candisc_+3A_var.col">var.col</code></td>
<td>
<p>Color used to plot variable vectors</p>
</td></tr>
<tr><td><code id="candisc_+3A_var.lwd">var.lwd</code></td>
<td>
<p>Line width used to plot variable vectors</p>
</td></tr>
<tr><td><code id="candisc_+3A_var.labels">var.labels</code></td>
<td>
<p>Optional vector of variable labels to replace variable names in the plots</p>
</td></tr>
<tr><td><code id="candisc_+3A_var.cex">var.cex</code></td>
<td>
<p>Character expansion size for variable labels in the plots</p>
</td></tr>
<tr><td><code id="candisc_+3A_var.pos">var.pos</code></td>
<td>
<p> Position(s) of variable vector labels wrt. the end point.  If not specified, the labels are
out-justified left and right with respect to the end points.</p>
</td></tr>
<tr><td><code id="candisc_+3A_rev.axes">rev.axes</code></td>
<td>
<p>Logical, a vector of <code>length(which)</code>. <code>TRUE</code> causes the orientation of the canonical
scores and structure coefficients to be reversed along a given axis.</p>
</td></tr>
<tr><td><code id="candisc_+3A_ellipse">ellipse</code></td>
<td>
<p>Draw data ellipses for canonical scores?</p>
</td></tr>
<tr><td><code id="candisc_+3A_ellipse.prob">ellipse.prob</code></td>
<td>
<p>Coverage probability for the data ellipses</p>
</td></tr>
<tr><td><code id="candisc_+3A_fill.alpha">fill.alpha</code></td>
<td>
<p>Transparency value for the color used to fill the ellipses.  Use <code>fill.alpha</code> to draw
the ellipses unfilled.</p>
</td></tr>
<tr><td><code id="candisc_+3A_prefix">prefix</code></td>
<td>
<p>Prefix used to label the canonical dimensions plotted</p>
</td></tr>
<tr><td><code id="candisc_+3A_suffix">suffix</code></td>
<td>
<p>Suffix for labels of canonical dimensions. If <code>suffix=TRUE</code>
the percent of hypothesis (H) variance accounted for by each canonical dimension is added to the axis label.</p>
</td></tr>
<tr><td><code id="candisc_+3A_titles.1d">titles.1d</code></td>
<td>
<p>A character vector of length 2, containing titles for the panels used to plot the
canonical scores and structure vectors, for the case in which there is only one canonical dimension.</p>
</td></tr>
<tr><td><code id="candisc_+3A_points.1d">points.1d</code></td>
<td>
<p>Logical value for <code>plot.candisc</code> when only one canonical dimension. </p>
</td></tr>
<tr><td><code id="candisc_+3A_means">means</code></td>
<td>
<p>Logical value used to determine if canonical means are printed</p>
</td></tr>
<tr><td><code id="candisc_+3A_scores">scores</code></td>
<td>
<p>Logical value used to determine if canonical scores are printed</p>
</td></tr>
<tr><td><code id="candisc_+3A_coef">coef</code></td>
<td>
<p>Type of coefficients printed by the summary method. Any one or more of
&quot;std&quot;, &quot;raw&quot;, or &quot;structure&quot;</p>
</td></tr>
<tr><td><code id="candisc_+3A_digits">digits</code></td>
<td>
<p>significant digits to print.</p>
</td></tr>
<tr><td><code id="candisc_+3A_lrtests">LRtests</code></td>
<td>
<p>logical; should likelihood ratio tests for the canonical dimensions 
be printed?</p>
</td></tr>
<tr><td><code id="candisc_+3A_...">...</code></td>
<td>
<p>arguments to be passed down.  In particular, <code>type="n"</code> can be used with
the <code>plot</code> method to suppress the display of canonical scores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Canonical discriminant analysis is typically carried out in conjunction with
a one-way MANOVA design. It represents a linear transformation of the response variables
into a canonical space in which (a) each successive canonical variate produces
maximal separation among the groups (e.g., maximum univariate F statistics), and
(b) all canonical variates are mutually uncorrelated. 
For a one-way MANOVA with g groups and p responses, there are 
<code>dfh</code> = min( g-1, p) such canonical dimensions, and tests, initially stated
by Bartlett (1938) allow one to determine the number of significant 
canonical dimensions.   
</p>
<p>Computational details for the one-way case are described
in Cooley &amp; Lohnes (1971), and in the <em>SAS/STAT User's Guide</em>,  &quot;The CANDISC procedure:
Computational Details,&quot; <a href="http://support.sas.com/documentation/cdl/en/statug/63962/HTML/default/viewer.htm#statug_candisc_sect012.htm">http://support.sas.com/documentation/cdl/en/statug/63962/HTML/default/viewer.htm#statug_candisc_sect012.htm</a>.
</p>
<p>A generalized canonical discriminant analysis extends this idea to a general
multivariate linear model.  Analysis of each term in the <code>mlm</code> produces
a rank <code class="reqn">df_h</code> H matrix sum of squares and crossproducts matrix that is 
tested against the rank <code class="reqn">df_e</code> E matrix by the standard multivariate
tests (Wilks' Lambda, Hotelling-Lawley trace, Pillai trace, Roy's maximum root
test).  For any given term in the <code>mlm</code>, the generalized canonical discriminant
analysis amounts to a standard discriminant analysis based on the H matrix for that
term in relation to the full-model E matrix.
</p>
<p>The plot method for candisc objects is typically a 2D plot, similar to a biplot.
It shows the canonical scores for the groups defined by the <code>term</code> as
points and the canonical structure coefficients as vectors from the origin.
</p>
<p>If the canonical structure for a <code>term</code> has <code>ndim==1</code>, or <code>length(which)==1</code>,
the 1D representation consists of a boxplot of canonical scores and a vector diagram
showing the magnitudes of the structure coefficients.
</p>


<h3>Value</h3>

<p>An object of class <code>candisc</code> with the following components:
</p>
<table>
<tr><td><code>dfh</code></td>
<td>
<p>hypothesis degrees of freedom for <code>term</code></p>
</td></tr>
<tr><td><code>dfe</code></td>
<td>
<p>error degrees of freedom for the <code>mlm</code></p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>number of non-zero eigenvalues of <code class="reqn">HE^{-1}</code></p>
</td></tr>
<tr><td><code>eigenvalues</code></td>
<td>
<p>eigenvalues of <code class="reqn">HE^{-1}</code></p>
</td></tr>
<tr><td><code>canrsq</code></td>
<td>
<p>squared canonical correlations</p>
</td></tr>
<tr><td><code>pct</code></td>
<td>
<p>A vector containing the percentages of the <code>canrsq</code> of their total.</p>
</td></tr>
<tr><td><code>ndim</code></td>
<td>
<p>Number of canonical dimensions stored in the <code>means</code>, <code>structure</code> and <code>coeffs.*</code> components</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>A data.frame containing the class means for the levels of the factor(s) in the term</p>
</td></tr>
<tr><td><code>factors</code></td>
<td>
<p>A data frame containing the levels of the factor(s) in the <code>term</code></p>
</td></tr>
<tr><td><code>term</code></td>
<td>
<p>name of the <code>term</code></p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>A character vector containing the names of the terms in the <code>mlm</code> object</p>
</td></tr>
<tr><td><code>coeffs.raw</code></td>
<td>
<p>A matrix containing the raw canonical coefficients</p>
</td></tr>
<tr><td><code>coeffs.std</code></td>
<td>
<p>A matrix containing the standardized canonical coefficients</p>
</td></tr>
<tr><td><code>structure</code></td>
<td>
<p>A matrix containing the canonical structure coefficients on <code>ndim</code> dimensions, i.e.,
the correlations between the original variates and the canonical scores.
These are sometimes referred to as Total Structure Coefficients.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>A data frame containing the predictors in the <code>mlm</code> model and the
canonical scores on <code>ndim</code> dimensions. 
These are calculated as <code>Y %*% coeffs.raw</code>, where <code>Y</code> contains the
standardized response variables.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly and John Fox</p>


<h3>References</h3>

<p>Bartlett, M. S. (1938). Further aspects of the theory of multiple regression. Proc. Cambridge Philosophical Society <b>34</b>, 33-34.
</p>
<p>Cooley, W.W. &amp; Lohnes, P.R. (1971). Multivariate Data Analysis,  New York: Wiley.
</p>
<p>Gittins, R. (1985). Canonical Analysis: A Review with Applications in Ecology,
Berlin: Springer.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+candiscList">candiscList</a></code>, <code><a href="heplots.html#topic+heplot">heplot</a></code>,  <code><a href="heplots.html#topic+heplot3d">heplot3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>grass.mod &lt;- lm(cbind(N1,N9,N27,N81,N243) ~ Block + Species, data=Grass)
Anova(grass.mod, test="Wilks")

grass.can1 &lt;-candisc(grass.mod, term="Species")
plot(grass.can1)

# library(heplots)
heplot(grass.can1, scale=6, fill=TRUE)

# iris data
iris.mod &lt;- lm(cbind(Petal.Length, Sepal.Length, Petal.Width, Sepal.Width) ~ Species, data=iris)
iris.can &lt;- candisc(iris.mod, data=iris)
#-- assign colors and symbols corresponding to species
col &lt;- c("red", "brown", "green3")
pch &lt;- 1:3
plot(iris.can, col=col, pch=pch)

heplot(iris.can)

# 1-dim plot
iris.can1 &lt;- candisc(iris.mod, data=iris, ndim=1)
plot(iris.can1)

</code></pre>

<hr>
<h2 id='candiscList'>Canonical discriminant analyses</h2><span id='topic+candiscList'></span><span id='topic+candiscList.mlm'></span><span id='topic+plot.candiscList'></span><span id='topic+print.candiscList'></span><span id='topic+summary.candiscList'></span>

<h3>Description</h3>

<p><code>candiscList</code> performs a generalized canonical discriminant analysis for
all terms in a multivariate linear model (i.e., an <code>mlm</code> object),
computing canonical scores and vectors.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>candiscList(mod, ...)

## S3 method for class 'mlm'
candiscList(mod, type = "2", manova, ndim, ...)

## S3 method for class 'candiscList'
plot(x, term, ask = interactive(), graphics = TRUE, ...)

## S3 method for class 'candiscList'
print(x, ...)

## S3 method for class 'candiscList'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="candiscList_+3A_mod">mod</code></td>
<td>
<p>An mlm object, such as computed by lm() with a multivariate response</p>
</td></tr>
<tr><td><code id="candiscList_+3A_type">type</code></td>
<td>
<p>type of test for the model <code>term</code>, one of: &quot;II&quot;, &quot;III&quot;, &quot;2&quot;, or &quot;3&quot;</p>
</td></tr>
<tr><td><code id="candiscList_+3A_manova">manova</code></td>
<td>
<p>the <code>Anova.mlm</code> object corresponding to <code>mod</code>.  Normally,
this is computed internally by  <code>Anova(mod)</code></p>
</td></tr>
<tr><td><code id="candiscList_+3A_ndim">ndim</code></td>
<td>
<p>Number of dimensions to store in the <code>means</code>, <code>structure</code>, <code>scores</code> and
<code>coeffs.*</code> components.  The default is the rank of the H matrix for the hypothesis
term.</p>
</td></tr>
<tr><td><code id="candiscList_+3A_object">object</code>, <code id="candiscList_+3A_x">x</code></td>
<td>
<p>A candiscList object</p>
</td></tr>
<tr><td><code id="candiscList_+3A_term">term</code></td>
<td>
<p>The name of one term to be plotted for the <code>plot</code> method.  If not specified, one
candisc plot is produced for each term in the <code>mlm</code> object.</p>
</td></tr>
<tr><td><code id="candiscList_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code> (the default, when running interactively), a menu of  terms is presented; if ask is FALSE, 
canonical plots for all  terms are produced.</p>
</td></tr>
<tr><td><code id="candiscList_+3A_graphics">graphics</code></td>
<td>
<p>if <code>TRUE</code> (the default, when running interactively), then the menu of terms to plot is presented in a dialog box rather than as a text menu.</p>
</td></tr> 
<tr><td><code id="candiscList_+3A_...">...</code></td>
<td>
<p>arguments to be passed down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>candiscList</code> which is a list of  <code>candisc</code> objects
for the terms in the mlm.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly and John Fox</p>


<h3>See Also</h3>

 <p><code><a href="#topic+candisc">candisc</a></code>, <code><a href="heplots.html#topic+heplot">heplot</a></code>,  <code><a href="heplots.html#topic+heplot3d">heplot3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>grass.mod &lt;- lm(cbind(N1,N9,N27,N81,N243) ~ Block + Species, data=Grass)

grass.canL &lt;-candiscList(grass.mod)
names(grass.canL)
names(grass.canL$Species)

## Not run: 
print(grass.canL)

## End(Not run)
plot(grass.canL, type="n", ask=FALSE)
heplot(grass.canL$Species, scale=6)
heplot(grass.canL$Block, scale=2)

</code></pre>

<hr>
<h2 id='dataIndex'>Indices of observations in a model data frame</h2><span id='topic+dataIndex'></span>

<h3>Description</h3>

<p>Find sequential indices for observations in a data frame
corresponding to the unique combinations of the levels
of a given model term from a model object or a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataIndex(x, term)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataIndex_+3A_x">x</code></td>
<td>
<p>Either a data frame or a model object</p>
</td></tr>
<tr><td><code id="dataIndex_+3A_term">term</code></td>
<td>
<p>The name of one term in the model, consisting only of factors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of indices.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly</p>


<h3>Examples</h3>

<pre><code class='language-R'>factors &lt;- expand.grid(A=factor(1:3),B=factor(1:2),C=factor(1:2))
n &lt;- nrow(factors)
responses &lt;-data.frame(Y1=10+round(10*rnorm(n)),Y2=10+round(10*rnorm(n)))

test &lt;- data.frame(factors, responses)
mod &lt;- lm(cbind(Y1,Y2) ~ A*B, data=test)

dataIndex(mod, "A")
dataIndex(mod, "A:B")

</code></pre>

<hr>
<h2 id='Grass'>Yields from Nitrogen nutrition of grass species</h2><span id='topic+Grass'></span>

<h3>Description</h3>

<p>The data frame <code>Grass</code> gives the yield (10 * log10 dry-weight (g))
of eight grass Species in five replicates (Block) grown in sand culture
at five levels of nitrogen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Grass)</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 7 variables.
</p>

<dl>
<dt><code>Species</code></dt><dd><p>a factor with levels 
<code>B.media</code> <code>D.glomerata</code> <code>F.ovina</code> <code>F.rubra</code> <code>H.pubesens</code> 
<code>K.cristata</code> <code>L.perenne</code> <code>P.bertolonii</code></p>
</dd>
<dt><code>Block</code></dt><dd><p>a factor with levels <code>1</code> <code>2</code> <code>3</code> <code>4</code> <code>5</code></p>
</dd>
<dt><code>N1</code></dt><dd><p>species yield at 1 ppm Nitrogen</p>
</dd>
<dt><code>N9</code></dt><dd><p>species yield at 9 ppm Nitrogen</p>
</dd>
<dt><code>N27</code></dt><dd><p>species yield at 27 ppm Nitrogen</p>
</dd>
<dt><code>N81</code></dt><dd><p>species yield at 81 ppm Nitrogen</p>
</dd>
<dt><code>N243</code></dt><dd><p>species yield at 243 ppm Nitrogen</p>
</dd>
</dl>



<h3>Details</h3>

<p>Nitrogen (NaNO3) levels were chosen to vary from what was expected to be from
critically low to almost toxic.  The amount of Nitrogen can be considered on
a log3 scale, with levels 0, 2, 3, 4, 5.  Gittins (1985, Ch. 11) treats these
as equally spaced for the purpose of testing polynomial trends in Nitrogen level.
</p>
<p>The data are also not truly multivariate, but rather a split-plot experimental design.
For the purpose of exposition, he regards Species as the experimental unit, so
that correlations among the responses refer to a composite representative of a species
rather than to an individual exemplar.
</p>


<h3>Source</h3>

<p>Gittins, R. (1985), Canonical Analysis: A Review with Applications in Ecology,
Berlin: Springer-Verlag, Table A-5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(Grass)
grass.mod &lt;- lm(cbind(N1,N9,N27,N81,N243) ~ Block + Species, data=Grass)
Anova(grass.mod)

grass.canL &lt;-candiscList(grass.mod)
names(grass.canL)
names(grass.canL$Species)

</code></pre>

<hr>
<h2 id='heplot.cancor'> Canonical Correlation HE plots</h2><span id='topic+heplot.cancor'></span><span id='topic+heplot3d.cancor'></span>

<h3>Description</h3>

<p>These functions plot ellipses (or ellipsoids in 3D)
in canonical space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model representing the result of a
canonical correlation analysis.
They provide a low-rank 2D (or 3D) view of the effects 
in the space of maximum canonical correlations, together with variable
vectors representing the correlations of Y variables with the canonical
dimensions.
</p>
<p>For consistency with <code><a href="#topic+heplot.candisc">heplot.candisc</a></code>, the plots show
effects in the space of the canonical Y variables selected by <code>which</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cancor'
heplot(mod, which = 1:2, scale, asp=1,
    var.vectors = "Y", var.col = c("blue", "darkgreen"), var.lwd = par("lwd"), 
    var.cex = par("cex"), var.xpd = TRUE, 
    prefix = "Ycan", suffix = TRUE, terms = TRUE, ...)

## S3 method for class 'cancor'
heplot3d(mod, which = 1:3, scale, asp="iso",
    var.vectors = "Y", var.col = c("blue", "darkgreen"), var.lwd = par("lwd"), 
    var.cex = par("cex"), var.xpd = NA, 
    prefix = "Ycan", suffix = FALSE, terms = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heplot.cancor_+3A_mod">mod</code></td>
<td>
<p> A <code>cancor</code> object</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_which">which</code></td>
<td>
<p> A numeric vector containing the indices of the Y canonical
dimensions to plot. </p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_scale">scale</code></td>
<td>
<p> Scale factor for the variable vectors in canonical space.  If
not specified, the function calculates one to make the variable vectors 
approximately fill the plot window. </p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_asp">asp</code></td>
<td>
<p>aspect ratio setting. Use <code>asp=1</code> in 2D plots and <code>asp="iso"</code> in 3D plots
to ensure equal units on the axes. Use <code>asp=NA</code> in 2D plots and <code>asp=NULL</code> in 3D plots
to allow separate scaling for the axes. See Details below.</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_var.vectors">var.vectors</code></td>
<td>
<p>Which variable vectors to plot?  A character vector containing one or more
of <code>"X"</code> and <code>"Y"</code>.</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_var.col">var.col</code></td>
<td>
<p> Color(s) for variable vectors and labels, a vector of length 1 or 2.
The first color is used for Y vectors and the second for X vectors, if these are plotted. </p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_var.lwd">var.lwd</code></td>
<td>
<p> Line width for variable vectors </p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_var.cex">var.cex</code></td>
<td>
<p> Text size for variable vector labels </p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_var.xpd">var.xpd</code></td>
<td>
<p>logical. Allow variable labels outside the plot box? Does not apply to 3D plots.</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_prefix">prefix</code></td>
<td>
<p> Prefix for labels of the Y canonical dimensions.</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_suffix">suffix</code></td>
<td>
<p> Suffix for labels of canonical dimensions. If <code>suffix=TRUE</code>
the percent of hypothesis (H) variance accounted for by each canonical dimension is added to the axis label.</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_terms">terms</code></td>
<td>

<p>Terms for the X variables to be plotted in canonical space.
The default, <code>terms=TRUE</code> or <code>terms="X"</code>
plots H ellipses for all of the X variables.
<code>terms="Xcan"</code> plots H ellipses for all of the X canonical variables,
<code>Xcan1</code>, <code>Xcan2</code>, ....
</p>
</td></tr>
<tr><td><code id="heplot.cancor_+3A_...">...</code></td>
<td>

<p>Other arguments passed to <code>link[heplots]{heplot}</code>.
In particular, you can pass linear hypotheses among the term variables via <code>hypotheses</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interpretation of variable vectors in these plots is different from that of the
<code>terms</code> plotted as H &quot;ellipses,&quot; which appear as degenerate lines in the plot (because they
correspond to 1 df tests of rank(H)=1).  
</p>
<p>In canonical space, the interpretation of the H ellipses for the <code>terms</code> is the same
as in ordinary HE plots:  a term is significant <em>iff</em> its H ellipse projects outside
the (orthogonalized) E ellipsoid somewhere in the space of the Y canonical dimensions.
The orientation of each H ellipse with respect to the Y canonical dimensions indicates
which dimensions that X variate contributes to.
</p>
<p>On the other hand, the variable vectors shown in these plots are intended only to show
the correlations of Y variables with the canonical dimensions.  Only their relative
lengths and angles with respect to the Y canonical dimensions have meaning.
Relative lengths correspond to proportions of variance accounted for in the 
Y canonical dimensions plotted;
angles between the variable vectors and the canonical axes correspond to the
structure correlations. 
The absolute lengths of these vectors are typically manipulated by the 
<code>scale</code> argument to provide better visual resolution and labeling for the variables.
</p>
<p>Setting the aspect ratio of these plots is important for the proper interpretation of
angles between the variable vectors and the coordinate axes.  
However, this then makes it impossible to change the aspect ratio of the plot
by re-sizing manually.
</p>


<h3>Value</h3>

<p>Returns invisibly an object of class <code>"heplot"</code>, with
coordinates for the various hypothesis ellipses and the error ellipse, and
the limits of the horizontal and vertical axes.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Gittins, R. (1985). <em>Canonical Analysis: A Review with Applications in Ecology</em>,
Berlin: Springer.
</p>
<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).
<em>Multivariate Analysis</em>. London: Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cancor">cancor</a></code> for details on canonical correlation as implemented here;
<code><a href="#topic+plot.cancor">plot.cancor</a></code> for scatterplots of canonical variable scores.
</p>
<p><code><a href="#topic+heplot.candisc">heplot.candisc</a></code>, <code><a href="heplots.html#topic+heplot">heplot</a></code>,
<code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Rohwer, package="heplots")
X &lt;- as.matrix(Rohwer[,6:10])
Y &lt;- as.matrix(Rohwer[,3:5])
cc &lt;- cancor(X, Y, set.names=c("PA", "Ability"))

# basic plot
heplot(cc)

# note relationship of joint hypothesis to individual ones
heplot(cc, scale=1.25, hypotheses=list("na+ns"=c("na", "ns")))

# more options
heplot(cc, hypotheses=list("All X"=colnames(X)),
	fill=c(TRUE,FALSE), fill.alpha=0.2,
	var.cex=1.5, var.col="red", var.lwd=3,
	prefix="Y canonical dimension"
	)

# 3D version
## Not run: 
heplot3d(cc, var.lwd=3, var.col="red")

## End(Not run)

</code></pre>

<hr>
<h2 id='heplot.candisc'> Canonical Discriminant HE plots</h2><span id='topic+heplot.candisc'></span><span id='topic+heplot3d.candisc'></span>

<h3>Description</h3>

<p>These functions plot ellipses (or ellipsoids in 3D)
in canonical discriminant space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model.
They provide a low-rank 2D (or 3D) view of the effects for that term 
in the space of maximum discrimination. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'candisc'
heplot(mod, which = 1:2, scale, asp = 1, var.col = "blue", 
    var.lwd = par("lwd"), var.cex=par("cex"), var.pos,
    rev.axes=c(FALSE, FALSE),
    prefix = "Can", suffix = TRUE, terms = mod$term, ...)

## S3 method for class 'candisc'
heplot3d(mod, which = 1:3, scale, asp="iso", var.col = "blue", 
    var.lwd=par("lwd"), var.cex=rgl::par3d("cex"),
    prefix = "Can", suffix = FALSE, terms = mod$term, 
    ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heplot.candisc_+3A_mod">mod</code></td>
<td>
<p> A <code>candisc</code> object for one term in a <code>mlm</code></p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_which">which</code></td>
<td>
<p> A numeric vector containing the indices of the canonical
dimensions to plot. </p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_scale">scale</code></td>
<td>
<p> Scale factor for the variable vectors in canonical space.  If
not specified, the function calculates one to make the variable vectors 
approximately fill the plot window. </p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_asp">asp</code></td>
<td>
<p>Aspect ratio for the horizontal and vertical
dimensions. The defaults, <code>asp=1</code> for <code>heplot.candisc</code> and
<code>asp="iso"</code> for <code>heplot3d.candisc</code>
ensure equal units on all axes, so that angles
and lengths of variable vectors are interpretable. As well, the 
standardized canonical scores are uncorrelated, so the Error ellipse
(ellipsoid) should plot as a circle (sphere) in canonical space.
For <code>heplot3d.candisc</code>, use <code>asp=NULL</code> to suppress this transformation
to iso-scaled axes.
</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_var.col">var.col</code></td>
<td>
<p> Color for variable vectors and labels </p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_var.lwd">var.lwd</code></td>
<td>
<p> Line width for variable vectors </p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_var.cex">var.cex</code></td>
<td>
<p> Text size for variable vector labels </p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_var.pos">var.pos</code></td>
<td>
<p> Position(s) of variable vector labels wrt. the end point.  If not specified, the labels are
out-justified left and right with respect to the end points.</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_rev.axes">rev.axes</code></td>
<td>
<p>Logical, a vector of <code>length(which)</code>. <code>TRUE</code> causes the orientation of the canonical
scores and structure coefficients to be reversed along a given axis.</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_prefix">prefix</code></td>
<td>
<p> Prefix for labels of canonical dimensions.</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_suffix">suffix</code></td>
<td>
<p> Suffix for labels of canonical dimensions. If <code>suffix=TRUE</code>
the percent of hypothesis (H) variance accounted for by each canonical dimension is added to the axis label.</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_terms">terms</code></td>
<td>
<p> Terms  from the original <code>mlm</code> whose H ellipses
are to be plotted in canonical space.  The default is the one term for
which the canonical scores were computed.  If <code>terms=TRUE</code>,
all terms are plotted.</p>
</td></tr>
<tr><td><code id="heplot.candisc_+3A_...">...</code></td>
<td>
<p> Arguments to be passed down to <code><a href="heplots.html#topic+heplot">heplot</a></code> or <code><a href="heplots.html#topic+heplot3d">heplot3d</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized canonical discriminant analysis for one term in a <code>mlm</code>
is based on the eigenvalues, <code class="reqn">\lambda_i</code>, and eigenvectors, V,
of the H and E matrices for that term.  This produces uncorrelated
canonical scores which give the maximum univariate F statistics.
The canonical HE plot is then just the HE plot of the canonical scores
for the given term.
</p>
<p>For <code>heplot3d.candisc</code>, the default <code>asp="iso"</code> now gives a geometrically
correct plot, but the third dimension, CAN3, is often small.  Passing an expanded
range in <code>zlim</code> to <code><a href="heplots.html#topic+heplot3d">heplot3d</a></code> usually helps.
</p>


<h3>Value</h3>

<p><code>heplot.candisc</code> returns invisibly an object of class <code>"heplot"</code>, with
coordinates for the various hypothesis ellipses and the error ellipse, and
the limits of the horizontal and vertical axes.
</p>
<p>Similarly, <code>heploted.candisc</code> returns an object of class <code>"heplot3d"</code>.
</p>


<h3>Author(s)</h3>

<p> Michael Friendly and John Fox </p>


<h3>References</h3>

 
<p>Friendly, M. (2006). Data Ellipses, HE Plots and Reduced-Rank Displays for Multivariate Linear Models: SAS Software and Examples <em>Journal of Statistical Software</em>, 17(6), 1-42. 
doi: <a href="https://doi.org/10.18637/jss.v017.i06">10.18637/jss.v017.i06</a>
</p>
<p>Friendly, M. (2007).
HE plots for Multivariate General Linear Models.
<em>Journal of Computational and Graphical Statistics</em>, <b>16</b>(2) 421&ndash;444.
<a href="http://datavis.ca/papers/jcgs-heplots.pdf">http://datavis.ca/papers/jcgs-heplots.pdf</a> 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+candisc">candisc</a></code>, <code><a href="#topic+candiscList">candiscList</a></code>, 
<code><a href="heplots.html#topic+heplot">heplot</a></code>, <code><a href="heplots.html#topic+heplot3d">heplot3d</a></code>, <code><a href="rgl.html#topic+aspect3d">aspect3d</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Pottery data, from car package
pottery.mod &lt;- lm(cbind(Al, Fe, Mg, Ca, Na) ~ Site, data=Pottery)
pottery.can &lt;-candisc(pottery.mod)

heplot(pottery.can, var.lwd=3)
if(requireNamespace("rgl")){
heplot3d(pottery.can, var.lwd=3, scale=10, zlim=c(-3,3), wire=FALSE)
}


# reduce example for CRAN checks time

grass.mod &lt;- lm(cbind(N1,N9,N27,N81,N243) ~ Block + Species, data=Grass)

grass.can1 &lt;-candisc(grass.mod,term="Species")
grass.canL &lt;-candiscList(grass.mod)

heplot(grass.can1, scale=6)
heplot(grass.can1, scale=6, terms=TRUE)
heplot(grass.canL, terms=TRUE, ask=FALSE)

heplot3d(grass.can1, wire=FALSE)
# compare with non-iso scaling
rgl::aspect3d(x=1,y=1,z=1)
# or,
# heplot3d(grass.can1, asp=NULL)


## Can't run this in example
# rgl::play3d(rgl::spin3d(axis = c(1, 0, 0), rpm = 5), duration=12)

# reduce example for CRAN checks time

## FootHead data, from heplots package
library(heplots)
data(FootHead)

# use Helmert contrasts for group
contrasts(FootHead$group) &lt;- contr.helmert

foot.mod &lt;- lm(cbind(width, circum,front.back,eye.top,ear.top,jaw)~group, data=FootHead)
foot.can &lt;- candisc(foot.mod)
heplot(foot.can, main="Candisc HE plot", 
 hypotheses=list("group.1"="group1","group.2"="group2"),
 col=c("red", "blue", "green3", "green3" ), var.col="red")


</code></pre>

<hr>
<h2 id='heplot.candiscList'>Canonical Discriminant HE plots </h2><span id='topic+heplot.candiscList'></span><span id='topic+heplot3d.candiscList'></span>

<h3>Description</h3>

<p>These functions plot ellipses (or ellipsoids in 3D)
in canonical discriminant space
representing the hypothesis and error sums-of-squares-and-products matrices for 
terms in a multivariate linear model.
They provide a low-rank 2D (or 3D) view of the effects for that term 
in the space of maximum discrimination. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'candiscList'
heplot(mod, term, ask = interactive(), graphics = TRUE, ...)

## S3 method for class 'candiscList'
heplot3d(mod, term, ask = interactive(), graphics = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heplot.candiscList_+3A_mod">mod</code></td>
<td>
<p>A <code>candiscList</code> object for  terms in a <code>mlm</code> </p>
</td></tr>
<tr><td><code id="heplot.candiscList_+3A_term">term</code></td>
<td>
<p>The name of one term to be plotted for the <code>heplot</code> and
<code>heplot3d</code> methods. If not specified, one
plot is produced for each term in the <code>mlm</code> object.</p>
</td></tr>
<tr><td><code id="heplot.candiscList_+3A_ask">ask</code></td>
<td>
<p>If <code>TRUE</code> (the default), a menu of  terms is presented; if ask is FALSE, 
canonical HE plots for all  terms are produced.</p>
</td></tr>
<tr><td><code id="heplot.candiscList_+3A_graphics">graphics</code></td>
<td>
<p>if <code>TRUE</code> (the default, when running interactively), then the menu of terms to plot is presented in a dialog box rather than as a text menu.</p>
</td></tr>
<tr><td><code id="heplot.candiscList_+3A_...">...</code></td>
<td>
<p> Arguments to be passed down </p>
</td></tr>
</table>


<h3>Value</h3>

<p>No useful value; used for the side-effect of producing canonical HE plots.
</p>


<h3>Author(s)</h3>

<p> Michael Friendly and John Fox </p>


<h3>References</h3>

 
<p>Friendly, M. (2006). Data Ellipses, HE Plots and Reduced-Rank Displays for Multivariate Linear Models: SAS Software and Examples Journal of Statistical Software, 17(6), 1-42. 
doi: <a href="https://doi.org/10.18637/jss.v017.i06">10.18637/jss.v017.i06</a>.
</p>
<p>Friendly, M. (2007).
HE plots for Multivariate General Linear Models.
<em>Journal of Computational and Graphical Statistics</em>, <b>16</b>(2) 421&ndash;444.
<a href="http://datavis.ca/papers/jcgs-heplots.pdf">http://datavis.ca/papers/jcgs-heplots.pdf</a> 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+candisc">candisc</a></code>, <code><a href="#topic+candiscList">candiscList</a></code>, <code><a href="heplots.html#topic+heplot">heplot</a></code>, 
<code><a href="heplots.html#topic+heplot3d">heplot3d</a></code></p>

<hr>
<h2 id='HSB'>High School and Beyond Data</h2><span id='topic+HSB'></span>

<h3>Description</h3>

<p>The High School and Beyond Project was a longitudinal study of students in the U.S.
carried out in 1980 by the National Center for Education Statistics.  
Data were collected from 58,270 high school students (28,240 seniors and 30,030 sophomores) and 1,015 secondary schools. 
The HSB data frame is sample of 600 observations, of unknown characteristics, originally taken
from Tatsuoka (1988). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HSB)</code></pre>


<h3>Format</h3>

<p>A data frame with 600 observations on the following 15 variables.  There is no missing data.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Observation id: a numeric vector</p>
</dd>
<dt><code>gender</code></dt><dd><p>a factor with levels <code>male</code> <code>female</code></p>
</dd>
<dt><code>race</code></dt><dd><p>Race or ethnicity: a factor with levels <code>hispanic</code> <code>asian</code> <code>african-amer</code> <code>white</code></p>
</dd>
<dt><code>ses</code></dt><dd><p>Socioeconomic status: a factor with levels <code>low</code> <code>middle</code> <code>high</code></p>
</dd>
<dt><code>sch</code></dt><dd><p>School type: a factor with levels <code>public</code> <code>private</code></p>
</dd>
<dt><code>prog</code></dt><dd><p>High school program: a factor with levels <code>general</code> <code>academic</code> <code>vocation</code></p>
</dd>
<dt><code>locus</code></dt><dd><p>Locus of control: a numeric vector</p>
</dd>
<dt><code>concept</code></dt><dd><p>Self-concept: a numeric vector</p>
</dd>
<dt><code>mot</code></dt><dd><p>Motivation: a numeric vector</p>
</dd>
<dt><code>career</code></dt><dd><p>Career plan: a factor with levels <code>clerical</code> <code>craftsman</code> 
<code>farmer</code> <code>homemaker</code> <code>laborer</code> <code>manager</code> <code>military</code> 
<code>operative</code> <code>prof1</code> <code>prof2</code> <code>proprietor</code> <code>protective</code> 
<code>sales</code> <code>school</code> <code>service</code> <code>technical</code> <code>not working</code></p>
</dd>
<dt><code>read</code></dt><dd><p>Standardized reading score: a numeric vector</p>
</dd>
<dt><code>write</code></dt><dd><p>Standardized writing score: a numeric vector</p>
</dd>
<dt><code>math</code></dt><dd><p>Standardized math score: a numeric vector</p>
</dd>
<dt><code>sci</code></dt><dd><p>Standardized science score: a numeric vector</p>
</dd>
<dt><code>ss</code></dt><dd><p>Standardized social science (civics) score: a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Tatsuoka, M. M. (1988).  Multivariate Analysis: Techniques for Educational and Psychological Research (2nd ed.).
New York: Macmillan, Appendix F, 430-442.
</p>


<h3>References</h3>

<p>High School and Beyond data files:
<a href="http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/7896">http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/7896</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(HSB)
# main effects model
hsb.mod &lt;- lm( cbind(read, write, math, sci, ss) ~
		gender + race + ses + sch + prog, data=HSB)
Anova(hsb.mod)

# Add some interactions
hsb.mod1 &lt;- update(hsb.mod, . ~ . + gender:race + ses:prog)
heplot(hsb.mod1, col=palette()[c(2,1,3:6)], variables=c("read","math"))

hsb.can1 &lt;- candisc(hsb.mod1, term="race")
heplot(hsb.can1, col=c("red", "black"))

# show canonical results for all terms
## Not run: 
hsb.can &lt;- candiscList(hsb.mod)
hsb.can

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.cancor'>
Canonical Correlation Plots
</h2><span id='topic+plot.cancor'></span>

<h3>Description</h3>

<p>This function produces plots to help visualize X, Y data
in canonical space.
</p>
<p>The present implementation plots the canonical scores for
the Y variables against those for the X variables on given
dimensions. We treat this as a view of the data in canonical
space, and so offer additional annotations to a standard
scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cancor'
plot(x, which = 1, xlim, ylim, xlab, ylab, 
    points = TRUE, add = FALSE, col = palette()[1], 
    ellipse = TRUE, ellipse.args = list(), 
    smooth = FALSE, smoother.args = list(), col.smooth = palette()[3], 
    abline = TRUE, col.lines = palette()[2], lwd = 2,
    labels = rownames(xy),
    id.method = "mahal",  id.n = 0, id.cex = 1, id.col = palette()[1],
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cancor_+3A_x">x</code></td>
<td>

<p>A <code>"cancor"</code> object
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_which">which</code></td>
<td>

<p>Which dimension to plot? An integer in <code>1:x$ndim</code>.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_xlim">xlim</code>, <code id="plot.cancor_+3A_ylim">ylim</code></td>
<td>

<p>Limits for x and y axes
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_xlab">xlab</code>, <code id="plot.cancor_+3A_ylab">ylab</code></td>
<td>

<p>Labels for x and y axes.  If not specified, these are
constructed from the <code>set.names</code> component of <code>x</code>.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_points">points</code></td>
<td>

<p>logical.  Display the points?
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_add">add</code></td>
<td>

<p>logical.  Add to an existing plot?
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_col">col</code></td>
<td>

<p>Color for points.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_ellipse">ellipse</code></td>
<td>

<p>logical. Draw a data ellipse for the canonical scores?
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_ellipse.args">ellipse.args</code></td>
<td>

<p>A list of arguments passed to <code><a href="car.html#topic+dataEllipse">dataEllipse</a></code>.
Internally, the function sets the default value for <code>levels</code> to 0.68.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_smooth">smooth</code></td>
<td>

<p>logical. Draw a (loess) smoothed curve?
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_smoother.args">smoother.args</code></td>
<td>

<p>Arguments passed to <code><a href="car.html#topic+loessLine">loessLine</a></code>,
which should be consulted for details and defaults.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_col.smooth">col.smooth</code></td>
<td>

<p>Color for the smoothed curve.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_abline">abline</code></td>
<td>

<p>logical. Draw the linear regression line for Ycan[,which] on Xcan[,which]?
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_col.lines">col.lines</code></td>
<td>

<p>Color for the linear regression line
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_lwd">lwd</code></td>
<td>

<p>Line widths
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_labels">labels</code></td>
<td>

<p>Point labels for point identification via the <code>id.method</code> argument.
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_id.method">id.method</code></td>
<td>

<p>Method used to identify individual points. See <code><a href="car.html#topic+showLabels">showLabels</a></code>
for details.  The default, <code>id.method = "mahal"</code> identifies the <code>id.n</code> points
furthest from the centroid. 
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_id.n">id.n</code></td>
<td>

<p>Number of points to identify
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_id.cex">id.cex</code>, <code id="plot.cancor_+3A_id.col">id.col</code></td>
<td>

<p>Character size and color for labeled points
</p>
</td></tr>
<tr><td><code id="plot.cancor_+3A_...">...</code></td>
<td>

<p>Other arguments passed down to <code>plot(...)</code> and <code>points(...)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Canonical correlation analysis assumes that the all correlations between
the X and Y variables can be expressed in terms of correlations
the canonical variate pairs,
(Xcan1, Ycan1), (Xcan2, Ycan2), ..., and that the relations between these
pairs are indeed linear. 
</p>
<p>Data ellipses, and smoothed (loess) curves, together with the linear regression
line for each canonical dimension help to assess whether there are
peculiarities in the data that might threaten the validity of CCA.
Point identification methods can be useful to determine influential cases.
</p>


<h3>Value</h3>

<p>None.  Used for its side effect of producing a plot.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).
<em>Multivariate Analysis</em>. London: Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cancor">cancor</a></code>,
</p>
<p><code><a href="car.html#topic+dataEllipse">dataEllipse</a></code>,  <code><a href="car.html#topic+loessLine">loessLine</a></code>, <code><a href="car.html#topic+showLabels">showLabels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Rohwer, package="heplots")
X &lt;- as.matrix(Rohwer[,6:10])  # the PA tests
Y &lt;- as.matrix(Rohwer[,3:5])   # the aptitude/ability variables

cc &lt;- cancor(X, Y, set.names=c("PA", "Ability"))

plot(cc)
# exercise some options
plot(cc, smooth=TRUE, id.n=3, ellipse.args=list(fill=TRUE))
plot(cc, which=2, smooth=TRUE)
plot(cc, which=3, smooth=TRUE)


# plot vectors showing structure correlations of Xcan and Ycan with their own variables
plot(cc)
struc &lt;- cc$structure
Xstruc &lt;- struc$X.xscores[,1]
Ystruc &lt;- struc$Y.yscores[,1]
scale &lt;- 2

# place vectors in the margins of the plot
usr &lt;- matrix(par("usr"), nrow=2, dimnames=list(c("min", "max"), c("x", "y")))
ypos &lt;- usr[2,2] - (1:5)/10 
arrows(0, ypos, scale*Xstruc, ypos, angle=10, len=0.1, col="blue")
text(scale*Xstruc, ypos, names(Xstruc), pos=2, col="blue")

xpos &lt;- usr[2,1] - ( 1 + 1:3)/10
arrows(xpos, 0, xpos, scale*Ystruc, angle=10, len=0.1, col="darkgreen")
text(xpos, scale*Ystruc, names(Ystruc), pos=1, col="darkgreen")

</code></pre>

<hr>
<h2 id='redundancy'>
Canonical Redundancy Analysis
</h2><span id='topic+redundancy'></span><span id='topic+print.cancor.redundancy'></span>

<h3>Description</h3>

<p>Calculates indices of redundancy (Stewart &amp; Love, 1968) from a canonical correlation analysis.
These give the proportion of variances of the variables in each set
(X and Y) which are accounted for by the variables in the other set
through the canonical variates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
redundancy(object, ...)

## S3 method for class 'cancor.redundancy'
print(x, digits = max(getOption("digits") - 3, 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redundancy_+3A_object">object</code></td>
<td>

<p>A <code>"cancor"</code> object
</p>
</td></tr>
<tr><td><code id="redundancy_+3A_x">x</code></td>
<td>

<p>A <code>"cancor.redundancy"</code> for the <code>print</code> method.
</p>
</td></tr>
<tr><td><code id="redundancy_+3A_digits">digits</code></td>
<td>

<p>Number of digits to print
</p>
</td></tr>
<tr><td><code id="redundancy_+3A_...">...</code></td>
<td>

<p>Other arguments 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>None yet.
</p>


<h3>Value</h3>

<p>An object of class <code>"cancor.redundancy"</code>, a list with the following 5 components:
</p>
<table>
<tr><td><code>Xcan.redun</code></td>
<td>
<p>Canonical redundancies for the X variables, i.e., the total fraction of
X variance accounted for by the Y variables through each canonical variate.</p>
</td></tr>
<tr><td><code>Ycan.redun</code></td>
<td>
<p>Canonical redundancies for the Y variables</p>
</td></tr>
<tr><td><code>X.redun</code></td>
<td>
<p>Total canonical redundancy for the X variables, i.e., the sum of
<code>Xcan.redun</code>.</p>
</td></tr>
<tr><td><code>Y.redun</code></td>
<td>
<p>Total canonical redundancy for the Y variables</p>
</td></tr>
<tr><td><code>set.names</code></td>
<td>
<p>names for the X and Y sets of variables</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Stewart, D. and Love, W. (1968). A general canonical correlation index. 
<em>Psychological Bulletin</em>, 70, 160-163.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cancor">cancor</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(Rohwer, package="heplots")
X &lt;- as.matrix(Rohwer[,6:10])  # the PA tests
Y &lt;- as.matrix(Rohwer[,3:5])   # the aptitude/ability variables

cc &lt;- cancor(X, Y, set.names=c("PA", "Ability"))

redundancy(cc)
## 
## Redundancies for the PA variables &amp; total X canonical redundancy
## 
##     Xcan1     Xcan2     Xcan3 total X|Y 
##   0.17342   0.04211   0.00797   0.22350 
## 
## Redundancies for the Ability variables &amp; total Y canonical redundancy
## 
##     Ycan1     Ycan2     Ycan3 total Y|X 
##    0.2249    0.0369    0.0156    0.2774 

</code></pre>

<hr>
<h2 id='varOrder'>
Order variables according to canonical structure or other criteria
</h2><span id='topic+varOrder'></span><span id='topic+varOrder.mlm'></span><span id='topic+varOrder.data.frame'></span>

<h3>Description</h3>

<p>The <code>varOrder</code> function implements some features of &ldquo;effect ordering&rdquo;
(Friendly &amp; Kwan (2003)
for <em>variables</em> in a multivariate data display to make the
displayed relationships more coherent.
</p>
<p>This can be used in pairwise HE plots, scatterplot matrices, parallel
coordinate plots, plots of multivariate means, and so forth.
</p>
<p>For a numeric data frame, the most useful displays often order
variables according to the angles of variable vectors in a
2D principal component analysis or biplot. For a multivariate
linear model, the analog is to use the angles of the variable
vectors in a 2D canonical discriminant biplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
varOrder(x, ...)

## S3 method for class 'mlm'
varOrder(x, term, variables, 
      type = c("can", "pc"), 
      method = c("angles", "dim1", "dim2", "alphabet", "data", "colmean"), 
      names = FALSE, descending = FALSE, ...)

## S3 method for class 'data.frame'
varOrder(x, variables, 
      method = c("angles", "dim1", "dim2", "alphabet", "data", "colmean"),
      names = FALSE, descending = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varOrder_+3A_x">x</code></td>
<td>

<p>A multivariate linear model or a numeric data frame
</p>
</td></tr>
<tr><td><code id="varOrder_+3A_term">term</code></td>
<td>

<p>For the <code>mlm</code> method, one term in the model for which the canonical structure coefficients
are found.
</p>
</td></tr>
<tr><td><code id="varOrder_+3A_variables">variables</code></td>
<td>
<p>indices or names of the variables to be ordered;
defaults to all response variables an MLM or all numeric variables in a data frame.</p>
</td></tr>
<tr><td><code id="varOrder_+3A_type">type</code></td>
<td>

<p>For an MLM, <code>type="can"</code> uses the canonical structure coefficients for the given <code>term</code>;
<code>type="pc"</code> uses the principal component variable eigenvectors.
</p>
</td></tr>
<tr><td><code id="varOrder_+3A_method">method</code></td>
<td>

<p>One of <code>c("angles", "dim1", "dim2", "alphabet", "data", "colmean")</code> giving the effect ordering method.
</p>

<dl>
<dt>&quot;angles&quot;</dt><dd><p>Orders variables according to the angles their vectors make with dimensions 1 and 2, 
counter-clockwise starting from the lower-left quadrant in a 2D biplot or candisc display.</p>
</dd>
<dt>&quot;dim1&quot;</dt><dd><p>Orders variables in increasing order of their coordinates on dimension 1</p>
</dd>
<dt>&quot;dim2&quot;</dt><dd><p>Orders variables in increasing order of their coordinates on dimension 2</p>
</dd>
<dt>&quot;alphabet&quot;</dt><dd><p>Orders variables alphabetically</p>
</dd>
<dt>&quot;data&quot;</dt><dd><p>Uses the order of the variables in the data frame or the list of responses in the MLM</p>
</dd>
<dt>&quot;colmean&quot;</dt><dd><p>Uses the order of the column means of the variables in the data frame or the list of responses in the MLM</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="varOrder_+3A_names">names</code></td>
<td>

<p>logical; if <code>TRUE</code> the effect ordered names of the variables are returned;
otherwise, their indices in <code>variables</code> are returned.
</p>
</td></tr>
<tr><td><code id="varOrder_+3A_descending">descending</code></td>
<td>
<p>If <code>TRUE</code>, the ordered result is reversed to a descending order.</p>
</td></tr>
<tr><td><code id="varOrder_+3A_...">...</code></td>
<td>

<p>Arguments passed to methods
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of integer indices of the variables or a character vector of their names.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Friendly, M. &amp; Kwan, E. (2003).
Effect Ordering for Data Displays,
<em>Computational Statistics and Data Analysis</em>, <b>43</b>, 509-539.
doi: <a href="https://doi.org/10.1016/S0167-9473(02)00290-6">10.1016/S0167-9473(02)00290-6</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Wine, package="candisc")
Wine.mod &lt;- lm(as.matrix(Wine[, -1]) ~ Cultivar, data=Wine)
Wine.can &lt;- candisc(Wine.mod)
plot(Wine.can, ellipse=TRUE)

# pairs.mlm HE plot, variables in given order
pairs(Wine.mod, fill=TRUE, fill.alpha=.1, var.cex=1.5)

order &lt;- varOrder(Wine.mod)
pairs(Wine.mod, variables=order, fill=TRUE, fill.alpha=.1, var.cex=1.5)

</code></pre>

<hr>
<h2 id='vecscale'>
Scale vectors to fill the current plot
</h2><span id='topic+vecscale'></span>

<h3>Description</h3>

<p>Calculates a scale factor so that a collection of vectors nearly fills the current
plot, that is, the longest vector does not extend beyond the plot region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vecscale(vectors, bbox = matrix(par("usr"), 2, 2), origin = c(0, 0), factor = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vecscale_+3A_vectors">vectors</code></td>
<td>

<p>a two-column matrix giving the end points of a collection of vectors
</p>
</td></tr>
<tr><td><code id="vecscale_+3A_bbox">bbox</code></td>
<td>

<p>the bounding box of the containing plot region within which the vectors are to be plotted
</p>
</td></tr>
<tr><td><code id="vecscale_+3A_origin">origin</code></td>
<td>

<p>origin of the vectors
</p>
</td></tr>
<tr><td><code id="vecscale_+3A_factor">factor</code></td>
<td>

<p>maximum length of the rescaled vectors relative to the maximum possible
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scale factor, the multiplier of the vectors
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vectors">vectors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bbox &lt;- matrix(c(-3, 3, -2, 2), 2, 2)
colnames(bbox) &lt;- c("x","y")
rownames(bbox) &lt;- c("min", "max")
bbox

vecs &lt;- matrix( runif(10, -1, 1), 5, 2)

plot(bbox)
arrows(0, 0, vecs[,1], vecs[,2], angle=10, col="red")
(s &lt;- vecscale(vecs))
arrows(0, 0, s*vecs[,1], s*vecs[,2], angle=10)
</code></pre>

<hr>
<h2 id='vectors'>
Draw Labeled Vectors in 2D or 3D
</h2><span id='topic+vectors'></span><span id='topic+vectors3d'></span>

<h3>Description</h3>

<p>Graphics utility functions to draw vectors from an origin to a collection of points
(using <code><a href="graphics.html#topic+arrows">arrows</a></code> in 2D or <code><a href="rgl.html#topic+lines3d">lines3d</a></code> in 3D)
with labels for each (using <code><a href="graphics.html#topic+text">text</a></code> or <code><a href="rgl.html#topic+texts3d">texts3d</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vectors(x, origin = c(0, 0), labels = rownames(x), 
    scale = 1, 
    col="blue",
    lwd=1, cex=1,
    length=.1, angle=13, pos=NULL,	
    ...)

vectors3d(x, origin=c(0,0,0), labels=rownames(x), 
    scale=1, 
    col="blue", 
    lwd=1, cex=1,
    ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vectors_+3A_x">x</code></td>
<td>

<p>A two-column matrix or a three-column matrix containing the end points of the vectors
</p>
</td></tr>
<tr><td><code id="vectors_+3A_origin">origin</code></td>
<td>
<p>Starting point(s) for the vectors</p>
</td></tr>
<tr><td><code id="vectors_+3A_labels">labels</code></td>
<td>
<p>Labels for the vectors</p>
</td></tr>
<tr><td><code id="vectors_+3A_scale">scale</code></td>
<td>
<p>A multiplier for the length of each vector</p>
</td></tr>
<tr><td><code id="vectors_+3A_col">col</code></td>
<td>
<p>color(s) for the vectors.</p>
</td></tr>
<tr><td><code id="vectors_+3A_lwd">lwd</code></td>
<td>
<p>line width(s) for the vectors.</p>
</td></tr>
<tr><td><code id="vectors_+3A_cex">cex</code></td>
<td>
<p>color(s) for the vectors.</p>
</td></tr>
<tr><td><code id="vectors_+3A_length">length</code></td>
<td>

<p>For <code>vectors</code>, length of the edges of the arrow head (in inches).
</p>
</td></tr>
<tr><td><code id="vectors_+3A_angle">angle</code></td>
<td>

<p>For <code>vectors</code>, angle from the shaft of the arrow to the edge of the arrow head.
</p>
</td></tr>
<tr><td><code id="vectors_+3A_pos">pos</code></td>
<td>

<p>For <code>vectors</code>, position of the text label relative to the vector head.
If <code>pos==NULL</code>, labels are positioned labels outside, relative to arrow ends.
</p>
</td></tr>
<tr><td><code id="vectors_+3A_...">...</code></td>
<td>

<p>other graphical parameters, such as <code>lty</code>,  <code>xpd</code>, ... 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The graphical parameters <code>col</code>, <code>lty</code> and <code>lwd</code> 
can be vectors of length greater than one and will be recycled if necessary
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+arrows">arrows</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+segments">segments</a></code>
</p>
<p><code><a href="rgl.html#topic+lines3d">lines3d</a></code>,
<code><a href="rgl.html#topic+texts3d">texts3d</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(c(-3, 3), c(-3,3), type="n")
X &lt;- matrix(rnorm(10), ncol=2)
rownames(X) &lt;- LETTERS[1:5]
vectors(X, scale=2, col=palette())

</code></pre>

<hr>
<h2 id='Wilks'>
Wilks Lambda Tests for Canonical Correlations
</h2><span id='topic+Wilks'></span><span id='topic+Wilks.cancor'></span><span id='topic+Wilks.candisc'></span>

<h3>Description</h3>

<p>Tests the sequential hypotheses that the <code class="reqn">i</code>th canonical correlation and all
that follow it are zero,
</p>
<p style="text-align: center;"><code class="reqn">\rho_i = \rho_{i+1} = \cdots = 0</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>
Wilks(object, ...)

## S3 method for class 'cancor'
Wilks(object, ...)
## S3 method for class 'candisc'
Wilks(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wilks_+3A_object">object</code></td>
<td>

<p>An object of class <code>"cancor""} or \code{"candisc""</code>
</p>
</td></tr>
<tr><td><code id="Wilks_+3A_...">...</code></td>
<td>

<p>Other arguments passed to methods (not used)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wilks' Lambda values are calculated from the eigenvalues and converted to F statistics using Rao's 
approximation.  
</p>


<h3>Value</h3>

<p>A data.frame (of class <code>"anova"</code>) containing the test statistics
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979).
<em>Multivariate Analysis</em>. London: Academic Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cancor">cancor</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Rohwer, package="heplots")
X &lt;- as.matrix(Rohwer[,6:10])  # the PA tests
Y &lt;- as.matrix(Rohwer[,3:5])   # the aptitude/ability variables

cc &lt;- cancor(X, Y, set.names=c("PA", "Ability"))
Wilks(cc)

iris.mod &lt;- lm(cbind(Petal.Length, Sepal.Length, Petal.Width, Sepal.Width) ~ Species, data=iris)
iris.can &lt;- candisc(iris.mod, data=iris)
Wilks(iris.can)

</code></pre>

<hr>
<h2 id='Wine'>
Chemical composition of three cultivars of wine 
</h2><span id='topic+Wine'></span>

<h3>Description</h3>

<p>These data are the results of a chemical analysis of wines grown in the same region in Italy 
but derived from three different cultivars. 
The analysis determined the quantities of 13 constituents found in each of the three types of wines.
</p>
<p>This data set is a classic in the machine learning literature as an easy high-D classification
problem, but is also of interest for examples of MANOVA and discriminant analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Wine")</code></pre>


<h3>Format</h3>

<p>A data frame with 178 observations on the following 14 variables.
</p>

<dl>
<dt><code>Cultivar</code></dt><dd><p>a factor with levels <code>barolo</code> <code>grignolino</code> <code>barbera</code></p>
</dd>
<dt><code>Alcohol</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>MalicAcid</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Ash</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>AlcAsh</code></dt><dd><p>a numeric vector, Alkalinity of ash</p>
</dd>
<dt><code>Mg</code></dt><dd><p>a numeric vector, Magnesium</p>
</dd>
<dt><code>Phenols</code></dt><dd><p>a numeric vector, Total phenols</p>
</dd>
<dt><code>Flav</code></dt><dd><p>a numeric vector, Flavanoids</p>
</dd>
<dt><code>NonFlavPhenols</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Proa</code></dt><dd><p>a numeric vector, Proanthocyanins</p>
</dd>
<dt><code>Color</code></dt><dd><p>a numeric vector, color intensity</p>
</dd>
<dt><code>Hue</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>OD</code></dt><dd><p>a numeric vector, OD280/OD315 of diluted wines</p>
</dd>
<dt><code>Proline</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The precise definitions of these variables is unknown: units, how they were measured,
etc. 
</p>


<h3>Source</h3>

<p>This data set was obtained from the UCI Machine Learning Repository,
<code>http://archive.ics.uci.edu/ml/datasets/Wine</code>.
This page references a large number of papers that use this data set
to compare different methods.
</p>


<h3>References</h3>

<p>In R, a comparable data set is contained in the <span class="pkg">ggbiplot</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Wine)
str(Wine)
#summary(Wine)

Wine.mlm &lt;- lm(as.matrix(Wine[, -1]) ~ Cultivar, data=Wine)
Wine.can &lt;- candisc(Wine.mlm)
Wine.can


plot(Wine.can, ellipse=TRUE)
plot(Wine.can, which=1)


</code></pre>

<hr>
<h2 id='Wolves'>Wolf skulls </h2><span id='topic+Wolves'></span>

<h3>Description</h3>

<p>Skull morphometric data on Rocky Mountain and Arctic
wolves (Canis Lupus L.) taken from Morrison (1990),
originally from Jolicoeur (1959). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Wolves)</code></pre>


<h3>Format</h3>

<p>A data frame with 25 observations on the following 11 variables.
</p>

<dl>
<dt><code>group</code></dt><dd><p>a factor with levels <code>ar:f</code> <code>ar:m</code> <code>rm:f</code> <code>rm:m</code>,
comprising the combinations of <code>location</code> and <code>sex</code></p>
</dd>
<dt><code>location</code></dt><dd><p>a factor with levels <code>ar</code>=Arctic, <code>rm</code>=Rocky Mountain</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>f</code>=female, <code>m</code>=male</p>
</dd>
<dt><code>x1</code></dt><dd><p>palatal length, a numeric vector</p>
</dd>
<dt><code>x2</code></dt><dd><p>postpalatal length, a numeric vector</p>
</dd>
<dt><code>x3</code></dt><dd><p>zygomatic width, a numeric vector</p>
</dd>
<dt><code>x4</code></dt><dd><p>palatal width outside first upper molars, a numeric vector</p>
</dd>
<dt><code>x5</code></dt><dd><p>palatal width inside second upper molars, a numeric vector</p>
</dd>
<dt><code>x6</code></dt><dd><p>postglenoid foramina width, a numeric vector</p>
</dd>
<dt><code>x7</code></dt><dd><p>interorbital width, a numeric vector</p>
</dd>
<dt><code>x8</code></dt><dd><p>braincase width, a numeric vector</p>
</dd>
<dt><code>x9</code></dt><dd><p>crown length, a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>All variables are expressed in millimeters. 
</p>
<p>The goal was to determine how geographic and sex differences among the wolf
populations are determined by these skull measurements. 
For MANOVA or (canonical) discriminant analysis, the factors <code>group</code>
or <code>location</code> and <code>sex</code> provide alternative
parameterizations.
</p>


<h3>Source</h3>

<p>Morrison, D. F.  <em>Multivariate Statistical Methods</em>,  (3rd ed.), 1990. 
New York: McGraw-Hill, p. 288-289.
</p>


<h3>References</h3>

<p>Jolicoeur, P. &ldquo;Multivariate geographical variation in the wolf <em>Canis lupis L.</em>&rdquo;,
<em>Evolution</em>, XIII, 283&ndash;299.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Wolves)

# using group
wolf.mod &lt;-lm(cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9) ~ group, data=Wolves)
Anova(wolf.mod)

wolf.can &lt;-candisc(wolf.mod)
plot(wolf.can)
heplot(wolf.can)

# using location, sex
wolf.mod2 &lt;-lm(cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9) ~ location*sex, data=Wolves)
Anova(wolf.mod2)

wolf.can2 &lt;-candiscList(wolf.mod2)
plot(wolf.can2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
