<!DOCTYPE html><html lang="en"><head><title>Help for package cases</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cases}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cases'><p><code>cases</code> package</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#categorize'><p>Categorize continuous values</p></a></li>
<li><a href='#compare'><p>Compare predictions and labels</p></a></li>
<li><a href='#cormat_ar1'><p>Create an AR(1) correlation matrix</p></a></li>
<li><a href='#cormat_equi'><p>Create an equicorrelation matrix</p></a></li>
<li><a href='#data_wdbc'><p>Breast Cancer Wisconsin (Diagnostic) Data Set</p></a></li>
<li><a href='#define_contrast'><p>Define a contrast (matrix) to specify exact hypothesis system</p></a></li>
<li><a href='#draw_data'><p>Generate binary data</p></a></li>
<li><a href='#draw_data_lfc'><p>Generate binary data (LFC model)</p></a></li>
<li><a href='#draw_data_prb'><p>Sample binary data (single sample)</p></a></li>
<li><a href='#draw_data_roc'><p>Generate binary data (ROC model)</p></a></li>
<li><a href='#evaluate'><p>Evaluate the accuracy of multiple (candidate) classifiers in several subgroups</p></a></li>
<li><a href='#generate_instance_lfc'><p>Generate data sets under least favorable parameter configurations</p></a></li>
<li><a href='#generate_instance_roc'><p>Generate data sets under realistic parameter configurations</p></a></li>
<li><a href='#process_instance'><p>Analyze simulated synthetic datasets.</p></a></li>
<li><a href='#visualize'><p>Visualize evaluation results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stratified Evaluation of Subgroup Classification Accuracy</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Enables simultaneous statistical inference for the accuracy of multiple classifiers in multiple subgroups (strata). For instance, allows to perform multiple comparisons in diagnostic accuracy studies with co-primary endpoints sensitivity and specificity (Westphal M, Zapf A. Statistical inference for diagnostic test accuracy studies with multiple comparisons. Statistical Methods in Medical Research. 2024;0(0). &lt;<a href="https://doi.org/10.1177%2F09622802241236933">doi:10.1177/09622802241236933</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>bindata, boot, copula, corrplot, dplyr, extraDistr, magrittr,
Matrix, multcomp, mvtnorm, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, covr, badger, glmnet,
splitstackshape</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/maxwestphal/cases">https://github.com/maxwestphal/cases</a>,
<a href="https://maxwestphal.github.io/cases/">https://maxwestphal.github.io/cases/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/maxwestphal/cases/issues">https://github.com/maxwestphal/cases/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-08 07:22:51 UTC; maxwe</td>
</tr>
<tr>
<td>Author:</td>
<td>Max Westphal <a href="https://orcid.org/0000-0002-8488-758X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Max Westphal &lt;dev@maxwestphal.io&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-09 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cases'><code>cases</code> package</h2><span id='topic+cases'></span><span id='topic+cases-package'></span>

<h3>Description</h3>

<p>Enables simultaneous statistical inference for the accuracy of multiple classifiers
in multiple subgroups (strata). For instance, allows to perform multiple comparisons
in diagnostic accuracy studies with co-primary endpoints
sensitivity (true positive rate, TPR) and specificity (true negative rate, TNR).
</p>


<h3>Details</h3>

<p>The package functionality and syntax is described in the vignettes, see examples.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Max Westphal <a href="mailto:dev@maxwestphal.io">dev@maxwestphal.io</a> (<a href="https://orcid.org/0000-0002-8488-758X">ORCID</a>)
</p>


<h3>References</h3>

<p>Westphal M, Zapf A.
Statistical inference for diagnostic test accuracy studies with multiple comparisons.
Statistical Methods in Medical Research. 2024;0(0).
<a href="https://journals.sagepub.com/doi/full/10.1177/09622802241236933">doi:10.1177/09622802241236933</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/maxwestphal/cases">https://github.com/maxwestphal/cases</a>
</p>
</li>
<li> <p><a href="https://maxwestphal.github.io/cases/">https://maxwestphal.github.io/cases/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/maxwestphal/cases/issues">https://github.com/maxwestphal/cases/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># overview over package functionality:
vignette("package_overview")

# a real-world data example:
vignette("example_wdbc")

</code></pre>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>the value to be piped in <code>rhs</code></p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>the function to be applied with first argument <code>lhs</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the result of <code>rhs(lhs, ...)</code>
</p>

<hr>
<h2 id='categorize'>Categorize continuous values</h2><span id='topic+categorize'></span>

<h3>Description</h3>

<p>This function allows to split continuous values, e.g. (risk) scores or (bio)markers,
into two or more categories by specifying one or more cutoff values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorize(
  values,
  cutoffs = rep(0, ncol(values)),
  map = 1:ncol(values),
  labels = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="categorize_+3A_values">values</code></td>
<td>
<p>(matrix) <br /> numeric matrix of continuous values to be categorized.
Assume an (n x r) matrix with n observations (subjects) of r continuous values.</p>
</td></tr>
<tr><td><code id="categorize_+3A_cutoffs">cutoffs</code></td>
<td>
<p>(numeric | matrix) <br /> numeric matrix of dimension m x k. Each row of cutoffs defines a split
into k+1 distinct categories. Each row must contain distinct values. In the simplest case (k=1),
cutoffs is a single column matrix whereby each row defines a binary split (&lt;=t vs. &gt;t).
In this case (k=1), cutoffs can also be a numeric vector.</p>
</td></tr>
<tr><td><code id="categorize_+3A_map">map</code></td>
<td>
<p>(numeric) <br /> integer vector of length k with values in 1:r, whereby r = ncol(values).
map_l gives the value which column of values should be categorized by ...</p>
</td></tr>
<tr><td><code id="categorize_+3A_labels">labels</code></td>
<td>
<p>(character) <br /> character of length m (= number of prediction r)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(matrix) <br /> numeric (n x k) matrix with categorical outcomes after categorizing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
M &lt;- as.data.frame(mvtnorm::rmvnorm(20, mean = rep(0, 3), sigma = 2 * diag(3)))
M
categorize(M)
C &lt;- matrix(rep(c(-1, 0, 1, -2, 0, 2), 3), ncol = 3, byrow = TRUE)
C
w &lt;- c(1, 1, 2, 2, 3, 3)
categorize(M, C, w)
</code></pre>

<hr>
<h2 id='compare'>Compare predictions and labels</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>Compare predictions and labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(
  predictions,
  labels,
  partition = TRUE,
  names = c(specificity = 0, sensitivity = 1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_predictions">predictions</code></td>
<td>
<p>(numeric | character) <br /> vector of class predictions, class and unique values+
need to match those of <code>labels</code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_labels">labels</code></td>
<td>
<p>(numeric | character) <br /> vector of true class labels (reference standard)</p>
</td></tr>
<tr><td><code id="compare_+3A_partition">partition</code></td>
<td>
<p>(logical) <br /> should result be split into one matrix per class (TRUE; default) or not (FALSE)</p>
</td></tr>
<tr><td><code id="compare_+3A_names">names</code></td>
<td>
<p>(character | NULL) <br /> named character. Values specify data values, names specify class names.
If <code>names=NULL</code>, the values and names are defined as <code>unique(labels)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>(list | matrix) <br /> list of matrices (one for each unique value of <code>labels</code>) with
values 1 (correct prediction) and 0 (false prediction).
If <code>partition=TRUE</code>, the matrices are combined in a single matrix with <code>rbind</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred &lt;- matrix(c(1, 1, 0), 5, 3)
labels &lt;- c(1, 1, 0, 0, 1)
compare(pred, labels, FALSE)
compare(pred, labels, TRUE)
</code></pre>

<hr>
<h2 id='cormat_ar1'>Create an AR(1) correlation matrix</h2><span id='topic+cormat_ar1'></span>

<h3>Description</h3>

<p>Create an AR(1) correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat_ar1(m, rho, d = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cormat_ar1_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> dimensions of the (square) matrix</p>
</td></tr>
<tr><td><code id="cormat_ar1_+3A_rho">rho</code></td>
<td>
<p>(numeric) <br /> correlation parameter in (0,1)</p>
</td></tr>
<tr><td><code id="cormat_ar1_+3A_d">d</code></td>
<td>
<p>(logical | numeric) <br /> binary vector of length m, whereby TRUE/FALSE (alternatively 1/0)
indicate active/inactive components of underlying random vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(matrix) <br />
AR(1) correlation matrix R with entries <code class="reqn">R_{ij} = \rho^{|i-j|}</code>
</p>

<hr>
<h2 id='cormat_equi'>Create an equicorrelation matrix</h2><span id='topic+cormat_equi'></span>

<h3>Description</h3>

<p>Create an equicorrelation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat_equi(m, rho, d = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cormat_equi_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> dimensions of the (square) matrix</p>
</td></tr>
<tr><td><code id="cormat_equi_+3A_rho">rho</code></td>
<td>
<p>(numeric) <br /> correlation parameter in (0,1)</p>
</td></tr>
<tr><td><code id="cormat_equi_+3A_d">d</code></td>
<td>
<p>(logical | numeric) <br /> binary vector of length m, whereby TRUE/FALSE (alternatively 1/0)
indicate active/inactive components of underlying random vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(matrix) <br />
AR(1) correlation matrix R with entries <code class="reqn">R_{ij} = \rho, i\neq j</code>
</p>

<hr>
<h2 id='data_wdbc'>Breast Cancer Wisconsin (Diagnostic) Data Set</h2><span id='topic+data_wdbc'></span>

<h3>Description</h3>

<p>Dataset documentation can be found at the source website and references below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_wdbc
</code></pre>


<h3>Format</h3>



<h4><code>data_wdbc</code></h4>

<p>A data frame with 569 rows (patients) and 31 columns (1 target, 30 features).
</p>



<h3>Details</h3>

<p>The ID variable was removed.
Diagnosis (1= malignant, 0 = benign).
Feature variables have been renamed.
</p>


<h3>Source</h3>

<p><a href="https://archive.ics.uci.edu/ml/datasets/breast+cancer+wisconsin+(diagnostic)">https://archive.ics.uci.edu/ml/datasets/breast+cancer+wisconsin+(diagnostic)</a>
</p>


<h3>References</h3>


<ul>
<li><p> W.N. Street, W.H. Wolberg and O.L. Mangasarian. Nuclear feature extraction for breast tumor diagnosis. IS&amp;T/SPIE 1993 International Symposium on Electronic Imaging: Science and Technology, volume 1905, pages 861-870, San Jose, CA, 1993.
</p>
</li>
<li><p> O.L. Mangasarian, W.N. Street and W.H. Wolberg. Breast cancer diagnosis and prognosis via linear programming. Operations Research, 43(4), pages 570-577, July-August 1995.
</p>
</li></ul>


<hr>
<h2 id='define_contrast'>Define a contrast (matrix) to specify exact hypothesis system</h2><span id='topic+define_contrast'></span>

<h3>Description</h3>

<p>Define a contrast (matrix) to specify exact hypothesis system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_contrast(type = c("raw", "one", "all"), comparator = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="define_contrast_+3A_type">type</code></td>
<td>
<p>(character) <br /> either &quot;raw&quot;, &quot;one&quot; or &quot;all&quot;, see details.</p>
</td></tr>
<tr><td><code id="define_contrast_+3A_comparator">comparator</code></td>
<td>
<p>(numeric | character) <br /> either integer (index of comparator) or character (name of comparator)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> &quot;raw&quot; contrast: compare all candidates against specified benchmark values
</p>
</li>
<li><p> &quot;one&quot; ('all vs. one' or 'Dunnett') contrast: compare all candidates to a single comparator.
</p>
</li>
<li><p> &quot;all&quot; ('all vs. all' or 'Tukey') contrast: compare all candidates against each other.
</p>
</li></ul>



<h3>Value</h3>

<p>(<code>cases_contrast</code>) <br /> object to be passed to <code><a href="#topic+evaluate">evaluate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>define_contrast("one", 1)
</code></pre>

<hr>
<h2 id='draw_data'>Generate binary data</h2><span id='topic+draw_data'></span>

<h3>Description</h3>

<p>Generate binary data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_data(
  n = 200,
  prev = c(0.5, 0.5),
  random = FALSE,
  m = 10,
  method = c("roc", "lfc", "pr"),
  pars = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_data_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> integer, overall sample size</p>
</td></tr>
<tr><td><code id="draw_data_+3A_prev">prev</code></td>
<td>
<p>(numeric) <br /> vector of class prevalences (adding up to 1)</p>
</td></tr>
<tr><td><code id="draw_data_+3A_random">random</code></td>
<td>
<p>(logical) <br /> random sampling (TRUE) or fixed group sample sizes (FALSE)</p>
</td></tr>
<tr><td><code id="draw_data_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> integer, number of models</p>
</td></tr>
<tr><td><code id="draw_data_+3A_method">method</code></td>
<td>
<p>(character) <br /> either &quot;roc&quot;, &quot;lfc&quot; (multiple subgroups) or &quot;prob&quot; (no subgroups)</p>
</td></tr>
<tr><td><code id="draw_data_+3A_pars">pars</code></td>
<td>
<p>(list) <br /> containing further named parameters passed to <code><a href="#topic+draw_data_roc">draw_data_roc</a></code>,
<code><a href="#topic+draw_data_lfc">draw_data_lfc</a></code></p>
</td></tr>
<tr><td><code id="draw_data_+3A_...">...</code></td>
<td>
<p>(any) <br /> further named parameters passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(matrix) <br /> generated binary data (possibly stratified for subgroups)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draw_data()
</code></pre>

<hr>
<h2 id='draw_data_lfc'>Generate binary data (LFC model)</h2><span id='topic+draw_data_lfc'></span>

<h3>Description</h3>

<p>Generate binary data (LFC model)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_data_lfc(
  n = 100,
  prev = c(0.5, 0.5),
  random = FALSE,
  m = 10,
  se = 0.8,
  sp = 0.8,
  B = round(m/2),
  L = 1,
  Rse = diag(rep(1, m)),
  Rsp = diag(rep(1, m)),
  modnames = paste0("model", 1:m),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_data_lfc_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> integer, total sample size</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_prev">prev</code></td>
<td>
<p>(numeric) <br /> disease and healthy prevalence (length 2, adds up to 1)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_random">random</code></td>
<td>
<p>(logical) <br /> random sampling (TRUE) or fixed prevalence (FALSE)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> integer, number of models</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_se">se</code></td>
<td>
<p>(numeric) <br /> sensitivity (length 1)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_sp">sp</code></td>
<td>
<p>(numeric) <br /> specificity (length 1)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_b">B</code></td>
<td>
<p>(numeric) <br /> integer, between 1 and m, specifies how many sensitivity values are projected to 1</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_l">L</code></td>
<td>
<p>(numeric) <br /> worst alternative is computed under side condition Acc &lt;= L
(default value L=1 corresponds to true LFC where values are projected to 1)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_rse">Rse</code></td>
<td>
<p>(matrix) <br /> correlation matrix for empirical sensitivities (m x m)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_rsp">Rsp</code></td>
<td>
<p>(maxtrix) <br /> correlation matrix for empirical specificities (m x m)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_modnames">modnames</code></td>
<td>
<p>(modnames) <br /> character, model names (length m)</p>
</td></tr>
<tr><td><code id="draw_data_lfc_+3A_...">...</code></td>
<td>
<p>(any) <br /> further arguments (currently unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(list) <br /> list of matrices including generated binary datasets
(1: correct prediction, 0: incorrect prediction) for each subgroup (specificity, sensitivity)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- draw_data_lfc()
head(data)
</code></pre>

<hr>
<h2 id='draw_data_prb'>Sample binary data (single sample)</h2><span id='topic+draw_data_prb'></span>

<h3>Description</h3>

<p>This function is wrapper for <code><a href="bindata.html#topic+rmvbin">rmvbin</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_data_prb(n = 100, pr = c(0.8, 0.8), R = diag(length(pr)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_data_prb_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> integer, sample size</p>
</td></tr>
<tr><td><code id="draw_data_prb_+3A_pr">pr</code></td>
<td>
<p>(numeric) <br /> vector with marginal success probabilities</p>
</td></tr>
<tr><td><code id="draw_data_prb_+3A_r">R</code></td>
<td>
<p>(matrix) <br /> square correlation matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(matrix) <br /> matrix with n rows and length(pr) columns of randomly generated binary (0, 1) data
</p>

<hr>
<h2 id='draw_data_roc'>Generate binary data (ROC model)</h2><span id='topic+draw_data_roc'></span>

<h3>Description</h3>

<p>Generate binary data (ROC model)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_data_roc(
  n = 100,
  prev = c(0.5, 0.5),
  random = FALSE,
  m = 10,
  auc = seq(0.85, 0.95, length.out = 5),
  rho = c(0.25, 0.25),
  dist = c("normal", "exponential"),
  e = 10,
  k = 100,
  delta = 0,
  modnames = paste0("model", 1:m),
  corrplot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="draw_data_roc_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> total sample size</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_prev">prev</code></td>
<td>
<p>(numeric) <br /> disease and healthy prevalence (adds up to 1)</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_random">random</code></td>
<td>
<p>(logical) <br /> random sampling (TRUE) or fixed prevalence (FALSE)</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> integer, number of models</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_auc">auc</code></td>
<td>
<p>(numeric) <br /> vector of AUCs of biomarkers</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_rho">rho</code></td>
<td>
<p>(numeric) <br /> vector (length 2) of correlations between biomarkers</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_dist">dist</code></td>
<td>
<p>(character) <br /> either &quot;normal&quot; or &quot;exponential&quot; specifying the subgroup biomarker distributions</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_e">e</code></td>
<td>
<p>(numeric) <br /> emulates better (worse) model selection quality with higher (lower) values of e</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_k">k</code></td>
<td>
<p>(numeric) <br /> technical parameter which adjusts grid size</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_delta">delta</code></td>
<td>
<p>(numeric) <br /> specify importance of sensitivity and specificity (default 0)</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_modnames">modnames</code></td>
<td>
<p>(character) <br /> model names (length m)</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_corrplot">corrplot</code></td>
<td>
<p>(logical) <br /> if TRUE do not return data but instead plot correlation
matrices for final binary data  (default: FALSE)</p>
</td></tr>
<tr><td><code id="draw_data_roc_+3A_...">...</code></td>
<td>
<p>(any) <br /> further arguments (currently unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(list) <br /> list of matrices including generated binary datasets
(1: correct prediction, 0: incorrect prediction) for each subgroup (specificity, sensitivity)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- draw_data_roc()
head(data)
</code></pre>

<hr>
<h2 id='evaluate'>Evaluate the accuracy of multiple (candidate) classifiers in several subgroups</h2><span id='topic+evaluate'></span>

<h3>Description</h3>

<p>Assess classification accuracy of multiple classifcation rules stratified
by subgroups, e.g. in diseased (sensitivity) and healthy (specificity)
individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate(
  data,
  contrast = define_contrast("raw"),
  benchmark = 0.5,
  alpha = 0.05,
  alternative = c("two.sided", "greater", "less"),
  adjustment = c("none", "bonferroni", "maxt", "bootstrap", "mbeta"),
  transformation = c("none", "logit", "arcsin"),
  analysis = c("co-primary", "full"),
  regu = FALSE,
  pars = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate_+3A_data">data</code></td>
<td>
<p>(list) <br /> of n_g x m binary matrix or data.frame (n_g observations of m binary decisions),
g is the index of subgroups/classes, usually created via <code><a href="#topic+compare">compare</a></code>.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_contrast">contrast</code></td>
<td>
<p>(<code>cases_contrast</code>) <br /> specified via <code><a href="#topic+define_contrast">define_contrast</a></code></p>
</td></tr>
<tr><td><code id="evaluate_+3A_benchmark">benchmark</code></td>
<td>
<p>(numeric) <br /> value to compare against (RHS), should have same length as data.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_alpha">alpha</code></td>
<td>
<p>(numeric) <br /> significance level (default: 0.05)</p>
</td></tr>
<tr><td><code id="evaluate_+3A_alternative">alternative</code></td>
<td>
<p>(character) <br /> specification of alternative hypothesis</p>
</td></tr>
<tr><td><code id="evaluate_+3A_adjustment">adjustment</code></td>
<td>
<p>(character) <br /> specification of statistical adjustment taken to address multiplicity.
The default 'none' does not perform any adjustment for multiplicity.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_transformation">transformation</code></td>
<td>
<p>(character) <br /> define transformation to ensure results
(e.g. point estimates, confidence limits) lie in unit interval (&quot;none&quot; (default), &quot;logit&quot;, or &quot;arcsin&quot; (sqrt))</p>
</td></tr>
<tr><td><code id="evaluate_+3A_analysis">analysis</code></td>
<td>
<p>(character) <br /> &quot;co-primary&quot; or &quot;full&quot;</p>
</td></tr>
<tr><td><code id="evaluate_+3A_regu">regu</code></td>
<td>
<p>(numeric | logical) <br /> vector of length 3, specify type of shrinkage.
Alternatively, logical of length one (TRUE := c(1, 1/2, 1/4), FALSE := c(0, 0, 0))</p>
</td></tr>
<tr><td><code id="evaluate_+3A_pars">pars</code></td>
<td>
<p>(list) <br /> further parameters given as named list list(type=&quot;pairs&quot;, nboot=2000)</p>
</td></tr>
<tr><td><code id="evaluate_+3A_...">...</code></td>
<td>
<p>(any) <br /> additional named parameters, can be used instead of (in in conjunction with) <code>pars</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adjustment methods (<code>adjustment</code>) and additional parameters (<code>pars</code> or <code>...</code>):<br />
</p>
<p><strong>&quot;none&quot;</strong> (default): no adjustment for multiplicity<br />
</p>
<p><strong>&quot;bonferroni&quot;</strong>: Bonferroni adjustment<br />
</p>
<p><strong>&quot;maxt&quot;</strong>: maxT adjustment, based on a multivariate normal approximation of the vector of test statistics<br />
</p>
<p><strong>&quot;bootstrap&quot;</strong>: Bootstrap approach
</p>

<ul>
<li><p> nboot: number of bootstrap draws (default: 2000)
</p>
</li>
<li><p> type: type of bootstrap, &quot;pairs&quot; (default) or &quot;wild&quot;
</p>
</li>
<li><p> dist: residual distribution for wild bootstrap, &quot;Normal&quot; (default) or &quot;Rademacher&quot;
</p>
</li>
<li><p> proj_est: should bootstrapped estimates for wild bootstrap be projected into unit interval? (default: TRUE)
</p>
</li>
<li><p> res_tra: type of residual transformation for wild boostrap, 0,1,2 or 3 (default: 0 = no transformation)
(for details on res_tra options, see this presentation by
<a href="https://www.math.kth.se/matstat/gru/sf2930/papers/wild.bootstrap.pdf">James G. MacKinnon (2012)</a> and references therein)
</p>
</li></ul>

<p><strong>&quot;mbeta&quot;</strong>: A heuristic Bayesian approach which is based on a multivariate beta-binomial model.
</p>

<ul>
<li><p> nrep: number of posterior draws (default: 5000)
</p>
</li>
<li><p> lfc_pr: prior probability of 'least-favorable parameter configuration' (default: 1 if analysis == &quot;co-primary&quot;, 0 if analysis == &quot;full&quot;).
</p>
</li></ul>



<h3>Value</h3>

<p>(<code>cases_results</code>) <br />
list of analysis results including (adjusted) confidence intervals and p-values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
data &lt;- draw_data_roc()
evaluate(data)
</code></pre>

<hr>
<h2 id='generate_instance_lfc'>Generate data sets under least favorable parameter configurations</h2><span id='topic+generate_instance_lfc'></span>

<h3>Description</h3>

<p>Generates a (simulation) instance, a list of multiple datasets to be processed
(analyzed) with <a href="#topic+process_instance">process_instance</a>. Ground truth parameters (Sensitvity &amp; Specificity) are
least-favorable in the sense that the type-I error rate of the subsequently applied
multiple test procedures is maximized.
</p>
<p><strong>This function is only needed for simulation via batchtools, not relevant in interactive use!</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_instance_lfc(
  nrep = 10,
  n = 100,
  prev = 0.5,
  random = FALSE,
  m = 10,
  se = 0.8,
  sp = 0.8,
  L = 1,
  rhose = 0,
  rhosp = 0,
  cortype = "equi",
  ...,
  data = NULL,
  job = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_instance_lfc_+3A_nrep">nrep</code></td>
<td>
<p>(numeric) <br /> integer, number of instances</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> integer, total sample size</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_prev">prev</code></td>
<td>
<p>(numeric) <br /> disease prevalence</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_random">random</code></td>
<td>
<p>(logical) <br /> fixed prevalence (FALSE) or simple random sampling (TRUE)</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> integer, number of candidates</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_se">se</code></td>
<td>
<p>(numeric) <br /> sensitivity</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_sp">sp</code></td>
<td>
<p>(numeric) <br /> specificity</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_l">L</code></td>
<td>
<p>(numeric) <br /> worst alternative is computed under side condition Acc &lt;= L</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_rhose">rhose</code></td>
<td>
<p>(numeric) <br /> correlation parameter for sensitivity</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_rhosp">rhosp</code></td>
<td>
<p>(numeric) <br /> correlation parameter for specificity</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_cortype">cortype</code></td>
<td>
<p>(character) <br />  correlation type (&quot;equi&quot; or &quot;ak1&quot;)</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_...">...</code></td>
<td>
<p>(any) <br /> further (named) arguments</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_data">data</code></td>
<td>
<p>(NULL) <br /> ignored (for batchtools compatibility)</p>
</td></tr>
<tr><td><code id="generate_instance_lfc_+3A_job">job</code></td>
<td>
<p>(NULL) <br /> ignored (for batchtools compatibility)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Utilizes same arguments as <a href="#topic+draw_data_lfc">draw_data_lfc</a> unless mentioned otherwise above.
</p>


<h3>Value</h3>

<p>(list) <br /> a single (LFC) simulation instance of length <code>nrep</code>
</p>

<hr>
<h2 id='generate_instance_roc'>Generate data sets under realistic parameter configurations</h2><span id='topic+generate_instance_roc'></span>

<h3>Description</h3>

<p>Generates a (simulation) instance, a list of multiple datasets to be processed
(analyzed) with <a href="#topic+process_instance">process_instance</a>. Ground truth parameters (Sensitvity &amp; Specificity) are
initially generated according to a generative model whereby multiple decision rules (with
different parameter values) are derived by thresholding multiple biomarkers.
</p>
<p><strong>This function is only needed for simulation via batchtools, not relevant in interactive use!</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_instance_roc(
  nrep = 10,
  n = 100,
  prev = 0.5,
  random = FALSE,
  m = 10,
  auc = "seq(0.85, 0.95, length.out = 5)",
  rhose = 0.5,
  rhosp = 0.5,
  dist = "normal",
  e = 10,
  k = 100,
  delta = 0,
  ...,
  data = NULL,
  job = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_instance_roc_+3A_nrep">nrep</code></td>
<td>
<p>(numeric) <br /> integer, number of instances</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_n">n</code></td>
<td>
<p>(numeric) <br /> integer, total sample size</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_prev">prev</code></td>
<td>
<p>(numeric) <br /> disease prevalence</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_random">random</code></td>
<td>
<p>(logical) <br /> fixed prevalence (FALSE) or simple random sampling (TRUE)</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_m">m</code></td>
<td>
<p>(numeric) <br /> integer, number of candidates</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_auc">auc</code></td>
<td>
<p>(numeric) <br /> vector of AUCs of biomarkers</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_rhose">rhose</code></td>
<td>
<p>(numeric) <br /> correlation parameter for sensitivity</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_rhosp">rhosp</code></td>
<td>
<p>(numeric) <br /> correlation parameter for specificity</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_dist">dist</code></td>
<td>
<p>(character) <br /> either &quot;normal&quot; or &quot;exponential&quot; specifying the subgroup biomarker distributions</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_e">e</code></td>
<td>
<p>(numeric) <br /> emulates better (worse) model selection quality with higher (lower) values of e</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_k">k</code></td>
<td>
<p>(numeric) <br /> technical parameter which adjusts grid size</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_delta">delta</code></td>
<td>
<p>(numeric) <br /> specify importance between sensitivity and specificity (default 0: equal importance)</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_...">...</code></td>
<td>
<p>(any) <br /> further arguments</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_data">data</code></td>
<td>
<p>(NULL) <br /> ignored (for batchtools compatibility)</p>
</td></tr>
<tr><td><code id="generate_instance_roc_+3A_job">job</code></td>
<td>
<p>(NULL) <br /> ignored (for batchtools compatibility)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Utilizes same arguments as <a href="#topic+draw_data_roc">draw_data_roc</a> unless mentioned otherwise above.
</p>


<h3>Value</h3>

<p>(list) <br /> a single (ROC) simulation instance of length <code>nrep</code>
</p>

<hr>
<h2 id='process_instance'>Analyze simulated synthetic datasets.</h2><span id='topic+process_instance'></span>

<h3>Description</h3>

<p>Process data instances, a list of multiple datasets generated via
<a href="#topic+generate_instance_lfc">generate_instance_lfc</a> or <a href="#topic+generate_instance_roc">generate_instance_roc</a>. This function
applies <a href="#topic+evaluate">evaluate</a> to all datasets.
</p>
<p><strong>This function is only needed for simulation via batchtools, not relevant in interactive use!</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_instance(
  instance = NULL,
  contrast = "cases::define_contrast('raw', NA)",
  benchmark = 0.5,
  alpha = 0.05,
  alternative = "greater",
  adjustment = "none",
  transformation = "none",
  analysis = "co-primary",
  regu = "c(1,1/2,1/4)",
  pars = "list()",
  ...,
  data = NULL,
  job = list(id = NA)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_instance_+3A_instance">instance</code></td>
<td>
<p>(list) <br /> generated via <a href="#topic+generate_instance_lfc">generate_instance_lfc</a> or <a href="#topic+generate_instance_roc">generate_instance_roc</a>.</p>
</td></tr>
<tr><td><code id="process_instance_+3A_contrast">contrast</code></td>
<td>
<p>(<code>cases_contrast</code>) <br /> specified via <code><a href="#topic+define_contrast">define_contrast</a></code></p>
</td></tr>
<tr><td><code id="process_instance_+3A_benchmark">benchmark</code></td>
<td>
<p>(numeric) <br /> value to compare against (RHS), should have same length as data
or length one if all benchmark values are identical.</p>
</td></tr>
<tr><td><code id="process_instance_+3A_alpha">alpha</code></td>
<td>
<p>(numeric) <br /> significance level (default: 0.05)</p>
</td></tr>
<tr><td><code id="process_instance_+3A_alternative">alternative</code></td>
<td>
<p>(character) <br /> specify alternative hypothesis</p>
</td></tr>
<tr><td><code id="process_instance_+3A_adjustment">adjustment</code></td>
<td>
<p>(character) <br /> specify type of statistical adjustment taken to address multiplicity</p>
</td></tr>
<tr><td><code id="process_instance_+3A_transformation">transformation</code></td>
<td>
<p>(character) <br /> define transformation to ensure results
(e.g. point estimates, confidence limits) lie in unit interval (&quot;none&quot; (default) or &quot;logit&quot;)</p>
</td></tr>
<tr><td><code id="process_instance_+3A_analysis">analysis</code></td>
<td>
<p>(character) <br />  &quot;co-primary&quot; (default; only option currently)</p>
</td></tr>
<tr><td><code id="process_instance_+3A_regu">regu</code></td>
<td>
<p>(numeric | logical) <br /> vector of length 3, specify type of shrinkage.
Alternatively, logical of length one (TRUE := c(2, 1, 1/2), FALSE := c(0, 0, 0))</p>
</td></tr>
<tr><td><code id="process_instance_+3A_pars">pars</code></td>
<td>
<p>(list) <br /> further parameters given as named list</p>
</td></tr>
<tr><td><code id="process_instance_+3A_...">...</code></td>
<td>
<p>(any) <br /> additional named parameters</p>
</td></tr>
<tr><td><code id="process_instance_+3A_data">data</code></td>
<td>
<p>(NULL) <br /> ignored (for batchtools compatibility)</p>
</td></tr>
<tr><td><code id="process_instance_+3A_job">job</code></td>
<td>
<p>(NULL) <br /> for batchtools compatibility, do not change</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Utilizes same arguments as <a href="#topic+evaluate">evaluate</a> unless mentioned otherwise above.
</p>


<h3>Value</h3>

<p>(list) <br /> standardized evaluation results
</p>

<hr>
<h2 id='visualize'>Visualize evaluation results</h2><span id='topic+visualize'></span>

<h3>Description</h3>

<p><strong>Currently, this implementation is only intended for situations with ...</strong>
</p>

<ul>
<li><p> two groups (e.g. healthy (&lt;-&gt; specificity) and diseased (&lt;-&gt; sensitivity))
</p>
</li>
<li><p> alternative = &quot;greater&quot;
</p>
</li>
<li><p> contrast = define_contrast(&quot;raw)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>visualize(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="visualize_+3A_x">x</code></td>
<td>
<p><code>cases_results</code> <br /> produced by <code><a href="#topic+evaluate">evaluate</a></code></p>
</td></tr>
<tr><td><code id="visualize_+3A_...">...</code></td>
<td>
<p><code>any</code> <br /> further arguments (currently ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
