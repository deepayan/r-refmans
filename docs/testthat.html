<!DOCTYPE html><html><head><title>Help for package testthat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {testthat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auto_test'><p>Watches code and tests for changes, rerunning tests as appropriate.</p></a></li>
<li><a href='#auto_test_package'><p>Watches a package for changes, rerunning tests as appropriate.</p></a></li>
<li><a href='#capture_condition'><p>Capture conditions, including messages, warnings, expectations, and errors.</p></a></li>
<li><a href='#capture_output'><p>Capture output to console</p></a></li>
<li><a href='#CheckReporter'><p>Check reporter: 13 line summary of problems</p></a></li>
<li><a href='#compare'><p>Provide human-readable comparison of two objects</p></a></li>
<li><a href='#compare_state'><p>Compare two directory states.</p></a></li>
<li><a href='#comparison-expectations'><p>Does code return a number greater/less than the expected value?</p></a></li>
<li><a href='#context'><p>Describe the context of a set of tests.</p></a></li>
<li><a href='#context_start_file'><p>Start test context from a file name</p></a></li>
<li><a href='#DebugReporter'><p>Test reporter: start recovery.</p></a></li>
<li><a href='#default_reporter'><p>Retrieve the default reporter</p></a></li>
<li><a href='#describe'><p>describe: a BDD testing language</p></a></li>
<li><a href='#dir_state'><p>Capture the state of a directory.</p></a></li>
<li><a href='#equality-expectations'><p>Does code return the expected value?</p></a></li>
<li><a href='#evaluate_promise'><p>Evaluate a promise, capturing all types of output.</p></a></li>
<li><a href='#expect'><p>The building block of all <code>expect_</code> functions</p></a></li>
<li><a href='#expect_cpp_tests_pass'><p>Do C++ tests past?</p></a></li>
<li><a href='#expect_equivalent'><p>Is an object equal to the expected value, ignoring attributes?</p></a></li>
<li><a href='#expect_error'><p>Does code throw an error, warning, message, or other condition?</p></a></li>
<li><a href='#expect_invisible'><p>Does code return a visible or invisible object?</p></a></li>
<li><a href='#expect_is'><p>Does an object inherit from a given class?</p></a></li>
<li><a href='#expect_known_output'><p>Expectations: is the output or the value equal to a known good value?</p></a></li>
<li><a href='#expect_length'><p>Does code return a vector with the specified length?</p></a></li>
<li><a href='#expect_less_than'><p>Deprecated numeric comparison functions</p></a></li>
<li><a href='#expect_match'><p>Does a string match a regular expression?</p></a></li>
<li><a href='#expect_named'><p>Does code return a vector with (given) names?</p></a></li>
<li><a href='#expect_no_error'><p>Does code run without error, warning, message, or other condition?</p></a></li>
<li><a href='#expect_null'><p>Does code return <code>NULL</code>?</p></a></li>
<li><a href='#expect_output'><p>Does code print output to the console?</p></a></li>
<li><a href='#expect_output_file'><p>Expectations: is the output or the value equal to a known good value?</p></a></li>
<li><a href='#expect_reference'><p>Does code return a reference to the expected object?</p></a></li>
<li><a href='#expect_setequal'><p>Does code return a vector containing the expected values?</p></a></li>
<li><a href='#expect_silent'><p>Does code execute silently?</p></a></li>
<li><a href='#expect_snapshot'><p>Snapshot testing</p></a></li>
<li><a href='#expect_snapshot_file'><p>Snapshot testing for whole files</p></a></li>
<li><a href='#expect_snapshot_output'><p>Snapshot helpers</p></a></li>
<li><a href='#expect_snapshot_value'><p>Snapshot testing for values</p></a></li>
<li><a href='#expect_success'><p>Tools for testing expectations</p></a></li>
<li><a href='#expect_that'><p>Expect that a condition holds.</p></a></li>
<li><a href='#expect_vector'><p>Does code return a vector with the expected size and/or prototype?</p></a></li>
<li><a href='#expectation'><p>Construct an expectation object</p></a></li>
<li><a href='#fail'><p>Default expectations that always succeed or fail.</p></a></li>
<li><a href='#FailReporter'><p>Test reporter: fail at end.</p></a></li>
<li><a href='#find_reporter'><p>Find reporter object given name or object.</p></a></li>
<li><a href='#find_test_scripts'><p>Find test files</p></a></li>
<li><a href='#inheritance-expectations'><p>Does code return an object inheriting from the expected base type, S3 class,</p>
or S4 class?</a></li>
<li><a href='#is_informative_error'><p>Is an error informative?</p></a></li>
<li><a href='#is_testing'><p>Determine testing status</p></a></li>
<li><a href='#JunitReporter'><p>Test reporter: summary of errors in jUnit XML format.</p></a></li>
<li><a href='#ListReporter'><p>List reporter: gather all test results along with elapsed time and</p>
file information.</a></li>
<li><a href='#local_edition'><p>Temporarily change the active testthat edition</p></a></li>
<li><a href='#local_mocked_bindings'><p>Mocking tools</p></a></li>
<li><a href='#local_snapshotter'><p>Instantiate local snapshotting context</p></a></li>
<li><a href='#local_test_context'><p>Locally set options for maximal test reproducibility</p></a></li>
<li><a href='#local_test_directory'><p>Locally set test directory options</p></a></li>
<li><a href='#LocationReporter'><p>Test reporter: location</p></a></li>
<li><a href='#logical-expectations'><p>Does code return <code>TRUE</code> or <code>FALSE</code>?</p></a></li>
<li><a href='#make_expectation'><p>Make an equality test.</p></a></li>
<li><a href='#MinimalReporter'><p>Test reporter: minimal.</p></a></li>
<li><a href='#MultiReporter'><p>Multi reporter: combine several reporters in one.</p></a></li>
<li><a href='#not'><p>Negate an expectation</p></a></li>
<li><a href='#oldskool'><p>Old-style expectations.</p></a></li>
<li><a href='#ProgressReporter'><p>Test reporter: interactive progress bar of errors.</p></a></li>
<li><a href='#quasi_label'><p>Quasi-labelling</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#Reporter'><p>Manage test reporting</p></a></li>
<li><a href='#reporter-accessors'><p>Get and set active reporter.</p></a></li>
<li><a href='#RStudioReporter'><p>Test reporter: RStudio</p></a></li>
<li><a href='#set_max_fails'><p>Set maximum number of test failures allowed before aborting the run</p></a></li>
<li><a href='#set_state_inspector'><p>State inspected</p></a></li>
<li><a href='#SilentReporter'><p>Test reporter: gather all errors silently.</p></a></li>
<li><a href='#skip'><p>Skip a test</p></a></li>
<li><a href='#skip_on_travis'><p>Superseded skip functions</p></a></li>
<li><a href='#snapshot_accept'><p>Snapshot management</p></a></li>
<li><a href='#source_file'><p>Source a file, directory of files, or various important subsets</p></a></li>
<li><a href='#StopReporter'><p>Test reporter: stop on error</p></a></li>
<li><a href='#SummaryReporter'><p>Test reporter: summary of errors.</p></a></li>
<li><a href='#takes_less_than'><p>Does code take less than the expected amount of time to run?</p></a></li>
<li><a href='#TapReporter'><p>Test reporter: TAP format.</p></a></li>
<li><a href='#TeamcityReporter'><p>Test reporter: Teamcity format.</p></a></li>
<li><a href='#teardown'><p>Run code before/after tests</p></a></li>
<li><a href='#teardown_env'><p>Run code after all test files</p></a></li>
<li><a href='#test_dir'><p>Run all tests in a directory</p></a></li>
<li><a href='#test_env'><p>Generate default testing environment.</p></a></li>
<li><a href='#test_examples'><p>Test package examples</p></a></li>
<li><a href='#test_file'><p>Run tests in a single file</p></a></li>
<li><a href='#test_package'><p>Run all tests in a package</p></a></li>
<li><a href='#test_path'><p>Locate a file in the testing directory</p></a></li>
<li><a href='#test_that'><p>Run a test</p></a></li>
<li><a href='#testthat_examples'><p>Retrieve paths to built-in example test files</p></a></li>
<li><a href='#testthat_results'><p>Create a <code>testthat_results</code> object from the test results</p>
as stored in the ListReporter results field.</a></li>
<li><a href='#testthat_tolerance'><p>Default numeric tolerance</p></a></li>
<li><a href='#testthat-package'><p>An R package to make testing fun!</p></a></li>
<li><a href='#try_again'><p>Try evaluating an expressing multiple times until it succeeds.</p></a></li>
<li><a href='#use_catch'><p>Use Catch for C++ Unit Testing</p></a></li>
<li><a href='#verify_output'><p>Verify output</p></a></li>
<li><a href='#watch'><p>Watch a directory for changes (additions, deletions &amp; modifications).</p></a></li>
<li><a href='#with_mock'><p>Mock functions in a package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Unit Testing for R</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Software testing is important, but, in part because it is
    frustrating and boring, many of us avoid it. 'testthat' is a testing
    framework for R that is easy to learn and use, and integrates with
    your existing 'workflow'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://testthat.r-lib.org">https://testthat.r-lib.org</a>, <a href="https://github.com/r-lib/testthat">https://github.com/r-lib/testthat</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/testthat/issues">https://github.com/r-lib/testthat/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>brio (&ge; 1.1.3), callr (&ge; 3.7.3), cli (&ge; 3.6.1), desc (&ge;
1.4.2), digest (&ge; 0.6.33), evaluate (&ge; 0.21), jsonlite (&ge;
1.8.7), lifecycle (&ge; 1.0.3), magrittr (&ge; 2.0.3), methods,
pkgload (&ge; 1.3.2.1), praise (&ge; 1.0.0), processx (&ge; 3.8.2),
ps (&ge; 1.7.5), R6 (&ge; 2.5.1), rlang (&ge; 1.1.1), utils, waldo
(&ge; 0.5.1), withr (&ge; 2.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, curl (&ge; 0.9.5), diffviewer (&ge; 0.1.0), knitr,
rmarkdown, rstudioapi, shiny, usethis, vctrs (&ge; 0.1.0), xml2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>watcher, parallel*</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-30 22:07:21 UTC; hadleywickham</td>
</tr>
<tr>
<td>Author:</td>
<td>Hadley Wickham [aut, cre],
  Posit Software, PBC [cph, fnd],
  R Core team [ctb] (Implementation of utils::recover())</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hadley Wickham &lt;hadley@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-02 11:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='auto_test'>Watches code and tests for changes, rerunning tests as appropriate.</h2><span id='topic+auto_test'></span>

<h3>Description</h3>

<p>The idea behind <code>auto_test()</code> is that you just leave it running while
you develop your code.  Every time you save a file it will be automatically
tested and you can easily see if your changes have caused any test
failures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_test(
  code_path,
  test_path,
  reporter = default_reporter(),
  env = test_env(),
  hash = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auto_test_+3A_code_path">code_path</code></td>
<td>
<p>path to directory containing code</p>
</td></tr>
<tr><td><code id="auto_test_+3A_test_path">test_path</code></td>
<td>
<p>path to directory containing tests</p>
</td></tr>
<tr><td><code id="auto_test_+3A_reporter">reporter</code></td>
<td>
<p>test reporter to use</p>
</td></tr>
<tr><td><code id="auto_test_+3A_env">env</code></td>
<td>
<p>environment in which to execute test suite.</p>
</td></tr>
<tr><td><code id="auto_test_+3A_hash">hash</code></td>
<td>
<p>Passed on to <code><a href="#topic+watch">watch()</a></code>. When FALSE, uses less accurate
modification time stamps, but those are faster for large files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current strategy for rerunning tests is as follows:
</p>

<ul>
<li><p> if any code has changed, then those files are reloaded and all tests
rerun
</p>
</li>
<li><p> otherwise, each new or modified test is run
</p>
</li></ul>

<p>In the future, <code>auto_test()</code> might implement one of the following more
intelligent alternatives:
</p>

<ul>
<li><p> Use codetools to build up dependency tree and then rerun tests only
when a dependency changes.
</p>
</li>
<li><p> Mimic ruby's autotest and rerun only failing tests until they pass,
and then rerun all tests.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+auto_test_package">auto_test_package()</a></code>
</p>

<hr>
<h2 id='auto_test_package'>Watches a package for changes, rerunning tests as appropriate.</h2><span id='topic+auto_test_package'></span>

<h3>Description</h3>

<p>Watches a package for changes, rerunning tests as appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_test_package(pkg = ".", reporter = default_reporter(), hash = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auto_test_package_+3A_pkg">pkg</code></td>
<td>
<p>path to package</p>
</td></tr>
<tr><td><code id="auto_test_package_+3A_reporter">reporter</code></td>
<td>
<p>test reporter to use</p>
</td></tr>
<tr><td><code id="auto_test_package_+3A_hash">hash</code></td>
<td>
<p>Passed on to <code><a href="#topic+watch">watch()</a></code>.  When FALSE, uses less accurate
modification time stamps, but those are faster for large files.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+auto_test">auto_test()</a></code> for details on how method works
</p>

<hr>
<h2 id='capture_condition'>Capture conditions, including messages, warnings, expectations, and errors.</h2><span id='topic+capture_condition'></span><span id='topic+capture_error'></span><span id='topic+capture_expectation'></span><span id='topic+capture_message'></span><span id='topic+capture_warning'></span><span id='topic+capture_messages'></span><span id='topic+capture_warnings'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>These functions allow you to capture the side-effects of a function call
including printed output, messages and warnings. We no longer recommend
that you use these functions, instead relying on the <code><a href="#topic+expect_message">expect_message()</a></code>
and friends to bubble up unmatched conditions. If you just want to silence
unimportant warnings, use <code><a href="base.html#topic+suppressWarnings">suppressWarnings()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture_condition(code, entrace = FALSE)

capture_error(code, entrace = FALSE)

capture_expectation(code, entrace = FALSE)

capture_message(code, entrace = FALSE)

capture_warning(code, entrace = FALSE)

capture_messages(code)

capture_warnings(code, ignore_deprecation = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capture_condition_+3A_code">code</code></td>
<td>
<p>Code to evaluate</p>
</td></tr>
<tr><td><code id="capture_condition_+3A_entrace">entrace</code></td>
<td>
<p>Whether to add a <a href="rlang.html#topic+trace_back">backtrace</a> to
the captured condition.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Singular functions (<code>capture_condition</code>, <code>capture_expectation</code> etc)
return a condition object. <code>capture_messages()</code> and <code>capture_warnings</code>
return a character vector of message text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function() {
  message("First")
  warning("Second")
  message("Third")
}

capture_message(f())
capture_messages(f())

capture_warning(f())
capture_warnings(f())

# Condition will capture anything
capture_condition(f())
</code></pre>

<hr>
<h2 id='capture_output'>Capture output to console</h2><span id='topic+capture_output'></span><span id='topic+capture_output_lines'></span><span id='topic+testthat_print'></span>

<h3>Description</h3>

<p>Evaluates <code>code</code> in a special context in which all output is captured,
similar to <code><a href="utils.html#topic+capture.output">capture.output()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capture_output(code, print = FALSE, width = 80)

capture_output_lines(code, print = FALSE, width = 80)

testthat_print(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capture_output_+3A_code">code</code></td>
<td>
<p>Code to evaluate.</p>
</td></tr>
<tr><td><code id="capture_output_+3A_print">print</code></td>
<td>
<p>If <code>TRUE</code> and the result of evaluating <code>code</code> is
visible, print the result using <code>testthat_print()</code>.</p>
</td></tr>
<tr><td><code id="capture_output_+3A_width">width</code></td>
<td>
<p>Number of characters per line of output. This does not
inherit from <code>getOption("width")</code> so that tests always use the same
output width, minimising spurious differences.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Results are printed using the <code>testthat_print()</code> generic, which defaults
to <code>print()</code>, giving you the ability to customise the printing of your
object in tests, if needed.
</p>


<h3>Value</h3>

<p><code>capture_output()</code> returns a single string. <code>capture_output_lines()</code>
returns a character vector with one entry for each line
</p>


<h3>Examples</h3>

<pre><code class='language-R'>capture_output({
  cat("Hi!\n")
  cat("Bye\n")
})

capture_output_lines({
  cat("Hi!\n")
  cat("Bye\n")
})

capture_output("Hi")
capture_output("Hi", print = TRUE)
</code></pre>

<hr>
<h2 id='CheckReporter'>Check reporter: 13 line summary of problems</h2><span id='topic+CheckReporter'></span>

<h3>Description</h3>

<p><code style="white-space: pre;">&#8288;R CMD check&#8288;</code> displays only the last 13 lines of the result, so this
report is designed to ensure that you see something useful there.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='compare'>Provide human-readable comparison of two objects</h2><span id='topic+compare'></span><span id='topic+compare.default'></span><span id='topic+compare.character'></span><span id='topic+compare.numeric'></span><span id='topic+compare.POSIXt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p><code>compare</code> is similar to <code><a href="base.html#topic+all.equal">base::all.equal()</a></code>, but somewhat buggy in its
use of <code>tolerance</code>. Please use <a href="https://waldo.r-lib.org/">waldo</a> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(x, y, ...)

## Default S3 method:
compare(x, y, ..., max_diffs = 9)

## S3 method for class 'character'
compare(
  x,
  y,
  check.attributes = TRUE,
  ...,
  max_diffs = 5,
  max_lines = 5,
  width = cli::console_width()
)

## S3 method for class 'numeric'
compare(
  x,
  y,
  tolerance = testthat_tolerance(),
  check.attributes = TRUE,
  ...,
  max_diffs = 9
)

## S3 method for class 'POSIXt'
compare(x, y, tolerance = 0.001, ..., max_diffs = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_x">x</code>, <code id="compare_+3A_y">y</code></td>
<td>
<p>Objects to compare</p>
</td></tr>
<tr><td><code id="compare_+3A_...">...</code></td>
<td>
<p>Additional arguments used to control specifics of comparison</p>
</td></tr>
<tr><td><code id="compare_+3A_max_diffs">max_diffs</code></td>
<td>
<p>Maximum number of differences to show</p>
</td></tr>
<tr><td><code id="compare_+3A_check.attributes">check.attributes</code></td>
<td>
<p>If <code>TRUE</code>, also checks values of attributes.</p>
</td></tr>
<tr><td><code id="compare_+3A_max_lines">max_lines</code></td>
<td>
<p>Maximum number of lines to show from each difference</p>
</td></tr>
<tr><td><code id="compare_+3A_width">width</code></td>
<td>
<p>Width of output device</p>
</td></tr>
<tr><td><code id="compare_+3A_tolerance">tolerance</code></td>
<td>
<p>Numerical tolerance: any differences (in the sense of
<code><a href="base.html#topic+all.equal">base::all.equal()</a></code>) smaller than this value will be ignored.
</p>
<p>The default tolerance is <code>sqrt(.Machine$double.eps)</code>, unless long doubles
are not available, in which case the test is skipped.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Character -----------------------------------------------------------------
x &lt;- c("abc", "def", "jih")
compare(x, x)

y &lt;- paste0(x, "y")
compare(x, y)

compare(letters, paste0(letters, "-"))

x &lt;- "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis cursus
 tincidunt auctor. Vestibulum ac metus bibendum, facilisis nisi non, pulvinar
 dolor. Donec pretium iaculis nulla, ut interdum sapien ultricies a. "
y &lt;- "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis cursus
 tincidunt auctor. Vestibulum ac metus1 bibendum, facilisis nisi non, pulvinar
 dolor. Donec pretium iaculis nulla, ut interdum sapien ultricies a. "
compare(x, y)
compare(c(x, x), c(y, y))

# Numeric -------------------------------------------------------------------

x &lt;- y &lt;- runif(100)
y[sample(100, 10)] &lt;- 5
compare(x, y)

x &lt;- y &lt;- 1:10
x[5] &lt;- NA
x[6] &lt;- 6.5
compare(x, y)

# Compare ignores minor numeric differences in the same way
# as all.equal.
compare(x, x + 1e-9)
</code></pre>

<hr>
<h2 id='compare_state'>Compare two directory states.</h2><span id='topic+compare_state'></span>

<h3>Description</h3>

<p>Compare two directory states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_state(old, new)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_state_+3A_old">old</code></td>
<td>
<p>previous state</p>
</td></tr>
<tr><td><code id="compare_state_+3A_new">new</code></td>
<td>
<p>current state</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing number of changes and files which have been
<code>added</code>, <code>deleted</code> and <code>modified</code>
</p>

<hr>
<h2 id='comparison-expectations'>Does code return a number greater/less than the expected value?</h2><span id='topic+comparison-expectations'></span><span id='topic+expect_lt'></span><span id='topic+expect_lte'></span><span id='topic+expect_gt'></span><span id='topic+expect_gte'></span>

<h3>Description</h3>

<p>Does code return a number greater/less than the expected value?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_lt(object, expected, label = NULL, expected.label = NULL)

expect_lte(object, expected, label = NULL, expected.label = NULL)

expect_gt(object, expected, label = NULL, expected.label = NULL)

expect_gte(object, expected, label = NULL, expected.label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparison-expectations_+3A_object">object</code>, <code id="comparison-expectations_+3A_expected">expected</code></td>
<td>
<p>A value to compare and its expected bound.</p>
</td></tr>
<tr><td><code id="comparison-expectations_+3A_label">label</code>, <code id="comparison-expectations_+3A_expected.label">expected.label</code></td>
<td>
<p>Used to customise failure messages. For expert
use only.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- 9
expect_lt(a, 10)

## Not run: 
expect_lt(11, 10)

## End(Not run)

a &lt;- 11
expect_gt(a, 10)
## Not run: 
expect_gt(9, 10)

## End(Not run)
</code></pre>

<hr>
<h2 id='context'>Describe the context of a set of tests.</h2><span id='topic+context'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>Use of <code>context()</code> is no longer recommended. Instead omit it, and messages
will use the name of the file instead. This ensures that the context and
test file name are always in sync.
</p>
<p>A context defines a set of tests that test related functionality.  Usually
you will have one context per file, but you may have multiple contexts
in a single file if you so choose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>context(desc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="context_+3A_desc">desc</code></td>
<td>
<p>description of context.  Should start with a capital letter.</p>
</td></tr>
</table>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>context()</code> is deprecated in the third edition, and the equivalent
information is instead recorded by the test file name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>context("String processing")
context("Remote procedure calls")
</code></pre>

<hr>
<h2 id='context_start_file'>Start test context from a file name</h2><span id='topic+context_start_file'></span>

<h3>Description</h3>

<p>For use in external reporters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>context_start_file(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="context_start_file_+3A_name">name</code></td>
<td>
<p>file name</p>
</td></tr>
</table>

<hr>
<h2 id='DebugReporter'>Test reporter: start recovery.</h2><span id='topic+DebugReporter'></span>

<h3>Description</h3>

<p>This reporter will call a modified version of <code><a href="utils.html#topic+recover">recover()</a></code> on all
broken expectations.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='default_reporter'>Retrieve the default reporter</h2><span id='topic+default_reporter'></span><span id='topic+default_parallel_reporter'></span><span id='topic+default_compact_reporter'></span><span id='topic+check_reporter'></span>

<h3>Description</h3>

<p>The defaults are:
</p>

<ul>
<li> <p><a href="#topic+ProgressReporter">ProgressReporter</a> for interactive, non-parallel; override with
<code>testthat.default_reporter</code>
</p>
</li>
<li> <p><a href="#topic+ParallelProgressReporter">ParallelProgressReporter</a> for interactive, parallel packages;
override with <code>testthat.default_parallel_reporter</code>
</p>
</li>
<li> <p><a href="#topic+CompactProgressReporter">CompactProgressReporter</a> for single-file interactive; override with
<code>testthat.default_compact_reporter</code>
</p>
</li>
<li> <p><a href="#topic+CheckReporter">CheckReporter</a> for R CMD check; override with <code>testthat.default_check_reporter</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>default_reporter()

default_parallel_reporter()

default_compact_reporter()

check_reporter()
</code></pre>

<hr>
<h2 id='describe'>describe: a BDD testing language</h2><span id='topic+describe'></span><span id='topic+it'></span>

<h3>Description</h3>

<p>A simple BDD DSL for writing tests. The language is similar to RSpec for
Ruby or Mocha for JavaScript. BDD tests read like sentences and it should
thus be easier to understand what the specification of a function/component
is.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>describe(description, code)

it(description, code = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="describe_+3A_description">description</code></td>
<td>
<p>description of the feature</p>
</td></tr>
<tr><td><code id="describe_+3A_code">code</code></td>
<td>
<p>test code containing the specs</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tests using the <code>describe</code> syntax not only verify the tested code, but
also document its intended behaviour. Each <code>describe</code> block specifies a
larger component or function and contains a set of specifications. A
specification is defined by an <code>it</code> block. Each <code>it</code> block
functions as a test and is evaluated in its own environment. You
can also have nested <code>describe</code> blocks.
</p>
<p>This test syntax helps to test the intended behaviour of your code. For
example: you want to write a new function for your package. Try to describe
the specification first using <code>describe</code>, before your write any code.
After that, you start to implement the tests for each specification (i.e.
the <code>it</code> block).
</p>
<p>Use <code>describe</code> to verify that you implement the right things and use
<code><a href="#topic+test_that">test_that()</a></code> to ensure you do the things right.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>describe("matrix()", {
  it("can be multiplied by a scalar", {
    m1 &lt;- matrix(1:4, 2, 2)
    m2 &lt;- m1 * 2
    expect_equal(matrix(1:4 * 2, 2, 2), m2)
  })
  it("can have not yet tested specs")
})

# Nested specs:
## code
addition &lt;- function(a, b) a + b
division &lt;- function(a, b) a / b

## specs
describe("math library", {
  describe("addition()", {
    it("can add two numbers", {
      expect_equal(1 + 1, addition(1, 1))
    })
  })
  describe("division()", {
    it("can divide two numbers", {
      expect_equal(10 / 2, division(10, 2))
    })
    it("can handle division by 0") #not yet implemented
  })
})
</code></pre>

<hr>
<h2 id='dir_state'>Capture the state of a directory.</h2><span id='topic+dir_state'></span>

<h3>Description</h3>

<p>Capture the state of a directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dir_state(path, pattern = NULL, hash = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dir_state_+3A_path">path</code></td>
<td>
<p>path to directory</p>
</td></tr>
<tr><td><code id="dir_state_+3A_pattern">pattern</code></td>
<td>
<p>regular expression with which to filter files</p>
</td></tr>
<tr><td><code id="dir_state_+3A_hash">hash</code></td>
<td>
<p>use hash (slow but accurate) or time stamp (fast but less
accurate)</p>
</td></tr>
</table>

<hr>
<h2 id='equality-expectations'>Does code return the expected value?</h2><span id='topic+equality-expectations'></span><span id='topic+expect_equal'></span><span id='topic+expect_identical'></span>

<h3>Description</h3>

<p>These functions provide two levels of strictness when comparing a
computation to a reference value. <code>expect_identical()</code> is the baseline;
<code>expect_equal()</code> relaxes the test to ignore small numeric differences.
</p>
<p>In the 2nd edition, <code>expect_identical()</code> uses <code><a href="base.html#topic+identical">identical()</a></code> and
<code>expect_equal</code> uses <code><a href="Matrix.html#topic+all.equal">all.equal()</a></code>. In the 3rd edition, both functions use
<a href="https://github.com/r-lib/waldo">waldo</a>. They differ only in that
<code>expect_equal()</code> sets <code>tolerance = testthat_tolerance()</code> so that small
floating point differences are ignored; this also implies that (e.g.) <code>1</code>
and <code>1L</code> are treated as equal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_equal(
  object,
  expected,
  ...,
  tolerance = if (edition_get() &gt;= 3) testthat_tolerance(),
  info = NULL,
  label = NULL,
  expected.label = NULL
)

expect_identical(
  object,
  expected,
  info = NULL,
  label = NULL,
  expected.label = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="equality-expectations_+3A_object">object</code>, <code id="equality-expectations_+3A_expected">expected</code></td>
<td>
<p>Computation and value to compare it to.
</p>
<p>Both arguments supports limited unquoting to make it easier to generate
readable failures within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for
more details.</p>
</td></tr>
<tr><td><code id="equality-expectations_+3A_...">...</code></td>
<td>
<p><strong>3e</strong>: passed on to <code><a href="waldo.html#topic+compare">waldo::compare()</a></code>. See its docs to see other
ways to control comparison.
</p>
<p><strong>2e</strong>: passed on to <code><a href="#topic+compare">compare()</a></code>/<code><a href="base.html#topic+identical">identical()</a></code>.</p>
</td></tr>
<tr><td><code id="equality-expectations_+3A_tolerance">tolerance</code></td>
<td>
<p><strong>3e</strong>: passed on to <code><a href="waldo.html#topic+compare">waldo::compare()</a></code>. If non-<code>NULL</code>, will
ignore small floating point differences. It uses same algorithm as
<code><a href="Matrix.html#topic+all.equal">all.equal()</a></code> so the tolerance is usually relative (i.e.
<code style="white-space: pre;">&#8288;mean(abs(x - y) / mean(abs(y)) &lt; tolerance&#8288;</code>), except when the differences
are very small, when it becomes absolute (i.e. <code style="white-space: pre;">&#8288;mean(abs(x - y) &lt; tolerance&#8288;</code>).
See waldo documentation for more details.
</p>
<p><strong>2e</strong>: passed on to <code><a href="#topic+compare">compare()</a></code>, if set. It's hard to
reason about exactly what tolerance means because depending on the precise
code path it could be either an absolute or relative tolerance.</p>
</td></tr>
<tr><td><code id="equality-expectations_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="equality-expectations_+3A_label">label</code>, <code id="equality-expectations_+3A_expected.label">expected.label</code></td>
<td>
<p>Used to customise failure messages. For expert
use only.</p>
</td></tr>
</table>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+expect_setequal">expect_setequal()</a></code>/<code><a href="#topic+expect_mapequal">expect_mapequal()</a></code> to test for set equality.
</p>
</li>
<li> <p><code><a href="#topic+expect_reference">expect_reference()</a></code> to test if two names point to same memory address.
</p>
</li></ul>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- 10
expect_equal(a, 10)

# Use expect_equal() when testing for numeric equality
## Not run: 
expect_identical(sqrt(2) ^ 2, 2)

## End(Not run)
expect_equal(sqrt(2) ^ 2, 2)
</code></pre>

<hr>
<h2 id='evaluate_promise'>Evaluate a promise, capturing all types of output.</h2><span id='topic+evaluate_promise'></span>

<h3>Description</h3>

<p>Evaluate a promise, capturing all types of output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_promise(code, print = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_promise_+3A_code">code</code></td>
<td>
<p>Code to evaluate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>result</code></td>
<td>
<p>The result of the function</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>A string containing all the output from the function</p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>A character vector containing the text from each warning</p>
</td></tr>
<tr><td><code>messages</code></td>
<td>
<p>A character vector containing the text from each message</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>evaluate_promise({
  print("1")
  message("2")
  warning("3")
  4
})
</code></pre>

<hr>
<h2 id='expect'>The building block of all <code>expect_</code> functions</h2><span id='topic+expect'></span>

<h3>Description</h3>

<p>Call <code>expect()</code> when writing your own expectations. See
<code>vignette("custom-expectation")</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect(
  ok,
  failure_message,
  info = NULL,
  srcref = NULL,
  trace = NULL,
  trace_env = caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_+3A_ok">ok</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> indicating if the expectation was successful.</p>
</td></tr>
<tr><td><code id="expect_+3A_failure_message">failure_message</code></td>
<td>
<p>Message to show if the expectation failed.</p>
</td></tr>
<tr><td><code id="expect_+3A_info">info</code></td>
<td>
<p>Character vector continuing additional information. Included
for backward compatibility only and new expectations should not use it.</p>
</td></tr>
<tr><td><code id="expect_+3A_srcref">srcref</code></td>
<td>
<p>Location of the failure. Should only needed to be explicitly
supplied when you need to forward a srcref captured elsewhere.</p>
</td></tr>
<tr><td><code id="expect_+3A_trace">trace</code></td>
<td>
<p>An optional backtrace created by <code><a href="rlang.html#topic+trace_back">rlang::trace_back()</a></code>.
When supplied, the expectation is displayed with the backtrace.</p>
</td></tr>
<tr><td><code id="expect_+3A_trace_env">trace_env</code></td>
<td>
<p>If <code>is.null(trace)</code>, this is used to automatically
generate a traceback running from <code>test_code()</code>/<code>test_file()</code> to
<code>trace_env</code>. You'll generally only need to set this if you're wrapping
an expectation inside another function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While <code>expect()</code> creates and signals an expectation in one go,
<code>exp_signal()</code> separately signals an expectation that you
have manually created with <code><a href="#topic+new_expectation">new_expectation()</a></code>. Expectations are
signalled with the following protocol:
</p>

<ul>
<li><p> If the expectation is a failure or an error, it is signalled with
<code><a href="base.html#topic+stop">base::stop()</a></code>. Otherwise, it is signalled with
<code><a href="base.html#topic+conditions">base::signalCondition()</a></code>.
</p>
</li>
<li><p> The <code>continue_test</code> restart is registered. When invoked, failing
expectations are ignored and normal control flow is resumed to
run the other tests.
</p>
</li></ul>



<h3>Value</h3>

<p>An expectation object. Signals the expectation condition
with a <code>continue_test</code> restart.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exp_signal">exp_signal()</a></code>
</p>

<hr>
<h2 id='expect_cpp_tests_pass'>Do C++ tests past?</h2><span id='topic+expect_cpp_tests_pass'></span><span id='topic+run_cpp_tests'></span>

<h3>Description</h3>

<p>Test compiled code in the package <code>package</code>. A call to this function will
automatically be generated for you in <code>tests/testthat/test-cpp.R</code> after
calling <code><a href="#topic+use_catch">use_catch()</a></code>; you should not need to manually call this expectation
yourself.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_cpp_tests_pass(package)

run_cpp_tests(package)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_cpp_tests_pass_+3A_package">package</code></td>
<td>
<p>The name of the package to test.</p>
</td></tr>
</table>

<hr>
<h2 id='expect_equivalent'>Is an object equal to the expected value, ignoring attributes?</h2><span id='topic+expect_equivalent'></span>

<h3>Description</h3>

<p>Compares <code>object</code> and <code>expected</code> using <code><a href="Matrix.html#topic+all.equal">all.equal()</a></code> and
<code>check.attributes = FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_equivalent(
  object,
  expected,
  ...,
  info = NULL,
  label = NULL,
  expected.label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_equivalent_+3A_object">object</code>, <code id="expect_equivalent_+3A_expected">expected</code></td>
<td>
<p>Computation and value to compare it to.
</p>
<p>Both arguments supports limited unquoting to make it easier to generate
readable failures within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for
more details.</p>
</td></tr>
<tr><td><code id="expect_equivalent_+3A_...">...</code></td>
<td>
<p>Passed on to <code><a href="#topic+compare">compare()</a></code>.</p>
</td></tr>
<tr><td><code id="expect_equivalent_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_equivalent_+3A_label">label</code>, <code id="expect_equivalent_+3A_expected.label">expected.label</code></td>
<td>
<p>Used to customise failure messages. For expert
use only.</p>
</td></tr>
</table>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>expect_equivalent()</code> is deprecated in the 3rd edition. Instead use
<code>expect_equal(ignore_attr = TRUE)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' # expect_equivalent() ignores attributes
a &lt;- b &lt;- 1:3
names(b) &lt;- letters[1:3]
## Not run: 
expect_equal(a, b)

## End(Not run)
expect_equivalent(a, b)
</code></pre>

<hr>
<h2 id='expect_error'>Does code throw an error, warning, message, or other condition?</h2><span id='topic+expect_error'></span><span id='topic+expect_warning'></span><span id='topic+expect_message'></span><span id='topic+expect_condition'></span>

<h3>Description</h3>

<p><code>expect_error()</code>, <code>expect_warning()</code>, <code>expect_message()</code>, and
<code>expect_condition()</code> check that code throws an error, warning, message,
or condition with a message that matches <code>regexp</code>, or a class that inherits
from <code>class</code>. See below for more details.
</p>
<p>In the 3rd edition, these functions match (at most) a single condition. All
additional and non-matching (if <code>regexp</code> or <code>class</code> are used) conditions
will bubble up outside the expectation. If these additional conditions
are important you'll need to catch them with additional
<code>expect_message()</code>/<code>expect_warning()</code> calls; if they're unimportant you
can ignore with <code><a href="base.html#topic+suppressMessages">suppressMessages()</a></code>/<code><a href="base.html#topic+suppressWarnings">suppressWarnings()</a></code>.
</p>
<p>It can be tricky to test for a combination of different conditions,
such as a message followed by an error. <code><a href="#topic+expect_snapshot">expect_snapshot()</a></code> is
often an easier alternative for these more complex cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_error(
  object,
  regexp = NULL,
  class = NULL,
  ...,
  inherit = TRUE,
  info = NULL,
  label = NULL
)

expect_warning(
  object,
  regexp = NULL,
  class = NULL,
  ...,
  inherit = TRUE,
  all = FALSE,
  info = NULL,
  label = NULL
)

expect_message(
  object,
  regexp = NULL,
  class = NULL,
  ...,
  inherit = TRUE,
  all = FALSE,
  info = NULL,
  label = NULL
)

expect_condition(
  object,
  regexp = NULL,
  class = NULL,
  ...,
  inherit = TRUE,
  info = NULL,
  label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_error_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_regexp">regexp</code></td>
<td>
<p>Regular expression to test against.
</p>

<ul>
<li><p> A character vector giving a regular expression that must match the
error message.
</p>
</li>
<li><p> If <code>NULL</code>, the default, asserts that there should be an error,
but doesn't test for a specific value.
</p>
</li>
<li><p> If <code>NA</code>, asserts that there should be no errors, but we now recommend
using <code><a href="#topic+expect_no_error">expect_no_error()</a></code> and friends instead.
</p>
</li></ul>

<p>Note that you should only use <code>message</code> with errors/warnings/messages
that you generate. Avoid tests that rely on the specific text generated by
another package since this can easily change. If you do need to test text
generated by another package, either protect the test with <code>skip_on_cran()</code>
or use <code>expect_snapshot()</code>.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_class">class</code></td>
<td>
<p>Instead of supplying a regular expression, you can also supply
a class name. This is useful for &quot;classed&quot; conditions.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+expect_match">expect_match</a></code>
</p>

<dl>
<dt><code>fixed</code></dt><dd><p>If <code>TRUE</code>, treats <code>regexp</code> as a string to be matched exactly
(not a regular expressions). Overrides <code>perl</code>.</p>
</dd>
<dt><code>perl</code></dt><dd><p>logical.  Should Perl-compatible regexps be used?</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="expect_error_+3A_inherit">inherit</code></td>
<td>
<p>Whether to match <code>regexp</code> and <code>class</code> across the
ancestry of chained errors.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
<tr><td><code id="expect_error_+3A_all">all</code></td>
<td>
<p><em>DEPRECATED</em> If you need to test multiple warnings/messages
you now need to use multiple calls to <code>expect_message()</code>/
<code>expect_warning()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>regexp = NA</code>, the value of the first argument; otherwise
the captured condition.
</p>


<h3>Testing <code>message</code> vs <code>class</code></h3>

<p>When checking that code generates an error, it's important to check that the
error is the one you expect. There are two ways to do this. The first
way is the simplest: you just provide a <code>regexp</code> that match some fragment
of the error message. This is easy, but fragile, because the test will
fail if the error message changes (even if its the same error).
</p>
<p>A more robust way is to test for the class of the error, if it has one.
You can learn more about custom conditions at
<a href="https://adv-r.hadley.nz/conditions.html#custom-conditions">https://adv-r.hadley.nz/conditions.html#custom-conditions</a>, but in
short, errors are S3 classes and you can generate a custom class and check
for it using <code>class</code> instead of <code>regexp</code>.
</p>
<p>If you are using <code>expect_error()</code> to check that an error message is
formatted in such a way that it makes sense to a human, we recommend
using <code><a href="#topic+expect_snapshot">expect_snapshot()</a></code> instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expect_no_error">expect_no_error()</a></code>, <code>expect_no_warning()</code>,
<code>expect_no_message()</code>, and <code>expect_no_condition()</code> to assert
that code runs without errors/warnings/messages/conditions.
</p>
<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Errors ------------------------------------------------------------------
f &lt;- function() stop("My error!")
expect_error(f())
expect_error(f(), "My error!")

# You can use the arguments of grepl to control the matching
expect_error(f(), "my error!", ignore.case = TRUE)

# Note that `expect_error()` returns the error object so you can test
# its components if needed
err &lt;- expect_error(rlang::abort("a", n = 10))
expect_equal(err$n, 10)

# Warnings ------------------------------------------------------------------
f &lt;- function(x) {
  if (x &lt; 0) {
    warning("*x* is already negative")
    return(x)
  }
  -x
}
expect_warning(f(-1))
expect_warning(f(-1), "already negative")
expect_warning(f(1), NA)

# To test message and output, store results to a variable
expect_warning(out &lt;- f(-1), "already negative")
expect_equal(out, -1)

# Messages ------------------------------------------------------------------
f &lt;- function(x) {
  if (x &lt; 0) {
    message("*x* is already negative")
    return(x)
  }

  -x
}
expect_message(f(-1))
expect_message(f(-1), "already negative")
expect_message(f(1), NA)
</code></pre>

<hr>
<h2 id='expect_invisible'>Does code return a visible or invisible object?</h2><span id='topic+expect_invisible'></span><span id='topic+expect_visible'></span>

<h3>Description</h3>

<p>Use this to test whether a function returns a visible or invisible
output. Typically you'll use this to check that functions called primarily
for their side-effects return their data argument invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_invisible(call, label = NULL)

expect_visible(call, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_invisible_+3A_call">call</code></td>
<td>
<p>A function call.</p>
</td></tr>
<tr><td><code id="expect_invisible_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The evaluated <code>call</code>, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_invisible(x &lt;- 10)
expect_visible(x)

# Typically you'll assign the result of the expectation so you can
# also check that the value is as you expect.
greet &lt;- function(name) {
  message("Hi ", name)
  invisible(name)
}
out &lt;- expect_invisible(greet("Hadley"))
expect_equal(out, "Hadley")
</code></pre>

<hr>
<h2 id='expect_is'>Does an object inherit from a given class?</h2><span id='topic+expect_is'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p><code>expect_is()</code> is an older form that uses <code><a href="base.html#topic+inherits">inherits()</a></code> without checking
whether <code>x</code> is S3, S4, or neither. Instead, I'd recommend using
<code><a href="#topic+expect_type">expect_type()</a></code>, <code><a href="#topic+expect_s3_class">expect_s3_class()</a></code> or <code><a href="#topic+expect_s4_class">expect_s4_class()</a></code> to more clearly
convey your  intent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_is(object, class, info = NULL, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_is_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_is_+3A_class">class</code></td>
<td>
<p>Either a character vector of class names, or
for <code>expect_s3_class()</code> and <code>expect_s4_class()</code>, an <code>NA</code> to assert
that <code>object</code> isn't an S3 or S4 object.</p>
</td></tr>
</table>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>expect_is()</code> is formally deprecated in the 3rd edition.
</p>

<hr>
<h2 id='expect_known_output'>Expectations: is the output or the value equal to a known good value?</h2><span id='topic+expect_known_output'></span><span id='topic+expect_known_value'></span><span id='topic+expect_equal_to_reference'></span><span id='topic+expect_known_hash'></span>

<h3>Description</h3>

<p>For complex printed output and objects, it is often challenging to describe
exactly what you expect to see. <code>expect_known_value()</code> and
<code>expect_known_output()</code> provide a slightly weaker guarantee, simply
asserting that the values have not changed since the last time that you ran
them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_known_output(
  object,
  file,
  update = TRUE,
  ...,
  info = NULL,
  label = NULL,
  print = FALSE,
  width = 80
)

expect_known_value(
  object,
  file,
  update = TRUE,
  ...,
  info = NULL,
  label = NULL,
  version = 2
)

expect_known_hash(object, hash = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_known_output_+3A_file">file</code></td>
<td>
<p>File path where known value/output will be stored.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_update">update</code></td>
<td>
<p>Should the file be updated? Defaults to <code>TRUE</code>, with
the expectation that you'll notice changes because of the first failure,
and then see the modified files in git.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_...">...</code></td>
<td>
<p>Passed on to <code><a href="waldo.html#topic+compare">waldo::compare()</a></code>.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_print">print</code></td>
<td>
<p>If <code>TRUE</code> and the result of evaluating <code>code</code> is
visible, print the result using <code>testthat_print()</code>.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_width">width</code></td>
<td>
<p>Number of characters per line of output. This does not
inherit from <code>getOption("width")</code> so that tests always use the same
output width, minimising spurious differences.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_version">version</code></td>
<td>
<p>The serialization format version to use. The default, 2, was
the default format from R 1.4.0 to 3.5.3. Version 3 became the default from
R 3.6.0 and can only be read by R versions 3.5.0 and higher.</p>
</td></tr>
<tr><td><code id="expect_known_output_+3A_hash">hash</code></td>
<td>
<p>Known hash value. Leave empty and you'll be informed what
to use in the test output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These expectations should be used in conjunction with git, as otherwise
there is no way to revert to previous values. Git is particularly useful
in conjunction with <code>expect_known_output()</code> as the diffs will show you
exactly what has changed.
</p>
<p>Note that known values updates will only be updated when running tests
interactively. <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> clones the package source so any changes to
the reference files will occur in a temporary directory, and will not be
synchronised back to the source package.
</p>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>expect_known_output()</code> and friends are deprecated in the 3rd edition;
please use <code><a href="#topic+expect_snapshot_output">expect_snapshot_output()</a></code> and friends instead.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp &lt;- tempfile()

# The first run always succeeds
expect_known_output(mtcars[1:10, ], tmp, print = TRUE)

# Subsequent runs will succeed only if the file is unchanged
# This will succeed:
expect_known_output(mtcars[1:10, ], tmp, print = TRUE)

## Not run: 
# This will fail
expect_known_output(mtcars[1:9, ], tmp, print = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_length'>Does code return a vector with the specified length?</h2><span id='topic+expect_length'></span>

<h3>Description</h3>

<p>Does code return a vector with the specified length?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_length(object, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_length_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_length_+3A_n">n</code></td>
<td>
<p>Expected length.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expect_vector">expect_vector()</a></code> to make assertions about the &quot;size&quot; of a vector
</p>
<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_length(1, 1)
expect_length(1:10, 10)

## Not run: 
expect_length(1:10, 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_less_than'>Deprecated numeric comparison functions</h2><span id='topic+expect_less_than'></span><span id='topic+expect_more_than'></span>

<h3>Description</h3>

<p>These functions have been deprecated in favour of the more concise
<code><a href="#topic+expect_gt">expect_gt()</a></code> and <code><a href="#topic+expect_lt">expect_lt()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_less_than(...)

expect_more_than(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_less_than_+3A_...">...</code></td>
<td>
<p>All arguments passed on to <code>expect_lt()</code>/<code>expect_gt()</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='expect_match'>Does a string match a regular expression?</h2><span id='topic+expect_match'></span><span id='topic+expect_no_match'></span>

<h3>Description</h3>

<p>Does a string match a regular expression?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_match(
  object,
  regexp,
  perl = FALSE,
  fixed = FALSE,
  ...,
  all = TRUE,
  info = NULL,
  label = NULL
)

expect_no_match(
  object,
  regexp,
  perl = FALSE,
  fixed = FALSE,
  ...,
  all = TRUE,
  info = NULL,
  label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_match_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_regexp">regexp</code></td>
<td>
<p>Regular expression to test against.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_perl">perl</code></td>
<td>
<p>logical.  Should Perl-compatible regexps be used?</p>
</td></tr>
<tr><td><code id="expect_match_+3A_fixed">fixed</code></td>
<td>
<p>If <code>TRUE</code>, treats <code>regexp</code> as a string to be matched exactly
(not a regular expressions). Overrides <code>perl</code>.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="base.html#topic+grep">base::grepl</a></code>
</p>

<dl>
<dt><code>ignore.case</code></dt><dd><p>if <code>FALSE</code>, the pattern matching is <em>case
sensitive</em> and if <code>TRUE</code>, case is ignored during matching.</p>
</dd>
<dt><code>useBytes</code></dt><dd><p>logical.  If <code>TRUE</code> the matching is done
byte-by-byte rather than character-by-character.  See
&lsquo;Details&rsquo;.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="expect_match_+3A_all">all</code></td>
<td>
<p>Should all elements of actual value match <code>regexp</code> (TRUE),
or does only one need to match (FALSE).</p>
</td></tr>
<tr><td><code id="expect_match_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>expect_match()</code> is a wrapper around <code><a href="base.html#topic+grepl">grepl()</a></code>. See its documentation for
more detail about the individual arguments. <code>expect_no_match()</code> provides
the complementary case, checking that a string <em>does not</em> match a regular
expression.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>expect_no_match()</code>: Check that a string doesn't match a regular
expression.
</p>
</li></ul>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_match("Testing is fun", "fun")
expect_match("Testing is fun", "f.n")
expect_no_match("Testing is fun", "horrible")

## Not run: 
expect_match("Testing is fun", "horrible")

# Zero-length inputs always fail
expect_match(character(), ".")

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_named'>Does code return a vector with (given) names?</h2><span id='topic+expect_named'></span>

<h3>Description</h3>

<p>You can either check for the presence of names (leaving <code>expected</code>
blank), specific names (by supplying a vector of names), or absence of
names (with <code>NULL</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_named(
  object,
  expected,
  ignore.order = FALSE,
  ignore.case = FALSE,
  info = NULL,
  label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_named_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_named_+3A_expected">expected</code></td>
<td>
<p>Character vector of expected names. Leave missing to
match any names. Use <code>NULL</code> to check for absence of names.</p>
</td></tr>
<tr><td><code id="expect_named_+3A_ignore.order">ignore.order</code></td>
<td>
<p>If <code>TRUE</code>, sorts names before comparing to
ignore the effect of order.</p>
</td></tr>
<tr><td><code id="expect_named_+3A_ignore.case">ignore.case</code></td>
<td>
<p>If <code>TRUE</code>, lowercases all names to ignore the
effect of case.</p>
</td></tr>
<tr><td><code id="expect_named_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_named_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(a = 1, b = 2, c = 3)
expect_named(x)
expect_named(x, c("a", "b", "c"))

# Use options to control sensitivity
expect_named(x, c("B", "C", "A"), ignore.order = TRUE, ignore.case = TRUE)

# Can also check for the absence of names with NULL
z &lt;- 1:4
expect_named(z, NULL)
</code></pre>

<hr>
<h2 id='expect_no_error'>Does code run without error, warning, message, or other condition?</h2><span id='topic+expect_no_error'></span><span id='topic+expect_no_warning'></span><span id='topic+expect_no_message'></span><span id='topic+expect_no_condition'></span>

<h3>Description</h3>

<p>These expectations are the opposite of <code><a href="#topic+expect_error">expect_error()</a></code>,
<code>expect_warning()</code>, <code>expect_message()</code>, and <code>expect_condition()</code>. They
assert the absence of an error, warning, or message, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_no_error(object, ..., message = NULL, class = NULL)

expect_no_warning(object, ..., message = NULL, class = NULL)

expect_no_message(object, ..., message = NULL, class = NULL)

expect_no_condition(object, ..., message = NULL, class = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_no_error_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_no_error_+3A_...">...</code></td>
<td>
<p>These dots are for future extensions and must be empty.</p>
</td></tr>
<tr><td><code id="expect_no_error_+3A_message">message</code>, <code id="expect_no_error_+3A_class">class</code></td>
<td>
<p>The default, <code style="white-space: pre;">&#8288;message = NULL, class = NULL&#8288;</code>,
will fail if there is any error/warning/message/condition.
</p>
<p>In many cases, particularly when testing warnings and messages, you will
want to be more specific about the condition you are hoping <strong>not</strong> to see,
i.e. the condition that motivated you to write the test.  Similar to
<code>expect_error()</code> and friends, you can specify the <code>message</code> (a regular
expression that the message of the condition must match) and/or the
<code>class</code> (a class the condition must inherit from). This ensures that
the message/warnings you don't want never recur, while allowing new
messages/warnings to bubble up for you to deal with.
</p>
<p>Note that you should only use <code>message</code> with errors/warnings/messages
that you generate, or that base R generates (which tend to be stable).
Avoid tests that rely on the specific text generated by another package
since this can easily change. If you do need to test text generated by
another package, either protect the test with <code>skip_on_cran()</code> or
use <code>expect_snapshot()</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>expect_no_warning(1 + 1)

foo &lt;- function(x) {
  warning("This is a problem!")
}

# warning doesn't match so bubbles up:
expect_no_warning(foo(), message = "bananas")

# warning does match so causes a failure:
try(expect_no_warning(foo(), message = "problem"))
</code></pre>

<hr>
<h2 id='expect_null'>Does code return <code>NULL</code>?</h2><span id='topic+expect_null'></span>

<h3>Description</h3>

<p>This is a special case because <code>NULL</code> is a singleton so it's possible
check for it either with <code>expect_equal(x, NULL)</code> or <code>expect_type(x, "NULL")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_null(object, info = NULL, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_null_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_null_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_null_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- NULL
y &lt;- 10

expect_null(x)
show_failure(expect_null(y))
</code></pre>

<hr>
<h2 id='expect_output'>Does code print output to the console?</h2><span id='topic+expect_output'></span>

<h3>Description</h3>

<p>Test for output produced by <code>print()</code> or <code>cat()</code>. This is best used for
very simple output; for more complex cases use <code><a href="#topic+expect_snapshot">expect_snapshot()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_output(
  object,
  regexp = NULL,
  ...,
  info = NULL,
  label = NULL,
  width = 80
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_output_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_output_+3A_regexp">regexp</code></td>
<td>
<p>Regular expression to test against.
</p>

<ul>
<li><p> A character vector giving a regular expression that must match the output.
</p>
</li>
<li><p> If <code>NULL</code>, the default, asserts that there should output,
but doesn't check for a specific value.
</p>
</li>
<li><p> If <code>NA</code>, asserts that there should be no output.
</p>
</li></ul>
</td></tr>
<tr><td><code id="expect_output_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+expect_match">expect_match</a></code>
</p>

<dl>
<dt><code>all</code></dt><dd><p>Should all elements of actual value match <code>regexp</code> (TRUE),
or does only one need to match (FALSE).</p>
</dd>
<dt><code>fixed</code></dt><dd><p>If <code>TRUE</code>, treats <code>regexp</code> as a string to be matched exactly
(not a regular expressions). Overrides <code>perl</code>.</p>
</dd>
<dt><code>perl</code></dt><dd><p>logical.  Should Perl-compatible regexps be used?</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="expect_output_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_output_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
<tr><td><code id="expect_output_+3A_width">width</code></td>
<td>
<p>Number of characters per line of output. This does not
inherit from <code>getOption("width")</code> so that tests always use the same
output width, minimising spurious differences.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The first argument, invisibly.
</p>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(mtcars)
expect_output(str(mtcars), "32 obs")
expect_output(str(mtcars), "11 variables")

# You can use the arguments of grepl to control the matching
expect_output(str(mtcars), "11 VARIABLES", ignore.case = TRUE)
expect_output(str(mtcars), "$ mpg", fixed = TRUE)
</code></pre>

<hr>
<h2 id='expect_output_file'>Expectations: is the output or the value equal to a known good value?</h2><span id='topic+expect_output_file'></span>

<h3>Description</h3>

<p><code>expect_output_file()</code> behaves identically to <code><a href="#topic+expect_known_output">expect_known_output()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_output_file(
  object,
  file,
  update = TRUE,
  ...,
  info = NULL,
  label = NULL,
  print = FALSE,
  width = 80
)
</code></pre>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>expect_output_file()</code> is deprecated in the 3rd edition;
please use <code><a href="#topic+expect_snapshot_output">expect_snapshot_output()</a></code> and friends instead.
</p>

<hr>
<h2 id='expect_reference'>Does code return a reference to the expected object?</h2><span id='topic+expect_reference'></span>

<h3>Description</h3>

<p><code>expect_reference()</code> compares the underlying memory addresses of
two symbols. It is for expert use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_reference(
  object,
  expected,
  info = NULL,
  label = NULL,
  expected.label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_reference_+3A_object">object</code>, <code id="expect_reference_+3A_expected">expected</code></td>
<td>
<p>Computation and value to compare it to.
</p>
<p>Both arguments supports limited unquoting to make it easier to generate
readable failures within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for
more details.</p>
</td></tr>
<tr><td><code id="expect_reference_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_reference_+3A_label">label</code>, <code id="expect_reference_+3A_expected.label">expected.label</code></td>
<td>
<p>Used to customise failure messages. For expert
use only.</p>
</td></tr>
</table>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>expect_reference()</code> is deprecated in the third edition. If you know what
you're doing, and you really need this behaviour, just use <code>is_reference()</code>
directly: <code>expect_true(rlang::is_reference(x, y))</code>.
</p>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>

<hr>
<h2 id='expect_setequal'>Does code return a vector containing the expected values?</h2><span id='topic+expect_setequal'></span><span id='topic+expect_mapequal'></span><span id='topic+expect_contains'></span><span id='topic+expect_in'></span>

<h3>Description</h3>


<ul>
<li> <p><code>expect_setequal(x, y)</code> tests that every element of <code>x</code> occurs in <code>y</code>,
and that every element of <code>y</code> occurs in <code>x</code>.
</p>
</li>
<li> <p><code>expect_contains(x, y)</code> tests that <code>x</code> contains every element of <code>y</code>
(i.e. <code>y</code> is a subset of <code>x</code>).
</p>
</li>
<li> <p><code>expect_in(x, y)</code> tests every element of <code>x</code> is in <code>y</code>
(i.e. <code>x</code> is a subset of <code>y</code>).
</p>
</li>
<li> <p><code>expect_mapequal(x, y)</code> tests that <code>x</code> and <code>y</code> have the same names, and
that <code>x[names(y)]</code> equals <code>y</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>expect_setequal(object, expected)

expect_mapequal(object, expected)

expect_contains(object, expected)

expect_in(object, expected)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_setequal_+3A_object">object</code>, <code id="expect_setequal_+3A_expected">expected</code></td>
<td>
<p>Computation and value to compare it to.
</p>
<p>Both arguments supports limited unquoting to make it easier to generate
readable failures within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for
more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>expect_setequal()</code> ignores names, and you will be warned if both
<code>object</code> and <code>expected</code> have them.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_setequal(letters, rev(letters))
show_failure(expect_setequal(letters[-1], rev(letters)))

x &lt;- list(b = 2, a = 1)
expect_mapequal(x, list(a = 1, b = 2))
show_failure(expect_mapequal(x, list(a = 1)))
show_failure(expect_mapequal(x, list(a = 1, b = "x")))
show_failure(expect_mapequal(x, list(a = 1, b = 2, c = 3)))
</code></pre>

<hr>
<h2 id='expect_silent'>Does code execute silently?</h2><span id='topic+expect_silent'></span>

<h3>Description</h3>

<p>Checks that the code produces no output, messages, or warnings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_silent(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_silent_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The first argument, invisibly.
</p>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_silent("123")

f &lt;- function() {
  message("Hi!")
  warning("Hey!!")
  print("OY!!!")
}
## Not run: 
expect_silent(f())

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_snapshot'>Snapshot testing</h2><span id='topic+expect_snapshot'></span>

<h3>Description</h3>

<p>Snapshot tests (aka golden tests) are similar to unit tests except that the
expected result is stored in a separate file that is managed by testthat.
Snapshot tests are useful for when the expected value is large, or when
the intent of the code is something that can only be verified by a human
(e.g. this is a useful error message). Learn more in
<code>vignette("snapshotting")</code>.
</p>
<p><code>expect_snapshot()</code> runs code as if you had executed it at the console, and
records the results, including output, messages, warnings, and errors.
If you just want to compare the result, try <code><a href="#topic+expect_snapshot_value">expect_snapshot_value()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_snapshot(
  x,
  cran = FALSE,
  error = FALSE,
  transform = NULL,
  variant = NULL,
  cnd_class = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_snapshot_+3A_x">x</code></td>
<td>
<p>Code to evaluate.</p>
</td></tr>
<tr><td><code id="expect_snapshot_+3A_cran">cran</code></td>
<td>
<p>Should these expectations be verified on CRAN? By default,
they are not, because snapshot tests tend to be fragile because they
often rely on minor details of dependencies.</p>
</td></tr>
<tr><td><code id="expect_snapshot_+3A_error">error</code></td>
<td>
<p>Do you expect the code to throw an error? The expectation
will fail (even on CRAN) if an unexpected error is thrown or the
expected error is not thrown.</p>
</td></tr>
<tr><td><code id="expect_snapshot_+3A_transform">transform</code></td>
<td>
<p>Optionally, a function to scrub sensitive or stochastic
text from the output. Should take a character vector of lines as input
and return a modified character vector as output.</p>
</td></tr>
<tr><td><code id="expect_snapshot_+3A_variant">variant</code></td>
<td>
<p>If non-<code>NULL</code>, results will be saved in
<code style="white-space: pre;">&#8288;_snaps/{variant}/{test.md}&#8288;</code>, so <code>variant</code> must be a single string
suitable for use as a directory name.
</p>
<p>You can use variants to deal with cases where the snapshot output varies
and you want to capture and test the variations. Common use cases include
variations for operating system, R version, or version of key dependency.
Variants are an advanced feature. When you use them, you'll need to
carefully think about your testing strategy to ensure that all important
variants are covered by automated tests, and ensure that you have a way
to get snapshot changes out of your CI system and back into the repo.</p>
</td></tr>
<tr><td><code id="expect_snapshot_+3A_cnd_class">cnd_class</code></td>
<td>
<p>Whether to include the class of messages,
warnings, and errors in the snapshot. Only the most specific
class is included, i.e. the first element of <code>class(cnd)</code>.</p>
</td></tr>
</table>


<h3>Workflow</h3>

<p>The first time that you run a snapshot expectation it will run <code>x</code>,
capture the results, and record them in <code style="white-space: pre;">&#8288;tests/testthat/_snaps/{test}.md&#8288;</code>.
Each test file gets its own snapshot file, e.g. <code>test-foo.R</code> will get
<code style="white-space: pre;">&#8288;_snaps/foo.md&#8288;</code>.
</p>
<p>It's important to review the Markdown files and commit them to git. They are
designed to be human readable, and you should always review new additions
to ensure that the salient information has been captured. They should also
be carefully reviewed in pull requests, to make sure that snapshots have
updated in the expected way.
</p>
<p>On subsequent runs, the result of <code>x</code> will be compared to the value stored
on disk. If it's different, the expectation will fail, and a new file
<code style="white-space: pre;">&#8288;_snaps/{test}.new.md&#8288;</code> will be created. If the change was deliberate,
you can approve the change with <code><a href="#topic+snapshot_accept">snapshot_accept()</a></code> and then the tests will
pass the next time you run them.
</p>
<p>Note that snapshotting can only work when executing a complete test file
(with <code><a href="#topic+test_file">test_file()</a></code>, <code><a href="#topic+test_dir">test_dir()</a></code>, or friends) because there's otherwise
no way to figure out the snapshot path. If you run snapshot tests
interactively, they'll just display the current value.
</p>

<hr>
<h2 id='expect_snapshot_file'>Snapshot testing for whole files</h2><span id='topic+expect_snapshot_file'></span><span id='topic+announce_snapshot_file'></span><span id='topic+compare_file_binary'></span><span id='topic+compare_file_text'></span>

<h3>Description</h3>

<p>Whole file snapshot testing is designed for testing objects that don't have
a convenient textual representation, with initial support for images
(<code>.png</code>, <code>.jpg</code>, <code>.svg</code>), data frames (<code>.csv</code>), and text files
(<code>.R</code>, <code>.txt</code>, <code>.json</code>, ...).
</p>
<p>The first time <code>expect_snapshot_file()</code> is run, it will create
<code style="white-space: pre;">&#8288;_snaps/{test}/{name}.{ext}&#8288;</code> containing reference output. Future runs will
be compared to this reference: if different, the test will fail and the new
results will be saved in <code style="white-space: pre;">&#8288;_snaps/{test}/{name}.new.{ext}&#8288;</code>. To review
failures, call <code><a href="#topic+snapshot_review">snapshot_review()</a></code>.
</p>
<p>We generally expect this function to be used via a wrapper that takes care
of ensuring that output is as reproducible as possible, e.g. automatically
skipping tests where it's known that images can't be reproduced exactly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_snapshot_file(
  path,
  name = basename(path),
  binary = lifecycle::deprecated(),
  cran = FALSE,
  compare = NULL,
  transform = NULL,
  variant = NULL
)

announce_snapshot_file(path, name = basename(path))

compare_file_binary(old, new)

compare_file_text(old, new)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_snapshot_file_+3A_path">path</code></td>
<td>
<p>Path to file to snapshot. Optional for
<code>announce_snapshot_file()</code> if <code>name</code> is supplied.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_name">name</code></td>
<td>
<p>Snapshot name, taken from <code>path</code> by default.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_binary">binary</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> Please use the
<code>compare</code> argument instead.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_cran">cran</code></td>
<td>
<p>Should these expectations be verified on CRAN? By default,
they are not, because snapshot tests tend to be fragile because they
often rely on minor details of dependencies.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_compare">compare</code></td>
<td>
<p>A function used to compare the snapshot files. It should take
two inputs, the paths to the <code>old</code> and <code>new</code> snapshot, and return either
<code>TRUE</code> or <code>FALSE</code>. This defaults to <code>compare_file_text</code> if <code>name</code> has
extension <code>.r</code>, <code>.R</code>, <code>.Rmd</code>, <code>.md</code>, or <code>.txt</code>, and otherwise uses
<code>compare_file_binary</code>.
</p>
<p><code>compare_file_binary()</code> compares byte-by-byte and
<code>compare_file_text()</code> compares lines-by-line, ignoring
the difference between Windows and Mac/Linux line endings.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_transform">transform</code></td>
<td>
<p>Optionally, a function to scrub sensitive or stochastic
text from the output. Should take a character vector of lines as input
and return a modified character vector as output.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_variant">variant</code></td>
<td>
<p>If not-<code>NULL</code>, results will be saved in
<code style="white-space: pre;">&#8288;_snaps/{variant}/{test}/{name}.{ext}&#8288;</code>. This allows you to create
different snapshots for different scenarios, like different operating
systems or different R versions.</p>
</td></tr>
<tr><td><code id="expect_snapshot_file_+3A_old">old</code>, <code id="expect_snapshot_file_+3A_new">new</code></td>
<td>
<p>Paths to old and new snapshot files.</p>
</td></tr>
</table>


<h3>Announcing snapshots</h3>

<p>testthat automatically detects dangling snapshots that have been
written to the <code style="white-space: pre;">&#8288;_snaps&#8288;</code> directory but which no longer have
corresponding R code to generate them. These dangling files are
automatically deleted so they don't clutter the snapshot
directory. However we want to preserve snapshot files when the R
code wasn't executed because of an unexpected error or because of a
<code><a href="#topic+skip">skip()</a></code>. Let testthat know about these files by calling
<code>announce_snapshot_file()</code> before <code>expect_snapshot_file()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# To use expect_snapshot_file() you'll typically need to start by writing
# a helper function that creates a file from your code, returning a path
save_png &lt;- function(code, width = 400, height = 400) {
  path &lt;- tempfile(fileext = ".png")
  png(path, width = width, height = height)
  on.exit(dev.off())
  code

  path
}
path &lt;- save_png(plot(1:5))
path

## Not run: 
expect_snapshot_file(save_png(hist(mtcars$mpg)), "plot.png")

## End(Not run)

# You'd then also provide a helper that skips tests where you can't
# be sure of producing exactly the same output
expect_snapshot_plot &lt;- function(name, code) {
  # Other packages might affect results
  skip_if_not_installed("ggplot2", "2.0.0")
  # Or maybe the output is different on some operation systems
  skip_on_os("windows")
  # You'll need to carefully think about and experiment with these skips

  name &lt;- paste0(name, ".png")

  # Announce the file before touching `code`. This way, if `code`
  # unexpectedly fails or skips, testthat will not auto-delete the
  # corresponding snapshot file.
  announce_snapshot_file(name = name)

  path &lt;- save_png(code)
  expect_snapshot_file(path, name)
}
</code></pre>

<hr>
<h2 id='expect_snapshot_output'>Snapshot helpers</h2><span id='topic+expect_snapshot_output'></span><span id='topic+expect_snapshot_error'></span><span id='topic+expect_snapshot_warning'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#questioning"><img src="../help/figures/lifecycle-questioning.svg" alt='[Questioning]' /></a>
</p>
<p>These snapshotting functions are questioning because they were developed
before <code><a href="#topic+expect_snapshot">expect_snapshot()</a></code> and we're not sure that they still have a
role to play.
</p>

<ul>
<li> <p><code>expect_snapshot_output()</code> captures just output printed to the console.
</p>
</li>
<li> <p><code>expect_snapshot_error()</code> captures an error message and
optionally checks its class.
</p>
</li>
<li> <p><code>expect_snapshot_warning()</code> captures a warning message and
optionally checks its class.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>expect_snapshot_output(x, cran = FALSE, variant = NULL)

expect_snapshot_error(x, class = "error", cran = FALSE, variant = NULL)

expect_snapshot_warning(x, class = "warning", cran = FALSE, variant = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_snapshot_output_+3A_x">x</code></td>
<td>
<p>Code to evaluate.</p>
</td></tr>
<tr><td><code id="expect_snapshot_output_+3A_cran">cran</code></td>
<td>
<p>Should these expectations be verified on CRAN? By default,
they are not, because snapshot tests tend to be fragile because they
often rely on minor details of dependencies.</p>
</td></tr>
<tr><td><code id="expect_snapshot_output_+3A_variant">variant</code></td>
<td>
<p>If non-<code>NULL</code>, results will be saved in
<code style="white-space: pre;">&#8288;_snaps/{variant}/{test.md}&#8288;</code>, so <code>variant</code> must be a single string
suitable for use as a directory name.
</p>
<p>You can use variants to deal with cases where the snapshot output varies
and you want to capture and test the variations. Common use cases include
variations for operating system, R version, or version of key dependency.
Variants are an advanced feature. When you use them, you'll need to
carefully think about your testing strategy to ensure that all important
variants are covered by automated tests, and ensure that you have a way
to get snapshot changes out of your CI system and back into the repo.</p>
</td></tr>
<tr><td><code id="expect_snapshot_output_+3A_class">class</code></td>
<td>
<p>Class of expected error or warning. The expectation will
always fail (even on CRAN) if an error of this class isn't seen
when executing <code>x</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='expect_snapshot_value'>Snapshot testing for values</h2><span id='topic+expect_snapshot_value'></span>

<h3>Description</h3>

<p>Captures the result of function, flexibly serializing it into a text
representation that's stored in a snapshot file. See <code><a href="#topic+expect_snapshot">expect_snapshot()</a></code>
for more details on snapshot testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_snapshot_value(
  x,
  style = c("json", "json2", "deparse", "serialize"),
  cran = FALSE,
  tolerance = testthat_tolerance(),
  ...,
  variant = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_snapshot_value_+3A_x">x</code></td>
<td>
<p>Code to evaluate.</p>
</td></tr>
<tr><td><code id="expect_snapshot_value_+3A_style">style</code></td>
<td>
<p>Serialization style to use:
</p>

<ul>
<li> <p><code>json</code> uses <code><a href="jsonlite.html#topic+fromJSON">jsonlite::fromJSON()</a></code> and <code><a href="jsonlite.html#topic+fromJSON">jsonlite::toJSON()</a></code>. This
produces the simplest output but only works for relatively simple
objects.
</p>
</li>
<li> <p><code>json2</code> uses <code><a href="jsonlite.html#topic+serializeJSON">jsonlite::serializeJSON()</a></code> and <code><a href="jsonlite.html#topic+serializeJSON">jsonlite::unserializeJSON()</a></code>
which are more verbose but work for a wider range of type.
</p>
</li>
<li> <p><code>deparse</code> uses <code><a href="base.html#topic+deparse">deparse()</a></code>, which generates a depiction of the object
using R code.
</p>
</li>
<li> <p><code>serialize()</code> produces a binary serialization of the object using
<code><a href="base.html#topic+serialize">serialize()</a></code>. This is all but guaranteed to work for any R object,
but produces a completely opaque serialization.
</p>
</li></ul>
</td></tr>
<tr><td><code id="expect_snapshot_value_+3A_cran">cran</code></td>
<td>
<p>Should these expectations be verified on CRAN? By default,
they are not, because snapshot tests tend to be fragile because they
often rely on minor details of dependencies.</p>
</td></tr>
<tr><td><code id="expect_snapshot_value_+3A_tolerance">tolerance</code></td>
<td>
<p>Numerical tolerance: any differences (in the sense of
<code><a href="base.html#topic+all.equal">base::all.equal()</a></code>) smaller than this value will be ignored.
</p>
<p>The default tolerance is <code>sqrt(.Machine$double.eps)</code>, unless long doubles
are not available, in which case the test is skipped.</p>
</td></tr>
<tr><td><code id="expect_snapshot_value_+3A_...">...</code></td>
<td>
<p>Passed on to <code><a href="waldo.html#topic+compare">waldo::compare()</a></code> so you can control the details of
the comparison.</p>
</td></tr>
<tr><td><code id="expect_snapshot_value_+3A_variant">variant</code></td>
<td>
<p>If non-<code>NULL</code>, results will be saved in
<code style="white-space: pre;">&#8288;_snaps/{variant}/{test.md}&#8288;</code>, so <code>variant</code> must be a single string
suitable for use as a directory name.
</p>
<p>You can use variants to deal with cases where the snapshot output varies
and you want to capture and test the variations. Common use cases include
variations for operating system, R version, or version of key dependency.
Variants are an advanced feature. When you use them, you'll need to
carefully think about your testing strategy to ensure that all important
variants are covered by automated tests, and ensure that you have a way
to get snapshot changes out of your CI system and back into the repo.</p>
</td></tr>
</table>

<hr>
<h2 id='expect_success'>Tools for testing expectations</h2><span id='topic+expect_success'></span><span id='topic+expect_failure'></span><span id='topic+show_failure'></span>

<h3>Description</h3>

<p>Use these expectations to test other expectations.
Use <code>show_failure()</code> in examples to print the failure message without
throwing an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_success(expr)

expect_failure(expr, message = NULL, ...)

show_failure(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_success_+3A_expr">expr</code></td>
<td>
<p>Expression that evaluates a single expectation.</p>
</td></tr>
<tr><td><code id="expect_success_+3A_message">message</code></td>
<td>
<p>Check that the failure message matches this regexp.</p>
</td></tr>
<tr><td><code id="expect_success_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="#topic+expect_match">expect_match()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='expect_that'>Expect that a condition holds.</h2><span id='topic+expect_that'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>An old style of testing that's no longer encouraged.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_that(object, condition, info = NULL, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_that_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_that_+3A_condition">condition</code></td>
<td>
<p>a function that returns whether or not the condition
is met, and if not, an error message to display.</p>
</td></tr>
<tr><td><code id="expect_that_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="expect_that_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the (internal) expectation result as an invisible list
</p>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>This style of testing is formally deprecated as of the 3rd edition.
Use a more specific <code>expect_</code> function instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fail">fail()</a></code> for an expectation that always fails.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_that(5 * 2, equals(10))
expect_that(sqrt(2) ^ 2, equals(2))
## Not run: 
expect_that(sqrt(2) ^ 2, is_identical_to(2))

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_vector'>Does code return a vector with the expected size and/or prototype?</h2><span id='topic+expect_vector'></span>

<h3>Description</h3>

<p><code>expect_vector()</code> is a thin wrapper around <code><a href="vctrs.html#topic+vec_assert">vctrs::vec_assert()</a></code>, converting
the results of that function in to the expectations used by testthat. This
means that it used the vctrs of <code>ptype</code> (prototype) and <code>size</code>. See
details in <a href="https://vctrs.r-lib.org/articles/type-size.html">https://vctrs.r-lib.org/articles/type-size.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_vector(object, ptype = NULL, size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expect_vector_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="expect_vector_+3A_ptype">ptype</code></td>
<td>
<p>(Optional) Vector prototype to test against. Should be a
size-0 (empty) generalised vector.</p>
</td></tr>
<tr><td><code id="expect_vector_+3A_size">size</code></td>
<td>
<p>(Optional) Size to check for.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("vctrs") &amp;&amp; packageVersion("vctrs") &gt; "0.1.0.9002") {
expect_vector(1:10, ptype = integer(), size = 10)
show_failure(expect_vector(1:10, ptype = integer(), size = 5))
show_failure(expect_vector(1:10, ptype = character(), size = 5))
}
</code></pre>

<hr>
<h2 id='expectation'>Construct an expectation object</h2><span id='topic+expectation'></span><span id='topic+new_expectation'></span><span id='topic+exp_signal'></span><span id='topic+is.expectation'></span>

<h3>Description</h3>

<p>For advanced use only. If you are creating your own expectation, you should
call <code><a href="#topic+expect">expect()</a></code> instead. See <code>vignette("custom-expectation")</code> for more
details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expectation(type, message, srcref = NULL, trace = NULL)

new_expectation(
  type,
  message,
  ...,
  srcref = NULL,
  trace = NULL,
  .subclass = NULL
)

exp_signal(exp)

is.expectation(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expectation_+3A_type">type</code></td>
<td>
<p>Expectation type. Must be one of &quot;success&quot;, &quot;failure&quot;, &quot;error&quot;,
&quot;skip&quot;, &quot;warning&quot;.</p>
</td></tr>
<tr><td><code id="expectation_+3A_message">message</code></td>
<td>
<p>Message describing test failure</p>
</td></tr>
<tr><td><code id="expectation_+3A_srcref">srcref</code></td>
<td>
<p>Optional <code>srcref</code> giving location of test.</p>
</td></tr>
<tr><td><code id="expectation_+3A_trace">trace</code></td>
<td>
<p>An optional backtrace created by <code><a href="rlang.html#topic+trace_back">rlang::trace_back()</a></code>.
When supplied, the expectation is displayed with the backtrace.</p>
</td></tr>
<tr><td><code id="expectation_+3A_...">...</code></td>
<td>
<p>Additional attributes for the expectation object.</p>
</td></tr>
<tr><td><code id="expectation_+3A_.subclass">.subclass</code></td>
<td>
<p>An optional subclass for the expectation object.</p>
</td></tr>
<tr><td><code id="expectation_+3A_exp">exp</code></td>
<td>
<p>An expectation object, as created by
<code><a href="#topic+new_expectation">new_expectation()</a></code>.</p>
</td></tr>
<tr><td><code id="expectation_+3A_x">x</code></td>
<td>
<p>object to test for class membership</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create an expectation with <code>expectation()</code> or <code>new_expectation()</code>
and signal it with <code>exp_signal()</code>.
</p>

<hr>
<h2 id='fail'>Default expectations that always succeed or fail.</h2><span id='topic+fail'></span><span id='topic+succeed'></span>

<h3>Description</h3>

<p>These allow you to manually trigger success or failure. Failure is
particularly useful to a pre-condition or mark a test as not yet
implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fail(
  message = "Failure has been forced",
  info = NULL,
  trace_env = caller_env()
)

succeed(message = "Success has been forced", info = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fail_+3A_message">message</code></td>
<td>
<p>a string to display.</p>
</td></tr>
<tr><td><code id="fail_+3A_info">info</code></td>
<td>
<p>Character vector continuing additional information. Included
for backward compatibility only and new expectations should not use it.</p>
</td></tr>
<tr><td><code id="fail_+3A_trace_env">trace_env</code></td>
<td>
<p>If <code>is.null(trace)</code>, this is used to automatically
generate a traceback running from <code>test_code()</code>/<code>test_file()</code> to
<code>trace_env</code>. You'll generally only need to set this if you're wrapping
an expectation inside another function.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
test_that("this test fails", fail())
test_that("this test succeeds", succeed())

## End(Not run)
</code></pre>

<hr>
<h2 id='FailReporter'>Test reporter: fail at end.</h2><span id='topic+FailReporter'></span>

<h3>Description</h3>

<p>This reporter will simply throw an error if any of the tests failed. It is
best combined with another reporter, such as the
<a href="#topic+SummaryReporter">SummaryReporter</a>.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='find_reporter'>Find reporter object given name or object.</h2><span id='topic+find_reporter'></span>

<h3>Description</h3>

<p>If not found, will return informative error message.
Pass a character vector to create a <a href="#topic+MultiReporter">MultiReporter</a> composed
of individual reporters.
Will return null if given NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_reporter(reporter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_reporter_+3A_reporter">reporter</code></td>
<td>
<p>name of reporter(s), or reporter object(s)</p>
</td></tr>
</table>

<hr>
<h2 id='find_test_scripts'>Find test files</h2><span id='topic+find_test_scripts'></span>

<h3>Description</h3>

<p>Find test files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_test_scripts(
  path,
  filter = NULL,
  invert = FALSE,
  ...,
  full.names = TRUE,
  start_first = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_test_scripts_+3A_path">path</code></td>
<td>
<p>path to tests</p>
</td></tr>
<tr><td><code id="find_test_scripts_+3A_filter">filter</code></td>
<td>
<p>If not <code>NULL</code>, only tests with file names matching this
regular expression will be executed. Matching is performed on the file
name after it's stripped of <code>"test-"</code> and <code>".R"</code>.</p>
</td></tr>
<tr><td><code id="find_test_scripts_+3A_invert">invert</code></td>
<td>
<p>If <code>TRUE</code> return files which <strong>don't</strong> match.</p>
</td></tr>
<tr><td><code id="find_test_scripts_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+grepl">grepl()</a></code> to control filtering.</p>
</td></tr>
<tr><td><code id="find_test_scripts_+3A_start_first">start_first</code></td>
<td>
<p>A character vector of file patterns (globs, see
<code><a href="utils.html#topic+glob2rx">utils::glob2rx()</a></code>). The patterns are for the file names (base names),
not for the whole paths. testthat starts the files matching the
first pattern first,  then the ones matching the second, etc. and then
the rest of the files, alphabetically. Parallel tests tend to finish
quicker if you start the slowest files first. <code>NULL</code> means alphabetical
order.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of paths
</p>

<hr>
<h2 id='inheritance-expectations'>Does code return an object inheriting from the expected base type, S3 class,
or S4 class?</h2><span id='topic+inheritance-expectations'></span><span id='topic+expect_type'></span><span id='topic+expect_s3_class'></span><span id='topic+expect_s4_class'></span>

<h3>Description</h3>

<p>See <a href="https://adv-r.hadley.nz/oo.html">https://adv-r.hadley.nz/oo.html</a> for an overview of R's OO systems, and
the vocabulary used here.
</p>

<ul>
<li> <p><code>expect_type(x, type)</code> checks that <code>typeof(x)</code> is <code>type</code>.
</p>
</li>
<li> <p><code>expect_s3_class(x, class)</code> checks that <code>x</code> is an S3 object that
<code><a href="base.html#topic+inherits">inherits()</a></code> from <code>class</code>
</p>
</li>
<li> <p><code>expect_s3_class(x, NA)</code> checks that <code>x</code> isn't an S3 object.
</p>
</li>
<li> <p><code>expect_s4_class(x, class)</code> checks that <code>x</code> is an S4 object that
<code><a href="methods.html#topic+is">is()</a></code> <code>class</code>.
</p>
</li>
<li> <p><code>expect_s4_class(x, NA)</code> checks that <code>x</code> isn't an S4 object.
</p>
</li></ul>

<p>See <code><a href="#topic+expect_vector">expect_vector()</a></code> for testing properties of objects created by vctrs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_type(object, type)

expect_s3_class(object, class, exact = FALSE)

expect_s4_class(object, class)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inheritance-expectations_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="inheritance-expectations_+3A_type">type</code></td>
<td>
<p>String giving base type (as returned by <code><a href="base.html#topic+typeof">typeof()</a></code>).</p>
</td></tr>
<tr><td><code id="inheritance-expectations_+3A_class">class</code></td>
<td>
<p>Either a character vector of class names, or
for <code>expect_s3_class()</code> and <code>expect_s4_class()</code>, an <code>NA</code> to assert
that <code>object</code> isn't an S3 or S4 object.</p>
</td></tr>
<tr><td><code id="inheritance-expectations_+3A_exact">exact</code></td>
<td>
<p>If <code>FALSE</code>, the default, checks that <code>object</code> inherits
from <code>class</code>. If <code>TRUE</code>, checks that object has a class that's identical
to <code>class</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+logical-expectations">logical-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(x = 1:10, y = "x", stringsAsFactors = TRUE)
# A data frame is an S3 object with class data.frame
expect_s3_class(x, "data.frame")
show_failure(expect_s4_class(x, "data.frame"))
# A data frame is built from a list:
expect_type(x, "list")

# An integer vector is an atomic vector of type "integer"
expect_type(x$x, "integer")
# It is not an S3 object
show_failure(expect_s3_class(x$x, "integer"))

# Above, we requested data.frame() converts strings to factors:
show_failure(expect_type(x$y, "character"))
expect_s3_class(x$y, "factor")
expect_type(x$y, "integer")
</code></pre>

<hr>
<h2 id='is_informative_error'>Is an error informative?</h2><span id='topic+is_informative_error'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>is_informative_error()</code> is a generic predicate that indicates
whether testthat users should explicitly test for an error
class. Since we no longer recommend you do that, this generic
has been deprecated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_informative_error(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_informative_error_+3A_x">x</code></td>
<td>
<p>An error object.</p>
</td></tr>
<tr><td><code id="is_informative_error_+3A_...">...</code></td>
<td>
<p>These dots are for future extensions and must be empty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A few classes are hard-coded as uninformative:
</p>

<ul>
<li> <p><code>simpleError</code>
</p>
</li>
<li> <p><code>rlang_error</code> unless a subclass is detected
</p>
</li>
<li> <p><code>Rcpp::eval_error</code>
</p>
</li>
<li> <p><code>Rcpp::exception</code>
</p>
</li></ul>


<hr>
<h2 id='is_testing'>Determine testing status</h2><span id='topic+is_testing'></span><span id='topic+is_parallel'></span><span id='topic+is_checking'></span><span id='topic+is_snapshot'></span><span id='topic+testing_package'></span>

<h3>Description</h3>

<p>These functions help you determine if you code is running in a particular
testing context:
</p>

<ul>
<li> <p><code>is_testing()</code> is <code>TRUE</code> inside a test.
</p>
</li>
<li> <p><code>is_snapshot()</code> is <code>TRUE</code> inside a snapshot test
</p>
</li>
<li> <p><code>is_checking()</code> is <code>TRUE</code> inside of <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> (i.e. by <code><a href="#topic+test_check">test_check()</a></code>).
</p>
</li>
<li> <p><code>is_parallel()</code> is <code>TRUE</code> if the tests are run in parallel.
</p>
</li>
<li> <p><code>testing_package()</code> gives name of the package being tested.
</p>
</li></ul>

<p>A common use of these functions is to compute a default value for a <code>quiet</code>
argument with <code>is_testing() &amp;&amp; !is_snapshot()</code>. In this case, you'll
want to avoid an run-time dependency on testthat, in which case you should
just copy the implementation of these functions into a <code>utils.R</code> or similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_testing()

is_parallel()

is_checking()

is_snapshot()

testing_package()
</code></pre>

<hr>
<h2 id='JunitReporter'>Test reporter: summary of errors in jUnit XML format.</h2><span id='topic+JunitReporter'></span>

<h3>Description</h3>

<p>This reporter includes detailed results about each test and summaries,
written to a file (or stdout) in jUnit XML format. This can be read by
the Jenkins Continuous Integration System to report on a dashboard etc.
Requires the <em>xml2</em> package.
</p>


<h3>Details</h3>

<p>To fit into the jUnit structure, context() becomes the <code style="white-space: pre;">&#8288;&lt;testsuite&gt;&#8288;</code>
name as well as the base of the <code style="white-space: pre;">&#8288;&lt;testcase&gt; classname&#8288;</code>. The
test_that() name becomes the rest of the <code style="white-space: pre;">&#8288;&lt;testcase&gt; classname&#8288;</code>.
The deparsed expect_that() call becomes the <code style="white-space: pre;">&#8288;&lt;testcase&gt;&#8288;</code> name.
On failure, the message goes into the <code style="white-space: pre;">&#8288;&lt;failure&gt;&#8288;</code> node message
argument (first line only) and into its text content (full message).
</p>
<p>Execution time and some other details are also recorded.
</p>
<p>References for the jUnit XML format:
<a href="http://llg.cubic.org/docs/junit/">http://llg.cubic.org/docs/junit/</a>
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='ListReporter'>List reporter: gather all test results along with elapsed time and
file information.</h2><span id='topic+ListReporter'></span>

<h3>Description</h3>

<p>This reporter gathers all results, adding additional information such as
test elapsed time, and test filename if available. Very useful for reporting.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='local_edition'>Temporarily change the active testthat edition</h2><span id='topic+local_edition'></span><span id='topic+edition_get'></span>

<h3>Description</h3>

<p><code>local_edition()</code> allows you to temporarily (within a single test or
a single test file) change the active edition of testthat.
<code>edition_get()</code> allows you to retrieve the currently active edition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_edition(x, .env = parent.frame())

edition_get()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local_edition_+3A_x">x</code></td>
<td>
<p>Edition Should be a single integer.</p>
</td></tr>
<tr><td><code id="local_edition_+3A_.env">.env</code></td>
<td>
<p>Environment that controls scope of changes. For expert use only.</p>
</td></tr>
</table>

<hr>
<h2 id='local_mocked_bindings'>Mocking tools</h2><span id='topic+local_mocked_bindings'></span><span id='topic+with_mocked_bindings'></span>

<h3>Description</h3>

<p><code>with_mocked_bindings()</code> and <code>local_mocked_bindings()</code> provide tools for
&quot;mocking&quot;, temporarily redefining a function so that it behaves differently
during tests. This is helpful for testing functions that depend on external
state (i.e. reading a value from a file or a website, or pretending a package
is or isn't installed).
</p>
<p>These functions represent a second attempt at bringing mocking to testthat,
incorporating what we've learned from the mockr, mockery, and mockthat
packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_mocked_bindings(..., .package = NULL, .env = caller_env())

with_mocked_bindings(code, ..., .package = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local_mocked_bindings_+3A_...">...</code></td>
<td>
<p>Name-value pairs providing new values (typically functions) to
temporarily replace the named bindings.</p>
</td></tr>
<tr><td><code id="local_mocked_bindings_+3A_.package">.package</code></td>
<td>
<p>The name of the package where mocked functions should be
inserted. Generally, you should not supply this as it will be automatically
detected when whole package tests are run or when there's one package
under active development (i.e. loaded with <code><a href="pkgload.html#topic+load_all">pkgload::load_all()</a></code>).
We don't recommend using this to mock functions in other packages,
as you should not modify namespaces that you don't own.</p>
</td></tr>
<tr><td><code id="local_mocked_bindings_+3A_.env">.env</code></td>
<td>
<p>Environment that defines effect scope. For expert use only.</p>
</td></tr>
<tr><td><code id="local_mocked_bindings_+3A_code">code</code></td>
<td>
<p>Code to execute with specified bindings.</p>
</td></tr>
</table>


<h3>Use</h3>

<p>There are four places that the function you are trying to mock might
come from:
</p>

<ul>
<li><p> Internal to your package.
</p>
</li>
<li><p> Imported from an external package via the <code>NAMESPACE</code>.
</p>
</li>
<li><p> The base environment.
</p>
</li>
<li><p> Called from an external package with <code>::</code>.
</p>
</li></ul>

<p>They are described in turn below.
</p>


<h4>Internal &amp; imported functions</h4>

<p>You mock internal and imported functions the same way. For example, take
this code:
</p>
<div class="sourceCode R"><pre>some_function &lt;- function() {
  another_function()
}
</pre></div>
<p>It doesn't matter whether <code>another_function()</code> is defined by your package
or you've imported it from a dependency with <code style="white-space: pre;">&#8288;@import&#8288;</code> or <code style="white-space: pre;">&#8288;@importFrom&#8288;</code>,
you mock it the same way:
</p>
<div class="sourceCode R"><pre>local_mocked_bindings(
  another_function = function(...) "new_value"
)
</pre></div>



<h4>Base functions</h4>

<p>To mock a function in the base package, you need to make sure that you
have a binding for this function in your package. It's easiest to do this
by binding the value to <code>NULL</code>. For example, if you wanted to mock
<code>interactive()</code> in your package, you'd need to include this code somewhere
in your package:
</p>
<div class="sourceCode R"><pre>interactive &lt;- NULL
</pre></div>
<p>Why is this necessary? <code>with_mocked_bindings()</code> and <code>local_mocked_bindings()</code>
work by temporarily modifying the bindings within your package's namespace.
When these tests are running inside of <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> the namespace is locked
which means it's not possible to create new bindings so you need to make sure
that the binding exists already.
</p>



<h4>Namespaced calls</h4>

<p>It's trickier to mock functions in other packages that you call with <code>::</code>.
For example, take this minor variation:
</p>
<div class="sourceCode R"><pre>some_function &lt;- function() {
  anotherpackage::another_function()
}
</pre></div>
<p>To mock this function, you'd need to modify <code>another_function()</code> inside the
<code>anotherpackage</code> package. You <em>can</em> do this by supplying the <code>.package</code>
argument to <code>local_mocked_bindings()</code> but we don't recommend it because
it will affect all calls to <code>anotherpackage::another_function()</code>, not just
the calls originating in your package. Instead, it's safer to either import
the function into your package, or make a wrapper that you can mock:
</p>
<div class="sourceCode R"><pre>some_function &lt;- function() {
  my_wrapper()
}
my_wrapper &lt;- function(...) {
  anotherpackage::another_function(...)
}

local_mocked_bindings(
  my_wrapper = function(...) "new_value"
)
</pre></div>


<hr>
<h2 id='local_snapshotter'>Instantiate local snapshotting context</h2><span id='topic+local_snapshotter'></span>

<h3>Description</h3>

<p>Needed if you want to run snapshot tests outside of the usual testthat
framework For expert use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_snapshotter(
  snap_dir = NULL,
  cleanup = FALSE,
  fail_on_new = FALSE,
  .env = parent.frame()
)
</code></pre>

<hr>
<h2 id='local_test_context'>Locally set options for maximal test reproducibility</h2><span id='topic+local_test_context'></span><span id='topic+local_reproducible_output'></span>

<h3>Description</h3>

<p><code>local_test_context()</code> is run automatically by <code>test_that()</code> but you may
want to run it yourself if you want to replicate test results interactively.
If run inside a function, the effects are automatically reversed when the
function exits; if running in the global environment, use
<code><a href="withr.html#topic+defer">withr::deferred_run()</a></code> to undo.
</p>
<p><code>local_reproducible_output()</code> is run automatically by <code>test_that()</code> in the
3rd edition. You might want to call it to override the the default settings
inside a test, if you want to test Unicode, coloured output, or a
non-standard width.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_test_context(.env = parent.frame())

local_reproducible_output(
  width = 80,
  crayon = FALSE,
  unicode = FALSE,
  rstudio = FALSE,
  hyperlinks = FALSE,
  lang = "en",
  .env = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local_test_context_+3A_.env">.env</code></td>
<td>
<p>Environment to use for scoping; expert use only.</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_width">width</code></td>
<td>
<p>Value of the <code>"width"</code> option.</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_crayon">crayon</code></td>
<td>
<p>Determines whether or not crayon (now cli) colour
should be applied.</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_unicode">unicode</code></td>
<td>
<p>Value of the <code>"cli.unicode"</code> option.
The test is skipped if <code>l10n_info()$`UTF-8`</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_rstudio">rstudio</code></td>
<td>
<p>Should we pretend that we're inside of RStudio?</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_hyperlinks">hyperlinks</code></td>
<td>
<p>Should we use ANSI hyperlinks.</p>
</td></tr>
<tr><td><code id="local_test_context_+3A_lang">lang</code></td>
<td>
<p>Optionally, supply a BCP47 language code to set the language
used for translating error messages. This is a lower case two letter
<a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">ISO 639 country code</a>,
optionally followed by &quot;_&quot; or &quot;-&quot; and an upper case two letter
<a href="https://en.wikipedia.org/wiki/ISO_3166-2">ISO 3166 region code</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>local_test_context()</code> sets <code>TESTTHAT = "true"</code>, which ensures that
<code><a href="#topic+is_testing">is_testing()</a></code> returns <code>TRUE</code> and allows code to tell if it is run by
testthat.
</p>
<p>In the third edition, <code>local_test_context()</code> also calls
<code>local_reproducible_output()</code> which temporary sets the following options:
</p>

<ul>
<li> <p><code>cli.dynamic = FALSE</code> so that tests assume that they are not run in
a dynamic console (i.e. one where you can move the cursor around).
</p>
</li>
<li> <p><code>cli.unicode</code> (default: <code>FALSE</code>) so that the cli package never generates
unicode output (normally cli uses unicode on Linux/Mac but not Windows).
Windows can't easily save unicode output to disk, so it must be set to
false for consistency.
</p>
</li>
<li> <p><code>cli.condition_width = Inf</code> so that new lines introduced while
width-wrapping condition messages don't interfere with message matching.
</p>
</li>
<li> <p><code>crayon.enabled</code> (default: <code>FALSE</code>) suppresses ANSI colours generated by
the cli and crayon packages (normally colours are used if cli detects
that you're in a terminal that supports colour).
</p>
</li>
<li> <p><code>cli.num_colors</code> (default: <code>1L</code>) Same as the crayon option.
</p>
</li>
<li> <p><code>lifecycle_verbosity = "warning"</code> so that every lifecycle problem always
generates a warning (otherwise deprecated functions don't generate a
warning every time).
</p>
</li>
<li> <p><code>max.print = 99999</code> so the same number of values are printed.
</p>
</li>
<li> <p><code>OutDec = "."</code> so numbers always uses <code>.</code> as the decimal point
(European users sometimes set <code>OutDec = ","</code>).
</p>
</li>
<li> <p><code>rlang_interactive = FALSE</code> so that <code><a href="rlang.html#topic+is_interactive">rlang::is_interactive()</a></code> returns
<code>FALSE</code>, and code that uses it pretends you're in a non-interactive
environment.
</p>
</li>
<li> <p><code>useFancyQuotes = FALSE</code> so base R functions always use regular (straight)
quotes (otherwise the default is locale dependent, see <code><a href="base.html#topic+sQuote">sQuote()</a></code> for
details).
</p>
</li>
<li> <p><code>width</code> (default: 80) to control the width of printed output (usually this
varies with the size of your console).
</p>
</li></ul>

<p>And modifies the following env vars:
</p>

<ul>
<li><p> Unsets <code>RSTUDIO</code>, which ensures that RStudio is never detected as running.
</p>
</li>
<li><p> Sets <code>LANGUAGE = "en"</code>, which ensures that no message translation occurs.
</p>
</li></ul>

<p>Finally, it sets the collation locale to &quot;C&quot;, which ensures that character
sorting the same regardless of system locale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>local({
  local_test_context()
  cat(cli::col_blue("Text will not be colored"))
  cat(cli::symbol$ellipsis)
  cat("\n")
})
test_that("test ellipsis", {
  local_reproducible_output(unicode = FALSE)
  expect_equal(cli::symbol$ellipsis, "...")

  local_reproducible_output(unicode = TRUE)
  expect_equal(cli::symbol$ellipsis, "\u2026")
})
</code></pre>

<hr>
<h2 id='local_test_directory'>Locally set test directory options</h2><span id='topic+local_test_directory'></span>

<h3>Description</h3>

<p>For expert use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_test_directory(path, package = NULL, .env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="local_test_directory_+3A_path">path</code></td>
<td>
<p>Path to directory of files</p>
</td></tr>
<tr><td><code id="local_test_directory_+3A_package">package</code></td>
<td>
<p>Optional package name, if known.</p>
</td></tr>
</table>

<hr>
<h2 id='LocationReporter'>Test reporter: location</h2><span id='topic+LocationReporter'></span>

<h3>Description</h3>

<p>This reporter simply prints the location of every expectation and error.
This is useful if you're trying to figure out the source of a segfault,
or you want to figure out which code triggers a C/C++ breakpoint
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='logical-expectations'>Does code return <code>TRUE</code> or <code>FALSE</code>?</h2><span id='topic+logical-expectations'></span><span id='topic+expect_true'></span><span id='topic+expect_false'></span>

<h3>Description</h3>

<p>These are fall-back expectations that you can use when none of the other
more specific expectations apply. The disadvantage is that you may get
a less informative error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_true(object, info = NULL, label = NULL)

expect_false(object, info = NULL, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logical-expectations_+3A_object">object</code></td>
<td>
<p>Object to test.
</p>
<p>Supports limited unquoting to make it easier to generate readable failures
within a function or for loop. See <a href="#topic+quasi_label">quasi_label</a> for more details.</p>
</td></tr>
<tr><td><code id="logical-expectations_+3A_info">info</code></td>
<td>
<p>Extra information to be included in the message. This argument
is soft-deprecated and should not be used in new code. Instead see
alternatives in <a href="#topic+quasi_label">quasi_label</a>.</p>
</td></tr>
<tr><td><code id="logical-expectations_+3A_label">label</code></td>
<td>
<p>Used to customise failure messages. For expert use only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Attributes are ignored.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is_false">is_false()</a></code> for complement
</p>
<p>Other expectations: 
<code><a href="#topic+comparison-expectations">comparison-expectations</a></code>,
<code><a href="#topic+equality-expectations">equality-expectations</a></code>,
<code><a href="#topic+expect_error">expect_error</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+expect_named">expect_named</a>()</code>,
<code><a href="#topic+expect_null">expect_null</a>()</code>,
<code><a href="#topic+expect_output">expect_output</a>()</code>,
<code><a href="#topic+expect_reference">expect_reference</a>()</code>,
<code><a href="#topic+expect_silent">expect_silent</a>()</code>,
<code><a href="#topic+inheritance-expectations">inheritance-expectations</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_true(2 == 2)
# Failed expectations will throw an error
## Not run: 
expect_true(2 != 2)

## End(Not run)
expect_true(!(2 != 2))
# or better:
expect_false(2 != 2)

a &lt;- 1:3
expect_true(length(a) == 3)
# but better to use more specific expectation, if available
expect_equal(length(a), 3)
</code></pre>

<hr>
<h2 id='make_expectation'>Make an equality test.</h2><span id='topic+make_expectation'></span>

<h3>Description</h3>

<p>This a convenience function to make a expectation that checks that
input stays the same.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_expectation(x, expectation = "equals")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_expectation_+3A_x">x</code></td>
<td>
<p>a vector of values</p>
</td></tr>
<tr><td><code id="make_expectation_+3A_expectation">expectation</code></td>
<td>
<p>the type of equality you want to test for
(<code>"equals"</code>, <code>"is_equivalent_to"</code>, <code>"is_identical_to"</code>)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
make_expectation(x)

make_expectation(mtcars$mpg)

df &lt;- data.frame(x = 2)
make_expectation(df)
</code></pre>

<hr>
<h2 id='MinimalReporter'>Test reporter: minimal.</h2><span id='topic+MinimalReporter'></span>

<h3>Description</h3>

<p>The minimal test reporter provides the absolutely minimum amount of
information: whether each expectation has succeeded, failed or experienced
an error.  If you want to find out what the failures and errors actually
were, you'll need to run a more informative test reporter.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='MultiReporter'>Multi reporter: combine several reporters in one.</h2><span id='topic+MultiReporter'></span>

<h3>Description</h3>

<p>This reporter is useful to use several reporters at the same time, e.g.
adding a custom reporter without removing the current one.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='not'>Negate an expectation</h2><span id='topic+not'></span>

<h3>Description</h3>

<p>This negates an expectation, making it possible to express that you
want the opposite of a standard expectation. This function is deprecated
and will be removed in a future version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>not(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="not_+3A_f">f</code></td>
<td>
<p>an existing expectation function</p>
</td></tr>
</table>

<hr>
<h2 id='oldskool'>Old-style expectations.</h2><span id='topic+oldskool'></span><span id='topic+is_null'></span><span id='topic+is_a'></span><span id='topic+is_true'></span><span id='topic+is_false'></span><span id='topic+has_names'></span><span id='topic+is_less_than'></span><span id='topic+is_more_than'></span><span id='topic+equals'></span><span id='topic+is_equivalent_to'></span><span id='topic+is_identical_to'></span><span id='topic+equals_reference'></span><span id='topic+shows_message'></span><span id='topic+gives_warning'></span><span id='topic+prints_text'></span><span id='topic+throws_error'></span><span id='topic+matches'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>Initial testthat used a style of testing that looked like
<code style="white-space: pre;">&#8288;expect_that(a, equals(b)))&#8288;</code> this allowed expectations to read like
English sentences, but was verbose and a bit too cutesy. This style
will continue to work but has been soft-deprecated - it is no longer
documented, and new expectations will only use the new style
<code>expect_equal(a, b)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_null()

is_a(class)

is_true()

is_false()

has_names(expected, ignore.order = FALSE, ignore.case = FALSE)

is_less_than(expected, label = NULL, ...)

is_more_than(expected, label = NULL, ...)

equals(expected, label = NULL, ...)

is_equivalent_to(expected, label = NULL)

is_identical_to(expected, label = NULL)

equals_reference(file, label = NULL, ...)

shows_message(regexp = NULL, all = FALSE, ...)

gives_warning(regexp = NULL, all = FALSE, ...)

prints_text(regexp = NULL, ...)

throws_error(regexp = NULL, ...)

matches(regexp, all = TRUE, ...)
</code></pre>

<hr>
<h2 id='ProgressReporter'>Test reporter: interactive progress bar of errors.</h2><span id='topic+ProgressReporter'></span><span id='topic+CompactProgressReporter'></span><span id='topic+ParallelProgressReporter'></span>

<h3>Description</h3>

<p><code>ProgressReporter</code> is designed for interactive use. Its goal is to
give you actionable insights to help you understand the status of your
code. This reporter also praises you from time-to-time if all your tests
pass. It's the default reporter for <code><a href="#topic+test_dir">test_dir()</a></code>.
</p>
<p><code>ParallelProgressReporter</code> is very similar to <code>ProgressReporter</code>, but
works better for packages that want parallel tests.
</p>
<p><code>CompactProgressReporter</code> is a minimal version of <code>ProgressReporter</code>
designed for use with single files. It's the default reporter for
<code><a href="#topic+test_file">test_file()</a></code>.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='quasi_label'>Quasi-labelling</h2><span id='topic+quasi_label'></span>

<h3>Description</h3>

<p>The first argument to every <code>expect_</code> function can use unquoting to
construct better labels. This makes it easy to create informative labels when
expectations are used inside a function or a for loop. <code>quasi_label()</code> wraps
up the details, returning the expression and label.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quasi_label(quo, label = NULL, arg = "quo")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quasi_label_+3A_quo">quo</code></td>
<td>
<p>A quosure created by <code>rlang::enquo()</code>.</p>
</td></tr>
<tr><td><code id="quasi_label_+3A_label">label</code></td>
<td>
<p>An optional label to override the default. This is
only provided for internal usage. Modern expectations should not
include a <code>label</code> parameter.</p>
</td></tr>
<tr><td><code id="quasi_label_+3A_arg">arg</code></td>
<td>
<p>Argument name shown in error message if <code>quo</code> is missing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two elements:
</p>
<table>
<tr><td><code>val</code></td>
<td>
<p>The evaluate value of <code>quo</code></p>
</td></tr>
<tr><td><code>lab</code></td>
<td>
<p>The quasiquoted label generated from <code>quo</code></p>
</td></tr>
</table>


<h3>Limitations</h3>

<p>Because all <code>expect_</code> function use unquoting to generate more informative
labels, you can not use unquoting for other purposes. Instead, you'll need
to perform all other unquoting outside of the expectation and only test
the results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(i) if (i &gt; 3) i * 9 else i * 10
i &lt;- 10

# This sort of expression commonly occurs inside a for loop or function
# And the failure isn't helpful because you can't see the value of i
# that caused the problem:
show_failure(expect_equal(f(i), i * 10))

# To overcome this issue, testthat allows you to unquote expressions using
# !!. This causes the failure message to show the value rather than the
# variable name
show_failure(expect_equal(f(!!i), !!(i * 10)))
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='Reporter'>Manage test reporting</h2><span id='topic+Reporter'></span>

<h3>Description</h3>

<p>The job of a reporter is to aggregate the results from files, tests, and
expectations and display them in an informative way. Every testtthat function
that runs multiple tests provides a <code>reporter</code> argument which you can
use to override the default (which is selected by <code><a href="#topic+default_reporter">default_reporter()</a></code>).
</p>


<h3>Details</h3>

<p>You only need to use this <code>Reporter</code> object directly if you are creating
a new reporter. Currently, creating new Reporters is undocumented,
so if you want to create your own, you'll need to make sure that you're
familiar with <a href="https://adv-r.hadley.nz/R6.html">R6</a> and then need read the
source code for a few.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- testthat_example("success")

test_file(path)
# Override the default by supplying the name of a reporter
test_file(path, reporter = "minimal")
</code></pre>

<hr>
<h2 id='reporter-accessors'>Get and set active reporter.</h2><span id='topic+reporter-accessors'></span><span id='topic+set_reporter'></span><span id='topic+get_reporter'></span><span id='topic+with_reporter'></span>

<h3>Description</h3>

<p><code>get_reporter()</code> and <code>set_reporter()</code> access and modify the current &quot;active&quot;
reporter. Generally, these functions should not be called directly; instead
use <code>with_reporter()</code> to temporarily change, then reset, the active reporter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_reporter(reporter)

get_reporter()

with_reporter(reporter, code, start_end_reporter = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reporter-accessors_+3A_reporter">reporter</code></td>
<td>
<p>Reporter to use to summarise output. Can be supplied
as a string (e.g. &quot;summary&quot;) or as an R6 object
(e.g. <code>SummaryReporter$new()</code>).
</p>
<p>See <a href="#topic+Reporter">Reporter</a> for more details and a list of built-in reporters.</p>
</td></tr>
<tr><td><code id="reporter-accessors_+3A_code">code</code></td>
<td>
<p>Code to execute.</p>
</td></tr>
<tr><td><code id="reporter-accessors_+3A_start_end_reporter">start_end_reporter</code></td>
<td>
<p>Should the reporters <code>start_reporter()</code> and
<code>end_reporter()</code> methods be called? For expert use only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>with_reporter()</code> invisible returns the reporter active when <code>code</code>
was evaluated.
</p>

<hr>
<h2 id='RStudioReporter'>Test reporter: RStudio</h2><span id='topic+RStudioReporter'></span>

<h3>Description</h3>

<p>This reporter is designed for output to RStudio. It produces results in
any easily parsed form.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='set_max_fails'>Set maximum number of test failures allowed before aborting the run</h2><span id='topic+set_max_fails'></span>

<h3>Description</h3>

<p>This sets the <code>TESTTHAT_MAX_FAILS</code> env var which will affect both the
current R process and any processes launched from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_max_fails(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_max_fails_+3A_n">n</code></td>
<td>
<p>Maximum number of failures allowed.</p>
</td></tr>
</table>

<hr>
<h2 id='set_state_inspector'>State inspected</h2><span id='topic+set_state_inspector'></span>

<h3>Description</h3>

<p>One of the most pernicious challenges to debug is when a test runs fine
in your test suite, but fails when you run it interactively (or similarly,
it fails randomly when running your tests in parallel). One of the most
common causes of this problem is accidentally changing global state in a
previous test (e.g. changing an option, an environment variable, or the
working directory). This is hard to debug, because it's very hard to figure
out which test made the change.
</p>
<p>Luckily testthat provides a tool to figure out if tests are changing global
state. You can register a state inspector with <code>set_state_inspector()</code> and
testthat will run it before and after each test, store the results, then
report if there are any differences. For example, if you wanted to see if
any of your tests were changing options or environment variables, you could
put this code in <code>tests/testthat/helper-state.R</code>:
</p>
<div class="sourceCode R"><pre>set_state_inspector(function() {
  list(
    options = options(),
    envvars = Sys.getenv()
  )
})
</pre></div>
<p>(You might discover other packages outside your control are changing
the global state, in which case you might want to modify this function
to ignore those values.)
</p>
<p>Other problems that can be troublesome to resolve are CRAN check notes that
report things like connections being left open. You can easily debug
that problem with:
</p>
<div class="sourceCode R"><pre>set_state_inspector(function() {
  getAllConnections()
})
</pre></div>


<h3>Usage</h3>

<pre><code class='language-R'>set_state_inspector(callback)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_state_inspector_+3A_callback">callback</code></td>
<td>
<p>Either a zero-argument function that returns an object
capturing global state that you're interested in, or <code>NULL</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='SilentReporter'>Test reporter: gather all errors silently.</h2><span id='topic+SilentReporter'></span>

<h3>Description</h3>

<p>This reporter quietly runs all tests, simply gathering all expectations.
This is helpful for programmatically inspecting errors after a test run.
You can retrieve the results with the <code>expectations()</code>
method.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='skip'>Skip a test</h2><span id='topic+skip'></span><span id='topic+skip_if_not'></span><span id='topic+skip_if'></span><span id='topic+skip_if_not_installed'></span><span id='topic+skip_if_offline'></span><span id='topic+skip_on_cran'></span><span id='topic+skip_on_os'></span><span id='topic+skip_on_ci'></span><span id='topic+skip_on_covr'></span><span id='topic+skip_on_bioc'></span><span id='topic+skip_if_translated'></span>

<h3>Description</h3>

<p><code>skip_if()</code> and <code>skip_if_not()</code> allow you to skip tests, immediately
concluding a <code><a href="#topic+test_that">test_that()</a></code> block without executing any further expectations.
This allows you to skip a test without failure, if for some reason it
can't be run (e.g. it depends on the feature of a specific operating system,
or it requires a specific version of a package).
</p>
<p>See <code>vignette("skipping")</code> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skip(message = "Skipping")

skip_if_not(condition, message = NULL)

skip_if(condition, message = NULL)

skip_if_not_installed(pkg, minimum_version = NULL)

skip_if_offline(host = "captive.apple.com")

skip_on_cran()

skip_on_os(os, arch = NULL)

skip_on_ci()

skip_on_covr()

skip_on_bioc()

skip_if_translated(msgid = "'%s' not found")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skip_+3A_message">message</code></td>
<td>
<p>A message describing why the test was skipped.</p>
</td></tr>
<tr><td><code id="skip_+3A_condition">condition</code></td>
<td>
<p>Boolean condition to check. <code>skip_if_not()</code> will skip if
<code>FALSE</code>, <code>skip_if()</code> will skip if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="skip_+3A_pkg">pkg</code></td>
<td>
<p>Name of package to check for</p>
</td></tr>
<tr><td><code id="skip_+3A_minimum_version">minimum_version</code></td>
<td>
<p>Minimum required version for the package</p>
</td></tr>
<tr><td><code id="skip_+3A_host">host</code></td>
<td>
<p>A string with a hostname to lookup</p>
</td></tr>
<tr><td><code id="skip_+3A_os">os</code></td>
<td>
<p>Character vector of one or more operating systems to skip on.
Supported values are <code>"windows"</code>, <code>"mac"</code>, <code>"linux"</code>, and <code>"solaris"</code>.</p>
</td></tr>
<tr><td><code id="skip_+3A_arch">arch</code></td>
<td>
<p>Character vector of one or more architectures to skip on.
Common values include <code>"i386"</code> (32 bit), <code>"x86_64"</code> (64 bit), and
<code>"aarch64"</code> (M1 mac). Supplying <code>arch</code> makes the test stricter; i.e. both
<code>os</code> and <code>arch</code> must match in order for the test to be skipped.</p>
</td></tr>
<tr><td><code id="skip_+3A_msgid">msgid</code></td>
<td>
<p>R message identifier used to check for translation: the default
uses a message included in most translation packs. See the complete list in
<a href="https://github.com/wch/r-source/blob/master/src/library/base/po/R-base.pot"><code>R-base.pot</code></a>.</p>
</td></tr>
</table>


<h3>Helpers</h3>


<ul>
<li> <p><code>skip_if_not_installed("pkg")</code> skips tests if package &quot;pkg&quot; is not
installed or cannot be loaded (using <code>requireNamespace()</code>). Generally,
you can assume that suggested packages are installed, and you do not
need to check for them specifically, unless they are particularly
difficult to install.
</p>
</li>
<li> <p><code>skip_if_offline()</code> skips if an internet connection is not available
(using <code><a href="curl.html#topic+nslookup">curl::nslookup()</a></code>) or if the test is run on CRAN. Requires
the curl packages to be installed.
</p>
</li>
<li> <p><code>skip_if_translated("msg")</code> skips tests if the &quot;msg&quot; is translated.
</p>
</li>
<li> <p><code>skip_on_bioc()</code> skips on Bioconductor (using the <code>IS_BIOC_BUILD_MACHINE</code>
env var).
</p>
</li>
<li> <p><code>skip_on_cran()</code> skips on CRAN (using the <code>NOT_CRAN</code> env var set by
devtools and friends).
</p>
</li>
<li> <p><code>skip_on_covr()</code> skips when covr is running (using the <code>R_COVR</code> env var).
</p>
</li>
<li> <p><code>skip_on_ci()</code> skips on continuous integration systems like GitHub Actions,
travis, and appveyor (using the <code>CI</code> env var).
</p>
</li>
<li> <p><code>skip_on_os()</code> skips on the specified operating system(s) (&quot;windows&quot;,
&quot;mac&quot;, &quot;linux&quot;, or &quot;solaris&quot;).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>if (FALSE) skip("Some Important Requirement is not available")

test_that("skip example", {
  expect_equal(1, 1L)    # this expectation runs
  skip('skip')
  expect_equal(1, 2)     # this one skipped
  expect_equal(1, 3)     # this one is also skipped
})
</code></pre>

<hr>
<h2 id='skip_on_travis'>Superseded skip functions</h2><span id='topic+skip_on_travis'></span><span id='topic+skip_on_appveyor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>

<ul>
<li> <p><code>skip_on_travis()</code> and <code>skip_on_appveyor()</code> have been superseded by
<code><a href="#topic+skip_on_ci">skip_on_ci()</a></code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>skip_on_travis()

skip_on_appveyor()
</code></pre>

<hr>
<h2 id='snapshot_accept'>Snapshot management</h2><span id='topic+snapshot_accept'></span><span id='topic+snapshot_review'></span>

<h3>Description</h3>


<ul>
<li> <p><code>snapshot_accept()</code> accepts all modified snapshots.
</p>
</li>
<li> <p><code>snapshot_review()</code> opens a Shiny app that shows a visual diff of each
modified snapshot. This is particularly useful for whole file snapshots
created by <code>expect_snapshot_file()</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>snapshot_accept(files = NULL, path = "tests/testthat")

snapshot_review(files = NULL, path = "tests/testthat")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snapshot_accept_+3A_files">files</code></td>
<td>
<p>Optionally, filter effects to snapshots from specified files.
This can be a snapshot name (e.g. <code>foo</code> or <code>foo.md</code>), a snapshot file name
(e.g. <code>testfile/foo.txt</code>), or a snapshot file directory (e.g. <code style="white-space: pre;">&#8288;testfile/&#8288;</code>).</p>
</td></tr>
<tr><td><code id="snapshot_accept_+3A_path">path</code></td>
<td>
<p>Path to tests.</p>
</td></tr>
</table>

<hr>
<h2 id='source_file'>Source a file, directory of files, or various important subsets</h2><span id='topic+source_file'></span><span id='topic+source_dir'></span><span id='topic+source_test_helpers'></span><span id='topic+source_test_setup'></span><span id='topic+source_test_teardown'></span>

<h3>Description</h3>

<p>These are used by <code><a href="#topic+test_dir">test_dir()</a></code> and friends
</p>


<h3>Usage</h3>

<pre><code class='language-R'>source_file(
  path,
  env = test_env(),
  chdir = TRUE,
  desc = NULL,
  wrap = TRUE,
  error_call = caller_env()
)

source_dir(
  path,
  pattern = "\\.[rR]$",
  env = test_env(),
  chdir = TRUE,
  wrap = TRUE
)

source_test_helpers(path = "tests/testthat", env = test_env())

source_test_setup(path = "tests/testthat", env = test_env())

source_test_teardown(path = "tests/testthat", env = test_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="source_file_+3A_path">path</code></td>
<td>
<p>Path to files.</p>
</td></tr>
<tr><td><code id="source_file_+3A_env">env</code></td>
<td>
<p>Environment in which to evaluate code.</p>
</td></tr>
<tr><td><code id="source_file_+3A_chdir">chdir</code></td>
<td>
<p>Change working directory to <code>dirname(path)</code>?</p>
</td></tr>
<tr><td><code id="source_file_+3A_desc">desc</code></td>
<td>
<p>If not-<code>NULL</code>, will run only test with this <code>desc</code>ription.</p>
</td></tr>
<tr><td><code id="source_file_+3A_wrap">wrap</code></td>
<td>
<p>Automatically wrap all code within <code><a href="#topic+test_that">test_that()</a></code>? This ensures
that all expectations are reported, even if outside a test block.</p>
</td></tr>
<tr><td><code id="source_file_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression used to filter files.</p>
</td></tr>
</table>

<hr>
<h2 id='StopReporter'>Test reporter: stop on error</h2><span id='topic+StopReporter'></span>

<h3>Description</h3>

<p>The default reporter used when <code><a href="#topic+expect_that">expect_that()</a></code> is run interactively.
It responds by <code><a href="base.html#topic+stop">stop()</a></code>ping on failures and doing nothing otherwise. This
will ensure that a failing test will raise an error.
</p>


<h3>Details</h3>

<p>This should be used when doing a quick and dirty test, or during the final
automated testing of R CMD check.  Otherwise, use a reporter that runs all
tests and gives you more context about the problem.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='SummaryReporter'>Test reporter: summary of errors.</h2><span id='topic+SummaryReporter'></span>

<h3>Description</h3>

<p>This is a reporter designed for interactive usage: it lets you know which
tests have run successfully and as well as fully reporting information about
failures and errors.
</p>


<h3>Details</h3>

<p>You can use the <code>max_reports</code> field to control the maximum number
of detailed reports produced by this reporter. This is useful when running
with <code><a href="#topic+auto_test">auto_test()</a></code>
</p>
<p>As an additional benefit, this reporter will praise you from time-to-time
if all your tests pass.
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='takes_less_than'>Does code take less than the expected amount of time to run?</h2><span id='topic+takes_less_than'></span>

<h3>Description</h3>

<p>This is useful for performance regression testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>takes_less_than(amount)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="takes_less_than_+3A_amount">amount</code></td>
<td>
<p>maximum duration in seconds</p>
</td></tr>
</table>

<hr>
<h2 id='TapReporter'>Test reporter: TAP format.</h2><span id='topic+TapReporter'></span>

<h3>Description</h3>

<p>This reporter will output results in the Test Anything Protocol (TAP),
a simple text-based interface between testing modules in a test harness.
For more information about TAP, see http://testanything.org
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TeamcityReporter">TeamcityReporter</a></code>
</p>

<hr>
<h2 id='TeamcityReporter'>Test reporter: Teamcity format.</h2><span id='topic+TeamcityReporter'></span>

<h3>Description</h3>

<p>This reporter will output results in the Teamcity message format.
For more information about Teamcity messages, see
http://confluence.jetbrains.com/display/TCD7/Build+Script+Interaction+with+TeamCity
</p>


<h3>See Also</h3>

<p>Other reporters: 
<code><a href="#topic+CheckReporter">CheckReporter</a></code>,
<code><a href="#topic+DebugReporter">DebugReporter</a></code>,
<code><a href="#topic+FailReporter">FailReporter</a></code>,
<code><a href="#topic+JunitReporter">JunitReporter</a></code>,
<code><a href="#topic+ListReporter">ListReporter</a></code>,
<code><a href="#topic+LocationReporter">LocationReporter</a></code>,
<code><a href="#topic+MinimalReporter">MinimalReporter</a></code>,
<code><a href="#topic+MultiReporter">MultiReporter</a></code>,
<code><a href="#topic+ProgressReporter">ProgressReporter</a></code>,
<code><a href="#topic+RStudioReporter">RStudioReporter</a></code>,
<code><a href="#topic+Reporter">Reporter</a></code>,
<code><a href="#topic+SilentReporter">SilentReporter</a></code>,
<code><a href="#topic+StopReporter">StopReporter</a></code>,
<code><a href="#topic+SummaryReporter">SummaryReporter</a></code>,
<code><a href="#topic+TapReporter">TapReporter</a></code>
</p>

<hr>
<h2 id='teardown'>Run code before/after tests</h2><span id='topic+teardown'></span><span id='topic+setup'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>We no longer recommend using <code>setup()</code> and <code>teardown()</code>; instead
we think it's better practice to use a <strong>test fixture</strong> as described in
<code>vignette("test-fixtures")</code>.
</p>
<p>Code in a <code>setup()</code> block is run immediately in a clean environment.
Code in a <code>teardown()</code> block is run upon completion of a test file,
even if it exits with an error. Multiple calls to <code>teardown()</code> will be
executed in the order they were created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>teardown(code, env = parent.frame())

setup(code, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="teardown_+3A_code">code</code></td>
<td>
<p>Code to evaluate</p>
</td></tr>
<tr><td><code id="teardown_+3A_env">env</code></td>
<td>
<p>Environment in which code will be evaluated. For expert
use only.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Old approach
tmp &lt;- tempfile()
setup(writeLines("some test data", tmp))
teardown(unlink(tmp))

## End(Not run)

# Now recommended:
local_test_data &lt;- function(env = parent.frame()) {
  tmp &lt;- tempfile()
  writeLines("some test data", tmp)
  withr::defer(unlink(tmp), env)

  tmp
}
# Then call local_test_data() in your tests
</code></pre>

<hr>
<h2 id='teardown_env'>Run code after all test files</h2><span id='topic+teardown_env'></span>

<h3>Description</h3>

<p>This environment has no purpose other than as a handle for <code><a href="withr.html#topic+defer">withr::defer()</a></code>:
use it when you want to run code after all tests have been run.
Typically, you'll use <code>withr::defer(cleanup(), teardown_env())</code>
immediately after you've made a mess in a <code style="white-space: pre;">&#8288;setup-*.R&#8288;</code> file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>teardown_env()
</code></pre>

<hr>
<h2 id='test_dir'>Run all tests in a directory</h2><span id='topic+test_dir'></span>

<h3>Description</h3>

<p>This function is the low-level workhorse that powers <code><a href="#topic+test_local">test_local()</a></code> and
<code><a href="#topic+test_package">test_package()</a></code>. Generally, you should not call this function directly.
In particular, you are responsible for ensuring that the functions to test
are available in the test <code>env</code> (e.g. via <code>load_package</code>).
</p>
<p>See <code>vignette("special-files")</code> to learn more about the conventions for test,
helper, and setup files that testthat uses, and what you might use each for.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_dir(
  path,
  filter = NULL,
  reporter = NULL,
  env = NULL,
  ...,
  load_helpers = TRUE,
  stop_on_failure = TRUE,
  stop_on_warning = FALSE,
  wrap = lifecycle::deprecated(),
  package = NULL,
  load_package = c("none", "installed", "source")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_dir_+3A_path">path</code></td>
<td>
<p>Path to directory containing tests.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_filter">filter</code></td>
<td>
<p>If not <code>NULL</code>, only tests with file names matching this
regular expression will be executed. Matching is performed on the file
name after it's stripped of <code>"test-"</code> and <code>".R"</code>.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_reporter">reporter</code></td>
<td>
<p>Reporter to use to summarise output. Can be supplied
as a string (e.g. &quot;summary&quot;) or as an R6 object
(e.g. <code>SummaryReporter$new()</code>).
</p>
<p>See <a href="#topic+Reporter">Reporter</a> for more details and a list of built-in reporters.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_env">env</code></td>
<td>
<p>Environment in which to execute the tests. Expert use only.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+grepl">grepl()</a></code> to control filtering.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_load_helpers">load_helpers</code></td>
<td>
<p>Source helper files before running the tests?</p>
</td></tr>
<tr><td><code id="test_dir_+3A_stop_on_failure">stop_on_failure</code></td>
<td>
<p>If <code>TRUE</code>, throw an error if any tests fail.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_stop_on_warning">stop_on_warning</code></td>
<td>
<p>If <code>TRUE</code>, throw an error if any tests generate
warnings.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_wrap">wrap</code></td>
<td>
<p>DEPRECATED</p>
</td></tr>
<tr><td><code id="test_dir_+3A_package">package</code></td>
<td>
<p>If these tests belong to a package, the name of the package.</p>
</td></tr>
<tr><td><code id="test_dir_+3A_load_package">load_package</code></td>
<td>
<p>Strategy to use for load package code:
</p>

<ul>
<li><p> &quot;none&quot;, the default, doesn't load the package.
</p>
</li>
<li><p> &quot;installed&quot;, uses <code><a href="base.html#topic+library">library()</a></code> to load an installed package.
</p>
</li>
<li><p> &quot;source&quot;, uses <code><a href="pkgload.html#topic+load_all">pkgload::load_all()</a></code> to a source package.
To configure the arguments passed to <code>load_all()</code>, add this
field in your DESCRIPTION file:
</p>
<div class="sourceCode"><pre>Config/testthat/load-all: list(export_all = FALSE, helpers = FALSE)
</pre></div>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A list (invisibly) containing data about the test results.
</p>


<h3>Environments</h3>

<p>Each test is run in a clean environment to keep tests as isolated as
possible. For package tests, that environment inherits from the package's
namespace environment, so that tests can access internal functions
and objects.
</p>

<hr>
<h2 id='test_env'>Generate default testing environment.</h2><span id='topic+test_env'></span>

<h3>Description</h3>

<p>We use a new environment which inherits from <code><a href="base.html#topic+globalenv">globalenv()</a></code> or a package
namespace. In an ideal world, we'd avoid putting the global environment on
the search path for tests, but it's not currently possible without losing
the ability to load packages in tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_env(package = NULL)
</code></pre>

<hr>
<h2 id='test_examples'>Test package examples</h2><span id='topic+test_examples'></span><span id='topic+test_rd'></span><span id='topic+test_example'></span>

<h3>Description</h3>

<p>These helper functions make it easier to test the examples in a package.
Each example counts as one test, and it succeeds if the code runs without
an error. Generally, this is redundant with R CMD check, and is not
recommended in routine practice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_examples(path = "../..")

test_rd(rd, title = attr(rd, "Rdfile"))

test_example(path, title = path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_examples_+3A_path">path</code></td>
<td>
<p>For <code>test_examples()</code>, path to directory containing Rd files.
For <code>test_example()</code>, path to a single Rd file. Remember the working
directory for tests is <code>tests/testthat</code>.</p>
</td></tr>
<tr><td><code id="test_examples_+3A_rd">rd</code></td>
<td>
<p>A parsed Rd object, obtained from <code><a href="tools.html#topic+Rdutils">tools::Rd_db()</a></code> or otherwise.</p>
</td></tr>
<tr><td><code id="test_examples_+3A_title">title</code></td>
<td>
<p>Test title to use</p>
</td></tr>
</table>

<hr>
<h2 id='test_file'>Run tests in a single file</h2><span id='topic+test_file'></span>

<h3>Description</h3>

<p>Helper, setup, and teardown files located in the same directory as the
test will also be run. See <code>vignette("special-files")</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_file(
  path,
  reporter = default_compact_reporter(),
  desc = NULL,
  package = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_file_+3A_path">path</code></td>
<td>
<p>Path to file.</p>
</td></tr>
<tr><td><code id="test_file_+3A_reporter">reporter</code></td>
<td>
<p>Reporter to use to summarise output. Can be supplied
as a string (e.g. &quot;summary&quot;) or as an R6 object
(e.g. <code>SummaryReporter$new()</code>).
</p>
<p>See <a href="#topic+Reporter">Reporter</a> for more details and a list of built-in reporters.</p>
</td></tr>
<tr><td><code id="test_file_+3A_desc">desc</code></td>
<td>
<p>Optionally, supply a string here to run only a single
test (<code>test_that()</code> or <code>describe()</code>) with this <code>desc</code>ription.</p>
</td></tr>
<tr><td><code id="test_file_+3A_package">package</code></td>
<td>
<p>If these tests belong to a package, the name of the package.</p>
</td></tr>
<tr><td><code id="test_file_+3A_...">...</code></td>
<td>
<p>Additional parameters passed on to <code>test_dir()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list (invisibly) containing data about the test results.
</p>


<h3>Environments</h3>

<p>Each test is run in a clean environment to keep tests as isolated as
possible. For package tests, that environment inherits from the package's
namespace environment, so that tests can access internal functions
and objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- testthat_example("success")
test_file(path)
test_file(path, desc = "some tests have warnings")
test_file(path, reporter = "minimal")
</code></pre>

<hr>
<h2 id='test_package'>Run all tests in a package</h2><span id='topic+test_package'></span><span id='topic+test_check'></span><span id='topic+test_local'></span>

<h3>Description</h3>


<ul>
<li> <p><code>test_local()</code> tests a local source package.
</p>
</li>
<li> <p><code>test_package()</code> tests an installed package.
</p>
</li>
<li> <p><code>test_check()</code> checks a package during <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>.
</p>
</li></ul>

<p>See <code>vignette("special-files")</code> to learn about the various files that
testthat works with.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_package(package, reporter = check_reporter(), ...)

test_check(package, reporter = check_reporter(), ...)

test_local(path = ".", reporter = NULL, ..., load_package = "source")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_package_+3A_package">package</code></td>
<td>
<p>If these tests belong to a package, the name of the package.</p>
</td></tr>
<tr><td><code id="test_package_+3A_reporter">reporter</code></td>
<td>
<p>Reporter to use to summarise output. Can be supplied
as a string (e.g. &quot;summary&quot;) or as an R6 object
(e.g. <code>SummaryReporter$new()</code>).
</p>
<p>See <a href="#topic+Reporter">Reporter</a> for more details and a list of built-in reporters.</p>
</td></tr>
<tr><td><code id="test_package_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+test_dir">test_dir()</a></code></p>
</td></tr>
<tr><td><code id="test_package_+3A_path">path</code></td>
<td>
<p>Path to directory containing tests.</p>
</td></tr>
<tr><td><code id="test_package_+3A_load_package">load_package</code></td>
<td>
<p>Strategy to use for load package code:
</p>

<ul>
<li><p> &quot;none&quot;, the default, doesn't load the package.
</p>
</li>
<li><p> &quot;installed&quot;, uses <code><a href="base.html#topic+library">library()</a></code> to load an installed package.
</p>
</li>
<li><p> &quot;source&quot;, uses <code><a href="pkgload.html#topic+load_all">pkgload::load_all()</a></code> to a source package.
To configure the arguments passed to <code>load_all()</code>, add this
field in your DESCRIPTION file:
</p>
<div class="sourceCode"><pre>Config/testthat/load-all: list(export_all = FALSE, helpers = FALSE)
</pre></div>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A list (invisibly) containing data about the test results.
</p>


<h3><code style="white-space: pre;">&#8288;R CMD check&#8288;</code></h3>

<p>To run testthat automatically from <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>, make sure you have
a <code>tests/testthat.R</code> that contains:
</p>
<div class="sourceCode"><pre>library(testthat)
library(yourpackage)

test_check("yourpackage")
</pre></div>


<h3>Environments</h3>

<p>Each test is run in a clean environment to keep tests as isolated as
possible. For package tests, that environment inherits from the package's
namespace environment, so that tests can access internal functions
and objects.
</p>

<hr>
<h2 id='test_path'>Locate a file in the testing directory</h2><span id='topic+test_path'></span>

<h3>Description</h3>

<p>Many tests require some external file (e.g. a <code>.csv</code> if you're testing a
data import function) but the working directory varies depending on the way
that you're running the test (e.g. interactively, with <code>devtools::test()</code>,
or with <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>). <code>test_path()</code> understands these variations and
automatically generates a path relative to <code>tests/testthat</code>, regardless of
where that directory might reside relative to the current working directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_path(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_path_+3A_...">...</code></td>
<td>
<p>Character vectors giving path components.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector giving the path.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
test_path("foo.csv")
test_path("data", "foo.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='test_that'>Run a test</h2><span id='topic+test_that'></span>

<h3>Description</h3>

<p>A test encapsulates a series of expectations about a small, self-contained
unit of functionality. Each test contains one or more expectations, such as
<code><a href="#topic+expect_equal">expect_equal()</a></code> or <code><a href="#topic+expect_error">expect_error()</a></code>, and lives in a <code style="white-space: pre;">&#8288;test/testhat/test*&#8288;</code>
file, often together with other tests that relate to the same function or set
of functions.
</p>
<p>Each test has its own execution environment, so an object created in a test
also dies with the test. Note that this cleanup does not happen automatically
for other aspects of global state, such as session options or filesystem
changes. Avoid changing global state, when possible, and reverse any changes
that you do make.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_that(desc, code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_that_+3A_desc">desc</code></td>
<td>
<p>Test name. Names should be brief, but evocative. It's common to
write the description so that it reads like a natural sentence, e.g.
<code>test_that("multiplication works", { ... })</code>.</p>
</td></tr>
<tr><td><code id="test_that_+3A_code">code</code></td>
<td>
<p>Test code containing expectations. Braces (<code>{}</code>) should always
be used in order to get accurate location data for test failures.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When run interactively, returns <code>invisible(TRUE)</code> if all tests
pass, otherwise throws an error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test_that("trigonometric functions match identities", {
  expect_equal(sin(pi / 4), 1 / sqrt(2))
  expect_equal(cos(pi / 4), 1 / sqrt(2))
  expect_equal(tan(pi / 4), 1)
})

## Not run: 
test_that("trigonometric functions match identities", {
  expect_equal(sin(pi / 4), 1)
})

## End(Not run)
</code></pre>

<hr>
<h2 id='testthat_examples'>Retrieve paths to built-in example test files</h2><span id='topic+testthat_examples'></span><span id='topic+testthat_example'></span>

<h3>Description</h3>

<p><code>testthat_examples()</code> retrieves path to directory of test files,
<code>testthat_example()</code> retrieves path to a single test file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testthat_examples()

testthat_example(filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testthat_examples_+3A_filename">filename</code></td>
<td>
<p>Name of test file</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dir(testthat_examples())
testthat_example("success")
</code></pre>

<hr>
<h2 id='testthat_results'>Create a <code>testthat_results</code> object from the test results
as stored in the ListReporter results field.</h2><span id='topic+testthat_results'></span>

<h3>Description</h3>

<p>Create a <code>testthat_results</code> object from the test results
as stored in the ListReporter results field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testthat_results(results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testthat_results_+3A_results">results</code></td>
<td>
<p>a list as stored in ListReporter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>its list argument as a <code>testthat_results</code> object
</p>


<h3>See Also</h3>

<p>ListReporter
</p>

<hr>
<h2 id='testthat_tolerance'>Default numeric tolerance</h2><span id='topic+testthat_tolerance'></span>

<h3>Description</h3>

<p>testthat's default numeric tolerance is 1.4901161 × 10<sup>-8</sup>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testthat_tolerance()
</code></pre>

<hr>
<h2 id='testthat-package'>An R package to make testing fun!</h2><span id='topic+testthat'></span><span id='topic+testthat-package'></span>

<h3>Description</h3>

<p>Try the example below. Have a look at the references and learn more
from function documentation such as <code><a href="#topic+test_that">test_that()</a></code>.
</p>


<h3>Options</h3>


<ul>
<li> <p><code>testthat.use_colours</code>: Should the output be coloured? (Default: <code>TRUE</code>).
</p>
</li>
<li> <p><code>testthat.summary.max_reports</code>: The maximum number of detailed test
reports printed for the summary reporter (default: 10).
</p>
</li>
<li> <p><code>testthat.summary.omit_dots</code>: Omit progress dots in the summary reporter
(default: <code>FALSE</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hadley Wickham <a href="mailto:hadley@posit.co">hadley@posit.co</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li>
<li><p> R Core team (Implementation of utils::recover()) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://testthat.r-lib.org">https://testthat.r-lib.org</a>
</p>
</li>
<li> <p><a href="https://github.com/r-lib/testthat">https://github.com/r-lib/testthat</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/testthat/issues">https://github.com/r-lib/testthat/issues</a>
</p>
</li></ul>


<hr>
<h2 id='try_again'>Try evaluating an expressing multiple times until it succeeds.</h2><span id='topic+try_again'></span>

<h3>Description</h3>

<p>Try evaluating an expressing multiple times until it succeeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try_again(times, code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="try_again_+3A_times">times</code></td>
<td>
<p>Maximum number of attempts.</p>
</td></tr>
<tr><td><code id="try_again_+3A_code">code</code></td>
<td>
<p>Code to evaluate</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>third_try &lt;- local({
  i &lt;- 3
  function() {
    i &lt;&lt;- i - 1
    if (i &gt; 0) fail(paste0("i is ", i))
  }
})
try_again(3, third_try())
</code></pre>

<hr>
<h2 id='use_catch'>Use Catch for C++ Unit Testing</h2><span id='topic+use_catch'></span>

<h3>Description</h3>

<p>Add the necessary infrastructure to enable C++ unit testing
in <span class="rlang"><b>R</b></span> packages with <a href="https://github.com/catchorg/Catch2">Catch</a> and
<code>testthat</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_catch(dir = getwd())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_catch_+3A_dir">dir</code></td>
<td>
<p>The directory containing an <span class="rlang"><b>R</b></span> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling <code>use_catch()</code> will:
</p>

<ol>
<li><p> Create a file <code>src/test-runner.cpp</code>, which ensures that the
<code>testthat</code> package will understand how to run your package's
unit tests,
</p>
</li>
<li><p> Create an example test file <code>src/test-example.cpp</code>, which
showcases how you might use Catch to write a unit test,
</p>
</li>
<li><p> Add a test file <code>tests/testthat/test-cpp.R</code>, which ensures that
<code>testthat</code> will run your compiled tests during invocations of
<code>devtools::test()</code> or <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>, and
</p>
</li>
<li><p> Create a file <code>R/catch-routine-registration.R</code>, which ensures that
<span class="rlang"><b>R</b></span> will automatically register this routine when
<code>tools::package_native_routine_registration_skeleton()</code> is invoked.
</p>
</li></ol>

<p>You will also need to:
</p>

<ul>
<li><p> Add xml2 to Suggests, with e.g. <code>usethis::use_package("xml2", "Suggests")</code>
</p>
</li>
<li><p> Add testthat to LinkingTo, with e.g.
<code>usethis::use_package("testthat", "LinkingTo")</code>
</p>
</li></ul>

<p>C++ unit tests can be added to C++ source files within the
<code>src</code> directory of your package, with a format similar
to <span class="rlang"><b>R</b></span> code tested with <code>testthat</code>. Here's a simple example
of a unit test written with <code>testthat</code> + Catch:
</p>
<pre>
context("C++ Unit Test") {
  test_that("two plus two is four") {
    int result = 2 + 2;
    expect_true(result == 4);
  }
}
</pre>
<p>When your package is compiled, unit tests alongside a harness
for running these tests will be compiled into your <span class="rlang"><b>R</b></span> package,
with the C entry point <code>run_testthat_tests()</code>. <code>testthat</code>
will use that entry point to run your unit tests when detected.
</p>


<h3>Functions</h3>

<p>All of the functions provided by Catch are
available with the <code>CATCH_</code> prefix &ndash; see
<a href="https://github.com/catchorg/Catch2/blob/master/docs/assertions.md">here</a>
for a full list. <code>testthat</code> provides the
following wrappers, to conform with <code>testthat</code>'s
<span class="rlang"><b>R</b></span> interface:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Function</strong> </td><td style="text-align: left;"> <strong>Catch</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>context</code> </td><td style="text-align: left;"> <code>CATCH_TEST_CASE</code> </td><td style="text-align: left;"> The context of a set of tests. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>test_that</code> </td><td style="text-align: left;"> <code>CATCH_SECTION</code> </td><td style="text-align: left;"> A test section. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expect_true</code> </td><td style="text-align: left;"> <code>CATCH_CHECK</code> </td><td style="text-align: left;"> Test that an expression evaluates to <code>true</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expect_false</code> </td><td style="text-align: left;"> <code>CATCH_CHECK_FALSE</code> </td><td style="text-align: left;"> Test that an expression evalutes to <code>false</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expect_error</code> </td><td style="text-align: left;"> <code>CATCH_CHECK_THROWS</code> </td><td style="text-align: left;"> Test that evaluation of an expression throws an exception. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expect_error_as</code> </td><td style="text-align: left;"> <code>CATCH_CHECK_THROWS_AS</code> </td><td style="text-align: left;"> Test that evaluation of an expression throws an exception of a specific class. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>In general, you should prefer using the <code>testthat</code>
wrappers, as <code>testthat</code> also does some work to
ensure that any unit tests within will not be compiled or
run when using the Solaris Studio compilers (as these are
currently unsupported by Catch). This should make it
easier to submit packages to CRAN that use Catch.
</p>


<h3>Symbol Registration</h3>

<p>If you've opted to disable dynamic symbol lookup in your
package, then you'll need to explicitly export a symbol
in your package that <code>testthat</code> can use to run your unit
tests. <code>testthat</code> will look for a routine with one of the names:
</p>
<pre>
    C_run_testthat_tests
    c_run_testthat_tests
    run_testthat_tests
</pre>
<p>See <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Controlling-visibility">Controlling Visibility</a>
and <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Registering-symbols">Registering Symbols</a>
in the <strong>Writing R Extensions</strong> manual for more information.
</p>


<h3>Advanced Usage</h3>

<p>If you'd like to write your own Catch test runner, you can
instead use the <code>testthat::catchSession()</code> object in a file
with the form:
</p>
<pre>
#define TESTTHAT_TEST_RUNNER
#include &lt;testthat.h&gt;

void run()
{
    Catch::Session&amp; session = testthat::catchSession();
    // interact with the session object as desired
}
</pre>
<p>This can be useful if you'd like to run your unit tests
with custom arguments passed to the Catch session.
</p>


<h3>Standalone Usage</h3>

<p>If you'd like to use the C++ unit testing facilities provided
by Catch, but would prefer not to use the regular <code>testthat</code>
<span class="rlang"><b>R</b></span> testing infrastructure, you can manually run the unit tests
by inserting a call to:
</p>
<pre>
.Call("run_testthat_tests", PACKAGE = &lt;pkgName&gt;)
</pre>
<p>as necessary within your unit test suite.
</p>


<h3>See Also</h3>

<p><a href="https://github.com/catchorg/Catch2/blob/master/docs/assertions.md">Catch</a>,
the library used to enable C++ unit testing.
</p>

<hr>
<h2 id='verify_output'>Verify output</h2><span id='topic+verify_output'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p>This function is superseded in favour of <code>expect_snapshot()</code> and friends.
</p>
<p>This is a regression test that records interwoven code and output into a
file, in a similar way to knitting an <code>.Rmd</code> file (but see caveats below).
</p>
<p><code>verify_output()</code> is designed particularly for testing print methods and error
messages, where the primary goal is to ensure that the output is helpful to
a human. Obviously, you can't test that with code, so the best you can do is
make the results explicit by saving them to a text file. This makes the output
easy to verify in code reviews, and ensures that you don't change the output
by accident.
</p>
<p><code>verify_output()</code> is designed to be used with git: to see what has changed
from the previous run, you'll need to use <code style="white-space: pre;">&#8288;git diff&#8288;</code> or similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_output(
  path,
  code,
  width = 80,
  crayon = FALSE,
  unicode = FALSE,
  env = caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_output_+3A_path">path</code></td>
<td>
<p>Path to record results.
</p>
<p>This should usually be a call to <code><a href="#topic+test_path">test_path()</a></code> in order to ensure that
the same path is used when run interactively (when the working directory
is typically the project root), and when run as an automated test (when
the working directory will be <code>tests/testthat</code>).</p>
</td></tr>
<tr><td><code id="verify_output_+3A_code">code</code></td>
<td>
<p>Code to execute. This will usually be a multiline expression
contained within <code>{}</code> (similarly to <code>test_that()</code> calls).</p>
</td></tr>
<tr><td><code id="verify_output_+3A_width">width</code></td>
<td>
<p>Width of console output</p>
</td></tr>
<tr><td><code id="verify_output_+3A_crayon">crayon</code></td>
<td>
<p>Enable cli/crayon package colouring?</p>
</td></tr>
<tr><td><code id="verify_output_+3A_unicode">unicode</code></td>
<td>
<p>Enable cli package UTF-8 symbols? If you set this to
<code>TRUE</code>, call <code>skip_if(!cli::is_utf8_output())</code> to disable the
test on your CI platforms that don't support UTF-8 (e.g. Windows).</p>
</td></tr>
<tr><td><code id="verify_output_+3A_env">env</code></td>
<td>
<p>The environment to evaluate <code>code</code> in.</p>
</td></tr>
</table>


<h3>Syntax</h3>

<p><code>verify_output()</code> can only capture the abstract syntax tree, losing all
whitespace and comments. To mildly offset this limitation:
</p>

<ul>
<li><p> Strings are converted to R comments in the output.
</p>
</li>
<li><p> Strings starting with <code style="white-space: pre;">&#8288;# &#8288;</code> are converted to headers in the output.
</p>
</li></ul>



<h3>CRAN</h3>

<p>On CRAN, <code>verify_output()</code> will never fail, even if the output changes.
This avoids false positives because tests of print methods and error
messages are often fragile due to implicit dependencies on other packages,
and failure does not imply incorrect computation, just a change in
presentation.
</p>

<hr>
<h2 id='watch'>Watch a directory for changes (additions, deletions &amp; modifications).</h2><span id='topic+watch'></span>

<h3>Description</h3>

<p>This is used to power the <code><a href="#topic+auto_test">auto_test()</a></code> and
<code><a href="#topic+auto_test_package">auto_test_package()</a></code> functions which are used to rerun tests
whenever source code changes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>watch(path, callback, pattern = NULL, hash = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="watch_+3A_path">path</code></td>
<td>
<p>character vector of paths to watch.  Omit trailing backslash.</p>
</td></tr>
<tr><td><code id="watch_+3A_callback">callback</code></td>
<td>
<p>function called everytime a change occurs.  It should
have three parameters: added, deleted, modified, and should return
TRUE to keep watching, or FALSE to stop.</p>
</td></tr>
<tr><td><code id="watch_+3A_pattern">pattern</code></td>
<td>
<p>file pattern passed to <code><a href="base.html#topic+dir">dir()</a></code></p>
</td></tr>
<tr><td><code id="watch_+3A_hash">hash</code></td>
<td>
<p>hashes are more accurate at detecting changes, but are slower
for large files.  When FALSE, uses modification time stamps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use Ctrl + break (windows), Esc (mac gui) or Ctrl + C (command line) to
stop the watcher.
</p>

<hr>
<h2 id='with_mock'>Mock functions in a package.</h2><span id='topic+with_mock'></span><span id='topic+local_mock'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded"><img src="../help/figures/lifecycle-superseded.svg" alt='[Superseded]' /></a>
</p>
<p><code>with_mock()</code> and <code>local_mock()</code> are superseded in favour of
<code><a href="#topic+with_mocked_bindings">with_mocked_bindings()</a></code> and <code><a href="#topic+local_mocked_bindings">local_mocked_bindings()</a></code>.
</p>
<p>These works by using some C code to temporarily modify the mocked function
<em>in place</em>. This is abusive of R's internals, which makes it dangerous, and
no longer recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_mock(..., .env = topenv())

local_mock(..., .env = topenv(), .local_envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_mock_+3A_...">...</code></td>
<td>
<p>named parameters redefine mocked functions, unnamed parameters
will be evaluated after mocking the functions</p>
</td></tr>
<tr><td><code id="with_mock_+3A_.env">.env</code></td>
<td>
<p>the environment in which to patch the functions,
defaults to the top-level environment.  A character is interpreted as
package name.</p>
</td></tr>
<tr><td><code id="with_mock_+3A_.local_envir">.local_envir</code></td>
<td>
<p>Environment in which to add exit handler.
For expert use only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of the last unnamed parameter
</p>


<h3>3rd edition</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p><code>with_mock()</code> and <code>local_mock()</code> are deprecated in the third edition.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
