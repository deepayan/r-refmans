<!DOCTYPE html><html><head><title>Help for package kanjistat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kanjistat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cjk_escape'><p>Replace CJK characters in files by escape sequences</p></a></li>
<li><a href='#codepoint'><p>Convert between Unicode codepoint and kanji</p></a></li>
<li><a href='#fivebetas'><p>A sample list of kanjivec objects</p></a></li>
<li><a href='#fivetrees'><p>Sample lists of kanjimat objects</p></a></li>
<li><a href='#get_strokes'><p>Get the strokes of a kanjivec object</p></a></li>
<li><a href='#get_strokes_compo'><p>Get the strokes of a specific component of a kanjivec object</p></a></li>
<li><a href='#kanjidata'><p>Data on kanji</p></a></li>
<li><a href='#kanjidist'><p>Compute distance between two kanjivec objects based on hierarchical optimal transport</p></a></li>
<li><a href='#kanjidistmat'><p>Compute distance matrix based on hierarchical optimal transport for lists of kanjivec objects</p></a></li>
<li><a href='#kanjimat'><p>Create kanjimat objects</p></a></li>
<li><a href='#kanjivec'><p>Create kanjivec objects from kanjivg data</p></a></li>
<li><a href='#kmatdist'><p>Compute the unbalanced or balanced Wasserstein distance between two kanjimat objects</p></a></li>
<li><a href='#kmatdistmat'><p>Compute distance matrix for lists of kanjimat objects</p></a></li>
<li><a href='#kreadmean'><p>Kanji readings and meanings</p></a></li>
<li><a href='#lookup'><p>Look up kanji</p></a></li>
<li><a href='#options'><p>Kanjistat Options</p></a></li>
<li><a href='#plot.kanjimat'><p>Plot kanjimat object</p></a></li>
<li><a href='#plot.kanjivec'><p>Plot kanjivec objects</p></a></li>
<li><a href='#plotkanji'><p>Plot kanji</p></a></li>
<li><a href='#print.kanjivec'><p>Print basic information about a kanjivec object</p></a></li>
<li><a href='#samplekan'><p>Sample kanji from a set</p></a></li>
<li><a href='#str.kanjivec'><p>Compactly display the structure of a kanjivec object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Statistical Framework for the Analysis of Japanese Kanji
Characters</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dominic Schuhmacher &lt;dominic.schuhmacher@mathematik.uni-goettingen.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Various tools and data sets that support the study of kanji, including their morphology, decomposition and concepts of distance and similarity between them.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dschuhmacher.github.io/kanjistat/">https://dschuhmacher.github.io/kanjistat/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dschuhmacher/kanjistat/issues">https://github.com/dschuhmacher/kanjistat/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, graphics, grDevices, gsubfn, utils, crayon,
dendextend, png, purrr, rlang, ROI, sysfonts, showtext,
stringi, stringr, transport, xml2, lifecycle</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, knitr, rmarkdown, ROI.plugin.glpk, systemfonts,
testthat (&ge; 3.0.0), tibble, withr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-22 23:08:02 UTC; schumi</td>
</tr>
<tr>
<td>Author:</td>
<td>Dominic Schuhmacher
    <a href="https://orcid.org/0000-0001-7079-6313"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-23 09:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='cjk_escape'>Replace CJK characters in files by escape sequences</h2><span id='topic+cjk_escape'></span>

<h3>Description</h3>

<p>All CJK characters in the file(s) found at the specified path are substituted by their Unicode
escape sequences (\u + 4 digit hex number or \U + 8 digit hex number where necessary).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cjk_escape(path, outdir = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cjk_escape_+3A_path">path</code></td>
<td>
<p>the path to a directory or a single file.</p>
</td></tr>
<tr><td><code id="cjk_escape_+3A_outdir">outdir</code></td>
<td>
<p>the directory where the output files are written. Defaults to the subdirectory
<code>out</code> of the directory in <code>path</code>. The output files have the same names as the originals.</p>
</td></tr>
<tr><td><code id="cjk_escape_+3A_verbose">verbose</code></td>
<td>
<p>whether to print a message for each output file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>path</code> is a directory, the replacement is performed for all files at that location
(subdirectories are ignored). If <code>outdir</code> is the same as <code>path</code>, the original files
are overwritten without warning.
</p>
<p>If <code>path</code> is a file, the replacement is limited to this file. If <code>outdir</code> is the same
as <code>dirname(path)</code>, the files are overwritten without warning.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='codepoint'>Convert between Unicode codepoint and kanji</h2><span id='topic+codepoint'></span><span id='topic+codepointToKanji'></span><span id='topic+kanjiToCodepoint'></span>

<h3>Description</h3>

<p>Given codepoints <code>cp</code>, the function <code>codepointToKanji</code> transforms
to UTF-8, which will typically show as the actual character the codepoints stands for.
Vice versa, given (UTF-8 encoded) kanjis <code>kan</code>, the function <code>kanjiToCodepoint</code> transforms
to unicode codepoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>codepointToKanji(cp, concat = FALSE)

kanjiToCodepoint(kan, character = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="codepoint_+3A_cp">cp</code></td>
<td>
<p>a vector of character strings or objects of class <code>hexmode</code>, representing
hexadecimal numbers.</p>
</td></tr>
<tr><td><code id="codepoint_+3A_concat">concat</code></td>
<td>
<p>logical. Shall the returned characters be concatenated?</p>
</td></tr>
<tr><td><code id="codepoint_+3A_kan">kan</code></td>
<td>
<p>a vector of kanjis (strings of length 1) or a single string of length &gt;= 1
of kanjis.</p>
</td></tr>
<tr><td><code id="codepoint_+3A_character">character</code></td>
<td>
<p>logical. Shall the returned codepoints be of class &quot;character&quot; or hexmode.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>codepointToKanji</code> a character vector of kanji. For <code>kanjiToCodepoint</code> a vector
of hexadecimal numbers (class <code>hexmode</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>codepointToKanji(c("51b7", "6696", "71b1"))
kanjiToCodepoint("\u51b7\u6696\u71b1")

</code></pre>

<hr>
<h2 id='fivebetas'>A sample list of kanjivec objects</h2><span id='topic+fivebetas'></span>

<h3>Description</h3>

<p>A sample list of kanjivec objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fivebetas
</code></pre>


<h3>Format</h3>

<p><code>fivebetas</code> is a list of five <code><a href="#topic+kanjivec">kanjivec</a></code> objects
representing the basic kanji \u90e8,\u969c,\u966a,\u90f5,\u9663 containing  &quot;beta&quot; components,
which come in fact from two different classical radicals:
</p>

<ul>
<li><p> \u961c&ndash;&gt;\u2ed6 on the left: mound, small village
</p>
</li>
<li><p> \u9091&ndash;&gt;\u2ecf on the right: large village
</p>
</li></ul>



<h3>Source</h3>

<p>The list has been generated with the function <code><a href="#topic+kanjivec">kanjivec</a></code>
with parameter <code>flatten="intelligent"</code> from the corresponding files
in the KanjiVG database by Ulrich Apel (<a href="https://kanjivg.tagaini.net/">https://kanjivg.tagaini.net/</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- par(mfrow = c(1,5), mai = rep(0,4))
invisible( lapply(fivebetas, plot, seg_depth = 2) )
par(oldpar)
  
</code></pre>

<hr>
<h2 id='fivetrees'>Sample lists of kanjimat objects</h2><span id='topic+fivetrees'></span><span id='topic+fivetrees1'></span><span id='topic+fivetrees2'></span><span id='topic+fivetrees3'></span>

<h3>Description</h3>

<p>Sample lists of kanjimat objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fivetrees1

fivetrees2

fivetrees3
</code></pre>


<h3>Format</h3>

<p><code>fivetrees1</code>, <code>fivetrees2</code> and <code>fivetrees3</code> are lists of five <code><a href="#topic+kanjimat">kanjimat</a></code>
objects each, representing the same five basic kanji \u6821,\u6728,\u4f11,\u6797,\u76f8, containing each
a tree component. Their matrices are antialiased 64 x 64 pixel representations of the kanji. The size
is chosen as a compromise between aesthetics and memory/computational cost,
such as for <code><a href="#topic+kmatdist">kmatdist</a></code>.
</p>
<p>All of them are in handwriting style fonts.
<code>fivetrees1</code> is in a Kyoukasho font (schoolbook style),
<code>fivetrees2</code> is in a Kaisho font (regular script calligraphy font)
<code>fivetrees3</code> is in a Gyousho font (semi-cursive calligraphy font)
</p>
<p>An object of class <code>list</code> of length 5.
</p>
<p>An object of class <code>list</code> of length 5.
</p>
<p>An object of class <code>list</code> of length 5.
</p>


<h3>Source</h3>

<p>The list has been generated with the function <code><a href="#topic+kanjimat">kanjimat</a></code> using the Mac OS
pre-installed YuKyokasho font (fivetrees1), as well as the freely available fonts nagayama_kai
by Norio Nagayama and KouzanBrushFontGyousyo by Aoyagi Kouzan.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- par(mfrow = c(3,5))
invisible( lapply(fivetrees1, plot) )
invisible( lapply(fivetrees2, plot) )
invisible( lapply(fivetrees3, plot) )
par(oldpar)
  
</code></pre>

<hr>
<h2 id='get_strokes'>Get the strokes of a kanjivec object</h2><span id='topic+get_strokes'></span>

<h3>Description</h3>

<p>The strokes are the leaves of the kanjivec <code>stroketree</code>. They consist of
a two-column matrix giving a discretized path for the stroke in the unit square <code class="reqn">[0,1]^2</code>
with further attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_strokes(kvec, which = 1:kvec$nstrokes, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_strokes_+3A_kvec">kvec</code></td>
<td>
<p>an object of class <code>kanjivec</code></p>
</td></tr>
<tr><td><code id="get_strokes_+3A_which">which</code></td>
<td>
<p>a numeric vector specifying the numbers of the strokes that are to be returned.
Defaults to all strokes.</p>
</td></tr>
<tr><td><code id="get_strokes_+3A_simplify">simplify</code></td>
<td>
<p>logical. Shall only the stroke be returned if <code>which</code> has length 1?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Usually a list of strokes with attributes. Regardless of
whether <code>which</code> is ordered or contains duplicates, the returned list will always contain
the strokes in their natural order without duplicates. If <code>which</code> has length 1 and
<code>simplified = TRUE</code>, the list is avoided, and only the single stroke is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_strokes_compo">get_strokes_compo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kanji &lt;- fivebetas[[5]]
get_strokes(kanji, c(3,10))    # the two long vertical strokes in \u9663

</code></pre>

<hr>
<h2 id='get_strokes_compo'>Get the strokes of a specific component of a kanjivec object</h2><span id='topic+get_strokes_compo'></span>

<h3>Description</h3>

<p>The strokes are the leaves of the kanjivec <code>stroketree</code>. They consist of
a two-column matrix giving a discretized path for the stroke in the unit square <code class="reqn">[0,1]^2</code>
with further attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_strokes_compo(kvec, which = c(1, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_strokes_compo_+3A_kvec">kvec</code></td>
<td>
<p>an object of class <code>kanjivec</code></p>
</td></tr>
<tr><td><code id="get_strokes_compo_+3A_which">which</code></td>
<td>
<p>a vector of length 2 specifing the index of the component, i.e. the component used
is <code>pluck(kvec$components, !!!which)</code>. The default <code>c(1,1)</code> refers
to the root component (full kanji), so all strokes are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of strokes with attributes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_strokes">get_strokes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kanji &lt;- fivebetas[[5]]
# get the three strokes of the component\u2ed6 in \u9663
rad &lt;- get_strokes_compo(kanji, c(2,1))    
plot(0.5, 0.5, xlim=c(0,1), ylim=c(0,1), type="n", asp=1, xaxs="i", yaxs="i", xlab="", ylab="")
invisible(lapply(rad, lines, lwd=4))

</code></pre>

<hr>
<h2 id='kanjidata'>Data on kanji</h2><span id='topic+kanjidata'></span><span id='topic+kbase'></span><span id='topic+kmorph'></span>

<h3>Description</h3>

<p>The tibbles kbase and kmorph provide basic and morphologic information, respectively, for
all kanji contained in the KANJIDIC2 file (see below)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kbase

kmorph
</code></pre>


<h3>Format</h3>

<p>kbase is a tibble with 13,108 rows and 13 variables:
</p>

<dl>
<dt>kanji</dt><dd><p>the kanji</p>
</dd>
<dt>unicode</dt><dd><p>the Unicode codepoint</p>
</dd>
<dt>strokes</dt><dd><p>the number of strokes</p>
</dd>
<dt>class</dt><dd><p>one of four classes: &quot;kyouiku&quot;, &quot;jouyou&quot;, &quot;jinmeiyou&quot; or &quot;hyougai&quot;</p>
</dd>
<dt>grade</dt><dd><p>a number from 1-11, basically a finer version of class, same as in KANJIDIC2,
except that we assgined an 11 for all hyougaiji (rather than an NA value)</p>
</dd>
<dt>kanken</dt><dd><p>at what level the kanji appears in the Nihon Kanji Nouryoku Kentei (Kanken)</p>
</dd>
<dt>jlpt</dt><dd><p>at what level the kanji appears in the Japanese Language Proficiency Test
(Nihongou Nouryoku Shiken)</p>
</dd>
<dt>wanikani</dt><dd><p>at what level the kanji is learned on the kanji learning website Wanikani</p>
</dd>
<dt>frank</dt><dd><p>the frequency rank (1 = most frequent) &quot;based on several averages (Wikipedia,
novels, newspapers, ...)&quot;</p>
</dd>
<dt>frank_news</dt><dd><p>the frequency rank (1 = most frequent) based on news paper data (2501
most frequent kanji over four years in the Mainichi Shimbun)</p>
</dd>
<dt>read_on, read_kun</dt><dd><p>a single ON reading in katakana</p>
</dd>
<dt>read_kun</dt><dd><p>a single kun reading in hiragana</p>
</dd>
<dt>mean</dt><dd><p>a single English meaning of the kanji</p>
</dd>
</dl>

<p>kmorph is a tibble with 13,108 rows and 15 variables:
</p>

<dl>
<dt>kanji</dt><dd><p>the kanji</p>
</dd>
<dt>strokes</dt><dd><p>the number of strokes</p>
</dd>
<dt>radical</dt><dd><p>the traditional (Kangxi) radical used for indexing kanji (one of 214)</p>
</dd>
<dt>radvar</dt><dd><p>the variant of the radical if it is different, otherwise <code>NA</code></p>
</dd>
<dt>nelson_c</dt><dd><p>the Nelson radical if it differs from the traditional one, otherwise <code>NA</code></p>
</dd>
<dt>idc</dt><dd><p>ideographic description character (plus sometimes a number or a letter) describing
the shape of the kanji</p>
</dd>
<dt>components</dt><dd><p>visible components of the kanji; originally from KRADFILE</p>
</dd>
<dt>skip</dt><dd><p>the kanji's SKIP code</p>
</dd>
<dt>mean</dt><dd><p>a single English meaning of the kanji (same as in kbase)</p>
</dd>
</dl>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 13108 rows and 13 columns.
</p>
<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 13108 rows and 9 columns.
</p>


<h3>Details</h3>

<p>The single ON and kun readings and the single meaning are for easy identification
of the more difficult kanji. They are the first entry in the KANJIDIC2 file which may not
always be the most important one. For full readings/meanings use the function <code><a href="#topic+lookup">lookup</a></code>
or consult a dictionary.
</p>


<h3>Source</h3>

<p>Most of the data is directly from the KANJIDIC2 file.
<a href="https://www.edrdg.org/wiki/index.php/KANJIDIC_Project">https://www.edrdg.org/wiki/index.php/KANJIDIC_Project</a><br />
Variables <code>jlpt</code>, <code>frank</code>, <code>idc</code>, <code>components</code> were taken from the Kanjium data base
<a href="https://github.com/mifunetoshiro/kanjium">https://github.com/mifunetoshiro/kanjium</a><br />
Variable <code>components</code> is originally from RADKFILE/KRADFILE.
<a href="https://www.edrdg.org/">https://www.edrdg.org/</a>)
</p>
<p>The use of this data is covered in each case by a Creative Commons BY-SA 4.0 License.
See the package's LICENSE file for details and copyright holders.
</p>
<p>Variable &quot;class&quot; is derived from &quot;grade&quot;.<br />
Variable &quot;kanken&quot; was compiled based on the Wikipedia description of the test levels (as of September 2022).
</p>

<hr>
<h2 id='kanjidist'>Compute distance between two kanjivec objects based on hierarchical optimal transport</h2><span id='topic+kanjidist'></span>

<h3>Description</h3>

<p>The kanji distance is based on matching hierarchical component structures in a
nesting-free way across all levels. The cost for matching individual components is a
cost for registering the components (i.e. alligning there position, scale and aspect
ratio) plus the (relative unbalanced) Wasserstein distance between the registered components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kanjidist(
  k1,
  k2,
  compo_seg_depth1 = 3,
  compo_seg_depth2 = 3,
  p = 1,
  C = 0.2,
  type = c("rtt", "unbalanced", "balanced"),
  size = 48,
  lwd = 2.5,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kanjidist_+3A_k1">k1</code>, <code id="kanjidist_+3A_k2">k2</code></td>
<td>
<p>two objects of type <code>kanjivec</code>.</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_compo_seg_depth1">compo_seg_depth1</code>, <code id="kanjidist_+3A_compo_seg_depth2">compo_seg_depth2</code></td>
<td>
<p>two integers <code class="reqn">\geq 1</code>. Specifies for each kanji the
deepest level included for component matching. If 1, only the kanji itself is used.</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_p">p</code></td>
<td>
<p>the order of the Wasserstein distance used for matching components. All distances and
the penalty (if any) are taken
to the <code>p</code>-th power (which is compensated by taking the <code>p</code>-th root after summation).</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_c">C</code></td>
<td>
<p>the penalty for extra mass if <code>type</code> is <code>"rtt"</code> or <code>"unbalanced"</code>, i.e.
we add  <code>C^p</code> per unit of extra mass (before applying the <code>p</code>-th root).</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_type">type</code></td>
<td>
<p>the type of Wasserstein distance used for matching components based on bitmaps drawn
from the stroke information in <code>k1</code> and <code>k2</code>. <code>"unbalanced"</code> means the pixel values
in the two images are interpreted as mass. The total masses can be very different. Extra mass can
be disposed of at cost <code>C^p</code> per unit. <code>"rtt"</code> is computationally the same, but the final
distance is divided by the maximum of the total ink in each kanji to the (1/p). <code>"balanced"</code>
means the pixel values are normalized so that both images have the same total mass 1. Everything has
to be transported, i.e.\ disposal of mass is not allowed.</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_size">size</code></td>
<td>
<p>side length of the bitmaps used for matching components.</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_lwd">lwd</code></td>
<td>
<p>linewidth for drawing the components in these bitmaps.</p>
</td></tr>
<tr><td><code id="kanjidist_+3A_verbose">verbose</code></td>
<td>
<p>logical. Whether to print detailed information on the cost for all pairs of
components and the final matching.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the precise definition and details see the reference below. Parameter <code>C</code>
corresponds to <code class="reqn">b/2^{1/p}</code> in the paper.
</p>


<h3>Value</h3>

<p>The kanji distance, a non-negative number.
</p>


<h3>Warning</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a><br />
The interface and details of this function will change in the future. Currently only a minimal
set of parameters can be passed. The other parameters are fixed exactly as in the
&quot;prototype distance&quot; (4.1) of the reference below for better or worse.<br />
There is a certain
tendency that exact matches of components are rather strongly favored (if the KanjiVG elements
agree this can overrule the unbalanced Wasserstein distance) and the penalties for
translation/scaling/distortion of components are somewhat mild.<br />
The computation time is rather high (depending on the settings and kanji up to several
seconds per kanji pair). This can be alleviated somewhat by keeping the <code>compo_seg_depth</code>
parameters at 3 or lower and setting <code>size = 32</code> (which goes well with <code>lwd=1.8</code>).<br />
Future versions will use a much faster line base optimal transport algorithm and further
speed-ups.
</p>


<h3>References</h3>

<p>Dominic Schuhmacher (2023).<br />
Distance maps between Japanese kanji characters based on hierarchical optimal transport.<br />
ArXiv Preprint, <a href="https://doi.org/10.48550/arXiv.2304.02493">doi:10.48550/arXiv.2304.02493</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kanjidistmat">kanjidistmat</a></code>, <code><a href="#topic+kmatdist">kmatdist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("ROI.plugin.glpk")) {
  kanjidist(fivebetas[[4]], fivebetas[[5]])
  kanjidist(fivebetas[[4]], fivebetas[[5]], verbose=TRUE)
  # faster and similar:
  kanjidist(fivebetas[[4]], fivebetas[[5]], compo_seg_depth1=2, compo_seg_depth2=2, 
            size=32, lwd=1.8, verbose=TRUE) 
  # slower and similar:
  kanjidist(fivebetas[[4]], fivebetas[[5]], size=64, lwd=3.2, verbose=TRUE)
} 
</code></pre>

<hr>
<h2 id='kanjidistmat'>Compute distance matrix based on hierarchical optimal transport for lists of kanjivec objects</h2><span id='topic+kanjidistmat'></span>

<h3>Description</h3>

<p>Individual distances are based on <code><a href="#topic+kanjidist">kanjidist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kanjidistmat(
  klist,
  klist2 = NULL,
  compo_seg_depth = 3,
  p = 1,
  C = 0.2,
  type = c("rtt", "unbalanced", "balanced"),
  size = 48,
  lwd = 2.5,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kanjidistmat_+3A_klist">klist</code></td>
<td>
<p>a list of <code><a href="#topic+kanjimat">kanjimat</a></code> objects.</p>
</td></tr>
<tr><td><code id="kanjidistmat_+3A_klist2">klist2</code></td>
<td>
<p>an optional second list of <code><a href="#topic+kanjimat">kanjimat</a></code> objects.</p>
</td></tr>
<tr><td><code id="kanjidistmat_+3A_compo_seg_depth">compo_seg_depth</code></td>
<td>
<p>integer <code class="reqn">\geq 1</code>. Specifies for all kanji the
deepest level included for component matching. If 1, only the kanji itself is used.</p>
</td></tr>
<tr><td><code id="kanjidistmat_+3A_p">p</code>, <code id="kanjidistmat_+3A_c">C</code>, <code id="kanjidistmat_+3A_type">type</code>, <code id="kanjidistmat_+3A_size">size</code>, <code id="kanjidistmat_+3A_lwd">lwd</code>, <code id="kanjidistmat_+3A_verbose">verbose</code></td>
<td>
<p>the same as for the function <code><a href="#topic+kanjidist">kanjidist</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of dimension <code>length(klist)</code> x <code>length(klist2)</code> having
as its <code class="reqn">(i,j)</code>-th entry the distance between <code>klist[[i]]</code> and
<code>klist2[[j]]</code>. If <code>klist2</code> is not provided it is assumed to be equal to
<code>klist</code>, but computation is more efficient as only the upper triangular part
is computed and then symmetrized with diagonal zero.
</p>


<h3>Warning</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a><br />
The same precautions apply as for <code><a href="#topic+kanjidist">kanjidist</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kanjidist">kanjidist</a></code>, <code><a href="#topic+kmatdistmat">kmatdistmat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
kanjidistmat(fivebetas)

</code></pre>

<hr>
<h2 id='kanjimat'>Create kanjimat objects</h2><span id='topic+kanjimat'></span>

<h3>Description</h3>

<p>Create a (list of) kanjimat object(s), i.e. bitmap representations of a kanji using a certain font-family
and other typographical parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kanjimat(
  kanji,
  family = NULL,
  size = NULL,
  margin = 0,
  antialias = TRUE,
  save = FALSE,
  overwrite = FALSE,
  simplify = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kanjimat_+3A_kanji">kanji</code></td>
<td>
<p>a (vector of) character string(s) containing kanjis.</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_family">family</code></td>
<td>
<p>the font-family to be used. For details see vignette.</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_size">size</code></td>
<td>
<p>the sidelength of the (square) bitmap</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_margin">margin</code></td>
<td>
<p>extra margin to around the character. Defaults to 0 which leaves a relatively slim margin.
Can be negative, but risks cutting off parts of the character. Units are relative to size in steps of 1/32.</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_antialias">antialias</code></td>
<td>
<p>logical. Shall antialiasing be performed?</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_save">save</code></td>
<td>
<p>logical or character. If FALSE return the (list of) kanjimat object(s). Otherwise save the result
as an rds file in the working directory (as kmatsave.rds) or under the file path provided.</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If FALSE return an error (before any computations are done) if the designated
file path already exists. Otherwise an existing file is overwritten.</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_simplify">simplify</code></td>
<td>
<p>logical. Shall a single kanjimat object be returned (instead a list of one) if <code>kanji</code>
is a single kanji?</p>
</td></tr>
<tr><td><code id="kanjimat_+3A_...">...</code></td>
<td>
<p>futher arguments passed to <a href="grDevices.html#topic+png">png</a>. This is for extensibility. The only argument
that may currently be used is <code>type</code>. Trying to change sizes, units, colors or fonts by this argument
results in an error or an undesirable output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of class <code>kanjimat</code> or, if only one kanji was specified and
<code>simplify</code> is <code>TRUE</code>, a single objects of class <code>kanjimat</code>. If <code>save = TRUE</code>,
the same is (saved and) still returned invisibly.
</p>


<h3>Warning</h3>

<p>If no font family is provided, the default <strong>Chinese</strong> font WenQuanYi Micro Hei that comes with the package showtext is used.
This means that the characters will typically be recognizable, but quite often look odd as Japanese characters.
We strongly advised that a Japanese font is used as detailed above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- kanjimat(kanji="\u85e4", size = 128)

</code></pre>

<hr>
<h2 id='kanjivec'>Create kanjivec objects from kanjivg data</h2><span id='topic+kanjivec'></span>

<h3>Description</h3>

<p>Create a (list of) kanjivec object(s). Each object is a representation of the kanji as a tree of strokes
based on .svg files from the KanjiVG database containing further, derived information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kanjivec(
  kanji,
  database = NULL,
  flatten = "intelligent",
  save = FALSE,
  overwrite = FALSE,
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kanjivec_+3A_kanji">kanji</code></td>
<td>
<p>a (vector of) character string(s) of one or several kanji.</p>
</td></tr>
<tr><td><code id="kanjivec_+3A_database">database</code></td>
<td>
<p>the path to a local copy of (a subset of) the KanjiVG database. It is expected
that the svg files reside at this exact location (not in a subdirectory). If <code>NULL</code>,
an attempt is made to read the svg file(s) from the KanjiVG GitHub repository (after
prompting for confirmation, which can be switched off via the <a href="#topic+kanjistat_options">option</a>
<code>ask_github</code>).</p>
</td></tr>
<tr><td><code id="kanjivec_+3A_flatten">flatten</code></td>
<td>
<p>logical. Should nodes that are only-children be fused with their parents?
Alternatively one of the strings &quot;intelligent&quot;, &quot;inner&quot; or &quot;leaves&quot;. Although the first is the default
it is experimental and the precise meaning will change in the future; see details.</p>
</td></tr>
<tr><td><code id="kanjivec_+3A_save">save</code></td>
<td>
<p>logical or character. If FALSE return the (list of) kanjivec object(s). Otherwise save the result
as an rds file in the working directory (as kvecsave.rds) or under the file path provided.</p>
</td></tr>
<tr><td><code id="kanjivec_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If FALSE return an error (before any computations are done) if the designated
file path already exists. Otherwise an existing file is overwritten.</p>
</td></tr>
<tr><td><code id="kanjivec_+3A_simplify">simplify</code></td>
<td>
<p>logical. Shall a single kanjivec object be returned (instead a list of one) if <code>kanji</code>
is a single kanji?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A kanjivec object contains detailed information on the strokes of which an individual kanji
is composed including their order, a segmentation into reasonable components (&quot;radicals&quot; in a
more general sense of the word), classification of individual strokes, and both
vector data and interpolated points to recreate the actual stroke in a Kyoukashou style font.
For more information on the original data see <a href="http://kanjivg.tagaini.net/">http://kanjivg.tagaini.net/</a>. That data
is licenced under Creative Commons BY-SA 3.0 (see licence file of this package).
</p>
<p>The original .svg files sometimes contain additional <code style="white-space: pre;">&#8288;&lt;g&gt;&#8288;</code> elements that provide
information about the current group of strokes rather than establishing a new subgroup
of its own. This happens typically for information that establishes coherence with another
part of the tree (by noting that the current subgroup is also part 2 of something else),
but also for variant information. With the option <code>flatten = TRUE</code> the extra hierarchy
level in the tree is avoided, while the original information in the KanjiVG file is kept.
This is achieved by fusing only-children to their parents, giving the new node the name
of the child and all its attributes, but prefixing <code>p.</code> to the attribute names
of the parent (the parents' &quot;names&quot; attribute is discarded, but can be reconstructed from
the parents' id). Removal of several hierarchies in sequence can lead to attribute names
with multiple <code>p.</code> in front. Fusing to parents is suppressed if the parent is the
root of the hierarchy (typically for one-stroke kanji), as this could lead to confusing
results.
</p>
<p>The options <code>flatten = "inner"</code> and <code>flatten = "leaves"</code> implement the above behavior
only for the corresponding type of node (inner nodes or leaves). The option
<code>flatten = "intelligent"</code> tries to find out in more sophisticated ways which flattening
is desirable and which is not (it will flatten rather conservatively). Currently nodes without
an element attribute that have only one child are flattened away (one example where this is
reasonable is in kanji <code>kbase[187, ]</code>), as are nodes with an element attribute and only
one child if this child is also an inner node and has the same element and part attribute as the
parent, but both have no number (this would be problematic for any component-building code
in the particular case of kanji <code>kbase[1111, ]</code>).
</p>
<p>A <code>kanjivec</code> object has components
</p>

<dl>
<dt><code>char</code></dt><dd><p>the kanji (a single character)</p>
</dd>
<dt><code>hex</code></dt><dd><p>its Unicode codepoint (integer of class <code>hexmode</code>)</p>
</dd>
<dt><code>padhex</code></dt><dd><p>the Unicode codepoint padded with zeros to five digits (mode character)</p>
</dd>
<dt><code>family</code></dt><dd><p>the font on which the data is based. Currently only &quot;schoolbook&quot; (to be extended with &quot;kaisho&quot; at some point)</p>
</dd>
<dt><code>nstrokes</code></dt><dd><p>the number of strokes in the kanji</p>
</dd>
<dt><code>ncompos</code></dt><dd><p>a vector of the number of components at each depth of the tree</p>
</dd>
<dt><code>nveins</code></dt><dd><p>the number of veins in the component structure</p>
</dd>
<dt><code>strokedend</code></dt><dd><p>the decomposition tree of the kanji as an object of class <code>dendrogram</code></p>
</dd>
<dt><code>components</code></dt><dd><p>the component structure by segmentation depth (components can overlap) in terms
of KanjiVG elements and their depth-first tree coordinates</p>
</dd>
<dt><code>veins</code></dt><dd><p>the veins in the component structure. Each vein is represented as a two-column matrix
that lists in its rows the indices of <code>components</code> (starting at the root,
which in the component indexing is <code>c(1,1)</code>)</p>
</dd>
<dt><code>stroketree</code></dt><dd><p>the decomposition tree of the kanji, a list containing the full information of the
the KanjiVG file (except some top level attributes)</p>
</dd>
</dl>

<p><code>stroketree</code> is a close representation of the KanjiVG svg file as list object with
some serious nesting of sublists. The XML attributes become attributes of the list and its elements.
The user will usually not have to look at or manipulate <code>stroketree</code> directly, but
<code>strokedend</code> and <code>compents</code> are derived from it and other functions may process it
further.
</p>
<p>The main differences to the svg file are
</p>

<ol>
<li><p> the actual strokes are not only given as d-attributes describing Bézier curves
but also as two-column matrices describing discretizations of these curves. These matrices
are the actual contents of the innermost lists in <code>stroketree</code>, but are more conveniently
accessed via the function <code><a href="#topic+get_strokes">get_strokes</a></code>.
</p>
</li>
<li><p> The positions of the stroke numbers (for plotting) are saved as an attribute strokenum_coords
to the entire stroke tree rather than a separate element.
</p>
</li></ol>

<p><code>strokedend</code> is more easy to examine and work with due to various convenience functions for
dendrograms in the packages <code>stats</code> and <code><a href="dendextend.html#topic+dendextend">dendextend</a></code>, including <code><a href="utils.html#topic+str">str</a></code>
and <code><a href="stats.html#topic+plot.dendrogram">plot.dendrogram</a></code>. The function <code><a href="#topic+plot.kanjivec">plot.kanjivec</a></code> with option
<code>type = "dend"</code> is a wrapper for <code><a href="stats.html#topic+plot.dendrogram">plot.dendrogram</a></code> with reasonable presets
for various options.
</p>
<p>The label-attributes of the nodes of <code>strokedend</code> are taken from the element (for inner nodes)
and type (for leaves) attributes of the .svg files. They consist of UTF-8 characters representing
kanji parts and a combination of UTF-8 characters for representing strokes and may not represent
well in all CJK fonts (see details of <code><a href="#topic+plot.kanjivec">plot.kanjivec</a></code>). If element and type are missing
in the .svg file, the label assigned is the second part of the id-attribute, e.g. g5 or s9.
</p>
<p>The <code>components</code> at a given level can be plotted, see <code><a href="#topic+plot.kanjivec">plot.kanjivec</a></code> with
<code>type = "kanji"</code>. Both <code>components</code> and <code>veins</code> serve mainly for the computation
of <a href="#topic+kanjidist">kanji distances</a>.
</p>


<h3>Value</h3>

<p>A list of objects of class <code>kanjivec</code> or, if only one kanji was specified and
<code>simplify</code> is <code>TRUE</code>, a single objects of class <code>kanjivec</code>. If <code>save = TRUE</code>,
the same is (saved and) still returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.kanjivec">plot.kanjivec</a></code>, <code><a href="#topic+str.kanjivec">str.kanjivec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  # Try to load the svg file for the kanji from GitHub.
  res &lt;- kanjivec("\u85e4", database=NULL)
  str(res)
}

fivebetas  # sample kanjivec data
str(fivebetas[[1]])

</code></pre>

<hr>
<h2 id='kmatdist'>Compute the unbalanced or balanced Wasserstein distance between two kanjimat objects</h2><span id='topic+kmatdist'></span>

<h3>Description</h3>

<p>This gives the dissimilarity of pixel-images of the kanji based on how far mass (or &quot;ink&quot;) has to be
transported to transform one image into the other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmatdist(
  k1,
  k2,
  p = 1,
  C = 0.2,
  type = c("unbalanced", "balanced"),
  output = c("dist", "all")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmatdist_+3A_k1">k1</code>, <code id="kmatdist_+3A_k2">k2</code></td>
<td>
<p>two objects of type <code>kanjimat</code>.</p>
</td></tr>
<tr><td><code id="kmatdist_+3A_p">p</code></td>
<td>
<p>the order of the Wasserstein distance. All distances and a potential penalty are taken
to the <code>p</code>-th power (which is compensated by taking the <code>p</code>-th root after summation).</p>
</td></tr>
<tr><td><code id="kmatdist_+3A_c">C</code></td>
<td>
<p>the penalty for extra mass if <code>type="unbalanced"</code>, i.e. we add  <code>C^p</code> per unit
of extra mass (before applying the <code>p</code>-th root).</p>
</td></tr>
<tr><td><code id="kmatdist_+3A_type">type</code></td>
<td>
<p>the type of Wasserstein metric. <code>"unbalanced"</code> means the pixel values in the two images are
interpreted as mass. The total masses can be very different. Extra mass can be disposed of at cost <code>C^p</code>
per unit. <code>"balanced"</code> means the pixel values are normalized so that both images have the same total
mass 1. Everything has to be transported, i.e. disposal of mass is not allowed.</p>
</td></tr>
<tr><td><code id="kmatdist_+3A_output">output</code></td>
<td>
<p>the requested output. See return value below.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>output = "dist"</code>, a single non-negative number: the unbalanced or balanced Wasserstein
distance between the kanji. If <code>output = "all"</code> a list with detailed information on the transport plan
and the disposal of pixel mass. See <code><a href="transport.html#topic+unbalanced">unbalanced</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmatdistmat">kmatdistmat</a></code>, <code><a href="#topic+kanjidist">kanjidist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- kmatdist(fivetrees1[[1]], fivetrees1[[5]], p=1, C=0.1, output="all")
plot(res, what="plan", angle=20, lwd=1.5) 
plot(res, what="trans")
plot(res, what="extra")
plot(res, what="inplace")

</code></pre>

<hr>
<h2 id='kmatdistmat'>Compute distance matrix for lists of kanjimat objects</h2><span id='topic+kmatdistmat'></span>

<h3>Description</h3>

<p>Apply <code><a href="#topic+kmatdist">kmatdist</a></code> to every pair of <code><a href="#topic+kanjimat">kanjimat</a></code> objects to compute
the unbalanced or balanced Wasserstein distance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmatdistmat(
  klist,
  klist2 = NULL,
  p = 1,
  C = 0.2,
  type = c("unbalanced", "balanced")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmatdistmat_+3A_klist">klist</code></td>
<td>
<p>a list of <code><a href="#topic+kanjimat">kanjimat</a></code> objects.</p>
</td></tr>
<tr><td><code id="kmatdistmat_+3A_klist2">klist2</code></td>
<td>
<p>an optional second list of <code><a href="#topic+kanjimat">kanjimat</a></code> objects.</p>
</td></tr>
<tr><td><code id="kmatdistmat_+3A_p">p</code>, <code id="kmatdistmat_+3A_c">C</code>, <code id="kmatdistmat_+3A_type">type</code></td>
<td>
<p>the same as for the function <code><a href="#topic+kmatdist">kmatdist</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of dimension <code>length(klist)</code> x <code>length(klist2)</code> having
as its <code class="reqn">(i,j)</code>-th entry the distance between <code>klist[[i]]</code> and
<code>klist2[[j]]</code>. If <code>klist2</code> is not provided it is assumed to be equal to
<code>klist</code>, but the computation is more efficient as only the upper triangular part
is computed and then symmetrized with diagonal zero.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kmatdist">kmatdist</a></code>, <code><a href="#topic+kanjidistmat">kanjidistmat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kmatdistmat(fivetrees1)
kmatdistmat(fivetrees1, fivetrees1)  # same result but slower
kmatdistmat(fivetrees1, fivetrees2)  # note the smaller values on the diagonal


</code></pre>

<hr>
<h2 id='kreadmean'>Kanji readings and meanings</h2><span id='topic+kreadmean'></span>

<h3>Description</h3>

<p>Data set of all kanji readings and meanings from the KANJIDIC2 dataset in an R list
format. For convenient access to this data use function <code><a href="#topic+lookup">lookup</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kreadmean
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 13108.
</p>


<h3>Source</h3>

<p>KANJIDIC2 file by Jim Breen and The Electronic Dictionary Research
and Development Group (EDRDG)<br />
<a href="https://www.edrdg.org/wiki/index.php/KANJIDIC_Project">https://www.edrdg.org/wiki/index.php/KANJIDIC_Project</a><br />
The use of this data is covered by the Creative Commons BY-SA 4.0 License.
</p>

<hr>
<h2 id='lookup'>Look up kanji</h2><span id='topic+lookup'></span>

<h3>Description</h3>

<p>Return readings and meanings or information from <code>kbase</code> or <code>kmorph</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lookup(kanji, what = c("readmean", "basic", "morphologic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lookup_+3A_kanji">kanji</code></td>
<td>
<p>a (vector of) character strings containing kanji.</p>
</td></tr>
<tr><td><code id="lookup_+3A_what">what</code></td>
<td>
<p>the sort of information to display.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a very basic interface for a quick lookup information based on exact
knowledge of the kanji (provided by a Japanese input method or its UTF-8 code).
Most of the information is based on the KANJIDIC2 file by EDRDG (see thank you page)
Please use one of the many excellent online kanji dictionaries (see e.g.) more
sophisticated lookup methods and more detailed results.
</p>


<h3>Value</h3>

<p>If <code>what</code> is &quot;readmean&quot; the information is output with cat and there is no return value (invisible NULL)
In the other cases the appropriate subsets of the tables kbase and kmorph are returned
</p>


<h3>Author(s)</h3>

<p>Dominic Schuhmacher <a href="mailto:schuhmacher@math.uni-goettingen.de">schuhmacher@math.uni-goettingen.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lookup(c("\u6674", "\u66c7", "\u96e8"))  
lookup("\u6674\u66c7\u96e8")   # same

</code></pre>

<hr>
<h2 id='options'>Kanjistat Options</h2><span id='topic+options'></span><span id='topic+kanjistat_options'></span><span id='topic+get_kanjistat_option'></span>

<h3>Description</h3>

<p>Set or examine global kanjistat options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kanjistat_options(...)

get_kanjistat_option(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="options_+3A_...">...</code></td>
<td>
<p>any number of options specified as <code>name = value</code></p>
</td></tr>
<tr><td><code id="options_+3A_x">x</code></td>
<td>
<p>name of an option given as character string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>kanjistat_options</code> returns the list of all set options if there
is no function argument. Otherwise it returns list of <em>all</em> old options.
<code>get_kanjistat_option</code> returns the current value set for option <code>x</code>
or NULL if the option is not set.
</p>

<hr>
<h2 id='plot.kanjimat'>Plot kanjimat object</h2><span id='topic+plot.kanjimat'></span>

<h3>Description</h3>

<p>Plot kanjimat object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kanjimat'
plot(
  x,
  mode = c("dark", "light"),
  col = gray(seq(0, 1, length.out = 256)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.kanjimat_+3A_x">x</code></td>
<td>
<p>object of class kanjimat.</p>
</td></tr>
<tr><td><code id="plot.kanjimat_+3A_mode">mode</code></td>
<td>
<p>character string. If &quot;dark&quot; the original grayscale values are used,
if &quot;light&quot; they are inverted. With the default grayscale color scheme the kanji is
plotted white-on-black for &quot;dark&quot; and black-on-white for &quot;light&quot;.</p>
</td></tr>
<tr><td><code id="plot.kanjimat_+3A_col">col</code></td>
<td>
<p>a vector of colors. Typically 256 values are enough to keep the full
information of an (antialiased) kanjimat object.</p>
</td></tr>
<tr><td><code id="plot.kanjimat_+3A_...">...</code></td>
<td>
<p>further parameters passed to <code><a href="graphics.html#topic+image">image</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='plot.kanjivec'>Plot kanjivec objects</h2><span id='topic+plot.kanjivec'></span>

<h3>Description</h3>

<p>Plot kanjivec objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kanjivec'
plot(
  x,
  type = c("kanji", "dend"),
  seg_depth = 0,
  palette = "Dark 3",
  pal.extra = 0,
  numbers = FALSE,
  offset = c(0.025, 0),
  family = NULL,
  lwd = 8,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.kanjivec_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+kanjivec">kanjivec</a></code></p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_type">type</code></td>
<td>
<p>either &quot;kanji&quot; or &quot;dend&quot;. Whether to plot the actual kanji, coloring strokes
according to levels of segmentation, or to plot a representation of the tree structure
underlying this segmentation. Among the following named parameters, only <code>family</code> is
for use with <code>type = "dend"</code>; all others are for <code>type = "dend"</code>.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_seg_depth">seg_depth</code></td>
<td>
<p>an integer. How many steps down the segmentation hierarchy we use
different colors for different groups. If zero (the default), only one color is used
that can be specified with <code>col</code> passed via <code>...</code> as usual</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_palette">palette</code></td>
<td>
<p>a valid name of a hcl palette (one of <code>hcl.pals()</code>). Used for coloring the
components if <code>seg_depth</code> is <code class="reqn">&gt;0</code>.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_pal.extra">pal.extra</code></td>
<td>
<p>an integer. How many extra colors are picked in the specified palette.
If this is 0 (the default), palette is used with as many colors as we have components.
Since many hcl palettes run from dark to light colors, the last (few) components may
be too light. Increasing pal.extra then makes the component colors somewhat more similar,
but the last component darker.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_numbers">numbers</code></td>
<td>
<p>logical. Shall the stroke numbers be displayed.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_offset">offset</code></td>
<td>
<p>the (x,y)-offset for the numbers relative to the positions from kanjivg saved
in the kanjivec object. Either a vector of length 2 specifying some fixed offset for
all numbers or a matrix of dimension kanjivec$nstrokes times 2.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_family">family</code></td>
<td>
<p>the font-family for labeling the nodes if <code>type = dend</code>. See details.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_lwd">lwd</code></td>
<td>
<p>the usual line width graphics parameter.</p>
</td></tr>
<tr><td><code id="plot.kanjivec_+3A_...">...</code></td>
<td>
<p>further parameters passed to <code>lines</code> if <code>type = "kanji"</code> and to <code>plot.dendrogram</code>
if <code>type = "dend"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting up nice labels for the nodes if <code>type = "dend"</code> is not easy. For many
font families it appears that some &quot;kanji components&quot; cannot be displayed in plots
even with the help of package <code>showtext</code> and if the
font contains glyphs for the corresponding codepoints that display correctly in text documents.
This concerns in increasing severity of the problem Unicode blocks 2F00–2FDF (Kangxi Radicals),
2E80–2EFF (CJK Radicals Supplement) and 31C0–31EF (CJK Strokes). For the strokes it seems
nearly impossible which is why leaves are simply annotated with the number of the strokes.
</p>
<p>For the other it is up to the user to find a suitable font and pass it via the argument
font family. The default <code>family = NULL</code> first tries to use <code>default_font</code>
if this option has been set (via <code><a href="#topic+kanjistat_options">kanjistat_options</a></code>) and otherwise
uses <code>wqy-microhei</code>, the Chinese default font that comes with package <code>showtext</code>
and cannot display any radicals from the supplement.
</p>
<p>On a Mac the experience is that &quot;hiragino_sans&quot; works well. In addition there is the issue of
font size which is currently not judiciously set and may be too large for some (especially
on-screen) devices. The parameter <code>cex</code> (via <code>...</code>) fixes this.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kanji &lt;- fivebetas[[2]]
plot(kanji, type = "kanji", seg_depth = 2)
plot(kanji, type = "dend")  
  # gives a warning if get_kanjistat_option("default_font") is NULL

</code></pre>

<hr>
<h2 id='plotkanji'>Plot kanji</h2><span id='topic+plotkanji'></span>

<h3>Description</h3>

<p>Write kanji to a graphics device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotkanji(
  kanji,
  device = "default",
  family = NULL,
  factor = 10,
  width = NULL,
  height = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotkanji_+3A_kanji">kanji</code></td>
<td>
<p>a vector of class character specifying one or several kanji to be plotted.</p>
</td></tr>
<tr><td><code id="plotkanji_+3A_device">device</code></td>
<td>
<p>the type of graphics device where the kanji is plotted. Defaults to the
user's default type according to <code>getOption("device")</code>.</p>
</td></tr>
<tr><td><code id="plotkanji_+3A_family">family</code></td>
<td>
<p>the font family or families used for writing the kanji. Make sure to add the font(s)
first by using <code><a href="sysfonts.html#topic+font_add">font_add</a></code>; see details. If <code>family</code> is
a vector of several font families they are matched to the characters in <code>kanji</code>
(and possibly recycled).</p>
</td></tr>
<tr><td><code id="plotkanji_+3A_factor">factor</code></td>
<td>
<p>a maginification factor applied to the font size (typically 12 points).</p>
</td></tr>
<tr><td><code id="plotkanji_+3A_width">width</code>, <code id="plotkanji_+3A_height">height</code></td>
<td>
<p>the dimensions of the device.</p>
</td></tr>
<tr><td><code id="plotkanji_+3A_...">...</code></td>
<td>
<p>further parameters passed to the function opening the device (such as a
file name for devices that create a file).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes one or several kanji to a graphics device
in an arbitrary font that has been registered, i.e., added
to the database in package <code>sysfonts</code>. For the latter say <code><a href="sysfonts.html#topic+font_add">font_add</a></code> or
<code><a href="sysfonts.html#topic+font_families">font_families</a></code> to verify what fonts are available.
</p>
<p>For further information see <em>Working with Japanese fonts</em> in <code>vignette("kanjistat", package = "kanjistat")</code>.
<code>plotkanji</code> uses the package <code>showtext</code> to write the kanji in a large font at the
center of a new device of the specified type.
specify <code>device = "current"</code> to write the kanji to the current device. It is now recommended
to simply use <code>graphics::text</code> in combination with <code>showtext::showtext_auto</code> instead.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Warning</h3>

<p>If no font family is provided, the default <strong>Chinese</strong> font WenQuanYi Micro Hei that comes with the package showtext is used.
This means that the characters will typically be recognizable, but quite often look odd as Japanese characters.
We strongly advised that a Japanese font is used as detailed above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotkanji("\u6edd")   
plotkanji("\u72ac\u732b\u9b5a")

</code></pre>

<hr>
<h2 id='print.kanjivec'>Print basic information about a kanjivec object</h2><span id='topic+print.kanjivec'></span>

<h3>Description</h3>

<p>Print basic information about a kanjivec object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kanjivec'
print(x, dend = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.kanjivec_+3A_x">x</code></td>
<td>
<p>an object of class <code>kanjivec</code>.</p>
</td></tr>
<tr><td><code id="print.kanjivec_+3A_dend">dend</code></td>
<td>
<p>whether to print the structure of the <code>strokedend</code> component.</p>
</td></tr>
<tr><td><code id="print.kanjivec_+3A_...">...</code></td>
<td>
<p>further parameters passed to <code>print.default</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='samplekan'>Sample kanji from a set</h2><span id='topic+samplekan'></span>

<h3>Description</h3>

<p>Sample kanji from a set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samplekan(
  set = c("kyouiku", "jouyou", "jinmeiyou", "kanjidic"),
  size = 1,
  replace = FALSE,
  prob = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samplekan_+3A_set">set</code></td>
<td>
<p>a character string specifying the set of kanjis to sample from.</p>
</td></tr>
<tr><td><code id="samplekan_+3A_size">size</code></td>
<td>
<p>a positive number, the number of samples.</p>
</td></tr>
<tr><td><code id="samplekan_+3A_replace">replace</code></td>
<td>
<p>logical. Sample with replacement?</p>
</td></tr>
<tr><td><code id="samplekan_+3A_prob">prob</code></td>
<td>
<p>currently without effect.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length <code>size</code> containing the individual characters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(sam &lt;- samplekan(size = 10))
lookup(sam)
</code></pre>

<hr>
<h2 id='str.kanjivec'>Compactly display the structure of a kanjivec object</h2><span id='topic+str.kanjivec'></span>

<h3>Description</h3>

<p>Compactly display the structure of a kanjivec object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kanjivec'
str(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="str.kanjivec_+3A_object">object</code></td>
<td>
<p>an object of class <code>kanjivec</code>.</p>
</td></tr>
<tr><td><code id="str.kanjivec_+3A_...">...</code></td>
<td>
<p>further parameters passed to <code>str</code> for all but the <code>stroketree</code> component
of <code>object</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
