<!DOCTYPE html><html><head><title>Help for package psborrow</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {psborrow}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.clinClass-class'><p>S4 Class for specifying parameters for enrollment time, drop-out pattern and analysis start time</p></a></li>
<li><a href='#.covClass-class'><p>S4 Class for setting up covariates</p></a></li>
<li><a href='#.eventClass-class'><p>S4 Class for setting parameters for time-to-events</p></a></li>
<li><a href='#.priorClass-class'><p>S4 Class for specifying prior distributions and predictors for MCMC methods</p></a></li>
<li><a href='#add_cov'><p>Simulate covariates with a multivariate normal distribution</p></a></li>
<li><a href='#add_mcmc'><p>Generating posterior samples from MCMC</p></a></li>
<li><a href='#add_time'><p>Simulate survival times</p></a></li>
<li><a href='#apply_mcmc'><p>Fit Dynamic Borrowing MCMC Model</p></a></li>
<li><a href='#c,.covClass-method'><p>Concatenate multiple <code>.covClasss</code> classes</p></a></li>
<li><a href='#c,.priorClass-method'><p>Concatenate multiple <code>.priorClasss</code> class</p></a></li>
<li><a href='#fix_col_names'><p>Fix Column Names</p></a></li>
<li><a href='#get_summary'><p>Generate summary statistics of a simulation scenario</p></a></li>
<li><a href='#is_psborrow_dev'><p>Check if user is in psborrow development environment</p></a></li>
<li><a href='#match_cov'><p>Match</p></a></li>
<li><a href='#plot_bias'><p>Plot bias</p></a></li>
<li><a href='#plot_hr'><p>Plot mean posterior hazard ratio between treatment and control</p></a></li>
<li><a href='#plot_mse'><p>Plot mean squared error (MSE)</p></a></li>
<li><a href='#plot_power'><p>Plot power</p></a></li>
<li><a href='#plot_type1error'><p>Plot type 1 error</p></a></li>
<li><a href='#ps_message'><p>Conditional Message</p></a></li>
<li><a href='#rej_est'><p>Generate summary statistics for the MCMC chains</p></a></li>
<li><a href='#run_mcmc'><p>Run MCMC for multiple scenarios with provided data</p></a></li>
<li><a href='#run_mcmc_p'><p>Run MCMC for multiple scenarios with provided data with parallel processing</p></a></li>
<li><a href='#set_clin'><p>Specify parameters for enrollment time, drop-out pattern and analysis start time</p></a></li>
<li><a href='#set_cov'><p>Set up covariates</p></a></li>
<li><a href='#set_event'><p>Set up time-to-events</p></a></li>
<li><a href='#set_n'><p>Simulate external trial indicator and treatment arm indicator</p></a></li>
<li><a href='#set_prior'><p>Specify prior distributions and predictors for MCMC methods</p></a></li>
<li><a href='#simu_cov'><p>Simulate covariates</p></a></li>
<li><a href='#simu_time'><p>Simulate time-to-events for multiple scenarios</p></a></li>
<li><a href='#valid_mcmc'><p>validate the operational parameters for MCMC method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Dynamic Borrowing with Propensity Score</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A tool which aims to help evaluate the effect of external borrowing using an integrated approach described in Lewis et al., (2019) &lt;<a href="https://doi.org/10.1080%2F19466315.2018.1497533">doi:10.1080/19466315.2018.1497533</a>&gt; that combines propensity score and Bayesian dynamic borrowing methods.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, data.table, rjags, mvtnorm, ggplot2 (&ge; 3.2.0),
foreach, doParallel, parallel, MatchIt, survival,
futile.logger, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, Matrix, assertthat, pkgload,
flexsurv, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Collate:</td>
<td>'zzz.R' 'add_cov.R' 'add_time.R' 'add_mcmc.R' 'apply_mcmc.R'
'simu_cov.R' 'match_cov.R' 'simu_time.R' 'run_mcmc.R'
'get_summary.R' 'utils.R'</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-02 08:22:14 UTC; gravesti</td>
</tr>
<tr>
<td>Author:</td>
<td>Isaac Gravestock [cre, ctb],
  Craig Gower-Page [aut],
  Matt Secrest [ctb],
  Yichen Lu [aut],
  Aijing Lin [aut],
  F. Hoffmann-La Roche AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Isaac Gravestock &lt;isaac.gravestock@roche.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-03 10:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='.clinClass-class'>S4 Class for specifying parameters for enrollment time, drop-out pattern and analysis start time</h2><span id='topic+.clinClass-class'></span><span id='topic+.clinClass'></span>

<h3>Description</h3>

<p>S4 Class for specifying parameters for enrollment time, drop-out pattern and analysis start time
</p>

<hr>
<h2 id='.covClass-class'>S4 Class for setting up covariates</h2><span id='topic+.covClass-class'></span><span id='topic+.covClass'></span>

<h3>Description</h3>

<p>S4 Class for setting up covariates
</p>

<hr>
<h2 id='.eventClass-class'>S4 Class for setting parameters for time-to-events</h2><span id='topic+.eventClass-class'></span><span id='topic+.eventClass'></span>

<h3>Description</h3>

<p>S4 Class for setting parameters for time-to-events
</p>

<hr>
<h2 id='.priorClass-class'>S4 Class for specifying prior distributions and predictors for MCMC methods</h2><span id='topic+.priorClass-class'></span><span id='topic+.priorClass'></span>

<h3>Description</h3>

<p>S4 Class for specifying prior distributions and predictors for MCMC methods
</p>

<hr>
<h2 id='add_cov'>Simulate covariates with a multivariate normal distribution</h2><span id='topic+add_cov'></span>

<h3>Description</h3>

<p>Simulate covariates with a multivariate normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_cov(dt, covObj, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_cov_+3A_dt">dt</code></td>
<td>
<p>a <code>matrix</code> generated in <code><a href="#topic+set_n">set_n</a></code></p>
</td></tr>
<tr><td><code id="add_cov_+3A_covobj">covObj</code></td>
<td>
<p>an object of class <code>.covClass</code> generated in <code><a href="#topic+set_cov">set_cov</a></code></p>
</td></tr>
<tr><td><code id="add_cov_+3A_seed">seed</code></td>
<td>
<p>the seed of Râ€˜s random number generator. Default is the first element of .Random.seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>matrix</code> containing simulated covariates information
</p>

<hr>
<h2 id='add_mcmc'>Generating posterior samples from MCMC</h2><span id='topic+add_mcmc'></span>

<h3>Description</h3>

<p>Generating posterior samples from MCMC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_mcmc(dt, priorObj, n.chains, n.adapt, n.burn, n.iter, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_mcmc_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code> containing simulated time-to-events information</p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_priorobj">priorObj</code></td>
<td>
<p>an object of class <code>.priorClass</code> generated in <code><a href="#topic+set_prior">set_prior</a></code></p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>number of parallel chains for the model</p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_n.burn">n.burn</code></td>
<td>
<p>number of iterations discarded as burn-in</p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor</p>
</td></tr>
<tr><td><code id="add_mcmc_+3A_seed">seed</code></td>
<td>
<p>the seed of random number generator. Default is the first element of .Random.seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing hazard ratio and prior information
</p>

<hr>
<h2 id='add_time'>Simulate survival times</h2><span id='topic+add_time'></span>

<h3>Description</h3>

<p>Simulate survival times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_time(dt, eventObj, clinInt, clinExt, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_time_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code> generated in <code><a href="#topic+simu_cov">simu_cov</a></code> containing simulated covariates information</p>
</td></tr>
<tr><td><code id="add_time_+3A_eventobj">eventObj</code></td>
<td>
<p>an object of class <code>.eventClass</code> generated in <code><a href="#topic+set_event">set_event</a></code> including event information</p>
</td></tr>
<tr><td><code id="add_time_+3A_clinint">clinInt</code></td>
<td>
<p>an object of class <code>.clinClass</code> generated in <code><a href="#topic+set_clin">set_clin</a></code> including internal trial information</p>
</td></tr>
<tr><td><code id="add_time_+3A_clinext">clinExt</code></td>
<td>
<p>an object of class <code>.clinClass</code> generated in <code><a href="#topic+set_clin">set_clin</a></code> including external trial information</p>
</td></tr>
<tr><td><code id="add_time_+3A_seed">seed</code></td>
<td>
<p>the seed of Râ€˜s random number generator. Default is the first element of .Random.seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code>matrix</code> containing simulated time-to-events information
</p>

<hr>
<h2 id='apply_mcmc'>Fit Dynamic Borrowing MCMC Model</h2><span id='topic+apply_mcmc'></span><span id='topic+extract_samples'></span><span id='topic+summary.apply_mcmc'></span>

<h3>Description</h3>

<p>Fit a dynamic borrowing Weibull survival model to the given dataset and extract the posterior
samples using MCMC.
See the user guide for more information on the model formulation.
See <code><a href="#topic+run_mcmc">run_mcmc()</a></code> for more information on the available parameters for tuning the MCMC sampling
process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_mcmc(dt, formula_cov, ...)

extract_samples(object)

## S3 method for class 'apply_mcmc'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_mcmc_+3A_dt">dt</code></td>
<td>
<p>A data.frame containing data required for modelling. See details</p>
</td></tr>
<tr><td><code id="apply_mcmc_+3A_formula_cov">formula_cov</code></td>
<td>
<p>A one sided formula specifying which non-treatment covariates should
be included into the model. See details</p>
</td></tr>
<tr><td><code id="apply_mcmc_+3A_...">...</code></td>
<td>
<p>Additional arguments passed onto <code><a href="#topic+run_mcmc">run_mcmc()</a></code>. Only exception being the
<code>path</code> argument which is not supported by this function</p>
</td></tr>
<tr><td><code id="apply_mcmc_+3A_object">object</code></td>
<td>
<p>A <code>apply_mcmc</code> object created by <code><a href="#topic+apply_mcmc">apply_mcmc()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>



<h4><code>apply_mcmc()</code></h4>

<p>The <code>dt</code> data.frame must contain 1 row per subject with the following variables:
</p>

<ul>
<li> <p><strong>time</strong> - A continuous non-zero number specifying the time that the subject had an event at
</p>
</li>
<li> <p><strong>cnsr</strong> - A column of 0/1's where 1 indicates that the event was censored/right truncated
</p>
</li>
<li> <p><strong>ext</strong> - A column of 0/1's where 1 indicates that the subject was part of the external
control
</p>
</li>
<li> <p><strong>trt</strong> - A column of 0/1's where 1 indicates that the subject was receiving the experimental
treatment
</p>
</li></ul>

<p>The <code>dt</code> data.frame may also contain any additional covariates to be used in the Weibull model
as specified by <code>formula_cov</code>. In order to fit a valid model <code>formula_cov</code> must contain
the intercept term. The formula will be automatically adjusted to include the treatment term
and as such should not be included here, if you want to include a treatment interaction term
this should be done by using <code>~ trt:covariate</code> and NOT via <code>~ trt*covariate</code>.
</p>



<h4><code>extract_samples()</code></h4>

<p>This function can be used to extract the samples generated by <code>apply_mcmc()</code>
</p>



<h4><code>summary()</code></h4>

<p>This function provides summary statistics about the samples generated by <code>apply_mcmc()</code>
</p>



<h4>Extracted Samples</h4>

<p>The extracted samples can be roughly defined as follows (see the user guide for full details):
</p>

<ul>
<li> <p><strong><code>HR_cc_hc</code></strong> - The hazard ratio between the concurrent control arm and the historical
control arm. This can be
be thought of as the ratio of the scale parameter between the baseline trial distribution and
the baseline
external control distribution. This is equivalent to <code>exp(alpha[2] - alpha[1])</code>
</p>
</li>
<li> <p><strong><code>HR_trt_cc</code></strong> - The hazard ratio between the treatment arm and the concurrent control arm.
This is equivalent
to <code>exp(beta_trt)</code>
</p>
</li>
<li> <p><strong><code>alpha[1]</code></strong> - The shape parameter for the trial's baseline distribution
</p>
</li>
<li> <p><strong><code>alpha[2]</code></strong> - The shape parameter for the historical control's baseline distribution
</p>
</li>
<li> <p><strong><code>beta_trt</code></strong> - The log-hazard ratio for the treatment effect. This is equivalent to
<code>log(HR_trt_cc)</code>
</p>
</li>
<li> <p><strong><code style="white-space: pre;">&#8288;beta_&lt;var&gt;&#8288;</code></strong> - The log-hazard ratio for any other covariate provided to the model via
<code>formula_cov</code>
</p>
</li>
<li> <p><strong><code>r0</code></strong> - The scale parameter for the baseline distribution of both the trial and the
historical control
</p>
</li>
<li> <p><strong><code>tau/sigma</code></strong> - The precision/variance for <code>alpha[1]</code> i.e. controls how much
information is borrowed from the
historical control arm
</p>
</li></ul>



<hr>
<h2 id='c+2C.covClass-method'>Concatenate multiple <code>.covClasss</code> classes</h2><span id='topic+c+2C.covClass-method'></span>

<h3>Description</h3>

<p>Concatenate multiple <code>.covClasss</code> classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature '.covClass'
c(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c+2B2C.covClass-method_+3A_x">x</code></td>
<td>
<p>A <code>.covClasss</code> class with covariate information generated in <code><a href="#topic+set_cov">set_cov</a></code></p>
</td></tr>
<tr><td><code id="c+2B2C.covClass-method_+3A_...">...</code></td>
<td>
<p>Other <code>.covClasss</code> classes with covariate information generated in
<code><a href="#topic+set_cov">set_cov</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>.covClasss</code> classes
</p>


<h3>Examples</h3>

<pre><code class='language-R'># combine two sets of covariates
covset1 = set_cov(n_cat = 2, n_cont = 0, mu_int = 0, mu_ext = 0, var = 1)
covset2 = set_cov(n_cat = 0, n_cont = 1, mu_int = 62, mu_ext = 65, var = 11)
cov_list = c(covset1, covset2)



</code></pre>

<hr>
<h2 id='c+2C.priorClass-method'>Concatenate multiple <code>.priorClasss</code> class</h2><span id='topic+c+2C.priorClass-method'></span>

<h3>Description</h3>

<p>Concatenate multiple <code>.priorClasss</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature '.priorClass'
c(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c+2B2C.priorClass-method_+3A_x">x</code></td>
<td>
<p>A <code>.priorClasss</code> class with prior distribution information generated in <code><a href="#topic+set_prior">set_prior</a></code></p>
</td></tr>
<tr><td><code id="c+2B2C.priorClass-method_+3A_...">...</code></td>
<td>
<p>A <code>.priorClasss</code> class with prior distribution information generated in <code><a href="#topic+set_prior">set_prior</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>.priorClasss</code> classes
</p>

<hr>
<h2 id='fix_col_names'>Fix Column Names</h2><span id='topic+fix_col_names'></span>

<h3>Description</h3>

<p>Utility function to make the mcmc column names more human friendly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fix_col_names(x, column_names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fix_col_names_+3A_x">x</code></td>
<td>
<p>a mcmc results object created by <code><a href="#topic+add_mcmc">add_mcmc()</a></code></p>
</td></tr>
<tr><td><code id="fix_col_names_+3A_column_names">column_names</code></td>
<td>
<p>The names to change the beta columns to</p>
</td></tr>
</table>

<hr>
<h2 id='get_summary'>Generate summary statistics of a simulation scenario</h2><span id='topic+get_summary'></span>

<h3>Description</h3>

<p>Generate summary statistics of a simulation scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_summary(dt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_summary_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> containing the mean and sd of posterior HR between treatment and control arm, the posterior mean and sd of HR between internal control and external control arm, reject rate, variance, bias and mse of the simulation set
</p>

<hr>
<h2 id='is_psborrow_dev'>Check if user is in psborrow development environment</h2><span id='topic+is_psborrow_dev'></span>

<h3>Description</h3>

<p>Simple function which leverages the DESCRIPTION file
to check if the user is in a development environment
for psborrow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_psborrow_dev()
</code></pre>


<h3>Value</h3>

<p>TRUE/FALSE flag (TRUE = in development environment)
</p>

<hr>
<h2 id='match_cov'>Match</h2><span id='topic+match_cov'></span>

<h3>Description</h3>

<p>Match
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_cov(dt, match)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_cov_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code></p>
</td></tr>
<tr><td><code id="match_cov_+3A_match">match</code></td>
<td>
<p>A vector of covariates name to match on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code>matrix</code> containing matched cohort information
</p>


<h3>Examples</h3>

<pre><code class='language-R'># match internal and external trial data using different covariates
smp = set_n(ssC = 140, ssE = 275, ssExt = 100)
covset1 = set_cov(n_cat = 2, n_cont = 0, mu_int = 0, mu_ext = 0, var = 1)
covset2 = set_cov(n_cat = 0, n_cont = 1, mu_int = 62, mu_ext = 65, var = 11)
cObj = c(covset1, covset2)
sample_cov &lt;-
  simu_cov(ssObj = smp, covObj = cObj, HR = 1, driftHR = 1.2, nsim = 2)

# match on covariates 1 and 2
match_cov(dt = sample_cov, match = c("cov1", "cov2"))

# match on all 3 covariates
match_cov(dt = sample_cov, match = c("cov1", "cov2", "cov3"))

</code></pre>

<hr>
<h2 id='plot_bias'>Plot bias</h2><span id='topic+plot_bias'></span>

<h3>Description</h3>

<p>Plot bias for each prior distribution according to selected simulation parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_bias(dt, HR = 1, driftHR = 1, pred = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_bias_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation generated with <code>get_summary</code>.</p>
</td></tr>
<tr><td><code id="plot_bias_+3A_hr">HR</code></td>
<td>
<p>pre-specified HR between treatment and control arm in the internal trial for which the bias should be plotted. Must be within <code>unique(dt$HR)</code>.</p>
</td></tr>
<tr><td><code id="plot_bias_+3A_drifthr">driftHR</code></td>
<td>
<p>pre-specified HR between external control arm and internal control arm for which the bias should be plotted. Must be within <code>unique(dt$driftHR)</code>.</p>
</td></tr>
<tr><td><code id="plot_bias_+3A_pred">pred</code></td>
<td>
<p>predictors to use when fitting exponential distribution in MCMC for which the bias should be plotted. Must be within <code>unique(dt$pred)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a bar plot of class <code>ggplot</code> containing the bias for each prior distribution.
</p>

<hr>
<h2 id='plot_hr'>Plot mean posterior hazard ratio between treatment and control</h2><span id='topic+plot_hr'></span>

<h3>Description</h3>

<p>Plot mean posterior hazard ratio between treatment and control
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hr(dt, HR = 0.67, driftHR = 1, pred = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_hr_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation generated with <code>get_summary</code>.</p>
</td></tr>
<tr><td><code id="plot_hr_+3A_hr">HR</code></td>
<td>
<p>pre-specified HR between treatment and control arm in the internal trial for which the mean posterior hazard ratio should be plotted. Must be within <code>unique(dt$HR)</code>.</p>
</td></tr>
<tr><td><code id="plot_hr_+3A_drifthr">driftHR</code></td>
<td>
<p>pre-specified HR between external control arm and internal control arm for which the mean posterior hazard ratio should be plotted. Must be within <code>unique(dt$driftHR)</code>.</p>
</td></tr>
<tr><td><code id="plot_hr_+3A_pred">pred</code></td>
<td>
<p>predictors to use when fitting exponential distribution in MCMC for which the mean posterior hazard ratio should be plotted. Must be within <code>unique(dt$pred)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code> containing the mean posterior hazard ratio for each prior distribution.
</p>

<hr>
<h2 id='plot_mse'>Plot mean squared error (MSE)</h2><span id='topic+plot_mse'></span>

<h3>Description</h3>

<p>Plot mean squared error (MSE) for each prior distribution according to selected simulation parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mse(dt, HR = 1, driftHR = 1, pred = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_mse_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation generated with <code>get_summary</code>.</p>
</td></tr>
<tr><td><code id="plot_mse_+3A_hr">HR</code></td>
<td>
<p>pre-specified HR between treatment and control arm in the internal trial for which the MSE should be plotted. Must be within <code>unique(dt$HR)</code>.</p>
</td></tr>
<tr><td><code id="plot_mse_+3A_drifthr">driftHR</code></td>
<td>
<p>pre-specified HR between external control arm and internal control arm for which the MSE should be plotted. Must be within <code>unique(dt$driftHR)</code>.</p>
</td></tr>
<tr><td><code id="plot_mse_+3A_pred">pred</code></td>
<td>
<p>predictors to use when fitting exponential distribution in MCMC for which the MSE should be plotted. Must be within <code>unique(dt$pred)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a bar plot of class <code>ggplot</code> containing the MSE for each prior distribution.
</p>

<hr>
<h2 id='plot_power'>Plot power</h2><span id='topic+plot_power'></span>

<h3>Description</h3>

<p>Plot power for each prior distribution according to selected simulation parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_power(dt, HR = 0.67, driftHR = 1, pred = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_power_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation generated with <code>get_summary</code>.</p>
</td></tr>
<tr><td><code id="plot_power_+3A_hr">HR</code></td>
<td>
<p>pre-specified HR between treatment and control arm in the internal trial for which the power should be plotted. Must be within <code>unique(dt$HR)</code>.</p>
</td></tr>
<tr><td><code id="plot_power_+3A_drifthr">driftHR</code></td>
<td>
<p>pre-specified HR between external control arm and internal control arm for which the power should be plotted. Must be within <code>unique(dt$driftHR)</code>.</p>
</td></tr>
<tr><td><code id="plot_power_+3A_pred">pred</code></td>
<td>
<p>predictors to use when fitting exponential distribution in MCMC for which the power should be plotted. Must be within <code>unique(dt$pred)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a bar plot of class <code>ggplot</code> containing the power for each prior distribution.
</p>

<hr>
<h2 id='plot_type1error'>Plot type 1 error</h2><span id='topic+plot_type1error'></span>

<h3>Description</h3>

<p>Plot type 1 error for each prior distribution according to selected simulation parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_type1error(dt, driftHR = 1, pred = "none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_type1error_+3A_dt">dt</code></td>
<td>
<p>a <code>data.frame</code> containing summary statistics for the posterior samples from each simulation generated with <code>get_summary()</code>. Must contain simulations for HR = 1.0.</p>
</td></tr>
<tr><td><code id="plot_type1error_+3A_drifthr">driftHR</code></td>
<td>
<p>the driftHR between the external and internal control arms for which the type 1 error should be plotted. Must be within <code>unique(dt$driftHR)</code>.</p>
</td></tr>
<tr><td><code id="plot_type1error_+3A_pred">pred</code></td>
<td>
<p>the predictors used when fitting the exponential distribution in MCMC for which the type 1 error should be plotted. Must be within <code>unique(dt$pred)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a bar plot of class <code>ggplot</code> containing type 1 error proportions for each prior distribution.
</p>

<hr>
<h2 id='ps_message'>Conditional Message</h2><span id='topic+ps_message'></span>

<h3>Description</h3>

<p>Simple wrapper function around <code><a href="base.html#topic+message">message()</a></code> that will supress
printing messages if the option <code>psborrow.quiet</code> is set to <code>TRUE</code>
i.e.</p>
<pre>options("psborrow.quiet" = TRUE)
</pre>


<h3>Usage</h3>

<pre><code class='language-R'>ps_message(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps_message_+3A_...">...</code></td>
<td>
<p>Values passed onto <code><a href="base.html#topic+message">message()</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='rej_est'>Generate summary statistics for the MCMC chains</h2><span id='topic+rej_est'></span>

<h3>Description</h3>

<p>Generate summary statistics for the MCMC chains
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rej_est(samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rej_est_+3A_samples">samples</code></td>
<td>
<p>an object of class <code>mcmc.list</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector containing the mean, median, sd, reject rate for the MCMC chains
</p>

<hr>
<h2 id='run_mcmc'>Run MCMC for multiple scenarios with provided data</h2><span id='topic+run_mcmc'></span>

<h3>Description</h3>

<p>Run MCMC for multiple scenarios with provided data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_mcmc(dt, priorObj, n.chains, n.adapt, n.burn, n.iter, seed, path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_mcmc_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code> containing simulated time-to-events information</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_priorobj">priorObj</code></td>
<td>
<p>an object of class <code>.priorClass</code> generated in <code><a href="#topic+set_prior">set_prior</a></code></p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>number of parallel chains for the model</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_n.burn">n.burn</code></td>
<td>
<p>number of iterations discarded as burn-in</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_seed">seed</code></td>
<td>
<p>the seed of random number generator. Default is the first element of .Random.seed</p>
</td></tr>
<tr><td><code id="run_mcmc_+3A_path">path</code></td>
<td>
<p>file name for saving the output including folder path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> containing summary statistics of the posterior distribution for each simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'># examples in vignette

</code></pre>

<hr>
<h2 id='run_mcmc_p'>Run MCMC for multiple scenarios with provided data with parallel processing</h2><span id='topic+run_mcmc_p'></span>

<h3>Description</h3>

<p>Run MCMC for multiple scenarios with provided data with parallel processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_mcmc_p(
  dt,
  priorObj,
  n.chains,
  n.adapt,
  n.burn,
  n.iter,
  seed,
  path,
  n.cores = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_mcmc_p_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code> containing simulated time-to-events information</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_priorobj">priorObj</code></td>
<td>
<p>an object of class <code>.priorClass</code> generated in <code><a href="#topic+set_prior">set_prior</a></code></p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_n.chains">n.chains</code></td>
<td>
<p>number of parallel chains for the model</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_n.burn">n.burn</code></td>
<td>
<p>number of iterations discarded as burn-in</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_seed">seed</code></td>
<td>
<p>the seed of random number generator. Default is the first element of .Random.seed</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_path">path</code></td>
<td>
<p>file name for saving the output including folder path</p>
</td></tr>
<tr><td><code id="run_mcmc_p_+3A_n.cores">n.cores</code></td>
<td>
<p>number of processes to parallelize over (default = 2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> containing summary statistics of the posterior distribution for each simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'># similar to run_mcmc


</code></pre>

<hr>
<h2 id='set_clin'>Specify parameters for enrollment time, drop-out pattern and analysis start time</h2><span id='topic+set_clin'></span>

<h3>Description</h3>

<p>This function allows user to specify the enrollment and drop-out rate, and the type of clinical cut-off Date. Both enrollment times and drop-out times follow piece-wise exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_clin(gamma, e_itv, CCOD, CCOD_t, etaC, etaE, d_itv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_clin_+3A_gamma">gamma</code></td>
<td>
<p>A vector of rate of enrollment per unit of time</p>
</td></tr>
<tr><td><code id="set_clin_+3A_e_itv">e_itv</code></td>
<td>
<p>A vector of duration of time periods for recruitment with rates specified in <code>gamma</code>. Note that the length of <code>e_itv</code> should be same length as <code>gamma</code> or 1 less.</p>
</td></tr>
<tr><td><code id="set_clin_+3A_ccod">CCOD</code></td>
<td>
<p>Type of analysis start time. Analysis starts at <code>CCOD_t</code> months after the first or last patient's enrollment if <code>CCOD = "fixed-first"</code> or <code>CCOD = "fixed-last"</code> respectively. Analysis starts when <code>CCOD_t</code> events have been observed if <code>CCOD = "event"</code></p>
</td></tr>
<tr><td><code id="set_clin_+3A_ccod_t">CCOD_t</code></td>
<td>
<p>Time difference between analysis start and first patient's enrollment if <code>CCOD = "fixed-first"</code>. Time difference between analysis start and last patient's enrollment if <code>CCOD = "fixed-last"</code>. Number of events observed when analysis starts if <code>CCOD = "event"</code>. Patients enrolled after the analysis start time are excluded from the analysis</p>
</td></tr>
<tr><td><code id="set_clin_+3A_etac">etaC</code></td>
<td>
<p>A vector for dropout rate per unit time for control arm</p>
</td></tr>
<tr><td><code id="set_clin_+3A_etae">etaE</code></td>
<td>
<p>A vector for dropout rate per unit time for experimental arm. If left <code>NULL</code>, it uses the same dropout rate as eta.</p>
</td></tr>
<tr><td><code id="set_clin_+3A_d_itv">d_itv</code></td>
<td>
<p>A vector of duration of time periods for dropping out the study with rates specified in <code>etaC</code> and <code>etaE</code>. Note that the length of <code>d_itv</code> should be same length as <code>etaC</code> or 1 less.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>.clinClass</code> class containing information on enrollment time, drop-out pattern and analysis start time
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set the operational parameter values for the trial
# analysis starts at64 time units after first patient in
set_clin(gamma = 10, e_itv = 4, etaC = 0.003,  CCOD = "fixed-first", CCOD_t = 64)

# analysis starts at 12 time units after last patient in
set_clin(gamma = 2, e_itv = 18, etaC = 0.005,  CCOD = "fixed-last", CCOD_t = 12)


</code></pre>

<hr>
<h2 id='set_cov'>Set up covariates</h2><span id='topic+set_cov'></span>

<h3>Description</h3>

<p>This function saves the mean, variance and covariance among covariates. For technical
details, see the vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_cov(n_cat, n_cont, mu_int, mu_ext, var, cov, prob_int, prob_ext)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_cov_+3A_n_cat">n_cat</code></td>
<td>
<p>Number of binary variable. See details</p>
</td></tr>
<tr><td><code id="set_cov_+3A_n_cont">n_cont</code></td>
<td>
<p>Number of continuous variable</p>
</td></tr>
<tr><td><code id="set_cov_+3A_mu_int">mu_int</code></td>
<td>
<p>Mean of covariates in the internal trial. All the covariates are simulated from a
multivariate normal distribution. If left <code>NULL</code>, it uses default value 0 for all
covariates. If provided one value, this value is used for all covariates</p>
</td></tr>
<tr><td><code id="set_cov_+3A_mu_ext">mu_ext</code></td>
<td>
<p>Mean of covariates in the external trial. If left <code>NULL</code>, it uses the same
mean as <code>mu_int</code></p>
</td></tr>
<tr><td><code id="set_cov_+3A_var">var</code></td>
<td>
<p>Variance of covariates. If left <code>NULL</code>, it uses default value 0 for all
covariates. If provided one value, it uses this value for all covariates</p>
</td></tr>
<tr><td><code id="set_cov_+3A_cov">cov</code></td>
<td>
<p>Covariance between each pair of covariates. Covariance needs to be provided in
a certain order and users are encouraged to read the example provided in the vignette. If
left <code>NULL</code>, it uses default value 0 for all covariates. If provided one value, it
uses this value for every pair of covariates</p>
</td></tr>
<tr><td><code id="set_cov_+3A_prob_int">prob_int</code></td>
<td>
<p>Probability of binary covariate equalling 1 in the internal trial. If left
<code>NULL</code>, it uses default value 0.5 for all covariates. If provided one value, it uses
this value for all covariates</p>
</td></tr>
<tr><td><code id="set_cov_+3A_prob_ext">prob_ext</code></td>
<td>
<p>Probability of binary covariate equalling 1 in the external trial. If
left <code>NULL</code>, it uses the same probability as <code>prob_int</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Categorical variables are created by sampling a continuous variable from the multivariate
normal
distribution (thus respecting the correlation to other covariates specified by <code>cov</code>)
and then applying a cut point derived from the <code>prob_int</code> or <code>prob_ext</code> quantile
of said distribution i.e. for a univariate variable it would be derived as:</p>
<pre>binvar &lt;- as.numeric(rnorm(n, mu, sqrt(var)) &lt; qnorm(prob, mu, sqrt(var)))
</pre>
<p>Please note that this means that the value of <code>mu_int</code> &amp; <code>mu_ext</code> has no impact on categorical
covariates and thus can be set to any value.
</p>
<p>As an example of how this process works assume <code>n_cat=3</code> and <code>n_cont=2</code>. First 5 variables are
sampled from the multivariate normal distribution as specified by <code>mu_int</code>/<code>mu_ext</code>, <code>var</code> &amp;
<code>cov</code>. Then, the first 3 of these variables are converted to binary based on the probabilities
specified by <code>prob_int</code> and <code>prob_ext</code>. This means that that the 2 continuous variables will
take their mean and sd from the last 2 entries in the vectors <code>mu_int</code>/<code>mu_ext</code> and <code>var</code>.
</p>


<h3>Value</h3>

<p>A <code>.covClass</code> class containing covariate information
</p>

<hr>
<h2 id='set_event'>Set up time-to-events</h2><span id='topic+set_event'></span>

<h3>Description</h3>

<p>Defines the model formula and distribution to be used when simulating time-to-events. Please
see the user-guide for the model formulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_event(event, lambdaC, beta, shape, t_itv, change, keep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_event_+3A_event">event</code></td>
<td>
<p>Distribution of time-to-events: <code>event = "pwexp"</code> for piece-wise exponential
distribution. <code>event = "weibull"</code> for Weibull distribution</p>
</td></tr>
<tr><td><code id="set_event_+3A_lambdac">lambdaC</code></td>
<td>
<p>Baseline hazard rate of internal control arm. Specify a vector for piece-wise
hazard with duration specified in <code>t_itv</code> if <code>event = "pwexp"</code></p>
</td></tr>
<tr><td><code id="set_event_+3A_beta">beta</code></td>
<td>
<p>covariates' coefficients (i.e. log hazard ratios). Must be equal in length to the number of covariates
created by <code><a href="#topic+simu_cov">simu_cov()</a></code> (or less if restricted by <code>keep</code>) plus the number of covariates
defined by <code>change</code>.</p>
</td></tr>
<tr><td><code id="set_event_+3A_shape">shape</code></td>
<td>
<p>the shape parameter of Weibull distribution if <code>event = "weibull"</code>. <code>NULL</code> if
<code>event = "pwexp"</code></p>
</td></tr>
<tr><td><code id="set_event_+3A_t_itv">t_itv</code></td>
<td>
<p>a vector indicating interval lengths where the exponential rates provided in
<code>lambdaC</code> apply. Note that the length of <code>t_itv</code> is at least 1 less than that of
<code>lambdaC</code> and that the final value rate in <code>lambdaC</code> applies after time <code>sum(t_itv)</code>.
<code>NULL</code> if <code>event = "weibull"</code></p>
</td></tr>
<tr><td><code id="set_event_+3A_change">change</code></td>
<td>
<p>A list of additional derivered covariates
to be used in simulating time-to-events. See details</p>
</td></tr>
<tr><td><code id="set_event_+3A_keep">keep</code></td>
<td>
<p>A character vector specifying which of the original covariates (i.e. those not
derived via the <code>change</code> argument) should be included into the model to simulate time-to-events.
If left unspecified all covariates will be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>change</code> argument is used to specify additional derived covariates to be used when
simulating time-to-events. For example, letâ€™s say have 3 covariates <code>cov1</code>, <code>cov2</code> &amp; <code>cov3</code>
but that we also wish to include a new covariate that is an interaction
between <code>cov1</code> and <code>cov2</code> as well as another covariate that is equal to the sum of
<code>cov2</code> and <code>cov3</code>; we could implement this as follows:</p>
<pre>set_event(
    event = "weibull",
    shape = 0.9,
    lambdaC = 0.0135,
    beta = c(5, 3, 1, 7, 9),
    change = list(
        c("cov1", "*", "cov2"),
        c("cov2", "+", "cov3")
    )
)
</pre>
<p>Note that in the above example 5 values have been specified to beta,
3 for the original three covariates
and 2 for the two additional derived covariates included via <code>change</code>.
</p>
<p>Variables derived via <code>change</code> are automatically included in the model regardless
of whether they are listed in <code>keep</code> or not. Likewise, these covariates are derived
separately and not via a standard R formula, that is to say including an interaction
term does not automatically include the individual fixed effects.
</p>


<h3>Value</h3>

<p>a <code>.eventClass</code> class containing time-to-events information
</p>
<p>a <code>matrix</code> containing simulated time-to-events information
</p>


<h3>Examples</h3>

<pre><code class='language-R'># time-to-event follows a Weibull distribution
set_event(event = "weibull", shape = 0.9, lambdaC = 0.0135)

# time-to-event follows a piece-wise exponential distribution
set_event(event = "pwexp", t_itv = 1, lambdaC = c(0.1, 0.02))


</code></pre>

<hr>
<h2 id='set_n'>Simulate external trial indicator and treatment arm indicator</h2><span id='topic+set_n'></span>

<h3>Description</h3>

<p>This function conducts validity check and generates a matrix with two binary variables indicating
</p>

<ol>
<li><p> if the observation belongs to the external trial
</p>
</li>
<li><p> if the observation belongs to the treatment arm.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>set_n(ssC, ssE, ssExt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_n_+3A_ssc">ssC</code></td>
<td>
<p>Number of observations in the internal control arm. Default is 100</p>
</td></tr>
<tr><td><code id="set_n_+3A_sse">ssE</code></td>
<td>
<p>Number of observations in the internal experiment arm. Default is the same number
of observations as <code>ssC</code></p>
</td></tr>
<tr><td><code id="set_n_+3A_ssext">ssExt</code></td>
<td>
<p>Number of observations in the external control arm. Default is the same number
of observations as <code>ssC</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> containing external trial indicator and treatment indicator
</p>

<hr>
<h2 id='set_prior'>Specify prior distributions and predictors for MCMC methods</h2><span id='topic+set_prior'></span>

<h3>Description</h3>

<p>Specify prior distributions and predictors for MCMC methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_prior(pred, prior, r0, alpha, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_prior_+3A_pred">pred</code></td>
<td>
<p>Predictors to include in the weibull distribution. No covariates except for
treatment indicator is included if <code>pred = NULL</code>. Only propensity score generated
using a logistic regression model on all covariates and treatment indicator are included
if <code>pred = ps</code>. All covariates and treatment indicator are included if <code>pred = all</code></p>
</td></tr>
<tr><td><code id="set_prior_+3A_prior">prior</code></td>
<td>
<p>Prior distribution for the precision parameter that controls the degree of
borrowing. Half-cauchy distribution if <code>prior = "cauchy"</code>. No external data is
included in the data if <code>prior = "no_ext"</code>. External control arm is assumed to
have the same baseline hazards as internal control arm if <code>prior = "full_ext"</code>.
Other options include &quot;gamma&quot; and &quot;unif&quot;</p>
</td></tr>
<tr><td><code id="set_prior_+3A_r0">r0</code></td>
<td>
<p>Initial values for the shape of the weibull distribution for time-to-events</p>
</td></tr>
<tr><td><code id="set_prior_+3A_alpha">alpha</code></td>
<td>
<p>Initial values for log of baseline hazard rate for external and internal control
arms. Length of <code>alpha</code> should be 1 if <code>prior = "full_ext"</code> or <code>prior =
"no_ext"</code>, and equal to 2 otherwise</p>
</td></tr>
<tr><td><code id="set_prior_+3A_sigma">sigma</code></td>
<td>
<p>Initial values for precision parameter if <code>prior = "cauchy"</code>.
If left <code>NULL</code>, default value 0.03 is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>.priorClass</code> class containing survival data and prior information
</p>


<h3>Examples</h3>

<pre><code class='language-R'># hierachical Bayesian model with precision parameter follows a half-cauchy distribution
set_prior(pred = "none", prior = "cauchy", r0 = 1, alpha = c(0, 0), sigma = 0.03)

# hierachical Bayesian model with precision parameter follows a gamma distribution
set_prior(pred = "none", prior = "gamma", r0 = 1, alpha = c(0, 0))

# conventional Bayesian model to not borrow from external control arm
set_prior(pred = "none", prior = "no_ext", alpha = 0)

# conventional Bayesian model to fully borrow from external control arm
set_prior(pred = "none", prior = "full_ext", alpha = 0)


</code></pre>

<hr>
<h2 id='simu_cov'>Simulate covariates</h2><span id='topic+simu_cov'></span><span id='topic+simu_cov+2Cmatrix-method'></span>

<h3>Description</h3>

<p>This function generates continuous and binary covariates through simulating from a multivariate normal distribution. Outcomes are further converted to binary variables using quantiles of the normal distribution calculated from the probability provided. Then the covariates are added to the external trial and treatment arm indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu_cov(ssObj, covObj, driftHR, HR, nsim, seed, path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu_cov_+3A_ssobj">ssObj</code></td>
<td>
<p>an object of class <code>.covClass</code> generated in <code><a href="#topic+set_n">set_n</a></code></p>
</td></tr>
<tr><td><code id="simu_cov_+3A_covobj">covObj</code></td>
<td>
<p>an object of class <code>.covClass</code> generated in <code><a href="#topic+set_cov">set_cov</a></code></p>
</td></tr>
<tr><td><code id="simu_cov_+3A_drifthr">driftHR</code></td>
<td>
<p>hazard ratio of external control and internal control arms</p>
</td></tr>
<tr><td><code id="simu_cov_+3A_hr">HR</code></td>
<td>
<p>a list of hazard ratio of treatment and control arms</p>
</td></tr>
<tr><td><code id="simu_cov_+3A_nsim">nsim</code></td>
<td>
<p>number of simulation. Default is 5</p>
</td></tr>
<tr><td><code id="simu_cov_+3A_seed">seed</code></td>
<td>
<p>the seed of Râ€˜s random number generator. Default is the first element of .Random.seed</p>
</td></tr>
<tr><td><code id="simu_cov_+3A_path">path</code></td>
<td>
<p>file name for saving the output including folder path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code>matrix</code> containing simulated covariates information
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate patient-level data with 1 continuous covariate
sample = set_n(ssC = 10, ssE = 20, ssExt = 40)
cov1 = set_cov(n_cat = 0, n_cont = 1, mu_int = 0, mu_ext = 0, var = 1)
simu_cov(ssObj = sample, covObj = cov1, HR = 0.5, driftHR = 1, nsim = 2)

# simulate patient-level data with 1 binary and 2 continuous covariate
cov2 = set_cov(n_cat = 1, n_cont = 2, mu_int = 0, mu_ext = 0, var = 1,
               cov = 0.3, prob_int = 0.2, prob_ext = 0.3)
simu_cov(ssObj = sample, covObj = cov2, HR = 0.5, driftHR = 1, nsim = 2)


</code></pre>

<hr>
<h2 id='simu_time'>Simulate time-to-events for multiple scenarios</h2><span id='topic+simu_time'></span>

<h3>Description</h3>

<p>Simulate time-to-events for multiple scenarios
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu_time(dt, eventObj, clinInt, clinExt, seed, path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu_time_+3A_dt">dt</code></td>
<td>
<p>a list of <code>matrix</code> generated in <code><a href="#topic+simu_cov">simu_cov</a></code> containing simulated covariates information</p>
</td></tr>
<tr><td><code id="simu_time_+3A_eventobj">eventObj</code></td>
<td>
<p>an object of class <code>.eventClass</code> generated in <code><a href="#topic+set_event">set_event</a></code> including event information</p>
</td></tr>
<tr><td><code id="simu_time_+3A_clinint">clinInt</code></td>
<td>
<p>an object of class <code>.clinClass</code> generated in <code><a href="#topic+set_clin">set_clin</a></code> including internal trial information</p>
</td></tr>
<tr><td><code id="simu_time_+3A_clinext">clinExt</code></td>
<td>
<p>an object of class <code>.clinClass</code> generated in <code><a href="#topic+set_clin">set_clin</a></code> including external trial information</p>
</td></tr>
<tr><td><code id="simu_time_+3A_seed">seed</code></td>
<td>
<p>the seed of Râ€˜s random number generator. Default is the first element of .Random.seed</p>
</td></tr>
<tr><td><code id="simu_time_+3A_path">path</code></td>
<td>
<p>file name for saving the output including folder path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <code>matrix</code> containing simulated time-to-events information
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate patient-level data without covariates
# simulate survival time following weibull distribution

# simulate trial indicator and set hazard ratios
sample = set_n(ssC = 10, ssE = 20, ssExt = 40)
sample_hr &lt;- simu_cov(ssObj = sample, HR = 1, driftHR=c(1,1.2), nsim = 10)

# enrollment pattern, drop-out, analysis start time
c_int = set_clin(gamma = 2, e_itv = 10, etaC = 0.5,  CCOD = "fixed-first", CCOD_t = 64)
c_ext = c_int

# simulate time-to-event with a weibull distribution
evt1 &lt;- set_event(event = "weibull", shape = 0.8, lambdaC = 0.01)
simu_time(dt = sample_hr, eventObj = evt1, clinInt = c_int, clinExt = c_ext)

# simulate time-to-event with an exponential distribution
evt2 &lt;- set_event(event = "pwexp", t_itv = 1, lambdaC = c(0.1, 0.02))
simu_time(dt = sample_hr, eventObj = evt2, clinInt = c_int, clinExt = c_int)


</code></pre>

<hr>
<h2 id='valid_mcmc'>validate the operational parameters for MCMC method</h2><span id='topic+valid_mcmc'></span>

<h3>Description</h3>

<p>validate the operational parameters for MCMC method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>valid_mcmc(n.chains, n.adapt, n.burn, n.iter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid_mcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>number of parallel chains for the model</p>
</td></tr>
<tr><td><code id="valid_mcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of iterations for adaptation</p>
</td></tr>
<tr><td><code id="valid_mcmc_+3A_n.burn">n.burn</code></td>
<td>
<p>number of iterations discarded as burn-in</p>
</td></tr>
<tr><td><code id="valid_mcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing numbers of parallel chains and iterations
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
