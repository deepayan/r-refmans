<!DOCTYPE html><html><head><title>Help for package multivar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multivar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#multivar-package'><p>Penalized Estimation of Multiple Subject Vector Autoregressive (multi-VAR) Models</p></a></li>
<li><a href='#canonical.multivar'><p>Canonical VAR Fitting Function for multivar</p></a></li>
<li><a href='#constructModel'><p>Construct an object of class multivar</p></a></li>
<li><a href='#cv.multivar'><p>Cross Validation for multivar</p></a></li>
<li><a href='#dat_multivar_sim'><p>Simulated multi-VAR data.</p></a></li>
<li><a href='#multivar_sim'><p>Simulate multivar data.</p></a></li>
<li><a href='#multivar-class'><p>multivar object class</p></a></li>
<li><a href='#plot_results'><p>Plot data arising from cv.multivar.</p></a></li>
<li><a href='#plot_sim'><p>Plot data arising from multivar_sim.</p></a></li>
<li><a href='#plot_transition_mat'><p>Plot arbitrary transition matrix.</p></a></li>
<li><a href='#show.multivar'><p>Default show method for an object of class multivar</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Title:</td>
<td>Penalized Estimation of Multiple-Subject Vector Autoregressive
(multi-VAR) Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for simulating, estimating and forecasting stationary Vector Autoregressive (VAR) models for multiple subject data using the penalized multi-VAR framework in Fisher, Kim and Pipiras (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2007.05052">doi:10.48550/arXiv.2007.05052</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, utils, MASS, Rcpp (&ge; 1.0.3), Matrix, ggplot2,
vars, reshape2, glmnet</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-27 15:14:24 UTC; lola</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zachary Fisher &lt;fish.zachary@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp,RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Author:</td>
<td>Zachary Fisher [aut, cre],
  Younghoon Kim [ctb],
  Vladas Pipiras [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-27 23:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='multivar-package'>Penalized Estimation of Multiple Subject Vector Autoregressive (multi-VAR) Models</h2><span id='topic+multivar'></span><span id='topic+multivar-package'></span>

<h3>Description</h3>

<p><span class="pkg">multivar</span> is an R package for simulating, estimating and forecasting stationary Vector Autoregressive (VAR) models for multiple subject data using the penalized multi-VAR framework.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Zachary Fisher <a href="mailto:fish.zachary@gmail.com">fish.zachary@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Younghoon Kim [contributor]
</p>
</li>
<li><p> Vladas Pipiras [contributor]
</p>
</li></ul>


<hr>
<h2 id='canonical.multivar'>Canonical VAR Fitting Function for multivar</h2><span id='topic+canonical.multivar'></span><span id='topic+canonical.multivar+2Cmultivar-method'></span>

<h3>Description</h3>

<p>Canonical VAR Fitting Function for multivar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canonical.multivar(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="canonical.multivar_+3A_object">object</code></td>
<td>
<p>multivar object built using <code>ConstructModel</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function to fit a canonical VAR model to each individual dataset.
</p>


<h3>Value</h3>

<p>A list of results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example 1 (run)
sim1  &lt;- multivar_sim(
  k = 2,  # individuals
  d = 5,  # number of variables
  n = 20, # number of timepoints
  prop_fill_com = 0.1, # proportion of paths common
  prop_fill_ind = 0.05, # proportion of paths unique
  lb = 0.1,  # lower bound on coefficient magnitude
  ub = 0.5,  # upper bound on coefficient magnitude
  sigma = diag(5) # noise
)

model1 &lt;- constructModel(data = sim1$data, weightest = "ols")
fit1 &lt;- canonical.multivar(model1)

</code></pre>

<hr>
<h2 id='constructModel'>Construct an object of class multivar</h2><span id='topic+constructModel'></span>

<h3>Description</h3>

<p>Construct an object of class multivar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constructModel(
  data = NULL,
  lag = 1,
  horizon = 0,
  t1 = NULL,
  t2 = NULL,
  lambda1 = NULL,
  lambda2 = NULL,
  nlambda1 = 30,
  nlambda2 = 30,
  depth = 1000,
  tol = 1e-04,
  window = 1,
  standardize = T,
  weightest = "lasso",
  canonical = FALSE,
  threshold = FALSE,
  lassotype = "adaptive",
  intercept = FALSE,
  W = NULL,
  ratios = NULL,
  cv = "blocked",
  nfolds = 10,
  thresh = 0,
  lamadapt = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constructModel_+3A_data">data</code></td>
<td>
<p>List. A list (length = k) of T by d multivariate time series</p>
</td></tr>
<tr><td><code id="constructModel_+3A_lag">lag</code></td>
<td>
<p>Numeric. The VAR order. Default is 1.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_horizon">horizon</code></td>
<td>
<p>Numeric. Desired forecast horizon. Default is 1. ZF Note: Should probably be zero.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_t1">t1</code></td>
<td>
<p>Numeric. Index of time series in which to start cross validation. If NULL, default is floor(nrow(n)/3) where nk is the time series length for individual k.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_t2">t2</code></td>
<td>
<p>Numeric. Index of times series in which to end cross validation. If NULL, default is floor(2*nrow(n)/3) where nk is the time series length for individual k.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_lambda1">lambda1</code></td>
<td>
<p>Matrix. Regularization parameter 1. Default is NULL.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_lambda2">lambda2</code></td>
<td>
<p>Matrix. Regularization parameter 2. Default is NULL.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_nlambda1">nlambda1</code></td>
<td>
<p>Numeric. Number of lambda1 values to search over. Default is 30.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_nlambda2">nlambda2</code></td>
<td>
<p>Numeric. Number of lambda2 values to search over. Default is 30.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_depth">depth</code></td>
<td>
<p>Numeric. Depth of grid construction. Default is 1000.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_tol">tol</code></td>
<td>
<p>Numeric. Optimization tolerance (default 1e-4).</p>
</td></tr>
<tr><td><code id="constructModel_+3A_window">window</code></td>
<td>
<p>Numeric. Size of rolling window.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_standardize">standardize</code></td>
<td>
<p>Logical. Default is true. Whether to standardize the individual data.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_weightest">weightest</code></td>
<td>
<p>Character. Default is &quot;mlr&quot; for multiple linear regression. &quot;sls&quot; for simple linear regression also available. How to estimate the first-stage weights.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_canonical">canonical</code></td>
<td>
<p>Logical. Default is false. If true, individual datasets are fit to a VAR(1) model.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_threshold">threshold</code></td>
<td>
<p>Logical. Default is false. If true, and canonical is true, individual transition matrices are thresholded based on significance.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_lassotype">lassotype</code></td>
<td>
<p>Character. Default is &quot;adaptive&quot;. Choices are &quot;standard&quot; or &quot;adaptive&quot; lasso.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_intercept">intercept</code></td>
<td>
<p>Logical. Default is FALSE.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_w">W</code></td>
<td>
<p>Matrix. Default is NULL.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_ratios">ratios</code></td>
<td>
<p>Numeric vector. Default is NULL.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_cv">cv</code></td>
<td>
<p>Character. Default is &quot;rolling&quot; for rolling window cross-validation. &quot;blocked&quot; is also available for blocked folds cross-validation. If &quot;blocked&quot; is selected the nfolds argument should bbe specified.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_nfolds">nfolds</code></td>
<td>
<p>Numeric. The number of folds for use with &quot;blocked&quot; cross-validation.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_thresh">thresh</code></td>
<td>
<p>Numeric. Post-estimation threshold for setting the individual-level coefficients to zero if their absolute value is smaller than the value provided. Default is zero.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_lamadapt">lamadapt</code></td>
<td>
<p>Logical. Should the lambdas be calculated adaptively. Default is FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
sim  &lt;- multivar_sim(
  k = 2,  # individuals
  d = 3,  # number of variables
  n = 20, # number of timepoints
  prop_fill_com = 0.1, # proportion of paths common
  prop_fill_ind = 0.1, # proportion of paths unique
  lb = 0.1,  # lower bound on coefficient magnitude
  ub = 0.9,  # upper bound on coefficient magnitude
  sigma = diag(3) # noise
)

plot_sim(sim, plot_type = "common")

model &lt;- constructModel(data = sim$data, weightest = "ols")

</code></pre>

<hr>
<h2 id='cv.multivar'>Cross Validation for multivar</h2><span id='topic+cv.multivar'></span><span id='topic+cv.multivar+2Cmultivar-method'></span>

<h3>Description</h3>

<p>Cross Validation for multivar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.multivar(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.multivar_+3A_object">object</code></td>
<td>
<p>multivar object built using <code>ConstructModel</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main function of the multivar package. Performs cross validation to select penalty parameters over a training sample and evaluates them over a test set.
</p>


<h3>Value</h3>

<p>An object of class <code>multivar.results</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example 1 (run)
sim1  &lt;- multivar_sim(
  k = 2,  # individuals
  d = 5,  # number of variables
  n = 20, # number of timepoints
  prop_fill_com = 0.1, # proportion of paths common
  prop_fill_ind = 0.05, # proportion of paths unique
  lb = 0.1,  # lower bound on coefficient magnitude
  ub = 0.5,  # upper bound on coefficient magnitude
  sigma = diag(5) # noise
)

model1 &lt;- constructModel(data = sim1$data)
fit1 &lt;- multivar::cv.multivar(model1)


</code></pre>

<hr>
<h2 id='dat_multivar_sim'>Simulated multi-VAR data.</h2><span id='topic+dat_multivar_sim'></span>

<h3>Description</h3>

<p>This dataset contains multivariate time series data for k = 9 individuals with 
$d = 10$ variables collected at $t = 100$ equidistant time points. The data was 
generated such that each individual's VAR(1) transition matrix has 20 percent 
nonzero entries. This means, for example, each individual has 20 nonzero directed 
relationships in their data generating model. The position of non-zero elements 
in each individual's transition matrix was selected randomly given the following 
constraints: 2/3 of  each individual's paths are shared by all individuals, 
and 1/3 are unique to each individual. For each individual, coefficient values 
between U(0,1, 0.9) were randomly drawn until stability conditions for the 
VAR model were satisfied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dat_multivar_sim
</code></pre>


<h3>Format</h3>

<p>A list containing
</p>

<dl>
<dt>mat_com</dt><dd><p>a common effects transition matrix</p>
</dd>
<dt>mat_ind_unique</dt><dd><p>a list of unique (individual-specific) effect matrices</p>
</dd>
<dt>mat_ind_final</dt><dd><p>a list of total (common + individual-specific) effect matrices</p>
</dd>
<dt>data</dt><dd><p>a list of multivariate time series for all subjects</p>
</dd>  
</dl>
<p>...

</p>

<hr>
<h2 id='multivar_sim'>Simulate multivar data.</h2><span id='topic+multivar_sim'></span>

<h3>Description</h3>

<p>Simulate multivar data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multivar_sim(
  k,
  d,
  n,
  prop_fill_com,
  prop_fill_ind,
  lb,
  ub,
  sigma,
  unique_overlap = FALSE,
  mat_common = NULL,
  mat_unique = NULL,
  mat_total = NULL,
  diag = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multivar_sim_+3A_k">k</code></td>
<td>
<p>Integer. The number of individuals (or datasets) to be generated.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_d">d</code></td>
<td>
<p>Integer. The number of variables per dataset. For now this will be constant across individuals.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_n">n</code></td>
<td>
<p>Integer. The time series length.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_prop_fill_com">prop_fill_com</code></td>
<td>
<p>Numeric. The proportion of nonzero paths in the common transition matrix.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_prop_fill_ind">prop_fill_ind</code></td>
<td>
<p>Numeric. The proportion of nonzero unique (not in the common transition matrix or transition matrix of other individuals) paths in each individual transition matrix.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_lb">lb</code></td>
<td>
<p>Numeric. The upper bound for individual elements of the transition matrices.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_ub">ub</code></td>
<td>
<p>Numeric. The lower bound for individual elements of the transition matrices.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_sigma">sigma</code></td>
<td>
<p>Matrix. The (population) innovation covariance matrix.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_unique_overlap">unique_overlap</code></td>
<td>
<p>Logical. Default is FALSE. Whether the unique portion should be completely unique (no overlap) or randomly chosen.</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_mat_common">mat_common</code></td>
<td>
<p>Matrix. A common effects transition matrix (if known).</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_mat_unique">mat_unique</code></td>
<td>
<p>List. A list of unique effects transition matrix (if known).</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_mat_total">mat_total</code></td>
<td>
<p>List. A list of total effects transition matrix (if known).</p>
</td></tr>
<tr><td><code id="multivar_sim_+3A_diag">diag</code></td>
<td>
<p>Logical. Default is FALSE. Should diagonal elements be filled first for common elements.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>k &lt;- 3
d &lt;- 10
n &lt;- 20
prop_fill_com &lt;- .1
prop_fill_ind &lt;- .05
lb &lt;- 0.1
ub &lt;- 0.5
sigma &lt;- diag(d)
data &lt;- multivar_sim(k, d, n, prop_fill_com, prop_fill_ind, lb, ub,sigma)$data
</code></pre>

<hr>
<h2 id='multivar-class'>multivar object class</h2><span id='topic+multivar-class'></span>

<h3>Description</h3>

<p>An object class to be used with cv.multivar
</p>


<h3>Details</h3>

<p>To construct an object of class multivar, use the function <code><a href="#topic+constructModel">constructModel</a></code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>k</code></dt><dd><p>Numeric. The number of subjects (or groupings) in the dataset.</p>
</dd>
<dt><code>n</code></dt><dd><p>Numeric Vector. Vector containing the number of timepoints for each dataset.</p>
</dd>
<dt><code>d</code></dt><dd><p>Numeric Vector. Vector containing the number of variables for each dataset.</p>
</dd>
<dt><code>Ak</code></dt><dd><p>List. A list (length = k) of lagged (T-lag-horizon) by d multivariate time series.</p>
</dd>
<dt><code>bk</code></dt><dd><p>List. A list (length = k) of (T-lag-horizon) by d multivariate time series.</p>
</dd>
<dt><code>Hk</code></dt><dd><p>List. A list (length = k) of (horizon) by d multivariate time series.</p>
</dd>
<dt><code>A</code></dt><dd><p>Matrix. A matrix containing the lagged ((T-lag-horizon)k) by (d+dk) multivariate time series.</p>
</dd>
<dt><code>b</code></dt><dd><p>Matrix. A matrix containing the non-lagged ((T-lag-horizon)k) by (d) multivariate time series.</p>
</dd>
<dt><code>H</code></dt><dd><p>Matrix. A matrix containing the non-lagged (horizon k) by d multivariate time series.</p>
</dd>
<dt><code>lag</code></dt><dd><p>Numeric. The VAR order. Currently only lag 1 is supported.</p>
</dd>
<dt><code>horizon</code></dt><dd><p>Numeric. Forecast horizon.</p>
</dd>
<dt><code>t1</code></dt><dd><p>Numeric vector. Index of time series in which to start cross validation for individual k.</p>
</dd>
<dt><code>t2</code></dt><dd><p>Numeric vector. Index of time series in which to end cross validation for individual k.</p>
</dd>
<dt><code>lambda1</code></dt><dd><p>Numeric vector. Regularization parameter 1.</p>
</dd>
<dt><code>lambda2</code></dt><dd><p>Numeric vector. Regularization parameter 2.</p>
</dd>
<dt><code>nlambda1</code></dt><dd><p>Numeric. Number of lambda1 values to search over. Default is 30.</p>
</dd>
<dt><code>nlambda2</code></dt><dd><p>Numeric. Number of lambda2 values to search over. Default is 30.</p>
</dd>
<dt><code>tol</code></dt><dd><p>Numeric. Convergence tolerance.</p>
</dd>
<dt><code>depth</code></dt><dd><p>Numeric. Depth of grid construction. Default is 1000.</p>
</dd>
<dt><code>window</code></dt><dd><p>Numeric. Size of rolling window.</p>
</dd>
<dt><code>standardize</code></dt><dd><p>Logical. Default is true. Whether to standardize the individual data.</p>
</dd>
<dt><code>weightest</code></dt><dd><p>Character. How to estimate the first-stage weights. Default is &quot;lasso&quot;. Other options include &quot;ridge&quot;, &quot;ols&quot; and &quot;var&quot;.</p>
</dd>
<dt><code>canonical</code></dt><dd><p>Logical. Default is false. If true, individual datasets are fit to a VAR(1) model.</p>
</dd>
<dt><code>threshold</code></dt><dd><p>Logical. Default is false. If true, and canonical is true, individual transition matrices are thresholded based on significance.</p>
</dd>
<dt><code>lassotype</code></dt><dd><p>Character. Default is &quot;adaptive&quot;. Choices are &quot;standard&quot; or &quot;adaptive&quot; lasso.</p>
</dd>
<dt><code>intercept</code></dt><dd><p>Logical. Default is FALSE.</p>
</dd>
<dt><code>W</code></dt><dd><p>Matrix. Default is NULL.</p>
</dd>
<dt><code>ratios</code></dt><dd><p>Numeric vector. Default is NULL.</p>
</dd>
<dt><code>cv</code></dt><dd><p>Character. Default is &quot;blocked&quot; for k-folds blocked cross-validation. rolling window cross-validation also available using &quot;rolling&quot;.  If &quot;blocked&quot; is selected the nfolds argument should be specified.</p>
</dd>
<dt><code>nfolds</code></dt><dd><p>Numeric. The number of folds for use with &quot;blocked&quot; cross-validation.</p>
</dd>
<dt><code>thresh</code></dt><dd><p>Numeric. Post-estimation threshold for setting the individual-level coefficients to zero if their absolute value is smaller than the value provided. Default is zero.</p>
</dd>
<dt><code>lamadapt</code></dt><dd><p>Logical. Should the lambdas be calculated adaptively. Default is FALSE.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>
</p>

<hr>
<h2 id='plot_results'>Plot data arising from cv.multivar.</h2><span id='topic+plot_results'></span>

<h3>Description</h3>

<p>Plot data arising from cv.multivar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_results(
  x,
  plot_type = "common",
  facet_ncol = 3,
  datasets = "all",
  ub = 1,
  lb = -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_results_+3A_x">x</code></td>
<td>
<p>Object. An object returned by multivar_sim.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_plot_type">plot_type</code></td>
<td>
<p>Character. User can specify &quot;common&quot; to plot the common effects matrix, &quot;unique&quot; to plot the unique effects matrix, or &quot;total&quot; to plot the total effects matrix.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_facet_ncol">facet_ncol</code></td>
<td>
<p>Numeric. Number of columns to use in the &quot;unique&quot; or &quot;total&quot; effects plot.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_datasets">datasets</code></td>
<td>
<p>Numeric. A vector containing the index of datasets to plot. Default is &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_ub">ub</code></td>
<td>
<p>Numeric. Upper bound on coefficient values for heatmap index. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_results_+3A_lb">lb</code></td>
<td>
<p>Numeric. Lower bound on coefficient values for heatmap index. Default is -1.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
sim1  &lt;- multivar_sim(
  k = 2,  # individuals
  d = 3,  # number of variables
  n = 20, # number of timepoints
  prop_fill_com = 0.1, # proportion of paths common
  prop_fill_ind = 0.1, # proportion of paths unique
  lb = 0.1,  # lower bound on coefficient magnitude
  ub = 0.9,  # upper bound on coefficient magnitude
  sigma = diag(1,3) # noise
)

model1 &lt;- constructModel(data = sim1$data, weightest = "ols")
fit1 &lt;- cv.multivar(model1)
plot_results(fit1, plot_type = "common")

</code></pre>

<hr>
<h2 id='plot_sim'>Plot data arising from multivar_sim.</h2><span id='topic+plot_sim'></span>

<h3>Description</h3>

<p>Plot data arising from multivar_sim.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sim(
  x,
  plot_type = "common",
  facet_ncol = 3,
  datasets = "all",
  ub = 1,
  lb = -1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_sim_+3A_x">x</code></td>
<td>
<p>Object. An object returned by multivar_sim.</p>
</td></tr>
<tr><td><code id="plot_sim_+3A_plot_type">plot_type</code></td>
<td>
<p>Character. User can specify &quot;common&quot; to plot the common effects matrix, &quot;unique&quot; to plot the unique effects matrix, or &quot;total&quot; to plot the total effects matrix.</p>
</td></tr>
<tr><td><code id="plot_sim_+3A_facet_ncol">facet_ncol</code></td>
<td>
<p>Numeric. Number of columns to use in the &quot;unique&quot; or &quot;total&quot; effects plot.</p>
</td></tr>
<tr><td><code id="plot_sim_+3A_datasets">datasets</code></td>
<td>
<p>Numeric. A vector containing the index of datasets to plot. Default is &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="plot_sim_+3A_ub">ub</code></td>
<td>
<p>Numeric. Upper bound on coefficient values for heatmap index. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_sim_+3A_lb">lb</code></td>
<td>
<p>Numeric. Lower bound on coefficient values for heatmap index. Default is -1.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
k &lt;- 3
d &lt;- 5
n &lt;- 50
prop_fill_com &lt;- .2
prop_fill_ind &lt;- .2
lb &lt;- 0.1
ub &lt;- 0.7
sigma &lt;- diag(0.1,d)
sim &lt;- multivar_sim(k, d, n, prop_fill_com, prop_fill_ind, lb, ub,sigma)
plot_sim(sim, plot_type = "common")

</code></pre>

<hr>
<h2 id='plot_transition_mat'>Plot arbitrary transition matrix.</h2><span id='topic+plot_transition_mat'></span>

<h3>Description</h3>

<p>Plot arbitrary transition matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_transition_mat(x, title = NULL, subtitle = NULL, ub = 1, lb = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_transition_mat_+3A_x">x</code></td>
<td>
<p>Matrix. An arbitrary transition matrix.</p>
</td></tr>
<tr><td><code id="plot_transition_mat_+3A_title">title</code></td>
<td>
<p>Character. A title for the plot.</p>
</td></tr>
<tr><td><code id="plot_transition_mat_+3A_subtitle">subtitle</code></td>
<td>
<p>Character. A subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot_transition_mat_+3A_ub">ub</code></td>
<td>
<p>Numeric. Upper bound on coefficient values for heatmap index. Default is 1.</p>
</td></tr>
<tr><td><code id="plot_transition_mat_+3A_lb">lb</code></td>
<td>
<p>Numeric. Lower bound on coefficient values for heatmap index. Default is -1.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
plot_transition_mat(matrix(rnorm(25),5,5), title= "Example")

</code></pre>

<hr>
<h2 id='show.multivar'>Default show method for an object of class multivar</h2><span id='topic+show.multivar'></span><span id='topic+show+2Cmultivar-method'></span>

<h3>Description</h3>

<p>Default show method for an object of class multivar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'multivar'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.multivar_+3A_object">object</code></td>
<td>
<p><code>multivar</code> object created from <code>ConstructModel</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Displays the following information about the multivar object:
</p>

<ul>
<li><p>To do.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
