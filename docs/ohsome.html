<!DOCTYPE html><html lang="en-US"><head><title>Help for package ohsome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ohsome}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ohsome_aggregate_elements'><p>Aggregate OSM elements</p></a></li>
<li><a href='#ohsome_api_url'><p>ohsome API URL</p></a></li>
<li><a href='#ohsome_boundary'><p>Create an <code>ohsome_boundary</code> object</p></a></li>
<li><a href='#ohsome_contributions_count'><p>Count OSM contributions</p></a></li>
<li><a href='#ohsome_endpoints'><p>ohsome API endpoints</p></a></li>
<li><a href='#ohsome_extract_contributions'><p>Extract OSM contributions</p></a></li>
<li><a href='#ohsome_extract_elements'><p>Extract OSM elements</p></a></li>
<li><a href='#ohsome_extract_elementsFullHistory'><p>Extract OSM elements' full history</p></a></li>
<li><a href='#ohsome_get_metadata'><p>GET metadata from ohsome API</p></a></li>
<li><a href='#ohsome_metadata'><p>ohsome API metadata</p></a></li>
<li><a href='#ohsome_parse'><p>Parse content from an ohsome API response</p></a></li>
<li><a href='#ohsome_post'><p>Send POST request to ohsome API</p></a></li>
<li><a href='#ohsome_query'><p>Create an <code>ohsome_query</code> object</p></a></li>
<li><a href='#ohsome_temporalExtent'><p>ohsome API temporal extent</p></a></li>
<li><a href='#ohsome_users_count'><p>Count OSM users</p></a></li>
<li><a href='#set_boundary'><p>Set boundary</p></a></li>
<li><a href='#set_endpoint'><p>Set endpoint</p></a></li>
<li><a href='#set_parameters'><p>Set parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>An 'ohsome API' Client</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A client that grants access to the power of the 'ohsome API'
    from R. It lets you analyze the rich data source of the 
    'OpenStreetMap (OSM)' history. You can retrieve the geometry of 'OSM' 
    data at specific points in time, and you can get aggregated statistics 
    on the evolution of 'OSM' elements and specify your own temporal, 
    spatial and/or thematic filters.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/GIScience/ohsome-r">https://github.com/GIScience/ohsome-r</a>,<a href="https://docs.ohsome.org/ohsome-api/stable/">https://docs.ohsome.org/ohsome-api/stable/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/GIScience/ohsome-r/issues">https://github.com/GIScience/ohsome-r/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>geojsonsf, httr, jsonlite, readr, sf, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, ggplot2, httptest, janitor, knitr, mapview,
nominatimlite, osmdata, rmarkdown, spelling, testthat (&ge;
3.0.0), tmaptools, tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-30 13:27:08 UTC; ofritz</td>
</tr>
<tr>
<td>Author:</td>
<td>Heidelberg Institute for Geoinformation Technology (HeiGIT) gGmbH [cph],
  Oliver Fritz <a href="https://orcid.org/0000-0001-6324-7295"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oliver Fritz &lt;oliver.fritz@heigit.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-30 16:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ohsome_aggregate_elements'>Aggregate OSM elements</h2><span id='topic+ohsome_aggregate_elements'></span><span id='topic+ohsome_elements_count'></span><span id='topic+ohsome_elements_length'></span><span id='topic+ohsome_elements_perimeter'></span><span id='topic+ohsome_elements_area'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_query</code> object for OSM element aggregation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_aggregate_elements(
  boundary = NULL,
  aggregation = c("count", "length", "perimeter", "area"),
  return_value = c("absolute", "density", "ratio"),
  grouping = NULL,
  time = NULL,
  ...
)

ohsome_elements_count(boundary = NULL, ...)

ohsome_elements_length(boundary = NULL, ...)

ohsome_elements_perimeter(boundary = NULL, ...)

ohsome_elements_area(boundary = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_aggregate_elements_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_aggregate_elements_+3A_aggregation">aggregation</code></td>
<td>
<p>character; aggregation type:
</p>

<ul>
<li> <p><code>"count"</code> returns the total number of elements. This is the default.
</p>
</li>
<li> <p><code>"length"</code> returns the total length of elements in meters.
</p>
</li>
<li> <p><code>"perimeter"</code> returns the total perimeter of elements in meters.
</p>
</li>
<li> <p><code>"area"</code> returns the total area of elements in square meters.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_aggregate_elements_+3A_return_value">return_value</code></td>
<td>
<p>character; the value to be returned by the ohsome API:
</p>

<ul>
<li> <p><code>"absolute"</code> returns the absolute number, length, perimeter or area of
elements. This is the default.
</p>
</li>
<li> <p><code>"density"</code> returns the number, length, perimeter or area (in meters!) of
elements per square kilometer.
</p>
</li>
<li> <p><code>"ratio"</code> returns an absolute <code>value</code> for elements satisfying the
<code>filter</code> argument, an absolute <code>value2</code> for elements satisfying the
<code>filter2</code> argument, and the <code>ratio</code> of <code>value2</code> to <code>value</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_aggregate_elements_+3A_grouping">grouping</code></td>
<td>
<p>character; group type(s) for grouped aggregations (only
available for queries to aggregation endpoints). The following group types
are available:
</p>

<ul>
<li> <p><code>"boundary"</code> groups the result by the given boundaries that are defined
through any of the <code>boundary</code> query parameters.
</p>
</li>
<li> <p><code>"key"</code> groups the result by the given keys that are defined through the
<code>groupByKeys</code> query parameter.
</p>
</li>
<li> <p><code>"tag"</code> groups the result by the given tags that are defined through the
<code>groupByKey</code> and <code>groupByValues</code> query parameters.
</p>
</li>
<li> <p><code>"type"</code> groups the result by OSM element type.
</p>
</li>
<li> <p><code>c("boundary", "tag")</code> groups the result by the given boundaries and
tags.
</p>
</li></ul>

<p>Not all of these group types are accepted by all of the aggregation
endpoints. Check
<a href="https://docs.ohsome.org/ohsome-api/v1/group-by.html">Grouping</a>
for available group types.</p>
</td></tr>
<tr><td><code id="ohsome_aggregate_elements_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_aggregate_elements_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_aggregate_elements()</code> creates an <code>ohsome_query</code> object for
OSM element aggregation. <code>ohsome_elements_count()</code>,
<code>ohsome_elements_length()</code>, <code>ohsome_elements_perimeter()</code> and
<code>ohsome_elements_area()</code> are wrapper functions for specific aggregation
endpoints. Boundary objects are passed via <code><a href="#topic+set_boundary">set_boundary()</a></code> into
<code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/stable/endpoints.html#elements-aggregation">ohsome API Endpoints - Elements Aggregation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Count of breweries in Franconia
ohsome_aggregate_elements(
    mapview::franconia, 
    aggregation = "count", 
    filter = "craft=brewery",
    time = "2022-01-01"
)

ohsome_elements_count(
    mapview::franconia, 
    filter = "craft=brewery",
    time = "2022-01-01"
)

# Monthly counts of breweries in Franconia from 2012 to 2022
ohsome_elements_count(
    mapview::franconia, 
    filter = "craft=brewery", 
    time = "2012/2022/P1M"
)

# Count of breweries per district of Franconia
ohsome_elements_count(
    mapview::franconia, 
    filter = "craft=brewery", 
    grouping = "boundary",
    time = "2022-01-01"
)

# Number of breweries per square kilometer
ohsome_elements_count(
    mapview::franconia, 
    filter = "craft=brewery", 
    return_value = "density",
    time = "2022-01-01"
)

# Proportion of breweries that are microbreweries
ohsome_elements_count(
    mapview::franconia, 
    filter = "craft=brewery", 
    filter2 = "craft=brewery and microbrewery=yes", 
    return_value = "ratio",
    time = "2022-01-01"
) 

# Total length of highway elements in Franconia
ohsome_elements_length(
    mapview::franconia, 
    filter = "highway=* and geometry:line",
    time = "2022-01-01"
)


</code></pre>

<hr>
<h2 id='ohsome_api_url'>ohsome API URL</h2><span id='topic+ohsome_api_url'></span>

<h3>Description</h3>

<p>The base URL of the ohsome API with path to current major
version.
</p>


<h3>Format</h3>

<p>A list:
</p>

<ul>
<li> <p><code>base</code>: character; base URL
</p>
</li>
<li> <p><code>version</code>: character; path to current major API version
</p>
</li></ul>


<hr>
<h2 id='ohsome_boundary'>Create an <code>ohsome_boundary</code> object</h2><span id='topic+ohsome_boundary'></span><span id='topic+ohsome_boundary.ohsome_boundary'></span><span id='topic+ohsome_boundary.character'></span><span id='topic+ohsome_boundary.sf'></span><span id='topic+ohsome_boundary.sfc'></span><span id='topic+ohsome_boundary.sfg'></span><span id='topic+ohsome_boundary.bbox'></span><span id='topic+ohsome_boundary.matrix'></span><span id='topic+ohsome_boundary.list'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_boundary</code> object from various classes of input geometries.
The <code>ohsome_boundary</code> object is used to set the <code>bpolys</code>, <code>bboxes</code> or
<code>bcircles</code> parameter of an <code>ohsome_query</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_boundary(boundary, ...)

## S3 method for class 'ohsome_boundary'
ohsome_boundary(boundary, ...)

## S3 method for class 'character'
ohsome_boundary(boundary, ...)

## S3 method for class 'sf'
ohsome_boundary(boundary, digits = 6, ...)

## S3 method for class 'sfc'
ohsome_boundary(boundary, ...)

## S3 method for class 'sfg'
ohsome_boundary(boundary, ...)

## S3 method for class 'bbox'
ohsome_boundary(boundary, ...)

## S3 method for class 'matrix'
ohsome_boundary(boundary, ...)

## S3 method for class 'list'
ohsome_boundary(boundary, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_boundary_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_boundary_+3A_...">...</code></td>
<td>
<p>Additional arguments other than <code>digits</code> are ignored.</p>
</td></tr>
<tr><td><code id="ohsome_boundary_+3A_digits">digits</code></td>
<td>
<p>integer; number of decimal places of coordinates in the
resulting GeoJSON when converting <code>sf</code> to GeoJSON (defaults to 6).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>ohsome_boundary</code> object which contains the following elements:
</p>

<ul>
<li> <p><code>boundary</code>: the boundary in textual format
</p>
</li>
<li> <p><code>type</code> of the boundary (<code>bpolys</code>, <code>bcircles</code>, or <code>bboxes</code>).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Defintion of a bounding circle (lon,lat,radius in meters)
ohsome_boundary("8.6528,49.3683,1000") 

# Definition of two named bounding circles
ohsome_boundary("Circle 1:8.6528,49.3683,1000|Circle 2:8.7294,49.4376,1000")

# Definition of two named bounding circles with a character vector
ohsome_boundary(c("Circle 1:8.6528,49.3683,1000", "Circle 2:8.7294,49.4376,1000"))

# Use franconia from the mapview package as bounding polygons

ohsome_boundary(mapview::franconia, digits = 4)

 
# Use the bounding box of franconia

ohsome_boundary(sf::st_bbox(mapview::franconia))


# Get bounding box of the city of Berlin from OSM
## Not run: 
ohsome_boundary(osmdata::getbb("Berlin"))

## End(Not run)
 
# Use a list of two bounding boxes
## Not run: 
ohsome_boundary(list(osmdata::getbb("Berlin"), sf::st_bbox(mapview::franconia)))

## End(Not run)

</code></pre>

<hr>
<h2 id='ohsome_contributions_count'>Count OSM contributions</h2><span id='topic+ohsome_contributions_count'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_query</code> object for OSM contributions count
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_contributions_count(
  boundary = NULL,
  latest = FALSE,
  return_value = c("absolute", "density"),
  time = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_contributions_count_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_contributions_count_+3A_latest">latest</code></td>
<td>
<p>logical; if <code>TRUE</code>, request only the latest contributions
provided to each OSM element.</p>
</td></tr>
<tr><td><code id="ohsome_contributions_count_+3A_return_value">return_value</code></td>
<td>
<p>character; the value to be returned by the ohsome API:
</p>

<ul>
<li> <p><code>"absolute"</code> returns the absolute number of contributions. This is the
default.
</p>
</li>
<li> <p><code>"density"</code> returns the number of contributions per square kilometer.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_contributions_count_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_contributions_count_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_contributions_count()</code> creates an <code>ohsome_query</code> object for
OSM element aggregation. Boundary objects are passed via <code><a href="#topic+set_boundary">set_boundary()</a></code>
into <code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html#contributions-aggregation">ohsome API Endpoints - Contributions Aggregation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Monthly counts of contributions to man-made objects around "Null Island"
ohsome_contributions_count("0,0,10", filter = "man_made=*", time = "2010/2020/P1Y")

# Monthly counts of latest contributions to man-made objects around "Null Island"
ohsome_contributions_count(
    "0,0,10", 
    latest = TRUE, 
    filter = "man_made=*", 
    time = "2010/2020/P1Y"
)

</code></pre>

<hr>
<h2 id='ohsome_endpoints'>ohsome API endpoints</h2><span id='topic+ohsome_endpoints'></span>

<h3>Description</h3>

<p>Available ohsome API endpoints with their parameters
</p>


<h3>Format</h3>

<p>A list of ohsome API endpoints.
</p>

<hr>
<h2 id='ohsome_extract_contributions'>Extract OSM contributions</h2><span id='topic+ohsome_extract_contributions'></span><span id='topic+ohsome_contributions_bbox'></span><span id='topic+ohsome_contributions_centroid'></span><span id='topic+ohsome_contributions_geometry'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_query</code> object for OSM contribution extraction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_extract_contributions(
  boundary = NULL,
  geometryType = c("centroid", "bbox", "geometry"),
  latest = FALSE,
  time = NULL,
  properties = NULL,
  clipGeometry = TRUE,
  ...
)

ohsome_contributions_bbox(boundary = NULL, ...)

ohsome_contributions_centroid(boundary = NULL, ...)

ohsome_contributions_geometry(boundary = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_extract_contributions_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_geometrytype">geometryType</code></td>
<td>
<p>character; type of geometry to be extracted:
</p>

<ul>
<li> <p><code>"centroid"</code>,
</p>
</li>
<li> <p><code>"bboxes"</code> (bounding boxes), or
</p>
</li>
<li> <p><code>"geometry"</code>
</p>
</li></ul>

<p>Caveat: Node elements are omitted from results in queries for bounding
boxes.</p>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_latest">latest</code></td>
<td>
<p>logical; if <code>TRUE</code>, request only the latest contributions
provided to each OSM element.</p>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_properties">properties</code></td>
<td>
<p>character; properties to be extracted with the
contributions:
</p>

<ul>
<li> <p><code>"tags"</code>, and/or
</p>
</li>
<li> <p><code>"metadata"</code> (i.e. <code style="white-space: pre;">&#8288;@changesetId&#8288;</code>, <code style="white-space: pre;">&#8288;@lastEdit&#8288;</code>, <code style="white-space: pre;">&#8288;@osmType&#8288;</code>,
<code style="white-space: pre;">&#8288;@version&#8288;</code>), and/or
</p>
</li>
<li> <p><code>"contributionTypes"</code> (i.e. <code style="white-space: pre;">&#8288;@creation&#8288;</code>, <code style="white-space: pre;">&#8288;@tagChange&#8288;</code>, <code style="white-space: pre;">&#8288;@deletion&#8288;</code>, and
<code style="white-space: pre;">&#8288;@geometryChange&#8288;</code>)
</p>
</li></ul>

<p>Multiple values can be provided as comma-separated character or as
character vector. This defaults to <code>NULL</code> (provides
<code style="white-space: pre;">&#8288;@contributionChangesetId&#8288;</code>, <code style="white-space: pre;">&#8288;@osmId&#8288;</code> and <code style="white-space: pre;">&#8288;@timestamp&#8288;</code>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_clipgeometry">clipGeometry</code></td>
<td>
<p>logical; specifies whether the returned geometries should
be clipped to the query’s spatial boundary</p>
</td></tr>
<tr><td><code id="ohsome_extract_contributions_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_extract_contributions()</code> creates an <code>ohsome_query</code> object for OSM
contribution extraction. <code>ohsome_contributions_bbox()</code>,
<code>ohsome_contributions_centroid()</code> and <code>ohsome_contributions_geometry()</code>
are wrapper functions for specific contributions extraction endpoints.
Boundary objects are passed via <code><a href="#topic+set_boundary">set_boundary()</a></code> into <code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/stable/endpoints.html#contributions-extraction">ohsome API Endpoints &ndash; Contributions Extraction</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extract contributions to man-made objects around "Null Island" with metadata:
ohsome_contributions_geometry(
    "0,0,10", 
    filter = "man_made=*", 
    time = c("2021-01-01", "2022-01-01"),
    properties = "metadata"
)

</code></pre>

<hr>
<h2 id='ohsome_extract_elements'>Extract OSM elements</h2><span id='topic+ohsome_extract_elements'></span><span id='topic+ohsome_elements_bbox'></span><span id='topic+ohsome_elements_centroid'></span><span id='topic+ohsome_elements_geometry'></span>

<h3>Description</h3>

<p>Create an <code>ohsome_query</code> object for OSM element extraction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_extract_elements(
  boundary = NULL,
  geometryType = c("centroid", "bbox", "geometry"),
  time = NULL,
  properties = NULL,
  clipGeometry = TRUE,
  ...
)

ohsome_elements_bbox(boundary = NULL, ...)

ohsome_elements_centroid(boundary = NULL, ...)

ohsome_elements_geometry(boundary = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_extract_elements_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_extract_elements_+3A_geometrytype">geometryType</code></td>
<td>
<p>character; type of geometry to be extracted:
</p>

<ul>
<li> <p><code>"centroid"</code>,
</p>
</li>
<li> <p><code>"bboxes"</code> (bounding boxes), or
</p>
</li>
<li> <p><code>"geometry"</code>
</p>
</li></ul>

<p>Caveat: Node elements are omitted from results in queries for bounding
boxes.</p>
</td></tr>
<tr><td><code id="ohsome_extract_elements_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_elements_+3A_properties">properties</code></td>
<td>
<p>character; properties to be extracted with the features:
</p>

<ul>
<li> <p><code>"tags"</code>, and/or
</p>
</li>
<li> <p><code>"metadata"</code> (i.e. <code style="white-space: pre;">&#8288;@changesetId&#8288;</code>, <code style="white-space: pre;">&#8288;@lastEdit&#8288;</code>, <code style="white-space: pre;">&#8288;@osmType&#8288;</code>, and
<code style="white-space: pre;">&#8288;@version&#8288;</code>)
</p>
</li></ul>

<p>Multiple values can be provided as comma-separated character or as
character vector. This defaults to <code>NULL</code> (provides <code style="white-space: pre;">&#8288;@osmId&#8288;</code>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_elements_+3A_clipgeometry">clipGeometry</code></td>
<td>
<p>logical; specifies whether the returned geometries should
be clipped to the query’s spatial boundary</p>
</td></tr>
<tr><td><code id="ohsome_extract_elements_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_extract_elements()</code> creates an <code>ohsome_query</code> object for OSM element
extraction. <code>ohsome_elements_bbox()</code>, <code>ohsome_elements_centroid()</code> and
<code>ohsome_elements_geometry()</code> are wrapper functions for specific elements
extraction endpoints. Boundary objects are passed via <code><a href="#topic+set_boundary">set_boundary()</a></code> into
<code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/stable/endpoints.html#elements-extraction">ohsome API Endpoints &ndash; Elements Extraction</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extract geometries, metadata and tags of man-made objects around "Null Island":
ohsome_elements_geometry(
    "0,0,10", 
    filter = "man_made=*", 
    time = "2022-01-01",
    properties = c("metadata", "tags")
)

</code></pre>

<hr>
<h2 id='ohsome_extract_elementsFullHistory'>Extract OSM elements' full history</h2><span id='topic+ohsome_extract_elementsFullHistory'></span><span id='topic+ohsome_elementsFullHistory_bbox'></span><span id='topic+ohsome_elementsFullHistory_centroid'></span><span id='topic+ohsome_elementsFullHistory_geometry'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_query</code> object for the extraction of OSM elements' full
history
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_extract_elementsFullHistory(
  boundary = NULL,
  geometryType = c("centroid", "bbox", "geometry"),
  time = NULL,
  properties = NULL,
  clipGeometry = TRUE,
  ...
)

ohsome_elementsFullHistory_bbox(boundary = NULL, ...)

ohsome_elementsFullHistory_centroid(boundary = NULL, ...)

ohsome_elementsFullHistory_geometry(boundary = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_geometrytype">geometryType</code></td>
<td>
<p>character; type of geometry to be extracted:
</p>

<ul>
<li> <p><code>"centroid"</code>,
</p>
</li>
<li> <p><code>"bboxes"</code> (bounding boxes), or
</p>
</li>
<li> <p><code>"geometry"</code>
</p>
</li></ul>

<p>Caveat: Node elements are omitted from results in queries for bounding
boxes.</p>
</td></tr>
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_properties">properties</code></td>
<td>
<p>character; properties to be extracted with the features:
</p>

<ul>
<li> <p><code>"tags"</code>, and/or
</p>
</li>
<li> <p><code>"metadata"</code> (i.e. <code style="white-space: pre;">&#8288;@changesetId&#8288;</code>, <code style="white-space: pre;">&#8288;@lastEdit&#8288;</code>, <code style="white-space: pre;">&#8288;@osmType&#8288;</code>, and
<code style="white-space: pre;">&#8288;@version&#8288;</code>)
</p>
</li></ul>

<p>Multiple values can be provided as comma-separated character or as
character vector. This defaults to <code>NULL</code> (provides <code style="white-space: pre;">&#8288;@osmId&#8288;</code>).</p>
</td></tr>
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_clipgeometry">clipGeometry</code></td>
<td>
<p>logical; specifies whether the returned geometries should
be clipped to the query’s spatial boundary</p>
</td></tr>
<tr><td><code id="ohsome_extract_elementsFullHistory_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_extract_elementsFullHistory()</code> creates an <code>ohsome_query</code> object for OSM
element full history extraction. <code>ohsome_elementsFullHistory_bbox()</code>,
<code>ohsome_elementsFullHistory_centroid()</code> and
<code>ohsome_elementsFullHistory_geometry()</code> are wrapper functions for specific
elementsFullHistory extraction endpoints. Boundary objects are passed via
<code><a href="#topic+set_boundary">set_boundary()</a></code> into <code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html#elements-full-history-extraction">ohsome API Endpoints &ndash; Elements Full History Extraction</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Extract full history of building geometries around Heidelberg main station:
ohsome_elementsFullHistory_geometry(
    boundary = "8.67542,49.40347,1000",
    time = "2012,2022", 
    filter = "building=* and geometry:polygon",
    clipGeometry = FALSE
)
</code></pre>

<hr>
<h2 id='ohsome_get_metadata'>GET metadata from ohsome API</h2><span id='topic+ohsome_get_metadata'></span>

<h3>Description</h3>

<p>Returns parsed metadata from ohsome API
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_get_metadata(quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_get_metadata_+3A_quiet">quiet</code></td>
<td>
<p>logical; suppresses message on data attribution, API version and
temporal extent.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_get_metadata()</code> sends a GET request to the metadata endpoint of
ohsome API and parses the response. The parsed metadata is silently returned.
</p>


<h3>Value</h3>

<p>An <code>ohsome_metadata</code> object. This is a named list with the
attributes <code>date</code>, <code>status_code</code> (of the GET request) and the following list
elements:
</p>

<ul>
<li> <p><code>attribution</code>: character; <code>url</code> and <code>text</code> of OSM data copyrights and
attribution
</p>
</li>
<li> <p><code>apiVersion</code>: character; Version of the ohsome API
</p>
</li>
<li> <p><code>timeout</code>: numeric; limit of the processing time in seconds
</p>
</li>
<li> <p><code>extractRegion</code>:
</p>

<ul>
<li> <p><code>spatialExtent</code>: sfc_POLYGON; spatial boundary of the OSM data in the
underlying OSHDB
</p>
</li>
<li> <p><code>temporalExtent</code>: vector of ISO 8601 character; start and end of the temporal extent of OSM data in the
underlying OSHDB
</p>
</li>
<li> <p><code>replicationSequenceNumber</code>: numeric; precise state of the OSM data
contained in the underlying OSHDB, expressed as the id of the last
applied (hourly) diff file from <a href="https://planet.openstreetmap.org">Planet OSM</a>
</p>
</li></ul>

</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html#metadata">ohsome API Endpoints &ndash; Metadata</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ohsome_get_metadata()

## End(Not run)
</code></pre>

<hr>
<h2 id='ohsome_metadata'>ohsome API metadata</h2><span id='topic+ohsome_metadata'></span>

<h3>Description</h3>

<p>Metadata of the ohsome API that is requested on loading the
package
</p>


<h3>Format</h3>

<p>An <code>ohsome_metadata</code> object. This is a named list with the
attributes <code>date</code>, <code>status_code</code> (of the GET request) and the following list
elements:
</p>

<ul>
<li> <p><code>attribution</code>: character; <code>url</code> and <code>text</code> of OSM data copyrights and
attribution
</p>
</li>
<li> <p><code>apiVersion</code>: numeric_version; Version of the ohsome API
</p>
</li>
<li> <p><code>timeout</code>: numeric; limit of the processing time in seconds
</p>
</li>
<li> <p><code>extractRegion</code>:
</p>

<ul>
<li> <p><code>spatialExtent</code>: sfc_POLYGON; spatial boundary of the OSM data in the
underlying OSHDB
</p>
</li>
<li> <p><code>temporalExtent</code>: vector of POSIXct; timeframe of the OSM data in the
underlying OSHDB data
</p>
</li>
<li> <p><code>replicationSequenceNumber</code>: numeric; precise state of the OSM data
contained in the underlying OSHDB, expressed as the id of the last
applied (hourly) diff file from <a href="https://planet.openstreetmap.org">Planet OSM</a>
</p>
</li></ul>

</li></ul>


<hr>
<h2 id='ohsome_parse'>Parse content from an ohsome API response</h2><span id='topic+ohsome_parse'></span><span id='topic+ohsome_sf'></span><span id='topic+ohsome_df'></span>

<h3>Description</h3>

<p>Extracts and parses the content from an ohsome API response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_parse(
  response,
  returnclass = c("default", "sf", "data.frame", "list", "character"),
  omit_empty = TRUE
)

ohsome_sf(response, omit_empty = TRUE)

ohsome_df(response, omit_empty = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_parse_+3A_response">response</code></td>
<td>
<p>An <code>ohsome_response</code> object</p>
</td></tr>
<tr><td><code id="ohsome_parse_+3A_returnclass">returnclass</code></td>
<td>
<p>character; one of the following:
</p>

<ul>
<li> <p><code>"default"</code> returns <code>sf</code> if the <code>ohsome_response</code> contains GeoJSON, or
else a <code>data.frame</code>.
</p>
</li>
<li> <p><code>"sf"</code> returns <code>sf</code> if the <code>ohsome_response</code> contains GeoJSON, else
issues a warning and returns a <code>data.frame</code>.
</p>
</li>
<li> <p><code>"data.frame"</code> returns a <code>data.frame</code>.
</p>
</li>
<li> <p><code>"list"</code> returns a <code>list</code>.
</p>
</li>
<li> <p><code>"character"</code> returns the ohsome API response body as text (JSON or
semicolon-separated values)
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_parse_+3A_omit_empty">omit_empty</code></td>
<td>
<p>logical; omit features with empty geometries (only if
<code>returnclass = "sf"</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_parse()</code> parses an <code>ohsome_response</code> object into an object of the
specified class. By default, this is an <code>sf</code> object if the ohsome API
response contains GeoJSON data or a <code>data.frame</code> if it does not.
<code>ohsome_sf()</code> and <code>ohsome_df()</code> wrapper functions for specific return
classes.
</p>


<h3>Value</h3>

<p>An <code>sf</code> object, a <code>data.frame</code>, a <code>list</code> or a <code>character</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create and send a query to ohsome API
r &lt;- ohsome_query("elements/centroid", filter = "amenity=*") |&gt;
    set_boundary(osmdata::getbb("Heidelberg")) |&gt;
    set_time("2021") |&gt;
    set_properties("metadata") |&gt;
    ohsome_post(parse = FALSE)

# Parse response to object of default class (here: sf)
ohsome_parse(r)

# Parse response to data.frame
ohsome_df(r)

# Parse response to sf
ohsome_sf(r)

## End(Not run)

</code></pre>

<hr>
<h2 id='ohsome_post'>Send POST request to ohsome API</h2><span id='topic+ohsome_post'></span>

<h3>Description</h3>

<p>Sends an <code>ohsome_query</code> object as a POST request to the ohsome API and
returns the response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_post(
  query,
  parse = TRUE,
  validate = TRUE,
  strict = validate,
  additional_identifiers = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_post_+3A_query">query</code></td>
<td>
<p>An <code>ohsome_query</code> object constructed with <code><a href="#topic+ohsome_query">ohsome_query()</a></code> or
any of its wrapper functions</p>
</td></tr>
<tr><td><code id="ohsome_post_+3A_parse">parse</code></td>
<td>
<p>logical; if <code>TRUE</code>, parse the ohsome API response with
<code><a href="#topic+ohsome_parse">ohsome_parse()</a></code></p>
</td></tr>
<tr><td><code id="ohsome_post_+3A_validate">validate</code></td>
<td>
<p>logical; if <code>TRUE</code>, issues warning for invalid endpoint or
invalid/missing query parameters.</p>
</td></tr>
<tr><td><code id="ohsome_post_+3A_strict">strict</code></td>
<td>
<p>logical; If <code>TRUE</code>, throws error on invalid query. Overrules
validate argument <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ohsome_post_+3A_additional_identifiers">additional_identifiers</code></td>
<td>
<p>vector coercible to character; optional user
agent identifiers in addition to <code>"ohsome-r/{version}"</code>.</p>
</td></tr>
<tr><td><code id="ohsome_post_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+ohsome_parse">ohsome_parse()</a></code>:
</p>

<ul>
<li> <p><code>returnclass</code>: class of the returned object
</p>
</li>
<li> <p><code>omit_empty</code>: logical; omit features with empty geometries (only if
<code>returnclass = "sf"</code>)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>ohsome_response</code> object if <code>parse = FALSE</code>, else an <code>sf</code> object,
a <code>data.frame</code>, a <code>list</code> or a <code>character</code>
</p>


<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/">ohsome API documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get bounding box of the city of Berlin
bbberlin &lt;- osmdata::getbb("Berlin")

# Query for cinema geometries within bounding box
q &lt;- ohsome_elements_geometry(bbberlin, filter = "amenity=cinema")

# Send query to ohsome API and return sf by default
ohsome_post(q)

# Send query to ohsome API and return data.frame
ohsome_post(q, returnclass = "data.frame")

# Send query and return unparsed response
ohsome_post(q, parse = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='ohsome_query'>Create an <code>ohsome_query</code> object</h2><span id='topic+ohsome_query'></span>

<h3>Description</h3>

<p>Creates an <code>ohsome_query</code> object specifying the ohsome API endpoint and
the request parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_query(endpoint, boundary = NULL, grouping = NULL, ..., validate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_query_+3A_endpoint">endpoint</code></td>
<td>
<p>The path to the
<a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html">ohsome API endpoint</a>.
Either a single string (e.g. <code>"elements/count"</code>) or a vector of character
in the right order (e.g. <code>c("elements", "count")</code>).</p>
</td></tr>
<tr><td><code id="ohsome_query_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_query_+3A_grouping">grouping</code></td>
<td>
<p>character; group type(s) for grouped aggregations (only
available for queries to aggregation endpoints). The following group types
are available:
</p>

<ul>
<li> <p><code>"boundary"</code> groups the result by the given boundaries that are defined
through any of the <code>boundary</code> query parameters.
</p>
</li>
<li> <p><code>"key"</code> groups the result by the given keys that are defined through the
<code>groupByKeys</code> query parameter.
</p>
</li>
<li> <p><code>"tag"</code> groups the result by the given tags that are defined through the
<code>groupByKey</code> and <code>groupByValues</code> query parameters.
</p>
</li>
<li> <p><code>"type"</code> groups the result by OSM element type.
</p>
</li>
<li> <p><code>c("boundary", "tag")</code> groups the result by the given boundaries and
tags.
</p>
</li></ul>

<p>Not all of these group types are accepted by all of the aggregation
endpoints. Check
<a href="https://docs.ohsome.org/ohsome-api/v1/group-by.html">Grouping</a>
for available group types.</p>
</td></tr>
<tr><td><code id="ohsome_query_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
<tr><td><code id="ohsome_query_+3A_validate">validate</code></td>
<td>
<p>logical; if <code>TRUE</code>, issues warning for invalid endpoint or
invalid/missing query parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/">ohsome API documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extract building geometries with manually set bboxes parameter
ohsome_query(
    "elements/geometry", 
    bboxes = "8.6,49.36,8.75,49.44", 
    time = "2022-01-01",
    filter = "building=*"
)

# Extract building geometries using a boundary object:
ohsome_query(
    "elements/geometry", 
    boundary = "8.6,49.36,8.75,49.44", 
    time = "2022-01-01",
    filter = "building=*"
)

</code></pre>

<hr>
<h2 id='ohsome_temporalExtent'>ohsome API temporal extent</h2><span id='topic+ohsome_temporalExtent'></span>

<h3>Description</h3>

<p>Temporal extent of the OSM data in the underlying OSHDB
</p>


<h3>Format</h3>

<p>A vector of POSIXct
</p>

<hr>
<h2 id='ohsome_users_count'>Count OSM users</h2><span id='topic+ohsome_users_count'></span>

<h3>Description</h3>

<p>Create an <code>ohsome_query</code> object for OSM users count
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohsome_users_count(
  boundary = NULL,
  return_value = c("absolute", "density"),
  grouping = NULL,
  time = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ohsome_users_count_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_users_count_+3A_return_value">return_value</code></td>
<td>
<p>character; the value to be returned by the ohsome API:
</p>

<ul>
<li> <p><code>"absolute"</code> returns the absolute number of users. This is the
default.
</p>
</li>
<li> <p><code>"density"</code> returns the number of users per square kilometer.
</p>
</li></ul>
</td></tr>
<tr><td><code id="ohsome_users_count_+3A_grouping">grouping</code></td>
<td>
<p>character; group type(s) for grouped aggregations (only
available for queries to aggregation endpoints). The following group types
are available:
</p>

<ul>
<li> <p><code>"boundary"</code> groups the result by the given boundaries that are defined
through any of the <code>boundary</code> query parameters.
</p>
</li>
<li> <p><code>"key"</code> groups the result by the given keys that are defined through the
<code>groupByKeys</code> query parameter.
</p>
</li>
<li> <p><code>"tag"</code> groups the result by the given tags that are defined through the
<code>groupByKey</code> and <code>groupByValues</code> query parameters.
</p>
</li>
<li> <p><code>"type"</code> groups the result by OSM element type.
</p>
</li>
<li> <p><code>c("boundary", "tag")</code> groups the result by the given boundaries and
tags.
</p>
</li></ul>

<p>Not all of these group types are accepted by all of the aggregation
endpoints. Check
<a href="https://docs.ohsome.org/ohsome-api/v1/group-by.html">Grouping</a>
for available group types.</p>
</td></tr>
<tr><td><code id="ohsome_users_count_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="ohsome_users_count_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ohsome_users_count()</code> creates an <code>ohsome_query</code> object for OSM users
aggregation. Boundary objects are passed via <code><a href="#topic+set_boundary">set_boundary()</a></code> into
<code><a href="#topic+ohsome_boundary">ohsome_boundary()</a></code>.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/stable/endpoints.html#users-aggregation">ohsome API Endpoints &ndash; Users Aggregation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yearly count of users contributing to man-made objects around "Null Island"
ohsome_users_count("0,0,10", filter = "man_made=*", time = "2012/2022/P1Y")

</code></pre>

<hr>
<h2 id='set_boundary'>Set boundary</h2><span id='topic+set_boundary'></span>

<h3>Description</h3>

<p>Set or modify the spatial filter of an existing <code>ohsome_query</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_boundary(query, boundary = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_boundary_+3A_query">query</code></td>
<td>
<p>An <code>ohsome_query</code> object constructed with <code><a href="#topic+ohsome_query">ohsome_query()</a></code> or
any of its wrapper functions</p>
</td></tr>
<tr><td><code id="set_boundary_+3A_boundary">boundary</code></td>
<td>
<p>Bounding geometries specified by WGS84 coordinates in the
order <code style="white-space: pre;">&#8288;lon,lat&#8288;</code>. The geometries of <code>sf</code> are transformed to WGS84 if the CRS
of the object is known. The following classes are supported:
</p>

<ul>
<li> <p><code>sf</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfc</code> with (MULTI)POLYGON geometries
</p>
</li>
<li> <p><code>sfg</code> with (MULTI)POLYGON geometries and WGS 84 coordinates
</p>
</li>
<li> <p><code>bbox</code> created with <code><a href="sf.html#topic+st_bbox">sf::st_bbox()</a></code> or <code><a href="tmaptools.html#topic+bb">tmaptools::bb()</a></code>
</p>
</li>
<li> <p><code>matrix</code> created with <code><a href="sp.html#topic+bbox">sp::bbox()</a></code> or <code><a href="osmdata.html#topic+getbb">osmdata::getbb()</a></code>
</p>
</li>
<li> <p><code>character</code> providing textual definitions of bounding polygons, boxes or
circles as allowed by the ohsome API (see
<a href="https://docs.ohsome.org/ohsome-api/stable/boundaries.html">ohsome API - Boundaries</a>
):
</p>

<ul>
<li><p> bboxes: WGS84 coordinates in the following format:
<code>"id1:lon1,lat1,lon2,lat2|id2:lon1,lat1,lon2,lat2|..."</code> OR
<code>"lon1,lat1,lon2,lat2|lon1,lat1,lon2,lat2|..."</code>
</p>
</li>
<li><p> bcircles: WGS84 coordinates + radius in meter in the following
format: <code>"id1:lon,lat,r|id2:lon,lat,r|..."</code> OR
<code>"lon,lat,r|lon,lat,r|..."</code>
</p>
</li>
<li><p> bpolys: WGS84 coordinates given as a list of coordinate pairs (as for
bboxes) or GeoJSON FeatureCollection. The first point has to be the same
as the last point and MultiPolygons are only supported in GeoJSON.
</p>
</li></ul>

</li>
<li> <p><code>list</code> of <code>bbox</code>, <code>matrix</code> or <code>character</code>. Bounding geometry types of all
list elements must be the same. Does not work with GeoJSON
FeatureCollections.
</p>
</li></ul>
</td></tr>
<tr><td><code id="set_boundary_+3A_...">...</code></td>
<td>
<p>Additional arguments other than <code>digits</code> are ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+set_boundary">set_boundary()</a></code> adds a spatial filter to an <code>ohsome_query</code> object or
replaces an existing one. The spatial filter of a query to the ohsome API can
be defined as one or more polygons, bounding boxes or bounding circles.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/">ohsome API documentation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Query without boundary definition
q &lt;- ohsome_query(
    "elements/count/groupBy/boundary", 
    filter = "building=*",
    time = "2022-01-01"
)

# Use franconia from the mapview package as bounding polygons

set_boundary(q, mapview::franconia, digits = 4)


# Use the bounding box of franconia

set_boundary(q, sf::st_bbox(mapview::franconia))


## Not run: 
# Get bounding box of the city of Kigali from OSM
set_boundary(q, osmdata::getbb("Kigali"))

## End(Not run)

# Definition of two named bounding circles
set_boundary(q, c("Circle 1:8.6528,49.3683,1000", "Circle 2:8.7294,49.4376,1000"))

</code></pre>

<hr>
<h2 id='set_endpoint'>Set endpoint</h2><span id='topic+set_endpoint'></span><span id='topic+set_grouping'></span>

<h3>Description</h3>

<p>Modifies the endpoint of an existing <code>ohsome_query</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_endpoint(query, endpoint, append = FALSE, reset_format = TRUE)

set_grouping(query, grouping, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_endpoint_+3A_query">query</code></td>
<td>
<p>An <code>ohsome_query</code> object constructed with <code><a href="#topic+ohsome_query">ohsome_query()</a></code> or
any of its wrapper functions</p>
</td></tr>
<tr><td><code id="set_endpoint_+3A_endpoint">endpoint</code></td>
<td>
<p>The path to the
<a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html">ohsome API endpoint</a>.
Either a single string (e.g. <code>"elements/count"</code>) or a vector of character
in the right order (e.g. <code>c("elements", "count")</code>).</p>
</td></tr>
<tr><td><code id="set_endpoint_+3A_append">append</code></td>
<td>
<p>logical; If <code>TRUE</code>, the provided endpoint string is appended to
the existing endpoint definition instead of replacing it. This is
particularly useful if you wish to add  <code>density</code>/<code>ratio</code> and/or a grouping
to an existing aggregation query.</p>
</td></tr>
<tr><td><code id="set_endpoint_+3A_reset_format">reset_format</code></td>
<td>
<p>logical; if <code>TRUE</code>, the format parameter of the query is
updated depending on the new endpoint.</p>
</td></tr>
<tr><td><code id="set_endpoint_+3A_grouping">grouping</code></td>
<td>
<p>character; group type(s) for grouped aggregations (only
available for queries to aggregation endpoints). The following group types
are available:
</p>

<ul>
<li> <p><code>"boundary"</code> groups the result by the given boundaries that are defined
through any of the <code>boundary</code> query parameters.
</p>
</li>
<li> <p><code>"key"</code> groups the result by the given keys that are defined through the
<code>groupByKeys</code> query parameter.
</p>
</li>
<li> <p><code>"tag"</code> groups the result by the given tags that are defined through the
<code>groupByKey</code> and <code>groupByValues</code> query parameters.
</p>
</li>
<li> <p><code>"type"</code> groups the result by OSM element type.
</p>
</li>
<li> <p><code>c("boundary", "tag")</code> groups the result by the given boundaries and
tags.
</p>
</li></ul>

<p>Not all of these group types are accepted by all of the aggregation
endpoints. Check
<a href="https://docs.ohsome.org/ohsome-api/v1/group-by.html">Grouping</a>
for available group types.</p>
</td></tr>
<tr><td><code id="set_endpoint_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>set_endpoint()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>set_endpoint()</code> takes an <code>ohsome_query</code> object and modifies the ohsome API
endpoint. <code>set_grouping()</code> takes an <code>ohsome_query</code> object and modifies the
endpoint path for grouped aggregations.
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/endpoints.html">ohsome API Endpoints</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Query for count of elements
q &lt;- ohsome_elements_count(
  boundary = "HD:8.5992,49.3567,8.7499,49.4371|HN:9.1638,49.113,9.2672,49.1766",
  time = "2022-01-01",
  filter = "highway=*"
)

# Modify query to aggregate length of elements instead of count
set_endpoint(q, "elements/length")

# Modify query to extract geometries instead of aggregating elements
set_endpoint(q, "elements/geometry")

# Append the endpoint path in order to group aggregation by boundary
set_endpoint(q, "groupBy/boundary", append = TRUE)

# Modify query to group aggregation by boundary
set_grouping(q, grouping = "boundary")

# Modify query to group by boundary, but keep format csv instead of geojson
set_grouping(q, grouping = "boundary", reset_format = FALSE)

# Append the endpoint path to query for element densities per boundary
set_endpoint(q, c("density", "groupBy", "boundary"), append = TRUE)

# Modify query to group aggregation by OSM element type
set_grouping(q, grouping = "type")

</code></pre>

<hr>
<h2 id='set_parameters'>Set parameters</h2><span id='topic+set_parameters'></span><span id='topic+set_time'></span><span id='topic+set_filter'></span><span id='topic+set_groupByKeys'></span><span id='topic+set_groupByKey'></span><span id='topic+set_groupByValues'></span><span id='topic+set_properties'></span>

<h3>Description</h3>

<p>Sets or modifies parameters of an existing <code>ohsome_query</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_parameters(query, ...)

set_time(query, time = query$body$time)

set_filter(query, filter = query$body$filter, filter2 = query$body$filter2)

set_groupByKeys(query, groupByKeys = query$body$groupByKeys)

set_groupByKey(query, groupByKey = query$body$groupByKey)

set_groupByValues(query, groupByValues = query$body$groupByValues)

set_properties(query, properties = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_parameters_+3A_query">query</code></td>
<td>
<p>An <code>ohsome_query</code> object constructed with <code><a href="#topic+ohsome_query">ohsome_query()</a></code> or
any of its wrapper functions</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_...">...</code></td>
<td>
<p>Parameters of the request to the ohsome API endpoint.</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_time">time</code></td>
<td>
<p>character; <code>time</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/time.html">Supported time formats</a>).</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_filter">filter</code></td>
<td>
<p>character; <code>filter</code> parameter of the query (see
<a href="https://docs.ohsome.org/ohsome-api/v1/filter.html">Filter</a>)</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_filter2">filter2</code></td>
<td>
<p>character; <code>filter2</code> parameter of a ratio query</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_groupbykeys">groupByKeys</code></td>
<td>
<p>character; <code>groupByKeys</code> parameter of a <code>groupBy/key</code> query</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_groupbykey">groupByKey</code></td>
<td>
<p>character; <code>groupByKey</code> parameter of a <code>groupBy/tag</code> query</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_groupbyvalues">groupByValues</code></td>
<td>
<p>character; <code>groupByValues</code> parameter of a <code>groupBy/tag</code>
query</p>
</td></tr>
<tr><td><code id="set_parameters_+3A_properties">properties</code></td>
<td>
<p>character; properties to be extracted with extraction
queries:
</p>

<ul>
<li> <p><code>"tags"</code>, and/or
</p>
</li>
<li> <p><code>"metadata"</code> (i.e. <code style="white-space: pre;">&#8288;@changesetId&#8288;</code>, <code style="white-space: pre;">&#8288;@lastEdit&#8288;</code>, <code style="white-space: pre;">&#8288;@osmType&#8288;</code>,
<code style="white-space: pre;">&#8288;@version&#8288;</code>), and/or
</p>
</li>
<li> <p><code>"contributionTypes"</code> (i.e. <code style="white-space: pre;">&#8288;@creation&#8288;</code>, <code style="white-space: pre;">&#8288;@tagChange&#8288;</code>, <code style="white-space: pre;">&#8288;@deletion&#8288;</code>, and
<code style="white-space: pre;">&#8288;@geometryChange&#8288;</code>; only for contributions extraction)
</p>
</li></ul>

<p>Multiple values can be provided as comma-separated character or as
character vector. This defaults to <code>NULL</code> (removes <code>properties</code> parameter
from the query body).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>set_parameters()</code> takes an <code>ohsome_query</code> object and an arbitrary number of
named parameters as an input. It sets or modifies these parameters in the
<code>ohsome_query</code> and returns the modified object. <code>set_time()</code>, <code>set_filter()</code>,
<code>set_groupByKeys()</code>, <code>set_groupByKey()</code>, <code>set_groupByValues()</code> and
<code>set_properties()</code> are wrapper functions to set specific parameters. By
default, an unmodified <code>ohsome_query</code> object is returned. In order to remove
a parameter from the query object, you can set the respective argument
explicitly to <code>NULL</code> (e.g. <code>set_filter(query, filter = NULL)</code>).
</p>


<h3>Value</h3>

<p>An <code>ohsome_query</code> object. The object can be sent to the ohsome API
with <code><a href="#topic+ohsome_post">ohsome_post()</a></code>. It consists of the following elements:
</p>

<ul>
<li> <p><code>url</code>: The URL of the endpoint.
</p>
</li>
<li> <p><code>encode</code>: The way the information is encoded and then posted to the
ohsome API. Set as <code>"form"</code>.
</p>
</li>
<li> <p><code>body</code>: The parameters of the query such as <code>format</code>, <code>filter</code> or
<code>bpolys</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="https://docs.ohsome.org/ohsome-api/v1/">https://docs.ohsome.org/ohsome-api/v1/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Query ratio grouped by boundary
q1 &lt;- ohsome_query(
     endpoint = "elements/count/ratio/groupBy/boundary",
     boundary = "HD:8.5992,49.3567,8.7499,49.4371|HN:9.1638,49.113,9.2672,49.1766"
)

# Add time, filter and format parameters
q1 |&gt;
    set_time("2021/2022/P3M") |&gt;
    set_filter("building=*", filter2 = "building=* and building:levels=3") |&gt;
    set_parameters(format = "csv")

# Query elements area grouped by tag
q2 &lt;- ohsome_query(
    endpoint = "elements/area/groupBy/tag",
    boundary = "HD:8.5992,49.3567,8.7499,49.4371"
)

# Add time, filter and groupByKey parameters
q2 |&gt;
    set_time("2021/2022/P3M") |&gt;
    set_filter("building=*") |&gt;
    set_groupByKey("building:levels")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
