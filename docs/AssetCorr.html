<!DOCTYPE html><html><head><title>Help for package AssetCorr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AssetCorr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyze_AssetCorr'><p>Function to evaluate several default time series simultaneously</p>
</p></a></li>
<li><a href='#AssetCorr-package'>
<p>AssetCorr</p></a></li>
<li><a href='#defaultTimeseries'><p>Creating a hypothetical Default Time Series.</p>
</p></a></li>
<li><a href='#interALL'><p>Function to use multiple estimators simultaneously</p>
</p></a></li>
<li><a href='#interCMM'><p> Corrected Asymptotic Method of Moments Estimator of Frei and Wunsch (2018)</p>
</p></a></li>
<li><a href='#interCopula'>
<p>Copula Based Maximum Likelihood Estimator</p></a></li>
<li><a href='#interCov'><p>Covariance Matching Estimator</p>
</p></a></li>
<li><a href='#interJDP'><p>Joint Default Probability Matching Estimator, De Servigny and Renault (2002)</p>
</p></a></li>
<li><a href='#interMLE'>
<p>Binomial Maximum Likelihood Estimator</p></a></li>
<li><a href='#intraALL'><p>Function to use multiple estimators simultaneously</p>
</p></a></li>
<li><a href='#intraAMLE'><p>Asymptotic Maximum Likelihood Estimator</p></a></li>
<li><a href='#intraAMM'><p> Asymptotic Method of Moments Estimator</p>
</p></a></li>
<li><a href='#intraBeta'><p> Parametric Approach of Botha and van Vuuren (2010)- Beta Distribution</p>
</p></a></li>
<li><a href='#intraCMM'><p>Corrected Asymptotic Method of Moments Estimator of Frei and Wunsch (2018)</p>
</p></a></li>
<li><a href='#intraFMM'><p>Finite Sample Method of Moments Estimator</p>
</p></a></li>
<li><a href='#intraJDP1'><p>Joint Default Probability Matching Estimator, Lucas (1995)</p>
</p></a></li>
<li><a href='#intraJDP2'><p>Joint Default Probability Matching Estimator,  De Servigny and Renault (2002)</p>
</p></a></li>
<li><a href='#intraMLE'><p>Binomial Maximum Likelihood Estimator</p>
</p></a></li>
<li><a href='#intraMode'><p> Parametric Approach of Botha and van Vuuren (2010)- Mode</p>
</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Asset Correlations from Default Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Maximilian Nagl [aut,cre], Yevhen Havrylenko [aut], Marius Pfeuffer [aut], Kevin Jakob [aut], Matthias Fischer [aut], Daniel Roesch [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maximilian Nagl &lt;maximilian.nagl@ur.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the estimation of intra- and inter-cohort correlations in the Vasicek credit portfolio model. For intra-cohort correlations, the package covers the two method of moments estimators of Gordy (2000) &lt;<a href="https://doi.org/10.1016%2FS0378-4266%2899%2900054-0">doi:10.1016/S0378-4266(99)00054-0</a>&gt;, the method of moments estimator of Lucas (1995) <a href="https://jfi.pm-research.com/content/4/4/76">https://jfi.pm-research.com/content/4/4/76</a> and a Binomial approximation extension of this approach. Moreover, the maximum likelihood estimators of Gordy and Heitfield (2010) <a href="http://elsa.berkeley.edu/~mcfadden/e242_f03/heitfield.pdf">http://elsa.berkeley.edu/~mcfadden/e242_f03/heitfield.pdf</a> and Duellmann and Gehde-Trapp (2004) <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a> are implemented. For inter-cohort correlations, the method of moments estimator of Bluhm and Overbeck (2003) &lt;<a href="https://doi.org/10.1007%2F978-3-642-59365-9_2">doi:10.1007/978-3-642-59365-9_2</a>&gt;/Bams et al. (2016) <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2676595">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2676595</a> is provided and the maximum likelihood estimators comprise the approaches of Gordy and Heitfield (2010)/Kalkbrener and Onwunta (2010) &lt;ISBN: 978-1906348250&gt; and Pfeuffer et al. (2020). Bootstrap and Jackknife procedures for bias correction are included as well as the method of moments estimator of Frei and Wunsch (2018) &lt;<a href="https://doi.org/10.21314%2FJCR.2017.231">doi:10.21314/JCR.2017.231</a>&gt; for auto-correlated time series.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>VineCopula, mvtnorm, boot, numDeriv, mvQuad, ggplot2,
Rdpack,knitr,qpdf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>markdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-05 14:53:18 UTC; LocalAdmin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-05 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyze_AssetCorr'>Function to evaluate several default time series simultaneously
</h2><span id='topic+analyze_AssetCorr'></span>

<h3>Description</h3>

<p>To give a first insight of several default time series, this function combines multiple estimator functions (intra and inter) and visualize the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze_AssetCorr(DTS,N, B=NA, DB=NA, JC=FALSE, CI_Boot=NA, Adjust=0.0001,
type="bca", Intra=c("AMM","FMM","CMM","JDP1","JDP2","MLE","AMLE","Beta","Mode"),
Inter=c("Copula","Cov","JDP","MLE"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze_AssetCorr_+3A_dts">DTS</code></td>
<td>
<p>a matrix, containing the default time series of each sector.

</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_n">N</code></td>
<td>
<p>a matrix, containing the number of obligors at the beginning of the period of sector.

</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate (intra and inter).
</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap (intra and inter).
</p>
</td></tr> 
<tr><td><code id="analyze_AssetCorr_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated (intra and inter).

</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified.
By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>(intra and inter).
</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_adjust">Adjust</code></td>
<td>
<p>a number, which should be added to a observed default rate of 0 or subtracted form a observed default rate of 1 (only for the intraAMLE).</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.</p>
</td></tr> 
<tr><td><code id="analyze_AssetCorr_+3A_intra">Intra</code></td>
<td>
<p>a combined string, indicating which intra correlation estimators should be used. All estimators are set as default.
</p>
</td></tr>
<tr><td><code id="analyze_AssetCorr_+3A_inter">Inter</code></td>
<td>
<p>a combined string, indicating which inter correlation estimators should be used. All estimators are set as default.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To give an first insight, the function provides an overview of the several default time series and estimates using different estimators (intra and inter) simultaneously. The plug-in estimates of the intra correlation using inter correlation methods will be estimated via <code>intraMLE</code>.
If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop.
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following entries:
</p>
<p>Estimators_Intra
</p>
<table>
<tr><td><code>Sector</code></td>
<td>
<p>Number of the sector</p>
</td></tr>
<tr><td><code>Sector_Name</code></td>
<td>
<p>Name of the sector</p>
</td></tr>
<tr><td><code>Estimator</code></td>
<td>
<p>Name of the applied estimator</p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>Value of the calculated estimate</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>String, which indicating corrected/non-corrected estimates</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>Name of the correction method</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Number of single bootstrap repetitions</p>
</td></tr>
<tr><td><code>DB</code></td>
<td>
<p>Number of the double bootstrap repetitions</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A string, indicating if the corresponding value is the upper or lower bound</p>
</td></tr>
</table>
<p>Estimators_Inter
</p>
<table>
<tr><td><code>Sector_1</code></td>
<td>
<p>Number of the sector</p>
</td></tr>
<tr><td><code>Sector_Name_1</code></td>
<td>
<p>Name of the sector</p>
</td></tr>
<tr><td><code>Sector_2</code></td>
<td>
<p>Number of the sector</p>
</td></tr>
<tr><td><code>Sector_Name_2</code></td>
<td>
<p>Name of the sector</p>
</td></tr>
<tr><td><code>Estimator</code></td>
<td>
<p>Name of the applied estimator to Sector_1 and Sector_2</p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>Value of the calculated estimateto Sector_1 and Sector_2</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>String, which indicating corrected/non-corrected estimates</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>Name of the correction method</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Number of single bootstrap repetitions</p>
</td></tr>
<tr><td><code>DB</code></td>
<td>
<p>Number of the double bootstrap repetitions</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A string, indicating if the corresponding value is the upper or lower bound</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Jakob
</p>


<h3>References</h3>

<p>Botha M, van Vuuren G (2010).
&ldquo;Implied asset correlation in retail loan portfolios.&rdquo;
<em>Journal of Risk Management in Financial Institutions</em>, <b>3</b>(2), 156&ndash;173. 
</p>
<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>De Servigny A, Renault O (2002).
&ldquo;Default correlation: empirical evidence.&rdquo;
<em>Working Paper, Standard and Poors</em>.
Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>.
</p>
<p>Duellmann K, Gehde-Trapp M (2004).
&ldquo;Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures.&rdquo;
<em>Bundesbank Series 2, Discussion Paper</em>.
Available at SSRN: <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a>. Accessed: 02.11.2017.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Frei C, Wunsch M (2018).
&ldquo;Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations.&rdquo;
<em>Journal of Credit Risk</em>, <b>14</b>, 1&ndash;29.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Gordy MB, Heitfield E (2010).
&ldquo;Small-sample estimation of models of portfolio credit risk.&rdquo;
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43&ndash;63.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>
<p>Lucas DJ (1995).
&ldquo;Default correlation and credit analysis.&rdquo;
<em>The Journal of Fixed Income</em>, <b>4</b>(4), 76&ndash;87.
</p>
<p>Meyer C (2009).
&ldquo;Estimation of intra-sector asset correlations.&rdquo;
<em>The Journal of Risk Model Validation</em>, <b>3</b>(3), 47&ndash;79.
</p>
<p>Teetor P (2011).
<em>R Cookbook: Proven recipes for data analysis, statistics, and graphics</em>.
O'Reilly Media, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraCMM">intraCMM</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>,
<code><a href="#topic+interJDP">interJDP</a></code>, <code><a href="#topic+interCopula">interCopula</a></code>,<code><a href="#topic+interCMM">interCMM</a></code>, 
<code><a href="#topic+interCov">interCov</a></code>, <code><a href="#topic+interMLE">interMLE</a></code>, <code><a href="#topic+intraALL">intraALL</a></code>, 
<code><a href="#topic+interALL">interALL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(mvtnorm)
set.seed(111)
NoO=1000 #Number of obligors in each sector
Years=20
AC=0.3
PD=0.01

Psi=rmvnorm(Years,sigma=matrix(c(1,0.5,0.5,0.5,1,0.5,0.5,0.5,1),3))
PDcond1=pnorm((qnorm(PD)-sqrt(AC)*Psi[,1])/sqrt(1-AC))
PDcond2=pnorm((qnorm(PD)-sqrt(AC/2)*Psi[,2])/sqrt(1-AC/2))
PDcond3=pnorm((qnorm(PD)-sqrt(AC*2)*Psi[,3])/sqrt(1-AC*2))

DTS=cbind(rbinom(Years,NoO,PDcond1),rbinom(Years,NoO,PDcond2),rbinom(Years,NoO,PDcond3))
N=matrix(NoO,nrow = Years,ncol = 3)

Output&lt;-analyze_AssetCorr(DTS,N)

#Bootstrap Correction and CIs

Output&lt;-analyze_AssetCorr(DTS,N,B=100,CI_Boot=0.95)

#Double Bootstrap Correction and Jackknife
Output&lt;-analyze_AssetCorr(DTS,N,DB=c(50,50),JC=TRUE)






</code></pre>

<hr>
<h2 id='AssetCorr-package'>
AssetCorr
</h2><span id='topic+AssetCorr-package'></span><span id='topic+AssetCorr'></span>

<h3>Description</h3>

 
<p>Functions for the estimation of intra- and inter-cohort correlations in the Vasicek credit portfolio model. For intra-cohort correlations, the package covers the two method of moments estimators of Gordy (2000) &lt;doi:10.1016/S0378-4266(99)00054-0&gt;, the method of moments estimator of Lucas (1995) &lt;https://jfi.pm-research.com/content/4/4/76&gt; and a Binomial approximation extension of this approach. Moreover, the maximum likelihood estimators of Gordy and Heitfield (2010) &lt;http://elsa.berkeley.edu/~mcfadden/e242_f03/heitfield.pdf&gt; and Duellmann and Gehde-Trapp (2004) &lt;http://hdl.handle.net/10419/19729&gt; are implemented. For inter-cohort correlations, the method of moments estimator of Bluhm and Overbeck (2003) &lt;doi:10.1007/978-3-642-59365-9_2&gt;/Bams et al. (2016) &lt;https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2676595&gt; is provided and the maximum likelihood estimators comprise the approaches of Gordy and Heitfield (2010)/Kalkbrener and Onwunta (2010) &lt;ISBN: 978-1906348250&gt; and Pfeuffer et al. (2020). Bootstrap and Jackknife procedures for bias correction are included as well as the method of moments estimator of Frei and Wunsch (2018) &lt;doi:10.21314/JCR.2017.231&gt; for auto-correlated time series.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> AssetCorr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Estimating Asset Correlations from Default Data</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-05-04</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Maximilian Nagl [aut,cre], Yevhen Havrylenko [aut], Marius Pfeuffer [aut], Kevin Jakob [aut], Matthias Fischer [aut], Daniel Roesch [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Maximilian Nagl &lt;maximilian.nagl@ur.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Functions for the estimation of intra- and inter-cohort correlations in the Vasicek credit portfolio model. For intra-cohort correlations, the package covers the two method of moments estimators of Gordy (2000) &lt;doi:10.1016/S0378-4266(99)00054-0&gt;, the method of moments estimator of Lucas (1995) &lt;https://jfi.pm-research.com/content/4/4/76&gt; and a Binomial approximation extension of this approach. Moreover, the maximum likelihood estimators of Gordy and Heitfield (2010) &lt;http://elsa.berkeley.edu/~mcfadden/e242_f03/heitfield.pdf&gt; and Duellmann and Gehde-Trapp (2004) &lt;http://hdl.handle.net/10419/19729&gt; are implemented. For inter-cohort correlations, the method of moments estimator of Bluhm and Overbeck (2003) &lt;doi:10.1007/978-3-642-59365-9_2&gt;/Bams et al. (2016) &lt;https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2676595&gt; is provided and the maximum likelihood estimators comprise the approaches of Gordy and Heitfield (2010)/Kalkbrener and Onwunta (2010) &lt;ISBN: 978-1906348250&gt; and Pfeuffer et al. (2020). Bootstrap and Jackknife procedures for bias correction are included as well as the method of moments estimator of Frei and Wunsch (2018) &lt;doi:10.21314/JCR.2017.231&gt; for auto-correlated time series.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> VineCopula, mvtnorm, boot, numDeriv, mvQuad, ggplot2, Rdpack,knitr,qpdf</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> markdown</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
RdMacros: </td><td style="text-align: left;"> Rdpack</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
AssetCorr-package       AssetCorr
analyze_AssetCorr       Function to evaluate several default time
                        series simultaneously
defaultTimeseries       Creating a hypothetical Default Time Series.
interALL                Function to use multiple estimators
                        simultaneously
interCMM                Corrected Asymptotic Method of Moments
                        Estimator of Frei and Wunsch (2018)
interCopula             Copula Based Maximum Likelihood Estimator
interCov                Covariance Matching Estimator
interJDP                Joint Default Probability Matching Estimator,
                        De Servigny and Renault (2002)
interMLE                Binomial Maximum Likelihood Estimator
intraALL                Function to use multiple estimators
                        simultaneously
intraAMLE               Asymptotic Maximum Likelihood Estimator
intraAMM                Asymptotic Method of Moments Estimator
intraBeta               Parametric Approach of Botha and van Vuuren
                        (2010)- Beta Distribution
intraCMM                Corrected Asymptotic Method of Moments
                        Estimator of Frei and Wunsch (2018)
intraFMM                Finite Sample Method of Moments Estimator
intraJDP1               Joint Default Probability Matching Estimator,
                        Lucas (1995)
intraJDP2               Joint Default Probability Matching Estimator,
                        De Servigny and Renault (2002)
intraMLE                Binomial Maximum Likelihood Estimator
intraMode               Parametric Approach of Botha and van Vuuren
                        (2010)- Mode
</pre>


<h3>Author(s)</h3>

<p>Maximilian Nagl [aut,cre],Yevhen Havrylenko [aut], Marius Pfeuffer [aut],  Matthias Fischer [aut],  Daniel Roesch [aut]
</p>
<p>Maintainer: Maximilian Nagl &lt;maximilian.nagl@ur.de&gt;
</p>


<h3>References</h3>

<p>De Servigny, A. and O. Renault: Default correlation: empirical evidence. Working Paper, Standard and Poor's: 90-94, 2003. Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>. Accessed: 04.05.2020
</p>
<p>Duellmann, K. and M. Gehde-Trapp: Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures. Bundesbank Series 2, Discussion Paper (2): 2004. Available at SSRN: <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2793954">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2793954</a>. Accessed: 01.05.2018
</p>
<p>Duellmann, K., J. Kuell and M. Kunisch: Estimating asset correlations from stock prices or default rates- Which method is superior? Journal of Economic Dynamics and Control 34(11): 2341-2357, 2010
</p>
<p>Efron, B. and R. J. Tibshirani: An introduction to the bootstrap. CRC press, 1994
</p>
<p>Pfeuffer, M.,  M. Nagl, M. Fischer  and D. Roesch: Parameter Estimation and Bias Correction in the Vasicek Credit Portfolio Model.  Journal of Risk 22(4), 2020
</p>
<p>Frei, C. and M. Wunsch: Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations. Journal of Credit Risk 14: 1-29, 2018
</p>
<p>Gordy, M. B.: A comparative anatomy of credit risk models. Journal of Banking &amp;
Finance 24(1): 119-149, 2000
</p>
<p>Gordy, M. B. and E. Heitfield: Small-sample estimation of models of portfolio credit risk. In Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August
2009: 43-63, World Scientific, 2010
</p>
<p>Hoese, S. and S. Huschens: Confidence intervals for asset correlations in the asymptotic single risk factor model. In Operations Research Proceedings 2010:  111-116, 2010
</p>
<p>Kalkbrener, M. and A. Onwunta: Validating structural credit portfolio models. Model risk-identification, measurement and management. Risk Books, London: 233-261, 2010
</p>
<p>Loeffler, G. The effects of estimation error on measures of portfolio credit risk. Journal of Banking &amp; Finance 27(8): 1427-1453, 2003
</p>
<p>Lucas, D. J.: Default correlation and credit analysis. The Journal of Fixed Income 4(4): 76-87, 1995
</p>
<p>Meyer, C.: Estimation of intra-sector asset correlations. The Journal of Risk Model Validation 3(3): 47-79, 2009
</p>
<p>Vasicek, O. A: The distribution of loan portfolio value. Risk 15(12): 160-162, 2002
</p>

<hr>
<h2 id='defaultTimeseries'>Creating a hypothetical Default Time Series.
</h2><span id='topic+defaultTimeseries'></span>

<h3>Description</h3>

<p>This function return a time series of defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defaultTimeseries(N, AC, Years, PD)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defaultTimeseries_+3A_n">N</code></td>
<td>
<p> Number of obligors for each point in time.
</p>
</td></tr>
<tr><td><code id="defaultTimeseries_+3A_ac">AC</code></td>
<td>
<p> Desired asset correlation.
</p>
</td></tr>
<tr><td><code id="defaultTimeseries_+3A_years">Years</code></td>
<td>
<p> Number of points in time, which corresponds to the length of the default time series.
</p>
</td></tr>
<tr><td><code id="defaultTimeseries_+3A_pd">PD</code></td>
<td>
<p> Uniform probability of default assumed for each obligor.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to draw a random default time series, assuming a specific length of the time series, number of obligors, a uniform asset correlation and a uniform probability of default.
</p>


<h3>Value</h3>

<p>The output contains a Nx1-vector with simulated defaults for each point in time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
D1&lt;-defaultTimeseries(1000,0.1,10,0.01)
</code></pre>

<hr>
<h2 id='interALL'>Function to use multiple estimators simultaneously
</h2><span id='topic+interALL'></span>

<h3>Description</h3>

<p>To give a first insight of the default time series, this function combines multiple estimator functions and visualize the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interALL(d1,n1,d2,n2,rho1,rho2, B=NA, DB=NA, JC=FALSE, CI_Boot=NA, plot=FALSE, 
type="bca",Estimator=c("Copula","Cov","JDP","MLE"),show_progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interALL_+3A_d1">d1</code></td>
<td>
<p>a vector, containing the default time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_n1">n1</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 1.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_d2">d2</code></td>
<td>
<p>a vector, containing the default time series of sector 2.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_n2">n2</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 2.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_rho1">rho1</code></td>
<td>
<p>estimated intra correlation of sector 1.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_rho2">rho2</code></td>
<td>
<p>estimated intra correlation of sector 2.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="interALL_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified.
By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the default time series and the estimates should be generated using the <code>multiplot</code> function of Teetor (2011).
</p>
</td></tr>
<tr><td><code id="interALL_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.</p>
</td></tr> 
<tr><td><code id="interALL_+3A_estimator">Estimator</code></td>
<td>
<p>a combined string, indicating which estimators should be used. All estimators are set as default.
</p>
</td></tr>
<tr><td><code id="interALL_+3A_show_progress">show_progress</code></td>
<td>
<p>a logical variable, indicating whether a progress bar should be displayed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To give an first insight, the function provides an overview of the default time series and estimates using different estimators simultaneously. 
If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop.
</p>


<h3>Value</h3>

<p>The returned value is a data frame, containing the following columns:
</p>
<table>
<tr><td><code>Estimator</code></td>
<td>
<p>Name of the applied estimator</p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>Value of the calculated estimate</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>String, which indicating corrected/non-corrected estimates</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>Name of the correction method</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Number of single bootstrap repetitions</p>
</td></tr>
<tr><td><code>DB</code></td>
<td>
<p>Number of the double bootstrap repetitions</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A string, indicating if the corresponding value is the upper or lower bound</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Jakob
</p>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>De Servigny A, Renault O (2002).
&ldquo;Default correlation: empirical evidence.&rdquo;
<em>Working Paper, Standard and Poors</em>.
Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>.
</p>
<p>Duellmann K, Gehde-Trapp M (2004).
&ldquo;Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures.&rdquo;
<em>Bundesbank Series 2, Discussion Paper</em>.
Available at SSRN: <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a>. Accessed: 02.11.2017.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Frei C, Wunsch M (2018).
&ldquo;Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations.&rdquo;
<em>Journal of Credit Risk</em>, <b>14</b>, 1&ndash;29.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Gordy MB, Heitfield E (2010).
&ldquo;Small-sample estimation of models of portfolio credit risk.&rdquo;
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43&ndash;63.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>
<p>Lucas DJ (1995).
&ldquo;Default correlation and credit analysis.&rdquo;
<em>The Journal of Fixed Income</em>, <b>4</b>(4), 76&ndash;87.
</p>
<p>Meyer C (2009).
&ldquo;Estimation of intra-sector asset correlations.&rdquo;
<em>The Journal of Risk Model Validation</em>, <b>3</b>(3), 47&ndash;79.
</p>
<p>Teetor P (2011).
<em>R Cookbook: Proven recipes for data analysis, statistics, and graphics</em>.
O'Reilly Media, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>
<code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraCMM">intraCMM</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(111)
Psi=rmvnorm(20,sigma=matrix(c(1,0.5,0.5,1),2))
PDcond1=pnorm((qnorm(0.01)-sqrt(0.05)*Psi[,1])/sqrt(1-0.05))
PDcond2=pnorm((qnorm(0.01)-sqrt(0.2)*Psi[,2])/sqrt(1-0.2))

D1=rbinom(20,1000,PDcond1)
D2=rbinom(20,1000,PDcond2)

N1=N2=rep(1000,20)

DTS=cbind(D1,D2)
N=cbind(N1,N2)

rho1=intraMLE(D1,N1)$Original
rho2=intraMLE(D2,N2)$Original

#Point Estimates
interALL(D1,N1,D2,N2,rho1,rho2, plot=TRUE)

#Bootstrap corrected estimates of all available estimators:
InterCorr=interALL(D1,N1,D2,N2,rho1,rho2, B=500, CI_Boot=0.95 , plot=TRUE, show_progress=TRUE)


#Jackknife correction
InterCorr=interALL(D1,N1,D2,N2,rho1,rho2, JC=TRUE, plot=TRUE)

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
InterCorr=interALL(D1,N1,D2,N2,rho1,rho2, DB=c(10,50), plot=TRUE)




</code></pre>

<hr>
<h2 id='interCMM'> Corrected Asymptotic Method of Moments Estimator of Frei and Wunsch (2018)
</h2><span id='topic+interCMM'></span>

<h3>Description</h3>

<p>This method provides analytical bias correction via Taylor series expansion. Additionally the bias due to autocorrelated default time series can be corrected. The estimated parameter is the inter correlation of the asset variables (in contrast to all other  inter correlation methods of this package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interCMM(d1,n1,d2,n2,rho,l=0, B=0,DB=c(0,0), JC=FALSE,
CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interCMM_+3A_d1">d1</code></td>
<td>
<p>a vector, containing the default time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_n1">n1</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 1.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_d2">d2</code></td>
<td>
<p>a vector, containing the default time series of sector 2.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_n2">n2</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 2.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_rho">rho</code></td>
<td>
<p>estimated inter asset correlation of another estimator.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_l">l</code></td>
<td>
<p>a number, indicating how many lags of autocorrelation should be used for the correction.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interCMM_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence level if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr> 
<tr><td><code id="interCMM_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr> 
<tr><td><code id="interCMM_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the inter correlation of the asset variables. In general, the inter correlation can be estimated for the asset variables or the systematic factors. This estimator uses a inter correlation estimate of another method to correct the bias due to small sample or autocorrelation. Only one parameter (inter correlation) must be estimated.  Additionally, asymptotic confidence interval can be provided, as shown by Frei and Wunsch (2018). The inter correlation of the asset variables can be transformed to the correlation of the systematic factors as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Systematic= rho_Asset/sqrt(rho_1*rho_2)</code>
</p>

<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Frei C, Wunsch M (2018).
&ldquo;Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations.&rdquo;
<em>Journal of Credit Risk</em>, <b>14</b>, 1&ndash;29.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interJDP">interJDP</a></code>, <code><a href="#topic+interCopula">interCopula</a></code>, <code><a href="#topic+interMLE">interMLE</a></code>, <code><a href="#topic+interCov">interCov</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n1=n2=rep(1000,10)

#Using the Covariance method to estimate the plug-in inter correlation.
inter_sys=interCov(d1,n1,d2,n2,0.1,0.2)$Original
inter_asset= inter_sys*sqrt(0.1*0.2)

interCMM(d1,n1,d2,n2,inter_asset,l=0)


InterCorr=interCMM(d1,n1,d2,n2,inter_asset, JC=TRUE)
InterCorr=interCMM(d1,n1,d2,n2,inter_asset, B=1000, CI_Boot=0.95, plot=TRUE)


InterCorr=interCMM(d1,n1,d2,n2,inter_asset, DB=c(10,50))


</code></pre>

<hr>
<h2 id='interCopula'>
Copula Based Maximum Likelihood Estimator
</h2><span id='topic+interCopula'></span>

<h3>Description</h3>

<p>The inter correlation parameter can be estimated by fitting a Gaussian copula with Vasicek distributed margins on two observed default rate time series. The estimated parameter is the inter correlation of the systematic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interCopula(df1, df2, B = 0, DB=c(0,0),JC = FALSE, 
 CI, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interCopula_+3A_df1">df1</code></td>
<td>
<p>a vector, containing the default rate time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_df2">df2</code></td>
<td>
<p>a vector, containing the default rate times eries of sector 2.
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="interCopula_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_ci">CI</code></td>
<td>
<p>a number, indicating the desired asymptotic confidence interval of the estimate. 
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired bootstrap confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr> 
<tr><td><code id="interCopula_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. 
</p>
</td></tr>
<tr><td><code id="interCopula_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the inter correlation of the systematic factors. In general the inter correlation can be estimated for the asset variables or the systematic factors. This method estimates the inter correlation of the systematic factors. The parameter will be estimated via Maximum Likelihood estimation, which ensures that an asymptotic confidence interval can be provided. The inter correlation of the systematic factors can be transformed to the correlation of the asset variables as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Asset= rho_Systematic*sqrt(rho_1*rho_2)</code>
</p>

<p>The estimated inter correlation of the systematic factors lies between -1 and 1.
If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Selected two-sided asymptotic bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Pfeuffer M, Nagl M, Fischer M, Roesch D (2020).
&ldquo;Parameter Estimation and Bias Correction in the Vasicek Credit Portfolio Model.&rdquo;
<em>Journal of Risk</em>, <b>22number</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interJDP">interJDP</a></code>, <code><a href="#topic+interCMM">interCMM</a></code>, <code><a href="#topic+interMLE">interMLE</a></code>, <code><a href="#topic+interCov">interCov</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n=rep(1000,10)

df1=d1/n
df2=d2/n

InterCorr=interCopula(df1,df2, CI=0.95)



InterCorr=interCopula(df1,df2, JC=TRUE)

InterCorr=interCopula(df1,df2, B=1000, CI_Boot=0.95, plot=TRUE)

InterCorr=interCopula(df1,df2, DB=c(50,50))


</code></pre>

<hr>
<h2 id='interCov'>Covariance Matching Estimator
</h2><span id='topic+interCov'></span>

<h3>Description</h3>

<p>The inter correlation parameter can be estimated by matching the empirical covariance of two default time series with the theoretical. The estimated parameter is the inter correlation of the systematic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interCov(d1, n1, d2, n2, rho1, rho2, B = 0, DB=c(0,0), JC = FALSE,
CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interCov_+3A_d1">d1</code></td>
<td>
<p>a vector, containing the default time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_n1">n1</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 1.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_d2">d2</code></td>
<td>
<p>a vector, containing the default times eries of sector 2.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_n2">n2</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 2.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_rho1">rho1</code></td>
<td>
<p>estimated intra asset correlation of sector 1.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_rho2">rho2</code></td>
<td>
<p>estimated intra asset correlation of sector 2.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="interCov_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence level if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="interCov_+3A_type">type</code></td>
<td>
<p>a string indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr>
<tr><td><code id="interCov_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the inter correlation of the systematic factors. In general, the inter correlation can be estimated for the asset variables or the systematic factors. To ensure the traceability of the estimation, the intra correlation estimates will be used as plug-in estimates. Hence only one parameter (inter correlation) must be estimated. The inter correlation of the systematic factors can be transformed to the correlation of the asset variables as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Asset= rho_Systematic*sqrt(rho_1*rho_2)</code>
</p>

<p>The estimated inter correlation of the systematic factors lies between -1 and 1.
</p>
<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Bluhm C, Overbeck L (2003).
&ldquo;Systematic risk in homogeneous credit portfolios.&rdquo;
<em>Credit risk. Physica-Verlag, Heidelberg</em>, 35&ndash;48.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interJDP">interJDP</a></code>, <code><a href="#topic+interCMM">interCMM</a></code>, <code><a href="#topic+interMLE">interMLE</a></code>, <code><a href="#topic+interCopula">interCopula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n1=n2=rep(1000,10)

InterCorr=interCov(d1,n1,d2,n2,0.1,0.2)



InterCorr=interCov(d1,n1,d2,n2,0.1,0.2, JC=TRUE)
InterCorr=interCov(d1,n1,d2,n2,0.1,0.2, B=1000, CI_Boot=0.95)

InterCorr=interCov(d1,n1,d2,n2,0.1,0.2, DB=c(50,50))



</code></pre>

<hr>
<h2 id='interJDP'>Joint Default Probability Matching Estimator, De Servigny and Renault (2002)
</h2><span id='topic+interJDP'></span>

<h3>Description</h3>

<p>The inter correlation parameter can be estimated by matching the empirical Joint Default Probability of two default time series with the theoretical one. The estimated parameter is the correlation of the systematic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interJDP(d1, n1, d2, n2, rho1, rho2, B = 0, DB=c(0,0), JC = FALSE, 
CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interJDP_+3A_d1">d1</code></td>
<td>
<p>a vector, containing the default time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_n1">n1</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 1.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_d2">d2</code></td>
<td>
<p>a vector, containing the default time series of sector 2.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_n2">n2</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 2.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_rho1">rho1</code></td>
<td>
<p>estimated intra correlation of sector 1.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_rho2">rho2</code></td>
<td>
<p>estimated intra correlation of sector 2.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interJDP_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence level if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="interJDP_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr> 
<tr><td><code id="interJDP_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the inter correlation of the systematic factor. In general, the inter correlation can be estimated for the asset variables or the systematic factors. To ensure the traceability of the estimation, the intra correlation estimates will be used as plug-in estimates. Hence only one parameter (inter correlation) must be estimated. The inter correlation of the systematic factor can be transformed to the correlation of the asset variables as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Asset= rho_Systematic*sqrt(rho_1*rho_2)</code>
</p>

<p>The estimated inter correlation of the systematic factors lies between -1 and 1.
</p>
<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>De Servigny A, Renault O (2002).
&ldquo;Default correlation: empirical evidence.&rdquo;
<em>Working Paper, Standard and Poors</em>.
Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interCov">interCov</a></code>, <code><a href="#topic+interCMM">interCMM</a></code>, <code><a href="#topic+interMLE">interMLE</a></code>, <code><a href="#topic+interCopula">interCopula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n1=n2=rep(1000,10)

InterCorr=interJDP(d1,n1,d2,n2,0.1,0.2)



InterCorr=interJDP(d1,n1,d2,n2,0.1,0.2, JC=TRUE)
InterCorr=interJDP(d1,n1,d2,n2,0.1,0.2, B=1000, CI_Boot=0.95)

InterCorr=interJDP(d1,n1,d2,n2,0.1,0.2, DB=c(10,50))



</code></pre>

<hr>
<h2 id='interMLE'>
Binomial Maximum Likelihood Estimator
</h2><span id='topic+interMLE'></span>

<h3>Description</h3>

<p>The inter correlation parameter can be estimated by maximizing the Vasicek-binomial log-likelihood. The default process in the Vasicek model follows a binomial distribution, conditional on the realisation of the systematic factor. Hence, the inter correlation of the systematic factor can be estimated by maximizing the resulting log likelihood. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interMLE(d1, n1, d2, n2, rho1, rho2, B = 0, DB=c(0,0), JC = FALSE,
CI, plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interMLE_+3A_d1">d1</code></td>
<td>
<p>a vector, containing the default time series of sector 1.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_n1">n1</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 1.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_d2">d2</code></td>
<td>
<p>a vector, containing the default time series of sector 2.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_n2">n2</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in sector 2.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_rho1">rho1</code></td>
<td>
<p>estimated intra correlation of sector 1.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_rho2">rho2</code></td>
<td>
<p>estimated intra correlation of sector 2.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="interMLE_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_ci">CI</code></td>
<td>
<p>a number, indicating the desired asymptotic confidence bound of the estimate. 
</p>
</td></tr>
<tr><td><code id="interMLE_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the inter correlation of the systematic factor. In general, the inter correlation can be estimated for the asset variables or the systematic factors. To ensure the traceability of the estimation, the intra correlation estimates will be used as plug-in estimates. Hence only one parameter (inter correlation) must be estimated. The inter correlation of the systematic factor can be transformed to the correlation of the asset variables as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Asset= rho_Systematic*sqrt(rho_1*rho_2)</code>
</p>

<p>The estimated inter correlation of the systematic factors lies between -1 and 1.
</p>
<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Selected two-sided asymptotic bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB, Heitfield E (2010).
&ldquo;Small-sample estimation of models of portfolio credit risk.&rdquo;
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43&ndash;63.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+interJDP">interJDP</a></code>, <code><a href="#topic+interCopula">interCopula</a></code>, <code><a href="#topic+interCMM">interCMM</a></code>, <code><a href="#topic+interCov">interCov</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>

d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n1=n2=rep(1000,10)

InterCorr=interMLE(d1,n1,d2,n2,0.1,0.2, CI=0.95)

InterCorr=interMLE(d1,n1,d2,n2,0.1,0.2, JC=TRUE)

InterCorr=interMLE(d1,n1,d2,n2,0.1,0.2, B=1000, CI_Boot=0.95)

InterCorr=interMLE(d1,n1,d2,n2,0.1,0.2, DB=c(10,50))




</code></pre>

<hr>
<h2 id='intraALL'>Function to use multiple estimators simultaneously
</h2><span id='topic+intraALL'></span>

<h3>Description</h3>

<p>To give a first insight of the default time series, this function combines multiple estimator functions and visualize the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraALL(d,n, B=NA, DB=NA, JC=FALSE, CI_Boot=NA, Adjust=0.0001, plot=FALSE, 
type="bca", Quantile=0.999, Estimator=c("AMM","FMM","CMM","JDP1","JDP2",
"MLE","AMLE","Beta","Mode"),show_progress=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraALL_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraALL_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified.
By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_adjust">Adjust</code></td>
<td>
<p>a number, which should be added to a observed default rate of 0 or subtracted form a observed default rate of 1 (only for the AMLE).</p>
</td></tr>
<tr><td><code id="intraALL_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the default time series and the estimates should be generated using the <code>multiplot</code> function of Teetor (2011).
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.</p>
</td></tr>
<tr><td><code id="intraALL_+3A_quantile">Quantile</code></td>
<td>
<p>a number, indicating the desired confidence level of the Value-at-Risk (only for the intraBeta). 
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_estimator">Estimator</code></td>
<td>
<p>a combined string, indicating which estimators should be used. All estimators are set as default.
</p>
</td></tr>
<tr><td><code id="intraALL_+3A_show_progress">show_progress</code></td>
<td>
<p>a logical variable, indicating whether a progress bar should be displayed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To give an first insight, the function provides an overview of the default time series and estimates using different estimators simultaneously. 
If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop.
</p>


<h3>Value</h3>

<p>The returned value is a data frame, containing the following columns:
</p>
<table>
<tr><td><code>Estimator</code></td>
<td>
<p>Name of the applied estimator</p>
</td></tr>
<tr><td><code>Estimate</code></td>
<td>
<p>Value of the calculated estimate</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>String, which indicating corrected/non-corrected estimates</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>Name of the correction method</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Number of single bootstrap repetitions</p>
</td></tr>
<tr><td><code>DB</code></td>
<td>
<p>Number of the double bootstrap repetitions</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A string, indicating if the corresponding value is the upper or lower bound</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Jakob
</p>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>De Servigny A, Renault O (2002).
&ldquo;Default correlation: empirical evidence.&rdquo;
<em>Working Paper, Standard and Poors</em>.
Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>.
</p>
<p>Duellmann K, Gehde-Trapp M (2004).
&ldquo;Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures.&rdquo;
<em>Bundesbank Series 2, Discussion Paper</em>.
Available at SSRN: <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a>. Accessed: 02.11.2017.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Frei C, Wunsch M (2018).
&ldquo;Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations.&rdquo;
<em>Journal of Credit Risk</em>, <b>14</b>, 1&ndash;29.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Gordy MB, Heitfield E (2010).
&ldquo;Small-sample estimation of models of portfolio credit risk.&rdquo;
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43&ndash;63.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>
<p>Lucas DJ (1995).
&ldquo;Default correlation and credit analysis.&rdquo;
<em>The Journal of Fixed Income</em>, <b>4</b>(4), 76&ndash;87.
</p>
<p>Meyer C (2009).
&ldquo;Estimation of intra-sector asset correlations.&rdquo;
<em>The Journal of Risk Model Validation</em>, <b>3</b>(3), 47&ndash;79.
</p>
<p>Teetor P (2011).
<em>R Cookbook: Proven recipes for data analysis, statistics, and graphics</em>.
O'Reilly Media, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraCMM">intraCMM</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(10)
d=defaultTimeseries(1000,0.01,20,0.01)
n=rep(1000,20)

#Point Estimate of all available estimators:
intraALL(d,n,Adjust=0.001, plot=TRUE)

#Bootstrap corrected estimates of all available estimators:
IntraCorr=intraALL(d,n, Adjust=0.001, B=500, CI_Boot=0.95 , plot=TRUE, show_progress=TRUE)

#Select some estimators
IntraCorr=intraALL(d,n,B=500,  CI_Boot=0.95, Adjust=0.001 ,Estimator=c("AMM","FMM"), plot=TRUE)

#Jackknife correction
IntraCorr=intraALL(d,n, JC=TRUE,Adjust=0.001, plot=TRUE)

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraALL(d,n, DB=c(10,50),Adjust=0.001, plot=TRUE)




</code></pre>

<hr>
<h2 id='intraAMLE'>Asymptotic Maximum Likelihood Estimator
</h2><span id='topic+intraAMLE'></span>

<h3>Description</h3>

<p>This estimator is based on the assumption of infinitely large portfolio size and a sufficient length of the default time series. In the asymptotic case, neither the default rate of 0 or a 1 occur. Hence one has to make an adjustment in these cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraAMLE(d, n, B = 0, DB=c(0,0),JC = FALSE, Adjust = 0,
CI_1,CI_2, CI_Boot,VaR=0.99, VaR_CI=0.95, ES=0.975, ES_CI=0.95,
type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraAMLE_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraAMLE_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_adjust">Adjust</code></td>
<td>
<p>a number, which should be added to a observed default rate of 0 or subtracted form a observed default rate of 1.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_ci_1">CI_1</code></td>
<td>
<p>a number, indicating the desired analytical confidence interval of the estimate. The interval is computed by asymptotic Cramer-Rao lower bound for the standard deviation of the estimate based on Duellmann and Gehde-Trapp (2004). Additionally the asymptotic confidence interval for the unconditional PD is computed.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_ci_2">CI_2</code></td>
<td>
<p>a number, indicating the desired analytical confidence interval of the estimate. The interval is computed by constructing a confidence interval for the variance, which can be transferred to the estimate based on Hoese and Huschens (2011).
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified.
By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_var">VaR</code></td>
<td>
<p>a number, indicating the desired confidence level for the asymptotic Value-at-Risk.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_var_ci">VaR_CI</code></td>
<td>
<p> a number, indicating the desired confidence interval for the asymptotic Value-at-Risk, derived by the delta method.</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_es">ES</code></td>
<td>
<p>a number, indicating the desired confidence level for the asymptotic Expected Shortfall.
</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_es_ci">ES_CI</code></td>
<td>
<p> a number, indicating the desired confidence interval for the asymptotic Expected Shortfall, derived by the delta method.</p>
</td></tr>
<tr><td><code id="intraAMLE_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr> 
<tr><td><code id="intraAMLE_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This estimator is based on the asymptotic assumptions of the Vasicek model, especially the assumption of an infinite large portfolio. If a 0 or 1 occurs at least once in the default rate time series, the estimator can not converge. Therefore, an adjustment (<code>Adjust</code>) can be made. Nevertheless, Meyer (2009) argued that the adjustment can harm the estimation efficiency.
</p>
<p>Additionally two different asymptotic confidence intervals are provided. Bootstrap and jackknife corrections are also possible. If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>PD</code></td>
<td>
<p>Estimate of the unconditional PD based on Duellmann and Gehde-Trapp (2004)</p>
</td></tr>
<tr><td><code>PD_CI_1</code></td>
<td>

<p>[Two-sided asymptotic confidence interval for the unconditional PD based on Duellmann and Gehde-Trapp (2004)</p>
</td></tr>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_1</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval based on Duellmann and Gehde-Trapp (2004)</p>
</td></tr>
<tr><td><code>CI_2</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval based on Hoese and Huschens (2011)</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>VaR</code></td>
<td>
<p>Asymptotic Value-at-Risk</p>
</td></tr>
<tr><td><code>VaR_CI</code></td>
<td>
<p>Confidence interval for the asymptotic Value-at-Risk</p>
</td></tr>
<tr><td><code>ES</code></td>
<td>
<p>Asymptotic Expected Shortfall</p>
</td></tr>
<tr><td><code>ES_CI</code></td>
<td>
<p>Confidence interval for the asymptotic Expected Shortfall</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Duellmann K, Gehde-Trapp M (2004).
&ldquo;Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures.&rdquo;
<em>Bundesbank Series 2, Discussion Paper</em>.
Available at SSRN: <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a>. Accessed: 02.11.2017.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Hoese S, Huschens S (2011).
&ldquo;Confidence intervals for asset correlations in the asymptotic single risk factor model.&rdquo;
In <em>Operations Research Proceedings 2010</em>, 111&ndash;116.
Springer.
</p>
<p>Meyer C (2009).
&ldquo;Estimation of intra-sector asset correlations.&rdquo;
<em>The Journal of Risk Model Validation</em>, <b>3</b>(3), 47&ndash;79.
</p>
<p>Pfeuffer M, Nagl M, Fischer M, Roesch D (2020).
&ldquo;Parameter Estimation and Bias Correction in the Vasicek Credit Portfolio Model.&rdquo;
<em>Journal of Risk</em>, <b>22number</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraCMM">intraCMM</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
d=defaultTimeseries(100,0.01,10,0.01)
n=rep(100,10)

#Sensitivity to the adjustment
intraAMLE(d,n,Adjust=0.001)
intraAMLE(d,n,Adjust=0.0001)

#Estimation with confidence intervals- I
IntraCorr=intraAMLE(d,n, Adjust=0.001, CI_1=0.95 )

#Estimation with confidence intervals- II
IntraCorr=intraAMLE(d,n, Adjust=0.001, CI_2=0.95 )

#Jackknife correction
IntraCorr=intraAMLE(d,n,Adjust=0.001, JC=TRUE)


#Bootstrap correction with  bootstrap confidence intervals
IntraCorr=intraAMLE(d,n, Adjust=0.001, B=1000, CI_Boot=0.95 )

#Bootstrap correction with  bootstrap confidence intervals and plot
IntraCorr=intraAMLE(d,n, B=1000, Adjust=0.001, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraAMLE(d,n,Adjust=0.001, DB=c(10,50))




</code></pre>

<hr>
<h2 id='intraAMM'> Asymptotic Method of Moments Estimator
</h2><span id='topic+intraAMM'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting the first two moments of the default rate time series to the theoretical moments of the default rate and backing out the remaining correlation parameter numerically. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraAMM(d, n, B = 0, DB=c(0,0), JC = FALSE,CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraAMM_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraAMM_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraAMM_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraAMM_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraAMM_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraAMM_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraAMM_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraAMM_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>As stated by Vasicek (1991) and Vasicek (2002), the asset variables follow a bivariate normal distribution. Since this distribution can be parametrized by the first two moments, namely the expected value and the variance, the remaining correlation parameter can be backed out numerically. The expected value will be approximated by the mean of the default rate and the variance is defined as the sample variance of the default rate. For theoretical background, see Gordy (2000). If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Vasicek O (1991).
&ldquo;Limiting loan loss probability distribution.&rdquo;
<em>Finance, Economics and Mathematics</em>, 147&ndash;148.
</p>
<p>Vasicek O (2002).
&ldquo;The distribution of loan portfolio value.&rdquo;
<em>Risk</em>, <b>15</b>(12), 160&ndash;162.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraAMM(d,n)

#Jackknife correction
IntraCorr=intraAMM(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraAMM(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraAMM(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraAMM(d,n, DB=c(10,50))


</code></pre>

<hr>
<h2 id='intraBeta'> Parametric Approach of Botha and van Vuuren (2010)- Beta Distribution
</h2><span id='topic+intraBeta'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting a beta distribution onto the default rate time series, then calculating the Value-at-Risk (VaR) of this beta distribution and fit it to the theoretical VaR of the Vasicek distribution. The correlation parameter will be backed out numerically. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraBeta(d, n, Quantile=0.999,B = 0, DB=c(0,0), JC = FALSE,
CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraBeta_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraBeta_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraBeta_+3A_quantile">Quantile</code></td>
<td>
<p>a number, indicating the desired confidence level of the Value-at-Risk.
</p>
</td></tr>
<tr><td><code id="intraBeta_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraBeta_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraBeta_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraBeta_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraBeta_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraBeta_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>As stated by Botha and van Vuuren (2010) one can estimate the intra correlation by matching VaR of a parametrized beta distribution onto the VaR of the Vasicek distribution. To do so, the shape parameters (alpha and beta) of the beta distribution are estimated according to Botha and van Vuuren (2010). Afterwards, the VaR_Beta at the confidence level of <code>Quantile</code> will be estimated. In a third step, this VaR_Beta is matched with the theoretical VaR of the Vasicek distribution, given by Vasicek (1991):
</p>
<p style="text-align: center;"><code class="reqn">VaR_Vasicek= Phi((Phi^-1(PD)+sqrt(rho)*Phi^-1(Quantile))/sqrt(1-rho))</code>
</p>

<p>Since <code>Quantile</code> and the corresponding VaR_Beta is known, the intra correlation parameter can be backed out numerically.
This estimator is sensitive to the chosen <code>Quantile</code>. Botha and van Vuuren (2010) suggested to use <code>Quantile=0.999</code>, but for validation purposes one may choose different values of <code>Quantile</code> to infer information about the robustness of the correlation estimate.
</p>
<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Botha M, van Vuuren G (2010).
&ldquo;Implied asset correlation in retail loan portfolios.&rdquo;
<em>Journal of Risk Management in Financial Institutions</em>, <b>3</b>(2), 156&ndash;173. 
</p>
<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Vasicek O (1991).
&ldquo;Limiting loan loss probability distribution.&rdquo;
<em>Finance, Economics and Mathematics</em>, 147&ndash;148.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>
<code><a href="#topic+intraMode">intraMode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraBeta(d,n)

#Jackknife correction
IntraCorr=intraBeta(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraBeta(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraBeta(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraBeta(D1,N1, DB=c(10,50))


</code></pre>

<hr>
<h2 id='intraCMM'>Corrected Asymptotic Method of Moments Estimator of Frei and Wunsch (2018)
</h2><span id='topic+intraCMM'></span>

<h3>Description</h3>

<p>The estimator is based on Frei and Wunsch (2018), who introduced an analytic bias correction via Taylor series expansion. Additionally, the bias due to autocorrelated default time series can be corrected. Furthermore, additional bootstrap and jackknife bias corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraCMM(d,n,l=0, B=0, DB=c(0,0), JC=FALSE , CI_Boot,type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraCMM_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraCMM_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td></tr>
<tr><td><code id="intraCMM_+3A_l">l</code></td>
<td>
<p>a number, indicating how many lags of autocorrelation should be used for the correction.
</p>
</td></tr>
<tr><td><code id="intraCMM_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraCMM_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraCMM_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraCMM_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence level if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr> 
<tr><td><code id="intraCMM_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr>
<tr><td><code id="intraCMM_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Frei and Wunsch (2018) introduced an estimator which simultaneously corrects the bias of a short default time series and an bias due to autocorrelation. Additionally, further corrections are implemented. If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Frei C, Wunsch M (2018).
&ldquo;Moment Estimators for Autocorrelated Time Series and their Application to Default Correlations.&rdquo;
<em>Journal of Credit Risk</em>, <b>14</b>, 1&ndash;29.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
d=defaultTimeseries(1000,0.1,10,0.01)
n=rep(1000,10)

IntraCorr=intraCMM(d,n,l=0)


#Estimation with  two lags of autocorrelation
IntraCorr=intraCMM(d,n, l=2 )

#Jackknife correction
IntraCorr=intraCMM(d,n, JC=TRUE)




#Bootstrap correction with  bootstrap confidence intervals
IntraCorr=intraCMM(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with  bootstrap confidence intervals and plot
IntraCorr=intraCMM(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraCMM(d,n, DB=c(10,50))


</code></pre>

<hr>
<h2 id='intraFMM'>Finite Sample Method of Moments Estimator
</h2><span id='topic+intraFMM'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting the first two moments of the default rate time series to the theoretical moments of the default rate and backing out the remaining correlation parameter numerically. The sample variance will be adjusted for an insufficiently large portfolio size. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraFMM(d, n, B = 0, DB=c(0,0), JC = FALSE,  CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraFMM_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraFMM_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraFMM_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraFMM_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraFMM_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraFMM_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraFMM_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraFMM_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>As stated by Vasicek (1991) and Vasicek (2002), the asset variables follow a bivariate normal distribution. Since this distribution can be parametrized by the first two moments, namely the expected value and the variance, the remaining correlation parameter can be backed out numerically. The expected value will be approximated by the mean of the default rate and the variance is defined as the (corrected) sample variance of the default rate. For theoretical background, see Gordy (2000). If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Vasicek O (1991).
&ldquo;Limiting loan loss probability distribution.&rdquo;
<em>Finance, Economics and Mathematics</em>, 147&ndash;148.
</p>
<p>Vasicek O (2002).
&ldquo;The distribution of loan portfolio value.&rdquo;
<em>Risk</em>, <b>15</b>(12), 160&ndash;162.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraFMM(d,n)

#Jackknife correction
IntraCorr=intraFMM(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraFMM(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraFMM(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraFMM(D1,N1, DB=c(10,50))



</code></pre>

<hr>
<h2 id='intraJDP1'>Joint Default Probability Matching Estimator, Lucas (1995)
</h2><span id='topic+intraJDP1'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting the empirical joint default probability (JDP) of the default rate time series to the theoretical one and backing out the remaining correlation parameter numerically. The unbiased estimator of Lucas (1995) will be used for the empirical JDP. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraJDP1(d, n, B = 0, DB=c(0,0), JC = FALSE, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraJDP1_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraJDP1_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraJDP1_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraJDP1_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraJDP1_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraJDP1_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraJDP1_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraJDP1_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Kalkbrener and Onwunta (2010) for example showed that the JDP of the default rates follow a bivariate normal distribution. The intra asset correlation will be estimated by fitting the empirical JDP of the default rate time series on the theoretical JDP of the default rate and backing out the remaining correlation parameter numerically. 
The empirical JDP is calculated by the (unbiased) estimator of Lucas (1995). If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>
<p>Lucas DJ (1995).
&ldquo;Default correlation and credit analysis.&rdquo;
<em>The Journal of Fixed Income</em>, <b>4</b>(4), 76&ndash;87.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraJDP1(d,n)
#Jackknife correction
IntraCorr=intraJDP1(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraJDP1(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraJDP1(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraJDP1(D1,N1, DB=c(10,50))



</code></pre>

<hr>
<h2 id='intraJDP2'>Joint Default Probability Matching Estimator,  De Servigny and Renault (2002)
</h2><span id='topic+intraJDP2'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting the empirical joint default probability (JDP) of the default rate time series to the theoretical one and backing out the remaining correlation parameter numerically. The biased estimator of De Servigny and Renault (2002) will be used for the empirical JDP. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraJDP2(d, n, B = 0,DB=c(0,0), JC = FALSE, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraJDP2_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraJDP2_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraJDP2_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraJDP2_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraJDP2_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraJDP2_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraJDP2_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraJDP2_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Kalkbrener and Onwunta (2010) for example showed that the JDP of the default rates follow a bivariate normal distribution. The intra asset correlation will be estimated by fitting the empirical JDP of the default rate time series on the theoretical JDP of the default rate and backing out the remaining correlation parameter numerically. 
The empirical JDP is calculated by the (unbiased) estimator of De Servigny and Renault (2002). If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>De Servigny A, Renault O (2002).
&ldquo;Default correlation: empirical evidence.&rdquo;
<em>Working Paper, Standard and Poors</em>.
Available at: <a href="https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675">https://www.semanticscholar.org/paper/Default-correlation%3A-empirical-evidence-Servigny-Renault/aae251436d0e3b489951c0d38463d71106755675</a>.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Kalkbrener M, Onwunta A (2010).
&ldquo;Validating structural credit portfolio models.&rdquo;
<em>Model risk - identification, measurement and management. Risk Books, London</em>, 233&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>,
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraJDP2(d,n)
#Jackknife correction
IntraCorr=intraJDP2(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraJDP2(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraJDP2(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraJDP2(D1,N1, DB=c(10,50))


</code></pre>

<hr>
<h2 id='intraMLE'>Binomial Maximum Likelihood Estimator
</h2><span id='topic+intraMLE'></span>

<h3>Description</h3>

<p>The default process in the Vasicek model follows a binomial distribution, conditional on the realization of the systematic factor. Hence, the intra asset correlation can be estimated by maximizing the Vasicek-binomial log likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraMLE(d, n, B =0, DB=c(0,0), JC = FALSE, CI, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraMLE_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraMLE_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraMLE_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_ci">CI</code></td>
<td>
<p>a number, indicating the desired asymptotic confidence interval of the estimate. 
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired bootstrap confidence interval of the estimate, if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_type">type</code></td>
<td>
<p>a string, indicating  the type of bootstrap intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>.
</p>
</td></tr>
<tr><td><code id="intraMLE_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>In the Vasicek model the default process can be expressed as independent binomial trials, conditional on the realization of the systematic factor. Therefore Gordy and Heitfield (2010) introduced an estimator of the intra asset correlation based on the log-likelihood maximization. For theoretical background see Gordy and Heitfield (2010). 
</p>
<p>The log-likelihood will be maximized for values between 0 and 1. The asymptotic confidence interval will be estimated using maximum likelihood theory. If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB, Heitfield E (2010).
&ldquo;Small-sample estimation of models of portfolio credit risk.&rdquo;
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43&ndash;63.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraAMM">intraAMM</a></code>, <code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>,
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraMode">intraMode</a></code>,<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(11)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraMLE(d,n)

#Estimation with confidence intervals
IntraCorr=intraMLE(d,n, CI=0.95 )






#Jackknife correction
IntraCorr=intraMLE(d,n, JC=TRUE)

#Bootstrap correction with bootstrap confidence intervals
IntraCorr=intraMLE(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with bootstrap confidence intervals and plot
IntraCorr=intraMLE(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraMLE(D1,N1, DB=c(10,50))



</code></pre>

<hr>
<h2 id='intraMode'> Parametric Approach of Botha and van Vuuren (2010)- Mode
</h2><span id='topic+intraMode'></span>

<h3>Description</h3>

<p>The intra asset correlation will be estimated by fitting the mode of the default rate time series to the theoretical mode of the default rates and backing out the remaining correlation parameter numerically. Additionally, bootstrap and jackknife corrections are implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intraMode(d, n, B = 0, DB=c(0,0), JC = FALSE,CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intraMode_+3A_d">d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td></tr>
<tr><td><code id="intraMode_+3A_n">n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period over time.
</p>
</td></tr>
<tr><td><code id="intraMode_+3A_b">B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td></tr> 
<tr><td><code id="intraMode_+3A_db">DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td></tr> 
<tr><td><code id="intraMode_+3A_jc">JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td></tr>
<tr><td><code id="intraMode_+3A_ci_boot">CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca).
</p>
</td></tr> 
<tr><td><code id="intraMode_+3A_type">type</code></td>
<td>
<p>a string, indicating the desired method to calculate the bootstrap confidence intervals. For more details see <code><a href="boot.html#topic+boot.ci">boot.ci</a></code>. Studendized confidence intervals are not supported.
</p>
</td></tr> 
<tr><td><code id="intraMode_+3A_plot">plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>As stated by Botha and van Vuuren (2010) one can estimate the intra correlation by matching the theoretical and empirical mode. According to Vasicek (1991) the default rates are only unimodal if the intra correlation is smaller than 0.5. Therefore, this estimator cannot be used for higher intra correlations. The theoretical mode is given by Vasicek (1991):
</p>
<p style="text-align: center;"><code class="reqn">Mode_Vasicek=Phi(sqrt(1-rho)/(1-2*rho)*Phi^-1(PD))</code>
</p>

<p>If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr><td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td></tr>
<tr><td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td></tr>
<tr><td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td></tr>
<tr><td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td></tr>
<tr><td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td></tr>
<tr><td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td></tr>
<tr><td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td></tr>
</table>


<h3>References</h3>

<p>Botha M, van Vuuren G (2010).
&ldquo;Implied asset correlation in retail loan portfolios.&rdquo;
<em>Journal of Risk Management in Financial Institutions</em>, <b>3</b>(2), 156&ndash;173. 
</p>
<p>Chang J, Hall P (2015).
&ldquo;Double-bootstrap methods that use a single double-bootstrap simulation.&rdquo;
<em>Biometrika</em>, <b>102</b>(1), 203&ndash;214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB (2000).
&ldquo;A comparative anatomy of credit risk models.&rdquo;
<em>Journal of Banking &amp; Finance</em>, <b>24</b>(1), 119&ndash;149.
</p>
<p>Vasicek O (1991).
&ldquo;Limiting loan loss probability distribution.&rdquo;
<em>Finance, Economics and Mathematics</em>, 147&ndash;148.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intraFMM">intraFMM</a></code>, <code><a href="#topic+intraJDP1">intraJDP1</a></code>, <code><a href="#topic+intraJDP2">intraJDP2</a></code>
<code><a href="#topic+intraCMM">intraCMM</a></code>, <code><a href="#topic+intraMLE">intraMLE</a></code>, <code><a href="#topic+intraAMLE">intraAMLE</a></code>,
<code><a href="#topic+intraBeta">intraBeta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraMode(d,n)

#Jackknife correction
IntraCorr=intraMode(d,n, JC=TRUE)


#Bootstrap correction with confidence intervals
IntraCorr=intraMode(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with confidence intervals and plot
IntraCorr=intraMode(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraMode(D1,N1, DB=c(10,50))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
