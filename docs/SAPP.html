<!DOCTYPE html><html><head><title>Help for package SAPP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SAPP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Brastings'><p>The Occurrence Times Data</p></a></li>
<li><a href='#eptren'><p>Maximum Likelihood Estimates of Intensity Rates</p></a></li>
<li><a href='#etarpp'><p>Residual Point Process of the ETAS Model</p></a></li>
<li><a href='#etasap'><p>Maximum Likelihood Estimates of the ETAS Model</p></a></li>
<li><a href='#etasim'><p>Simulation of Earthquake Dataset Based on the ETAS Model</p></a></li>
<li><a href='#linlin'><p>Maximum Likelihood Estimates of Linear Intensity Models</p></a></li>
<li><a href='#linsim'><p>Simulation of a Self-Exciting Point Process</p></a></li>
<li><a href='#main2003JUL26'><p>The Aftershock Data</p></a></li>
<li><a href='#momori'><p>Maximum Likelihood Estimates of Parameters in the Omori-Utsu (Modified Omori) Formula</p></a></li>
<li><a href='#pgraph'><p>Graphical Outputs for the Point Process Data Set</p></a></li>
<li><a href='#PoissonData'><p>Poisson Data</p></a></li>
<li><a href='#PProcess'><p>The Point Process Data</p></a></li>
<li><a href='#ptspec'><p>The Periodogram of Point Process Data</p></a></li>
<li><a href='#res2003JUL26'><p>The Residual Point Process Data</p></a></li>
<li><a href='#respoi'><p>The Residual Point Process of the ETAS Model</p></a></li>
<li><a href='#SAPP-package'>
<p>Statistical Analysis of Point Processes</p></a></li>
<li><a href='#SelfExcit'><p>Self-Exciting Point Process Data</p></a></li>
<li><a href='#simbvh'><p>Simulation of Bi-Variate Hawkes' Mutually Exciting Point Processes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.9-1</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Analysis of Point Processes</td>
</tr>
<tr>
<td>Author:</td>
<td>The Institute of Statistical Mathematics</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Masami Saga &lt;msaga@mtb.biglobe.ne.jp&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for statistical analysis of point processes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>MailingList:</td>
<td>Please send bug reports to ismrp@grp.ism.ac.jp.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-02 02:09:07 UTC; msaga</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-02 03:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Brastings'>The Occurrence Times Data</h2><span id='topic+Brastings'></span>

<h3>Description</h3>

<p>This data consists of the occurrence times of 627 blastings at a certain 
stoneyard with a very small portion of microearthquakes during a past 4600 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brastings)
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 627.
</p>


<h3>Source</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006)
<em>Computer Science Monographs, No.32, TIMSAC84: Statistical Analysis of
Series of events (TIMSAC84-SASE) Version 2.</em> The Institute of Statistical
Mathematics.
</p>

<hr>
<h2 id='eptren'>Maximum Likelihood Estimates of Intensity Rates</h2><span id='topic+eptren'></span>

<h3>Description</h3>

<p>Compute the maximum likelihood estimates of intensity rates of either
exponential polynomial or exponential Fourier series of non-stationary Poisson
process models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eptren(data, mag = NULL, threshold = 0.0, nparam, nsub, cycle = 0,
       tmpfile = NULL, nlmax = 1000, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eptren_+3A_data">data</code></td>
<td>
<p>point process data.</p>
</td></tr>
<tr><td><code id="eptren_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="eptren_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="eptren_+3A_nparam">nparam</code></td>
<td>
<p>maximum number of parameters.</p>
</td></tr>
<tr><td><code id="eptren_+3A_nsub">nsub</code></td>
<td>
<p>number of subdivisions in either (<code class="reqn">0</code>,<code class="reqn">t</code>) or (<code class="reqn">0</code>,
<code>cycle</code>), where <code class="reqn">t</code> is the length of observed time interval of
points.</p>
</td></tr>
<tr><td><code id="eptren_+3A_cycle">cycle</code></td>
<td>
<p>periodicity to be investigated days in a Poisson process model.
If zero (default) fit an exponential polynomial model.</p>
</td></tr>
<tr><td><code id="eptren_+3A_tmpfile">tmpfile</code></td>
<td>
<p>a character string naming the file to write the process of minimizing by
Davidon-Fletcher-Powell procedure. If &quot;&quot; print the process to the standard
output and if <code>NULL</code> (default) no report.</p>
</td></tr>
<tr><td><code id="eptren_+3A_nlmax">nlmax</code></td>
<td>
<p>the maximum number of steps in the process of minimizing.</p>
</td></tr> 
<tr><td><code id="eptren_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) intensity rates are plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the maximum likelihood estimates (MLEs) of the
coefficients <code class="reqn">A_1, A_2,\ldots A_n</code> is an exponential
polynomial
</p>
<p style="text-align: center;"><code class="reqn"> f(t) = exp(A_1 + A_2t + A_3t^2 + ... ) </code>
</p>

<p>or <code class="reqn">A_1, A_2, B_2, ..., A_n, B_n</code> in a Poisson process model with an
intensity taking the form of an exponential Fourier series
</p>
<p style="text-align: center;"><code class="reqn">f(t) = exp\{ A_1 + A_2cos(2\pi t/p) + B_2sin(2\pi t/p) + A_3cos(4\pi t/p) + B_3sin(4\pi t/p) +... \}</code>
</p>

<p>which represents the time varying rate of occurrence (intensity function) of
earthquakes in a region.
</p>
<p>These two models belong to the family of non-stationary Poisson process. The
optimal order <code class="reqn">n</code> can be determined by minimize the value of the Akaike
Information Criterion (AIC).
</p>


<h3>Value</h3>

<table>
<tr><td><code>aic</code></td>
<td>
<p>AIC.</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>parameters.</p>
</td></tr>
<tr><td><code>aicmin</code></td>
<td>
<p>minimum AIC.</p>
</td></tr>
<tr><td><code>maice.order</code></td>
<td>
<p>number of parameters of minimum AIC.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>time ( <code>cycle</code> = 0 ) or superposed occurrence time
( <code>cycle</code> &gt; 0 ).</p>
</td></tr>
<tr><td><code>intensity</code></td>
<td>
<p>intensity rates.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006)
<em>Computer Science Monographs, No.32, TIMSAC84: STATISTICAL ANALYSIS OF
SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity -
updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The Occurrence Times Data of 627 Blastings
data(Brastings)

# exponential polynomial trend fitting
eptren(Brastings, nparam = 10, nsub = 1000)

# exponential Fourier series fitting
eptren(Brastings, nparam = 10, nsub = 1000, cycle = 1)

## Poisson Process data
data(PoissonData)

# exponential polynomial trend fitting
eptren(PoissonData, nparam = 10, nsub = 1000)

# exponential Fourier series fitting
eptren(PoissonData, nparam = 10, nsub = 1000, cycle = 1)

## The aftershock data of 26th July 2003 earthquake of M6.2
data(main2003JUL26)
x &lt;- main2003JUL26

# exponential polynomial trend fitting
eptren(x$time, mag = x$magnitude, nparam = 10, nsub = 1000)

# exponential Fourier series fitting
eptren(x$time, mag = x$magnitude, nparam = 10, nsub = 1000, cycle = 1)   
</code></pre>

<hr>
<h2 id='etarpp'>Residual Point Process of the ETAS Model</h2><span id='topic+etarpp'></span><span id='topic+etarpp2'></span>

<h3>Description</h3>

<p>Compute the residual data using the ETAS model with MLEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etarpp(time, mag, threshold = 0.0, reference = 0.0, parami, zts = 0.0, tstart,
       zte, ztend = NULL, plot = TRUE)

etarpp2(etas, threshold = 0.0, reference = 0.0, parami, zts = 0.0, tstart, zte,
        ztend = NULL, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etarpp_+3A_time">time</code></td>
<td>
<p>the time measured from the main shock(t = 0).</p>
</td></tr>
<tr><td><code id="etarpp_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_etas">etas</code></td>
<td>
<p>a etas-format dataset on 9 variables
</p>
<p>(no., longitude, latitude, magnitude, time, depth, year, month and days).</p>
</td></tr>
<tr><td><code id="etarpp_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_reference">reference</code></td>
<td>
<p>reference magnitude.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_parami">parami</code></td>
<td>
<p>initial estimates of five parameters <code class="reqn">\mu</code>, <code class="reqn">K</code>,
<code class="reqn">c</code>, <code class="reqn">\alpha</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_zts">zts</code></td>
<td>
<p>the start of the precursory period.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_tstart">tstart</code></td>
<td>
<p>the start of the target period.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_zte">zte</code></td>
<td>
<p>the end of the target period.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_ztend">ztend</code></td>
<td>
<p>the end of the prediction period. If <code>NULL</code> (default)
the last time of available data is set.</p>
</td></tr>
<tr><td><code id="etarpp_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) the graphs of cumulative number
and magnitude against the ordinary time and transformed time are plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cumulative number of earthquakes at time <code class="reqn">t</code> since <code class="reqn">t_0</code> is given
by the integration of <code class="reqn">\lambda(t)</code> ( see <code><a href="#topic+etasap">etasap</a></code> )
with respect to the time <code class="reqn">t</code>,
</p>
<p style="text-align: center;"><code class="reqn">\Lambda(t) = \mu(t-t_0) + K \Sigma_i \exp[\alpha(M_i-M_z)]\{c^{(1-p)}-(t-t_i+c)^{(1-p)}\}/(p-1),</code>
</p>

<p>where the summation of <code class="reqn">i</code> is taken for all data event. The output of
<code>etarpp2</code> is given in a res-format dataset which includes the column of
<code class="reqn">\{\Lambda(t_i), i = 1, 2, ..., N\}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>trans.time</code></td>
<td>
<p>transformed time <code class="reqn">\Lambda(t_i), i = 1, 2, ..., N</code>.</p>
</td></tr>
<tr><td><code>no.tstart</code></td>
<td>
<p>data number of the start of the target period.</p>
</td></tr>
<tr><td><code>resData</code></td>
<td>
<p>a res-format dataset on 7 variables
</p>
<p>(no., longitude, latitude, magnitude, time, depth and transformed time).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity -
updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(main2003JUL26)  # The aftershock data of 26th July 2003 earthquake of M6.2

## output transformed times and cumulative numbers
x &lt;- main2003JUL26
etarpp(time = x$time, mag = x$magnitude, threshold = 2.5, reference = 6.2,
       parami = c(0, 0.63348e+02, 0.38209e-01, 0.26423e+01, 0.10169e+01),
       tstart = 0.01, zte = 7, ztend = 18.68)

## output a res-format dataset
etarpp2(main2003JUL26, threshold = 2.5,  reference = 6.2,
        parami = c(0, 0.63348e+02, 0.38209e-01, 0.26423e+01, 0.10169e+01),
        tstart = 0.01, zte = 7, ztend = 18.68)
</code></pre>

<hr>
<h2 id='etasap'>Maximum Likelihood Estimates of the ETAS Model</h2><span id='topic+etasap'></span>

<h3>Description</h3>

<p>Compute the maximum likelihood estimates of five parameters of ETAS model. This function consists of two (exact and approximated) versions of the calculation algorithm for the maximization of likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etasap(time, mag, threshold = 0.0, reference = 0.0, parami, zts = 0.0, 
       tstart, zte, approx = 2, tmpfile = NULL, nlmax = 1000, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etasap_+3A_time">time</code></td>
<td>
<p>the time measured from the main shock(t=0).</p>
</td></tr>
<tr><td><code id="etasap_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="etasap_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="etasap_+3A_reference">reference</code></td>
<td>
<p>reference magnitude.</p>
</td></tr>
<tr><td><code id="etasap_+3A_parami">parami</code></td>
<td>
<p>initial estimates of five parameters <code class="reqn">\mu</code>, <code class="reqn">K</code>, <code class="reqn">c</code>, <code class="reqn">\alpha</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="etasap_+3A_zts">zts</code></td>
<td>
<p>the start of the precursory period.</p>
</td></tr>
<tr><td><code id="etasap_+3A_tstart">tstart</code></td>
<td>
<p>the start of the target period.</p>
</td></tr>
<tr><td><code id="etasap_+3A_zte">zte</code></td>
<td>
<p>the end of the target period.</p>
</td></tr>
<tr><td><code id="etasap_+3A_approx">approx</code></td>
<td>
<p>&gt; 0 : the level for approximation version, which is one of the five levels 1, 2, 4, 8 and 16.
The higher level means faster processing but lower accuracy. <br />
= 0 : the exact version.</p>
</td></tr>
<tr><td><code id="etasap_+3A_tmpfile">tmpfile</code></td>
<td>
<p>a character string naming the file to write the process of maximum likelihood procedure.
If &quot;&quot; print the process to the standard output and if <code>NULL</code> (default) no report.</p>
</td></tr>
<tr><td><code id="etasap_+3A_nlmax">nlmax</code></td>
<td>
<p>the maximum number of steps in the process of minimizing.</p>
</td></tr> 
<tr><td><code id="etasap_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) the graph of cumulative number and magnitude of earthquakes
against the ordinary time is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ETAS model is a point-process model representing the activity of earthquakes of magnitude <code class="reqn">M_z</code> and larger occurring in a certain region during a certain interval of time.
The total number of such earthquakes is denoted by <code class="reqn">N</code>. The seismic activity includes primary activity of constant
occurrence rate <code class="reqn">\mu</code> in time (Poisson process). Each earthquake ( including aftershock of another earthquake)
is followed by its aftershock activity, though only aftershocks of magnitude <code class="reqn">M_z</code> and larger are included in the data.
The aftershock activity is represented by the Omori-Utsu formula in the time domain. The rate of aftershock occurrence
at time <code class="reqn">t</code> following the <code class="reqn">i</code>th earthquake (time: <code class="reqn">t_i</code>, magnitude: <code class="reqn">M_i</code>) is given by 
</p>
<p style="text-align: center;"><code class="reqn">n_i(t) = K exp[\alpha(M_i-M_z)]/(t-t_i+c)^p,</code>
</p>

<p>for <code class="reqn"> t&gt;t_i </code> where <code class="reqn">K</code>, <code class="reqn">\alpha</code>, <code class="reqn">c</code>, and <code class="reqn">p</code> are constants, which are common to all aftershock sequences
in the region. The rate of occurrence of the whole earthquake series at time <code class="reqn">t</code> becomes
</p>
<p style="text-align: center;"><code class="reqn">\lambda(t) = \mu + \Sigma_i  n_i(t).</code>
</p>

<p>The summation is done for all <code class="reqn">i</code> satisfying <code class="reqn">t_i &lt; t</code>. Five parameters <code class="reqn">\mu</code>, <code class="reqn">K</code>, <code class="reqn">c</code>, <code class="reqn">\alpha</code> and <code class="reqn">p</code>
represent characteristics of seismic activity of the region.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ngmle</code></td>
<td>
<p>negative max log-likelihood.</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>list of maximum likelihood estimates of five parameters <code class="reqn">\mu</code>, <code class="reqn">K</code>, <code class="reqn">c</code>, <code class="reqn">\alpha</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>aic2</code></td>
<td>
<p>AIC/2.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(main2003JUL26)  # The aftershock data of 26th July 2003 earthquake of M6.2 
x &lt;- main2003JUL26
etasap(x$time, x$magnitude, threshold = 2.5, reference = 6.2, 
       parami = c(0, 0.63348e+02, 0.38209e-01, 0.26423e+01, 0.10169e+01),
       tstart = 0.01, zte = 18.68)
</code></pre>

<hr>
<h2 id='etasim'>Simulation of Earthquake Dataset Based on the ETAS Model</h2><span id='topic+etasim1'></span><span id='topic+etasim2'></span>

<h3>Description</h3>

<p>Produce simulated dataset for given sets of parameters in the point process model used in ETAS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etasim1(bvalue, nd, threshold = 0.0, reference = 0.0, param)

etasim2(etas, tstart, threshold = 0.0, reference = 0.0, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etasim_+3A_bvalue">bvalue</code></td>
<td>
<p><code class="reqn">b</code>-value of G-R law if <code>etasim1</code>.</p>
</td></tr>
<tr><td><code id="etasim_+3A_nd">nd</code></td>
<td>
<p>the number of the simulated events if <code>etasim1</code>.</p>
</td></tr>
<tr><td><code id="etasim_+3A_etas">etas</code></td>
<td>
<p>a etas-format dataset on 9 variables
(no., longitude, latitude, magnitude, time, depth, year, month and days).</p>
</td></tr>
<tr><td><code id="etasim_+3A_tstart">tstart</code></td>
<td>
<p>the end of precursory period if <code>etasim2</code>.</p>
</td></tr>
<tr><td><code id="etasim_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="etasim_+3A_reference">reference</code></td>
<td>
<p>reference magnitude.</p>
</td></tr>
<tr><td><code id="etasim_+3A_param">param</code></td>
<td>
<p>five parameters <code class="reqn">\mu</code>, <code class="reqn">K</code>, <code class="reqn">c</code>, <code class="reqn">\alpha</code> and <code class="reqn">p</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two versions; either simulating magnitude by Gutenberg-Richter's Law <code>etasim1</code>
or using magnitudes from <code class="reqn">etas</code> dataset <code>etasim2</code>.
For <code>etasim1</code>, <code class="reqn">b</code>-value of G-R law and number of events to be simulated are provided.
<code>stasim2</code> simulates the same number of events that are not less than threshold magnitude in the dataset <code class="reqn">etas</code>,
and simulation starts after a precursory period depending on the same history of events in <code class="reqn">etas</code> in the period.
</p>


<h3>Value</h3>

<p><code>etasim1</code> and <code>etasim2</code> generate a etas-format dataset given values of 'no.', 'magnitude' and 'time'.
</p>


<h3>References</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## by Gutenberg-Richter's Law 
etasim1(bvalue = 1.0, nd = 999, threshold = 3.5, reference = 3.5,
        param = c(0.2e-02, 0.4e-02, 0.3e-02, 0.24e+01, 0.13e+01))

## from a etas-format dataset
data(main2003JUL26)  # The aftershock data of 26th July 2003 earthquake of M6.2
etasim2(main2003JUL26, tstart = 0.01, threshold = 2.5, reference = 6.2,
        param = c(0, 0.63348e+02, 0.38209e-01, 0.26423e+01, 0.10169e+01))
</code></pre>

<hr>
<h2 id='linlin'>Maximum Likelihood Estimates of Linear Intensity Models</h2><span id='topic+linlin'></span>

<h3>Description</h3>

<p>Perform the maximum likelihood estimates of linear intensity models of self-exciting point process with another point
process input, cyclic and trend components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linlin(external, self.excit, interval, c, d, ax = NULL, ay = NULL, ac = NULL,
       at = NULL, opt = 0, tmpfile = NULL, nlmax = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linlin_+3A_external">external</code></td>
<td>
<p>another point process data.</p>
</td></tr>
<tr><td><code id="linlin_+3A_self.excit">self.excit</code></td>
<td>
<p>self-exciting data.</p>
</td></tr>
<tr><td><code id="linlin_+3A_interval">interval</code></td>
<td>
<p>length of observed time interval of event.</p>
</td></tr>
<tr><td><code id="linlin_+3A_c">c</code></td>
<td>
<p>exponential coefficient of lgp in self-exciting part.</p>
</td></tr>
<tr><td><code id="linlin_+3A_d">d</code></td>
<td>
<p>exponential coefficient of lgp in input part.</p>
</td></tr>
<tr><td><code id="linlin_+3A_ax">ax</code></td>
<td>
<p>coefficients of self-exciting response function.</p>
</td></tr>
<tr><td><code id="linlin_+3A_ay">ay</code></td>
<td>
<p>coefficients of input response function.</p>
</td></tr>
<tr><td><code id="linlin_+3A_ac">ac</code></td>
<td>
<p>coefficients of cycle.</p>
</td></tr>
<tr><td><code id="linlin_+3A_at">at</code></td>
<td>
<p>coefficients of trend.</p>
</td></tr>
<tr><td><code id="linlin_+3A_opt">opt</code></td>
<td>
<p>0 : minimize the likelihood with fixed exponential coefficient <code class="reqn">c</code><br />
1 : not fixed <code class="reqn">d</code>.</p>
</td></tr>
<tr><td><code id="linlin_+3A_tmpfile">tmpfile</code></td>
<td>
<p>a character string naming the file to write the process of minimizing.
If &quot;&quot; print the process to the standard output and if <code>NULL</code> (default) no report.</p>
</td></tr>
<tr><td><code id="linlin_+3A_nlmax">nlmax</code></td>
<td>
<p>the maximum number of steps in the process of minimizing.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The cyclic part is given by the Fourier series, the trend is given by usual polynomial.
The response functions of the self-exciting and the input are given by the Laguerre type polynomials (lgp), 
where the scaling parameters in the exponential function, say <code class="reqn">c</code> and <code class="reqn">d</code>, can be different. 
However, it is advised to estimate <code class="reqn">c</code> first without the input component, and then to estimate <code class="reqn">d</code> with the fixed <code class="reqn">c</code> 
(this means that the gradient corresponding to the <code class="reqn">c</code> is set to keep <code class="reqn">0</code>), which are good initial estimates for 
the <code class="reqn">c</code> and <code class="reqn">d</code> of the mixed self-exciting and input model.
</p>
<p>Note that estimated intensity sometimes happen to be negative on some part of time interval 
outside the neighborhood of events.  this take place more easily the larger the number of parameters. 
This causes some difficulty in getting the m.l.e., because the negativity of the intensity contributes to 
the seeming increase of the likelihood.
</p>
<p>Note that for the initial estimates of <code class="reqn">ax(1)</code>, <code class="reqn">ay(1)</code> and <code class="reqn">at(1)</code>, some positive value are necessary. 
Especially 0.0 is not suitable.
</p>


<h3>Value</h3>

<table>
<tr><td><code>c1</code></td>
<td>
<p>initial estimate of exponential coefficient of lgp in self-exciting part.</p>
</td></tr>
<tr><td><code>d1</code></td>
<td>
<p>initial estimate of exponential coefficient of lgp in input part.</p>
</td></tr>
<tr><td><code>ax1</code></td>
<td>
<p>initial estimates of lgp coefficients in self-exciting part.</p>
</td></tr>
<tr><td><code>ay1</code></td>
<td>
<p>initial estimates of lgp coefficients in the input part.</p>
</td></tr>
<tr><td><code>ac1</code></td>
<td>
<p>initial estimates of coefficients of Fourier series.</p>
</td></tr>
<tr><td><code>at1</code></td>
<td>
<p>initial estimates of coefficients of the polynomial trend.</p>
</td></tr>
<tr><td><code>c2</code></td>
<td>
<p>final estimate of exponential coefficient of lgp in self-exciting part.</p>
</td></tr>
<tr><td><code>d2</code></td>
<td>
<p>final estimate of exponential coefficient of lgp in input part.</p>
</td></tr>
<tr><td><code>ax2</code></td>
<td>
<p>final estimates of lgp coefficients in self-exciting part.</p>
</td></tr>
<tr><td><code>ay2</code></td>
<td>
<p>final estimates of lgp coefficients in the input part.</p>
</td></tr>
<tr><td><code>ac2</code></td>
<td>
<p>final estimates of coefficients of Fourier series.</p>
</td></tr>
<tr><td><code>at2</code></td>
<td>
<p>final estimates of coefficients of the polynomial trend.</p>
</td></tr>
<tr><td><code>aic2</code></td>
<td>
<p>AIC/2.</p>
</td></tr>
<tr><td><code>ngmle</code></td>
<td>
<p>negative max likelihood.</p>
</td></tr>
<tr><td><code>rayleigh.prob</code></td>
<td>
<p>Rayleigh probability.</p>
</td></tr>
<tr><td><code>distance</code></td>
<td>
<p>= <code class="reqn">\sqrt(rwx^2+rwy^2)</code>.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>phase.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. and Akaike, H. (1982) <em>On linear intensity models for mixed doubly stochastic Poisson and self-exciting point processes</em>.
J. royal statist. soc. b, vol. 44, pp. 102-107.
</p>
<p>Ogata, Y., Akaike, H. and Katsura, K. (1982) <em>The application of linear intensity models to the investigation of causal relations between a point process and another stochastic process</em>.
Ann. inst. statist. math., vol. 34. pp. 373-387.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PProcess)  # point process data 
data(SelfExcit) # self-exciting point process data
linlin(PProcess[1:69], SelfExcit, interval = 20000, c = 0.13, d = 0.026,
       ax = c(0.035, -0.0048), ay = c(0.0, 0.00017), at = c(0.007, -.00000029))
</code></pre>

<hr>
<h2 id='linsim'>Simulation of a Self-Exciting Point Process</h2><span id='topic+linsim'></span>

<h3>Description</h3>

<p>Perform simulation of a self-exciting point process whose intensity also includes a component triggered by another given point process data
and a non-stationary Poisson trend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linsim(data, interval, c, d, ax, ay, at, ptmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linsim_+3A_data">data</code></td>
<td>
<p>point process data.</p>
</td></tr>
<tr><td><code id="linsim_+3A_interval">interval</code></td>
<td>
<p>length of time interval in which events take place.</p>
</td></tr>
<tr><td><code id="linsim_+3A_c">c</code></td>
<td>
<p>exponential coefficient of lgp corresponding to simulated data.</p>
</td></tr>
<tr><td><code id="linsim_+3A_d">d</code></td>
<td>
<p>exponential coefficient of lgp corresponding to input data.</p>
</td></tr>
<tr><td><code id="linsim_+3A_ax">ax</code></td>
<td>
<p>lgp coefficients in self-exciting part.</p>
</td></tr>
<tr><td><code id="linsim_+3A_ay">ay</code></td>
<td>
<p>lgp coefficients in the input part.</p>
</td></tr>
<tr><td><code id="linsim_+3A_at">at</code></td>
<td>
<p>coefficients of the polynomial trend.</p>
</td></tr>
<tr><td><code id="linsim_+3A_ptmax">ptmax</code></td>
<td>
<p>an upper bound of trend polynomial.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs simulation of a self-exciting point process whose intensity also includes 
a component triggered by another given point process data and non-stationary Poisson trend. 
The trend is given by usual polynomial, and the response functions to the self-exciting and 
the external inputs are given the Laguerre-type polynomials (lgp), where the scaling parameters 
in the exponential functions, say <code class="reqn">c</code> and <code class="reqn">d</code>, can be different.
</p>


<h3>Value</h3>

<table>
<tr><td><code>in.data</code></td>
<td>
<p>input data for <code>sim.data</code>.</p>
</td></tr>
<tr><td><code>sim.data</code></td>
<td>
<p>self-exciting simulated data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. (1981) <em>On Lewis' simulation method for point processes</em>.
IEEE information theory, vol. it-27, pp. 23-31.
</p>
<p>Ogata, Y. and Akaike, H. (1982) <em>On linear intensity models for mixed doubly stochastic Poisson and self-exciting point processes</em>.
J. royal statist. soc. b, vol. 44, pp. 102-107.
</p>
<p>Ogata, Y., Akaike, H. and Katsura, K. (1982) <em>The application of linear intensity models to the investigation of causal relations between a point process and another stochastic process</em>.
Ann. inst. statist math., vol. 34. pp. 373-387.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PProcess)   ## The point process data
linsim(PProcess, interval = 20000, c = 0.13, d = 0.026, ax = c(0.035, -0.0048), 
       ay = c(0.0, 0.00017), at = c(0.007, -0.00000029), ptmax = 0.007)
</code></pre>

<hr>
<h2 id='main2003JUL26'>The Aftershock Data</h2><span id='topic+main2003JUL26'></span>

<h3>Description</h3>

<p>The aftershock data of 26th July 2003 earthquake of M6.2 at the northern Miyagi-Ken Japan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(main2003JUL26)
</code></pre>


<h3>Format</h3>

<p><code>main2003JUL26</code> is a data frame with 2305 observations and 9 variables
named no., longitude, latitude, magnitude, time (from the main shock in days), depth, year, month, and day.
</p>


<h3>Source</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>

<hr>
<h2 id='momori'>Maximum Likelihood Estimates of Parameters in the Omori-Utsu (Modified Omori) Formula</h2><span id='topic+momori'></span>

<h3>Description</h3>

<p>Compute the maximum likelihood estimates (MLEs) of parameters in the Omori-Utsu (modified Omori) formula representing for the decay of occurrence rate of aftershocks with time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>momori(data, mag = NULL, threshold = 0.0, tstart, tend, parami,
       tmpfile = NULL, nlmax = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="momori_+3A_data">data</code></td>
<td>
<p>point process data.</p>
</td></tr>
<tr><td><code id="momori_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="momori_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="momori_+3A_tstart">tstart</code></td>
<td>
<p>the start of the target period.</p>
</td></tr>
<tr><td><code id="momori_+3A_tend">tend</code></td>
<td>
<p>the end of the target period.</p>
</td></tr>
<tr><td><code id="momori_+3A_parami">parami</code></td>
<td>
<p>the initial estimates of the four parameters <code class="reqn">B</code>, <code class="reqn">K</code>, <code class="reqn">c</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="momori_+3A_tmpfile">tmpfile</code></td>
<td>
<p>a character string naming the file to write the process of minimizing.
If &quot;&quot; print the process to the standard output and if <code>NULL</code> (default) no report.</p>
</td></tr>
<tr><td><code id="momori_+3A_nlmax">nlmax</code></td>
<td>
<p>the maximum number of steps in the process of minimizing.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The modified Omori formula represent the delay law of aftershock activity in time.
In this equation, <code class="reqn">f(t)</code> represents the rate of aftershock occurrence at time <code class="reqn">t</code>, where <code class="reqn">t</code> is the time measured from the origin time of the main shock.
<code class="reqn">B</code>, <code class="reqn">K</code>, <code class="reqn">c</code> and <code class="reqn">p</code> are non-negative constants.
<code class="reqn">B</code> represents constant-rate background seismicity which may be included in the aftershock data.
</p>
<p style="text-align: center;"><code class="reqn">f(t) = B + K/(t+c)^p</code>
</p>

<p>In this function the negative log-likelihood function is minimized by the Davidon-Fletcher-Powell algorithm.
Starting from a given set of initial guess of the parameters <code>parai</code>, <code>momori()</code> repeats calculations of function values and its gradients at each step of parameter vector.
At each cycle of iteration, the linearly searched step (<code class="reqn">lambda</code>), negative log-likelihood value (<code class="reqn">-LL</code>),
and two estimates of square sum of gradients are shown (<code class="reqn">process=1</code>).
</p>
<p>The cumulative number of earthquakes at time <code class="reqn">t</code> since <code class="reqn">t_0</code> is given by the integration of <code class="reqn">f(t)</code> with respect to the time <code class="reqn">t</code>,
</p>
<p style="text-align: center;"><code class="reqn">F(t) = B(t-t_0) + K\{c^{1-p}-(t-t_i+c)^{1-p}\} / (p-1)</code>
</p>

<p>where the summation of <code class="reqn">i</code> is taken for all data event.
</p>


<h3>Value</h3>

<table>
<tr><td><code>param</code></td>
<td>
<p>the final estimates of the four parameters <code class="reqn">B</code>, <code class="reqn">K</code>, <code class="reqn">c</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>ngmle</code></td>
<td>
<p>negative max likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC = -2<code class="reqn">LL</code> + 2*(number of variables), and the number = 4 in this case.</p>
</td></tr>
<tr><td><code>plist</code></td>
<td>
<p>list of parameters <code class="reqn">t_i</code>, <code class="reqn">K</code>, <code class="reqn">c</code>, <code class="reqn">p</code> and <code class="reqn">cls</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(main2003JUL26)  # The aftershock data of 26th July 2003 earthquake of M6.2 
x &lt;- main2003JUL26
momori(x$time, x$magnitude, threshold = 2.5, tstart = 0.01, tend = 18.68,
       parami = c(0,0.96021e+02, 0.58563e-01, 0.96611e+00))
</code></pre>

<hr>
<h2 id='pgraph'>Graphical Outputs for the Point Process Data Set</h2><span id='topic+pgraph'></span>

<h3>Description</h3>

<p>Provide the several graphical outputs for the point process data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgraph(data, mag, threshold = 0.0, h, npoint, days, delta = 0.0, dmax = 0.0,
       separate.graphics = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgraph_+3A_data">data</code></td>
<td>
<p>point process data.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_h">h</code></td>
<td>
<p>time length of the moving interval in which points are counted to show the graph.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_npoint">npoint</code></td>
<td>
<p>number of subintervals in (0, days) to estimate a nonparametric intensity under the palm probability measure.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_days">days</code></td>
<td>
<p>length of interval to display the intensity estimate under the palm probability.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_delta">delta</code></td>
<td>
<p>length of a subinterval unit in (0, dmax) to compute the variance time curve.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_dmax">dmax</code></td>
<td>
<p>time length of an interval to display the variance time curve; <br />
this is less than (length of whole interval)/4.
As the default setting of either delta = 0.0 or dmax = 0.0, set dmax = (length of whole interval)/4 and delta = dmax/100.</p>
</td></tr>
<tr><td><code id="pgraph_+3A_separate.graphics">separate.graphics</code></td>
<td>
<p>logical. If <code>TRUE</code> a graphic device is opened for each graphics display.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>cnum</code></td>
<td>
<p>cumulative numbers of events time.</p>
</td></tr>
<tr><td><code>lintv</code></td>
<td>
<p>interval length.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>= time * (total number of events)/(time end).</p>
</td></tr>
<tr><td><code>nevent</code></td>
<td>
<p>number of events in [tau, tau+h].</p>
</td></tr>
<tr><td><code>survivor</code></td>
<td>
<p>log survivor curve with i*(standard error), i = 1,2,3.</p>
</td></tr>
<tr><td><code>deviation</code></td>
<td>
<p>deviation of survivor function from the Poisson.</p>
</td></tr>
<tr><td><code>nomal.cnum</code></td>
<td>
<p>normalized cumulative number.</p>
</td></tr>
<tr><td><code>nomal.lintv</code></td>
<td>
<p>U(i) = -exp(-(normalized interval length)).</p>
</td></tr>
<tr><td><code>success.intv</code></td>
<td>
<p>successive pair of intervals.</p>
</td></tr>
<tr><td><code>occur</code></td>
<td>
<p>occurrence rate.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>time assuming the stationary Poisson process.</p>
</td></tr>
<tr><td><code>variance</code></td>
<td>
<p>Var(N(0,time)).</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>the 0.95 and 0.99 error lines assuming the stationary Poisson process.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. and Shimazaki, K. (1984) <em>Transition from aftershock to normal activity: The 1965 Rat islands earthquake aftershock sequence</em>.
Bulletin of the seismological society of America, vol. 74, no. 5, pp. 1757-1765.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The aftershock data of 26th July 2003 earthquake of M6.2
data(main2003JUL26)
x &lt;- main2003JUL26
pgraph(x$time, x$magnitude, h = 6, npoint = 100, days = 10)

## The residual point process data of 26th July 2003 earthquake of M6.2
data(res2003JUL26)
y &lt;- res2003JUL26
pgraph(y$trans.time, y$magnitude, h = 6, npoint = 100, days = 10)
</code></pre>

<hr>
<h2 id='PoissonData'>Poisson Data</h2><span id='topic+PoissonData'></span>

<h3>Description</h3>

<p>Poisson test data for <code>ptspec</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PoissonData)
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 2553.
</p>


<h3>Source</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>

<hr>
<h2 id='PProcess'>The Point Process Data</h2><span id='topic+PProcess'></span>

<h3>Description</h3>

<p>The point process test data for <code>linsim</code> and <code>linlin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PProcess)
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 72.
</p>


<h3>Source</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>

<hr>
<h2 id='ptspec'>The Periodogram of Point Process Data</h2><span id='topic+ptspec'></span>

<h3>Description</h3>

<p>Provide the periodogram of point process data with the significant band (0.90, 0.95 and 0.99) of the maximum power
in searching a cyclic component, for stationary Poisson Process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptspec(data, nfre, prdmin, prd, nsmooth = 1, pprd, interval, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptspec_+3A_data">data</code></td>
<td>
<p>data of events.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_nfre">nfre</code></td>
<td>
<p>number of sampling frequencies of spectra.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_prdmin">prdmin</code></td>
<td>
<p>the minimum periodicity of the sampling.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_prd">prd</code></td>
<td>
<p>a periodicity for calculating the Rayleigh probability.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_nsmooth">nsmooth</code></td>
<td>
<p>number for smoothing of periodogram.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_pprd">pprd</code></td>
<td>
<p>particular periodicities to be investigated among others.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_interval">interval</code></td>
<td>
<p>length of observed time interval of events.</p>
</td></tr>
<tr><td><code id="ptspec_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) the periodogram is plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>f</code></td>
<td>
<p>frequency.</p>
</td></tr>
<tr><td><code>db</code></td>
<td>
<p>D.B.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>power.</p>
</td></tr>
<tr><td><code>rayleigh.prob</code></td>
<td>
<p>the probability of Rayleigh.</p>
</td></tr>
<tr><td><code>distance</code></td>
<td>
<p>= <code class="reqn">\sqrt(rwx^2+rwy^2)</code>.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>phase.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brastings)  # The Occurrence Times Data of 627 Blastings
ptspec(Brastings, nfre = 1000, prdmin = 0.5, prd = 1.0, pprd = c(2.0, 1.0, 0.5),
       interval = 4600)

data(PoissonData)  # to see the contrasting difference
ptspec(PoissonData, nfre = 1000, prdmin = 0.5, prd =  1.0, pprd = c(2.0, 1.0, 0.5),
       interval = 5000)
</code></pre>

<hr>
<h2 id='res2003JUL26'>The Residual Point Process Data</h2><span id='topic+res2003JUL26'></span>

<h3>Description</h3>

<p>The residual point process data of 26th July 2003 earthquake of M6.2 at the northern Miyagi-Ken Japan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(res2003JUL26)
</code></pre>


<h3>Format</h3>

<p><code>res2003JUL26</code> is a data frame with 553 observations and 7 variables named 
no., longitude, latitude, magnitude, time (from the main shock in days), depth, Ft (transformed time).
</p>


<h3>Source</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>

<hr>
<h2 id='respoi'>The Residual Point Process of the ETAS Model</h2><span id='topic+respoi'></span><span id='topic+respoi2'></span>

<h3>Description</h3>

<p>Compute the residual of modified Omori Poisson process and display the cumulative curve and magnitude v.s. transformed time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>respoi(time, mag, param, zts, tstart, zte, threshold = 0.0, plot = TRUE)

respoi2(etas, param, zts, tstart, zte, threshold = 0.0, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="respoi_+3A_time">time</code></td>
<td>
<p>the time measured from the main shock (t = 0).</p>
</td></tr>
<tr><td><code id="respoi_+3A_mag">mag</code></td>
<td>
<p>magnitude.</p>
</td></tr>
<tr><td><code id="respoi_+3A_etas">etas</code></td>
<td>
<p>an etas-format dataset on 9 variables
</p>
<p>(no., longitude, latitude, magnitude, time, depth, year, month and days).</p>
</td></tr>
<tr><td><code id="respoi_+3A_param">param</code></td>
<td>
<p>the four parameters <code class="reqn">B</code>, <code class="reqn">K</code>, <code class="reqn">c</code> and <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="respoi_+3A_zts">zts</code></td>
<td>
<p>the start of the precursory period.</p>
</td></tr>
<tr><td><code id="respoi_+3A_tstart">tstart</code></td>
<td>
<p>the start of the target period.</p>
</td></tr>
<tr><td><code id="respoi_+3A_zte">zte</code></td>
<td>
<p>the end of the target period.</p>
</td></tr>
<tr><td><code id="respoi_+3A_threshold">threshold</code></td>
<td>
<p>threshold magnitude.</p>
</td></tr>
<tr><td><code id="respoi_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) cumulative curve and magnitude v.s. transformed time <code class="reqn">F(t_i)</code> are plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>respoi</code> and <code>respoi2</code> compute the following output for displaying the goodness-of-fit of Omori-Utsu model to the data.
The cumulative number of earthquakes at time <code class="reqn">t</code> since <code class="reqn">t_0</code> is given by the integration of <code class="reqn">f(t)</code> with respect to the time <code class="reqn">t</code>,
</p>
<p style="text-align: center;"><code class="reqn">F(t) = B(t-t_0) + K\{ c^{(1-p)}-(t-t_i+c)^{(1-p)} \}/(p-1)</code>
</p>

<p>where the summation of <code class="reqn">i</code> is taken for all data event. 
</p>
<p><code>respoi2</code> is equivalent to <code>respoi</code> except that input and output forms are different. When a etas-format dataset is given, <code>respoi2</code> returns the dataset with the format as described below.
</p>


<h3>Value</h3>

<table>
<tr><td><code>trans.time</code></td>
<td>
<p>transformed time <code class="reqn">F(t_i), i = 1,2,...,N.</code></p>
</td></tr>
<tr><td><code>cnum</code></td>
<td>
<p>cumulative number of events.</p>
</td></tr>
<tr><td><code>resData</code></td>
<td>
<p>a res-format dataset on 7 variables
</p>
<p>(no., longitude, latitude, magnitude, time, depth and trans.time) </p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity - updated version (SASeies2006).</em>
The Institute of Statistical Mathematics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(main2003JUL26)  # The aftershock data of 26th July 2003 earthquake of M6.2 

# output transformed times and cumulative numbers
x &lt;- main2003JUL26
respoi(x$time, x$magnitude, param = c(0,0.96021e+02, 0.58563e-01, 0.96611e+00),
       zts = 0.0, tstart = 0.01, zte = 18.68, threshold = 2.5)

# output a res-format dataset
respoi2(main2003JUL26, param = c(0,0.96021e+02, 0.58563e-01, 0.96611e+00),
        zts = 0.0, tstart = 0.01, zte = 18.68, threshold = 2.5)
</code></pre>

<hr>
<h2 id='SAPP-package'>
Statistical Analysis of Point Processes
</h2><span id='topic+SAPP-package'></span><span id='topic+SAPP'></span>

<h3>Description</h3>

<p>R functions for statistical analysis of point processes
</p>


<h3>Details</h3>

<p>This package provides functions for statistical analysis of series of events and
seismicity.
</p>
<p>For overview of point process models, 'Statistical Analysis of Point Processes
with R' is available in the package vignette using the vignette function
(e.g., vignette(&quot;SAPP&quot;)).
</p>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs,
No.32, TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE)
VERSION 2</em>. The Institute of Statistical Mathematics.
<a href="https://www.ism.ac.jp/editsec/csm/">https://www.ism.ac.jp/editsec/csm/</a>
</p>
<p>Ogata, Y. (2006)
<em>Computer Science Monographs, No.33, Statistical Analysis of Seismicity -
updated version (SASeies2006).</em> The Institute of Statistical Mathematics.
<a href="https://www.ism.ac.jp/editsec/csm/">https://www.ism.ac.jp/editsec/csm/</a>
</p>

<hr>
<h2 id='SelfExcit'>Self-Exciting Point Process Data</h2><span id='topic+SelfExcit'></span>

<h3>Description</h3>

<p>Self-exciting point process test data for <code>linlin</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SelfExcit)
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 99.
</p>


<h3>Source</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>

<hr>
<h2 id='simbvh'>Simulation of Bi-Variate Hawkes' Mutually Exciting Point Processes
</h2><span id='topic+simbvh'></span>

<h3>Description</h3>

<p>Perform the simulation of bi-variate Hawkes' mutually exciting point processes.
The response functions are parameterized by the Laguerre-type polynomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbvh(interval, axx = NULL, axy = NULL, axz = NULL, ayx = NULL, 
       ayy = NULL, ayz = NULL, c, d, c2, d2, ptxmax, ptymax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simbvh_+3A_interval">interval</code></td>
<td>
<p>length of time interval in which events take place.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_axx">axx</code></td>
<td>
<p>coefficients of Laguerre polynomial (lgp) of the transfer function
</p>
<p>(= response function) from the data events x to x (trf; x &ndash;&gt; x).</p>
</td></tr>
<tr><td><code id="simbvh_+3A_axy">axy</code></td>
<td>
<p>coefficients of lgp (trf; y &ndash;&gt; x).</p>
</td></tr>
<tr><td><code id="simbvh_+3A_ayx">ayx</code></td>
<td>
<p>coefficients of lgp (trf; x &ndash;&gt; y).</p>
</td></tr>
<tr><td><code id="simbvh_+3A_ayy">ayy</code></td>
<td>
<p>coefficients of lgp (trf; y &ndash;&gt; y).</p>
</td></tr>
<tr><td><code id="simbvh_+3A_axz">axz</code></td>
<td>
<p>coefficients of polynomial for x data.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_ayz">ayz</code></td>
<td>
<p>coefficients of polynomial for y data.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_c">c</code></td>
<td>
<p>exponential coefficient of lgp corresponding to xx.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_d">d</code></td>
<td>
<p>exponential coefficient of lgp corresponding to xy.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_c2">c2</code></td>
<td>
<p>exponential coefficient of lgp corresponding to yx.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_d2">d2</code></td>
<td>
<p>exponential coefficient of lgp corresponding to yy.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_ptxmax">ptxmax</code></td>
<td>
<p>an upper bound of trend polynomial corresponding to xz.</p>
</td></tr>
<tr><td><code id="simbvh_+3A_ptymax">ptymax</code></td>
<td>
<p>an upper bound of trend polynomial corresponding to yz.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>simulated data X.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>simulated data Y.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ogata, Y., Katsura, K. and Zhuang, J. (2006) <em>Computer Science Monographs, No.32,
TIMSAC84: STATISTICAL ANALYSIS OF SERIES OF EVENTS (TIMSAC84-SASE) VERSION 2</em>.
The Institute of Statistical Mathematics.
</p>
<p>Ogata, Y. (1981) <em>On Lewis' simulation method for point processes</em>.
IEEE Information Theory, IT-27, pp.23-31.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simbvh(interval = 20000,
       axx = 0.01623,
       axy = 0.007306,
       axz = c(0.006187, -0.00000023),
       ayz = c(0.0046786, -0.00000048, 0.2557e-10),
       c = 0.4032, d = 0.0219, c2 = 1.0, d2 = 1.0,
       ptxmax = 0.0062, ptymax = 0.08)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
