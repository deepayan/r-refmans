<!DOCTYPE html><html><head><title>Help for package babsim.hospital</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {babsim.hospital}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aggMax'><p>Sane max for aggregation</p></a></li>
<li><a href='#aggregateSimulationReplications'><p>Summarize replications of a simulation</p></a></li>
<li><a href='#autoplot.BabsimDailyCases'><p>Visualize new daily cases</p></a></li>
<li><a href='#babsimHospital'><p>babsimHospital</p></a></li>
<li><a href='#babsimHospitalPara'><p>babsimHospitalPara</p></a></li>
<li><a href='#babsimToolsConf'><p>babsimToolsConf</p></a></li>
<li><a href='#checkSimPara'><p>checkSimPara</p></a></li>
<li><a href='#checkTestConfig'><p>Check test config</p></a></li>
<li><a href='#checkTestData'><p>Check Test Data</p></a></li>
<li><a href='#checkTrainConfig'><p>Check train config</p></a></li>
<li><a href='#dataCovidBeds20200624'><p>dataCovidBeds20200624</p></a></li>
<li><a href='#dataICUBeds20200821'><p>dataICUBeds20200821</p></a></li>
<li><a href='#ensureRangeOpen'><p>ensureRangeOpen</p></a></li>
<li><a href='#envToTibble'><p>envToTibble</p></a></li>
<li><a href='#ex1InfectedDf'><p>ex1InfectedDf</p></a></li>
<li><a href='#extendRki'><p>extendRki Erweiterung der RKI Daten</p></a></li>
<li><a href='#extractSimulationResults'><p>Extract and summarize BaBSim results</p></a></li>
<li><a href='#fetchRkiCases'><p>Download German daily case summary from RKI</p></a></li>
<li><a href='#fitExponential'><p>Fit a exponential function to data.</p></a></li>
<li><a href='#funBaBSimHospital'><p>Optimization of the BaBSim.Hospital Simulator</p></a></li>
<li><a href='#funOptimizeSim'><p>funOptimizeSim</p></a></li>
<li><a href='#funWrapOptimizeSim'><p>funWrapOptimizeSim</p></a></li>
<li><a href='#GABeds220200624'><p>GABeds220200624 Intensivbetten: Daten vom 24.6.2020</p></a></li>
<li><a href='#GermanCounties'><p>List of German administrative counties</p></a></li>
<li><a href='#GermanStates'><p>List of German states</p></a></li>
<li><a href='#getAndCheckTrainData'><p>Get and Check Train Data</p></a></li>
<li><a href='#getArrivalTimes'><p>getArrivalTimes</p></a></li>
<li><a href='#getBestParameter'><p>Return the best parameter set found</p></a></li>
<li><a href='#getBounds'><p>getBounds</p></a></li>
<li><a href='#getConfFromData'><p>getConfFromData</p></a></li>
<li><a href='#getDailyMaxResults'><p>getDailyMaxResults</p></a></li>
<li><a href='#getDecision'><p>getDecision</p></a></li>
<li><a href='#getDiviLinks'><p>Retrieve links to all DIVI day reports.</p></a></li>
<li><a href='#getError'><p>getError</p></a></li>
<li><a href='#getIcuBeds'><p>getIcuBeds</p></a></li>
<li><a href='#getInfectedPerDay'><p>getInfectedPerDay</p></a></li>
<li><a href='#getMatrixD'><p>getMatrixD</p></a></li>
<li><a href='#getMatrixP'><p>getMatrixP</p></a></li>
<li><a href='#getObkData'><p>getObkData</p></a></li>
<li><a href='#getParameterDataFrame'><p>getParameterDataFrame</p></a></li>
<li><a href='#getParameterName'><p>getParameterName</p></a></li>
<li><a href='#getParameterNameList'><p>getParameterNameList</p></a></li>
<li><a href='#getParaSet'><p>getParaSet</p></a></li>
<li><a href='#getPeakVec'><p>getPeakVec</p></a></li>
<li><a href='#getRealBeds'><p>getRealBeds</p></a></li>
<li><a href='#getRegionIcu'><p>getRegionIcu Auswahl der ICU Daten fuer eine Region</p></a></li>
<li><a href='#getRegionRki'><p>getRegionRki Auswahl der RKI Daten fuer eine Region</p></a></li>
<li><a href='#getRkiData'><p>getRkiData</p></a></li>
<li><a href='#getRkiRisk'><p>getRkiRisk</p></a></li>
<li><a href='#getStartParameter'><p>getStartParameter</p></a></li>
<li><a href='#getSyntheticData'><p>getSyntheticData</p></a></li>
<li><a href='#getTestData'><p>Get Test Data</p></a></li>
<li><a href='#getTrainTestObjFun'><p>getTrainTestObjFun</p></a></li>
<li><a href='#ggVisualizeIcu'><p>ggVisualizeIcu Visualisierung der ICU Daten</p></a></li>
<li><a href='#ggVisualizeRki'><p>ggVisualizeRki ggPlot Visualisierung der RKI Daten</p></a></li>
<li><a href='#ggVisualizeRkiAge'><p>ggVisualizeRkiAge Visualisation of the pre-processed RKI Data with</p>
respect to age and gender</a></li>
<li><a href='#ggVisualizeRkiEvents'><p>ggVisualizeRkiEvents Visualisation of the pre-processed RKI Data</p></a></li>
<li><a href='#ggVisualizeRkiExtended'><p>ggVisualizeRkiExtended Visualisation of the extended RKI Data</p></a></li>
<li><a href='#ggVisualizeRkiExtendedDataCalculation'><p>Data precalculation for ggVisualizeRkiExtended</p></a></li>
<li><a href='#icudata'><p>icudata IntensivbettenDaten (Beispieldatensatz)</p></a></li>
<li><a href='#koelnarchive'><p>koelnarchive archived koeln data</p></a></li>
<li><a href='#mapAgeGroupToAge'><p>mapAgeGroupToAge</p></a></li>
<li><a href='#mapAgeToAgeGroup'><p>mapAgeToAgeGroup</p></a></li>
<li><a href='#mapPToPara'><p>mapPToPara</p></a></li>
<li><a href='#mapXToPara'><p>mapXToPara</p></a></li>
<li><a href='#messageDateRange'><p>Display date range of a vector</p></a></li>
<li><a href='#messagef'><p>Output a formatted message</p></a></li>
<li><a href='#modelResultHospital'><p>modelResultHospital</p></a></li>
<li><a href='#nrwarchive'><p>nrwarchive archived nrw data</p></a></li>
<li><a href='#obkarchive'><p>obkarchive archived obk data</p></a></li>
<li><a href='#paras'><p>paras data</p></a></li>
<li><a href='#plotDailyMaxResults'><p>plotDailyMaxResults</p></a></li>
<li><a href='#plotPostprocessedEnvs'><p>plotPostprocessedEnvs</p></a></li>
<li><a href='#postprocessEnvs'><p>postprocessEnvs</p></a></li>
<li><a href='#printConf'><p>printConf</p></a></li>
<li><a href='#RiskScore'><p>Calculate risk scores</p></a></li>
<li><a href='#rkidata'><p>rkidata: RKI COVID-19 Daten (complete, not included in CRAN version)</p></a></li>
<li><a href='#rkiGeschlechtToSex'><p>Map <code>Geschlecht</code> to biological sex</p></a></li>
<li><a href='#rkiToBabsimArrivals'><p>rkiToBabsimArrivals</p></a></li>
<li><a href='#rkiToBabsimData'><p>rkiToBabsimData</p></a></li>
<li><a href='#rtgamma'><p>rtgamma</p></a></li>
<li><a href='#runoptDirect'><p>runoptDirect Optimierung der babsim.hospital Parameter</p></a></li>
<li><a href='#runOptLocal'><p>runOptLocal</p></a></li>
<li><a href='#runoptUK'><p>runoptUK Optimierung der babsim.hospital Parameter</p></a></li>
<li><a href='#skip_if_quicktest'><p>Skip test if in quicktest mode</p></a></li>
<li><a href='#smoothParameter'><p>Smooth a parameter set using another parameter set</p></a></li>
<li><a href='#softmax'><p>softmax</p></a></li>
<li><a href='#switchRkiRefdatumToMeldedatum'><p>switchRkiRefdatumToMeldedatum Change RKI data File</p></a></li>
<li><a href='#synthpara'><p>synthpara data</p></a></li>
<li><a href='#ukpara'><p>ukpara data</p></a></li>
<li><a href='#ukpara01'><p>ukpara01 data</p></a></li>
<li><a href='#ukpara02'><p>ukpara02 data</p></a></li>
<li><a href='#updateIcudataFile'><p>updateIcudataFile Update ICU data File</p></a></li>
<li><a href='#updateMatrixP'><p>updateMatrixP</p></a></li>
<li><a href='#updateParaSet'><p>updateParaSet</p></a></li>
<li><a href='#updateRkidataFile'><p>updateRkidataFile Update RKI data File</p></a></li>
<li><a href='#vaccineCounts'><p>Amount of vaccinated people in germany</p></a></li>
<li><a href='#visualizeGraph'><p>visualizeGraph Visualisierung der Wahrscheinlichkeiten und Dauern</p></a></li>
<li><a href='#visualizeIcu'><p>visualizeIcu Visualisierung der ICU Daten</p></a></li>
<li><a href='#visualizeRki'><p>visualizeRki Visualisierung der RKI Daten</p></a></li>
<li><a href='#visualizeRkiEvents'><p>visualizeRkiEvents Visualisation of the pre-processed RKI Data</p></a></li>
<li><a href='#visualizeUK'><p>visualizeUK</p></a></li>
<li><a href='#weighted_rmse'><p>weighted_rmse</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Title:</td>
<td>Bartz &amp; Bartz Simulation Hospital</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a discrete-event simulation model for a hospital resource planning problem.
    The project is motivated by the challenges faced by health care institutions in the current COVID-19 pandemic. 
    It can be used by health departments to forecast demand for intensive care beds, ventilators, and staff resources.
    Our modelling approach is inspired by "A novel modelling technique to predict resource requirements in critical care - a case study" (Lawton and McCooe 2019) and combines two powerful technologies: 
      (i) discrete event simulation using the 'simmer' package and 
      (ii) model-based optimization using 'SPOT'.
    Ucar I, Smeets B, Azcorra A (2019) &lt;<a href="https://doi.org/10.18637%2Fjss.v090.i02">doi:10.18637/jss.v090.i02</a>&gt;.
    Bartz-Beielstein T, Lasarczyk C W G, Preuss M (2005) &lt;<a href="https://doi.org/10.1109%2FCEC.2005.1554761">doi:10.1109/CEC.2005.1554761</a>&gt;.
    Lawton T, McCooe M (2019) &lt;<a href="https://doi.org/10.7861%2Ffuturehosp.6-1-17">doi:10.7861/futurehosp.6-1-17</a>&gt;.</td>
</tr>
<tr>
<td>Copyright:</td>
<td>file inst/COPYRIGHTS</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.th-koeln.de/babsimhospital">https://www.th-koeln.de/babsimhospital</a></td>
</tr>
<tr>
<td>Version:</td>
<td>11.8.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-27</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>SPOT, checkmate, curl, data.table, dplyr, ggplot2, golem,
igraph, lubridate, markovchain, methods, padr, parallel, rvest,
scales, simmer, slider, testthat, plyr, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>batchtools, knitr, rmarkdown, rpart, rpart.plot, simmer.plot,
stringr, tidyverse, usethis, vctrs</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-27 13:53:40 UTC; bartz</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Bartz-Beielstein
    <a href="https://orcid.org/0000-0002-5938-5158"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Frederik Rehbach <a href="https://orcid.org/0000-0003-0922-8629"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Eva Bartz [aut],
  Olaf Mersmann <a href="https://orcid.org/0000-0002-7720-4939"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Martin Zaefferer <a href="https://orcid.org/0000-0003-2372-2092"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Bartz-Beielstein &lt;tbb@bartzundbartz.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-30 07:00:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='aggMax'>Sane max for aggregation</h2><span id='topic+aggMax'></span>

<h3>Description</h3>

<p>Sane max for aggregation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggMax(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggMax_+3A_x">x</code></td>
<td>
<p>[<code>vector(n)</code>] <br />
numerical or character argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R's <code>max</code> returns &lsquo;-Inf&rsquo; for empty lists. 
This is undesirable for aggregation where we would rather have &lsquo;NA&rsquo;.
</p>


<h3>Value</h3>

<p>Maximum value in &lsquo;x&rsquo; or &lsquo;NA&rsquo; if &lsquo;x&rsquo; is empty.
</p>

<hr>
<h2 id='aggregateSimulationReplications'>Summarize replications of a simulation</h2><span id='topic+aggregateSimulationReplications'></span>

<h3>Description</h3>

<p>Summarize replications of a simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregateSimulationReplications(results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregateSimulationReplications_+3A_results">results</code></td>
<td>
<p>Raw simulation results. 
The result of <code><a href="#topic+extractSimulationResults">extractSimulationResults</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='autoplot.BabsimDailyCases'>Visualize new daily cases</h2><span id='topic+autoplot.BabsimDailyCases'></span>

<h3>Description</h3>

<p>Visualize new daily cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoplot.BabsimDailyCases(
  object,
  xlab = "Date",
  ylab = "Cases",
  clab = "Age",
  droplevels = TRUE,
  drop.NA = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_object">object</code></td>
<td>
<p>[<code>BabsimCases</code>] <br />
new daily cases.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_xlab">xlab</code></td>
<td>
<p>[<code>character(1)</code>] <br />
a label for the x axis.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_ylab">ylab</code></td>
<td>
<p>[<code>character(1)</code>] <br />
a label for the y axis.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_clab">clab</code></td>
<td>
<p>[<code>character(1)</code>] <br />
a label for the fill legend.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_droplevels">droplevels</code></td>
<td>
<p>[<code>logical(1)</code>] <br />
drop unused levels from &lsquo;ageGroup&rsquo; and &lsquo;sex&rsquo; before plotting.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_drop.na">drop.NA</code></td>
<td>
<p>[<code>logical(1)</code>] <br />
drop rows with missing or &lsquo;NA&rsquo; values before plotting.</p>
</td></tr>
<tr><td><code id="autoplot.BabsimDailyCases_+3A_...">...</code></td>
<td>
<p>[] <br />
additional arguments. Ignored.</p>
</td></tr>
</table>

<hr>
<h2 id='babsimHospital'>babsimHospital</h2><span id='topic+babsimHospital'></span>

<h3>Description</h3>

<p>Simulate resource allocation in hospitals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>babsimHospital(arrivalTimes = NULL, conf = list(), para = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="babsimHospital_+3A_arrivaltimes">arrivalTimes</code></td>
<td>
<p>Arrival times as generated using <code>getArrivalTimes</code>.</p>
</td></tr>
<tr><td><code id="babsimHospital_+3A_conf">conf</code></td>
<td>
<p>list with the following entries:
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd></dl>
<p>. Values larger than 1 are mapped to 1.
</p>
</td></tr>
<tr><td><code id="babsimHospital_+3A_para">para</code></td>
<td>
<p>List with parameter settings. Can be generated with <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>.</p>
</td></tr>
<tr><td><code id="babsimHospital_+3A_...">...</code></td>
<td>
<p>additional parameters passed to <code>fun</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an env list with:
</p>

<dl>
<dt><code>xbest</code></dt><dd><p>Parameters of the best found solution (matrix).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
require("simmer")
require("dplyr")
# Generate simulation data based on number of infected persons per day:
x &lt;- dataCovidBeds20200624
arrivalTimes &lt;- getArrivalTimes(x$Infected)
conf &lt;- babsimToolsConf()
y &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = babsimHospitalPara()
)
resources &lt;- get_mon_resources(y)
# resources &lt;- resources %&gt;% filter(resource != "nurse")
mean(resources$server)

## 2nd example (shows details):
# Generate simulation data based on number of infected persons per day:
x &lt;- dataCovidBeds20200624
arrivalTimes &lt;- getArrivalTimes(x$Infected)
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
conf$logLevel &lt;- 1
conf$simRepeats &lt;- 1
para$GammaShapeParameter &lt;- 0.8
y &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = para
)
</code></pre>

<hr>
<h2 id='babsimHospitalPara'>babsimHospitalPara</h2><span id='topic+babsimHospitalPara'></span>

<h3>Description</h3>

<p>Default Control list for babsimHospital
This function returns the default controls for the functions <code><a href="#topic+babsimHospital">babsimHospital</a></code>.
Control is a list of the following settings.
Note: dependent parameters that are based on other parameters (e.g., probabilities that add to 1.0) are marked with an asterisk (*).
Note: parameters that are currently not used, are marked with a double asterisk (**).
</p>

<dl>
<dt><code>logLevel</code></dt><dd><p>if larger than 10, shown detailed simmer output. simmer <code>log_</code> level, default is <code>0</code>.</p>
</dd>
</dl>
<p>1
</p>
<dl>
<dt><code>FactorPatientsInfectedToHealthy*</code></dt><dd><p>Z1: Infected -&gt; Healthy: percentage of patients that move from state infected to healthy, default is <code>0.831</code>.
Note: not used. Value is internally calculated as: <code>1 - FactorPatientsInfectedToHospital</code></p>
</dd>
<dt><code>AmntDaysInfectedToHealthy**</code></dt><dd><p>Z1: Infected -&gt; Healthy: duration (in days) if patients move from state infected to healthy, default is <code>20.5</code>.
Note: not used, because not modeled.</p>
</dd>
</dl>
<p>2
</p>
<dl>
<dt><code>FactorPatientsInfectedToHospital</code></dt><dd><p>Z2: Infected -&gt; Hospital: percentage of patients that move from state infected to hospital, default is <code>0.169</code>.</p>
</dd>
<dt><code>AmntDaysInfectedToHospital</code></dt><dd><p>Z2: Infected -&gt; Hospital: duration (in days) if patients move from state infected to hospital, default is <code>8.4</code>.</p>
</dd>
</dl>
<p>3
</p>
<dl>
<dt><code>FactorPatientsHospitalToNormal*</code></dt><dd><p>Z3: Hospital -&gt; Normal: percentage of patients that move from state hospital to normal, default is <code>0</code>.
Note: not used. Value is internally calculated as: <code>1 - FactorPatientsHospitalToIntensive - FactorPatientsHospitalToVentilation</code> </p>
</dd>
<dt><code>AmntDaysHospitalToNormal*</code></dt><dd><p>Z3: Hospital -&gt; Normal: duration (in days) if patients move from state hospital to normal, default is <code>1e6</code>.
Note: not used. Patients move from hospital to normal immediately</p>
</dd>
</dl>
<p>4
</p>
<dl>
<dt><code>FactorPatientsHospitalToIntensive</code></dt><dd><p>Z4: Hospital -&gt; Intensive: percentage of patients that move from state hospital to intensive, default is <code>0.012</code>.</p>
</dd>
<dt><code>AmntDaysHospitalToIntensiv*</code></dt><dd><p>Z4: Hospital -&gt; Intensive: duration (in days) if patients move from state hospital to intensive, default is <code>1e6</code>. Note: not used.
Patients move from hospital to intensive immediately</p>
</dd>
</dl>
<p>5
</p>
<dl>
<dt><code>FactorPatientsHospitalToVentilation</code></dt><dd><p>Z5: Hospital -&gt; Ventilation: percentage of patients that move from state hospital to ventilation, default is <code>0.036</code>.</p>
</dd>
<dt><code>AmntDaysHospitalToVentilation*</code></dt><dd><p>Z5: Hospital -&gt; Ventilation: duration (in days) if patients move from state hospitel to ventilation, default is <code>1e6</code>. Note: not used.
Patients move from hospital to intensive immediately</p>
</dd>
</dl>
<p>6
</p>
<dl>
<dt><code>FactorPatientsNormalToHealthy*</code></dt><dd><p>Z6: Normal -&gt; Healthy: percentage of patients that move from state normal to healthy, default is <code>0</code>. Note: not used.
Value is internally calculated as: <code>1 - FactorPatientsNormalToIntensive - FactorPatientsNormalToVentilation - FactorPatientsNormalToDeath </code></p>
</dd>
<dt><code>AmntDaysNormalToHealthy</code></dt><dd><p>Z6: Normal -&gt; Healthy: duration (in days) if patients move from state normal to healthy, default is <code>11.6</code>.</p>
</dd>
</dl>
<p>7
</p>
<dl>
<dt><code>FactorPatientsNormalToIntensive</code></dt><dd><p>Z7: Normal -&gt; Intensive: percentage of patients that move from state normal to intensive, default is <code>0.0506</code>.</p>
</dd>
<dt><code>AmntDaysNormalToIntensive</code></dt><dd><p>Z7: Normal -&gt; Intensive: duration (in days) if patients move from state normal to intensive, default is <code>1.25</code>.</p>
</dd>
</dl>
<p>8
</p>
<dl>
<dt><code>FactorPatientsNormalToVentilation</code></dt><dd><p>Z8: Normal -&gt; Ventilation: percentage of patients that move from state normal to ventilation, default is <code>0.1013</code>.</p>
</dd>
<dt><code>AmntDaysNormalToVentilation</code></dt><dd><p>Z8: Normal -&gt; Ventilation: duration (in days) if patients move from state normal to ventilation, default is <code>3.63</code>.</p>
</dd>
</dl>
<p>9
</p>
<dl>
<dt><code>FactorPatientsNormalToDeath</code></dt><dd><p>Z9: Normal -&gt; Death: percentage of patients that move from state normal to death, default is <code>0.139</code>.</p>
</dd>
<dt><code>AmntDaysNormalToDeath</code></dt><dd><p>Z9: Normal -&gt; Death: duration (in days) if patients move from state normal to death, default is <code>11.4</code>.</p>
</dd>
</dl>
<p>10
</p>
<dl>
<dt><code>FactorPatientsIntensiveToAftercare*</code></dt><dd><p>Z10: Intensive -&gt; Aftercare: percentage of patients that move from state intensive to aftercare, default is <code>0.25</code>. Note: not used.
Value is internally calculated as: <code>1 - FactorPatientsIntensiveToVentilation - FactorPatientsIntensiveToDeath - FactorPatientsIntensiveToHealthy</code></p>
</dd>
<dt><code>AmntDaysIntensiveToAftercare</code></dt><dd><p>Z10: Intensive -&gt; Aftercare: duration (in days) if patients move from state intensive to aftercare, default is <code>7.0</code>.</p>
</dd>
</dl>
<p>11
</p>
<dl>
<dt><code>FactorPatientsIntensiveToVentilation</code></dt><dd><p>Z11: Intensive &gt; Ventilation: percentage of patients that move from state intensive to ventilation, default is <code>0.25</code>.</p>
</dd>
<dt><code>AmntDaysIntensiveToVentilation</code></dt><dd><p>Z11: Intensive &gt; Ventilation: duration (in days) if patients move from state intensive to ventilation, default is <code>2.0</code>.</p>
</dd>
</dl>
<p>12
</p>
<dl>
<dt><code>FactorPatientsIntensiveToDeath</code></dt><dd><p>Z12: Intensive -&gt; Death: percentage of patients that move from state intensive to death, default is <code>0.25</code>.</p>
</dd>
<dt><code>AmntDaysIntensiveToDeath</code></dt><dd><p>Z12: Intensive -&gt; Death: duration (in days) if patients move from state intensive to death, default is <code>2.0</code>.</p>
</dd>
</dl>
<p>12a
</p>
<dl>
<dt>Removed in v11: <code>FactorPatientsIntensiveToHealthy</code></dt><dd><p>Z12a: Intensive -&gt; Healthy: percentage of patients that move from state intensive  to healthy, default is <code>0.25</code>.</p>
</dd>
<dt><code>AmntDaysIntensiveToHealthy</code></dt><dd><p>Z12a: Intensive -&gt; Healthy: duration (in days) if patients move from state intensive to healthy, default is <code>13.0</code>.</p>
</dd>
</dl>
<p>13
</p>
<dl>
<dt>Removed in v11: <code>FactorPatientsVentilationToAftercare*</code></dt><dd><p>Z13: Ventilation -&gt; Aftercare: percentage of patients that move from state ventilation to aftercare, default is <code>0.08</code>. Note: not used.
Value is internally calculated as: <code>1 - FactorPatientsVentilationToIntensiveAfter - FactorPatientsVentilationToDeath</code></p>
</dd>
<dt>Removed in v11: <code>AmntDaysVentilationToAftercare</code></dt><dd><p>Z13: Ventilation -&gt; Aftercare: duration (in days) if patients move from state ventilation to aftercare, default is <code>9.0</code>.</p>
</dd>
</dl>
<p>14
</p>
<dl>
<dt><code>FactorPatientsVentilationToIntensiveAfter</code></dt><dd><p>Z14: Ventilation -&gt; IntensiveAfter: percentage of patients that move from state ventilation to intensiveAfter, default is <code>0.42</code>.</p>
</dd>
<dt><code>AmntDaysVentilationToIntensiveAfter</code></dt><dd><p>Z14: Ventilation -&gt; IntensiveAfter: duration (in days) if patients move from state ventilation to intensiveAfter, default is <code>23.0</code>.</p>
</dd>
</dl>
<p>15
</p>
<dl>
<dt>Removed in v11: <code>FactorPatientsVentilationToDeath</code></dt><dd><p>Z15: Ventilation -&gt; Death: percentage of patients that move from state ventilation to death, default is <code>0.5</code>.</p>
</dd>
<dt><code>AmntDaysVentilationToDeath</code></dt><dd><p>Z15: Ventilation -&gt; Death: duration (in days) if patients move from state  ventilation to death, default is <code>16.0</code>.</p>
</dd>
</dl>
<p>16
</p>
<dl>
<dt><code>FactorPatientsAftercareToHealthy*</code></dt><dd><p>Z16: Aftercare -&gt; Healthy: percentage of patients that move from state aftercare to healthy, default is <code>1.0</code>. Note: not used.
Value is <code>1</code>. No branching required, because there is no alternative.</p>
</dd>
<dt><code>AmntDaysAftercareToHealthy</code></dt><dd><p>Z16: Aftercare -&gt; Healthy: duration (in days) if patients move from state aftercare to healthy, default is <code>21.0</code>.</p>
</dd>
</dl>
<p>17 I
</p>
<dl>
<dt><code>FactorPatientsIntensiveAfterToAftercare*</code></dt><dd><p>Z17I: IntensiveAfter -&gt; Aftercare: percentage of patients that move from state intensiveAfter to aftercare, default is <code>0.5</code>. Note: not used.
Value is internally calculated as: <code>1 - FactorPatientsIntensiveAfterToHealthy - FactorPatientsIntensiveAfterToDeath - FactorPatientsIntensiveAfterToHealthy</code></p>
</dd>
<dt><code>AmntDaysIntensiveAfterToAftercare</code></dt><dd><p>Z17I: IntensiveAfter -&gt; Aftercare: duration (in days) if patients move from state intensiveAfter to aftercare, default is <code>7.0</code>.</p>
</dd>
</dl>
<p>17 II
</p>
<dl>
<dt>Removed in v11: <code>AmntDaysIntensiveAfterToHealthy</code></dt><dd><p>Z17II: IntensiveAfter -&gt; Healthy: duration (in days) if patients move from state intensiveAfter to healthy, default is <code>18.0</code>.</p>
</dd>
</dl>
<p>18
</p>
<dl>
<dt><code>FactorPatientsIntensiveAfterToDeath</code></dt><dd><p>IntensiveAfter -&gt; Death: percentage of patients that move from state intensiveAfter to death, default is <code>0.0</code>.</p>
</dd>
<dt><code>AmntDaysIntensiveAfterToDeath</code></dt><dd><p>IntensiveAfter -&gt; Death: duration (in days) if patients move from state intensiveAfter to death, default is <code>1e-6</code>.</p>
</dd>
<dt><code>GammaShapeParameter</code></dt><dd><p>Gamma shape parameter, default is <code>1</code> (exponential distribution).</p>
</dd>
<dt><code>RiskFactorA</code></dt><dd><p>Parameter a in the exponential function r(x) = a exp(b x) that models the risk r as a function of the age x, default is <code>0.02048948</code>.</p>
</dd>
<dt><code>RiskFactorB</code></dt><dd><p>Parameter b in the exponential function r(x) = a exp(b x) that models the risk r as a function of the age x, default is <code>0.07138200</code>.</p>
</dd>
<dt><code>RiskMale</code></dt><dd><p>Death risk of male patients compared to female , default is <code>2</code>.</p>
</dd>
<dt><code>AmntDaysIntensiveAfterToHealthy</code></dt><dd><p>IntensiveAfter -&gt; Healthy: duration (in days) if patients move from state intensiveAfter to death, default is <code>3</code>.</p>
</dd>
<dt><code>FactorPatientsIntensiveAfterToHealthy</code></dt><dd><p>IntensiveAfter -&gt; Healthy: percentage of patients that move from state intensiveAfter to healthy, default is <code>0.67</code>.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>babsimHospitalPara()
</code></pre>


<h3>Value</h3>

<p>a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# change Gamma parameter
x &lt;- babsimHospitalPara()
x$GammaShapeParameter &lt;- 1.0
</code></pre>

<hr>
<h2 id='babsimToolsConf'>babsimToolsConf</h2><span id='topic+babsimToolsConf'></span>

<h3>Description</h3>

<p>Default configuration list for babsimTools.
This function returns the default configuration settings of the babsimTools functions
used to run <code><a href="#topic+babsimHospital">babsimHospital</a></code>.
Configuration <code>conf</code>  is a list of the following settings.
</p>

<dl>
<dt><code>seed</code></dt><dd><p>(int) Initial seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>(int) Number of <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation runs. Default: 1</p>
</dd>
<dt><code>parallel</code></dt><dd><p>(logical) Use parallel simulations based on <code><a href="parallel.html#topic+mclapply">mclapply</a></code>. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>(num) Percentage of cores used, if <code>parallel == TRUE</code>. Default: 0.5</p>
</dd>
<dt><code>ICU</code></dt><dd><p>(logical) Use ICU (RKI) data. Default: FALSE.</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>(int) 0 = no logging, &gt;= 1 logging. Default: 0. If larger than 10, shown detailed simmer output.</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>(num) Maximum capacity used for <code><a href="#topic+babsimHospital">babsimHospital</a></code> resources. Default: 1e6.</p>
</dd>
<dt><code>dataset</code></dt><dd><p>(chr)  &quot;GA&quot; or &quot;ICU&quot;. Default: &quot;GA&quot;.</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the simulation data (infection data used to generate
arrival times), first day. Default: &quot;2020-03-03&quot;</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the simulation data, last day. Default: &quot;2020-06-24&quot;</p>
</dd>
</dl>
</dd>
<dt><code>fieldDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the field (resources)  data, first day. Default: &quot;2020-03-03&quot;</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the field data, last day. Default: &quot;2020-06-24&quot;</p>
</dd>
</dl>
</dd>
<dt><code>simulationData</code></dt><dd><p>(data frame) Data used for the simulation. Default <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code>
</p>

<dl>
<dt>bed</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>intensiveBed</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: &quot;2020-03-03&quot; &quot;2020-03-04&quot; &quot;2020-03-05&quot; &quot;2020-03-06&quot; ...</p>
</dd>
<dt>Infected</dt><dd><p>num  5 0 0 0 0 0 0 7 2 5 ...</p>
</dd>
<dt>Sick</dt><dd><p>num  5 5 5 5 5 5 5 12 14 19 ...</p>
</dd>
</dl>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>(data frame) Data used for evalution of the simulation. Default <code><a href="#topic+GABeds220200624">GABeds220200624</a></code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  &quot;bed&quot; &quot;bed&quot; &quot;bed&quot; &quot;bed&quot; ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: &quot;2020-03-03&quot; &quot;2020-03-04&quot; &quot;2020-03-05&quot; &quot;2020-03-06&quot; ...</p>
</dd>
</dl>
</dd>
<dt><code>resource</code></dt><dd><p>(vector) Resources used in the simulation.
Default: <code>c("bed", "intensiveBed", "intensiveBedVentilation")</code>. For ICU data use:
<code>c("bed", "intensiveBedVentilation")</code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  &quot;bed&quot; &quot;bed&quot; &quot;bed&quot; &quot;bed&quot; ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: &quot;2020-03-03&quot; &quot;2020-03-04&quot; &quot;2020-03-05&quot; &quot;2020-03-06&quot; ...</p>
</dd>
</dl>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>babsimToolsConf()
</code></pre>


<h3>Value</h3>

<p>a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# turn on parallel simulation:
conf &lt;- babsimToolsConf()
conf$parallel &lt;- TRUE
conf$simulationDates$StartDate &lt;- "2020-01-01"
</code></pre>

<hr>
<h2 id='checkSimPara'>checkSimPara</h2><span id='topic+checkSimPara'></span>

<h3>Description</h3>

<p>check (and correct) parameter list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkSimPara(para = babsimHospitalPara())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkSimPara_+3A_para">para</code></td>
<td>
<p>list: optimization parameters, e.g., generated via <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected parameter list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x0 &lt;- babsimHospitalPara()
x &lt;- checkSimPara(x0)
</code></pre>

<hr>
<h2 id='checkTestConfig'>Check test config</h2><span id='topic+checkTestConfig'></span>

<h3>Description</h3>

<p>Check test config
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkTestConfig(testConf, TestSimStartDate, TestFieldStartDate, verbosity)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkTestConfig_+3A_testconf">testConf</code></td>
<td>
<p>test configuration</p>
</td></tr>
<tr><td><code id="checkTestConfig_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>test data: sim start date</p>
</td></tr>
<tr><td><code id="checkTestConfig_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>test data: field start date</p>
</td></tr>
<tr><td><code id="checkTestConfig_+3A_verbosity">verbosity</code></td>
<td>
<p>default 0.</p>
</td></tr>
</table>

<hr>
<h2 id='checkTestData'>Check Test Data</h2><span id='topic+checkTestData'></span>

<h3>Description</h3>

<p>Check test data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkTestData(testData, TestSimStartDate, TestFieldStartDate, verbosity)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkTestData_+3A_testdata">testData</code></td>
<td>
<p>list of test data: field and sim</p>
</td></tr>
<tr><td><code id="checkTestData_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>test data: sim start date</p>
</td></tr>
<tr><td><code id="checkTestData_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>test data: field start date</p>
</td></tr>
<tr><td><code id="checkTestData_+3A_verbosity">verbosity</code></td>
<td>
<p>default 0.</p>
</td></tr>
</table>

<hr>
<h2 id='checkTrainConfig'>Check train config</h2><span id='topic+checkTrainConfig'></span>

<h3>Description</h3>

<p>Check consistency of the training configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkTrainConfig(
  trainConf,
  TrainSimStartDate,
  TrainFieldStartDate,
  verbosity = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkTrainConfig_+3A_trainconf">trainConf</code></td>
<td>
<p>trainConfig</p>
</td></tr>
<tr><td><code id="checkTrainConfig_+3A_trainsimstartdate">TrainSimStartDate</code></td>
<td>
<p>Start data simulation train data</p>
</td></tr>
<tr><td><code id="checkTrainConfig_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start data simulation field data</p>
</td></tr>
<tr><td><code id="checkTrainConfig_+3A_verbosity">verbosity</code></td>
<td>
<p>Default 0.</p>
</td></tr>
</table>

<hr>
<h2 id='dataCovidBeds20200624'>dataCovidBeds20200624</h2><span id='topic+dataCovidBeds20200624'></span>

<h3>Description</h3>

<p>A data set of COVID-19 cases with 99 obs. of  11 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataCovidBeds20200624
</code></pre>


<h3>Format</h3>

<p>A data frame with 32239 rows and 6 columns:
</p>

<dl>
<dt>bed</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>intensiveBed</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
<dt>Infected</dt><dd><p>num  5 0 0 0 0 0 0 7 2 5 ...</p>
</dd>
<dt>Sick</dt><dd><p>num  5 5 5 5 5 5 5 12 14 19 ...</p>
</dd>
</dl>

<p>The variable <code>obk$Sick</code> was generated from the Infected data as follows:
<code>slide_dbl(obk$Infected, ~sum(.x), .before = (amntDaysSickness -1)) </code>
<code>amntDaysSickness</code> was set to 20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- dataCovidBeds20200624
# first look
str(x)

# plot
x$InfCum &lt;- cumsum(x$Infected)
plot(x$Day, x$InfCum, type = "l", log = "y", ylim = c(1, 500))
lines(x$Day, x$Infected + 1e-6)
</code></pre>

<hr>
<h2 id='dataICUBeds20200821'>dataICUBeds20200821</h2><span id='topic+dataICUBeds20200821'></span>

<h3>Description</h3>

<p>A data set of COVID-19 ICU beds with 113 obs. of  3 variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataICUBeds20200821
</code></pre>


<h3>Format</h3>

<p>A data frame with the following entries:
</p>

<dl>
<dt>bed</dt><dd><p>640 597 538 553 591 573 593 527 529 508 ...</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  1549 1508 1441 1396 1346 1311 1230 1185 1121 1073 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-05-01' '2020-05-02' '2020-05-03' '2020-05-04' ...</p>
</dd>
</dl>

<p>The data frame was generated as follows:
<code>icu &lt;- icudata
icuCov &lt;- as.data.frame(xtabs( faelle_covid_aktuell ~  daten_stand, icu))
icuCov$daten_stand &lt;- as.Date(icuCov$daten_stand)
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBeatm$daten_stand &lt;- as.Date(icuCovBeatm$daten_stand)
dataICUBeds20200821 &lt;- data.frame(bed=(icuCov$Freq - icuCovBeatm$Freq), intensiveBedVentilation=icuCovBeatm$Freq, Day =  as.Date(icuCovBeatm$daten_stand))
</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- dataICUBeds20200821
# first look
str(x)

# plot
x &lt;- dataICUBeds20200821
plot(x$Day, x$bed, type = "o")
lines(x$Day, x$intensiveBedVentilation, type = "o", col = "red")
</code></pre>

<hr>
<h2 id='ensureRangeOpen'>ensureRangeOpen</h2><span id='topic+ensureRangeOpen'></span>

<h3>Description</h3>

<p>Ensure that value belongs to the open interval ]a,b[
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensureRangeOpen(x, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ensureRangeOpen_+3A_x">x</code></td>
<td>
<p>value</p>
</td></tr>
<tr><td><code id="ensureRangeOpen_+3A_a">a</code></td>
<td>
<p>lower limit</p>
</td></tr>
<tr><td><code id="ensureRangeOpen_+3A_b">b</code></td>
<td>
<p>upper limit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected value
</p>


<h3>Examples</h3>

<pre><code class='language-R'># return 1:
ensureRangeOpen(x = 10, a = 0, b = 1)
# return 0:
ensureRangeOpen(x = 0, a = 0, b = 1)
# return 0.5:
ensureRangeOpen(x = 0.5, a = 0, b = 1)
</code></pre>

<hr>
<h2 id='envToTibble'>envToTibble</h2><span id='topic+envToTibble'></span>

<h3>Description</h3>

<p>Convert  babsim simulation results to tibble data.
Input: <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment and field data formatted
using <code><a href="#topic+getRealBeds">getRealBeds</a></code>. The formatted filed date has dim (nxm, 5), the output data
has dimension (nxm, 15).
The method <code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> function is used to extract information from
the <code>babsim.hospital</code> simulation.
The function is used by <code><a href="#topic+modelResultHospital">modelResultHospital</a></code> to prepare the calculation of the error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envToTibble(envs, fieldEvents, conf, dontFilter = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envToTibble_+3A_envs">envs</code></td>
<td>
<p><code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment.
Result from <code>babsim.hospital</code> simulation runs, e.g., output from <code><a href="#topic+babsimHospital">babsimHospital</a></code>.</p>
</td></tr>
<tr><td><code id="envToTibble_+3A_fieldevents">fieldEvents</code></td>
<td>
<p>Real values. Output from <code><a href="#topic+getRealBeds">getRealBeds</a></code>, i.e.,
a (nxm, 5)-dim data.frame with the following variables:
</p>

<dl>
<dt><code>resource</code></dt><dd><p>chr:  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code></dt><dd><p>int:  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt><code>med</code></dt><dd><p>int:   2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt><code>source</code></dt><dd><p>chr:  'GA' 'GA' 'GA' 'GA' ...</p>
</dd>
<dt><code>date</code></dt><dd><p> POSIXct, format: '2020-03-03 01:00:00' '2020-03-04 01:00:00' '2020-03-05 01:00:00' '2020-03-06 01:00:00' ...</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="envToTibble_+3A_conf">conf</code></td>
<td>
<p>list with the following entries (generated with <code><a href="#topic+babsimToolsConf">babsimToolsConf</a></code>):
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Change the <code>seed</code> value to get different output for the same
input parameters. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>max capacity of resources. Default: 1e6</p>
</dd>
<dt><code>dataset</code></dt><dd><p>char name of the data set. Default: 'GA'</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period that is used for the simulation (babsim, simmer). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>fieldDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period when real data is available (resource usage). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>simulationData</code></dt><dd><p>data frame. Data used for the simulation. Default:
<code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>data frame. Data used for the evaluation (error). Default:
<code><a href="#topic+GABeds220200624">GABeds220200624</a></code></p>
</dd>
<dt><code>resource</code></dt><dd><p>vector with resource names.
Default: c('bed', 'intensiveBed', 'intensiveBedVentilation')</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="envToTibble_+3A_dontfilter">dontFilter</code></td>
<td>
<p>do not filter by date (used in subsimulations)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> returns state changes in resources:
</p>

<ul>
<li><p>'resource': resources name
</p>
</li>
<li><p>'time': time instant of the event that triggered the state change
</p>
</li>
<li><p>'server': server count
</p>
</li>
<li><p>'queue': queue count
</p>
</li>
<li><p>'capacity': capacity
</p>
</li>
<li><p>'queue_size': queue size
</p>
</li>
<li><p>'system': system count (server + queue). If no queues are used, system values equal server values.
</p>
</li>
<li><p>'system_limit': system limit (capacity + queue_size)
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns an env data frame (tibble [nxm, 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+modelResultHospital">modelResultHospital</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- getSyntheticData()
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
conf &lt;- getConfFromData(
  conf = conf,
  simData = data$simData,
  fieldData = data$fieldData
)
arrivalTimes &lt;- getArrivalTimes(data$simData$Infected)
fieldEvents &lt;- getRealBeds(
  data = data$fieldData,
  resource = c("bed", "intensiveBed", "intensiveBedVentilation")
)
envs &lt;- babsimHospital(arrivalTimes = arrivalTimes, conf = conf, para = para)
res &lt;- envToTibble(envs = envs, conf = conf, fieldEvents = fieldEvents)
</code></pre>

<hr>
<h2 id='ex1InfectedDf'>ex1InfectedDf</h2><span id='topic+ex1InfectedDf'></span>

<h3>Description</h3>

<p>Data used in example 1 and for testing
A synthetic data set of COVID-19 cases with 99 obs. of  8 variables:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex1InfectedDf
</code></pre>


<h3>Format</h3>

<p>A data frame with 99 obs. of  8 variables:
</p>

<dl>
<dt>index</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
<dt>Infected</dt><dd><p>num  6 0 1 3 3 1 5 1 6 104 ...</p>
</dd>
<dt>Sick</dt><dd><p>num  6 6 7 10 13 14 19 20 26 130 ...</p>
</dd>
<dt>InfectedCum</dt><dd><p>num  6 6 7 10 13 14 19 20 26 130 ...</p>
</dd>
<dt>normalStation</dt><dd><p>num  1 1 1 1 2 2 3 3 4 18 ...</p>
</dd>
<dt>intensive</dt><dd><p>num  0 0 0 0 0 0 0 0 0 1 ...</p>
</dd>
<dt>ventilation</dt><dd><p>num  0 0 0 0 0 0 0 0 0 2 ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ex1InfectedDf
# first look
str(x)

# plot
x$InfCum &lt;- cumsum(x$Infected)
plot(x$Day, x$InfCum, type = "l", log = "y", ylim = c(1, 500))
lines(x$Day, x$Infected + 1e-6)
</code></pre>

<hr>
<h2 id='extendRki'>extendRki Erweiterung der RKI Daten</h2><span id='topic+extendRki'></span>

<h3>Description</h3>

<p>Combine existing data with synthetic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extendRki(
  data = getRkiData(babsim.hospital::rkidata),
  EndDate = max(data$Day) + 28,
  R0 = c(1, 1),
  tau = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extendRki_+3A_data">data</code></td>
<td>
<p>rki data, e.g., <code>getRkiData(babsim.hospital::rkidata)</code></p>
</td></tr>
<tr><td><code id="extendRki_+3A_enddate">EndDate</code></td>
<td>
<p>Ende (Tag), e.g., <code>'2020-05-04'</code></p>
</td></tr>
<tr><td><code id="extendRki_+3A_r0">R0</code></td>
<td>
<p>Basisreproduktionszahl. Constant, if a scalar value is given.
If a vector of two values are given, they will be interpreted as
a start and an end value, respectively. <code>c(1,2)</code> defines an increasing
<code>R0</code> value from <code>1</code> to <code>2</code>. Default: <code>1</code>, i.e., constant <code>1</code>.
Note: This is NOT exactly the same R0 value presented by the Robert-Koch Institute,
please refer to <a href="https://en.wikipedia.org/wiki/Basic_reproduction_number">https://en.wikipedia.org/wiki/Basic_reproduction_number</a>
for our implementation.</p>
</td></tr>
<tr><td><code id="extendRki_+3A_tau">tau</code></td>
<td>
<p>Ansteckungszeitraum in Tagen</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getRkiData">getRkiData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># take 10,000 data points only:
data &lt;- getRkiData(babsim.hospital::rkidata[1:10000, ])
# check whether enough data are provided
if (dim(data)[1] &gt; 1e6){
n &lt;- as.integer(max(data$Day) - min(data$Day))
StartDay &lt;- min(data$Day) + round(n * 0.995)
data &lt;- data[which(data$Day &gt;= StartDay), ]
EndDate &lt;- max(data$Day) + 2
dataExt &lt;- extendRki(
  data = data,
  EndDate = EndDate,
  R0 = c(0.1, 0.2)
)
}
</code></pre>

<hr>
<h2 id='extractSimulationResults'>Extract and summarize BaBSim results</h2><span id='topic+extractSimulationResults'></span>

<h3>Description</h3>

<p>Given a list of result environments returned by <code><a href="#topic+babsimHospital">babsimHospital</a></code>, extract and summarize resource usage for each day.
If the resource usage fluctuates during the day, the maximum usage is reported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractSimulationResults(envs, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractSimulationResults_+3A_envs">envs</code></td>
<td>
<p>List of simulation environments</p>
</td></tr>
<tr><td><code id="extractSimulationResults_+3A_conf">conf</code></td>
<td>
<p>Configuration for simulation runs in <code>envs</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.table</code> with columns
</p>

<dl>
<dt><code>date</code></dt><dd><p>Day on which the resource is required.</p>
</dd>
<dt><code>resource</code></dt><dd><p>The resource required.</p>
</dd>
<dt><code>replication</code></dt><dd><p>From which replication the result stems.</p>
</dd>
<dt><code>count</code></dt><dd><p>Number of units of <code>resource</code> in use.</p>
</dd>
</dl>


<hr>
<h2 id='fetchRkiCases'>Download German daily case summary from RKI</h2><span id='topic+fetchRkiCases'></span>

<h3>Description</h3>

<p>Download German daily case summary from RKI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetchRkiCases(dir = tempdir(), force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fetchRkiCases_+3A_dir">dir</code></td>
<td>
<p>[<code>character(1)</code>] <br /> 
directory where downloaded data is stored. Defaults to <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="fetchRkiCases_+3A_force">force</code></td>
<td>
<p>[<code>bool(1)</code>] <br />
if true, force download of data even if a previous download is found in <code>dir</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;BabsimCasesRki&rsquo;.
</p>


<h3>See Also</h3>


<ul>
<li><p><code><a href="#topic+GermanStates">GermanStates</a></code> for a list of German states and their state id.
</p>
</li>
<li><p><code><a href="#topic+GermanCounties">GermanCounties</a></code> for a list of German counties and theirs county id.
</p>
</li></ul>


<hr>
<h2 id='fitExponential'>Fit a exponential function to data.</h2><span id='topic+fitExponential'></span>

<h3>Description</h3>

<p>Fit the model $y = a e^bx$ to the provided data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitExponential(x, y, a0 = 0, b0 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitExponential_+3A_x">x</code></td>
<td>
<p>x data</p>
</td></tr>
<tr><td><code id="fitExponential_+3A_y">y</code></td>
<td>
<p>y data</p>
</td></tr>
<tr><td><code id="fitExponential_+3A_a0">a0</code></td>
<td>
<p>start value (default: 1)</p>
</td></tr>
<tr><td><code id="fitExponential_+3A_b0">b0</code></td>
<td>
<p>start value (default: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector of coefficients ('a', 'b')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age &lt;- c(2, 10, 25, 47, 70, 90)
risk &lt;- c(0.01, 0.07, 0.15, 0.65, 3, 12.64)
plot(age, risk)
ab &lt;- fitExponential(x = age, y = risk, a0 = 1, b0 = 0)
y &lt;- ab[1] * exp(ab[2] * age)
lines(age, y)
</code></pre>

<hr>
<h2 id='funBaBSimHospital'>Optimization of the BaBSim.Hospital Simulator</h2><span id='topic+funBaBSimHospital'></span>

<h3>Description</h3>

<p><code>funBaBSimHospital</code> implements an interface to the 
<code>babsim.hospital</code> package.
<code>babsim.hospital</code> is a discrete-event simulation model 
for a hospital resource planning problem.  
The project is motivated by the challenges faced by health care institutions in 
the COVID-19 pandemic. 
It can be used by health departments to forecast demand for intensive care beds, 
ventilators, and staff resources.
<code>funBaBSimHospital</code> provides an interface to <code><a href="#topic+getTrainTestObjFun">getTrainTestObjFun</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funBaBSimHospital(
  x,
  region = 5374,
  nCores = 2,
  verbosity = 0,
  rkiEndDate = "2020-12-09",
  icuEndDate = "2020-12-09",
  trainingWeeksSimulator = 10,
  trainingWeeksField = 6,
  totalRepeats = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funBaBSimHospital_+3A_x">x</code></td>
<td>
<p><code>matrix</code> of points to evaluate with the simulator. 
Rows for points and columns for dimension.</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_region">region</code></td>
<td>
<p><code>integer</code>. Represents the region code. Default: 5374 (Oberberg).</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_ncores">nCores</code></td>
<td>
<p><code>integer</code>. Defines the number of cores.</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_verbosity">verbosity</code></td>
<td>
<p><code>integer</code>. Handles output. Default: 0</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_rkienddate">rkiEndDate</code></td>
<td>
<p><code>characters</code>. Last day of rki data. Default <code>"2020-12-09"</code></p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_icuenddate">icuEndDate</code></td>
<td>
<p><code>characters</code>. Last day of icu data. Default <code>"2020-12-09"</code></p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_trainingweekssimulator">trainingWeeksSimulator</code></td>
<td>
<p><code>integer</code>. Training period using rki data. Default: 10. Should be larger than <code>trainingWeeksField</code>.</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_trainingweeksfield">trainingWeeksField</code></td>
<td>
<p><code>integer</code>. Training period using icu data. Default: 6. Should be smaller than <code>trainingWeeksSimulator</code>.</p>
</td></tr>
<tr><td><code id="funBaBSimHospital_+3A_totalrepeats">totalRepeats</code></td>
<td>
<p><code>integer</code>. Number of repeats for each configuration. Should be a multiple of <code>nCores</code>. Default: 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y <code>numeric</code> function value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
BABSIM_HOSPITAL &lt;- FALSE
if(BABSIM_HOSPITAL){
## babsim.hospital version must be greater equal 11.7:
ver &lt;-  unlist(packageVersion("babsim.hospital"))
if( ver[1] &gt;= 11 &amp; ver[2] &gt;= 7){
    x &lt;- matrix(as.numeric(babsim.hospital::getParaSet(5374)[1,-1]),1,)
    funBaBSimHospital(x)
}
}

</code></pre>

<hr>
<h2 id='funOptimizeSim'>funOptimizeSim</h2><span id='topic+funOptimizeSim'></span>

<h3>Description</h3>

<p>Interface function to evaluate one parameter configuration
from <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funOptimizeSim(x, conf, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funOptimizeSim_+3A_x">x</code></td>
<td>
<p>num:  real values. Will be interpreted as parameter values for <code><a href="#topic+babsimHospital">babsimHospital</a></code>.
Names of these parameters can be obtained via <code><a href="#topic+getParameterName">getParameterName</a></code>.</p>
</td></tr>
<tr><td><code id="funOptimizeSim_+3A_conf">conf</code></td>
<td>
<p>list with the following entries:
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="funOptimizeSim_+3A_data">data</code></td>
<td>
<p>list with simData and fieldData</p>
</td></tr>
<tr><td><code id="funOptimizeSim_+3A_...">...</code></td>
<td>
<p>additional variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a real value, that represents the combined rmse from the three beds
types.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- getStartParameter()
conf &lt;- babsimToolsConf()
data &lt;- getObkData()
err &lt;- funOptimizeSim(x = x, conf = conf, data = data)
</code></pre>

<hr>
<h2 id='funWrapOptimizeSim'>funWrapOptimizeSim</h2><span id='topic+funWrapOptimizeSim'></span>

<h3>Description</h3>

<p>Wrapper function for <code>funOptimizeSim</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funWrapOptimizeSim(x, conf, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funWrapOptimizeSim_+3A_x">x</code></td>
<td>
<p>num: real values. Will be interpreted as parameter values from <code>babsimHospital</code>.
Names of these parameters can be obtained via <code><a href="#topic+getParameterName">getParameterName</a></code>.</p>
</td></tr>
<tr><td><code id="funWrapOptimizeSim_+3A_conf">conf</code></td>
<td>
<p>list with the following entries:
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd>
</dl>

<p>For example: <code>conf &lt;- babsimToolsConf()</code></p>
</td></tr>
<tr><td><code id="funWrapOptimizeSim_+3A_data">data</code></td>
<td>
<p>list with simData and fieldData, e.g. <code>data &lt;- getObkData()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a  num [1, 1] matrix,
that represents the combined rmse from the three beds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para &lt;- getStartParameter()
conf &lt;- babsimToolsConf()
data &lt;- getObkData()
funWrapOptimizeSim(x = para, conf = conf, data = data)
</code></pre>

<hr>
<h2 id='GABeds220200624'>GABeds220200624 Intensivbetten: Daten vom 24.6.2020</h2><span id='topic+GABeds220200624'></span>

<h3>Description</h3>

<p>Betten Daten aggregiert
</p>
<p>Ein data.frame  mit 5 Variablen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GABeds220200624
</code></pre>


<h3>Format</h3>

<p>data.frame with 342 obs. of  5 variables:
</p>

<dl>
<dt>ressource</dt><dd><p>chr  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
</dl>


<hr>
<h2 id='GermanCounties'>List of German administrative counties</h2><span id='topic+GermanCounties'></span>

<h3>Description</h3>

<p>A dataset containing the names and AGS of all 401 German counties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GermanCounties
</code></pre>


<h3>Format</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with 401 rows and 3 variables:
</p>

<dl>
<dt><code>stateId</code></dt><dd><p>id of state containing this county.</p>
</dd>
<dt><code>countyId</code></dt><dd><p>unique id, first five digits of the German AGS.</p>
</dd>
<dt><code>county</code></dt><dd><p>name of county in German.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gemeindeverzeichnis-Informationssystem (GV-ISys) of the German Federal Statistics Office
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GermanStates">GermanStates</a></code> for German states.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- merge(GermanCounties, GermanStates, by="stateId")
subset(x, countyId == "05135") # Cologne, North Rhine-Westphalia

</code></pre>

<hr>
<h2 id='GermanStates'>List of German states</h2><span id='topic+GermanStates'></span>

<h3>Description</h3>

<p>A dataset containing all 16 German states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GermanStates
</code></pre>


<h3>Format</h3>

<p>A <code><a href="data.table.html#topic+data.table">data.table</a></code> with 16 rows an 2 variables:
</p>

<dl>
<dt><code>stateId</code></dt><dd><p>unique id, first two digits of the German AGS.</p>
</dd>
<dt><code>state</code></dt><dd><p>name of state in German.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gemeindeverzeichnis-Informationssystem (GV-ISys) of the German Federal Statistics Office
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GermanCounties">GermanCounties</a></code> for German counties.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(GermanStates)

</code></pre>

<hr>
<h2 id='getAndCheckTrainData'>Get and Check Train Data</h2><span id='topic+getAndCheckTrainData'></span>

<h3>Description</h3>

<p>Generate and check train data (start and end dates) from field and simulation
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAndCheckTrainData(
  simData,
  fieldData,
  tryOnTestSet = FALSE,
  TrainFieldStartDate,
  TestFieldStartDate,
  verbosity = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAndCheckTrainData_+3A_simdata">simData</code></td>
<td>
<p>simulation data, i.e., data used for the simulator, e.g. infections.</p>
</td></tr>
<tr><td><code id="getAndCheckTrainData_+3A_fielddata">fieldData</code></td>
<td>
<p>field data, i.e., real-world data.</p>
</td></tr>
<tr><td><code id="getAndCheckTrainData_+3A_tryontestset">tryOnTestSet</code></td>
<td>
<p>logical, default FALSE.</p>
</td></tr>
<tr><td><code id="getAndCheckTrainData_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start date of the train data set.</p>
</td></tr>
<tr><td><code id="getAndCheckTrainData_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>Start date of the test data set.</p>
</td></tr>
<tr><td><code id="getAndCheckTrainData_+3A_verbosity">verbosity</code></td>
<td>
<p>Default 0.
Only needed if <code>tryOnTestSet</code> is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>traindata, i.e., list of sim data and field data, checked train data set
</p>

<hr>
<h2 id='getArrivalTimes'>getArrivalTimes</h2><span id='topic+getArrivalTimes'></span>

<h3>Description</h3>

<p>Generate arrival times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getArrivalTimes(xDaily)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getArrivalTimes_+3A_xdaily">xDaily</code></td>
<td>
<p>Vector that contains the number of arrivals for each day.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a data frame of arrival times with the following entries:
</p>

<dl>
<dt><code>time</code> (num)</dt><dd><p>name of the seized resource</p>
</dd>
</dl>

<p>@seealso <code><a href="#topic+rkiToBabsimArrivals">rkiToBabsimArrivals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- dataCovidBeds20200624
arrivalTimes &lt;- getArrivalTimes(xDaily = x$Infected)
# For RKI data, use rkiToBabsimArrivals as follows:
arrivalTimes &lt;- rkiToBabsimArrivals(rki = babsim.hospital::rkidata)
</code></pre>

<hr>
<h2 id='getBestParameter'>Return the best parameter set found</h2><span id='topic+getBestParameter'></span>

<h3>Description</h3>

<p>Extract the best result from a data frame of optimization runs and return it as a valid Para list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBestParameter(para)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBestParameter_+3A_para">para</code></td>
<td>
<p>A data frame with columns 'y' and 'x.1' to 'x.27'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an env data frame (tibble [560 × 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+mapXToPara">mapXToPara</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getBestParameter(getParaSet(5374))
</code></pre>

<hr>
<h2 id='getBounds'>getBounds</h2><span id='topic+getBounds'></span>

<h3>Description</h3>

<p>Returns parameter bounds for babsim runs
(settings version &gt; v10.4.8)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBounds()
</code></pre>


<h3>Value</h3>

<p>This function returns a list of two vectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bounds &lt;- getBounds()
lower &lt;- bounds$lower
upper &lt;- bounds$upper
</code></pre>

<hr>
<h2 id='getConfFromData'>getConfFromData</h2><span id='topic+getConfFromData'></span>

<h3>Description</h3>

<p>Generate a configuration list for babsimTools based on the data file and the
vector of resources.
This function returns the default configuration settings of the babsimTools functions
used to run <code><a href="#topic+babsimHospital">babsimHospital</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getConfFromData(conf, simData, fieldData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getConfFromData_+3A_conf">conf</code></td>
<td>
<p>Configuration. Default: <code><a href="#topic+babsimToolsConf">babsimToolsConf</a></code></p>
</td></tr>
<tr><td><code id="getConfFromData_+3A_simdata">simData</code></td>
<td>
<p>Simulation data. Default: <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</td></tr>
<tr><td><code id="getConfFromData_+3A_fielddata">fieldData</code></td>
<td>
<p>Field (real) data. Default: <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Configuration <code>conf</code>  is a list of the following settings.
</p>

<dl>
<dt><code>seed</code></dt><dd><p>(int) Initial seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>(int) Number of <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation runs. Default: 1</p>
</dd>
<dt><code>parallel</code></dt><dd><p>(logical) Use parallel simulations based on <code><a href="parallel.html#topic+mclapply">mclapply</a></code>. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>(num) Percentage of cores used, if <code>parallel == TRUE</code>. Default: 0.5</p>
</dd>
<dt><code>ICU</code></dt><dd><p>(logical) Use ICU (RKI) data. Default: FALSE.</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>(int) 0 = no logging, &gt;= 1 logging. Default: 0. If larger than 10, shown detailed simmer output.</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>(num) Maximum capacity used for <code><a href="#topic+babsimHospital">babsimHospital</a></code> resources. Default: 1e6.</p>
</dd>
<dt><code>dataset</code></dt><dd><p>(chr)  'GA' or 'ICU'. Default: 'GA'.</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the simulation data (infection data used to generate
arrival times), first day. Default: '2020-03-03'</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the simulation data, last day. Default: '2020-06-24'</p>
</dd>
</dl>
</dd>
<dt><code>fieldDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the field (resources)  data, first day. Default: '2020-03-03'</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the field data, last day. Default: '2020-06-24'</p>
</dd>
</dl>
</dd>
<dt><code>simulationData</code></dt><dd><p>(data frame) Data used for the simulation. Default <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code>
</p>

<dl>
<dt>bed</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>intensiveBed</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
<dt>Infected</dt><dd><p>num  5 0 0 0 0 0 0 7 2 5 ...</p>
</dd>
<dt>Sick</dt><dd><p>num  5 5 5 5 5 5 5 12 14 19 ...</p>
</dd>
</dl>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>(data frame) Data used for evalution of the simulation. Default <code><a href="#topic+GABeds220200624">GABeds220200624</a></code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
</dl>
</dd>
<dt><code>resource</code></dt><dd><p>(vector) Resources used in the simulation.
Default: <code>c('bed', 'intensiveBed', 'intensiveBedVentilation')</code>. For ICU data use:
<code>c('bed', 'intensiveBedVentilation')</code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
</dl>
</dd>
</dl>



<h3>Value</h3>

<p>a list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
conf &lt;- babsimToolsConf()
simData &lt;- babsim.hospital::dataCovidBeds20200624
fieldData &lt;- babsim.hospital::dataCovidBeds20200624
conf &lt;- getConfFromData(
  conf = conf,
  simData = simData,
  fieldData = fieldData
)
# turn on parallel simulation:
conf$parallel &lt;- TRUE
# Change the start date of the simulations
conf$simulationDates$StartDate &lt;- "2020-01-01"
</code></pre>

<hr>
<h2 id='getDailyMaxResults'>getDailyMaxResults</h2><span id='topic+getDailyMaxResults'></span>

<h3>Description</h3>

<p>Combine babsim simulation results with real (field) data. Use daily max resources.
Input: <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment and field data formatted
using <code><a href="#topic+getRealBeds">getRealBeds</a></code>. The formatted filed date has dim (nxm, 5), the output data
has dimension (nxm, 15).
The method <code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> function is used to extract information from
the <code>babsim.hospital</code> simulation.
The function is used by <code><a href="#topic+modelResultHospital">modelResultHospital</a></code> to prepare the calculation of the error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDailyMaxResults(envs, fieldEvents, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDailyMaxResults_+3A_envs">envs</code></td>
<td>
<p><code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment.
Result from <code>babsim.hospital</code> simulation runs, e.g., output from <code><a href="#topic+babsimHospital">babsimHospital</a></code>.</p>
</td></tr>
<tr><td><code id="getDailyMaxResults_+3A_fieldevents">fieldEvents</code></td>
<td>
<p>Real values. Output from <code><a href="#topic+getRealBeds">getRealBeds</a></code>, i.e.,
a (nxm, 5)-dim data.frame with the following variables:
</p>

<dl>
<dt><code>resource</code></dt><dd><p>chr:  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code></dt><dd><p>int:  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt><code>med</code></dt><dd><p>int:   2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt><code>source</code></dt><dd><p>chr:  'GA' 'GA' 'GA' 'GA' ...</p>
</dd>
<dt><code>date</code></dt><dd><p> POSIXct, format: '2020-03-03 01:00:00' '2020-03-04 01:00:00' '2020-03-05 01:00:00' '2020-03-06 01:00:00' ...</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="getDailyMaxResults_+3A_conf">conf</code></td>
<td>
<p>list with the following entries (generated with <code><a href="#topic+babsimToolsConf">babsimToolsConf</a></code>):
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Change the <code>seed</code> value to get different output for the same
input parameters. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>max capacity of resources. Default: 1e6</p>
</dd>
<dt><code>dataset</code></dt><dd><p>char name of the data set. Default: 'GA'</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period that is used for the simulation (babsim, simmer). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>fieldDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period when real data is available (resource usage). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>simulationData</code></dt><dd><p>data frame. Data used for the simulation. Default:
<code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>data frame. Data used for the evaluation (error). Default:
<code><a href="#topic+GABeds220200624">GABeds220200624</a></code></p>
</dd>
<dt><code>resource</code></dt><dd><p>vector with resource names.
Default: c('bed', 'intensiveBed', 'intensiveBedVentilation')</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> returns state changes in resources:
</p>

<ul>
<li><p>'resource': resources name
</p>
</li>
<li><p>'time': time instant of the event that triggered the state change
</p>
</li>
<li><p>'server': server count
</p>
</li>
<li><p>'queue': queue count
</p>
</li>
<li><p>'capacity': capacity
</p>
</li>
<li><p>'queue_size': queue size
</p>
</li>
<li><p>'system': system count (server + queue). If no queues are used, system values equal server values.
</p>
</li>
<li><p>'system_limit': system limit (capacity + queue_size)
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns an env data frame (tibble [nxm, 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+modelResultHospital">modelResultHospital</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- getSyntheticData()
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
conf &lt;- getConfFromData(
  conf = conf,
  simData = data$simData,
  fieldData = data$fieldData
)
arrivalTimes &lt;- getArrivalTimes(data$simData$Infected)
envs &lt;- babsimHospital(arrivalTimes = arrivalTimes, conf = conf, para = para)
fieldEvents &lt;- getRealBeds(
  data = data$fieldData,
  resource = c("bed", "intensiveBed", "intensiveBedVentilation")
)
res &lt;- getDailyMaxResults(envs = envs, fieldEvents = fieldEvents, conf = conf)
</code></pre>

<hr>
<h2 id='getDecision'>getDecision</h2><span id='topic+getDecision'></span>

<h3>Description</h3>

<p>For given n probabilities 0 &lt;= pi &lt;= 1 with sum(pi)=1,
return 0,1,2,3,..,n with probability p0, p1, p2, ..., pn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDecision(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDecision_+3A_p">p</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>int decision in the range from 0 to n
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- c(0.6, 0.3, 0.1)
getDecision(p)
</code></pre>

<hr>
<h2 id='getDiviLinks'>Retrieve links to all DIVI day reports.</h2><span id='topic+getDiviLinks'></span>

<h3>Description</h3>

<p>Retrieve links to all DIVI day reports.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDiviLinks()
</code></pre>


<h3>Value</h3>

<p>List of download URLs to the daily reports.
</p>

<hr>
<h2 id='getError'>getError</h2><span id='topic+getError'></span>

<h3>Description</h3>

<p>Determine error from babsim runs.
This error is the sum of the RMSE values for bed, intensiveBed, and intensiveBedVentilation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getError(res, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getError_+3A_res">res</code></td>
<td>
<p>Results from <code>getDailyMaxResults</code>.</p>
</td></tr>
<tr><td><code id="getError_+3A_conf">conf</code></td>
<td>
<p>configuration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a num value, that represents the combined rmse from the beds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
data &lt;- getObkData()
set.seed(conf$seed)
para &lt;- checkSimPara(para)
arrivalTimes &lt;- getArrivalTimes(data$simData$Infected)
envs &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = para
)
fieldEvents &lt;- getRealBeds(
  data = data$fieldData,
  resource = conf$ResourceNames
)
res &lt;- getDailyMaxResults(
  envs = envs,
  fieldEvents = fieldEvents,
  conf = conf
)
err &lt;- getError(res, conf = conf)
</code></pre>

<hr>
<h2 id='getIcuBeds'>getIcuBeds</h2><span id='topic+getIcuBeds'></span>

<h3>Description</h3>

<p>Convert the 9 dim DIVI ICU data (bundesland,gemeindeschluessel,..., daten_stand)
into a data.frame with bed, intensiveBedVentilation, and Day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getIcuBeds(data = babsim.hospital::icudata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getIcuBeds_+3A_data">data</code></td>
<td>
<p>data.frame with obs. of  9 variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with observations of 3 variables:
</p>

<dl>
<dt>intensiveBed</dt><dd><p>int COVID-19 ICU beds without ventilation</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  COVID-19 ICU beds with ventilation</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-05-01' '2020-05-02' '2020-05-03' '2020-05-04' ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
IcuBeds &lt;- getIcuBeds(data = icudata)
</code></pre>

<hr>
<h2 id='getInfectedPerDay'>getInfectedPerDay</h2><span id='topic+getInfectedPerDay'></span>

<h3>Description</h3>

<p>Generate Poisson distributed infections.
This function calculates <code>n</code>, the number of days between <code>StartDate</code>
and <code>EndDate</code>, and returns a vector with <code>n</code> realizations of a
Poisson(lambda) distributed random variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInfectedPerDay(lambda = 4, StartDate = "2020-03-03", EndDate = "2020-06-24")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInfectedPerDay_+3A_lambda">lambda</code></td>
<td>
<p>Expected number of infections/day.</p>
</td></tr>
<tr><td><code id="getInfectedPerDay_+3A_startdate">StartDate</code></td>
<td>
<p>Day, simulation starts</p>
</td></tr>
<tr><td><code id="getInfectedPerDay_+3A_enddate">EndDate</code></td>
<td>
<p>Day, simulation ends</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector that lists the number of infections.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>StartDate &lt;- "2020-03-03"
EndDate &lt;- "2020-06-24"
getInfectedPerDay(lambda = 4, StartDate = StartDate, EndDate = EndDate)
</code></pre>

<hr>
<h2 id='getMatrixD'>getMatrixD</h2><span id='topic+getMatrixD'></span>

<h3>Description</h3>

<p>Builds the duration matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMatrixD(para = babsimHospitalPara())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMatrixD_+3A_para">para</code></td>
<td>
<p>parameter vector, e.g., generated via
<code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>. Default: <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with transition durations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getMatrixD()
</code></pre>

<hr>
<h2 id='getMatrixP'>getMatrixP</h2><span id='topic+getMatrixP'></span>

<h3>Description</h3>

<p>Builds the probability matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMatrixP(para = babsimHospitalPara())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMatrixP_+3A_para">para</code></td>
<td>
<p>parameter vector, e.g., generated via
<code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>. Default: <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with transition probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getMatrixP()
</code></pre>

<hr>
<h2 id='getObkData'>getObkData</h2><span id='topic+getObkData'></span>

<h3>Description</h3>

<p>Generate simData and fieldData from OBK data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getObkData(data = babsim.hospital::dataCovidBeds20200624)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getObkData_+3A_data">data</code></td>
<td>
<p>OBK data. Default: <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with simData and fieldData
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- getObkData()
</code></pre>

<hr>
<h2 id='getParameterDataFrame'>getParameterDataFrame</h2><span id='topic+getParameterDataFrame'></span>

<h3>Description</h3>

<p>Get parameterss (probabilities and durations) of the
babsim.hospital simulator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParameterDataFrame(
  paraList = list(obk = getParaSet(5374), koeln = getParaSet(5315))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getParameterDataFrame_+3A_paralist">paraList</code></td>
<td>
<p>list of parameter values.
Each list element has the form <code>obk=getParaSet(5374)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with parameters in each column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- getParameterDataFrame()
</code></pre>

<hr>
<h2 id='getParameterName'>getParameterName</h2><span id='topic+getParameterName'></span>

<h3>Description</h3>

<p>Returns the name (chr) of the babsim <code>x</code> parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParameterName(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getParameterName_+3A_n">n</code></td>
<td>
<p>int: position</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a  character value, which represents
the name of the n-th <code>x</code> variable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getParameterName(16)
</code></pre>

<hr>
<h2 id='getParameterNameList'>getParameterNameList</h2><span id='topic+getParameterNameList'></span>

<h3>Description</h3>

<p>Returns the names (chr) of the babsim <code>x</code> parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParameterNameList(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getParameterNameList_+3A_x">x</code></td>
<td>
<p>vector of int: positions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector. Its elements represent
the names of the n-th <code>x</code> variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getParameterNameList(c(16, 18))
</code></pre>

<hr>
<h2 id='getParaSet'>getParaSet</h2><span id='topic+getParaSet'></span>

<h3>Description</h3>

<p>Load a specific parameter set by region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParaSet(region)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getParaSet_+3A_region">region</code></td>
<td>
<p>integer, the region id</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame parameters of that specific region
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getParaSet(5315)
</code></pre>

<hr>
<h2 id='getPeakVec'>getPeakVec</h2><span id='topic+getPeakVec'></span>

<h3>Description</h3>

<p>Generate peak values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPeakVec(
  peakData = c(10, 100),
  StartDate = "2020-03-03",
  EndDate = "2020-06-24"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPeakVec_+3A_peakdata">peakData</code></td>
<td>
<p>Vector of time steps and peak heights.</p>
</td></tr>
<tr><td><code id="getPeakVec_+3A_startdate">StartDate</code></td>
<td>
<p>Day, simulation starts.</p>
</td></tr>
<tr><td><code id="getPeakVec_+3A_enddate">EndDate</code></td>
<td>
<p>Day, simulation ends.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a vector of peaks data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getPeakVec()
</code></pre>

<hr>
<h2 id='getRealBeds'>getRealBeds</h2><span id='topic+getRealBeds'></span>

<h3>Description</h3>

<p>Convert daily data, e.g., a data.frame with the columns
<code>bed, intensiveBedVentilation, Day</code>
into event data, e.g., a data.frame with the following columns
<code>resource, time,  med, source, date</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRealBeds(data, resource)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRealBeds_+3A_data">data</code></td>
<td>
<p>(n, m) data frame with daily bed data, e.g.,
from <code><a href="#topic+icudata">icudata</a></code></p>
</td></tr>
<tr><td><code id="getRealBeds_+3A_resource">resource</code></td>
<td>
<p>vector of resource names, e.g., 'bed'. Default:
<code>resource=c('bed', 'intensiveBedVentilation')</code>. For GA data use:
<code>resource=c('bed', 'intensiveBed', 'intensiveBedVentilation')</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prepares data for combination with output (env)
from <a href="simmer.html#topic+simmer">simmer</a>.
Extracts and formats real data from the real data sets, e.g.,
<code>icudata</code>.
The resulting data frame can be combined with
the output from the simulation run.
Can be used to add the true data (ground truth) to the simulated data.
</p>


<h3>Value</h3>

<p>This function returns a (n x m, 5) data frame with:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource</p>
</dd>
<dt><code>time</code> (int)</dt><dd><p>time step, starts with <code>1</code></p>
</dd>
<dt><code>med</code> (int)</dt><dd><p>amount of the seized resource</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used</p>
</dd>
<dt><code>date</code> (Date)</dt><dd><p>time, format: <code>yyyy-mm-dd</code></p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+getIcuBeds">getIcuBeds</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># First example shows how to process the GA data
GABeds &lt;- getRealBeds(
  data = babsim.hospital::dataCovidBeds20200624,
  resource = c("bed", "intensiveBed", "intensiveBedVentilation")
)

# Second example shows how to process the DIVI ICU data.
icu &lt;- babsim.hospital::icudata
icuCov &lt;- as.data.frame(xtabs(faelle_covid_aktuell ~ daten_stand, icu))
icuCov$daten_stand &lt;- as.Date(icuCov$daten_stand)
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBeatm$daten_stand &lt;- as.Date(icuCovBeatm$daten_stand)
Day &lt;- as.Date(icuCovBeatm$daten_stand)
dataICUBeds20200821 &lt;- data.frame(
  bed = (icuCov$Freq - icuCovBeatm$Freq),
  intensiveBedVentilation = icuCovBeatm$Freq,
  Day = as.Date(icuCovBeatm$daten_stand)
)
ICUBeds &lt;- getRealBeds(
  data = dataICUBeds20200821,
  resource = c("bed", "intensiveBedVentilation")
)
</code></pre>

<hr>
<h2 id='getRegionIcu'>getRegionIcu Auswahl der ICU Daten fuer eine Region</h2><span id='topic+getRegionIcu'></span>

<h3>Description</h3>

<p>Auswahl anhand der Bundeslaender, Landkreis IDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRegionIcu(data = babsim.hospital::icudata, region = 5315)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRegionIcu_+3A_data">data</code></td>
<td>
<p>Daten, z.B. icudata</p>
</td></tr>
<tr><td><code id="getRegionIcu_+3A_region">region</code></td>
<td>
<p>Id der Region, <code>0</code> Deutschland</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- getRegionIcu(babsim.hospital::icudata, 5315)
</code></pre>

<hr>
<h2 id='getRegionRki'>getRegionRki Auswahl der RKI Daten fuer eine Region</h2><span id='topic+getRegionRki'></span>

<h3>Description</h3>

<p>Auswahl anhand der Bundeslaender, Landkreis IDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRegionRki(data = babsim.hospital::rkidata, region)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRegionRki_+3A_data">data</code></td>
<td>
<p>Daten, z.B. rkidata</p>
</td></tr>
<tr><td><code id="getRegionRki_+3A_region">region</code></td>
<td>
<p>Id der Region, <code>0</code> Deutschland</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- getRegionRki(
  data = babsim.hospital::rkidata[1:1000, ],
  region = 0
)
</code></pre>

<hr>
<h2 id='getRkiData'>getRkiData</h2><span id='topic+getRkiData'></span>

<h3>Description</h3>

<p>Transforms the freshly downloaded rki data into the babsim data frame.
Also imputes mising dates as zero frequency in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRkiData(rki)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRkiData_+3A_rki">rki</code></td>
<td>
<p>data.frame of downloaded rki data before preprocessing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame of aggregated data
</p>

<dl>
<dt><code>Day</code></dt><dd><p>Date, format: '2020-01-01' '2020-01-02' '2020-01-03' '2020-01-04' ...</p>
</dd>
<dt><code>...</code></dt><dd><p> ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- getRkiData(rkidata[1:100, ])
</code></pre>

<hr>
<h2 id='getRkiRisk'>getRkiRisk</h2><span id='topic+getRkiRisk'></span>

<h3>Description</h3>

<p>Calculate risk for RKI data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRkiRisk(rki, para)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRkiRisk_+3A_rki">rki</code></td>
<td>
<p>data.frame of downloaded rki data</p>
</td></tr>
<tr><td><code id="getRkiRisk_+3A_para">para</code></td>
<td>
<p>parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rki &lt;- getRkiData(rkidata[1:10, ])
para &lt;- babsimHospitalPara()
# get risk for the first 10 entries:
rkiWithRisk &lt;- getRkiRisk(rki = rki, para)
</code></pre>

<hr>
<h2 id='getStartParameter'>getStartParameter</h2><span id='topic+getStartParameter'></span>

<h3>Description</h3>

<p>Returns parameter for babsim runs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStartParameter(para = babsimHospitalPara(), region = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getStartParameter_+3A_para">para</code></td>
<td>
<p>parameter vector, e.g., generated via
<code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>. Default: <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code></p>
</td></tr>
<tr><td><code id="getStartParameter_+3A_region">region</code></td>
<td>
<p>(int) use region specific start parameter, e.g., <code>5374</code> for OBK.
If <code>region</code> is negative (default), a generic start parameter is chosen.
The selection is based on the obkpara, koelnpara, and nrwpara parameter values,
which are the best known values found so far.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a (1,n) dim matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para &lt;- getStartParameter(region = 5374)
</code></pre>

<hr>
<h2 id='getSyntheticData'>getSyntheticData</h2><span id='topic+getSyntheticData'></span>

<h3>Description</h3>

<p>Generate synthetic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSyntheticData(
  StartDate = "2020-09-01",
  EndDate = "2020-11-30",
  lambda = 4,
  peakData = c(21, 50, 28, 40, 42, 50),
  amntDaysSickness = 20,
  hospitalizationRates = list(rBed = 0.1347, rIntensiveBed = 0.004,
    rIntensiveBedVentilation = 0.0171)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSyntheticData_+3A_startdate">StartDate</code></td>
<td>
<p>Start date. Default: <code>'2020-09-01'</code></p>
</td></tr>
<tr><td><code id="getSyntheticData_+3A_enddate">EndDate</code></td>
<td>
<p>Start date. Default: <code>'2020-11-30'</code></p>
</td></tr>
<tr><td><code id="getSyntheticData_+3A_lambda">lambda</code></td>
<td>
<p>Average number of daily infections. Default: 4</p>
</td></tr>
<tr><td><code id="getSyntheticData_+3A_peakdata">peakData</code></td>
<td>
<p>Vector to define peak events. Odd entries represent days,
even entries the number of infections. Default: <code>c(21,50, 28,40, 42,50)</code>,
i.e., after 21 days 50 additional infections, after 28 days 40 additional infections,
and after 42 days 50 addditional infections to the base infection rate per day,
which is defined by <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="getSyntheticData_+3A_amntdayssickness">amntDaysSickness</code></td>
<td>
<p>Length (in days) of the interval that is used to determine
the number of infected individuals that have to go to the hospital. Based on this
interval, the number of sick individuals is determined. The number of sick individuals
is multiplied by the hospitalization rate to determine the number of bed. Default: 20</p>
</td></tr>
<tr><td><code id="getSyntheticData_+3A_hospitalizationrates">hospitalizationRates</code></td>
<td>
<p>list of hospitalization rates, i.e., percentage
of sick individuals that need a <code>bed</code>, or an <code>intensiveBed</code>, or
an <code>intensiveBedVentilation</code>. Default: <code>list(rBed = 0.1347,
rIntensiveBed = 0.004,  rIntensiveBedVentilation = 0.0171)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with the following entries:
bed=bed,
intensiveBed = intensiveBed,
intensiveBedVentilation = intensiveBedVentilation,
Day = Day,
Infected=Infected,
Sick = Sick)
</p>

<dl>
<dt><code>bed</code></dt><dd><p>int: COVID-19 beds</p>
</dd>
<dt><code>intensiveBed</code></dt><dd><p>int: COVID-19 ICU beds</p>
</dd>
<dt><code>intensiveBedVentilation</code></dt><dd><p>int  COVID-19 ICU beds with ventilation</p>
</dd>
<dt><code>Day</code></dt><dd><p>Date, format: '2020-05-01' '2020-05-02' '2020-05-03' '2020-05-04' ...</p>
</dd>
<dt><code>Infected</code></dt><dd><p>int: number of infected individuals (daily)</p>
</dd>
<dt><code>Sick</code></dt><dd><p>int: number of sick individuals (daily)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
dataSynth &lt;- getSyntheticData()
</code></pre>

<hr>
<h2 id='getTestData'>Get Test Data</h2><span id='topic+getTestData'></span>

<h3>Description</h3>

<p>Generate test data for final evaluation of one optimization run
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTestData(fieldData, simData, TestFieldStartDate, TestSimStartDate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTestData_+3A_fielddata">fieldData</code></td>
<td>
<p>field data</p>
</td></tr>
<tr><td><code id="getTestData_+3A_simdata">simData</code></td>
<td>
<p>sim data</p>
</td></tr>
<tr><td><code id="getTestData_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>start date</p>
</td></tr>
<tr><td><code id="getTestData_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>start date</p>
</td></tr>
</table>


<h3>Value</h3>

<p>testData test data
</p>

<hr>
<h2 id='getTrainTestObjFun'>getTrainTestObjFun</h2><span id='topic+getTrainTestObjFun'></span>

<h3>Description</h3>

<p>Generate objective functions (one for train, optionally one for test)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTrainTestObjFun(
  rkiwerte = babsim.hospital::rkidata,
  icuwerte = babsim.hospital::icudata,
  region = 5374,
  TrainSimStartDate = Sys.Date() - 12 * 7,
  TrainFieldStartDate = Sys.Date() - 8 * 7,
  TestSimStartDate = Sys.Date() - 8 * 7,
  TestFieldStartDate = Sys.Date() - 4 * 7,
  verbosity = 0,
  parallel = FALSE,
  percCores = NULL,
  icu = TRUE,
  icuWeights = c(1, 1),
  resourceNames = c("intensiveBed", "intensiveBedVentilation"),
  resourceEval = c("intensiveBed", "intensiveBedVentilation"),
  tryOnTestSet = FALSE,
  simRepeats = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTrainTestObjFun_+3A_rkiwerte">rkiwerte</code></td>
<td>
<p>RKI Daten</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_icuwerte">icuwerte</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> fuer OBK, <code>5315</code> fuer Koeln,
<code>0</code> fuer Deutschland,
oder Bundesland ID, e.g., <code>5</code> fuer NRW.</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_trainsimstartdate">TrainSimStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-06-01'</code></p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>'2020-05-01'</code> for test simulation data,
TestSimStartDate is usually before TestFieldStartDate</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>'2020-06-01'</code> for test field data</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_verbosity">verbosity</code></td>
<td>
<p>verbosity (int). Default: <code>0</code></p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_parallel">parallel</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_perccores">percCores</code></td>
<td>
<p>percentage</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_icu">icu</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_icuweights">icuWeights</code></td>
<td>
<p>Gewichtung der ICU Betten</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_resourcenames">resourceNames</code></td>
<td>
<p>Name der Ressourcen</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_resourceeval">resourceEval</code></td>
<td>
<p>Name der zu evaluierenden Ressourcen</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_tryontestset">tryOnTestSet</code></td>
<td>
<p>Should results be tested on a separate test set?. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="getTrainTestObjFun_+3A_simrepeats">simRepeats</code></td>
<td>
<p>Number of simulation repeats on each kernel (only on unix-like machines, ignored on Win systems). Default: 1</p>
</td></tr>
</table>

<hr>
<h2 id='ggVisualizeIcu'>ggVisualizeIcu Visualisierung der ICU Daten</h2><span id='topic+ggVisualizeIcu'></span>

<h3>Description</h3>

<p>Quelle: ICU Daten bundesweit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeIcu(data = babsim.hospital::icudata, region = 5315)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeIcu_+3A_data">data</code></td>
<td>
<p>icu data, e.g., <code><a href="#topic+icudata">icudata</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeIcu_+3A_region">region</code></td>
<td>
<p>Region: Gemeindeschluessel, <code>int 05374</code> fuer OBK oder
|code05315 fuer Koeln oder <code>05911</code> fuer Bochum.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>data.frame of 9 variables
</p>

<dl>
<dt>bundesland</dt><dd><p> int  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt>gemeindeschluessel</dt><dd><p> int  1001 1002 1003 1004 1051 1053 1054 1055 1056 1057 ...</p>
</dd>
<dt>anzahl_meldebereiche</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>faelle_covid_aktuell</dt><dd><p> int  0 3 5 1 3 1 0 0 5 1 ...</p>
</dd>
<dt>faelle_covid_aktuell_beatmet</dt><dd><p> int  0 2 5 1 1 1 0 0 4 0 ...</p>
</dd>
<dt>anzahl_standorte</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>betten_frei</dt><dd><p> int  44 113 115 19 54 7 7 18 10 7 ...</p>
</dd>
<dt>betten_belegt</dt><dd><p> int  38 110 108 19 26 17 3 34 27 5 ...</p>
</dd>
<dt>daten_stand</dt><dd><p>Date, format: &quot;2020-05-01&quot; &quot;2020-05-01&quot; &quot;2020-05-01&quot; &quot;2020-05-01&quot; ... &quot;2020-08-21&quot;</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+icudata">icudata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("stats")
icu &lt;- babsim.hospital::icudata
icuCov &lt;- as.data.frame(xtabs(faelle_covid_aktuell ~ daten_stand, icu))
icuCov$daten_stand &lt;- as.Date(icuCov$daten_stand)
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBeatm$daten_stand &lt;- as.Date(icuCovBeatm$daten_stand)
dataICUBeds &lt;- data.frame(
  bed = (icuCov$Freq - icuCovBeatm$Freq),
  intensiveBedVentilation = icuCovBeatm$Freq,
  Day = as.Date(icuCovBeatm$daten_stand)
)

require("padr")
require("stats")
require("slider")

icu &lt;- babsim.hospital::icudata
icu &lt;- pad(icu, interval = "day")
icuCov &lt;- as.data.frame(xtabs(faelle_covid_aktuell ~ daten_stand, icu))
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBett &lt;- as.data.frame(xtabs(betten_belegt ~ daten_stand, icu))
plot(icuCov$daten_stand, icuCov$Freq,
  type = "p", xlab = "Tag", ylab = "COVID ",
  main = "COVID-Faelle in Behandlung im KHaus"
)
plot(icuCovBeatm$daten_stand, icuCovBeatm$Freq,
  type = "p", xlab = "Tag",
  ylab = "Patienten", main = "Beatmete COVID-19-Pat. nur invasive Beatmung und ECMO"
)
plot(icuCovBett$daten_stand, icuCovBett$Freq, type = "l", xlab = "Tag", ylab = "ICU Betten belegt")

# Nur Daten des OBK:
icu &lt;- babsim.hospital::icudata
icu &lt;- icu[icu$gemeindeschluessel == 05374, ]
</code></pre>

<hr>
<h2 id='ggVisualizeRki'>ggVisualizeRki ggPlot Visualisierung der RKI Daten</h2><span id='topic+ggVisualizeRki'></span>

<h3>Description</h3>

<p>Quelle: RKI Daten bundesweit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeRki(
  data = babsim.hospital::rkidata,
  region = 5374,
  StartDate = "2020-05-01"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeRki_+3A_data">data</code></td>
<td>
<p>rki data, e.g., <code><a href="#topic+rkidata">rkidata</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeRki_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="ggVisualizeRki_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rkidata">rkidata</a></code>
</p>

<hr>
<h2 id='ggVisualizeRkiAge'>ggVisualizeRkiAge Visualisation of the pre-processed RKI Data with
respect to age and gender</h2><span id='topic+ggVisualizeRkiAge'></span>

<h3>Description</h3>

<p>ggplot RKI data as result from <code>getRkiData(babsim.hospital::rkidata)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeRkiAge(
  data = babsim.hospital::rkidata,
  region = 5374,
  StartDate = "2020-10-01",
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeRkiAge_+3A_data">data</code></td>
<td>
<p>rki data as preprocessed by <code><a href="#topic+rkiToBabsimData">rkiToBabsimData</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiAge_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="ggVisualizeRkiAge_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiAge_+3A_simplify">simplify</code></td>
<td>
<p>logical. Simplify presentation, Default: TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rkiToBabsimData">rkiToBabsimData</a></code>
</p>

<hr>
<h2 id='ggVisualizeRkiEvents'>ggVisualizeRkiEvents Visualisation of the pre-processed RKI Data</h2><span id='topic+ggVisualizeRkiEvents'></span>

<h3>Description</h3>

<p>ggplot RKI data as result from <code>getRkiData(babsim.hospital::rkidata)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeRkiEvents(
  data = getRkiData(babsim.hospital::rkidata),
  region = 5374,
  StartDate = "2020-10-01"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeRkiEvents_+3A_data">data</code></td>
<td>
<p>rki data as preprocessed by <code><a href="#topic+getRkiData">getRkiData</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiEvents_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="ggVisualizeRkiEvents_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getRkiData">getRkiData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use 10000 data points only:
data &lt;- getRkiData(babsim.hospital::rkidata[1:10000, ])
p &lt;- ggVisualizeRkiEvents(data = data, region = 0, StartDate = "2020-10-01")
</code></pre>

<hr>
<h2 id='ggVisualizeRkiExtended'>ggVisualizeRkiExtended Visualisation of the extended RKI Data</h2><span id='topic+ggVisualizeRkiExtended'></span>

<h3>Description</h3>

<p>ggplot RKI data as result from <code><a href="#topic+extendRki">extendRki</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeRkiExtended(
  data = extendRki(),
  region = 5374,
  StartDate = "2020-10-01",
  simplify = TRUE,
  preloadedData = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeRkiExtended_+3A_data">data</code></td>
<td>
<p>rki data as preprocessed by <code><a href="#topic+extendRki">extendRki</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtended_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtended_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtended_+3A_simplify">simplify</code></td>
<td>
<p>logical. Simplify presentation, Default: TRUE.</p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtended_+3A_preloadeddata">preloadedData</code></td>
<td>
<p>optional way to pass the result of preloading.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rkidata">rkidata</a></code>
</p>

<hr>
<h2 id='ggVisualizeRkiExtendedDataCalculation'>Data precalculation for ggVisualizeRkiExtended</h2><span id='topic+ggVisualizeRkiExtendedDataCalculation'></span>

<h3>Description</h3>

<p>Data for ggplot RKI data as result from <code><a href="#topic+extendRki">extendRki</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggVisualizeRkiExtendedDataCalculation(
  data = extendRki(),
  region = 5374,
  StartDate = "2020-10-01",
  simplify = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggVisualizeRkiExtendedDataCalculation_+3A_data">data</code></td>
<td>
<p>rki data as preprocessed by <code><a href="#topic+extendRki">extendRki</a></code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtendedDataCalculation_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtendedDataCalculation_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
<tr><td><code id="ggVisualizeRkiExtendedDataCalculation_+3A_simplify">simplify</code></td>
<td>
<p>logical. Simplify presentation, Default: TRUE.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rkidata">rkidata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- getRkiData(babsim.hospital::rkidata[1:10000, ])
# data size sufficient?: 
if (dim(data)[1]&gt; 1e6){
p &lt;- ggVisualizeRkiExtended(
  data = extendRki(data),
  region = 5374, StartDate = "2020-10-01"
)
}
</code></pre>

<hr>
<h2 id='icudata'>icudata IntensivbettenDaten (Beispieldatensatz)</h2><span id='topic+icudata'></span>

<h3>Description</h3>

<p>ICU Beispiel-Datensatz (nur für Demonstrationszwecke).
Der Beispieldatensatz <code>icudata</code> dient nur zu Demonstrationszwecken.
Er besitzt das gleiche Format wie Tagesreports des DIVI Intensivregisters, siehe
<code>https://www.divi.de/register/tagesreport</code>. 
Ziel des DIVI-Intensivregisters ist, 
die Verfügbarkeiten von Beatmungsbetten und von erweiterten Therapiemaßnahmen 
bei akutem Lungenversagen in Deutschland sichtbar zu machen. 
Eine weitere wissenschaftliche Nutzung der Daten ist nur mit Zustimmung der DIVI gestattet. 
Bitte kontaktieren Sie die wissenschaftliche Leitung des DIVI-Intensivregisters. 
Please contact DIVI e.V. if you are interested in the full data:
<code>https://www.divi.de/register/anprechpartner-register</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icudata
</code></pre>


<h3>Format</h3>

<p>data.frame of 9 variables
</p>

<dl>
<dt>bundesland</dt><dd><p> int  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt>gemeindeschluessel</dt><dd><p> int  1001 1002 1003 1004 1051 1053 1054 1055 1056 1057 ...</p>
</dd>
<dt>anzahl_meldebereiche</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>faelle_covid_aktuell</dt><dd><p> int  0 3 5 1 3 1 0 0 5 1 ...</p>
</dd>
<dt>faelle_covid_aktuell_beatmet</dt><dd><p> int  0 2 5 1 1 1 0 0 4 0 ...</p>
</dd>
<dt>anzahl_standorte</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>betten_frei</dt><dd><p> int  44 113 115 19 54 7 7 18 10 7 ...</p>
</dd>
<dt>betten_belegt</dt><dd><p> int  38 110 108 19 26 17 3 34 27 5 ...</p>
</dd>
<dt>daten_stand</dt><dd><p>Date, format: &quot;2020-05-01&quot; &quot;2020-05-01&quot; &quot;2020-05-01&quot; &quot;2020-05-01&quot; ... &quot;2020-08-21&quot;</p>
</dd>
</dl>



<h3>Details</h3>

<p>A sample of the ICU data
</p>

<hr>
<h2 id='koelnarchive'>koelnarchive archived koeln data</h2><span id='topic+koelnarchive'></span>

<h3>Description</h3>

<p>Data: koeln data generated with SPOT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koelnarchive
</code></pre>


<h3>Format</h3>

<p>'data.frame':  obs. of  28 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.33</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code><a href="#topic+runoptDirect">runoptDirect</a></code> run.
</p>

<hr>
<h2 id='mapAgeGroupToAge'>mapAgeGroupToAge</h2><span id='topic+mapAgeGroupToAge'></span>

<h3>Description</h3>

<p>Calculate real valued age based on RKI age classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapAgeGroupToAge(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapAgeGroupToAge_+3A_x">x</code></td>
<td>
<p>age vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>age as a real value
</p>

<hr>
<h2 id='mapAgeToAgeGroup'>mapAgeToAgeGroup</h2><span id='topic+mapAgeToAgeGroup'></span>

<h3>Description</h3>

<p>Calculate age based on RKI age classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapAgeToAgeGroup(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapAgeToAgeGroup_+3A_x">x</code></td>
<td>
<p>age vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>age class
</p>

<hr>
<h2 id='mapPToPara'>mapPToPara</h2><span id='topic+mapPToPara'></span>

<h3>Description</h3>

<p><code>mapPToPara</code> accepts
a nxn matrix. Its values will be mapped onto
the probability entries of a <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>
list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapPToPara(P = getMatrixP(), para)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapPToPara_+3A_p">P</code></td>
<td>
<p>(num) nxn-dim matrix. Values will be mapped onto the probabilities in
<code>babsimHospitalPara</code>.
Names of these parameters can be obtained via <code><a href="#topic+getParameterName">getParameterName</a></code>.</p>
</td></tr>
<tr><td><code id="mapPToPara_+3A_para">para</code></td>
<td>
<p>Parameter list, e.g., generated via <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a parameter list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para &lt;- babsimHospitalPara()
P &lt;- getMatrixP()
para &lt;- mapPToPara(
  P = P,
  para = para
)
</code></pre>

<hr>
<h2 id='mapXToPara'>mapXToPara</h2><span id='topic+mapXToPara'></span>

<h3>Description</h3>

<p><code>mapXToPara</code> accepts
a n-dim vector. Its values will be mapped onto a <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>
list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapXToPara(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapXToPara_+3A_x">x</code></td>
<td>
<p>(num) n-dim vector. Values will be mapped onto <code>babsimHospitalPara</code>.
Names of these parameters can be obtained via <code><a href="#topic+getParameterName">getParameterName</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will replaced hte function <code>simulateHospital</code> in versions &gt;=  1.2.8.
</p>


<h3>Value</h3>

<p>This function returns an env data frame (tibble [560 × 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rep(0.2, 29)
para &lt;- mapXToPara(x)
conf &lt;- babsimToolsConf()
data &lt;- getObkData()
res &lt;- modelResultHospital(para = para, conf = conf, data = data)
getError(res = res, conf = conf)
p &lt;- plotDailyMaxResults(res)
</code></pre>

<hr>
<h2 id='messageDateRange'>Display date range of a vector</h2><span id='topic+messageDateRange'></span>

<h3>Description</h3>

<p>Utility function to display the range of dates in a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>messageDateRange(prefix, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="messageDateRange_+3A_prefix">prefix</code></td>
<td>
<p>string to print before outputting range.</p>
</td></tr>
<tr><td><code id="messageDateRange_+3A_d">d</code></td>
<td>
<p>vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for the side effect.
</p>

<hr>
<h2 id='messagef'>Output a formatted message</h2><span id='topic+messagef'></span>

<h3>Description</h3>

<p>Output a formatted message
</p>


<h3>Usage</h3>

<pre><code class='language-R'>messagef(fmt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="messagef_+3A_fmt">fmt</code></td>
<td>
<p>format string (see <code><a href="base.html#topic+sprintf">sprintf</a></code> for details)</p>
</td></tr>
<tr><td><code id="messagef_+3A_...">...</code></td>
<td>
<p>values passed into <code>fmt</code>.
Only logical, integer, real and character vectors are supported, but some coercion will be done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for the side effect of outputting a message to the console.
</p>

<hr>
<h2 id='modelResultHospital'>modelResultHospital</h2><span id='topic+modelResultHospital'></span>

<h3>Description</h3>

<p>Simulate one parameter configuration from <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>. The simulation is by default
deterministic, because <code>conf$seed</code> is used for <code><a href="base.html#topic+set.seed">set.seed</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelResultHospital(para, conf, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelResultHospital_+3A_para">para</code></td>
<td>
<p>Simulation model parameters. The function <code><a href="#topic+babsimHospitalPara">babsimHospitalPara</a></code>
can be used to generate these parameters.</p>
</td></tr>
<tr><td><code id="modelResultHospital_+3A_conf">conf</code></td>
<td>
<p>list with the following entries:
</p>

<dl>
<dt><code>seed</code></dt><dd><p>seed. Change the <code>seed</code> value to get different output for the same
input parameters. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>simmer repeats</p>
</dd>
<dt><code>parallel</code></dt><dd><p>simmer parallel runs. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>percentage of cores used for parallel simmer simulations. Default: 0.5 (=50 percent)</p>
</dd>
<dt><code>ICU</code></dt><dd><p>use ICU infection data. Default: FALSE</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>log leved (0 or 1). Default: 0 (no output)</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>max capacity of resources. Default: 1e6</p>
</dd>
<dt><code>dataset</code></dt><dd><p>char name of the data set. Default: 'GA'</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period that is used for the simulation (babsim, simmer). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>fieldDates</code></dt><dd><p>list with <code>StartDate</code> and <code>EndDate</code>.
Period when real data is available (resource usage). Default:
<code>list(StartDate = '2020-03-03', EndDate = '2020-06-24')</code></p>
</dd>
<dt><code>simulationData</code></dt><dd><p>data frame. Data used for the simulation. Default:
<code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code></p>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>data frame. Data used for the evaluation (error). Default:
<code><a href="#topic+GABeds220200624">GABeds220200624</a></code></p>
</dd>
<dt><code>resource</code></dt><dd><p>vector with resource names.
Default: c('bed', 'intensiveBed', 'intensiveBedVentilation')</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="modelResultHospital_+3A_data">data</code></td>
<td>
<p>list with simData and fieldData</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns an env data frame (tibble [560 × 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>queue</code> (int)</dt><dd><p>1 1 2 3 4 3 4 1 0 2 ...</p>
</dd>
<dt><code>capacity</code> (num)</dt><dd><p>10000 10000 10000 10000 10000 10000 10000 10000 10000 10000 ...</p>
</dd>
<dt><code>queue_size</code> (num)</dt><dd><p>Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>system</code> (int)</dt><dd><p>1 1 2 3 4 3 4 1 0 2 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># First example: OBK data
data &lt;- getObkData()
para &lt;- babsimHospitalPara()
para$GammaShapeParameter &lt;- 0.8
# turn off parallelized simulation:
conf &lt;- babsimToolsConf()
conf &lt;- getConfFromData(
  conf = conf,
  simData = data$simData,
  fieldData = data$fieldData
)
# no logging (default)
conf$logLevel &lt;- 0
res &lt;- modelResultHospital(
  para = para,
  conf = conf,
  data = data
)

# Second example: synthetic data
data &lt;- getSyntheticData()
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
conf &lt;- getConfFromData(
  conf = conf,
  simData = data$simData,
  fieldData = data$fieldData
)
res &lt;- modelResultHospital(para = para, conf = conf, data = data)
</code></pre>

<hr>
<h2 id='nrwarchive'>nrwarchive archived nrw data</h2><span id='topic+nrwarchive'></span>

<h3>Description</h3>

<p>Data: nrw data generated with SPOT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nrwarchive
</code></pre>


<h3>Format</h3>

<p>'data.frame':  obs. of  28 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.33</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code><a href="#topic+runoptDirect">runoptDirect</a></code> run.
</p>

<hr>
<h2 id='obkarchive'>obkarchive archived obk data</h2><span id='topic+obkarchive'></span>

<h3>Description</h3>

<p>Data: OBK data generated with SPOT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obkarchive
</code></pre>


<h3>Format</h3>

<p>'data.frame':  obs. of  28 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.33</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code><a href="#topic+runoptDirect">runoptDirect</a></code> run.
to extract the best parameter set x.
</p>

<hr>
<h2 id='paras'>paras data</h2><span id='topic+paras'></span>

<h3>Description</h3>

<p>Data: Parameters for all regions, generated through SPOT optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paras
</code></pre>


<h3>Format</h3>

<p>'data.frame' obs. of  31 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.29</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
<dt>region</dt><dd><p>num 5315</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code><a href="#topic+runoptDirect">runoptDirect</a></code> run.
</p>

<hr>
<h2 id='plotDailyMaxResults'>plotDailyMaxResults</h2><span id='topic+plotDailyMaxResults'></span>

<h3>Description</h3>

<p>Plot output from <code>getDailyMax()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDailyMaxResults(
  results,
  labels = c("babsim", "DIVI"),
  title = "Betten: Tuerkis = Readfssldaten, Rot = Simulation",
  showBeds = FALSE,
  icuDataRegion = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDailyMaxResults_+3A_results">results</code></td>
<td>
<p>Results from <code>getDailyMax</code>.</p>
</td></tr>
<tr><td><code id="plotDailyMaxResults_+3A_labels">labels</code></td>
<td>
<p>Axes labels (vector). Default: <code>c('babsim', 'DIVI')</code></p>
</td></tr>
<tr><td><code id="plotDailyMaxResults_+3A_title">title</code></td>
<td>
<p>Title. Default:
<code>'Betten: Tuerkis = Realdaten, Rot = Simulation'</code></p>
</td></tr>
<tr><td><code id="plotDailyMaxResults_+3A_showbeds">showBeds</code></td>
<td>
<p>should normal beds be shown in the plot?</p>
</td></tr>
<tr><td><code id="plotDailyMaxResults_+3A_icudataregion">icuDataRegion</code></td>
<td>
<p>regional <code>icudata</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
# 1. Generate simulation data based on number of infected persons per day:
x &lt;- dataCovidBeds20200624
StartDate &lt;- x$Day[1]
EndDate &lt;- x$Day[length(x$Day)]
arrivalTimes &lt;- getArrivalTimes(x$Infected)
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
y &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = para
)

# 2. Extract real data:
fieldEvents &lt;- getRealBeds(
  data = babsim.hospital::dataCovidBeds20200624,
  resource = c("bed", "intensiveBed", "intensiveBedVentilation")
)
conf &lt;- babsimToolsConf()
# 3. Combine simlated and real data:
res &lt;- getDailyMaxResults(
  envs = y,
  fieldEvents = fieldEvents,
  conf = conf
)
# 4. Plot results
p &lt;- plotDailyMaxResults(res)
# print(p)
</code></pre>

<hr>
<h2 id='plotPostprocessedEnvs'>plotPostprocessedEnvs</h2><span id='topic+plotPostprocessedEnvs'></span>

<h3>Description</h3>

<p>Plot output from <code><a href="#topic+postprocessEnvs">postprocessEnvs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPostprocessedEnvs(results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPostprocessedEnvs_+3A_results">results</code></td>
<td>
<p>Results from <code><a href="#topic+postprocessEnvs">postprocessEnvs</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a <code>ggplot</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
# 1. Generate simulation data based on number of infected persons per day:
x &lt;- dataCovidBeds20200624
StartDate &lt;- x$Day[1]
EndDate &lt;- x$Day[length(x$Day)]
arrivalTimes &lt;- getArrivalTimes(x$Infected)
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
y &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = para
)

# 2. Postprocess simmer environment:
res &lt;- postprocessEnvs(envs = y, StartDate = "2020-03-03")
# 4. Plot results
p &lt;- plotPostprocessedEnvs(res)
# print(p)
</code></pre>

<hr>
<h2 id='postprocessEnvs'>postprocessEnvs</h2><span id='topic+postprocessEnvs'></span>

<h3>Description</h3>

<p>Postprocess results from several <code><a href="simmer.html#topic+simmer">simmer</a></code> results.
Input: <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment.
The method <code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> function is used to extract information from
the <code>babsim.hospital</code> simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postprocessEnvs(envs, StartDate = "2020-03-03")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postprocessEnvs_+3A_envs">envs</code></td>
<td>
<p><code><a href="simmer.html#topic+simmer">simmer</a></code> simulation environment.
Result from <code>babsim.hospital</code> simulation runs, e.g., output from <code><a href="#topic+babsimHospital">babsimHospital</a></code>.</p>
</td></tr>
<tr><td><code id="postprocessEnvs_+3A_startdate">StartDate</code></td>
<td>
<p>Date[1:1], format: 'YYYY-MM-DD' First day of the simulation. Default: <code>'2020-03-03'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="simmer.html#topic+get_mon_resources">get_mon_resources</a></code> returns state changes in resources:
</p>

<ul>
<li><p>'resource': resources name
</p>
</li>
<li><p>'time': time instant of the event that triggered the state change
</p>
</li>
<li><p>'server': server count
</p>
</li>
<li><p>'queue': queue count
</p>
</li>
<li><p>'capacity': capacity
</p>
</li>
<li><p>'queue_size': queue size
</p>
</li>
<li><p>'system': system count (server + queue). If no queues are used, system values equal server values.
</p>
</li>
<li><p>'system_limit': system limit (capacity + queue_size)
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns an env data frame (tibble [nxm, 15] (S3: grouped_df/tbl_df/tbl/data.frame))
with the following entries:
</p>

<dl>
<dt><code>resource</code> (chr)</dt><dd><p>name of the seized resource: 'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt><code>time</code> (num)</dt><dd><p>time step:  3 10 12 13 14 15 15 15 15 16 ...</p>
</dd>
<dt><code>server</code> (int)</dt><dd><p>server: 1 2 3 2 3 4 3 4 5 6 ...</p>
</dd>
<dt><code>limit</code> (num)</dt><dd><p>limit: Inf Inf Inf Inf Inf ...</p>
</dd>
<dt><code>replication</code> (int)</dt><dd><p>replication:  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>upper</code> (int)</dt><dd><p>upper: 1 2 3 2 3 5 5 5 5 7 ...</p>
</dd>
<dt><code>lower</code> (int)</dt><dd><p>lower: 1 2 3 2 3 3 3 3 3 5 ...</p>
</dd>
<dt><code>med</code> (num)</dt><dd><p>med: 1 2 3 2 3 4 4 4 4 6 ...</p>
</dd>
<dt><code>date</code> (POSIXct)</dt><dd><p>time, format: <code>yyyy-mm-dd hh:mm.ss</code></p>
</dd>
<dt><code>rwdate</code> (POSIXct)</dt><dd><p>format: '2020-03-01' '2020-03-08' '2020-03-15' '2020-03-15' ...</p>
</dd>
<dt><code>source</code> (chr)</dt><dd><p>name of the simulation that was used: 'babsim' 'babsim' 'babsim' 'babsim' ...</p>
</dd>
</dl>



<h3><code><a href="#topic+plotPostprocessedEnvs">plotPostprocessedEnvs</a></code></h3>

<p>NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
# 1. Generate simulation data based on number of infected persons per day:
x &lt;- dataCovidBeds20200624
StartDate &lt;- x$Day[1]
EndDate &lt;- x$Day[length(x$Day)]
arrivalTimes &lt;- getArrivalTimes(x$Infected)
para &lt;- babsimHospitalPara()
conf &lt;- babsimToolsConf()
y &lt;- babsimHospital(
  arrivalTimes = arrivalTimes,
  conf = conf,
  para = para
)

# 2. Postprocess simulation results:
res &lt;- postprocessEnvs(envs = y)
# 3. Plot results
p &lt;- plotPostprocessedEnvs(res)
</code></pre>

<hr>
<h2 id='printConf'>printConf</h2><span id='topic+printConf'></span>

<h3>Description</h3>

<p>Print configuration information, e.g., for debugging.
This function returns the configuration settings of the babsim.hospital functions
used to run <code><a href="#topic+babsimHospital">babsimHospital</a></code>.
Currently, only <code><a href="utils.html#topic+str">str</a></code> is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printConf(conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printConf_+3A_conf">conf</code></td>
<td>
<p>Configuration, e.g., generated with <code><a href="#topic+babsimToolsConf">babsimToolsConf</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Configuration <code>conf</code>  is a list of the following settings.
</p>

<dl>
<dt><code>seed</code></dt><dd><p>(int) Initial seed. Default: 123</p>
</dd>
<dt><code>simRepeats</code></dt><dd><p>(int) Number of <code><a href="simmer.html#topic+simmer">simmer</a></code> simulation runs. Default: 1</p>
</dd>
<dt><code>parallel</code></dt><dd><p>(logical) Use parallel simulations based on <code><a href="parallel.html#topic+mclapply">mclapply</a></code>. Default: FALSE</p>
</dd>
<dt><code>perCores</code></dt><dd><p>(num) Percentage of cores used, if <code>parallel == TRUE</code>. Default: 0.5</p>
</dd>
<dt><code>ICU</code></dt><dd><p>(logical) Use ICU (RKI) data. Default: FALSE.</p>
</dd>
<dt><code>logLevel</code></dt><dd><p>(int) 0 = no logging, &gt;= 1 logging. Default: 0. If larger than 10, shown detailed simmer output.</p>
</dd>
<dt><code>maxCapacity</code></dt><dd><p>(num) Maximum capacity used for <code><a href="#topic+babsimHospital">babsimHospital</a></code> resources. Default: 1e6.</p>
</dd>
<dt><code>dataset</code></dt><dd><p>(chr)  'GA' or 'ICU'. Default: 'GA'.</p>
</dd>
<dt><code>simulationDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the simulation data (infection data used to generate
arrival times), first day. Default: '2020-03-03'</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the simulation data, last day. Default: '2020-06-24'</p>
</dd>
</dl>
</dd>
<dt><code>fieldDates</code></dt><dd><p> List with the following entries:
</p>

<dl>
<dt><code>StartDate</code></dt><dd><p>(chr) Start date of the field (resources)  data, first day. Default: '2020-03-03'</p>
</dd>
<dt><code>EndDate</code></dt><dd><p>(chr) End date of the field data, last day. Default: '2020-06-24'</p>
</dd>
</dl>
</dd>
<dt><code>simulationData</code></dt><dd><p>(data frame) Data used for the simulation. Default <code><a href="#topic+dataCovidBeds20200624">dataCovidBeds20200624</a></code>
</p>

<dl>
<dt>bed</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>intensiveBed</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>intensiveBedVentilation</dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt>Day</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
<dt>Infected</dt><dd><p>num  5 0 0 0 0 0 0 7 2 5 ...</p>
</dd>
<dt>Sick</dt><dd><p>num  5 5 5 5 5 5 5 12 14 19 ...</p>
</dd>
</dl>
</dd>
<dt><code>fieldEvents</code></dt><dd><p>(data frame) Data used for evalution of the simulation. Default <code><a href="#topic+GABeds220200624">GABeds220200624</a></code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
</dl>
</dd>
<dt><code>resource</code></dt><dd><p>(vector) Resources used in the simulation.
Default: <code>c('bed', 'intensiveBed', 'intensiveBedVentilation')</code>. For ICU data use:
<code>c('bed', 'intensiveBedVentilation')</code>
</p>

<dl>
<dt>ressource</dt><dd><p>chr  'bed' 'bed' 'bed' 'bed' ...</p>
</dd>
<dt>time</dt><dd><p>int  1 2 3 4 5 6 7 8 9 10 ...</p>
</dd>
<dt>med</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>source</dt><dd><p>int  2 2 3 3 3 3 3 3 4 4 ...</p>
</dd>
<dt>date</dt><dd><p>Date, format: '2020-03-03' '2020-03-04' '2020-03-05' '2020-03-06' ...</p>
</dd>
</dl>
</dd>
</dl>



<h3>Value</h3>

<p>conf elements
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
conf &lt;- babsimToolsConf()
# turn on parallel simulation:
conf$parallel &lt;- TRUE
# Change the start date of the simulations
printConf(conf = conf)
</code></pre>

<hr>
<h2 id='RiskScore'>Calculate risk scores</h2><span id='topic+RiskScore'></span>

<h3>Description</h3>

<p>Calculate a risk score based on age and sex of patient for a set of cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RiskScore(cases, par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RiskScore_+3A_cases">cases</code></td>
<td>
<p>[<code>object</code>] <br /> table of cases, one per row.</p>
</td></tr>
<tr><td><code id="RiskScore_+3A_par">par</code></td>
<td>
<p>[<code>list()</code>] <br /> parameters of risk model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The risk score is calculated according to the following formula:
</p>
<p style="text-align: center;"><code class="reqn">\code{RiskScore} = \code{RiskFactorA}  exp(\code{RiskFactorB} \code{age}) (1 + I_{male} (\code{RiskMale} - 1)</code>
</p>

<p>Here the <code>RiskFactorA</code>, <code>RiskFactorB</code> and <code>RiskMale</code> are taken from the parameter list <code>par</code> and the <code>age</code> and <code>sex</code> are taken from the <code>cases</code> .
</p>


<h3>Value</h3>

<p>Vector of risk scores.
</p>

<hr>
<h2 id='rkidata'>rkidata: RKI COVID-19 Daten (complete, not included in CRAN version)</h2><span id='topic+rkidata'></span>

<h3>Description</h3>

<p>RKI Daten komplett
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkidata
</code></pre>


<h3>Format</h3>

<p>a data.frame of of  18 variables
</p>

<dl>
<dt><code>FID</code></dt><dd><p>int  40613780 40613781 40613782 40613783 40613784 40613785 40613786 40613787 40613788 40613789 ...</p>
</dd>
<dt><code>IdBundesland </code></dt><dd><p> 1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>Bundesland</code></dt><dd><p>chr  &quot;Schleswig-Holstein&quot; &quot;Schleswig-Holstein&quot; &quot;Schleswig-Holstein&quot; &quot;Schleswig-Holstein&quot; ...</p>
</dd>
<dt><code>Landkreis</code></dt><dd><p>chr  &quot;SK Flensburg&quot; &quot;SK Flensburg&quot; &quot;SK Flensburg&quot; &quot;SK Flensburg&quot; ...</p>
</dd>
<dt><code>Altersgruppe</code></dt><dd><p>chr  &quot;A00-A04&quot; &quot;A00-A04&quot; &quot;A00-A04&quot; &quot;A05-A14&quot; ...</p>
</dd>
<dt><code>Geschlecht</code></dt><dd><p>chr  &quot;M&quot; &quot;W&quot; &quot;W&quot; &quot;M&quot; ...</p>
</dd>
<dt><code>AnzahlFall</code></dt><dd><p>int  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>AnzahlTodesfall</code></dt><dd><p> ...</p>
</dd>
<dt><code>Meldedatum</code></dt><dd><p>chr  &quot;2020/09/30 00:00:00&quot; &quot;2020/08/24 00:00:00&quot; &quot;2020/09/26 00:00:00&quot; &quot;2020/09/25 00:00:00&quot; ...</p>
</dd>
<dt><code>IdLandkreis</code></dt><dd><p>int  1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 ...</p>
</dd>
<dt><code>Datenstand</code></dt><dd><p>&quot;04.10.2020, 00:00 Uhr&quot; &quot;04.10.2020, 00:00 Uhr&quot; &quot;04.10.2020, 00:00 Uhr&quot; &quot;04.10.2020, 00:00 Uhr&quot; ...</p>
</dd>
<dt><code>NeuerFall</code></dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt><code>NeuerTodesfall</code></dt><dd><p>int  -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 ...</p>
</dd>
<dt><code>Refdatum</code></dt><dd><p>chr  &quot;2020/09/30 00:00:00&quot; &quot;2020/08/24 00:00:00&quot; &quot;2020/09/26 00:00:00&quot; &quot;2020/09/21 00:00:00&quot; ...</p>
</dd>
<dt><code>NeuGenesen</code></dt><dd><p>int  -9 0 -9 -9 -9 -9 0 -9 -9 0 ...</p>
</dd>
<dt><code>AnzahlGenesen</code></dt><dd><p>int  0 1 0 0 0 0 1 0 0 1 ...</p>
</dd>
<dt><code>IstErkrankungsbeginn</code></dt><dd><p>int  0 0 0 1 1 0 0 1 0 1 ...</p>
</dd>
<dt><code>Altergruppe2</code></dt><dd><p>chr  &quot;Nicht übermittelt&quot; &quot;Nicht übermittelt&quot; &quot;Nicht übermittelt&quot; &quot;Nicht übermittelt&quot; ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Heruntergeladen  mittels 
<code>wget https://www.arcgis.com/sharing/rest/content/items/f10774f1c63e40168479a1feb6c7ca74/data</code>
Eingelesen mittels <code>rkidata &lt;- read.csv("data", header=TRUE,encoding="UTF-8")</code>
Eingepflegt mittel <code>usethis::use_data(rkidata)</code>
</p>
<p>Weiterverabeitung z.B. mit:
<code>rkidataobk &lt;- rkidata[rkidata$Landkreis == "LK Oberbergischer Kreis", ]</code>
<code>rkidataobk$Meldedatum &lt;- as.Date(rkidataobk$Meldedatum) </code>
<code>sum(rkidataobk$AnzahlFall)</code>
<code>sum(rkidataobk$AnzahlTodesfall)</code>
<code>rkidataobkAgg &lt;- as.data.frame(xtabs( AnzahlFall   ~ Meldedatum, rkidataobk))</code>
<code>plot(rkidataobkAgg$Meldedatum, rkidataobkAgg$Freq)</code>
</p>
<p>Ein data.frame  mit 18 Variablen
</p>

<hr>
<h2 id='rkiGeschlechtToSex'>Map <code>Geschlecht</code> to biological sex</h2><span id='topic+rkiGeschlechtToSex'></span>

<h3>Description</h3>

<p>Map <code>Geschlecht</code> to biological sex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkiGeschlechtToSex(geschlecht)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rkiGeschlechtToSex_+3A_geschlecht">geschlecht</code></td>
<td>
<p>[<code>character(n)</code>] <br />
character vector with values in &lsquo;M&rsquo;, &lsquo;W&rsquo;, and &lsquo;unbekannt&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A factor vector with <code>n</code> elements and levels &lsquo;male&rsquo; or &lsquo;female&rsquo;. 
&lsquo;unbekannt&rsquo; or other values are mapped to <code>NA</code>.
</p>

<hr>
<h2 id='rkiToBabsimArrivals'>rkiToBabsimArrivals</h2><span id='topic+rkiToBabsimArrivals'></span>

<h3>Description</h3>

<p>Transforms the freshly downloaded rki data into the babsim fitting format of
arrival times. Also imputes mising dates as zero frequency in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkiToBabsimArrivals(rki)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rkiToBabsimArrivals_+3A_rki">rki</code></td>
<td>
<p>data.frame of downloaded rki data before preprocessing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame of arrival times suited for babsimHospital
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
arrivals &lt;- rkiToBabsimArrivals(rkidata[1:100, ])
min(as.Date(rkidata$Refdatum)) + max(arrivals)
</code></pre>

<hr>
<h2 id='rkiToBabsimData'>rkiToBabsimData</h2><span id='topic+rkiToBabsimData'></span>

<h3>Description</h3>

<p>Transforms the freshly downloaded rki data into the babsim data frame.
Also imputes mising dates as zero frequency in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkiToBabsimData(rki = babsim.hospital::rkidata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rkiToBabsimData_+3A_rki">rki</code></td>
<td>
<p>data.frame of downloaded rki data before preprocessing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame of aggregated data
</p>

<dl>
<dt><code>Day</code></dt><dd><p>Date, format: '2020-01-01' '2020-01-02' '2020-01-03' '2020-01-04' ...</p>
</dd>
<dt><code>Infected</code></dt><dd><p>Infiziert: num  1 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt><code>Weiblich</code></dt><dd><p>Geschlecht weiblich: int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt><code>Maennlich</code></dt><dd><p>Geschlecht maennlich: int  1 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt><code>GUnbekannt</code></dt><dd><p>Geschlecht unbekannt: int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- rkiToBabsimData(rkidata[1:100, ])
plot(data$Day, data$Infected, type = "o")
#
max(data$Day) - min(data$Day)
</code></pre>

<hr>
<h2 id='rtgamma'>rtgamma</h2><span id='topic+rtgamma'></span>

<h3>Description</h3>

<p>Random generation for the shifted and truncated Gamma distribution with parameters
<code>shape</code> and <code>scale</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtgamma(n = 1, shape = 1, rate = 1, shift = 0, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtgamma_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="rtgamma_+3A_shape">shape</code></td>
<td>
<p>Gamma shape parameter</p>
</td></tr>
<tr><td><code id="rtgamma_+3A_rate">rate</code></td>
<td>
<p>Gamma rate parameter</p>
</td></tr>
<tr><td><code id="rtgamma_+3A_shift">shift</code></td>
<td>
<p>shift parameter.</p>
</td></tr>
<tr><td><code id="rtgamma_+3A_alpha">alpha</code></td>
<td>
<p>upper quantile of gamma distribution. All values above alpha are truncated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rtgamma generates random deviates. The length of the result is determined by <code>n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rtgamma(n = 1, shape = 1, rate = 1, shift = 1, alpha = 0.95)
</code></pre>

<hr>
<h2 id='runoptDirect'>runoptDirect Optimierung der babsim.hospital Parameter</h2><span id='topic+runoptDirect'></span>

<h3>Description</h3>

<p>SPOT Aufruf zur Optimierung der babsim Parameter mit Lasso
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runoptDirect(
  expName = "obkpara20201017",
  rkiwerte = babsim.hospital::rkidata,
  icuwerte = babsim.hospital::icudata,
  region = 5374,
  TrainFieldStartDate = NULL,
  TrainSimStartDate = NULL,
  TestFieldStartDate = NULL,
  TestSimStartDate = NULL,
  Overlap = 7,
  verbosity = 0,
  seed = 123,
  direct = FALSE,
  repeats = 1,
  funEvals = 35,
  funEvalsFactor = 0,
  size = 30,
  simrepeats = 2,
  subset = 32,
  parallel = FALSE,
  percCores = NULL,
  icu = TRUE,
  icuWeights = 1,
  testRepeats = 3,
  resourceNames = c("intensiveBed", "intensiveBedVentilation"),
  resourceEval = c("intensiveBed", "intensiveBedVentilation"),
  spotEvalsParallel = FALSE,
  tryOnTestSet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runoptDirect_+3A_expname">expName</code></td>
<td>
<p>Experiment Name</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_rkiwerte">rkiwerte</code></td>
<td>
<p>RKI Daten</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_icuwerte">icuwerte</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> fuer OBK, <code>5315</code> fuer Koeln,
<code>0</code> fuer Deutschland,
oder Bundesland ID, e.g., <code>5</code> fuer NRW.</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-06-01"</code></p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_trainsimstartdate">TrainSimStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-05-01"</code></p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>"2020-06-01"</code> for test field data</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>"2020-05-01"</code> for test simulation data,
TestSimStartDate is usually before TestFieldStartDate</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_overlap">Overlap</code></td>
<td>
<p>integer. Days, train data will be extended (overlap with test data). Default: 7</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_verbosity">verbosity</code></td>
<td>
<p>verbosity (int). Default: <code>0</code></p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_seed">seed</code></td>
<td>
<p>Seed</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_direct">direct</code></td>
<td>
<p>use model-free optimization. Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_repeats">repeats</code></td>
<td>
<p>Wiederholungen fuer SPOT (Optimierungslaeufe mit unterschiedlichem Seed)</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_funevals">funEvals</code></td>
<td>
<p>Auswertungen fuer SPOT (Simulationen,
die fuer einen SPOT Lauf zur Verfuegung stehen)</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_funevalsfactor">funEvalsFactor</code></td>
<td>
<p>factor to increase function evaluations. Default: 0</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_size">size</code></td>
<td>
<p>Groesse des initialen Desings</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_simrepeats">simrepeats</code></td>
<td>
<p>Sim Wdhlg</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_subset">subset</code></td>
<td>
<p>Subset (SPOT)</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_parallel">parallel</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_perccores">percCores</code></td>
<td>
<p>percentage</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_icu">icu</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_icuweights">icuWeights</code></td>
<td>
<p>Gewichtung der ICU Betten</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_testrepeats">testRepeats</code></td>
<td>
<p>number of final evaluations on the test data</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_resourcenames">resourceNames</code></td>
<td>
<p>Name der Ressourcen</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_resourceeval">resourceEval</code></td>
<td>
<p>Name der zu evaluierenden Ressourcen</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_spotevalsparallel">spotEvalsParallel</code></td>
<td>
<p>Should the spot repeats be evaluated in parallel?</p>
</td></tr>
<tr><td><code id="runoptDirect_+3A_tryontestset">tryOnTestSet</code></td>
<td>
<p>Should results be tested on a separate test set?</p>
</td></tr>
</table>

<hr>
<h2 id='runOptLocal'>runOptLocal</h2><span id='topic+runOptLocal'></span>

<h3>Description</h3>

<p>Run a local optimization on a set of parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runOptLocal(
  X,
  rkiwerte = babsim.hospital::rkidata,
  icuwerte = babsim.hospital::icudata,
  region = 5374,
  TrainFieldStartDate = NULL,
  TrainSimStartDate = NULL,
  verbosity = 0,
  seed = 123,
  funEvals = 35,
  simrepeats = 2,
  parallel = FALSE,
  percCores = NULL,
  icu = TRUE,
  icuWeights = 1,
  resourceNames = c("intensiveBed", "intensiveBedVentilation"),
  resourceEval = c("intensiveBed", "intensiveBedVentilation"),
  spotEvalsParallel = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runOptLocal_+3A_x">X</code></td>
<td>
<p>matrix of parameters. Each row should contain one parameterset to which a local optimization is applied</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_rkiwerte">rkiwerte</code></td>
<td>
<p>RKI Daten</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_icuwerte">icuwerte</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> fuer OBK, <code>5315</code> fuer Koeln,
<code>0</code> fuer Deutschland,
oder Bundesland ID, e.g., <code>5</code> fuer NRW.</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-06-01"</code></p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_trainsimstartdate">TrainSimStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-05-01"</code></p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_verbosity">verbosity</code></td>
<td>
<p>verbosity (int). Default: <code>0</code></p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_seed">seed</code></td>
<td>
<p>Seed</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_funevals">funEvals</code></td>
<td>
<p>Auswertungen fuer SPOT (Simulationen,
die fuer einen SPOT Lauf zur Verfuegung stehen)</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_simrepeats">simrepeats</code></td>
<td>
<p>Sim Wdhlg</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_parallel">parallel</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_perccores">percCores</code></td>
<td>
<p>percentage</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_icu">icu</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_icuweights">icuWeights</code></td>
<td>
<p>Gewichtung der ICU Betten</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_resourcenames">resourceNames</code></td>
<td>
<p>Name der Ressourcen</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_resourceeval">resourceEval</code></td>
<td>
<p>Name der zu evaluierenden Ressourcen</p>
</td></tr>
<tr><td><code id="runOptLocal_+3A_spotevalsparallel">spotEvalsParallel</code></td>
<td>
<p>Should the spot repeats be evaluated in parallel?</p>
</td></tr>
</table>

<hr>
<h2 id='runoptUK'>runoptUK Optimierung der babsim.hospital Parameter</h2><span id='topic+runoptUK'></span>

<h3>Description</h3>

<p>SPOT Aufruf zur Optimierung der babsim Parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runoptUK(
  expName = "ukl001",
  simData = simData,
  fieldData = fieldData,
  TrainFieldStartDate = Sys.Date() - 6 * 7,
  TrainSimStartDate = Sys.Date() - 10 * 7,
  TestFieldStartDate = Sys.Date() - 4 * 7,
  TestSimStartDate = Sys.Date() - 8 * 7,
  Overlap = 0,
  verbosity = 0,
  seed = 123,
  repeats = 1,
  funEvals = 35,
  size = 30,
  simrepeats = 2,
  subset = 32,
  parallel = FALSE,
  percCores = 0.8,
  icu = FALSE,
  icuWeights = c(1, 1, 1),
  testRepeats = 3,
  resourceNames = c("bed", "intensiveBed", "intensiveBedVentilation"),
  resourceEval = c("bed", "intensiveBed", "intensiveBedVentilation"),
  factorUK = 1,
  factorIcuUK = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runoptUK_+3A_expname">expName</code></td>
<td>
<p>Experiment Name</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_simdata">simData</code></td>
<td>
<p>RKI Daten</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_fielddata">fieldData</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_trainfieldstartdate">TrainFieldStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-06-01"</code></p>
</td></tr>
<tr><td><code id="runoptUK_+3A_trainsimstartdate">TrainSimStartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>"2020-05-01"</code></p>
</td></tr>
<tr><td><code id="runoptUK_+3A_testfieldstartdate">TestFieldStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>"2020-06-01"</code> for test field data</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_testsimstartdate">TestSimStartDate</code></td>
<td>
<p>Start (Day), e.g., <code>"2020-05-01"</code> for test simulation data,
TestSimStartDate is usually before TestFieldStartDate</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_overlap">Overlap</code></td>
<td>
<p>integer. Days, train data will be extended (overlap with test data). Default: 7</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_verbosity">verbosity</code></td>
<td>
<p>verbosity (int). Default: <code>0</code></p>
</td></tr>
<tr><td><code id="runoptUK_+3A_seed">seed</code></td>
<td>
<p>Seed</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_repeats">repeats</code></td>
<td>
<p>Wiederholungen fuer SPOT (Optimierungslaeufe mit unterschiedlichem Seed)</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_funevals">funEvals</code></td>
<td>
<p>Auswertungen fuer SPOT (Simulationen, 
die fuer einen SPOT Lauf zur Verfuegung stehen)</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_size">size</code></td>
<td>
<p>Groesse des initialen Desings</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_simrepeats">simrepeats</code></td>
<td>
<p>Sim Wdhlg</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_subset">subset</code></td>
<td>
<p>Subset (SPOT)</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_parallel">parallel</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_perccores">percCores</code></td>
<td>
<p>percentage</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_icu">icu</code></td>
<td>
<p>ICU Daten</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_icuweights">icuWeights</code></td>
<td>
<p>Gewichtung der ICU Betten</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_testrepeats">testRepeats</code></td>
<td>
<p>number of final evaluations on the test data</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_resourcenames">resourceNames</code></td>
<td>
<p>Name der Ressourcen</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_resourceeval">resourceEval</code></td>
<td>
<p>Name der zu evaluierenden Ressourcen</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_factoruk">factorUK</code></td>
<td>
<p>factor to adapt the percentage of patients ventilated. For example,
if set to '0.5', only 50 percent of the default number of patients will be ventilated.
Default: 1</p>
</td></tr>
<tr><td><code id="runoptUK_+3A_factoricuuk">factorIcuUK</code></td>
<td>
<p>factor to adapt the duration on ICU. For example,
if set to '0.5', patients stay on half the time at ICU
Default: 1</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
res &lt;- runoptUK()

## End(Not run)

</code></pre>

<hr>
<h2 id='skip_if_quicktest'>Skip test if in quicktest mode</h2><span id='topic+skip_if_quicktest'></span>

<h3>Description</h3>

<p>Skip test if option &lsquo;babsim.hospital.quicktest&rsquo; is <code>TRUE</code> or if
the environment variable &lsquo;BABSIM_HOSPTIAL_QUICKTEST&rsquo; is set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skip_if_quicktest()
</code></pre>

<hr>
<h2 id='smoothParameter'>Smooth a parameter set using another parameter set</h2><span id='topic+smoothParameter'></span>

<h3>Description</h3>

<p>Calculate the average of two parameter sets to smooth out any local anomalies.
Mostly useful to smooth out a local (say OBK) parameter set using a global one (say NRW).
</p>
<p>Technically this function calculates
<code>(1-weight) * para + weight * other</code>
ensuring that the names etc. of <code>para</code> are preserved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothParameter(para, other, weight = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothParameter_+3A_para">para</code></td>
<td>
<p>Parameter set to smooth</p>
</td></tr>
<tr><td><code id="smoothParameter_+3A_other">other</code></td>
<td>
<p>Other parameters to average in</p>
</td></tr>
<tr><td><code id="smoothParameter_+3A_weight">weight</code></td>
<td>
<p>Weight of other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Weighted parameter set
</p>

<hr>
<h2 id='softmax'>softmax</h2><span id='topic+softmax'></span>

<h3>Description</h3>

<p>softmax function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="softmax_+3A_par">par</code></td>
<td>
<p>vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>num vector with components &gt;= 0 and sum = 1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- c(0.6, 0.3, 0.1)
softmax(p)
</code></pre>

<hr>
<h2 id='switchRkiRefdatumToMeldedatum'>switchRkiRefdatumToMeldedatum Change RKI data File</h2><span id='topic+switchRkiRefdatumToMeldedatum'></span>

<h3>Description</h3>

<p>Use Meldedatum instead of Refdatum in
<code><a href="#topic+rkidata">rkidata</a></code>. It is recommended to run
install and restart the package afterwards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switchRkiRefdatumToMeldedatum(rkidata = rkidata, overwrite = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switchRkiRefdatumToMeldedatum_+3A_rkidata">rkidata</code></td>
<td>
<p>RKI Data</p>
</td></tr>
<tr><td><code id="switchRkiRefdatumToMeldedatum_+3A_overwrite">overwrite</code></td>
<td>
<p>logical Overwrite existing file. Default <code>TRUE</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='synthpara'>synthpara data</h2><span id='topic+synthpara'></span>

<h3>Description</h3>

<p>Data: Synthetic data generated with SPOT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synthpara
</code></pre>


<h3>Format</h3>

<p>'data.frame':  obs. of  34 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.33</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code><a href="#topic+runoptDirect">runoptDirect</a></code> run.
Use <code>yx &lt;- synthpara[synthpara$y == min(synthpara$y), ]
x &lt;- yx[1,2:34]
</code>
to extract the best parameter set x.
</p>

<hr>
<h2 id='ukpara'>ukpara data</h2><span id='topic+ukpara'></span>

<h3>Description</h3>

<p>Data: ukpara para generated with SPOT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ukpara
</code></pre>


<h3>Format</h3>

<p>'data.frame':	 obs. of  29 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.29</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code>runoptUK</code> run.
Use <code>yx &lt;- ukpara[ukpara$y == min(ukpara$y), ]
x &lt;- yx[1,2:dim(ukpara)[2]]
</code> 
to extract the best parameter set x.
</p>

<hr>
<h2 id='ukpara01'>ukpara01 data</h2><span id='topic+ukpara01'></span>

<h3>Description</h3>

<p>Data: ukpara para generated with SPOT. Probabilities for ICU ventilation reduced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ukpara01
</code></pre>


<h3>Format</h3>

<p>'data.frame':	 obs. of  29 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.29</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code>runoptUK</code> run.
Use <code>yx &lt;- ukpara[ukpara$y == min(ukpara$y), ]
x &lt;- yx[1,2:dim(ukpara)[2]]
</code> 
to extract the best parameter set x.
</p>

<hr>
<h2 id='ukpara02'>ukpara02 data</h2><span id='topic+ukpara02'></span>

<h3>Description</h3>

<p>Data: ukpara para generated with SPOT. Probabilities for ICU ventilation reduced 
and durations for ICU stays increased.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ukpara02
</code></pre>


<h3>Format</h3>

<p>'data.frame':	 obs. of  29 variables:
</p>

<dl>
<dt>y</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>x.1</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>...</dt><dd><p> ...</p>
</dd>
<dt>x.29</dt><dd><p>num  1.072 1.015 1.044 1.057 0.556 ...</p>
</dd>
</dl>



<h3>Details</h3>

<p>Result from the <code>runoptUK</code> run.
Use <code>yx &lt;- ukpara[ukpara$y == min(ukpara$y), ]
x &lt;- yx[1,2:dim(ukpara)[2]]
</code> 
to extract the best parameter set x.
</p>

<hr>
<h2 id='updateIcudataFile'>updateIcudataFile Update ICU data File</h2><span id='topic+updateIcudataFile'></span>

<h3>Description</h3>

<p>Update icudata (divi)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateIcudataFile(overwrite = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateIcudataFile_+3A_overwrite">overwrite</code></td>
<td>
<p>logical Overwrite existing file. Default <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>True if new data was downloaded, otherwise false
</p>

<hr>
<h2 id='updateMatrixP'>updateMatrixP</h2><span id='topic+updateMatrixP'></span>

<h3>Description</h3>

<p>Updates the probability matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateMatrixP(P = getMatrixP(), u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateMatrixP_+3A_p">P</code></td>
<td>
<p>matrix P. Default <code><a href="#topic+getMatrixP">getMatrixP</a></code></p>
</td></tr>
<tr><td><code id="updateMatrixP_+3A_u">u</code></td>
<td>
<p>list of factors used for the update</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with updated transition probabilities
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
u &lt;- list(k = 2)
R &lt;- updateMatrixP(u = u)
</code></pre>

<hr>
<h2 id='updateParaSet'>updateParaSet</h2><span id='topic+updateParaSet'></span>

<h3>Description</h3>

<p>Delete old parameters from paras and replace them with new ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateParaSet(paramDF, region, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateParaSet_+3A_paramdf">paramDF</code></td>
<td>
<p>the data frame with the new parameters that should replace the old ones</p>
</td></tr>
<tr><td><code id="updateParaSet_+3A_region">region</code></td>
<td>
<p>integer, the region id</p>
</td></tr>
<tr><td><code id="updateParaSet_+3A_path">path</code></td>
<td>
<p>path to the old para file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parameter set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getParaSet(5315)
</code></pre>

<hr>
<h2 id='updateRkidataFile'>updateRkidataFile Update RKI data File</h2><span id='topic+updateRkidataFile'></span>

<h3>Description</h3>

<p>Update rkidata. Download RKI data from the RKI Server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateRkidataFile(fileName = NULL, overwrite = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateRkidataFile_+3A_filename">fileName</code></td>
<td>
<p>RKI Filename, e.g.,
<code>'https://www.arcgis.com/sharing/rest/content/}
\code{items/f10774f1c63e40168479a1feb6c7ca74/data'</code></p>
</td></tr>
<tr><td><code id="updateRkidataFile_+3A_overwrite">overwrite</code></td>
<td>
<p>logical Overwrite existing file. Default <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because the downloaded RKI data include data from January 2020
(first COVID-19 wave in Germany) until
today (or the day before today), the original data are stored as <code>rkidataFull</code>.
<code>babsim.hospital</code> simulations require data starting from September 2020 (second
COVID-19 wave in Germany). Therefore, a limited data set starting from Sep 1st
is stored as <code><a href="#topic+rkidata">rkidata</a></code> in the <code>babsim.hospital</code> package.
Furthermore, because no nowcasting is implemented in the current version of the
<code>babsim.hospital</code> simulator, the <code>Meldedatum</code> information will be used
instead of the the <code>Refdatum</code> information: the corresponding columns in
<code>rkidata</code> are renamed, because all functions in <code>babsim.hospital</code>
use the <code>Refdatum</code> information.
</p>
<p>Creates two <code>*.rda</code> files in the folder <code>data</code>:
1. <code>babsim.hospital::rkidata</code> and
2. <code>babsim.hospital::rkidataFull</code>.
Both data frames contain the following 18 variables
</p>

<dl>
<dt><code>FID</code></dt><dd><p>int  40613780 40613781 40613782 40613783 40613784 40613785 40613786 40613787 40613788 40613789 ...</p>
</dd>
<dt><code>IdBundesland </code></dt><dd><p> 1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>Bundesland</code></dt><dd><p>chr  'Schleswig-Holstein' 'Schleswig-Holstein' 'Schleswig-Holstein' 'Schleswig-Holstein' ...</p>
</dd>
<dt><code>Landkreis</code></dt><dd><p>chr  'SK Flensburg' 'SK Flensburg' 'SK Flensburg' 'SK Flensburg' ...</p>
</dd>
<dt><code>Altersgruppe</code></dt><dd><p>chr  'A00-A04' 'A00-A04' 'A00-A04' 'A05-A14' ...</p>
</dd>
<dt><code>Geschlecht</code></dt><dd><p>chr  'M' 'W' 'W' 'M' ...</p>
</dd>
<dt><code>AnzahlFall</code></dt><dd><p>int  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt><code>AnzahlTodesfall</code></dt><dd><p> ...</p>
</dd>
<dt><code>Meldedatum</code></dt><dd><p>chr  '2020/09/30 00:00:00' '2020/08/24 00:00:00' '2020/09/26 00:00:00' '2020/09/25 00:00:00' ...</p>
</dd>
<dt><code>IdLandkreis</code></dt><dd><p>int  1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 ...</p>
</dd>
<dt><code>Datenstand</code></dt><dd><p>'04.10.2020, 00:00 Uhr' '04.10.2020, 00:00 Uhr' '04.10.2020, 00:00 Uhr' '04.10.2020, 00:00 Uhr' ...</p>
</dd>
<dt><code>NeuerFall</code></dt><dd><p>int  0 0 0 0 0 0 0 0 0 0 ...</p>
</dd>
<dt><code>NeuerTodesfall</code></dt><dd><p>int  -9 -9 -9 -9 -9 -9 -9 -9 -9 -9 ...</p>
</dd>
<dt><code>Refdatum</code></dt><dd><p>chr  '2020/09/30 00:00:00' '2020/08/24 00:00:00' '2020/09/26 00:00:00' '2020/09/21 00:00:00' ...</p>
</dd>
<dt><code>NeuGenesen</code></dt><dd><p>int  -9 0 -9 -9 -9 -9 0 -9 -9 0 ...</p>
</dd>
<dt><code>AnzahlGenesen</code></dt><dd><p>int  0 1 0 0 0 0 1 0 0 1 ...</p>
</dd>
<dt><code>IstErkrankungsbeginn</code></dt><dd><p>int  0 0 0 1 1 0 0 1 0 1 ...</p>
</dd>
<dt><code>Altergruppe2</code></dt><dd><p>chr  'Nicht übermittelt' 'Nicht übermittelt' 'Nicht übermittelt' 'Nicht übermittelt' ...</p>
</dd>
</dl>



<h3>Value</h3>

<p>True if new data was downloaded, otherwise false
</p>

<hr>
<h2 id='vaccineCounts'>Amount of vaccinated people in germany</h2><span id='topic+vaccineCounts'></span>

<h3>Description</h3>

<p>Data: Amount of vaccinated people in germany. Collected by day and state.
Additionally the vaccine-quota (vaccinated/capita) is stored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vaccineCounts
</code></pre>


<h3>Format</h3>

<p>'data.frame':  obs. of  4 variables:
</p>

<dl>
<dt>vaccinated</dt><dd><p>num  311 158 180 232 297 ...</p>
</dd>
<dt>quote</dt><dd><p>num  10.55 17.91 3.19 9.5 17.71 ...</p>
</dd>
<dt>state</dt><dd><p>char Berlin Bayern ...</p>
</dd>
<dt>date</dt><dd><p>date  2020-12-29 2020-12-30 ...</p>
</dd>
</dl>


<hr>
<h2 id='visualizeGraph'>visualizeGraph Visualisierung der Wahrscheinlichkeiten und Dauern</h2><span id='topic+visualizeGraph'></span>

<h3>Description</h3>

<p>Ergebnisse
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualizeGraph(para = babsimHospitalPara(), option = "P")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualizeGraph_+3A_para">para</code></td>
<td>
<p>parameter</p>
</td></tr>
<tr><td><code id="visualizeGraph_+3A_option">option</code></td>
<td>
<p>Option: plot probabilities ('P') or durations ('D')</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
para &lt;- babsimHospitalPara()
visualizeGraph(para = para, option = "P")
</code></pre>

<hr>
<h2 id='visualizeIcu'>visualizeIcu Visualisierung der ICU Daten</h2><span id='topic+visualizeIcu'></span>

<h3>Description</h3>

<p>Quelle: ICU Daten bundesweit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualizeIcu(data = babsim.hospital::icudata, region = 5315)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualizeIcu_+3A_data">data</code></td>
<td>
<p>icu data, e.g., <code><a href="#topic+icudata">icudata</a></code></p>
</td></tr>
<tr><td><code id="visualizeIcu_+3A_region">region</code></td>
<td>
<p>Region: Gemeindeschluessel, <code>int 05374</code> fuer OBK oder
|code05315 fuer Koeln oder <code>05911</code> fuer Bochum.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>data.frame of 9 variables
</p>

<dl>
<dt>bundesland</dt><dd><p> int  1 1 1 1 1 1 1 1 1 1 ...</p>
</dd>
<dt>gemeindeschluessel</dt><dd><p> int  1001 1002 1003 1004 1051 1053 1054 1055 1056 1057 ...</p>
</dd>
<dt>anzahl_meldebereiche</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>faelle_covid_aktuell</dt><dd><p> int  0 3 5 1 3 1 0 0 5 1 ...</p>
</dd>
<dt>faelle_covid_aktuell_beatmet</dt><dd><p> int  0 2 5 1 1 1 0 0 4 0 ...</p>
</dd>
<dt>anzahl_standorte</dt><dd><p> int  2 3 2 1 1 2 1 3 2 1 ...</p>
</dd>
<dt>betten_frei</dt><dd><p> int  44 113 115 19 54 7 7 18 10 7 ...</p>
</dd>
<dt>betten_belegt</dt><dd><p> int  38 110 108 19 26 17 3 34 27 5 ...</p>
</dd>
<dt>daten_stand</dt><dd><p>Date, format: '2020-05-01' '2020-05-01' '2020-05-01' '2020-05-01' ... '2020-08-21'</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+icudata">icudata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("stats")
icu &lt;- babsim.hospital::icudata
icuCov &lt;- as.data.frame(xtabs(faelle_covid_aktuell ~ daten_stand, icu))
icuCov$daten_stand &lt;- as.Date(icuCov$daten_stand)
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBeatm$daten_stand &lt;- as.Date(icuCovBeatm$daten_stand)
dataICUBeds &lt;- data.frame(
  bed = (icuCov$Freq - icuCovBeatm$Freq),
  intensiveBedVentilation = icuCovBeatm$Freq,
  Day = as.Date(icuCovBeatm$daten_stand)
)

require("padr")
require("stats")
icu &lt;- babsim.hospital::icudata
icu &lt;- pad(icu, interval = "day")
icuCov &lt;- as.data.frame(xtabs(faelle_covid_aktuell ~ daten_stand, icu))
icuCovBeatm &lt;- as.data.frame(xtabs(faelle_covid_aktuell_beatmet ~ daten_stand, icu))
icuCovBett &lt;- as.data.frame(xtabs(betten_belegt ~ daten_stand, icu))
plot(icuCov$daten_stand, icuCov$Freq,
  type = "p", xlab = "Tag", ylab = "COVID ",
  main = "COVID-Faelle in Behandlung im KHaus"
)
plot(icuCovBeatm$daten_stand, icuCovBeatm$Freq,
  type = "p", xlab = "Tag",
  ylab = "Patienten", main = "Beatmete COVID-19-Pat. nur invasive Beatmung und ECMO"
)
plot(icuCovBett$daten_stand, icuCovBett$Freq, type = "l", xlab = "Tag", ylab = "ICU Betten belegt")

# Nur Daten des OBK:
icu &lt;- babsim.hospital::icudata
icu &lt;- icu[icu$gemeindeschluessel == 05374, ]
</code></pre>

<hr>
<h2 id='visualizeRki'>visualizeRki Visualisierung der RKI Daten</h2><span id='topic+visualizeRki'></span>

<h3>Description</h3>

<p>Quelle: RKI Daten bundesweit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualizeRki(
  data = babsim.hospital::rkidata,
  region = 5374,
  StartDate = "2020-05-01"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualizeRki_+3A_data">data</code></td>
<td>
<p>rki data, e.g., <code><a href="#topic+rkidata">rkidata</a></code></p>
</td></tr>
<tr><td><code id="visualizeRki_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="visualizeRki_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rkidata">rkidata</a></code>
</p>

<hr>
<h2 id='visualizeRkiEvents'>visualizeRkiEvents Visualisation of the pre-processed RKI Data</h2><span id='topic+visualizeRkiEvents'></span>

<h3>Description</h3>

<p>RKI data as result from <code>getRkiData(babsim.hospital::rkidata)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualizeRkiEvents(
  data = getRkiData(babsim.hospital::rkidata),
  region = 0,
  StartDate = "2020-05-01"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualizeRkiEvents_+3A_data">data</code></td>
<td>
<p>rki data as preprocessed by <code><a href="#topic+getRkiData">getRkiData</a></code></p>
</td></tr>
<tr><td><code id="visualizeRkiEvents_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> oder Bundesland ID, e.g., <code>5</code>.</p>
</td></tr>
<tr><td><code id="visualizeRkiEvents_+3A_startdate">StartDate</code></td>
<td>
<p>Start (Tag), e.g., <code>'2020-05-01'</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getRkiData">getRkiData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- visualizeRkiEvents(getRkiData(babsim.hospital::rkidata[1:1000, ]))
</code></pre>

<hr>
<h2 id='visualizeUK'>visualizeUK</h2><span id='topic+visualizeUK'></span>

<h3>Description</h3>

<p>Anzeigen der UK Daten
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visualizeUK(data, region = 5315)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visualizeUK_+3A_data">data</code></td>
<td>
<p>Date</p>
</td></tr>
<tr><td><code id="visualizeUK_+3A_region">region</code></td>
<td>
<p>Landkreis Id, e.g., <code>5374</code> fuer OBK, <code>5315</code> fuer Koeln,
<code>0</code> fuer Deutschland,
oder Bundesland ID, e.g., <code>5</code> fuer NRW.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
res &lt;- visualizeUK()

## End(Not run)

</code></pre>

<hr>
<h2 id='weighted_rmse'>weighted_rmse</h2><span id='topic+weighted_rmse'></span>

<h3>Description</h3>

<p>Calculate a weighted RMSE. Weights are based on 'time' in the case of the weights variable.
(E.g. older errors weigh less). And also based on the 'direction' e.g. predicting to few used ressources
is worse than predicting a few ressources used too much.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_rmse(
  actual,
  predicted,
  weights = exp(-(length(actual):1)/14),
  worsenGoodExpections = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weighted_rmse_+3A_actual">actual</code></td>
<td>
<p>Real Data, vector of observations</p>
</td></tr>
<tr><td><code id="weighted_rmse_+3A_predicted">predicted</code></td>
<td>
<p>Predicted Data, vector of observations</p>
</td></tr>
<tr><td><code id="weighted_rmse_+3A_weights">weights</code></td>
<td>
<p>Time based decay. Default is an exponential decay</p>
</td></tr>
<tr><td><code id="weighted_rmse_+3A_worsengoodexpections">worsenGoodExpections</code></td>
<td>
<p>Factor by how much predicting too few used ressources should be punished more.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>weighted RMSE
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
