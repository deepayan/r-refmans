<!DOCTYPE html><html lang="en"><head><title>Help for package XLConnect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {XLConnect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#XLConnect-package'>
<p>Excel Connector for R</p></a></li>
<li><a href='#+24-methods'><p>Executing workbook methods in object$method(...) form</p></a></li>
<li><a href='#addImage-methods'><p>Adding images to a worksheet</p></a></li>
<li><a href='#appendNamedRegion-methods'><p>Appending data to a named region</p></a></li>
<li><a href='#appendWorksheet-methods'><p>Appending data to worksheets</p></a></li>
<li><a href='#aref'>
<p>Constructing Excel area references</p></a></li>
<li><a href='#aref2idx'>
<p>Converting Excel cell references to row and column based cell references</p></a></li>
<li><a href='#cellstyle-class'><p>Class &quot;cellstyle&quot;</p></a></li>
<li><a href='#clearNamedRegion-methods'><p>Clearing named regions in a workbook</p></a></li>
<li><a href='#clearRange-methods'><p>Clearing cell ranges in a workbook</p></a></li>
<li><a href='#clearRangeFromReference-methods'><p>Clearing cell ranges in a workbook</p></a></li>
<li><a href='#clearSheet-methods'><p>Clearing worksheets in a workbook</p></a></li>
<li><a href='#cloneSheet-methods'><p>Cloning/copying worksheets</p></a></li>
<li><a href='#col2idx'>
<p>Converting Excel column names to indices</p></a></li>
<li><a href='#createCellStyle-methods'><p>Creating custom named and anonymous cell styles</p></a></li>
<li><a href='#createFreezePane-methods'><p>Creating a freeze pane on a worksheet</p></a></li>
<li><a href='#createName-methods'><p>Creating names in a workbook</p></a></li>
<li><a href='#createSheet-methods'><p>Creating worksheets in a workbook</p></a></li>
<li><a href='#createSplitPane-methods'><p>Creating a split pane on a worksheet</p></a></li>
<li><a href='#cref2idx'>
<p>Converting Excel cell references to indices</p></a></li>
<li><a href='#existsCellStyle-methods'><p>Retrieving named cell styles</p></a></li>
<li><a href='#existsName-methods'><p>Checking existence of named ranges in a workbook</p></a></li>
<li><a href='#existsSheet-methods'><p>Checking for existence of worksheets in a workbook</p></a></li>
<li><a href='#extraction-methods'><p>Workbook data extraction &amp; replacement operators</p></a></li>
<li><a href='#extractSheetName'>
<p>Extracting the sheet name from a formula</p></a></li>
<li><a href='#getActiveSheetIndex-methods'><p>Querying the active worksheet index</p></a></li>
<li><a href='#getActiveSheetName-methods'><p>Querying the active worksheet name</p></a></li>
<li><a href='#getBoundingBox-methods'><p>Querying the coordinates of a worksheet bounding box</p></a></li>
<li><a href='#getCellFormula-methods'><p>Retrieving formula definitions from cells</p></a></li>
<li><a href='#getCellStyle-methods'><p>Retrieving named cell styles</p></a></li>
<li><a href='#getCellStyleForType-methods'><p>Querying the cell style per data type for the DATATYPE style action</p></a></li>
<li><a href='#getDefinedNames-methods'><p>Retrieving defined names in a workbook</p></a></li>
<li><a href='#getForceFormulaRecalculation-methods'><p>Querying the coordinates of the range reference by an Excel name</p></a></li>
<li><a href='#getLastColumn-methods'><p>Querying the last (non-empty) column on a worksheet</p></a></li>
<li><a href='#getLastRow-methods'><p>Querying the last (non-empty) row on a worksheet</p></a></li>
<li><a href='#getOrCreateCellStyle-methods'><p>Retrieving or creating named cell styles</p></a></li>
<li><a href='#getReferenceCoordinates-methods'><p>Querying the coordinates of the range reference by an Excel name</p></a></li>
<li><a href='#getReferenceCoordinatesForName-methods'><p>Querying the coordinates of the range reference by an Excel name</p></a></li>
<li><a href='#getReferenceCoordinatesForTable-methods'><p>Querying the coordinates of the range of an Excel table</p></a></li>
<li><a href='#getReferenceFormula-methods'><p>Querying reference formulas of Excel names</p></a></li>
<li><a href='#getSheetPos-methods'><p>Querying worksheet position</p></a></li>
<li><a href='#getSheets-methods'><p>Querying available worksheets in a workbook</p></a></li>
<li><a href='#getTables-methods'><p>Querying available Excel tables in a workbook</p></a></li>
<li><a href='#hideSheet-methods'><p>Hiding worksheets in a workbook</p></a></li>
<li><a href='#idx2aref'>
<p>Converting row and column based area references to Excel area references</p></a></li>
<li><a href='#idx2col'>
<p>Converting column indices to Excel column names</p></a></li>
<li><a href='#idx2cref'>
<p>Converting indices to Excel cell references</p></a></li>
<li><a href='#isSheetHidden-methods'><p>Checking if worksheets are hidden in a workbook</p></a></li>
<li><a href='#isSheetVeryHidden-methods'><p>Checking if worksheets are very hidden in a workbook</p></a></li>
<li><a href='#isSheetVisible-methods'><p>Checking if worksheets are visible in a workbook</p></a></li>
<li><a href='#jTryCatch'>
<p>Standard Java exception handling for XLConnect</p></a></li>
<li><a href='#loadWorkbook'>
<p>Loading Microsoft Excel workbooks</p></a></li>
<li><a href='#mergeCells-methods'><p>Merging cells</p></a></li>
<li><a href='#mirai'>
<p>Mirai Solutions GmbH</p></a></li>
<li><a href='#normalizeDataframe'>
<p>Data frame Normalization for Unit Tests</p></a></li>
<li><a href='#onErrorCell-methods'><p> Behavior when error cells are detected</p></a></li>
<li><a href='#print-methods'><p> Print a workbook's filename</p></a></li>
<li><a href='#readNamedRegion'><p>Reading named regions from a workbook</p></a></li>
<li><a href='#readNamedRegionFromFile'><p>Reading named regions from an Excel file (wrapper function)</p></a></li>
<li><a href='#readTable'><p>Reading Excel tables from a workbook</p></a></li>
<li><a href='#readWorksheet-methods'><p>Reading data from worksheets</p></a></li>
<li><a href='#readWorksheetFromFile'><p>Reading data from worksheets in an Excel file (wrapper function)</p></a></li>
<li><a href='#removeName-methods'><p>Removing names from workbooks</p></a></li>
<li><a href='#removePane-methods'><p>Removing panes from worksheet</p></a></li>
<li><a href='#removeSheet-methods'><p>Removing worksheets from workbooks</p></a></li>
<li><a href='#renameSheet-methods'><p>Renaming worksheets from workbooks</p></a></li>
<li><a href='#saveWorkbook-methods'><p>Saving Microsoft Excel workbooks</p></a></li>
<li><a href='#setActiveSheet-methods'><p>Setting the active worksheet in a workbook</p></a></li>
<li><a href='#setAutoFilter-methods'><p>Setting auto-filters on worksheets</p></a></li>
<li><a href='#setBorder-methods'><p>Specifying borders for cell styles</p></a></li>
<li><a href='#setCellFormula-methods'><p>Setting cell formulas</p></a></li>
<li><a href='#setCellStyle-methods'><p>Setting cell styles</p></a></li>
<li><a href='#setCellStyleForType-methods'><p>Setting the cell style per data type for the DATATYPE style action</p></a></li>
<li><a href='#setColumnWidth-methods'><p>Setting the width of a column in a worksheet</p></a></li>
<li><a href='#setDataFormat-methods'><p>Specifying custom data formats for cell styles</p></a></li>
<li><a href='#setDataFormatForType-methods'><p>Setting the data format for the DATA_FORMAT_ONLY style action</p></a></li>
<li><a href='#setFillBackgroundColor-methods'><p>Specifying the fill background color for cell styles</p></a></li>
<li><a href='#setFillForegroundColor-methods'><p>Specifying the fill foreground color for cell styles</p></a></li>
<li><a href='#setFillPattern-methods'><p>Specifying the fill pattern for cell styles</p></a></li>
<li><a href='#setForceFormulaRecalculation-methods'><p>Forcing Excel to recalculate formula values when opening a workbook</p></a></li>
<li><a href='#setHyperlink-methods'><p>Setting hyperlinks</p></a></li>
<li><a href='#setMissingValue-methods'><p>Setting missing value identifiers</p></a></li>
<li><a href='#setRowHeight-methods'><p>Setting the height of a row in a worksheet</p></a></li>
<li><a href='#setSheetColor-methods'><p>Setting colors on worksheet tabs</p></a></li>
<li><a href='#setSheetPos-methods'><p>Setting worksheet position</p></a></li>
<li><a href='#setStyleAction-methods'><p>Controlling application of cell styles when writing data to Excel</p></a></li>
<li><a href='#setStyleNamePrefix-methods'><p>Setting the style name prefix for the &quot;name prefix&quot; style action</p></a></li>
<li><a href='#setWrapText-methods'><p>Specifying text wrapping behaviour</p></a></li>
<li><a href='#show-methods'><p>Display a workbook object</p></a></li>
<li><a href='#summary-methods'><p> Summarizing workbook objects</p></a></li>
<li><a href='#swissfranc'><p>Historical Exchange Rates: CHF vs EUR, USD and GBP</p></a></li>
<li><a href='#unhideSheet-methods'><p>Unhiding worksheets in a workbook</p></a></li>
<li><a href='#unmergeCells-methods'><p>Unmerging cells</p></a></li>
<li><a href='#with.workbook'><p>Evaluate an R expression in a workbook environment</p></a></li>
<li><a href='#workbook-class'><p>Class &quot;workbook&quot;</p></a></li>
<li><a href='#wrapList'>
<p>Wrapping of arguments in a list</p></a></li>
<li><a href='#writeNamedRegion-methods'><p>Writing named regions to a workbook</p></a></li>
<li><a href='#writeNamedRegionToFile'><p>Writing named regions to an Excel file (wrapper function)</p></a></li>
<li><a href='#writeWorksheet-methods'><p>Writing data to worksheets</p></a></li>
<li><a href='#writeWorksheetToFile'><p>Writing data to worksheets in an Excel file (wrapper function)</p></a></li>
<li><a href='#XLC'>
<p>XLConnect Constants</p></a></li>
<li><a href='#xlcCall'>
<p>Automatic argument vectorization, default Java exception and warnings handling for XLConnect</p></a></li>
<li><a href='#xlcDump'>
<p>Dumping data sets to Excel files</p></a></li>
<li><a href='#xlcEdit'>
<p>Editing data sets in an Excel file editor</p></a></li>
<li><a href='#xlcFreeMemory'>
<p>Freeing Java Virtual Machine memory</p></a></li>
<li><a href='#xlcMemoryReport'>
<p>Reporting free Java Virtual Machine memory</p></a></li>
<li><a href='#XLConnect-deprecated'><p>Deprecated functions in package <span class="pkg">XLConnect</span></p></a></li>
<li><a href='#XLConnectSettings'>
<p>Performing general settings for XLConnect</p></a></li>
<li><a href='#xlcRestore'>
<p>Restoring objects from Excel files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Excel Connector for R</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
<a href="https://github.com/miraisolutions/xlconnect">https://github.com/miraisolutions/xlconnect</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/miraisolutions/xlconnect/issues">https://github.com/miraisolutions/xlconnect/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Java (&gt;= 8)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, rJava (&ge; 1.0-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit, lattice, ggplot2 (&ge; 0.9.3), zoo</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides comprehensive functionality to read, write and format Excel data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>See file COPYRIGHTS</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-17 14:45:17 UTC; mstuder</td>
</tr>
<tr>
<td>Author:</td>
<td>Mirai Solutions GmbH [aut],
  Martin Studer [cre],
  The Apache Software Foundation [ctb, cph] (Apache POI),
  Graph Builder [ctb, cph] (Curvesapi Java library),
  Brett Woolridge [ctb, cph] (SparseBitSet Java library)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Studer &lt;martin.studer@mirai-solutions.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-18 09:10:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='XLConnect-package'>
Excel Connector for R
</h2><span id='topic+XLConnect-package'></span><span id='topic+XLConnect'></span>

<h3>Description</h3>

<p>Provides comprehensive functionality to read, write and format Excel data.
</p>


<h3>Details</h3>

<p>For an overview over the package please refer to the available demos:<br />
<code>demo(package = "XLConnect")</code>
</p>


<h3>Author(s)</h3>

<p>Mirai Solutions GmbH, <a href="mailto:xlconnect@mirai-solutions.com">xlconnect@mirai-solutions.com</a>
</p>


<h3>References</h3>

<p>Mirai Solutions GmbH: <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a><br />
XLConnect on GitHub: <a href="https://github.com/miraisolutions/xlconnect">https://github.com/miraisolutions/xlconnect</a>
Mirai Solutions on GitHub: <a href="https://github.com/miraisolutions">https://github.com/miraisolutions</a><br />
Apache POI: <a href="https://poi.apache.org">https://poi.apache.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook; create if not existing
wb &lt;- loadWorkbook("XLConnect.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "mtcars")

# Create a name reference
createName(wb, name = "mtcars", formula = "mtcars!$C$5")

# Write built-in data.frame 'mtcars' to the specified named region
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook
saveWorkbook(wb)

# clean up 
file.remove("XLConnect.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='+24-methods'>Executing workbook methods in object$method(...) form</h2><span id='topic++24'></span><span id='topic++24-methods'></span><span id='topic++24+2Cworkbook-method'></span><span id='topic++24+2Ccellstyle-method'></span>

<h3>Description</h3>

<p>Allows to execute <code><a href="#topic+workbook-class">workbook</a></code> methods in <code>workbook-object$method(...)</code> form.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B24-methods_+3A_x">x</code></td>
<td>
<p>The object (<code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>) to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x$method(...)</code> (where <code>x</code> is a <code><a href="#topic+workbook-class">workbook</a></code>-object) is equivalent to <code>method(x, ...)</code>
</p>


<h3>Note</h3>

<p>The <code><a href="#topic+workbook-class">workbook</a></code> <code>$</code>-operator allows to call <code><a href="#topic+workbook-class">workbook</a></code>-methods in <code>workbook-object$method(...)</code> form. 
This form might be considered more convenient or readable for programmers coming from other object-oriented languages such as Java, C#, ...
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("dollar.xlsx", create = TRUE)

# Create a worksheet called 'CO2'
wb$createSheet(name = "CO2")

# Write built-in data set 'CO2' to the worksheet created above
wb$writeWorksheet(CO2, sheet = "CO2", startRow = 4, startCol = 2)

# Save workbook
wb$saveWorkbook()

# clean up 
file.remove("dollar.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='addImage-methods'>Adding images to a worksheet</h2><span id='topic+addImage'></span><span id='topic+addImage-methods'></span><span id='topic+addImage+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Adds an image to a worksheet using a named region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S4 method for signature 'workbook'
addImage(object, filename, name, originalSize, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addImage-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="addImage-methods_+3A_filename">filename</code></td>
<td>
<p>Name of the image file. Supported are images of
the following formats: JPG/JPEG, PNG, WMF, EMF, BMP, PICT.</p>
</td></tr>
<tr><td><code id="addImage-methods_+3A_name">name</code></td>
<td>
<p>Name of the named region that the image is set to</p>
</td></tr>
<tr><td><code id="addImage-methods_+3A_originalsize">originalSize</code></td>
<td>
<p>If <code>originalSize = TRUE</code>, the image is
inserted in the top left corner of the named region and not
scaled. Otherwise, the image is scaled to fit the named region.
The default value for <code>originalSize</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="addImage-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the name of the worksheet in which the name is scoped;
useful if different sheets have scoped regions with the same name.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>There is an known issue in Apache POI with adding images to xls workbooks. The result of adding
images to workbooks that already contain shapes or images may be that previous images are
removed or that existing images are replaced with newly added ones. It is therefore advised that
you use the <code>addImage</code> functionality only with workbooks that have no existing shapes or images.
Note that this only holds for xls workbooks (Excel 97-2003) and not for xlsx (Excel 2007+). There should
be no issues with xlsx workbooks.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Write an R plot to a specified named region
## This example makes use of the 'Tonga Trench Earthquakes' example

# Load workbook (create if not existing)
wb &lt;- loadWorkbook("earthquake.xlsx", create = TRUE)

# Create a sheet named 'earthquake'
createSheet(wb, name = "earthquake")

# Create a named region called 'earthquake' referring to the sheet
# called 'earthquake' 
createName(wb, name = "earthquake", formula = "earthquake!$B$2")

# Create R plot to a png device
require(lattice)
png(filename = "earthquake.png", width = 800, height = 600)
devAskNewPage(ask = FALSE)

Depth &lt;- equal.count(quakes$depth, number=8, overlap=.1)
xyplot(lat ~ long | Depth, data = quakes)
update(trellis.last.object(),
       strip = strip.custom(strip.names = TRUE, strip.levels = TRUE),
       par.strip.text = list(cex = 0.75),
       aspect = "iso")

dev.off()

# Write image to the named region created above using the image's
# original size; i.e. the image's top left corner will match the
# specified cell's top left corner 
addImage(wb, filename = "earthquake.png", name = "earthquake",
         originalSize = TRUE)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("earthquake.xlsx")
file.remove("earthquake.png")

## End(Not run)
</code></pre>

<hr>
<h2 id='appendNamedRegion-methods'>Appending data to a named region</h2><span id='topic+appendNamedRegion'></span><span id='topic+appendNamedRegion-methods'></span><span id='topic+appendNamedRegion+2Cworkbook-method'></span><span id='topic+appendNamedRegion+2Cworkbook+2CANY-method'></span>

<h3>Description</h3>

<p>Appends data to an existing named region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,ANY'
appendNamedRegion(object,data,name,header,overwriteFormulaCells,rownames,worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="appendNamedRegion-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_data">data</code></td>
<td>
<p>Data to write</p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_name">name</code></td>
<td>
<p>Name of the (existing) named region to which to append the <code>data</code></p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_header">header</code></td>
<td>
<p>Specifies if the column names should be written. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_overwriteformulacells">overwriteFormulaCells</code></td>
<td>
<p>Specifies if existing formula cells in the <code><a href="#topic+workbook-class">workbook</a></code>
should be overwritten. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_rownames">rownames</code></td>
<td>
<p>Name (<code>character</code>) of column to use for the row names of the provided
<code>data</code> object. If specified, the row names of the data object (<code>data.frame</code>) will be
included as an additional column with the specified name. If <code>rownames = NULL</code> (default),
no row names will be included.</p>
</td></tr>
<tr><td><code id="appendNamedRegion-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional character vector with worksheet name(s) to target a <code>name</code>
defined in the specified sheet(s) only. If not specified, the first matching named region is
appended to. Use <code>""</code> to specifically target a globally-scoped named region.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Appends <code>data</code> to the existing named region specified by <code>name</code>. The <code>data</code> is
appended at the bottom of the named region. See <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
for further information on writing named regions.
</p>


<h3>Note</h3>

<p>Named regions are automatically redefined to the area occupied by the
previous and the newly appended data. This guarantees that the complete set 
of data can be re-read using <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>.
Note however, that no checks are performed to see whether the appended data has the
same shape/structure as the previous data.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+appendWorksheet-methods">appendWorksheet</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Append mtcars data set to named region named 'mtcars'
appendNamedRegion(wb, mtcars, name = "mtcars")

## End(Not run)
</code></pre>

<hr>
<h2 id='appendWorksheet-methods'>Appending data to worksheets</h2><span id='topic+appendWorksheet'></span><span id='topic+appendWorksheet-methods'></span><span id='topic+appendWorksheet+2Cworkbook+2CANY+2Ccharacter-method'></span><span id='topic+appendWorksheet+2Cworkbook+2CANY+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Appends data to worksheets of a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,ANY,character'
appendWorksheet(object,data,sheet,header,rownames)
## S4 method for signature 'workbook,ANY,numeric'
appendWorksheet(object,data,sheet,header,rownames)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="appendWorksheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to write to</p>
</td></tr>
<tr><td><code id="appendWorksheet-methods_+3A_data">data</code></td>
<td>
<p>Data to append</p>
</td></tr>
<tr><td><code id="appendWorksheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to append the <code>data</code> to</p>
</td></tr>
<tr><td><code id="appendWorksheet-methods_+3A_header">header</code></td>
<td>
<p>Specifies if the column names should be written. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="appendWorksheet-methods_+3A_rownames">rownames</code></td>
<td>
<p>Name (<code>character</code>) of column to use for the row names of the provided
<code>data</code> object. If specified, the row names of the data object (<code>data.frame</code>) will be
included as an additional column with the specified name. If <code>rownames = NULL</code> (default),
no row names will be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Appends <code>data</code> to the worksheet specified by <code>sheet</code>. Data will be appended at the
bottom and left most column containing some data. If more complex &quot;appending schemes&quot; are required
you may make direct use of <code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+appendNamedRegion-methods">appendNamedRegion</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Append mtcars data set to worksheet named 'mtcars'
appendWorksheet(wb, mtcars, sheet = "mtcars")

## End(Not run)
</code></pre>

<hr>
<h2 id='aref'>
Constructing Excel area references
</h2><span id='topic+aref'></span>

<h3>Description</h3>

<p>Constructs an Excel area reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aref(topLeft, dimension)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aref_+3A_topleft">topLeft</code></td>
<td>
<p>Top left corner. Either a <code>character</code> specifying a cell reference in the
form &quot;A1&quot; or a <code>numeric</code> vector of length two specifying the corresponding coordinates.</p>
</td></tr>
<tr><td><code id="aref_+3A_dimension">dimension</code></td>
<td>
<p>Dimensions (<code>numeric</code>) of a 2-dimensional object 
(mostly a <code>data.frame</code> or a <code>matrix</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the area reference (<code>character</code>) for the specified top left cell and dimension.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+idx2aref">idx2aref</a></code>,
<code><a href="#topic+idx2cref">idx2cref</a></code>, <code><a href="#topic+col2idx">col2idx</a></code>, <code><a href="#topic+idx2col">idx2col</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
aref("A1", dim(mtcars))
aref(c(1, 1), dim(mtcars))

## End(Not run)
</code></pre>

<hr>
<h2 id='aref2idx'>
Converting Excel cell references to row and column based cell references
</h2><span id='topic+aref2idx'></span>

<h3>Description</h3>

<p>Converts Excel cell references to row and column based cell references
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aref2idx(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aref2idx_+3A_x">x</code></td>
<td>
<p><code>Character</code> vector of Excel cell references (e.g. &quot;A1:B6&quot;, &quot;B6:C17&quot;, ...)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric matrix with four columns and as many rows as cell references that have
been provided. The first two columns represent the coordinates of the top left corner (row, column)
and the third and fourth columns represent the bottom right corner of the referenced area.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idx2aref">idx2aref</a></code>, <code><a href="#topic+aref">aref</a></code>, <code><a href="#topic+cref2idx">cref2idx</a></code>,
<code><a href="#topic+idx2cref">idx2cref</a></code>, <code><a href="#topic+col2idx">col2idx</a></code>, <code><a href="#topic+idx2col">idx2col</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
aref2idx(c("A1:B6", "B6:C17"))

## End(Not run)
</code></pre>

<hr>
<h2 id='cellstyle-class'>Class &quot;cellstyle&quot;</h2><span id='topic+cellstyle-class'></span>

<h3>Description</h3>

<p>This class represents a cell style in a Microsoft Excel <code><a href="#topic+workbook-class">workbook</a></code>. S4 objects of this class
and corresponding methods are used to manipulate cell styles. This includes setting data formats,
borders, background- and foreground-colors, etc.
</p>


<h3>Objects from the Class</h3>

<p>Cell styles are created by calling the <code><a href="#topic+createCellStyle-methods">createCellStyle</a></code> method on a
<code><a href="#topic+workbook-class">workbook</a></code> object.
</p>


<h3>Slots</h3>


<dl>
<dt><code>jobj</code>:</dt><dd><p>Object of class <code>jobjRef</code> (see package <span class="pkg">rJava</span>) which represents a Java object reference that is used
in the back-end to manipulate the underlying Excel cell style instance.</p>
</dd>
</dl>



<h3>Note</h3>

<p><span class="pkg">XLConnect</span> generally makes use of custom (named) cell styles. This allows users to more easily manage cell styles via Excel's cell style
menu. For example, assuming you were using a specific custom cell style for your data table headers, you can change the header
styling with a few clicks in Excel's cell style menu across all tables.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>Apply, create, or remove a cell style:<br />
<a href="https://support.microsoft.com/en-us/office/apply-create-or-remove-a-cell-style-472213bf-66bd-40c8-815c-594f0f90cd22?ocmsassetid=hp001216732&amp;correlationid=5691ac73-b7a2-40c3-99aa-a06e806bb566&amp;ui=en-us&amp;rs=en-us&amp;ad=us">https://support.microsoft.com/en-us/office/apply-create-or-remove-a-cell-style-472213bf-66bd-40c8-815c-594f0f90cd22?ocmsassetid=hp001216732&amp;correlationid=5691ac73-b7a2-40c3-99aa-a06e806bb566&amp;ui=en-us&amp;rs=en-us&amp;ad=us</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>, <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>,
<code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("cellstyles.xlsx", create = TRUE)

# We don't set a specific style action in this demo, so the 
# default 'XLConnect' will be used (XLC$"STYLE_ACTION.XLCONNECT")

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' referring to the sheet
# called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$C$4")

# Write built-in data set 'mtcars' to the above defined named region.
# This will use the default style action 'XLConnect'.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Now let's color all weight cells of cars with a weight &gt; 3.5 in red
# (mtcars$wt &gt; 3.5)

# First, create a corresponding (named) cell style
heavyCar &lt;- createCellStyle(wb, name = "HeavyCar")

# Specify the cell style to use a solid foreground color
setFillPattern(heavyCar, fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(heavyCar, color = XLC$"COLOR.RED")

# Which cars have a weight &gt; 3.5 ?
rowIndex &lt;- which(mtcars$wt &gt; 3.5)

# NOTE: The mtcars data.frame has been written offset with top 
# left cell C4 - and we have also written a header row!
# So, let's take that into account appropriately. Obviously,
# the two steps could be combined directly into one ...
rowIndex &lt;- rowIndex + 4

# The same holds for the column index
colIndex &lt;- which(names(mtcars) == "wt") + 2

# Set the 'HeavyCar' cell style for the corresponding cells.
# Note: the row and col arguments are vectorized!
setCellStyle(wb, sheet = "mtcars", row = rowIndex, col = colIndex,
             cellstyle = heavyCar)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("cellstyles.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='clearNamedRegion-methods'>Clearing named regions in a workbook</h2><span id='topic+clearNamedRegion'></span><span id='topic+clearNamedRegion-methods'></span><span id='topic+clearNamedRegion+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Clears named regions in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S4 method for signature 'workbook,character'
clearNamedRegion(object, name, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clearNamedRegion-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="clearNamedRegion-methods_+3A_name">name</code></td>
<td>
<p>The name of the named region to clear</p>
</td></tr>
<tr><td><code id="clearNamedRegion-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the name of the worksheet in which the region is scoped;
useful if different sheets have scoped regions with the same name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Clearing a named region/range means to clear all the cells associated with that named
region. Clearing named regions can be useful if (named) data sets in a worksheet need 
to be replaced, i.e. data is first read, modified in R and finally written back to the 
the same named region. Without clearing the named region first, (parts of) the original 
data may still be visible if they occupied a larger range in the worksheet.
</p>
<p>If <code>worksheetScope</code> is unspecified, the first matching name found anywhere in the workbook
will be cleared. Otherwise, only a name specifically scoped to the worksheet may be cleared.
To only clear a name in global scope, pass <code>""</code> as the value.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+clearSheet-methods">clearSheet</a></code>, 
<code><a href="#topic+clearRange-methods">clearRange</a></code>, 
<code><a href="#topic+clearRangeFromReference-methods">clearRangeFromReference</a></code>,
<code><a href="#topic+clearSheet-methods">clearSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
# mtcars xlsx file from demoFiles subfolder of 
# package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", 
                             package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read named region 'mtcars'
data &lt;- readNamedRegion(wb, name = "mtcars", header = TRUE)

# Only consider cars with a weight &gt;= 5
data &lt;- data[data$wt &gt;= 5, ]

# Clear original named region
clearNamedRegion(wb, name = "mtcars")

# Write subsetted data back
# Note: this is covering a smaller area now -
# writeNamedRegion automatically redefines the named region
# to the size/area of the data
writeNamedRegion(wb, data = data, name = "mtcars",
                 header = TRUE) 

## End(Not run) 
</code></pre>

<hr>
<h2 id='clearRange-methods'>Clearing cell ranges in a workbook</h2><span id='topic+clearRange'></span><span id='topic+clearRange-methods'></span><span id='topic+clearRange+2Cworkbook+2Cnumeric-method'></span><span id='topic+clearRange+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Clears cell ranges in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S4 method for signature 'workbook,numeric'
clearRange(object, sheet, coords)
  ## S4 method for signature 'workbook,character'
clearRange(object, sheet, coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clearRange-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="clearRange-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the worksheet in which to clear
cell ranges</p>
</td></tr>
<tr><td><code id="clearRange-methods_+3A_coords">coords</code></td>
<td>
<p>Numeric vector of length 4 or numeric matrix with 4 columns
where the elements of the vector or rows in the matrix refer to
the coordinates of the top-left and bottom-right corners of the ranges
to clear. I.e. a vector or each row specifies the coordinates
{top row, left column, bottom row, right column}. You may use
<code><a href="#topic+aref2idx">aref2idx</a></code> to generate such a matrix. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Clearing a cell range means to clear all the cells associated with that range.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+clearSheet-methods">clearSheet</a></code>, 
<code><a href="#topic+clearNamedRegion-methods">clearNamedRegion</a></code>, 
<code><a href="#topic+clearRangeFromReference-methods">clearRangeFromReference</a></code>,
<code><a href="#topic+clearSheet-methods">clearSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of 
# package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", 
                             package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Clear range from top left corner (4,2) ^= B4 to
# bottom right corner (6,4) ^= D6
clearRange(wb, sheet = "mtcars", coords = c(4, 2, 6, 4))

# Clear two ranges in one go ...
mat = matrix(c(5, 1, 6, 4, 5, 7, 7, 9), ncol = 4,
             byrow = TRUE)
clearRange(wb, sheet = "mtcars", coords = mat)

# The above is equivalent to ...
clearRange(wb, sheet = "mtcars",
           coords = aref2idx(c("A5:D6", "G5:I7")))
           
# This in turn is the same as ...
clearRangeFromReference(wb, reference = c("mtcars!A5:D6",
                        "mtcars!G5:I7"))

## End(Not run)
</code></pre>

<hr>
<h2 id='clearRangeFromReference-methods'>Clearing cell ranges in a workbook</h2><span id='topic+clearRangeFromReference'></span><span id='topic+clearRangeFromReference-methods'></span><span id='topic+clearRangeFromReference+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Clears cell ranges specified by area reference in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S4 method for signature 'workbook,character'
clearRangeFromReference(object, reference)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clearRangeFromReference-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="clearRangeFromReference-methods_+3A_reference">reference</code></td>
<td>
<p><code>character</code> specifying an area reference in
the form 'SheetX!A7:B19'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Clearing a cell range means to clear all the cells associated with that range. This
method is very similar to <code><a href="#topic+clearRange-methods">clearRange</a></code>.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+clearSheet-methods">clearSheet</a></code>, 
<code><a href="#topic+clearNamedRegion-methods">clearNamedRegion</a></code>, 
<code><a href="#topic+clearRange-methods">clearRange</a></code>,
<code><a href="#topic+clearSheet-methods">clearSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of 
# package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", 
                             package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Clear ranges A5:D6 and G5:I7 on sheet mtcars
clearRangeFromReference(wb, reference = c("mtcars!A5:D6",
                        "mtcars!G5:I7"))

## End(Not run)
</code></pre>

<hr>
<h2 id='clearSheet-methods'>Clearing worksheets in a workbook</h2><span id='topic+clearSheet'></span><span id='topic+clearSheet-methods'></span><span id='topic+clearSheet+2Cworkbook+2Cnumeric-method'></span><span id='topic+clearSheet+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Clears worksheets with specified names or indices in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S4 method for signature 'workbook,numeric'
clearSheet(object, sheet)
  ## S4 method for signature 'workbook,character'
clearSheet(object, sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clearSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="clearSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or the index of the worksheet to clear</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Clearing a worksheet means to clear all the cells in that worksheet. Consequently,
the saved workbook should be smaller in size. Clearing a worksheet can be useful
if data sets in a worksheet need to be replaced, i.e. data are first read, modified
in R and finally written back to the worksheet. Without clearing the worksheet first, 
(parts of) the original data may still be visible if they occupied a larger range of 
the worksheet.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+clearNamedRegion-methods">clearNamedRegion</a></code>, 
<code><a href="#topic+clearRange-methods">clearRange</a></code>, 
<code><a href="#topic+clearRangeFromReference-methods">clearRangeFromReference</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of 
# package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", 
                             package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Clear worksheets named 'mtcars' and 'mtcars2'
clearSheet(wb, sheet = c("mtcars", "mtcars2"))

# Clear 3rd worksheet
clearSheet(wb, sheet = 3) 

## End(Not run)
</code></pre>

<hr>
<h2 id='cloneSheet-methods'>Cloning/copying worksheets</h2><span id='topic+cloneSheet'></span><span id='topic+cloneSheet-methods'></span><span id='topic+cloneSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+cloneSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Clones (copies) a worksheet in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,numeric'
cloneSheet(object,sheet,name)
## S4 method for signature 'workbook,character'
cloneSheet(object,sheet,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cloneSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="cloneSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the worksheet to clone</p>
</td></tr>
<tr><td><code id="cloneSheet-methods_+3A_name">name</code></td>
<td>
<p>The name to assign to the cloned worksheet. Throws an exception if the name to assign
is the name of an already existing worksheet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any worksheet-scoped named ranges are present on the original <code>sheet</code>, these named ranges will not be present on the cloned worksheet.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+removeSheet-methods">removeSheet</a></code>, <code><a href="#topic+renameSheet-methods">renameSheet</a></code>,
<code><a href="#topic+getSheets-methods">getSheets</a></code>, <code><a href="#topic+existsSheet-methods">existsSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Clone the 'mtcars' worksheet and assign it the name 'mtcars cloned'
cloneSheet(wb, sheet = "mtcars", name = "mtcars cloned")

## End(Not run)
</code></pre>

<hr>
<h2 id='col2idx'>
Converting Excel column names to indices
</h2><span id='topic+col2idx'></span>

<h3>Description</h3>

<p>Converts Excel column names to indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2idx(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="col2idx_+3A_x">x</code></td>
<td>
<p>Character vector of Excel column names (e.g. &quot;A&quot;, &quot;AF&quot;, ...)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of integers representing the corresponding column indices.
Note that passing invalid column name references may result in an arbitrary number.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idx2col">idx2col</a></code>, <code><a href="#topic+cref2idx">cref2idx</a></code>, <code><a href="#topic+idx2cref">idx2cref</a></code>,
<code><a href="#topic+idx2aref">idx2aref</a></code>, <code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+aref">aref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
col2idx(c("A", "BTG"))

## End(Not run)
</code></pre>

<hr>
<h2 id='createCellStyle-methods'>Creating custom named and anonymous cell styles</h2><span id='topic+createCellStyle'></span><span id='topic+createCellStyle-methods'></span><span id='topic+createCellStyle+2Cworkbook+2Ccharacter-method'></span><span id='topic+createCellStyle+2Cworkbook+2Cmissing-method'></span>

<h3>Description</h3>

<p>Creates a custom named or anonymous <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
createCellStyle(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createCellStyle-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="createCellStyle-methods_+3A_name">name</code></td>
<td>
<p>The name of the new <code><a href="#topic+cellstyle-class">cellstyle</a></code> to create. Omit
to create an anonymous <code><a href="#topic+cellstyle-class">cellstyle</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a named <code><a href="#topic+cellstyle-class">cellstyle</a></code> with the specified <code>name</code>. Named cell
styles may be used in conjunction with the <em>name prefix</em> style
action (see <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>) or
may also be used directly with the method
<code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>. Named cell styles can
easily be changed from within Excel using the cell styles menu.
</p>
<p>If <code>name</code> is missing, an anonymous cell style is created.
Anonymous cell styles can be used in conjunction with the
<code><a href="#topic+setCellStyle-methods">setCellStyle</a></code> method.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+getOrCreateCellStyle-methods">getOrCreateCellStyle</a></code>,
<code><a href="#topic+existsCellStyle-methods">existsCellStyle</a></code>, <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>,
<code><a href="#topic+setStyleNamePrefix-methods">setStyleNamePrefix</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>,
<code><a href="#topic+setDataFormat-methods">setDataFormat</a></code>, <code><a href="#topic+setBorder-methods">setBorder</a></code>,
<code><a href="#topic+setFillBackgroundColor-methods">setFillBackgroundColor</a></code>, <code><a href="#topic+setFillForegroundColor-methods">setFillForegroundColor</a></code>,
<code><a href="#topic+setFillPattern-methods">setFillPattern</a></code>, <code><a href="#topic+setWrapText-methods">setWrapText</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("createCellstyles.xlsx", create = TRUE)

# We don't set a specific style action in this demo, so the 
# default 'XLConnect' will be used (XLC$"STYLE_ACTION.XLCONNECT")

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' referring to the sheet
# called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$C$4")

# Write built-in data set 'mtcars' to the above defined named region.
# This will use the default style action 'XLConnect'.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Now let's color all weight cells of cars with a weight &gt; 3.5 in red
# (mtcars$wt &gt; 3.5)

# First, create a corresponding (named) cell style
heavyCar &lt;- createCellStyle(wb, name = "HeavyCar")

# Specify the cell style to use a solid foreground color
setFillPattern(heavyCar, fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(heavyCar, color = XLC$"COLOR.RED")

# Which cars have a weight &gt; 3.5 ?
rowIndex &lt;- which(mtcars$wt &gt; 3.5)

# NOTE: The mtcars data.frame has been written offset with 
# top left cell C4 - and we have also written a header row!
# So, let's take that into account appropriately. Obviously, 
# the two steps could be combined directly into one ...
rowIndex &lt;- rowIndex + 4

# The same holds for the column index
colIndex &lt;- which(names(mtcars) == "wt") + 2

# Set the 'HeavyCar' cell style for the corresponding cells.
# Note: the row and col arguments are vectorized!
setCellStyle(wb, sheet = "mtcars", row = rowIndex, col = colIndex, 
             cellstyle = heavyCar)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("createCellstyles.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='createFreezePane-methods'>Creating a freeze pane on a worksheet</h2><span id='topic+createFreezePane'></span><span id='topic+createFreezePane-methods'></span><span id='topic+createFreezePane+2Cworkbook+2Ccharacter-method'></span><span id='topic+createFreezePane+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Creates a freeze pane on a specified worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
createFreezePane(object, sheet, colSplit, rowSplit, leftColumn, topRow)
## S4 method for signature 'workbook,numeric'
createFreezePane(object, sheet, colSplit, rowSplit, leftColumn, topRow)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createFreezePane-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="createFreezePane-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to create a freeze pane</p>
</td></tr>
<tr><td><code id="createFreezePane-methods_+3A_colsplit">colSplit</code></td>
<td>
<p>Horizontal position of freeze (as column index or name)</p>
</td></tr>
<tr><td><code id="createFreezePane-methods_+3A_rowsplit">rowSplit</code></td>
<td>
<p>Vertical position of freeze (as number of rows)</p>
</td></tr>
<tr><td><code id="createFreezePane-methods_+3A_leftcolumn">leftColumn</code></td>
<td>
<p>Left column (as column index or name) visible in right pane. If not specified, the default is <code>leftColumn</code>=<code>colSplit</code></p>
</td></tr>
<tr><td><code id="createFreezePane-methods_+3A_toprow">topRow</code></td>
<td>
<p>Top row (as index) visible in bottom pane. If not specified, the default is <code>topRow</code>=<code>rowSplit</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>To keep an area of a worksheet visible while you scroll to another area of the worksheet,
you can lock specific rows or columns in one area by freezing or splitting panes.
</p>
<p>When you freeze panes, you keep specific rows or columns visible when you scroll in the worksheet.
For example, you might want to keep row and column labels visible as you scroll.
</p>
<p>When you split panes, you create separate worksheet areas that you can scroll within,
while rows or columns in the non-scrolled area remain visible.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>How to create a freeze pane/split pane in Office 2007
<a href="https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us">https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
<code><a href="#topic+createSplitPane-methods">createSplitPane</a></code>
<code><a href="#topic+removePane-methods">removePane</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("freezePaneTest.xlsx", create = TRUE)

# Create a worksheet named 'Sheet1'
createSheet(wb, name = "Sheet1")

# Create a freeze pane on Sheet1, using as reference position the 5th column and the 5th row,
# showing the 10th column as the leftmost visible one in the right pane
# and the 10th row as the top visible one in the bottom pane.
createFreezePane(wb, "Sheet1", 5, 5, 10, 10)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("freezePaneTest.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='createName-methods'>Creating names in a workbook</h2><span id='topic+createName'></span><span id='topic+createName-methods'></span><span id='topic+createName+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Creates a named range for a specified formula in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
createName(object, name, formula, overwrite, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createName-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="createName-methods_+3A_name">name</code></td>
<td>
<p>The name of the range to be created</p>
</td></tr>
<tr><td><code id="createName-methods_+3A_formula">formula</code></td>
<td>
<p>Excel formula specifying the value / data the name refers to</p>
</td></tr>
<tr><td><code id="createName-methods_+3A_overwrite">overwrite</code></td>
<td>
<p>If a name with the same <code>name</code> already exists
and <code>overwrite = TRUE</code>, then this name is removed first before
the new one is created. If a name already exists and
<code>overwrite = FALSE</code>, then an exception is thrown. The default
value for <code>overwrite</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="createName-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - specific worksheet the name should be scoped to. 
If unspecified the name will be scoped to the whole workbook.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a named range called <code>name</code> for the specified <code>formula</code>. 
</p>
<p>The <code>formula</code> should be specified as you would type it
in Excel. Make sure that the worksheets, functions, ...
exist that you are referring to in the <code>formula</code>.
</p>
<p>The <code>name</code>, <code>formula</code> and <code>overwrite</code> arguments are
vectorized such that multiple names can be created in one method call.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>What are named regions/ranges?<br />
<a href="https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm">https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm</a><br />
How to create named regions/ranges?<br />
<a href="https://www.youtube.com/watch?v=iAE9a0uRtpM">https://www.youtube.com/watch?v=iAE9a0uRtpM</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+removeName-methods">removeName</a></code>,
<code><a href="#topic+existsName-methods">existsName</a></code>,
<code><a href="#topic+getDefinedNames-methods">getDefinedNames</a></code>,<br />
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("createName.xlsx", create = TRUE)

# Create a worksheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' on the sheet called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$A$1")

# Write built-in data set 'mtcars' to the above defined named region
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook
saveWorkbook(wb)

# clean up 
file.remove("createName.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='createSheet-methods'>Creating worksheets in a workbook</h2><span id='topic+createSheet'></span><span id='topic+createSheet-methods'></span><span id='topic+createSheet+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Creates worksheets with specified names in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S4 method for signature 'workbook'
createSheet(object, name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="createSheet-methods_+3A_name">name</code></td>
<td>
<p>The name of the sheet to create</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a worksheet with the specified <code>name</code> if it does not
already exist. Note that the naming of worksheets needs to be in line
with Excel's convention, otherwise an exception will be thrown. For
example, worksheet names cannot be longer than 31 characters. Also note
that the <code>name</code> argument is vectorized, so multiple worksheets can
be created in one method call.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+removeSheet-methods">removeSheet</a></code>, 
<code><a href="#topic+renameSheet-methods">renameSheet</a></code>,
<code><a href="#topic+existsSheet-methods">existsSheet</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>,
<code><a href="#topic+cloneSheet-methods">cloneSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("createSheet.xlsx", create = TRUE)

# Create a worksheet called 'CO2'
createSheet(wb, name = "CO2")

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("createSheet.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='createSplitPane-methods'>Creating a split pane on a worksheet</h2><span id='topic+createSplitPane'></span><span id='topic+createSplitPane-methods'></span><span id='topic+createSplitPane+2Cworkbook+2Ccharacter-method'></span><span id='topic+createSplitPane+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Creates a split pane on a specified worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
createSplitPane(object,sheet,xSplitPos,ySplitPos,leftColumn,topRow)
## S4 method for signature 'workbook,numeric'
createSplitPane(object,sheet,xSplitPos,ySplitPos,leftColumn,topRow)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createSplitPane-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="createSplitPane-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to create a split pane</p>
</td></tr>
<tr><td><code id="createSplitPane-methods_+3A_xsplitpos">xSplitPos</code></td>
<td>
<p>Horizontal position of split (in 1/20th of a point)</p>
</td></tr>
<tr><td><code id="createSplitPane-methods_+3A_ysplitpos">ySplitPos</code></td>
<td>
<p>Vertical position of split (in 1/20th of a point)</p>
</td></tr>
<tr><td><code id="createSplitPane-methods_+3A_leftcolumn">leftColumn</code></td>
<td>
<p>Left column (as index or column name) visible in right pane</p>
</td></tr>
<tr><td><code id="createSplitPane-methods_+3A_toprow">topRow</code></td>
<td>
<p>Top row visible in bottom pane</p>
</td></tr>
</table>


<h3>Note</h3>

<p>To keep an area of a worksheet visible while you scroll to another area of the worksheet,
you can lock specific rows or columns in one area by freezing or splitting panes.
</p>
<p>When you freeze panes, you keep specific rows or columns visible when you scroll in the worksheet.
For example, you might want to keep row and column labels visible as you scroll.
</p>
<p>When you split panes, you create separate worksheet areas that you can scroll within,
while rows or columns in the non-scrolled area remain visible.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>How to create a freeze pane/split pane in Office 2007
<a href="https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us">https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
<code><a href="#topic+createFreezePane-methods">createFreezePane</a></code>
<code><a href="#topic+removePane-methods">removePane</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("splitPaneTest.xlsx", create = TRUE)

# Create a worksheet named 'Sheet1'
createSheet(wb, name = "Sheet1")

# Create a split pane on Sheet1, with coordinates (10000, 5000) expressed as 1/20th of a point,
# 10 (-&gt; J) as left column visible in right pane and 10 as top row visible in bottom pane 
createSplitPane(wb, "Sheet1", 10000, 5000, 10, 10)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("splitPaneTest.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='cref2idx'>
Converting Excel cell references to indices
</h2><span id='topic+cref2idx'></span>

<h3>Description</h3>

<p>Converts Excel cell references to row &amp; column indices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cref2idx(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cref2idx_+3A_x">x</code></td>
<td>
<p>Character vector of Excel cell references (e.g. &quot;$A$20&quot;, &quot;B18&quot;, ...)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric matrix with two columns and as many rows as cell references that have
been provided. The first column represents the row indices and the second column represents
the column indices.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idx2cref">idx2cref</a></code>, <code><a href="#topic+col2idx">col2idx</a></code>, <code><a href="#topic+idx2col">idx2col</a></code>,
<code><a href="#topic+idx2aref">idx2aref</a></code>, <code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+aref">aref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
cref2idx(c("$A$20", "B18"))

## End(Not run)
</code></pre>

<hr>
<h2 id='existsCellStyle-methods'>Retrieving named cell styles</h2><span id='topic+existsCellStyle'></span><span id='topic+existsCellStyle-methods'></span><span id='topic+existsCellStyle+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Checks whether a named cell style exists in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
existsCellStyle(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="existsCellStyle-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="existsCellStyle-methods_+3A_name">name</code></td>
<td>
<p>The name of the <code><a href="#topic+cellstyle-class">cellstyle</a></code> to check</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checks whether the <code><a href="#topic+cellstyle-class">cellstyle</a></code> with the specified <code>name</code> exists. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>,
<code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>, <code><a href="#topic+getOrCreateCellStyle-methods">getOrCreateCellStyle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("existsCellStyle.xlsx", create = TRUE)

# Cell style 'MyStyle' does not exist yet
stopifnot(!existsCellStyle(wb, "MyStyle"))

# Create the style "MyStyle"
createCellStyle(wb, "MyStyle")

# And now it is here
stopifnot(existsCellStyle(wb, "MyStyle"))

# clean up 
file.remove("existsCellStyle.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='existsName-methods'>Checking existence of named ranges in a workbook</h2><span id='topic+existsName'></span><span id='topic+existsName-methods'></span><span id='topic+existsName+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Checks the existence of a named range in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
existsName(object, name, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="existsName-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="existsName-methods_+3A_name">name</code></td>
<td>
<p>The name to check for</p>
</td></tr>
<tr><td><code id="existsName-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the specific worksheet to check</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns <code>TRUE</code> if the specified <code>name</code> exists and <code>FALSE</code>
otherwise. Note that the <code>name</code> argument is vectorized and
therefore multiple names can be checked for existence in one method call.
</p>
<p>If <code>worksheetScope</code> is provided, TRUE will be returned only if a matching
named range exists in the local scope of the specified sheet. To explicitly match only
in the global scope, pass <code>""</code> as the value.
</p>
<p>If option <code>XLConnect.setCustomAttributes</code> is <code>TRUE</code> (default <code>FALSE</code>),
the worksheet scope in which the name is defined is set as attribute <code>worksheetScope</code> on the result.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+removeName-methods">removeName</a></code>,
<code><a href="#topic+getDefinedNames-methods">getDefinedNames</a></code>, <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,<br /> 
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Check if the name 'mtcars' exists
# (should return TRUE since the name is defined as 'mtcars!$A$1:$K$33')
existsName(wb, name = "mtcars")

# check if the worksheet-scoped name 'iris' exists
options(XLConnect.setCustomAttributes = TRUE)
wb &lt;- loadWorkbook("demoFiles/iris.xlsx")

# should return TRUE with worksheet scope "iris"
res &lt;- existsName(wb, name = "iris")
res
attributes(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='existsSheet-methods'>Checking for existence of worksheets in a workbook</h2><span id='topic+existsSheet'></span><span id='topic+existsSheet-methods'></span><span id='topic+existsSheet+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Checks the existence of a worksheet in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
existsSheet(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="existsSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="existsSheet-methods_+3A_name">name</code></td>
<td>
<p>The sheet name to check for</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Checks if the specified worksheet exists. Returns <code>TRUE</code> if it
exists, otherwise <code>FALSE</code>. The <code>name</code> argument is vectorized
which allows to check for existence of multiple worksheets with one call.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+removeSheet-methods">removeSheet</a></code>, <code><a href="#topic+renameSheet-methods">renameSheet</a></code>,
<code><a href="#topic+getSheets-methods">getSheets</a></code>, <code><a href="#topic+cloneSheet-methods">cloneSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Check for existence of a worksheet called 'mtcars'
existsSheet(wb, "mtcars")

## End(Not run)
</code></pre>

<hr>
<h2 id='extraction-methods'>Workbook data extraction &amp; replacement operators</h2><span id='topic++5B'></span><span id='topic++5B+5B'></span><span id='topic++5B+3C-'></span><span id='topic++5B+5B+3C-'></span><span id='topic++5B-methods'></span><span id='topic++5B+5B-methods'></span><span id='topic++5B+3C--methods'></span><span id='topic++5B+5B+3C--methods'></span><span id='topic++5B+2Cworkbook-method'></span><span id='topic++5B+5B+2Cworkbook-method'></span><span id='topic++5B+3C-+2Cworkbook-method'></span><span id='topic++5B+5B+3C-+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Operators that allow to extract/replace data from/on a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extraction-methods_+3A_x">x</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> object to use</p>
</td></tr>
<tr><td><code id="extraction-methods_+3A_i">i</code></td>
<td>
<p>Name of worksheet (<code>[</code>, <code>[&lt;-</code>) or name of Excel name (<code>[[</code>, <code>[[&lt;-</code>)
to extract or replace</p>
</td></tr>
<tr><td><code id="extraction-methods_+3A_j">j</code></td>
<td>
<p>Only used with <code>[[&lt;-</code>: Optional formula to define the Excel name if it does not yet exist
on the workbook.</p>
</td></tr>
<tr><td><code id="extraction-methods_+3A_drop">drop</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="extraction-methods_+3A_value">value</code></td>
<td>
<p>Data object used for replacement</p>
</td></tr>
<tr><td><code id="extraction-methods_+3A_...">...</code></td>
<td>
<p>Arguments passed to the corresponding underlying function to read/write the data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The workbook extraction operators are basically syntactic sugar for the common methods <code><a href="#topic+readWorksheet-methods">readWorksheet</a></code> (<code>[</code>), 
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code> (<code>[&lt;-</code>), <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code> (<code>[[</code>), 
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code> (<code>[[&lt;-</code>).
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>, <code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>, <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("extraction.xlsx", create = TRUE)

# Write mtcars data set on a worksheet named 'mtcars1'.
# Note: The 'mtcars1' sheet will be created automatically if it does
# not exist yet. Also, default values for other writeWorksheet arguments
# hold, i.e. the data set is written starting at the top left corner. 
wb["mtcars1"] = mtcars

# Write mtcars data set on a worksheet named 'mtcars2'.
# Again, the 'mtcars2' worksheet is created automatically.
# Additionally specify arguments passed to the underlying method
# writeWorksheet.
wb["mtcars2", startRow = 6, startCol = 11, header = FALSE] = mtcars

# Read worksheets 'mtcars1' and 'mtcars2'.
# Note: The default arguments hold for the underlying method
# readWorksheet.
wb["mtcars1"]
wb["mtcars2"]

# Write mtcars data set to a named region named 'mtcars3'. Since
# it doesn't exist yet we also need to specify the formula to
# define it. Also note that the sheet 'mtcars3' referenced in the
# formula does not yet exist - it will be created automatically!
# Moreover, default values for other writeNamedRegion arguments hold.
wb[["mtcars3", "mtcars3!$B$7"]] = mtcars

# Redefine named region 'mtcars3'. Note that no formula specification
# is required since named region is already defined (see above example).
wb[["mtcars3"]] = mtcars

# Write mtcars data set to a named region 'mtcars4'. Since the named
# region does not yet exist a formula specification is required. Also,
# additional arguments are specified that are passed to the underlying
# method writeNamedRegion.
wb[["mtcars4", "mtcars4!$D$8", rownames = "Car"]] = mtcars

# Read the named regions 'mtcars3' and 'mtcars4'.
# Note: Default values hold for the underlying method readNamedRegion.
wb[["mtcars3"]]
wb[["mtcars4"]]

# clean up 
file.remove("extraction.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='extractSheetName'>
Extracting the sheet name from a formula
</h2><span id='topic+extractSheetName'></span>

<h3>Description</h3>

<p>Extracts the sheet name from a formula of the form &lt;SHEET_NAME&gt;!&lt;CELL_ADDRESS&gt;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractSheetName(formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractSheetName_+3A_formula">formula</code></td>
<td>
<p>Formula string of the form &lt;SHEET_NAME&gt;!&lt;CELL_ADDRESS&gt;. Note that the validity
of the formula won't be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the name of the sheet referenced in the formula. For quoted sheet names (required if names
contain e.g. whitespaces or exclamation marks (!)) in formulas the function returns the unquoted
name.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
extractSheetName(c("MySheet!$A$1", "'My Sheet'!$A$1", "'My!Sheet'!$A$1"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getActiveSheetIndex-methods'>Querying the active worksheet index</h2><span id='topic+getActiveSheetIndex'></span><span id='topic+getActiveSheetIndex-methods'></span><span id='topic+getActiveSheetIndex+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Queries the index of the active worksheet in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getActiveSheetIndex(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getActiveSheetIndex-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getActiveSheetName-methods">getActiveSheetName</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query the active sheet index
activeSheet &lt;- getActiveSheetIndex(wb)

## End(Not run)
</code></pre>

<hr>
<h2 id='getActiveSheetName-methods'>Querying the active worksheet name</h2><span id='topic+getActiveSheetName'></span><span id='topic+getActiveSheetName-methods'></span><span id='topic+getActiveSheetName+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Queries the name of the active worksheet in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getActiveSheetName(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getActiveSheetName-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getActiveSheetIndex-methods">getActiveSheetIndex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query the active sheet name
activeSheet &lt;- getActiveSheetName(wb)

## End(Not run)
</code></pre>

<hr>
<h2 id='getBoundingBox-methods'>Querying the coordinates of a worksheet bounding box</h2><span id='topic+getBoundingBox'></span><span id='topic+getBoundingBox-methods'></span><span id='topic+getBoundingBox+2Cworkbook+2Ccharacter-method'></span><span id='topic+getBoundingBox+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>This function queries the coordinates of a bounding box in an Excel worksheet. A bounding box is the rectangular region of minimum size containing all the non-empty cells in a sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getBoundingBox(object,sheet,startRow,startCol,endRow,endCol,autofitRow,autofitCol)
## S4 method for signature 'workbook,numeric'
getBoundingBox(object,sheet,startRow,startCol,endRow,endCol,autofitRow,autofitCol)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBoundingBox-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet from which to get the bounding box</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_startrow">startRow</code></td>
<td>
<p>Start reference row for the bounding box. Defaults to <code>0</code> meaning that the start row is determined automatically.</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_startcol">startCol</code></td>
<td>
<p>Start reference column for the bounding box. Defaults to <code>0</code> meaning that the start column is determined automatically.</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_endrow">endRow</code></td>
<td>
<p>End reference row for the bounding box. Defaults to <code>0</code> meaning that the end row is determined automatically.</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_endcol">endCol</code></td>
<td>
<p>End reference column for the bounding box. Defaults to <code>0</code> meaning that the end column is determined automatically.</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_autofitrow">autofitRow</code></td>
<td>
<p><code>logical</code> specifying if leading and trailing empty rows should be
skipped. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="getBoundingBox-methods_+3A_autofitcol">autofitCol</code></td>
<td>
<p><code>logical</code> specifying if leading and trailing empty columns should be skipped. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result is a <code>matrix</code> containing the following coordinates:<br />
<code>[1,]</code>  top left row<br />
<code>[2,]</code>  top left column<br />
<code>[3,]</code>  bottom right row<br />
<code>[4,]</code>  bottom right column<br />
<br />
In case more than one <code>sheet</code> is selected, the result <code>matrix</code> will contain a column for each sheet.<br /><br />
</p>
<p>The bounding box resolution algorithm works as follows:<br />
If <code>startRow &lt;= 0</code> then the first available row in the sheet is assumed. 
If <code>endRow &lt;= 0</code> then the last available row in the sheet is assumed.
If <code>startCol &lt;= 0</code> then the minimum column between <code>startRow</code> and
<code>endRow</code> is assumed. If <code>endCol &lt;= 0</code> then the maximum column between
<code>startRow</code> and <code>endRow</code> is assumed.
The arguments <code>autofitRow</code> and <code>autofitCol</code> (both defaulting to <code>TRUE</code>) can be used to skip leading and trailing empty rows even in case <code>startRow</code>, <code>endRow</code>, <code>startCol</code> and <code>endCol</code> are specified to values <code>&gt; 0</code>. This can be useful if data is expected within certain given boundaries but the exact location is not available.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query bounding box for the second sheet
print(getBoundingBox(wb, sheet="SecondSheet"))

# Query bounding box for the first sheet, selecting the columns from 5 to 8
print(getBoundingBox(wb, sheet="FirstSheet", startCol=5, endCol=8))

## End(Not run)
</code></pre>

<hr>
<h2 id='getCellFormula-methods'>Retrieving formula definitions from cells</h2><span id='topic+getCellFormula'></span><span id='topic+getCellFormula-methods'></span><span id='topic+getCellFormula+2Cworkbook+2Ccharacter-method'></span><span id='topic+getCellFormula+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Retrieves a cell formula from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getCellFormula(object,sheet,row,col)
## S4 method for signature 'workbook,numeric'
getCellFormula(object,sheet,row,col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCellFormula-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getCellFormula-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the worksheet containing the cell</p>
</td></tr>
<tr><td><code id="getCellFormula-methods_+3A_row">row</code></td>
<td>
<p>The one-based row index of the cell to query</p>
</td></tr>
<tr><td><code id="getCellFormula-methods_+3A_col">col</code></td>
<td>
<p>The one-based column index of the cell to query</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Retrieves the formula of the specified cell as a character, without the initial
<code>=</code> character displayed in Excel. Raises an error if the specified cell 
is not a formula cell.
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setCellFormula-methods">setCellFormula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("cellFormula.xlsx", create = TRUE)

createSheet(wb, "Formula")

# Assign a formula to A1
setCellFormula(wb, "Formula", 1, 1, "SUM($B$1:$B$29)")

# Returns the formula for Sheet1!A1
getCellFormula(wb, "Formula", 1, 1)
# The same with a numeric sheet index
getCellFormula(wb, 1, 1, 1)

# clean up 
file.remove("cellFormula.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='getCellStyle-methods'>Retrieving named cell styles</h2><span id='topic+getCellStyle'></span><span id='topic+getCellStyle-methods'></span><span id='topic+getCellStyle+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Retrieves a named cell style from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getCellStyle(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCellStyle-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getCellStyle-methods_+3A_name">name</code></td>
<td>
<p>The name of the <code><a href="#topic+cellstyle-class">cellstyle</a></code> to retrieve</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Retrieves the <code><a href="#topic+cellstyle-class">cellstyle</a></code> with the specified <code>name</code>. 
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>,
<code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>, <code><a href="#topic+getOrCreateCellStyle-methods">getOrCreateCellStyle</a></code>,
<code><a href="#topic+existsCellStyle-methods">existsCellStyle</a></code>,
<code><a href="#topic+setStyleNamePrefix-methods">setStyleNamePrefix</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>,
<code><a href="#topic+setDataFormat-methods">setDataFormat</a></code>, <code><a href="#topic+setBorder-methods">setBorder</a></code>,
<code><a href="#topic+setFillBackgroundColor-methods">setFillBackgroundColor</a></code>, <code><a href="#topic+setFillForegroundColor-methods">setFillForegroundColor</a></code>,
<code><a href="#topic+setFillPattern-methods">setFillPattern</a></code>, <code><a href="#topic+setWrapText-methods">setWrapText</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("getCellstyles.xlsx", create = TRUE)

# You wouldn't usually ignore the return value here...
createCellStyle(wb, 'Header')

# ... but if you did it doesn't hurt.
cs &lt;- getCellStyle(wb, 'Header')

# Specify the cell style to use a solid foreground color
setFillPattern(cs, fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(cs, color = XLC$"COLOR.RED")


# clean up 
file.remove("getCellstyles.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='getCellStyleForType-methods'>Querying the cell style per data type for the DATATYPE style action</h2><span id='topic+getCellStyleForType'></span><span id='topic+getCellStyleForType-methods'></span><span id='topic+getCellStyleForType+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Queries the cell style for a specific data type as used by the DATATYPE style action.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getCellStyleForType(object,type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCellStyleForType-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getCellStyleForType-methods_+3A_type">type</code></td>
<td>
<p>The data type for which to get the <code><a href="#topic+cellstyle-class">cellstyle</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the (cell) data type the DATATYPE style action (see <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>)
sets the <code><a href="#topic+cellstyle-class">cellstyle</a></code> for the corresponding cells. The data <code>type</code> is normally specified via a
corresponding data type constant from the <code><a href="#topic+XLC">XLC</a></code> object. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setCellStyleForType-methods">setCellStyleForType</a></code>,
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file.copy(system.file("demoFiles/template2.xlsx", 
                      package = "XLConnect"),
          "datatype.xlsx", overwrite = TRUE)

# Load workbook
wb &lt;- loadWorkbook("datatype.xlsx")

# Get current (existing) cell style for numerics
cs &lt;- getCellStyleForType(wb, XLC$"DATA_TYPE.NUMERIC")
# Could also say cs &lt;- getCellStyleForType(wb, "numeric")

# Change style
setBorder(cs, side = c("bottom", "right"), type = XLC$"BORDER.THICK", 
          color = c(XLC$"COLOR.BLACK", XLC$"COLOR.RED"))
          
# Set style action to 'datatype'
setStyleAction(wb, XLC$"STYLE_ACTION.DATATYPE")

# Write built-in data set 'mtcars' to the named region 
# 'mtcars' as defined by the Excel template.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook
saveWorkbook(wb)

# clean up
file.remove("datatype.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='getDefinedNames-methods'>Retrieving defined names in a workbook</h2><span id='topic+getDefinedNames'></span><span id='topic+getDefinedNames-methods'></span><span id='topic+getDefinedNames+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Retrieves the defined names in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getDefinedNames(object, validOnly, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDefinedNames-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getDefinedNames-methods_+3A_validonly">validOnly</code></td>
<td>
<p>If <code>validOnly = TRUE</code> only names with valid references
are returned. Valid references are ones not starting with #REF! or
#NULL! - which could result e.g. due to a missing sheet reference. The default
value for <code>validOnly</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="getDefinedNames-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the name of the worksheet in which the names are scoped;
to only query names in the global scope, use the value <code>""</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If option <code>XLConnect.setCustomAttributes</code> is <code>TRUE</code> (default <code>FALSE</code>),
a list of the worksheet scopes in which the names were found is set as attribute <code>worksheetScope</code> on the result.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+removeName-methods">removeName</a></code>, 
<code><a href="#topic+existsName-methods">existsName</a></code>, <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,<br />
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Retrieve defined names with valid references
getDefinedNames(wb)

## End(Not run)
</code></pre>

<hr>
<h2 id='getForceFormulaRecalculation-methods'>Querying the coordinates of the range reference by an Excel name</h2><span id='topic+getForceFormulaRecalculation'></span><span id='topic+getForceFormulaRecalculation-methods'></span><span id='topic+getForceFormulaRecalculation+2Cworkbook+2Ccharacter-method'></span><span id='topic+getForceFormulaRecalculation+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Queries the &quot;force formula recalculation&quot; flag on an Excel worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getForceFormulaRecalculation(object,sheet)
## S4 method for signature 'workbook,numeric'
getForceFormulaRecalculation(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getForceFormulaRecalculation-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getForceFormulaRecalculation-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to query. This argument is vectorized such that
multiple sheets can be queried with one method call. If <code>sheet = "*"</code>, the flag is
queried for all sheets in the <code><a href="#topic+workbook-class">workbook</a></code> (in the order as returned
by <code><a href="#topic+getSheets-methods">getSheets</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>,
<code><a href="#topic+setForceFormulaRecalculation-methods">setForceFormulaRecalculation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Ask whether Excel will automatically recalculate formulas on sheet mtcars
print(getForceFormulaRecalculation(wb, sheet = "mtcars"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getLastColumn-methods'>Querying the last (non-empty) column on a worksheet</h2><span id='topic+getLastColumn'></span><span id='topic+getLastColumn-methods'></span><span id='topic+getLastColumn+2Cworkbook+2Ccharacter-method'></span><span id='topic+getLastColumn+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Queries the last (non-empty) column on a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getLastColumn(object,sheet)
## S4 method for signature 'workbook,numeric'
getLastColumn(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getLastColumn-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getLastColumn-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet of which to query the last column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the (1-based) numeric index of the last non-empty column in the specified worksheet.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query the last row of the 'mtcars' worksheet
getLastColumn(wb, "mtcars")

# Query the last row of the 'mtcars2' worksheet
getLastColumn(wb, "mtcars2")

# Query the last row of the 'mtcars3' worksheet
getLastColumn(wb, "mtcars3")

## End(Not run)
</code></pre>

<hr>
<h2 id='getLastRow-methods'>Querying the last (non-empty) row on a worksheet</h2><span id='topic+getLastRow'></span><span id='topic+getLastRow-methods'></span><span id='topic+getLastRow+2Cworkbook+2Ccharacter-method'></span><span id='topic+getLastRow+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Queries the last (non-empty) row on a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getLastRow(object,sheet)
## S4 method for signature 'workbook,numeric'
getLastRow(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getLastRow-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getLastRow-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet of which to query the last row</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the numeric index of the last non-empty row in the specified worksheet.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query the last row of the 'mtcars' worksheet
getLastRow(wb, "mtcars")

# Query the last row of the 'mtcars2' worksheet
getLastRow(wb, "mtcars2")

# Query the last row of the 'mtcars3' worksheet
getLastRow(wb, "mtcars3")

## End(Not run)
</code></pre>

<hr>
<h2 id='getOrCreateCellStyle-methods'>Retrieving or creating named cell styles</h2><span id='topic+getOrCreateCellStyle'></span><span id='topic+getOrCreateCellStyle-methods'></span><span id='topic+getOrCreateCellStyle+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Retrieves or creates cell styles in <code><a href="#topic+workbook-class">workbook</a></code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getOrCreateCellStyle(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getOrCreateCellStyle-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getOrCreateCellStyle-methods_+3A_name">name</code></td>
<td>
<p>The name of the <code><a href="#topic+cellstyle-class">cellstyle</a></code> to retrieve or to create</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Retrieves an existing <code><a href="#topic+cellstyle-class">cellstyle</a></code> if it exists or creates a new one if it
does not exist yet.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>,
<code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>, <code><a href="#topic+existsCellStyle-methods">existsCellStyle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("getOrCreateCellStyle.xlsx", create = TRUE)

# The first time, the style does not exist yet and gets created
myStyle &lt;- getOrCreateCellStyle(wb, name = "MyStyle")

# The second time, we retrieve the already existing style 
myStyle &lt;- getOrCreateCellStyle(wb, name = "MyStyle")

# clean up 
file.remove("getOrCreateCellStyle.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='getReferenceCoordinates-methods'>Querying the coordinates of the range reference by an Excel name</h2><span id='topic+getReferenceCoordinates'></span><span id='topic+getReferenceCoordinates-methods'></span><span id='topic+getReferenceCoordinates+2Cworkbook-method'></span>

<h3>Description</h3>

<p>(DEPRECATED) Queries the coordinates of an Excel named range in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getReferenceCoordinates(object,name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getReferenceCoordinates-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getReferenceCoordinates-methods_+3A_name">name</code></td>
<td>
<p>The name to query. This argument is vectorized such that
multiple names can be queried with one method call.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is deprecated. Use <code><a href="#topic+getReferenceCoordinatesForName-methods">getReferenceCoordinatesForName</a></code>
instead.
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+existsName-methods">existsName</a></code>,
<code><a href="#topic+removeName-methods">removeName</a></code>, <code><a href="#topic+getReferenceFormula-methods">getReferenceFormula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query reference coordinate for name 'mtcars'
print(getReferenceCoordinatesForName(wb, name = "mtcars"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getReferenceCoordinatesForName-methods'>Querying the coordinates of the range reference by an Excel name</h2><span id='topic+getReferenceCoordinatesForName'></span><span id='topic+getReferenceCoordinatesForName-methods'></span><span id='topic+getReferenceCoordinatesForName+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Queries the coordinates of an Excel named range in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getReferenceCoordinatesForName(object,name, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getReferenceCoordinatesForName-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getReferenceCoordinatesForName-methods_+3A_name">name</code></td>
<td>
<p>The name to query. This argument is vectorized such that
multiple names can be queried with one method call.</p>
</td></tr>
<tr><td><code id="getReferenceCoordinatesForName-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional, the name of the worksheet to use for resolving the named region</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>worksheetScope</code> is defined, only coordinates for a range scoped strictly to the specified worksheet are 
returned. To explicitly only query for named ranges in the global scope, pass <code>""</code> as the value.
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+existsName-methods">existsName</a></code>,
<code><a href="#topic+removeName-methods">removeName</a></code>, <code><a href="#topic+getReferenceFormula-methods">getReferenceFormula</a></code>, 
<code><a href="#topic+getReferenceCoordinatesForTable-methods">getReferenceCoordinatesForTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query reference coordinate for name 'mtcars'
print(getReferenceCoordinatesForName(wb, name = "mtcars"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getReferenceCoordinatesForTable-methods'>Querying the coordinates of the range of an Excel table</h2><span id='topic+getReferenceCoordinatesForTable'></span><span id='topic+getReferenceCoordinatesForTable-methods'></span><span id='topic+getReferenceCoordinatesForTable+2Cworkbook+2Cnumeric-method'></span><span id='topic+getReferenceCoordinatesForTable+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Queries the coordinates of an Excel table (Office 2007+) in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,numeric'
getReferenceCoordinatesForTable(object,sheet,table)
## S4 method for signature 'workbook,character'
getReferenceCoordinatesForTable(object,sheet,table)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getReferenceCoordinatesForTable-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getReferenceCoordinatesForTable-methods_+3A_sheet">sheet</code></td>
<td>
<p>The index or name of the worksheet on which to look for the specified <code>table</code></p>
</td></tr>
<tr><td><code id="getReferenceCoordinatesForTable-methods_+3A_table">table</code></td>
<td>
<p>The name of the table to query. This argument is vectorized such that
multiple tables can be queried with one method call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+existsName-methods">existsName</a></code>,
<code><a href="#topic+removeName-methods">removeName</a></code>, <code><a href="#topic+getReferenceFormula-methods">getReferenceFormula</a></code>,
<code><a href="#topic+getReferenceCoordinatesForName-methods">getReferenceCoordinatesForName</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query reference coordinates for table 'MtcarsTable' on sheet
# 'mtcars_table'
print(getReferenceCoordinatesForTable(wb, sheet = "mtcars_table", 
                                      table = "MtcarsTable"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getReferenceFormula-methods'>Querying reference formulas of Excel names</h2><span id='topic+getReferenceFormula'></span><span id='topic+getReferenceFormula-methods'></span><span id='topic+getReferenceFormula+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Queries the reference formula of an Excel named range in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getReferenceFormula(object,name, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getReferenceFormula-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getReferenceFormula-methods_+3A_name">name</code></td>
<td>
<p>The named range to query. This argument is vectorized such that
multiple names can be queried with one method call.</p>
</td></tr>
<tr><td><code id="getReferenceFormula-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the name of the worksheet in which the name is scoped;
if undefined a matching name in any scope may be returned. To specify global scope only, use the value <code>""</code></p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>If option <code>XLConnect.setCustomAttributes</code> is <code>TRUE</code> (default <code>FALSE</code>),
the worksheet scope in which the queried name is defined is set as attribute <code>worksheetScope</code> on the result.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createName-methods">createName</a></code>, <code><a href="#topic+existsName-methods">existsName</a></code>,
<code><a href="#topic+removeName-methods">removeName</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query reference formula for name 'mtcars'
print(getReferenceFormula(wb, name = "mtcars"))

## End(Not run)
</code></pre>

<hr>
<h2 id='getSheetPos-methods'>Querying worksheet position</h2><span id='topic+getSheetPos'></span><span id='topic+getSheetPos-methods'></span><span id='topic+getSheetPos+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Queries the position of a worksheet in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
getSheetPos(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSheetPos-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getSheetPos-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name of the worksheet (<code>character</code>) to query. This argument is vectorized such that
multiple worksheets can be queried with one method call.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the position index of the corresponding worksheet. Note that querying a non-existing worksheet results
in a 0 index and does not throw an exception!
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setSheetPos-methods">setSheetPos</a></code>,
<code><a href="#topic+getSheets-methods">getSheets</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query worksheet positions for the worksheets 'mtcars2', 'mtcars3',
# 'mtcars' and 'NotThere' (which actually does not exist)
print(getSheetPos(wb, sheet = c("mtcars2", "mtcars3", "mtcars", "NotThere")))

## End(Not run)
</code></pre>

<hr>
<h2 id='getSheets-methods'>Querying available worksheets in a workbook</h2><span id='topic+getSheets'></span><span id='topic+getSheets-methods'></span><span id='topic+getSheets+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Returns all worksheet names in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
getSheets(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSheets-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+removeSheet-methods">removeSheet</a></code>, <code><a href="#topic+renameSheet-methods">renameSheet</a></code>,
<code><a href="#topic+getSheetPos-methods">getSheetPos</a></code>, <code><a href="#topic+setSheetPos-methods">setSheetPos</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query available worksheets
sheets &lt;- getSheets(wb)

## End(Not run)
</code></pre>

<hr>
<h2 id='getTables-methods'>Querying available Excel tables in a workbook</h2><span id='topic+getTables'></span><span id='topic+getTables-methods'></span><span id='topic+getTables+2Cworkbook+2Cnumeric-method'></span><span id='topic+getTables+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Queries the available Excel tables on the specified worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,numeric'
getTables(object,sheet,simplify)
## S4 method for signature 'workbook,character'
getTables(object,sheet,simplify)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTables-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="getTables-methods_+3A_sheet">sheet</code></td>
<td>
<p>Index (<code>integer</code>) or name (<code>character</code>) of worksheet to query</p>
</td></tr>
<tr><td><code id="getTables-methods_+3A_simplify">simplify</code></td>
<td>
<p><code>logical</code> specifying if the result should be simplified (defaults
to <code>TRUE</code>). See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since this is a vectorized function (multiple sheets can be specified) the result is a
named list (one component per sheet) if no simplification is applied. In cases where only 
one sheet is queried and <code>simplify = TRUE</code> (default) the result is simplified to a
vector.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>,
<code><a href="#topic+readTable-methods">readTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Query available tables (table names) on sheet 'mtcars_table'
tables &lt;- getTables(wb, sheet = "mtcars_table")

# ... or via sheet index
tables &lt;- getTables(wb, sheet = 4)

## End(Not run)
</code></pre>

<hr>
<h2 id='hideSheet-methods'>Hiding worksheets in a workbook</h2><span id='topic+hideSheet'></span><span id='topic+hideSheet-methods'></span><span id='topic+hideSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+hideSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>(Very) hides the specified worksheets in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
hideSheet(object, sheet, veryHidden)
## S4 method for signature 'workbook,numeric'
hideSheet(object, sheet, veryHidden)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hideSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="hideSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to hide</p>
</td></tr>
<tr><td><code id="hideSheet-methods_+3A_veryhidden">veryHidden</code></td>
<td>
<p>If <code>veryHidden = TRUE</code>, the specified <code>sheet</code> is &quot;very&quot; hidden
(see note), otherwise it is just hidden. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>sheet</code> and <code>veryHidden</code> are vectorized such
that multiple worksheets can be (very) hidden with one method call. An
exception is thrown if the specified <code>sheet</code> does not exist.
</p>


<h3>Note</h3>

<p>Note that hidden worksheets can be unhidden by users directly within
Excel via standard functionality. Therefore Excel  knows the concept
of &quot;very hidden&quot; worksheets. These worksheets cannot be unhidden with
standard Excel functionality but need programatic intervention to be
made visible.<br /><br />
</p>
<p>Also note that in case the specified worksheet to hide is the
currently active worksheet, then <code>hideSheet</code> tries to set the
active worksheet to the first non-hidden (not hidden and not very
hidden) worksheet in the workbook. If there is no such worksheet,
<code>hideSheet</code> will throw an exception. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+unhideSheet-methods">unhideSheet</a></code>,
<code><a href="#topic+isSheetHidden-methods">isSheetHidden</a></code>, <code><a href="#topic+isSheetVeryHidden-methods">isSheetVeryHidden</a></code>,
<code><a href="#topic+isSheetVisible-methods">isSheetVisible</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("hiddenWorksheet.xlsx", create = TRUE)

# Write a couple of built-in data.frame's into sheets
# with corresponding name
for(obj in c("CO2", "airquality", "swiss")) {
  createSheet(wb, name = obj)
  writeWorksheet(wb, get(obj), sheet = obj)
}

# Hide sheet 'airquality';
# the sheet may be unhidden by a user from within Excel
# since veryHidden defaults to FALSE
hideSheet(wb, sheet = "airquality")

# Save workbook
saveWorkbook(wb)

# clean up 
file.remove("hiddenWorksheet.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='idx2aref'>
Converting row and column based area references to Excel area references
</h2><span id='topic+idx2aref'></span>

<h3>Description</h3>

<p>Converts row &amp; column based area references to Excel area references
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idx2aref(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idx2aref_+3A_x">x</code></td>
<td>
<p>Numeric (integer) matrix or vector of indices. If a matrix is provided it
should have four columns with the first two columns representing the top left corner
(row and column indices) and the third &amp; fourth column representing the bottom right
corner. If a vector is provided it will be converted to a matrix by filling the vector into a 4-column 
matrix by row.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code>character</code> vector of corresponding Excel area references.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+aref">aref</a></code>, <code><a href="#topic+idx2cref">idx2cref</a></code>,
<code><a href="#topic+cref2idx">cref2idx</a></code>, <code><a href="#topic+idx2col">idx2col</a></code>, <code><a href="#topic+col2idx">col2idx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
idx2aref(c(1, 1, 5, 4))

## End(Not run)
</code></pre>

<hr>
<h2 id='idx2col'>
Converting column indices to Excel column names
</h2><span id='topic+idx2col'></span>

<h3>Description</h3>

<p>Converts column indices to Excel column names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idx2col(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idx2col_+3A_x">x</code></td>
<td>
<p>Numeric (integer) vector of column indices
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a character vector of corresponding Excel column names.
Numbers <code>&lt;= 0</code> result in the empty string (&quot;&quot;).
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+col2idx">col2idx</a></code>, <code><a href="#topic+idx2cref">idx2cref</a></code>, <code><a href="#topic+cref2idx">cref2idx</a></code>,
<code><a href="#topic+idx2aref">idx2aref</a></code>, <code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+aref">aref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
idx2col(c(1, 347))

## End(Not run)
</code></pre>

<hr>
<h2 id='idx2cref'>
Converting indices to Excel cell references
</h2><span id='topic+idx2cref'></span>

<h3>Description</h3>

<p>Converts row &amp; column indices to Excel cell references
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idx2cref(x, absRow = TRUE, absCol = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idx2cref_+3A_x">x</code></td>
<td>
<p>Numeric (integer) matrix or vector of indices. If a matrix is provided it
should have two columns with the first column representing the row indices and the second
column representing the column indices (i.e. each row represents a index-based cell reference). 
If a vector is provided it will be converted to a matrix by filling the vector into a 2-column 
matrix by row.
</p>
</td></tr>
<tr><td><code id="idx2cref_+3A_absrow">absRow</code></td>
<td>
<p>Boolean determining if the row index should be considered absolute. 
If <code>TRUE</code> (default), this will result in a '$'-prefixed row identifier.
</p>
</td></tr>
<tr><td><code id="idx2cref_+3A_abscol">absCol</code></td>
<td>
<p>Boolean determining if the column index should be considered absolute.
If <code>TRUE</code> (default), this will result in a '$'-prefixed column identifier.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a character vector of corresponding Excel cell references.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cref2idx">cref2idx</a></code>, <code><a href="#topic+idx2col">idx2col</a></code>, <code><a href="#topic+col2idx">col2idx</a></code>,
<code><a href="#topic+idx2aref">idx2aref</a></code>, <code><a href="#topic+aref2idx">aref2idx</a></code>, <code><a href="#topic+aref">aref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
idx2cref(c(5, 8, 14, 38))

## End(Not run)
</code></pre>

<hr>
<h2 id='isSheetHidden-methods'>Checking if worksheets are hidden in a workbook</h2><span id='topic+isSheetHidden'></span><span id='topic+isSheetHidden-methods'></span><span id='topic+isSheetHidden+2Cworkbook+2Ccharacter-method'></span><span id='topic+isSheetHidden+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Checks if the specified worksheets are hidden (but not very hidden) in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
isSheetHidden(object,sheet)
## S4 method for signature 'workbook,numeric'
isSheetHidden(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isSheetHidden-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="isSheetHidden-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to check</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns <code>TRUE</code> if the specified <code>sheet</code> is hidden (not visible
but also not very hidden), otherwise <code>FALSE</code>. <code>sheet</code> is
vectorized such that multiple worksheets can be queried with one method
call. An exception is thrown if the specified <code>sheet</code> does not exist. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+hideSheet-methods">hideSheet</a></code>, <code><a href="#topic+unhideSheet-methods">unhideSheet</a></code>,
<code><a href="#topic+isSheetVeryHidden-methods">isSheetVeryHidden</a></code>, <code><a href="#topic+isSheetVisible-methods">isSheetVisible</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("isSheetHidden.xlsx", create = TRUE)

# Write a couple of built-in data.frame's into sheets
# with corresponding name
for(obj in c("CO2", "airquality", "swiss")) {
  createSheet(wb, name = obj)
  writeWorksheet(wb, get(obj), sheet = obj)
}

# Hide sheet 'airquality'
hideSheet(wb, sheet = "airquality")

# Check if sheet 'airquality' is hidden;
# this should obviously return TRUE
isSheetHidden(wb, "airquality")

# Check if sheet 'swiss' is hidden;
# this should obviously return FALSE
isSheetHidden(wb, "swiss")


# clean up 
file.remove("isSheetHidden.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='isSheetVeryHidden-methods'>Checking if worksheets are very hidden in a workbook</h2><span id='topic+isSheetVeryHidden'></span><span id='topic+isSheetVeryHidden-methods'></span><span id='topic+isSheetVeryHidden+2Cworkbook+2Ccharacter-method'></span><span id='topic+isSheetVeryHidden+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Checks if the specified worksheets are very hidden (but not just hidden) in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
isSheetVeryHidden(object,sheet)
## S4 method for signature 'workbook,numeric'
isSheetVeryHidden(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isSheetVeryHidden-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="isSheetVeryHidden-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to check</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns <code>TRUE</code> if the specified named <code>sheet</code> is very hidden
(not visible but also not just hidden), otherwise
<code>FALSE</code>. <code>sheet</code> is vectorized such that multiple worksheets
can be queried with one method call. An exception is thrown if the
specified <code>sheet</code> does not exist. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+hideSheet-methods">hideSheet</a></code>, <code><a href="#topic+unhideSheet-methods">unhideSheet</a></code>,
<code><a href="#topic+isSheetHidden-methods">isSheetHidden</a></code>, <code><a href="#topic+isSheetVisible-methods">isSheetVisible</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("isSheetVeryHidden.xlsx", create = TRUE)

# Write a couple of built-in data.frame's into sheets
# with corresponding name
for(obj in c("CO2", "airquality", "swiss")) {
  createSheet(wb, name = obj)
  writeWorksheet(wb, get(obj), sheet = obj)
}

# Very hide sheet 'airquality'
hideSheet(wb, sheet = "airquality", veryHidden = TRUE)

# Hide sheet 'CO2'
hideSheet(wb, sheet = "CO2", veryHidden = FALSE)

# Check if sheet 'airquality' is very hidden;
# this should obviously return TRUE
isSheetVeryHidden(wb, "airquality")

# Check if sheet 'swiss' is very hidden;
# this should obviously return FALSE
isSheetVeryHidden(wb, "swiss")

# Check if sheet 'CO2' is very hidden;
# this should also return FALSE - the sheet
# is just hidden but not very hidden
isSheetVeryHidden(wb, "CO2")


# clean up 
file.remove("isSheetVeryHidden.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='isSheetVisible-methods'>Checking if worksheets are visible in a workbook</h2><span id='topic+isSheetVisible'></span><span id='topic+isSheetVisible-methods'></span><span id='topic+isSheetVisible+2Cworkbook+2Ccharacter-method'></span><span id='topic+isSheetVisible+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Checks if the specified worksheets are visible in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
isSheetVisible(object,sheet)
## S4 method for signature 'workbook,numeric'
isSheetVisible(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isSheetVisible-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="isSheetVisible-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to check</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns <code>TRUE</code> if the specified named <code>sheet</code> is visible (not
hidden and not very hidden), otherwise <code>FALSE</code>. <code>sheet</code> is
vectorized such that multiple worksheets can be queried with one method
call. An exception is thrown if the specified <code>sheet</code> does not
exist.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+hideSheet-methods">hideSheet</a></code>, <code><a href="#topic+unhideSheet-methods">unhideSheet</a></code>,
<code><a href="#topic+isSheetHidden-methods">isSheetHidden</a></code>, <code><a href="#topic+isSheetVeryHidden-methods">isSheetVeryHidden</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("isSheetVisible.xlsx", create = TRUE)

# Write a couple of built-in data.frame's into sheets
# with corresponding name
for(obj in c("CO2", "airquality", "swiss")) {
  createSheet(wb, name = obj)
  writeWorksheet(wb, get(obj), sheet = obj)
}

# Hide sheet 'CO2'
hideSheet(wb, sheet = "CO2", veryHidden = FALSE)

# Very hide sheet 'airquality'
hideSheet(wb, sheet = "airquality", veryHidden = TRUE)

# Check if sheet 'swiss' is visible;
# this should obviously return TRUE
isSheetVisible(wb, "swiss")

# Check if sheet 'CO2' is visible;
# this should obviously return FALSE
isSheetVisible(wb, "CO2")

# Check if sheet 'airquality' is visible;
# this should obviously return FALSE
isSheetVisible(wb, "airquality")


# clean up 
file.remove("isSheetVisible.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='jTryCatch'>
Standard Java exception handling for XLConnect
</h2><span id='topic+jTryCatch'></span>

<h3>Description</h3>

<p>Catches Java exceptions to create nicer error messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jTryCatch(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jTryCatch_+3A_...">...</code></td>
<td>

<p>Arguments to <code><a href="base.html#topic+tryCatch">tryCatch</a></code> - an expression and optionally the argument
<code>finally</code> to specify an expression to be evaluated before returning or exiting.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function specifies a Java Throwable error handler that catches any Java exceptions. Caught exceptions
are post-processed and re-thrown using <code><a href="base.html#topic+stop">stop</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+tryCatch">tryCatch</a></code>, <code><a href="base.html#topic+stop">stop</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
try(XLConnect:::jTryCatch(J("java.lang.Integer")$valueOf("not an integer")))

## End(Not run)
</code></pre>

<hr>
<h2 id='loadWorkbook'>
Loading Microsoft Excel workbooks
</h2><span id='topic+loadWorkbook'></span>

<h3>Description</h3>

<p>Loads or creates a Microsoft Excel <code><a href="#topic+workbook-class">workbook</a></code> for further manipulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadWorkbook(filename, create = FALSE, password = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadWorkbook_+3A_filename">filename</code></td>
<td>

<p>Filename (absolute or relative) of Excel workbook to be loaded. Supported are Excel '97 (*.xls) and
OOXML (Excel 2007+, *.xlsx) file formats. Paths are expanded using <code>path.expand</code>.
</p>
</td></tr>
<tr><td><code id="loadWorkbook_+3A_create">create</code></td>
<td>

<p>Specifies if the file should be created if it does not already exist (default is <code>FALSE</code>). Note that
<code>create = TRUE</code> has no effect if the specified file exists, i.e. an existing file is loaded and not
being recreated if <code>create = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="loadWorkbook_+3A_password">password</code></td>
<td>

<p>Password to use when opening password protected files. The default <code>NULL</code> means no password is
being used. This argument is ignored when creating new files using <code>create = TRUE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code><a href="#topic+workbook-class">workbook</a></code> object for further manipulation.
</p>


<h3>Note</h3>

<p><code>loadWorkbook</code> is basically just a shortcut form of <code>new("workbook", filename, create)</code> with some additional error checking. As such
it is the preferred way of creating <code><a href="#topic+workbook-class">workbook</a></code> instances.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>Wikipedia: Office Open XML<br />
<a href="https://en.wikipedia.org/wiki/Office_Open_XML">https://en.wikipedia.org/wiki/Office_Open_XML</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+saveWorkbook-methods">saveWorkbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load existing demo Excel file 'mtcars.xlsx' from the XLConnect package
wb.mtcars &lt;- loadWorkbook(system.file("demoFiles/mtcars.xlsx", 
                          package = "XLConnect"))

# Create new workbook
wb.new &lt;- loadWorkbook("myNewExcelFile.xlsx", create = TRUE)

# NOTE: The above statement does not write the file to disk! 
# saveWorkbook(wb.new) would need to be called in order to write/save 
# the file to disk!

# clean up 
file.remove("myNewExcelFile.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='mergeCells-methods'>Merging cells</h2><span id='topic+mergeCells'></span><span id='topic+mergeCells-methods'></span><span id='topic+mergeCells+2Cworkbook+2Ccharacter-method'></span><span id='topic+mergeCells+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Merges cells in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
mergeCells(object,sheet,reference)
## S4 method for signature 'workbook,numeric'
mergeCells(object,sheet,reference)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeCells-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="mergeCells-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to merge cells</p>
</td></tr>
<tr><td><code id="mergeCells-methods_+3A_reference">reference</code></td>
<td>
<p>A cell range specification (<code>character</code>) in the form 'A1:B8'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+unmergeCells-methods">unmergeCells</a></code>,
<code><a href="#topic+idx2cref">idx2cref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("mergeCells.xlsx", create = TRUE)

# Create a worksheet called 'merge'
createSheet(wb, name = "merge")

# Merge the cells A1:B8 on the worksheet created above
mergeCells(wb, sheet = "merge", reference = "A1:B8")

# Save workbook
saveWorkbook(wb)

# clean up 
file.remove("mergeCells.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='mirai'>
Mirai Solutions GmbH
</h2><span id='topic+mirai'></span>

<h3>Description</h3>

<p>Utility object to easily get to the Mirai Solutions GmbH web page. Just enter <code>mirai</code> in the R console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mirai</code></pre>


<h3>References</h3>

<p>Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>

<hr>
<h2 id='normalizeDataframe'>
Data frame Normalization for Unit Tests
</h2><span id='topic+normalizeDataframe'></span>

<h3>Description</h3>

<p>Normalizes a data.frame with respect to column types. This is necessary for comparing data.frames written to Excel and then read from Excel. Excel does not know e.g. factor types. Factor variables
in fact are written to Excel as ordinary strings. Therefore, when read back in to R, they are treated as character variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizeDataframe(df, replaceInf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalizeDataframe_+3A_df">df</code></td>
<td>
<p><code>data.frame</code> to normalize</p>
</td></tr>
<tr><td><code id="normalizeDataframe_+3A_replaceinf">replaceInf</code></td>
<td>
<p><code>logical</code> specifying if infinites should be replaced with <code>NA</code>; this is used
because Excel does not support infinites</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a normalized <code>data.frame</code>
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>

<hr>
<h2 id='onErrorCell-methods'> Behavior when error cells are detected </h2><span id='topic+onErrorCell'></span><span id='topic+onErrorCell-methods'></span><span id='topic+onErrorCell+2Cworkbook-method'></span>

<h3>Description</h3>

<p>This function defines the behavior when reading data from a worksheet and error cells
are detected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
onErrorCell(object,behavior)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="onErrorCell-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="onErrorCell-methods_+3A_behavior">behavior</code></td>
<td>
<p>The behavior to follow when an error cell is detected. This is normally
specified by a corresponding <code><a href="#topic+XLC">XLC</a></code> error constant, i.e. either
<code>XLC$"ERROR.WARN"</code> or <code>XLC$"ERROR.STOP"</code>. <code>XLC$"ERROR.WARN"</code> means the
error cell will be read as missing value (<code>NA</code>) and a corresponding warning will be
generated (this is the default behavior). <code>XLC$"ERROR.STOP"</code> means that an exception
will be thrown and further execution will be stopped immediately.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>, <code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,<br />
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# errorCell xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/errorCell.xlsx", 
							  package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Set error behavior to XLC$ERROR.WARN when detecting error cells
# Note: this is the default behavior
onErrorCell(wb, XLC$ERROR.WARN)
# Alternatively: wb$onErrorCell(XLC$ERROR.WARN)

# Read named region 'MyData' (with default header = TRUE)
data &lt;- readNamedRegion(wb, name = "MyData")

# Now set error behavior to XLC$ERROR.STOP to immediately
# issue an exception and stop in case an error cell is
# detected
onErrorCell(wb, XLC$ERROR.STOP)
# Alternatively: wb$onErrorCell(XLC$ERROR.STOP)

# Read (again) named region 'MyData' (with default header = TRUE)
res &lt;- try(readNamedRegion(wb, name = "MyData"))
# Did we get an error?
print(is(res, "try-error"))

## End(Not run)
</code></pre>

<hr>
<h2 id='print-methods'> Print a workbook's filename </h2><span id='topic+print'></span><span id='topic+print-methods'></span><span id='topic+print+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Prints the <code><a href="#topic+workbook-class">workbook</a></code>'s underlying filename.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print-methods_+3A_x">x</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to print</p>
</td></tr>
<tr><td><code id="print-methods_+3A_...">...</code></td>
<td>
<p>Arguments passed on to standard <code>print</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints the specified <code><a href="#topic+workbook-class">workbook</a></code>'s filename (see also the S4 <code>filename</code>
slot of the <code><a href="#topic+workbook-class">workbook</a></code> class).
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load existing demo Excel file 'mtcars.xlsx' from the XLConnect package
wb.mtcars &lt;- loadWorkbook(system.file("demoFiles/mtcars.xlsx", 
                          package = "XLConnect"))

# Print the workbook's underlying filename
print(wb.mtcars)

## End(Not run)
</code></pre>

<hr>
<h2 id='readNamedRegion'>Reading named regions from a workbook</h2><span id='topic+readNamedRegion'></span><span id='topic+readNamedRegion-methods'></span><span id='topic+readNamedRegion+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Reads named regions from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
readNamedRegion(object, name, header, rownames, colTypes, 
forceConversion, dateTimeFormat, check.names, useCachedValues, keep, drop, simplify,
readStrategy, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readNamedRegion_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_name">name</code></td>
<td>
<p>The name of the named region to read</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_header">header</code></td>
<td>
<p>The argument <code>header</code> specifies if the first row
should be interpreted as column names. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_rownames">rownames</code></td>
<td>
<p>Index (<code>numeric</code>) or name (<code>character</code>) of column that
should be used as row names. The corresponding column will be removed from the data
set. Defaults to <code>NULL</code> which means that no row names are applied. Row names must be either
<code>integer</code> or <code>character</code>. Non-numeric columns will be coerced to <code>character</code>.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_coltypes">colTypes</code></td>
<td>
<p>Column types to use when reading in the data. Specified as a <code>character</code>
vector of the corresponding type names (see <code><a href="#topic+XLC">XLC</a></code>; <code>XLC$DATA_TYPE.&lt;?&gt;</code>). You
may also use R class names such as <code>numeric</code>, <code>character</code>, <code>logical</code> and <code>POSIXt</code>.
The types are applied in the given order to the columns - elements are recycled if necessary.
Defaults to <code>character(0)</code> meaning that column types are determined automatically (see the
Note section for more information).<br />
By default, type conversions are only applied if the specified column type is a more generic type
(e.g. from Numeric to String) - otherwise <code>NA</code> is returned. The <code>forceConversion</code> flag can be
set to force conversion into less generic types where possible.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_forceconversion">forceConversion</code></td>
<td>
<p><code>logical</code> specifying if conversions to less generic types should be
forced. Defaults to <code>FALSE</code> meaning that if a column is specified
to be of a certain type via the <code>colTypes</code> argument and a more generic type is detected in
the column, then <code>NA</code> will be returned (example: column is specified to be DateTime but a
more generic String is found). Specifying <code>forceConversion = TRUE</code> will try to enforce a
conversion - if it succeeds the corresponding (converted) value will be returned, otherwise
<code>NA</code>. See the Note section for some additional information.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_datetimeformat">dateTimeFormat</code></td>
<td>
<p>Date/time format used when doing date/time conversions. Defaults to<br />
<code>getOption("XLConnect.dateTimeFormat")</code>. This should be a POSIX format specifier according
to <code><a href="base.html#topic+strptime">strptime</a></code> although not all specifications have been implemented yet - the most
important ones however are available.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_check.names">check.names</code></td>
<td>
<p><code>logical</code> specifying if column names of the resulting <code>data.frame</code>
should be checked to ensure that they are syntactically valid valid variable names and are not
duplicated. See the <code>check.names</code> argument of <code><a href="base.html#topic+data.frame">data.frame</a></code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_usecachedvalues">useCachedValues</code></td>
<td>
<p><code>logical</code> specifying whether to read cached formula results from the 
workbook instead of re-evaluating them. This is particularly helpful in cases for reading data
produced by Excel features not supported in XLConnect like references to external workbooks. 
Defaults to <code>FALSE</code>, which means that formulas will be evaluated by XLConnect.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_keep">keep</code></td>
<td>
<p>List of column names or indices to be kept in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time. 
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.
Example: if <code>name = c("NamedRegion1", "NamedRegion2", "NamedRegion3")</code> and <code>keep = c(1,2)</code>, <code>keep</code> will be
internally converted into <code>list(c(1,2))</code> and then replicated to match the number of named regions, i.e.
<code>keep = list(c(1,2), c(1,2), c(1,2))</code>. The result is that the first two columns of each named region
are kept. If <code>keep = list(1,2)</code> is specified, it will be replicated as <code>list(1,2,1)</code>, i.e. respectively
the first, second and first column of the named regions &quot;NamedRegion1&quot;, &quot;NamedRegion2&quot;, &quot;NamedRegion3&quot;
will be kept.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_drop">drop</code></td>
<td>
<p>List of column names or indices to be dropped in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time.
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.
Example: if <code>name = c("NamedRegion1", "NamedRegion2", "NamedRegion3")</code> and <code>drop = c(1,2)</code>, <code>drop</code> will be
internally converted into <code>list(c(1,2))</code> and then replicated to match the number of named regions, i.e.
<code>drop = list(c(1,2), c(1,2), c(1,2))</code>. The result is that the first two columns of each named region
are dropped. If <code>drop = list(1,2)</code> is specified, it will be replicated as <code>list(1,2,1)</code>, i.e. respectively
the first, second and first column of the named regions &quot;NamedRegion1&quot;, &quot;NamedRegion2&quot;, &quot;NamedRegion3&quot;
will be dropped.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_simplify">simplify</code></td>
<td>
<p><code>logical</code> specifying if the result should be simplified, e.g. in case the <code>data.frame</code>
would only have one row or one column (and data types match). Simplifying here is identical to calling <code>unlist</code>
on the otherwise resulting <code>data.frame</code> (using <code>use.names = FALSE</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_readstrategy">readStrategy</code></td>
<td>
<p><code>character</code> specifying the reading strategy to use. Currently supported strategies are:
</p>

<ul>
<li> <p><code>"default"</code> (default): Can handle all supported data types incl. date/time values and can deal 
directly with missing value identifiers (see <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code>)
</p>
</li>
<li> <p><code>"fast"</code>: Increased read performance. Date/time values are read as numeric (number of days since 1900-01-01; 
fractional days represent hours, minutes, and seconds) and only blank cells are recognized as missing (missing value 
identifiers as set in <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code> are ignored)
</p>
</li></ul>
</td></tr>
<tr><td><code id="readNamedRegion_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional, the name of the worksheet to use for resolving the named region</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>name</code>, <code>header</code>, and <code>worksheetScope</code> are vectorized. As such,
multiple named regions can be read with one method call. If only one
single named region is read, the return value is a <code>data.frame</code>.If
multiple named regions are specified, the return value is a (named)
<code>list</code> of <code>data.frame</code>'s returned in the order they have been
specified with the argument <code>name</code>.<br />
When reading dates, if your system uses a time zone that has / had daylight saving time,
certain dates / timestamps will not be read exactly as they were written. See
<a href="https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/DateUtil.html#getJavaDate-double-">https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/DateUtil.html#getJavaDate-double-</a>
If <code>worksheetScope</code> is unspecified, the contents of the name found anywhere in the workbook will be read.
Otherwise, only a name specifically scoped to the specified sheet may be read. 
To read only names defined in the global scope, pass <code>""</code> as the value.
If option <code>XLConnect.setCustomAttributes</code> is <code>TRUE</code> (default <code>FALSE</code>), 
the worksheet scope in which the name was found is set as attribute <code>worksheetScope</code> on the result.
</p>


<h3>Note</h3>

<p>If no specific column types (see argument <code>colTypes</code>) are specified,
<code>readNamedRegion</code> tries to determine the resulting column types
based on the read cell types. If different cell types are found in a
specific column, the most general of those is used and mapped to the
corresponding R data type. The order of data types from least to most
general is Boolean (<code>logical</code>) &lt; DateTime (<code>POSIXct</code>) &lt;
Numeric (<code>numeric</code>) &lt; String (<code>character</code>). E.g. if a column
is read that contains cells of type Boolean, Numeric and String then the
resulting column in R would be <code>character</code> since <code>character</code>
is the most general type.<br /><br />
Some additional information with respect to forcing data type conversion
using <code>forceConversion = TRUE</code>:
</p>

<ul>
<li><p> Forcing conversion from String to Boolean: <code>TRUE</code> is returned
if and only if the target string is &quot;true&quot; (ignoring any capitalization).
Any other string will return <code>FALSE</code>.
</p>
</li>
<li><p> Forcing conversion from Numeric to DateTime: since Excel understands
Dates/Times as Numerics with some additional formatting, a conversion from
a Numeric to a DateTime is actually possible. Numerics in this case represent
the number of days since 1900-01-00 (yes, day 00! - see <a href="https://web.archive.org/web/20240821110422/http://www.cpearson.com/excel/datetime.htm">https://web.archive.org/web/20240821110422/http://www.cpearson.com/excel/datetime.htm</a>).
Note that in R 0 is represented as 1899-12-31 since there is no 1900-01-00.
Fractional days represent hours, minutes, and seconds.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Martin Studer<br />
Thomas Themel<br />
Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>What are named regions/ranges?<br />
<a href="https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm">https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm</a><br />
How to create named regions/ranges?<br />
<a href="https://www.youtube.com/watch?v=iAE9a0uRtpM">https://www.youtube.com/watch?v=iAE9a0uRtpM</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,<br />
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>,
<code><a href="#topic+readTable-methods">readTable</a></code>,
<code><a href="#topic+onErrorCell-methods">onErrorCell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example 1:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read named region 'mtcars' (with default header = TRUE)
data &lt;- readNamedRegion(wb, name = "mtcars")

## Example 2;
# conversion xlsx file from demoFiles subfolder of package XLConnect
excelFile &lt;- system.file("demoFiles/conversion.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(excelFile)

# Read named region 'conversion' with pre-specified column types
# Note: in the worksheet all data was entered as strings!
# forceConversion = TRUE is used to force conversion from String
# into the less generic data types Numeric, DateTime &amp; Boolean
df &lt;- readNamedRegion(wb, name = "conversion", header = TRUE,
                      colTypes = c(XLC$DATA_TYPE.NUMERIC,
                                   XLC$DATA_TYPE.DATETIME,
                                   XLC$DATA_TYPE.BOOLEAN),
                      forceConversion = TRUE,
                      dateTimeFormat = "%Y-%m-%d %H:%M:%S")
                      
## Example 3:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read the columns 1, 3 and 5 of the named region 'mtcars' (with default header = TRUE)
data &lt;- readNamedRegion(wb, name = "mtcars", keep=c(1,3,5))

# activate attributes (used by worksheet scope)
options(XLConnect.setCustomAttributes = TRUE)

# read the iris dataset from worksheet-scoped named region 'iris'
wb &lt;- loadWorkbook("demoFiles/iris.xlsx")
data &lt;- readNamedRegion(wb, name = "iris", worksheetScope = "iris")

# show worksheet scope attribute
attr(data, "worksheetScope")

## End(Not run)
</code></pre>

<hr>
<h2 id='readNamedRegionFromFile'>Reading named regions from an Excel file (wrapper function)</h2><span id='topic+readNamedRegionFromFile'></span>

<h3>Description</h3>

<p>Reads named regions from an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNamedRegionFromFile(file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readNamedRegionFromFile_+3A_file">file</code></td>
<td>
<p>The file name of the workbook to read</p>
</td></tr>
<tr><td><code id="readNamedRegionFromFile_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="#topic+readNamedRegion-methods">readNamedRegion</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience wrapper to read named regions from a file
without creating an intermediate <code><a href="#topic+workbook-class">workbook</a></code> object.
See <a href="#topic+readNamedRegion-methods">readNamedRegion</a> for more details.</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>,
<code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>,<br />
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>,
<code><a href="#topic+onErrorCell-methods">onErrorCell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx", 
                             package = "XLConnect")
                             
# Load a single named region into a single data.frame.
df &lt;- readNamedRegionFromFile(demoExcelFile, name="Iris")

# Load multiple regions at once - returns a (named) list 
# of data.frames.
df &lt;- readNamedRegionFromFile(demoExcelFile, 
                              name=c("Calendar", "Iris", "IQ"))

## End(Not run)
</code></pre>

<hr>
<h2 id='readTable'>Reading Excel tables from a workbook</h2><span id='topic+readTable'></span><span id='topic+readTable-methods'></span><span id='topic+readTable+2Cworkbook+2Cnumeric-method'></span><span id='topic+readTable+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Reads Excel tables (Office 2007+) from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,numeric'
readTable(object, sheet, table, header, rownames, colTypes, forceConversion, 
dateTimeFormat, check.names, useCachedValues, keep, drop, simplify, readStrategy)
## S4 method for signature 'workbook,character'
readTable(object, sheet, table, header, rownames, colTypes, forceConversion, 
dateTimeFormat, check.names, useCachedValues, keep, drop, simplify, readStrategy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readTable_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="readTable_+3A_sheet">sheet</code></td>
<td>
<p>The index or name of the worksheet on which to look for the specified <code>table</code></p>
</td></tr>
<tr><td><code id="readTable_+3A_table">table</code></td>
<td>
<p>The name of the table to read</p>
</td></tr>
<tr><td><code id="readTable_+3A_header">header</code></td>
<td>
<p>The argument <code>header</code> specifies if the first row
should be interpreted as column names. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readTable_+3A_rownames">rownames</code></td>
<td>
<p>Index (<code>numeric</code>) or name (<code>character</code>) of column that
should be used as row names. The corresponding column will be removed from the data
set. Defaults to <code>NULL</code> which means that no row names are applied.</p>
</td></tr>
<tr><td><code id="readTable_+3A_coltypes">colTypes</code></td>
<td>
<p>Column types to use when reading in the data. Specified as a <code>character</code>
vector of the corresponding type names (see <code><a href="#topic+XLC">XLC</a></code>; <code>XLC$DATA_TYPE.&lt;?&gt;</code>). You
may also use R class names such as <code>numeric</code>, <code>character</code>, <code>logical</code> and <code>POSIXt</code>.
The types are applied in the given order to the columns - elements are recycled if necessary.
Defaults to <code>character(0)</code> meaning that column types are determined automatically (see the
Note section for more information).<br />
By default, type conversions are only applied if the specified column type is a more generic type
(e.g. from Numeric to String) - otherwise <code>NA</code> is returned. The <code>forceConversion</code> flag can be
set to force conversion into less generic types where possible.</p>
</td></tr>
<tr><td><code id="readTable_+3A_forceconversion">forceConversion</code></td>
<td>
<p><code>logical</code> specifying if conversions to less generic types should be
forced. Defaults to <code>FALSE</code> meaning that if a column is specified
to be of a certain type via the <code>colTypes</code> argument and a more generic type is detected in
the column, then <code>NA</code> will be returned (example: column is specified to be DateTime but a
more generic String is found). Specifying <code>forceConversion = TRUE</code> will try to enforce a
conversion - if it succeeds the corresponding (converted) value will be returned, otherwise
<code>NA</code>. See the Note section for some additional information.</p>
</td></tr>
<tr><td><code id="readTable_+3A_datetimeformat">dateTimeFormat</code></td>
<td>
<p>Date/time format used when doing date/time conversions. Defaults to<br />
<code>getOption("XLConnect.dateTimeFormat")</code>. This should be a POSIX format specifier according
to <code><a href="base.html#topic+strptime">strptime</a></code> although not all specifications have been implemented yet - the most
important ones however are available.</p>
</td></tr>
<tr><td><code id="readTable_+3A_check.names">check.names</code></td>
<td>
<p><code>logical</code> specifying if column names of the resulting <code>data.frame</code>
should be checked to ensure that they are syntactically valid valid variable names and are not
duplicated. See the <code>check.names</code> argument of <code><a href="base.html#topic+data.frame">data.frame</a></code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readTable_+3A_usecachedvalues">useCachedValues</code></td>
<td>
<p><code>logical</code> specifying whether to read cached formula results from the 
workbook instead of re-evaluating them. This is particularly helpful in cases for reading data
produced by Excel features not supported in XLConnect like references to external workbooks. 
Defaults to <code>FALSE</code>, which means that formulas will be evaluated by XLConnect.</p>
</td></tr>
<tr><td><code id="readTable_+3A_keep">keep</code></td>
<td>
<p>List of column names or indices to be kept in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time. 
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.</p>
</td></tr>
<tr><td><code id="readTable_+3A_drop">drop</code></td>
<td>
<p>List of column names or indices to be dropped in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time.
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.</p>
</td></tr>
<tr><td><code id="readTable_+3A_simplify">simplify</code></td>
<td>
<p><code>logical</code> specifying if the result should be simplified, e.g. in case the <code>data.frame</code>
would only have one row or one column (and data types match). Simplifying here is identical to calling <code>unlist</code>
on the otherwise resulting <code>data.frame</code> (using <code>use.names = FALSE</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="readTable_+3A_readstrategy">readStrategy</code></td>
<td>
<p><code>character</code> specifying the reading strategy to use. Currently supported strategies are:
</p>

<ul>
<li> <p><code>"default"</code> (default): Can handle all supported data types incl. date/time values and can deal 
directly with missing value identifiers (see <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code>)
</p>
</li>
<li> <p><code>"fast"</code>: Increased read performance. Date/time values are read as numeric (number of days since 1900-01-01; 
fractional days represent hours, minutes, and seconds) and only blank cells are recognized as missing (missing value 
identifiers as set in <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code> are ignored)
</p>
</li></ul>
</td></tr>
</table>


<h3>Note</h3>

<p>If no specific column types (see argument <code>colTypes</code>) are specified,
<code>readNamedRegion</code> tries to determine the resulting column types
based on the read cell types. If different cell types are found in a
specific column, the most general of those is used and mapped to the
corresponding R data type. The order of data types from least to most
general is Boolean (<code>logical</code>) &lt; DateTime (<code>POSIXct</code>) &lt;
Numeric (<code>numeric</code>) &lt; String (<code>character</code>). E.g. if a column
is read that contains cells of type Boolean, Numeric and String then the
resulting column in R would be <code>character</code> since <code>character</code>
is the most general type.<br /><br />
Some additional information with respect to forcing data type conversion
using <code>forceConversion = TRUE</code>:
</p>

<ul>
<li><p> Forcing conversion from String to Boolean: <code>TRUE</code> is returned
if and only if the target string is &quot;true&quot; (ignoring any capitalization).
Any other string will return <code>FALSE</code>.
</p>
</li>
<li><p> Forcing conversion from Numeric to DateTime: since Excel understands
Dates/Times as Numerics with some additional formatting, a conversion from
a Numeric to a DateTime is actually possible. Numerics in this case represent
the number of days since 1900-01-01. Fractional days represent hours, minutes, 
and seconds.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>Overview of Excel tables<br />
<a href="https://support.microsoft.com/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c?ocmsassetid=ha010048546&amp;correlationid=ecf0d51a-596f-42e5-9c05-8653648bb180&amp;ui=en-us&amp;rs=en-us&amp;ad=us">https://support.microsoft.com/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c?ocmsassetid=ha010048546&amp;correlationid=ecf0d51a-596f-42e5-9c05-8653648bb180&amp;ui=en-us&amp;rs=en-us&amp;ad=us</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,<br />
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>,
<code><a href="#topic+onErrorCell-methods">onErrorCell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read table 'MtcarsTable' from sheet 'mtcars_table'
data &lt;- readTable(wb, sheet = "mtcars_table", table = "MtcarsTable")

## End(Not run)
</code></pre>

<hr>
<h2 id='readWorksheet-methods'>Reading data from worksheets</h2><span id='topic+readWorksheet'></span><span id='topic+readWorksheet-methods'></span><span id='topic+readWorksheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+readWorksheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Reads data from worksheets of a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,numeric'
readWorksheet(object,sheet,startRow,startCol,endRow,endCol,autofitRow,autofitCol,
region,header,rownames,colTypes,forceConversion,dateTimeFormat,check.names,
useCachedValues,keep,drop, simplify, readStrategy)
## S4 method for signature 'workbook,character'
readWorksheet(object,sheet,startRow,startCol,endRow,endCol,autofitRow,autofitCol,
region,header,rownames,colTypes,forceConversion,dateTimeFormat,check.names,
useCachedValues,keep,drop, simplify, readStrategy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readWorksheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the worksheet to read from</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_startrow">startRow</code></td>
<td>
<p>The index of the first row to read from. Defaults to <code>0</code> meaning that the start row is determined automatically.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_startcol">startCol</code></td>
<td>
<p>The index of the first column to read from. Defaults to <code>0</code> meaning that the start column is determined automatically.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_endrow">endRow</code></td>
<td>
<p>The index of the last row to read from. Defaults to <code>0</code> meaning that the end row is determined automatically.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_endcol">endCol</code></td>
<td>
<p>The index of the last column to read from. Defaults to <code>0</code> meaning that the end column is determined automatically.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_autofitrow">autofitRow</code></td>
<td>
<p><code>logical</code> specifying if leading and trailing empty rows should be
skipped. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_autofitcol">autofitCol</code></td>
<td>
<p><code>logical</code> specifying if leading and trailing empty columns should be skipped. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_region">region</code></td>
<td>
<p>A range specifier in the form 'A10:B18'. This provides an alternative way to specify
<code>startRow</code>, <code>startCol</code>, <code>endRow</code> and <code>endCol</code>. Range specifications take precedence
over index specifications.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_header">header</code></td>
<td>
<p>Interpret the first row of the specified area as column
headers. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_rownames">rownames</code></td>
<td>
<p>Index (<code>numeric</code>) or name (<code>character</code>) of column that
should be used as row names. The corresponding column will be removed from the data
set. Defaults to <code>NULL</code> which means that no row names are applied. Row names must be either
<code>integer</code> or <code>character</code>. Non-numeric columns will be coerced to <code>character</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_coltypes">colTypes</code></td>
<td>
<p>Column types to use when reading in the data. Specified as a <code>character</code>
vector of the corresponding type names (see <code><a href="#topic+XLC">XLC</a></code>; <code>XLC$DATA_TYPE.&lt;?&gt;</code>). You
may also use R class names such as <code>numeric</code>, <code>character</code>, <code>logical</code> and <code>POSIXt</code>.
The types are applied in the given order to the columns - elements are recycled if necessary.
Defaults to <code>character(0)</code> meaning that column types are determined automatically (see the
Note section for more information).<br />
By default, type conversions are only applied if the specified column type is a more generic type
(e.g. from Numeric to String) - otherwise <code>NA</code> is returned. The <code>forceConversion</code> flag can be
set to force conversion into less generic types where possible.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_forceconversion">forceConversion</code></td>
<td>
<p><code>logical</code> specifying if conversions to less generic types should be
forced. Defaults to <code>FALSE</code> meaning that if a column is specified
to be of a certain type via the <code>colTypes</code> argument and a more generic type is detected in
the column, then <code>NA</code> will be returned (example: column is specified to be DateTime but a
more generic String is found). Specifying <code>forceConversion = TRUE</code> will try to enforce a
conversion - if it succeeds the corresponding (converted) value will be returned, otherwise
<code>NA</code>. See the Note section for some additional information.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_datetimeformat">dateTimeFormat</code></td>
<td>
<p>Date/time format used when doing date/time conversions. Defaults to<br />
<code>getOption("XLConnect.dateTimeFormat")</code>. This should be a POSIX format specifier according
to <code><a href="base.html#topic+strptime">strptime</a></code> although not all specifications have been implemented yet - the most
important ones however are available. When using the '%OS' specification for fractional seconds
(without an additional integer) 3 digits will be used by default (<code>getOption("digits.secs")</code> 
is not considered).
</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_check.names">check.names</code></td>
<td>
<p><code>logical</code> specifying if column names of the resulting <code>data.frame</code>
should be checked to ensure that they are syntactically valid variable names and are not
duplicated. See the <code>check.names</code> argument of <code><a href="base.html#topic+data.frame">data.frame</a></code>. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_usecachedvalues">useCachedValues</code></td>
<td>
<p><code>logical</code> specifying whether to read cached formula results from the 
workbook instead of re-evaluating them. This is particularly helpful in cases for reading data
produced by Excel features not supported in XLConnect like references to external workbooks. 
Defaults to <code>FALSE</code>, which means that formulas will be evaluated by XLConnect.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_keep">keep</code></td>
<td>
<p>Vector of column names or indices to be kept in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time.
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.
Example: if <code>sheet = c("Sheet1", "Sheet2", "Sheet3")</code> and <code>keep = c(1,2)</code>, <code>keep</code> will be
internally converted into <code>list(c(1,2))</code> and then replicated to match the number of sheets, i.e.
<code>keep = list(c(1,2), c(1,2), c(1,2))</code>. The result is that the first two columns of each sheet
are kept. If <code>keep = list(1,2)</code> is specified, it will be replicated as <code>list(1,2,1)</code>, i.e. respectively
the first, second and first column of the sheets &quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet3&quot;
will be kept.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_drop">drop</code></td>
<td>
<p>Vector of column names or indices to be dropped in the output data frame.
It is possible to specify either <code>keep</code> or <code>drop</code>, but not both at the same time.
Defaults to <code>NULL</code>. If a vector is passed as argument, it will be wrapped into a list.
This list gets replicated to match the length of the other arguments.
Example: if <code>sheet = c("Sheet1", "Sheet2", "Sheet3")</code> and <code>drop = c(1,2)</code>, <code>drop</code> will be
internally converted into <code>list(c(1,2))</code> and then replicated to match the number of sheets, i.e.
<code>drop = list(c(1,2), c(1,2), c(1,2))</code>. The result is that the first two columns of each sheet
are dropped. If <code>drop = list(1,2)</code> is specified, it will be replicated as <code>list(1,2,1)</code>, i.e. respectively
the first, second and first column of the sheets &quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet3&quot;
will be dropped.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_simplify">simplify</code></td>
<td>
<p><code>logical</code> specifying if the result should be simplified, e.g. in case the <code>data.frame</code>
would only have one row or one column (and data types match). Simplifying here is identical to calling <code>unlist</code>
on the otherwise resulting <code>data.frame</code> (using <code>use.names = FALSE</code>). The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="readWorksheet-methods_+3A_readstrategy">readStrategy</code></td>
<td>
<p><code>character</code> specifying the reading strategy to use. Currently supported strategies are:
</p>

<ul>
<li> <p><code>"default"</code> (default): Can handle all supported data types incl. date/time values and can deal 
directly with missing value identifiers (see <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code>)
</p>
</li>
<li> <p><code>"fast"</code>: Increased read performance. Date/time values are read as numeric (number of days since 1900-01-01; 
fractional days represent hours, minutes, and seconds) and only blank cells are recognized as missing (missing value 
identifiers as set in <code><a href="#topic+setMissingValue-methods">setMissingValue</a></code> are ignored)
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Reads data from the worksheet specified by <code>sheet</code>. Data is read
starting at the top left corner specified by <code>startRow</code> and
<code>startCol</code> down to the bottom right corner specified by
<code>endRow</code> and <code>endCol</code>. If <code>header = TRUE</code>, the first row
is interpreted as column names of the resulting <code>data.frame</code>.<br /> If
<code>startRow &lt;= 0</code> then the first available row in the sheet is assumed. 
If <code>endRow = 0</code> then the last available row in the sheet is assumed.
For <code>endRow = -n</code> with n &gt; 0, the 'last row' - n rows is assumed. This
is useful in cases where you want to skip the last n rows.
If <code>startCol &lt;= 0</code> then the minimum column between <code>startRow</code> and
<code>endRow</code> is assumed. If <code>endCol = 0</code> then the maximum column between
<code>startRow</code> and <code>endRow</code> is assumed. If <code>endCol = -n</code> with n &gt; 0,
the maximum column between <code>startRow</code> and <code>endRow</code> except for the last n
columns is assumed.
</p>
<p>In other words, if no boundaries are specified <code>readWorksheet</code> assumes the &quot;bounding box&quot; of the data as the corresponding boundaries.<br />
The arguments <code>autofitRow</code> and <code>autofitCol</code> (both defaulting to <code>TRUE</code>) can be used to skip leading and trailing empty rows even in case <code>startRow</code>, <code>endRow</code>, <code>startCol</code> and <code>endCol</code> are specified to values <code>&gt; 0</code>. This can be useful if data is expected within certain given boundaries but the exact location is not available.<br /><br />
</p>
<p>If all four coordinate arguments are missing this behaves as above with
<code>startRow = 0</code>, <code>startCol = 0</code>, <code>endRow = 0</code> and
<code>endCol = 0</code>. In this case  <code>readWorksheet</code> assumes the
&quot;bounding box&quot; of the data as the corresponding boundaries.<br /><br />
</p>
<p>All arguments (except <code>object</code>) are vectorized. As such, multiple worksheets (and also multiple data regions
from the same worksheet) can be read with one method call. If only one single data region is read, the return value 
is a <code>data.frame</code>. If multiple data regions are specified, the return value is a <code>list</code> of <code>data.frame</code>'s 
returned in the order they have been specified. If worksheets have been specified by name, the <code>list</code> will be a
named <code>list</code> named by the corresponding worksheets.
</p>


<h3>Note</h3>

<p>If no specific column types (see argument <code>colTypes</code>) are specified,
<code>readWorksheet</code> tries to determine the resulting column types based on the read cell types. If different cell
types are found in a specific column, the most general of those is used and mapped to the corresponding R data type.
The order of data types from least to most general is Boolean (<code>logical</code>) &lt; DateTime (<code>POSIXct</code>) &lt; 
Numeric (<code>numeric</code>) &lt; String (<code>character</code>). E.g. if a column is read that contains cells of type Boolean,
Numeric and String then the resulting column in R would be <code>character</code> since <code>character</code> is the most general
type.<br /><br />
Some additional information with respect to forcing data type conversion
using <code>forceConversion = TRUE</code>:
</p>

<ul>
<li><p> Forcing conversion from String to Boolean: <code>TRUE</code> is returned
if and only if the target string is &quot;true&quot; (ignoring any capitalization).
Any other string will return <code>FALSE</code>.
</p>
</li>
<li><p> Forcing conversion from Numeric to DateTime: since Excel understands
Dates/Times as Numerics with some additional formatting, a conversion from
a Numeric to a DateTime is actually possible. Numerics in this case represent
the number of days since 1900-01-00 (yes, day 00! - see <a href="https://web.archive.org/web/20240821110422/http://www.cpearson.com/excel/datetime.htm">https://web.archive.org/web/20240821110422/http://www.cpearson.com/excel/datetime.htm</a>).
Note that in R 0 is represented as 1899-12-31 since there is no 1900-01-00.
Fractional days represent hours, minutes, and seconds.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Martin Studer<br />
Thomas Themel<br />
Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,<br />
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>,
<code><a href="#topic+readTable-methods">readTable</a></code>,
<code><a href="#topic+onErrorCell-methods">onErrorCell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example 1:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read worksheet 'mtcars' (providing no specific area bounds;
# with default header = TRUE)
data &lt;- readWorksheet(wb, sheet = "mtcars")


## Example 2:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read worksheet 'mtcars' (providing area bounds; with default header = TRUE)
data &lt;- readWorksheet(wb, sheet = "mtcars", startRow = 1, startCol = 3,
                      endRow = 15, endCol = 8)


## Example 3:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read worksheet 'mtcars' (providing area bounds using the region argument;
# with default header = TRUE)
data &lt;- readWorksheet(wb, sheet = "mtcars", region = "C1:H15")


## Example 4:
# conversion xlsx file from demoFiles subfolder of package XLConnect
excelFile &lt;- system.file("demoFiles/conversion.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(excelFile)

# Read worksheet 'Conversion' with pre-specified column types
# Note: in the worksheet all data was entered as strings!
# forceConversion = TRUE is used to force conversion from String
# into the less generic data types Numeric, DateTime &amp; Boolean
df &lt;- readWorksheet(wb, sheet = "Conversion", header = TRUE,
                    colTypes = c(XLC$DATA_TYPE.NUMERIC,
                                 XLC$DATA_TYPE.DATETIME,
                                 XLC$DATA_TYPE.BOOLEAN),
                    forceConversion = TRUE,
                    dateTimeFormat = "%Y-%m-%d %H:%M:%S")
                    
## Example 5:
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Read the columns 1, 3 and 5 from the sheet 'mtcars' (with default header = TRUE)
data &lt;- readWorksheet(wb, sheet = "mtcars", keep=c(1,3,5))

## End(Not run)
</code></pre>

<hr>
<h2 id='readWorksheetFromFile'>Reading data from worksheets in an Excel file (wrapper function)</h2><span id='topic+readWorksheetFromFile'></span>

<h3>Description</h3>

<p>Reads data from worksheets in an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readWorksheetFromFile(file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readWorksheetFromFile_+3A_file">file</code></td>
<td>
<p>The path name of the file to read from.</p>
</td></tr>
<tr><td><code id="readWorksheetFromFile_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="#topic+readWorksheet-methods">readWorksheet</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="#topic+readWorksheet-methods">readWorksheet</a> for more information.
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>,
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>,<br />
<code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>,
<code><a href="#topic+onErrorCell-methods">onErrorCell</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of 
# package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx", 
                             package = "XLConnect")

# Read single area from first sheet of existing file,
# "B2:C3" in Excel speak
df.one &lt;- readWorksheetFromFile(demoExcelFile, sheet = 1, 
                                header = FALSE, startCol = 2, 
                                startRow = 2, endCol = 3, 
                                endRow = 3)

# Read three data sets in one from known positions
dflist &lt;- readWorksheetFromFile(demoExcelFile,
                                sheet = c("FirstSheet", 
                                          "FirstSheet", 
                                          "SecondSheet"),
                                header = TRUE, 
                                startRow = c(2,2,3), 
                                startCol = c(2,5,2),
                                endCol = c(5,8,6), 
                                endRow = c(9,15,153))

## End(Not run)
</code></pre>

<hr>
<h2 id='removeName-methods'>Removing names from workbooks</h2><span id='topic+removeName'></span><span id='topic+removeName-methods'></span><span id='topic+removeName+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Removes a named range reference from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
removeName(object,name,worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeName-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="removeName-methods_+3A_name">name</code></td>
<td>
<p>The name to delete</p>
</td></tr>
<tr><td><code id="removeName-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional - the name of the worksheet in which the name is scoped;
useful if different sheets have locally-scoped named ranges with the same name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Removes the named range reference <code>name</code> from the specified workbook <code>object</code> if it does exist.
Data in the referenced cells remains unchanged. Multiple names can be specified to be removed.
Use <code>worksheetScope = ""</code> to only target names defined in the global scope.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+createName-methods">createName</a></code>,
<code><a href="#topic+existsName-methods">existsName</a></code>,<br />
<code><a href="#topic+getDefinedNames-methods">getDefinedNames</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Remove the named region called 'mtcars' from the above file
# (this named region is defined as 'mtcars!$A$1:$K$33')
removeName(wb, name = "mtcars")

## End(Not run)
</code></pre>

<hr>
<h2 id='removePane-methods'>Removing panes from worksheet</h2><span id='topic+removePane'></span><span id='topic+removePane-methods'></span><span id='topic+removePane+2Cworkbook+2Ccharacter-method'></span><span id='topic+removePane+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Removes the split pane/freeze pane from the specified worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
removePane(object,sheet)
## S4 method for signature 'workbook,numeric'
removePane(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removePane-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="removePane-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet from which to remove the split pane/freeze pane</p>
</td></tr>
</table>


<h3>Note</h3>

<p>To keep an area of a worksheet visible while you scroll to another area of the worksheet,
you can lock specific rows or columns in one area by freezing or splitting panes.
</p>
<p>When you freeze panes, you keep specific rows or columns visible when you scroll in the worksheet.
For example, you might want to keep row and column labels visible as you scroll.
</p>
<p>When you split panes, you create separate worksheet areas that you can scroll within,
while rows or columns in the non-scrolled area remain visible.
</p>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>How to create a freeze pane/split pane in Office 2007
<a href="https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us">https://support.microsoft.com/en-us/office/freeze-panes-to-lock-rows-and-columns-dab2ffc9-020d-4026-8121-67dd25f2508f?ocmsassetid=hp001217048&amp;correlationid=b4f5baeb-b622-4487-a96f-514d2f00208a&amp;ui=en-us&amp;rs=en-us&amp;ad=us</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
<code><a href="#topic+createFreezePane-methods">createFreezePane</a></code>
<code><a href="#topic+createSplitPane-methods">createSplitPane</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("removePaneTest.xlsx", create = TRUE)

# Create a worksheet named 'Sheet1'
createSheet(wb, name = "Sheet1")

# Create a split pane on Sheet1, with coordinates (10000, 5000) expressed as 1/20th of a point,
# 10 (-&gt; J) as left column visible in right pane and 10 as top row visible in bottom pane 
createSplitPane(wb, "Sheet1", 10000, 5000, 10, 10)

# Remove the split pane from Sheet1
removePane(wb, "Sheet1")

# Save workbook (this actually writes the file to disk). Now the workbook has no split pane.
saveWorkbook(wb)

# clean up 
file.remove("removePaneTest.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='removeSheet-methods'>Removing worksheets from workbooks</h2><span id='topic+removeSheet'></span><span id='topic+removeSheet-methods'></span><span id='topic+removeSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+removeSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Removes a worksheet from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
removeSheet(object,sheet)
## S4 method for signature 'workbook,numeric'
removeSheet(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="removeSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to remove</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When removing a worksheet that is the currently active sheet then <span class="pkg">XLConnect</span> resets
the active sheet to the first possible worksheet in the <code><a href="#topic+workbook-class">workbook</a></code>.<br />
Also note that deleting worksheets may result in invalid name references.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+existsSheet-methods">existsSheet</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>,
<code><a href="#topic+renameSheet-methods">renameSheet</a></code>, <code><a href="#topic+cloneSheet-methods">cloneSheet</a></code>,
<code><a href="#topic+setActiveSheet-methods">setActiveSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Remove the worksheet called 'mtcars' from the above file
removeSheet(wb, sheet = "mtcars")

## End(Not run)
</code></pre>

<hr>
<h2 id='renameSheet-methods'>Renaming worksheets from workbooks</h2><span id='topic+renameSheet'></span><span id='topic+renameSheet-methods'></span><span id='topic+renameSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+renameSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Renames a worksheet from a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
renameSheet(object,sheet,newName)
## S4 method for signature 'workbook,numeric'
renameSheet(object,sheet,newName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="renameSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="renameSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to rename</p>
</td></tr>
<tr><td><code id="renameSheet-methods_+3A_newname">newName</code></td>
<td>
<p>The new name of the sheet</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that renaming worksheets may result in invalid name references.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+existsSheet-methods">existsSheet</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>,
<code><a href="#topic+removeSheet-methods">removeSheet</a></code>, <code><a href="#topic+cloneSheet-methods">cloneSheet</a></code>,
<code><a href="#topic+setActiveSheet-methods">setActiveSheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Rename the worksheet called 'mtcars' from the above file to 'MyCars'
renameSheet(wb, sheet = "mtcars", newName = "MyCars")

## End(Not run)
</code></pre>

<hr>
<h2 id='saveWorkbook-methods'>Saving Microsoft Excel workbooks</h2><span id='topic+saveWorkbook'></span><span id='topic+saveWorkbook-methods'></span><span id='topic+saveWorkbook+2Cworkbook+2Cmissing-method'></span><span id='topic+saveWorkbook+2Cworkbook+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Saves a <code><a href="#topic+workbook-class">workbook</a></code> to the corresponding Excel file. This method actually writes the <code><a href="#topic+workbook-class">workbook</a></code> object to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,missing'
saveWorkbook(object,file)
## S4 method for signature 'workbook,character'
saveWorkbook(object,file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveWorkbook-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to save</p>
</td></tr>
<tr><td><code id="saveWorkbook-methods_+3A_file">file</code></td>
<td>
<p>The file to which to save the <code><a href="#topic+workbook-class">workbook</a></code> (&quot;save as&quot;).
If not specified (missing), the workbook will be saved to the <code><a href="#topic+workbook-class">workbook</a></code>'s underlying 
file which is the file specified in <code><a href="#topic+loadWorkbook">loadWorkbook</a></code> (also see the <code><a href="#topic+workbook-class">workbook</a></code> 
class for more information). Note that due to currently missing functionality in Apache POI, workbooks can
only be saved in the same file format - i.e. if the workbooks underlying file format is xls, then the 
<code>file</code> argument may only specify another xls file. Also note that when specifying the <code>file</code> 
argument the <code><a href="#topic+workbook-class">workbook</a></code>'s underlying filename changes to reflect the &quot;save as&quot; behavior.<br />
Paths are expanded using <code>path.expand</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Saves the specified <code><a href="#topic+workbook-class">workbook</a></code> object to disk.
</p>


<h3>Note</h3>

<p>As already mentioned in the documentation of the
<code><a href="#topic+workbook-class">workbook</a></code> class,  a <code><a href="#topic+workbook-class">workbook</a></code>'s
underlying Excel file is not saved (or being created in case the file
did not exist and <code>create = TRUE</code> has been specified) unless the
<code>saveWorkbook</code> method has been called on the object. This provides
more flexibility to the user to decide when changes are saved and also
provides better performance in that several changes can be written in
one go (normally at the end, rather than  after every operation causing
the file to be rewritten again completely each time). This is due to the
fact that workbooks are manipulated in-memory and are only written to
disk with specifically calling <code>saveWorkbook</code>.<br /><br />
Further note that calling <code>saveWorkbook</code> more than once leads to an
exception. This is due to a current issue in the underlying POI libraries.
However, with <span class="pkg">XLConnect</span> there should be no need to call <code>saveWorkbook</code>
more than once so virtually this is no issue.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+loadWorkbook">loadWorkbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create a new workbook 'saveMe.xlsx'
# (assuming the file to not exist already)
wb &lt;- loadWorkbook("saveMe.xlsx", create = TRUE)

# Create a worksheet called 'mtcars'
createSheet(wb, name = "mtcars")

# Write built-in dataset 'mtcars' to sheet 'mtcars' created above
writeWorksheet(wb, mtcars, sheet = "mtcars")

# Save workbook - this actually writes the file 'saveMe.xlsx' to disk
saveWorkbook(wb)

# clean up 
file.remove("saveMe.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setActiveSheet-methods'>Setting the active worksheet in a workbook</h2><span id='topic+setActiveSheet'></span><span id='topic+setActiveSheet-methods'></span><span id='topic+setActiveSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+setActiveSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets the active worksheet of a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setActiveSheet(object,sheet)
## S4 method for signature 'workbook,numeric'
setActiveSheet(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setActiveSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setActiveSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to activate</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The active worksheet of a <code><a href="#topic+workbook-class">workbook</a></code> is the worksheet that is displayed
when the corresponding Excel file is opened.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+createSheet-methods">createSheet</a></code>,
<code><a href="#topic+removeSheet-methods">removeSheet</a></code>, <code><a href="#topic+renameSheet-methods">renameSheet</a></code>,
<code><a href="#topic+existsSheet-methods">existsSheet</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Sets the active sheet to the sheet 'mtcars3'
setActiveSheet(wb, sheet = "mtcars3")

## End(Not run)
</code></pre>

<hr>
<h2 id='setAutoFilter-methods'>Setting auto-filters on worksheets</h2><span id='topic+setAutoFilter'></span><span id='topic+setAutoFilter-methods'></span><span id='topic+setAutoFilter+2Cworkbook+2Ccharacter-method'></span><span id='topic+setAutoFilter+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets an auto-filter on a specified worksheet. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setAutoFilter(object,sheet,reference)
## S4 method for signature 'workbook,numeric'
setAutoFilter(object,sheet,reference)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setAutoFilter-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setAutoFilter-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to set the auto-filter</p>
</td></tr>
<tr><td><code id="setAutoFilter-methods_+3A_reference">reference</code></td>
<td>
<p>A cell range specification (<code>character</code>) in the form 'A1:B8'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("autofilter.xlsx", create = TRUE)

# Create a worksheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' on the sheet called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$A$1")

# Write built-in data set 'mtcars' to the above defined named region
# (using header = TRUE)
writeNamedRegion(wb, mtcars, name = "mtcars")

# Set an auto-filter for the named region written above
setAutoFilter(wb, sheet = "mtcars", reference = aref("A1", dim(mtcars)))

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("autofilter.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setBorder-methods'>Specifying borders for cell styles</h2><span id='topic+setBorder'></span><span id='topic+setBorder-methods'></span><span id='topic+setBorder+2Ccellstyle-method'></span>

<h3>Description</h3>

<p>Specifies borders for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle'
setBorder(object,side,type,color)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setBorder-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to edit</p>
</td></tr>
<tr><td><code id="setBorder-methods_+3A_side">side</code></td>
<td>
<p>A vector with any combination of {&quot;bottom&quot;, &quot;left&quot;,
&quot;right&quot;, &quot;top&quot;, &quot;all&quot;}</p>
</td></tr>
<tr><td><code id="setBorder-methods_+3A_type">type</code></td>
<td>
<p>Specifies the border type to be used - it is normally
specified by a corresponding <code><a href="#topic+XLC">XLC</a></code> constant (see the
<code><a href="#topic+XLC">XLC</a></code> border constant,
e.g. <code>XLC$"BORDER.MEDIUM_DASHED"</code>)</p>
</td></tr>
<tr><td><code id="setBorder-methods_+3A_color">color</code></td>
<td>
<p>Defines the border color and is normally also specified
via an <code><a href="#topic+XLC">XLC</a></code> constant.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifies the border for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>. Note that the arguments
<code>type</code> and  <code>color</code> should be of the same length as side. In
other words, for each specified <code>side</code> there should be a
corresponding specification of <code>type</code> and <code>color</code>. If this is
not the case the arguments will be automatically replicated to the
length of <code>side</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>, <code><a href="#topic+XLC">XLC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setBorder.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify the border for the cell style created above
setBorder(cs, side = c("bottom", "right"), type = XLC$"BORDER.THICK", 
          color = c(XLC$"COLOR.BLACK", XLC$"COLOR.RED"))

# Set the cell style created above for the top left cell (A1) in the 
# 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, cellstyle = cs)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setBorder.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setCellFormula-methods'>Setting cell formulas</h2><span id='topic+setCellFormula'></span><span id='topic+setCellFormula-methods'></span><span id='topic+setCellFormula+2Cworkbook+2Ccharacter-method'></span><span id='topic+setCellFormula+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets cell formulas for specific cells in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setCellFormula(object,sheet,row,col,formula)
## S4 method for signature 'workbook,numeric'
setCellFormula(object,sheet,row,col,formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setCellFormula-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setCellFormula-methods_+3A_sheet">sheet</code></td>
<td>
<p>Name or index of the sheet the cell is on</p>
</td></tr>
<tr><td><code id="setCellFormula-methods_+3A_row">row</code></td>
<td>
<p>Row index of the cell to edit</p>
</td></tr>
<tr><td><code id="setCellFormula-methods_+3A_col">col</code></td>
<td>
<p>Column index of the cell to edit</p>
</td></tr>
<tr><td><code id="setCellFormula-methods_+3A_formula">formula</code></td>
<td>
<p>The formula to apply to the cell, without the initial 
<code>=</code> character used in Excel</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments are vectorized such that multiple cells can be set with
one method call. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+getCellFormula-methods">getCellFormula</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setCellFormula.xls", create = TRUE)

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' referring to the sheet
# called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$A$1")

# Write built-in data set 'mtcars' to the above defined named region.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Now, let us get Excel to calculate average weights.
# Where did we write the dataset?
corners &lt;- getReferenceCoordinatesForName(wb, "mtcars")
# Put the average under the wt column
colIndex &lt;- which(names(mtcars) == "wt") 
rowIndex &lt;- corners[2,1] + 1

# Construct the input range &amp; formula
input &lt;- paste(idx2cref(c(corners[1,1], colIndex, 
                          corners[2,1], colIndex)), collapse=":")
formula &lt;- paste("AVERAGE(", input, ")", sep="") 
            
setCellFormula(wb, "mtcars", rowIndex, colIndex, formula)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("setCellFormula.xls")

## End(Not run)
</code></pre>

<hr>
<h2 id='setCellStyle-methods'>Setting cell styles</h2><span id='topic+setCellStyle'></span><span id='topic+setCellStyle-methods'></span><span id='topic+setCellStyle+2Cworkbook+2Cmissing+2Ccharacter-method'></span><span id='topic+setCellStyle+2Cworkbook+2Cmissing+2Cnumeric-method'></span><span id='topic+setCellStyle+2Cworkbook+2Ccharacter+2Cmissing-method'></span>

<h3>Description</h3>

<p>Sets cell styles for specific cells in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,missing,character'
setCellStyle(object,formula,sheet,row,col,cellstyle)
## S4 method for signature 'workbook,missing,numeric'
setCellStyle(object,formula,sheet,row,col,cellstyle)
## S4 method for signature 'workbook,character,missing'
setCellStyle(object,formula,sheet,row,col,cellstyle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setCellStyle-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setCellStyle-methods_+3A_formula">formula</code></td>
<td>
<p>A formula specification in the form Sheet!B8:C17. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.</p>
</td></tr>
<tr><td><code id="setCellStyle-methods_+3A_sheet">sheet</code></td>
<td>
<p>Name or index of the sheet the cell is on. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.</p>
</td></tr>
<tr><td><code id="setCellStyle-methods_+3A_row">row</code></td>
<td>
<p>Row index of the cell to apply the cellstyle to.</p>
</td></tr>
<tr><td><code id="setCellStyle-methods_+3A_col">col</code></td>
<td>
<p>Column index of the cell to apply the cellstyle to.</p>
</td></tr>
<tr><td><code id="setCellStyle-methods_+3A_cellstyle">cellstyle</code></td>
<td>
<p><code><a href="#topic+cellstyle-class">cellstyle</a></code> to apply</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sets the specified <code><a href="#topic+cellstyle-class">cellstyle</a></code> for the specified cell
(<code>row</code>, <code>col</code>) on the specified <code>sheet</code> or alternatively for the cells referred to by <code>formula</code>. Note that the
arguments are vectorized such that multiple cells can be styled with one
method call. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+cellstyle-class">cellstyle</a></code>,
<code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>,
<code><a href="#topic+setDataFormat-methods">setDataFormat</a></code>,
<code><a href="#topic+setBorder-methods">setBorder</a></code>,<br />
<code><a href="#topic+setFillBackgroundColor-methods">setFillBackgroundColor</a></code>,
<code><a href="#topic+setFillForegroundColor-methods">setFillForegroundColor</a></code>,
<code><a href="#topic+setFillPattern-methods">setFillPattern</a></code>,<br />
<code><a href="#topic+setWrapText-methods">setWrapText</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setCellStyle.xlsx", create = TRUE)

# We don't set a specific style action in this demo, so the default 
# 'XLConnect' will be used (XLC$"STYLE_ACTION.XLCONNECT")

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' referring to the sheet
# called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$C$4")

# Write built-in data set 'mtcars' to the above defined named region.
# This will use the default style action 'XLConnect'.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Now let's color all weight cells of cars with a weight &gt; 3.5 in red
# (mtcars$wt &gt; 3.5)

# First, create a corresponding (named) cell style
heavyCar &lt;- createCellStyle(wb, name = "HeavyCar")

# Specify the cell style to use a solid foreground color
setFillPattern(heavyCar, fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(heavyCar, color = XLC$"COLOR.RED")

# Which cars have a weight &gt; 3.5 ?
rowIndex &lt;- which(mtcars$wt &gt; 3.5)

# NOTE: The mtcars data.frame has been written offset with
# top left cell C4 - and we have also written a header row!
# So, let's take that into account appropriately. Obviously,
# the two steps could be combined directly into one ...
rowIndex &lt;- rowIndex + 4

# The same holds for the column index
colIndex &lt;- which(names(mtcars) == "wt") + 2

# Set the 'HeavyCar' cell style for the corresponding cells.
# Note: the row and col arguments are vectorized!
setCellStyle(wb, sheet = "mtcars", row = rowIndex, col = colIndex, 
             cellstyle = heavyCar)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("setCellStyle.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setCellStyleForType-methods'>Setting the cell style per data type for the DATATYPE style action</h2><span id='topic+setCellStyleForType'></span><span id='topic+setCellStyleForType-methods'></span><span id='topic+setCellStyleForType+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Sets the cell style for a specific data type as used by the DATATYPE style action.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
setCellStyleForType(object,type,style)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setCellStyleForType-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setCellStyleForType-methods_+3A_type">type</code></td>
<td>
<p>The data type for which to set the <code>style</code></p>
</td></tr>
<tr><td><code id="setCellStyleForType-methods_+3A_style">style</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to set</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the (cell) data type the DATATYPE style action (see <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>)
sets the <code><a href="#topic+cellstyle-class">cellstyle</a></code> for the corresponding cells. The data <code>type</code> is normally specified via a
corresponding data type constant from the <code><a href="#topic+XLC">XLC</a></code> object. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getCellStyleForType-methods">getCellStyleForType</a></code>,
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file.copy(system.file("demoFiles/template2.xlsx", 
                      package = "XLConnect"),
          "datatype.xlsx", overwrite = TRUE)

# Load workbook
wb &lt;- loadWorkbook("datatype.xlsx")

# Create a new cell style to be used
cs &lt;- createCellStyle(wb, name = "mystyle")

# Set data format (number format) as numbers with aligned fractions
setDataFormat(cs, format = "# ???/???")

# Define the above created cell style as style to be used for
# numerics
setCellStyleForType(wb, type = XLC$"DATA_TYPE.NUMERIC", style = cs)
# Could also say cs &lt;- setCellStyleForType(wb, "numeric")
          
# Set style action to 'datatype'
setStyleAction(wb, XLC$"STYLE_ACTION.DATATYPE")

# Write built-in data set 'mtcars' to the named region 
# 'mtcars' as defined by the Excel template.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook
saveWorkbook(wb)

# clean up
file.remove("datatype.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setColumnWidth-methods'>Setting the width of a column in a worksheet</h2><span id='topic+setColumnWidth'></span><span id='topic+setColumnWidth-methods'></span><span id='topic+setColumnWidth+2Cworkbook+2Ccharacter-method'></span><span id='topic+setColumnWidth+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets the width of a column in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setColumnWidth(object,sheet,column,width)
## S4 method for signature 'workbook,numeric'
setColumnWidth(object,sheet,column,width)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setColumnWidth-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setColumnWidth-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet</p>
</td></tr>
<tr><td><code id="setColumnWidth-methods_+3A_column">column</code></td>
<td>
<p>The index of the column to resize</p>
</td></tr>
<tr><td><code id="setColumnWidth-methods_+3A_width">width</code></td>
<td>
<p>The width of the specified column in  units of 1/256th of a character width.
If <code>width = -1</code> (default), the column is auto-sized. If negative otherwise, the column
will be sized to the sheet's default column width.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments <code>sheet</code>, <code>column</code> and <code>width</code> are
vectorized. As such the column width of multiple columns (potentially on
different sheets) can be set with one method call. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setRowHeight-methods">setRowHeight</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Sets the column width of the 3rd column on sheet 'mtcars' 
# to 4000/256th (= 15.625) character width
setColumnWidth(wb, sheet = "mtcars", column = 3, width = 4000)

## End(Not run)
</code></pre>

<hr>
<h2 id='setDataFormat-methods'>Specifying custom data formats for cell styles</h2><span id='topic+setDataFormat'></span><span id='topic+setDataFormat-methods'></span><span id='topic+setDataFormat+2Ccellstyle-method'></span>

<h3>Description</h3>

<p>Specifies a custom data format for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle'
setDataFormat(object,format)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setDataFormat-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to use</p>
</td></tr>
<tr><td><code id="setDataFormat-methods_+3A_format">format</code></td>
<td>
<p>A data format string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifies the data <code>format</code> to be used by the corresponding
<code><a href="#topic+cellstyle-class">cellstyle</a></code>. Data formats are specified the standard
Excel way. Refer to the Excel help or to the link below for more
information. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setDataFormat.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a dummy data set with the current date/time (as POSIXct)
now &lt;- data.frame(Now = Sys.time())

# Write the value to the 'cellstyles' worksheet in the top left 
# corner (cell A1)
writeWorksheet(wb, now, sheet = "cellstyles", startRow = 1, 
               startCol = 1, header = FALSE)

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify a custom data format
setDataFormat(cs, format = "dddd d-m-yyyy h:mm AM/PM")

# Set the cell style created above for the top left cell (A1) in 
# the 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, cellstyle = cs)

# Set column width to display whole time/date string
setColumnWidth(wb, sheet = "cellstyles", column = 1, width = 6000)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setDataFormat.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setDataFormatForType-methods'>Setting the data format for the DATA_FORMAT_ONLY style action</h2><span id='topic+setDataFormatForType'></span><span id='topic+setDataFormatForType-methods'></span><span id='topic+setDataFormatForType+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Sets the data format for a specific data type as used by the DATA_FORMAT_ONLY style action.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
setDataFormatForType(object,type,format)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setDataFormatForType-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setDataFormatForType-methods_+3A_type">type</code></td>
<td>
<p>The data type for which to set the <code>format</code>.</p>
</td></tr>
<tr><td><code id="setDataFormatForType-methods_+3A_format">format</code></td>
<td>
<p>A data format string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the (cell) data type the DATA_FORMAT_ONLY style action (see <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>)
sets the data format for the corresponding cells. The data <code>type</code> is normally specified via a
corresponding data type constant from the <code><a href="#topic+XLC">XLC</a></code> object. Data formats are specified the standard
Excel way. Refer to the Excel help or to the link below for more information. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Copy existing Excel template to working directory
file.copy(system.file("demoFiles/template2.xlsx", 
                      package = "XLConnect"),
          "dataformat.xlsx", overwrite = TRUE)

# Load workbook
wb &lt;- loadWorkbook("dataformat.xlsx")

# Set the data format for numeric columns (cells)
# (keeping the defaults for all other data types)
setDataFormatForType(wb, type = XLC$"DATA_TYPE.NUMERIC", 
                     format = "0.00")

# Set style action to 'data format only'
setStyleAction(wb, XLC$"STYLE_ACTION.DATA_FORMAT_ONLY")

# Write built-in data set 'mtcars' to the named region 
# 'mtcars' as defined by the Excel template.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook
saveWorkbook(wb)

# clean up
file.remove("dataformat.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setFillBackgroundColor-methods'>Specifying the fill background color for cell styles</h2><span id='topic+setFillBackgroundColor'></span><span id='topic+setFillBackgroundColor-methods'></span><span id='topic+setFillBackgroundColor+2Ccellstyle+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Specifies the fill background color for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle,numeric'
setFillBackgroundColor(object,color)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setFillBackgroundColor-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to manipulate</p>
</td></tr>
<tr><td><code id="setFillBackgroundColor-methods_+3A_color">color</code></td>
<td>
<p>The fill background color to use for the <code><a href="#topic+cellstyle-class">cellstyle</a></code>. 
The <code>color</code> is normally specified via a corresponding color constant from the 
<code><a href="#topic+XLC">XLC</a></code> object. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>, <code><a href="#topic+XLC">XLC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setFillBackgroundColor.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify the fill background color for the cell style created above
setFillBackgroundColor(cs, color = XLC$"COLOR.CORNFLOWER_BLUE")

# Specify the fill foreground color
setFillForegroundColor(cs, color = XLC$"COLOR.YELLOW")

# Specify the fill pattern
setFillPattern(cs, fill = XLC$"FILL.BIG_SPOTS")

# Set the cell style created above for the top left cell (A1) in the 
# 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, cellstyle = cs)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setFillBackgroundColor.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setFillForegroundColor-methods'>Specifying the fill foreground color for cell styles</h2><span id='topic+setFillForegroundColor'></span><span id='topic+setFillForegroundColor-methods'></span><span id='topic+setFillForegroundColor+2Ccellstyle+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Specifies the fill foreground color for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle,numeric'
setFillForegroundColor(object,color)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setFillForegroundColor-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to manipulate</p>
</td></tr>
<tr><td><code id="setFillForegroundColor-methods_+3A_color">color</code></td>
<td>
<p>The fill foreground color to use for the <code><a href="#topic+cellstyle-class">cellstyle</a></code>. 
The <code>color</code> is normally specified via a corresponding color constant from the 
<code><a href="#topic+XLC">XLC</a></code> object. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>, <code><a href="#topic+XLC">XLC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setFillForegroundColor.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify the fill background color for the cell style created above
setFillBackgroundColor(cs, color = XLC$"COLOR.CORNFLOWER_BLUE")

# Specify the fill foreground color
setFillForegroundColor(cs, color = XLC$"COLOR.YELLOW")

# Specify the fill pattern
setFillPattern(cs, fill = XLC$"FILL.BIG_SPOTS")

# Set the cell style created above for the top left cell (A1) in the
# 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, cellstyle = cs)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setFillForegroundColor.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setFillPattern-methods'>Specifying the fill pattern for cell styles</h2><span id='topic+setFillPattern'></span><span id='topic+setFillPattern-methods'></span><span id='topic+setFillPattern+2Ccellstyle-method'></span>

<h3>Description</h3>

<p>Specifies the fill pattern for a <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle'
setFillPattern(object,fill)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setFillPattern-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to manipulate</p>
</td></tr>
<tr><td><code id="setFillPattern-methods_+3A_fill">fill</code></td>
<td>
<p>The fill pattern to use for the <code><a href="#topic+cellstyle-class">cellstyle</a></code>. 
<code>fill</code> is normally specified via a corresponding fill constant from the 
<code><a href="#topic+XLC">XLC</a></code> object. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>, <code><a href="#topic+XLC">XLC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setFillPattern.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify the fill background color for the cell style created above
setFillBackgroundColor(cs, color = XLC$"COLOR.CORNFLOWER_BLUE")

# Specify the fill foreground color
setFillForegroundColor(cs, color = XLC$"COLOR.YELLOW")

# Specify the fill pattern
setFillPattern(cs, fill = XLC$"FILL.BIG_SPOTS")

# Set the cell style created above for the top left cell (A1) in the
# 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, cellstyle = cs)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setFillPattern.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setForceFormulaRecalculation-methods'>Forcing Excel to recalculate formula values when opening a workbook</h2><span id='topic+setForceFormulaRecalculation'></span><span id='topic+setForceFormulaRecalculation-methods'></span><span id='topic+setForceFormulaRecalculation+2Cworkbook+2Ccharacter-method'></span><span id='topic+setForceFormulaRecalculation+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>This function controls a flag that forces Excel to recalculate formula values when a workbook
is opened. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setForceFormulaRecalculation(object,sheet,value)
## S4 method for signature 'workbook,numeric'
setForceFormulaRecalculation(object,sheet,value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setForceFormulaRecalculation-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setForceFormulaRecalculation-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet for which to force formula recalculation.
If <code>sheet = "*"</code>, the flag is set for all sheets in the <code><a href="#topic+workbook-class">workbook</a></code>.</p>
</td></tr>
<tr><td><code id="setForceFormulaRecalculation-methods_+3A_value">value</code></td>
<td>
<p><code>logical</code> specifying if formula recalculation should be forced or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>sheet</code> and <code>value</code> are vectorized such
that multiple worksheets can be controlled with one method call. 
</p>


<h3>Note</h3>

<p>A typical use for this flag is forcing Excel into updating formulas
that reference cells affected by <code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code> 
or <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>. 
The exact behavior of Excel when the flag is set depends on version and file format.
</p>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, 
<code><a href="#topic+getForceFormulaRecalculation-methods">getForceFormulaRecalculation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Tell Excel to automatically recalculate formulas on sheet mtcars
setForceFormulaRecalculation(wb, sheet = "mtcars", TRUE)
# The same with a numerical sheet index
setForceFormulaRecalculation(wb, sheet = 1, TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setHyperlink-methods'>Setting hyperlinks</h2><span id='topic+setHyperlink'></span><span id='topic+setHyperlink-methods'></span><span id='topic+setHyperlink+2Cworkbook+2Cmissing+2Ccharacter-method'></span><span id='topic+setHyperlink+2Cworkbook+2Cmissing+2Cnumeric-method'></span><span id='topic+setHyperlink+2Cworkbook+2Ccharacter+2Cmissing-method'></span>

<h3>Description</h3>

<p>Sets hyperlinks for specific cells in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,missing,character'
setHyperlink(object,formula,sheet,row,col,type,address)
## S4 method for signature 'workbook,missing,numeric'
setHyperlink(object,formula,sheet,row,col,type,address)
## S4 method for signature 'workbook,character,missing'
setHyperlink(object,formula,sheet,row,col,type,address)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setHyperlink-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_formula">formula</code></td>
<td>
<p>A formula specification in the form Sheet!B8:C17. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_sheet">sheet</code></td>
<td>
<p>Name or index of the sheet the cell is on. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_row">row</code></td>
<td>
<p>Row index of the cell to apply the cellstyle to.</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_col">col</code></td>
<td>
<p>Column index of the cell to apply the cellstyle to.</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_type">type</code></td>
<td>
<p>Hyperlink type. See the corresponding &quot;HYPERLINK.*&quot; constants from the <code><a href="#topic+XLC">XLC</a></code> object.</p>
</td></tr>
<tr><td><code id="setHyperlink-methods_+3A_address">address</code></td>
<td>
<p>Hyperlink address. This needs to be a valid URI including scheme. E.g. for email <code>mailto:myself@me.org</code>, for a URL <code>https://www.somewhere.net</code> or for a file <code>file:///a/b/c.dat</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sets a hyperlink for the specified cells. Note that <code><a href="#topic+cellstyle-class">cellstyle</a></code>s for hyperlinks can be defined independently using
<code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>. The arguments are vectorized such that multiple hyperlinks can be set in one
method call. Use either the argument <code>formula</code> or the combination of <code>sheet</code>, <code>row</code> and <code>col</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setHyperlink.xlsx", create = TRUE)

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")


# Write built-in data set 'mtcars' to the above defined worksheet
writeWorksheet(wb, mtcars, sheet = "mtcars", rownames = "Car")

# Set hyperlinks
links &lt;- paste0("https://www.google.com?q=", gsub(" ", "+", rownames(mtcars)))
setHyperlink(wb, sheet = "mtcars", row = seq_len(nrow(mtcars)) + 1, col = 1,
  type = XLC$HYPERLINK.URL, address = links)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("setHyperlink.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setMissingValue-methods'>Setting missing value identifiers</h2><span id='topic+setMissingValue'></span><span id='topic+setMissingValue-methods'></span><span id='topic+setMissingValue+2Cworkbook-method'></span><span id='topic+setMissingValue+2Cworkbook+2CANY-method'></span>

<h3>Description</h3>

<p>Defines the set of missing values (character or numeric) used when reading and writing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,ANY'
setMissingValue(object,value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setMissingValue-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setMissingValue-methods_+3A_value">value</code></td>
<td>
<p><code>vector</code> or <code>list</code> of missing value identifiers (either
<code>character</code> or <code>numeric</code>) that are recognized as missing (<code>NA</code>) 
when reading data. The first element of this vector will be used as missing value 
identifier when writing data. If <code>value = NULL</code> (default), missing values are 
represented by blank cells and only blank cells are recognized as missing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are no specific missing value identifiers defined the default behavior is
to map missing values to blank (empty) cells. Otherwise, each string or numeric cell is 
checked if it matches one of the defined missing value identifiers. In addition, the first 
missing value identifier (i.e. the first element of the <code>value</code> argument) is used to represent missing values when writing data.<br />
Note that the missing value identifiers have to be either <code>character</code> or <code>numeric</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("missingValue.xlsx", create = TRUE)

# Create a worksheet named 'airquality'
createSheet(wb, name = "airquality")

# Create a named region called 'airquality' on the sheet called
# 'airquality'
createName(wb, name = "airquality", formula = "airquality!$A$1")

# Set the missing value string to 'missing'
setMissingValue(wb, value = "missing")

# Write built-in data set 'airquality' to the above defined named region
writeNamedRegion(wb, airquality, name = "airquality")

# Save workbook
saveWorkbook(wb)

# clean up 
file.remove("missingValue.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setRowHeight-methods'>Setting the height of a row in a worksheet</h2><span id='topic+setRowHeight'></span><span id='topic+setRowHeight-methods'></span><span id='topic+setRowHeight+2Cworkbook+2Ccharacter-method'></span><span id='topic+setRowHeight+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets the height of a row in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setRowHeight(object,sheet,row,height)
## S4 method for signature 'workbook,numeric'
setRowHeight(object,sheet,row,height)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setRowHeight-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setRowHeight-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to edit</p>
</td></tr>
<tr><td><code id="setRowHeight-methods_+3A_row">row</code></td>
<td>
<p>The index of the row to resize</p>
</td></tr>
<tr><td><code id="setRowHeight-methods_+3A_height">height</code></td>
<td>
<p>The height in points. If <code>height &lt; 0</code> (default: -1),
the row will be sized to the sheet's default row height.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments <code>sheet</code>, <code>row</code> and <code>height</code> are
vectorized. As such the row height of multiple rows (potentially on
different worksheets) can be set with one method call. 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+setColumnWidth-methods">setColumnWidth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
mtcarsFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(mtcarsFile)

# Sets the row height of the 1st row on sheet 'mtcars'
# to 20 points
setRowHeight(wb, sheet = "mtcars", row = 1, height = 20)

## End(Not run)
</code></pre>

<hr>
<h2 id='setSheetColor-methods'>Setting colors on worksheet tabs</h2><span id='topic+setSheetColor'></span><span id='topic+setSheetColor-methods'></span><span id='topic+setSheetColor+2Cworkbook+2Ccharacter-method'></span><span id='topic+setSheetColor+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets a color on a specified worksheet tab. This only works for xlsx files. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
setSheetColor(object,sheet,color)
## S4 method for signature 'workbook,numeric'
setSheetColor(object,sheet,color)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setSheetColor-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setSheetColor-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to set the tab color</p>
</td></tr>
<tr><td><code id="setSheetColor-methods_+3A_color">color</code></td>
<td>
<p>The color to use for the sheet tab. The color is normally specified
via a corresponding color constant from the <code><a href="#topic+XLC">XLC</a></code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicola Lambiase<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+XLC">XLC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("sheetcolor.xlsx", create = TRUE)

# Create a worksheet named 'Sheet1'
createSheet(wb, name = "Sheet1")

# Set the "Sheet1" tab color as red
setSheetColor(wb, "Sheet1", XLC$COLOR.RED)

# Create a worksheet named 'Sheet2'
createSheet(wb, name = "Sheet2")

# Set the tab color of the second workbook sheet as green
setSheetColor(wb, 2, XLC$COLOR.GREEN)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("sheetcolor.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setSheetPos-methods'>Setting worksheet position</h2><span id='topic+setSheetPos'></span><span id='topic+setSheetPos-methods'></span><span id='topic+setSheetPos+2Cworkbook+2Ccharacter+2Cmissing-method'></span><span id='topic+setSheetPos+2Cworkbook+2Ccharacter+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Sets the position of a worksheets in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character,numeric'
setSheetPos(object,sheet,pos)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setSheetPos-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setSheetPos-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name of the worksheet (<code>character</code>) whose position to set. 
This argument is vectorized such that the positions of multiple worksheets can be 
set with one method call.</p>
</td></tr>
<tr><td><code id="setSheetPos-methods_+3A_pos">pos</code></td>
<td>
<p>The position index to set for the corresponding <code>sheet</code>. If missing, sheets
will be positioned in the order they are specified in the argument <code>sheet</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is important to note that the worksheet positions will be applied one after the other in the order
they have been specified.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getSheetPos-methods">getSheetPos</a></code>,
<code><a href="#topic+getSheets-methods">getSheets</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# mtcars xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/mtcars.xlsx", package = "XLConnect")

# Load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# Move the 'mtcars3' worksheet to the front
setSheetPos(wb, sheet = "mtcars3", pos = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='setStyleAction-methods'>Controlling application of cell styles when writing data to Excel</h2><span id='topic+setStyleAction'></span><span id='topic+setStyleAction-methods'></span><span id='topic+setStyleAction+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Controls the application of <code><a href="#topic+cellstyle-class">cellstyle</a></code>s when writing data to Excel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
setStyleAction(object,type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setStyleAction-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setStyleAction-methods_+3A_type">type</code></td>
<td>
<p>Defines the style action to be used when writing data
(<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>) to the
specified workbook <code>object</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following style actions are supported:<br />
</p>

<ul>
<li> <p><code>XLC$"STYLE_ACTION.XLCONNECT"</code>: This is the
default. <code>data.frame</code> headers (if specified to be written) are
colored in solid light grey (25 percent). character, numeric and
logical vectors are written using Excel's &quot;General&quot; data
format. Time/date vectors e.g. <code>Date</code> or <code>POSIXt</code>) are
written with the &quot;mm/dd/yyyy hh:mm:ss&quot; data format. All cells are
specified to wrap the text if necessary. The corresponding custom cell
styles are called <em>XLConnect.Header</em>, <em>XLConnect.String</em>,
<em>XLConnect.Numeric</em>, <em>XLConnect.Boolean</em> and <em>XLConnect.Date</em>.
</p>
</li>
<li> <p><code>XLC$"STYLE_ACTION.DATATYPE"</code>: This style action instructs
<span class="pkg">XLConnect</span> to apply <code><a href="#topic+cellstyle-class">cellstyle</a></code>s per data type as
set by the <code><a href="#topic+setCellStyleForType-methods">setCellStyleForType</a></code>
methods. In contrast to the <code>XLC$"STYLE_ACTION.DATA_FORMAT_ONLY"</code>
style action (see below) which only sets a data format to an existing
cell style, this action actually sets a new <code><a href="#topic+cellstyle-class">cellstyle</a></code>.
</p>
</li>
<li> <p><code>XLC$"STYLE_ACTION.NONE"</code>: This style action instructs
<span class="pkg">XLConnect</span> to apply no cell styles when writing data. Cell styles
are kept as they are. This is useful in a scenario where all styling is
predefined in an Excel template which is then only filled with
data.
</p>
</li>
<li> <p><code>XLC$"STYLE_ACTION.PREDEFINED"</code>: This style action
instructs <span class="pkg">XLConnect</span> to use existing (predefined) <code><a href="#topic+cellstyle-class">cellstyle</a></code>s when
writing headers and columns. This is useful in a template-based approach
where an Excel template with predefined <code><a href="#topic+cellstyle-class">cellstyle</a></code>s for headers and
columns is available. Normally, this would be used when the column
dimensions (and potentially also the row dimensions) of the data tables
are known up-front and as such a layout and corresponding cell styles
can be pre-specified.<br /> If a <code>data.frame</code> is written including
its header, it is assumed that the Excel file being written to has
predefined <code><a href="#topic+cellstyle-class">cellstyle</a></code>s in the header row. Furthermore, the first row of
data is assumed to contain the cell styles to be replicated for any
additional rows. As such, this style action may only be useful if the
same column cell style should be applied across all rows. Please refer
to the available demos for some examples.
</p>
</li>
<li> <p><code>XLC$"STYLE_ACTION.NAME_PREFIX"</code>: This style action instructs
<span class="pkg">XLConnect</span> to look for custom (named) <code><a href="#topic+cellstyle-class">cellstyle</a></code>s with a specified
prefix when writing columns and headers. This style name prefix can be
set via the method <code><a href="#topic+setStyleNamePrefix-methods">setStyleNamePrefix</a></code>.<br />
</p>
<p>For column headers, it first checks if there is a cell style named<br />
<var>&lt;STYLE_NAME_PREFIX&gt;.Header.&lt;COLUMN_NAME&gt;</var>.<br /> If there is no
such cell style,  it checks for a cell style named<br />
<var>&lt;STYLE_NAME_PREFIX&gt;.Header.&lt;COLUMN_INDEX&gt;</var>.<br /> Again, if
there is no such cell style, it checks for<br />
<var>&lt;STYLE_NAME_PREFIX&gt;.Header</var><br /> (no specific column
discrimination). As a final resort, it just takes the workbook default
cell style.<br /> 
</p>
<p>For columns, <span class="pkg">XLConnect</span> first checks the availability of a cell
style named<br /> <var>&lt;STYLE_NAME_PREFIX&gt;.Column.&lt;COLUMN_NAME&gt;</var>.<br /> If
there is no such cell style, it checks for<br />
<var>&lt;STYLE_NAME_PREFIX&gt;.Column.&lt;COLUMN_INDEX&gt;</var>.<br /> If again there
is no such cell style, it checks for<br />
<var>&lt;STYLE_NAME_PREFIX&gt;.Column.&lt;COLUMN_DATA_TYPE&gt;</var><br /> with
<var>&lt;COLUMN_DATA_TYPE&gt;</var> being the corresponding data type from the
set:  <var>{Numeric, String, Boolean, DateTime}</var>. As a last resort,
it would make use of the workbook's default cell style.
</p>
</li>
<li> <p><code>XLC$"STYLE_ACTION.DATA_FORMAT_ONLY"</code>: This style action instructs
<span class="pkg">XLConnect</span> to only set the data format for a cell but not to apply any other
styling but rather keep the existing one. The data format to apply is determined
by the data type of the cell (which is in turn determined by the corresponding R data
type). The data format for a specific type can be set via the method
<code><a href="#topic+setDataFormatForType-methods">setDataFormatForType</a></code>. The default data format
is &quot;General&quot; for the data types <var>Numeric</var>, <var>String</var> and <var>Boolean</var> and is
&quot;mm/dd/yyyy hh:mm:ss&quot; for the data type <var>DateTime</var>.
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>, <code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>, <code><a href="#topic+setStyleNamePrefix-methods">setStyleNamePrefix</a></code>,
<code><a href="#topic+setCellStyleForType-methods">setCellStyleForType</a></code>,
<code><a href="#topic+setDataFormatForType-methods">setDataFormatForType</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("styleaction.xlsx", create = TRUE)

# Set style action to 'name prefix' 
setStyleAction(wb, XLC$"STYLE_ACTION.NAME_PREFIX")
# Set the name prefix to 'MyPersonalStyle'
setStyleNamePrefix(wb, "MyPersonalStyle")

# We now create a named cell style to be used for the header 
# (column names) of a data.frame
headerCellStyle &lt;- createCellStyle(wb, 
                             name = "MyPersonalStyle.Header")

# Specify the cell style to use a solid foreground color
setFillPattern(headerCellStyle, 
               fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(headerCellStyle, 
                    color = XLC$"COLOR.LIGHT_CORNFLOWER_BLUE")

# Specify a thick black bottom border
setBorder(headerCellStyle, side = "bottom", 
          type = XLC$"BORDER.THICK", 
          color = XLC$"COLOR.BLACK")

# We now create a named cell style to be used for 
# the column named 'wt' (as you will see below, we will 
# write the built-in data.frame 'mtcars')
wtColumnCellStyle &lt;- createCellStyle(wb, 
                           name = "MyPersonalStyle.Column.wt")

# Specify the cell style to use a solid foreground color
setFillPattern(wtColumnCellStyle, 
               fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(wtColumnCellStyle, 
                       color = XLC$"COLOR.LIGHT_ORANGE")

# We now create a named cell style to be used for 
# the 3rd column in the data.frame
wtColumnCellStyle &lt;- createCellStyle(wb, 
                            name = "MyPersonalStyle.Column.3")

# Specify the cell style to use a solid foreground color
setFillPattern(wtColumnCellStyle, 
               fill = XLC$"FILL.SOLID_FOREGROUND")

# Specify the foreground color to be used
setFillForegroundColor(wtColumnCellStyle, 
                       color = XLC$"COLOR.LIME")

# Create a sheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' referring to 
# the sheet called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$A$1")

# Write built-in data set 'mtcars' to the above defined named region.
# The style action 'name prefix' will be used when writing the data
# as defined above.
writeNamedRegion(wb, mtcars, name = "mtcars")

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("styleaction.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='setStyleNamePrefix-methods'>Setting the style name prefix for the &quot;name prefix&quot; style action</h2><span id='topic+setStyleNamePrefix'></span><span id='topic+setStyleNamePrefix-methods'></span><span id='topic+setStyleNamePrefix+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Sets the style name prefix for the &quot;name prefix&quot; style action.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
setStyleNamePrefix(object,prefix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setStyleNamePrefix-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="setStyleNamePrefix-methods_+3A_prefix">prefix</code></td>
<td>
<p>The name prefix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sets the <code>prefix</code> for the &quot;name prefix&quot; style action. See the method <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code> for more information.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>, 
<code><a href="#topic+createCellStyle-methods">createCellStyle</a></code>
</p>

<hr>
<h2 id='setWrapText-methods'>Specifying text wrapping behaviour</h2><span id='topic+setWrapText'></span><span id='topic+setWrapText-methods'></span><span id='topic+setWrapText+2Ccellstyle-method'></span>

<h3>Description</h3>

<p>Specifies if text should be wrapped in a cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cellstyle'
setWrapText(object,wrap)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setWrapText-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+cellstyle-class">cellstyle</a></code> to manipulate</p>
</td></tr>
<tr><td><code id="setWrapText-methods_+3A_wrap">wrap</code></td>
<td>
<p>If <code>wrap = TRUE</code>, the text is wrapped if it exceeds the width of the cell - otherwise not.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>, <code><a href="#topic+setCellStyle-methods">setCellStyle</a></code>, 
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("setWrapText.xlsx", create = TRUE)

# Create a worksheet
createSheet(wb, name = "cellstyles")

# Create a dummy data set with some long text
text &lt;- data.frame(
     Text = "Some very very very very very very very long text")

# Write the value to the 'cellstyles' worksheet in the 
# top left corner (cell A1)
writeWorksheet(wb, text, sheet = "cellstyles", startRow = 1, 
               startCol = 1, header = FALSE)

# Create a custom anonymous cell style
cs &lt;- createCellStyle(wb)

# Specify to wrap the text
setWrapText(cs, wrap = TRUE)

# Set the cell style created above for the top left cell (A1) 
# in the 'cellstyles' worksheet
setCellStyle(wb, sheet = "cellstyles", row = 1, col = 1, 
             cellstyle = cs)

# Save the workbook
saveWorkbook(wb)

# clean up 
file.remove("setWrapText.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='show-methods'>Display a workbook object</h2><span id='topic+show'></span><span id='topic+show-methods'></span><span id='topic+show+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Displays a <code><a href="#topic+workbook-class">workbook</a></code> by printing it. This actually calls the <code><a href="#topic+workbook-class">workbook</a></code>'s
<code><a href="#topic+print-methods">print</a></code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to display</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+print-methods">print</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load existing demo Excel file 'mtcars.xlsx' from the XLConnect package
wb.mtcars &lt;- loadWorkbook(system.file("demoFiles/mtcars.xlsx", 
                          package = "XLConnect"))

# Display the wb.mtcars object
wb.mtcars

# Alternatively, show can be called explicitely
show(wb.mtcars)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary-methods'> Summarizing workbook objects </h2><span id='topic+summary'></span><span id='topic+summary-methods'></span><span id='topic+summary+2Cworkbook-method'></span>

<h3>Description</h3>

<p>Outputs a <code><a href="#topic+workbook-class">workbook</a></code> summary including the underlying Excel filename, contained worksheets,
hidden sheets, very hidden sheets, defined names and the active sheet name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to summarize</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+getSheets-methods">getSheets</a></code>, 
<code><a href="#topic+isSheetHidden-methods">isSheetHidden</a></code>, <code><a href="#topic+isSheetVeryHidden-methods">isSheetVeryHidden</a></code>,
<code><a href="#topic+getDefinedNames-methods">getDefinedNames</a></code>, <code><a href="#topic+getActiveSheetName-methods">getActiveSheetName</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load existing demo Excel file 'mtcars.xlsx' from the XLConnect package
wb.mtcars &lt;- loadWorkbook(system.file("demoFiles/mtcars.xlsx", 
                          package = "XLConnect"))

# Print a workbook summary
summary(wb.mtcars)

## End(Not run)
</code></pre>

<hr>
<h2 id='swissfranc'>Historical Exchange Rates: CHF vs EUR, USD and GBP</h2><span id='topic+swissfranc'></span>

<h3>Description</h3>

<p>This data set provides historical exchange rates (CHF vs EUR, USD, GBP)
in the time frame from January 1, 2014 to February 24, 2015. The exchange 
rates reflect bid prices with a 0% interbank rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swissfranc</code></pre>


<h3>Format</h3>

<p>A data.frame with daily exchange rates in the mentioned time frame.</p>


<h3>Source</h3>

<p>retrieved via &lsquo;<span class="samp">&#8288;https://www.oanda.com/&#8288;</span>&rsquo; - the retrieved time range is no longer available.</p>

<hr>
<h2 id='unhideSheet-methods'>Unhiding worksheets in a workbook</h2><span id='topic+unhideSheet'></span><span id='topic+unhideSheet-methods'></span><span id='topic+unhideSheet+2Cworkbook+2Ccharacter-method'></span><span id='topic+unhideSheet+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Unhides the specified worksheets in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
unhideSheet(object,sheet)
## S4 method for signature 'workbook,numeric'
unhideSheet(object,sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unhideSheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="unhideSheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to unhide</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+hideSheet-methods">hideSheet</a></code>,
<code><a href="#topic+isSheetHidden-methods">isSheetHidden</a></code>, <code><a href="#topic+isSheetVeryHidden-methods">isSheetVeryHidden</a></code>,
<code><a href="#topic+isSheetVisible-methods">isSheetVisible</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("unhideWorksheet.xlsx", create = TRUE)

# Create sheet 'airquality'
createSheet(wb, name = "airquality")

# Write the built-in data set airquality to worksheet
# 'airquality'
writeWorksheet(wb, airquality, sheet = "airquality")

# Create sheet 'CO2'
createSheet(wb, name = "CO2")

# Write the built-in data set CO2 to worksheet 'C02'
writeWorksheet(wb, CO2, sheet = "CO2")

# Hide sheet 'airquality'
hideSheet(wb, sheet = "airquality")

# Unhide sheet 'airquality'
unhideSheet(wb, sheet = "airquality")

# clean up 
file.remove("unhideWorksheet.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='unmergeCells-methods'>Unmerging cells</h2><span id='topic+unmergeCells'></span><span id='topic+unmergeCells-methods'></span><span id='topic+unmergeCells+2Cworkbook+2Ccharacter-method'></span><span id='topic+unmergeCells+2Cworkbook+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Unmerges cells in a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,character'
unmergeCells(object,sheet,reference)
## S4 method for signature 'workbook,numeric'
unmergeCells(object,sheet,reference)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unmergeCells-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="unmergeCells-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet on which to unmerge cells</p>
</td></tr>
<tr><td><code id="unmergeCells-methods_+3A_reference">reference</code></td>
<td>
<p>A cell range specification (<code>character</code>) in the form 'A1:B8'. Note that the specification
must exactly correspond to the range of the merged cells.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+mergeCells-methods">mergeCells</a></code>,
<code><a href="#topic+idx2cref">idx2cref</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("unmergeCells.xlsx", create = TRUE)

# Create a worksheet called 'merge'
createSheet(wb, name = "merge")

# Merge the cells A1:B8 on the worksheet created above
mergeCells(wb, sheet = "merge", reference = "A1:B8")

# Unmerge the cells A1:B8
unmergeCells(wb, sheet = "merge", reference = "A1:B8")

# clean up 
file.remove("unmergeCells.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='with.workbook'>Evaluate an R expression in a workbook environment</h2><span id='topic+with.workbook'></span>

<h3>Description</h3>

<p>Evaluate an R expression in an environment constructed from the named regions of an 
Excel workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'workbook'
with(data, expr, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="with.workbook_+3A_data">data</code></td>
<td>
<p>A workbook object, as returned by <a href="#topic+loadWorkbook">loadWorkbook</a>.</p>
</td></tr>
<tr><td><code id="with.workbook_+3A_expr">expr</code></td>
<td>
<p>expression to evaluate</p>
</td></tr>
<tr><td><code id="with.workbook_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <a href="#topic+readNamedRegion-methods">readNamedRegion</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method will read all named regions from the workbook when
creating the environment. Names in the workbook will be processed through
<a href="base.html#topic+make.names">make.names</a> to obtain the variable names.
</p>
<p>Changes to the variables representing named regions will not affect the
workbook contents and need to be saved explicitly using
<a href="#topic+writeNamedRegion-methods">writeNamedRegion</a> and
<a href="#topic+saveWorkbook-methods">saveWorkbook</a>. If the workbook contains names that
do not map to R identifiers, </p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getDefinedNames-methods">getDefinedNames</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx",
                             package = "XLConnect")

# load workbook
wb &lt;- loadWorkbook(demoExcelFile)

# named regions: Calendar, IQ, Iris
print(getDefinedNames(wb))

# named regions as variables
with(wb, { 
  print(Calendar)
  summary(IQ)
  summary(Iris)
})

## End(Not run)
</code></pre>

<hr>
<h2 id='workbook-class'>Class &quot;workbook&quot;</h2><span id='topic+workbook-class'></span>

<h3>Description</h3>

<p>This is <span class="pkg">XLConnect</span>'s main entity representing a Microsoft Excel workbook. S4 objects of this class
and corresponding methods are used to manipulate the underlying Excel workbook instances.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code><a href="#topic+loadWorkbook">loadWorkbook</a>(filename, create)</code>. This is
a shortcut form of <code>new("workbook", filename, create)</code> with some additional error checking.
</p>


<h3>Slots</h3>


<dl>
<dt><code>filename</code>:</dt><dd><p>Object of class <code>character</code> which represents the filename of the
underlying Microsoft Excel workbook.</p>
</dd>
<dt><code>jobj</code>:</dt><dd><p>Object of class <code>jobjRef</code> (see package <span class="pkg">rJava</span>) which represents a Java object reference that is used
in the back-end to manipulate the underlying Excel workbook instance.</p>
</dd>
</dl>

<p>Note: The <code>jobj</code> slot should not be accessed directly. <code>workbook</code> objects should only be manipulated
via the corresponding methods.
</p>


<h3>Note</h3>

<p><span class="pkg">XLConnect</span> supports both Excel 97-2003 (*.xls) and OOXML (Excel 2007+, *.xlsx) file formats.<br /><br />
</p>
<p>A <code>workbook</code>'s underlying Excel file is not saved (or being created in case the file did not exist and <code>create = TRUE</code> has been
specified) unless the <code><a href="#topic+saveWorkbook-methods">saveWorkbook</a></code> method has been called on the object. This provides more flexibility to the user to decide
when changes are saved and also provides better performance in that several changes can be written in one go (normally at the end, rather than 
after every operation causing the file to be rewritten again completely each time). This is due to the fact that workbooks are manipulated in-memory and
are only written to disk with specifically calling <code><a href="#topic+saveWorkbook-methods">saveWorkbook</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>Wikipedia: Office Open XML<br />
<a href="https://en.wikipedia.org/wiki/Office_Open_XML">https://en.wikipedia.org/wiki/Office_Open_XML</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loadWorkbook">loadWorkbook</a></code>, <code><a href="#topic+saveWorkbook-methods">saveWorkbook</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create a new workbook 'myWorkbook.xlsx' 
# (assuming the file to not exist already)
wb &lt;- loadWorkbook("myWorkbook.xlsx", create = TRUE)

# Create a worksheet called 'mtcars'
createSheet(wb, name = "mtcars")

# Write built-in dataset 'mtcars' to sheet 'mtcars' created above
writeWorksheet(wb, mtcars, sheet = "mtcars")

# Save workbook - this actually writes the file 'myWorkbook.xlsx' to disk
saveWorkbook(wb)

# clean up 
file.remove("myWorkbook.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='wrapList'>
Wrapping of arguments in a list
</h2><span id='topic+wrapList'></span>

<h3>Description</h3>

<p>Wraps the specified argument in a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrapList(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrapList_+3A_x">x</code></td>
<td>

<p>Any object.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wraps an argument in a list if it not already is a list.
Further extracts the 'jobj' slot from S4 classes (such as <code><a href="#topic+workbook-class">workbook</a></code> 
and <code><a href="#topic+cellstyle-class">cellstyle</a></code>).
</p>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code> which wraps the provided argument if it not already was a <code><a href="base.html#topic+list">list</a></code>.
If the provided argument is a S4 class with a 'jobj' slot, the corresponding slot is extracted and
wrapped in a list.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcCall">xlcCall</a></code>
</p>

<hr>
<h2 id='writeNamedRegion-methods'>Writing named regions to a workbook</h2><span id='topic+writeNamedRegion'></span><span id='topic+writeNamedRegion-methods'></span><span id='topic+writeNamedRegion+2Cworkbook-method'></span><span id='topic+writeNamedRegion+2Cworkbook+2CANY-method'></span>

<h3>Description</h3>

<p>Writes data to the named regions defined in a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,ANY'
writeNamedRegion(object, data, name, header, 
  overwriteFormulaCells, rownames, worksheetScope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeNamedRegion-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to use</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_data">data</code></td>
<td>
<p>Data to write</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_name">name</code></td>
<td>
<p>Name of the named region to write to</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_header">header</code></td>
<td>
<p>Specifies if the column names should be written. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_overwriteformulacells">overwriteFormulaCells</code></td>
<td>
<p>Specifies if existing formula cells in the <code><a href="#topic+workbook-class">workbook</a></code>
should be overwritten. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_rownames">rownames</code></td>
<td>
<p>Name (<code>character</code>) of column to use for the row names of the provided
<code>data</code> object. If specified, the row names of the data object (<code>data.frame</code>) will be
included as an additional column with the specified name. If <code>rownames = NULL</code> (default),
no row names will be included. May also be a <code>list</code> in case multiple data objects are
written in one call (see below).</p>
</td></tr>
<tr><td><code id="writeNamedRegion-methods_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional character vector with worksheet name(s) to limit the scope in 
which the <code>name</code>(s) to write to is/are expected to be found</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>Writes <code>data</code> to the named region specified by <code>name</code>. Note
that <code>data</code> is assumed to be a <code>data.frame</code> and is coerced to
one if this is not already the case. The argument <code>header</code>
specifies if the column names should be written. Note also that the
arguments are vectorized and as such multiple named regions can be
written with one call. In this case <code>data</code> is assumed to be a list
of data objects (<code>data.frame</code>'s).
</p>


<h3>Note</h3>

<p>Named regions are automatically redefined to the area occupied by the
written cells. This guarantees that the complete set of data can be
re-read using
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>. Also, this
allows the named region just to be defined as the top left cell to be
written to. There is no need to know the exact size of the data in advance.<br /><br />
When writing data to Excel, <code>writeNamedRegion</code> further applies cell
styles to the cells as defined by the <code><a href="#topic+workbook-class">workbook</a></code>'s
&quot;style action&quot; (see
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>). 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>References</h3>

<p>What are named regions/ranges?<br />
<a href="https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm">https://web.archive.org/web/20240821110221/https://www.officearticles.com/excel/named_ranges_in_microsoft_excel.htm</a><br />
How to create named regions/ranges?<br />
<a href="https://www.youtube.com/watch?v=iAE9a0uRtpM">https://www.youtube.com/watch?v=iAE9a0uRtpM</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+appendNamedRegion-methods">appendNamedRegion</a></code>,
<code><a href="#topic+appendWorksheet-methods">appendWorksheet</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("writeNamedRegion.xlsx", create = TRUE)

# Create a worksheet named 'mtcars'
createSheet(wb, name = "mtcars")

# Create a named region called 'mtcars' on the sheet called 'mtcars'
createName(wb, name = "mtcars", formula = "mtcars!$A$1")

# Write built-in data set 'mtcars' to the above defined named region
# (using header = TRUE)
writeNamedRegion(wb, mtcars, name = "mtcars")

createSheet(wb, name="iris")
setActiveSheet(wb, "iris")

# Do the same with the iris data set, with a worksheet-scoped name
createName(wb, name = "iris", formula = "iris!$A$1", worksheetScope = "iris")
writeNamedRegion(wb, iris, name = "iris", worksheetScope="iris")

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("writeNamedRegion.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='writeNamedRegionToFile'>Writing named regions to an Excel file (wrapper function)</h2><span id='topic+writeNamedRegionToFile'></span>

<h3>Description</h3>

<p>Writes named regions to an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeNamedRegionToFile(file, data, name, formula=NA, ..., worksheetScope = NULL,
styleAction = XLC$STYLE_ACTION.XLCONNECT, clearNamedRegions=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeNamedRegionToFile_+3A_file">file</code></td>
<td>
<p>The path name of the file to write to</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_data">data</code></td>
<td>
<p>Data to write</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_name">name</code></td>
<td>
<p>Name of the named region to write to</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_formula">formula</code></td>
<td>
<p>If formula is specified, each item defines the formula of
the named region identified by the corresponding entry of
<code>name</code>. Use this if you want to create the document from scratch
instead of writing to a template!</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_worksheetscope">worksheetScope</code></td>
<td>
<p>Optional character vector with worksheet name(s) to limit the scope in 
which the <code>name</code>(s) to write to is/are expected to be found. If not specified, the first
matching named region is written to. Use <code>""</code> to specifically target a globally-scoped named region.
</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code></p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_styleaction">styleAction</code></td>
<td>
<p>Style action to be used when writing the data.<br />
The default is <code>XLC$STYLE_ACTION.XLCONNECT</code>. 
See <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code> for more information.</p>
</td></tr>
<tr><td><code id="writeNamedRegionToFile_+3A_clearnamedregions">clearNamedRegions</code></td>
<td>
<p>TRUE to clear content of existing named regions before writing data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>,
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>,<br />
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx", 
                             package = "XLConnect")

template &lt;- "template-ws.xlsx"
file.copy(demoExcelFile, template) 

# Write single data.frame to a named region in an existing file
writeNamedRegionToFile(template, name = "Iris", iris)

# Write to a new file, defining the sheet and named region as we write.
# Format according to XLConnect defaults
writeNamedRegionToFile("iris.xlsx", name = "Iris", data = iris,
                       formula = "IrisData!$C$4", 
                       styleAction = "XLCONNECT")
# clean up
file.remove("iris.xlsx")
file.remove("template-ws.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='writeWorksheet-methods'>Writing data to worksheets</h2><span id='topic+writeWorksheet'></span><span id='topic+writeWorksheet-methods'></span><span id='topic+writeWorksheet+2Cworkbook+2CANY+2Ccharacter-method'></span><span id='topic+writeWorksheet+2Cworkbook+2CANY+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Writes data to worksheets of a <code><a href="#topic+workbook-class">workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'workbook,ANY,character'
writeWorksheet(object,data,sheet,startRow,startCol,header,overwriteFormulaCells,rownames)
## S4 method for signature 'workbook,ANY,numeric'
writeWorksheet(object,data,sheet,startRow,startCol,header,overwriteFormulaCells,rownames)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeWorksheet-methods_+3A_object">object</code></td>
<td>
<p>The <code><a href="#topic+workbook-class">workbook</a></code> to write to</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_data">data</code></td>
<td>
<p>Data to write</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to write to</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_startrow">startRow</code></td>
<td>
<p>Index of the first row to write to. The default is <code>startRow = 1</code>.</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_startcol">startCol</code></td>
<td>
<p>Index of the first column to write to. The default is <code>startCol = 1</code>.</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_header">header</code></td>
<td>
<p>Specifies if the column names should be written. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_overwriteformulacells">overwriteFormulaCells</code></td>
<td>
<p>Specifies if existing formula cells in the <code><a href="#topic+workbook-class">workbook</a></code>
should be overwritten. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="writeWorksheet-methods_+3A_rownames">rownames</code></td>
<td>
<p>Name (<code>character</code>) of column to use for the row names of the provided
<code>data</code> object. If specified, the row names of the data object (<code>data.frame</code>) will be
included as an additional column with the specified name. If <code>rownames = NULL</code> (default),
no row names will be included. May also be a <code>list</code> in case multiple data objects are
written in one call (see below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writes <code>data</code> to the worksheet specified by
<code>sheet</code>. <code>data</code> is assumed to be a  <code>data.frame</code> and is
coerced to one if this is not already the case. <code>startRow</code> and
<code>startCol</code> define the top left corner of the data region to be
written.  Note that the arguments are vectorized and as such multiple
data objects (<code>data.frame</code>'s) can be written to different
worksheets in one call. In this case <code>data</code> is assumed to be a <code>list</code>
of <code>data.frame</code>s. 
</p>


<h3>Note</h3>

<p>When writing data to Excel, <code>writeWorksheet</code> further applies cell
styles to the cells as defined by the <code><a href="#topic+workbook-class">workbook</a></code>'s
&quot;style action&quot; (see
<code><a href="#topic+setStyleAction-methods">setStyleAction</a></code>). 
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+workbook-class">workbook</a></code>,
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>,
<code><a href="#topic+appendWorksheet-methods">appendWorksheet</a></code>,
<code><a href="#topic+appendNamedRegion-methods">appendNamedRegion</a></code>,
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>,
<code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>,
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load workbook (create if not existing)
wb &lt;- loadWorkbook("writeWorksheet.xlsx", create = TRUE)

# Create a worksheet called 'CO2'
createSheet(wb, name = "CO2")

# Write built-in data set 'CO2' to the worksheet created above;
# offset from the top left corner and with default header = TRUE
writeWorksheet(wb, CO2, sheet = "CO2", startRow = 4, startCol = 2)

# Save workbook (this actually writes the file to disk)
saveWorkbook(wb)

# clean up 
file.remove("writeWorksheet.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='writeWorksheetToFile'>Writing data to worksheets in an Excel file (wrapper function)</h2><span id='topic+writeWorksheetToFile'></span>

<h3>Description</h3>

<p>Writes data to worksheets in an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeWorksheetToFile(file, data, sheet, ..., styleAction = XLC$STYLE_ACTION.XLCONNECT, 
clearSheets = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeWorksheetToFile_+3A_file">file</code></td>
<td>
<p>The path name of the file to write to.</p>
</td></tr>
<tr><td><code id="writeWorksheetToFile_+3A_data">data</code></td>
<td>
<p>Data to write</p>
</td></tr>
<tr><td><code id="writeWorksheetToFile_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to write to</p>
</td></tr>
<tr><td><code id="writeWorksheetToFile_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <a href="#topic+writeWorksheet-methods">writeWorksheet</a></p>
</td></tr>
<tr><td><code id="writeWorksheetToFile_+3A_styleaction">styleAction</code></td>
<td>
<p>Style action to be used when writing the data - not vectorized! 
The default is <code>XLC$STYLE_ACTION.XLCONNECT</code>. 
See <code><a href="#topic+setStyleAction-methods">setStyleAction</a></code> for more information.</p>
</td></tr>
<tr><td><code id="writeWorksheetToFile_+3A_clearsheets">clearSheets</code></td>
<td>
<p>TRUE to clear sheets before writing data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Themel<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>,
<code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>,
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>,<br />
<code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# multiregion xlsx file from demoFiles subfolder of package XLConnect
demoExcelFile &lt;- system.file("demoFiles/multiregion.xlsx",
                             package = "XLConnect")

# create a copy of the template
template &lt;- "template-ws.xlsx"
file.copy(demoExcelFile, template) 

# Write single data.frame to a specified location in an existing file
writeWorksheetToFile(template, data=iris, sheet="FirstSheet",
                     startRow=9, startCol = 9)

# create a copy of the template
template &lt;- "template-multi-ws.xlsx"

# Write a few copies of the data.frame all over a new file
writeWorksheetToFile(template, data = list(i1 = iris, i2 = iris, i3 = iris),
                     sheet = c("FirstSheet", "SecondSheet", "FirstSheet"),
                     startRow = c(1,101,201), startCol = c(1,11,21))

# clean up
file.remove("template-multi-ws.xlsx")
file.remove("template-ws.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='XLC'>
XLConnect Constants
</h2><span id='topic+XLC'></span>

<h3>Description</h3>

<p>List structure defining several constants used across <span class="pkg">XLConnect</span>.
</p>


<h3>Format</h3>

<p>The format is:
</p>
<pre>
List of 90
 $ ERROR.WARN					: chr "WARN"
 $ ERROR.STOP					: chr "STOP"
 $ DATA_TYPE.BOOLEAN            : chr "BOOLEAN"
 $ DATA_TYPE.NUMERIC            : chr "NUMERIC"
 $ DATA_TYPE.STRING             : chr "STRING"
 $ DATA_TYPE.DATETIME           : chr "DATETIME"
 $ STYLE_ACTION.XLCONNECT       : chr "XLCONNECT"
 $ STYLE_ACTION.NONE            : chr "NONE"
 $ STYLE_ACTION.PREDEFINED      : chr "PREDEFINED"
 $ STYLE_ACTION.NAME_PREFIX     : chr "STYLE_NAME_PREFIX"
 $ STYLE_ACTION.DATA_FORMAT_ONLY: chr "DATA_FORMAT_ONLY"
 $ BORDER.DASHED                : num 3
 $ BORDER.DASH_DOT              : num 9
 $ BORDER.DASH_DOT_DOT          : num 11
 $ BORDER.DOTTED                : num 7
 $ BORDER.DOUBLE                : num 6
 $ BORDER.HAIR                  : num 4
 $ BORDER.MEDIUM                : num 2
 $ BORDER.MEDIUM_DASHED         : num 8
 $ BORDER.MEDIUM_DASH_DOT       : num 10
 $ BORDER.MEDIUM_DASH_DOT_DOT   : num 12
 $ BORDER.NONE                  : num 0
 $ BORDER.SLANTED_DASH_DOT      : num 13
 $ BORDER.THICK                 : num 5
 $ BORDER.THIN                  : num 1
 $ COLOR.BLACK                  : num 8
 $ COLOR.WHITE                  : num 9
 $ COLOR.RED                    : num 10
 $ COLOR.BRIGHT_GREEN           : num 11
 $ COLOR.BLUE                   : num 12
 $ COLOR.YELLOW                 : num 13
 $ COLOR.PINK                   : num 14
 $ COLOR.TURQUOISE              : num 15
 $ COLOR.DARK_RED               : num 16
 $ COLOR.GREEN                  : num 17
 $ COLOR.DARK_BLUE              : num 18
 $ COLOR.DARK_YELLOW            : num 19
 $ COLOR.VIOLET                 : num 20
 $ COLOR.TEAL                   : num 21
 $ COLOR.GREY_25_PERCENT        : num 22
 $ COLOR.GREY_50_PERCENT        : num 23
 $ COLOR.CORNFLOWER_BLUE        : num 24
 $ COLOR.MAROON                 : num 25
 $ COLOR.LEMON_CHIFFON          : num 26
 $ COLOR.ORCHID                 : num 28
 $ COLOR.CORAL                  : num 29
 $ COLOR.ROYAL_BLUE             : num 30
 $ COLOR.LIGHT_CORNFLOWER_BLUE  : num 31
 $ COLOR.SKY_BLUE               : num 40
 $ COLOR.LIGHT_TURQUOISE        : num 41
 $ COLOR.LIGHT_GREEN            : num 42
 $ COLOR.LIGHT_YELLOW           : num 43
 $ COLOR.PALE_BLUE              : num 44
 $ COLOR.ROSE                   : num 45
 $ COLOR.LAVENDER               : num 46
 $ COLOR.TAN                    : num 47
 $ COLOR.LIGHT_BLUE             : num 48
 $ COLOR.AQUA                   : num 49
 $ COLOR.LIME                   : num 50
 $ COLOR.GOLD                   : num 51
 $ COLOR.LIGHT_ORANGE           : num 52
 $ COLOR.ORANGE                 : num 53
 $ COLOR.BLUE_GREY              : num 54
 $ COLOR.GREY_40_PERCENT        : num 55
 $ COLOR.DARK_TEAL              : num 56
 $ COLOR.SEA_GREEN              : num 57
 $ COLOR.DARK_GREEN             : num 58
 $ COLOR.OLIVE_GREEN            : num 59
 $ COLOR.BROWN                  : num 60
 $ COLOR.PLUM                   : num 61
 $ COLOR.INDIGO                 : num 62
 $ COLOR.GREY_80_PERCENT        : num 63
 $ COLOR.AUTOMATIC              : num 64
 $ FILL.NO_FILL                 : num 0
 $ FILL.SOLID_FOREGROUND        : num 1
 $ FILL.FINE_DOTS               : num 2
 $ FILL.ALT_BARS                : num 3
 $ FILL.SPARSE_DOTS             : num 4
 $ FILL.THICK_HORZ_BANDS        : num 5
 $ FILL.THICK_VERT_BANDS        : num 6
 $ FILL.THICK_BACKWARD_DIAG     : num 7
 $ FILL.THICK_FORWARD_DIAG      : num 8
 $ FILL.BIG_SPOTS               : num 9
 $ FILL.BRICKS                  : num 10
 $ FILL.THIN_HORZ_BANDS         : num 11
 $ FILL.THIN_VERT_BANDS         : num 12
 $ FILL.THIN_BACKWARD_DIAG      : num 13
 $ FILL.THIN_FORWARD_DIAG       : num 14
 $ FILL.SQUARES                 : num 15
 $ FILL.DIAMONDS                : num 16
 </pre>


<h3>Details</h3>

<p>The <code>XLC</code> list structure defines several constants used throughout <span class="pkg">XLConnect</span>. The general convention for
enumeration types is to address corresponding constants via <var>XLC$&quot;&lt;ENUM_TYPE&gt;.&lt;VALUE&gt;&quot;</var> where <var>&lt;ENUM_TYPE&gt;</var> specifies
the name of the enumeration and <var>&lt;VALUE&gt;</var> specifies a corresponding enumeration value. An example is <code>XLC$"COLOR.RED"</code> where
&quot;COLOR&quot; is the enumeration type and &quot;RED&quot; is the corresponding color enumeration value.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>

<hr>
<h2 id='xlcCall'>
Automatic argument vectorization, default Java exception and warnings handling for XLConnect
</h2><span id='topic+xlcCall'></span>

<h3>Description</h3>

<p>Performs automatic argument vectorization, provides default Java
exception and warnings handling for <span class="pkg">XLConnect</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcCall(obj, fun, ..., .recycle = TRUE, 
  .simplify = TRUE, .checkWarnings = TRUE, .withAttributes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlcCall_+3A_obj">obj</code></td>
<td>

<p><span class="pkg">XLConnect</span> S4 object (e.g <code><a href="#topic+workbook-class">workbook</a></code>, <code><a href="#topic+cellstyle-class">cellstyle</a></code>) which
has a slot <code>jobj</code> representing a <span class="pkg">rJava</span> <code>jobjRef</code> object whose method represented
by the argument <code>fun</code> should be called.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_fun">fun</code></td>
<td>

<p>Name of Java method to be called.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_...">...</code></td>
<td>

<p>Arguments to the Java method to be called.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_.recycle">.recycle</code></td>
<td>

<p>If <code>TRUE</code> (default), arguments passed through ... will be automatically vectorized using <code><a href="base.html#topic+mapply">mapply</a></code> and
<code>fun</code> will be called the appropriate amount of times.
If <code>FALSE</code>, no vectorization will take place in R and <code>fun</code> will be called once only. This may be used to implement
vectorization on the Java side.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_.simplify">.simplify</code></td>
<td>

<p>Only relevant if <code>.recycle = TRUE</code>. Argument to internal <code><a href="base.html#topic+mapply">mapply</a></code> to set if there should be an attempt to 
reduce the result to a vector or matrix.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_.checkwarnings">.checkWarnings</code></td>
<td>

<p>Whether to check for warnings registered on the underlying Java object.
</p>
</td></tr>
<tr><td><code id="xlcCall_+3A_.withattributes">.withAttributes</code></td>
<td>

<p>Whether the function being called returns a wrapped Java object with attributes. 
If <code>TRUE</code>:
</p>

<ul>
<li><p> the object will be unwrapped
</p>
</li>
<li><p> if option <code>XLConnect.setCustomAttributes</code> is <code>TRUE</code>, the attributes will be processed and set on the resulting R object.
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>This function makes use of <code><a href="base.html#topic+mapply">mapply</a></code> to perform automatic argument vectorization. Non-atomic arguments are
wrapped in a list using <code><a href="#topic+wrapList">wrapList</a></code> first. The list of the resulting arguments is then being vectorized
using <code><a href="base.html#topic+mapply">mapply</a></code> before the specified function is being called. The function call is wrapped with
<code><a href="#topic+jTryCatch">jTryCatch</a></code> to catch Java exceptions. Further, any warnings are retrieved from the Java side and are logged
via R's standard warning mechanism.
</p>


<h3>Value</h3>

<p>Result of the specified function by calling it with the vectorized argument list.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wrapList">wrapList</a></code>, <code><a href="#topic+jTryCatch">jTryCatch</a></code>
</p>

<hr>
<h2 id='xlcDump'>
Dumping data sets to Excel files
</h2><span id='topic+xlcDump'></span>

<h3>Description</h3>

<p>Dumps data sets to Excel files by writing each object to a separate worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcDump(list, ..., file = "dump.xlsx", pos = -1, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlcDump_+3A_list">list</code></td>
<td>

<p><code>character</code> vector of names of objects inside environment <code>pos</code> to dump into an Excel file. Objects
will be written using <code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code> - as such any object will be coerced
to a <code>data.frame</code>. If <code>missing</code>, the list of objects will be determined via the function <code>ls</code> which
takes any arguments specified via ....
</p>
</td></tr>
<tr><td><code id="xlcDump_+3A_...">...</code></td>
<td>

<p>Arguments that will be passed to the <code>ls</code> function for getting a list of object names in case the <code>list</code>
argument is <code>missing</code>.
</p>
</td></tr>
<tr><td><code id="xlcDump_+3A_file">file</code></td>
<td>

<p>Excel file to which objects will be dumped. Can be an existing or a new file. Defaults to <code>"dump.xlsx"</code>.
</p>
</td></tr>
<tr><td><code id="xlcDump_+3A_pos">pos</code></td>
<td>

<p>Environment in which to look for objects. Can be specified either as an <code>integer</code>
specifying the position in the <code>search</code> list, as a <code>character</code> naming an element in the <code>search</code>
list or as an <code>environment</code>. Defaults to <code>-1</code> which refers to the current environment.
</p>
</td></tr>
<tr><td><code id="xlcDump_+3A_overwrite">overwrite</code></td>
<td>

<p><code>logical</code> specifying if data should be overwritten if objects with the same name have already been dumped
to the Excel <code>file</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each object is written to a separate worksheet named by the name of the object. Objects are written using the
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code> method - as such any object will be coerced to <code>data.frame</code>. 
</p>


<h3>Value</h3>

<p>Named <code>logical</code> vector specifying if objects have been dumped or not. An object may not be dumped because there
was an issue with the coercion to a <code>data.frame</code> or the object already existed (and <code>overwrite = FALSE</code>) in
the workbook.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcRestore">xlcRestore</a></code>, <code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>, 
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>, <code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>,
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>, <code><a href="#topic+xlcEdit">xlcEdit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(datasets)
xlcDump(c("airquality", "CO2", "iris", "PlantGrowth", "swiss"),
        file = "myDump.xlsx", pos = "package:datasets")
xlcRestore(file = "myDump.xlsx", overwrite = TRUE)
# clean up
file.remove("myDump.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='xlcEdit'>
Editing data sets in an Excel file editor
</h2><span id='topic+xlcEdit'></span>

<h3>Description</h3>

<p>Provides the capability to edit an object/data.frame in an Excel file
editor. After editing, the object is restored in the R session with the
corresponding changes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcEdit(obj, pos = globalenv(), ext = ".xlsx")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlcEdit_+3A_obj">obj</code></td>
<td>

<p>Object (<code>data.frame</code>) to edit.
</p>
</td></tr>
<tr><td><code id="xlcEdit_+3A_pos">pos</code></td>
<td>

<p>Where to look for the object specified by <code>obj</code>.
See <code>pos</code> argument of <code><a href="base.html#topic+get">get</a></code> for more
information.
</p>
</td></tr>
<tr><td><code id="xlcEdit_+3A_ext">ext</code></td>
<td>

<p>Extension to use for the Excel file being created. Defaults
to &quot;.xlsx&quot;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="#topic+xlcDump">xlcDump</a></code> and <code><a href="#topic+xlcRestore">xlcRestore</a></code> to
dump objects to and restore objects from Excel files. An OS command is invoked
to open the temporary Excel file in the default editor. Changes to the file have 
to be saved in order for them to take effect in the restored object.
</p>


<h3>Value</h3>

<p>Invisibly returns the value of the <code><a href="#topic+xlcRestore">xlcRestore</a></code> operation.
</p>


<h3>Note</h3>

<p>This function only works under Windows and MacOS with a corresponding Excel
file editor, e.g. MS Excel or LibreOffice. Attempts to use this function under
another OS will result in an error being thrown.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcDump">xlcDump</a></code>, <code><a href="#topic+xlcRestore">xlcRestore</a></code>, 
<code><a href="#topic+writeNamedRegion-methods">writeNamedRegion</a></code>, 
<code><a href="#topic+writeWorksheet-methods">writeWorksheet</a></code>, <code><a href="#topic+writeNamedRegionToFile">writeNamedRegionToFile</a></code>,
<code><a href="#topic+writeWorksheetToFile">writeWorksheetToFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
myObj = mtcars
xlcEdit(myObj)

## End(Not run)
</code></pre>

<hr>
<h2 id='xlcFreeMemory'>
Freeing Java Virtual Machine memory
</h2><span id='topic+xlcFreeMemory'></span>

<h3>Description</h3>

<p>Frees Java Virtual Machine (JVM) memory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcFreeMemory(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlcFreeMemory_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to R's garbage collector (<code><a href="base.html#topic+gc">gc</a></code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses Java's Runtime class to run the garbage collector.<br />
Java memory is freed by first running R's garbage collector (<code><a href="base.html#topic+gc">gc</a></code>) and then
Java's garbage collector. This sequence is important as R's <code><a href="base.html#topic+gc">gc</a></code> may release 
objects which in turn allows Java's garbage collector to release some objects.<br /><br />
Note, in general there should be no need to make active use of this with <span class="pkg">XLConnect</span>. Both
R and Java automatically perform garbage collection at times. However, this function might be useful
to reclaim memory after removing a large data object that has been written/read to/from Excel.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcMemoryReport">xlcMemoryReport</a></code>, <code><a href="base.html#topic+gc">gc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
xlcFreeMemory()

## End(Not run)
</code></pre>

<hr>
<h2 id='xlcMemoryReport'>
Reporting free Java Virtual Machine memory
</h2><span id='topic+xlcMemoryReport'></span>

<h3>Description</h3>

<p>Reports the amount of free memory in the Java Virtual Machine (JVM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcMemoryReport()
</code></pre>


<h3>Details</h3>

<p>This function uses Java's Runtime class to query the free JVM memory.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcFreeMemory">xlcFreeMemory</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
xlcMemoryReport()

## End(Not run)
</code></pre>

<hr>
<h2 id='XLConnect-deprecated'>Deprecated functions in package <span class="pkg">XLConnect</span></h2><span id='topic+XLConnect-deprecated'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older versions of
<span class="pkg">XLConnect</span> only, and will be defunct in a later release.
</p>


<h3>Details</h3>

<p>The following functions are deprecated and will be made defunct. Use the replacements as indicated.
</p>

<ul>
<li> <p><code>getReferenceCoordinates</code>: <code><a href="#topic+getReferenceCoordinatesForName-methods">getReferenceCoordinatesForName</a></code>
</p>
</li></ul>


<hr>
<h2 id='XLConnectSettings'>
Performing general settings for XLConnect
</h2><span id='topic+XLConnectSettings'></span>

<h3>Description</h3>

<p>Performs general settings as used by <span class="pkg">XLConnect</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XLConnectSettings(pdesc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="XLConnectSettings_+3A_pdesc">pdesc</code></td>
<td>

<p>An object of class packageDescription for the <span class="pkg">XLConnect</span> package.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by <span class="pkg">XLConnect</span>'s <code>.onLoad</code> function to perform general settings
used by <span class="pkg">XLConnect</span>.
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>

<hr>
<h2 id='xlcRestore'>
Restoring objects from Excel files
</h2><span id='topic+xlcRestore'></span>

<h3>Description</h3>

<p>Restores objects from Excel files that have been dumped using <code><a href="#topic+xlcDump">xlcDump</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlcRestore(file = "dump.xlsx", pos = -1, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlcRestore_+3A_file">file</code></td>
<td>

<p>Excel file from which to restore objects. This is normally a file that has been produced with
<code><a href="#topic+xlcDump">xlcDump</a></code>. Defaults to <code>"dump.xlsx"</code>.
</p>
</td></tr>
<tr><td><code id="xlcRestore_+3A_pos">pos</code></td>
<td>

<p>Environment into which to restore objects. Can be specified either as an <code>integer</code>
specifying the position in the <code>search</code> list, as a <code>character</code> naming an element in the <code>search</code>
list or as an <code>environment</code>. Defaults to <code>-1</code> which refers to the current environment.
</p>
</td></tr>
<tr><td><code id="xlcRestore_+3A_overwrite">overwrite</code></td>
<td>

<p><code>logical</code> specifying if data objects should be overwritten if they already exist inside the
environment <code>pos</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named <code>logical</code> vector specifying if objects have been restored or not. An object may not be restored because there
was an issue with reading the data from the worksheet or the object already existed in the environment <code>pos</code>
(and <code>overwrite = FALSE</code>).
</p>


<h3>Author(s)</h3>

<p>Martin Studer<br />
Mirai Solutions GmbH <a href="https://mirai-solutions.ch">https://mirai-solutions.ch</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlcDump">xlcDump</a></code>, <code><a href="#topic+readNamedRegion-methods">readNamedRegion</a></code>, 
<code><a href="#topic+readWorksheet-methods">readWorksheet</a></code>, <code><a href="#topic+readNamedRegionFromFile">readNamedRegionFromFile</a></code>,<br />
<code><a href="#topic+readWorksheetFromFile">readWorksheetFromFile</a></code>, <code><a href="#topic+xlcEdit">xlcEdit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(datasets)
xlcDump(c("airquality", "CO2", "iris", "PlantGrowth", "swiss"),
        file = "myDump.xlsx", pos = "package:datasets")
xlcRestore(file = "myDump.xlsx", overwrite = TRUE)
# clean up
file.remove("myDump.xlsx")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
