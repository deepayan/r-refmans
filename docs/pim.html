<!DOCTYPE html><html><head><title>Help for package pim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pim-package'><p>Probabilistic Index Models</p></a></li>
<li><a href='#.make.posfun'><p>Create a poset function</p></a></li>
<li><a href='#add.poset'><p>Add a poset to a pim.environment object</p></a></li>
<li><a href='#as.data.frame'><p>Convert a pim.environment to a data frame</p></a></li>
<li><a href='#as.matrix.pim.summary'><p>Convert a pim.summary object to a matrix</p></a></li>
<li><a href='#classes'><p>Extract information from pim.environment and pim.poset objects</p></a></li>
<li><a href='#coef'><p>Extract the coefficients from a pim or pim.summary object</p></a></li>
<li><a href='#confint.pim'><p>Calculate Wald confidence intervals around the coefficients of a PIM</p></a></li>
<li><a href='#create.poset'><p>Create a poset</p></a></li>
<li><a href='#CreateScoreFun'><p>Create a score function for use in a pim.</p></a></li>
<li><a href='#DysData'><p>This is the Dysphagia data</p></a></li>
<li><a href='#EngelData'><p>This is the engel data</p></a></li>
<li><a href='#estimators'><p>Estimator functions for probabilistic index models</p></a></li>
<li><a href='#Extract.pim.summary'><p>Extract method for pim.summary objects</p></a></li>
<li><a href='#FEVData'><p>This is the Childhood respiratory disease data</p></a></li>
<li><a href='#formula'><p>Extract the formula from a pim or pim.formula object</p></a></li>
<li><a href='#has.intercept'><p>Check whether formula has an explicit intercept</p></a></li>
<li><a href='#has.specials'><p>Extract information from a pim.formula object</p></a></li>
<li><a href='#is.complete'><p>Check whether a pim environment is complete</p></a></li>
<li><a href='#L'><p>Specify the left hand and right hand side of an expression used in pims</p></a></li>
<li><a href='#MHData'><p>This is the Mental health data</p></a></li>
<li><a href='#model.matrix.pim'><p>Create a model matrix for a probabilistic index model</p></a></li>
<li><a href='#new.pim'><p>Create an object of class pim</p></a></li>
<li><a href='#new.pim.env'><p>Constructor for a pim.environment</p></a></li>
<li><a href='#new.pim.formula'><p>Constructor for pim.formula</p></a></li>
<li><a href='#new.pim.poset'><p>Create a pim.poset environment</p></a></li>
<li><a href='#nobs+2Cpim.environment-method'><p>Extract the number of observations</p></a></li>
<li><a href='#P'><p>Probability function</p></a></li>
<li><a href='#penv'><p>Extract a pim environment from a model or formula</p></a></li>
<li><a href='#pim'><p>Fitting a Probabilistic Index Model</p></a></li>
<li><a href='#pim-class'><p>Class pim</p></a></li>
<li><a href='#pim-getters'><p>Getters for slots of a pim object</p></a></li>
<li><a href='#pim.environment-class'><p>The pim.environment class</p></a></li>
<li><a href='#pim.fit'><p>Fitter function for a probabilistic index model</p></a></li>
<li><a href='#pim.formula-class'><p>Class pim.formula</p></a></li>
<li><a href='#pim.poset-class'><p>The pim.poset class</p></a></li>
<li><a href='#pim.summary-class'><p>Class pim.summary</p></a></li>
<li><a href='#pimdata'><p>The data contained in the pim package</p></a></li>
<li><a href='#poset'><p>Extract the poset as a matrix or list</p></a></li>
<li><a href='#print'><p>Print methods for the different object types</p></a></li>
<li><a href='#response'><p>Extract response from a pim.formula or a pim object</p></a></li>
<li><a href='#sandwich.estimator'><p>Pseudo-observation variance sandwich estimator</p></a></li>
<li><a href='#SUData'><p>This is the Surgical unit data</p></a></li>
<li><a href='#summary.pim'><p>The summary function for the pim class</p></a></li>
<li><a href='#vcov'><p>Methods for vcov</p></a></li>
<li><a href='#vcov.estimators'><p>vcov estimators for pim</p></a></li>
<li><a href='#vcov.internal'><p>Internal functions for vcov estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit Probabilistic Index Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Joris Meys [aut, cre],
  Jan De Neve [aut],
  Nick Sabbe [aut],
  Gustavo Guimaraes de Castro Amorim [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joris Meys &lt;Joris.Meys@UGent.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit a probabilistic index model as described in 
    Thas et al, 2012: &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2011.01020.x">doi:10.1111/j.1467-9868.2011.01020.x</a>&gt;. The interface to the 
    modeling function has changed in this new version. The old version is
    still available at R-Forge.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, utils, stats4, nleqslv, BB</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/CenterForStatistics-UGent/pim">https://github.com/CenterForStatistics-UGent/pim</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CenterForStatistics-UGent/pim/issues">https://github.com/CenterForStatistics-UGent/pim/issues</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>'CreateScoreFun.R' 'DysData.R' 'EngelData.R' 'Estimators.R'
'pim.poset-class.R' 'pim.environment-class.R' 'pim-package.R'
'pim.formula-class.R' 'pim-class.R' 'pim.summary-class.R'
'Extract.pim.summary.R' 'FEVData.R' 'Getters.R' 'Getters_pim.R'
'Getters_pim.formula.R' 'InternalFunctions.R'
'InternalObjects.R' 'LR.R' 'MHData.R' 'P.R' 'SUData.R'
'add.poset.R' 'as.data.frame.pim.environment.R'
'as.matrix.pim.summary.R' 'coef.R' 'confint.pim.R'
'create.poset.R' 'formula.R' 'has.intercept.R' 'is.complete.R'
'make.posfun.R' 'model.matrix.pim.R' 'new.pim.R'
'new.pim.env.R' 'new.pim.formula.R' 'new.pim.poset.R' 'nobs.R'
'penv.R' 'pim.R' 'pim.fit.R' 'pimdata.R' 'poset.R' 'print.R'
'response.R' 'sandwich.estimator.R' 'summary.R' 'vcov.R'
'vcov.estimators.R' 'vcov.internal.R' 'zzz.R'</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, MASS</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-03 17:18:09 UTC; Joris</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-03 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pim-package'>Probabilistic Index Models</h2><span id='topic+pim-package'></span>

<h3>Description</h3>

<p>Fit a probabilistic index model. Note that this
version is NOT compatible with the previous version used in the original
publications on probabilistic index models. If you want to try out the
original code, please install the package pimold from R-Forge.
You can install the old package using:
</p>


<h3>Details</h3>

<p><code>install.packages('pimold', repos = 'http://R-Forge.R-project.org')</code>
</p>


<h3>Author(s)</h3>

<p>Joris Meys <a href="mailto:Joris.Meys@UGent.be">Joris.Meys@UGent.be</a> Jan De Neve <a href="mailto:Jan.DeNeve@UGent.be">Jan.DeNeve@UGent.be</a> original package and engine code by Nick Sabbe.
</p>


<h3>References</h3>

<p><a href="http://r-forge.r-project.org/projects/pim/">http://r-forge.r-project.org/projects/pim/</a>
</p>

<hr>
<h2 id='.make.posfun'>Create a poset function</h2><span id='topic+.make.posfun'></span>

<h3>Description</h3>

<p>This function creates a poset function from a poset. The function is not
exported and shouldn't be called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.make.posfun(poset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".make.posfun_+3A_poset">poset</code></td>
<td>
<p>a vector with the columns as indices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that takes a single vector as argument, and that
returns the vector with the poset vector applied to it.
</p>

<hr>
<h2 id='add.poset'>Add a poset to a pim.environment object</h2><span id='topic+add.poset'></span><span id='topic+add.poset+2Cpim.environment-method'></span>

<h3>Description</h3>

<p>This function adds a poset to a <code><a href="#topic+pim.environment">pim.environment</a></code>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.poset(x, ...)

## S4 method for signature 'pim.environment'
add.poset(x, overwrite = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add.poset_+3A_x">x</code></td>
<td>
<p>a pim.environment object</p>
</td></tr>
<tr><td><code id="add.poset_+3A_...">...</code></td>
<td>
<p>further parameters passed to <code><a href="#topic+new.pim.poset">new.pim.poset</a></code>.</p>
</td></tr>
<tr><td><code id="add.poset_+3A_overwrite">overwrite</code></td>
<td>
<p>a logical value indicating whether the poset
should be overwritten if it's already present. Defaults to 
<code>FALSE</code> to avoid problems.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The object with a (new) poset attached.
</p>


<h3>Warning</h3>

<p>Although it might be tempting to pass the argument
<code>nobs</code> to <code><a href="#topic+new.pim.poset">new.pim.poset</a></code>, you shouldn't. 
The necessary information is taken from the respective slot 
in the <code>pim.environment</code> object.
</p>
<p>If you provide a matrix or a list as value for the argument <code>compare</code>,
note that you can easily create a poset that doesn't use all the 
observations. This might or might not be your intention. If the poset
you try to create contains indices that go beyond the number of
observations, you will get errors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new.pim.poset">new.pim.poset</a></code> for the possible values of the
arguments <code>compare</code> and <code>nobs</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(DysData)
Dysenv &lt;- new.pim.env(DysData)
Dysenv
DysenvAll &lt;- add.poset(Dysenv, overwrite = TRUE, 
                       compare = 'all', nobs = nobs(DysData))
compare(Dysenv)
compare(DysenvAll)                       


</code></pre>

<hr>
<h2 id='as.data.frame'>Convert a pim.environment to a data frame</h2><span id='topic+as.data.frame'></span><span id='topic+as.data.frame+2Cpim.environment-method'></span>

<h3>Description</h3>

<p>This function extracts all data from a <code><a href="#topic+pim.environment">pim.environment</a></code>
and returns it as a data frame. Note that this is the original data
frame, not the one with pseudo observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.data.frame(x, row.names = NULL, optional = FALSE, ...)

## S4 method for signature 'pim.environment'
as.data.frame(x, row.names = NULL, optional = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>a <code>pim.environment</code> object</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_row.names">row.names</code></td>
<td>
<p>NULL or a character vector giving the row names for
the data frame. Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_optional">optional</code></td>
<td>
<p>logical. if TRUE, setting row names and converting
column names (to syntactic names: see <code><a href="base.html#topic+make.names">make.names</a></code>)
is optional</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods,
including <code>stringsAsFactors</code>. For more information, see the
function <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> from the base package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TO DO: Insert link to how to get pseudo observations out.
</p>


<h3>Value</h3>

<p>a data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a pim environment
data("DysData")
Dys &lt;- new.pim.env(DysData)
str(as.data.frame(Dys))

</code></pre>

<hr>
<h2 id='as.matrix.pim.summary'>Convert a pim.summary object to a matrix</h2><span id='topic+as.matrix.pim.summary'></span><span id='topic+as.matrix'></span><span id='topic+as.matrix+2Cpim.summary-method'></span><span id='topic+as.matrix+2Cpim-method'></span>

<h3>Description</h3>

<p>This function converts a summary object to a matrix so values can be
extracted from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.matrix(x, ...)

## S4 method for signature 'pim.summary'
as.matrix(x, ...)

## S4 method for signature 'pim'
as.matrix(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.matrix.pim.summary_+3A_x">x</code></td>
<td>
<p>a <code>pim.summary</code> object</p>
</td></tr>
<tr><td><code id="as.matrix.pim.summary_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.
This one is ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with the estimate, standard error, Z value and
probability for every coefficient.
</p>

<hr>
<h2 id='classes'>Extract information from pim.environment and pim.poset objects</h2><span id='topic+classes'></span><span id='topic+names'></span><span id='topic+compare'></span><span id='topic+model'></span><span id='topic+link'></span><span id='topic+classes+2Cpim.environment-method'></span><span id='topic+names+2Cpim.environment-method'></span><span id='topic+names+2Cpim.poset-method'></span><span id='topic+compare+2Cpim.environment-method'></span><span id='topic+compare+2Cpim.poset-method'></span><span id='topic+model+2Cpim-method'></span><span id='topic+model+2Cpim.summary-method'></span><span id='topic+link+2Cpim-method'></span><span id='topic+link+2Cpim.summary-method'></span>

<h3>Description</h3>

<p>These functions serve to extract the information contained
in the objects of class <code><a href="#topic+pim.environment">pim.environment</a></code> and 
<code><a href="#topic+pim.poset">pim.poset</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classes(x)

## S4 method for signature 'pim.environment'
classes(x)

## S4 method for signature 'pim.environment'
names(x)

## S4 method for signature 'pim.poset'
names(x)

compare(x)

## S4 method for signature 'pim.environment'
compare(x)

## S4 method for signature 'pim.poset'
compare(x)

model(object, ...)

## S4 method for signature 'pim'
model(object)

## S4 method for signature 'pim.summary'
model(object)

link(object, ...)

## S4 method for signature 'pim'
link(object)

## S4 method for signature 'pim.summary'
link(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classes_+3A_x">x</code></td>
<td>
<p>an object of class <code>pim.environment</code> or <code>pim.poset</code></p>
</td></tr>
<tr><td><code id="classes_+3A_object">object</code></td>
<td>
<p>an object of class <code>pim</code> or <code>pim.summary</code></p>
</td></tr>
<tr><td><code id="classes_+3A_...">...</code></td>
<td>
<p>arguments passed to and from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>classes()</code>: A named vector with the classes of the data 
contained in the <code>pim.environment</code>
</p>
<p><code>names()</code>: For an object of class <code>pim.environment</code> the names
of the variables in the object. For an object of class <code>pim.poset</code>,
the name of the poset functions inside the environment
</p>
<p><code>compare()</code>: A character value indicating how the comparison
is defined in a <code>pim.poset</code> object, or the poset-slot of 
a <code>pim.environment</code> object respectively.
</p>
<p><code>model()</code>: a character value that displays
the type of model (difference, marginal, regular or customized)
</p>
<p><code>link()</code>: a character value that displays
the type of link (difference, marginal, regular or customized)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nobs">nobs</a></code>, <code><a href="#topic+poset">poset</a></code>, <code><a href="#topic+is.complete">is.complete</a></code>,
<code><a href="#topic+pim.environment-class">pim.environment-class</a></code>, <code><a href="#topic+pim.poset-class">pim.poset-class</a></code>, 
<code><a href="#topic+pim-class">pim-class</a></code>, <code><a href="#topic+pim.summary-class">pim.summary-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DysData)
DysPimEnv &lt;- new.pim.env(DysData,poset=TRUE)
classes(DysPimEnv)
names(DysPimEnv)
compare(DysPimEnv)

themodel &lt;- pim(SPC_D2 ~ Chemo, data = DysData, model = 'difference')
model(themodel)
thesummary &lt;- summary(themodel)
model(thesummary)

</code></pre>

<hr>
<h2 id='coef'>Extract the coefficients from a pim or pim.summary object</h2><span id='topic+coef'></span><span id='topic+coef+2Cpim-method'></span><span id='topic+coef+2Cpim.summary-method'></span>

<h3>Description</h3>

<p>This function works like <code><a href="stats.html#topic+coef">coef</a></code> from the <code>stats</code>
package. It extracts the coefficients from the objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef(object, ...)

## S4 method for signature 'pim'
coef(object, ...)

## S4 method for signature 'pim.summary'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_+3A_object">object</code></td>
<td>
<p>a <code>pim</code> or <code>pim.summary</code> object</p>
</td></tr>
<tr><td><code id="coef_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named vector with the coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("FEVData")
Model &lt;- pim(FEV~ Age + Smoke*Sex , data=FEVData)
coef(Model)
summ &lt;- summary(Model)
coef(summ)

</code></pre>

<hr>
<h2 id='confint.pim'>Calculate Wald confidence intervals around the coefficients of a PIM</h2><span id='topic+confint.pim'></span><span id='topic+confint.pim.summary'></span><span id='topic+confint'></span><span id='topic+confint+2Cpim-method'></span><span id='topic+confint+2Cpim.summary-method'></span>

<h3>Description</h3>

<p>This function returns Wald confidence intervals around the 
coefficients of a fitted <code><a href="#topic+pim">pim</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint(object, parm, level = 0.95, ...)

## S4 method for signature 'pim'
confint(object, parm, level = 0.95, ...)

## S4 method for signature 'pim.summary'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.pim_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+pim">pim</a></code> or <code><a href="#topic+pim.summary">pim.summary</a></code> object</p>
</td></tr>
<tr><td><code id="confint.pim_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals. Either a vector of numbers or a vector of names.
If missing, all parameters are considered</p>
</td></tr>
<tr><td><code id="confint.pim_+3A_level">level</code></td>
<td>
<p>The confidence level required.</p>
</td></tr>
<tr><td><code id="confint.pim_+3A_...">...</code></td>
<td>
<p>extra arguments to methods</p>
</td></tr>
</table>

<hr>
<h2 id='create.poset'>Create a poset</h2><span id='topic+create.poset'></span>

<h3>Description</h3>

<p>This function creates a poset for use in a pim model based on a
number of observations and a comparison type. This function is
called from <code><a href="#topic+new.pim.poset">new.pim.poset</a></code> and returns a list that
can be used as a value for its argument <code>compare</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.poset(compare = c("unique", "all"), n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.poset_+3A_compare">compare</code></td>
<td>
<p>a character value, either 'unique' or 'all'</p>
</td></tr>
<tr><td><code id="create.poset_+3A_n">n</code></td>
<td>
<p>an single integer value indicating how many observations there
are in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list with 2 elements, called &quot;L&quot; and &quot;R&quot;, containing
the selection indices for the left hand and right hand side of a pim.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create.poset(n=10)
create.poset('all',n=4)
</code></pre>

<hr>
<h2 id='CreateScoreFun'>Create a score function for use in a pim.</h2><span id='topic+CreateScoreFun'></span>

<h3>Description</h3>

<p>This function creates a suitable score function for the fitting 
process of a probabilistic index model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CreateScoreFun(Z, Y, link = c("probit", "logit", "identity"), W = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CreateScoreFun_+3A_z">Z</code></td>
<td>
<p>the model matrix of pseudo-observations</p>
</td></tr>
<tr><td><code id="CreateScoreFun_+3A_y">Y</code></td>
<td>
<p>a vector with the response of the pseudo-observations</p>
</td></tr>
<tr><td><code id="CreateScoreFun_+3A_link">link</code></td>
<td>
<p>a character vector indicating the link function 
to be used.</p>
</td></tr>
<tr><td><code id="CreateScoreFun_+3A_w">W</code></td>
<td>
<p>a vector with weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function used for estimating the coefficients by
the estimator functions.
</p>


<h3>NOTE</h3>

<p>This function is not exported.
</p>

<hr>
<h2 id='DysData'>This is the Dysphagia data</h2><span id='topic+DysData'></span>

<h3>Description</h3>

<p>This is the Dysphagia data
</p>


<h3>Details</h3>

<p>These are the columns and their meanings
</p>

<ul>
<li><p><code>out</code> Outcome: a factor with values 1 to 4, indicating the outcome
</p>
</li>
<li><p><code>Chemo</code> Whether the patient underwent chemotherapy (&quot;ja&quot; is yes, &quot;nee&quot; is no)
</p>
</li>
<li><p><code>SNP_XRCC1__77</code> Genotype of this SNP. A factor with three levels: &quot;TT&quot;, &quot;TC&quot; and &quot;CC&quot;
</p>
</li>
<li><p><code>SPC_D2</code> Dose of radiation that reached 2
</p>
</li>
<li><p><code>SNP_XRCC1__77TC</code> 1 if <code>SNP_XRCC1__77</code> is &quot;TC&quot;, 0 otherwise
</p>
</li></ul>


<hr>
<h2 id='EngelData'>This is the engel data</h2><span id='topic+EngelData'></span>

<h3>Description</h3>

<p>This is the engel data
</p>


<h3>Details</h3>

<p>These are the columns and their meanings
</p>

<ul>
<li><p><code>foodexp</code> Food expenditure (FE)
</p>
</li>
<li><p><code>income</code> Household income (HI)
</p>
</li></ul>


<hr>
<h2 id='estimators'>Estimator functions for probabilistic index models</h2><span id='topic+estimators'></span><span id='topic+estimator.nleqslv'></span><span id='topic+estimator.glm'></span><span id='topic+estimator.BB'></span>

<h3>Description</h3>

<p>This page documents different possibilities for solving the score function
of a probabilistic index model or <code><a href="#topic+pim">pim</a></code>. All functions mentioned on this page, are essentially wrappers around different solver functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimator.nleqslv(
  x,
  y,
  start = rep(0, ncol(x)),
  link = "logit",
  construct = NULL,
  ...
)

estimator.glm(x, y, start = rep(0, ncol(x)), link = "logit", ...)

estimator.BB(
  x,
  y,
  start = rep(0, ncol(x)),
  link = "logit",
  construct = NULL,
  method = c(1, 2, 3),
  control = list(NM = c(FALSE, TRUE)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimators_+3A_x">x</code></td>
<td>
<p>a model matrix for the respective pim model. See also
<code><a href="#topic+model.matrix">model.matrix</a></code>.</p>
</td></tr>
<tr><td><code id="estimators_+3A_y">y</code></td>
<td>
<p>a vector with the response for the respective pim model.</p>
</td></tr>
<tr><td><code id="estimators_+3A_start">start</code></td>
<td>
<p>a vector as long as there are columns in <code>x</code>, containing
the starting values for the algorithm</p>
</td></tr>
<tr><td><code id="estimators_+3A_link">link</code></td>
<td>
<p>a character vector describing the link function. This
link function is used to adapt the calculation depending on the
link used in the fitting process.</p>
</td></tr>
<tr><td><code id="estimators_+3A_construct">construct</code></td>
<td>
<p>a function that creates the score function
used by either <code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> or
<code><a href="BB.html#topic+BBsolve">BBsolve</a></code> for numerical optimization. See Details.
The estimator <code>estimator.glm</code> doesn't allow
for specification of your own score function.</p>
</td></tr>
<tr><td><code id="estimators_+3A_...">...</code></td>
<td>
<p>extra arguments passed down to the actual solver function. See details.</p>
</td></tr>
<tr><td><code id="estimators_+3A_method">method</code></td>
<td>
<p>A vector of integers specifying which
Barzilai-Borwein steplengths should be used in a consecutive
manner. The methods will be used in the order specified.
More information on the help page of <code><a href="BB.html#topic+BBsolve">BBsolve</a></code>.</p>
</td></tr>
<tr><td><code id="estimators_+3A_control">control</code></td>
<td>
<p>a list with extra controlling parameters for
<code>BBsolve</code>. See the help page of <code><a href="BB.html#topic+BBsolve">BBsolve</a></code> for
more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All functions share the same three arguments, being the design matrix <code>x</code>,
the response vector <code>y</code> and the start values for the estimating function.
If you follow the same principles, you can write your own wrapper function
for any solver function of your choice.
</p>
<p>The solvers <code>estimator.nleqslv</code> and <code>estimator.BBsolve</code>
allow for specification of your own score function as well. For
this, you have the possibility to provide a constructor function
that takes three arguments
</p>

<dl>
<dt>x</dt><dd><p>The model matrix</p>
</dd>
<dt>y</dt><dd><p>the vector with pseudo-observations</p>
</dd>
<dt>link</dt><dd><p>a character vector specifying the link</p>
</dd>
</dl>

<p>The function should return a function that can be used in
either <code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code> or
<code><a href="BB.html#topic+BBsolve">BBsolve</a></code>. If you don't specify this constructor function,
the package will use the constructor function <code><a href="#topic+CreateScoreFun">CreateScoreFun</a></code>
to provide the score function.
</p>


<h3>Value</h3>

<p>a list with following elements:
</p>
<table>
<tr><td><code>coef</code></td>
<td>
<p>the estimated coefficients</p>
</td></tr>
</table>


<h3>WARNING</h3>

<p>If you specify your own score function
without changing the estimators for the variance-covariance
matrix, this vcov matrix will be blatantly wrong!!!!!
</p>


<h3>See Also</h3>

<p><code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>, <code><a href="stats.html#topic+glm.fit">glm.fit</a></code>,
<code><a href="BB.html#topic+BBsolve">BBsolve</a></code> for more information on the fitting
algorithms.
</p>
<p><code><a href="#topic+vcov.estimators">vcov.estimators</a></code>, <code><a href="#topic+pim.fit">pim.fit</a></code> and
<code><a href="#topic+pim">pim</a></code> for more information on the fitting process
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is a reimplementation of the identity link
myconstruct &lt;- function(x,y,link){
  # this function is returned
 function(beta){
   xb &lt;- as.vector(x %*% beta)
   colSums(x * (y - xb))
  }
}

data(ChickWeight)
themodel &lt;- pim(weight ~ Diet, data = ChickWeight,
construct = myconstruct)

# compare coefficients to
themodel2 &lt;- pim(weight ~ Diet, data = ChickWeight,
                link = "identity")
coef(themodel)
coef(themodel2)

# Note that this example uses a wrong estimate for the variance-covariance matrix
# You have to specify the correct vcov estimator as well
</code></pre>

<hr>
<h2 id='Extract.pim.summary'>Extract method for pim.summary objects</h2><span id='topic+Extract.pim.summary'></span><span id='topic++5B+2Cpim.summary-method'></span>

<h3>Description</h3>

<p>This method allows to extract data directly from a <code><a href="#topic+pim.summary">pim.summary</a></code>
object. It's exactly the same as extracting from <code>as.matrix(thesummary)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'pim.summary'
x[i, j, drop = TRUE]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract.pim.summary_+3A_x">x</code></td>
<td>

<p>object from which to extract element(s) or in which to replace element(s).
</p>
</td></tr>
<tr><td><code id="Extract.pim.summary_+3A_i">i</code></td>
<td>

<p>indices specifying elements to extract or replace.  Indices are
<code>numeric</code> or <code>character</code> vectors or empty (missing) or
<code>NULL</code>.  Numeric values are coerced to integer as by
<code><a href="base.html#topic+as.integer">as.integer</a></code> (and hence truncated towards zero).
Character vectors will be matched to the <code><a href="base.html#topic+names">names</a></code> of the
object (or for matrices/arrays, the <code><a href="base.html#topic+dimnames">dimnames</a></code>):
see &lsquo;Character indices&rsquo; below for further details.
</p>
<p>For <code>[</code>-indexing only: <code>i</code>, <code>j</code>, <code>...</code> can be
logical vectors, indicating elements/slices to select.  Such vectors
are recycled if necessary to match the corresponding extent.
<code>i</code>, <code>j</code>, <code>...</code> can also be negative integers,
indicating elements/slices to leave out of the selection.
</p>
<p>When indexing arrays by <code>[</code> a single argument <code>i</code> can be a
matrix with as many columns as there are dimensions of <code>x</code>; the
result is then a vector with elements corresponding to the sets of
indices in each row of <code>i</code>.
</p>
<p>An index value of <code>NULL</code> is treated as if it were <code>integer(0)</code>.
</p>
</td></tr>
<tr><td><code id="Extract.pim.summary_+3A_j">j</code></td>
<td>
<p>see i</p>
</td></tr>
<tr><td><code id="Extract.pim.summary_+3A_drop">drop</code></td>
<td>
<p>For matrices and arrays.  If <code>TRUE</code> the result is
coerced to the lowest possible dimension (see the examples).  This
only works for extracting elements, not for the replacement.  See
<code><a href="base.html#topic+drop">drop</a></code> for further details.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the selected matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FEVData)
Model &lt;- pim(FEV~ Smoke*Sex , data=FEVData)

thesummary &lt;- summary(Model)
thesummary[,2:3]
thesummary["Sex"]

</code></pre>

<hr>
<h2 id='FEVData'>This is the Childhood respiratory disease data</h2><span id='topic+FEVData'></span>

<h3>Description</h3>

<p>This is the Childhood respiratory disease data
</p>


<h3>Details</h3>

<p>These are the columns and their meanings
</p>

<ul>
<li><p><code>FEV</code> Forced Expiratory Volme (FE)
</p>
</li>
<li><p><code>Age</code> Age of the child
</p>
</li>
<li><p><code>Height</code> Height of the child
</p>
</li>
<li><p><code>Sex</code> Gender of the child (1 for boys, 0 for girls)
</p>
</li>
<li><p><code>Smoke</code> 1 if the child smokes, 0 otherwise
</p>
</li></ul>


<hr>
<h2 id='formula'>Extract the formula from a pim or pim.formula object</h2><span id='topic+formula'></span><span id='topic+formula+2Cpim-method'></span><span id='topic+formula+2Cpim.formula-method'></span>

<h3>Description</h3>

<p>This function allows you to extract a formula from a <code><a href="#topic+pim">pim</a></code>
or a <code><a href="#topic+pim.formula">pim.formula</a></code> object. In the latter case, you extract
the original formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula(x, ...)

## S4 method for signature 'pim'
formula(x, orig = FALSE, ...)

## S4 method for signature 'pim.formula'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_+3A_x">x</code></td>
<td>
<p>a <code>pim</code> or <code>pim.formula</code> object</p>
</td></tr>
<tr><td><code id="formula_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
<tr><td><code id="formula_+3A_orig">orig</code></td>
<td>
<p>a locigal value indicating whether the original formula
(<code>TRUE</code>) or the <code>pim.formula</code> object (<code>FALSE</code>) should
be returned. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on <code><a href="stats.html#topic+formula">formula</a></code> from the stats 
package. It creates a generic and can hence be used more or less in the 
same way. Yet, as the pim package is dependent on the correct
binding between the formula objects and different environments, it is
advised not to change the environments tied to the formulas and to
use this function only to extract the desired information.
</p>


<h3>Value</h3>

<p>a <code><a href="#topic+pim.formula">pim.formula</a></code> if <code>x</code> is a <code>pim</code>
object and <code>orig = TRUE</code>. Otherwise a <code><a href="stats.html#topic+formula">formula</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pim.formula-class">pim.formula-class</a></code> and <code><a href="#topic+pim-class">pim-class</a></code> for 
more information on the classes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("DysData")
themodel &lt;- pim(SPC_D2 ~ Chemo, data = DysData)

thepimform &lt;- formula(themodel)
formula(thepimform)
formula(themodel, orig = TRUE)

</code></pre>

<hr>
<h2 id='has.intercept'>Check whether formula has an explicit intercept</h2><span id='topic+has.intercept'></span><span id='topic+has.intercept+2Ccharacter-method'></span><span id='topic+has.intercept+2Cformula-method'></span><span id='topic+has.intercept+2Cterms-method'></span><span id='topic+has.intercept+2Cpim.formula-method'></span><span id='topic+has.intercept+2Cpim-method'></span>

<h3>Description</h3>

<p>This function checks whether an intercept is present in a formula of
some form. It works for a <code><a href="stats.html#topic+formula">formula</a></code>, a 
<code><a href="stats.html#topic+terms.object">terms.object</a></code> a <code><a href="#topic+pim.formula">pim.formula</a></code> object or 
a character vector representing a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has.intercept(x)

## S4 method for signature 'character'
has.intercept(x)

## S4 method for signature 'formula'
has.intercept(x)

## S4 method for signature 'terms'
has.intercept(x)

## S4 method for signature 'pim.formula'
has.intercept(x)

## S4 method for signature 'pim'
has.intercept(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="has.intercept_+3A_x">x</code></td>
<td>
<p>either a <code>formula</code>, <code>pim.formula</code>, <code>terms.object</code>
or a character vector representing a formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of a <code>terms.object</code>, this function only checks whether the
<code>intercept</code> attribute is larger than 0. In all other cases, the 
function checks whether it can find a <code>+ 1</code> somewhere in the formula,
indicating that an intercept has to be fit in a <code><a href="#topic+pim">pim</a></code>.
</p>


<h3>Value</h3>

<p>a single logical value
</p>


<h3>WARNING</h3>

<p>This function will return <code>FALSE</code> for a standard formula
that is used in the context of a marginal model. Keep in mind that when
specifying <code>model = 'marginal'</code> in a call to <code>pim</code>, the model
will contain an intercept regardless of the outcome of <code>has.intercept</code>
</p>


<h3>Note</h3>

<p>This function is meant to be used in the context of a <code><a href="#topic+pim">pim</a></code>
call. Although the function should work for standard formulas as well,
correct results are not guaranteed when used outside a pim context.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("FEVData")
# Create the "model frame"
FEVenv &lt;- new.pim.env(FEVData, compare="unique")
# create the formula and bind it to the pim.environment.
FEVform &lt;- new.pim.formula(
  Age ~ I(L(Height) - R(Height))  ,
  FEVenv
)
has.intercept(FEVform)
FEVform2 &lt;- new.pim.formula(Age ~ Height + 1, FEVData)
has.intercept(FEVform2)

</code></pre>

<hr>
<h2 id='has.specials'>Extract information from a pim.formula object</h2><span id='topic+has.specials'></span><span id='topic+lhs+2C'></span><span id='topic+terms+2C'></span><span id='topic+has.specials+2Cpim.formula-method'></span><span id='topic+terms'></span><span id='topic+terms+2Cpim.formula-method'></span><span id='topic+lhs'></span><span id='topic+lhs+2Cpim.formula-method'></span>

<h3>Description</h3>

<p>This group of functions provides an easy way to extract the
extra information saved in a <code><a href="#topic+pim.formula">pim.formula</a></code> object. 
Take a look at the help page of <code><a href="#topic+pim.formula">pim.formula</a></code> for
more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has.specials(x)

## S4 method for signature 'pim.formula'
has.specials(x)

terms(x, ...)

## S4 method for signature 'pim.formula'
terms(x)

lhs(x)

## S4 method for signature 'pim.formula'
lhs(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="has.specials_+3A_x">x</code></td>
<td>
<p>an object of the class pim.formula</p>
</td></tr>
<tr><td><code id="has.specials_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>has.specials()</code>: a single <code>TRUE</code> or <code>FALSE</code>
value indicating whether the formula right-hand side contains any
special functions.
</p>
<p><code>terms()</code>: the <code><a href="stats.html#topic+terms">terms</a></code> object
of the <code>pim.formula</code> object
</p>
<p><code>lhs()</code>: an object of class <code>call</code> containing 
the left hand side of the formula as used in the pim.
</p>


<h3>See Also</h3>

<p>the class <code><a href="#topic+pim.formula-class">pim.formula-class</a></code>
</p>
<p><code><a href="#topic+response">response</a></code> for extracting the pseudoresponse
variable, <code><a href="#topic+model.matrix">model.matrix</a></code> for extracting the design
matrix of pseudo-observations, <code><a href="#topic+formula">formula</a></code> for
extracting the <code>pim.formula</code> and <code><a href="#topic+penv">penv</a></code> for 
extracting the pim environment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("FEVData")
# Create the "model frame"
FEVenv &lt;- new.pim.env(FEVData, compare="unique")

# create the formula and bind it to the pim.environment.
FEVform &lt;- new.pim.formula(
  Age ~ I(L(Height) - R(Height))  ,
  FEVenv
)
lhs(FEVform)
has.specials(FEVform)
penv(FEVform)

FEVform2 &lt;- new.pim.formula(
  FEV ~ Height*Sex,
  FEVenv
)

has.specials(FEVform2)
terms(FEVform2)

</code></pre>

<hr>
<h2 id='is.complete'>Check whether a pim environment is complete</h2><span id='topic+is.complete'></span>

<h3>Description</h3>

<p>Objects of class <code><a href="#topic+pim.environment">pim.environment</a></code> can be created with
or without a poset. To check whether an object has a poset included,
you use the function <code>is.complete</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.complete(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.complete_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+pim.environment">pim.environment</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a single value TRUE or FALSE
</p>


<h3>Note</h3>

<p>This function is not written as an S4 method. Might be rewritten
to S4 later on.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the constructor returns an empty environment without poset 
is.complete(new.pim.env())

# Constructing a pim environment with a poset
data("FEVData")
FEVenv &lt;- new.pim.env(FEVData, compare="unique")
is.complete(FEVenv)

</code></pre>

<hr>
<h2 id='L'>Specify the left hand and right hand side of an expression used in pims</h2><span id='topic+L'></span><span id='topic+R'></span><span id='topic+PP'></span>

<h3>Description</h3>

<p>These functions allow you to specify the left hand side and
right hand side of a term in a pim model. The user should
only use this functions within a formula using the <code><a href="#topic+pim">pim</a></code>
function. Use in a different context will return an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L(x)

R(x)

PP(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L_+3A_x">x</code></td>
<td>
<p>any vector specified in a formula</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These specific functions are actually not used by the
function <code><a href="#topic+pim">pim</a></code>. <code>pim</code> calls the internal function
<code><a href="#topic+.make.posfun">.make.posfun</a></code> to create the actual functions <code>L</code>
and <code>R</code> to work with the specified posets of the model of
interest.
</p>
<p>The actual functions used by <code>pim</code> are saved in a specific environment, a <code><a href="#topic+pim.environment">pim.environment</a></code>, which resides in the <code><a href="#topic+pim-class">pim-class</a></code> object returned by <code>pim</code>. This way of working
is chosen in order to avoid unnecessary copying of data.
</p>
<p>The function <code>PP</code> serves simply as short for <code>R(x) - L(x)</code>. If used outside the context of a pim model, it will generate
multiple warnings (see section warning).
</p>


<h3>Value</h3>

<p>a vector with the pseudo-observations for x, based on the
poset used to create the function. If used in a wrong context (i.e.
not in a call to <code>pim</code>), it returns <code>x</code> unchanged and throws
a warning.
</p>


<h3>warning</h3>

<p>These functions serve only as placeholder. During the fitting process
of a pim, they get updated to include the posets (the indices that
determine which observations are compared)
Note that this makes the functions behave fundamentally
different from what you would expect R. The result of these
functions depends on the context in which they are called.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pim(income~(L(foodexp) - R(foodexp)), data=Engeldata)
L(1:10) # Gives a warning

## End(Not run)
</code></pre>

<hr>
<h2 id='MHData'>This is the Mental health data</h2><span id='topic+MHData'></span>

<h3>Description</h3>

<p>This is the Mental health data
</p>


<h3>Details</h3>

<p>These are the columns and their meanings
</p>

<ul>
<li><p><code>mental</code> Mental impairment (MI)
</p>
</li>
<li><p><code>ses</code> Socioeconomic status
</p>
</li>
<li><p><code>life</code> Life index (LI)
</p>
</li></ul>


<hr>
<h2 id='model.matrix.pim'>Create a model matrix for a probabilistic index model</h2><span id='topic+model.matrix.pim'></span><span id='topic+model.matrix'></span><span id='topic+model.matrix.pim.formula'></span><span id='topic+model.matrix+2Cpim-method'></span><span id='topic+model.matrix+2Cpim.formula-method'></span>

<h3>Description</h3>

<p>This function creates a model matrix for use in a probabilistic
index model. This model matrix can be passed to <code><a href="#topic+pim.fit">pim.fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model.matrix(object, ...)

## S4 method for signature 'pim'
model.matrix(object, data, ...)

## S4 method for signature 'pim.formula'
model.matrix(
  object,
  data,
  model = c("difference", "marginal", "regular", "customized"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.pim_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+pim.formula">pim.formula</a></code> object that contains
the formula necessary for constructing the model matrix.</p>
</td></tr>
<tr><td><code id="model.matrix.pim_+3A_...">...</code></td>
<td>
<p>extra arguments passed to or from other methods.
This is currently only implemented in concordance with
the generic <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> function.</p>
</td></tr>
<tr><td><code id="model.matrix.pim_+3A_data">data</code></td>
<td>
<p>an optional argument specifying the data frame for which
the model matrix should be constructed. See also 
<code><a href="stats.html#topic+model.matrix">model.matrix</a>)</code> in the <code>stats</code> package.</p>
</td></tr>
<tr><td><code id="model.matrix.pim_+3A_model">model</code></td>
<td>
<p>a single character value with possible values &quot;difference&quot; 
(the default), &quot;marginal&quot;, &quot;regular&quot; or &quot;customized&quot;. See also
<code><a href="#topic+pim">pim</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a design matrix for a pim model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("FEVData")
# Create the "model frame"
FEVenv &lt;- new.pim.env(FEVData, compare="unique")
# This includes the poset
pos &lt;- poset(FEVenv, as.list=TRUE)

# create the formula and bind it to the pim.environment.
FEVform &lt;- new.pim.formula(
  Age ~ I(L(Height) - R(Height))  ,
  FEVenv
)

# Use this formula object to construct the model matrix
# use the default model ( difference )
MM &lt;- model.matrix(FEVform)

# Use this formula object to construct the pseudo response
Y &lt;- response(FEVform)

# Now pim.fit can do what it does
res &lt;- pim.fit(MM,Y, estim = "estimator.glm", penv=FEVenv)

</code></pre>

<hr>
<h2 id='new.pim'>Create an object of class pim</h2><span id='topic+new.pim'></span>

<h3>Description</h3>

<p>This function is the constructor for an object of class pim. It is nothing
but a placeholder for <code>new("pim", ...)</code>. This function is not exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.pim(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.pim_+3A_...">...</code></td>
<td>
<p>Data to include in the new object. See <code><a href="methods.html#topic+new">new</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>pim</code>. See <code><a href="#topic+pim-class">pim-class</a></code>
</p>

<hr>
<h2 id='new.pim.env'>Constructor for a pim.environment</h2><span id='topic+new.pim.env'></span><span id='topic+new.pim.env+2Cmissing-method'></span><span id='topic+new.pim.env+2Cenvironment-method'></span><span id='topic+new.pim.env+2Clist-method'></span><span id='topic+new.pim.env+2Cdata.frame-method'></span><span id='topic+new.pim.env+2CANY-method'></span>

<h3>Description</h3>

<p>This functions serves as a constructor for an object of the class
<code><a href="#topic+pim.environment">pim.environment</a></code>. In most cases, calling this function directly
is not necessary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.pim.env(data, ...)

## S4 method for signature 'missing'
new.pim.env(data, ...)

## S4 method for signature 'environment'
new.pim.env(
  data,
  compare = "unique",
  env = parent.frame(),
  vars = NULL,
  classes = NULL,
  ...
)

## S4 method for signature 'list'
new.pim.env(data, compare = "unique", vars = NULL, ...)

## S4 method for signature 'data.frame'
new.pim.env(data, compare = "unique", vars = NULL, ...)

## S4 method for signature 'ANY'
new.pim.env(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.pim.env_+3A_data">data</code></td>
<td>
<p>a data frame, a list or an environment containing
the data for a probabilistic index model.</p>
</td></tr>
<tr><td><code id="new.pim.env_+3A_...">...</code></td>
<td>
<p>extra parameters for construction of the poset, like
the argument <code>compare</code> from <code><a href="#topic+new.pim.poset">new.pim.poset</a></code>.</p>
</td></tr>
<tr><td><code id="new.pim.env_+3A_compare">compare</code></td>
<td>
<p>a character vector, matrix or list that defines how the
set of pseudo observations (poset) should be constructed. 
if set to <code>NULL</code>, no poset is constructed.
See also <code><a href="#topic+new.pim.poset">new.pim.poset</a></code> 
for more information on how to specify a custom poset.</p>
</td></tr>
<tr><td><code id="new.pim.env_+3A_env">env</code></td>
<td>
<p>an environment that is the parent environment of the object.</p>
</td></tr>
<tr><td><code id="new.pim.env_+3A_vars">vars</code></td>
<td>
<p>An optional character vector with the names of the variables
that should be included in the pim environment. Note that the
variable names should be found in the object passed to argument <code>data</code>.</p>
</td></tr>
<tr><td><code id="new.pim.env_+3A_classes">classes</code></td>
<td>
<p>An optional character vector with the classes of the 
variables in the environment, given in the same order as 
the argument <code>data.names</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called during the preparation of the model
matrix for a pim. The resulting object is used to evaluate the formula
of a pim, and stores information on how this is done. 
</p>
<p>Note that the parent of the environment is actually the 
<code><a href="#topic+pim.poset">pim.poset</a></code> object in the <code>poset</code> slot. 
The parent you set using the <code>env</code> argument, 
is the parent of the <code>pim.poset</code> object.  This ensures that
when a formula is evaluated in the <code>pim.environment</code> it 
will use a suitable search path to find all functions and objects.
</p>


<h3>Value</h3>

<p>an object of the class <code><a href="#topic+pim.environment">pim.environment</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>new.pim.env() # Creates an empty object

# Starting from a data frame
data(DysData)
env1 &lt;- new.pim.env(DysData)

env2 &lt;- new.pim.env(DysData, compare=NULL)
poset(env2)
env3 &lt;- new.pim.env(DysData, compare="all")
poset(env3)


data(FEVData)
env4 &lt;- new.pim.env(FEVData, vars=c('Age','Sex'))
ls(env4)


</code></pre>

<hr>
<h2 id='new.pim.formula'>Constructor for pim.formula</h2><span id='topic+new.pim.formula'></span><span id='topic+new.pim.formula+2Cformula+2Cpim.environment-method'></span><span id='topic+new.pim.formula+2Cformula+2CANY-method'></span>

<h3>Description</h3>

<p>This function reworks a formula to a pim.formula for use
in a probabilistic index model. This function is only meant
to be used internally, but is exported. It should be used only
in concordance with <code><a href="#topic+model.matrix.pim">model.matrix.pim</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.pim.formula(formula, data, ...)

## S4 method for signature 'formula,pim.environment'
new.pim.formula(formula, data, ...)

## S4 method for signature 'formula,ANY'
new.pim.formula(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.pim.formula_+3A_formula">formula</code></td>
<td>
<p>a formula object</p>
</td></tr>
<tr><td><code id="new.pim.formula_+3A_data">data</code></td>
<td>
<p>either a <code><a href="#topic+pim.environment">pim.environment</a></code> object containing the
data for the pim, or an object that can be converted to a 
<code>pim.environment</code> by <code><a href="#topic+new.pim.env">new.pim.env</a></code></p>
</td></tr>
<tr><td><code id="new.pim.formula_+3A_...">...</code></td>
<td>
<p>extra arguments to <code><a href="#topic+new.pim.env">new.pim.env</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is the constructor to be used for a <code><a href="#topic+pim.formula">pim.formula</a></code>
object, and should only be used in conjunction with 
<code><a href="#topic+model.matrix.pim">model.matrix.pim</a></code> and <code><a href="#topic+pim.fit">pim.fit</a></code> as shown
in the examples.
</p>


<h3>Value</h3>

<p>a <code><a href="#topic+pim.formula">pim.formula</a></code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pim.formula-class">pim.formula-class</a></code> for more information on the 
class itself. <code><a href="#topic+PO">PO</a></code>, <code><a href="#topic+L">L</a></code> and <code>R</code> for some
functions that can be used in a <code>pim.formula</code>
</p>
<p>#' @examples 
data(&quot;FEVData&quot;)
# Create the &quot;model frame&quot;
FEVenv &lt;- new.pim.env(FEVData, compare=&quot;unique&quot;)
# This includes the poset
pos &lt;- poset(FEVenv, as.list=TRUE)
</p>
<p># create the formula and bind it to the pim.environment.
FEVform &lt;- new.pim.formula(
Age ~ I(L(Height) - R(Height))  ,
FEVenv
)
</p>
<p># Use this formula object to construct the model matrix
# use the default model ( difference )
MM &lt;- model.matrix(FEVform)
</p>
<p># Use this formula object to construct the pseudo response
Y &lt;- response(FEVform)
</p>
<p># Now pim.fit can do what it does
res &lt;- pim.fit(MM,Y, estim = &quot;estimator.glm&quot;, penv=FEVenv)
</p>

<hr>
<h2 id='new.pim.poset'>Create a pim.poset environment</h2><span id='topic+new.pim.poset'></span><span id='topic+new.pim.poset+2Ccharacter+2Cnumeric-method'></span><span id='topic+new.pim.poset+2Cmatrix+2Cnumeric-method'></span><span id='topic+new.pim.poset+2Clist+2Cnumeric-method'></span><span id='topic+new.pim.poset+2Cmatrix+2Cmissing-method'></span><span id='topic+new.pim.poset+2Clist+2Cmissing-method'></span><span id='topic+new.pim.poset+2Cmissing+2Cnumeric-method'></span>

<h3>Description</h3>

<p>This function allows you to create a <code><a href="#topic+pim.poset">pim.poset</a></code> environment 
that can be added to a <code><a href="#topic+pim.environment">pim.environment</a></code> object. You can
use this function to create a custom poset, but in general it's safer
to use the relevant arguments of the <code><a href="#topic+pim">pim</a></code> function. 
That way more safety checks are carried out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new.pim.poset(compare, nobs, parent = parent.frame(), ...)

## S4 method for signature 'character,numeric'
new.pim.poset(compare, nobs, parent = parent.frame(), ...)

## S4 method for signature 'matrix,numeric'
new.pim.poset(compare, nobs, parent = parent.frame(), ...)

## S4 method for signature 'list,numeric'
new.pim.poset(compare, nobs, parent, comp.value = "custom", ...)

## S4 method for signature 'matrix,missing'
new.pim.poset(compare, nobs, parent = parent.frame(), ...)

## S4 method for signature 'list,missing'
new.pim.poset(compare, nobs, parent = parent.frame(), ...)

## S4 method for signature 'missing,numeric'
new.pim.poset(compare, nobs, parent = parent.frame(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new.pim.poset_+3A_compare">compare</code></td>
<td>
<p>A character value, matrix or list indicating how the
poset should be constructed. Defaults to the default value of 
<code><a href="#topic+create.poset">create.poset</a></code>. See Details section for more information.</p>
</td></tr>
<tr><td><code id="new.pim.poset_+3A_nobs">nobs</code></td>
<td>
<p>An integer value determining the number of observations
this poset is created for. If compare is not a character value,
the number of observations</p>
</td></tr>
<tr><td><code id="new.pim.poset_+3A_parent">parent</code></td>
<td>
<p>An optional environment that serves as the parent for the
<code>pim.poset</code> environment. By default this is the environment
from which the function is called. Note that for a correct functioning,
the parent environment should be set to the <code><a href="#topic+pim.environment">pim.environment</a></code>
this object is part of. This is done automatically by the function
<code><a href="#topic+add.poset">add.poset</a></code>.</p>
</td></tr>
<tr><td><code id="new.pim.poset_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="new.pim.poset_+3A_comp.value">comp.value</code></td>
<td>
<p>a character value to be used as value for the 
compare slot of the object. Defaults to 'custom' and 
should be left at the default without
a very good reason to change it.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A poset (or pseudo observation set) in the context of 
probabilistic index models is a set of indices that determines
which observations are compared with one another. It is used to
construct the pseudo-observations on which the model is fitted.
You can think of a poset as a &quot;pseudo-observation set&quot;.
</p>
<p>The most convenient way to use this function, is by specifying
a character value for the argument <code>compare</code>. The value &quot;unique&quot;
creates a poset in such a way that only unique combinations of two
observations are used in the model. The value &quot;all&quot; creates all
possible L-R combinations between the observations.
</p>
<p>If you want to define the poset yourself, you can pass either a matrix 
or a list with 2 elements as value for the argument <code>compare</code>.
Columns of the matrix or elements of the list should either be named
&quot;L&quot; and &quot;R&quot;, or be unnamed. When unnamed, the function takes the first
column/element as the left poset, and the second column/element as
the right poset. If the (col)names are anything else but &quot;L&quot; and &quot;R&quot;,
these names are ignored and the first column is seen as &quot;L&quot;.
</p>


<h3>Value</h3>

<p>an <code><a href="#topic+pim.poset">pim.poset</a></code> object that can be used to
replace the poset in a pim environment.
</p>


<h3>Note</h3>

<p>You can omit the argument <code>compare</code> if you supply a value for
<code>nobs</code>. You can also omit the argument <code>nobs</code> if you
provide a matrix or list as value for <code>compare</code>. The function
will try to deduct the number of observations from the highest 
index value present in the matrix/list
</p>
<p>You can't omit both arguments together though, as the function
needs at least some information on the number of observations
the poset is designed for.
</p>


<h3>Warning</h3>

<p>Changing the value of <code>comp.value</code> by hand might result in 
errors or a wrongly fitted model. The argument exists for internal
purposes and possible extensions later on, but should not be used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add.poset">add.poset</a></code> for more information on how to
adapt the poset of a <code>pim.environment</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mypos &lt;- new.pim.poset('unique',n=10) # creates empty environment
ls(mypos)
# Using the created poset functions L and R
# Note this is purely as illustration, this makes no sense
# in the context of a pim analysis.
mypos$L(1:10)
mypos$R(1:10)

</code></pre>

<hr>
<h2 id='nobs+2Cpim.environment-method'>Extract the number of observations</h2><span id='topic+nobs+2Cpim.environment-method'></span><span id='topic+nobs+2Cpim.poset-method'></span><span id='topic+nobs+2Cmatrix-method'></span><span id='topic+nobs+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>This function extracts the number of observations in an object
of class <code><a href="#topic+pim.environment">pim.environment</a></code>, or the number of observations
for which a <code><a href="#topic+pim.poset">pim.poset</a></code> is constructed. If applied to
a matrix or data.frame, it returns the number of rows.
For any other object it
does the same as <code><a href="base.html#topic+length">length</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'pim.environment'
nobs(object)

## S4 method for signature 'pim.poset'
nobs(object)

## S4 method for signature 'matrix'
nobs(object)

## S4 method for signature 'data.frame'
nobs(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs+2B2Cpim.environment-method_+3A_object">object</code></td>
<td>
<p>an object of the class <code><a href="#topic+pim.environment">pim.environment</a></code> or <code><a href="#topic+pim.poset">pim.poset</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package imports the generic <code><a href="stats.html#topic+nobs">nobs</a></code> from the package
<code>stats4</code>.
</p>


<h3>Value</h3>

<p>In case the function is called on a <code>pim.environment</code>
or a <code>pim.poset</code> object,
an integer with the number of (foreseen) observations. If the
pim.environment is empty, it returns <code>0</code>.
</p>
<p>In all other cases, it returns the output of either <code><a href="base.html#topic+nrow">nrow</a></code> (for
matrices and data.frames)
or <code><a href="base.html#topic+length">length</a></code>.
</p>

<hr>
<h2 id='P'>Probability function</h2><span id='topic+P'></span><span id='topic+PO'></span>

<h3>Description</h3>

<p>This functions transform a comparison or otherwise
logical value to a numeric value for use in a pim.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P(x)

PO(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P_+3A_x">x</code></td>
<td>
<p>for <code>P</code>, a logical value. For <code>PO</code> a numeric value.</p>
</td></tr>
<tr><td><code id="P_+3A_y">y</code></td>
<td>
<p>a numeric value or <code>NULL</code>. If <code>NULL</code>, the function
will try to calculate <code>PO(L(x),R(x))</code>, provided the functions
<code><a href="#topic+L">L</a></code> and <code><a href="#topic+R">R</a></code> are defined correctly. This
is the case when <code>PO</code> is used in the context of a probabilistic
index model fitted with <code><a href="#topic+pim">pim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are constructed purely for notation. 
<code>P</code> is completely equivalent
to <code><a href="base.html#topic+as.numeric">as.numeric</a></code>, apart from an extra control
to check whether it actually makes sense to do so. 
The function <code>PO</code> is just short for <code>P(x &lt; y) + 0.5*P(x == y)</code>
</p>


<h3>Value</h3>

<p>A numeric value of 0, 0.5 or 1. 1 if x &lt; y, 0.5 if x == y 
and 0 if x &gt; y
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pim">pim</a></code> and <code><a href="#topic+pim.formula">pim.formula</a></code> for more information
on how this is used inside a pim context.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Check in pim

</code></pre>

<hr>
<h2 id='penv'>Extract a pim environment from a model or formula</h2><span id='topic+penv'></span><span id='topic+penv+2Cpim.formula-method'></span><span id='topic+penv+2Cpim-method'></span>

<h3>Description</h3>

<p>This function allows you to extract the 
<code><a href="#topic+pim.environment">pim.environment</a></code> object from either a <code>pim</code>
object or a <code>pim.formula</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penv(x)

## S4 method for signature 'pim.formula'
penv(x)

## S4 method for signature 'pim'
penv(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penv_+3A_x">x</code></td>
<td>
<p>either a <code>pim</code> or a <code>pim.formula</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>In case of a <code>pim</code> object, the <code>pim.environment</code>
contained therein. In case of a <code>pim.formula</code> object, 
the environment itself. 
See the help page <code>pim.formula-class</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("FEVData")
# Create the "model frame"
FEVenv &lt;- new.pim.env(FEVData, compare="unique")

# create the formula and bind it to the pim.environment.
FEVform &lt;- new.pim.formula(
  Age ~ I(L(Height) - R(Height))  ,
  FEVenv
)
theEnv &lt;- penv(FEVform)
ls(theEnv)

themodel &lt;- pim(Age ~ Height, FEVenv)
thePEnv &lt;- penv(themodel)
thePEnv

ls(thePEnv)
# Note that this is a different environment, and that it only contains
# the variables in the formula, contrary to the environment created
# by new.pim.formula
</code></pre>

<hr>
<h2 id='pim'>Fitting a Probabilistic Index Model</h2><span id='topic+pim'></span>

<h3>Description</h3>

<p>This function fits a probabilistic index model,
also known as PIM. It can be used to fit standard PIMs, as well as
many different flavours of models that can be reformulated as a pim.
The most general models are implemented, but the flexible formula
interface allows you to specify a wide variety of different models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim(
  formula,
  data,
  link = c("logit", "probit", "identity"),
  compare = if (model == "marginal") "all" else "unique",
  model = c("difference", "marginal", "regular", "customized"),
  na.action = getOption("na.action"),
  weights = NULL,
  keep.data = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pim_+3A_formula">formula</code></td>
<td>
<p>An object of class <code><a href="#topic+formula">formula</a></code> (or one that
can be coerced to that class): A symbolic description of the model
to be fitted. The details of model specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="pim_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment that contains
the variables in the model. Objects that can be coerced by
<code><a href="#topic+as.data.frame">as.data.frame</a></code> can be used too.</p>
</td></tr>
<tr><td><code id="pim_+3A_link">link</code></td>
<td>
<p>a character vector with a single value that determines the
used link function. Possible values are &quot;logit&quot;, &quot;probit&quot; and &quot;identity&quot;.
The default is &quot;logit&quot;.</p>
</td></tr>
<tr><td><code id="pim_+3A_compare">compare</code></td>
<td>
<p>a character vector with a single value that describes how the
model compares observations. It can take the values &quot;unique&quot; or &quot;all&quot;.
Alternatively you can pass a matrix with two columns.
Each row represents the rownumbers in the original data frame that
should be compared to eachother. See Details.</p>
</td></tr>
<tr><td><code id="pim_+3A_model">model</code></td>
<td>
<p>a single character value with possible values &quot;difference&quot;
(the default), &quot;marginal&quot;, &quot;regular&quot; or &quot;customized&quot;. If the formula indicates
a customized model (by the use of <code><a href="#topic+L">L</a>()</code> or <code><a href="#topic+R">R</a>()</code>),
this parameter is set automatically to &quot;customized&quot;. Currently, only the
options &quot;difference&quot;, &quot;marginal&quot; and &quot;customized&quot; are implemented.</p>
</td></tr>
<tr><td><code id="pim_+3A_na.action">na.action</code></td>
<td>
<p>the name of a function which indicates what should happen when the data
contains NAs. The default is set by the <code>na.action</code> setting of
<code><a href="base.html#topic+options">options</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code> when unset.</p>
</td></tr>
<tr><td><code id="pim_+3A_weights">weights</code></td>
<td>
<p>Currently not implemented.</p>
</td></tr>
<tr><td><code id="pim_+3A_keep.data">keep.data</code></td>
<td>
<p>a logical value indicating whether the model
matrix should be saved in the object. Defaults to <code>FALSE</code>. See Details.</p>
</td></tr>
<tr><td><code id="pim_+3A_...">...</code></td>
<td>
<p>extra parameters sent to <code><a href="#topic+pim.fit">pim.fit</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>PIMs are based on a set of pseudo-observations constructed from the
comparison between a range of possible combinations of 2 observations.
We call the set of pseudo observations <em>poset</em> in the context
of this package.
</p>
<p>By default, this poset takes every unique combination of 2 observations
(<code>compare = "unique"</code>). You can either use a character value, or
use a matrix or list to identify the set of observation pairs that have to be
used as pseudo-observations. Note that the matrix and list should
be either nameless, or have the (col)names 'L' and 'R'. If any other
names are used, these are ignored and the first column/element
is considered to be 'L'. See also
<code><a href="#topic+new.pim.poset">new.pim.poset</a></code>.
</p>
<p>It's possible to store the model matrix and psuedo responses in the
resulting object. By default this is not done
(<code>keep.data = FALSE</code>) as this is less burden on the memory and
the <code><a href="#topic+pim.formula">pim.formula</a></code> object contains all information to
reconstruct both the model matrix and the pseudo responses.
If either the model matrix or the pseudo responses are needed for
further calculations, setting <code>keep.data</code> to <code>TRUE</code> might
reduce calculation time for these further calculations.
</p>


<h3>Value</h3>

<p>An object of class <code>pim</code>. See <code><a href="#topic+pim-class">pim-class</a></code>
for more information.
</p>


<h3>The enhanced formula interface</h3>

<p>In case you want to fit a standard PIM, you can specify the model in
mostly the same way as for <code><a href="stats.html#topic+lm">lm</a></code>. There's one important
difference: a PIM has by default no intercept. To add an intercept, use
<code>+ 1</code> in the formula.
</p>
<p>Next to this, you can use the functions <code><a href="#topic+L">L</a></code> and <code><a href="#topic+R">R</a></code>
in a formula to indicate which part of the poset you refer to. Remember a
poset is essentially a matrix-like object with indices refering to the
pseudo-observations. Using <code>L()</code> and <code>R()</code> you can define
exactly how the pseudo-observations fit in the model. Keep in mind that
any calculation done with these functions, has to be wrapped in a call
to <code>I()</code>, just like you would do in any other formula interface.
</p>
<p>You don't have to specify the model though. If you choose the option
<code>model = 'difference'</code>, every variable in the formula will be
interpreted as <code>I(R(x) - L(x))</code>. If you use the option
<code>model = 'marginal'</code>, every variable will be interpreted as
<code>R(X)</code>.
</p>
<p>If you don't specify any special function (i.e. <code><a href="#topic+L">L</a></code>,
<code><a href="#topic+R">R</a></code>, <code><a href="#topic+P">P</a></code> or <code><a href="#topic+PO">PO</a></code>),
the lefthand side of the formula is defined as <code>PO(y)</code>. The function
<code><a href="#topic+PO">PO</a></code> calculates pseudo observations; it is 1
if the value of the dependent variable for the observation
from the L-poset is smaller than, 0 if it is larger than and 0.5 if
it is equal to the value for value from the R-poset (see also <code><a href="#topic+PO">PO</a></code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pim-class">pim-class</a></code> for more information on the returned
object, <code><a href="#topic+pim.fit">pim.fit</a></code> for more information on the fitting
itself,  <code><a href="#topic+pim-getters">pim-getters</a></code>, <code><a href="#topic+coef">coef</a></code>, <code><a href="#topic+confint">confint</a></code>,
<code><a href="#topic+vcov">vcov</a></code> etc  for how to extract information like coefficients,
variance-covariance matrix, ...,
<code><a href="#topic+summary">summary</a></code> for some tests on the coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('FEVData')
# The most basic way to use the function
Model &lt;- pim(FEV~ Smoke*Sex , data=FEVData)

# A model with intercept
# The argument xscalm is passed to nleqslv via pim.fit and estimator.nleqslv
# By constructing the estimator functions wisely, you can control most of
# the fitting process from the pim() function.
data('EngelData')
Model2 &lt;- pim(foodexp ~ income + 1, data=EngelData,
   compare="all",
   xscalm = 'auto')

# A marginal model
# It makes sense to use the identity link in combination with the
# score estimator for the variance-covariance matrix
data('DysData')
Model3 &lt;- pim(SPC_D2 ~ out, data = DysData,
  model = 'marginal', link = 'identity',
  vcov.estim = score.vcov)

# A Model using logical comparisons, this is also possible!
# Model the chance that both observations have a different
# outcome in function of whether they had a different Chemo treatment
Model6 &lt;- pim(P(L(out) != R(out)) ~ I(L(Chemo) != R(Chemo)),
   data=DysData,
   compare="all")

# Implementation of the friedman test in the context of a pim
# warpbreaks data where we consider tension as a block
# To do so, you provide the argument compare with a custom
# set of comparisons
data(warpbreaks)
wb &lt;- aggregate(warpbreaks$breaks,
                by = list(w = warpbreaks$wool,
                          t = warpbreaks$tension),
                FUN = mean)
comp &lt;- expand.grid(1:nrow(wb), 1:nrow(wb))
comp &lt;- comp[wb$t[comp[,1]] == wb$t[comp[,2]],] # only compare within blocks
m &lt;- pim(x ~ w, data = wb, compare = comp, link = "identity",  vcov.estim = score.vcov)
summary(m)
friedman.test(x ~ w | t, data = wb)
## Not run: 
# This illustrates how a standard model is actually built in a pim contex
Model4 &lt;- pim(PO(L(Height),R(Height)) ~ I(R(Age) - L(Age)) + I(R(Sex) - L(Sex)),
data=FEVData,
estim = "estimator.BB")
# is the same as
Model5 &lt;- pim(Height ~ Age + Sex, data = FEVData, estim = "estimator.BB")
summary(Model4)
summary(Model5)

## End(Not run)
</code></pre>

<hr>
<h2 id='pim-class'>Class pim</h2><span id='topic+pim-class'></span>

<h3>Description</h3>

<p>This class contains the fitting information resulting from a call to
<code><a href="#topic+pim">pim</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>formula</code></dt><dd><p>The <code><a href="#topic+pim.formula">pim.formula</a></code> object used in the fit</p>
</dd>
<dt><code>coef</code></dt><dd><p>a numeric vector with the fitted coefficients</p>
</dd>
<dt><code>vcov</code></dt><dd><p>a numeric matrix containing the variance-covariance matrix 
of the fitted coefficients</p>
</dd>
<dt><code>penv</code></dt><dd><p>a <code><a href="#topic+pim.environment">pim.environment</a></code> object containing the 
data used to fit this</p>
</dd>
<dt><code>fitted</code></dt><dd><p>a numeric vector containing the raw fitted</p>
</dd>
<dt><code>link</code></dt><dd><p>a character vector describing the used link function</p>
</dd>
<dt><code>estimators</code></dt><dd><p>a list with the elements <code>coef</code> and <code>vcov</code>,
containing either a character value with the name of the used estimator,
or the function itself.</p>
</dd>
<dt><code>model.matrix</code></dt><dd><p>If <code>keep.data</code> is set to <code>TRUE</code> 
while calling <code><a href="#topic+pim">pim</a></code> the original model matrix. 
Otherwise an empty matrix with 0 rows and columns.</p>
</dd>
<dt><code>response</code></dt><dd><p>If <code>keep.data</code> is set to <code>TRUE</code> 
while calling <code><a href="#topic+pim">pim</a></code> the original response vector.
Otherwise an empty numeric vector.</p>
</dd>
<dt><code>keep.data</code></dt><dd><p>a logical value indicating whether the original
data is kept in the object. This is set using the argument
<code>keep.data</code> of the function <code><a href="#topic+pim">pim</a></code>.
<code>model</code> a character value with the value &quot;difference&quot;,
&quot;marginal&quot;, &quot;regular&quot; or &quot;customized&quot;, indicating which
type of pim model has been fitted.</p>
</dd>
</dl>

<hr>
<h2 id='pim-getters'>Getters for slots of a pim object</h2><span id='topic+pim-getters'></span><span id='topic+keep.data'></span><span id='topic+getters-pim'></span><span id='topic+fitted'></span><span id='topic+fitted+2Cpim-method'></span>

<h3>Description</h3>

<p>Getters for slots of a pim object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keep.data(x)

fitted(object, ...)

## S4 method for signature 'pim'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pim-getters_+3A_x">x</code></td>
<td>
<p>a pim object</p>
</td></tr>
<tr><td><code id="pim-getters_+3A_object">object</code></td>
<td>
<p>a pim object</p>
</td></tr>
<tr><td><code id="pim-getters_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>keep.data()</code>: a single logical value indicating whether
the model matrix and pseudo responses were stored in the 
<code><a href="#topic+pim">pim</a></code> object.
</p>
<p><code>fitted()</code>: a numeric vector with the fitted
values for the pseudo-observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('FEVData')
themodel &lt;- pim(FEV ~ Age + Height, data = FEVData)
keep.data(themodel)
fitted(themodel)

</code></pre>

<hr>
<h2 id='pim.environment-class'>The pim.environment class</h2><span id='topic+pim.environment-class'></span><span id='topic+pim.environment'></span>

<h3>Description</h3>

<p>This S4 class inherits from the S3 class <code><a href="base.html#topic+environment">environment</a></code>.
The environment serves as a container to hold the data, poset and the
poset related functions of a probabilistic index model generated
by the function <code><a href="#topic+pim">pim</a></code>. The objects of this class
behave much like an environment, but contain some extra slots
with information on the objects inside the environment.
</p>


<h3>Slots</h3>


<dl>
<dt><code>poset</code></dt><dd><p>an environment of class <code><a href="#topic+pim.poset">pim.poset</a></code> containing the  poset-related functions
(normally these are <code><a href="#topic+L">L</a></code> and <code><a href="#topic+R">R</a></code>). This 
environment has the object itself as parent.</p>
</dd>
<dt><code>data.names</code></dt><dd><p>a character vector containing the names of the
vectors that represent the data</p>
</dd>
<dt><code>nobs</code></dt><dd><p>integer value indicating the number of observations in the 
environment</p>
</dd>
<dt><code>classes</code></dt><dd><p>a _named_ list containing the classes of the
objects inside the environment. Note that the value should be the one
given by <code><a href="base.html#topic+class">class</a></code>.</p>
</dd>
<dt><code>is.complete</code></dt><dd><p>a logical value indicating whether or not the poset
was added before.</p>
</dd>
</dl>


<h3>Note</h3>

<p>This class is not exported, so it can't be extended as for now. 
Although it is possible to use the function <code><a href="methods.html#topic+new">new</a></code> for
creation of new instances, users are strongly advised to use
the function <code><a href="#topic+new.pim.env">new.pim.env</a></code> in case they need to manually
create a new instance of the class <code>pim.environment</code>.
</p>

<hr>
<h2 id='pim.fit'>Fitter function for a probabilistic index model</h2><span id='topic+pim.fit'></span>

<h3>Description</h3>

<p>This is the basic computing engine called by <code><a href="#topic+pim">pim</a></code>
to get the estimates for the coefficients and the variance-
covariance matrices. This function currently only spits out
these components using the sandwich estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim.fit(
  x,
  y,
  link = "logit",
  estim = "estimator.nleqslv",
  start = rep(0, ncol(x)),
  vcov.estim = "sandwich.vcov",
  weights = NULL,
  penv,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pim.fit_+3A_x">x</code></td>
<td>
<p>a model matrix with as many rows as <code>y</code>.</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_y">y</code></td>
<td>
<p>a vector with the pseudo-responses</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_link">link</code></td>
<td>
<p>a character vector with a link function</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_estim">estim</code></td>
<td>
<p>a character vector or a function indicating the solver
to be used for estimating the coefficients. By default this is
the function <code><a href="nleqslv.html#topic+nleqslv">nleqslv</a></code>. Other possibilities are
given in the help page on <code><a href="#topic+estimators">estimators</a></code>.</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_start">start</code></td>
<td>
<p>A numeric vector with the starting values for the fitting
algorithm, if required.</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_vcov.estim">vcov.estim</code></td>
<td>
<p>a function to determine the variance-covariance matrix.
Possibilities are <code><a href="#topic+sandwich.vcov">sandwich.vcov</a></code> and <code>link{score.vcov}</code>.
Defaults to <code>sandwich.vcov</code></p>
</td></tr>
<tr><td><code id="pim.fit_+3A_weights">weights</code></td>
<td>
<p>currently not implemented</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_penv">penv</code></td>
<td>
<p>An environment, <code><a href="#topic+pim.environment">pim.environment</a></code> or
<code><a href="#topic+pim.poset">pim.poset</a></code> object containing the poset functions.
Alternatively this can be a list of two numeric vectors, containing the
poset indices for the left and right side of the pim.</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_...">...</code></td>
<td>
<p>Further arguments that need to be passed to
the estimation function. The most relevant is <code>construct</code>,
allowing you to write your own score function for
the numerical optimization. See also <code><a href="#topic+estimators">estimators</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements
</p>

<dl>
<dt>coefficients</dt><dd><p>a numeric vector with the coefficients</p>
</dd>
<dt>vcov</dt><dd><p>a numeric matrix with the variance-covarianc matrix for
the coefficients</p>
</dd>
<dt>fitted</dt><dd><p>a numeric vector with the raw fitted values</p>
</dd>
<dt>estim</dt><dd><p>a list with two components named <code>coef</code> and <code>vcov</code>
containing information on the used estimators for both.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+model.matrix">model.matrix</a></code> for how to construct a valid model matrix
for a pim, <code><a href="#topic+pim">pim</a></code> for the general user interface
</p>

<hr>
<h2 id='pim.formula-class'>Class pim.formula</h2><span id='topic+pim.formula-class'></span><span id='topic+pim.formula'></span>

<h3>Description</h3>

<p>This class contains information on the formula passed in 
a call to <code><a href="#topic+pim">pim</a></code>. The object is used to create the 
model matrix of a pim (see <code><a href="#topic+model.matrix">model.matrix</a></code>)
</p>


<h3>Details</h3>

<p>Although a future version of this package will include the
possibility to fit survival models, this is currently not implemented.
If the <code><a href="#topic+pim">pim</a></code> function encounters special functions on the
left-hand side (i.e. when <code>has.lhs.fun</code> is <code>TRUE</code>), the
model won't be calculated.
</p>
<p>The slot <code>penv</code> contains a reference to an environment
In most cases, this will be the environment contained in a 
<code><a href="#topic+pim.environment">pim.environment</a></code> object. Note though that the
<code>pim.formula</code> object only contains a link to the environment.
The extra slots contained in the <code>pim.environment</code> object
are NOT copied to the <code>pim.formula</code>. Also keep
in mind that the environment linked to the <code>pim.environment</code>
object will continue to exist even after deleting the 
<code>pim.environment</code> itself, and this for as long as the 
<code>pim.formula</code> object exists.
</p>
<p>This class is not exported and hence cannot be extended. It serves
internal use in the pim package only.
</p>


<h3>Slots</h3>


<dl>
<dt><code>terms</code></dt><dd><p>a <code><a href="stats.html#topic+terms.object">terms.object</a></code> derived from the formula</p>
</dd>
<dt><code>has.specials</code></dt><dd><p>a logical value indicating whether the right-hand
side of the original formula contains special functions like 
<code><a href="#topic+L">L</a></code> and <code><a href="#topic+R">R</a></code></p>
</dd>
<dt><code>has.lhs.fun</code></dt><dd><p>a logical value indicating whether the left-hand
side of the original formula contains special functions. These 
exclude the functions <code><a href="#topic+P">P</a></code> and <code><a href="#topic+PO">PO</a></code> but 
include functions like <code><a href="survival.html#topic+Surv">Surv</a></code>. See Details</p>
</dd>
<dt><code>predictors</code></dt><dd><p>a character vector with the names of all the variables
mentioned in the right-hand side of the formula.</p>
</dd>
<dt><code>response</code></dt><dd><p>an character vector with the name of the response
variable.</p>
</dd>
<dt><code>lhs</code></dt><dd><p>a call with the processed left-hand side of
the formula</p>
</dd>
<dt><code>orig</code></dt><dd><p>a formula object with the original formula</p>
</dd>
<dt><code>penv</code></dt><dd><p>an <code>environment</code> object to which the
formula is related (i.e. the environment containing possible
<code>L</code> and <code>R</code> function definitions.) See Details.</p>
</dd>
<dt><code>has.intercept</code></dt><dd><p>a logical value indicating whether the formula has
an explicit intercept (indicated by + 1)</p>
</dd>
</dl>


<h3>Note</h3>

<p>This class is not exported, so it can't be extended as for now. 
Although it is possible to use the function <code><a href="methods.html#topic+new">new</a></code> for
creation of new instances, users are strongly advised to use
the function <code><a href="#topic+new.pim.formula">new.pim.formula</a></code> in case they need to manually
create a new instance of the class <code>pim.formula</code>.
</p>

<hr>
<h2 id='pim.poset-class'>The pim.poset class</h2><span id='topic+pim.poset-class'></span><span id='topic+pim.poset'></span>

<h3>Description</h3>

<p>The pim.poset class is an S4 class that inherits from <code><a href="base.html#topic+environment">environment</a></code>
and contains the poset functions for a <code><a href="#topic+pim">pim</a></code>. It's a class
used internally and should not be adapted by the user. The correct
interpretation of the formula is dependent on this object. The object
mainly functions as a slot in object of class 
<code><a href="#topic+pim.environment">pim.environment</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>compare</code></dt><dd><p>a character value with the type of poset. This can
take the values &quot;unique&quot;, &quot;all&quot; and &quot;custom&quot;.</p>
</dd>
<dt><code>nobs</code></dt><dd><p>an integer value describing the number of observations 
for which this poset is meant to be used.</p>
</dd>
</dl>


<h3>Note</h3>

<p>The pim.poset class doesn't really make sense to be used on itself.
It is part of the <code><a href="#topic+pim.environment">pim.environment</a></code> class and shouldn't
be used outside this context.
</p>

<hr>
<h2 id='pim.summary-class'>Class pim.summary</h2><span id='topic+pim.summary-class'></span><span id='topic+pim.summary'></span>

<h3>Description</h3>

<p>This class contains the summary information from a probabilistic index
model , and is created by using the function <code><a href="#topic+summary">summary</a></code>
on an object of the <code><a href="#topic+pim-class">pim-class</a></code>.
</p>


<h3>Details</h3>

<p>The class <code>pim.summary</code> can be treated like a matrix to get out
the coefficients, standard errors, Z values and/or p values.
</p>


<h3>Slots</h3>


<dl>
<dt><code>formula</code></dt><dd><p>contains an object of the class <code><a href="#topic+pim.formula">pim.formula</a></code>
containing the model fitted.</p>
</dd>
<dt><code>model</code></dt><dd><p>a character vector describing the type of model. See also the argument <code>model</code> of the function <code><a href="#topic+pim">pim</a></code></p>
</dd>
<dt><code>link</code></dt><dd><p>a character value that contains the link. See also
the argument <code>link</code> of the function <code><a href="#topic+pim">pim</a></code></p>
</dd>
<dt><code>coef</code></dt><dd><p>a numeric vector with the coefficients</p>
</dd>
<dt><code>se</code></dt><dd><p>a numeric vector with the standard errors for the coefficients</p>
</dd>
<dt><code>zval</code></dt><dd><p>a numeric vector containing the Z values for the coefficients,
testing whether the coefficient differs significantly from 0.</p>
</dd>
<dt><code>pr</code></dt><dd><p>a numeric vector containing the related p-values for the
coefficients.</p>
</dd>
<dt><code>h0</code></dt><dd><p>a numeric value or a numeric vector containing
the null hypothesis. See the argument at <code><a href="#topic+summary.pim">summary.pim</a></code></p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+pim">pim</a></code> for more info on how to construct the model
and <code><a href="#topic+summary.pim">summary.pim</a></code> for the constructor.
</p>

<hr>
<h2 id='pimdata'>The data contained in the pim package</h2><span id='topic+pimdata'></span>

<h3>Description</h3>

<p>The pim package contains different datasets for use in examples and tests. Currently, you find the datasets <code><a href="#topic+DysData">DysData</a></code>, <code><a href="#topic+EngelData">EngelData</a></code> and <code><a href="#topic+FEVData">FEVData</a></code>. More information can be found on the respective help pages.
</p>


<h3>Details</h3>

<p>The data contained in the package has following structures
</p>

<ul>
<li><p><code><a href="#topic+EngelData">EngelData</a></code>: A single numeric predictor variable and a response
</p>
</li>
<li><p><code><a href="#topic+FEVData">FEVData</a></code>: A data frame with a numeric response variable and 4 additional numeric predictor values.
</p>
</li>
<li><p><code><a href="#topic+DysData">DysData</a></code>: A dataframe with 3 factors and a numeric variable as predictors. The outcome is a factor with 4 levels.
</p>
</li>
<li><p><code>SNP_XRCC1__77</code> Genotype of this SNP. A factor with three levels: &quot;TT&quot;, &quot;TC&quot; and &quot;CC&quot;
</p>
</li>
<li><p><code>SPC_D2</code> Dose of radiation that reached 2
</p>
</li>
<li><p><code>SNP_XRCC1__77TC</code> 1 if <code>SNP_XRCC1__77</code> is &quot;TC&quot;, 0 otherwise
</p>
</li></ul>


<hr>
<h2 id='poset'>Extract the poset as a matrix or list</h2><span id='topic+poset'></span><span id='topic+poset+2Cpim.environment-method'></span><span id='topic+poset+2Cpim.poset-method'></span><span id='topic+poset+2Cenvironment-method'></span><span id='topic+poset+2Cpim-method'></span><span id='topic+poset+2Cpim.formula-method'></span>

<h3>Description</h3>

<p>This function allows you to extract the poset from either a 
<code><a href="#topic+pim.environment">pim.environment</a></code> or a <code><a href="#topic+pim.poset">pim.poset</a></code> object.
The poset can be extracted as a matrix or a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poset(x, ...)

## S4 method for signature 'pim.environment'
poset(x, ...)

## S4 method for signature 'pim.poset'
poset(x, as.list = FALSE)

## S4 method for signature 'environment'
poset(x, as.list = FALSE)

## S4 method for signature 'pim'
poset(x, ...)

## S4 method for signature 'pim.formula'
poset(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poset_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+pim.environment">pim.environment</a></code>,
<code><a href="#topic+pim.formula">pim.formula</a></code>, <code><a href="#topic+pim">pim</a></code> 
or <code><a href="#topic+pim.poset">pim.poset</a></code>, or an environment derived from
either object.</p>
</td></tr>
<tr><td><code id="poset_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Currently ignored.</p>
</td></tr>
<tr><td><code id="poset_+3A_as.list">as.list</code></td>
<td>
<p>a logical value indicating whether the poset should
be returned as list or as a matrix. Defaults to FALSE, which returns
a matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When x contains a poset, either a matrix or a list 
(when <code>as.list</code> is <code>TRUE</code>) with the indices that
make up the poset. If there's no poset, the function returns
a missing value.
</p>
<p>The returned matrix hax 2 columns, each named after the 
respective poset function. In case a list is requested, the function
returns a named list with 2 elements, each element containing the
indices related to the poset function of the same name 
(either <code><a href="#topic+L">L</a></code> or <code><a href="#topic+R">R</a></code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DysData)
DysPimEnv &lt;- new.pim.env(DysData)
poset(DysPimEnv)

</code></pre>

<hr>
<h2 id='print'>Print methods for the different object types</h2><span id='topic+print'></span><span id='topic+print+2Cpim-method'></span><span id='topic+print+2Cpim.environment-method'></span><span id='topic+print+2Cpim.poset-method'></span><span id='topic+print+2Cpim.formula-method'></span>

<h3>Description</h3>

<p>Printing <code>pim</code>, <code>pim.environment</code>, <code>pim.formula</code> and
<code>pim.poset</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print(x, ...)

## S4 method for signature 'pim'
print(x, digits = max(3L, getOption("digits") - 3L), show.vcov = FALSE, ...)

## S4 method for signature 'pim.environment'
print(x, digits = max(3L, getOption("digits") - 3L), n = 6L, ...)

## S4 method for signature 'pim.poset'
print(x, digits = max(3L, getOption("digits") - 3L), n = 6L, ...)

## S4 method for signature 'pim.formula'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>the object</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Currently ignored</p>
</td></tr>
<tr><td><code id="print_+3A_digits">digits</code></td>
<td>
<p>an integer that defines the number of digits printed</p>
</td></tr>
<tr><td><code id="print_+3A_show.vcov">show.vcov</code></td>
<td>
<p>a logical value indicating whether the variance-
covariance matrix should be shown or not. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="print_+3A_n">n</code></td>
<td>
<p>number of observations shown by <code>print</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FEVData)
Model &lt;- pim(FEV~ Smoke*Sex , data=FEVData)
print(Model)
print(penv(Model))
# You get the drift

</code></pre>

<hr>
<h2 id='response'>Extract response from a pim.formula or a pim object</h2><span id='topic+response'></span><span id='topic+response+2Cpim.formula-method'></span><span id='topic+response+2Cpim-method'></span>

<h3>Description</h3>

<p>This function extracts the response from a 
<code><a href="#topic+pim.formula">pim.formula</a></code> for use in <code><a href="#topic+pim.fit">pim.fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>response(object)

## S4 method for signature 'pim.formula'
response(object)

## S4 method for signature 'pim'
response(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="response_+3A_object">object</code></td>
<td>
<p>an object of class pim or pim.formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The response variable with pseudo-observations for
a pim.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pim-class">pim-class</a></code> and <code><a href="#topic+pim.formula-class">pim.formula-class</a></code>
for more information on the classes, and <code><a href="#topic+pim">pim</a></code>, 
<code><a href="#topic+pim.fit">pim.fit</a></code> and <code><a href="#topic+pim.formula">pim.formula</a></code> for more
information on related functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('FEVData')
Model &lt;- pim(FEV~ Smoke*Sex , data=FEVData)
response(Model)

# In pieces
FEVenv &lt;- new.pim.env(FEVData, compare="unique")
FEVform &lt;- new.pim.formula(
  Age ~ I(L(Height) - R(Height))  ,
  FEVenv
)
response(FEVform)
</code></pre>

<hr>
<h2 id='sandwich.estimator'>Pseudo-observation variance sandwich estimator</h2><span id='topic+sandwich.estimator'></span><span id='topic+score.estimator'></span>

<h3>Description</h3>

<p>The functions described here all implement an estimator for
the variance of the coefficients. This function is not exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandwich.estimator(
  U,
  U.diff,
  g1,
  g2,
  shared.factor = 1,
  switched.factor = 1,
  self.factor = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sandwich.estimator_+3A_u">U</code></td>
<td>
<p>See the formula for sandwich estimator: 
holds <code>U_{ij}</code></p>
</td></tr>
<tr><td><code id="sandwich.estimator_+3A_u.diff">U.diff</code></td>
<td>
<p>See the formula for sandwich estimator: 
holds the partial derivatives of <code>U</code>.</p>
</td></tr>
<tr><td><code id="sandwich.estimator_+3A_g1">g1</code>, <code id="sandwich.estimator_+3A_g2">g2</code></td>
<td>
<p>Index in the original observations of the &quot;left&quot; and &quot;right&quot; part of the pseudo-observations.</p>
</td></tr>
<tr><td><code id="sandwich.estimator_+3A_shared.factor">shared.factor</code></td>
<td>
<p>Factor by which all <code>UijUik</code> or
<code>UijUlj</code> will be multiplied</p>
</td></tr>
<tr><td><code id="sandwich.estimator_+3A_switched.factor">switched.factor</code></td>
<td>
<p>Factor by which all <code>UijUki</code> or
<code>UijUjl</code> will be multiplied</p>
</td></tr>
<tr><td><code id="sandwich.estimator_+3A_self.factor">self.factor</code></td>
<td>
<p>Factor by which all <code>UijUij</code> or 
<code>-UijUji</code> will be multiplied</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of the sandwich estimator
</p>

<hr>
<h2 id='SUData'>This is the Surgical unit data</h2><span id='topic+SUData'></span>

<h3>Description</h3>

<p>This is the Surgical unit data
</p>


<h3>Details</h3>

<p>These are the columns and their meanings
</p>

<ul>
<li><p><code>EnT</code> Enzyme function test score
</p>
</li>
<li><p><code>Gender</code> Gender of the patient (0: male, 1: female)
</p>
</li>
<li><p><code>Alcohol</code> History of alcohol use (0: none, 1: moderate, 2: severe)
</p>
</li>
<li><p><code>SurvivalTime</code> Survival time of each patient (the outcome of interest)
</p>
</li></ul>


<hr>
<h2 id='summary.pim'>The summary function for the pim class</h2><span id='topic+summary.pim'></span><span id='topic+summary'></span><span id='topic+summary+2Cpim-method'></span>

<h3>Description</h3>

<p>The function <code><a href="base.html#topic+summary">summary</a></code> is a generic function. We provide
a method for objects of the <code><a href="#topic+pim-class">pim-class</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object, ...)

## S4 method for signature 'pim'
summary(object, h0 = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pim_+3A_object">object</code></td>
<td>
<p>an object of the class pim.</p>
</td></tr>
<tr><td><code id="summary.pim_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Currently ignored.</p>
</td></tr>
<tr><td><code id="summary.pim_+3A_h0">h0</code></td>
<td>
<p>a numeric value or a vector as long as the number of coefficients
with the value that defines the null hypothesis to test against</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="#topic+pim.summary">pim.summary</a></code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FEVData)
Model &lt;- pim(FEV~ Age + Smoke*Sex , data=FEVData)
summary(Model)

</code></pre>

<hr>
<h2 id='vcov'>Methods for vcov</h2><span id='topic+vcov'></span><span id='topic+vcov+2Cpim-method'></span><span id='topic+vcov+2Clist-method'></span>

<h3>Description</h3>

<p>This package defines an S4 generic for <code><a href="stats.html#topic+vcov">vcov</a></code> and methods for list and pim classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcov(object, ...)

## S4 method for signature 'pim'
vcov(object, ...)

## S4 method for signature 'list'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov_+3A_object">object</code></td>
<td>
<p>any object.</p>
</td></tr>
<tr><td><code id="vcov_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variance-covariance matrix
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code> in the stats package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FEVData)
Model &lt;- pim(FEV~ Age + Smoke*Sex , data=FEVData)
vcov(Model)
</code></pre>

<hr>
<h2 id='vcov.estimators'>vcov estimators for pim</h2><span id='topic+vcov.estimators'></span><span id='topic+sandwich.vcov'></span><span id='topic+score.vcov'></span>

<h3>Description</h3>

<p><code>sandwich.vcov</code> and <code>score.vcov</code> are two similar estimators
for the variance-covariance matrix of a probabilistic index model.
These functions are meant to be used within a call to <code><a href="#topic+pim">pim</a></code>
as a value for the argument <code>vcov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sandwich.vcov(fitted, X, Y, W, link, poset, ...)

score.vcov(fitted, X, Y, W, link, poset, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.estimators_+3A_fitted">fitted</code></td>
<td>
<p>The fitted values (calculated as <code>X %*% coef</code> with
<code>X</code> the design matrix and <code>coef</code> the coefficients)</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_x">X</code></td>
<td>
<p>the design matrix</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_y">Y</code></td>
<td>
<p>a numeric vector with pseudoresponses</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_w">W</code></td>
<td>
<p>a numeric vector with weights. If weights are not applicable,
set to <code>NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_link">link</code></td>
<td>
<p>a character vector with the link function</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_poset">poset</code></td>
<td>
<p>a list with the left and right indices. See <code><a href="#topic+poset">poset</a></code>
for more information.</p>
</td></tr>
<tr><td><code id="vcov.estimators_+3A_...">...</code></td>
<td>
<p>arguments passed to downstream methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You can create your own estimating functions for the variance-covariance
matrix. To do so, you have to make sure that your function allows for
the exact same arguments. As the function <code>pim.fit</code> calculates the
fitted values already, there's no need to incorporate the calculation of
these inside the function.
</p>


<h3>Value</h3>

<p>the variance-covariance matrix
</p>


<h3>Note</h3>

<p>You should only use <code>score.vcov</code> in combination with an 
identity link
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sandwich.estimator">sandwich.estimator</a></code> for more information on the
actual fitting process. <code><a href="#topic+pim">pim</a></code> for a few examples in how
these are used
</p>

<hr>
<h2 id='vcov.internal'>Internal functions for vcov estimation</h2><span id='topic+vcov.internal'></span><span id='topic+U.sandwich'></span><span id='topic+U.score'></span>

<h3>Description</h3>

<p>These functions serve as preparation functions to calculute the variance-
covariance matrix of a pim using any of the <code><a href="#topic+vcov.estimators">vcov.estimators</a></code>
provided in this package. The result of these preparation functions
is used by the <code><a href="#topic+sandwich.estimator">sandwich.estimator</a></code> and 
<code><a href="#topic+score.estimator">score.estimator</a></code> functions respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>U.sandwich(Zbeta, Z, Y, link, W = NULL)

U.score(Zbeta, Z, Y, link, W = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.internal_+3A_zbeta">Zbeta</code></td>
<td>
<p>fitted values</p>
</td></tr>
<tr><td><code id="vcov.internal_+3A_z">Z</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="vcov.internal_+3A_y">Y</code></td>
<td>
<p>pseudo responses</p>
</td></tr>
<tr><td><code id="vcov.internal_+3A_link">link</code></td>
<td>
<p>character vector with link function</p>
</td></tr>
<tr><td><code id="vcov.internal_+3A_w">W</code></td>
<td>
<p>vector with weights</p>
</td></tr>
</table>


<h3>Note</h3>

<p>These functions should NOT be called by the user
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
