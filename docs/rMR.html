<!DOCTYPE html><html><head><title>Help for package rMR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rMR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#background.resp'>
<p>Determine the Background Respiration in a Respirometer</p></a></li>
<li><a href='#Barom.Press'>
<p>Estimate Barometric Pressure</p></a></li>
<li><a href='#DO.saturation'>
<p>Calculate Oxygen Saturation of Water</p></a></li>
<li><a href='#DO.unit.convert'>
<p>Convert Between Different Common Units of DO Concentration</p></a></li>
<li><a href='#Eq.Ox.conc'>
<p>Equilibrium Concentration of Dissolved Oxygen in Water</p></a></li>
<li><a href='#fishMR'>
<p>Gnathonemus Respirometry Trial Data</p></a></li>
<li><a href='#get.pcrit'>
<p>Calculate Critical Tension for Rate Processes</p></a></li>
<li><a href='#get.witrox.data'>
<p>Load Data from 'AutoResp' Software Generated .txt Files</p></a></li>
<li><a href='#MR.loops'>
<p>Calculate Metabolic Rates from Multiple Closed Respirometry Loops</p></a></li>
<li><a href='#plotRaw'>
<p>Plotting Data from Witrox</p></a></li>
<li><a href='#rMR-package'>
<p>Importing Data from Loligo Systems Software Output, Calculating Metabolic Rates and Critical Tensions</p></a></li>
<li><a href='#sumsq'>
<p>Sum of squares</p></a></li>
<li><a href='#tot.rss'>
<p>Total Residual Sum of Squares for Broken Stick Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Importing Data from Loligo Systems Software, Calculating
Metabolic Rates and Critical Tensions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-01-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Tyler L. Moulton</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tyler L. Moulton &lt;tyler.moulton@cortland.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of oxygen consumption data generated by Loligo (R) Systems respirometry equipment. The package includes a function for loading data output by Loligo's 'AutoResp' software (get.witrox.data()), functions for calculating metabolic rates over user-specified time intervals, extracting critical points from data using broken stick regressions based on Yeager and Ultsch (&lt;<a href="https://doi.org/10.1086%2Fphyszool.62.4.30157935">doi:10.1086/physzool.62.4.30157935</a>&gt;), and easy functions for converting between different units of barometric pressure.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), biglm</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-21 02:31:24 UTC; Tyler Moulton</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-21 16:47:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='background.resp'>
Determine the Background Respiration in a Respirometer
</h2><span id='topic+background.resp'></span>

<h3>Description</h3>

<p>Takes user-defined start and end times to calculate the backround respiration rate in a respirometer. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>background.resp(data, DO.var.name,
time.var.name = "std.time", 
start.time, end.time, col.vec = c("black","red"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="background.resp_+3A_data">data</code></td>
<td>

<p><code>data.frame</code> object to be used, best if formatted by <code>get.witrox.data()</code>. 
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_do.var.name">DO.var.name</code></td>
<td>

<p>Column name of DO variable, formatted as a character string.
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_time.var.name">time.var.name</code></td>
<td>

<p>Column name of time variable as character string. Time column must be formatted as default class for datetime: <code>class = "POSIXct" "POSIXt"</code>, <code>strptime</code> format = <code>"%Y-%m-%d %H:%M:%S"</code>.
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_start.time">start.time</code></td>
<td>

<p>Input start time as character string of <code>strptime</code> format = <code>"%Y-%m-%d %H:%M:%S"</code>.
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_end.time">end.time</code></td>
<td>

<p>Input endtime as character string of <code>strptime</code> format = <code>"%Y-%m-%d %H:%M:%S"</code>.
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_col.vec">col.vec</code></td>
<td>

<p>Specifies colors on plot in the following order: 1) scatterplot points, 2) regression color.
</p>
</td></tr>
<tr><td><code id="background.resp_+3A_...">...</code></td>
<td>

<p>Passes on arguments to internal functions.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of method <code>biglm</code>. The slope of this funtion is the metabolic rate in input units/(default time).
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Thomas Lumley (2013). biglm: bounded memory linear and generalized linear models. R package version 0.9-1. <a href="https://CRAN.R-project.org/package=biglm">https://CRAN.R-project.org/package=biglm</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>,
<code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="biglm.html#topic+biglm">biglm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load data##
data(fishMR)

## create time variable in POSIXct format ##
fishMR$std.time &lt;- as.POSIXct(fishMR$Date.time,
                    format = "%d/%m/%Y %I:%M:%S %p")

bgd.resp &lt;- 
background.resp(fishMR, "DO.mgL", 
           start.time = "2015-07-02 16:05:00",
           end.time = "2015-07-02 16:35:00")
</code></pre>

<hr>
<h2 id='Barom.Press'>
Estimate Barometric Pressure
</h2><span id='topic+Barom.Press'></span>

<h3>Description</h3>

<p>Function to estimate barometric pressure based on altitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Barom.Press(elevation.m, units = "atm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Barom.Press_+3A_elevation.m">elevation.m</code></td>
<td>

<p>Elevation in meters above sea level.
</p>
</td></tr>
<tr><td><code id="Barom.Press_+3A_units">units</code></td>
<td>

<p>Output units for barometric pressure must be one of: <code>"atm"</code>, <code>"kpa"</code>, or <code>"mmHg"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is just a simple conversion function. Plug and chug, as they say...
</p>


<h3>Value</h3>

<p>Returns numeric object of barometric pressure in specified units.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Mechtly, E. A., 1973: The International System of Units, Physical Constants and Conversion Factors. NASA SP-7012, Second Revision, National Aeronautics and Space Administration, Washington, D.C. <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf">https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf</a>.
</p>
<p>U.S. Geological Survey (2011). Change to solubility equations for oxygen in water: Office of Water Quality Technical Memorandum 2011.03, accessed July 15, 2011, at <a href="http://water.usgs.gov/admin/memo/QW/qw11.03.pdf">http://water.usgs.gov/admin/memo/QW/qw11.03.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bar.pressure1 &lt;- Barom.Press(elevation.m = 1000) # returns "atm"
bar.pressure2 &lt;- Barom.Press(elevation.m = 1000, "kpa")
bar.pressure3 &lt;- Barom.Press(elevation.m = 1000, "mmHg")
</code></pre>

<hr>
<h2 id='DO.saturation'>
Calculate Oxygen Saturation of Water
</h2><span id='topic+DO.saturation'></span>

<h3>Description</h3>

<p>Calculate the percent saturation of oxygen in water given external temperature, barometric pressure, and recorded DO concentration in mg/L.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DO.saturation(DO.mgl, temp.C,
elevation.m = NULL, bar.press = NULL,
bar.units = NULL,
salinity, salinity.units)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DO.saturation_+3A_do.mgl">DO.mgl</code></td>
<td>

<p>Recorded DO concentration in mg/L.
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_temp.c">temp.C</code></td>
<td>

<p>Temperature in degrees C.
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_elevation.m">elevation.m</code></td>
<td>

<p>Elevation in meters above sea level. EITHER <code>elevation.m</code> or <code>bar.press</code> must be specified.
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_bar.press">bar.press</code></td>
<td>

<p>Barometric pressure in user defined units (bar.units)&ndash;defaults to <code>NULL</code>. EITHER <code>elevation.m</code> or <code>bar.press</code> must be specified.
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_bar.units">bar.units</code></td>
<td>

<p>Units of barometric pressure, defaults to <code>NULL</code>. must be <code>"atm"</code>, <code>"kpa"</code> or <code>"mmHg"</code>
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_salinity">salinity</code></td>
<td>

<p>Salinity, either reported in parts per thousand (<code>"pp.thou"</code>) or microsiemens/cm (<code>"us"</code>). 
</p>
</td></tr>
<tr><td><code id="DO.saturation_+3A_salinity.units">salinity.units</code></td>
<td>

<p>Salinity units, must be <code>"pp.thou"</code> or <code>"us"</code> 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns numeric value of dissolved oxygen saturation.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Mechtly, E. A., 1973: The International System of Units, Physical Constants and Conversion Factors. NASA SP-7012, Second Revision, National Aeronautics and Space Administration, Washington, D.C. <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf">https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf</a>.
</p>
<p>U.S. Geological Survey (2011). Change to solubility equations for oxygen in water: Office of Water Quality Technical Memorandum 2011.03, accessed July 15, 2011, at <a href="http://water.usgs.gov/admin/memo/QW/qw11.03.pdf">http://water.usgs.gov/admin/memo/QW/qw11.03.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Eq.Ox.conc">Eq.Ox.conc</a></code>,
<code><a href="#topic+DO.unit.convert">DO.unit.convert</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DO.sat1 &lt;- DO.saturation(DO.mgl = 5.5,
temp.C = 20, elevation.m = 1000)

DO.sat2 &lt;- DO.saturation(DO.mgl = 5.5,
temp.C = 20, bar.press = 674.1, bar.units = "mmHg")

DO.sat1
DO.sat2

# Will ya look at that...
</code></pre>

<hr>
<h2 id='DO.unit.convert'>
Convert Between Different Common Units of DO Concentration
</h2><span id='topic+DO.unit.convert'></span>

<h3>Description</h3>

<p>Converts between different different units of DO concentration. Takes into account ambient temperature, pressure and salinity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DO.unit.convert(x, DO.units.in, DO.units.out, bar.units.in,
bar.press, temp.C, bar.units.out = "mmHg",
salinity = 0, salinity.units = "pp.thou")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DO.unit.convert_+3A_x">x</code></td>
<td>

<p>Value or object of class numeric to be converted.
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_do.units.in">DO.units.in</code></td>
<td>

<p>Units of dissolved oxygen concentration measured, i.e. to be converted from. Must be <code>"mg/L"</code>, <code>"PP"</code> (partial pressure), or <code>"pct"</code> (percent). If <code>"PP"</code>, the units of partial pressure must be equal to <code>bar.units.in</code>.
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_do.units.out">DO.units.out</code></td>
<td>

<p>Units of dissolved oxygen concentration desired, i.e. to be converted to. Must be <code>"mg/L"</code>, <code>"PP"</code>, or &quot;pct&quot;.
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_bar.units.in">bar.units.in</code></td>
<td>

<p>Units of barometric pressure of user specified barometric pressure measurement. Must take value of <code>"atm"</code>, <code>"kpa"</code>, or <code>"mmHg"</code>.
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_bar.press">bar.press</code></td>
<td>

<p>Ambient barometric pressure measurement
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_temp.c">temp.C</code></td>
<td>

<p>Water temperature measured in degrees C
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_bar.units.out">bar.units.out</code></td>
<td>

<p>Used in internal calculation, only visible if output DO.units.out = <code>"PP"</code>. Must take value of <code>"atm"</code>, <code>"kpa"</code>, or <code>"mmHg"</code>.
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_salinity">salinity</code></td>
<td>

<p>Salinity, either reported in parts per thousand (<code>"pp.thou"</code>) or microsiemens/cm (<code>"us"</code>) 
</p>
</td></tr>
<tr><td><code id="DO.unit.convert_+3A_salinity.units">salinity.units</code></td>
<td>

<p>Salinity units, must be <code>"pp.thou"</code> or <code>"us"</code> 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric object representing dissolved oxygen concentration in the units specified by <code>DO.units.out</code>. 
</p>


<h3>Note</h3>

<p>Use this function on entire data columns to convert them to desired units before analysing with functions like <code>MR.loops</code> and <code>get.pcrit</code>.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Mechtly, E. A., 1973: The International System of Units, Physical Constants and Conversion Factors. NASA SP-7012, Second Revision, National Aeronautics and Space Administration, Washington, D.C. <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf">https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf</a>.
</p>
<p>U.S. Geological Survey (2011). Change to solubility equations for oxygen in water: Office of Water Quality Technical Memorandum 2011.03, accessed July 15, 2011, at <a href="http://water.usgs.gov/admin/memo/QW/qw11.03.pdf">http://water.usgs.gov/admin/memo/QW/qw11.03.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>, 
<code><a href="#topic+plotRaw">plotRaw</a></code>, 
<code><a href="base.html#topic+cbind">cbind</a></code>, 
<code><a href="#topic+Eq.Ox.conc">Eq.Ox.conc</a></code>, 
<code><a href="#topic+DO.saturation">DO.saturation</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## on a single value ##

DO.pct&lt;- DO.unit.convert(x= 125.6863, DO.units.in = "PP",
                DO.units.out = "pct",
                bar.units.in = "mmHg", bar.press = 750, temp.C =15)

## Apply to a column in a 'data.frame' class object ## 

## load data ##
data(fishMR)

## create time variable in POSIXct format ##
fishMR$std.time &lt;- as.POSIXct(fishMR$Date.time,
                    format = "%d/%m/%Y %I:%M:%S %p")

head(fishMR)

#note that DO data are in mg/L (DO.mgL) and
#that there is an instantaneous temperature column
#(temp.C) and a pressure column (Bar.Pressure.hpa)

DO.pct.col.a &lt;- DO.unit.convert(fishMR$DO.mgL, DO.units.in = "mg/L",
                DO.units.out = "pct",
                bar.units.in = "kpa", bar.press = 101.3,
                temp.C = fishMR$temp.C,
                bar.units.out = "kpa")
DO.pct.col.b&lt;- DO.unit.convert(fishMR$DO.mgL, DO.units.in = "mg/L",
                DO.units.out = "pct",
                bar.units.in = "kpa", bar.press = 101.3,
                temp.C = fishMR$temp.C)
head(DO.pct.col.a)
head(DO.pct.col.b)

# Now with df #

fishMR2 &lt;- as.data.frame(cbind(fishMR, DO.pct.col.a))

par(mfrow = c(1,2))
plotRaw(data = fishMR, DO.var.name = "DO.mgL",
          start.time = "2015-07-03 06:15:00",
          end.time = "2015-07-03 08:05:00",
          main = "DO (mg/L) vs time",
          xlab = "time",
          ylab = "DO (mg/L)")
          

plotRaw(data = fishMR2, DO.var.name = "DO.pct.col.a",
          start.time = "2015-07-03 06:15:00",
          end.time = "2015-07-03 08:05:00",
          main = "DO (percent saturation) vs time",
          xlab = "time",
          ylab = "DO (percent saturation)")
</code></pre>

<hr>
<h2 id='Eq.Ox.conc'>
Equilibrium Concentration of Dissolved Oxygen in Water
</h2><span id='topic+Eq.Ox.conc'></span>

<h3>Description</h3>

<p>Determines equilibrium dissolved oxygen concentration in water based on pressure and temperature. An estimate for barometric pressure can be generated by supplying the temperature and elevation (calculation by <code>Barom.Press()</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Eq.Ox.conc(temp.C, elevation.m = NULL, 
bar.press = NULL, bar.units = "mmHg", 
out.DO.meas = "mg/L", 
salinity = 0, salinity.units = "pp.thou")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Eq.Ox.conc_+3A_temp.c">temp.C</code></td>
<td>

<p>Water temperature in degrees C
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_elevation.m">elevation.m</code></td>
<td>

<p>Elevation in meters. Default = <code>NULL</code>. Must be <code>NULL</code> if <code>bar.press</code> takes a value.
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_bar.press">bar.press</code></td>
<td>

<p>Barometric pressure. Default = <code>NULL</code>. Must be <code>NULL</code> if <code>elevation.m</code> takes a value.
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_bar.units">bar.units</code></td>
<td>

<p>Units of barometric pressure for value supplied in bar.press. Must be <code>NULL</code>, <code>"atm"</code>, <code>"kpa"</code>, or<code>"mmHg"</code>.
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_out.do.meas">out.DO.meas</code></td>
<td>

<p>Units of dissolved oxygen concentration 
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_salinity">salinity</code></td>
<td>

<p>Salinity, either reported in parts per thousand (<code>"pp.thou"</code>) or microsiemens/cm (<code>"us"</code>) 
</p>
</td></tr>
<tr><td><code id="Eq.Ox.conc_+3A_salinity.units">salinity.units</code></td>
<td>

<p>Salinity units, must be <code>"pp.thou"</code> or <code>"us"</code>. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns object of class numberic of full equilibrium dissolved oxygen concentration.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Benson, B.B., and Daniel Krause, Jr (1980). The concentration and isotopic fractionation of gases dissolved in freshwater in equilibrium with the atmosphere. 1. Oxygen: Limnology and Oceanography, vol. 25, no. 4, p. 662-671. <a href="http://doi.org/10.4319/lo.1980.25.4.0662">doi: 10.4319/lo.1980.25.4.0662</a>.
</p>
<p>Gnaiger, Erich, and Hellmuth Forstner, eds. Polarographic oxygen sensors: Aquatic and physiological applications. Springer Science &amp; Business Media, 2012. <a href="http://doi.org/10.1007/978-3-642-81863-9">doi: 10.1007/978-3-642-81863-9</a>.
</p>
<p>Mechtly, E. A., 1973: The International System of Units, Physical Constants and Conversion Factors. NASA SP-7012, Second Revision, National Aeronautics and Space Administration, Washington, D.C. <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf">https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf</a>.
</p>
<p>U.S. Geological Survey (2011). Change to solubility equations for oxygen in water: Office of Water Quality Technical Memorandum 2011.03, accessed July 15, 2011, at <a href="http://water.usgs.gov/admin/memo/QW/qw11.03.pdf">http://water.usgs.gov/admin/memo/QW/qw11.03.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DO.saturation">DO.saturation</a></code>
<code><a href="#topic+DO.unit.convert">DO.unit.convert</a></code>
<code><a href="#topic+Barom.Press">Barom.Press</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eqO2.1 &lt;- Eq.Ox.conc(temp.C = 20, elevation.m = 1000, bar.units = NULL)

eqO2.2 &lt;- Eq.Ox.conc(temp.C = 20,
bar.press = 674.1, bar.units = "mmHg")

eqO2.1
eqO2.2

</code></pre>

<hr>
<h2 id='fishMR'>
Gnathonemus Respirometry Trial Data
</h2><span id='topic+fishMR'></span>

<h3>Description</h3>

<p>This is a dataset acquired duirng a respirometry trial on a mormyrid of the species Gnathonemus victoriae. It went great. There are several &quot;loops&quot; (open/close the respirometer) to establish routine metabolic rate, as well as an extended &quot;closed&quot; period to capture the &quot;P.crit&quot;, the point at which the linear relationship between metabolic rate and ambient dissolved oxygen changed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fishMR)</code></pre>


<h3>Format</h3>

<p>A data frame with 64239 observations on the following 7 variables.
</p>

<dl>
<dt><code>Date.time</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>times</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Bar.Pressure.hpa</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Phase</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>temp.C</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>DO.mgL</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>References</h3>

<p>Moulton Tyler L., Chapman Lauren J., Krahe Rudiger. Manuscript in Prep.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fishMR)
str(fishMR)
head(fishMR) 
</code></pre>

<hr>
<h2 id='get.pcrit'>
Calculate Critical Tension for Rate Processes
</h2><span id='topic+get.pcrit'></span>

<h3>Description</h3>

<p>Determines the critical point of a rate process based on the broken stick model featured in Yeager and Ultsch (1989). The two regressions are selected based on the break point which minimizes the total residual sum of squares. The rate process that this package is designed for is metabolic rate (<code>MR.var.name</code>), and it is regressed on ambient dissolved oxygen concentration (<code>DO.var.name</code>). However, the same function can be used for other processes. 
</p>
<p>If metabolic rate has not already been calculated and the user wishes to calculate metabolic rates directly from oxygen concentration measurements, let <code>MR.var.name= NULL</code>. Then indicate the name of the time variable AND the time interval (i.e. the width of the time window over which you will estimate instantaneous metabolic rates).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.pcrit(data, DO.var.name, MR.var.name = NULL, Pcrit.below,
             time.interval, time.var = NULL,
             start.time, stop.time, time.units = "sec",
             Pcrit.type = "both", syst.vol = NULL,
             col.vec = c("black", "gray60", "red", "blue"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.pcrit_+3A_data">data</code></td>
<td>

<p>Data to be used.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_do.var.name">DO.var.name</code></td>
<td>

<p>Variable name of oxygen concentration variable, formatted as character string. To be used for determination of critical point. If using pre-calculated instantaneous metabolic rates (MR) to conduct Pcrit, this should be specified by <code>MR.var.name</code>. If using raw oxygen values with time stamps to compute instantaneous MR within the function, <code>get.pcrit</code> requires <code>time.interval</code> to be specified.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_mr.var.name">MR.var.name</code></td>
<td>

<p>Metabolic rate variable name, formatted as character. Default = <code>NULL</code>. If this argument takes a value, Pcrit will be calculated by regressing <code>MR.var.name</code> on <code>DO.var.name</code>. <code>time.var</code> and time.interval should, in this case, take no value. If <code>MR.var.name</code> is left as<code>NULL</code>, then instantaneous metabolic rates (MR) at specified time intervals (see <code>time.interval</code>) from <code>DO.var.name</code> and <code>time.var</code>.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_pcrit.below">Pcrit.below</code></td>
<td>

<p>DO concentration below which you are confident that Pcrit occurs. Accelerates process by reducing the number of iterations required to find Pcrit. Data points featuring DO conc &gt; <code>Pcrit.below</code> are still used to calculate regressions for model.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_time.interval">time.interval</code></td>
<td>

<p>If <code>MR.var.name = NULL</code>, specify interval in seconds over which to calculate instantaneous MR.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_time.var">time.var</code></td>
<td>

<p>Column name for indexing (time) variable used to calculate instantaneous Metabolic Rate (MR) from oxygen concentration data (specified by <code>DO.var.name</code>). Must be a character string.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_start.time">start.time</code></td>
<td>

<p>Beginning of time interval over which to evaluate data for Pcrit. Required if <code>MR.var.name = NULL</code>. Must be character string in the default <code>POSIXct</code> format (matches format of <code>time.var</code>).
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_stop.time">stop.time</code></td>
<td>

<p>End of time interval over which to evaluate data for Pcrit. Required if <code>MR.var.name = NULL</code>. Must be character string in the default <code>POSIXct</code> format (matches format of <code>time.var</code>).
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_time.units">time.units</code></td>
<td>

<p>Units of time in MR calculation. Defaults to <code>"sec"</code>, must be <code>"sec"</code>, <code>"min"</code>, or <code>"hr"</code>. Required if <code>MR.var.name = NULL</code>.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_pcrit.type">Pcrit.type</code></td>
<td>

<p>Either <code>"lm"</code> to draw a vertical line at the Pcrit as determined by the intersection point of the best fit lines(Yeager and Ultsch 1989) or <code>"midpoint"</code> as determined by the midpoint between the two points on either side of the Pcrit (Yeager and Ultsch 1989). <code>"both"</code> will plot both as vertical lines on the plot. NULL will plot neither. Both values are returned in the output.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_syst.vol">syst.vol</code></td>
<td>

<p>Enter the system volume in Liters. If <code>syst.vol</code> takes a value, then an additional column, <code>MR.vol.adj</code> will be added to <code>$DATA</code>. The values in this colum will reflect mg of oxygen consumed. Otherwise, the returned MR variable (and in <code>data</code>) on the y axis of the plot will represent <code>DO.var.name</code> units/time.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_...">...</code></td>
<td>

<p>Arguments passed on to internal functions.
</p>
</td></tr>
<tr><td><code id="get.pcrit_+3A_col.vec">col.vec</code></td>
<td>

<p>Specifies colors on plot in the following order: 1) scatterplot points representing instantaneous MR, 2) regression lines color, 3) vertical line representing Pcrit using the intersect method (<code>Pcrit.type = "lm"</code>), 4)vertical line representing Pcrit using the midpoint method (<code>Pcrit.type = "midpoint"</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calculates the critical oxygen tension for a change in metabolic rate. It is a simple broken stick model which evaluates the data at dissolved oxygen values recorded within the specified time frame. The data of MR and DO are ordered by decreasing DO value. Then, the function iteratively calculates the total residual sum of squares (using <code>tot.rss</code>) of two linear models, one spanning from <code>Pcrit.below</code> to <code>Pcrit.below</code> - i, the other with a range from the minimum DO value to <code>Pcrit.below</code> - (i + 1). The broken stick model resulting in the lowest total residual sum of squares is selected. 
</p>


<h3>Value</h3>

<p>A scatterplot of MR ~ DO is generated with the two regression lines (in gray). Also returns a list of 6. <code>$Pcrit.lm</code> is the Pcrit given by the intersection of the two best fit lines (vertical red dashed line). <code>$Pcrit.mp</code> is the Pcrit using the midpoint method (vertical blue dotted vertical line). <code>$P$Adj.r2.above</code> gives the adjusted R2 value of the relationship between MR~DO above the critical point, and likewise, <code>$Adj.r2.below</code> gives the R2 below the critical point. The other two elements are <code>lm</code> class objects calculated from the regression slopes above and below the break point in the broken stick model (which is not necessarily the same point as where the regression lines intersect!).
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>Yeager, D. P. and Ultsch, G. R. (1989). Physiological regulation and conformation: a BASIC program for the determination of critical points. Physiological Zoology, 888-907. <a href="http://doi.org/10.1086/physzool.62.4.30157935">doi: 10.1086/physzool.62.4.30157935</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tot.rss">tot.rss</a></code>,
<code><a href="base.html#topic+strptime">strptime</a></code>, 
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## set data ##
data(fishMR)

## create time variable in POSIXct format ##
fishMR$std.time &lt;- as.POSIXct(fishMR$Date.time,
                    format = "%d/%m/%Y %I:%M:%S %p")
                    
Pcrit1 &lt;-get.pcrit(data = fishMR, DO.var.name = "DO.mgL",
                    Pcrit.below = 2,
                    time.var = "std.time",
                    time.interval = 120,
                    start.time = "2015-07-03 06:15:00",
                    stop.time = "2015-07-03 08:05:00")
## MR units in mgO2 / sec
            
## Change time interval ##
Pcrit2 &lt;-get.pcrit(data = fishMR, DO.var.name = "DO.mgL",
                    Pcrit.below = 2,
                    time.var = "std.time",
                    time.interval = 60,
                    start.time = "2015-07-03 06:15:00",
                    stop.time = "2015-07-03 08:05:00",
                    time.units = "min")
## MR units in mgO2 / min


Pcrit3 &lt;-get.pcrit(data = fishMR, DO.var.name = "DO.mgL",
                    Pcrit.below = 2,
                    time.var = "std.time",
                    time.interval = 60,
                    start.time = "2015-07-03 06:15:00",
                    stop.time = "2015-07-03 08:05:00",
                    time.units = "hr",
                    ylab = "Met Rate (mg O2 L-1 hr-1)")
## MR units in mgO2 / hr

## syst vol specified at 0.75 L ##

Pcrit3a &lt;-get.pcrit(data = fishMR, DO.var.name = "DO.mgL",
                    Pcrit.below = 2,
                    time.var = "std.time",
                    time.interval = 60,
                    start.time = "2015-07-03 06:15:00",
                    stop.time = "2015-07-03 08:05:00",
                    time.units = "hr",
                    syst.vol = 0.75,
                    ylab = "Met Rate (mg O2 / hr)")
## MR units in mgO2 / hr

## No vertical lines on plot

Pcrit4 &lt;-get.pcrit(data = fishMR, DO.var.name = "DO.mgL",
                    Pcrit.below = 2,
                    time.var = "std.time",
                    time.interval = 60,
                    start.time = "2015-07-03 06:15:00",
                    stop.time = "2015-07-03 08:05:00",
                    time.units = "hr",
                    ylab = "Met Rate (mg O2 L-1 hr-1)",
                    Pcrit.type = "")
                    

</code></pre>

<hr>
<h2 id='get.witrox.data'>
Load Data from 'AutoResp' Software Generated .txt Files
</h2><span id='topic+get.witrox.data'></span>

<h3>Description</h3>

<p>Allows user to import data from Loligo (R) Systems' 'Autoresp' software-generated text files into a R data.frame (class <code>data.frame</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.witrox.data(data.name, lines.skip, delimit = "tab", 
choose.names = F, chosen.names = NULL, 
format)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.witrox.data_+3A_data.name">data.name</code></td>
<td>

<p>Full data file name as character string.
</p>
</td></tr>
<tr><td><code id="get.witrox.data_+3A_lines.skip">lines.skip</code></td>
<td>

<p>The lines in the header to be skipped. If <code>choose.names = FALSE</code>, then skip all lines up to the column names. If <code>choose.names =TRUE</code>, skip all lines including column names.
</p>
</td></tr>
<tr><td><code id="get.witrox.data_+3A_delimit">delimit</code></td>
<td>

<p>Choose the delimiter. Defaults to tab delimited. Can take values of <code>"tab"</code>, <code>"space"</code>, or <code>"comma"</code>. If importing from an excel file, save the file as a .csv file, then use the delimiter argument <code>"comma"</code>
</p>
</td></tr>
<tr><td><code id="get.witrox.data_+3A_choose.names">choose.names</code></td>
<td>

<p>logical: if <code>FALSE</code>, then names are automatically derived from the names of the text file. Sometimes, this can be a problem if there are tabs or commas included in odd places in the column name line of the text file. If <code>TRUE</code>, user must specify a vector of column names&ndash;see <code>lines.skip</code> and <code>chosen.names</code>. 
</p>
</td></tr>
<tr><td><code id="get.witrox.data_+3A_chosen.names">chosen.names</code></td>
<td>

<p>If <code>choose.names = TRUE</code>, chosen.names must be a vector of character strings for use as <code>column.names</code>.
</p>
</td></tr>
<tr><td><code id="get.witrox.data_+3A_format">format</code></td>
<td>

<p>This is the format that the date-time column is formatted in by auto resp&ndash;This must be the FIRST COLUMN. The default format is <code>"%d/%m/%Y %I:%M:%S %p"</code>. Another common format is <code>"%d/%m/%Y/%I:%M:%S %p"</code>. See <code><a href="base.html#topic+strptime">strptime</a></code> for more directions on formatting the date and time.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class data.frame, with <code>std.time</code> as the last column, which is in the default standard <code>POSIXct</code> date-time format.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+strptime">strptime</a></code>, 
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Requires a text file. Download fish_MR.txt from github repository and
# accompanying readme file at:
# https://github.com/tyler-l-moulton/rMR

</code></pre>

<hr>
<h2 id='MR.loops'>
Calculate Metabolic Rates from Multiple Closed Respirometry Loops
</h2><span id='topic+MR.loops'></span>

<h3>Description</h3>

<p>This function calculates the metabolic rates from multiple closed respirometry loops simultaneously. Requires lots of user input, but is easy to manipulate. Returns list of metabolic rates, as well as the average metabolic rate and the standard deviation of the sample of metabolic rates, as well as biglm objects for each section of data used to calculate MRs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MR.loops(data, DO.var.name, time.var.name = "std.time",
             in.DO.meas = "mg/L", out.DO.meas = "mg/L",
             start.idx, stop.idx, syst.vol = 1,
             background.consumption = 0,
             background.indices = NULL,
             temp.C, elevation.m = NULL,
             bar.press = NULL, bar.units = "atm",
             PP.units, time.units = "sec",
             col.vec = c("black","red"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MR.loops_+3A_data">data</code></td>
<td>

<p>Must include a time variable in standard <code>POSIXct</code> format. eg 
<code>"2016-09-25 15:30:00 EST"</code>.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_do.var.name">DO.var.name</code></td>
<td>

<p>Column name of DO variable, must be entered as character string.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_time.var.name">time.var.name</code></td>
<td>

<p>Column name of time variable (which is in <code>POSIXct</code> format) as character. defaults to &quot;std.time&quot; as generated from <code>get.witrox.data()</code>.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_in.do.meas">in.DO.meas</code></td>
<td>

<p>Units of DO measurement entered in the DO variable column: must be one of <code>"mg/L"</code> for miligrams/liter, <code>"PP"</code> for partial pressure, <code>"pct"</code> for saturation percent.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_out.do.meas">out.DO.meas</code></td>
<td>

<p>Units of DO measurement returned for metabolic rate: must be one of <code>"mg/L"</code> for miligrams/liter, <code>"PP"</code> for partial pressure (units determined by <code>bar.units</code>), <code>"pct"</code> for saturation percent.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_start.idx">start.idx</code></td>
<td>

<p>Character class value or vector matching <code>POSIXct</code> object coding for date time. Each element of the vector represents the start time of a new loop for calculation of metabolic rates.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_stop.idx">stop.idx</code></td>
<td>

<p>Character class value or vector matching <code>POSIXct</code> object coding for date time. Each element of the vector represents the stop time of a new loop for calculation of metabolic rates.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_syst.vol">syst.vol</code></td>
<td>

<p>System volume in Liters (defaults to 1 L).
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_background.consumption">background.consumption</code></td>
<td>

<p>Default = 0. If using a one point calibration for background, simply set <code>background.consumption</code> equal to the value of the calculated respiration rate. If using a multi-point calibration, enter a vector of background respiration rates, and enter a corresponding vector for <code>background.indices</code>. CAUTION: The slope must be entered in raw units  (i.e. those specified in the input data.frame in the <code>data</code> argument). For example, if the <code>DO.var.name column</code> is recorded in &quot;mg/L&quot;, and the <code>POSIXct</code> format goes to the resolution of seconds, background consumption units would need to be entered in mgO2 / sec. 
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_background.indices">background.indices</code></td>
<td>

<p>If using a multi-point calibration to set the background respiration rate, enter a vector of times for when the respiration rates were calculated. There should be one time point per corresponding value in <code>background.consumption</code>. The background respiration rate is continually factored into all calculations of metabolic rate. The elements of the vector must entered as character strings conforming to the <code>POSIXct</code>format specified in the <code>time.var.name</code> column.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_temp.c">temp.C</code></td>
<td>

<p>Water temperature in degrees C.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_elevation.m">elevation.m</code></td>
<td>

<p>Elevation in m. Only required if <code>bar.press = NULL</code>.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_bar.press">bar.press</code></td>
<td>

<p>barometric pressure in units defined by bar.units argument. Only required if <code>elevation.m = NULL</code>.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_bar.units">bar.units</code></td>
<td>

<p>Units of barometric pressure used as input and in output if <code>DO.meas.out = "PP"</code>. Acceptable arguments: &quot;mmHg&quot;, &quot;atm&quot;, &quot;kpa&quot;.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_pp.units">PP.units</code></td>
<td>

<p>Units of barometric pressure used for &quot;PP&quot;. 
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_time.units">time.units</code></td>
<td>

<p>Denominator for metabolic rate, also displayed as units on X-axis. Acceptable arguments: &quot;hr&quot;, &quot;min&quot;, &quot;sec&quot;.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_col.vec">col.vec</code></td>
<td>

<p>Specifies colors on plot in the following order: 1) scatterplot points, 2) regression lines color.
</p>
</td></tr>
<tr><td><code id="MR.loops_+3A_...">...</code></td>
<td>

<p>Arguments passed on to internal functions
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of 2. <code>$MR.summary</code> is of class data.frame with 3 columns: <code>$MR</code> (metabolic rate in user specified units, this is the same as the slope in each linear model), <code>$sd.slope</code> (standard deviation of slopes calculation), <code>$r.square</code> (adjusted r square value from each model). This second object is a list of <code>biglm</code> objects, each one representing a metabolic loop (see McDonnell and Chapman 2016). 
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>References</h3>

<p>McDonnell, Laura H., and Lauren J. Chapman (2016). &quot;Effects of thermal increase on aerobic capacity and swim performance in a tropical inland fish.&quot; Comparative Biochemistry and Physiology Part A: Molecular &amp; Integrative Physiology 199: 62-70. <a href="http://doi.org/10.1016/j.cbpa.2016.05.018">doi: 10.1016/j.cbpa.2016.05.018</a>.
</p>
<p>Roche, Dominique G., et al. (2013). &quot;Finding the best estimates of metabolic rates in a coral reef fish.&quot; Journal of Experimental Biology 216.11: 2103-2110. <a href="http://doi.org/10.1242/jeb.082925">doi: 10.1242/jeb.082925</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>,
<code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="#topic+background.resp">background.resp</a></code>,
<code><a href="#topic+Barom.Press">Barom.Press</a></code>,
<code><a href="#topic+Eq.Ox.conc">Eq.Ox.conc</a></code>,
<code><a href="biglm.html#topic+biglm">biglm</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data ##
data(fishMR)

## create time variable in POSIXct format ##
fishMR$std.time &lt;- as.POSIXct(fishMR$Date.time,
                    format = "%d/%m/%Y %I:%M:%S %p")

## calc background resp rate
bgd.resp &lt;- 
    background.resp(fishMR, "DO.mgL", 
                    start.time = "2015-07-02 16:05:00",
                    end.time = "2015-07-02 16:35:00",
                    ylab = "DO (mg/L)", xlab = "time (min)")

bg.slope.a &lt;- bgd.resp$mat[2]


starts &lt;- c("2015-07-03 01:15:00", "2015-07-03 02:13:00",
            "2015-07-03 03:02:00", "2015-07-03 03:50:00",
            "2015-07-03 04:50:00")

stops &lt;- c("2015-07-03 01:44:00", "2015-07-03 02:35:30",
           "2015-07-03 03:25:00", "2015-07-03 04:16:00",
           "2015-07-03 05:12:00")

metR &lt;- MR.loops(data = fishMR, DO.var.name ="DO.mgL",
                 start.idx = starts, time.units = "hr",
                 stop.idx = stops, time.var.name = "std.time",
                 temp.C = "temp.C", elevation.m = 1180,
                 bar.press = NULL, in.DO.meas = "mg/L", 
                 background.consumption = bg.slope.a,
                 ylim=c(6, 8))

metR$MR.summary


## now lets assume we ran a control loop for background rate
## before and after we ran the MR loops
## let:

bg.slope.b &lt;-bg.slope.a -0.0001 
metRa &lt;- MR.loops(data = fishMR, DO.var.name ="DO.mgL",
                 start.idx = starts, time.units = "hr",
                 stop.idx = stops, time.var.name = "std.time",
                 temp.C = "temp.C", elevation.m = 1180,
                 bar.press = NULL, in.DO.meas = "mg/L", 
                 background.consumption = c(bg.slope.a, bg.slope.b),
                 background.indices = c("2015-07-02 16:20:00",
                                        "2015-07-03 06:00:00"),
                 ylim=c(6, 8))


metRa$MR.summary

# note that the calculated slopes
# diverge as time increases. This is
# because the background respiration
# rate is increasing.

metR$MR.summary-metRa$MR.summary

## This looks great, but you need to check your start and
## stop vectors, otherwise, you could end up with some
## atrocious loops, e.g.:

starts &lt;- c("2015-07-03 01:15:00", "2015-07-03 02:13:00",
            "2015-07-03 03:02:00", "2015-07-03 03:50:00",
            "2015-07-03 04:50:00")

stops &lt;- c("2015-07-03 01:50:00", "2015-07-03 02:35:30",
           "2015-07-03 03:25:00", "2015-07-03 04:16:00",
           "2015-07-03 05:12:00")

metRb &lt;- MR.loops(data = fishMR, DO.var.name ="DO.mgL",
         start.idx = starts,
         stop.idx = stops, time.var.name = "std.time",
         temp.C = "temp.C", elevation.m = 1180,
         bar.press = NULL, in.DO.meas = "mg/L", 
         background.consumption = bg.slope.a,
         ylim=c(6,8))

</code></pre>

<hr>
<h2 id='plotRaw'>
Plotting Data from Witrox
</h2><span id='topic+plotRaw'></span>

<h3>Description</h3>

<p>A good way to visualize your respiro data to get an idea of where to set up the time intervals in functions like <code>MR.loops()</code> or <code>get.pcrit()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRaw(data, DO.var.name, time.var.name = "std.time",
             start.time = data$x[1],
             end.time = data$x[length(data$x)],...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRaw_+3A_data">data</code></td>
<td>

<p>data object for plotting
</p>
</td></tr>
<tr><td><code id="plotRaw_+3A_do.var.name">DO.var.name</code></td>
<td>

<p>A character string matching the column header for the DO variable column.
</p>
</td></tr>
<tr><td><code id="plotRaw_+3A_time.var.name">time.var.name</code></td>
<td>

<p>Column name of time (or x) axis in character class. 
</p>
</td></tr>
<tr><td><code id="plotRaw_+3A_start.time">start.time</code></td>
<td>

<p>Character string specifying left bound x limit in <code>strptime</code> compatable format.
</p>
</td></tr>
<tr><td><code id="plotRaw_+3A_end.time">end.time</code></td>
<td>

<p>Character string specifying right bound x limit in <code>strptime</code> compatable format.
</p>
</td></tr>
<tr><td><code id="plotRaw_+3A_...">...</code></td>
<td>

<p>Arguments passed on to internal functions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>start.time</code> and <code>end.time</code> arguments must match the <code>time.var.name</code> column's format for date time.
</p>


<h3>Value</h3>

<p>Plot showing the overall metabolic data
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="#topic+get.pcrit">get.pcrit</a></code>,
<code><a href="#topic+MR.loops">MR.loops</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data ##

data(fishMR)
## create time variable in POSIXct format ##
fishMR$std.time &lt;- as.POSIXct(fishMR$Date.time,
                    format = "%d/%m/%Y %I:%M:%S %p")

plotRaw(data = fishMR, DO.var.name = "DO.mgL",
         start.time = "2015-07-03 06:15:00",
         end.time = "2015-07-03 08:05:00")
         
plotRaw(fishMR, DO.var.name = "DO.mgL",
         start.time = "2015-07-03 01:00:00",
         end.time = "2015-07-03 05:12:00")

</code></pre>

<hr>
<h2 id='rMR-package'>
Importing Data from Loligo Systems Software Output, Calculating Metabolic Rates and Critical Tensions
</h2><span id='topic+rMR-package'></span><span id='topic+rMR'></span>

<h3>Description</h3>

<p>Analysis of oxygen consumption data generated by Loligo (R) Systems respirometry equipment. The package includes a function for loading data output by Loligo's 'AutoResp' software (get.witrox.data()), functions for calculating metabolic rates over user-specified time intervals, extracting critical points from data using broken stick regressions based on Yeager and Ultsch (1989), and easy functions for converting between different units of barometric pressure.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rMR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-09-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> 3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>
<p>Maintainer: Tyler L. Moulton &lt;tyler.moulton@cortland.edu&gt;
</p>


<h3>References</h3>

<p>Benson, B.B., and Daniel Krause, Jr (1980). The concentration and isotopic fractionation of gases dissolved in freshwater in equilibrium with the atmosphere. 1. Oxygen: Limnology and Oceanography, vol. 25, no. 4, p. 662-671. <a href="http://doi.org/10.4319/lo.1980.25.4.0662">doi: 10.4319/lo.1980.25.4.0662</a>.
</p>
<p>Gnaiger, Erich, and Hellmuth Forstner, eds. (2012). Polarographic oxygen sensors: Aquatic and physiological applications. Springer Science &amp; Business Media. <a href="http://doi.org/10.1007/978-3-642-81863-9">doi: 10.1007/978-3-642-81863-9</a>.
</p>
<p>Lumley, Thomas (2013). &quot;biglm: bounded memory linear and generalized linear models&quot;. 0.9-1. <a href="https://CRAN.R-project.org/package=biglm">https://CRAN.R-project.org/package=biglm</a>.
</p>
<p>McDonnell, Laura H., and Lauren J. Chapman (2016). &quot;Effects of thermal increase on aerobic capacity and swim performance in a tropical inland fish.&quot; Comparative Biochemistry and Physiology Part A: Molecular &amp; Integrative Physiology 199: 62-70. <a href="http://doi.org/10.1016/j.cbpa.2016.05.018">doi: 10.1016/j.cbpa.2016.05.018</a>.
</p>
<p>Mechtly, E. A. (1973). The International System of Units, Physical Constants and Conversion Factors. NASA SP-7012, Second Revision, National Aeronautics and Space Administration, Washington, D.C. <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf">https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19730018242.pdf</a>.
</p>
<p>Roche, Dominique G., et al. (2013). &quot;Finding the best estimates of metabolic rates in a coral reef fish.&quot; Journal of Experimental Biology 216.11: 2103-2110. <a href="http://doi.org/10.1242/jeb.082925">doi: 10.1242/jeb.082925</a>.
</p>
<p>U.S. Geological Survey (2011). Change to solubility equations for oxygen in water: Office of Water Quality Technical Memorandum 2011.03, accessed July 15, 2011, at <a href="http://water.usgs.gov/admin/memo/QW/qw11.03.pdf">http://water.usgs.gov/admin/memo/QW/qw11.03.pdf</a>.
</p>
<p>Yeager, D. P. and Ultsch, G. R. (1989). Physiological regulation and conformation: a BASIC program for the determination of critical points. Physiological Zoology, 888-907. <a href="http://doi.org/10.1086/physzool.62.4.30157935">doi: 10.1086/physzool.62.4.30157935</a>.
</p>
<p>http://www.loligosystems.com/
</p>


<h3>See Also</h3>

<p><code><a href="biglm.html#topic+biglm">biglm</a></code>
</p>

<hr>
<h2 id='sumsq'>
Sum of squares
</h2><span id='topic+sumsq'></span>

<h3>Description</h3>

<p>Internal Function for Use in Package for Calculating Sum of Squares of a Vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumsq(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumsq_+3A_x">x</code></td>
<td>

<p>Numeric vector to be evaluated
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internal function for package
</p>


<h3>Value</h3>

<p>The sum of squares of the vector
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vec &lt;- sample(c(100:120), 50, replace = TRUE)
sumsq(vec)
</code></pre>

<hr>
<h2 id='tot.rss'>
Total Residual Sum of Squares for Broken Stick Model
</h2><span id='topic+tot.rss'></span>

<h3>Description</h3>

<p>Calculates the total residual sum of squares for broken stick model (2 part)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tot.rss(data, break.pt, xvar, yvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tot.rss_+3A_data">data</code></td>
<td>

<p>data frame for calculating total residual sum of squares.
</p>
</td></tr>
<tr><td><code id="tot.rss_+3A_break.pt">break.pt</code></td>
<td>

<p>This is the data point at which the data are split for a broken stick model.
</p>
</td></tr>
<tr><td><code id="tot.rss_+3A_xvar">xvar</code></td>
<td>

<p>The x-variable in the data frame for broken stick model.
</p>
</td></tr>
<tr><td><code id="tot.rss_+3A_yvar">yvar</code></td>
<td>

<p>The y-variable in the data frame for broken stick model.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The residual sum of squares of a broken stick model with a specified break point.
</p>


<h3>Author(s)</h3>

<p>Tyler L. Moulton
</p>


<h3>See Also</h3>

<p>code<a href="#topic+sumsq">sumsq</a>
code<a href="#topic+get.pcrit">get.pcrit</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data ##
data(fishMR)

## subset data to appropriate region ##

data&lt;-fishMR[fishMR$DO.mgL &lt; 4,] 
data$times &lt;- data$times-min(data$times)
data&lt;-data[data$times&lt; 6800,]

## calculate total RSS for different breakpoints ##

a1 &lt;- tot.rss(data, break.pt = 4000,
xvar = "times", yvar = "DO.mgL") 
a2 &lt;- tot.rss(data, break.pt = 4250,
xvar = "times", yvar = "DO.mgL")
a3 &lt;- tot.rss(data, break.pt = 4500,
xvar = "times", yvar = "DO.mgL")
a4 &lt;- tot.rss(data, break.pt = 4750,
xvar = "times", yvar = "DO.mgL") 
a5 &lt;- tot.rss(data, break.pt = 5000,
xvar = "times", yvar = "DO.mgL")
a6 &lt;- tot.rss(data, break.pt = 5250,
xvar = "times", yvar = "DO.mgL")

# a5 represents the break point for the 
# best broken stick linear model of the
# above 6 options.

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
