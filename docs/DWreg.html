<!DOCTYPE html><html lang="en"><head><title>Help for package DWreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DWreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dw'><p>Discrete Weibull</p></a></li>
<li><a href='#dw.meanvar'><p>Mean and Variance of Discrete Weibull</p></a></li>
<li><a href='#dw.parest'><p>Parameter estimation for discrete Weibull</p></a></li>
<li><a href='#dw.reg'><p>DW regression</p></a></li>
<li><a href='#res.dw'><p>DW regression: Diagnostics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-07-11</td>
</tr>
<tr>
<td>Title:</td>
<td>Parametric Regression for Discrete Response</td>
</tr>
<tr>
<td>Author:</td>
<td>Veronica Vinciotti &lt;veronica.vinciotti@brunel.ac.uk&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Veronica Vinciotti&lt;veronica.vinciotti@brunel.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Regression for a discrete response, where the conditional distribution is modelled via a discrete Weibull distribution.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>maxLik, DiscreteWeibull, Ecdat,survival</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-07-18 08:08:22 UTC; mastvvv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-07-18 12:26:11</td>
</tr>
</table>
<hr>
<h2 id='dw'>Discrete Weibull</h2><span id='topic+rdw'></span><span id='topic+qdw'></span><span id='topic+pdw'></span><span id='topic+ddw'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the discrete Weibull distribution with parameters q and beta.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddw(x,q=exp(-1),beta=1)
pdw(x,q=exp(-1),beta=1)
qdw(p,q=exp(-1),beta=1)
rdw(n,q=exp(-1),beta=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dw_+3A_x">x</code></td>
<td>
<p>quantile</p>
</td></tr>
<tr><td><code id="dw_+3A_p">p</code></td>
<td>
<p>probability</p>
</td></tr>
<tr><td><code id="dw_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="dw_+3A_q">q</code>, <code id="dw_+3A_beta">beta</code></td>
<td>
<p>Parameters of the distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The discrete Weibulll distribution has density
</p>
<p style="text-align: center;"><code class="reqn">p(x,q,\beta) = q^{x^{\beta}}-q^{(x+1)^{\beta}}</code>
</p>

<p>for <code class="reqn">x = 0, 1, 2, \ldots</code>.
If q or beta are not specified they assume the default values of exp(-1) and 1, respectively. In this case, DW corresponds to a geometric distribution with p=1-q.  
</p>


<h3>Value</h3>

<p>ddw gives the density, pdw gives the distribution function, qdw gives the quantile function, and rdw generates random samples from a DW distribution with parameters q and beta.
</p>


<h3>Author(s)</h3>

<p>Veronica Vinciotti</p>


<h3>References</h3>

<p>Nagakawa T, Osaki S. The discrete Weibull distribution. IEEE transactions on reliability 1975; R-24(5).</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-rdw(1000,q=0.9,beta=1.5)
hist(x)
plot(x,unlist(lapply(x,ddw,q=0.9,beta=1.5)),ylab="density")
plot(x,unlist(lapply(x,pdw,q=0.9,beta=1.5)),ylab="cdf")
</code></pre>

<hr>
<h2 id='dw.meanvar'>Mean and Variance of Discrete Weibull</h2><span id='topic+dw.meanvar'></span>

<h3>Description</h3>

<p>Mean and variance of a discrete Weibull distribution with parameters q and beta.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw.meanvar(q,beta,M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dw.meanvar_+3A_q">q</code>, <code id="dw.meanvar_+3A_beta">beta</code></td>
<td>
<p>Parameters of the distribution</p>
</td></tr>
<tr><td><code id="dw.meanvar_+3A_m">M</code></td>
<td>
<p>Maximum value of the summation. Default value is 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean and variance are computed using the following approximations:
</p>
<p style="text-align: center;"><code class="reqn">E(X)=\sum_{k=1}^{M} q^{k^{\beta}}</code>
</p>

<p style="text-align: center;"><code class="reqn">E(X^2)=\sum_{k=1}^{M} (2k-1)q^{k^{\beta}} = 2\sum_{k=1}^{M} kq^{k^{\beta}}-E(X)</code>
</p>



<h3>Value</h3>

<p>The function returns the mean and variance of a DW distribution with parameters q and beta.</p>


<h3>Author(s)</h3>

<p>Veronica Vinciotti</p>


<h3>References</h3>

<p>Khan M, Khalique A, Abouammoth A. On estimating parameters in a discrete Weibull distribution. IEEE transactions on Reliability 1989; 38(3):348-350.</p>


<h3>Examples</h3>

<pre><code class='language-R'>dw.meanvar(q=0.9,beta=1.5)
#compare with sample mean/variance from a random sample
x&lt;-rdw(1000,q=0.9,beta=1.5)
mean(x)
var(x)
</code></pre>

<hr>
<h2 id='dw.parest'>Parameter estimation for discrete Weibull</h2><span id='topic+dw.parest'></span>

<h3>Description</h3>

<p>Estimation of the parameters q and beta of a discrete Weibull distribution</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw.parest(data,method,method.opt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dw.parest_+3A_data">data</code></td>
<td>
<p>Vector of observations</p>
</td></tr>
<tr><td><code id="dw.parest_+3A_method">method</code></td>
<td>
<p>Either &quot;likelihood&quot; or &quot;proportion&quot;</p>
</td></tr>
<tr><td><code id="dw.parest_+3A_method.opt">method.opt</code></td>
<td>
<p>Optimization criterion used in maxLik (default is &quot;NR&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If method=&quot;likelihood&quot;, the parameters q and beta are estimated by maximum likelihood. 
</p>
<p>If method=&quot;proportion&quot;, the method of Araujio Santos and Fraga Alves (2013) is used, based on count frequencies.
</p>


<h3>Value</h3>

<p>The function returns the parameter estimates of q and beta.</p>


<h3>Author(s)</h3>

<p>Veronica Vinciotti</p>


<h3>References</h3>

<p>Araujo Santos P, Fraga Alves M. Improved shape parameter estimation in a discrete Weibull model. Recent Developments in Modeling and Applications in Statistics . Studies in Theoretical and Applied Statistics. Springer-Verlag, 2013; 71-80.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-rdw(1000,q=0.9,beta=1.5)
dw.parest(x) #maximum likelihood estimates
dw.parest(x,method="proportion") #proportion estimates
</code></pre>

<hr>
<h2 id='dw.reg'>DW regression</h2><span id='topic+dw.reg'></span>

<h3>Description</h3>

<p>Parametric regression for discrete response data. The conditional distribution of the response given the predictors is assumed to be DW with parameters q and beta dependent on the predictors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw.reg(formula, data,tau=0.5,para.q1=NULL,para.q2=NULL,para.beta=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dw.reg_+3A_formula">formula</code></td>
<td>
<p>An object of class &quot;formula&quot;: a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="dw.reg_+3A_data">data</code></td>
<td>
<p>An optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which dw.qr is called.</p>
</td></tr>
<tr><td><code id="dw.reg_+3A_tau">tau</code></td>
<td>
<p>Quantile value (default 0.5). This is used only to extract the conditional quantile from the fitted distribution.</p>
</td></tr>
<tr><td><code id="dw.reg_+3A_para.q1">para.q1</code>, <code id="dw.reg_+3A_para.q2">para.q2</code></td>
<td>
<p>logical flag. If TRUE, the model includes a dependency of q on the predictors, as explained below.</p>
</td></tr>
<tr><td><code id="dw.reg_+3A_para.beta">para.beta</code></td>
<td>
<p>logical flag. If TRUE, the model includes a dependency of beta on the predictors, as explained below.</p>
</td></tr>
<tr><td><code id="dw.reg_+3A_...">...</code></td>
<td>
<p>Additional arguments to the maxLik function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conditional distribution of Y (response) given x (predictors) is assumed a DW(q(x),beta(x)). 
</p>
<p>If para.q1=TRUE, 
</p>
<p style="text-align: center;"><code class="reqn">log(q/(1-q))=\theta_0+\theta_1 X_1+\ldots+\theta_pX_p.</code>
</p>
 
<p>If para.q2=TRUE, 
</p>
<p style="text-align: center;"><code class="reqn">log(-log(q))=\theta_0+\theta_1 X_1+\ldots+\theta_pX_p.</code>
</p>

<p>This is equivalent to a continuous Weibull regression model with interval-censored data.
</p>
<p>If para.q1=NULL and para.q2=NULL, then q(x) is constant.
</p>
<p>If para.beta=TRUE,
</p>
<p style="text-align: center;"><code class="reqn">log(\beta)= \gamma_0+\gamma_1 X_1+\ldots+\gamma_pX_p.</code>
</p>
<p> Otherwise beta(x) is constant.
</p>


<h3>Value</h3>

<p> A list of class dw.reg containing the following components:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the input data as a list of response and covariates.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>the theta and gamma estimated coefficients.</p>
</td></tr> 
<tr><td><code>loglik</code></td>
<td>
<p>the log-likelihood of the model.</p>
</td></tr> 
<tr><td><code>fitted.values</code></td>
<td>
<p>fitted values (on the response scale) for the specified quantile tau.</p>
</td></tr>
<tr><td><code>fitted.q</code></td>
<td>
<p>fitted q values.</p>
</td></tr>
<tr><td><code>fitted.beta</code></td>
<td>
<p>fitted beta values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>randomised quantile residuals of the fitted model.</p>
</td></tr>
<tr><td><code>tTable</code></td>
<td>
<p>coefficients, standard errors, etc.</p>
</td></tr> 
<tr><td><code>tTable.survreg</code></td>
<td>
<p>Only for the model para.q2=TRUE. Coefficients, standard errors, etc from the survreg parametrization. These estimates are linked to changes of log(Median+1).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Veronica Vinciotti, Hadeel Kalktawi, Alina Peluso</p>


<h3>References</h3>

<p>Kalktawi, Vinciotti and Yu (2016) A simple and adaptive dispersion regression model for count data.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulated example (para.q1=TRUE, beta constant)
theta0 &lt;- 2
theta1 &lt;- 0.5
beta&lt;-0.5
n&lt;-500
x &lt;- runif(n=n, min=0, max=1.5)
logq&lt;-theta0 + theta1 * x - log(1+exp(theta0  + theta1 * x))		
y&lt;-unlist(lapply(logq,function(x,beta) rdw(1,q=exp(x),beta),beta=beta)) 
data.sim&lt;-data.frame(x,y) #simulated data
fit&lt;-dw.reg(y~x,data=data.sim,para.q1=TRUE)
fit$tTable	

#simulated example (para.q2=TRUE, beta constant)
theta0 &lt;- -2
theta1 &lt;- -0.5
beta&lt;-0.5
n&lt;-500
x &lt;- runif(n=n, min=0, max=1.5)
logq&lt;--exp(theta0  + theta1 * x)		
y&lt;-unlist(lapply(logq,function(x,beta) rdw(1,q=exp(x),beta),beta=beta)) 
data.sim&lt;-data.frame(x,y) #simulated data
fit&lt;-dw.reg(y~x,data=data.sim,para.q2=TRUE)
fit$tTable	
fit$survreg

#real example
library(Ecdat)
data(StrikeNb)
fit&lt;-dw.reg(strikes~output,data=StrikeNb,para.q2=TRUE)
fit$tTable
fit$survreg
</code></pre>

<hr>
<h2 id='res.dw'>DW regression: Diagnostics</h2><span id='topic+res.dw'></span>

<h3>Description</h3>

<p>Quantile-Quantile plot of the randomised quantile residuals of a DW regression fitted model with 95% simulated envelope.</p>


<h3>Usage</h3>

<pre><code class='language-R'>res.dw(obj,k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="res.dw_+3A_obj">obj</code></td>
<td>
<p>An object of class &quot;dw.reg&quot;: the output of the dw.reg function.</p>
</td></tr>
<tr><td><code id="res.dw_+3A_k">k</code></td>
<td>
<p>The number of iterations for the simulated envelope.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Diagnostic check for a DW regression model. The randomised quantile residuals should follow a standard normal distribution.
</p>


<h3>Value</h3>

<p>A q-q plot of the residuals with 95% simulated envelope</p>


<h3>Author(s)</h3>

<p>Veronica Vinciotti, Hadeel Kalktawi</p>


<h3>References</h3>

<p>Kalktawi, Vinciotti and Yu (2016) A simple and adaptive dispersion regression model for count data.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#simulated example (para.q2=TRUE, beta constant)
theta0 &lt;- -2
theta1 &lt;- -0.5
beta&lt;-0.5
n&lt;-500
x &lt;- runif(n=n, min=0, max=1.5)
logq&lt;--exp(theta0  + theta1 * x)		
y&lt;-unlist(lapply(logq,function(x,beta) rdw(1,q=exp(x),beta),beta=beta)) 
data.sim&lt;-data.frame(x,y) #simulated data
fit&lt;-dw.reg(y~x,data=data.sim,para.q2=TRUE)
res.dw(fit,k=5)
ks.test(fit$residuals,"pnorm")

#real example
library(Ecdat)
data(StrikeNb)
fit&lt;-dw.reg(strikes~output,data=StrikeNb,para.q2=TRUE)
res.dw(fit,k=5)
ks.test(fit$residuals,"pnorm")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
