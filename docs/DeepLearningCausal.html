<!DOCTYPE html><html><head><title>Help for package DeepLearningCausal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DeepLearningCausal}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#complier_mod'><p>Train complier model using ensemble methods</p></a></li>
<li><a href='#complier_predict'><p>Complier model prediction</p></a></li>
<li><a href='#exp_data'><p>Survey Experiment of Support for Populist Policy</p></a></li>
<li><a href='#exp_data_full'><p>Survey Experiment of Support for Populist Policy</p></a></li>
<li><a href='#expcall'><p>Create list for experimental data</p></a></li>
<li><a href='#metalearner_deepneural'><p>metalearner_deepneural</p></a></li>
<li><a href='#metalearner_ensemble'><p>metalearner_ensemble</p></a></li>
<li><a href='#neuralnet_complier_mod'><p>Train compliance model using neural networks</p></a></li>
<li><a href='#neuralnet_pattc_counterfactuals'><p>Assess Population Data counterfactuals</p></a></li>
<li><a href='#neuralnet_predict'><p>Predicting Compliance from experimental data</p></a></li>
<li><a href='#neuralnet_response_model'><p>Modeling Responses from experimental data Using Deep NN</p></a></li>
<li><a href='#pattc_counterfactuals'><p>Assess Population Data counterfactuals</p></a></li>
<li><a href='#pattc_deepneural'><p>Estimate PATT_C using Deep NN</p></a></li>
<li><a href='#pattc_ensemble'><p>PATT_C SL Ensemble</p></a></li>
<li><a href='#pop_data'><p>World Value Survey India Sample</p></a></li>
<li><a href='#pop_data_full'><p>World Value Survey India Sample</p></a></li>
<li><a href='#popcall'><p>Create list for population data</p></a></li>
<li><a href='#print.pattc_ensemble'><p>print.metalearner_ensemble</p></a></li>
<li><a href='#response_model'><p>Response model from experimental data using SL ensemble</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Inference with Super Learner and Deep Neural Networks</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.103</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nguyen K. Huynh &lt;khoinguyen.huynh@r.hit-u.ac.jp&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to estimate Conditional Average Treatment Effects (CATE) 
    and Population Average Treatment Effects on the Treated (PATT) from 
    experimental or observational data using the Super Learner (SL) ensemble 
    method and Deep neural networks. The package first provides functions to 
    implement meta-learners such as the Single-learner (S-learner) and 
    Two-learner (T-learner) described in Künzel et al. (2019) 
    &lt;<a href="https://doi.org/10.1073%2Fpnas.1804597116">doi:10.1073/pnas.1804597116</a>&gt; for estimating the CATE. The S- and T-learner 
    are each estimated using the SL ensemble method and deep neural networks. It 
    then provides functions to implement the Ottoboni and Poulos (2020) 
    &lt;<a href="https://doi.org/10.1515%2Fjci-2018-0035">doi:10.1515/jci-2018-0035</a>&gt;  PATT-C estimator to obtain the PATT from 
    experimental data with noncompliance by using the SL ensemble method and 
    deep neural networks.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ROCR, caret, neuralnet, SuperLearner, class, xgboost,
randomForest, glmnet, gam, e1071, gbm, Hmisc, weights</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, ggplot2, tidyr, dplyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hknd23/DeepLearningCausal">https://github.com/hknd23/DeepLearningCausal</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hknd23/DeepLearningCausal/issues">https://github.com/hknd23/DeepLearningCausal/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-01 14:54:47 UTC; nguye</td>
</tr>
<tr>
<td>Author:</td>
<td>Nguyen K. Huynh <a href="https://orcid.org/0000-0002-6234-7232"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Bumba Mukherjee <a href="https://orcid.org/0000-0002-3453-601X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Irvin (Chen-Yu) Lee
    <a href="https://orcid.org/0009-0004-5913-8925"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-01 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='complier_mod'>Train complier model using ensemble methods</h2><span id='topic+complier_mod'></span>

<h3>Description</h3>

<p>Train model using group exposed to treatment with compliance as binary
outcome variable and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complier_mod(
  exp.data,
  complier.formula,
  treat.var,
  ID = NULL,
  SL.library = c("SL.glmnet", "SL.xgboost", "SL.ranger", "SL.nnet", "SL.glm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complier_mod_+3A_exp.data">exp.data</code></td>
<td>
<p>list object of experimental data.</p>
</td></tr>
<tr><td><code id="complier_mod_+3A_complier.formula">complier.formula</code></td>
<td>
<p>formula to fit compliance model (c ~ x) using
complier variable and covariates</p>
</td></tr>
<tr><td><code id="complier_mod_+3A_treat.var">treat.var</code></td>
<td>
<p>string specifying the binary treatment variable</p>
</td></tr>
<tr><td><code id="complier_mod_+3A_id">ID</code></td>
<td>
<p>string for name of indentifier variable.</p>
</td></tr>
<tr><td><code id="complier_mod_+3A_sl.library">SL.library</code></td>
<td>
<p>vector of strings for ML classifier algorithms. If left
<code>NULL</code> employs extreme gradient boosting, elastic net regression, random
forest, and neural nets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model object of trained model.
</p>

<hr>
<h2 id='complier_predict'>Complier model prediction</h2><span id='topic+complier_predict'></span>

<h3>Description</h3>

<p>Predict Compliance from control group in experimental data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complier_predict(complier.mod, exp.data, treat.var, compl.var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complier_predict_+3A_complier.mod">complier.mod</code></td>
<td>
<p>output from trained ensemble superlearner model</p>
</td></tr>
<tr><td><code id="complier_predict_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> object of experimental dataset</p>
</td></tr>
<tr><td><code id="complier_predict_+3A_treat.var">treat.var</code></td>
<td>
<p>string specifying the binary treatment variable</p>
</td></tr>
<tr><td><code id="complier_predict_+3A_compl.var">compl.var</code></td>
<td>
<p>string specifying binary complier variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> object with true compliers, predicted compliers in the
control group, and all compliers (actual + predicted).
</p>

<hr>
<h2 id='exp_data'>Survey Experiment of Support for Populist Policy</h2><span id='topic+exp_data'></span>

<h3>Description</h3>

<p>Shortened version of survey response data that incorporates a vignette survey
experiment. The vignette describes an international crisis between country A
and B. After reading this vignette, respondents are randomly assigned to the
control group or to one of two treatments: policy prescription to said crisis
by strong (populist) leader and centrist (non-populist) leader. The
respondents are then asked whether they are willing to support the policy
decision to fight a war against country A, which is the dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp_data)
</code></pre>


<h3>Format</h3>



<h4><code>exp_data</code></h4>

<p>A data frame with 257 rows and 12 columns:
</p>

<dl>
<dt>female</dt><dd><p> Gender.</p>
</dd>
<dt>age</dt><dd><p> Age of participant.</p>
</dd>
<dt>income</dt><dd><p> Monthly household income.</p>
</dd>
<dt>religion</dt><dd><p> Religious denomination</p>
</dd>
<dt>practicing_religion</dt><dd><p> Importance of religion in life.</p>
</dd>
<dt>education</dt><dd><p> Educational level of participant.</p>
</dd>
<dt>political_ideology</dt><dd><p> Political ideology of participant.</p>
</dd>
<dt>employment</dt><dd><p> Employment status of participant.</p>
</dd>
<dt>marital_status</dt><dd><p> Marital status of participant.</p>
</dd>
<dt>job_loss</dt><dd><p> Concern about job loss.</p>
</dd>
<dt>strong_leader</dt><dd><p> Binary treatment measure of leader type.</p>
</dd>
<dt>support_war</dt><dd><p> Binary outcome measure for willingness to fight war.</p>
</dd>
</dl>
<p>#'   ...

</p>



<h3>Source</h3>

<p>Yadav and Mukherjee (2024)
</p>

<hr>
<h2 id='exp_data_full'>Survey Experiment of Support for Populist Policy</h2><span id='topic+exp_data_full'></span>

<h3>Description</h3>

<p>Extended experiment data with 514 observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp_data_full)
</code></pre>


<h3>Format</h3>



<h4><code>exp_data_full</code></h4>

<p>A data frame with 514 rows and 12 columns:
</p>

<dl>
<dt>female</dt><dd><p> Gender.</p>
</dd>
<dt>age</dt><dd><p> Age of participant.</p>
</dd>
<dt>income</dt><dd><p> Monthly household income.</p>
</dd>
<dt>religion</dt><dd><p> Religious denomination</p>
</dd>
<dt>practicing_religion</dt><dd><p> Importance of religion in life.</p>
</dd>
<dt>education</dt><dd><p> Educational level of participant.</p>
</dd>
<dt>political_ideology</dt><dd><p> Political ideology of participant.</p>
</dd>
<dt>employment</dt><dd><p> Employment status of participant.</p>
</dd>
<dt>marital_status</dt><dd><p> Marital status of participant.</p>
</dd>
<dt>job_loss</dt><dd><p> Concern about job loss.</p>
</dd>
<dt>strong_leader</dt><dd><p> Binary treatment measure of leader type.</p>
</dd>
<dt>support_war</dt><dd><p> Binary outcome measure for willingness to fight war.</p>
</dd>
</dl>
<p>#'   ...

</p>



<h3>Source</h3>

<p>Yadav and Mukherjee (2024)
</p>

<hr>
<h2 id='expcall'>Create list for experimental data</h2><span id='topic+expcall'></span>

<h3>Description</h3>

<p>create list object of experimental data for easy data processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expcall(
  response.formula,
  treat.var,
  compl.var,
  exp.data,
  weights = NULL,
  cluster = NULL,
  ID = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expcall_+3A_response.formula">response.formula</code></td>
<td>
<p>formula for response equation of binary outcome
variable and covariates</p>
</td></tr>
<tr><td><code id="expcall_+3A_treat.var">treat.var</code></td>
<td>
<p>string for binary treatment variable</p>
</td></tr>
<tr><td><code id="expcall_+3A_compl.var">compl.var</code></td>
<td>
<p>string for complier variable</p>
</td></tr>
<tr><td><code id="expcall_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> of experimental variable</p>
</td></tr>
<tr><td><code id="expcall_+3A_weights">weights</code></td>
<td>
<p>observation weights</p>
</td></tr>
<tr><td><code id="expcall_+3A_cluster">cluster</code></td>
<td>
<p>clustering variable</p>
</td></tr>
<tr><td><code id="expcall_+3A_id">ID</code></td>
<td>
<p>identifier variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of processed dataset
</p>

<hr>
<h2 id='metalearner_deepneural'>metalearner_deepneural</h2><span id='topic+metalearner_deepneural'></span>

<h3>Description</h3>

<p><code>metalearner_deepneural</code> implements the S-learner and T-learner for estimating
CATE using Deep Neural Networks. The Resilient back propagation (Rprop)
algorithm is used for training neural networks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metalearner_deepneural(
  data,
  cov.formula,
  treat.var,
  meta.learner.type,
  stepmax = 1e+05,
  nfolds = 5,
  algorithm = "rprop+",
  hidden.layer = c(4, 2),
  linear.output = FALSE,
  binary.outcome = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metalearner_deepneural_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> object of data.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_cov.formula">cov.formula</code></td>
<td>
<p>formula description of the model y ~ x(list of covariates).</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_treat.var">treat.var</code></td>
<td>
<p>string for the name of treatment variable.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_meta.learner.type">meta.learner.type</code></td>
<td>
<p>string specifying is the S-learner and
<code>"T.Learner"</code> for the T-learner model.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_stepmax">stepmax</code></td>
<td>
<p>maximum number of steps for training model.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds for cross-validation. Currently supports up to
5 folds.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_algorithm">algorithm</code></td>
<td>
<p>a string for the algorithm for the neural network.
Default set to <code style="white-space: pre;">&#8288;rprop+&#8288;</code>, the Resilient back propagation (Rprop) with weight
backtracking algorithm for training neural networks.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_hidden.layer">hidden.layer</code></td>
<td>
<p>vector of integers specifying layers and number of neurons.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_linear.output">linear.output</code></td>
<td>
<p>logical specifying regression (TRUE)
or classification (FALSE) model.</p>
</td></tr>
<tr><td><code id="metalearner_deepneural_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying predicted outcome variable will take
binary values or proportions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of predicted outcome values and CATEs estimated by the meta
learners for each observation.#' @export
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load dataset
data(exp_data)
# estimate CATEs with S Learner
set.seed(123456)
slearner_nn &lt;- metalearner_deepneural(cov.formula = support_war ~ age + income +
                                   employed  + job_loss,
                                   data = exp_data,
                                   treat.var = "strong_leader",
                                   meta.learner.type = "S.Learner",
                                   stepmax = 2e+9,
                                   nfolds = 5,
                                   algorithm = "rprop+",
                                   hidden.layer = c(1),
                                   linear.output = FALSE,
                                   binary.outcome = FALSE)

print(slearner_nn)

# load dataset
set.seed(123456)
# estimate CATEs with T Learner
tlearner_nn &lt;- metalearner_deepneural(cov.formula = support_war ~ age +
                                  income  +
                                  employed  + job_loss,
                                  data = exp_data,
                                  treat.var = "strong_leader",
                                  meta.learner.type = "T.Learner",
                                  stepmax = 1e+9,
                                  nfolds = 5,
                                  algorithm = "rprop+",
                                  hidden.layer = c(2,1),
                                  linear.output = FALSE,
                                  binary.outcome = FALSE)

print(tlearner_nn)
                                  

</code></pre>

<hr>
<h2 id='metalearner_ensemble'>metalearner_ensemble</h2><span id='topic+metalearner_ensemble'></span>

<h3>Description</h3>

<p><code>metalearner_ensemble</code> implements the S-learner and T-learner for
estimating CATE using the super learner ensemble method. The super learner in
this case includes the following machine learning algorithms:
extreme gradient boosting, glmnet (elastic net regression), random forest and
neural nets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metalearner_ensemble(
  data,
  cov.formula,
  treat.var,
  meta.learner.type,
  learners = c("SL.glmnet", "SL.xgboost", "SL.ranger", "SL.nnet"),
  nfolds = 5,
  binary.outcome = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metalearner_ensemble_+3A_data">data</code></td>
<td>
<p><code>data.frame</code> object of data</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_cov.formula">cov.formula</code></td>
<td>
<p>formula description of the model y ~ x(list of covariates)</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_treat.var">treat.var</code></td>
<td>
<p>string for the name of treatment variable.</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_meta.learner.type">meta.learner.type</code></td>
<td>
<p>string specifying is the S-learner and
<code>"T.Learner"</code> for the T-learner model.</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_learners">learners</code></td>
<td>
<p>vector for super learner ensemble that includes extreme gradient
boosting, glmnet, random forest, and neural nets.</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds for cross-validation. Currently supports up to
5 folds.</p>
</td></tr>
<tr><td><code id="metalearner_ensemble_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying predicted outcome variable will take
binary values or proportions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>list</code> of predicted outcome values and CATEs estimated by the meta
learners for each observation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load dataset
data(exp_data)
#load SuperLearner package
library(SuperLearner)
# estimate CATEs with S Learner
set.seed(123456)
slearner &lt;- metalearner_ensemble(cov.formula = support_war ~ age +
                                  income + employed + job_loss,
                                data = exp_data,
                                treat.var = "strong_leader",
                                meta.learner.type = "S.Learner",
                                learners = c("SL.glm"),
                                nfolds = 5,
                                binary.outcome = FALSE)
print(slearner)


# estimate CATEs with T Learner
set.seed(123456)
tlearner &lt;- metalearner_ensemble(cov.formula = support_war ~ age + income +
                                  employed  + job_loss,
                                  data = exp_data,
                                  treat.var = "strong_leader",
                                  meta.learner.type = "T.Learner",
                                  learners = c("SL.xgboost","SL.ranger",
                                               "SL.nnet"),
                                  nfolds = 5,
                                  binary.outcome = FALSE)

print(tlearner)
                                  

</code></pre>

<hr>
<h2 id='neuralnet_complier_mod'>Train compliance model using neural networks</h2><span id='topic+neuralnet_complier_mod'></span>

<h3>Description</h3>

<p>Train model using group exposed to treatment with compliance as binary
outcome variable and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neuralnet_complier_mod(
  complier.formula,
  exp.data,
  treat.var,
  algorithm = "rprop+",
  hidden.layer = c(4, 2),
  ID = NULL,
  stepmax = 1e+08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neuralnet_complier_mod_+3A_complier.formula">complier.formula</code></td>
<td>
<p>formula for complier variable as outcome and
covariates (c ~ x)</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> for experimental data.</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_treat.var">treat.var</code></td>
<td>
<p>string for treatment variable.</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_algorithm">algorithm</code></td>
<td>
<p>string for algorithm for training neural networks.
Default set to the Resilient back propagation with weight backtracking
(rprop+). Other algorithms include backprop', rprop-', 'sag', or 'slr'
(see <code>neuralnet</code> package).</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_hidden.layer">hidden.layer</code></td>
<td>
<p>vector for specifying hidden layers and number of neurons.</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_id">ID</code></td>
<td>
<p>string for identifier variable</p>
</td></tr>
<tr><td><code id="neuralnet_complier_mod_+3A_stepmax">stepmax</code></td>
<td>
<p>maximum number of steps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>trained complier model object
</p>

<hr>
<h2 id='neuralnet_pattc_counterfactuals'>Assess Population Data counterfactuals</h2><span id='topic+neuralnet_pattc_counterfactuals'></span>

<h3>Description</h3>

<p>Create counterfactual datasets in the population for compliers and
noncompliers. Then predict potential outcomes using trained model from
<code>neuralnet_response_model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neuralnet_pattc_counterfactuals(
  pop.data,
  neuralnet.response.mod,
  ID = NULL,
  cluster = NULL,
  binary.outcome = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neuralnet_pattc_counterfactuals_+3A_pop.data">pop.data</code></td>
<td>
<p>population data.</p>
</td></tr>
<tr><td><code id="neuralnet_pattc_counterfactuals_+3A_neuralnet.response.mod">neuralnet.response.mod</code></td>
<td>
<p>trained model from.
<code>neuralnet_response_model</code>.</p>
</td></tr>
<tr><td><code id="neuralnet_pattc_counterfactuals_+3A_id">ID</code></td>
<td>
<p>string for identifier variable.</p>
</td></tr>
<tr><td><code id="neuralnet_pattc_counterfactuals_+3A_cluster">cluster</code></td>
<td>
<p>string for clustering variable (currently unused).</p>
</td></tr>
<tr><td><code id="neuralnet_pattc_counterfactuals_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying predicted outcome variable will take
binary values or proportions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> of predicted outcomes of response variable from
counterfactuals.
</p>

<hr>
<h2 id='neuralnet_predict'>Predicting Compliance from experimental data</h2><span id='topic+neuralnet_predict'></span>

<h3>Description</h3>

<p>Predicting Compliance from control group experimental data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neuralnet_predict(neuralnet.complier.mod, exp.data, treat.var, compl.var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neuralnet_predict_+3A_neuralnet.complier.mod">neuralnet.complier.mod</code></td>
<td>
<p>results from <code>neuralnet_complier_mod</code></p>
</td></tr>
<tr><td><code id="neuralnet_predict_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> of experimental data</p>
</td></tr>
<tr><td><code id="neuralnet_predict_+3A_treat.var">treat.var</code></td>
<td>
<p>string for treatment variable</p>
</td></tr>
<tr><td><code id="neuralnet_predict_+3A_compl.var">compl.var</code></td>
<td>
<p>string for compliance variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> object with true compliers, predicted compliers in the
control group, and all compliers (actual + predicted).
</p>

<hr>
<h2 id='neuralnet_response_model'>Modeling Responses from experimental data Using Deep NN</h2><span id='topic+neuralnet_response_model'></span>

<h3>Description</h3>

<p>Model Responses from all compliers (actual + predicted)
in experimental data using neural network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neuralnet_response_model(
  response.formula,
  exp.data,
  neuralnet.compliers,
  compl.var,
  algorithm = "rprop+",
  hidden.layer = c(4, 2),
  stepmax = 1e+08
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neuralnet_response_model_+3A_response.formula">response.formula</code></td>
<td>
<p>formula for response variable and covariates (y ~ x)</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> of experimental data.</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_neuralnet.compliers">neuralnet.compliers</code></td>
<td>
<p><code>data.frame</code> of compliers (actual + predicted)
from <code>neuralnet_predict</code>.</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_compl.var">compl.var</code></td>
<td>
<p>string of compliance variable</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_algorithm">algorithm</code></td>
<td>
<p>neural network algorithm, default set to <code>"rprop+"</code>.</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_hidden.layer">hidden.layer</code></td>
<td>
<p>vector specifying hidden layers and number of neurons.</p>
</td></tr>
<tr><td><code id="neuralnet_response_model_+3A_stepmax">stepmax</code></td>
<td>
<p>maximum number of steps for training model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>trained response model object
</p>

<hr>
<h2 id='pattc_counterfactuals'>Assess Population Data counterfactuals</h2><span id='topic+pattc_counterfactuals'></span>

<h3>Description</h3>

<p>Create counterfactual datasets in the population for compliers and
noncompliers. Then predict potential outcomes from counterfactuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattc_counterfactuals(
  pop.data,
  response.mod,
  ID = NULL,
  cluster = NULL,
  binary.outcome = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pattc_counterfactuals_+3A_pop.data">pop.data</code></td>
<td>
<p>population dataset</p>
</td></tr>
<tr><td><code id="pattc_counterfactuals_+3A_response.mod">response.mod</code></td>
<td>
<p>trained model from <code>response_model</code>.</p>
</td></tr>
<tr><td><code id="pattc_counterfactuals_+3A_id">ID</code></td>
<td>
<p>string fir identifier variable</p>
</td></tr>
<tr><td><code id="pattc_counterfactuals_+3A_cluster">cluster</code></td>
<td>
<p>string for clustering variable</p>
</td></tr>
<tr><td><code id="pattc_counterfactuals_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying whether predicted outcomes are
proportions or binary (0-1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> object of predicted outcomes of counterfactual groups.
</p>

<hr>
<h2 id='pattc_deepneural'>Estimate PATT_C using Deep NN</h2><span id='topic+pattc_deepneural'></span>

<h3>Description</h3>

<p>estimates the Population Average Treatment Effect
of the Treated from experimental data with noncompliers using Deep Neural
Networks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattc_deepneural(
  response.formula,
  exp.data,
  pop.data,
  treat.var,
  compl.var,
  compl.algorithm = "rprop+",
  response.algorithm = "rprop+",
  compl.hidden.layer = c(4, 2),
  response.hidden.layer = c(4, 2),
  compl.stepmax = 1e+08,
  response.stepmax = 1e+08,
  ID = NULL,
  cluster = NULL,
  binary.outcome = FALSE,
  bootstrap = FALSE,
  nboot = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pattc_deepneural_+3A_response.formula">response.formula</code></td>
<td>
<p>formula of response variable as outcome and
covariates (y ~ x)</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> of experimental data. Must include binary
treatment and compliance variables.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_pop.data">pop.data</code></td>
<td>
<p><code>data.frame</code> of population data. Must include binary
compliance variable</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_treat.var">treat.var</code></td>
<td>
<p>string for treatment variable.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_compl.var">compl.var</code></td>
<td>
<p>string for compliance variable</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_compl.algorithm">compl.algorithm</code></td>
<td>
<p>string for algorithim to train neural network for
compliance model. Default set to <code>"rprop+"</code>. See (<code>neuralnet</code> package for
available algorithms).</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_response.algorithm">response.algorithm</code></td>
<td>
<p>string for algorithim to train neural network for
response model. Default set to <code>"rprop+"</code>. See (<code>neuralnet</code> package for
available algorithms).</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_compl.hidden.layer">compl.hidden.layer</code></td>
<td>
<p>vector for specifying hidden layers and number of
neurons in complier model.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_response.hidden.layer">response.hidden.layer</code></td>
<td>
<p>vector for specifying hidden layers and number of
neurons in response model.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_compl.stepmax">compl.stepmax</code></td>
<td>
<p>maximum number of steps for complier model</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_response.stepmax">response.stepmax</code></td>
<td>
<p>maximum number of steps for response model</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_id">ID</code></td>
<td>
<p>string for identifier variable</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_cluster">cluster</code></td>
<td>
<p>string for cluster variable.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying predicted outcome variable will take
binary values or proportions.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_bootstrap">bootstrap</code></td>
<td>
<p>logical for bootstrapped PATT-C.</p>
</td></tr>
<tr><td><code id="pattc_deepneural_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrapped samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of t test as PATTC estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load datasets
data(exp_data) #experimental data
data(pop_data) #population data
# specify models and estimate PATTC
set.seed(123456)
pattc_neural &lt;- pattc_deepneural(response.formula = support_war ~ age + female +
                               income + education +  employed + married +
                               hindu + job_loss,
                               exp.data = exp_data,
                               pop.data = pop_data,
                               treat.var = "strong_leader",
                               compl.var = "compliance",
                               compl.algorithm = "rprop+",
                               response.algorithm = "rprop+",
                               compl.hidden.layer = c(4,2),
                               response.hidden.layer = c(4,2),
                               compl.stepmax = 1e+09,
                               response.stepmax = 1e+09,
                               ID = NULL,
                               cluster = NULL,
                               binary.outcome = FALSE)

print(pattc_neural)

pattc_neural_boot &lt;- pattc_deepneural(response.formula = support_war ~ age + female +
                               income + education +  employed + married +
                               hindu + job_loss,
                               exp.data = exp_data,
                               pop.data = pop_data,
                               treat.var = "strong_leader",
                               compl.var = "compliance",
                               compl.algorithm = "rprop+",
                               response.algorithm = "rprop+",
                               compl.hidden.layer = c(4,2),
                               response.hidden.layer = c(4,2),
                               compl.stepmax = 1e+09,
                               response.stepmax = 1e+09,
                               ID = NULL,
                               cluster = NULL,
                               binary.outcome = FALSE,
                               bootstrap = TRUE,
                               nboot = 2000)

print(pattc_neural_boot)



</code></pre>

<hr>
<h2 id='pattc_ensemble'>PATT_C SL Ensemble</h2><span id='topic+pattc_ensemble'></span>

<h3>Description</h3>

<p><code>pattc_ensemble</code> estimates the Population Average Treatment Effect
of the Treated from experimental data with noncompliers
using the super learner ensemble that includes extreme gradient boosting,
glmnet (elastic net regression), random forest and neural nets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattc_ensemble(
  response.formula,
  exp.data,
  pop.data,
  treat.var,
  compl.var,
  SL.library = c("SL.glmnet", "SL.xgboost", "SL.ranger", "SL.nnet", "SL.glm"),
  ID = NULL,
  cluster = NULL,
  binary.outcome = FALSE,
  bootstrap = FALSE,
  nboot = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pattc_ensemble_+3A_response.formula">response.formula</code></td>
<td>
<p>formula for the effects of covariates on outcome
variable (y ~ x).</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_exp.data">exp.data</code></td>
<td>
<p><code>data.frame</code> object for experimental data. Must include
binary treatment and compliance variable.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_pop.data">pop.data</code></td>
<td>
<p><code>data.frame</code> object for population data. Must include
binary compliance variable.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_treat.var">treat.var</code></td>
<td>
<p>string for binary treatment variable.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_compl.var">compl.var</code></td>
<td>
<p>string for binary compliance variable.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_sl.library">SL.library</code></td>
<td>
<p>vector of names of ML algorithms used for ensemble model.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_id">ID</code></td>
<td>
<p>string for name of identifier.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_cluster">cluster</code></td>
<td>
<p>string for name of cluster variable.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_binary.outcome">binary.outcome</code></td>
<td>
<p>logical specifying predicted outcome variable will take
binary values or proportions.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_bootstrap">bootstrap</code></td>
<td>
<p>logical for bootstrapped PATT-C.</p>
</td></tr>
<tr><td><code id="pattc_ensemble_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrapped samples. Only used with
<code>bootstrap = FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of t test as PATTC estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load datasets
data(exp_data_full) # full experimental data
data(exp_data) #experimental data
data(pop_data) #population data
#attach SuperLearner (model will not recognize learner if package is not loaded)
library(SuperLearner)
set.seed(123456)
#specify models and estimate PATTC
pattc &lt;- pattc_ensemble(response.formula = support_war ~ age + income +
                                education + employed + job_loss,
                                exp.data = exp_data_full,
                                pop.data = pop_data,
                                treat.var = "strong_leader",
                                compl.var = "compliance",
                                SL.library = c("SL.glm", "SL.nnet"),
                                ID = NULL,
                                cluster = NULL,
                                binary.outcome = FALSE)

print(pattc)

pattc_boot &lt;- pattc_ensemble(response.formula = support_war ~ age + income +
                                education + employed + job_loss,
                                exp.data = exp_data_full,
                                pop.data = pop_data,
                                treat.var = "strong_leader",
                                compl.var = "compliance",
                                SL.library = c("SL.glm", "SL.nnet"),
                                ID = NULL,
                                cluster = NULL,
                                binary.outcome = FALSE,
                                bootstrap = TRUE,
                                nboot = 1000)
print(pattc_boot)


</code></pre>

<hr>
<h2 id='pop_data'>World Value Survey India Sample</h2><span id='topic+pop_data'></span>

<h3>Description</h3>

<p>World Value Survey (WVS) Data for India in 2022. The variables drawn from the
said WVS India data match the covariates from the India survey experiment sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pop_data)
</code></pre>


<h3>Format</h3>



<h4><code>pop_data</code></h4>

<p>A data frame with 846 rows and 13 columns:
</p>

<dl>
<dt>female</dt><dd><p> Respondent’s Sex.</p>
</dd>
<dt>age</dt><dd><p> Age of respondent.</p>
</dd>
<dt>income</dt><dd><p> income group of Household.</p>
</dd>
<dt>religion</dt><dd><p> Religious denomination</p>
</dd>
<dt>practicing_religion</dt><dd><p> Importance of religion in respondent’s life.</p>
</dd>
<dt>education</dt><dd><p> Educational level of respondent.</p>
</dd>
<dt>political_ideology</dt><dd><p> Political ideology of respondent.</p>
</dd>
<dt>employment</dt><dd><p> Employment status and full-time employee.</p>
</dd>
<dt>marital_status</dt><dd><p> Marital status of respondent.</p>
</dd>
<dt>job_loss</dt><dd><p> Concern about job loss.</p>
</dd>
<dt>support_war</dt><dd><p> Binary (Yes/No) outcome measure for willingness to fight war.</p>
</dd>
<dt>strong_leader</dt><dd><p> Binary measure of preference for strong leader.</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>Haerpfer, C., Inglehart, R., Moreno, A., Welzel, C., Kizilova, K., Diez-Medrano J., M. Lagos, P. Norris, E. Ponarin &amp; B. Puranen et al. (eds.). 2020. World Values Survey: Round Seven – Country-Pooled Datafile. Madrid, Spain &amp; Vienna, Austria: JD Systems Institute &amp; WVSA Secretariat. &lt;doi.org/10.14281/18241.1&gt;
</p>

<hr>
<h2 id='pop_data_full'>World Value Survey India Sample</h2><span id='topic+pop_data_full'></span>

<h3>Description</h3>

<p>Extended World Value Survey (WVS) Data for India in 1995, 2001, 2006, 2012,
and 2022.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pop_data_full)
</code></pre>


<h3>Format</h3>



<h4><code>pop_data_full</code></h4>

<p>A data frame with 11,813 rows and 13 columns:
</p>

<dl>
<dt>female</dt><dd><p> Respondent’s Sex.</p>
</dd>
<dt>age</dt><dd><p> Age of respondent.</p>
</dd>
<dt>income</dt><dd><p> income group of Household.</p>
</dd>
<dt>religion</dt><dd><p> Religious denomination</p>
</dd>
<dt>practicing_religion</dt><dd><p> Importance of religion in respondent’s life.</p>
</dd>
<dt>education</dt><dd><p> Educational level of respondent.</p>
</dd>
<dt>political_ideology</dt><dd><p> Political ideology of respondent.</p>
</dd>
<dt>employment</dt><dd><p> Employment status and full-time employee.</p>
</dd>
<dt>marital_status</dt><dd><p> Marital status of respondent.</p>
</dd>
<dt>job_loss</dt><dd><p> Concern about job loss.</p>
</dd>
<dt>support_war</dt><dd><p> Binary (Yes/No) outcome measure for willingness to fight war.</p>
</dd>
<dt>strong_leader</dt><dd><p> Binary measure of preference for strong leader.</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>Haerpfer, C., Inglehart, R., Moreno, A., Welzel, C., Kizilova, K., Diez-Medrano J., M. Lagos, P. Norris, E. Ponarin &amp; B. Puranen et al. (eds.). 2020. World Values Survey: Round Seven – Country-Pooled Datafile. Madrid, Spain &amp; Vienna, Austria: JD Systems Institute &amp; WVSA Secretariat. &lt;doi.org/10.14281/18241.1&gt;
</p>

<hr>
<h2 id='popcall'>Create list for population data</h2><span id='topic+popcall'></span>

<h3>Description</h3>

<p>create list object of population data for easy data processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popcall(
  response.formula,
  compl.var,
  pop.data,
  weights = NULL,
  cluster = NULL,
  ID = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popcall_+3A_response.formula">response.formula</code></td>
<td>
<p>formula for response equation of binary outcome
variable and covariates</p>
</td></tr>
<tr><td><code id="popcall_+3A_compl.var">compl.var</code></td>
<td>
<p>string for complier variable</p>
</td></tr>
<tr><td><code id="popcall_+3A_pop.data">pop.data</code></td>
<td>
<p><code>data.frame</code> of experimental variable</p>
</td></tr>
<tr><td><code id="popcall_+3A_weights">weights</code></td>
<td>
<p>observation weights</p>
</td></tr>
<tr><td><code id="popcall_+3A_cluster">cluster</code></td>
<td>
<p>clustering variable</p>
</td></tr>
<tr><td><code id="popcall_+3A_id">ID</code></td>
<td>
<p>identifier variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of processed dataset
</p>

<hr>
<h2 id='print.pattc_ensemble'>print.metalearner_ensemble</h2><span id='topic+print.pattc_ensemble'></span>

<h3>Description</h3>

<p>Print method for <code>metalearner_ensemble</code>
</p>
<p>Print method for <code>metalearner_deepneural</code>
</p>
<p>Print method for <code>pattc_ensemble</code>
</p>
<p>Print method for <code>pattc_deepneural</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pattc_ensemble'
print(x, ...)

## S3 method for class 'pattc_ensemble'
print(x, ...)

## S3 method for class 'pattc_ensemble'
print(x, ...)

## S3 method for class 'pattc_ensemble'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pattc_ensemble_+3A_x">x</code></td>
<td>
<p><code>pattc_deepneural</code> class object from <code>pattc_deepneural</code></p>
</td></tr>
<tr><td><code id="print.pattc_ensemble_+3A_...">...</code></td>
<td>
<p>additional parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of model results
</p>
<p>list of model results
</p>
<p>list of model results
</p>
<p>list of model results
</p>

<hr>
<h2 id='response_model'>Response model from experimental data using SL ensemble</h2><span id='topic+response_model'></span>

<h3>Description</h3>

<p>Train response model (response variable as outcome and covariates) from all
compliers (actual + predicted) in experimental data using SL ensemble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>response_model(
  response.formula,
  exp.data,
  compl.var,
  exp.compliers,
  family = "binomial",
  ID = NULL,
  SL.library = c("SL.glmnet", "SL.xgboost", "SL.ranger", "SL.nnet", "SL.glm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="response_model_+3A_response.formula">response.formula</code></td>
<td>
<p>formula to fit the response model (y ~ x) using
binary outcome variable and covariates</p>
</td></tr>
<tr><td><code id="response_model_+3A_exp.data">exp.data</code></td>
<td>
<p>experimental dataset.</p>
</td></tr>
<tr><td><code id="response_model_+3A_compl.var">compl.var</code></td>
<td>
<p>string specifying binary complier variable</p>
</td></tr>
<tr><td><code id="response_model_+3A_exp.compliers">exp.compliers</code></td>
<td>
<p><code>data.frame</code> object of compliers from
<code>complier_predict</code>.</p>
</td></tr>
<tr><td><code id="response_model_+3A_family">family</code></td>
<td>
<p>string for <code>"gaussian"</code> or <code>"binomial"</code>.</p>
</td></tr>
<tr><td><code id="response_model_+3A_id">ID</code></td>
<td>
<p>string for identifier variable.</p>
</td></tr>
<tr><td><code id="response_model_+3A_sl.library">SL.library</code></td>
<td>
<p>vector of names of ML algorithms used for ensemble model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>trained response model.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
