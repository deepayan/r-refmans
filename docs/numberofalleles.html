<!DOCTYPE html><html><head><title>Help for package numberofalleles</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {numberofalleles}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#expected_number_of_distinct_alleles'><p>Compute the expectation of the number of distinct alleles observed in a DNA mixture for a locus</p></a></li>
<li><a href='#mean.pf'><p>Mean method for objects of class pf</p></a></li>
<li><a href='#numberofalleles'><p>numberofalleles</p></a></li>
<li><a href='#plot.pf'><p>Plot method for objects of class pf</p></a></li>
<li><a href='#pr_independent_alleles'><p>Compute the probability distribution of the number of independent alleles in a mixture with dropout</p></a></li>
<li><a href='#pr_independent_alleles_ped'><p>Compute the probability distribution of the number of independent alleles in a mixture with dropout and related contributors</p></a></li>
<li><a href='#pr_number_of_distinct_alleles'><p>Compute the probability distribution of the number of distinct alleles observed in a DNA mixture for a locus</p></a></li>
<li><a href='#pr_total_number_of_distinct_alleles'><p>Compute the probability distribution of total number of distinct alleles in a DNA mixture</p></a></li>
<li><a href='#read_allele_freqs'><p>Read allele frequencies in FSIgen format (.csv)</p></a></li>
<li><a href='#var'><p>Variance method for objects of class pf</p></a></li>
<li><a href='#variance_number_of_distinct_alleles'><p>Compute the variance of the number of distinct alleles observed in a DNA mixture for a locus</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute the Probability Distribution of the Number of Alleles in
a DNA Mixture</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-28</td>
</tr>
<tr>
<td>Description:</td>
<td>The number of distinct alleles observed in a DNA mixture is informative of the number of contributors to the mixture. The package provides methods for computing the probability distribution of the number of distinct alleles in a mixture for a given set of allele frequencies. The mixture contributors may be related according to a provided pedigree.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7), pedtools, ribd, partitions, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0), ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-27 23:07:07 UTC; mkruijver</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Kruijver <a href="https://orcid.org/0000-0002-6890-7632"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  James Curran <a href="https://orcid.org/0000-0003-3323-6733"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Kruijver &lt;maarten.kruijver@esr.cri.nz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-29 08:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='expected_number_of_distinct_alleles'>Compute the expectation of the number of distinct alleles observed in a DNA mixture for a locus</h2><span id='topic+expected_number_of_distinct_alleles'></span>

<h3>Description</h3>

<p>For a given number of <em>independent</em> alleles, compute the mean and variance of the number of <em>distinct</em> alleles observed in a DNA mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expected_number_of_distinct_alleles(number_of_independent_alleles, f, fst = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expected_number_of_distinct_alleles_+3A_number_of_independent_alleles">number_of_independent_alleles</code></td>
<td>
<p>Integer. Number of independent alleles in the mixture.</p>
</td></tr>
<tr><td><code id="expected_number_of_distinct_alleles_+3A_f">f</code></td>
<td>
<p>Numeric vector with allele frequencies</p>
</td></tr>
<tr><td><code id="expected_number_of_distinct_alleles_+3A_fst">fst</code></td>
<td>
<p>Numeric value for sub-population correction (also known as theta)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to allele sharing between DNA mixture contributors, the number of <em>distinct</em> alleles observed in a mixture is often less than the number of independent alleles in the mixture. For example, if mixture comprises two unrelated contributors, there are four independent alleles. Some of these four independent alleles may be of the same allelic type so that at least one and at most four distinct alleles are observed.
</p>
<p>This function computes the probability distribution of the number of <em>distinct</em> alleles observed when the mixtures comprises a given number of <em>independent</em> alleles. Optionally, a sub-population correction may be applied by setting <code>fst&gt;0</code>.
</p>


<h3>Value</h3>

<p>Expected value (numeric of length one)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- c(A = 0.1, B = 0.2, C = 0.7)

e &lt;- expected_number_of_distinct_alleles(3, f)

# by hand calculation
p &lt;- pr_number_of_distinct_alleles(3, f)
e_by_hand &lt;- sum(as.numeric(names(p)) * p)

stopifnot(isTRUE(all.equal(e, e_by_hand)))
</code></pre>

<hr>
<h2 id='mean.pf'>Mean method for objects of class pf</h2><span id='topic+mean.pf'></span>

<h3>Description</h3>

<p>Mean method for objects of class pf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pf'
mean(x, by_locus = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean.pf_+3A_x">x</code></td>
<td>
<p>Object of class <code>pf</code>: output of <a href="#topic+pr_total_number_of_distinct_alleles">pr_total_number_of_distinct_alleles</a></p>
</td></tr>
<tr><td><code id="mean.pf_+3A_by_locus">by_locus</code></td>
<td>
<p>If <code>TRUE</code> then the results will be returned locus by locus</p>
</td></tr>
<tr><td><code id="mean.pf_+3A_...">...</code></td>
<td>
<p>other arguments that may p</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a vector of means, one for each locus, or the sum of the locus means.
The means are the expected number of alleles observed at each locus
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                           package = "numberofalleles"))
p &lt;- pr_total_number_of_distinct_alleles(contributors = c("U1","U2"),
                                         freqs = freqs)
mean(p)
var(p)
</code></pre>

<hr>
<h2 id='numberofalleles'>numberofalleles</h2><span id='topic+numberofalleles'></span>

<h3>Description</h3>

<p>Probabilities for observing a number of distinct alleles in a forensic DNA mixture
</p>


<h3>Author(s)</h3>

<p>Maarten Kruijver
</p>

<hr>
<h2 id='plot.pf'>Plot method for objects of class pf</h2><span id='topic+plot.pf'></span>

<h3>Description</h3>

<p>Plot method for objects of class pf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pf'
plot(
  x,
  lines = TRUE,
  points = TRUE,
  line_col = "black",
  point_col = "black",
  xlab = "Number of alleles (n)",
  ylab = expression(Pr(N == n)),
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pf_+3A_x">x</code></td>
<td>
<p>An object of class pf</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_lines">lines</code></td>
<td>
<p>if <code>TRUE</code> then lines will be drawn from 0 to the
probability value for each x value.</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_points">points</code></td>
<td>
<p>if <code>TRUE</code> then points will be plotted at the
probability value for each x value.</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_line_col">line_col</code></td>
<td>
<p>the colour of the lines drawn for each probability mass</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_point_col">point_col</code></td>
<td>
<p>the colour of the points plotted for each probability mass</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis, defaults to <code>"Number of alleles (n)"</code></p>
</td></tr>
<tr><td><code id="plot.pf_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis, defaults to <code>expression(Pr(N == n))</code></p>
</td></tr>
<tr><td><code id="plot.pf_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code> then the plotting information will be added to
the existing plot.</p>
</td></tr>
<tr><td><code id="plot.pf_+3A_...">...</code></td>
<td>
<p>Any other arguments that should be sent to <code>plot</code>,
<code>arrows</code>, or <code>points</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Has the side effect of plotting to the active graphics device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load allele frequencies
freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                            package = "numberofalleles"))

gf_loci &lt;- c("D3S1358", "vWA", "D16S539", "CSF1PO", "TPOX", "D8S1179",
            "D21S11",  "D18S51", "D2S441", "D19S433", "TH01", "FGA",
            "D22S1045", "D5S818", "D13S317", "D7S820", "SE33",
            "D10S1248", "D1S1656", "D12S391", "D2S1338")

gf_freqs &lt;- freqs[gf_loci]

## Compute the pedigrees for two and three siblings respectively
pedSibs2 = pedtools::nuclearPed(father = "F", mother = "M",
                                children = c("S1", "S2"))
pedSibs3 = pedtools::addChildren(father = "F", mother = "M",
                                 pedSibs2, ids = "S3")

## Compute the probability functions for each of 2 Unknowns, and 2 Sibs
p2U = pr_total_number_of_distinct_alleles(contributors = c("U1", "U2"),
                                          freqs = gf_freqs)
p2S =  pr_total_number_of_distinct_alleles(contributors = c("S1", "S2"),
                                           freqs = gf_freqs,
                                           pedigree = pedSibs2)

## And plot the two probability distribution functions on top of each other
plot(p2U,
     line_col = "red",
     point_col = "red",
     pch = 18,
     lwd = 2,
     ylim = c(0, 0.15),
     xlab = "Total Number of Alleles (TAC)",
     ylab = expression(Pr(N == n~"|"~ P)))

plot(p2S,
     add = TRUE,
     point_col = "blue",
     line_col = "blue",
     lwd = 2)

legend("topleft", legend = c("2 U", "2 S"), fill = c("red", "blue"), bty = "n")

## Compute the LR for the number of peaks given the
#  number of contributors and the pedigrees
lr = p2U$pf / p2S$pf
data.df = data.frame(log10lr = log10(lr), noa = p2U$noa)

## Plot the LR and a grid so that it's easy to see where
#  the LR becomes greater than 1
plot(log10lr~noa,
     data = data.df,
     axes = FALSE,
     xlab = "Total number of alleles, n",
     ylab = expression(log[10](LR(P[1],P[2]~"|"~N==n))),
     xaxs = "i", yaxs = "i",
     xlim = c(22,93),
     pch = 18)
axis(1)
y.exponents = seq(-20, 15, by = 5)
for(i in 1:length(y.exponents)){
  if(y.exponents[i] == 0)
    axis(2, at=y.exponents[i], labels="1", las = 1)
  else if(y.exponents[i] == 1)
    axis(2, at=y.exponents[i], labels="10", las = 1)
  else
    axis(2, at = y.exponents[i],
         labels = eval(substitute(
           expression(10^y),
           list(y = y.exponents[i]))),
         las = 1)
}
grid()
box()

## Let's look at 2 sibs versus 3 sibs

p3S = pr_total_number_of_distinct_alleles(contributors = c("S1", "S2", "S3"),
                                          freqs = gf_freqs,
                                          pedigree = pedSibs3)
plot(p3S,
     line_col = "green",
     point_col = "green",
     pch = 18,
     lwd = 2,
     ylim = c(0, 0.15),
     xlab = "Total Number of Alleles (TAC)",
     ylab = expression(Pr(N == n~"|"~ P)))

plot(p2S,
     add = TRUE,
     pch = 18,
     point_col = "blue",
     line_col = "blue",
     lwd = 2)
legend("topleft", legend = c("3 S", "2 S"), fill = c("green", "blue"), bty = "n")

## And finally two sibs and one unknown versus three sibs
p2SU = pr_total_number_of_distinct_alleles(contributors = c("S1", "S2", "U1"),
                                           freqs = gf_freqs,
                                           pedigree = pedSibs2)
plot(p3S,
     line_col = "green",
     point_col = "green",
     pch = 18,
     lwd = 2,
     ylim = c(0, 0.15),
     xlab = "Total Number of Alleles (TAC)",
     ylab = expression(Pr(N == n~"|"~ P)))
plot(p2SU,
     add = TRUE,
     pch = 18,
     point_col = "orange",
     line_col = "orange",
     lwd = 2)
legend("topleft", legend = c("3 S", "2 S + U"),
       fill = c("green", "orange"), bty = "n")
</code></pre>

<hr>
<h2 id='pr_independent_alleles'>Compute the probability distribution of the number of independent alleles in a mixture with dropout</h2><span id='topic+pr_independent_alleles'></span>

<h3>Description</h3>

<p>Without dropout, each mixture contributor has two <em>independent</em> but not necessarily <em>distinct</em> alleles that are represented in the DNA mixture. If the probability of dropout for a mixture contributor is greater than zero, then the mixture contributor has either 0 (full dropout), 1 (partial dropout) or 2 (no dropout) independent alleles that are represented in the mixture. This function computes the probability distribution of the number of independent alleles that unrelated mixture contributors have in total for a locus given their dropout parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pr_independent_alleles(dropout_prs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pr_independent_alleles_+3A_dropout_prs">dropout_prs</code></td>
<td>
<p>Numeric vector. Dropout probabilities per contributor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector describing the probability distribution. Numeric values are the probabilities corresponding to the names describing integer values.
</p>


<h3>See Also</h3>

<p><a href="#topic+pr_independent_alleles_ped">pr_independent_alleles_ped</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a dropout pr. of 0.5
p &lt;- pr_independent_alleles(0.5)
stopifnot(all.equal(as.vector(p),
                    c(0.5^2, 2 * 0.5 * 0.5, (1-0.5)^2)))

# one contrib. without dropout and one with d=0.5
p1 &lt;- pr_independent_alleles(c(0, 0.5))
stopifnot(identical(as.integer(names(p1)),
                    as.integer(names(p)) + 2L))
</code></pre>

<hr>
<h2 id='pr_independent_alleles_ped'>Compute the probability distribution of the number of independent alleles in a mixture with dropout and related contributors</h2><span id='topic+pr_independent_alleles_ped'></span>

<h3>Description</h3>

<p>When mixture contributors are related according to a pedigree, they may share some alleles identical by descent so that their total number of <em>independent</em> alleles is smaller than two times the number of contributors. The number of <em>independent</em> alleles can be further reduced if dropout plays a role. This function computes the probability distribution of the number of independent alleles that related mixture contributors have in total for a locus given their dropout parameters. Note that the number of <em>distinct</em> alleles that is observed at the locus is typically smaller than the number of independent alleles due to allele sharing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pr_independent_alleles_ped(pedigree, ped_contributors, dropout_prs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pr_independent_alleles_ped_+3A_pedigree">pedigree</code></td>
<td>
<p><a href="pedtools.html#topic+ped">ped</a> object</p>
</td></tr>
<tr><td><code id="pr_independent_alleles_ped_+3A_ped_contributors">ped_contributors</code></td>
<td>
<p>Character vector with unique names of contributors. Valid names are the names of pedigree members.</p>
</td></tr>
<tr><td><code id="pr_independent_alleles_ped_+3A_dropout_prs">dropout_prs</code></td>
<td>
<p>Numeric vector. Dropout probabilities per contributor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector describing the probability distribution. Numeric values are the probabilities corresponding to the names describing integer values.
</p>


<h3>See Also</h3>

<p><a href="#topic+pr_independent_alleles">pr_independent_alleles</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># without dropout, a father-mother-child mixture has 4 indep. alleles
p &lt;- pr_independent_alleles_ped(pedtools::nuclearPed(),
                                ped_contributors = as.character(1:3),
                                dropout_prs = rep(0, 3))
stopifnot(identical(p,
                    stats::setNames(1., "4")))
</code></pre>

<hr>
<h2 id='pr_number_of_distinct_alleles'>Compute the probability distribution of the number of distinct alleles observed in a DNA mixture for a locus</h2><span id='topic+pr_number_of_distinct_alleles'></span>

<h3>Description</h3>

<p>For a given number of <em>independent</em> alleles, compute the probability distribution of the number of <em>distinct</em> alleles observed in a DNA mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pr_number_of_distinct_alleles(
  number_of_independent_alleles,
  f,
  fst = 0,
  brute_force = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pr_number_of_distinct_alleles_+3A_number_of_independent_alleles">number_of_independent_alleles</code></td>
<td>
<p>Integer. Number of independent alleles in the mixture.</p>
</td></tr>
<tr><td><code id="pr_number_of_distinct_alleles_+3A_f">f</code></td>
<td>
<p>Numeric vector with allele frequencies</p>
</td></tr>
<tr><td><code id="pr_number_of_distinct_alleles_+3A_fst">fst</code></td>
<td>
<p>Numeric value for sub-population correction (also known as theta)</p>
</td></tr>
<tr><td><code id="pr_number_of_distinct_alleles_+3A_brute_force">brute_force</code></td>
<td>
<p>Logical. Should a brute force algorithm be used?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to allele sharing between DNA mixture contributors, the number of <em>distinct</em> alleles observed in a mixture is often less than the number of independent alleles in the mixture. For example, if mixture comprises two unrelated contributors, there are four independent alleles. Some of these four independent alleles may be of the same allelic type so that at least one and at most four distinct alleles are observed.
</p>
<p>This function computes the probability distribution of the number of <em>distinct</em> alleles observed when the mixtures comprises a given number of <em>independent</em> alleles. Optionally, a sub-population correction may be applied by setting <code>fst&gt;0</code>.
</p>
<p>An efficient way of computing the probability distribution was given by Tvedebrink (2014) and was slightly adapted by Kruijver &amp; Curran (2022) to handle the case of an odd number of independent alleles. A much slower brute force algorithm is also implemented (argument <code>brute_force=TRUE</code>) for testing purposes.
</p>


<h3>Value</h3>

<p>A named numeric vector describing the probability distribution. Numeric values are the probabilities corresponding to the names describing integer values.
</p>


<h3>References</h3>

<p>M. Kruijver &amp; J.Curran (2022). 'The number of alleles in DNA mixtures with related
contributors', manuscript submitted
</p>
<p>T. Tvedebrink (2014). 'On the exact distribution of the number of
alleles in DNA mixtures', International Journal of Legal Medicine; 128(3):427&ndash;37.
doi: <a href="https://doi.org/10.1007/s00414-013-0951-3">10.1007/s00414-013-0951-3</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- c(A = 0.1, B = 0.2, C = 0.7)

p &lt;- pr_number_of_distinct_alleles(3, f)
p_by_hand &lt;- c(sum(f^3), 1 - sum(f^3) - 6 * prod(f), 6 * prod(f))
stopifnot(all.equal(as.vector(p), p_by_hand))
</code></pre>

<hr>
<h2 id='pr_total_number_of_distinct_alleles'>Compute the probability distribution of total number of distinct alleles in a DNA mixture</h2><span id='topic+pr_total_number_of_distinct_alleles'></span>

<h3>Description</h3>

<p>Compute the probability distribution of total number of distinct alleles in a DNA mixture
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pr_total_number_of_distinct_alleles(
  contributors,
  freqs,
  pedigree,
  dropout_prs = rep(0, length(contributors)),
  fst = 0,
  loci = names(freqs)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_contributors">contributors</code></td>
<td>
<p>Character vector with unique names of contributors. Valid names are &quot;U1&quot;, &quot;U2&quot;, ... for unrelated contributors or the names of pedigree members for related contributors.</p>
</td></tr>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_freqs">freqs</code></td>
<td>
<p>Allele frequencies (see <a href="#topic+read_allele_freqs">read_allele_freqs</a>)</p>
</td></tr>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_pedigree">pedigree</code></td>
<td>
<p>(optionally) <a href="pedtools.html#topic+ped">ped</a> object</p>
</td></tr>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_dropout_prs">dropout_prs</code></td>
<td>
<p>Numeric vector. Dropout probabilities per contributor. Defaults to zeroes.</p>
</td></tr>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_fst">fst</code></td>
<td>
<p>Numeric. Defaults to 0.</p>
</td></tr>
<tr><td><code id="pr_total_number_of_distinct_alleles_+3A_loci">loci</code></td>
<td>
<p>Character vector of locus names (defaults to names attr. of <code>freqs</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A DNA mixture of <code class="reqn">n</code> contributors contains <code class="reqn">2n</code> <em>independent</em> alleles per locus if the contributors are unrelated; fewer if they are related. This function computes the probability distribution of the total number of <em>distinct</em> alleles observed across all loci. Mixture contributors may be related according to an optionally specified pedigree. Optionally, a sub-population correction may be applied by setting <code>fst&gt;0</code>.
</p>
<p>The case where all contributors are unrelated was discussed by Tvedebrink (2014) and is implemented in the <code>DNAtools</code> package. Kruijver &amp; Curran (2022)
extended this to include related contributors by exploiting the <a href="ribd.html#topic+multiPersonIBD">multiPersonIBD</a> function in the <code>ribd</code> package.
</p>


<h3>Value</h3>

<p>an object of class <code>pf</code>. This is a list containing: </p>

<ul>
<li><p> pf. A named numeric vector describing the probability distribution of the total number of alleles. Numeric values are the probabilities corresponding to the names describing integer values.
</p>
</li>
<li><p> by_locus. A list of probability distributions by locus.
</p>
</li>
<li><p> noa. For convenience, an integer vector with the number of alleles corresponding to the probability distribution pf (the names attribute as integer vector)
</p>
</li>
<li><p> min. For convenience, the minimum of <code>noa</code>
</p>
</li>
<li><p> max. For convenience, the maximum of <code>noa</code>
</p>
</li></ul>



<h3>References</h3>

<p>M. Kruijver &amp; J.Curran (2022). 'The number of alleles in DNA mixtures with related
contributors', manuscript submitted
</p>
<p>T. Tvedebrink (2014). 'On the exact distribution of the number of
alleles in DNA mixtures', International Journal of Legal Medicine; 128(3):427&ndash;37.
doi: <a href="https://doi.org/10.1007/s00414-013-0951-3">10.1007/s00414-013-0951-3</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># define a pedigree of siblings S1 and S2 (and their parents)
ped_sibs &lt;- pedtools::nuclearPed(children = c("S1", "S2"))

# define allele frequencies
freqs &lt;- list(locus1 = c(0.1, 0.9),
              locus2 = c(0.25, 0.5, 0.25))

# compute dist. of number of alleles for two siblings and one unrelated persons
pr_total_number_of_distinct_alleles(contributors = c("S1","S2","U1"), freqs,
                                    pedigree = ped_sibs)

## GlobalFiler example (2 unrelated contributors)
freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
package = "numberofalleles"))

gf_loci &lt;- c("D3S1358", "vWA", "D16S539", "CSF1PO", "TPOX", "D8S1179",
             "D21S11",  "D18S51", "D2S441", "D19S433", "TH01", "FGA",
             "D22S1045", "D5S818", "D13S317", "D7S820", "SE33",
             "D10S1248", "D1S1656", "D12S391", "D2S1338")

p_gf &lt;- pr_total_number_of_distinct_alleles(contributors = c("U1", "U2"),
                                            freqs = freqs, loci = gf_loci)

barplot(p_gf$pf)

</code></pre>

<hr>
<h2 id='read_allele_freqs'>Read allele frequencies in FSIgen format (.csv)</h2><span id='topic+read_allele_freqs'></span>

<h3>Description</h3>

<p>Read allele frequencies in FSIgen format (.csv)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_allele_freqs(filename, remove_zeroes = TRUE, normalise = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_allele_freqs_+3A_filename">filename</code></td>
<td>
<p>Path to csv file.</p>
</td></tr>
<tr><td><code id="read_allele_freqs_+3A_remove_zeroes">remove_zeroes</code></td>
<td>
<p>Logical. Should frequencies of 0 be removed from the return value? Default is TRUE.</p>
</td></tr>
<tr><td><code id="read_allele_freqs_+3A_normalise">normalise</code></td>
<td>
<p>Logical. Should frequencies be normalised to sum to 1? Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Reads allele frequencies from a .csv file. The file should be in FSIgen format, i.e.
comma separated with the first column specifying the allele labels and
one column per locus. The last row should be the number of observations.
No error checking is done since the file format is only loosely defined,
e.g. we do not restrict the first column name or the last row name.
</p>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'># below we read an allele freqs file that comes with the package
filename &lt;- system.file("extdata","FBI_extended_Cauc.csv",package = "numberofalleles")
freqs &lt;- read_allele_freqs(filename)
freqs # the output is just a list with an N attribute
</code></pre>

<hr>
<h2 id='var'>Variance method for objects of class pf</h2><span id='topic+var'></span><span id='topic+var.pf'></span>

<h3>Description</h3>

<p>Variance method for objects of class pf
</p>
<p>Variance method for <code>pf</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var(x, ...)

## S3 method for class 'pf'
var(x, by_locus = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var_+3A_x">x</code></td>
<td>
<p>Object of class <code>pf</code>: output of <a href="#topic+pr_total_number_of_distinct_alleles">pr_total_number_of_distinct_alleles</a></p>
</td></tr>
<tr><td><code id="var_+3A_...">...</code></td>
<td>
<p>other arguments that may p</p>
</td></tr>
<tr><td><code id="var_+3A_by_locus">by_locus</code></td>
<td>
<p>If <code>TRUE</code> then the results will be returned locus by locus</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either a vector of variances, one for each locus, or the sum of the locus variances.
The variances are the variances of the number of alleles observed at each locus.
</p>


<h3>See Also</h3>

<p><a href="#topic+mean.pf">mean.pf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>freqs &lt;- read_allele_freqs(system.file("extdata","FBI_extended_Cauc.csv",
                           package = "numberofalleles"))
p &lt;- pr_total_number_of_distinct_alleles(contributors = c("U1","U2"),
                                         freqs = freqs)
mean(p)
var(p)

</code></pre>

<hr>
<h2 id='variance_number_of_distinct_alleles'>Compute the variance of the number of distinct alleles observed in a DNA mixture for a locus</h2><span id='topic+variance_number_of_distinct_alleles'></span>

<h3>Description</h3>

<p>For a given number of <em>independent</em> alleles, compute the mean and variance of the number of <em>distinct</em> alleles observed in a DNA mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_number_of_distinct_alleles(number_of_independent_alleles, f, fst = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_number_of_distinct_alleles_+3A_number_of_independent_alleles">number_of_independent_alleles</code></td>
<td>
<p>Integer. Number of independent alleles in the mixture.</p>
</td></tr>
<tr><td><code id="variance_number_of_distinct_alleles_+3A_f">f</code></td>
<td>
<p>Numeric vector with allele frequencies</p>
</td></tr>
<tr><td><code id="variance_number_of_distinct_alleles_+3A_fst">fst</code></td>
<td>
<p>Numeric value for sub-population correction (also known as theta)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to allele sharing between DNA mixture contributors, the number of <em>distinct</em> alleles observed in a mixture is often less than the number of independent alleles in the mixture. For example, if mixture comprises two unrelated contributors, there are four independent alleles. Some of these four independent alleles may be of the same allelic type so that at least one and at most four distinct alleles are observed.
</p>
<p>This function computes the probability distribution of the number of <em>distinct</em> alleles observed when the mixtures comprises a given number of <em>independent</em> alleles. Optionally, a sub-population correction may be applied by setting <code>fst&gt;0</code>.
</p>


<h3>Value</h3>

<p>Variance (numeric of length one)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- c(A = 0.1, B = 0.2, C = 0.7)
v &lt;- variance_number_of_distinct_alleles(3, f)

# now compute variance by hand from the full pr. dist of N
p &lt;- pr_number_of_distinct_alleles(3, f)

n &lt;- as.numeric(names(p))
p_n &lt;- as.vector(p)

# compute expected value
ev &lt;- expected_number_of_distinct_alleles(3, f)

# and variance by hand
v2 &lt;- sum(p_n * (n - ev)^2)

stopifnot(all.equal(v,v2))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
