<!DOCTYPE html><html><head><title>Help for package elsa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {elsa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#categorize'><p>Categorizing continious data</p></a></li>
<li><a href='#correlogram'><p>Correlogram of Spatial Data</p></a></li>
<li><a href='#dif2list'><p>Convert differences in the level of categorical map to a list</p></a></li>
<li><a href='#dneigh'><p>Construct neighbours list</p></a></li>
<li><a href='#elsa'><p>Entropy-based Local indicator of Spatial Association</p></a></li>
<li><a href='#elsa.test'><p>Elsa test for local spatial autocorrelation</p></a></li>
<li><a href='#entrogram'><p>Entrogram for Spatial Data</p></a></li>
<li><a href='#Entrogram-class'><p>An S4 class for Entrogram</p></a></li>
<li><a href='#lisa'><p>Local indicators of Spatial Associations</p></a></li>
<li><a href='#moran'><p>Global Spatial Autocorrelation Statistics</p></a></li>
<li><a href='#nclass'><p>Best number of classes for categorizing a continuous variable</p></a></li>
<li><a href='#neighbours-class'><p>An S4 class of neighbour features</p></a></li>
<li><a href='#Variogram'><p>Empirical Variogram from Spatial Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Entropy-Based Local Indicator of Spatial Association</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-28</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-13</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, sp (&ge; 1.2-0), raster, R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework that provides the methods for quantifying entropy-based local indicator of spatial association (ELSA) that can be used for both continuous and categorical data. In addition, this package offers other methods to measure local indicators of spatial associations (LISA). Furthermore, global spatial structure can be measured using a variogram-like diagram, called entrogram. For more information, please check that paper: Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2018.10.001">doi:10.1016/j.spasta.2018.10.001</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://r-gis.net">http://r-gis.net</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/babaknaimi/elsa/issues/">https://github.com/babaknaimi/elsa/issues/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-12 22:57:04 UTC; naimi</td>
</tr>
<tr>
<td>Author:</td>
<td>Babak Naimi <a href="https://orcid.org/0000-0001-5431-2729"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Roger Bivand [ctb] (part of the dnn C code, from the spdep package),
  William Venables [ctb] (part of the dnn C code, taken from the spdep
    package),
  Brian Ripley [ctb] (part of the dnn C code, taken from the spdep
    package)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Babak Naimi &lt;naimi.b@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-19 14:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='categorize'>Categorizing continious data</h2><span id='topic+categorize'></span><span id='topic+categorize+2CRasterLayer-method'></span><span id='topic+categorize+2CRasterStackBrick-method'></span><span id='topic+categorize+2Cnumeric-method'></span><span id='topic+categorize+2Clist-method'></span>

<h3>Description</h3>

<p>A function to categorize (discretize or binning) numerical data in the form of a raster layer, or a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorize(x,nc,probs,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categorize_+3A_x">x</code></td>
<td>
<p> A <code>RasterLayer</code> or a <code>numerical vector</code></p>
</td></tr>
<tr><td><code id="categorize_+3A_nc">nc</code></td>
<td>
<p> Number of classes, if missing, it will be automatically detected</p>
</td></tr>
<tr><td><code id="categorize_+3A_probs">probs</code></td>
<td>
<p> a two-item numeric vector of the lower and upper probabilities within the range of [0,1], e.g., c(0.025, 0.975) (default: NULL) to consider a quantile range of values in categorization (to avoid the effects of outliers); if <code>NULL</code> or <code>FALSE</code>, then the whole range is used.</p>
</td></tr>
<tr><td><code id="categorize_+3A_...">...</code></td>
<td>
<p> Additional parameters for <code><a href="raster.html#topic+writeRaster">writeRaster</a></code> function (<code>filename</code> should be specified as additional argument)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If nc is not specified, the function calls the function <code>nclass</code> to find the best number of classes. For the details of how nclass works, see the reference.
</p>
<p>When outliers do exist in <code>x</code>, it is likely that they affect the quality of categorization. To avoid their affects, a quantile with the specified probabilities can be used. default is recommended: c(0.025,0.975), but to ignore it, you can turn the probs argument to <code>NULL</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>RasterLayer</code></td>
<td>
<p>if x is a <code>RasterLayer</code></p>
</td></tr>
<tr><td><code>numeric vector</code></td>
<td>
<p>if x is a numeric <code>vector</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
categorize(1:10,3) # categorizeing a numeric vector into 3 categories

file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)
plot(r,main='a continuous raster map')
rc &lt;- categorize(r,nc=4)
plot(rc, main='categorized map')

</code></pre>

<hr>
<h2 id='correlogram'>Correlogram of Spatial Data</h2><span id='topic+correlogram'></span><span id='topic+correlogram+2CRasterLayer-method'></span><span id='topic+correlogram+2CSpatial-method'></span>

<h3>Description</h3>

<p>Compute Correlogram of spatial data. The function returns a binned correlogram by calculating Moran's I (spatial autocorrelation) in different range of distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlogram(x, width, cutoff,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correlogram_+3A_x">x</code></td>
<td>
<p> a spatial object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>) </p>
</td></tr>
<tr><td><code id="correlogram_+3A_width">width</code></td>
<td>
<p> the lag size (width of subsequent distance intervals) into which cell pairs are grouped for semivariance estimates. If missing, the cell size (raster resolution) is assigned. </p>
</td></tr>
<tr><td><code id="correlogram_+3A_cutoff">cutoff</code></td>
<td>
<p> spatial separation distance up to which cell pairs are included in semivariance estimates; as a default, the length of the diagonal of the box spanning the data is divided by three. </p>
</td></tr>
<tr><td><code id="correlogram_+3A_...">...</code></td>
<td>
<p>Additional arguments including <code>zcol</code> (when <code>x</code> is Spatial* object, specifies the name of the variable in the dataset; <code>longlat</code> (when <code>x</code> is Spatial* object, spacifies whether the dataset has a geographic coordinate system); <code>s</code> (only when x is a Raster object, it would be useful when the dataset is big, so then by specifying <code>s</code>, the calculation would be based on a sample with size <code>s</code> drawn from the dataset, default is <code>NULL</code> means all cells should be contributed in the calculations)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Correlogram is a graph to explore spatial structure in a single variable. A correlogram summarizes the spatial relations in the data, and can be used to understand within what range (distance) the data is spatially autocorrelated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Correlogram</code></td>
<td>
<p>an object containing Moran's I values within each distance interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)
plot(r,main='a continuous raster map')

co &lt;- correlogram(r, width=2000,cutoff=30000)

plot(co)


</code></pre>

<hr>
<h2 id='dif2list'>Convert differences in the level of categorical map to a list</h2><span id='topic+dif2list'></span><span id='topic+dif2list+2Cdata.frameORmatrix+2CANY-method'></span><span id='topic+dif2list+2Cdata.frameORmatrix-method'></span>

<h3>Description</h3>

<p>This function converts a data.frame including the values specifying the differences (contrast or degrees of dissimilarities) between the classes (categories) in a categoricl map, to a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dif2list(x,pattern,fact=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dif2list_+3A_x">x</code></td>
<td>
<p> a data.frame containing degrees of dissimilarities between different categories</p>
</td></tr>
<tr><td><code id="dif2list_+3A_pattern">pattern</code></td>
<td>
<p>a numeric vector, specifies the pattern the data is organised in x; (only when the number of classes or subclasses is greater than 9; see the examples)</p>
</td></tr>
<tr><td><code id="dif2list_+3A_fact">fact</code></td>
<td>
<p> a numeric value (default = 1), specifies the factor that multiplied to the estimated dissimilarities</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When ELSA is calculated for a categorical map, by default it is assumed that the level of dissimilarities (or level of contrast) between different classes are the same. For example, if a categorical map has four classes of &quot;A&quot;,&quot;B&quot;,&quot;C&quot;, and &quot;D&quot;, dissimilarity or contrast between &quot;A&quot; &amp; &quot;B&quot; is the same as between &quot;A&quot; &amp; &quot;C&quot;, or between &quot;C&quot; &amp; &quot;D&quot;, etc. Sometimes, it is not a valid assumption as some classes might be more similar than the others. For example, a landuse map may contain several classes of forest, and several classes of agriculture. The level of dissimilarity between a class of forest and a class of agriculture is not the same as between two different types of forest.
</p>
<p>ELSA is flexible enough to incorporate different levels of dissimilarity. To do that, a list can be specified in which you specify the contrast or dissimilarity between each class (name of an item in the list) to the other classes (named vector with items corresponsing to the other classes). For instance, list(A=c(A=0,B=1,C=2,D=2), B=c(A=1,B=0,C=2,D=2),...) simply specifies the dissimilarities between class A and class B (the first two items in the list) to the four classes of A, B, C, and D (the vectors assigned to the first and second item in the list). 
</p>
<p>Alternatively, a simple coding approach can be used when the classes can be organised in a hierarchical way (see Naimi et al. (2019) for more details), and if that is the case, a code can be assigned to each class within a data.frame. Then, <code>dif2list</code> function can be used to convert the data.frame to a list with the structure required by the function (like the above example). Using <code>diff2list</code> is not necessary to introduce the differences between different categories, as a user can either specify them directly in a list. However, defining them in a data.frame would be easier specially when the classes are in related in a hierarchical form. 
</p>
<p>In the data.frame required by <code>dif2list</code>, a code is assigned to each class. The code is specified according to a hierarchical structure and the number of levels in it. For instance, a land cover may have four classes including forest broadleaves, forest needle-leaves, cropland rainfed, and cropland irrigated. These four classes can be organised hierarchically at two levels, the first level would be forst and cropland, and the second level would be the name of the classes. The codes assigned to these four classes can be 11, 12, 21, and 22, respectively. The dissimilarities between, for example, classes of 11 &amp; 12 would be 1 and between 11 &amp; 21 would be 2. The estimated dissimilarities can be adjusted by changing the <code>fact</code> that is multiplied to the dissimilarity values.
</p>


<h3>Value</h3>

<p>A list
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># imagine we have a categorical map including 4 classes (values 1:4), and the first two classes
# (i.e., 1 and 2) belong to the major class 1 (so can have legends of 11, 12, respectively), and
# the second two classes (i,e, 3 and 4) belong to the major class 2 (so can have legends of 21,
# and 22 respectively). Then we can construct the data.frame as:

d &lt;- data.frame(g=c(1,2,3,4),leg=c(11,12,21,22))

d

# dif2list generates a list including 4 values each corresponding to each value (class in the map
#, i,e, 1:4). Each item then has a numeric vector containing a relative dissimilarity between the
# main class (the name of the item in the list) and the other classes. If one wants to change 
# the relative dissimilarity between two specific classes, then the list can easily be edited and
# used in the elsa function

dif2list(d)


# As you see in the legend, each value contains a sequence of numbers specifying the class, 
#subclass, sub-subclass, .... and so on in a hierarchical manner (for example, 12 means class 1
# and subclass 2). In case if there is more than 9 classes or subclasses (for example, 112 should
# refer to class 1, and subclass 12, not class 1 , subclass 1, and sub-subclass 2), then the
# pattern should be specified as a vector like c(1,2) means that the length of the major class in
# the hierarchy is 1, while the length of the sub class is 2.

d &lt;- data.frame(g=c(1,2,3,4),leg=c(101,102,201,202))

d

dif2list(d,pattern=c(1,2))

dif2list(d,pattern=c(1,2), fact=2) # dissimilarities are multiplied by 2 (fact=2).

</code></pre>

<hr>
<h2 id='dneigh'>Construct neighbours list</h2><span id='topic+dneigh'></span><span id='topic+neighd'></span><span id='topic+dneigh+2CSpatialPoints-method'></span><span id='topic+dneigh+2CSpatialPolygons-method'></span><span id='topic+dneigh+2Cdata.frameORmatrix-method'></span><span id='topic+neighd+2CSpatialPoints-method'></span><span id='topic+neighd+2CSpatialPolygons-method'></span><span id='topic+neighd+2Cdata.frameORmatrix-method'></span>

<h3>Description</h3>

<p>This function identifies the neighbours features (points or polygons) given the specified distance (in kilometer for geographic coordinates, i.e., if longlat=TRUE; and in the map unit for projected datasets, i.e., if longlat = FALSE) and builds a list of neighbours.
</p>
<p>The neighd function returns a list including distance of each feature to neighbourhood locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dneigh(x,d1,d2,longlat,method,...)

neighd(x,d1,d2,longlat,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dneigh_+3A_x">x</code></td>
<td>
<p> a SpatialPoints, or SpatialPolygons or a matrix (or data.frame) of point coordinates or a SpatialPoints object</p>
</td></tr>
<tr><td><code id="dneigh_+3A_d1">d1</code></td>
<td>
<p> lower local distance bound (if longlat = TRUE, in kilometer; otherwise in the spatial unit of the dataset, e.g., meter) </p>
</td></tr>
<tr><td><code id="dneigh_+3A_d2">d2</code></td>
<td>
<p> upper local distance bound (if longlat = TRUE, in kilometer; otherwise in the spatial unit of the dataset, e.g., meter)</p>
</td></tr>
<tr><td><code id="dneigh_+3A_longlat">longlat</code></td>
<td>
<p> TRUE if point coordinates are longitude-latitude</p>
</td></tr>
<tr><td><code id="dneigh_+3A_method">method</code></td>
<td>
<p>if x is SpatialPolygons, specifies the method to identify the neighbour polygons; see details</p>
</td></tr>
<tr><td><code id="dneigh_+3A_...">...</code></td>
<td>
<p> additional arguments; see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is mostly based on <code>dnearneigh</code> (for points), and <code>poly2nb</code> (for polygons), implemented in the spdep package by Roger Bivand.
</p>
<p>When <code>x</code> is SpatialPolygons, there is two methods (can be specified through <code>method</code>) to identify the neighbour polygons. The default method ('bound') seeks the polygons that has one or more points in their boundaries within the specified distance (<code>d</code>), while the method 'centroid' considers any polygon with a centriod within the given distance.
</p>
<p>One additional argument is queen (default is TRUE), can beused only when x is SpatialPolygons, and method='bound', if TRUE, a single shared boundary point meets the contiguity condition, if FALSE, more than one shared point is required.
</p>
<p><code>neighd</code> for SpatialPolygons returns distances of each polygon to centroids of neighbor polygons.
</p>


<h3>Value</h3>

<p>An object of class <code>neighbours</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
</code></pre>

<hr>
<h2 id='elsa'>Entropy-based Local indicator of Spatial Association</h2><span id='topic+elsa'></span><span id='topic+elsa+2CSpatialPointsDataFrame-method'></span><span id='topic+elsa+2CSpatialPolygonsDataFrame-method'></span><span id='topic+elsa+2CRasterLayer-method'></span>

<h3>Description</h3>

<p>Calculate ELSA statistic for a categorical or continuous spatial dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elsa(x,d,nc,categorical,dif,classes,stat,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elsa_+3A_x">x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code></p>
</td></tr>
<tr><td><code id="elsa_+3A_d">d</code></td>
<td>
<p> numeric local distance, or an object of class neighbours created by dneigh when x is SpatialPoints or SpatialPolygons</p>
</td></tr>
<tr><td><code id="elsa_+3A_nc">nc</code></td>
<td>
<p> optional, for continuous data it specifies the number of classes through categorizing the variable. If missing, it is automatically calculated (recommended)</p>
</td></tr>
<tr><td><code id="elsa_+3A_categorical">categorical</code></td>
<td>
<p> logical, specified whether x is a continuous or categorical. If missed the function tries to detect it</p>
</td></tr>
<tr><td><code id="elsa_+3A_dif">dif</code></td>
<td>
<p>the difference between categories, only for categorical </p>
</td></tr>
<tr><td><code id="elsa_+3A_classes">classes</code></td>
<td>
<p>Optional, only when <code>x</code> is categorical is a character vector contains classes; would be useful when the dataset is part of a bigger dataset or when it does not contain all the categories, then by specifying the full set of categories, they will be taken into account to calculate ELSA, and therefore, it would be comparable with the other dataset with the same list of classes (these classes may alternatively introduce by <code>dif</code>, as the classes considered to specify dissimilarities in <code>dif</code> list, would be used as <code>classes</code>)</p>
</td></tr>
<tr><td><code id="elsa_+3A_stat">stat</code></td>
<td>
<p>specifies which statistic should be calculated by the function; it can be &quot;elsa&quot; (default), or either of the two components of the statistic, &quot;Ea&quot;, or &quot;Ec&quot;; ELSA is the product of Ea and Ec. (it is possible to select more than one statistic); this argument is ignored if <code>x</code> is <code>Spatial*</code> object as all the three statistics are returned (see details)</p>
</td></tr>
<tr><td><code id="elsa_+3A_...">...</code></td>
<td>
<p> additional arguments including: 
</p>
<p><code>cells</code> - a numeric vector to specify for which raster cells the ELSA statistic should be calculated; it works when <code>x</code> is <code>RasterLayer</code>, and if it is specified, ELSA is calculated only for the specified cells;
</p>
<p><code>filename</code> - only if <code>x</code> is <code>RasterLayer</code>, specifies the name of the raster file to be written in the working directory.
</p>
<p><code>zcol</code> - only if <code>x</code> is <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>, specifies the name of the column (variable) in the attribute table for which the elsa statistics are calcualted (i.e., ELSA, Ea, Ec).
</p>
<p><code>drop</code> - logical; only if <code>x</code> is <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>, specifies whether the output should be a data.frame or a <code>Spatial*</code> object.
</p>
<p><code>method</code> - only if <code>SpatialPolygonsDataFrame</code>, specifies the method for identifying the neighbourhood polygons; default: 'centroid' (see <code>dneigh</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>dif can be used when categorical values are sorted into hierarchical system (e.g., CORINE land cover). This make it possible to difine different weights of similarity between each pairs of categories when the level of similarity is not the same between different classes in the variable. For example, two categories belong to two forest types are more similar than two categories, one a forest type and the other one an agriculture type. So, it can take this differences into account when the spatial autocorrelation for categorical variables is quantified.
</p>
<p>the ELSA statistics has two terms, &quot;Ea&quot; and &quot;Ec&quot;, in the reference. It can be specified in the <code>stat</code> argument if either of these terms should be returned from the function or ELSA (&quot;E&quot;), which is the product of these two terms, <code>Ea * Ec</code>. All three terms can also be selected.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Raster*</code></td>
<td>
<p>if <code>x</code> is a <code>RasterLayer</code></p>
</td></tr>
<tr><td><code>Spatial* or data.frame</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)

plot(r, main='a continuous raster map')

e &lt;- elsa(r,d=2000,categorical=FALSE)

plot(e)
</code></pre>

<hr>
<h2 id='elsa.test'>Elsa test for local spatial autocorrelation</h2><span id='topic+elsa.test'></span><span id='topic+elsa.test+2CRasterLayer-method'></span><span id='topic+elsa.test+2CSpatial-method'></span>

<h3>Description</h3>

<p>This function uses a non-parametric approach to test whether local spatial autocorrelation (characterised by ELSA) is significant. It generates a p-value at each spatial location (a raster cell or spatial point/polygon) that can be used to infer the significancy of local spatial autocorrelation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elsa.test(x, d, n, method, null, nc, categorical, dif,classes,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elsa.test_+3A_x">x</code></td>
<td>
<p> A Raster or Spatial* dataset</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_d">d</code></td>
<td>
<p>the local distance, or an object of class neighbours created by dneigh function</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_n">n</code></td>
<td>
<p>number of simulation, default is 999 for small datasets, and 99 for large datasets</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_null">null</code></td>
<td>
<p> Optional, a null distribution of data (a Raster if x is Raster or a numerical vector if x is either Raster or Spatial dataset ); if not provided, a null distribution is generated by the function</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_method">method</code></td>
<td>
<p>resampling method for nonparametric simulation, can be either 'boot' (bootstraping; default) or 'perm' (permutation) </p>
</td></tr>
<tr><td><code id="elsa.test_+3A_nc">nc</code></td>
<td>
<p>number of classes (only if x is a continuous variable); if not specified, it is estimated using nclass function</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_categorical">categorical</code></td>
<td>
<p>logical, specifies whether x is a categorical; if not specified, it is guessed by the function</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_dif">dif</code></td>
<td>
<p>the level of dissimilarities between different categories (only if x is a categorical variable); see <code><a href="#topic+dif2list">dif2list</a></code> for more details</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_classes">classes</code></td>
<td>
<p>Optional, only when <code>x</code> is categorical is a character vector contains classes; would be useful when the dataset is part of a bigger dataset or when it does not contain all the categories, then by specifying the full set of categories, they will be taken into account to calculate ELSA, and therefore, it would be comparable with the other dataset with the same list of classes (these classes may alternatively introduce by <code>dif</code>, as the classes considered to specify dissimilarities in <code>dif</code> list, would be used as <code>classes</code>)</p>
</td></tr>
<tr><td><code id="elsa.test_+3A_...">...</code></td>
<td>
<p>Aditional arguments passed to writeRaster function (applied only when x is Raster)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function test how significant the local spatial autocorrelation is at each location, so it generates a p-value at each location through a Monte Carlo simulation and a non-parametric approach. See the reference for the details about the method.
</p>
<p>If <code>null</code> distribution is not provided, the function generates a null distribution by randomly shuffling the values in the dataset. 
</p>


<h3>Value</h3>

<p>An object same as the input (<code>x</code>)
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file('external/dem_example.grd',package='elsa')

r &lt;- raster(file)

plot(r,main='a continuous raster map')

et &lt;- elsa.test(r,d=2000,n=99, categorical=FALSE)

plot(et)



</code></pre>

<hr>
<h2 id='entrogram'>Entrogram for Spatial Data</h2><span id='topic+entrogram'></span><span id='topic+entrogram+2CRasterLayer-method'></span><span id='topic+entrogram+2CSpatialPointsDataFrame-method'></span><span id='topic+entrogram+2CSpatialPolygonsDataFrame-method'></span>

<h3>Description</h3>

<p>Compute sample (empirical) entrogram from spatial data. The function returns a binned entrogram and an entrogram cloud.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entrogram(x, width, cutoff,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="entrogram_+3A_x">x</code></td>
<td>
<p> a spatial object (<code>RasterLayer</code> or <code>SpatialPoints</code> or <code>SpatialPolygons</code>) </p>
</td></tr>
<tr><td><code id="entrogram_+3A_width">width</code></td>
<td>
<p> the lag size (width of subsequent distance intervals) into which cell pairs are grouped for ELSA estimates. If missing, the cell size (raster resolution) is assigned. </p>
</td></tr>
<tr><td><code id="entrogram_+3A_cutoff">cutoff</code></td>
<td>
<p> spatial separation distance up to which cell pairs are included in ELSA estimates; as a default, the length of the diagonal of the box spanning the data is divided by three. </p>
</td></tr>
<tr><td><code id="entrogram_+3A_...">...</code></td>
<td>
<p>Additional arguments including <code>zcol</code> (when <code>x</code> is Spatial* object, specifies the name of the variable in the dataset; <code>longlat</code> (when <code>x</code> is Spatial* object, spacifies whether the dataset has a geographic coordinate system); <code>s</code> (only when x is a Raster object, it would be useful when the dataset is big, so then by specifying <code>s</code>, the calculation would be based on a sample with size <code>s</code> drawn from the dataset, default is <code>NULL</code> means all cells should be contributed in the calculations)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Entrogram is a variogram-like graph to explore spatial structure in a single variable. An entrogram summarizes the spatial relations in the data, and can be used to understand within what range (distance) the data is spatially autocorrelated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Entrogram</code></td>
<td>
<p>an object containing entrogram cloud and the entrogram within each distance interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)
plot(r,main='a continuous raster map')

en &lt;- entrogram(r, width=2000)

plot(en)



</code></pre>

<hr>
<h2 id='Entrogram-class'>An S4 class for Entrogram</h2><span id='topic+Entrogram-class'></span><span id='topic+Variogram-class'></span><span id='topic+Correlogram-class'></span><span id='topic+data.frameORmatrix-class'></span><span id='topic+matrixORnull-class'></span>

<h3>Description</h3>

<p>An S4 class representing Entrogram dataset generated by <code>entrogram</code> function
</p>


<h3>Slots</h3>


<dl>
<dt><code>width</code></dt><dd><p>the width of susequent distance intervals</p>
</dd>
<dt><code>cutoff</code></dt><dd><p>spatial separation distance up to which point pairs are included in entrogram estimates</p>
</dd>
<dt><code>entrogramCloud</code></dt><dd><p>A matrix containing the elsa for each location and the neighbourhood distance</p>
</dd>
<dt><code>entrogram</code></dt><dd><p>A data.frame containing mean elsa values at each distance interval</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>

<hr>
<h2 id='lisa'>Local indicators of Spatial Associations</h2><span id='topic+lisa'></span><span id='topic+lisa+2CSpatial-method'></span><span id='topic+lisa+2CRasterLayer-method'></span>

<h3>Description</h3>

<p>Calculate local indicators of spatial association (LISA) for a continuous (numeric) variable at each location in a Raster layer or a SpatialPointsDataFrame or a SpatialPolygonsDataFrame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lisa(x,d1,d2,statistic,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lisa_+3A_x">x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code></p>
</td></tr>
<tr><td><code id="lisa_+3A_d1">d1</code></td>
<td>
<p> numeric lower bound of local distance (default=0), or an object of class neighbours created by dneigh when x is SpatialPoints or SpatialPolygons</p>
</td></tr>
<tr><td><code id="lisa_+3A_d2">d2</code></td>
<td>
<p> numeric upper bound of local distance, not needed if d1 is a neighbours object,</p>
</td></tr>
<tr><td><code id="lisa_+3A_statistic">statistic</code></td>
<td>
<p> a character string specifying the LISA statistic that should be calculated. This can be one of &quot;I&quot; (or &quot;localmoran&quot; or &quot;moran&quot;), &quot;c&quot; (or &quot;localgeary&quot; or &quot;geary&quot;), &quot;G&quot; (or &quot;localG&quot;), &quot;G*&quot; (or &quot;localG*&quot;)</p>
</td></tr>
<tr><td><code id="lisa_+3A_...">...</code></td>
<td>
<p> additional arguments including <code>filename</code> (only when x is Raster, specifies the name of the raster file when the output should be written; additional arguments for <code><a href="raster.html#topic+writeRaster">writeRaster</a></code> function can also be specified);
<code>mi</code> (only when x is Raster and <code>statistic='I'</code>, specifies whether raw Local Moran's I statistic (Ii) should be returned, or standardized value (Z.Ii). e.g., mi=&quot;I&quot;, mi='Z' (default)); 
<code>zcol</code> (only when x is a Spatial* object specifies the name of the variable column in the data); 
<code>longlat</code> (logical, only when x is a Spatial* object specifies whether the coordinate system is geographic); 
<code>drop</code> (logical, only when x is a Spatial* object, if TRUE, the original data structure (Spatial* object) is returned, otherwise a numeric vector is returned) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can calculate different LISA statistics at each location in the input dataset. The statistics, implemented in this function, include local Moran's I (&quot;I&quot;), local Geary's c (&quot;c&quot;), local G and G* (&quot;G&quot; and &quot;G*&quot;). This function returns standardized value (Z) for Moran, G and G*.
</p>


<h3>Value</h3>

<table>
<tr><td><code>RasterLayer</code></td>
<td>
<p>if <code>x</code> is a <code>RasterLayer</code></p>
</td></tr>
<tr><td><code>Spatial*</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code> and <code>drop=FALSE</code></p>
</td></tr>
<tr><td><code>numeric vector</code></td>
<td>
<p>if <code>x</code> is a <code>Spatial*</code> and <code>drop=TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
Anselin, L. 1995. Local indicators of spatial association, Geographical Analysis, 27, 93&ndash;115;
</p>
<p>Getis, A. and Ord, J. K. 1996 Local spatial statistics: an overview. In P. Longley and M. Batty (eds) <em>Spatial analysis: modelling in a GIS environment</em> (Cambridge: Geoinformation International), 261&ndash;277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)

plot(r,main='a continuous raster map')

mo &lt;- lisa(r,d2=2000,statistic='i') # local moran's I (Z.Ii value)

plot(mo, main="local Moran's I (Z.Ii)")

mo &lt;- lisa(r,d2=2000,statistic='i',mi='I') # local moran's I (Ii value  (non-standardized))

plot(mo, main="local Moran's I (Ii))")

gc &lt;- lisa(r,d2=2000,statistic='c') # local Geary's c

plot(gc, main="local Geary's c")

g &lt;- lisa(r,d2=2000,statistic='g') # local G

plot(g, main="local G")


</code></pre>

<hr>
<h2 id='moran'>Global Spatial Autocorrelation Statistics</h2><span id='topic+moran'></span><span id='topic+geary'></span><span id='topic+moran+2CSpatial-method'></span><span id='topic+moran+2CRasterLayer-method'></span><span id='topic+geary+2CSpatial-method'></span><span id='topic+geary+2CRasterLayer-method'></span>

<h3>Description</h3>

<p>Functions to calculate Moran's I and Geary's c statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moran(x,d1,d2,...) 
geary(x,d1,d2,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moran_+3A_x">x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code></p>
</td></tr>
<tr><td><code id="moran_+3A_d1">d1</code></td>
<td>
<p> lower bound local distance, or an object of class neighbours created by dneigh when x is SpatialPoints or SpatialPolygons</p>
</td></tr>
<tr><td><code id="moran_+3A_d2">d2</code></td>
<td>
<p> upper bound local distance</p>
</td></tr>
<tr><td><code id="moran_+3A_...">...</code></td>
<td>
<p> additional arguments including <code>zcol</code> (when <code>x</code> is Spatial* object, specifies the name of the variable in the dataset; <code>longlat</code> (when <code>x</code> is Spatial* object, spacifies whether the dataset has a geographic coordinate system</p>
</td></tr>
</table>


<h3>Details</h3>

<p>moran and geary are two functions to measure global spatial autocorrelation within the range of distance specified through d1 and d2. It returns a single numeric value than can show the degree of spatial autocorrelation in the whole dataset.
</p>


<h3>Value</h3>

<p>A numeric value.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)

moran(r, d1=0, d2=2000)

geary(r, d1=0, d2=2000)
</code></pre>

<hr>
<h2 id='nclass'>Best number of classes for categorizing a continuous variable</h2><span id='topic+nclass'></span><span id='topic+nclass+2CRasterLayer-method'></span><span id='topic+nclass+2Cnumeric-method'></span>

<h3>Description</h3>

<p>This function explores the best number of classes to categorize (discretize) a continuous variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nclass(x,th,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nclass_+3A_x">x</code></td>
<td>
<p> a RasterLayer or a numeric vector</p>
</td></tr>
<tr><td><code id="nclass_+3A_th">th</code></td>
<td>
<p>A threshold (default = 0.005) used to find the best number of classes</p>
</td></tr>
<tr><td><code id="nclass_+3A_...">...</code></td>
<td>
<p>Additional arguments; currently probs implemented that specifies which extreme values (outliers) should be ignored; specified as a percentile probabilities, e.g., c(0.005,0.995), default is NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses an approach introduced in Naimi et al. (under review), to find the best number of classes (categories) when a continuous variable is discretizing. The threhold is corresponding to the acceptable level of information loose through discretizing procedure. For the details, see the reference.
</p>


<h3>Value</h3>

<p>An object with the same class as the input <code>x</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)
plot(r,main='a continuous raster map')

nclass(r)

nclass(r, th=0.01)

nclass(r, th=0.1)
</code></pre>

<hr>
<h2 id='neighbours-class'>An S4 class of neighbour features</h2><span id='topic+neighbours-class'></span>

<h3>Description</h3>

<p>An S4 class representing a list of neighbour features generated by <code>dneigh</code> function
</p>


<h3>Slots</h3>


<dl>
<dt><code>distance1</code></dt><dd><p>the distance from which the neighbour features are seeked</p>
</dd>
<dt><code>distance2</code></dt><dd><p>the distance up to which the neighbour features are seeked</p>
</dd>
<dt><code>neighbours</code></dt><dd><p>A list containing numeric vectors each specifies which the neighbours for the corresponsing feature</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>

<hr>
<h2 id='Variogram'>Empirical Variogram from Spatial Data</h2><span id='topic+Variogram'></span><span id='topic+Variogram+2CRasterLayer-method'></span><span id='topic+Variogram+2CSpatial-method'></span>

<h3>Description</h3>

<p>Compute sample (empirical) variogram from spatial data. The function returns a binned variogram and a variogram cloud.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Variogram(x, width, cutoff,...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Variogram_+3A_x">x</code></td>
<td>
<p> a spatial object (<code>RasterLayer</code> or <code>SpatialPointsDataFrame</code> or <code>SpatialPolygonsDataFrame</code>) </p>
</td></tr>
<tr><td><code id="Variogram_+3A_width">width</code></td>
<td>
<p> the lag size (width of subsequent distance intervals) into which cell pairs are grouped for semivariance estimates. If missing, the cell size (raster resolution) is assigned. </p>
</td></tr>
<tr><td><code id="Variogram_+3A_cutoff">cutoff</code></td>
<td>
<p> spatial separation distance up to which cell pairs are included in semivariance estimates; as a default, the length of the diagonal of the box spanning the data is divided by three. </p>
</td></tr>
<tr><td><code id="Variogram_+3A_...">...</code></td>
<td>
<p>Additional arguments including <code>cloud</code> that specifies whether a variogram cloud should be included to the output (default is <code>FALSE</code>), <code>zcol</code> (when <code>x</code> is Spatial* object, specifies the name of the variable in the dataset; <code>longlat</code> (when <code>x</code> is Spatial* object, spacifies whether the dataset has a geographic coordinate system; <code>s</code> (only when x is a Raster object, it would be useful when the dataset is big, so then by specifying <code>s</code>, the calculation would be based on a sample with size <code>s</code> drawn from the dataset, default is <code>NULL</code> means all cells should be contributed in the calculations) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variogram is a graph to explore spatial structure in a single variable. A variogram summarizes the spatial relations in the data, and can be used to understand within what range (distance) the data is spatially autocorrelated.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Variogram</code></td>
<td>
<p>an object containing variogram cloud and the variogram within each distance interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="http://r-gis.net">http://r-gis.net</a>
</p>


<h3>References</h3>

<p>Naimi, B., Hamm, N. A., Groen, T. A., Skidmore, A. K., Toxopeus, A. G., &amp; Alibakhshi, S. (2019). ELSA: Entropy-based local indicator of spatial association. Spatial statistics, 29, 66-88.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file('external/dem_example.grd',package='elsa')
r &lt;- raster(file)
plot(r,main='a continuous raster map')

en &lt;- Variogram(r, width=2000)

plot(en)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
