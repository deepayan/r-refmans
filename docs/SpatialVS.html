<!DOCTYPE html><html lang="en"><head><title>Help for package SpatialVS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpatialVS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#control.default'><p>Global variable of spatial variable selection, contains optimization tuning</p>
parameters.</a></li>
<li><a href='#lyme.svs.eco0.dat'><p>The Lyme disease dataset with Eco id=0</p></a></li>
<li><a href='#lyme.svs.eco1.dat'><p>The Lyme disease dataset with Eco id=1</p></a></li>
<li><a href='#small.test.dat'><p>A small dataset for fast testing of functions</p></a></li>
<li><a href='#SpatialVS'><p>Function for spatial variable selection</p></a></li>
<li><a href='#SpatialVS.summary'><p>Function for spatial variable selection's summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatial Variable Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Yili Hong, Li Xu, Yimeng Xie, and Zhongnan Jin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yili Hong &lt;yilihong@vt.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform variable selection for the spatial Poisson regression model under the adaptive elastic net penalty. Spatial count data with covariates is the input. We use a spatial Poisson regression model to link the spatial counts and covariates. For maximization of the likelihood under adaptive elastic net penalty, we implemented the penalized quasi-likelihood (PQL) and the approximate penalized loglikelihood (APL) methods. The proposed methods can automatically select important covariates, while adjusting for possible spatial correlations among the responses. More details are available in Xie et al. (2018, &lt;<a href="https://doi.org/10.48550/arXiv.1809.06418">doi:10.48550/arXiv.1809.06418</a>&gt;). The package also contains the Lyme disease dataset, which consists of the disease case data from 2006 to 2011, and demographic data and land cover data in Virginia. The Lyme disease case data were collected by the Virginia Department of Health. The demographic data (e.g., population density, median income, and average age) are from the 2010 census. Land cover data were obtained from the Multi-Resolution Land Cover Consortium for 2006.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS,nlme, fields</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-10 00:19:18 UTC; yilihong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-11-10 05:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='control.default'>Global variable of spatial variable selection, contains optimization tuning
parameters.</h2><span id='topic+control.default'></span>

<h3>Description</h3>

<p>control.default is a list that gives the default setting for the optimization procedures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control.default
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>maxIter</code></dt><dd><p>maximum number of iterations in the <a href="#topic+SpatialVS">SpatialVS</a></p>
</dd>
<dt><code>iwls</code></dt><dd><p>convergence criterion for the iterative weighted least squares</p>
</dd>
<dt><code>tol1</code></dt><dd><p>convergence criteria for beta estimation in <a href="#topic+SpatialVS">SpatialVS</a></p>
</dd>
<dt><code>tol2</code></dt><dd><p>convergence criteria for theta estimation in <a href="#topic+SpatialVS">SpatialVS</a></p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>control.default=list(maxIter=200,iwls=10^(-4),tol1=10^(-3),tol2=10^(-3))
</code></pre>

<hr>
<h2 id='lyme.svs.eco0.dat'>The Lyme disease dataset with Eco id=0</h2><span id='topic+lyme.svs.eco0.dat'></span><span id='topic+distmat.compute'></span>

<h3>Description</h3>

<p>The Lyme disease dataset contains case data from 2006 to 2011 demographic
data and land cover data in Virginia. Lyme disease case data were collected by Virginia Department of Health.
Eco id = 0 represents northern/western subregion, which includes Northern Piedmont, Blue Ridge, Ridge and Valley, and Central Appalachian.
</p>
<p>The column names of X are listed as follows. The first column is the intercept column.
</p>
<p>x1: Dvlpd_NLCD06; Percentage of developed land in each census tract
</p>
<p>x2: Forest_NLCD06; Percentage of forest in each census tract
</p>
<p>x3: Herbaceous_NLCD06; Percentage of herbaceous in each census tract
</p>
<p>x4: X.Water_NLCD06; Percentage of water in each census tract
</p>
<p>x5: Tract_Frag06; Sum of area of forested fragments in each census tract divided by the total area
</p>
<p>x6: FragPerim06; Sum of forest fragment perimeters in each census tract divided by the total area
</p>
<p>x7: CWED_DF06; CWED of developed-forest edge
</p>
<p>x8: TECI_DF06; TECI of developed-forest edge
</p>
<p>x9: CWED_FH06; CWED of forest-herbaceous edge
</p>
<p>x10: TECI_FH06; TECI of forest-herbaceous edge
</p>
<p>x11: CWED_HD06; CWED of herbaceous-developed edge
</p>
<p>x12: TECI_HD06; TECI of herbaceous-developed edge
</p>
<p>x13: Pop_den; Tract population density in 2010
</p>
<p>x14: Median_age; Median age at each census tract in 2010
</p>
<p>x15: Mean_income; Mean income (inflation adjusted) at each census tract in 2010
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lyme.svs.eco0.dat
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>y</code></dt><dd><p>integer vector, output count, each element represents the disease count in one census tract.</p>
</dd>
<dt><code>X</code></dt><dd><p>Numeric matrix, matrix of covariates, includes percentage of developed land in each census tract, percentage of forest in each census tract, etc.</p>
</dd>
<dt><code>offset</code></dt><dd><p>Numeric vector, vector for offset values, each element represents the log of population divided by 20,000 in census tract.</p>
</dd>
<dt><code>location</code></dt><dd><p>Numeric matrix, location for each census tract.</p>
</dd>
<dt><code>geoid</code></dt><dd><p>Numeric vector, geo id for each census tract.</p>
</dd>
</dl>


<h3>References</h3>

<p>Xie, Y., Xu, L., Li, J., Deng, X., Hong, Y., Kolivras, K., and Gaines, D. N. (2018). Spatial Variable Selection and An Application to Virginia Lyme Disease Emergence. Preprint, arXiv:1809.06418 [stat.AP].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("lyme.svs.eco0")
lyme.svs.eco0.dat$dist=distmat.compute(location=lyme.svs.eco0.dat$location, dist.min=0.4712249)

</code></pre>

<hr>
<h2 id='lyme.svs.eco1.dat'>The Lyme disease dataset with Eco id=1</h2><span id='topic+lyme.svs.eco1.dat'></span>

<h3>Description</h3>

<p>The Lyme disease dataset contains case data from 2006 to 2011 demographic
data and land cover data in Virginia. Lyme disease case data were collected by Virginia Department of Health.
Eco id = 1 represents the southern/eastern subregion, which includes Piedmont, Middle Atlantic Coastal Plain, and Southeastern Plains.
</p>
<p>The column names of X are listed as follows. The first column is the intercept column.
</p>
<p>x1: Dvlpd_NLCD06; Percentage of developed land in each census tract
</p>
<p>x2: Forest_NLCD06; Percentage of forest in each census tract
</p>
<p>x3: Herbaceous_NLCD06; Percentage of herbaceous in each census tract
</p>
<p>x4: X.Water_NLCD06; Percentage of water in each census tract
</p>
<p>x5: Tract_Frag06; Sum of area of forested fragments in each census tract divided by the total area
</p>
<p>x6: FragPerim06; Sum of forest fragment perimeters in each census tract divided by the total area
</p>
<p>x7: CWED_DF06; CWED of developed-forest edge
</p>
<p>x8: TECI_DF06; TECI of developed-forest edge
</p>
<p>x9: CWED_FH06; CWED of forest-herbaceous edge
</p>
<p>x10: TECI_FH06; TECI of forest-herbaceous edge
</p>
<p>x11: CWED_HD06; CWED of herbaceous-developed edge
</p>
<p>x12: TECI_HD06; TECI of herbaceous-developed edge
</p>
<p>x13: Pop_den; Tract population density in 2010
</p>
<p>x14: Median_age; Median age at each census tract in 2010
</p>
<p>x15: Mean_income; Mean income (inflation adjusted) at each census tract in 2010
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lyme.svs.eco1.dat
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>y</code></dt><dd><p>integer vector, output count, each element represents the disease count in one census tract.</p>
</dd>
<dt><code>X</code></dt><dd><p>Numeric matrix, matrix of covariates, includes percentage of developed land in each census tract, percentage of forest in each census tract, etc.</p>
</dd>
<dt><code>offset</code></dt><dd><p>Numeric vector, vector for offset values, each element represents the log of population divided by 20,000 in census tract.</p>
</dd>
<dt><code>location</code></dt><dd><p>Numeric matrix, location for each census tract.</p>
</dd>
<dt><code>geoid</code></dt><dd><p>Numeric vector, geo id for each census tract.</p>
</dd>
</dl>


<h3>References</h3>

<p>Xie, Y., Xu, L., Li, J., Deng, X., Hong, Y., Kolivras, K., and Gaines, D. N. (2018). Spatial Variable Selection and An Application to Virginia Lyme Disease Emergence. Preprint, arXiv:1809.06418 [stat.AP].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("lyme.svs.eco1")
lyme.svs.eco1.dat$dist=distmat.compute(location=lyme.svs.eco1.dat$location, dist.min=0.2821849)

</code></pre>

<hr>
<h2 id='small.test.dat'>A small dataset for fast testing of functions</h2><span id='topic+small.test.dat'></span>

<h3>Description</h3>

<p>Simulated data for fast testing of the functions. A list contains integer
responses, model matrix, distance matrix, and offset term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>small.test.dat
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>y</code></dt><dd><p>Integer vector, the response variable, which is count data.</p>
</dd>
<dt><code>X</code></dt><dd><p>Numeric matrix, the model matrix contains covariate information.</p>
</dd>
<dt><code>offset</code></dt><dd><p>Numeric vector, vector for offset values.</p>
</dd>
<dt><code>dist</code></dt><dd><p>Numeric matrix, a matrix for pairwise distance.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>data("small.test")

#Here is a toy example for creating a data object that can be used for
#generating dat.obj for SpatialVS function
n=20
#simulate counts data
y=rpois(n=n, lambda=1)
#simulate covariate matrix
x1=rnorm(n)
x2=rnorm(n)
X=cbind(1, x1, x2)
#compute distance matrix from some simulated locations
loc_x=runif(n)
loc_y=runif(n)
dist=matrix(0,n, n)
for(i in 1:n)
{
  for(j in 1:n)
  {
    dist[i,j]=sqrt((loc_x[i]-loc_x[j])^2+(loc_y[i]-loc_y[j])^2)
  }
}

#assume offset is all zero
offset=rep(0, n)

#assemble the data object for SpatialVS

dat.obj=list(y=y, X=X, dist=dist, offset=offset)


</code></pre>

<hr>
<h2 id='SpatialVS'>Function for spatial variable selection</h2><span id='topic+SpatialVS'></span>

<h3>Description</h3>

<p>Perform variable selection for the spatial Poisson regression model under adaptive elastic net penalty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatialVS(dat.obj, alpha.vec = seq(0.6, 1, by = 0.05),
  lambda.vec = seq(0.15, 1, len = 50), method = "PQL", plots = F,
  intercept = T, verbose = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatialVS_+3A_dat.obj">dat.obj</code></td>
<td>
<p>List, input data. Must contains:
</p>

<ol>
<li> <p><code>X</code> numeric matrix, the covariates.
</p>
</li>
<li> <p><code>y</code> integer vector, the response in counts.
</p>
</li>
<li> <p><code>dist</code> numeric matrix, the distance matrix.
</p>
</li>
<li> <p><code>offset</code> numeric vector, the offset item.
</p>
</li></ol>
</td></tr>
<tr><td><code id="SpatialVS_+3A_alpha.vec">alpha.vec</code></td>
<td>
<p>numeric vector, a vector of possible values of regularization parameter. The range is [0,1].</p>
</td></tr>
<tr><td><code id="SpatialVS_+3A_lambda.vec">lambda.vec</code></td>
<td>
<p>numeric vector, a vector of positive values of regularization parameter. </p>
</td></tr>
<tr><td><code id="SpatialVS_+3A_method">method</code></td>
<td>
<p>string, the method to be used. Options are:
</p>

<ol>
<li> <p><code>"PQL"</code> penalized quasi-likelihood method that considers spatial correlation.
</p>
</li>
<li> <p><code>"PQL.nocor"</code> penalized quasi-likelihood method that ignores spatial correlation.
</p>
</li>
<li> <p><code>"APL"</code> approximate penalized loglikelihood method that considers spatial correlation.
</p>
</li>
<li> <p><code>"APL.nocor"</code> approximate penalized loglikelihood method that ignores spatial correlation.
</p>
</li></ol>
</td></tr>
<tr><td><code id="SpatialVS_+3A_plots">plots</code></td>
<td>
<p>bool, if <code>True</code>, contour plot of AIC/BIC values is generated.</p>
</td></tr>
<tr><td><code id="SpatialVS_+3A_intercept">intercept</code></td>
<td>
<p>bool, if <code>True</code>, an intercept item will be included in model.</p>
</td></tr>
<tr><td><code id="SpatialVS_+3A_verbose">verbose</code></td>
<td>
<p>bool, if <code>True</code>, various updates are printed during each iteration of the algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 13 items:
</p>

<ol>
<li> <p><code>dat.obj</code>, List, a copy of the <code>dat.obj</code> input.
</p>
</li>
<li> <p><code>start</code>, Initial values of parameters given by glmmPQL().
</p>
</li>
<li> <p><code>L.obj</code>,  Regression coefficients under each <code>alpha.vec</code> and <code>lambda.vec</code>, under the adaptive elastic net.
</p>
</li>
<li> <p><code>Lout.obj</code>, AIC and BIC values under each <code>L.obj value</code>, under the adaptive elastic net.
</p>
</li>
<li> <p><code>contour.out.obj</code>, Object used to generate contour plot as a function of <code>alpha.vec</code> and <code>lambda.vec</code>, with  AIC or BIC as the output. Used to choose best penalty parameter, under the adaptive elastic net.
</p>
</li>
<li> <p><code>L.best.obj</code>, Model fitting results under the best chosen <code>alpha.vec</code> and <code>lambda.vec</code>, under the adaptive elastic net.
</p>
</li>
<li> <p><code>Lout.best.obj</code>, Best BIC value for <code>L.best.obj</code>.
</p>
</li>
<li> <p><code>L.EN.obj, Lout.EN.obj, contour.out.EN.obj, L.EN.best.obj</code>, Similar items but under the elastic penalty.
</p>
</li>
<li> <p><code>lasso.weight</code>, Numeric, specifies the adaptive Lasso weight.
</p>
</li>
<li> <p><code>method</code>, String, the method used for computing the approximate likelihood function.
</p>
</li></ol>



<h3>References</h3>

<p>Xie, Y., Xu, L., Li, J., Deng, X., Hong, Y., Kolivras, K., and Gaines, D. N. (2018). Spatial Variable Selection and An Application to Virginia Lyme Disease Emergence. Preprint, arXiv:1809.06418 [stat.AP].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#use small.test.dat as the input to fit the spatial Poisson regression model.
#a grid of alpha.vec and lambda.vec is typically used.
#Here one point of alpha.vec and lambda.vec is used for fast illustration.

test.fit&lt;-SpatialVS(dat.obj=small.test.dat, alpha.vec=0.5,
lambda.vec=5, method="PQL", intercept=TRUE, verbose=FALSE)
</code></pre>

<hr>
<h2 id='SpatialVS.summary'>Function for spatial variable selection's summary</h2><span id='topic+SpatialVS.summary'></span>

<h3>Description</h3>

<p>return the summarized parameter estimates from the <a href="#topic+SpatialVS">SpatialVS</a> procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatialVS.summary(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpatialVS.summary_+3A_obj">obj</code></td>
<td>
<p>List, returned by <a href="#topic+SpatialVS">SpatialVS</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector contains the final estimates of parameters. The estimates of theta are in log scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
test.fit&lt;-SpatialVS(dat.obj=small.test.dat, alpha.vec=0.5, lambda.vec=5,
method="PQL", intercept=TRUE, verbose=FALSE)
SpatialVS.summary(test.fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
