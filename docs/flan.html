<!DOCTYPE html><html><head><title>Help for package flan</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flan}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#flan-package'><p>Fluctuation analysis of mutant cell counts</p></a></li>
<li><a href='#boeal'><p>Number of nalidixic acid-resistant mutants from Boe et al. (1994)</p></a></li>
<li><a href='#david'><p>Mutant counts and final numbers from H. L. David (1970)</p></a></li>
<li><a href='#draw.clone'><p>Graphic representation of clone growing upon a finite time.</p></a></li>
<li><a href='#flan.test'><p>Fluctuation Analysis parametric testing</p></a></li>
<li><a href='#luriadel'><p>Resistant bacteria counts from Luria and Delbruck (1943)</p></a></li>
<li><a href='#mutestim'><p>Fluctuation Analysis parametric estimation</p></a></li>
<li><a href='#number of mutant cells distribution'><p>The distribution of mutant cell counts</p></a></li>
<li><a href='#roster'><p>Mutant counts from Rosche and Foster (2000)</p></a></li>
<li><a href='#werhoff'><p>Rifampin-resistant mutant counts from Werngren and Hoffner (2003)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-26</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>FLuctuation ANalysis on Mutation Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrien Mazoyer [aut, cre],
  Remy Drouilhet [aut],
  Stephane Despreaux [aut],
  Bernard Ycart [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrien Mazoyer &lt;adrien.mazoyer@math.univ-toulouse.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for fluctuations analysis of mutant cells counts. Main reference is A. Mazoyer, R. Drouilhet, S. Despreaux and B. Ycart (2017)  &lt;<a href="https://doi.org/10.32614%2FRJ-2017-029">doi:10.32614/RJ-2017-029</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>, <a href="https://github.com/AdriMaz/flan">https://github.com/AdriMaz/flan</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AdriMaz/flan/issues">https://github.com/AdriMaz/flan/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.5), methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppGSL</td>
</tr>
<tr>
<td>RcppModules:</td>
<td>flan_module</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU GSL</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-03 18:36:15 UTC; AdrienMazoyer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-07 07:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='flan-package'>Fluctuation analysis of mutant cell counts</h2><span id='topic+flan-package'></span><span id='topic+flan'></span>

<h3>Description</h3>

<p>Statistical tools for fluctuation analysis of mutant cells counts.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> flan</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 0.9</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2021-05-26</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>This package contains functions dedicated to :
</p>
<p>- Distribution (dflan, pflan, qflan, and rflan): built as the classic distribution functions, like dnorm, pnorm, qnorm, and rnorm.
</p>
<p>- Parametric estimation (mutestim): estimates of the parameters of interest, which are the mean number of mutations (or the mutation probability) and the fitness parameter.
</p>
<p>- Parametric testing (flan.test): built as the classic test functions, like t.test.
</p>


<h3>Author(s)</h3>

<p>Adrien Mazoyer, Rémy Drouilhet, Stéphane Despréaux, and Bernard Ycart
</p>
<p>Maintainer: Adrien Mazoyer &lt;adrien.mazoyer@math.univ-toulouse.fr&gt;
</p>


<h3>References</h3>

<p>A. Mazoyer: Fluctuation analysis on mutation models with birth-date dependence
Math. Biosci. (2018)
</p>
<p>A. Mazoyer: Time inhomogeneous mutation models with birth-date dependence
B. Math. Biol. (2017)
</p>
<p>A. Mazoyer, R. Drouilhet, S. Despréaux and B. Ycart: flan: An R Package for Inference on Mutation Models.
R Journal 9(1) (2017)
</p>
<p>B. Ycart and N. Veziris: Unbiased estimates of mutation rates under fluctuating final counts.
PLoS one 9(7) e101434 (2014)
</p>
<p>B. Ycart: Fluctuation analysis with cell deaths.
J. Applied Probab. Statist, 9(1):12-28 (2014)
</p>
<p>B. Ycart: Fluctuation analysis: can estimates be trusted?
One PLoS one 8(12) e80958 (2013)
</p>
<p>A. Hamon and B. Ycart: Statistics for the Luria-Delbrück distribution.
Elect. J. Statist., 6:1251-1272 (2012)
</p>

<hr>
<h2 id='boeal'>Number of nalidixic acid-resistant mutants from Boe et al. (1994)</h2><span id='topic+boeal'></span>

<h3>Description</h3>

<p>Samples from Table 4 p. 2784-2785 of Boe and al (1994).
</p>
<p>Plates with more than 512 mutants could not be counted with precision, hence the value 512 must be understood as &ldquo;512 or more&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(boeal)
</code></pre>


<h3>Format</h3>

<p>A list of 23 samples of mutants counts, each named &quot;B&lt;index of the sample&gt;&quot;.
</p>
<p>The i-th sample of the list includes the i-th column of the table.
</p>


<h3>Source</h3>

<p>L. Boe, T. Tolker-Nielsen, K. M. Eegholm, H. Spliid, and A. Vrang:  Fluctuation analysis of mutations to nalidixic acid resistance in <em>Escherichia Coli</em>, <em>J. Bacteriol.</em>, 176(10):2781-2787 (1994)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b &lt;- unlist(boeal)              # concatenate all samples
ml &lt;- mutestim(b)               # maximum likelihood
gf &lt;- mutestim(b,method="GF")   # generating function
p0 &lt;- mutestim(b,method="P0")   # P0 method
cbind(ml,gf,p0)                 # compare 3 methods

                                # test values of mutations and fitness
flan.test(b,alternative=c("greater","less"),mutations0=0.6,fitness0=1)

b1 &lt;- unlist(boeal[1:10])       # first 10 samples
b2 &lt;- unlist(boeal[11:20])      # next 10 samples
flan.test(list(b1,b2))          # test equality
</code></pre>

<hr>
<h2 id='david'>Mutant counts and final numbers from H. L. David (1970)</h2><span id='topic+david'></span>

<h3>Description</h3>

<p>Samples from Table 1 and 2 of H. L. David (1970).
</p>
<p>Classes have been replaced by medians, 1000 for the last class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(david)
</code></pre>


<h3>Format</h3>

<p>A list of 11 lists named &quot;D&lt;index of the sample&gt;&quot;. Each list includes :
</p>

<ul>
<li> <p><code>sample</code> A sample of mutants counts.
</p>
</li>
<li> <p><code>fn</code> : the mean final numbers of cells, or a sample of final numbers (only for the last one).
</p>
</li></ul>

<p>The i-th sample of the list includes the i-th column of Table 1, except the last sample which includes Table 2.
</p>


<h3>Source</h3>

<p>H. L. David, Probability distribution of drug-resistant mutants in unselected populations of 
<em>Mycobacterium tuberculosis</em>. <em>Appl. Microbiol.</em>, 20(5):810-814 (1970).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># samples 1-10 only give mean final numbers
D1 &lt;- david[[1]]; D1
# estimate mutation probability
mutestim(D1$mc,mfn=D1$mfn)

# sample 11 has individual final numbers
D11 &lt;- david[[11]]; D11
# with mean final number
mutestim(D11$mc,mfn=mean(D11$fn))
# with true final numbers
mutestim(D11$mc,D11$fn)
</code></pre>

<hr>
<h2 id='draw.clone'>Graphic representation of clone growing upon a finite time.</h2><span id='topic+draw.clone'></span>

<h3>Description</h3>

<p>Simulates a clone up to a time t and represents the clone as a binary tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  draw.clone(t,mutprob=1.e-2,fitness=1.,death=0.,
	     dist=list("lnorm",meanlog=-0.3795851,sdlog=0.3016223),
	     col=c("green4","orange4"),
       with.lab = TRUE,
       with.pch = FALSE
     )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.clone_+3A_t">t</code></td>
<td>
<p> time of end of experiment . </p>
</td></tr>
<tr><td><code id="draw.clone_+3A_mutprob">mutprob</code></td>
<td>
<p> mutation probability: numeric between 0 and 1. By default 1.e-2. </p>
</td></tr>
<tr><td><code id="draw.clone_+3A_fitness">fitness</code></td>
<td>
<p> fitness parameter: numeric positive. By default 1. </p>
</td></tr>
<tr><td><code id="draw.clone_+3A_death">death</code></td>
<td>
<p> death probability: numeric between 0 and 0.5. By default 0. </p>
</td></tr>
<tr><td><code id="draw.clone_+3A_dist">dist</code></td>
<td>
<p> lifetime distribution for mutant cells. See Details. </p>
</td></tr>
<tr><td><code id="draw.clone_+3A_col">col</code></td>
<td>
<p> vector of size 2 of colors. The first is for the normal cells, the second for the mutant cells. </p>
</td></tr></table>
<p>,
</p>
<table>
<tr><td><code id="draw.clone_+3A_with.lab">with.lab</code></td>
<td>
<p> logical. If TRUE, parameters will appear as title. </p>
</td></tr></table>
<p>,
</p>
<table>
<tr><td><code id="draw.clone_+3A_with.pch">with.pch</code></td>
<td>
<p> logical. If TRUE, mutant cells will be represented with triangles, normal cells with regular dots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not provide a representation of a realistic realization of a mutation model (mutation probability too high, time of end of experiment to small).
</p>
<p>The argument <code>dist</code> is a list beginning with the distribution name followed by its parameters, and must be one the 4 following distributions: &quot;dirac&quot;, &quot;exp&quot;, &quot;lnorm&quot;(meanlog, sdlog), &quot;gamma&quot;(shape, scale).
Note that the parameters related to the &quot;dirac&quot; and &quot;exp&quot; cases are directly computed with inputs <code>fitness</code> and <code>death</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rflan">rflan</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Luria-Delbrück model, mutation probability 1e-2, fitness 1
draw.clone(t=9,dist=list(name="exp",rate=1))

# Luria-Delbrück model, mutation probability 0.1, fitness 0.6
draw.clone(t=9,mutprob=0.1,fitness=0.6,dist=list(name="exp",rate=1))

# Haldane model, mutation probability 1e-2, fitness 1
draw.clone(t=7,dist=list(name="dirac",location=1))

# Lognormal lifetime distribution
draw.clone(t=7,fitness=0.5,death=0.1)

# Luria-Delbrück model with positive cell death probability
draw.clone(t=7,dist=list(name="exp",rate=1),death=0.2)

</code></pre>

<hr>
<h2 id='flan.test'>Fluctuation Analysis parametric testing</h2><span id='topic+flan.test'></span>

<h3>Description</h3>

<p>Performs one-sample and two-sample Fluctuation Analysis tests on mutant counts. Returns confidence intervals and p-values, based on asymptotic normality, from the values returned by <code>mutestim</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  flan.test(mc, fn = NULL, mfn = NULL, cvfn = NULL,
               fitness = NULL, death = 0., plateff = 1.,
               model = c("LD", "H", "I"), muinf = +Inf,
               mutations0 = 1., mutprob0 = NULL, fitness0 = 1.,
               conf.level = 0.95,
               alternative = c("two.sided", "less", "greater"),
               method = c("ML", "GF", "P0"), winsor = 2000
               )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flan.test_+3A_mc">mc</code></td>
<td>
<p> a numeric vector of mutant counts or a list of two numeric vectors of mutant counts.  </p>
</td></tr>
<tr><td><code id="flan.test_+3A_fn">fn</code></td>
<td>
<p> an optional numeric vector of final numbers or a list of two numeric vectors of final numbers. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_mfn">mfn</code></td>
<td>
<p> mean final number of cells. Ignored if <code>fn</code> is non-missing. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_cvfn">cvfn</code></td>
<td>
<p> coefficient of variation of final number of cells. Ignored if <code>fn</code> is non-missing. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_fitness">fitness</code></td>
<td>
<p> fitness parameter: ratio of growth rates of normal and mutant cells. If <code>fitness</code> is <code>NULL</code> (default) then the fitness will be estimated. Otherwise, the given value will
be used to estimate the mean mutation number <code>mutations</code> </p>
</td></tr>
<tr><td><code id="flan.test_+3A_death">death</code></td>
<td>
<p> death probability. Must be smaller than 0.5. By default 0. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_plateff">plateff</code></td>
<td>
<p> plating efficiency parameter. Must be non-larger than 1. By default 1. Available for <code>GF</code> method, and for <code>ML</code> method under <code>LD</code> model.</p>
</td></tr>
<tr><td><code id="flan.test_+3A_model">model</code></td>
<td>
<p> statistical lifetime model. Must be one of &quot;LD&quot; (default) for Luria-Delbrück model (exponential lifetimes), &quot;H&quot; for Haldane model (constant lifetimes), or &quot;I&quot; for Inhomogeneous model </p>
</td></tr>
<tr><td><code id="flan.test_+3A_muinf">muinf</code></td>
<td>
<p> parameter used only if <code>model</code> is <code>I</code>. See details. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_mutations0">mutations0</code></td>
<td>
<p> null hypothesis value for parameter mutations. See details. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_mutprob0">mutprob0</code></td>
<td>
<p> null hypothesis value for parameter mutprob. See details. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_fitness0">fitness0</code></td>
<td>
<p> null hypothesis value for parameter fitness. See details. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_conf.level">conf.level</code></td>
<td>
<p> confidence level of the interval. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative hypothesis, must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or <code>"less"</code>. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_method">method</code></td>
<td>
<p> estimation method as a character string: one of <code>ML</code> (default), <code>P0</code>, or <code>GF</code>. See <code>mutestim</code>. </p>
</td></tr>
<tr><td><code id="flan.test_+3A_winsor">winsor</code></td>
<td>
<p> winsorization parameter: positive integer. Only used when <code>method</code> is <code>ML</code> or when    <code>method</code> is <code>P0</code> and <code>fitness</code> is NULL. See <code>mutestim</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>flan.test</code> tests the values of parameters <code>mutations</code>, <code>mutprob</code>, or <code>fitness</code>, with <code>mutations0</code> <code>mutprob0</code>, <code>fitness0</code> as null hypotheses.
</p>
<p>If <code>fn</code> or <code>mfn</code> are given, mutprob is tested, otherwise, <code>mutations</code> is tested. If <code>fitness</code> is given, it is not tested.
</p>
<p><code>muinf</code> corresponds to the cumulative division rate on the interval [0 ; +Inf).
If <code>model</code> is <code>I</code>, <code>muinf</code> has to be finite, else <code>model</code> is set to &quot;LD&quot;.
</p>
<p><code>alternative</code> may be a two dimensional vector specifying the alternatives for the two parameters to be tested.
</p>
<p>If <code>mc</code> is a list, a two-sample test is performed. In that case, the values in <code>mutations0</code>, <code>mutprob0</code> and <code>fitness0</code> apply to the difference between the two samples (with 0 as default value)
For the two-sample tests, the parameters <code>mfn</code>, <code>cvfn</code>, <code>fitness</code>, <code>death</code> and <code>plateff</code> may be two dimensional vectors, where the first (resp. second) components are related to the first (resp. second) sample.
</p>


<h3>Value</h3>

<p>Returns a list with class <code>"flantest"</code>. The structure of a <code>"flantest"</code> object, is similar to that of a <code>"htest"</code> object (see also <code><a href="stats.html#topic+t.test">t.test</a></code>).
The class <code>"flantest"</code> contains the following components :
</p>
<table>
<tr><td><code>Tstat</code></td>
<td>
<p> the value of the computed statistic(s). </p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p> the values of <code>fitness</code> (if not tested), <code>death</code> and <code>plateff</code>. </p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the p-value(s) of the test. </p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p> confidence interval(s) for the parameter(s) relative to the specified alternative. </p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p> the estimate(s). </p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p> the specified hypothesized value(s). </p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p> a (vector of) character string(s) describing the alternative hypothesis. </p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p> the statistical lifetime model. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> method used to compute the estimate(s). </p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the complete data. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mutestim">mutestim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># one sample test, without final numbers
b &lt;- unlist(boeal)
# is the mean mutation number greater than 0.7, and the fitness greater than 0.8?
flan.test(b, alternative = "greater", mutations0 = 0.7, fitness0 = 0.8)
# is the mean mutation number less than 0.8, given the fitness?
flan.test(b, alternative = "less", mutations0 = 0.8, fitness = 0.84)

# one sample test, with final numbers
d &lt;- david[[11]]
flan.test(d$mc, d$fn, alternative = "less", mutprob0 = 2e-10, fitness0 = 2)

# two-sample test: test equality of parameters
b1 &lt;- unlist(boeal[1:10])
b2 &lt;- unlist(boeal[11:20])
flan.test(list(b1, b2))

# realistic random sample of size 100: mutation probability 1e-9,
# mean final number 1e9, coefficient of variation on final numbers 0.3,
# fitness 0.9, lognormal lifetimes, 5% mutant deaths

x &lt;- rflan(100, mutprob = 1e-9, mfn = 1e9, cvfn = 0.3, fitness = 0.9, death = 0.05)

# test on mutations and fitness, without final numbers
flan.test(x$mc, mutations0 = 1, fitness0 = 0.9)

# test on mutprob and fitness, with final numbers
flan.test(x$mc, x$fn, mutprob0 = 1e-9, fitness0 = 0.9)

# given fitness

flan.test(x$mc, x$fn, fitness = 0.9, mutprob0 = 1e-9)

# take deaths into account
flan.test(x$mc, x$fn, mutprob0 = 1e-9, fitness0 = 0.9, death = 0.05)

# change method
flan.test(x$mc, x$fn, mutprob0 = 1e-9, fitness0 = 0.9, death = 0.05, method = "GF")

flan.test(x$mc, x$fn, mutprob0 = 1e-9, fitness0 = 0.9, death = 0.05, method = "P0")
# change model
flan.test(x$mc, x$fn, mutprob0 = 1e-9, fitness0 = 0.9, model = "H")

# Two-sample test
y &lt;- rflan(100, mutprob = 1e-9, mfn = 1e9, cvfn = 0.3, fitness = 1.2, death = 0.05)
MC &lt;- list(x$mc, y$mc)
FN &lt;- list(x$fn, y$fn)
#
flan.test(mc = MC, fn = FN, fitness = c(0.9, 1.1), death = 0.05)


</code></pre>

<hr>
<h2 id='luriadel'>Resistant bacteria counts from Luria and Delbruck (1943)</h2><span id='topic+luriadel'></span>

<h3>Description</h3>

<p>Samples of mutants counts from Table 2 of Luria and Delbrück (1943).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(luriadel)
</code></pre>


<h3>Format</h3>

<p>A list of 3 samples of mutants counts, each named &quot;LD&lt;index of the sample&gt;&quot;. 
</p>

<ul>
<li><p> The <code>LD1</code> sample includes the first four columns and the last one (experiments number 1, 10, 11, 15 and 21b) of table 2 p. 504.
</p>
</li>
<li><p> The <code>LD2</code> sample includes the fifth and the sixth columns (experiments number 16 and 17)
</p>
</li>
<li><p> The <code>LD3</code> sample includes the next to last column (experiment number 21a).
</p>
</li></ul>



<h3>Source</h3>

<p>D. E. Luria and M. Delbrück: Mutations  of bacteria from virus sensitivity to virus resistance, 
<em>Genetics</em>, 28:491-511 (1943)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1st sample
mutestim(luriadel[[1]])

# compare 2nd and 3rd samples
flan.test(luriadel[2:3]) 
</code></pre>

<hr>
<h2 id='mutestim'>Fluctuation Analysis parametric estimation</h2><span id='topic+mutestim'></span>

<h3>Description</h3>

<p>Estimates mean number of mutations, mutation probability, and fitness parameter, with different methods, under different models. Returns the estimated means and standard deviations for each parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mutestim(mc, fn = NULL, mfn = NULL, cvfn = NULL,
                  fitness = NULL, death = 0., plateff = 1.,
                  model = c("LD", "H", "I"), muinf = +Inf,
                  method = c("ML", "GF", "P0"),
                  winsor = 2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mutestim_+3A_mc">mc</code></td>
<td>
<p> a (non-empty) numeric vector of mutants counts. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_fn">fn</code></td>
<td>
<p> an optional (non-empty) numeric vector with same length as <code>mc</code> of final numbers of cells.</p>
</td></tr>
<tr><td><code id="mutestim_+3A_mfn">mfn</code></td>
<td>
<p> mean final number of cells. Ignored if <code>fn</code> is non-missing. By default empty. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_cvfn">cvfn</code></td>
<td>
<p> coefficient of variation of final number of cells. Ignored if <code>fn</code> is non-missing. By default empty. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_fitness">fitness</code></td>
<td>
<p> fitness parameter: ratio of growth rates of normal and mutant cells. If <code>fitness</code> is <code>NULL</code> (default), then the fitness will be estimated. Otherwise, the given value will
be used to estimate the mean mutation number <code>mutations</code>. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_death">death</code></td>
<td>
<p> death probability. Must be smaller than 0.5. By default 0. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_plateff">plateff</code></td>
<td>
<p> plating efficiency parameter. Must be non-larger than 1. By default 1. Available for <code>GF</code> method, and for <code>ML</code> method under <code>LD</code> model.</p>
</td></tr>
<tr><td><code id="mutestim_+3A_model">model</code></td>
<td>
<p> statistical lifetime model. Must be one of &quot;LD&quot; (default) for Luria-Delbrück model (exponential lifetimes), &quot;H&quot; for Haldane model (constant lifetimes), or &quot;I&quot; for Inhomogeneous model </p>
</td></tr>
<tr><td><code id="mutestim_+3A_muinf">muinf</code></td>
<td>
<p> parameter used only if <code>model</code> is <code>I</code>. See details. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_method">method</code></td>
<td>
<p> estimation method as a character string: one of <code>ML</code> (default), <code>P0</code>, or <code>GF</code>. See details. </p>
</td></tr>
<tr><td><code id="mutestim_+3A_winsor">winsor</code></td>
<td>
<p> winsorization parameter: positive integer. Only used when <code>method</code> is <code>ML</code> or when <code>method</code> is <code>P0</code> and <code>fitness</code> is NULL. See details. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method <code>ML</code> is the classic maximum likelihood estimation method. The maximum is computed with a BFGS (bounded) algorithm.
</p>
<p>Method <code>P0</code> uses the number of null values in the sample, therefore it can be applied only if there is at least one zero in <code>mc</code>.
The estimate of the fitness is computed by maximum likelihood.
</p>
<p>Method <code>GF</code> uses the empirical generating function of <code>mc</code>.
Since this method is the fastest, <code>"GF"</code> is used to initialize the values of the estimates for methods <code>"ML"</code> and <code>"P0"</code> (if the fitness is estimated).
</p>
<p>If <code>fn</code>, <code>mfn</code> or <code>cvfn</code> is non-empty, then the mutation probability is estimated instead of the mean number of mutations.
If <code>fn</code> is non-empty and <code>method</code> is <code>P0</code> or <code>GF</code>, then <code>mfn</code> and <code>cvfn</code> are computed from <code>fn</code>, and the estimate of
of the mutation probability is deduced from the estimate of the mean number of mutations.
If <code>fn</code> is non-empty and <code>method</code> is <code>ML</code>, the estimate of the mutation probability is directly computed.
</p>
<p><code>muinf</code> corresponds to the cumulative division rate on the interval [0 ; +Inf).
If <code>model</code> is <code>I</code>, <code>muinf</code> has to be finite, else <code>model</code> is set to &quot;LD&quot;
</p>
<p>The winsorization parameter <code>winsor</code> is used as a threshold for values in <code>mc</code> when maximum likelihood estimates are computed.
</p>


<h3>Value</h3>

<p> A list containing the following components:
</p>
<table>
<tr><td><code>mutations</code></td>
<td>
<p> mean number of mutations</p>
</td></tr>
<tr><td><code>sd.mutations</code></td>
<td>
<p> estimated standard deviation on mean number of mutations</p>
</td></tr>
<tr><td><code>mutprob</code></td>
<td>
<p> mutation probability (if <code>fn</code>, <code>mfn</code> or <code>cvfn</code> is non-empty)</p>
</td></tr>
<tr><td><code>sd.mutprob</code></td>
<td>
<p> estimated standard deviation on mutation probability</p>
</td></tr>
<tr><td><code>fitness</code></td>
<td>
<p> estimated fitness (if argument <code>fitness</code> is NULL)</p>
</td></tr>
<tr><td><code>sd.fitness</code></td>
<td>
<p> estimated standard deviation on fitness</p>
</td></tr>
</table>


<h3>References</h3>

<p>A. Mazoyer: Fluctuation analysis on mutation models with birth-date dependence.
Math. Biosci 303(9): 83-100 (2018)
</p>
<p>B. Ycart and N. Veziris: Unbiased estimates of mutation rates under fluctuating final counts.
PLoS one 9(7) e101434 (2014)
</p>
<p>B. Ycart: Fluctuation analysis with cell deaths.
J. Applied Probab. Statist, 9(1):12-28 (2014)
</p>
<p>B. Ycart: Fluctuation analysis: can estimates be trusted?
One PLoS one 8(12) e80958 (2013)
</p>
<p>A. Hamon and B. Ycart: Statistics for the Luria-Delbrück distribution.
Elect. J. Statist., 6:1251-1272 (2012)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rflan">rflan</a>, <a href="#topic+flan.test">flan.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# realistic random sample of size 100: mutation probability 1e-9,
# mean final number 1e9, coefficient of variation on final numbers 0.3,
# fitness 0.9, lognormal lifetimes, 5% mutant deaths, plating efficiency 80%
x &lt;- rflan(100, mutprob = 1e-9, mfn = 1e9, cvfn = 0.3, fitness = 0.9, death = 0.05, plateff = 0.8)

# maximum likelihood estimates with mean final number
meanfn &lt;- mutestim(x$mc, mfn = 1e9)

# maximum likelihood estimates with final numbers
withfn &lt;- mutestim(x$mc, x$fn)

# change model
Hmodel &lt;- mutestim(x$mc, x$fn, model = "H")

# faster methods
GFmethod &lt;- mutestim(x$mc, x$fn, method = "GF")
P0method &lt;- mutestim(x$mc, x$fn, method = "P0")

# take deaths into account
withdeaths &lt;- mutestim(x$mc, x$fn, death = 0.05, method = "GF")

# with plateff
withpef &lt;- mutestim(x$mc, x$fn, death = 0.05, plateff = 0.8, method = "GF")

# compare results
rbind(meanfn, withfn, Hmodel, GFmethod, P0method, withdeaths, withpef)

# extreme example
x &lt;- rflan(1000, mutations = 50, fitness = 0.5, dist = "exp")$mc
summary(x)
mutestim(x, method = "GF")
mutestim(x)
mutestim(x, winsor = 5000)

## Not run: 
  # None null count in the sample: P0 can not be used.
  mutestim(x, method = "P0")

## End(Not run)
</code></pre>

<hr>
<h2 id='number+20of+20mutant+20cells+20distribution'>The distribution of mutant cell counts</h2><span id='topic+dflan'></span><span id='topic+pflan'></span><span id='topic+qflan'></span><span id='topic+rflan'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for mutant cell counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dflan(m, mutations = 1., fitness = 1., death = 0., plateff = 1.,
        model = c("LD", "H", "I"), muinf = +Inf)
  pflan(m, mutations = 1., fitness = 1., death = 0., plateff = 1.,
        model = c("LD", "H", "I"), muinf = +Inf, lower.tail = TRUE)
  qflan(p, mutations = 1., fitness = 1., death = 0., plateff = 1.,
        model = c("LD", "H", "I"), muinf = +Inf, lower.tail = TRUE)
  rflan(n, mutations = 1., mutprob = NULL, fitness = 1., death = 0., plateff = 1.,
        dist = list(name = "lnorm", meanlog = -0.3795851, sdlog = 0.3016223),
        distfn = NULL,
        mfn = 1e9, cvfn = 0,
        muih = list(mu = NULL, muinv0 = NULL),
        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_m">m</code></td>
<td>
<p> vector of quantiles. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_p">p</code></td>
<td>
<p> vector of probabilities. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_n">n</code></td>
<td>
<p> number of observations. If <code>length(n) &gt; 1</code>, the length is taken to be the number required. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_mutations">mutations</code></td>
<td>
<p>mean number of mutations: positive integer. Ignored if <code>mutprob</code> is non-empty. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_mutprob">mutprob</code></td>
<td>
<p> mutation probability: numeric between 0 and 1. By default empty. See details. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_fitness">fitness</code></td>
<td>
<p> fitness parameter: numeric positive. By default 1. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_death">death</code></td>
<td>
<p> death probability: numeric between 0 and 0.5. By default 0. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_plateff">plateff</code></td>
<td>
<p> plating efficiency parameter: numeric number between 0 and 1. By default 1. See Details. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_dist">dist</code></td>
<td>
<p> lifetime distribution for mutant cells. See Details. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_model">model</code></td>
<td>
<p> statistical lifetime model. Must be one of &quot;LD&quot; (default) for Luria-Delbrück model (exponential lifetimes), &quot;H&quot; for Haldane model (constant lifetimes), or &quot;I&quot; for Inhomogeneous model </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_distfn">distfn</code></td>
<td>
<p> final number of cells distribution. Must be one of &quot;lnorm&quot; (default if <code>cvfn</code> is positive) or &quot;gamma&quot;. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_mfn">mfn</code></td>
<td>
<p> mean final number of cells: numeric positive. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_cvfn">cvfn</code></td>
<td>
<p> coefficient of variation of final numbers of cells: numeric, default 0. If non-zero and if <code>mutprob</code> is empty, compute the sample with <code>mutprob</code> = <code>mutations</code>/<code>mfn</code></p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_muih">muih</code></td>
<td>
<p> functions for inhomogeneous model. See details. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_muinf">muinf</code></td>
<td>
<p> parameter used only if <code>model</code> is <code>I</code>. See details. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_lower.tail">lower.tail</code></td>
<td>
<p> logical: if TRUE (default), probabilities are P[X &lt;= x] otherwise, P[X &gt; m]. </p>
</td></tr>
<tr><td><code id="number+2B20of+2B20mutant+2B20cells+2B20distribution_+3A_...">...</code></td>
<td>
<p> Arguments to be passed for <code>muih</code>, such that hyperparameters. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>dist</code> is a list beginning with the distribution name followed by its parameters, and must be one the 4 following distributions: &quot;dirac&quot;, &quot;exp&quot;, &quot;lnorm&quot;(meanlog, sdlog), &quot;gamma&quot;(shape, scale).
Note that the parameters related to the &quot;dirac&quot; and &quot;exp&quot; cases are directly computed with inputs <code>fitness</code> and <code>death</code>.
</p>
<p>If <code>muih$mu</code> is non-empty, a time dependent growth model is performed.
The function <code>muih$mu</code> is a bivariate function which represents roughly the mean growth of clone durig an time interval.
The function <code>muih$muinv0</code> is the inverse function of <code>muih$mu(0,.)</code>.
If <code>muih$muinv0</code> is empty, it is approximated using <code>muih$mu</code>.
</p>
<p><code>muinf</code> corresponds to the cumulative division rate on the interval [0 ; +Inf).
It is the limit as t tends to infinity of <code>muih$mu(0,t)</code>.
If <code>model</code> is <code>I</code>, <code>muinf</code> has to be finite, else <code>model</code> is set to &quot;LD&quot;
</p>
<p>If <code>mutprob</code> is non-empty and if <code>cvfn</code> is zero, the sample of mutants is computed with <code>mutations</code> as the product of <code>mutprob</code> by <code>mfn</code>.
If <code>cvfn</code> is positive, the final numbers of cells are generated with the log-normal (if <code>distfn</code> is &quot;lnorm&quot; or empty) or the gamma (if <code>distfn</code> is &quot;gamma&quot;) distribution with mean <code>mfn</code> and coefficient of variation <code>cvfn</code>.
The sample of mutants is then generated conditionally to the sample of final numbers of cells.
</p>
<p>A plating efficiency <code>plateff</code> smaller than 1 can be taken into account in the <code>dflan, pflan</code> and <code>qflan</code> functions only under <code>LD</code> model.
</p>
<p>If the plating efficiency <code>plateff</code> is smaller than 1 in the <code>flan</code> function, then each mutant count <code>mc</code> is replaced by a binomial number with parameters <code>size = mc</code> and <code>prob = plateff</code>.
</p>


<h3>Value</h3>

<p><code>dflan</code> gives the density, <code>pflan</code> gives the distribution
function, <code>qflan</code> gives the quantile function, and <code>rflan</code>
generates a random sample.
</p>
<p><code>rflan</code> returns a list with two arguments, each with length <code>n</code>: a vector of integers
<code>$mc</code> (mutant counts), and a vector of numeric <code>$fn</code> (final numbers of cells).
</p>


<h3>See Also</h3>

<p><code>link{draw.clone}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#----------------------- distributions ----------------------------------

# Luria-Delbrück model, mean number of mutations 1, fitness parameter 1
dflan(0:10)
pflan(0:10)
qflan(c(0.95, 0.99))

# Luria-Delbrück model, mean number of mutations 2, fitness parameter 0.5
qflan(c(0.95, 0.99), mutations = 2, fitness = 0.5)

qflan(c(0.05, 0.01), mutations = 2, fitness = 0.5, lower.tail = FALSE)

# Haldane model, mean number of mutations 2, fitness parameter 0.5
qflan(c(0.95, 0.99), mutations = 2, fitness = 0.5, model = "H")

#---------------------- random samples ----------------------------------
# lognormal lifetime distribution, lognormal final numbers
X &lt;- rflan(100, cvfn = 0.3)
X$mc              # mutant counts
X$fn              # final numbers

# lognormal lifetime distribution, gamma final numbers
X &lt;- rflan(100, distfn = "gamma", cvfn = 0.3)
X$mc              # mutant counts
X$fn              # final numbers

# mean number of mutations 2, fitness parameter 0.5 (realistic model, but slow)

# lognormal lifetimes
rflan(1000, mutations = 2, fitness = 0.5)$mc
# gamma lifetimes
rflan(1000, mutations = 2, fitness = 0.5, dist = list(name = "gamma", shape = 10, scale = 0.05))$mc

# exponential lifetimes (Luria-Delbrück model, fast)
rflan(1000, mutations = 2, fitness = 0.5, dist = list("exp"))$mc

# constant lifetimes (Haldane model, fast)
rflan(1000, mutations = 2, fitness = 0.5, dist = "dirac")$mc

# specifying mutation probability and mean final number

rflan(1000, mutprob = 2e-9, mfn = 2e9, fitness = 0.5, dist = list("dirac"))$mc


# positive cell death probability
rflan(1000, mutprob = 2e-9, mfn = 2e9, death = 0.1, fitness = 0.5, dist = list("exp"))$mc

#------------- Inhomogeneous model ---------
f &lt;- function(t,n0,nf) nf/(1+(nf/n0-1)*exp(-t))  # Logistic function: mean growth of a clone
finv &lt;- function(s,n0,nf) -log((nf/s-1)/(nf/n0-1))  # Inverse function of f

mu &lt;- function(s,t,n0,nf) log(f(t,n0,nf)/f(s,n0,nf))   # Definition of mu
muinv0 &lt;- function(u,n0,nf) finv(f(0.,n0,nf)*exp(u),n0,nf)   # Inverse function of mu

rflan(1000, muih = list(mu = mu, muinv0 = muinv0), n0 = 1e2, nf = 1e6)$mc

</code></pre>

<hr>
<h2 id='roster'>Mutant counts from Rosche and Foster (2000)</h2><span id='topic+roster'></span>

<h3>Description</h3>

<p>Sample from Table 3 of Rosche and Foster (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(roster)
</code></pre>


<h3>Format</h3>

<p>A vector of positive integers with size 52.
</p>


<h3>Source</h3>

<p>W. A. Rosche and P. L. Foster, Determining mutation rates in bacterial populations,  
<em>Methods</em>, 20(1):4-17 (2000)</p>


<h3>Examples</h3>

<pre><code class='language-R'># are parameters significantly larger than 1 ?
flan.test(roster,alternative="greater",mutations0=1,fitness0=1)
</code></pre>

<hr>
<h2 id='werhoff'>Rifampin-resistant mutant counts from Werngren and Hoffner (2003)</h2><span id='topic+werhoff'></span>

<h3>Description</h3>

<p>Samples from Table 1 p. 1522 of Werngren and Hoffner (2003). 
</p>
<p>The mean final number of cells is also given for each sample.
</p>
<p>The coefficient of variation of the final number of cells is the same for all samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(werhoff)
</code></pre>


<h3>Format</h3>

<p>A list of 2 elements :
</p>

<ul>
<li> <p><code>cvfn</code> : the coefficient of variation of final numbers of cells, for all samples.
</p>
</li>
<li> <p><code>samples</code> : a list of 13 lists. Each list includes :
</p>

<ul>
<li><p> A sample of mutants counts named &quot;W&lt;index of the sample&quot;.
</p>
</li>
<li> <p><code>mfn</code> : the mean final number of cells.
</p>
</li></ul>

</li></ul>



<h3>Source</h3>

<p>J. Werngren and S. E. Hoffner: Drug susceptible Mycobacterium tuberculosis Beijing genotype does not develop mutation-conferred resistance to Rifampin at an elevated rate, 
<em>J. Clin. Microbiol.</em>, 41(4):1520-1524 (2003)</p>


<h3>Examples</h3>

<pre><code class='language-R'># coefficient of variation of final numbers
Wcvfn &lt;- werhoff$cvfn
# tenth sample
W10 &lt;- werhoff$samples[[10]]

# estimates without cvfn
without &lt;- mutestim(W10$mc,mfn=W10$mfn)
# estimates with cvfn
with &lt;- mutestim(W10$mc,mfn=W10$mfn,cvfn=Wcvfn)
rbind(without,with)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
