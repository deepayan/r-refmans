<!DOCTYPE html><html><head><title>Help for package Microsoft365R</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Microsoft365R}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_methods'><p>Microsoft 365 object accessor methods</p></a></li>
<li><a href='#get_personal_onedrive'><p>Login clients for Microsoft 365</p></a></li>
<li><a href='#microsoft365r_options'><p>Global options</p></a></li>
<li><a href='#ms_channel'><p>Teams channel</p></a></li>
<li><a href='#ms_chat'><p>Teams chat</p></a></li>
<li><a href='#ms_chat_message'><p>Teams chat message</p></a></li>
<li><a href='#ms_drive'><p>Personal OneDrive or SharePoint document library</p></a></li>
<li><a href='#ms_drive_item'><p>File or folder in a drive</p></a></li>
<li><a href='#ms_list'><p>Sharepoint list</p></a></li>
<li><a href='#ms_list_item'><p>SharePoint list item</p></a></li>
<li><a href='#ms_outlook'><p>Outlook mail client</p></a></li>
<li><a href='#ms_outlook_attachment'><p>Outlook mail attachment</p></a></li>
<li><a href='#ms_outlook_email'><p>Outlook mail message</p></a></li>
<li><a href='#ms_outlook_folder'><p>Outlook mail folder</p></a></li>
<li><a href='#ms_plan'><p>Microsoft Planner Plan</p></a></li>
<li><a href='#ms_plan_bucket'><p>Microsoft Planner Plan Bucket</p></a></li>
<li><a href='#ms_plan_task'><p>Microsoft Planner Plan Task</p></a></li>
<li><a href='#ms_site'><p>Office 365 SharePoint site</p></a></li>
<li><a href='#ms_team'><p>Microsoft Teams team</p></a></li>
<li><a href='#ms_team_member'><p>Teams/channel member</p></a></li>
<li><a href='#personal_onedrive'><p>Deprecated client functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interface to the 'Microsoft 365' Suite of Cloud Services</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to the 'Microsoft 365' (formerly known as 'Office 365') suite of cloud services, building on the framework supplied by the 'AzureGraph' package. Enables access from R to data stored in 'Teams', 'SharePoint Online' and 'OneDrive', including the ability to list drive folder contents, upload and download files, send messages, and retrieve data lists. Also provides a full-featured 'Outlook' email client, with the ability to send emails and manage emails and mail folders.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/Microsoft365R">https://github.com/Azure/Microsoft365R</a>
<a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/Microsoft365R/issues">https://github.com/Azure/Microsoft365R/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>AzureAuth, AzureGraph (&ge; 1.3.1), utils, parallel, tools,
curl, httr, jsonlite, R6, vctrs, mime</td>
</tr>
<tr>
<td>Suggests:</td>
<td>openssl, knitr, rmarkdown, testthat, blastula, emayili, readr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-30 16:03:11 UTC; hongo</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut, cre],
  Roman Zenka [ctb],
  Robert Ashton [ctb],
  Philip Zheng [ctb],
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Ooi &lt;hongooi73@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-30 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_methods'>Microsoft 365 object accessor methods</h2><span id='topic+add_methods'></span>

<h3>Description</h3>

<p>Methods for the <code><a href="AzureGraph.html#topic+ms_graph">AzureGraph::ms_graph</a></code>, <code><a href="AzureGraph.html#topic+az_user">AzureGraph::az_user</a></code> and <code><a href="AzureGraph.html#topic+az_group">AzureGraph::az_group</a></code> classes.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>## R6 method for class 'az_user'
get_chat(chat_id)

## R6 method for class 'ms_graph'
get_drive(drive_id)

## R6 method for class 'az_user'
get_drive(drive_id = NULL)

## R6 method for class 'az_group'
get_drive(drive_name = NULL, drive_id = NULL)

## R6 method for class 'az_group'
get_plan(plan_title = NULL, plan_id = NULL)

## R6 method for class 'ms_graph'
get_sharepoint_site(site_url = NULL, site_id = NULL)

## R6 method for class 'az_group'
get_sharepoint_site()

## R6 method for class 'ms_graph'
get_team(team_id = NULL)

## R6 method for class 'az_group'
get_team()

## R6 method for class 'az_user'
list_chats(filter = NULL, n = Inf)

## R6 method for class 'az_user'
list_drives(filter = NULL, n = Inf)

## R6 method for class 'az_group'
list_drives(filter = NULL, n = Inf)

## R6 method for class 'az_group'
list_plans(filter = NULL, n = Inf)

## R6 method for class 'az_user'
list_sharepoint_sites(filter = NULL, n = Inf)

## R6 method for class 'az_user'
list_teams(filter = NULL, n = Inf)
</pre></div>


<h3>Arguments</h3>


<ul>
<li> <p><code>drive_name</code>,<code>drive_id</code>: For <code>get_drive</code>, the name or ID of the drive or shared document library. Note that only the <code>az_group</code> method  has the <code>drive_name</code> argument, as user drives do not have individual names (and most users will only have one drive anyway). For the <code>az_user</code> and <code>az_group</code> methods, leaving the argument(s) blank will return the default drive/document library.
</p>
</li>
<li> <p><code>site_url</code>,<code>site_id</code>: For <code>ms_graph$get_sharepoint_site()</code>, the URL and ID of the site. Provide one or the other, but not both.
</p>
</li>
<li> <p><code>team_name</code>,<code>team_id</code>: For <code>az_user$get_team()</code>, the name and ID of the site. Provide one or the other, but not both. For <code>ms_graph$get_team</code>, you must provide the team ID.
</p>
</li>
<li> <p><code>plan_title</code>,<code>plan_id</code>: For <code>az_group$get_plan()</code>, the title and ID of the site. Provide one or the other, but not both.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;filter, n&#8288;</code>: See 'List methods' below.
</p>
</li></ul>



<h3>Details</h3>

<p><code>get_sharepoint_site</code> retrieves a SharePoint site object. The method for the top-level Graph client class requires that you provide either the site URL or ID. The method for the <code>az_group</code> class will retrieve the site associated with that group, if applicable.
</p>
<p><code>get_drive</code> retrieves a OneDrive or shared document library, and <code>list_drives</code> retrieves all such drives/libraries that the user or group has access to. Whether these are personal or business drives depends on the tenant that was specified in <code>AzureGraph::get_graph_login()</code>/<code>create_graph_login()</code>: if this was &quot;consumers&quot; or &quot;9188040d-6c67-4c5b-b112-36a304b66dad&quot; (the equivalent GUID), it will be the personal OneDrive. See the examples below.
</p>
<p><code>get_plan</code> retrieves a plan (not to be confused with a Todo task list), and <code>list_plans</code> retrieves all plans for a group.
</p>
<p><code>get_team</code> retrieves a team. The method for the Graph client class requires the team ID. The method for the <code>az_user</code> class requires either the team name or ID. The method for the <code>az_group</code> class retrieves the team associated with the group, if it exists.
</p>
<p><code>get_chat</code> retrieves a one-on-one, group or meeting chat, by ID. <code>list_chats</code> retrieves all chats that the user is part of.
</p>
<p>Note that Teams, SharePoint and OneDrive for Business require a Microsoft 365 Business license, and are available for organisational tenants only. Similarly, only Microsoft 365 groups can have associated sites/teams/plans/drives, not any other kind of group.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>Value</h3>

<p>For <code>get_sharepoint_site</code>, an object of class <code>ms_site</code>.
</p>
<p>For <code>get_drive</code>, an object of class <code>ms_drive</code>. For <code>list_drives</code>, a list of <code>ms_drive</code> objects.
</p>
<p>For <code>get_plan</code>, an object of class <code>ms_plan</code>. For <code>list_plans</code>, a list of <code>ms_plan</code> objects.
</p>
<p>For <code>get_team</code>, an object of class <code>ms_team</code>. For <code>list_teams</code>, a list of <code>ms_team</code> objects.
</p>
<p>For <code>get_chat</code>, an object of class <code>ms_chat</code>. For <code>list_chats</code>, a list of <code>ms_chat</code> objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>, <code><a href="#topic+ms_plan">ms_plan</a></code>, <code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_chat">ms_chat</a></code>, <code><a href="AzureGraph.html#topic+az_user">az_user</a></code>, <code><a href="AzureGraph.html#topic+az_group">az_group</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# 'consumers' tenant -&gt; personal OneDrive for a user
gr &lt;- AzureGraph::get_graph_login("consumers", app="myapp")
me &lt;- gr$get_user()
me$get_drive()

# organisational tenant -&gt; business OneDrive for a user
gr2 &lt;- AzureGraph::get_graph_login("mycompany", app="myapp")
myuser &lt;- gr2$get_user("username@mycompany.onmicrosoft.com")
myuser$get_drive()

# get a site/drive directly from a URL/ID
gr2$get_sharepoint_site("My site")
gr2$get_drive("drive-id")

# site/drive(s) for a group
grp &lt;- gr2$get_group("group-id")
grp$get_sharepoint_site()
grp$list_drives()
grp$get_drive()


## End(Not run)
</code></pre>

<hr>
<h2 id='get_personal_onedrive'>Login clients for Microsoft 365</h2><span id='topic+get_personal_onedrive'></span><span id='topic+get_business_onedrive'></span><span id='topic+get_sharepoint_site'></span><span id='topic+list_sharepoint_sites'></span><span id='topic+get_team'></span><span id='topic+list_teams'></span><span id='topic+get_personal_outlook'></span><span id='topic+get_business_outlook'></span><span id='topic+get_chat'></span><span id='topic+list_chats'></span>

<h3>Description</h3>

<p>Microsoft365R provides functions for logging into each Microsoft 365 service.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_personal_onedrive(
  app = .microsoft365r_app_id,
  scopes = c("Files.ReadWrite.All", "User.Read"),
  token = NULL,
  ...
)

get_business_onedrive(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = c("Files.ReadWrite.All", "User.Read"),
  token = NULL,
  ...
)

get_sharepoint_site(
  site_name = NULL,
  site_url = NULL,
  site_id = NULL,
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = c("Group.ReadWrite.All", "Directory.Read.All", "Sites.ReadWrite.All",
    "Sites.Manage.All"),
  token = NULL,
  ...
)

list_sharepoint_sites(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = c("Group.ReadWrite.All", "Directory.Read.All", "Sites.ReadWrite.All",
    "Sites.Manage.All"),
  token = NULL,
  ...
)

get_team(
  team_name = NULL,
  team_id = NULL,
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = c("Group.ReadWrite.All", "Directory.Read.All"),
  token = NULL,
  ...
)

list_teams(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = c("Group.ReadWrite.All", "Directory.Read.All"),
  token = NULL,
  ...
)

get_personal_outlook(
  app = .microsoft365r_app_id,
  scopes = c("Mail.Send", "Mail.ReadWrite", "User.Read"),
  token = NULL,
  ...
)

get_business_outlook(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = .microsoft365r_app_id,
  shared_mbox_id = NULL,
  shared_mbox_name = NULL,
  shared_mbox_email = NULL,
  scopes = c("User.Read", "Mail.Send", "Mail.ReadWrite"),
  token = NULL,
  ...
)

get_chat(
  chat_id,
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = .microsoft365r_app_id,
  scopes = c("User.Read", "Directory.Read.All", "Chat.ReadWrite"),
  token = NULL,
  ...
)

list_chats(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = .microsoft365r_app_id,
  scopes = c("User.Read", "Directory.Read.All", "Chat.ReadWrite"),
  token = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_personal_onedrive_+3A_app">app</code></td>
<td>
<p>A custom app registration ID to use for authentication. See below.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_scopes">scopes</code></td>
<td>
<p>The Microsoft Graph scopes (permissions) to obtain. It should never be necessary to change these.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_token">token</code></td>
<td>
<p>An AAD OAuth token object, of class <code>AzureAuth::AzureToken</code>. If supplied, the <code>tenant</code>, <code>app</code>, <code>scopes</code> and <code>...</code> arguments will be ignored. See &quot;Authenticating with a token&quot; below.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_...">...</code></td>
<td>
<p>Optional arguments that will ultimately be passed to <code><a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a></code>.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_tenant">tenant</code></td>
<td>
<p>For <code>get_business_onedrive</code>, <code>get_sharepoint_site</code> and <code>get_team</code>, the name of your Azure Active Directory (AAD) tenant. If not supplied, use the value of the <code>CLIMICROSOFT365_TENANT</code> environment variable, or &quot;common&quot; if that is unset.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_site_name">site_name</code>, <code id="get_personal_onedrive_+3A_site_url">site_url</code>, <code id="get_personal_onedrive_+3A_site_id">site_id</code></td>
<td>
<p>For <code>get_sharepoint_site</code>, either the name, web URL or ID of the SharePoint site to retrieve. Supply exactly one of these.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_team_name">team_name</code>, <code id="get_personal_onedrive_+3A_team_id">team_id</code></td>
<td>
<p>For <code>get_team</code>, either the name or ID of the team to retrieve. Supply exactly one of these.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_shared_mbox_id">shared_mbox_id</code>, <code id="get_personal_onedrive_+3A_shared_mbox_name">shared_mbox_name</code>, <code id="get_personal_onedrive_+3A_shared_mbox_email">shared_mbox_email</code></td>
<td>
<p>For <code>get_business_outlook</code>, an ID/principal name/email address. Supply exactly one of these to retrieve a shared mailbox. If all are NULL (the default), retrieve your own mailbox.</p>
</td></tr>
<tr><td><code id="get_personal_onedrive_+3A_chat_id">chat_id</code></td>
<td>
<p>For <code>get_chat</code>, the ID of a group, one-on-one or meeting chat in Teams.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions provide easy access to the various collaboration services that are part of Microsoft 365. On first use, they will call your web browser to authenticate with Azure Active Directory, in a similar manner to other web apps. You will get a dialog box asking for permission to access your information. You only have to authenticate once; your credentials will be saved and reloaded in subsequent sessions.
</p>
<p>When authenticating, you can pass optional arguments in <code>...</code> which will ultimately be received by <code>AzureAuth::get_azure_token</code>. In particular, if your machine doesn't have a web browser available to authenticate with (for example if you are in a remote RStudio Server session), pass <code>auth_type="device_code"</code> which is intended for such scenarios.
</p>


<h4>Authenticating to Microsoft 365 Business services</h4>

<p>Authenticating to Microsoft 365 Business services (Teams, SharePoint and business OneDrive/Outlook) has some specific complexities.
</p>
<p>The default &quot;common&quot; tenant for <code>get_team</code>, <code>get_business_onedrive</code> and <code>get_sharepoint_site</code> attempts to detect your actual tenant from your saved credentials in your browser. This may not always succeed, for example if you have a personal account that is also a guest account in a tenant. In this case, supply the actual tenant name, either in the <code>tenant</code> argument or in the <code>CLIMICROSOFT365_TENANT</code> environment variable. The latter allows sharing authentication details with the <a href="https://pnp.github.io/cli-microsoft365/">CLI for Microsoft 365</a>.
</p>
<p>The default when authenticating to these services is for Microsoft365R to use its own internal app ID. As an alternative, you (or your admin) can create your own app registration in Azure: for use in a local session, it should have a native redirect URI of <code style="white-space: pre;">&#8288;http://localhost:1410&#8288;</code>, and the &quot;public client&quot; option should be enabled if you want to use the device code authentication flow. You can supply your app ID either via the <code>app</code> argument, or in the environment variable <code>CLIMICROSOFT365_AADAPPID</code>.
</p>



<h4>Authenticating with a token</h4>

<p>In some circumstances, it may be desirable to carry out authentication/authorization as a separate step prior to  making requests to the Microsoft 365 REST API. This holds in a Shiny app, for example, since only the UI part can talk to the browser while the server part does the rest of the work. Another scenario is if the refresh token lifetime set by your org is too short, so that the token expires in between R sessions.
</p>
<p>In this case, you can authenticate by obtaining a new token with <code>AzureAuth::get_azure_token</code>, and passing the token object to the client function. Note that the token is accepted as-is; no checks are performed that it has the correct permissions for the service you're using.
</p>
<p>When calling <code>get_azure_token</code>, the scopes you should use are those given in the <code>scopes</code> argument for each client function, and the API host is <code style="white-space: pre;">&#8288;https://graph.microsoft.com/&#8288;</code>. The Microsoft365R internal app ID is <code style="white-space: pre;">&#8288;d44a05d5-c6a5-4bbb-82d2-443123722380&#8288;</code>, while that for the CLI for Microsoft 365 is <code style="white-space: pre;">&#8288;31359c7f-bd7e-475c-86db-fdb8c937548e&#8288;</code>. However, these app IDs <strong>only</strong> work for a local R session; you must create your own app registration if you want to use the package inside a Shiny app.
</p>
<p>See the examples below, and also the vignette &quot;Using Microsoft365R in a Shiny app&quot; for a more detailed rundown on combining Microsoft365R and Shiny.
</p>



<h4>Clearing the cache</h4>

<p>Deleting your cached credentials is a way of rebooting the authentication process, if you are repeatedly encountering errors. To do this, call <code><a href="AzureAuth.html#topic+get_azure_token">AzureAuth::clean_token_directory</a></code>, then try logging in again. You may also need to clear your browser's cookies, if you are authenticating interactively.
</p>



<h3>Value</h3>

<p>For <code>get_personal_onedrive</code> and <code>get_business_onedrive</code>, an R6 object of class <code>ms_drive</code>.
</p>
<p>For <code>get_sharepoint_site</code>, an R6 object of class <code>ms_site</code>; for <code>list_sharepoint_sites</code>, a list of such objects.
</p>
<p>For <code>get_team</code>, an R6 object of class <code>ms_team</code>; for <code>list_teams</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_drive">ms_drive</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_chat">ms_chat</a></code>, <a href="#topic+microsoft365r_options">Microsoft365R global options</a>
</p>
<p><code><a href="#topic+add_methods">add_methods</a></code> for the associated methods that this package adds to the base AzureGraph classes.
</p>
<p>The &quot;Authentication&quot; vignette has more details on the authentication process, including troubleshooting and fixes for common problems. The &quot;Using Microsoft365R in a Shiny app&quot; vignette has further Shiny-specific information, including how to configure the necessary app registration in Azure Active Directory.
</p>
<p><a href="https://pnp.github.io/cli-microsoft365/">CLI for Microsoft 365</a> &ndash; a commandline tool for managing Microsoft 365
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

get_personal_onedrive()

# authenticating without a browser
get_personal_onedrive(auth_type="device_code")

odb &lt;- get_business_onedrive("mycompany")
odb$list_items()

mysite &lt;- get_sharepoint_site("My site", tenant="mycompany")
mysite &lt;- get_sharepoint_site(site_url="https://mycompany.sharepoint.com/sites/my-site-url")
mysite$get_drive()$list_items()

myteam &lt;- get_team("My team", tenant="mycompany")
myteam$list_channels()
myteam$get_drive()$list_items()

# retrieving chats
get_chat("chat-id")
list_chats()

# you can also use your own app registration ID:
get_business_onedrive(app="app_id")
get_sharepoint_site("My site", app="app_id")

# using the app ID for the CLI for Microsoft 365: set a global option
options(microsoft365r_use_cli_app_id=TRUE)
get_business_onedrive()
get_sharepoint_site("My site")
get_team("My team")

# authenticating separately to working with the MS365 API
scopes &lt;- c(
    "https://graph.microsoft.com/Files.ReadWrite.All",
    "https://graph.microsoft.com/User.Read",
    "openid", "offline_access"
)
app &lt;- "d44a05d5-c6a5-4bbb-82d2-443123722380" # for local use only
token &lt;- AzureAuth::get_azure_token(scopes, "mycompany", app, version=2)
get_business_onedrive(token=token)


## End(Not run)
</code></pre>

<hr>
<h2 id='microsoft365r_options'>Global options</h2><span id='topic+microsoft365r_options'></span><span id='topic+microsoft365r_global'></span>

<h3>Description</h3>

<p>Microsoft365R has a number of global options that affect how it interacts with the underlying Graph API.
</p>


<h3>Usage</h3>

<div class="sourceCode"><pre>options(microsoft365r_use_itemid_in_path = TRUE)
options(microsoft365r_use_outlook_immutable_ids = TRUE)
</pre></div>


<h3>Details</h3>

<p>The <code>microsoft365r_use_itemid_in_path</code> option controls when to use item IDs in requests for OneDrive/SharePoint drive items. The default value of TRUE means to use this always; other possible values are FALSE (the default in previous versions of Microsoft365R) and &quot;remote&quot; (use only when dealing with items shared by another user).
</p>
<p>The <code>microsoft365r_use_outlook_immutable_ids</code> option controls whether to use immutable object IDs in Outlook. Immutable IDs have the advantage that they don't change when an email is moved or copied between folders, whereas traditional Outlook object IDs can change. The default is to use immutable IDs; set this option to FALSE to revert to traditional Outlook IDs.
</p>

<hr>
<h2 id='ms_channel'>Teams channel</h2><span id='topic+ms_channel'></span>

<h3>Description</h3>

<p>Class representing a Microsoft Teams channel.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_channel</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: Always &quot;channel&quot; for a channel object
</p>
</li>
<li> <p><code>team_id</code>: The ID of the parent team.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this channel. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the channel's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the channel.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the channel metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>send_message(body, content_type, attachments)</code>: Sends a new message to the channel. See below.
</p>
</li>
<li> <p><code>list_messages(filter=NULL, n=50)</code>: Retrieves the messages in the channel. By default, this is limited to the 50 most recent messages; set the <code>n</code> argument to change this.
</p>
</li>
<li> <p><code>get_message(message_id)</code>: Retrieves a specific message in the channel.
</p>
</li>
<li> <p><code>delete_message(message_id, confirm=TRUE)</code>: Deletes a message. Currently the Graph API does not support deleting Teams messages, so this method is disabled.
</p>
</li>
<li> <p><code>list_files()</code>: List the files for the channel. See <code><a href="#topic+ms_drive">ms_drive</a></code> for the arguments available for this and the file upload/download methods.
</p>
</li>
<li> <p><code>upload_file()</code>: Uploads a file to the channel.
</p>
</li>
<li> <p><code>download_file()</code>: Downloads a file from the channel.
</p>
</li>
<li> <p><code>get_folder()</code>: Retrieves the files folder for the channel, as a <code><a href="#topic+ms_drive_item">ms_drive_item</a></code> object.
</p>
</li>
<li> <p><code>list_members(filter=NULL, n=Inf)</code>: Retrieves the members of the channel, as a list of <code><a href="#topic+ms_team_member">ms_team_member</a></code> objects.
</p>
</li>
<li> <p><code>get_member(name, email, id)</code>: Retrieve a specific member of the channel, as a <code>ms_team_member</code> object. Supply only one of the member name, email address or ID.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_channel</code> and <code>list_channels</code> methods of the <code><a href="#topic+ms_team">ms_team</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual channel.
</p>


<h3>Messaging</h3>

<p>To send a message to a channel, use the <code>send_message()</code> method. This has arguments:
</p>

<ul>
<li> <p><code>body</code>: The body of the message. This should be a character vector, which will be concatenated into a single string with newline separators. The body can be either plain text or HTML formatted.
</p>
</li>
<li> <p><code>content_type</code>: Either &quot;text&quot; (the default) or &quot;html&quot;.
</p>
</li>
<li> <p><code>attachments</code>: Optional vector of filenames.
</p>
</li>
<li> <p><code>inline</code>: Optional vector of image filenames that will be inserted into the body of the message. The images must be PNG or JPEG, and the <code>content_type</code> argument must be &quot;html&quot; to include inline content.
</p>
</li>
<li> <p><code>mentions</code>: Optional vector of @mentions that will be inserted into the body of the message. This should be either an object of one of the following classes, or a list of the same: <code><a href="AzureGraph.html#topic+az_user">az_user</a></code>, <code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>, <code><a href="#topic+ms_team_member">ms_team_member</a></code>. The <code>content_type</code> argument must be &quot;html&quot; to include mentions.
</p>
</li></ul>

<p>Note that message attachments are actually uploaded to the channel's file listing (a directory in the team's primary shared document folder). Support for attachments is somewhat experimental, so if you want to be sure that it works, upload the file separately using the <code>upload_file()</code> method.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>, <code><a href="#topic+ms_chat_message">ms_chat_message</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0">Microsoft Teams API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

myteam &lt;- get_team("my team")
myteam$list_channels()

chan &lt;- myteam$get_channel()
chan$list_messages()
chan$send_message("hello from R")

# a multi-line message with an attachment
msg_text &lt;- c(
    "message line 1",
    "message line 2",
    "message line 3"
)
chan$send_message(msg_text, attachments="myfile.csv")

# sending an inline image
chan$send_message("", content_type="html", inline="graph.png")

# channel members
chan$list_members()
jane &lt;- chan$get_member("Jane Smith")
bill &lt;- chan$get_member(email="billg@mycompany.com")

# mentioning a team member
chan$send_message("Here is a message", content_type="html", mentions=jane)

# mentioning 2 or more members: use a list
chan$send_message("Here is another message", content_type="html",
    mentions=list(jane, bill))

# mentioning an entire channel or team
chan$send_message("FYI to channel", content_type="html", mentions=chan)
chan$send_message("FYI to everyone", content_type="html", mentions=myteam)

chan$list_files()

chan$upload_file("mydocument.docx")


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_chat'>Teams chat</h2><span id='topic+ms_chat'></span>

<h3>Description</h3>

<p>Class representing a one-on-one, group or meeting chat in Microsoft Teams.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_chat</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: Always &quot;chat&quot; for a chat object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>update(...)</code>: Update the chat's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the chat.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the chat metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>send_message(body, content_type, attachments)</code>: Sends a new message to the chat. See below.
</p>
</li>
<li> <p><code>list_messages(filter=NULL, n=50)</code>: Retrieves the messages in the chat. By default, this is limited to the 50 most recent messages; set the <code>n</code> argument to change this.
</p>
</li>
<li> <p><code>get_message(message_id)</code>: Retrieves a specific message in the chat.
</p>
</li>
<li> <p><code>delete_message(message_id, confirm=TRUE)</code>: Deletes a message. Currently the Graph API does not support deleting Teams messages, so this method is disabled.
</p>
</li>
<li> <p><code>list_members(filter=NULL, n=Inf)</code>: Retrieves the members of the chat, as a list of <code><a href="#topic+ms_team_member">ms_team_member</a></code> objects.
</p>
</li>
<li> <p><code>get_member(name, email, id)</code>: Retrieve a specific member of the chat, as a <code>ms_team_member</code> object. Supply only one of the member name, email address or ID.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_chat</code> and <code>list_chats</code> methods of the <code><a href="#topic+ms_team">ms_team</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual chat.
</p>


<h3>Messaging</h3>

<p>To send a message to a chat, use the <code>send_message()</code> method. This has arguments:
</p>

<ul>
<li> <p><code>body</code>: The body of the message. This should be a character vector, which will be concatenated into a single string with newline separators. The body can be either plain text or HTML formatted.
</p>
</li>
<li> <p><code>content_type</code>: Either &quot;text&quot; (the default) or &quot;html&quot;.
</p>
</li>
<li> <p><code>attachments</code>: Optional vector of filenames.
</p>
</li>
<li> <p><code>inline</code>: Optional vector of image filenames that will be inserted into the body of the message. The images must be PNG or JPEG, and the <code>content_type</code> argument must be &quot;html&quot; to include inline content.
</p>
</li>
<li> <p><code>mentions</code>: Optional vector of @mentions that will be inserted into the body of the message. This should be either an object of one of the following classes, or a list of the same: <code><a href="AzureGraph.html#topic+az_user">az_user</a></code>, <code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>, <code><a href="#topic+ms_team_member">ms_team_member</a></code>. The <code>content_type</code> argument must be &quot;html&quot; to include mentions.
</p>
</li></ul>

<p>Message attachments are uploaded to your OneDrive for Business, in the folder &quot;Microsoft Teams Chat Files&quot;. This is the same method as used by the regular Teams app. Unlike the Teams app, no localisation is performed, so the folder is always the same regardless of your language settings. As with channels, support for attachments is still somewhat experimental so please report any bugs found.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>, <code><a href="#topic+ms_chat">ms_chat</a></code>, <code><a href="#topic+ms_chat_message">ms_chat_message</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0">Microsoft Teams API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

chat &lt;- get_chat("chat-id")

# a multi-line message with an attachment
msg_text &lt;- c(
    "message line 1",
    "message line 2",
    "message line 3"
)
chat$send_message(msg_text, attachments="myfile.csv")

# sending an inline image
chat$send_message("", content_type="html", inline="graph.png")

# chat members
chat$list_members()
jane &lt;- chat$get_member("Jane Smith")
bill &lt;- chat$get_member(email="billg@mycompany.com")

# mentioning a team member
chat$send_message("Here is a message", content_type="html", mentions=jane)

# mentioning 2 or more members: use a list
chat$send_message("Here is another message", content_type="html",
    mentions=list(jane, bill))


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_chat_message'>Teams chat message</h2><span id='topic+ms_chat_message'></span>

<h3>Description</h3>

<p>Class representing a message in a Teams channel. Currently Microsoft365R only supports channels, not chats between individuals.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_chat_message</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: Always &quot;Teams message&quot; for a chat message object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this message. Currently the Graph API does not support deleting Teams messages, so this method is disabled.
</p>
</li>
<li> <p><code>update(...)</code>: Update the message's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the message.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the message metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>send_reply(body, content_type, attachments)</code>: Sends a reply to the message. See below.
</p>
</li>
<li> <p><code>list_replies(filter=NULL, n=50)</code>: List the replies to this message. By default, this is limited to the 50 most recent replies; set the <code>n</code> argument to change this.
</p>
</li>
<li> <p><code>get_reply(message_id)</code>: Retrieves a specific reply to the message.
</p>
</li>
<li> <p><code>delete_reply(message_id, confirm=TRUE)</code>: Deletes a reply to the message. Currently the Graph API does not support deleting Teams messages, so this method is disabled.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_message</code> and <code>list_messages</code> method of the <code><a href="#topic+ms_team">ms_team</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual message.
</p>


<h3>Replying to a message</h3>

<p>To reply to a message, use the <code>send_reply()</code> method. This has arguments:
</p>

<ul>
<li> <p><code>body</code>: The body of the message. This should be a character vector, which will be concatenated into a single string with newline separators. The body can be either plain text or HTML formatted.
</p>
</li>
<li> <p><code>content_type</code>: Either &quot;text&quot; (the default) or &quot;html&quot;.
</p>
</li>
<li> <p><code>attachments</code>: Optional vector of filenames.
</p>
</li>
<li> <p><code>inline</code>: Optional vector of image filenames that will be inserted into the body of the message. The images must be PNG or JPEG, and the <code>content_type</code> argument must be &quot;html&quot; to include inline content.
</p>
</li>
<li> <p><code>mentions</code>: Optional vector of @mentions that will be inserted into the body of the message. This should be either an object of one of the following classes, or a list of the same: <code><a href="AzureGraph.html#topic+az_user">az_user</a></code>, <code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>, <code><a href="#topic+ms_team_member">ms_team_member</a></code>. The <code>content_type</code> argument must be &quot;html&quot; to include mentions.
</p>
</li></ul>

<p>Teams channels don't support nested replies, so any methods dealing with replies will fail if the message object is itself a reply.
</p>
<p>Note that message attachments are actually uploaded to the channel's file listing (a directory in the team's primary shared document folder). Support for attachments is somewhat experimental, so if you want to be sure that it works, upload the file separately using the channel's <code>upload_file()</code> method.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0">Microsoft Teams API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

myteam &lt;- get_team("my team")

chan &lt;- myteam$get_channel()
msg &lt;- chan$list_messages()[[1]]
msg$list_replies()
msg$send_reply("Reply from R")


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_drive'>Personal OneDrive or SharePoint document library</h2><span id='topic+ms_drive'></span>

<h3>Description</h3>

<p>Class representing a personal OneDrive or SharePoint document library.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_drive</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this drive.
</p>
</li>
<li> <p><code>type</code>: always &quot;drive&quot; for a drive object.
</p>
</li>
<li> <p><code>properties</code>: The drive properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new drive object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a drive. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the drive metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the drive.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the drive metadata in Microsoft Graph.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;list_items(...), list_files(...)&#8288;</code>: List the files and folders under the specified path. See 'File and folder operations' below.
</p>
</li>
<li> <p><code>download_file(src, srcid, dest, overwrite)</code>: Download a file.
</p>
</li>
<li> <p><code>download_folder(src, srcid, dest, overwrite, recursive, parallel)</code>: Download a folder.
</p>
</li>
<li> <p><code>upload_file(src, dest, blocksize)</code>: Upload a file.
</p>
</li>
<li> <p><code>upload_folder(src, dest, blocksize, recursive, parallel)</code>: Upload a folder.
</p>
</li>
<li> <p><code>create_folder(path)</code>: Create a folder.
</p>
</li>
<li> <p><code>open_item(path, itemid)</code>: Open a file or folder.
</p>
</li>
<li> <p><code>create_share_link(...)</code>: Create a shareable link for a file or folder.
</p>
</li>
<li> <p><code>delete_item(path, itemid, confirm, by_item)</code>: Delete a file or folder. By default, ask for confirmation first. For personal OneDrive, deleting a folder will also automatically delete its contents; for business OneDrive or SharePoint document libraries, you may need to set <code>by_item=TRUE</code> to delete the contents first depending on your organisation's policies. Note that this can be slow for large folders.
</p>
</li>
<li> <p><code>get_item(path, itemid)</code>: Get an item representing a file or folder.
</p>
</li>
<li> <p><code>get_item_properties(path, itemid)</code>: Get the properties (metadata) for a file or folder.
</p>
</li>
<li> <p><code>set_item_properties(path, itemid, ...)</code>: Set the properties for a file or folder.
</p>
</li>
<li> <p><code>copy_item(path, itemid, dest, dest_item_id)</code>: Copy a file or folder.
</p>
</li>
<li> <p><code>move_item(path, itemid, dest, dest_item_id)</code>: Move a file or folder.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;list_shared_items(...), list_shared_files(...)&#8288;</code>: List the drive items shared with you. See 'Shared items' below.
</p>
</li>
<li> <p><code>load_dataframe(path, itemid, ...)</code>: Download a delimited file and return its contents as a data frame. See 'Saving and loading data' below.
</p>
</li>
<li> <p><code>load_rds(path, itemid)</code>: Download a .rds file and return the saved object.
</p>
</li>
<li> <p><code>load_rdata(path, itemid)</code>: Load a .RData or .Rda file into the specified environment.
</p>
</li>
<li> <p><code>save_dataframe(df, file, ...)</code> Save a dataframe to a delimited file.
</p>
</li>
<li> <p><code>save_rds(object, file)</code>: Save an R object to a .rds file.
</p>
</li>
<li> <p><code>save_rdata(..., file)</code>: Save the specified objects to a .RData file.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_drive</code> methods of the <code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="AzureGraph.html#topic+az_user">az_user</a></code> or <code><a href="#topic+ms_site">ms_site</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual drive.
</p>


<h3>File and folder operations</h3>

<p>This class exposes methods for carrying out common operations on files and folders. They call down to the corresponding methods for the <code><a href="#topic+ms_drive_item">ms_drive_item</a></code> class. In most cases an item can be specified either by path or ID. The former is more user-friendly but subject to change if the file is moved or renamed; the latter is an opaque string but is immutable regardless of file operations.
</p>
<p><code>get_item(path, itemid)</code> retrieves a file or folder, as an object of class <code><a href="#topic+ms_drive_item">ms_drive_item</a></code>. Specify either the path or ID, not both.
</p>
<p><code>open_item</code> opens the given file or folder in your browser. If the file has an unrecognised type, most browsers will attempt to download it.
</p>
<p><code>delete_item</code> deletes a file or folder. By default, it will ask for confirmation first.
</p>
<p><code>create_share_link(path, itemid, type, expiry, password, scope)</code> returns a shareable link to the item.
</p>
<p><code>get_item_properties</code> is a convenience function that returns the properties of a file or folder as a list.
</p>
<p><code>set_item_properties</code> sets the properties of a file or folder. The new properties should be specified as individual named arguments to the method. Any existing properties that aren't listed as arguments will retain their previous values or be recalculated based on changes to other properties, as appropriate. You can also call the <code>update</code> method on the corresponding <code>ms_drive_item</code> object.
</p>

<ul>
<li> <p><code>copy_item</code> and <code>move_item</code> can take the destination location as either a full pathname (in the <code>dest</code> argument), or a name plus a drive item object (in the <code>dest_folder_item</code> argument). If the latter is supplied, any path in <code>dest</code> is ignored with a warning. Note that copying is an <em>asynchronous</em> operation, meaning the method returns before the copy is complete.
</p>
</li></ul>

<p>For copying and moving, the destination folder must exist beforehand. When copying/moving a large number of files, it's much more efficient to supply the destination folder in the <code>dest_folder_item</code> argument rather than as a path.
</p>
<p><code>list_items(path, info, full_names, pagesize)</code> lists the items under the specified path.
</p>
<p><code>list_files</code> is a synonym for <code>list_items</code>.
</p>
<p><code>download_file</code> and <code>upload_file</code> transfer files between the local machine and the drive. For <code>download_file</code>, the default destination folder is the current (working) directory of your R session. For <code>upload_file</code>, there is no default destination folder; make sure you specify the destination explicitly.
</p>
<p><code>download_folder</code> and <code>upload_folder</code> transfer all the files in a folder. If <code>recursive</code> is TRUE, all subfolders will also be transferred recursively. The <code>parallel</code> argument can have the following values:
</p>

<ul>
<li><p> TRUE: A cluster with 5 workers is created
</p>
</li>
<li><p> A number: A cluster with this many workers is created
</p>
</li>
<li><p> A cluster object, created via the parallel package
</p>
</li>
<li><p> FALSE: The transfer is done serially
Transferring files in parallel can result in substantial speedup for a large number of small files.
</p>
</li></ul>

<p><code>create_folder</code> creates a folder with the specified path. Trying to create an already existing folder is an error.
</p>


<h3>Saving and loading data</h3>

<p>The following methods are provided to simplify the task of loading and saving datasets and R objects. They call down to the corresponding methods for the <code>ms_drive_item</code> class. The 'load_*&ldquo; methods allow specifying the file to be loaded by either a path or item ID.
</p>

<ul>
<li> <p><code>load_dataframe</code> downloads a delimited file and returns its contents as a data frame. The delimiter can be specified with the <code>delim</code> argument; if omitted, this is &quot;,&quot; if the file extension is .csv, &quot;;&quot; if the file extension is .csv2, and a tab otherwise. If the readr package is installed, the <code>readr::read_delim</code> function is used to parse the file, otherwise <code>utils::read.delim</code> is used. You can supply other arguments to the parsing function via the <code>...</code> argument.
</p>
</li>
<li> <p><code>save_dataframe</code> is the inverse of <code>load_dataframe</code>: it uploads the given data frame to a folder item. Specify the delimiter with the <code>delim</code> argument. The <code>readr::write_delim</code> function is used to serialise the data if that package is installed, and <code>utils::write.table</code> otherwise.
</p>
</li>
<li> <p><code>load_rds</code> downloads a .rds file and returns its contents as an R object. It is analogous to the base <code>readRDS</code> function but for OneDrive/SharePoint drive items.
</p>
</li>
<li> <p><code>save_rds</code> uploads a given R object as a .rds file, analogously to <code>saveRDS</code>.
</p>
</li>
<li> <p><code>load_rdata</code> downloads a .RData or .Rda file and loads its contents into the given environment. It is analogous to the base <code>load</code> function but for OneDrive/SharePoint drive items.
</p>
</li>
<li> <p><code>save_rdata</code> uploads the given R objects as a .RData file, analogously to <code>save</code>.
</p>
</li></ul>



<h3>Shared items</h3>

<p>The <code>list_shared_items</code> method shows the files and folders that have been shared with you. This is a named list of drive items, that you can use to access the shared files/folders. The arguments are:
</p>

<ul>
<li> <p><code>allow_external</code>: Whether to include items that were shared from outside tenants. The default is FALSE.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;filter, n&#8288;</code>: See 'List methods' below.
</p>
</li>
<li> <p><code>pagesize</code>: The number of results to return for each call to the REST endpoint. You can try reducing this argument below the default of 1000 if you are experiencing timeouts.
</p>
</li>
<li> <p><code>info</code>: Deprecated, will be ignored. In previous versions, controlled the return type of the method.
</p>
</li></ul>

<p><code>list_shared_files</code> is a synonym for <code>list_shared_items</code>.
</p>
<p>Because of how the Graph API handles access to shared items linked in the root, you cannot directly access subitems of shared folders via the drive <code>get_item</code> method, like this: <code>drv$get_item("shared_folder/path/to/file")</code>. Instead, get the item into its own object, and use its <code>get_item</code> method: <code>drv$get_item("shared_folder")$get_item("path/to/file")</code>.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_personal_onedrive">get_personal_onedrive</a></code>, <code><a href="#topic+get_business_onedrive">get_business_onedrive</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_drive_item">ms_drive_item</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0">OneDrive API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# personal OneDrive
mydrv &lt;- get_personal_onedrive()

# OneDrive for Business
busdrv &lt;- get_business_onedrive("mycompany")

# shared document library for a SharePoint site
site &lt;- get_sharepoint_site("My site")
drv &lt;- site$get_drive()

## file/folder operationss
drv$list_files()
drv$list_files("path/to/folder", full_names=TRUE)

# download a file -- default destination filename is taken from the source
drv$download_file("path/to/folder/data.csv")

# shareable links
drv$create_share_link("myfile")
drv$create_share_link("myfile", type="edit", expiry="24 hours")
drv$create_share_link("myfile", password="Use-strong-passwords!")

# file metadata (name, date created, etc)
drv$get_item_properties("myfile")

# rename a file -- item ID remains the same, while name is changed
obj &lt;- drv$get_item("myfile")
drv$set_item_properties("myfile", name="newname")

# retrieve the renamed object by ID
id &lt;- obj$properties$id
obj2 &lt;- drv$get_item(itemid=id)
obj$properties$id == obj2$properties$id  # TRUE

# saving and loading data
drv$save_dataframe(iris, "path/to/iris.csv")
iris2 &lt;- drv$load_dataframe("path/to/iris.csv")
identical(iris, iris2)  # TRUE

drv$save_rds(iris, "path/to/iris.rds")
iris3 &lt;- drv$load_rds("path/to/iris.rds")
identical(iris, iris3)  # TRUE

# accessing shared files
shared_df &lt;- drv$list_shared_items()
shared_df$remoteItem[[1]]$open()
shared_items &lt;- drv$list_shared_items(info="items")
shared_items[[1]]$open()


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_drive_item'>File or folder in a drive</h2><span id='topic+ms_drive_item'></span>

<h3>Description</h3>

<p>Class representing an item (file or folder) in a OneDrive or SharePoint document library.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_drive_item</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: always &quot;drive item&quot; for a drive item object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE, by_item=FALSE)</code>: Delete this item. By default, ask for confirmation first. For personal OneDrive, deleting a folder will also automatically delete its contents; for business OneDrive or SharePoint document libraries, you may need to set <code>by_item=TRUE</code> to delete the contents first depending on your organisation's policies. Note that this can be slow for large folders.
</p>
</li>
<li> <p><code>update(...)</code>: Update the item's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the item.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the item metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>open()</code>: Open the item in your browser.
</p>
</li>
<li> <p><code>copy(dest, dest_folder_item=NULL)</code>: Copy the item to the given location.
</p>
</li>
<li> <p><code>move(dest, dest_folder_item=NULL)</code>: Move the item to the given location.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;list_items(...), list_files(...)&#8288;</code>: List the files and folders under the specified path.
</p>
</li>
<li> <p><code>download(dest, overwrite, recursive, parallel)</code>: Download the file or folder. See below.
</p>
</li>
<li> <p><code>create_share_link(type, expiry, password, scope)</code>: Create a shareable link to the file or folder.
</p>
</li>
<li> <p><code>upload(src, dest, blocksize, , recursive, parallel)</code>: Upload a file or folder. See below.
</p>
</li>
<li> <p><code>create_folder(path)</code>: Create a folder. Only applicable for a folder item.
</p>
</li>
<li> <p><code>get_item(path)</code>: Get a child item (file or folder) under this folder.
</p>
</li>
<li> <p><code>get_parent_folder()</code>: Get the parent folder for this item, as a drive item object. Returns the root folder for the root. Not supported for remote items.
</p>
</li>
<li> <p><code>get_path()</code>: Get the absolute path for this item, as a character string. Not supported for remote items.
</p>
</li>
<li> <p><code>is_folder()</code>: Information function, returns TRUE if this item is a folder.
</p>
</li>
<li> <p><code>load_dataframe(delim=NULL, ...)</code>: Download a delimited file and return its contents as a data frame. See 'Saving and loading data' below.
</p>
</li>
<li> <p><code>load_rds()</code>: Download a .rds file and return the saved object.
</p>
</li>
<li> <p><code>load_rdata(envir)</code>: Load a .RData or .Rda file into the specified environment.
</p>
</li>
<li> <p><code>save_dataframe(df, file, delim=",", ...)</code> Save a dataframe to a delimited file.
</p>
</li>
<li> <p><code>save_rds(object, file)</code>: Save an R object to a .rds file.
</p>
</li>
<li> <p><code>save_rdata(..., file)</code>: Save the specified objects to a .RData file.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_item</code> method of the <code><a href="#topic+ms_drive">ms_drive</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual item.
</p>


<h3>File and folder operations</h3>

<p>This class exposes methods for carrying out common operations on files and folders. Note that for the methods below, any paths to child items are relative to the folder's own path.
</p>
<p><code>open</code> opens this file or folder in your browser. If the file has an unrecognised type, most browsers will attempt to download it.
</p>
<p><code>list_items(path, info, full_names, filter, n, pagesize)</code> lists the items under the specified path. It is the analogue of base R's <code>dir</code>/<code>list.files</code>. Its arguments are
</p>

<ul>
<li> <p><code>path</code>: The path.
</p>
</li>
<li> <p><code>info</code>: The information to return: either &quot;partial&quot;, &quot;name&quot; or &quot;all&quot;. If &quot;partial&quot;, a data frame is returned containing the name, size, ID and whether the item is a file or folder. If &quot;name&quot;, a vector of file/folder names is returned. If &quot;all&quot;, a data frame is returned containing <em>all</em> the properties for each item (this can be large).
</p>
</li>
<li> <p><code>full_names</code>: Whether to prefix the folder path to the names of the items.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;filter, n&#8288;</code>: See 'List methods' below.
</p>
</li>
<li> <p><code>pagesize</code>: The number of results to return for each call to the REST endpoint. You can try reducing this argument below the default of 1000 if you are experiencing timeouts.
</p>
</li></ul>

<p><code>list_files</code> is a synonym for <code>list_items</code>.
</p>
<p><code>download</code> downloads the item to the local machine. If this is a file, it is downloaded; in this case, the <code>dest</code> argument can be the path to the destination file, or NULL to return the downloaded content in a raw vector. If the item is a folder, all its files are downloaded, including subfolders if the <code>recursive</code> argument is TRUE.
</p>
<p><code>upload</code> uploads a file or folder from the local machine into the folder item. The <code>src</code> argument can be the path to the source file, a <a href="base.html#topic+rawConnection">rawConnection</a> or a <a href="base.html#topic+textConnection">textConnection</a> object. If <code>src</code> is a folder, all its files are uploaded, including subfolders if the <code>recursive</code> argument iS TRUE. An <code>ms_drive_item</code> object is returned invisibly.
</p>
<p>Uploading is done in blocks of 32MB by default; you can change this by setting the <code>blocksize</code> argument. For technical reasons, the block size <a href="https://learn.microsoft.com/en-us/graph/api/driveitem-createuploadsession?view=graph-rest-1.0#upload-bytes-to-the-upload-session">must be a multiple of 320KB</a>.
</p>
<p>Uploading and downloading folders can be done in parallel, which can result in substantial speedup when transferring a large number of small files. This is controlled by the <code>parallel</code> argument to <code>upload</code> and <code>download</code>, which can have the following values:
</p>

<ul>
<li><p> TRUE: A cluster with 5 workers is created
</p>
</li>
<li><p> A number: A cluster with this many workers is created
</p>
</li>
<li><p> A cluster object, created via the parallel package
</p>
</li>
<li><p> FALSE: The transfer is done serially
</p>
</li></ul>

<p><code>get_item</code> retrieves the file or folder with the given path, as another object of class <code>ms_drive_item</code>.
</p>

<ul>
<li> <p><code>copy</code> and <code>move</code> can take the destination location as either a full pathname (in the <code>dest</code> argument), or a name plus a drive item object (in the <code>dest_folder_item</code> argument). If the latter is supplied, any path in <code>dest</code> is ignored with a warning. Note that copying is an <em>asynchronous</em> operation, meaning the method returns before the copy is complete.
</p>
</li></ul>

<p>For copying and moving, the destination folder must exist beforehand. When copying/moving a large number of files, it's much more efficient to supply the destination folder in the <code>dest_folder_item</code> argument rather than as a path.
</p>
<p><code>create_folder</code> creates a folder with the specified path. Trying to create an already existing folder is an error. This returns an <code>ms_drive_item</code> object, invisibly.
</p>
<p><code>create_share_link(path, type, expiry, password, scope)</code> returns a shareable link to the item. Its arguments are
</p>

<ul>
<li> <p><code>path</code>: The path.
</p>
</li>
<li> <p><code>type</code>: Either &quot;view&quot; for a read-only link, &quot;edit&quot; for a read-write link, or &quot;embed&quot; for a link that can be embedded in a web page. The last one is only available for personal OneDrive.
</p>
</li>
<li> <p><code>expiry</code>: How long the link is valid for. The default is 7 days; you can set an alternative like &quot;15 minutes&quot;, &quot;24 hours&quot;, &quot;2 weeks&quot;, &quot;3 months&quot;, etc. To leave out the expiry date, set this to NULL.
</p>
</li>
<li> <p><code>password</code>: An optional password to protect the link.
</p>
</li>
<li> <p><code>scope</code>: Optionally the scope of the link, either &quot;anonymous&quot; or &quot;organization&quot;. The latter allows only users in your AAD tenant to access the link, and is only available for OneDrive for Business or SharePoint.
</p>
</li></ul>

<p>This method returns a URL to access the item, for <code>type="view"</code> or &quot;<code style="white-space: pre;">&#8288;type=edit"&#8288;</code>. For <code>type="embed"</code>, it returns a list with components <code>webUrl</code> containing the URL, and <code>webHtml</code> containing a HTML fragment to embed the link in an IFRAME. The default is a viewable link, expiring in 7 days.
</p>


<h3>Saving and loading data</h3>

<p>The following methods are provided to simplify the task of loading and saving datasets and R objects.
</p>

<ul>
<li> <p><code>load_dataframe</code> downloads a delimited file and returns its contents as a data frame. The delimiter can be specified with the <code>delim</code> argument; if omitted, this is &quot;,&quot; if the file extension is .csv, &quot;;&quot; if the file extension is .csv2, and a tab otherwise. If the readr package is installed, the <code>readr::read_delim</code> function is used to parse the file, otherwise <code>utils::read.delim</code> is used. You can supply other arguments to the parsing function via the <code>...</code> argument.
</p>
</li>
<li> <p><code>save_dataframe</code> is the inverse of <code>load_dataframe</code>: it uploads the given data frame to a folder item. Specify the delimiter with the <code>delim</code> argument. The <code>readr::write_delim</code> function is used to serialise the data if that package is installed, and <code>utils::write.table</code> otherwise.
</p>
</li>
<li> <p><code>load_rds</code> downloads a .rds file and returns its contents as an R object. It is analogous to the base <code>readRDS</code> function but for OneDrive/SharePoint drive items.
</p>
</li>
<li> <p><code>save_rds</code> uploads a given R object as a .rds file, analogously to <code>saveRDS</code>.
</p>
</li>
<li> <p><code>load_rdata</code> downloads a .RData or .Rda file and loads its contents into the given environment. It is analogous to the base <code>load</code> function but for OneDrive/SharePoint drive items.
</p>
</li>
<li> <p><code>save_rdata</code> uploads the given R objects as a .RData file, analogously to <code>save</code>.
</p>
</li></ul>



<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0">OneDrive API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# personal OneDrive
mydrv &lt;- get_personal_onedrive()

docs &lt;- mydrv$get_item("Documents")
docs$list_files()
docs$list_items()

# this is the file 'Documents/myfile.docx'
myfile &lt;- docs$get_item("myfile.docx")
myfile$properties

# rename a file
myfile$update(name="newname.docx")

# copy a file (destination folder must exist)
myfile$copy("/Documents/folder2/myfile_copied.docx")

# alternate way of copying: supply the destination folder
destfolder &lt;- docs$get_item("folder2")
myfile$copy("myfile_copied.docx", dest_folder_item=destfolder)

# move a file (destination folder must exist)
myfile$move("Documents/folder2/myfile_moved.docx")

# open the file in the browser
myfile$open()

# download the file to the working directory
myfile$download()

# shareable links
myfile$create_share_link()
myfile$create_share_link(type="edit", expiry="24 hours")
myfile$create_share_link(password="Use-strong-passwords!")

# delete the file (will ask for confirmation first)
myfile$delete()

# saving and loading data
myfolder &lt;- mydrv$get_item("myfolder")
myfolder$save_dataframe(iris, "iris.csv")
iris2 &lt;- myfolder$get_item("iris.csv")$load_dataframe()
identical(iris, iris2)  # TRUE

myfolder$save_rds(iris, "iris.rds")
iris3 &lt;- myfolder$get_item("iris.rds")$load_rds()
identical(iris, iris3)  # TRUE


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_list'>Sharepoint list</h2><span id='topic+ms_list'></span>

<h3>Description</h3>

<p>Class representing a list in a SharePoint site.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_list</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: always &quot;list&quot; for a SharePoint list object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this list. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the list's properties in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the list.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the list metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_items(filter, select, all_metadata, as_data_frame, pagesize)</code>: Queries the list and returns items as a data frame. See 'List querying' below.
</p>
</li>
<li> <p><code>get_column_info()</code>: Return a data frame containing metadata on the columns (fields) in the list.
</p>
</li>
<li> <p><code>get_item(id)</code>: Get an individual list item.
</p>
</li>
<li> <p><code>create_item(...)</code>: Create a new list item, using the named arguments as fields.
</p>
</li>
<li> <p><code>update_item(id, ...)</code>: Update the <em>data</em> fields in the given item, using the named arguments. To update the item's metadata, use <code>get_item()</code> to retrieve the item object, then call its <code>update()</code> method.
</p>
</li>
<li> <p><code>delete_item(confirm=TRUE)</code>: Delete a list item. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>bulk_import(data)</code>: Imports a data frame into the list.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_list</code> method of the <code><a href="#topic+ms_site">ms_site</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual item.
</p>


<h3>List querying</h3>

<p><code>list_items</code> supports the following arguments to customise results returned by the query.
</p>

<ul>
<li> <p><code>filter</code>: A string giving an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> to filter the rows to return. Note that column names used in the expression must be prefixed with <code style="white-space: pre;">&#8288;fields/&#8288;</code> to distinguish them from item metadata.
</p>
</li>
<li> <p><code>n</code>: The maximum number of (filtered) results to return. If this is NULL, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
</li>
<li> <p><code>select</code>: A string containing comma-separated column names to include in the returned data frame. If not supplied, includes all columns.
</p>
</li>
<li> <p><code>all_metadata</code>: If TRUE, the returned data frame will contain extended metadata as separate columns, while the data fields will be in a nested data frame named <code>fields</code>. This is always set to FALSE if <code>n=NULL</code> or <code>as_data_frame=FALSE</code>.
</p>
</li>
<li> <p><code>as_data_frame</code>: If FALSE, return the result as a list of individual <code>ms_list_item</code> objects, rather than a data frame.
</p>
</li>
<li> <p><code>pagesize</code>: The number of results to return for each call to the REST endpoint. You can try reducing this argument below the default of 5000 if you are experiencing timeouts.
</p>
</li></ul>

<p>Note that the Graph API currently doesn't support retrieving item attachments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_sharepoint_site">get_sharepoint_site</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_list_item">ms_list_item</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/sharepoint?view=graph-rest-1.0">SharePoint sites API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

site &lt;- get_sharepoint_site("My site")
lst &lt;- site$get_list("mylist")

lst$get_column_info()

lst$list_items()
lst$list_items(filter="startswith(fields/firstname, 'John')", select="firstname,lastname")

lst$create_item(firstname="Mary", lastname="Smith")
lst$get_item("item-id")
lst$update_item("item_id", firstname="Eliza")
lst$delete_item("item_id")

df &lt;- data.frame(
    firstname=c("Satya", "Mark", "Tim", "Jeff", "Sundar"),
    lastname=c("Nadella", "Zuckerberg", "Cook", "Bezos", "Pichai")
)
lst$bulk_import(df)


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_list_item'>SharePoint list item</h2><span id='topic+ms_list_item'></span>

<h3>Description</h3>

<p>Class representing an item in a SharePoint list.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_list_item</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.
</p>
</li>
<li> <p><code>type</code>: always &quot;drive item&quot; for a drive item object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (data and metadata). This is a list; the item data can be found in the <code>fields</code> component.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this item. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the item's properties (metadata) in Microsoft Graph. To update the list <em>data</em>, update the <code>fields</code> property. See the examples below.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the item.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the item data and metadata in Microsoft Graph.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_item</code> method of the <code><a href="#topic+ms_list">ms_list</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual item.
</p>


<h3>See Also</h3>

<p><code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_list">ms_list</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/sharepoint?view=graph-rest-1.0">SharePoint sites API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

site &lt;- get_sharepoint_site("My site")
lst &lt;- site$get_list("mylist")

lst_items &lt;- lst$list_items(as_data_frame=FALSE)

item &lt;- lst_items[[1]]

item$update(fields=list(firstname="Mary"))

# item data (plus some metadata mixed in)
item$properties$fields

item$delete()


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_outlook'>Outlook mail client</h2><span id='topic+ms_outlook'></span>

<h3>Description</h3>

<p>Class representing a user's Outlook email account.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_outlook</code>, inheriting from <code>ms_outlook_object</code>, which in turn inherits from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the email account.
</p>
</li>
<li> <p><code>type</code>: always &quot;Outlook account&quot; for an Outlook email account.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>update(...)</code>: Update the account's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the account.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the account metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>create_email(...)</code>: Creates a new email in the Drafts folder, optionally sending it as well. See 'Creating and sending emails'.
</p>
</li>
<li> <p><code>list_inbox_emails(...)</code>: List the emails in the Inbox folder. See 'Listing emails'.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;get_inbox(),get_drafts(),get_sent_items(),get_deleted_items()&#8288;</code>: Gets the special folder of that name. These folders are created by Outlook and exist in every email account.
</p>
</li>
<li> <p><code>list_folders(filter=NULL, n=Inf)</code>: List all folders in this account.
</p>
</li>
<li> <p><code>get_folder(folder_name, folder_id)</code>: Get a folder, either by the name or ID.
</p>
</li>
<li> <p><code>create_folder(folder_name)</code>: Create a new folder.
</p>
</li>
<li> <p><code>delete_folder(folder_name, folder_id, confirm=TRUE)</code>: Delete a folder. By default, ask for confirmation first. Note that special folders cannot be deleted.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_personal_outlook()</code> or <code>get_business_outlook()</code> functions, or the <code>get_outlook</code> method of the <code><a href="AzureGraph.html#topic+az_user">az_user</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve the account information.
</p>


<h3>Creating and sending emails</h3>

<p>To create a new email, call the <code>create_email()</code> method. The default behaviour is to create a new draft email in the Drafts folder, which can then be edited further to add attachments, recipients etc; or the email can be sent immediately.
</p>
<p>The <code>create_email()</code> method has the following signature:
</p>
<div class="sourceCode"><pre>create_email(body = "", content_type = c("text", "html"), subject = "",
             to = NULL, cc = NULL, bcc = NULL, reply_to = NULL, send_now = FALSE)
</pre></div>

<ul>
<li> <p><code>body</code>: The body of the message. This should be a string or vector of strings, which will be pasted together with newlines as separators. You can also supply a message object as created by the blastula or emayili packages&mdash;see the examples below.
</p>
</li>
<li> <p><code>content_type</code>: The format of the body, either &quot;text&quot; (the default) or HTML.
</p>
</li>
<li> <p><code>subject</code>: The subject of the message.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;to,cc,bcc,reply_to&#8288;</code>: These should be lists of email addresses, in standard &quot;user@host&quot; format. You can also supply objects of class <code><a href="AzureGraph.html#topic+az_user">AzureGraph::az_user</a></code> representing user accounts in Azure Active Directory.
</p>
</li>
<li> <p><code>send_now</code>: Whether the email should be sent immediately, or saved as a draft. You can send a draft email later with its <code>send()</code> method.
</p>
</li></ul>

<p>This returns an object of class <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>, which has methods for making further edits, attaching files, replying, forwarding, and (re-)sending.
</p>
<p>You can also supply message objects as created by the blastula and emayili packages in the <code>body</code> argument. Note that blastula objects include attachments (if any), and emayili objects include attachments, recipients, and subject line; the corresponding arguments to <code>create_email()</code> will not be used in this case.
</p>


<h3>Listing emails</h3>

<p>To list the emails in the Inbox, call the <code>list_emails()</code> method. This returns a list of objects of class <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>, and has the following signature:
</p>
<div class="sourceCode"><pre>list_emails(by = "received desc", n = 100, pagesize = 10)
</pre></div>

<ul>
<li> <p><code>by</code>: The sorting order of the message list. The possible fields are &quot;received&quot; (received date, the default), &quot;from&quot; and &quot;subject&quot;. To sort in descending order, add a &quot; desc&quot;. You can specify multiple sorting fields, with later fields used to break ties in earlier ones. The last sorting field is always &quot;received desc&quot; unless it appears earlier.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;filter, n&#8288;</code>: See below.
</p>
</li>
<li> <p><code>pagesize</code>: The number of emails per page. You can change this to a larger number to increase throughput, at the risk of running into timeouts.
</p>
</li></ul>



<h3>List methods generally</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=100</code> for listing emails, and <code>n=Inf</code> for listing folders. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_outlook_folder">ms_outlook_folder</a></code>, <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/mail-api-overview?view=graph-rest-1.0">Outlook API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

outl &lt;- get_personal_outlook()

##
## listing emails and folders
##

# the default: 100 most recent messages in the inbox
outl$list_emails()

# sorted by subject, then by most recent received date
outl$list_emails(by="subject")

# retrieve a specific email:
# note the Outlook ID is NOT the same as the Internet message-id
email_id &lt;- outl$list_emails()[[1]]$properties$id
outl$get_email(email_id)

# all folders in this account (including nested folders)
outl$list_folders()

# draft (unsent) emails
dr &lt;- outl$get_drafts()
dr$list_emails()

# sent emails
sent &lt;- outl$get_sent_items()
sent$list_emails()

##
## creating/sending emails
##

# a simple text email with just a body (can't be sent)
outl$create_email("Hello from R")

# HTML-formatted email with all necessary fields, sent immediately
outl$create_email("&lt;emph&gt;Emphatic hello&lt;/emph&gt; from R",
    content_type="html",
    to="user@example.com",
    subject="example email",
    send_now=TRUE)

# you can also create a blank email object and call its methods to add content
outl$create_email()$
    set_body("&lt;emph&gt;Emphatic hello&lt;/emph&gt; from R", content_type="html")$
    set_recipients(to="user@example.com")$
    set_subject("example email")$
    add_attachment("mydocument.docx")$
    send()

# using blastula to create a HTML email with Markdown
bl_msg &lt;- blastula::compose_email(md(
"
## Hello!

This is an email message that was generated by the blastula package.

We can use **Markdown** formatting with the `md()` function.

Cheers,

The blastula team
"),
    footer=md("Sent via Microsoft365R"))
outl$create_email(bl_msg, subject="example blastula email")


# using emayili to create an email with attachments
ey_email &lt;- emayili::envelope(
    text="Hello from emayili",
    to="user@example.com",
    subject="example emayili email") %&gt;%
    emayili::attachment("mydocument.docx") %&gt;%
    emayili::attachment("mydata.xlsx")
outl$create_email(ey_email)


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_outlook_attachment'>Outlook mail attachment</h2><span id='topic+ms_outlook_attachment'></span>

<h3>Description</h3>

<p>Class representing an attachment in Outlook.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_outlook_attachment</code>, inheriting from <code>ms_outlook_object</code>, which in turn inherits from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the email account.
</p>
</li>
<li> <p><code>type</code>: always &quot;attachment&quot; for an attachment.
</p>
</li>
<li> <p><code>properties</code>: The attachment properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this attachment. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the attachment's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the attachment.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the attachment metadata in Microsoft Graph. This method does <em>not</em> transfer the attachment content for a file attachment.
</p>
</li>
<li> <p><code>download(dest, overwrite)</code>: For a file attachment, downloads the content to a file. The default destination filename is the name of the attachment.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the the <code>get_attachment()</code>, <code>list_attachments()</code> or <code>create_attachment()</code> methods <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual attachment.
</p>
<p>In general, you should not need to interact directly with this class, as the <code>ms_outlook_email</code> class exposes convenience methods for working with attachments. The only exception is to download an attachment in a reliable way (not involving the attachment name); see the example below.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_outlook">ms_outlook</a></code>, <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/mail-api-overview?view=graph-rest-1.0">Outlook API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

outl &lt;- get_personal_outlook()

em &lt;- outl$get_inbox$get_email("email_id")

# download the first attachment in an email
atts &lt;- em$list_attachments()
atts[[1]]$download()


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_outlook_email'>Outlook mail message</h2><span id='topic+ms_outlook_email'></span>

<h3>Description</h3>

<p>Class representing an Outlook mail message. The one class represents both sent and unsent (draft) emails.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_outlook_email</code>, inheriting from <code>ms_outlook_object</code>, which in turn inherits from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the email account.
</p>
</li>
<li> <p><code>type</code>: always &quot;email&quot; for an Outlook mail message.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this email. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the email's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the email.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the email metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>set_body(body=NULL, content_type=NULL)</code>: Update the email body. See 'Editing an email' below.
</p>
</li>
<li> <p><code>set_subject(subject)</code>: Update the email subject line.
</p>
</li>
<li> <p><code>set_recipients(to=NULL, cc=NULL, bcc=NULL)</code>: Set the recipients for the email, overwriting any existing recipients.
</p>
</li>
<li> <p><code>add_recipients(to=NULL, cc=NULL, bcc=NULL)</code>: Adds recipients for the email, leaving existing ones unchanged.
</p>
</li>
<li> <p><code>set_reply_to(reply_to=NULL)</code>: Sets the reply-to field for the email.
</p>
</li>
<li> <p><code>add_attachment(object, ...)</code>: Adds an attachment to the email. See 'Attachments' below.
</p>
</li>
<li> <p><code>add_image(object)</code>: Adds an inline image to the email.
</p>
</li>
<li> <p><code>get_attachment(attachment_name=NULL, attachment_id=NULL)</code>: Gets an attachment, either by name or ID. Note that attachments don't need to have unique names; if multiple attachments share the same name, the method throws an error.
</p>
</li>
<li> <p><code>list_attachments(filter=NULL, n=Inf)</code>: Lists the current attachments for the email.
</p>
</li>
<li> <p><code>remove_attachment(attachment_name=NULL, attachment_id=NULL, confirm=TRUE)</code>: Removes an attachment from the email. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>download_attachment(attachment_name=NULL, attachment_id=NULL, ...)</code>: Downloads an attachment. This is only supported for file attachments (not URLs).
</p>
</li>
<li> <p><code>send()</code>: Sends an email.  See 'Sending, replying and forwarding'.
</p>
</li>
<li> <p><code>create_reply(comment="", send_now=FALSE)</code>: Replies to the sender of an email.
</p>
</li>
<li> <p><code>create_reply_all(comment="", send_now=FALSE)</code>: Replies to the sender and all recipients of an email.
</p>
</li>
<li> <p><code>create_forward(comment="", to=NULL, cc=NULL, bcc=NULL, send_now=FALSE)</code>: Forwards the email to other recipients.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;copy(dest),move(dest)&#8288;</code>: Copies or moves the email to the destination folder.
</p>
</li>
<li> <p><code>get_message_headers</code>: Retrieves the Internet message headers for an email, as a named character vector.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the the appropriate methods for the <code><a href="#topic+ms_outlook">ms_outlook</a></code> or <code><a href="#topic+ms_outlook_folder">ms_outlook_folder</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual folder.
</p>


<h3>Editing an email</h3>

<p>This class exposes several methods for updating the properties of an email. They should work both for unsent (draft) emails and sent ones, although they make most sense in the context of editing drafts.
</p>
<p><code>set_body(body, content_type)</code> updates the message body of the email. This has 2 arguments: <code>body</code> which is the body text itself, and <code>content_type</code> which should be either &quot;text&quot; or &quot;html&quot;. For both arguments, you can set the value to NULL to leave the current property unchanged. The <code>body</code> argument can also be a message object from either the blastula or emayili packages, much like when creating a new email.
</p>
<p><code>set_subject(subject)</code> sets the subject line of the email.
</p>
<p><code>set_recipients(to, cc, bcc)</code> sets or clears the recipients of the email. The <code>to</code>, <code>cc</code> and <code>bcc</code> arguments should be lists of either email addresses as character strings, or objects of class <code>az_user</code> representing a user account in Azure Active Directory. The default behaviour is to overwrite any existing recipients; to avoid this, pass <code>NA</code> as the value for the relevant argument. Alternatively, you can use the <code>add_recipients()</code> method.
</p>
<p><code>add_recipients(to, cc, bcc)</code> is like <code>set_recipients()</code> but leaves existing recipients unchanged.
</p>
<p><code>set_reply_to(reply_to)</code> sets or clears the reply-to address for the email. Leave the <code>reply_to</code> argument at its default NULL value to clear this property.
</p>


<h3>Attachments</h3>

<p>This class exposes the following methods for working with attachments.
</p>
<p><code>add_attachment(object, type, expiry, password, scope)</code> adds an attachment to the email. The arguments are as follows:
</p>

<ul>
<li> <p><code>object</code>: A character string containing a filename or URL, or an object of class <code><a href="#topic+ms_drive_item">ms_drive_item</a></code> representing a file in OneDrive or SharePoint. In the latter case, a shareable link to the drive item will be attached to the email, with the link details given by the other arguments.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;type, expiry, password, scope&#8288;</code>: The specifics for the shareable link to attach to the email, if <code>object</code> is a drive item. See the <code>create_share_link()</code> method of the <code><a href="#topic+ms_drive_item">ms_drive_item</a></code> class; the default is to create a read-only link valid for 7 days.
</p>
</li></ul>

<p><code>add_image(object)</code> adds an image as an <em>inline</em> attachment, ie, as part of the message body. The <code>object</code> argument should be a filename, and the message content type will be set to &quot;html&quot; if it is not already. Currently Microsoft365R does minimal formatting of the image; consider using a package like blastula for more control over the layout of inline images.
</p>
<p><code>list_attachments()</code> lists the attachments for the email, including inline images. This will be a list of objects of class <code><a href="#topic+ms_outlook_attachment">ms_outlook_attachment</a></code> containing the metadata for the attachments.
</p>
<p><code>get_attachment(attachment_name, attachment_id)</code>: Retrieves the metadata for an attachment, as an object of class <code>ms_outlook_attachment</code>. Note that multiple attachments can share the same name; in this case, you must specify the ID of the attachment.
</p>
<p><code>download_attachment(attachment_name, attachment_id, dest, overwrite)</code>: Downloads a file attachment. The default destination filename is the name of the attachment.
</p>
<p><code>remove_attachment(attachment_name, attachment_id)</code> removes (deletes) an attachment.
</p>


<h3>Sending, replying and forwarding</h3>

<p>Microsoft365R's default behaviour when creating, replying or forwarding emails is to create a draft message object, to allow for further edits. The draft is saved in the Drafts folder by default, and can be sent later by calling its <code>send()</code> method.
</p>
<p>The methods for replying and forwarding are <code>create_reply()</code>, <code>create_reply_all()</code> and <code>create_forward()</code>. The first argument to these is the reply text, which will appear above the current message text in the body of the reply. For <code>create_forward()</code>, the other arguments are <code>to</code>, <code>cc</code> and <code>bcc</code> to specify the recipients of the forwarded email.
</p>


<h3>Other methods</h3>

<p>The <code>copy()</code> and <code>move()</code> methods copy and move an email to a different folder. The destination should be an object of class <code>ms_outlook_folder</code>.
</p>
<p>The <code>get_message_headers()</code> method retrieves the Internet message headers for the email, as a named character vector.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_outlook">ms_outlook</a></code>, <code><a href="#topic+ms_outlook_folder">ms_outlook_folder</a></code>, <code><a href="#topic+ms_outlook_attachment">ms_outlook_attachment</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/mail-api-overview?view=graph-rest-1.0">Outlook API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

outl &lt;- get_personal_outlook()

##
## creating a new email
##

# a blank text email
em &lt;- outl$create_email()

# add a body
em$set_body("Hello from R", content_type="html")

# add recipients
em$set_recipients(to="user@example.com")

# add subject line
em$set_subject("example email")

# add an attachment
em$add_attachment("mydocument.docx")

# add a shareable link to a file in OneDrive
mysheet &lt;- get_personal_onedrive()$get_item("documents/mysheet.xlsx")
em$add_attachment(mysheet)

# add an inline image
em$add_image("myggplot.jpg")

# oops, wrong recipient, it should be someone else
# this removes user@example.com from the to: field
em$set_recipients(to="user2@example.com")

# and we should also cc a third user
em$add_recipients(cc="user3@example.com")

# send it
em$send()

# you can also compose an email as a pipeline
outl$create_email()$
    set_body("Hello from R")$
    set_recipients(to="user2@example.com", cc="user3@example.com")$
    set_subject("example email")$
    add_attachment("mydocument.docx")$
    send()

# using blastula to create a HTML email with Markdown
bl_msg &lt;- blastula::compose_email(md(
"
## Hello!

This is an email message that was generated by the blastula package.

We can use **Markdown** formatting with the `md()` function.

Cheers,

The blastula team
"),
    footer=md("Sent via Microsoft365R"))
outl$create_email()
    set_body(bl_msg)$
    set_subject("example blastula email")


##
## replying and forwarding
##

# get the most recent email in the Inbox
em &lt;- outl$list_emails()[[1]]

# reply to the message sender, cc'ing Carol
em$create_reply("I agree")$
    add_recipients(cc="carol@example.com")$
    send()

# reply to everyone, setting the reply-to address
em$create_reply_all("Please do not reply")$
    set_reply_to("do_not_reply@example.com")$
    send()

# forward to Dave
em$create_forward("FYI", to="dave@example.com")$
    send()


##
## attachments
##

# download an attachment by name (assumes there is only one 'myfile.docx')
em$download_attachment("myfile.docx")

# a more reliable way: get the list of attachments, and download via the object
atts &lt;- em$list_attachments()
atts[[1]]$download()

# add and remove an attachment
em$add_attachment("anotherfile.pptx")
em$remove_attachment("anotherfile.pptx")


##
## moving and copying
##

# copy an email to a nested folder: /folder1/folder2
dest &lt;- outl$get_folder("folder1")$get_folder("folder2")
em$copy(dest)

# move it instead
em$move(dest)


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_outlook_folder'>Outlook mail folder</h2><span id='topic+ms_outlook_folder'></span>

<h3>Description</h3>

<p>Class representing a folder in Outlook.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_outlook_folder</code>, inheriting from <code>ms_outlook_object</code>, which in turn inherits from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the email account.
</p>
</li>
<li> <p><code>type</code>: always &quot;mail folder&quot; for an Outlook folder object.
</p>
</li>
<li> <p><code>user_id</code>: the user ID of the Outlook account.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this folder. By default, ask for confirmation first. Note that special folders cannot be deleted.
</p>
</li>
<li> <p><code>update(...)</code>: Update the item's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the item.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the item metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_emails(...)</code>: List the emails in this folder.
</p>
</li>
<li> <p><code>get_email(message_id)</code>: Get the email with the specified ID.
</p>
</li>
<li> <p><code>create_email(...)</code>: Creates a new draft email in this folder, optionally sending it as well. See 'Creating and sending emails'.
</p>
</li>
<li> <p><code>delete_email(message_id, confim=TRUE)</code>: Deletes the specified email. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>list_folders(filter=NULL, n=Inf)</code>: List subfolders of this folder.
</p>
</li>
<li> <p><code>get_folder(folder_name, folder_id)</code>: Get a subfolder, either by the name or ID.
</p>
</li>
<li> <p><code>create_folder(folder_name)</code>: Create a new subfolder of this folder.
</p>
</li>
<li> <p><code>delete_folder(folder_name, folder_id, confirm=TRUE)</code>: Delete a subfolder. By default, ask for confirmation first.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;copy(dest),move(dest)&#8288;</code>: Copies or moves this folder to another folder. All the contents of the folder will also be copied/moved. The destination should be an object of class <code>ms_outlook_folder</code>.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_folder</code>, <code>list_folders</code> or <code>create_folder</code> methods of this class or the <code><a href="#topic+ms_outlook">ms_outlook</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual folder.
</p>


<h3>Creating and sending emails</h3>

<p>Outlook allows creating new draft emails in any folder, not just the Drafts folder (although that is the default location for the Outlook app, and the <code>ms_outlook</code> client class). To create a new email, call the <code>create_email()</code> method, which has the following signature:
</p>
<div class="sourceCode"><pre>create_email(body = "", content_type = c("text", "html"), subject = "",
             to = NULL, cc = NULL, bcc = NULL, reply_to = NULL, send_now = FALSE)
</pre></div>

<ul>
<li> <p><code>body</code>: The body of the message. This should be a string or vector of strings, which will be pasted together with newlines as separators. You can also supply a message object as created by the blastula or emayili packages&mdash;see the examples below.
</p>
</li>
<li> <p><code>content_type</code>: The format of the body, either &quot;text&quot; (the default) or HTML.
</p>
</li>
<li> <p><code>subject</code>: The subject of the message.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;to,cc,bcc,reply_to&#8288;</code>: These should be lists of email addresses, in standard &quot;user@host&quot; format. You can also supply objects of class <code><a href="AzureGraph.html#topic+az_user">AzureGraph::az_user</a></code> representing user accounts in Azure Active Directory.
</p>
</li>
<li> <p><code>send_now</code>: Whether the email should be sent immediately, or saved as a draft. You can send a draft email later with its <code>send()</code> method.
</p>
</li></ul>

<p>This returns an object of class <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>, which has methods for making further edits and attaching files.
</p>
<p>You can also supply message objects as created by the blastula and emayili packages in the <code>body</code> argument. Note that blastula objects include attachments (if any), and emayili objects include attachments, recipients, and subject line; the corresponding arguments to <code>create_email()</code> will not be used in this case.
</p>
<p>To reply to or forward an email, first retrieve it using <code>get_email()</code> or <code>list_emails()</code>, and then call its <code>create_reply()</code>, <code>create_reply_all()</code> or <code>create_forward()</code> methods.
</p>


<h3>Listing emails</h3>

<p>To list the emails in a folder, call the <code>list_emails()</code> method. This returns a list of objects of class <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>, and has the following signature:
</p>
<div class="sourceCode"><pre>list_emails(by = "received desc", search = NULL, filter = NULL, n = 100, pagesize = 10)
</pre></div>

<ul>
<li> <p><code>by</code>: The sorting order of the message list. The possible fields are &quot;received&quot; (received date, the default), &quot;from&quot; and &quot;subject&quot;. To sort in descending order, add a &quot; desc&quot;. You can specify multiple sorting fields, with later fields used to break ties in earlier ones. The last sorting field is always &quot;received desc&quot; unless it appears earlier.
</p>
</li>
<li> <p><code>search</code>: An optional string to search for. Only emails that contain the search string will be returned. See the <a href="https://learn.microsoft.com/en-us/graph/query-parameters#search-parameter">description of this parameter</a> for more information.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;filter, n&#8288;</code>: See below.
</p>
</li>
<li> <p><code>pagesize</code>: The number of emails per page. You can change this to a larger number to increase throughput, at the risk of running into timeouts.
</p>
</li></ul>

<p>Currently, searching and filtering the message list is subject to some limitations. You can only specify one of <code>search</code> and <code>filter</code>; searching and filtering at the same time will not work. Ordering the results is only allowed if neither a search term nor a filtering expression is present. If searching or filtering is done, the result is always sorted by date.
</p>


<h3>List methods generally</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=100</code> for listing emails, and <code>n=Inf</code> for listing folders. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_outlook">ms_outlook</a></code>, <code><a href="#topic+ms_outlook_email">ms_outlook_email</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/mail-api-overview?view=graph-rest-1.0">Outlook API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

outl &lt;- get_personal_outlook()

folder &lt;- outl$get_folder("My folder")

##
## listing emails
##

# the default: 100 most recent messages
folder$list_emails()

# sorted by subject, then by most recent received date
folder$list_emails(by="subject")

# sorted by from name in descending order, then by most recent received date
folder$list_emails(by="from desc")

# searching the list
folder$list_emails(search="important information")

# retrieve a specific email:
# note the Outlook ID is NOT the same as the Internet message-id
email_id &lt;- folder$list_emails()[[1]]$properties$id
folder$get_email(email_id)

##
## creating/sending emails
##

# a simple text email with just a body:
# you can add other properties by calling the returned object's methods
folder$create_email("Hello from R")

# HTML-formatted email with all necessary fields, sent immediately
folder$create_email("&lt;emph&gt;Emphatic hello&lt;/emph&gt; from R",
    content_type="html",
    to="user@example.com",
    subject="example email",
    send_now=TRUE)

# using blastula to create a HTML email with Markdown
bl_msg &lt;- blastula::compose_email(md(
"
## Hello!

This is an email message that was generated by the blastula package.

We can use **Markdown** formatting with the `md()` function.

Cheers,

The blastula team
"),
    footer=md("Sent via Microsoft365R"))
folder$create_email(bl_msg, subject="example blastula email")


# using emayili to create an email with attachments
ey_email &lt;- emayili::envelope(
    text="Hello from emayili",
    to="user@example.com",
    subject="example emayili email") %&gt;%
    emayili::attachment("mydocument.docx") %&gt;%
    emayili::attachment("mydata.xlsx")
folder$create_email(ey_email)


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_plan'>Microsoft Planner Plan</h2><span id='topic+ms_plan'></span>

<h3>Description</h3>

<p>Class representing one plan withing a Microsoft Planner.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_plan</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Details</h3>

<p>The plans belong to a group.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this drive.
</p>
</li>
<li> <p><code>type</code>: always &quot;plan&quot; for plan object.
</p>
</li>
<li> <p><code>properties</code>: The plan properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new plan object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>update(...)</code>: Update the plan metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the plan
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the plan metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_tasks(filter=NULL, n=Inf)</code>: List the tasks under the specified plan.
</p>
</li>
<li> <p><code>get_task(task_title, task_id)</code>: Get a task, either by title or ID.
</p>
</li>
<li> <p><code>list_buckets(filter=NULL, n=Inf)</code>: List the buckets under the specified plan.
</p>
</li>
<li> <p><code>get_bucket(bucket_name, bucket_id)</code>: Get a bucket, either by name or ID.
</p>
</li>
<li> <p><code>get_details()</code>: Get the plan details.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>list_plans</code> methods of the <code><a href="AzureGraph.html#topic+az_group">az_group</a></code> class.
Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual plan.
</p>


<h3>Planner operations</h3>

<p>This class exposes methods for carrying out common operations on a plan. Currently only read operations are supported.
</p>
<p>Call <code>list_tasks()</code> to list the tasks under the plan, and <code>get_task()</code> to retrieve a specific task. Similarly, call <code>list_buckets()</code> to list the buckets, and <code>get_bucket()</code> to retrieve a specific bucket.
</p>
<p>Call <code>get_details()</code> to get a list containing the details for the plan.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_plan_task">ms_plan_task</a></code>, <code><a href="#topic+ms_plan_bucket">ms_plan_bucket</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/planner-overview?view=graph-rest-beta">Plans overview</a>
</p>

<hr>
<h2 id='ms_plan_bucket'>Microsoft Planner Plan Bucket</h2><span id='topic+ms_plan_bucket'></span>

<h3>Description</h3>

<p>Class representing a bucket within a plan of a Microsoft Planner.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_plan_bucket</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this bucket
</p>
</li>
<li> <p><code>type</code>: always &quot;plan_bucket&quot; for plan bucket object.
</p>
</li>
<li> <p><code>properties</code>: The plan bucket properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new plan bucket object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>update(...)</code>: Update the plan bucket metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the plan bucket
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the plan bucket metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_tasks(filter=NULL, n=Inf)</code>: List the tasks for this bucket.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>list_buckets</code> method of the <code><a href="#topic+ms_plan">ms_plan</a></code> class.
Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual plan bucket.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_plan">ms_plan</a></code>, <code><a href="#topic+ms_plan_task">ms_plan_task</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/planner-overview?view=graph-rest-beta">Plans overview</a>
</p>

<hr>
<h2 id='ms_plan_task'>Microsoft Planner Plan Task</h2><span id='topic+ms_plan_task'></span>

<h3>Description</h3>

<p>Class representing a task within a plan of a Microsoft Planner.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_plan_task</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this task.
</p>
</li>
<li> <p><code>type</code>: always &quot;plan_task&quot; for plan task object.
</p>
</li>
<li> <p><code>properties</code>: The task properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new plan task object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>update(...)</code>: Update the plan task metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the plan task
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the plan task metadata in Microsoft Graph.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>list_tasks</code> methods of the <code><a href="#topic+ms_plan">ms_plan</a></code> class.
Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual plan task.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_plan">ms_plan</a></code>, <code><a href="#topic+ms_plan_bucket">ms_plan_bucket</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/planner-overview?view=graph-rest-beta">Plans overview</a>
</p>

<hr>
<h2 id='ms_site'>Office 365 SharePoint site</h2><span id='topic+ms_site'></span>

<h3>Description</h3>

<p>Class representing a SharePoint site.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_site</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this site.
</p>
</li>
<li> <p><code>type</code>: always &quot;site&quot; for a site object.
</p>
</li>
<li> <p><code>properties</code>: The site properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new site object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a site. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the site metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the site.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the site metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_drives(filter=NULL, n=Inf)</code>: List the drives (shared document libraries) associated with this site.
</p>
</li>
<li> <p><code>get_drive(drive_name, drive_id)</code>: Retrieve a shared document library for this site. If the name and ID are not specified, this returns the default document library.
</p>
</li>
<li> <p><code>list_subsites(filter=NULL, n=Inf)</code>: List the subsites of this site.
</p>
</li>
<li> <p><code>get_lists(filter=NULL, n=Inf)</code>: Returns the lists that are part of this site.
</p>
</li>
<li> <p><code>get_list(list_name, list_id)</code>: Returns a specific list, either by name or ID.
</p>
</li>
<li> <p><code>get_group()</code>: Retrieve the Microsoft 365 group associated with the site, if it exists. A site that backs a private Teams channel will not have a group associated with it.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_sharepoint_site</code> method of the <code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code> or <code><a href="AzureGraph.html#topic+az_group">az_group</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual site.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>, <code><a href="AzureGraph.html#topic+az_user">az_user</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/sharepoint?view=graph-rest-1.0">SharePoint sites API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

site &lt;- get_sharepoint_site("My site")
site$list_drives()
site$get_drive()


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_team'>Microsoft Teams team</h2><span id='topic+ms_team'></span>

<h3>Description</h3>

<p>Class representing a team in Microsoft Teams.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_team</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this team.
</p>
</li>
<li> <p><code>type</code>: Always &quot;team&quot; for a team object.
</p>
</li>
<li> <p><code>properties</code>: The team properties.
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new team object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete a team. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the team metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the team.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the team metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>list_channels(filter=NULL, n=Inf)</code>: List the channels for this team.
</p>
</li>
<li> <p><code>get_channel(channel_name, channel_id)</code>: Retrieve a channel. If the name and ID are not specified, returns the primary channel.
</p>
</li>
<li> <p><code>create_channel(channel_name, description, membership)</code>: Create a new channel. Optionally, you can specify a short text description of the channel, and the type of membership: either standard or private (invitation-only).
</p>
</li>
<li> <p><code>delete_channel(channel_name, channel_id, confirm=TRUE)</code>: Delete a channel; by default, ask for confirmation first. You cannot delete the primary channel of a team. Note that Teams keeps track of all channels ever created, even if you delete them (you can see the deleted channels by going to the &quot;Manage team&quot; pane for a team, then the &quot;Channels&quot; tab, and expanding the &quot;Deleted&quot; entry); therefore, try not to create and delete channels unnecessarily.
</p>
</li>
<li> <p><code>list_drives(filter=NULL, n=Inf)</code>: List the drives (shared document libraries) associated with this team.
</p>
</li>
<li> <p><code>get_drive(drive_name, drive_id)</code>: Retrieve a shared document library for this team. If the name and ID are not specified, this returns the default document library.
</p>
</li>
<li> <p><code>get_sharepoint_site()</code>: Get the SharePoint site associated with the team.
</p>
</li>
<li> <p><code>get_group()</code>: Retrieve the Microsoft 365 group associated with the team.
</p>
</li>
<li> <p><code>list_members(filter=NULL, n=Inf)</code>: Retrieves the members of the team, as a list of <code><a href="#topic+ms_team_member">ms_team_member</a></code> objects.
</p>
</li>
<li> <p><code>get_member(name, email, id)</code>: Retrieve a specific member of the channel, as a <code>ms_team_member</code> object. Supply only one of the member name, email address or ID.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_team</code> and <code>list_teams</code> methods of the <code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="AzureGraph.html#topic+az_user">az_user</a></code> or <code><a href="AzureGraph.html#topic+az_group">az_group</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual team.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">&#8288;list_*&#8288;</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>See Also</h3>

<p><code><a href="AzureGraph.html#topic+ms_graph">ms_graph</a></code>, <code><a href="AzureGraph.html#topic+az_group">az_group</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>, <code><a href="#topic+ms_site">ms_site</a></code>, <code><a href="#topic+ms_drive">ms_drive</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0">Microsoft Teams API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

myteam &lt;- get_team("my team")
myteam$list_channels()
myteam$get_channel()
myteam$get_drive()

myteam$create_channel("Test channel", description="A channel for testing")
myteam$delete_channel("Test channel")

# team members
myteam$list_members()
myteam$get_member("Jane Smith")
myteam$get_member(email="billg@mycompany.com")


## End(Not run)
</code></pre>

<hr>
<h2 id='ms_team_member'>Teams/channel member</h2><span id='topic+ms_team_member'></span>

<h3>Description</h3>

<p>Class representing a member of a team or channel (which will normally be a user in Azure Active Directory).
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_team_member</code>, inheriting from <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for the parent object.
</p>
</li>
<li> <p><code>type</code>: One of &quot;team member&quot;, &quot;channel member&quot; or &quot;chat member&quot; depending on the parent object.
</p>
</li>
<li> <p><code>properties</code>: The item properties (metadata).
</p>
</li></ul>



<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete this member.
</p>
</li>
<li> <p><code>update(...)</code>: Update the member's properties (metadata) in Microsoft Graph.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the member.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the member metadata in Microsoft Graph.
</p>
</li>
<li> <p><code>get_aaduser()</code>: Get the AAD information for the member; returns an object of class <code><a href="AzureGraph.html#topic+az_user">AzureGraph::az_user</a></code>.
</p>
</li></ul>



<h3>Initialization</h3>

<p>Creating new objects of this class should be done via the <code>get_member</code> and <code>list_members</code> methods of the <code><a href="#topic+ms_team">ms_team</a></code>and <code><a href="#topic+ms_channel">ms_channel</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual member.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ms_team">ms_team</a></code>, <code><a href="#topic+ms_channel">ms_channel</a></code>
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0">Microsoft Teams API reference</a>
</p>

<hr>
<h2 id='personal_onedrive'>Deprecated client functions</h2><span id='topic+personal_onedrive'></span><span id='topic+client-deprecated'></span><span id='topic+business_onedrive'></span><span id='topic+sharepoint_site'></span>

<h3>Description</h3>

<p>Deprecated client functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>personal_onedrive(
  app = .microsoft365r_app_id,
  scopes = c("Files.ReadWrite.All", "User.Read"),
  ...
)

business_onedrive(
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = ".default",
  ...
)

sharepoint_site(
  site_url = NULL,
  site_id = NULL,
  tenant = Sys.getenv("CLIMICROSOFT365_TENANT", "common"),
  app = Sys.getenv("CLIMICROSOFT365_AADAPPID"),
  scopes = ".default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="personal_onedrive_+3A_app">app</code></td>
<td>
<p>A custom app registration ID to use for authentication. For <code>personal_onedrive</code>, the default is to use Microsoft365R's internal app ID. For <code>business_onedrive</code> and <code>sharepoint_site</code>, see below.</p>
</td></tr>
<tr><td><code id="personal_onedrive_+3A_scopes">scopes</code></td>
<td>
<p>The Microsoft Graph scopes (permissions) to obtain.</p>
</td></tr>
<tr><td><code id="personal_onedrive_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to <code>AzureGraph::create_graph_login</code>.</p>
</td></tr>
<tr><td><code id="personal_onedrive_+3A_tenant">tenant</code></td>
<td>
<p>For <code>business_onedrive</code> and <code>sharepoint_site</code>, the name of your Azure Active Directory (AAD) tenant. If not supplied, use the value of the <code>CLIMICROSOFT365_TENANT</code> environment variable, or &quot;common&quot; if that is unset.</p>
</td></tr>
<tr><td><code id="personal_onedrive_+3A_site_url">site_url</code>, <code id="personal_onedrive_+3A_site_id">site_id</code></td>
<td>
<p>For <code>sharepoint_site</code>, the web URL and ID of the SharePoint site to retrieve. Supply one or the other, but not both.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions have been replaced by <code><a href="#topic+get_personal_onedrive">get_personal_onedrive</a></code>, <code><a href="#topic+get_business_onedrive">get_business_onedrive</a></code> and <code><a href="#topic+get_sharepoint_site">get_sharepoint_site</a></code>. They will be removed in a later version of the package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
