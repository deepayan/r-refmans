<!DOCTYPE html><html lang="en"><head><title>Help for package simrel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simrel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#AppSimrel'><p>Simulation of Multivariate Linear Model Data</p></a></li>
<li><a href='#bisimrel'><p>Simulation of Multivariate Linear Model data with response</p></a></li>
<li><a href='#cov_mat'><p>Extract various sigma matrices</p></a></li>
<li><a href='#cov_plot_data'><p>Prepare data for Plotting Covariance Matrix</p></a></li>
<li><a href='#cov_xy'><p>Covariance between X and Y</p></a></li>
<li><a href='#cov_zw'><p>Covariance between Z and W</p></a></li>
<li><a href='#cov_zy'><p>Covariance between Z and Y</p></a></li>
<li><a href='#expect_subset'><p>Extra test functions</p></a></li>
<li><a href='#ggsimrelplot'><p>Simulation Plot with ggplot: The true beta, relevant component and eigen structure</p></a></li>
<li><a href='#mbrd'><p>Function to create MBR-design.</p></a></li>
<li><a href='#mbrdsim'><p>A function to set up a design for a given set of factors with their specific levels using the MBR-design method.</p></a></li>
<li><a href='#msim'><p>Simulation of Multivariate Linear Model Data</p></a></li>
<li><a href='#multisimrel'><p>Simulation of Multivariate Linear Model Data</p></a></li>
<li><a href='#parse_parm'><p>Some helper function for simulation</p></a></li>
<li><a href='#plot_beta'><p>Plotting Functions</p></a></li>
<li><a href='#plot_cov'><p>Plotting Covariance Matrix</p></a></li>
<li><a href='#plot_covariance'><p>Plot Covariance between predictor (components) and response (components)</p></a></li>
<li><a href='#plot_simrel'><p>A wrapper function for a simrel object</p></a></li>
<li><a href='#prepare_design'><p>Prepare design for experiment from a list of simulation parameter</p></a></li>
<li><a href='#simrel'><p>Simulation of Multivariate Linear Model Data</p></a></li>
<li><a href='#simrelplot'><p>Simulation Plot: The true beta, relevant component and eigen structure</p></a></li>
<li><a href='#tidy_beta'><p>Tidy Functions to make plotting easy</p></a></li>
<li><a href='#tidy_lambda'><p>Extract Eigenvalues of predictors</p></a></li>
<li><a href='#tidy_sigma'><p>Tidy covariance matrix</p></a></li>
<li><a href='#unisimrel'><p>Function for data simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simulation of Multivariate Linear Model Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Researchers have been using simulated data from a multivariate linear model to compare and evaluate different methods, ideas and models. Additionally, teachers and educators have been using a simulation tool to demonstrate and teach various statistical and machine learning concepts.
    This package helps users to simulate linear model data with a wide range of properties by tuning few parameters such as relevant latent components. In addition, a shiny app as an 'RStudio' gadget gives users a simple interface for using the simulation function. See more on: Sæbø, S., Almøy, T., Helland, I.S. (2015) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2015.05.012">doi:10.1016/j.chemolab.2015.05.012</a>&gt; and Rimal, R., Almøy, T., Sæbø, S. (2018) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2018.02.009">doi:10.1016/j.chemolab.2018.02.009</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/simulatr/simrel/issues">https://github.com/simulatr/simrel/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://simulatr.github.io/simrel/">https://simulatr.github.io/simrel/</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Imports:</td>
<td>FrF2, ggplot2, gridExtra, jsonlite, magrittr, miniUI, purrr,
reshape2, rstudioapi, scales, sfsmisc, shiny, tibble, tidyr,
rlang, testthat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, pls, markdown, DoE.base</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-15 08:05:37 UTC; therimalaya</td>
</tr>
<tr>
<td>Author:</td>
<td>Raju Rimal <a href="https://orcid.org/0000-0001-6097-0285"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Solve Sæbø <a href="https://orcid.org/0000-0001-8699-4592"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    ths] (Original creator of the package),
  Kristian Hovde Liland
    <a href="https://orcid.org/0000-0001-6468-9423"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]
    (Contributor and coauthor of the univariate version of simrel)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Raju Rimal &lt;raju.rimal@medisin.uio.no&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-17 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='AppSimrel'>Simulation of Multivariate Linear Model Data</h2><span id='topic+AppSimrel'></span>

<h3>Description</h3>

<p>Simulation of Multivariate Linear Model Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AppSimrel()
</code></pre>


<h3>Value</h3>

<p>No return value, runs the shiny interface for simulation
</p>

<hr>
<h2 id='bisimrel'>Simulation of Multivariate Linear Model data with response</h2><span id='topic+bisimrel'></span>

<h3>Description</h3>

<p>Simulation of Multivariate Linear Model data with response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bisimrel(
  n = 50,
  p = 100,
  q = c(10, 10, 5),
  rho = c(0.8, 0.4),
  relpos = list(c(1, 2), c(2, 3)),
  gamma = 0.5,
  R2 = c(0.8, 0.8),
  ntest = NULL,
  muY = NULL,
  muX = NULL,
  sim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bisimrel_+3A_n">n</code></td>
<td>
<p>Number of training samples</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_p">p</code></td>
<td>
<p>Number of x-variables</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_q">q</code></td>
<td>
<p>Vector of number of relevant predictor variables for first, second and common to both responses</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_rho">rho</code></td>
<td>
<p>A 2-element vector, unconditional and conditional correlation between y_1 and y_2</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_relpos">relpos</code></td>
<td>
<p>A list of position of relevant component for predictor variables. The list contains vectors of position index, one vector or each response</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_gamma">gamma</code></td>
<td>
<p>A declining (decaying) factor of eigen value of predictors (X). Higher the value of <code>gamma</code>, the decrease of eigenvalues will be steeper</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_r2">R2</code></td>
<td>
<p>Vector of coefficient of determination for each response</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_ntest">ntest</code></td>
<td>
<p>Number of test observation</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_muy">muY</code></td>
<td>
<p>Vector of average (mean) for each response variable</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_mux">muX</code></td>
<td>
<p>Vector of average (mean) for each predictor variable</p>
</td></tr>
<tr><td><code id="bisimrel_+3A_sim">sim</code></td>
<td>
<p>A simrel object for reusing parameters setting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simrel object with all the input arguments along with following additional items
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>Simulated predictors</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Simulated responses</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>True regression coefficients</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>True regression intercept</p>
</td></tr>
<tr><td><code>relpred</code></td>
<td>
<p>Position of relevant predictors</p>
</td></tr>
<tr><td><code>testX</code></td>
<td>
<p>Test Predictors</p>
</td></tr>
<tr><td><code>testY</code></td>
<td>
<p>Test Response</p>
</td></tr>
<tr><td><code>minerror</code></td>
<td>
<p>Minimum model error</p>
</td></tr>
<tr><td><code>Rotation</code></td>
<td>
<p>Rotation matrix of predictor (R)</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of simrel object, in this case <em>bivariate</em></p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Eigenvalues of predictors</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Variance-Covariance matrix of response and predictors</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sæbø, S., Almøy, T., &amp; Helland, I. S. (2015). simrel—A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors. Chemometrics and Intelligent Laboratory Systems, 146, 128-135.
</p>
<p>Almøy, T. (1996). A simulation study on comparison of prediction methods when only a few components are relevant. Computational statistics &amp; data analysis, 21(1), 87-107.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- bisimrel(
   n = 100,
   p = 10,
   q = c(5, 5, 3),
   rho = c(0.8, 0.4),
   relpos = list(c(1, 2, 3), c(2, 3, 4)),
   gamma = 0.7,
   R2 = c(0.8, 0.8)
)
# Regression Coefficients from this simulation
sobj$beta
</code></pre>

<hr>
<h2 id='cov_mat'>Extract various sigma matrices</h2><span id='topic+cov_mat'></span>

<h3>Description</h3>

<p>Extract various sigma matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_mat(obj, which = c("xy", "zy", "zw"), use_population = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_mat_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="cov_mat_+3A_which">which</code></td>
<td>
<p>A character string to specify which covariance matrix to extract, possible values are &quot;xy&quot;, &quot;zy&quot; and &quot;zw&quot;</p>
</td></tr>
<tr><td><code id="cov_mat_+3A_use_population">use_population</code></td>
<td>
<p>A boolean whether to use compute population values or to estimate from sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of covariances with column equals to the number of response and row equals to the number of predictors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1983)
sobj &lt;- multisimrel()
cov_mat(sobj, which = "xy", use_population = TRUE)
cov_mat(sobj, which = "xy", use_population = FALSE)
</code></pre>

<hr>
<h2 id='cov_plot_data'>Prepare data for Plotting Covariance Matrix</h2><span id='topic+cov_plot_data'></span>

<h3>Description</h3>

<p>Prepare data for Plotting Covariance Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_plot_data(sobj, type = "relpos", ordering = TRUE, facetting = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_plot_data_+3A_sobj">sobj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="cov_plot_data_+3A_type">type</code></td>
<td>
<p>Type of covariance matrix - can take two values <code>relpos</code> for relevant position
of principal components  and <code>relpred</code> for relevant position of predictor variables</p>
</td></tr>
<tr><td><code id="cov_plot_data_+3A_ordering">ordering</code></td>
<td>
<p>TRUE for ordering the covariance for block diagonal display</p>
</td></tr>
<tr><td><code id="cov_plot_data_+3A_facetting">facetting</code></td>
<td>
<p>TRUE for facetting the predictor and response space. FALSE will give a single facet plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with covariances and related values based on <code>type</code> argument that is  ready to plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- simrel(n = 100, p = 10, q = c(4, 5), relpos = list(c(1, 2, 3), c(4, 6, 7)), m = 3,
               R2 = c(0.8, 0.7), ypos = list(c(1, 3), 2), gamma = 0.7, type = "multivariate")
head(cov_plot_data(sobj))
</code></pre>

<hr>
<h2 id='cov_xy'>Covariance between X and Y</h2><span id='topic+cov_xy'></span>

<h3>Description</h3>

<p>Covariance between X and Y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_xy(obj, use_population = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_xy_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="cov_xy_+3A_use_population">use_population</code></td>
<td>
<p>A boolean to specify wheather to use population or sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A covariance matrix of X and Y
</p>

<hr>
<h2 id='cov_zw'>Covariance between Z and W</h2><span id='topic+cov_zw'></span>

<h3>Description</h3>

<p>Helper Functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_zw(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_zw_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A covariance matrix of Z and W
</p>

<hr>
<h2 id='cov_zy'>Covariance between Z and Y</h2><span id='topic+cov_zy'></span>

<h3>Description</h3>

<p>Covariance between Z and Y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_zy(obj, use_population = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_zy_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="cov_zy_+3A_use_population">use_population</code></td>
<td>
<p>A boolean to specify wheather to use population or sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A covariance matrix of Z and Y
</p>

<hr>
<h2 id='expect_subset'>Extra test functions</h2><span id='topic+expect_subset'></span>

<h3>Description</h3>

<p>Extra test functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_subset(
  object,
  expected,
  info = NULL,
  label = NULL,
  expected.label = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expect_subset_+3A_object">object</code></td>
<td>
<p>object to test</p>
</td></tr>
<tr><td><code id="expect_subset_+3A_expected">expected</code></td>
<td>
<p>Expected value</p>
</td></tr>
<tr><td><code id="expect_subset_+3A_info">info</code></td>
<td>
<p>extra information to be included in the message (useful when writing tests in loops).</p>
</td></tr>
<tr><td><code id="expect_subset_+3A_label">label</code></td>
<td>
<p>object label. When 'NULL', computed from deparsed object.</p>
</td></tr>
<tr><td><code id="expect_subset_+3A_expected.label">expected.label</code></td>
<td>
<p>Equivalent of 'label' for shortcut form.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the object itself if expected value is found in the object as a subset else return Error
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_subset(c(1, 2, 3, 4, 5), c(2, 4, 5))
</code></pre>

<hr>
<h2 id='ggsimrelplot'>Simulation Plot with ggplot: The true beta, relevant component and eigen structure</h2><span id='topic+ggsimrelplot'></span>

<h3>Description</h3>

<p>Simulation Plot with ggplot: The true beta, relevant component and eigen structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggsimrelplot(
  obj,
  ncomp = min(obj$p, obj$n, 20),
  which = 1L:3L,
  layout = NULL,
  print.cov = FALSE,
  use_population = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggsimrelplot_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="ggsimrelplot_+3A_ncomp">ncomp</code></td>
<td>
<p>Number of components to plot</p>
</td></tr>
<tr><td><code id="ggsimrelplot_+3A_which">which</code></td>
<td>
<p>A character indicating which plot you want as output, it can take <code>TrueBeta</code>, <code>RelComp</code> and <code>EstRelComp</code></p>
</td></tr>
<tr><td><code id="ggsimrelplot_+3A_layout">layout</code></td>
<td>
<p>A layout matrix of how to layout multiple plots</p>
</td></tr>
<tr><td><code id="ggsimrelplot_+3A_print.cov">print.cov</code></td>
<td>
<p>Output estimated covariance structure</p>
</td></tr>
<tr><td><code id="ggsimrelplot_+3A_use_population">use_population</code></td>
<td>
<p>Logical, TRUE if population values should be used and FALSE if sample values should be used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim.obj &lt;- simrel(n = 100, p = 16, q = c(3, 4, 5),
   relpos = list(c(1, 2), c(3, 4), c(5, 7)), m = 5,
   ypos = list(c(1, 4), 2, c(3, 5)), type = "multivariate",
   R2 = c(0.8, 0.7, 0.9), gamma = 0.8)

ggsimrelplot(sim.obj, layout = matrix(c(2, 1, 3, 1), 2))

ggsimrelplot(sim.obj, which = c(1, 2), use_population = TRUE)

ggsimrelplot(sim.obj, which = c(1, 2), use_population = FALSE)

ggsimrelplot(sim.obj, which = c(1, 3), layout = matrix(c(1, 2), 1))
</code></pre>

<hr>
<h2 id='mbrd'>Function to create MBR-design.</h2><span id='topic+mbrd'></span>

<h3>Description</h3>

<p>Function to create multi-level binary replacement (MBR) design (Martens et al., 2010). The MBR approach was 
developed for constructing experimental designs for computer experiments.
MBR makes it possible to set up fractional designs for multi-factor problems 
with potentially many levels for each factor. In this package 
it is mainly called by the <code>mbrdsim</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbrd(
  l2levels = c(2, 2),
  fraction = 0,
  gen = NULL,
  fnames1 = NULL,
  fnames2 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mbrd_+3A_l2levels">l2levels</code></td>
<td>
<p>A vector indicating the number of log2-levels for each factor. E.g. <code>c(2,3)</code> means 2 factors,
the first with <code class="reqn">2^2=4</code> levels, the second with <code class="reqn">2^3=8</code> levels</p>
</td></tr>
<tr><td><code id="mbrd_+3A_fraction">fraction</code></td>
<td>
<p>Design fraction at bit-level. Full design: fraction=0, half-fraction: fraction=1, and so on...</p>
</td></tr>
<tr><td><code id="mbrd_+3A_gen">gen</code></td>
<td>
<p>list of generators at bit-factor level. Same as generators in function FrF2.</p>
</td></tr>
<tr><td><code id="mbrd_+3A_fnames1">fnames1</code></td>
<td>
<p>Factor names of original multi-level factors (optional).</p>
</td></tr>
<tr><td><code id="mbrd_+3A_fnames2">fnames2</code></td>
<td>
<p>Factor names at bit-level (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MBR design approach was developed for designing fractional designs in multi-level multi-factor experiments, 
typically computer experiments. The basic idea can be summarized in the following steps: 1) Choose the number of levels <code class="reqn">L</code> 
for each multi-level factor as a multiple of 2, that is <code class="reqn">L \in \{2, 4, 8,...\}</code>. 2) Replace any given multi-level factor by a 
set of <code class="reqn">ln(L)</code> two-level &quot;bit factors&quot;. The complete bit-factor design can then by expressed as a <code class="reqn">2^K</code> design where <code class="reqn">K</code> 
is the total number of bit-factors across all original multi-level factors. 3) Choose a fraction level <code class="reqn">P</code> defining av fractional 
design <code class="reqn">2^{(K-P)}</code> (see e.g. Montgomery, 2008) as for regular two-levels factorial designs. 4) 
Express the reduced design in terms of the original multi-level factors.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BitDesign</code></td>
<td>
<p>The design at bit-factor level (inherits from FrF2). Function <code>design.info()</code>
can be used to get extra design info of the bit-design, and <code>plot</code> for plotting of the bit-level design.</p>
</td></tr> 
<tr><td><code>Design</code></td>
<td>
<p>The design at original factor levels, non-randomized.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Martens, H., Måge, I., Tøndel, K., Isaeva, J., Høy, M. and Sæbø¸, S., 2010, Multi-level binary replacement (MBR) design for computer experiments in high-dimensional nonlinear systems, <em>J, Chemom</em>, <b>24</b>, 748&ndash;756.
</p>
<p>Montgomery, D., <em>Design and analysis of experiments</em>, John Wiley &amp; Sons, 2008.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> #Two variables with 8 levels each (2^3=8), a half-fraction design.
 res &lt;- mbrd(c(3,3),fraction=1, gen=list(c(1,4)))
 #plot(res$Design, pch=20, cex=2, col=2)
 #Three variabler with 8 levels each, a 1/16-fraction.
 res &lt;- mbrd(c(3,3,3),fraction=4)
 #library(rgl)
 #plot3d(res$Design,type="s",col=2)
</code></pre>

<hr>
<h2 id='mbrdsim'>A function to set up a design for a given set of factors with their specific levels using the MBR-design method.</h2><span id='topic+mbrdsim'></span>

<h3>Description</h3>

<p>The multi-level binary replacement (MBR) design approach is used here in order to facilitate the investigation of the effects of
the data properties on the performance of estimation/prediction methods. The mbrdsim function
takes as input a list containing a set of factors with their levels. The output is an MBR-design
with the combinations of the factor levels to be run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbrdsim(simlist, fraction, gen = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mbrdsim_+3A_simlist">simlist</code></td>
<td>
<p>A named list containing the levels of a set of (multi-level) factors.</p>
</td></tr>
<tr><td><code id="mbrdsim_+3A_fraction">fraction</code></td>
<td>
<p>Design fraction at bit-level. Full design: fraction=0, half-fraction: fraction=1, and so on.</p>
</td></tr>
<tr><td><code id="mbrdsim_+3A_gen">gen</code></td>
<td>
<p>Generators for the fractioning at the bit level. Default is <code>NULL</code> for which the generators are chosen
automatically by the <code>FrF2</code> function. See documentation of <code>FrF2</code> for details on how to set the generators.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BitDesign</code></td>
<td>
<p>The design at bit-factor level. The object is of class design, as output from FrF2. Function design.info()
can be used to get extra design info of the bit-design. The bit-factors are named.numbered if the input factor list is named.</p>
</td></tr>
<tr><td><code>Design</code></td>
<td>
<p>The design at original factor level, non-randomized. The factors are named if the input factor list is named.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Solve Sæbø
</p>


<h3>References</h3>

<p>Martens, H., Måge, I., Tøndel, K., Isaeva, J., Høy, M. and Sæbø¸, S., 2010, Multi-level binary replacement (MBR) design for computer experiments in high-dimensional nonlinear systems, <em>J, Chemom</em>, <b>24</b>, 748&ndash;756.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Input: A list of factors with their levels (number of levels must be a multiple of 2).
## Simrel Parameters ----
sim_list &lt;- list(
  p = c(20, 150),
  gamma = seq(0.2, 1.1, length.out = 4),
  relpos = list(list(c(1, 2, 3), c(4, 5, 6)), list(c(1, 5, 6), c(2, 3, 4))),
  R2 = list(c(0.4, 0.8), c(0.8, 0.8)),
  ypos = list(list(1, c(2, 3)), list(c(1, 3), 2))
)
## 1/8 fractional Design ----
dgn &lt;- mbrdsim(sim_list, fraction = 3)
design &lt;- cbind(
  dgn[["Design"]],
  q = lapply(dgn[["Design"]][, "p"], function(x) rep(x/2, 2)),
  type = "multivariate",
  n = 100,
  ntest = 200,
  m = 3,
  eta = 0.6
)
## Simulation ----
sobj &lt;- apply(design, 1, function(x) do.call(simrel, x))
names(sobj) &lt;- paste0("Design", seq.int(sobj))

# Info about the bit-design including bit-level aliasing (and resolution if \code{gen = NULL})
if (requireNamespace("DoE.base", quietly = TRUE)) {
  dgn &lt;- mbrdsim(sim_list, fraction = 3)
  DoE.base::design.info(dgn$BitDesign)
}
</code></pre>

<hr>
<h2 id='msim'>Simulation of Multivariate Linear Model Data</h2><span id='topic+msim'></span>

<h3>Description</h3>

<p>Simulation of Multivariate Linear Model Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msim(
  p = 15,
  q = c(5, 4, 3),
  m = 5,
  relpos = list(c(1, 2), c(3, 4, 6), c(5, 7)),
  gamma = 0.6,
  R2 = c(0.8, 0.7, 0.8),
  eta = 0,
  muX = NULL,
  muY = NULL,
  ypos = list(c(1), c(3, 4), c(2, 5))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msim_+3A_p">p</code></td>
<td>
<p>Number of variables</p>
</td></tr>
<tr><td><code id="msim_+3A_q">q</code></td>
<td>
<p>Vector containing the number of relevant predictor variables for each relevant response components</p>
</td></tr>
<tr><td><code id="msim_+3A_m">m</code></td>
<td>
<p>Number of response variables</p>
</td></tr>
<tr><td><code id="msim_+3A_relpos">relpos</code></td>
<td>
<p>A list of position of relevant component for predictor variables. The list contains vectors of position index, one vector or each relevant response components</p>
</td></tr>
<tr><td><code id="msim_+3A_gamma">gamma</code></td>
<td>
<p>A declining (decaying) factor of eigen value of predictors (X). Higher the value of <code>gamma</code>, the decrease of eigenvalues will be steeper</p>
</td></tr>
<tr><td><code id="msim_+3A_r2">R2</code></td>
<td>
<p>Vector of coefficient of determination (proportion of variation explained by predictor variable) for each relevant response components</p>
</td></tr>
<tr><td><code id="msim_+3A_eta">eta</code></td>
<td>
<p>A declining (decaying) factor of eigenvalues of response (Y). Higher the value of <code>eta</code>, more will be the declining of eigenvalues of Y. <code>eta = 0</code> refers that all eigenvalues of responses (Y) are 1.</p>
</td></tr>
<tr><td><code id="msim_+3A_mux">muX</code></td>
<td>
<p>Vector of average (mean) for each predictor variable</p>
</td></tr>
<tr><td><code id="msim_+3A_muy">muY</code></td>
<td>
<p>Vector of average (mean) for each response variable</p>
</td></tr>
<tr><td><code id="msim_+3A_ypos">ypos</code></td>
<td>
<p>List of position of relevant response components that are combined to generate response variable during orthogonal rotation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simrel object with all the input arguments along with following additional items
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>Simulated predictors</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Simulated responses</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Simulated predictor components</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>Simulated response components</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>True regression coefficients</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>True regression intercept</p>
</td></tr>
<tr><td><code>relpred</code></td>
<td>
<p>Position of relevant predictors</p>
</td></tr>
<tr><td><code>testX</code></td>
<td>
<p>Test Predictors</p>
</td></tr>
<tr><td><code>testY</code></td>
<td>
<p>Test Response</p>
</td></tr>
<tr><td><code>testW</code></td>
<td>
<p>Test predictor components</p>
</td></tr>
<tr><td><code>testZ</code></td>
<td>
<p>Test response components</p>
</td></tr>
<tr><td><code>minerror</code></td>
<td>
<p>Minimum model error</p>
</td></tr>
<tr><td><code>Xrotation</code></td>
<td>
<p>Rotation matrix of predictor (R)</p>
</td></tr>
<tr><td><code>Yrotation</code></td>
<td>
<p>Rotation matrix of response (Q)</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of simrel object <em>univariate</em> or <em>multivariate</em></p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Eigenvalues of predictors</p>
</td></tr>
<tr><td><code>SigmaWZ</code></td>
<td>
<p>Variance-Covariance matrix of components of response and predictors</p>
</td></tr>
<tr><td><code>SigmaWX</code></td>
<td>
<p>Covariance matrix of response components and predictors</p>
</td></tr>
<tr><td><code>SigmaYZ</code></td>
<td>
<p>Covariance matrix of response and predictor components</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Variance-Covariance matrix of response and predictors</p>
</td></tr>
<tr><td><code>RsqW</code></td>
<td>
<p>Coefficient of determination corresponding to response components</p>
</td></tr>
<tr><td><code>RsqY</code></td>
<td>
<p>Coefficient of determination corresponding to response variables</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sæbø, S., Almøy, T., &amp; Helland, I. S. (2015). simrel—A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors. Chemometrics and Intelligent Laboratory Systems, 146, 128-135.
</p>
<p>Almøy, T. (1996). A simulation study on comparison of prediction methods when only a few components are relevant. Computational statistics &amp; data analysis, 21(1), 87-107.
</p>

<hr>
<h2 id='multisimrel'>Simulation of Multivariate Linear Model Data</h2><span id='topic+multisimrel'></span>

<h3>Description</h3>

<p>Simulation of Multivariate Linear Model Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multisimrel(
  n = 100,
  p = 15,
  q = c(5, 4, 3),
  m = 5,
  relpos = list(c(1, 2), c(3, 4, 6), c(5, 7)),
  gamma = 0.6,
  R2 = c(0.8, 0.7, 0.8),
  eta = 0,
  ntest = NULL,
  muX = NULL,
  muY = NULL,
  ypos = list(c(1), c(3, 4), c(2, 5))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multisimrel_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_p">p</code></td>
<td>
<p>Number of variables</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_q">q</code></td>
<td>
<p>Vector containing the number of relevant predictor variables for each relevant response components</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_m">m</code></td>
<td>
<p>Number of response variables</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_relpos">relpos</code></td>
<td>
<p>A list of position of relevant component for predictor variables. The list contains vectors of position index, one vector or each relevant response components</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_gamma">gamma</code></td>
<td>
<p>A declining (decaying) factor of eigen value of predictors (X). Higher the value of <code>gamma</code>, the decrease of eigenvalues will be steeper</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_r2">R2</code></td>
<td>
<p>Vector of coefficient of determination (proportion of variation explained by predictor variable) for each relevant response components</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_eta">eta</code></td>
<td>
<p>A declining (decaying) factor of eigenvalues of response (Y). Higher the value of <code>eta</code>, more will be the declining of eigenvalues of Y. <code>eta = 0</code> refers that all eigenvalues of responses (Y) are 1.</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_ntest">ntest</code></td>
<td>
<p>Number of test observation</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_mux">muX</code></td>
<td>
<p>Vector of average (mean) for each predictor variable</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_muy">muY</code></td>
<td>
<p>Vector of average (mean) for each response variable</p>
</td></tr>
<tr><td><code id="multisimrel_+3A_ypos">ypos</code></td>
<td>
<p>List of position of relevant response components that are combined to generate response variable during orthogonal rotation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simrel object with all the input arguments along with following additional items
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>Simulated predictors</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Simulated responses</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Simulated predictor components</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>Simulated response components</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>True regression coefficients</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>True regression intercept</p>
</td></tr>
<tr><td><code>relpred</code></td>
<td>
<p>Position of relevant predictors</p>
</td></tr>
<tr><td><code>testX</code></td>
<td>
<p>Test Predictors</p>
</td></tr>
<tr><td><code>testY</code></td>
<td>
<p>Test Response</p>
</td></tr>
<tr><td><code>testW</code></td>
<td>
<p>Test predictor components</p>
</td></tr>
<tr><td><code>testZ</code></td>
<td>
<p>Test response components</p>
</td></tr>
<tr><td><code>minerror</code></td>
<td>
<p>Minimum model error</p>
</td></tr>
<tr><td><code>Xrotation</code></td>
<td>
<p>Rotation matrix of predictor (R)</p>
</td></tr>
<tr><td><code>Yrotation</code></td>
<td>
<p>Rotation matrix of response (Q)</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of simrel object <em>univariate</em> or <em>multivariate</em></p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Eigenvalues of predictors</p>
</td></tr>
<tr><td><code>SigmaWZ</code></td>
<td>
<p>Variance-Covariance matrix of components of response and predictors</p>
</td></tr>
<tr><td><code>SigmaWX</code></td>
<td>
<p>Covariance matrix of response components and predictors</p>
</td></tr>
<tr><td><code>SigmaYZ</code></td>
<td>
<p>Covariance matrix of response and predictor components</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Variance-Covariance matrix of response and predictors</p>
</td></tr>
<tr><td><code>RsqW</code></td>
<td>
<p>Coefficient of determination corresponding to response components</p>
</td></tr>
<tr><td><code>RsqY</code></td>
<td>
<p>Coefficient of determination corresponding to response variables</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sæbø, S., Almøy, T., &amp; Helland, I. S. (2015). simrel—A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors. Chemometrics and Intelligent Laboratory Systems, 146, 128-135.
</p>
<p>Almøy, T. (1996). A simulation study on comparison of prediction methods when only a few components are relevant. Computational statistics &amp; data analysis, 21(1), 87-107.
</p>

<hr>
<h2 id='parse_parm'>Some helper function for simulation</h2><span id='topic+parse_parm'></span>

<h3>Description</h3>

<p>These function helps to parse a character string into a list object and also creates parameters for performing multiple simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_parm(character_string, in_list = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parse_parm_+3A_character_string">character_string</code></td>
<td>
<p>A character string for parameter where the items in a list is separated by semicolon. For example: 1, 2; 3, 4</p>
</td></tr>
<tr><td><code id="parse_parm_+3A_in_list">in_list</code></td>
<td>
<p>TRUE if the result need to wrap in a list, default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list or a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parse_parm("1, 2; 3, 4")
parse_parm("1, 2")
</code></pre>

<hr>
<h2 id='plot_beta'>Plotting Functions</h2><span id='topic+plot_beta'></span>

<h3>Description</h3>

<p>Plotting Functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_beta(obj, base_theme = theme_grey, lab_list = NULL, theme_list = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_beta_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_base_theme">base_theme</code></td>
<td>
<p>Base ggplot theme to apply</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_lab_list">lab_list</code></td>
<td>
<p>List of labs arguments such as x, y, title, subtitle</p>
</td></tr>
<tr><td><code id="plot_beta_+3A_theme_list">theme_list</code></td>
<td>
<p>List of theme arguments to apply in the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of true regression coefficients for the simulated data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- multisimrel()
sobj %&gt;%
    plot_beta(
        base_theme = ggplot2::theme_bw,
        lab_list = list(
            title = "Regression Coefficients",
            subtitle = "From Simulation",
            y = "True Regression Coefficients"
        ),
        theme_list = list(
            legend.position = "bottom"
        )
    )
</code></pre>

<hr>
<h2 id='plot_cov'>Plotting Covariance Matrix</h2><span id='topic+plot_cov'></span>

<h3>Description</h3>

<p>Plotting Covariance Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cov(sobj, type = "relpos", ordering = TRUE, facetting = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cov_+3A_sobj">sobj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="plot_cov_+3A_type">type</code></td>
<td>
<p>Type of covariance matrix - can take two values <code>relpos</code> for relevant position
of principal components  and <code>relpred</code> for relevant position of predictor variables</p>
</td></tr>
<tr><td><code id="plot_cov_+3A_ordering">ordering</code></td>
<td>
<p>TRUE for ordering the covariance for block diagonal display</p>
</td></tr>
<tr><td><code id="plot_cov_+3A_facetting">facetting</code></td>
<td>
<p>TRUE for facetting the predictor and response space. FALSE will give a single facet plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A covariance plot
</p>


<h3>References</h3>

<p>Sæbø, S., Almøy, T., &amp; Helland, I. S. (2015). simrel—A versatile tool for linear
model data simulation based on the concept of a relevant subspace and relevant predictors.
Chemometrics and Intelligent Laboratory Systems, 146, 128-135.
</p>
<p>Almøy, T. (1996). A simulation study on comparison of prediction methods when only a
few components are relevant. Computational statistics &amp; data analysis, 21(1), 87-107.
</p>
<p>Rimal, R., Almøy, T., &amp; Sæbø, S. (2018). A tool for simulating multi-response linear model data. Chemometrics and Intelligent Laboratory Systems, 176, 1-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- simrel(n = 100, p = 10, q = c(4, 5), relpos = list(c(1, 2, 3), c(4, 6, 7)), m = 3,
               R2 = c(0.8, 0.7), ypos = list(c(1, 3), 2), gamma = 0.7, type = "multivariate")
p1 &lt;- plot_cov(sobj, type = "relpos", facetting = FALSE)
p2 &lt;- plot_cov(sobj, type = "rotation", facetting = FALSE)
p3 &lt;- plot_cov(sobj, type = "relpred", facetting = FALSE)
gridExtra::grid.arrange(p1, p2, p3, ncol = 3)
</code></pre>

<hr>
<h2 id='plot_covariance'>Plot Covariance between predictor (components) and response (components)</h2><span id='topic+plot_covariance'></span>

<h3>Description</h3>

<p>Plot Covariance between predictor (components) and response (components)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_covariance(
  sigma_df,
  lambda_df = NULL,
  base_theme = theme_grey,
  lab_list = NULL,
  theme_list = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_covariance_+3A_sigma_df">sigma_df</code></td>
<td>
<p>A data.frame generated by tidy_sigma</p>
</td></tr>
<tr><td><code id="plot_covariance_+3A_lambda_df">lambda_df</code></td>
<td>
<p>A data.frame generated by tidy_lambda</p>
</td></tr>
<tr><td><code id="plot_covariance_+3A_base_theme">base_theme</code></td>
<td>
<p>Base ggplot theme to apply</p>
</td></tr>
<tr><td><code id="plot_covariance_+3A_lab_list">lab_list</code></td>
<td>
<p>List of labs arguments such as x, y, title, subtitle</p>
</td></tr>
<tr><td><code id="plot_covariance_+3A_theme_list">theme_list</code></td>
<td>
<p>List of theme arguments to apply in the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of true regression coefficients for the simulated data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- bisimrel(p = 12)
sigma_df &lt;- sobj %&gt;%
    cov_mat(which = "zy") %&gt;%
    tidy_sigma() %&gt;%
    abs_sigma()
lambda_df &lt;- sobj %&gt;%
    tidy_lambda()
plot_covariance(
    sigma_df,
    lambda_df,
    base_theme = ggplot2::theme_bw,
    lab_list = list(
        title = "Covariance between Response and Predictor Components",
        subtitle = "The bar represents the eigenvalues predictor covariance",
        y = "Absolute covariance",
        x = "Predictor Component",
        color = "Response Component"
    ),
    theme_list = list(
        legend.position = "bottom"
    )
)
</code></pre>

<hr>
<h2 id='plot_simrel'>A wrapper function for a simrel object</h2><span id='topic+plot_simrel'></span>

<h3>Description</h3>

<p>A wrapper function for a simrel object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_simrel(
  obj,
  ncomp = min(obj$p, obj$n, 20),
  which = c(1L:4L),
  layout = NULL,
  print.cov = FALSE,
  use_population = TRUE,
  palette = "Set1",
  base_theme = ggplot2::theme_grey,
  lab_list = NULL,
  theme_list = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_simrel_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_ncomp">ncomp</code></td>
<td>
<p>Number of components to show in x-axis</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_which">which</code></td>
<td>
<p>An integer specifying which simrel plot to obtain</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_layout">layout</code></td>
<td>
<p>A layout matrix for arranging the simrel plots</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_print.cov">print.cov</code></td>
<td>
<p>A boolean where to print covariance matrices</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_use_population">use_population</code></td>
<td>
<p>A boolean specifying weather to get plot for population or sample</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_palette">palette</code></td>
<td>
<p>Name of color paletter compaticable with RColorBrewer</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_base_theme">base_theme</code></td>
<td>
<p>Base ggplot theme to apply</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_lab_list">lab_list</code></td>
<td>
<p>List of labs arguments such as x, y, title, subtitle. A nested list if the argument which has length greater than 1.</p>
</td></tr>
<tr><td><code id="plot_simrel_+3A_theme_list">theme_list</code></td>
<td>
<p>List of theme arguments to apply in the plot. A nested list if the argument which has length greater than 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simrel Plot(s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- bisimrel(p = 12)
plot_simrel(sobj, layout = matrix(1:4, 2, 2))
</code></pre>

<hr>
<h2 id='prepare_design'>Prepare design for experiment from a list of simulation parameter</h2><span id='topic+prepare_design'></span>

<h3>Description</h3>

<p>Prepare design for experiment from a list of simulation parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_design(option_list, tabular = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_design_+3A_option_list">option_list</code></td>
<td>
<p>A list of options that is to be parsed</p>
</td></tr>
<tr><td><code id="prepare_design_+3A_tabular">tabular</code></td>
<td>
<p>logical if output is needed in tabular form or list format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parsed parameters for simulatr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>opts &lt;- list(
  n = rep(100, 2),
  p = c(20, 40),
  q = c("5, 5, 4",
        "10, 5, 5"),
  m = c(5, 5),
  relpos = c("1; 2, 4; 3",
             "1, 2; 3, 4; 5"),
  gamma = c(0.2, 0.4),
  R2 = c("0.8, 0.9, 0.7",
         "0.6, 0.8, 0.7"),
  ypos = c("1, 4; 2, 5; 3",
           "1; 2, 4; 3, 5"),
  ntest = rep(1000, 2)
)
design &lt;- prepare_design(opts)
design
</code></pre>

<hr>
<h2 id='simrel'>Simulation of Multivariate Linear Model Data</h2><span id='topic+simrel'></span>

<h3>Description</h3>

<p>Simulation of Multivariate Linear Model Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simrel(n, p, q, relpos, gamma, R2, type = "univariate", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simrel_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="simrel_+3A_p">p</code></td>
<td>
<p>Number of variables.</p>
</td></tr>
<tr><td><code id="simrel_+3A_q">q</code></td>
<td>
<p>An integer for univariate, a vector of 3 integers for bivariate and 3 or more for multivariate simulation (for details see Notes).</p>
</td></tr>
<tr><td><code id="simrel_+3A_relpos">relpos</code></td>
<td>
<p>A list (vector in case of univariate simulation) of position of relevant component for predictor variables corresponding to each response.</p>
</td></tr>
<tr><td><code id="simrel_+3A_gamma">gamma</code></td>
<td>
<p>A declining (decaying) factor of eigenvalues of predictors (X). Higher the value of <code>gamma</code>, the decrease of eigenvalues will be steeper.</p>
</td></tr>
<tr><td><code id="simrel_+3A_r2">R2</code></td>
<td>
<p>Vector of coefficient of determination (proportion of variation explained by predictor variable) for each relevant response components.</p>
</td></tr>
<tr><td><code id="simrel_+3A_type">type</code></td>
<td>
<p>Type of simulation - <code>univariate</code>, <code>bivariate</code> and <code>multivariate</code></p>
</td></tr>
<tr><td><code id="simrel_+3A_...">...</code></td>
<td>
<p>Since this is a wrapper function to simulate univariate, bivariate or multivariate, it calls their respective function. This parameter should contain all the necessary arguements for respective simulations. See <code><a href="#topic+unisimrel">unisimrel</a></code>, <code><a href="#topic+bisimrel">bisimrel</a></code> and <code><a href="#topic+multisimrel">multisimrel</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simrel object with all the input arguments along with following additional items.
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>Simulated predictors</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Simulated responses</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Simulated predictor components</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>Simulated response components</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>True regression coefficients</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>True regression intercept</p>
</td></tr>
<tr><td><code>relpred</code></td>
<td>
<p>Position of relevant predictors</p>
</td></tr>
<tr><td><code>testX</code></td>
<td>
<p>Test Predictors</p>
</td></tr>
<tr><td><code>testY</code></td>
<td>
<p>Test Response</p>
</td></tr>
<tr><td><code>testW</code></td>
<td>
<p>Test predictor components</p>
</td></tr>
<tr><td><code>testZ</code></td>
<td>
<p>Test response components</p>
</td></tr>
<tr><td><code>minerror</code></td>
<td>
<p>Minimum model error</p>
</td></tr>
<tr><td><code>Xrotation</code></td>
<td>
<p>Rotation matrix of predictor (R)</p>
</td></tr>
<tr><td><code>Yrotation</code></td>
<td>
<p>Rotation matrix of response (Q)</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>Type of simrel object <em>univariate</em> or <em>multivariate</em></p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Eigenvalues of predictors</p>
</td></tr>
<tr><td><code>SigmaWZ</code></td>
<td>
<p>Variance-Covariance matrix of components of response and predictors</p>
</td></tr>
<tr><td><code>SigmaWX</code></td>
<td>
<p>Covariance matrix of response components and predictors</p>
</td></tr>
<tr><td><code>SigmaYZ</code></td>
<td>
<p>Covariance matrix of response and predictor components</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Variance-Covariance matrix of response and predictors</p>
</td></tr>
<tr><td><code>RsqW</code></td>
<td>
<p>Coefficient of determination corresponding to response components</p>
</td></tr>
<tr><td><code>RsqY</code></td>
<td>
<p>Coefficient of determination corresponding to response variables</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sæbø, S., Almøy, T., &amp; Helland, I. S. (2015). simrel—A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors. Chemometrics and Intelligent Laboratory Systems, 146, 128-135.
</p>
<p>Almøy, T. (1996). A simulation study on comparison of prediction methods when only a few components are relevant. Computational statistics &amp; data analysis, 21(1), 87-107.
</p>

<hr>
<h2 id='simrelplot'>Simulation Plot: The true beta, relevant component and eigen structure</h2><span id='topic+simrelplot'></span>

<h3>Description</h3>

<p>Simulation Plot: The true beta, relevant component and eigen structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simrelplot(
  obj,
  ncomp = min(obj$p, obj$n, 20),
  ask = TRUE,
  print.cov = FALSE,
  which = 1L:3L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simrelplot_+3A_obj">obj</code></td>
<td>
<p>A simrel object</p>
</td></tr>
<tr><td><code id="simrelplot_+3A_ncomp">ncomp</code></td>
<td>
<p>Number of components to plot</p>
</td></tr>
<tr><td><code id="simrelplot_+3A_ask">ask</code></td>
<td>
<p>logical, TRUE: functions ask for comfirmation FALSE: function layout plot on predefined format</p>
</td></tr>
<tr><td><code id="simrelplot_+3A_print.cov">print.cov</code></td>
<td>
<p>Output estimated covariance structure</p>
</td></tr>
<tr><td><code id="simrelplot_+3A_which">which</code></td>
<td>
<p>A character indicating which plot you want as output, it can take <code>TrueBeta</code>, <code>RelComp</code> and <code>EstRelComp</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of plots
</p>

<hr>
<h2 id='tidy_beta'>Tidy Functions to make plotting easy</h2><span id='topic+tidy_beta'></span><span id='topic+abs_sigma'></span>

<h3>Description</h3>

<p>Tidy Functions to make plotting easy
</p>
<p>Absolute value of sigma scaled by the overall maximum absolute value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_beta(obj)

abs_sigma(sigma_df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_beta_+3A_obj">obj</code></td>
<td>
<p>A Simrel Object</p>
</td></tr>
<tr><td><code id="tidy_beta_+3A_sigma_df">sigma_df</code></td>
<td>
<p>A tidy covariance data frame generated by tidy_sigma function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with three columns: Predictor, Response and BetaCoef
</p>
<p>Another data.frame (tibble) of same dimension with absolute covarinace scaled by overall maximum absolute values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- multisimrel()
beta_df &lt;- tidy_beta(sobj)
beta_df
sobj &lt;- multisimrel()
sobj %&gt;% 
    cov_mat("zy") %&gt;% 
    tidy_sigma() %&gt;% 
    abs_sigma()
</code></pre>

<hr>
<h2 id='tidy_lambda'>Extract Eigenvalues of predictors</h2><span id='topic+tidy_lambda'></span>

<h3>Description</h3>

<p>Extract Eigenvalues of predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_lambda(obj, use_population = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_lambda_+3A_obj">obj</code></td>
<td>
<p>A simrel Object</p>
</td></tr>
<tr><td><code id="tidy_lambda_+3A_use_population">use_population</code></td>
<td>
<p>A boolean to specify where to use population value or calculate from sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of eigenvalues for each predictors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- multisimrel()
sobj %&gt;% 
    tidy_lambda()
</code></pre>

<hr>
<h2 id='tidy_sigma'>Tidy covariance matrix</h2><span id='topic+tidy_sigma'></span>

<h3>Description</h3>

<p>Tidy covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidy_sigma(covs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tidy_sigma_+3A_covs">covs</code></td>
<td>
<p>A sigma matrix obtained from cov_mat function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with three columns: Predictor, Response and Covariance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sobj &lt;- multisimrel()
</code></pre>

<hr>
<h2 id='unisimrel'>Function for data simulation</h2><span id='topic+unisimrel'></span>

<h3>Description</h3>

<p>Functions for data simulation from a random regression model with one
response variable where the data properties can be controlled by a few input
parameters.  The data simulation is based on the concept of relevant latent
components and relevant predictors, and was developed for the purpose of
testing methods for variable selection for prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unisimrel(
  n,
  p,
  q,
  relpos,
  gamma,
  R2,
  ntest = NULL,
  muY = NULL,
  muX = NULL,
  lambda.min = .Machine$double.eps,
  sim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unisimrel_+3A_n">n</code></td>
<td>
<p>The number of (training) samples to generate.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_p">p</code></td>
<td>
<p>The total number of predictor variables to generate.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_q">q</code></td>
<td>
<p>The number of relevant predictor variables (as a subset of <code class="reqn">p</code>).</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_relpos">relpos</code></td>
<td>
<p>A vector indicating the position (between 1 and <code class="reqn">p</code>) of the <code class="reqn">m</code> relevant components, e.g. <code class="reqn">c(1,2)</code> means that the first two latent components should be relevant. The length of relpos must be equal to <code class="reqn">m</code>.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_gamma">gamma</code></td>
<td>
<p>A number defining the speed of decline in eigenvalues (variances) of the latent components. The eigenvalues are assumed to decline according to an exponential model. The first eigenvalue is set equal to 1.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_r2">R2</code></td>
<td>
<p>The theoretical R-squared according to the true linear model. A number between 0 and 1.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_ntest">ntest</code></td>
<td>
<p>The number of test samples to be generated (optional).</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_muy">muY</code></td>
<td>
<p>The true mean of the response variable (optional). Default is muY=NULL.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_mux">muX</code></td>
<td>
<p>The <code>p</code>-vector of true means of the predictor variables (optional). Default is muX=NULL.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_lambda.min">lambda.min</code></td>
<td>
<p>Lower bound of the eigenvalues. Defaults to .Machine$double.eps.</p>
</td></tr>
<tr><td><code id="unisimrel_+3A_sim">sim</code></td>
<td>
<p>A fitted simrel object. If this is given, the same regression coefficients will be used to simulate a new data set of requested size. Default is NULL, for which new regression coefficients are sampled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data are simulated according to a multivariate normal model for the
vector <code class="reqn">(y, z_1, z_2, z_3, ..., z_p)^t</code> where <code class="reqn">y</code> is the response
variable and <code class="reqn">z = (z_1,..., z_p)^t</code> is the vector of latent (principal)
components. The ordered principal components are uncorrelated variables with
declining variances (eigenvalues) defined for component <code class="reqn">j</code> as
<code class="reqn">e^{-\gamma * j}/e^{-\gamma}</code>. Hence, the variance (eigenvalue) of the
first principal component is equal to 1, and a large value of <code class="reqn">\gamma</code>
gives a rapid decline in the variances. The variance of the response
variable is by default fixed equal to 1.
</p>
<p>Some of the principal components (ordered by their decreasing variances) are
assumed to be relevant for the prediction of the response. The indices of
the positions of the relevant components are set by the <code>relpos</code>
argument. The joint degree of relevance for the relevant components is
determined by the population R-squared defined by <code>R2</code>.
</p>
<p>In order to obtain predictor variables <code class="reqn">x = (x_1, x_2, ..., x_p)^t</code> for
<code class="reqn">y</code>, a random rotation of the principal components is performed. Hence,
<code class="reqn">x = R^t*z</code> for some random rotation matrix <code class="reqn">R</code>. For values of
<code class="reqn">q</code> satisfying <code class="reqn">m &lt;= q &lt;p</code> only a subspace of dimension <code class="reqn">q</code>
containing the <code class="reqn">m</code> relevant component(s) is rotated. This facilitates
the possibility to generate <code class="reqn">q</code> relevant predictor variables
(<code class="reqn">x</code>'s). The indices of the relevant predictors is randomly selected
with the only restriction that the index set contains the indices in
<code>relpos</code>. The final index set of the relevant predictors is saved in
the output argument <code>relpred</code>. If <code>q=p</code> all <code class="reqn">p</code> predictor
variables are relevant for the prediction of <code class="reqn">y</code>.
</p>
<p>For further details on the simulation approach, please see S&lt;e6&gt;b&lt;f8&gt;,
Alm&lt;f8&gt;y and Helland (2015).
</p>


<h3>Value</h3>

<p>A simrel object with list of following items,
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The call to simrel.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The (n x p) simulated predictor matrix.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>The n-vector of simulated response values.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The vector of true regression coefficients.</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>The true intercept. This is zero if muY=NULL and muX=NULL</p>
</td></tr>
<tr><td><code>muY</code></td>
<td>
<p>The true mean of the response variable.</p>
</td></tr>
<tr><td><code>muX</code></td>
<td>
<p>The <code>p</code>-vector of true means of the predictor variables.</p>
</td></tr>
<tr><td><code>relpred</code></td>
<td>
<p>The index of the true relevant predictors, that is the x-variables with non-zero true regression coefficients.</p>
</td></tr>
<tr><td><code>TESTX</code></td>
<td>
<p>The (ntest x p) matrix of optional test samples.</p>
</td></tr>
<tr><td><code>TESTY</code></td>
<td>
<p>The ntest-vector of responses of the optional test samples.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The number of simulated samples.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The number of predictor variables.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>The number of relevant components.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The number of relevant predictors.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>The decline parameter in the exponential model for the true eigenvalues.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The true eigenvalues of the covariance matrix of the p predictor variables.</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>The true R-squared value of the linear model.</p>
</td></tr>
<tr><td><code>relpos</code></td>
<td>
<p>The positions of the relevant components.</p>
</td></tr>
<tr><td><code>minerror</code></td>
<td>
<p>The minimum achievable prediction error. Also the variance of the noise term in the linear model.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The sampled correlations between the principal components and the response.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The true covariance matrix of <code class="reqn">(y,z_1, z_2, ..., z_p)^t</code>.</p>
</td></tr>
<tr><td><code>Rotation</code></td>
<td>
<p>The random rotation matrix which is used to achieve the predictor variables as rotations of the latent components. Equals the transposed of the eigenvector-matrix of the covariance matrix of <code class="reqn">(x_1,...,x_p)^t</code>.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The type of response generated, either &quot;univariate&quot; as returned from <code>simrel</code>, or &quot;bivariate&quot; as returned from <code>simrel2</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Solve S&lt;e6&gt;b&lt;f8&gt; and Kristian H. Liland
</p>


<h3>References</h3>

<p>Helland, I. S. and Alm&lt;f8&gt;y, T., 1994, Comparison of prediction methods when only a few components are relevant, <em>J. Amer. Statist. Ass.</em>, <b>89</b>(426), 583 &ndash; 591.
</p>
<p>S&lt;e6&gt;b&lt;f8&gt;, S., Alm&lt;f8&gt;y, T. and Helland, I. S., 2015, simrel - A versatile tool for linear model data simulation based on the concept of a relevant subspace and relevant predictors, <em>Chemometr. Intell. Lab.</em>(in press),doi:10.1016/j.chemolab.2015.05.012.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Linear model data, large n, small p
mydata &lt;- unisimrel(n = 250, p = 20, q = 5, relpos = c(2, 4), gamma = 0.25, R2 = 0.75)

#Estimating model parameters using ordinary least squares
lmfit &lt;- lm(mydata$Y ~ mydata$X)
summary(lmfit)

#Comparing true with estimated regression coefficients
plot(mydata$beta, lmfit$coef[-1], xlab = "True regression coefficients",
  ylab = "Estimated regression coefficients")
abline(0,1)

#Linear model data, small n, large p
mydata &lt;- unisimrel(n = 50, p = 200, q = 25, relpos = c(2, 4), gamma = 0.25, R2 = 0.8 )

#Simulating more samples with identical distribution as previous simulation
mydata2 &lt;- unisimrel(n = 2500, sim = mydata)

#Estimating model parameters using partial least squares regression with
#cross-validation to determine the number of relevant components.
if (requireNamespace("pls", quietly = TRUE)) {
  require(pls)
  plsfit &lt;- plsr(mydata$Y ~ mydata$X, 15, validation = "CV")
 
  #Validation plot and finding the number of relevant components.
  plot(0:15, c(plsfit$validation$PRESS0, plsfit$validation$PRESS),
    type = "b", xlab = "Components", ylab = "PRESS")
  mincomp &lt;- which(plsfit$validation$PRESS == min(plsfit$validation$PRESS))
 
  #Comparing true with estimated regression coefficients
  plot(mydata$beta, plsfit$coef[, 1, mincomp], xlab = "True regression coefficients",
    ylab = "Estimated regression coefficients")
  abline(0, 1)
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
