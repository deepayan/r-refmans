<!DOCTYPE html><html><head><title>Help for package eicm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eicm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.eicm'><p>Define a parameterized EICM model</p></a></li>
<li><a href='#coef.eicm'><p>Extract EICM model coefficients</p></a></li>
<li><a href='#coefficientComparisonPlot'><p>Diagnostic monitor plots for EICM</p></a></li>
<li><a href='#confint.eicm'><p>Confidence intervals for EICM parameters</p></a></li>
<li><a href='#eicm'><p>Fit and select an Explicit Interaction Community Model (EICM)</p></a></li>
<li><a href='#eicm-package'><p>eicm: Explicit Interaction Community Models</p></a></li>
<li><a href='#eicm.data'><p>Define a data object for a EICM model</p></a></li>
<li><a href='#eicm.fit'><p>Estimate a EICM model</p></a></li>
<li><a href='#eicm.matrix'><p>Define a model object for a EICM model</p></a></li>
<li><a href='#eicm.options'><p>Set EICM fitting options</p></a></li>
<li><a href='#generateEICM'><p>Generate EICM model following a Beta frequency distribution</p></a></li>
<li><a href='#interactionPlot'><p>Compare two interaction matrices</p></a></li>
<li><a href='#isCyclic'><p>Is the adjacency matrix a cyclic graph?</p></a></li>
<li><a href='#logLik.eicm'><p>EICM (penalized) log-likelihood</p></a></li>
<li><a href='#plot.confint.eicm'><p>Plot EICM estimates and confidence intervals</p></a></li>
<li><a href='#plot.eicm'><p>Quick plot EICM results</p></a></li>
<li><a href='#plot.eicm.list'><p>Quick plot EICM results</p></a></li>
<li><a href='#plot.profile.eicm'><p>Plot EICM likelihood profile</p></a></li>
<li><a href='#plotNetworkFromMatrix'><p>Plot graphs from adjacency matrices</p></a></li>
<li><a href='#predict.eicm'><p>Predict method for EICM fits</p></a></li>
<li><a href='#print.eicm.matrix'><p>Print EICM model matrix</p></a></li>
<li><a href='#profile.eicm'><p>Likelihood profiles for EICMs</p></a></li>
<li><a href='#truemodel'><p>A parameterized EICM model for simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-28</td>
</tr>
<tr>
<td>Title:</td>
<td>Explicit Interaction Community Models</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Miguel Porto &lt;mpbertolo@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, parallel, GA (&ge; 3.1.1), snow, doSNOW, iterators,
pso, ucminf, foreach, graphics, optimParallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>igraph, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Model fitting and species biotic interaction network topology selection for explicit
  interaction community models. Explicit interaction community models are an extension of binomial
  linear models for joint modelling of species communities, that incorporate both the effects of
  species biotic interactions and the effects of missing covariates. Species interactions are modelled
  as direct effects of each species on each of the others, and are estimated alongside the effects of
  missing covariates, modelled as latent factors. The package includes a penalized maximum likelihood
  fitting function, and a genetic algorithm for selecting the most parsimonious species interaction
  network topology.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/miguel-porto/eicm">https://github.com/miguel-porto/eicm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/miguel-porto/eicm">https://github.com/miguel-porto/eicm</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-05 10:03:16 UTC; miguel</td>
</tr>
<tr>
<td>Author:</td>
<td>Miguel Porto <a href="https://orcid.org/0000-0001-7640-0623"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Pedro Beja <a href="https://orcid.org/0000-0001-8164-0760"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-05 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.eicm'>Define a parameterized EICM model</h2><span id='topic+as.eicm'></span>

<h3>Description</h3>

<p>Constructs a EICM model object from given coefficients and data. Useful for simulating &quot;true&quot; models,
otherwise only used internally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.eicm(
  env.coefs,
  sp.coefs = NULL,
  latent = NULL,
  options = NULL,
  occurrences = NULL,
  env = NULL,
  traits = NULL,
  intercept = TRUE,
  regularization = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.eicm_+3A_env.coefs">env.coefs</code></td>
<td>
<p>the environmental coefficient matrix: a species x variable matrix (including intercept).</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_sp.coefs">sp.coefs</code></td>
<td>
<p>the species interaction coefficient matrix: a species x species matrix, with zero diagonal.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_latent">latent</code></td>
<td>
<p>the values for the latent variables in each sample: a sample x latent variable matrix.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_options">options</code></td>
<td>
<p>a <code>eicm.options</code> object defining options for fitting. Usually not needed, use
<code>forbidden</code>, <code>mask.sp</code> and <code>exclude.prevalence</code> instead.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_occurrences">occurrences</code></td>
<td>
<p>a binary (0/1) sample x species matrix, possibly including NAs.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_env">env</code></td>
<td>
<p>an optional sample x environmental variable matrix, for the known environmental predictors.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_traits">traits</code></td>
<td>
<p>an optional species x trait matrix. Currently, it is only used for excluding
species interactions <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_intercept">intercept</code></td>
<td>
<p>logical specifying whether to add a column for the species-level intercepts.</p>
</td></tr>
<tr><td><code id="as.eicm_+3A_regularization">regularization</code></td>
<td>
<p>a two-element numeric vector defining the regularization lambdas used for
environmental coefficients and for species interactions respectively. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>regularization</code> is only used for storing the regularization lambdas used in model fitting.
It is ignored in simulation.
</p>


<h3>Value</h3>

<p>A <code>eicm</code> object that can be used for prediction.
</p>


<h3>Note</h3>

<p>This function is only useful for simulation purposes. If you want to predict values from a fitted model,
a <code>eicm</code> object is already provided for the fitted model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.eicm">predict.eicm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some coefficients
nenv &lt;- 2
nsp &lt;- 20
nsamples &lt;- 200

env &lt;- matrix(rnorm(nenv * nsamples), ncol=nenv, nrow=nsamples)
env.coefs &lt;- matrix(runif((nenv + 1) * nsp, -4, 4), nrow=nsp)
sp.coefs &lt;- matrix(0, nrow=nsp, ncol=nsp)
sp.coefs[3, 5] &lt;- 3
sp.coefs[4, 8] &lt;- 2

# Define a true model (including environmental data)
truemodel &lt;- as.eicm(env=env, env.coefs=env.coefs, sp.coefs=sp.coefs)

# We can now realize it
predict(truemodel)
</code></pre>

<hr>
<h2 id='coef.eicm'>Extract EICM model coefficients</h2><span id='topic+coef.eicm'></span>

<h3>Description</h3>

<p>Extract the EICM model coefficients, organized in three separate matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.eicm_+3A_object">object</code></td>
<td>
<p>a EICM model.</p>
</td></tr>
<tr><td><code id="coef.eicm_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three coefficient matrices:
</p>

<dl>
<dt>$env</dt><dd><p>environmental coefficients</p>
</dd>
<dt>$sp</dt><dd><p>species interaction coefficients. It reads as: species C (column) affects species R (row) with the coefficient sp[R, C]</p>
</dd>
<dt>$samples</dt><dd><p>estimated latent variable values</p>
</dd>
</dl>


<hr>
<h2 id='coefficientComparisonPlot'>Diagnostic monitor plots for EICM</h2><span id='topic+coefficientComparisonPlot'></span>

<h3>Description</h3>

<p>Visually compare the true model with estimation results (final results or during model fitting)
and compute accuracy statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coefficientComparisonPlot(
  model,
  true.model,
  nenv.to.plot = 0,
  nlatent.to.plot = 0,
  plot.interactions = any(model$sp != 0),
  plot.intercept = FALSE,
  excluded.interactions = NULL,
  layout = TRUE,
  noplot = FALSE,
  env.stats = TRUE,
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coefficientComparisonPlot_+3A_model">model</code></td>
<td>
<p>the EICM model of interest.</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_true.model">true.model</code></td>
<td>
<p>the true model to compare with (usually, the one used for simulating the data).</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_nenv.to.plot">nenv.to.plot</code></td>
<td>
<p>the number of environmental variables to plot.</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_nlatent.to.plot">nlatent.to.plot</code></td>
<td>
<p>the number of latent variables to plot.</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_plot.interactions">plot.interactions</code></td>
<td>
<p>logical. Plot interaction coefficient scatterplot?</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_plot.intercept">plot.intercept</code></td>
<td>
<p>logical. plot the species-level intercepts?</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_excluded.interactions">excluded.interactions</code></td>
<td>
<p>a binary species x species matrix telling which interactions were excluded <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_layout">layout</code></td>
<td>
<p>logical. Do multi-panel layout?</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_noplot">noplot</code></td>
<td>
<p>logical. Do plots? If TRUE, it will return the accuracy statistics only.</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_env.stats">env.stats</code></td>
<td>
<p>logical. Compute accuracy for environmental predictors?</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_legend">legend</code></td>
<td>
<p>logical. Plot legend?</p>
</td></tr>
<tr><td><code id="coefficientComparisonPlot_+3A_...">...</code></td>
<td>
<p>further arguments to pass to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with accuracy statistics.
</p>

<hr>
<h2 id='confint.eicm'>Confidence intervals for EICM parameters</h2><span id='topic+confint.eicm'></span>

<h3>Description</h3>

<p>Computes the profile (penalized) likelihood confidence intervals for all estimated parameters in a EICM model.
If the likelihood profiles are not computed yet, they will be computed first.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
confint(
  object,
  parm,
  level = 0.99,
  step = 0.3,
  ncores = parallel::detectCores(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.eicm_+3A_object">object</code></td>
<td>
<p>the fitted EICM model.</p>
</td></tr>
<tr><td><code id="confint.eicm_+3A_parm">parm</code></td>
<td>
<p>currently unused.</p>
</td></tr>
<tr><td><code id="confint.eicm_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.eicm_+3A_step">step</code></td>
<td>
<p>the step increments/decrements at which to compute the likelihood profile points.</p>
</td></tr>
<tr><td><code id="confint.eicm_+3A_ncores">ncores</code></td>
<td>
<p>the number of CPU cores to use when computing profiles for all parameters.</p>
</td></tr>
<tr><td><code id="confint.eicm_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same model object with a new <code>confint</code> component.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load the included parameterized model
data(truemodel)

# realize the model
occurrences &lt;- predict(truemodel, nrepetitions=1)

# fit the model without species interactions
fitted &lt;- eicm(occurrences, n.latent=2, mask.sp=0, do.selection=FALSE)$fitted.model

# compute confidence intervals for all parameters
# this updates the fitted model with the confints
fitted &lt;- confint(fitted, ncores=2)

# plot the confidence intervals
plot(fitted, type="confint")

</code></pre>

<hr>
<h2 id='eicm'>Fit and select an Explicit Interaction Community Model (EICM)</h2><span id='topic+eicm'></span>

<h3>Description</h3>

<p>Given species occurrence data and (optionally) measured environmental predictors,
fits and selects an EICM that models species occurrence probability as a function of
measured predictors, unmeasured predictors (latent variables) and direct species interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eicm(
  occurrences,
  env = NULL,
  traits = NULL,
  intercept = TRUE,
  n.latent = 0,
  rotate.latents = FALSE,
  scale.latents = TRUE,
  forbidden = NULL,
  allowed = NULL,
  mask.sp = NULL,
  exclude.prevalence = 0,
  regularization = c(ifelse(n.latent &gt; 0, 6, 0.5), 1),
  regularization.type = "hybrid",
  penalty = 4,
  theta.threshold = 0.5,
  latent.lambda = 1,
  fit.all.with.latents = TRUE,
  popsize.sel = 2,
  n.cores = parallel::detectCores(),
  parallel = FALSE,
  true.model = NULL,
  do.selection = TRUE,
  do.plots = TRUE,
  fast = FALSE,
  refit.selected = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eicm_+3A_occurrences">occurrences</code></td>
<td>
<p>a binary (0/1) sample x species matrix, possibly including NAs.</p>
</td></tr>
<tr><td><code id="eicm_+3A_env">env</code></td>
<td>
<p>an optional sample x environmental variable matrix, for the known environmental predictors.</p>
</td></tr>
<tr><td><code id="eicm_+3A_traits">traits</code></td>
<td>
<p>an optional species x trait matrix. Currently, it is only used for excluding
species interactions <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="eicm_+3A_intercept">intercept</code></td>
<td>
<p>logical specifying whether to add a column for the species-level intercepts.</p>
</td></tr>
<tr><td><code id="eicm_+3A_n.latent">n.latent</code></td>
<td>
<p>the number of latent variables to estimate.</p>
</td></tr>
<tr><td><code id="eicm_+3A_rotate.latents">rotate.latents</code></td>
<td>
<p>logical. Rotate the estimated latent variable values (the values of the
latents at each sample) in the first step with PCA? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="eicm_+3A_scale.latents">scale.latents</code></td>
<td>
<p>logical. Standardize the estimated latent variable values (the values of the
latents at each sample) in the first step? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="eicm_+3A_forbidden">forbidden</code></td>
<td>
<p>a formula (or list of) defining which species interactions are not to be estimated. See details.
This constraint is cumulative with other constraints (<code>mask.sp</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm_+3A_allowed">allowed</code></td>
<td>
<p>a formula (or list of) defining which species interactions are to be estimated. See details.
This constraint is cumulative with other constraints (<code>mask.sp</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm_+3A_mask.sp">mask.sp</code></td>
<td>
<p>a scalar or a binary square species x species matrix defining which species interactions to exclude
(0) or include (1) <em>a priori</em>. If a scalar (0 or 1), 0 excludes all interactions, 1 allows all interactions.
If a matrix, species in the columns affect species in the rows, so, setting <code>mask.sp[3, 8] &lt;- 0</code>
means that species #8 is assumed <em>a priori</em> to not affect species #3.
This constraint is cumulative with other constraints (<code>forbidden</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm_+3A_exclude.prevalence">exclude.prevalence</code></td>
<td>
<p>exclude species interactions which are caused by species
with prevalence equal or lower than this value. This constraint is cumulative with
other constraints (<code>forbidden</code> and <code>mask.sp</code>)</p>
</td></tr>
<tr><td><code id="eicm_+3A_regularization">regularization</code></td>
<td>
<p>a two-element numeric vector defining the regularization lambdas used for
environmental coefficients and for species interactions respectively. See details.</p>
</td></tr>
<tr><td><code id="eicm_+3A_regularization.type">regularization.type</code></td>
<td>
<p>one of &quot;lasso&quot;, &quot;ridge&quot; or &quot;hybrid&quot;, defining the type of penalty to apply.
Type &quot;hybrid&quot; applies ridge penalty to environmental coefficients and LASSO to interaction coefficients.</p>
</td></tr>
<tr><td><code id="eicm_+3A_penalty">penalty</code></td>
<td>
<p>the penalty applied to the number of species interactions to include, during variable selection.</p>
</td></tr>
<tr><td><code id="eicm_+3A_theta.threshold">theta.threshold</code></td>
<td>
<p>exclude species interactions (from network selection) whose preliminary coefficient (in absolute value)
is lower than this value. This exclusion criterion is cumulative with the other user-defined exclusions.</p>
</td></tr>
<tr><td><code id="eicm_+3A_latent.lambda">latent.lambda</code></td>
<td>
<p>the regularization applied to latent variables and respective coefficients
when estimating their values in samples.</p>
</td></tr>
<tr><td><code id="eicm_+3A_fit.all.with.latents">fit.all.with.latents</code></td>
<td>
<p>logical. Whether to use the previously estimated latent variables
when estimating the preliminary species interactions.</p>
</td></tr>
<tr><td><code id="eicm_+3A_popsize.sel">popsize.sel</code></td>
<td>
<p>the population size for the genetic algorithm, expressed as the factor to multiply
by the recommended minimum. Ignored if <code>do.selection=FALSE</code>.</p>
</td></tr>
<tr><td><code id="eicm_+3A_n.cores">n.cores</code></td>
<td>
<p>the number of CPU cores to use in the variable selection stage and in the optimization.</p>
</td></tr>
<tr><td><code id="eicm_+3A_parallel">parallel</code></td>
<td>
<p>logical. Whether to use <code><a href="optimParallel.html#topic+optimParallel">optimParallel</a></code> during optimizations
instead of <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="eicm_+3A_true.model">true.model</code></td>
<td>
<p>for validation purposes only: the true model that has generated the data, to which
the estimated coefficients will be compared in each selection algorithm iteration.</p>
</td></tr>
<tr><td><code id="eicm_+3A_do.selection">do.selection</code></td>
<td>
<p>logical. Conduct the variable selection stage, over species interaction network topology?</p>
</td></tr>
<tr><td><code id="eicm_+3A_do.plots">do.plots</code></td>
<td>
<p>logical. Plot diagnostic and trace plots?</p>
</td></tr>
<tr><td><code id="eicm_+3A_fast">fast</code></td>
<td>
<p>a logical defining whether to do a fast - but less accurate - estimation, or a normal estimation.</p>
</td></tr>
<tr><td><code id="eicm_+3A_refit.selected">refit.selected</code></td>
<td>
<p>logical. Refit with exact estimates the best model after network selection? Note that,
for performance reasons, the models fit during the network selection stage use an approximate likelihood.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An Explicit Interaction Community Model (EICM) is a simultaneous equation linear model in which each
species model integrates all the other species as predictors, along with measured and latent variables.
</p>
<p>This is the main function for fitting EICM models, and is preferred over using <code><a href="#topic+eicm.fit">eicm.fit</a></code> directly.
</p>
<p>This function conducts the fitting and network topology selection workflow, which includes three stages:
1) estimate latent variable values; 2) make preliminary estimates for species interactions;
3) conduct network topology selection over a reduced model (based on the preliminary estimates).
</p>
<p>The selection stage is optional. If not conducted, the species interactions are estimated
(all or a subset according to the user-provided constraints), but not selected.
See <code>vignette("eicm")</code> for commented examples on a priori excluding interactions.
</p>
<p>Missing data in the response matrix is allowed.
</p>


<h3>Value</h3>

<p>A <code>eicm.list</code> with the following components:
</p>

<dl>
<dt>true.model:</dt><dd><p>a copy of the <code>true.model</code> argument.</p>
</dd>
<dt>latents.only:</dt><dd><p>the model with only the latent variables estimated.</p>
</dd>
<dt>fitted.model</dt><dd><p>the model with only the species interactions estimated.</p>
</dd>
<dt>selected.model:</dt><dd><p>the final model with all coefficients estimated, after network topology selection.
This is the &quot;best&quot; model given the selection criterion (which depends on
<code>regularization</code> and <code>penalty</code>.</p>
</dd>
</dl>

<p>When accessing the results, remember to pick the model you want (usually, <code>selected.model</code>).
<code><a href="graphics.html#topic+plot">plot</a></code> automatically picks <code>selected.model</code> or, if NULL, <code>fitted.model</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eicm-package">eicm-package</a></code>, <code><a href="#topic+eicm.fit">eicm.fit</a></code>, <code><a href="#topic+plot.eicm">plot.eicm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># refer to the vignette for a more detailed explanation

# This can take some time to run

# Load the included parameterized model
data(truemodel)

# make one realization of the model
occurrences &lt;- predict(truemodel, nrepetitions=1)

# Fit and select a model with 2 latent variables to be estimated and all
# interactions possible
m &lt;- eicm(occurrences, n.latent=2, penalty=4, theta.threshold=0.5, n.cores=2)

plot(m)

</code></pre>

<hr>
<h2 id='eicm-package'>eicm: Explicit Interaction Community Models</h2><span id='topic+eicm-package'></span>

<h3>Description</h3>

<p>Explicit Interaction Community Models
</p>


<h3>Details</h3>

<p>Model fitting and species biotic interaction network topology selection for explicit interaction community models.
Explicit interaction community models are an extension of binomial linear models for joint modelling of species
communities, that incorporate both the effects of species biotic interactions and the effects of missing covariates.
Species interactions are modelled as direct effects of each species on each of the others, and are estimated
alongside the effects of missing covariates, modelled as latent factors.
The package includes a penalized maximum likelihood fitting function, and a genetic algorithm for selecting
the most parsimonious species interaction network topology.
</p>


<h3>Main functions</h3>

<p><code><a href="#topic+eicm">eicm</a></code>, <code><a href="#topic+eicm.fit">eicm.fit</a></code>
</p>

<hr>
<h2 id='eicm.data'>Define a data object for a EICM model</h2><span id='topic+eicm.data'></span>

<h3>Description</h3>

<p>Constructs a EICM data object for prediction. The data object contains all data matrices that may be needed for prediction.
Usually, you don't need to invoke this function directly, use <code><a href="#topic+as.eicm">as.eicm</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eicm.data(occurrences = NULL, env = NULL, traits = NULL, intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eicm.data_+3A_occurrences">occurrences</code></td>
<td>
<p>a binary (0/1) sample x species matrix, possibly including NAs.</p>
</td></tr>
<tr><td><code id="eicm.data_+3A_env">env</code></td>
<td>
<p>an optional sample x environmental variable matrix, for the known environmental predictors.</p>
</td></tr>
<tr><td><code id="eicm.data_+3A_traits">traits</code></td>
<td>
<p>an optional species x trait matrix. Currently, it is only used for excluding
species interactions <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="eicm.data_+3A_intercept">intercept</code></td>
<td>
<p>logical specifying whether to add a column for the species-level intercepts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>eicm.data</code> object that can be used for defining a model.
</p>

<hr>
<h2 id='eicm.fit'>Estimate a EICM model</h2><span id='topic+eicm.fit'></span>

<h3>Description</h3>

<p>Estimates the parameter values of a EICM model from the provided observation data.
This is the low-level estimation function. Users should use <code><a href="#topic+eicm">eicm</a></code> instead, particularly
if estimating latent variables and species interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eicm.fit(
  occurrences,
  env = NULL,
  traits = NULL,
  intercept = TRUE,
  n.latent = 0,
  forbidden = NULL,
  allowed = NULL,
  mask.sp = NULL,
  exclude.prevalence = 0,
  options = NULL,
  initial.values = NULL,
  regularization = c(ifelse(n.latent &gt; 0, 0.5, 0), 1),
  regularization.type = "hybrid",
  fast = FALSE,
  n.cores = 1,
  optim.method = "L-BFGS-B",
  optim.control = list(trace = 1, maxit = 10000, ndeps = 1e-04, factr = ifelse(fast,
    1e-04, 1e-06)/.Machine$double.eps)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eicm.fit_+3A_occurrences">occurrences</code></td>
<td>
<p>a binary (0/1) sample x species matrix, possibly including NAs.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_env">env</code></td>
<td>
<p>an optional sample x environmental variable matrix, for the known environmental predictors.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_traits">traits</code></td>
<td>
<p>an optional species x trait matrix. Currently, it is only used for excluding
species interactions <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_intercept">intercept</code></td>
<td>
<p>logical specifying whether to add a column for the species-level intercepts.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_n.latent">n.latent</code></td>
<td>
<p>the number of latent variables to estimate.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_forbidden">forbidden</code></td>
<td>
<p>a formula (or list of) defining which species interactions are not to be estimated. See details.
This constraint is cumulative with other constraints (<code>mask.sp</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_allowed">allowed</code></td>
<td>
<p>a formula (or list of) defining which species interactions are to be estimated. See details.
This constraint is cumulative with other constraints (<code>mask.sp</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_mask.sp">mask.sp</code></td>
<td>
<p>a scalar or a binary square species x species matrix defining which species interactions to exclude
(0) or include (1) <em>a priori</em>. If a scalar (0 or 1), 0 excludes all interactions, 1 allows all interactions.
If a matrix, species in the columns affect species in the rows, so, setting <code>mask.sp[3, 8] &lt;- 0</code>
means that species #8 is assumed <em>a priori</em> to not affect species #3.
This constraint is cumulative with other constraints (<code>forbidden</code> and <code>exclude.prevalence</code>).</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_exclude.prevalence">exclude.prevalence</code></td>
<td>
<p>exclude species interactions which are caused by species
with prevalence equal or lower than this value. This constraint is cumulative with
other constraints (<code>forbidden</code> and <code>mask.sp</code>)</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_options">options</code></td>
<td>
<p>a <code>eicm.options</code> object defining options for fitting. Usually not needed, use
<code>forbidden</code>, <code>mask.sp</code> and <code>exclude.prevalence</code> instead.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_initial.values">initial.values</code></td>
<td>
<p>the starting values for all parameters. Used only for speeding up
fitting when there are previous estimates available.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_regularization">regularization</code></td>
<td>
<p>a two-element numeric vector defining the regularization lambdas used for
environmental coefficients and for species interactions respectively. See details.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_regularization.type">regularization.type</code></td>
<td>
<p>one of &quot;lasso&quot;, &quot;ridge&quot; or &quot;hybrid&quot;, defining the type of penalty to apply.
Type &quot;hybrid&quot; applies ridge penalty to environmental coefficients and LASSO to interaction coefficients.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_fast">fast</code></td>
<td>
<p>a logical defining whether to do a fast - but less accurate - estimation, or a normal estimation.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_n.cores">n.cores</code></td>
<td>
<p>the number of CPU cores to use in the L-BFGS-B optimization. This may be reduced to prevent
excessive memory usage.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_optim.method">optim.method</code></td>
<td>
<p>the optimization function to use. Should be set to the default.</p>
</td></tr>
<tr><td><code id="eicm.fit_+3A_optim.control">optim.control</code></td>
<td>
<p>the optimization parameters to use. Should be set to the defaults.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, all species interactions are estimated. Uers can control which species interactions
are to be estimated with the arguments <code>forbidden</code>, <code>mask.sp</code> and <code>exclude.prevalence</code>,
which place cumulative restrictions on which interactions to estimate. See <code>vignette("eicm")</code>
for commented examples.
</p>


<h3>Value</h3>

<p>A fitted <code>eicm</code> object.
</p>


<h3>Note</h3>

<p>If estimating latent variables and species interactions, use <code><a href="#topic+eicm">eicm</a></code> instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eicm">eicm</a></code>, <code><a href="#topic+confint.eicm">confint.eicm</a></code>, <code><a href="#topic+plot.eicm">plot.eicm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some random occurrence data
nenv &lt;- 2
nsp &lt;- 10
nsamples &lt;- 200

env &lt;- matrix(rnorm(nenv * nsamples), ncol=nenv, nrow=nsamples)
env.coefs &lt;- matrix(runif((nenv + 1) * nsp, -4, 4), nrow=nsp)
sp.coefs &lt;- matrix(0, nrow=nsp, ncol=nsp)
sp.coefs[3, 5] &lt;- 3
sp.coefs[4, 8] &lt;- 2

# Define a true model
truemodel &lt;- as.eicm(env=env, env.coefs=env.coefs, sp.coefs=sp.coefs)

# realize the model
simulated.data &lt;- predict(truemodel, nrepetitions=1)


# fit the model without species interactions
fittedNoInt &lt;- eicm.fit(simulated.data, env, mask.sp=0)

# fit the model with all species interactions
fittedInt &lt;- eicm.fit(simulated.data, env, mask.sp=1)

# compute confidence intervals for all parameters
fittedInt &lt;- confint(fittedInt, ncores=2)

# plot estimated parameters and confidence intervals
plot(fittedInt, type="confint", truemodel=truemodel)

</code></pre>

<hr>
<h2 id='eicm.matrix'>Define a model object for a EICM model</h2><span id='topic+eicm.matrix'></span>

<h3>Description</h3>

<p>Constructs a EICM model object for prediction. The model object contains all coefficient matrices that may be needed for prediction.
Usually, you don't need to invoke this function directly, use <code><a href="#topic+as.eicm">as.eicm</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eicm.matrix(env.coefs, sp.coefs = NULL, latent = NULL, options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eicm.matrix_+3A_env.coefs">env.coefs</code></td>
<td>
<p>the environmental coefficient matrix: a species x variable matrix (including intercept).</p>
</td></tr>
<tr><td><code id="eicm.matrix_+3A_sp.coefs">sp.coefs</code></td>
<td>
<p>the species interaction coefficient matrix: a species x species matrix, with zero diagonal.</p>
</td></tr>
<tr><td><code id="eicm.matrix_+3A_latent">latent</code></td>
<td>
<p>the values for the latent variables in each sample: a sample x latent variable matrix.</p>
</td></tr>
<tr><td><code id="eicm.matrix_+3A_options">options</code></td>
<td>
<p>options for the model fitting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EICM model is a list composed of three matrices plus the fitting options:
</p>

<ol>
<li><p> env
</p>
</li>
<li><p> sp
</p>
</li>
<li><p> samples
</p>
</li></ol>



<h3>Value</h3>

<p>A <code>eicm.matrix</code> object that can be used for defining a model.
</p>

<hr>
<h2 id='eicm.options'>Set EICM fitting options</h2><span id='topic+eicm.options'></span>

<h3>Description</h3>

<p>Construct a EICM options object to inform the fitting engine. There is usually no need to use this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eicm.options(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eicm.options_+3A_...">...</code></td>
<td>
<p>a named list of options. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible options are currently: <code>mask</code> and <code>offset</code>. Both are lists having the same structure of an <code>eicm.matrix</code> object:
</p>

<dl>
<dt>$mask</dt><dd><p>Binary matrices defining which coefficients are to be estimated in model fitting
OR a scalar, constant for all coefficients. 0 or FALSE exclude the given term from estimation,
i.e., fixes it at 0.
</p>

<dl>
<dt>$mask$env</dt><dd><p>environmental coefficient mask</p>
</dd>
<dt>$mask$sp</dt><dd><p>species interaction mask</p>
</dd>
</dl>

</dd>
<dt>$offset</dt><dd><p>Numeric matrices defining constant terms, to be fixed and not estimated
</p>

<dl>
<dt>$offset$env</dt><dd><p>environmental coefficient offset</p>
</dd>
<dt>$offset$sp</dt><dd><p>species interaction offset</p>
</dd>
</dl>

</dd>
</dl>

<p>When an offset for a term is nonzero, the respective mask element will be automatically zeroed (so it is not estimated).
</p>


<h3>Value</h3>

<p>A <code>eicm.options</code> object with options for model fitting, currently a model mask and model offsets.
</p>

<hr>
<h2 id='generateEICM'>Generate EICM model following a Beta frequency distribution</h2><span id='topic+generateEICM'></span>

<h3>Description</h3>

<p>Generates a randomly parameterized EICM model (predictors, environmental coefficients and species interactions),
ensuring that communities simulated with this model have a frequency distribution that matches the given Beta
distribution of frequencies as much as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateEICM(
  nspecies,
  nsamples,
  nenv,
  ninteractions,
  shape1,
  shape2,
  nbins = 10,
  nrepetitions = 5,
  shrinkage = 2,
  bounds = 10,
  swarm.size = floor((ninteractions + nspecies * (nenv + 1)) * 0.5),
  maxit.stagnate = 150
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateEICM_+3A_nspecies">nspecies</code></td>
<td>
<p>the number of species to generate.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_nsamples">nsamples</code></td>
<td>
<p>the number of samples to generate.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_nenv">nenv</code></td>
<td>
<p>the number of environmental predictors to generate.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_ninteractions">ninteractions</code></td>
<td>
<p>the number of species interactions to generate.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_shape1">shape1</code></td>
<td>
<p>the shape1 parameter of the Beta distribution.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_shape2">shape2</code></td>
<td>
<p>the shape2 parameter of the Beta distribution.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_nbins">nbins</code></td>
<td>
<p>the number of histogram bins for comparing distributions.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_nrepetitions">nrepetitions</code></td>
<td>
<p>the number of times to realize a model candidate to average their distributions.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_shrinkage">shrinkage</code></td>
<td>
<p>the shrinkage factor for generated coefficients, when computing fitness criterion.
Ensures that the generated coefficients remain at plausible values.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_bounds">bounds</code></td>
<td>
<p>the allowed range for the coefficients <code>c(-bounds, +bounds)</code>.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_swarm.size">swarm.size</code></td>
<td>
<p>the swarm size of the particle swarm optimization.</p>
</td></tr>
<tr><td><code id="generateEICM_+3A_maxit.stagnate">maxit.stagnate</code></td>
<td>
<p>the number of iterations without improvement until the optimization stops.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for generating a realistic random model for simulation, i.e. a model that, when simulated, will
yield species communities with a distribution of frequencies akin of real communities: with most species being rare.
The generated coefficients are not assumed to follow any distribution, but are optionally shrinked so that
their values will remain &quot;decent&quot;. The values of the environmental predictors are drawn from a gaussian distribution.
</p>


<h3>Value</h3>

<p>A EICM model of class <code>eicm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate model with 32 species, 30 species interactions and 2 environmental predictors
# for 500 samples with a frequency distribution following a Beta(1.5, 3)
model &lt;- generateEICM(nspecies=32, nsamples=500, nenv=2, ninteractions=30,
  shape1=1.5, shape2=3)

# make one realization
data &lt;- predict(model, nrepetitions=1)

# plot frequency histogram: should follow a Beta distribution.
hist(apply(data, 2, sum) / nrow(data), breaks=seq(0, 1, by=0.1), xlim=c(0, 1),
  main="Frequency distribution of one realization", xlab="Frequency in samples",
  ylab="Number of species")

</code></pre>

<hr>
<h2 id='interactionPlot'>Compare two interaction matrices</h2><span id='topic+interactionPlot'></span>

<h3>Description</h3>

<p>Visually compare two interaction (adjacency) matrices and return accuracy statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interactionPlot(
  estimated.adjacency.matrix,
  true.adjacency.matrix,
  excluded.interactions = NULL,
  labels = TRUE,
  noplot = FALSE,
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interactionPlot_+3A_estimated.adjacency.matrix">estimated.adjacency.matrix</code></td>
<td>
<p>the interaction matrix of the model of interest.</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_true.adjacency.matrix">true.adjacency.matrix</code></td>
<td>
<p>the interaction matrix of the model to compare with (usually, the one used for simulating the data).</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_excluded.interactions">excluded.interactions</code></td>
<td>
<p>a binary species x species matrix telling which interactions were excluded <em>a priori</em>.</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_labels">labels</code></td>
<td>
<p>logical. Add default axis labels and title?</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_noplot">noplot</code></td>
<td>
<p>logical. Do plots? If TRUE, it will return the accuracy statistics only.</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_legend">legend</code></td>
<td>
<p>logical. Plot legend?</p>
</td></tr>
<tr><td><code id="interactionPlot_+3A_...">...</code></td>
<td>
<p>further arguments to pass to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with accuracy statistics.
</p>

<hr>
<h2 id='isCyclic'>Is the adjacency matrix a cyclic graph?</h2><span id='topic+isCyclic'></span>

<h3>Description</h3>

<p>Tests whether the given graph (given as an adjacency matrix) contains cycles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isCyclic(coefs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isCyclic_+3A_coefs">coefs</code></td>
<td>
<p>a square adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical indicating whether there are cycles in the graph.
</p>

<hr>
<h2 id='logLik.eicm'>EICM (penalized) log-likelihood</h2><span id='topic+logLik.eicm'></span>

<h3>Description</h3>

<p>Compute the (penalized) log-likelihood of the data matrix included in the EICM model,
or the log-likelihood of a new occurrence data matrix given the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
logLik(object, occurrences = NULL, allow.na = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.eicm_+3A_object">object</code></td>
<td>
<p>a EICM model</p>
</td></tr>
<tr><td><code id="logLik.eicm_+3A_occurrences">occurrences</code></td>
<td>
<p>the occurrence data matrix. If omitted, the data matrix used to fit the model is used.</p>
</td></tr>
<tr><td><code id="logLik.eicm_+3A_allow.na">allow.na</code></td>
<td>
<p>logical. Allow NAs in the occurrence matrix? If no NAs exist, it's faster to set to FALSE.</p>
</td></tr>
<tr><td><code id="logLik.eicm_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logLik</code> object.
</p>

<hr>
<h2 id='plot.confint.eicm'>Plot EICM estimates and confidence intervals</h2><span id='topic+plot.confint.eicm'></span>

<h3>Description</h3>

<p>Plot EICM estimates and confidence intervals, in a dot-and-whisker plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confint.eicm'
plot(x, truemodel = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.confint.eicm_+3A_x">x</code></td>
<td>
<p>a eicm.confint object</p>
</td></tr>
<tr><td><code id="plot.confint.eicm_+3A_truemodel">truemodel</code></td>
<td>
<p>for validation purposes only. The true model used to simulate data.</p>
</td></tr>
<tr><td><code id="plot.confint.eicm_+3A_...">...</code></td>
<td>
<p>other arguments passed to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL.
</p>

<hr>
<h2 id='plot.eicm'>Quick plot EICM results</h2><span id='topic+plot.eicm'></span>

<h3>Description</h3>

<p>Multiple types of plots for EICM models: coefficients, network topology, confidence intervals and likelihood profiles.
Allows to plot a single model or the comparison between an estimated and a true model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
plot(
  x,
  type = ifelse(is.null(true.model), "network", "coefficients"),
  true.model = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eicm_+3A_x">x</code></td>
<td>
<p>a EICM model.</p>
</td></tr>
<tr><td><code id="plot.eicm_+3A_type">type</code></td>
<td>
<p>character. The type of plot, one of <code>confint</code>, <code>profile</code>, <code>network</code> or <code>coefficients</code>.
See details.</p>
</td></tr>
<tr><td><code id="plot.eicm_+3A_true.model">true.model</code></td>
<td>
<p>the true model to compare with (usually, the one used for simulating the data).</p>
</td></tr>
<tr><td><code id="plot.eicm_+3A_...">...</code></td>
<td>
<p>further arguments to pass to <code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code> or other plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no <code>true.model</code> is provided, <code>type</code> must be one of <code>confint</code>, <code>profile</code>, <code>network</code>.
</p>
<p>If <code>true.model</code> is provided, <code>type</code> must be one of <code>network</code> or <code>coefficients</code>.
In the latter case, see <code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code> for possible options.
</p>
<p>If <code>x</code> is of type <code>eicm.list</code> (as returned by <code><a href="#topic+eicm">eicm</a></code>), this function first
tries to plot the model after network selection, then, if it was not computed, the fitted model with the full network.
</p>


<h3>Value</h3>

<p>If <code>true.model</code> is provided and <code>type="coefficients"</code>, returns a named vector with 
accuracy statistics (invisibly). Otherwise, NULL.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code>, <code><a href="#topic+confint.eicm">confint.eicm</a></code>
</p>

<hr>
<h2 id='plot.eicm.list'>Quick plot EICM results</h2><span id='topic+plot.eicm.list'></span>

<h3>Description</h3>

<p>Multiple types of plots for EICM models: coefficients, network topology, confidence intervals and likelihood profiles.
Allows to plot a single model or the comparison between an estimated and a true model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm.list'
plot(
  x,
  type = ifelse(is.null(true.model), "network", "coefficients"),
  true.model = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eicm.list_+3A_x">x</code></td>
<td>
<p>a EICM model.</p>
</td></tr>
<tr><td><code id="plot.eicm.list_+3A_type">type</code></td>
<td>
<p>character. The type of plot, one of <code>confint</code>, <code>profile</code>, <code>network</code> or <code>coefficients</code>.
See details.</p>
</td></tr>
<tr><td><code id="plot.eicm.list_+3A_true.model">true.model</code></td>
<td>
<p>the true model to compare with (usually, the one used for simulating the data).</p>
</td></tr>
<tr><td><code id="plot.eicm.list_+3A_...">...</code></td>
<td>
<p>further arguments to pass to <code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code> or other plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If no <code>true.model</code> is provided, <code>type</code> must be one of <code>confint</code>, <code>profile</code>, <code>network</code>.
</p>
<p>If <code>true.model</code> is provided, <code>type</code> must be one of <code>network</code> or <code>coefficients</code>.
In the latter case, see <code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code> for possible options.
</p>
<p>If <code>x</code> is of type <code>eicm.list</code> (as returned by <code><a href="#topic+eicm">eicm</a></code>), this function first
tries to plot the model after network selection, then, if it was not computed, the fitted model with the full network.
</p>


<h3>Value</h3>

<p>If <code>true.model</code> is provided and <code>type="coefficients"</code>, returns a named vector with 
accuracy statistics (invisibly). Otherwise, NULL.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coefficientComparisonPlot">coefficientComparisonPlot</a></code>, <code><a href="#topic+confint.eicm">confint.eicm</a></code>
</p>

<hr>
<h2 id='plot.profile.eicm'>Plot EICM likelihood profile</h2><span id='topic+plot.profile.eicm'></span>

<h3>Description</h3>

<p>Plot one likelihood profile with the line representing a confidence level threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.eicm'
plot(x, level = 0.99, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.profile.eicm_+3A_x">x</code></td>
<td>
<p>a profile.eicm object, created with <code><a href="#topic+profile.eicm">profile.eicm</a></code>.</p>
</td></tr>
<tr><td><code id="plot.profile.eicm_+3A_level">level</code></td>
<td>
<p>the significance level desired.</p>
</td></tr>
<tr><td><code id="plot.profile.eicm_+3A_...">...</code></td>
<td>
<p>other arguments passed to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL.
</p>

<hr>
<h2 id='plotNetworkFromMatrix'>Plot graphs from adjacency matrices</h2><span id='topic+plotNetworkFromMatrix'></span>

<h3>Description</h3>

<p>Plots a graph from a weighted adjacency matrix, using <code>igraph</code>'s plotting functions,
optionally comparing it with another &quot;true&quot; adjacency matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotNetworkFromMatrix(
  adjacency,
  true.adjacency = NULL,
  labels = TRUE,
  exclude.orphans = TRUE,
  lwd = 1,
  edge.arrow.size = 0.8,
  severe.threshold = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotNetworkFromMatrix_+3A_adjacency">adjacency</code></td>
<td>
<p>the square adjacency matrix.</p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_true.adjacency">true.adjacency</code></td>
<td>
<p>optional. The reference &quot;true&quot; square adjacency matrix to which to compare the first one.</p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_labels">labels</code></td>
<td>
<p>logical. Draw default labels?</p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_exclude.orphans">exclude.orphans</code></td>
<td>
<p>logical. Hide nodes without links?</p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_lwd">lwd</code></td>
<td>
<p>a numerical value giving the amount by which the arrows' line width should be magnified
relative to the default, when plotting the weighted graph (only used when
<code>true.adjacency</code> is not provided).</p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_edge.arrow.size">edge.arrow.size</code></td>
<td>
<p>size of the arrow heads. See <code>igraph::plot.igraph</code></p>
</td></tr>
<tr><td><code id="plotNetworkFromMatrix_+3A_severe.threshold">severe.threshold</code></td>
<td>
<p>the absolute threshold above which the interaction weights are highlighted in the graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When comparing two adjacency matrices
</p>


<h3>Value</h3>

<p>The corresponding igraph network, invisibly.
</p>


<h3>Note</h3>

<p>The arrow direction depicts the direction of the interaction. Species in columns affect species in rows.
</p>
<p>The matrices should include row and column labels, otherwise the node labels may not correspond to the species index
(when <code>exclude.orphans = TRUE</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate two adjacency matrices with 15 species and 10 interactions
A &lt;- matrix(0, ncol=15, nrow=15)
A[sample(length(A), 10)] &lt;- runif(10)

B &lt;- matrix(0, ncol=15, nrow=15)
B[sample(length(B), 10)] &lt;- runif(10)

# set the species names
rownames(A) &lt;- rownames(B) &lt;-
  colnames(A) &lt;- colnames(B) &lt;- paste0("S", 1:15)

plotNetworkFromMatrix(A, B)

</code></pre>

<hr>
<h2 id='predict.eicm'>Predict method for EICM fits</h2><span id='topic+predict.eicm'></span>

<h3>Description</h3>

<p>Obtains probability predictions (conditional or unconditional) or a model realization from a
parameterized EICM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
predict(object, nrepetitions = 10000, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.eicm_+3A_object">object</code></td>
<td>
<p>the fitted EICM model.</p>
</td></tr>
<tr><td><code id="predict.eicm_+3A_nrepetitions">nrepetitions</code></td>
<td>
<p>the number of realizations to conduct for computing probabilities. Set to 1
if you only need simulated community data.</p>
</td></tr>
<tr><td><code id="predict.eicm_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a matrix in which to look for variables with which to predict.
If omitted, the original data (used to fit the model) is used.</p>
</td></tr>
<tr><td><code id="predict.eicm_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interaction network of the model must be an <strong>acyclic graph</strong>.
Predictions are obtained by realizing the model multiple times and averaging realizations,
because there is not a closed-form expression for their calculation.
</p>
<p>To obtain conditional predictions, include presence/absence columns with species names in <code>newdata</code>.
Named columns for all the environmental predictors must always be included.
</p>


<h3>Value</h3>

<p>A species x sample matrix with predictions. If nrepetitions=1, predictions correspond to one
realization, otherwise they are probabilities.
</p>


<h3>Note</h3>

<p>If the eicm was fit without regularization, unconditional predictions are numerically equal
to those of simple binomial GLMs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the included parameterized model
data(truemodel)

# for reference, plot the species interaction network
plot(truemodel, type="network")

# Unconditional predictions
# let's fix environmental predictors at 0, for simplicity.
predict(truemodel, newdata=cbind(env01=0, env02=0))

# Conditional predictions
# predict probabilities for all species conditional on the
# known presence of sp011 (compare sp014 and sp004 with the above)
predict(truemodel, newdata=cbind(env01=0, env02=0, sp011=1))

# Propagation of indirect species effects
# predict probabilities for all species conditional on the known 
# absence (first line) and known presence (second line) of sp005 and sp023
predict(truemodel, newdata=cbind(env01=0, env02=0, sp012=c(0, 1), sp018=c(0, 1)), nrep=100000)

# Notice the effects on sp026 and the effect propagation to those
# species which depend on it (sp013, sp008)
# Also compare with unconditional predictions
</code></pre>

<hr>
<h2 id='print.eicm.matrix'>Print EICM model matrix</h2><span id='topic+print.eicm.matrix'></span>

<h3>Description</h3>

<p>Prints an excerpt of the EICM model coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm.matrix'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.eicm.matrix_+3A_x">x</code></td>
<td>
<p>a EICM model matrix.</p>
</td></tr>
<tr><td><code id="print.eicm.matrix_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL.
</p>

<hr>
<h2 id='profile.eicm'>Likelihood profiles for EICMs</h2><span id='topic+profile.eicm'></span>

<h3>Description</h3>

<p>Computes the profile (penalized) likelihood for all (or only one) estimated parameters in a EICM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eicm'
profile(
  fitted,
  all.pars = TRUE,
  parmatrix,
  species,
  parameter,
  step = 0.3,
  ncores = parallel::detectCores(),
  alpha = 0.01,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="profile.eicm_+3A_fitted">fitted</code></td>
<td>
<p>the fitted EICM model.</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_all.pars">all.pars</code></td>
<td>
<p>logical. Compute for all model parameters?</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_parmatrix">parmatrix</code></td>
<td>
<p>if all.pars=FALSE, in which matrix is the parameter of interest, &quot;env&quot; or &quot;sp&quot;?</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_species">species</code></td>
<td>
<p>if all.pars=FALSE, in which row of <code>parmatrix</code> is the parameter of interest?</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_parameter">parameter</code></td>
<td>
<p>if all.pars=FALSE, in which column of <code>parmatrix</code> is the parameter of interest?</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_step">step</code></td>
<td>
<p>the step increments/decrements at which to compute the likelihood profile points.</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_ncores">ncores</code></td>
<td>
<p>the number of CPU cores to use when computing profiles for all parameters.</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_alpha">alpha</code></td>
<td>
<p>highest significance level that will be guaranteed for this profile.</p>
</td></tr>
<tr><td><code id="profile.eicm_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Likelihod profiles will use the same regularization settings that were used in model fitting.
</p>


<h3>Value</h3>

<p>The same model object updated with a new <code>profile</code> component.
</p>


<h3>Note</h3>

<p>Confidence intervals should <strong>not</strong> be computed on a model whose terms have been selected.
</p>
<p>This function is optimized for computing profiles of multiple parameters simultaneously (in parallel).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load the included parameterized model
data(truemodel)

# realize the model
occurrences &lt;- predict(truemodel, nrepetitions=1)

# fit the model without species interactions
fitted &lt;- eicm(occurrences, n.latent=2, mask.sp=0, do.selection=FALSE)$fitted.model

# compute likelihood profiles for all parameters
fitted &lt;- profile(fitted, ncores=2)

# plot the first 9 profiles
par(mfrow=c(3, 3))
dummy &lt;- lapply(fitted$profile[1:9], plot)

</code></pre>

<hr>
<h2 id='truemodel'>A parameterized EICM model for simulation</h2><span id='topic+truemodel'></span>

<h3>Description</h3>

<p>A parameterized EICM model ready for simulating communities with a frequency
distribution following a Beta distribution with shape1=1.5 and shape2=3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truemodel
</code></pre>


<h3>Format</h3>

<p>A 'eicm' object with 2 environmental predictors in 400 samples,
32 species and 30 species interactions.
</p>


<h3>Details</h3>

<p>The model was generated with the command:
</p>
<p><code>truemodel &lt;- generateEICM(32, 400, 2, 30, shape1=1.5, shape2=3)</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
