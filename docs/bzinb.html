<!DOCTYPE html><html><head><title>Help for package bzinb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bzinb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bnb'><p>The bivariate negative binomial distribution</p></a></li>
<li><a href='#bp'><p>The bivariate poisson distribution</p></a></li>
<li><a href='#bzinb'><p>The bivariate zero-inflated negative binomial distribution</p></a></li>
<li><a href='#bzinb.se'><p>The bivariate zero-inflated negative binomial distribution</p>
- Standard error estimation</a></li>
<li><a href='#bzip.a'><p>The bivariate zero-inflated Poisson distribution (A)</p></a></li>
<li><a href='#bzip.b'><p>The bivariate zero-inflated Poisson distribution (B)</p></a></li>
<li><a href='#idigamma'><p>Inverse digamma function</p></a></li>
<li><a href='#pairwise.bzinb'><p>Pairwise underlying correlation based on bivariate zero-inflated negative binomial (BZINB) model</p></a></li>
<li><a href='#weighted.pc'><p>Weighted Pearson Correlation (WPC) based on bivariate zero-inflated</p>
negative binomial (BZINB) model</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivariate Zero-Inflated Negative Binomial Model Estimator</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.8</td>
</tr>
<tr>
<td>Author:</td>
<td>Hunyong Cho, Chuwen Liu, Jinyoung Park, Di Wu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hunyong Cho &lt;hunyong.cho@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a maximum likelihood estimation of Bivariate Zero-Inflated Negative Binomial (BZINB) model or the nested model parameters. Also estimates the underlying correlation of the a pair of count data. See Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation) for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, BH</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-14 11:53:57 UTC; hunyongcho</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-14 15:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='bnb'>The bivariate negative binomial distribution</h2><span id='topic+bnb'></span><span id='topic+lik.bnb'></span><span id='topic+rbnb'></span>

<h3>Description</h3>

<p>random generation (<code>rbnb</code>), maximum likelihood estimation (<code>bnb</code>), 
and log-likelihood. (<code>lik.bnb</code>)  for the bivariate negative binomial 
distribution with parameters equal to <code>(a0, a1, a2, b1, b2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.bnb(xvec, yvec, a0, a1, a2, b1, b2, param = NULL)

rbnb(n, a0, a1, a2, b1, b2, param = NULL)

bnb(
  xvec,
  yvec,
  em = TRUE,
  tol = 1e-08,
  maxiter = 50000,
  vcov = TRUE,
  initial = NULL,
  showFlag = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bnb_+3A_xvec">xvec</code>, <code id="bnb_+3A_yvec">yvec</code></td>
<td>
<p>a pair of bnb random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bnb_+3A_a0">a0</code>, <code id="bnb_+3A_a1">a1</code>, <code id="bnb_+3A_a2">a2</code></td>
<td>
<p>shape parameters of the latent gamma variables. must be positive.</p>
</td></tr>
<tr><td><code id="bnb_+3A_b1">b1</code>, <code id="bnb_+3A_b2">b2</code></td>
<td>
<p>scale parameters for the latent gamma variables. must be positive.</p>
</td></tr>
<tr><td><code id="bnb_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(a0, a1, a2, b1, b2)</code>). 
Either <code>param</code> or individual parameters (<code>a0, a1, a2, b1, b2</code>) 
need to be provided.</p>
</td></tr>
<tr><td><code id="bnb_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="bnb_+3A_em">em</code></td>
<td>
<p>if <code>TRUE</code> in <code>bnb</code>, EM algorithm is applied. Otherwise, direct opitmation is used.</p>
</td></tr>
<tr><td><code id="bnb_+3A_tol">tol</code>, <code id="bnb_+3A_maxiter">maxiter</code>, <code id="bnb_+3A_vcov">vcov</code>, <code id="bnb_+3A_initial">initial</code>, <code id="bnb_+3A_showflag">showFlag</code></td>
<td>
<p>optional arguments applied only when <code>em</code> is <code>TRUE</code> in <code>bnb</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>rbnb</code> gives a pair of random vectors following BNB distribution.
</p>
</li>
<li> <p><code>bnb</code> gives the maximum likelihood estimates of a BNB pair. 
Standard error and covariance matrix are provided when <code>em</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>lik.bnb</code> gives the log-likelihood of a set of parameters for a BNB pair.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(1)
data1 &lt;- rbnb(n = 100, a0 = 2, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1)

lik.bnb(xvec = data1[, 1], yvec = data1[ ,2], 
          a0 = 1, a1 = 1, a2 = 1, b1 = 1, b2 = 1) 

bnb(xvec = data1[,1], yvec = data1[,2], showFlag = FALSE)

</code></pre>

<hr>
<h2 id='bp'>The bivariate poisson distribution</h2><span id='topic+bp'></span><span id='topic+lik.bp'></span><span id='topic+rbp'></span>

<h3>Description</h3>

<p>random generation (<code>rbp</code>), maximum likelihood estimation (<code>bp</code>), 
and log-likelihood. (<code>lik.bp</code>)  for the bivariate Poisson 
distribution with parameters equal to <code>(m0, m1, m2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.bp(xvec, yvec, m0, m1, m2, param = NULL)

rbp(n, m0, m1, m2, param = NULL)

bp(xvec, yvec, tol = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bp_+3A_xvec">xvec</code>, <code id="bp_+3A_yvec">yvec</code></td>
<td>
<p>a pair of bp random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bp_+3A_m0">m0</code>, <code id="bp_+3A_m1">m1</code>, <code id="bp_+3A_m2">m2</code></td>
<td>
<p>mean parameters of the Poisson variables. They must be positive.</p>
</td></tr>
<tr><td><code id="bp_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(m0, m1, m2)</code>). 
Either <code>param</code> or individual parameters (<code>m0, m1, m2</code>) 
need to be provided.</p>
</td></tr>
<tr><td><code id="bp_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="bp_+3A_tol">tol</code></td>
<td>
<p>tolerance for judging convergence. <code>tol = 1e-8</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>rbp</code> gives a pair of random vectors following BP distribution.
</p>
</li>
<li> <p><code>bp</code> gives the maximum likelihood estimates of a BP pair.
</p>
</li>
<li> <p><code>lik.bp</code> gives the log-likelihood of a set of parameters for a BP pair.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>
<p>Kocherlakota, S. &amp; Kocherlakota, K. (1992). Bivariate Discrete Distributions. New York: Marcel Dekker.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(1)
data1 &lt;- rbp(n = 20, m0 = 1, m1 = 1, m2 = 1)

lik.bp(xvec = data1[, 1], yvec = data1[ ,2], 
          m0 = 1, m1 = 1, m2 = 1) 

bp(xvec = data1[,1], yvec = data1[,2])

</code></pre>

<hr>
<h2 id='bzinb'>The bivariate zero-inflated negative binomial distribution</h2><span id='topic+bzinb'></span><span id='topic+lik.bzinb'></span><span id='topic+rbzinb'></span>

<h3>Description</h3>

<p>random generation (<code>rbzinb</code>), maximum likelihood estimation (<code>bzinb</code>), 
and log-likelihood. (<code>lik.bzinb</code>)  for the bivariate zero-inflated negative binomial 
distribution with parameters equal to <code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.bzinb(xvec, yvec, a0, a1, a2, b1, b2, p1, p2, p3, p4, param = NULL)

rbzinb(n, a0, a1, a2, b1, b2, p1, p2, p3, p4, param = NULL)

bzinb(
  xvec,
  yvec,
  initial = NULL,
  tol = 1e-08,
  maxiter = 50000,
  showFlag = FALSE,
  vcov = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bzinb_+3A_xvec">xvec</code>, <code id="bzinb_+3A_yvec">yvec</code></td>
<td>
<p>a pair of bzinb random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_a0">a0</code>, <code id="bzinb_+3A_a1">a1</code>, <code id="bzinb_+3A_a2">a2</code></td>
<td>
<p>shape parameters of the latent gamma variables. They must be positive.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_b1">b1</code>, <code id="bzinb_+3A_b2">b2</code></td>
<td>
<p>scale parameters for the latent gamma variables. They must be positive.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_p1">p1</code>, <code id="bzinb_+3A_p2">p2</code>, <code id="bzinb_+3A_p3">p3</code>, <code id="bzinb_+3A_p4">p4</code></td>
<td>
<p>proportions summing up to 1 (<code>p1 + p2 + p3 + p4 = 1</code>). 
<code>p1</code> is the probability of both latent Poisson variables being observed. 
<code>p2</code> is the probability of only the first Poisson variables being observed.
<code>p3</code> is the probability of only the second Poisson variables being observed, and
<code>p4</code> is the probability of both Poisson variables being dropped out.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>). 
Either <code>param</code> or individual parameters (<code>a0, a1, a2, b1, b2, p1, p2, p3, p4</code>) 
need to be provided.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_initial">initial</code></td>
<td>
<p>starting value of param for EM algorithm, a vector of nine values.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_tol">tol</code></td>
<td>
<p>tolerance for judging convergence. <code>tol = 1e-8</code> by default.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations allowed. <code>tol = 50000</code> by default.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_showflag">showFlag</code></td>
<td>
<p>if <code>TRUE</code>, the updated parameter estimates for each iteration 
are printed out. If a positive integer, the updated parameter estimates for 
iterations greater than <code>showFlag</code> are printed out.</p>
</td></tr>
<tr><td><code id="bzinb_+3A_vcov">vcov</code></td>
<td>
<p>if <code>TRUE</code>, the variance-covariance matrix and information matrix 
are returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>EM theoretically guarantees higher likelihood at each iteration than that of previous iterations. 
See Dempster, Laird, and Rubin (1977). This guarantee comes with an assumption that there is no numerical
error in conditional likelihood maximization at each iteration. Small errors can cause decreasing likelihood 
especially when the iterations reach the point of convergence. Due to this technical error, the EM continues after it reaches
the maximum likelihood point (up to 100 iterations). However, the final estimate being returned is the parameter values at
the maximum likelihood.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>rbzinb</code> gives a pair of random vectors following BZINB distribution.
</p>
</li>
<li> <p><code>bzinb</code> gives the maximum likelihood estimates of a BZINB pair.
</p>

<ul>
<li> <p><code>rho</code> estimate and standard error of the underlying correlation (<code class="reqn">\rho</code>) and (<code class="reqn">logit(\rho)</code>)
</p>
</li>
<li> <p><code>coefficients</code> estimate and standard error of the BZINB parameters
</p>
</li>
<li> <p><code>lik</code> log-likelihood of the maximum likelihood estimate
</p>
</li>
<li> <p><code>iter</code> total number of iterations
</p>
</li>
<li> <p><code>info</code> information matrix. Provided when <code>vcov</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>vcov</code> variance-covariance matrix. Provided when <code>vcov</code> is <code>TRUE</code>.
</p>
</li></ul>

</li>
<li> <p><code>lik.bzinb</code> gives the log-likelihood of a set of parameters for a BZINB pair.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Preisser, J., Liu, C., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>
<p>Dempster, A. P., Laird, N. M., &amp; Rubin, D. B. (1977). Maximum likelihood from 
incomplete data via the EM algorithm. Journal of the Royal Statistical Society: 
Series B (Methodological), 39(1), 1-22.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(2)
data1 &lt;- rbzinb(n = 100, a0 = 2, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)

lik.bzinb(xvec = data1[, 1], yvec = data1[ ,2], 
          a0 = 1, a1 = 1, a2 = 1, b1 = 1, b2 = 1, 
          p1 = 0.5, p2 = 0.2, p3 = 0.2, p4 = 0.1)

bzinb(xvec = data1[,1], yvec = data1[,2], showFlag = FALSE)

</code></pre>

<hr>
<h2 id='bzinb.se'>The bivariate zero-inflated negative binomial distribution 
- Standard error estimation</h2><span id='topic+bzinb.se'></span>

<h3>Description</h3>

<p>Standard errors of the BZINB distribution parameter estimates are 
calculated based on maximum likelihood estimation. If <code>param</code> is <code>NULL</code>,
the parameters are first estimated by <code>bzinb</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bzinb.se(xvec, yvec, a0, a1, a2, b1, b2, p1, p2, p3, p4, param = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bzinb.se_+3A_xvec">xvec</code>, <code id="bzinb.se_+3A_yvec">yvec</code></td>
<td>
<p>a pair of bzinb random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bzinb.se_+3A_a0">a0</code>, <code id="bzinb.se_+3A_a1">a1</code>, <code id="bzinb.se_+3A_a2">a2</code></td>
<td>
<p>shape parameters of the latent gamma variables. They must be positive.</p>
</td></tr>
<tr><td><code id="bzinb.se_+3A_b1">b1</code>, <code id="bzinb.se_+3A_b2">b2</code></td>
<td>
<p>scale parameters for the latent gamma variables. They must be positive.</p>
</td></tr>
<tr><td><code id="bzinb.se_+3A_p1">p1</code>, <code id="bzinb.se_+3A_p2">p2</code>, <code id="bzinb.se_+3A_p3">p3</code>, <code id="bzinb.se_+3A_p4">p4</code></td>
<td>
<p>proportions summing up to 1 (<code>p1 + p2 + p3 + p4 = 1</code>). 
<code>p1</code> is the probability of both latent Poisson variables being observed. 
<code>p2</code> is the probability of only the first Poisson variables being observed.
<code>p3</code> is the probability of only the second Poisson variables being observed, and
<code>p4</code> is the probability of both Poisson variables being dropped out.</p>
</td></tr>
<tr><td><code id="bzinb.se_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>). 
See <code><a href="#topic+bzinb">bzinb</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="bzinb.se_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code>bzinb</code> function, when <code>param</code> is 
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Standard error of <code>rho</code>,  <code>logit.rho</code>,  <code>a0, a1, a2, b1, b2, p1, p2, p3</code>,
and <code>p4</code> estimates, variance-covariance matrix (<code>vcov</code>) and information matrix.
See <code><a href="#topic+bzinb">bzinb</a></code> for more detail. <code>iter</code> is <code>NA</code>, if the <code>param</code> 
is given.
</p>


<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
data1 &lt;- rbzinb(n = 20, a0 = 1, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)
bzinb.se(xvec = data1[,1], yvec = data1[,2], 
         param = c(5.5, 0.017, 0.017, 0.33, 0.36, 
                   0.53, 0.30, 0.08, 0.09))

</code></pre>

<hr>
<h2 id='bzip.a'>The bivariate zero-inflated Poisson distribution (A)</h2><span id='topic+bzip.a'></span><span id='topic+lik.bzip.a'></span><span id='topic+rbzip.a'></span>

<h3>Description</h3>

<p>random generation (<code>rbzip.a</code>), maximum likelihood estimation (<code>bzip.a</code>), 
and log-likelihood. (<code>lik.bzip.a</code>)  for the bivariate zero-inflated Poisson (A)
distribution with parameters equal to <code>(m0, m1, m2, p)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.bzip.a(xvec, yvec, m0, m1, m2, p, param = NULL)

rbzip.a(n, m0, m1, m2, p, param = NULL)

bzip.a(xvec, yvec, tol = 1e-06, initial = NULL, showFlag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bzip.a_+3A_xvec">xvec</code>, <code id="bzip.a_+3A_yvec">yvec</code></td>
<td>
<p>a pair of BZIP (A) random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_m0">m0</code>, <code id="bzip.a_+3A_m1">m1</code>, <code id="bzip.a_+3A_m2">m2</code></td>
<td>
<p>mean parameters of the Poisson variables. must be positive.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_p">p</code></td>
<td>
<p>zero-inflation probability</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(m0, m1, m2, p)</code>). 
Either <code>param</code> or individual parameters (<code>m0, m1, m2, p</code>) 
need to be provided.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_tol">tol</code></td>
<td>
<p>tolerance for judging convergence. <code>tol = 1e-8</code> by default.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_initial">initial</code></td>
<td>
<p>starting value of param for EM algorithm, a vector of nine values.</p>
</td></tr>
<tr><td><code id="bzip.a_+3A_showflag">showFlag</code></td>
<td>
<p>if <code>TRUE</code>, the updated parameter estimates for each iteration 
are printed out. If a positive integer, the updated parameter estimates for 
iterations greater than <code>showFlag</code> are printed out.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>rbzip.a</code> gives a pair of random vectors following BZIP (A) distribution.
</p>
</li>
<li> <p><code>bzip.a</code> gives the maximum likelihood estimates of a BZIP (A) pair.
</p>
</li>
<li> <p><code>lik.bzip.a</code> gives the log-likelihood of a set of parameters for a BZIP (A) pair.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>
<p>Li, C. S., Lu, J. C., Park, J., Kim, K., Brinkley, P. A., &amp; Peterson, J. P. (1999). 
Multivariate zero-inflated Poisson models and their applications. Technometrics, 41, 29-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(1)
data1 &lt;- rbzip.a(n = 20, m0 = 1, m1 = 1, m2 = 1, p = 0.5)

lik.bzip.a(xvec = data1[, 1], yvec = data1[ ,2], 
          m0 = 1, m1 = 1, m2 = 1, p = 0.5)

bzip.a(xvec = data1[,1], yvec = data1[,2], showFlag = FALSE)

</code></pre>

<hr>
<h2 id='bzip.b'>The bivariate zero-inflated Poisson distribution (B)</h2><span id='topic+bzip.b'></span><span id='topic+lik.bzip.b'></span><span id='topic+rbzip.b'></span>

<h3>Description</h3>

<p>random generation (<code>rbzip.b</code>), maximum likelihood estimation (<code>bzip.b</code>), 
and log-likelihood. (<code>lik.bzip.b</code>)  for the bivariate zero-inflated Poisson (B)
distribution with parameters equal to <code>(m0, m1, m2, p1, p2, p3, p4)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik.bzip.b(xvec, yvec, m0, m1, m2, p1, p2, p3, p4, param = NULL)

rbzip.b(n, m0, m1, m2, p1, p2, p3, p4, param = NULL)

bzip.b(
  xvec,
  yvec,
  tol = 1e-06,
  initial = NULL,
  showFlag = FALSE,
  maxiter = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bzip.b_+3A_xvec">xvec</code>, <code id="bzip.b_+3A_yvec">yvec</code></td>
<td>
<p>a pair of BZIP (B) random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_m0">m0</code>, <code id="bzip.b_+3A_m1">m1</code>, <code id="bzip.b_+3A_m2">m2</code></td>
<td>
<p>mean parameters of the Poisson variables. must be positive.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_p1">p1</code>, <code id="bzip.b_+3A_p2">p2</code>, <code id="bzip.b_+3A_p3">p3</code>, <code id="bzip.b_+3A_p4">p4</code></td>
<td>
<p>proportions summing up to 1 (<code>p1 + p2 + p3 + p4 = 1</code>). 
<code>p1</code> is the probability of both latent Poisson variables being observed. 
<code>p2</code> is the probability of only the first Poisson variables being observed.
<code>p3</code> is the probability of only the second Poisson variables being observed, and
<code>p4</code> is the probability of both Poisson variables being dropped out.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(m0, m1, m2, p1, p2, p3, p4)</code>). 
Either <code>param</code> or individual parameters (<code>m0, m1, m2, p1, p2, p3, p4</code>) 
need to be provided.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_tol">tol</code></td>
<td>
<p>tolerance for judging convergence. <code>tol = 1e-8</code> by default.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_initial">initial</code></td>
<td>
<p>starting value of param for EM algorithm, a vector of nine values.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_showflag">showFlag</code></td>
<td>
<p>if <code>TRUE</code>, the updated parameter estimates for each iteration 
are printed out. If a positive integer, the updated parameter estimates for 
iterations greater than <code>showFlag</code> are printed out.</p>
</td></tr>
<tr><td><code id="bzip.b_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations allowed. <code>tol = 50000</code> by default.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>rbzip.b</code> gives a pair of random vectors following BZIP (B) distribution.
</p>
</li>
<li> <p><code>bzip.b</code> gives the maximum likelihood estimates of a BZIP (B) pair.
</p>
</li>
<li> <p><code>lik.bzip.b</code> gives the log-likelihood of a set of parameters for a BZIP (B) pair.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(1)
data1 &lt;- rbzip.b(n = 20, m0 = 1, m1 = 1, m2 = 1, 
                p1 = 0.5, p2 = 0.2, p3 = 0.2, p4 = 0.1)

lik.bzip.b(xvec = data1[, 1], yvec = data1[ ,2], 
          m0 = 1, m1 = 1, m2 = 1, 
          p1 = 0.5, p2 = 0.2, p3 = 0.2, p4 = 0.1)

bzip.b(xvec = data1[,1], yvec = data1[,2], showFlag = FALSE)

</code></pre>

<hr>
<h2 id='idigamma'>Inverse digamma function</h2><span id='topic+idigamma'></span>

<h3>Description</h3>

<p>inverse of digamma. digamma function is the first derivative of gamma function divided by gamma function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idigamma(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idigamma_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>idigamma(2)
plot(digamma, 0.1, 3)
plot(idigamma, -10.4, 0.9)

</code></pre>

<hr>
<h2 id='pairwise.bzinb'>Pairwise underlying correlation based on bivariate zero-inflated negative binomial (BZINB) model</h2><span id='topic+pairwise.bzinb'></span>

<h3>Description</h3>

<p>For each pair of rows in the data, underlying corelation (<code class="reqn">\rho</code>) is calculated based on
bivariate zero-inflated negative binomial (BZINB) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairwise.bzinb(
  data,
  nonzero.prop = TRUE,
  fullParam = FALSE,
  showFlag = FALSE,
  nsample = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairwise.bzinb_+3A_data">data</code></td>
<td>
<p>a matrix with nonnegative integers. rows represent the feature (or gene), and
columns represent the sample. If not integers, rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="pairwise.bzinb_+3A_nonzero.prop">nonzero.prop</code></td>
<td>
<p>logical. If <code>TRUE</code>, proportion of nonzero for each of the pair is returned.</p>
</td></tr>
<tr><td><code id="pairwise.bzinb_+3A_fullparam">fullParam</code></td>
<td>
<p>logical. If <code>TRUE</code>, estimates of all parameters are returned.</p>
</td></tr>
<tr><td><code id="pairwise.bzinb_+3A_showflag">showFlag</code></td>
<td>
<p>logical. If <code>TRUE</code>, for each pair, the estimates are printed out.</p>
</td></tr>
<tr><td><code id="pairwise.bzinb_+3A_nsample">nsample</code></td>
<td>
<p>positive integer. If provided, <code>nsample</code> random pairs will only be considered for 
correlation. A non-integer will be rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="pairwise.bzinb_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code>bzinb</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a table of pairwise underlying correlation (<code class="reqn">\rho</code>) and related statistics.
</p>

<ul>
<li> <p><code>1</code> row number of the first vector of the pair
</p>
</li>
<li> <p><code>2</code> row number of the second vector of the pair
</p>
</li>
<li> <p><code>pair</code> row numbers of the pair
</p>
</li>
<li> <p><code>rho</code> underlying correlation estimate
</p>
</li>
<li> <p><code>se.rho</code> standard error of the underlying correlation estimate
</p>
</li>
<li> <p><code>nonzero.1, nonzero.2</code> non-zero proportion of the first and the second vector. 
Returned if <code>nonzero.prop</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>nonzero.min</code> pairwise minimum of non-zero proportions
Returned if <code>nonzero.prop</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a0, a1, ..., p4</code> parameter estimates
</p>
</li>
<li> <p><code>se.a0, se.a1, ..., se.p4</code> standard error of the parameter estimates
</p>
</li>
<li> <p><code>logLik</code> log-likelihood of the maximum likelihood estimates
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Liu, C., Preisser, J., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating four random vectors
set.seed(7)
data1 &lt;- rbzinb(n = 20, a0 = 0.5, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)
set.seed(14)
data2 &lt;- rbzinb(n = 20, a0 = 0.5, a1 = 1, a2 = 1, 
                b1 = 2, b2 = 2, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)
data3 &lt;- t(cbind(data1, data2))

# calculating all pairwise underlying correlations
## Not run: pairwise.bzinb(data3, showFlag = TRUE)

</code></pre>

<hr>
<h2 id='weighted.pc'>Weighted Pearson Correlation (WPC) based on bivariate zero-inflated 
negative binomial (BZINB) model</h2><span id='topic+weighted.pc'></span>

<h3>Description</h3>

<p>weighted.pc calculates Pearson's correlation with less weights for pairs 
containing zero(s). The weights are determined by BZINB model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted.pc(xvec, yvec, param = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weighted.pc_+3A_xvec">xvec</code>, <code id="weighted.pc_+3A_yvec">yvec</code></td>
<td>
<p>a pair of bzinb random vectors. nonnegative integer vectors. 
If not integers, they will be rounded to the nearest integers.</p>
</td></tr>
<tr><td><code id="weighted.pc_+3A_param">param</code></td>
<td>
<p>a vector of parameters (<code>(a0, a1, a2, b1, b2, p1, p2, p3, p4)</code>). 
See <code>bzinb</code> for details.
If <code>param</code> is <code>null</code>, it will be estimated by <code>bzinb()</code>.</p>
</td></tr>
<tr><td><code id="weighted.pc_+3A_...">...</code></td>
<td>
<p>optional arguments used passed to <code>bzinb</code>, when <code>param</code> is <code>null</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>weighted Pearson correlation (WPC) estimate
</p>


<h3>Author(s)</h3>

<p>Hunyong Cho, Chuwen Liu, Jinyoung Park, and Di Wu
</p>


<h3>References</h3>

<p>Cho, H., Preisser, J., Liu, C., and Wu, D. (In preparation), &quot;A bivariate 
zero-inflated negative binomial model for identifying underlying dependence&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generating a pair of random vectors
set.seed(2)
data1 &lt;- rbzinb(n = 20, a0 = 1, a1 = 1, a2 = 1, 
                b1 = 1, b2 = 1, p1 = 0.5, p2 = 0.2, 
                p3 = 0.2, p4 = 0.1)

weighted.pc(xvec = data1[,1], yvec = data1[,2], 
            param = c(0.769, 0.041, 0.075, 3.225, 1.902, 0.5, 0.084, 1e-20, 0.416))
weighted.pc(xvec = data1[,1], yvec = data1[,2])

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
