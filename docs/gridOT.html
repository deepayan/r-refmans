<!DOCTYPE html><html lang="en"><head><title>Help for package gridOT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gridOT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gridOT-package'><p>gridOT: Approximate Optimal Transport Between Two-Dimensional Grids</p></a></li>
<li><a href='#dual1d'><p>Dual Solution of one-dimensional Optimal Transport</p></a></li>
<li><a href='#north_west_corner'><p>North-west-corner Rule</p></a></li>
<li><a href='#otgrid'><p>Two-dimensional Grid with Mass</p></a></li>
<li><a href='#pivot_measure'><p>Pivot Measure</p></a></li>
<li><a href='#plot.otgrid'><p>Plots for two-dimensional Optimal Transport</p></a></li>
<li><a href='#transport_cost.numeric'><p>Optimal Transport Cost</p></a></li>
<li><a href='#transport_costmat'><p>Cost Matrix for two-dimensional Optimal Transport</p></a></li>
<li><a href='#transport_df.numeric'><p>Optimal Transport Plan</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Approximate Optimal Transport Between Two-Dimensional Grids</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Can be used for optimal transport between two-dimensional grids with respect to separable cost functions of l^p form. It utilizes the Frank-Wolfe algorithm to approximate so-called pivot measures: one-dimensional transport plans that fully describe the full transport, see G. Auricchio (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2105.07278">doi:10.48550/arXiv.2105.07278</a>&gt;. For these, it offers methods for visualization and to extract the corresponding transport plans and costs. Additionally, related functions for one-dimensional optimal transport are available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-18 14:02:34 UTC; Michl</td>
</tr>
<tr>
<td>Author:</td>
<td>Michel Groppe [aut, cre],
  Nicholas Bonneel [ctb],
  Egerváry Research Group on Combinatorial Optimization [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michel Groppe &lt;michel.groppe@stud.uni-goettingen.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-18 23:05:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='gridOT-package'>gridOT: Approximate Optimal Transport Between Two-Dimensional Grids</h2><span id='topic+gridOT'></span><span id='topic+gridOT-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
Can be used for optimal transport between two-dimensional grids with respect to separable cost functions of l^p form. It utilizes the
Frank-Wolfe algorithm to approximate so-called pivot measures: one-dimensional transport plans that fully describe the full transport, see G.
Auricchio (2021) <a href="https://arxiv.org/abs/2105.07278">arXiv:2105.07278</a>. For these, it offers methods for visualization and to extract the corresponding transport plans and costs.
Additionally, related functions for one-dimensional optimal transport are available.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Michel Groppe <a href="mailto:michel.groppe@stud.uni-goettingen.de">michel.groppe@stud.uni-goettingen.de</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Nicholas Bonneel [contributor]
</p>
</li>
<li><p> Egerváry Research Group on Combinatorial Optimization [copyright holder]
</p>
</li></ul>



<h3>References</h3>

<p>G. Auricchio (2021). On the Pythagorean Structure of the Optimal Transport for Separable Cost Functions. arXiv preprint <a href="https://arxiv.org/abs/2105.07278">arXiv:2105.07278</a>.
</p>

<hr>
<h2 id='dual1d'>Dual Solution of one-dimensional Optimal Transport</h2><span id='topic+dual1d'></span>

<h3>Description</h3>

<p>Calculate an optimal dual pair for the optimal transport between discrete one-dimensional measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dual1d(a, b, wa, wb, p = 1, right.margin = 1e-15, sorted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dual1d_+3A_a">a</code></td>
<td>
<p>first vector of points.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_b">b</code></td>
<td>
<p>second vector of points.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_wa">wa</code></td>
<td>
<p>weight vector of the first vector of points.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_wb">wb</code></td>
<td>
<p>weight vector of the second vector of points.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_p">p</code></td>
<td>
<p>the power <code class="reqn">\geq 1</code> of the cost function.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_right.margin">right.margin</code></td>
<td>
<p>small amount the points are moved by.</p>
</td></tr>
<tr><td><code id="dual1d_+3A_sorted">sorted</code></td>
<td>
<p>logical value indicating whether or not <code>a</code> and <code>b</code> are sorted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pair <code class="reqn">f, g</code> is an optimal dual pair if the optimal transport distance between the two distributions
with respect to the cost function <code class="reqn">c(x, y) = | x - y |^p</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\langle f, w_a \rangle + \langle g, w_b \rangle</code>
</p>

<p>and the condition <code class="reqn">f_i + g_j \leq | a_i - b_j |^p</code> holds.
</p>


<h3>Value</h3>

<p>a list containing the dual vectors <code>pot.a</code> and <code>pot.b</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
a &lt;- 1:5
wa &lt;- rep(1/5, 5)
b &lt;- 1:6
wb &lt;- runif(6)
wb &lt;- wb / sum(wb)

d &lt;- dual1d(a, b, wa, wb, p = 1)

dc &lt;- sum(d$pot.a * wa) + sum(d$pot.b * wb)
print(all.equal(dc, transport_cost(a, b, wa, wb, p = 1)))
</code></pre>

<hr>
<h2 id='north_west_corner'>North-west-corner Rule</h2><span id='topic+north_west_corner'></span>

<h3>Description</h3>

<p>Calculate the transport plan obtained by the north-west-corner rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>north_west_corner(wx, wy, threshold = 1e-15)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="north_west_corner_+3A_wx">wx</code></td>
<td>
<p>first weight vector.</p>
</td></tr>
<tr><td><code id="north_west_corner_+3A_wy">wy</code></td>
<td>
<p>second weight vector.</p>
</td></tr>
<tr><td><code id="north_west_corner_+3A_threshold">threshold</code></td>
<td>
<p>small value that indicates when a value is considered to be zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix representing the transport plan obtained by the north-west-corner rule.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
wx &lt;- rep(1/5, 5)
wy &lt;- runif(6)
wy &lt;- wy / sum(wy)
north_west_corner(wx, wy)
</code></pre>

<hr>
<h2 id='otgrid'>Two-dimensional Grid with Mass</h2><span id='topic+otgrid'></span>

<h3>Description</h3>

<p>Create an object that represents a probability measure that is supported on a two-dimensional grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>otgrid(
  mass,
  x = NULL,
  y = NULL,
  sorted = FALSE,
  normalize = FALSE,
  remove.zeros = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="otgrid_+3A_mass">mass</code></td>
<td>
<p>matrix of non-negative weights.</p>
</td></tr>
<tr><td><code id="otgrid_+3A_x">x</code></td>
<td>
<p>vector of support points of the first marginal.</p>
</td></tr>
<tr><td><code id="otgrid_+3A_y">y</code></td>
<td>
<p>vector of support points of the second marginal.</p>
</td></tr>
<tr><td><code id="otgrid_+3A_sorted">sorted</code></td>
<td>
<p>logical value specifying whether or not the support points are sorted.</p>
</td></tr>
<tr><td><code id="otgrid_+3A_normalize">normalize</code></td>
<td>
<p>logical value specifying whether or not the total mass should be rescaled to 1.</p>
</td></tr>
<tr><td><code id="otgrid_+3A_remove.zeros">remove.zeros</code></td>
<td>
<p>logical value specifying whether or not marginals with no mass should be removed from the grid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> and <code>y</code> are not specified, then a equispaced unit grid is chosen.
</p>


<h3>Value</h3>

<p>object of class <code>"otgrid"</code>. It contains the following elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>x</code>     </td><td style="text-align: left;"> vector of support points of the first marginal  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code>     </td><td style="text-align: left;"> vector of support points of the second marginal </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>n</code>     </td><td style="text-align: left;"> number of support points of the first marginal  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>m</code>     </td><td style="text-align: left;"> number of support points of the second marginal </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>mass</code>  </td><td style="text-align: left;"> matrix of non-negative weights                  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>total</code> </td><td style="text-align: left;"> total mass
</td>
</tr>

</table>

<p>Also note that the functions <code>print</code> and <code>plot</code> are available for objects of class <code>"otgrid"</code>.
</p>


<h3>See Also</h3>

<p>plot <code><a href="#topic+plot.otgrid">plot.otgrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- otgrid(cbind(1:2, 0, 3:4), remove.zeros = TRUE)

print(x) # note that it's only 2 x 2 
plot(x)
</code></pre>

<hr>
<h2 id='pivot_measure'>Pivot Measure</h2><span id='topic+pivot_measure'></span><span id='topic+pivot_measure.otgrid'></span><span id='topic+pivot_measure.data.frame'></span>

<h3>Description</h3>

<p>Calculate the pivot measure of the optimal transport between two-dimensional grids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivot_measure(x, ...)

## S3 method for class 'otgrid'
pivot_measure(
  x,
  y,
  p.1 = 2,
  p.2 = p.1,
  max.it = 100,
  tol = 1e-04,
  threads = 1,
  start.pivot = c("independent", "northwestcorner"),
  dual.method = c("discrete", "epsilon-discrete", "epsilon-histogram"),
  dual.params = list(),
  return.it = FALSE,
  ...
)

## S3 method for class 'data.frame'
pivot_measure(x, a, b, p.1 = 2, p.2 = p.1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pivot_measure_+3A_x">x</code></td>
<td>
<p>an object of class <code>"otgrid"</code> the mass is to be transported from or
a data frame with columns <code>from</code>, <code>to</code> and <code>mass</code> specifying the optimal transport plan.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_...">...</code></td>
<td>
<p>further arguments (currently unused).</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_y">y</code></td>
<td>
<p>an object of class <code>"otgrid"</code> the mass is to be transported to.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_p.1">p.1</code></td>
<td>
<p>the first power <code class="reqn">\geq 1</code> of the cost.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_p.2">p.2</code></td>
<td>
<p>the second power <code class="reqn">\geq 1</code> of the cost.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_max.it">max.it</code></td>
<td>
<p>the maximum number of iterations.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_tol">tol</code></td>
<td>
<p>the desired accuracy.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_threads">threads</code></td>
<td>
<p>number of threads to use.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_start.pivot">start.pivot</code></td>
<td>
<p>the start pivot to use: matrix representing an actual coupling or <code>"independent"</code> or <code>"northwestcorner"</code>.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_dual.method">dual.method</code></td>
<td>
<p>the name of the dual calculators to use: <code>"discrete"</code>, <code>"epsilon-discrete"</code> or <code>"epsilon-histogram"</code>.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_dual.params">dual.params</code></td>
<td>
<p>list of parameters for the dual calculators.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_return.it">return.it</code></td>
<td>
<p>logical value specifying whether or not the costs and dual gaps in each iteration are to be returned .</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_a">a</code></td>
<td>
<p>an object of class <code>"otgrid"</code> the mass is to be transported from.</p>
</td></tr>
<tr><td><code id="pivot_measure_+3A_b">b</code></td>
<td>
<p>an object of class <code>"otgrid"</code> the mass is to be transported to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Denote with <code class="reqn">X_1 \times X_2</code> and <code class="reqn">Y_1 \times Y_2</code> the two-dimensional grids that <code>x</code> and <code>y</code> lie on, respectively.
The pivot measure is a measure on <code class="reqn">Y_1 \times X_2</code> that specifies the whole transport between <code>x</code> and <code>y</code> given that the cost
is of the separable form <code class="reqn">c(x, y) = | x_1 - y_1 |^{p_1} + | x_2 - y_2 |^{p_2}</code>.
</p>
<p>The pivot measure is approximated using the Frank-Wolfe algorithm. The algorithm starts with an initial guess (<code>start.pivot</code>), e.g., the
independent coupling (<code>"independent"</code>) or the north-west-corner rule (<code>"northwestcorner"</code>). Then, in each iteration step, the dual solutions of
multiple one-dimensional transport problems are calculated and combined to give the gradient. To ensure differentiability, the dual solutions
must be unique. There are three different calculators for the dual solutions, of which the last two ensure uniqueness:
</p>

<table>
<tr>
 <td style="text-align: left;">
name                  </td><td style="text-align: left;"> description </td><td style="text-align: left;"> <code>dual.params</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"discrete"</code>          </td><td style="text-align: left;"> the distributions are basically unchanged, due to rounding errors the support points
are moved by a small positive amount.  </td><td style="text-align: left;"> <code>right.margin = 1e-15</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"epsilon-discrete"</code>  </td><td style="text-align: left;"> additionally, the support is made connected by uniformly adding <code class="reqn">\varepsilon</code>
mass. </td><td style="text-align: left;"> + <code>eps = 1e-8</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"epsilon-histogram"</code> </td><td style="text-align: left;"> additionally, each point mass is distributed uniformly in a bin around said point </td><td style="text-align: left;"> + <code>width = 1e-8</code>
</td>
</tr>

</table>

<p>A pivot measure can also be computed from an optimal transport plan.
</p>
<p>Finally, the pivot measure can be used to calculate the full transport plan and cost.
</p>


<h3>Value</h3>

<p>an object of class <code>"otgridtransport"</code> that contains the following elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>from</code>  </td><td style="text-align: left;"> an object of class <code>"otgrid"</code> the mass is transported from. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>to</code>    </td><td style="text-align: left;"> an object of class <code>"otgrid"</code> the mass is transported to. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.1</code>   </td><td style="text-align: left;"> the first power <code class="reqn">\geq 1</code> of the cost function. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p.2</code>   </td><td style="text-align: left;"> the second power <code class="reqn">\geq 1</code> of the cost function. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>pivot</code> </td><td style="text-align: left;"> a matrix representing the pivot measure.
</td>
</tr>

</table>

<p>If the Frank-Wolfe algorithm is used to approximate the pivot measure, the element <code>conv</code> indicates whether or not
we can ensured that the error is less or equal to the given precision <code>tol</code>.
</p>
<p>If <code>return.it = TRUE</code>, then it also contains the vectors <code>costs</code> and <code>dualgaps</code> of costs and dual gaps in each iteration.
</p>
<p>Also note that the functions <code>print</code> and <code>plot</code> are available for objects of class <code>"otgridtransport"</code>.
</p>


<h3>See Also</h3>

<p>transport plan <code><a href="#topic+transport_df">transport_df</a></code>, transport cost <code><a href="#topic+transport_cost">transport_cost</a></code>, two-dimensional grid <code><a href="#topic+otgrid">otgrid</a></code>,
plot <code><a href="#topic+plot.otgridtransport">plot.otgridtransport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- otgrid(rbind(c(0, 0, 0, 0, 0, 0, 0, 0, 0),
                 c(0, 0, 1, 0, 0, 0, 0, 0, 0),
                 c(0, 1, 2, 1, 0, 0, 0, 0, 0),
                 c(0, 0, 1, 0, 0, 0, 0, 0, 0), 
                  0, 0, 0, 0, 0))
y &lt;- otgrid(rbind(0, 0, 0, 0,
                 c(0, 0, 0, 0, 0, 0, 0, 0, 0),
                 c(0, 0, 0, 0, 0, 0, 1, 0, 0),
                 c(0, 0, 0, 0, 0, 1, 2, 1, 0),
                 c(0, 0, 0, 0, 0, 0, 1, 0, 0), 0))

pm &lt;- pivot_measure(x, y, p.1 = 1, p.2 = 2, dual.method = "epsilon-discrete")

print(pm)
plot(pm)

# use pivot measure to calculate cost and plan
pm &lt;- transport_cost(pm)
pm &lt;- transport_df(pm)
print(pm)

# calculate pivot from plan
pm2 &lt;- pivot_measure(pm$df, x, y)
plot(pm2)
</code></pre>

<hr>
<h2 id='plot.otgrid'>Plots for two-dimensional Optimal Transport</h2><span id='topic+plot.otgrid'></span><span id='topic+plot.otgridtransport'></span>

<h3>Description</h3>

<p>Plot two-dimensional grids or visualize the pivot measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'otgrid'
plot(x, num.col = 256, useRaster = TRUE, ...)

## S3 method for class 'otgridtransport'
plot(x, num.col = 256, useRaster = TRUE, back.col = "lightblue", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.otgrid_+3A_x">x</code></td>
<td>
<p>an object of class <code>"otgrid"</code> or <code>"otgridtransport"</code></p>
</td></tr>
<tr><td><code id="plot.otgrid_+3A_num.col">num.col</code></td>
<td>
<p>number of colors (grey) to use.</p>
</td></tr>
<tr><td><code id="plot.otgrid_+3A_useraster">useRaster</code></td>
<td>
<p>parameter passed to the <code><a href="graphics.html#topic+image">image</a></code> function.</p>
</td></tr>
<tr><td><code id="plot.otgrid_+3A_...">...</code></td>
<td>
<p>further arguments (currently unused).</p>
</td></tr>
<tr><td><code id="plot.otgrid_+3A_back.col">back.col</code></td>
<td>
<p>color of the background.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For objects of class <code>"otgrid"</code>, the grid is plotted as a greyscale image.
</p>
<p>For objects of class <code>"otgridtransport"</code>, the pivot measure is visualized as follows: the two grids of the transport are plotted
in the left upper (<code>from</code>) and right lower (<code>to</code>) corner. The pivot measure is in the left lower corner such that the marginals match.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>See Also</h3>

<p>pivot measure <code><a href="#topic+pivot_measure">pivot_measure</a></code>, grid <code><a href="#topic+otgrid">otgrid</a></code>
</p>

<hr>
<h2 id='transport_cost.numeric'>Optimal Transport Cost</h2><span id='topic+transport_cost.numeric'></span><span id='topic+transport_cost'></span><span id='topic+transport_cost.otgridtransport'></span><span id='topic+transport_cost.otgrid'></span><span id='topic+transport_cost.data.frame'></span>

<h3>Description</h3>

<p>Calculate the optimal transport cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'numeric'
transport_cost(x, y, wx, wy, p = 1, sorted = FALSE, threshold = 1e-15, ...)

transport_cost(x, ...)

## S3 method for class 'otgridtransport'
transport_cost(x, threshold = 1e-15, ...)

## S3 method for class 'otgrid'
transport_cost(x, ...)

## S3 method for class 'data.frame'
transport_cost(x, costm, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transport_cost.numeric_+3A_x">x</code></td>
<td>
<p>a vector of points; a data frame with columns <code>from</code>, <code>to</code> and <code>mass</code> specifying the optimal transport plan;
an object of class <code>"otgridtransport"</code> or <code>"otgrid"</code>, in the latter case <code>...</code> must be
the arguments of <code><a href="#topic+pivot_measure">pivot_measure</a></code>.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_y">y</code></td>
<td>
<p>second vector of points.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_wx">wx</code></td>
<td>
<p>weight vector of the first vector of points.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_wy">wy</code></td>
<td>
<p>weight vector of the second vector of points.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_p">p</code></td>
<td>
<p>the power <code class="reqn">\geq 1</code> of the cost function.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_sorted">sorted</code></td>
<td>
<p>logical value indicating whether or not <code>a</code> and <code>b</code> are sorted.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_threshold">threshold</code></td>
<td>
<p>small value that indicates when a value is considered to be zero.</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_...">...</code></td>
<td>
<p>further arguments (for <code><a href="#topic+pivot_measure">pivot_measure</a></code> if <code>x</code> is an object of class <code>"otgrid"</code>).</p>
</td></tr>
<tr><td><code id="transport_cost.numeric_+3A_costm">costm</code></td>
<td>
<p>cost matrix of the transport</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of two-dimensional grids, the pivot measure is used to calculate the optimal transport cost.
</p>
<p>For one-dimensional optimal transport, the cost function is given by <code class="reqn">c(x, y) = | x - y |^p</code>. In this case, the north-west-corner
algorithm is used.
</p>


<h3>Value</h3>

<p>the optimal transport cost or, in case of two-dimensional case, an object of class <code>"otgridtransport"</code> with element <code>cost</code> that contains it.
</p>


<h3>See Also</h3>

<p>pivot measure <code><a href="#topic+pivot_measure">pivot_measure</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## one-dimensional example
set.seed(1)
a &lt;- 1:5
wa &lt;- rep(1/5, 5)
b &lt;- 1:6
wb &lt;- runif(6)
wb &lt;- wb / sum(wb)
transport_cost(a, b, wa, wb, p = 1)

## two-dimensional example
x &lt;- otgrid(cbind(0:1, 1:0))
y &lt;- otgrid(cbind(1:0, 0:1))

# first calculate pivot manually
pm &lt;- pivot_measure(x, y)
pm &lt;- transport_cost(pm)
print(pm$cost)

# or just
pm2 &lt;- transport_cost(x, y)
print(pm2$cost)

# or from transport plan and cost matrix
costm &lt;- transport_costmat(pm)
tp &lt;- transport_df(pm)
print(transport_cost(tp$df, costm))
</code></pre>

<hr>
<h2 id='transport_costmat'>Cost Matrix for two-dimensional Optimal Transport</h2><span id='topic+transport_costmat'></span><span id='topic+transport_costmat.otgrid'></span><span id='topic+transport_costmat.otgridtransport'></span>

<h3>Description</h3>

<p>Calculate the cost matrix for the optimal transport between two-dimensional grids with respect to the cost function
</p>
<p style="text-align: center;"><code class="reqn">c(x, y) = | x_1 - y_1 |^{p_1} + | x_2 - y_2 |^{p_2}.</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>transport_costmat(x, ...)

## S3 method for class 'otgrid'
transport_costmat(x, y, p.1 = 2, p.2 = p.1, ...)

## S3 method for class 'otgridtransport'
transport_costmat(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transport_costmat_+3A_x">x</code></td>
<td>
<p>an object of class <code>"otgridtransport"</code> or <code>"otgrid"</code>, in the latter case it gives the object the mass is to be transported from.</p>
</td></tr>
<tr><td><code id="transport_costmat_+3A_...">...</code></td>
<td>
<p>further arguments (currently unused).</p>
</td></tr>
<tr><td><code id="transport_costmat_+3A_y">y</code></td>
<td>
<p>an object of class <code>"otgrid"</code> the mass is to be transported from.</p>
</td></tr>
<tr><td><code id="transport_costmat_+3A_p.1">p.1</code></td>
<td>
<p>the first power <code class="reqn">\geq 1</code> of the cost.</p>
</td></tr>
<tr><td><code id="transport_costmat_+3A_p.2">p.2</code></td>
<td>
<p>the second power <code class="reqn">\geq 1</code> of the cost.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix giving the pairwise costs in column-mayor format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- otgrid(cbind(0:1, 1:0))
y &lt;- otgrid(cbind(1:0, 0:1))

transport_costmat(x, y, p.1 = 1, p.2 = 3)
</code></pre>

<hr>
<h2 id='transport_df.numeric'>Optimal Transport Plan</h2><span id='topic+transport_df.numeric'></span><span id='topic+transport_df'></span><span id='topic+transport_df.otgridtransport'></span><span id='topic+transport_df.otgrid'></span>

<h3>Description</h3>

<p>Calculate the optimal transport plan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'numeric'
transport_df(x, y, threshold = 1e-15, ...)

transport_df(x, ...)

## S3 method for class 'otgridtransport'
transport_df(x, ...)

## S3 method for class 'otgrid'
transport_df(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transport_df.numeric_+3A_x">x</code></td>
<td>
<p>a vector of weights, an object of class <code>"otgridtransport"</code> or <code>"otgrid"</code>, in the latter case <code>...</code> must be the arguments of <code><a href="#topic+pivot_measure">pivot_measure</a></code>.</p>
</td></tr>
<tr><td><code id="transport_df.numeric_+3A_y">y</code></td>
<td>
<p>second weight vector.</p>
</td></tr>
<tr><td><code id="transport_df.numeric_+3A_threshold">threshold</code></td>
<td>
<p>small value that indicates when a value is considered to be zero.</p>
</td></tr>
<tr><td><code id="transport_df.numeric_+3A_...">...</code></td>
<td>
<p>further arguments (for <code><a href="#topic+pivot_measure">pivot_measure</a></code> if <code>x</code> is an object of class <code>"otgrid"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case of two-dimensional grids, the pivot measure is used to calculate the optimal transport plan.
</p>
<p>For one-dimensional optimal transport, we assume that the optimal transport plan is the monotone plan. For example, this is the case
for costs of the form <code class="reqn">c(x, y) = | x - y |^p</code> for some <code class="reqn">p \geq 1</code>.
In this case, the north-west-corner algorithm is used.
</p>


<h3>Value</h3>

<p>a data frame representing the optimal transport plan. It has columns <code>from</code>, <code>to</code> and <code>mass</code> that specify
between which points of the two grids how much mass is transported.
</p>
<p>In the two-dimensional case, a point is given by the index in column-mayor format and the data frame is actually stored in the element
<code>df</code> of an object of class <code>"otgridtransport"</code>.
</p>


<h3>See Also</h3>

<p>pivot measure <code><a href="#topic+pivot_measure">pivot_measure</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## one-dimensional example
set.seed(1)
wa &lt;- rep(1/5, 5)
wb &lt;- runif(6)
wb &lt;- wb / sum(wb)
transport_df(wa, wb)

## two-dimensional example
x &lt;- otgrid(cbind(0:1, 1:0))
y &lt;- otgrid(cbind(1:0, 0:1))

# first calculate pivot manually
pm &lt;- pivot_measure(x, y)
pm &lt;- transport_df(pm)

# or just
pm2 &lt;- transport_df(x, y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
