<!DOCTYPE html><html lang="en"><head><title>Help for package cytometree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cytometree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cytometree-package'><p>Binary tree algorithm for cytometry data analysis.</p></a></li>
<li><a href='#Annotation'><p>Annotates cell populations found using CytomeTree.</p></a></li>
<li><a href='#AsinhTransformation'><p>Data transformation using asinh</p></a></li>
<li><a href='#BiexpTransformation'><p>Data transformation using biexp</p></a></li>
<li><a href='#BinaryTree'><p>Builds a binary tree.</p></a></li>
<li><a href='#bootstrapCI'><p>Bootstrapped Confidence Interval.</p></a></li>
<li><a href='#CytEM'><p>E-M algorithm.</p></a></li>
<li><a href='#Cytof_BinaryTree'><p>Builds a binary tree for mass cytometry data.</p></a></li>
<li><a href='#CytofEM'><p>E-M algorithm for cytoftree.</p></a></li>
<li><a href='#CytofTree'><p>Binary tree algorithm for mass cytometry data analysis.</p></a></li>
<li><a href='#CytomeTree'><p>Binary tree algorithm for cytometry data analysis.</p></a></li>
<li><a href='#DLBCL'><p>Diffuse large B-cell lymphoma data set from the FlowCAP-I challenge.</p></a></li>
<li><a href='#FmeasureC'><p>C++ implementation of the F-measure computation</p></a></li>
<li><a href='#FmeasureC_no0'><p>C++ implementation of the F-measure computation without the reference class labeled &quot;0&quot;</p></a></li>
<li><a href='#GaussMix'><p>Bi-modal normal mixture distribution.</p></a></li>
<li><a href='#GaussMix2'><p>tri-modal normal mixture distribution.</p></a></li>
<li><a href='#HIPC'><p>HIPC T cell data set from HIPC program, patient 12828. The data was analyzed and gated by Stanford.</p></a></li>
<li><a href='#IMdata'><p>Influenza vaccine response dataset</p></a></li>
<li><a href='#KmeansOPT'><p>Finds the partition which minimize the within-leaves sum of squares.</p></a></li>
<li><a href='#LeavesCenters'><p>Computes means of leaves given cytomeTreeObj.</p></a></li>
<li><a href='#LeavesMedians'><p>Computes medians of leaves given cytomeTreeObj.</p></a></li>
<li><a href='#Log10Transformation'><p>Data transformation using log10</p></a></li>
<li><a href='#Partition2gr'><p>Computes N-1 possible partitions of ordered N into 2 subsets.</p></a></li>
<li><a href='#Partition3gr'><p>Computes (N-1)*(N-2) possible partitions of N into 3 subsets.</p></a></li>
<li><a href='#plot_cytopop'><p>Plot the cell count for each population using CytomeTree.</p></a></li>
<li><a href='#plot_graph'><p>Plot the binary tree built using CytomeTree.</p></a></li>
<li><a href='#plot_nodes'><p>Plot the distribution of the observed cells at each node</p>
of the binary tree built using CytomeTree.</a></li>
<li><a href='#RetrievePops'><p>Retrieve cell populations found using Annotation.</p></a></li>
<li><a href='#TreeAnnot'><p>Returns the underlying annotation given a tree pattern.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automated Cytometry Gating and Annotation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Chariff Alkhassim, Boris P Hejblum, Anthony Devaux, Van Hung Huynh Tran</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Boris P Hejblum &lt;boris.hejblum@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Description:</td>
<td>Given the hypothesis of a bi-modal distribution of cells for
    each marker, the algorithm constructs a binary tree, the nodes of which are
    subpopulations of cells. At each node, observed cells and markers are modeled
    by both a family of normal distributions and a family of bi-modal normal mixture
    distributions. Splitting is done according to a normalized difference of AIC
    between the two families. Method is detailed in: Commenges, Alkhassim, Gottardo, 
    Hejblum &amp; Thiebaut (2018) &lt;<a href="https://doi.org/10.1002%2Fcyto.a.23601">doi:10.1002/cyto.a.23601</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), Rcpp (&ge; 0.12.11)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, graphics, igraph, mclust, methods, stats, cowplot,
GoFKernel</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sistm/Cytometree/issues">https://github.com/sistm/Cytometree/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, formatR, rmarkdown, viridis</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-04 20:27:58 UTC; boris</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-04 22:20:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='cytometree-package'>Binary tree algorithm for cytometry data analysis.</h2><span id='topic+cytometree-package'></span><span id='topic+cytometree'></span>

<h3>Description</h3>

<p>The algorithm is based on the construction of a binary tree, 
the nodes of which are subpopulations of cells. At each node, 
observed cells and markers are modeled by both a family of normal
distributions and a family of bi-modal normal mixture distributions. 
Splitting is done according to a normalized difference of AIC between 
the two families.
Given the unsupervised nature of the binary tree, some of the available
markers may not be used to find the different cell populations present in 
a given sample. To recover a complete annotation, we defined, as a post 
processing procedure, an annotation method which allows the user to 
distinguish two or three expression levels per marker.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> cytometree</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-12-04</td>
</tr>
<tr>
 <td style="text-align: left;">
License:</td><td style="text-align: left;"> <a href="http://www.gnu.org/licenses/lgpl.txt">LGPL-3</a></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main function in this package is <code><a href="#topic+CytomeTree">CytomeTree</a></code>.
</p>


<h3>Author(s)</h3>

<p>Chariff Alkhassim, Boris Hejblum, Anthony Devaux, Van Hung Huynh Tran
&mdash; Maintainer: Boris Hejblum
</p>


<h3>References</h3>

<p>Commenges D, Alkhassim C, Gottardo R, Hejblum BP, Thi√©baut R (2018). 
cytometree: a binary tree algorithm for automatic gating in cytometry analysis. 
Cytometry Part A, 93(11):1132-1140. &lt;doi: 10.1002/cyto.a.23601&gt;
</p>

<hr>
<h2 id='Annotation'>Annotates cell populations found using CytomeTree.</h2><span id='topic+Annotation'></span>

<h3>Description</h3>

<p>Annotates cell populations found using CytomeTree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Annotation(
  CytomeTreeObj,
  K2markers = NULL,
  K3markers = NULL,
  plot = TRUE,
  t = 0.2,
  remove_outliers_inplot = TRUE,
  center_fun = c("median", "mean")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Annotation_+3A_cytometreeobj">CytomeTreeObj</code></td>
<td>
<p>An object of class CytomeTree.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_k2markers">K2markers</code></td>
<td>
<p>A vector of class character where the names of 
the markers for which 2 levels of expression are sought can be specified.
Default is <code>NULL</code> i.e. unsupervised.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_k3markers">K3markers</code></td>
<td>
<p>A vector of class character where the names of 
the markers for which 3 levels of expression are sought can be specified.
Default is <code>NULL</code> i.e. unsupervised.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether or not to plot the 
partitioning in 1, 2 or 3 groups for each marker. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_t">t</code></td>
<td>
<p>A real positive-or-null number used for comparison with
the normalized AIC computed to compare the fits of the marginal distributions
obtained by one normal distribution and by a mixture of two or three normal.
For markers used in the tree, the algorithm compares the
fits obtained by a mixture of two and three normal distributions.
Default value is .2. A higher value leads to a smaller number of
expression levels per marker.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_remove_outliers_inplot">remove_outliers_inplot</code></td>
<td>
<p>a logical flag indicating whether the y-axis
should be scaled by removing outliers or not. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="Annotation_+3A_center_fun">center_fun</code></td>
<td>
<p>a character string either 'median' or 'mean' indicating based 
on which summary the populations should be ordered. Default is <code>'median'</code>,
which is more robust to outliers and long tail distributions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is set to find the partitioning in 1, 2 or
3 groups of cell populations found using CytomeTree. In an unsupervised mode,
it minimizes the within-leaves sum of squares of the observed values on each
marker and computes the normalized AIC to compare the fits of the marginal 
distributions obtained by one normal distribution and by a mixture of two
or three normal.For markers used in the tree, the algorithm compares the
fits obtained by a mixture of two and three normal distributions.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the annotation of each 
cell population.
</p>


<h3>Author(s)</h3>

<p>Chariff Alkhassim, Boris Hejblum
</p>

<hr>
<h2 id='AsinhTransformation'>Data transformation using asinh</h2><span id='topic+AsinhTransformation'></span>

<h3>Description</h3>

<p>Data transformation using asinh
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsinhTransformation(M, num_col, a = 0, b = 0.2, c = 0)
</code></pre>

<hr>
<h2 id='BiexpTransformation'>Data transformation using biexp</h2><span id='topic+BiexpTransformation'></span>

<h3>Description</h3>

<p>Data transformation using biexp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BiexpTransformation(M, num_col, a = 0.5, b = 1, c = 0.5, d = 1, f = 0, w = 0)
</code></pre>

<hr>
<h2 id='BinaryTree'>Builds a binary tree.</h2><span id='topic+BinaryTree'></span>

<h3>Description</h3>

<p>Builds a binary tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BinaryTree(M, minleaf = 1, t = 0.1, verbose = TRUE, force_first_markers = NULL)
</code></pre>

<hr>
<h2 id='bootstrapCI'>Bootstrapped Confidence Interval.</h2><span id='topic+bootstrapCI'></span>

<h3>Description</h3>

<p>Bootstrapped Confidence Interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapCI(stat, n, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootstrapCI_+3A_stat">stat</code></td>
<td>
<p>A numeric vector of statistics for which to compute a 
confidence interval.</p>
</td></tr>
<tr><td><code id="bootstrapCI_+3A_n">n</code></td>
<td>
<p>An integer giving the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="bootstrapCI_+3A_alpha">alpha</code></td>
<td>
<p>A real number comprised in ]0, 1[ : 
1 - desired confidence level.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chariff Alkhassim
</p>

<hr>
<h2 id='CytEM'>E-M algorithm.</h2><span id='topic+CytEM'></span>

<h3>Description</h3>

<p>E-M algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CytEM(M, indices, minleaf, level, t, force_marker = NULL)
</code></pre>

<hr>
<h2 id='Cytof_BinaryTree'>Builds a binary tree for mass cytometry data.</h2><span id='topic+Cytof_BinaryTree'></span>

<h3>Description</h3>

<p>Builds a binary tree for mass cytometry data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cytof_BinaryTree(
  M,
  minleaf = 1,
  t = 0.1,
  verbose = TRUE,
  force_first_markers = NULL
)
</code></pre>

<hr>
<h2 id='CytofEM'>E-M algorithm for cytoftree.</h2><span id='topic+CytofEM'></span>

<h3>Description</h3>

<p>E-M algorithm for cytoftree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CytofEM(M, indices, minleaf, level, t, force_marker = NULL)
</code></pre>

<hr>
<h2 id='CytofTree'>Binary tree algorithm for mass cytometry data analysis.</h2><span id='topic+CytofTree'></span>

<h3>Description</h3>

<p>Binary tree algorithm for mass cytometry data analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CytofTree(
  M,
  minleaf = 1,
  t = 0.1,
  verbose = TRUE,
  force_first_markers = NULL,
  transformation = c("asinh", "biexp", "log10", "none"),
  num_col = 1:ncol(M)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CytofTree_+3A_m">M</code></td>
<td>
<p>A matrix of size n x p containing mass cytometry measures
of n cells on p markers.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_minleaf">minleaf</code></td>
<td>
<p>An integer indicating the minimum number of cells
per population. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_t">t</code></td>
<td>
<p>A real positive-or-null number used for comparison with
the normalized AIC computed at each node of the tree.
A higher value limits the height of the tree.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_verbose">verbose</code></td>
<td>
<p>A logical controlling if a text progress bar is displayed 
during the execution of the algorithm. By default is TRUE.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_force_first_markers">force_first_markers</code></td>
<td>
<p>a vector of index to split the data on first.
This argument is used in the semi-supervised setting, forcing the algorithm to consider 
those markers first, in the order they appear in this <code>force_first_markers</code> vector, 
and forcing the split at every node. Default is <code>NULL</code>, in which case
the clustering algorithm is unsupervised.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_transformation">transformation</code></td>
<td>
<p>A string indicating the transformation used among <code>asinh</code> 
<code>biexp</code>, <code>log10</code> and <code>none</code>. Default is <code>asinh</code> transformation.</p>
</td></tr>
<tr><td><code id="CytofTree_+3A_num_col">num_col</code></td>
<td>
<p>An integer vector of index indicating the columns to be transform. 
Default is <code>1:ncol(M)</code> to transform all the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First of all, data can be transformed using different transformations. 
The algorithm is based on the construction of a binary tree,
the nodes of which are subpopulations of cells. At each node,
observed cells and markers are modeled by both a family of normal
distributions and a family of bi-modal normal mixture distributions.
Splitting is done according to a normalized difference of AIC between
the two families.
</p>


<h3>Value</h3>

<p>An object of class 'cytomeTree' providing a partitioning
of the set of n cells.
</p>

<ul>
<li><p><code>annotation</code> A <code>data.frame</code> containing the annotation of each 
cell population underlying the tree pattern.
</p>
</li>
<li><p><code>labels</code> The partitioning of the set of n cells.
</p>
</li>
<li><p><code>M</code> The transformed matrix of mass cytometry.
</p>
</li>
<li><p><code>mark_tree</code> A two level list containing markers used
for node splitting.
</p>
</li>
<li><p><code>transformation</code> Transformation used
</p>
</li>
<li><p><code>num_col</code> Indexes of columns transformed
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Anthony Devaux, Boris Hejblum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IMdata)

# dimension of data
dim(IMdata)

# given the size of the dataset, the code below can take several minutes to run

if(interactive()){
# Don't transform Time et Cell_length column
num_col &lt;- 3:ncol(IMdata)

# Build Cytoftree binary tree
tree &lt;- CytofTree(M = IMdata, minleaf = 1, t = 0.1, transformation = "asinh", num_col = num_col)

# Annotation
annot &lt;- Annotation(tree, plot = FALSE, K2markers = colnames(IMdata))

# Provide subpopulations
annot$combinations
}

</code></pre>

<hr>
<h2 id='CytomeTree'>Binary tree algorithm for cytometry data analysis.</h2><span id='topic+CytomeTree'></span>

<h3>Description</h3>

<p>Binary tree algorithm for cytometry data analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CytomeTree(M, minleaf = 1, t = 0.1, verbose = TRUE, force_first_markers = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CytomeTree_+3A_m">M</code></td>
<td>
<p>A matrix of size n x p containing cytometry measures
of n cells on p markers.</p>
</td></tr>
<tr><td><code id="CytomeTree_+3A_minleaf">minleaf</code></td>
<td>
<p>An integer indicating the minimum number of cells
per population. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="CytomeTree_+3A_t">t</code></td>
<td>
<p>A real positive-or-null number used for comparison with
the normalized AIC computed at each node of the tree.
A higher value limits the height of the tree.</p>
</td></tr>
<tr><td><code id="CytomeTree_+3A_verbose">verbose</code></td>
<td>
<p>A logical controlling if a text progress bar is displayed 
during the execution of the algorithm. By default is TRUE.</p>
</td></tr>
<tr><td><code id="CytomeTree_+3A_force_first_markers">force_first_markers</code></td>
<td>
<p>a vector of index to split the data on first.
This argument is used in the semi-supervised setting, forcing the algorithm to consider 
those markers first, in the order they appear in this <code>force_first_markers</code> vector, 
and forcing the split at every node. Default is <code>NULL</code>, in which case
the clustering algorithm is unsupervised.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is based on the construction of a binary tree,
the nodes of which are subpopulations of cells. At each node,
observed cells and markers are modeled by both a family of normal
distributions and a family of bi-modal normal mixture distributions.
Splitting is done according to a normalized difference of AIC between
the two families.
</p>


<h3>Value</h3>

<p>An object of class 'cytomeTree' providing a partitioning
of the set of n cells.
</p>

<ul>
<li><p><code>annotation</code> A <code>data.frame</code> containing the annotation of each 
cell population underlying the tree pattern.
</p>
</li>
<li><p><code>labels</code> The partitioning of the set of n cells.
</p>
</li>
<li><p><code>M</code> The input matrix.
</p>
</li>
<li><p><code>mark_tree</code> A two level list containing markers used
for node splitting.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Chariff Alkhassim, Boris Hejblum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(DLBCL)

# number of cell event
N &lt;- nrow(DLBCL)

# Cell events
cellevents &lt;- DLBCL[, c("FL1", "FL2", "FL4")]


# Manual partitioning of the set N (from FlowCAP-I)
manual_labels &lt;- DLBCL[, "label"]


# Build the binary tree
Tree &lt;- CytomeTree(cellevents, minleaf = 1, t=.1)


# Retreive the resulting partition of the set N
Tree_Partition &lt;- Tree$labels


# Plot node distributions
par(mfrow=c(1, 2))
plot_nodes(Tree)

# Choose a node to plot
plot_nodes(Tree,"FL4.1")

# Plot a graph of the tree
par(mfrow=c(1,1))
plot_graph(Tree,edge.arrow.size=.3, Vcex =.5, vertex.size = 30)

# Run the annotation algorithm
Annot &lt;- Annotation(Tree,plot=FALSE)
Annot$combinations


# Compare to the annotation gotten from the tree
Tree$annotation


# Example of sought phenotypes
# Variable in which sought phenotypes can be entered in the form of matrices.
phenotypes &lt;- list()

# Sought phenotypes:
## FL2+ FL4-.
phenotypes[[1]] &lt;- rbind(c("FL2", 1), c("FL4", 0))

## FL2- FL4+.
phenotypes[[2]] &lt;- rbind(c("FL2", 0), c("FL4", 1))

## FL2+ FL4+.
phenotypes[[3]] &lt;- rbind(c("FL2", 1), c("FL4", 1))

# Retreive cell populations found using Annotation.
PhenoInfos &lt;- RetrievePops(Annot, phenotypes)
PhenoInfos$phenotypesinfo

# F-measure ignoring cells labeled 0 as in FlowCAP-I.

# Use FmeasureC() in any other case.
FmeasureC_no0(ref=manual_labels, pred=Tree_Partition)



if(interactive()){

# Scatterplots.
library(ggplot2)

# Ignoring cells labeled 0 as in FlowCAP-I.
rm_zeros &lt;- which(!manual_labels)

# Building the data frame to scatter plot the data.
FL1 &lt;- cellevents[-c(rm_zeros),"FL1"]
FL2 &lt;- cellevents[-c(rm_zeros),"FL2"]
FL4 &lt;- cellevents[-c(rm_zeros),"FL4"]
n &lt;- length(FL1)
Labels &lt;- c(manual_labels[-c(rm_zeros)]%%2+1, Tree_Partition[-c(rm_zeros)])
Labels &lt;- as.factor(Labels)
method &lt;- as.factor(c(rep("FlowCap-I",n),rep("CytomeTree",n)))

scatter_df &lt;- data.frame("FL2" = FL2, "FL4" = FL4, "labels" = Labels, "method" = method)
p &lt;- ggplot2::ggplot(scatter_df,  ggplot2::aes_string(x = "FL2", y = "FL4", colour = "labels")) +
 ggplot2::geom_point(alpha = 1,cex = 1) +
 ggplot2::scale_colour_manual(values = c("green","red","blue")) +
 ggplot2::facet_wrap(~ method) +
 ggplot2::theme_bw() +
 ggplot2::theme(legend.position="bottom")
p

}
</code></pre>

<hr>
<h2 id='DLBCL'>Diffuse large B-cell lymphoma data set from the FlowCAP-I challenge.</h2><span id='topic+DLBCL'></span>

<h3>Description</h3>

<p>Diffuse large B-cell lymphoma data set from the FlowCAP-I challenge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DLBCL)
</code></pre>


<h3>Format</h3>

<p>A data frame with 5524 cell events and 3 markers.</p>


<h3>Source</h3>

<p><a href="http://flowcap.flowsite.org/">http://flowcap.flowsite.org/</a>
</p>

<hr>
<h2 id='FmeasureC'>C++ implementation of the F-measure computation</h2><span id='topic+FmeasureC'></span>

<h3>Description</h3>

<p>C++ implementation of the F-measure computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FmeasureC(pred, ref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FmeasureC_+3A_pred">pred</code></td>
<td>
<p>vector of a predicted partition</p>
</td></tr>
<tr><td><code id="FmeasureC_+3A_ref">ref</code></td>
<td>
<p>vector of a reference partition</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Boris Hejblum
</p>

<hr>
<h2 id='FmeasureC_no0'>C++ implementation of the F-measure computation without the reference class labeled &quot;0&quot;</h2><span id='topic+FmeasureC_no0'></span>

<h3>Description</h3>

<p>Aghaeepour in FlowCAP 1 ignore the reference class labeled &quot;0&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FmeasureC_no0(pred, ref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FmeasureC_no0_+3A_pred">pred</code></td>
<td>
<p>vector of a predicted partition</p>
</td></tr>
<tr><td><code id="FmeasureC_no0_+3A_ref">ref</code></td>
<td>
<p>vector of a reference partition</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Boris Hejblum
</p>

<hr>
<h2 id='GaussMix'>Bi-modal normal mixture distribution.</h2><span id='topic+GaussMix'></span>

<h3>Description</h3>

<p>Bi-modal normal mixture distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussMix(x, mu1, mu2, sd1, sd2, pi1, pi2)
</code></pre>

<hr>
<h2 id='GaussMix2'>tri-modal normal mixture distribution.</h2><span id='topic+GaussMix2'></span>

<h3>Description</h3>

<p>tri-modal normal mixture distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussMix2(x, mu1, mu2, mu3, sd1, sd2, sd3, pi1, pi2, pi3)
</code></pre>

<hr>
<h2 id='HIPC'>HIPC T cell data set from HIPC program, patient 12828. The data was analyzed and gated by Stanford.</h2><span id='topic+HIPC'></span>

<h3>Description</h3>

<p>HIPC T cell data set from HIPC program, patient 12828. The data was analyzed and gated by Stanford.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HIPC)
</code></pre>


<h3>Format</h3>

<p>A data frame with 33992 cell events and 6 markers.</p>


<h3>Source</h3>

<p><a href="https://www.immuneprofiling.org/">https://www.immuneprofiling.org/</a> <a href="https://www.immunespace.org/">https://www.immunespace.org/</a> 
<a href="https://www.immunespace.org/project/HIPC/Lyoplate/begin.view?pageId=study.DATA_ANALYSIS">https://www.immunespace.org/project/HIPC/Lyoplate/begin.view?pageId=study.DATA_ANALYSIS</a>
</p>

<hr>
<h2 id='IMdata'>Influenza vaccine response dataset</h2><span id='topic+IMdata'></span>

<h3>Description</h3>

<p>A dataset containing 10,000 cells and 39 markers of mass cytometry subsampled
from the sample SUB116516.478 from the study SDY478 by Mark Davis 
retrieved from ImmuneSpace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(IMdata)
</code></pre>


<h3>Format</h3>

<p>A data frame with 10,000 rows and 39 variables:</p>


<h3>Source</h3>

<p><a href="https://www.immunespace.org/project/Studies/SDY478/begin.view?">https://www.immunespace.org/project/Studies/SDY478/begin.view?</a>
</p>

<hr>
<h2 id='KmeansOPT'>Finds the partition which minimize the within-leaves sum of squares.</h2><span id='topic+KmeansOPT'></span>

<h3>Description</h3>

<p>Finds the partition which minimize the within-leaves sum of squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KmeansOPT(groups, leaves, labels, dat, K)
</code></pre>

<hr>
<h2 id='LeavesCenters'>Computes means of leaves given cytomeTreeObj.</h2><span id='topic+LeavesCenters'></span>

<h3>Description</h3>

<p>Computes means of leaves given cytomeTreeObj.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LeavesCenters(cytomeTreeObj)
</code></pre>

<hr>
<h2 id='LeavesMedians'>Computes medians of leaves given cytomeTreeObj.</h2><span id='topic+LeavesMedians'></span>

<h3>Description</h3>

<p>Computes medians of leaves given cytomeTreeObj.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LeavesMedians(cytomeTreeObj)
</code></pre>

<hr>
<h2 id='Log10Transformation'>Data transformation using log10</h2><span id='topic+Log10Transformation'></span>

<h3>Description</h3>

<p>Data transformation using log10
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Log10Transformation(M, num_col, a = 1, b = 1)
</code></pre>

<hr>
<h2 id='Partition2gr'>Computes N-1 possible partitions of ordered N into 2 subsets.</h2><span id='topic+Partition2gr'></span>

<h3>Description</h3>

<p>Computes N-1 possible partitions of ordered N into 2 subsets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Partition2gr(N)
</code></pre>

<hr>
<h2 id='Partition3gr'>Computes (N-1)*(N-2) possible partitions of N into 3 subsets.</h2><span id='topic+Partition3gr'></span>

<h3>Description</h3>

<p>Computes (N-1)*(N-2) possible partitions of N into 3 subsets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Partition3gr(N)
</code></pre>

<hr>
<h2 id='plot_cytopop'>Plot the cell count for each population using CytomeTree.</h2><span id='topic+plot_cytopop'></span>

<h3>Description</h3>

<p>Plot the cell count for each population using CytomeTree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cytopop(
  AnnotObj,
  nbpop = 10,
  mincount = 1,
  maxcount = NULL,
  y_axis = c("abs_count", "prop")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cytopop_+3A_annotobj">AnnotObj</code></td>
<td>
<p>An object of class Annotation.</p>
</td></tr>
<tr><td><code id="plot_cytopop_+3A_nbpop">nbpop</code></td>
<td>
<p>Number indicating the maximum of population plotted.
Default is <code>10</code></p>
</td></tr>
<tr><td><code id="plot_cytopop_+3A_mincount">mincount</code></td>
<td>
<p>Number indicating the minimum of cell count
for the populations. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_cytopop_+3A_maxcount">maxcount</code></td>
<td>
<p>Number indicating the maximum of cell count
for the populations. Default is <code>NULL</code> i.e no maximum selected.</p>
</td></tr>
<tr><td><code id="plot_cytopop_+3A_y_axis">y_axis</code></td>
<td>
<p>a character string either <code>"abs_count"</code> or <code>"prop"</code> indicating 
whether the absolute cell count or the relative populations proportions should be plotted.
Default is <code>"abs_count"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Anthony Devaux, Boris Hejblum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Run CytomeTree
data(DLBCL)
cellevents &lt;- DLBCL[,c("FL1", "FL2", "FL4")]
Tree &lt;- CytomeTree(cellevents, minleaf = 1, t=.1)
Annot &lt;- Annotation(Tree,plot=FALSE)

# Plot the cell count
plot_cytopop(Annot)
</code></pre>

<hr>
<h2 id='plot_graph'>Plot the binary tree built using CytomeTree.</h2><span id='topic+plot_graph'></span>

<h3>Description</h3>

<p>Plot the binary tree built using CytomeTree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_graph(CytomeTreeObj, Ecex = 1, Ecolor = 8, Vcex = 0.8, Vcolor = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_graph_+3A_cytometreeobj">CytomeTreeObj</code></td>
<td>
<p>An object of class CytomeTree.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_ecex">Ecex</code></td>
<td>
<p>Number indicating the amount by which text
on the edges should be scaled. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_ecolor">Ecolor</code></td>
<td>
<p>An integer or a string of character
to color edges of the graph.  Default is <code>8</code>.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_vcex">Vcex</code></td>
<td>
<p>Number indicating the amount by which text
in the vertices should be scaled.  Default is <code>.8</code>.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_vcolor">Vcolor</code></td>
<td>
<p>A vector of class numeric or character to color
vertices of the graph. Default is <code>0</code>.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="#topic+plot_graph">plot_graph</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chariff Alkhassim
</p>

<hr>
<h2 id='plot_nodes'>Plot the distribution of the observed cells at each node 
of the binary tree built using CytomeTree.</h2><span id='topic+plot_nodes'></span>

<h3>Description</h3>

<p>Plot the distribution of the observed cells at each node 
of the binary tree built using CytomeTree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_nodes(
  CytomeTreeObj,
  nodes = NULL,
  nodesPerCol = NULL,
  nodesPerRow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_nodes_+3A_cytometreeobj">CytomeTreeObj</code></td>
<td>
<p>An object of class CytomeTree.</p>
</td></tr>
<tr><td><code id="plot_nodes_+3A_nodes">nodes</code></td>
<td>
<p>A list of character elements containing the name of
the nodes for which the distribution is to be plotted. Default is 
<code>NULL</code>, and plots the distribution for each node.</p>
</td></tr>
<tr><td><code id="plot_nodes_+3A_nodespercol">nodesPerCol</code></td>
<td>
<p>an integer specifying the number of plots to be
displayed per column when plotting multiple nodes at once. Default is 
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_nodes_+3A_nodesperrow">nodesPerRow</code></td>
<td>
<p>an integer specifying the number of plots to be
displayed per row when plotting multiple nodes at once. Default is 
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_nodes_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="cowplot.html#topic+plot_grid">plot_grid</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if both <code>nodesPerCol</code> and <code>nodesPerRow</code> are <code>NULL</code>
then all the nodes are plotted on a single page.
</p>


<h3>Value</h3>

<p>a list of <code>ggplot2</code> plot objects, containing each node plot.
</p>


<h3>Author(s)</h3>

<p>Chariff Alkhassim, Boris Hejblum
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(DLBCL)
myct &lt;- CytomeTree(DLBCL[, c("FL1", "FL2", "FL4")], minleaf = 1, t=.1)
plot_nodes(myct)

</code></pre>

<hr>
<h2 id='RetrievePops'>Retrieve cell populations found using Annotation.</h2><span id='topic+RetrievePops'></span>

<h3>Description</h3>

<p>Retrieve cell populations found using Annotation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RetrievePops(AnnotationObj, phenotypes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RetrievePops_+3A_annotationobj">AnnotationObj</code></td>
<td>
<p>An object of class Annotation.</p>
</td></tr>
<tr><td><code id="RetrievePops_+3A_phenotypes">phenotypes</code></td>
<td>
<p>A list containing at least one element of class 
matrix describing a sought phenotype. Each matrix should have two
columns where the name of a used marker is associated to a value
chosen between 0, 1 and 2. 0 translates to -, 1 to + and 2 to ++.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of two elements.
</p>

<ul>
<li><p><code>phenotypesinfo</code> A <code>list</code> containing informations 
about sought populations.
</p>
</li>
<li><p><code>Mergedleaves</code> The partitioning of the set of n cells
with potentially merged leaves.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Chariff Alkhassim, Boris Hejblum
</p>

<hr>
<h2 id='TreeAnnot'>Returns the underlying annotation given a tree pattern.</h2><span id='topic+TreeAnnot'></span>

<h3>Description</h3>

<p>Returns the underlying annotation given a tree pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TreeAnnot(labels, combinaisons)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
