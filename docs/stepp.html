<!DOCTYPE html><html><head><title>Help for package stepp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stepp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyze.CumInc.stepp'>
<p>Analyze competing risks data using Cumulative Incidence method</p></a></li>
<li><a href='#analyze.KM.stepp'>
<p>Analyze survival data using Kaplan-Meier method</p></a></li>
<li><a href='#aspirin'>
<p>The aspirin data set.</p></a></li>
<li><a href='#balance_example'>
<p>Sample data to use with the <code>balance_patients()</code> function.</p></a></li>
<li><a href='#balance_patients'>
<p>Utility function for determining the optimal values for generating the subpopulations.</p></a></li>
<li><a href='#bigCI'>
<p>The BIG 1-98 trial dataset for cumulative incidence STEPP.</p></a></li>
<li><a href='#bigKM'>
<p>The BIG 1-98 trial dataset for Kaplan-Meier STEPP.</p></a></li>
<li><a href='#estimate'>
<p>The standard generic function for all estimate methods</p></a></li>
<li><a href='#gen.tailwin'>
<p>Utility function to generate tail-oriented window</p></a></li>
<li><a href='#generate'>
<p>The standard generic function for the generate method in stsubpop class</p></a></li>
<li><a href='#simdataKM'>
<p>Simulated data for Kaplan-Meier STEPP analysis.</p></a></li>
<li><a href='#stepp'>
<p>Analyze survival or competing risks data</p></a></li>
<li><a href='#stepp_plot'>
<p>A function to generate the stepp plots</p></a></li>
<li><a href='#stepp_print'>
<p>The function to print the estimate, covariance matrices and test statistics.</p></a></li>
<li><a href='#stepp_summary'>
<p>The function to produce a summary of the size and various attributes of each subpopulation</p></a></li>
<li><a href='#stepp.CI'>
<p>The constructor to create the stmodelCI object</p></a></li>
<li><a href='#stepp.edge'>
<p>The method performs an edge analysis on the STEPP GLM model estimate objects.</p></a></li>
<li><a href='#stepp.GLM'>
<p>The constructor to create the stmodelGLM object</p></a></li>
<li><a href='#stepp.KM'>
<p>The constructor to create the stmodelKM object</p></a></li>
<li><a href='#stepp.rnote'>
<p>The method to print the release note for STEPP.</p></a></li>
<li><a href='#stepp.subpop'>
<p>The constructor to create the stsubpop object and generate the subpopulations based on the</p>
specified stepp window and covariate of interest</a></li>
<li><a href='#stepp.test'>
<p>The constructor to generate a complete steppes object with effect estimates and test statistics</p></a></li>
<li><a href='#stepp.win'>
<p>The constructor to create the stepp window object</p></a></li>
<li><a href='#steppes-class'><p>Class <code>"steppes"</code></p></a></li>
<li><a href='#stmodel-class'><p>Class <code>"stmodel"</code></p></a></li>
<li><a href='#stmodelCI-class'><p>Class <code>"stmodelCI"</code></p></a></li>
<li><a href='#stmodelGLM-class'><p>Class <code>"stmodelGLM"</code></p></a></li>
<li><a href='#stmodelKM-class'><p>Class <code>"stmodelKM"</code></p></a></li>
<li><a href='#stsubpop-class'><p>Class <code>"stsubpop"</code></p></a></li>
<li><a href='#stwin-class'><p>Class <code>"stwin"</code></p></a></li>
<li><a href='#test'>
<p>the standard generic function for all test methods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Subpopulation Treatment Effect Pattern Plot (STEPP)</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Wai-ki Yip [aut, cre],
  Ann Lazar [ctb],
  David Zahrieh [ctb],
  Chip Cole [ctb],
  Ann Lazar [ctb],
  Marco Bonetti [ctb],
  Victoria Wang [ctb],
  William Barcella [ctb],
  Sergio Venturini [aut]
  Richard Gelber [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wai-ki Yip &lt;yuser86@yahoo.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>rstudioapi, scales</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, car, survival, splines</td>
</tr>
<tr>
<td>Collate:</td>
<td>'zzz.R' 'utility.R' 'stutil.R' 'stwin.R' 'stsubpop.R'
'stmodelKM.R' 'stmodelCI.R' 'stmodelGLM.R' 'stmodel.R'
'steppes.R' 'stepp.R'</td>
</tr>
<tr>
<td>Description:</td>
<td>A method to explore the treatment-covariate interactions in survival or generalized 
	linear model (GLM) for continuous, binomial and count data arising from two or more treatment 
	arms of a clinical trial. A permutation distribution approach to inference is implemented, 
	based on permuting the covariate values within each treatment group.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-17 21:48:34 UTC; wkyip</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-18 04:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyze.CumInc.stepp'>
Analyze competing risks data using Cumulative Incidence method
</h2><span id='topic+analyze.CumInc.stepp'></span>

<h3>Description</h3>

<p>This method will be deprecated in the future.  Please use the constructor function stepp.CI to
create a STEPP Cumulative Incidence model for future development.
</p>
<p>A method to explore the treatment-effect interactions in competing risks data arising 
from two treatment arms of a clinical trial. A permutation distribution approach to inference 
is implemented that permutes covariate values within a treatment group. 
The statistical significance of observed heterogeneity of treatment effects is calculated using 
permutation tests: 1) for the maximum difference between each subpopulation effect and the overall
population treatment effect or supremum based test statistic; 2) for the difference between each
subpopulation effect and the overall population treatment effect, which resembles the chi-square statistic. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  analyze.CumInc.stepp(coltrt, coltime, coltype, covar, trts, patspop, minpatspop, 
    timest, noperm=2500, ncex = 0.7, legendy = 30, pline = -2.5, 
    color = c("red", "black"), 
    xlabel = "Subpopulations by Median Covariate", 
    ylabel = "?-year Disease-Free Survival", 
    tlegend = c("1st Treatment", "2nd Treatment"),  
    nlas = 3, pointwise = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.CumInc.stepp_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_coltime">coltime</code></td>
<td>
<p>the time to event variable</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_coltype">coltype</code></td>
<td>
<p>variable with distinct codes for different causes of failure where coltype=0 for censored observations; coltype=1 for event of interest; coltype=2 for other causes of failure</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_covar">covar</code></td>
<td>
<p>the covariate of interest</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment arms, 1st and 2nd treatment arms, respectively</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_patspop">patspop</code></td>
<td>
<p>larger parameter(r2) for subpopulation construction that determines how many patients are in each subpopulation</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_minpatspop">minpatspop</code></td>
<td>
<p>smaller parameter(r1) for subpopulation construction that determines the largest number of patients in common among consecutive subpopulations</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_timest">timest</code></td>
<td>
<p>timepoint to estimate survival</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_noperm">noperm</code></td>
<td>
<p>the desired number of permutations; must be 0 or above</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_ncex">ncex</code></td>
<td>
<p>optional - specify the size of the text for the sample size annotation, that is, the character expansion factor</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_legendy">legendy</code></td>
<td>
<p>optional - the vertical location of the legend according to the units on the y-axis</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_pline">pline</code></td>
<td>
<p>optional - specify the vertical location of the p-value, that is, on which margin line, starting at 0 counting outwards</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_color">color</code></td>
<td>
<p>optional - a vector containing the line colors for the 1st and 2nd treatment, respectively</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_ylabel">ylabel</code></td>
<td>
<p>optional - specify the label for the y-axis</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_xlabel">xlabel</code></td>
<td>
<p>optional - specify the label for the x-axis</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_tlegend">tlegend</code></td>
<td>
<p>optional - a vector containing the treatment labels, 1st and 2nd treatment, respectively</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_nlas">nlas</code></td>
<td>
<p>optional - specify the las parameter (0,1,2,3) to determine the orientation of the sample size annotation</p>
</td></tr>
<tr><td><code id="analyze.CumInc.stepp_+3A_pointwise">pointwise</code></td>
<td>
<p>optional -specify pointwise confidence intervals (pointwise=TRUE), or confidence bands (pointwise=FALSE, default) to be displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical method to explore treatment by covariate interactions in competing risks data arising from two 
treatment arms of a clinical trial. The method is based on constructing overlapping subpopulations 
of patients with respect to a covariate of interest, and in observing the pattern of the treatment 
effects estimated across subpopulations. A plot of these treatment effects is called STEPP, or 
Subpopulation Treatment Effect Pattern Plot. STEPP uses the permutation distribution based approach
for inference.
</p>
<p>One can explore the window parameters without invoking the permutation analysis by setting noperm 
to 0.  In that case, pvalue and the covarance matrix will not be available.
</p>
<p>We acknowledge Robert J. Gray for permitting us to use the cmprsk package.
</p>


<h3>Value</h3>

<p>analyze.CumInc.stepp generates a Subpopulation Treatment Effect Pattern Plot (STEPP) displaying 
the p-value from the test for interaction. Descriptive summaries of the dataset and the estimated 
variance-covariance matrix are returned through the steppes object. See documentation on steppes 
object for details on how you can use it. 
</p>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>
<p>A few tips to keep in mind:
</p>
<p>The variables coltrt, coltime, coltype, and covar must be numeric. No formatting allowed.
</p>
<p>If you receive the error &quot;Error in solve.default(sigma): system is computationally singular; reciprocal condition number = 0&quot; then we recommend changing the seed by re-running analyze.KM.stepp. If this error persists after several runs, then the program cannot provide reliable results. Please try modifying your choices of the two parameters minpatspop(r1) and patspop(r2) that define the subpopulation.
</p>
<p>The number of permutations specified in noperm, the sample size, and the number of subpopulations generated will affect how long analyze.CumInc.stepp takes to execute. The results are stable if 2500 or more permutations are specified. Furthermore, varying the number of subpopulations will affect inference.
</p>
<p>The time point selected to estimate survival in timest must be in the same units (e.g., months) as the coltime variable.
</p>
<p>The order of the treatments in the vector trts must be in the same order in the vector tlegend. 
</p>


<h3>Note</h3>

<p>STEPP is an exploratory tool, with graphical features that make it easy for clinicians to interpret 
the results of the analysis. Positive results should prompt the need 
for confirmation from other datasets investigating similar treatment comparisons. It should also be 
clear that STEPP is not meant to estimate specific cutpoints in the range of values of the covariate 
of interest, but rather to provide some indication on ranges of values where treatment effect might 
have a particular behavior.
</p>
<p>STEPP considers the case in which the subpopulations are constructed according to a sliding window 
pattern. The larger parameter (patspop) determines how many patients are in each subpopulation, and 
the smaller parameter (minpatspop) determines the largest number of patients in common among 
consecutive subpopulations. A minimum of 80-100 patients should be in each subpopulation, 
but that is not strictly necessary. The difference (patspop-minpatspop) is the approximate number of 
patients replaced between any two subsequent subpopulations, and can be used to determine the number 
of subpopulations once patspop is fixed. The choice of the values of the parameters patspop and 
minpatspop to be used does change the appearance of the plot and the corresponding p-value. It is 
probably reasonable to experiment with a few combinations to ensure that the significance (or lack 
of significance) is stable with respect to that choice.
</p>
<p>For best results, consider implementing 2500 permutations of the covariate (vector of subpopulations)
to obtain a rich distribution in which to draw inference. 
</p>


<h3>Author(s)</h3>

<p>Ann Lazar, Wai-ki Yip, David Zahrieh, Bernard Cole, Marco Bonetti, Richard Gelber
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>
<p>Lazar AA, Cole BF, Bonetti M, Gelber RD.  Evaluation of treatment-effect heterogeneity usiing biomarkers measured
on a continuous scale: subpopulation treatment effect pattern plot.  Journal of Clinical Oncology, 2010; 28(29): 4539-4544.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>, <code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.CI">stepp.CI</a></code>,                                         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>,
</p>
<p>Old functions to be deprecated: stepp, stepp_summary, stepp_print, stepp_plot, and analyze.KM.stepp. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE TREATMENT VARIABLE:
n &lt;- 1000		# set the sample size
mu &lt;- 0			# set the mean and sd of the covariate
sigma &lt;- 1

beta0 &lt;- log(-log(0.5)) # set the intercept for the log hazard
beta1 &lt;- -0.2		# set the slope on the covariate
beta2 &lt;- 0.5		# set the slope on the treatment indicator
beta3 &lt;- 0.7		# set the slope on the interaction

prob2 &lt;- 0.2		# set the proportion type 2 events
cprob &lt;- 0.3		# set the proportion censored

set.seed(7775432) 	# set the random number seed
covariate &lt;- rnorm(n,mean=mu,sd=sigma)	# generate the covariate values
Txassign &lt;- rbinom(n,1,0.5)		# generate the treatment indicator
x3 &lt;- covariate*Txassign		# compute interaction term
					# compute the hazard for type 1 event
lambda1 &lt;- exp(beta0+beta1*covariate+beta2*Txassign+beta3*x3)
lambda2 &lt;- prob2*lambda1/(1-prob2)	# compute the hazard for the type 2 event
					# compute the hazard for censoring time
lambda0 &lt;- cprob*(lambda1+lambda2)/(1-cprob)
t1 &lt;- rexp(n,rate=lambda1)		# generate the survival time for type 1 event
t2 &lt;- rexp(n,rate=lambda2)		# generate the survival time for type 2 event
t0 &lt;- rexp(n,rate=lambda0)		# generate the censoring time
time &lt;- pmin(t0,t1,t2)			# compute the observed survival time
type &lt;- rep(0,n)
type[(t1 &lt; t0)&amp;(t1 &lt; t2)] &lt;- 1
type[(t2 &lt; t0)&amp;(t2 &lt; t1)] &lt;- 2

# Call analyze.CumInc.stepp to analyze the data
# Warning: In this example, the permutations have been set to 0 to allow the stepp function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
analyze.CumInc.stepp(coltrt=Txassign, trts=c(0,1), coltime=time, coltype=type, covar=covariate,
  patspop=300, minpatspop=200, timest=1.0, noperm=0,
  ncex=0.70,legendy=30,pline=-2.5,color=c("red", "black"),
  xlabel="Subpopulations by Median Age",ylabel="4-year Cancer Relapse",
  tlegend=c("Treatment A", "Treatment B"), nlas=3,pointwise=FALSE)
</code></pre>

<hr>
<h2 id='analyze.KM.stepp'>
Analyze survival data using Kaplan-Meier method
</h2><span id='topic+analyze.KM.stepp'></span>

<h3>Description</h3>

<p>This method will be deprecated in the future.  Please use the constructor function stepp.KM to
create a STEPP Kaplan-Meier model for future development.
</p>
<p>A method to explore the treatment-covariate interactions in survival data arising 
from two treatment arms of a clinical trial. The treatment effects are measured using survival 
functions at a specified time point estimated from the Kaplan-Meier method and the hazard ratio 
based on observed-minus-expected estimation. A permutation distribution approach to inference 
is implemented, based on permuting the covariate values within each treatment group. 
The statistical significance of observed heterogeneity of treatment effects is calculated using 
permutation tests:<br /><br />
1) for the maximum difference between each subpopulation effect and the overall population 
treatment effect or supremum based test statistic; <br />
2) for the difference between each subpopulation effect and the overall population treatment 
effect, which resembles the chi-square statistic. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  analyze.KM.stepp(coltrt, coltime, colcens, covar, trts, patspop, minpatspop, 
    timest, noperm=2500, ncex = 0.7, legendy = 30, pline = -2.5, 
    color = c("red", "black"),
    xlabel = "Subpopulations by Median Covariate", 
    ylabel = "?-year Disease-Free Survival", 
    tlegend = c("1st Treatment", "2nd Treatment"), 
    nlas = 3, pointwise = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.KM.stepp_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_coltime">coltime</code></td>
<td>
<p>the time to event variable</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_colcens">colcens</code></td>
<td>
<p>the censoring variable</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_covar">covar</code></td>
<td>
<p>the covariate of interest</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment arms, 1st and 2nd treatment arms, respectively</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_patspop">patspop</code></td>
<td>
<p>larger parameter(r2) for subpopulation construction that determines how many patients are in each subpopulation</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_minpatspop">minpatspop</code></td>
<td>
<p>smaller parameter(r1) for subpopulation construction that determines the largest number of patients in common among consecutive subpopulations</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_timest">timest</code></td>
<td>
<p>timepoint to estimate survival</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_noperm">noperm</code></td>
<td>
<p>the desired number of permutations; must be 0 or above</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_ncex">ncex</code></td>
<td>
<p>optional - specify the size of the text for the sample size annotation, that is, the character expansion factor</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_legendy">legendy</code></td>
<td>
<p>optional - the vertical location of the legend according to the units on the y-axis</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_pline">pline</code></td>
<td>
<p>optional - specify the vertical location of the p-value, that is, on which margin line, starting at 0 counting outwards</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_color">color</code></td>
<td>
<p>optional - a vector containing the line colors for the 1st and 2nd treatment, respectively</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_ylabel">ylabel</code></td>
<td>
<p>optional - specify the label for the y-axis</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_xlabel">xlabel</code></td>
<td>
<p>optional - specify the label for the x-axis</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_tlegend">tlegend</code></td>
<td>
<p>optional - a vector containing the treatment labels, 1st and 2nd treatment, respectively</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_nlas">nlas</code></td>
<td>
<p>optional - specify the las parameter (0,1,2,3) to determine the orientation of the sample size annotation</p>
</td></tr>
<tr><td><code id="analyze.KM.stepp_+3A_pointwise">pointwise</code></td>
<td>
<p>optional -specify pointwise confidence intervals (pointwise=TRUE), or confidence bands (pointwise=FALSE, default) to be displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical method to explore treatment-covariate interactions in survival data arising from two 
treatment arms of a clinical trial. The method is based on constructing overlapping subpopulations 
of patients with respect to one covariate of interest, and in observing the pattern of the treatment 
effects estimated across subpopulations. A plot of these treatment effects is called STEPP, or 
Subpopulation Treatment Effect Pattern Plot. STEPP uses the permutation distribution based approach
for inference.
</p>
<p>One can explore the window parameters without invoking the permutation analysis by setting noperm 
to 0.  In that case, pvalue and the covarance matrix will not be available.
</p>


<h3>Value</h3>

<p>analyze.KM.stepp generates a Subpopulation Treatment Effect Pattern Plot (STEPP) displaying 
the p-value from the test for interaction. Descriptive summaries of the dataset and the estimated 
variance-covariance matrix are returned through the steppes object. See documentation on steppes 
object for details on how you can use it. 
</p>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>
<p>A few tips to keep in mind:
</p>
<p>The variables coltrt, coltime, colcens, and covar must be numeric. No formatting allowed.
</p>
<p>If you receive the error &quot;Error in solve.default(sigma): system is computationally singular; reciprocal condition number = 0&quot; then we recommend changing the seed by re-running analyze.KM.stepp. If this error persists after several runs, then the program cannot provide reliable results. Please try modifying your choices of the two parameters minpatspop(r1) and patspop(r2) that define the subpopulation.
</p>
<p>The number of permutations specified in noperm, the sample size, and the number of subpopulations generated will affect how long analyze.KM.stepp takes to execute. The results are stable if 2500 or more permutations are specified. Furthermore, varying the number of subpopulations will affect inference.
</p>
<p>The time point selected to estimate survival in timest must be in the same units (e.g., months) as the coltime variable.
</p>
<p>The order of the treatments in the vector trts must be in the same order in the vector tlegend. 
</p>


<h3>Note</h3>

<p>STEPP is an exploratory tool, with graphical features that make it easy for clinicians to interpret 
the results of the analysis. The method provides an opportunity to detect interactions other than 
those that may be apparent for example by using Cox models. Positive results should prompt the need 
for confirmation from other datasets investigating similar treatment comparisons. It should also be 
clear that STEPP is not meant to estimate specific cutpoints in the range of values of the covariate 
of interest, but rather to provide some indication on ranges of values where treatment effect might 
have a particular behavior.
</p>
<p>STEPP considers the case in which the subpopulations are constructed according to a sliding window 
pattern. The larger parameter (patspop) determines how many patients are in each subpopulation, and 
the smaller parameter (minpatspop) determines the largest number of patients in common among 
consecutive subpopulations. A minimum of 80-100 patients should probably be in each subpopulation, 
but that is not strictly necessary. The difference (patspop-minpatspop) is the approximate number of 
patients replaced between any two subsequent subpopulations, and can be used to determine the number 
of subpopulations once patspop is fixed. The choice of the values of the parameters patspop and 
minpatspop to be used does change the appearance of the plot and the corresponding p-value. It is 
probably reasonable to experiment with a few combinations to ensure that the significance (or lack 
of significance) is stable with respect to that choice.
</p>
<p>For best results, consider implementing 2500 permutations of the covariate (vector of subpopulations)
to obtain a rich distribution in which to draw inference. 
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip, David Zahrieh, Marco Bonetti, Bernard Cole, Ann Lazar, Richard Gelber
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>
<p>Old functions to be deprecated: stepp, stepp_summary, stepp_print, stepp_plot, and analyze.CumInc.stepp. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE TREATMENT VARIABLE:
N &lt;- 1000
Txassign &lt;- sample(c(1,2), N, replace=TRUE, prob=c(1/2, 1/2))
n1 &lt;- length(Txassign[Txassign==1])
n2 &lt;- N - n1
#GENERATE A COVARIATE:
covariate &lt;- rnorm(N, 55, 7)
#GENERATE SURVIVAL AND CENSORING VARIABLES ASSUMING A TREATMENT COVARIATE INTERACTION:
Entry &lt;- sort( runif(N, 0, 5) )
SurvT1 &lt;- .5
beta0 &lt;-  -65 / 75
beta1 &lt;- 2 / 75
Surv &lt;- rep(0, N)
lambda1 &lt;- -log(SurvT1) / 4
Surv[Txassign==1] &lt;- rexp(n1, lambda1)
Surv[Txassign==2] &lt;- rexp(n2, (lambda1*(beta0+beta1*covariate[Txassign==2])))
EventTimes &lt;- rep(0, N)
EventTimes &lt;- Entry + Surv
censor &lt;- rep(0, N)
time &lt;- rep(0,N)
for ( i in 1:N )
  {
   censor[i] &lt;- ifelse( EventTimes[i] &lt;= 7, 1, 0 )
   time[i] &lt;- ifelse( EventTimes[i] &lt; 7, Surv[i], 7 - Entry[i] ) 
  }

#CALL analyze.KM.stepp to analyze the data
# Warning: In this example, the permutations have been set to 0 to allow 
# the stepp function to finish in a short amount of time.  IT IS RECOMMEND
# TO USE AT LEAST 2500 PERMUTATIONS TO PROVIDE STABLE RESULTS.
output &lt;- analyze.KM.stepp ( coltrt=Txassign, coltime=time, 
  colcens=censor, covar=covariate, trts=c(1,2), patspop=300,
  minpatspop=200, timest=4, noperm=0, ncex=0.70, legendy=30,
  pline=-2.5, color=c("red", "black"),
  xlabel="Subpopulations by Median Age", ylabel="4-year Disease-Free Survival", 
  tlegend=c("Treatment A", "Treatment B"), nlas=3, pointwise=FALSE)
</code></pre>

<hr>
<h2 id='aspirin'>
The aspirin data set.
</h2><span id='topic+aspirin'></span>

<h3>Description</h3>

<p>The &quot;aspirin&quot; data set was obtained with permission from the Polyp Prevention Study Group. The data are from a randomized clinical trial
comparing two dosages of daily aspirin (81 mg or 325 mg/day) versus placebo for the prevention of colorectal adenomas among people having 
a prior history of these lesions.  The study randomized a total of 1,121 participants to the three treatment groups.  After an approximately 
three-year treatment period, 1,084 participants underwent follow-up colonoscopy. The primary endpoint of the trial was the occurrence of
one or more large-bowel adenomas.  Secondary endpoints included the occurrence of any advanced lesion (i.e., adenomas having high-risk 
characteristics or invasive cancer).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aspirin)</code></pre>


<h3>Format</h3>

<p>The data set has the following columns:
DOSE - Randomized aspirin dose (0=placebo);
AGE  - Age of the participant in years at baseline;
G    - Gender of the participant (M or F)
AD   - Occurrence of any adenoma at follow-up (0=no, 1=yes, .=missing);
AL   - Occurrence of any advanced lesion at follow-up(0=no, 1=yes, .=missing)
</p>


<h3>Source</h3>

<p>The Polyp Prevention Study Group is acknowledged for granting permission to use the data from 
the Aspirin/Folate Polyp Prevention study.
</p>


<h3>References</h3>

<p>Baron J, Cole BF, Sandler RS, et al (2003), &quot;A Randomized Trial of Aspirin to prevent Colorectal Adenomas.&quot; n engl j med 2003;234:891-9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aspirin)

# remove cases with missing data
aspirinc &lt;- aspirin[complete.cases(aspirin),]

# make a subset of patients with placebo and 81 mg
attach(aspirinc)
subset1  &lt;- DOSE == 0 | DOSE == 81
aspirin1 &lt;- aspirinc[subset1,]
detach(aspirinc)

# set up treatment assignment
trtA     &lt;- rep(0, dim(aspirin1)[1])
trtA[aspirin1[,"DOSE"] == 81] &lt;- 1

# STEPP analysis A: placebo vs. 81 mg aspirin
attach(aspirin1)
inc_win     &lt;- stepp.win(type="sliding", r1=30, r2=100)
inc_sp      &lt;- stepp.subpop(swin=inc_win, cov=AGE)

ADorLE      &lt;- as.numeric(AD==1 | AL==1)
modelA      &lt;- stepp.GLM(coltrt=trtA, trts=c(0,1), colY=ADorLE, glm="binomial")
# Warning: In this example, the permutations have been set to 50 to allow the function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
steppGLMA   &lt;- stepp.test(inc_sp, modelA, nperm=50)
summary(steppGLMA)
print(steppGLMA)
plot(steppGLMA, ncex=0.70, legendy=30,
	pline=-4.5, color=c("red","black"),
	xlabel="Subpopulations by Median Age", ylabel="Risk",
	tlegend=c("Placebo", "81 mg aspirin"), nlas=3, pointwise=FALSE, noyscale=TRUE, rug=FALSE)

detach(aspirin1)
</code></pre>

<hr>
<h2 id='balance_example'>
Sample data to use with the <code>balance_patients()</code> function.
</h2><span id='topic+balance_example'></span>

<h3>Description</h3>

<p>A sample data set containing a single column which is used to show the usage of the <code>balance_patients()</code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(balance_example)</code></pre>


<h3>Format</h3>

<p>There is only one numeric column:
covar (continuous covariate).
</p>


<h3>References</h3>

<p>Lazar A, Cole B, Bonetti M, Gelber R (2010), &quot;Evaluation of treatment-effect heterogeneity using biomarkers measured on a continuous scale: subpopulation treatment effect pattern plot.&quot;
J Clin Oncol, 28(29), 4539-44.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+balance_patients">balance_patients</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(balance_example, package = "stepp")
ranger2 &lt;- c(950, 1050)
ranger1 &lt;- c(300, 500)
maxnsubpops &lt;- 50

res_bal &lt;- balance_patients(ranger1, ranger2, maxnsubpops, balance_example$covar,
  plot = TRUE, verbose = TRUE, contour = TRUE, nlevels = 6)

## End(Not run)
</code></pre>

<hr>
<h2 id='balance_patients'>
Utility function for determining the optimal values for generating the subpopulations.
</h2><span id='topic+balance_patients'></span>

<h3>Description</h3>

<p>Utility function for determining the optimal values of the number of subpopulations and the corresponding r1 and r2
values for creating subpopulations with the sliding window approach. The optimal values are those that make the
subpopulations more balanced by minimizing the variance of the subpopulation sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  balance_patients(range.r1, range.r2, maxnsubpops, covar, verbose = FALSE,
    plot = FALSE, contour = FALSE, nlevels = 5, showstatus = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="balance_patients_+3A_range.r1">range.r1</code></td>
<td>
<p>numeric vector with two elements providing the range of values for the r1 parameter</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_range.r2">range.r2</code></td>
<td>
<p>numeric vector with two elements providing the range of values for the r2 parameter</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_maxnsubpops">maxnsubpops</code></td>
<td>
<p>length-one numeric vector providing the maximum number of subpopulations to consider</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_covar">covar</code></td>
<td>
<p>numeric vector containing the covariate values to use for generating the subpopulations</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_verbose">verbose</code></td>
<td>
<p>length-one logical vector; if <code>TRUE</code> prints a summary of the results in the console</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_plot">plot</code></td>
<td>
<p>length-one logical vector; if <code>TRUE</code> produces a diagram showing the results of the calculations</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_contour">contour</code></td>
<td>
<p>length-one logical vector; if <code>TRUE</code> adds to the plot the variance contour lines for each
subpopulation number</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_nlevels">nlevels</code></td>
<td>
<p>length-one numeric vector providing the number of contour lines to plot</p>
</td></tr>
<tr><td><code id="balance_patients_+3A_showstatus">showstatus</code></td>
<td>
<p>length-one logical vector; if <code>TRUE</code> displays a bar showing the progress of the calculations; default is TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>balance_patients()</code> function returns a list with the following items:
</p>
<table>
<tr><td><code>r1_best</code></td>
<td>
<p>length-one numeric vector with overall best value of the r1 parameter</p>
</td></tr>
<tr><td><code>r2_best</code></td>
<td>
<p>length-one numeric vector with overall best value of the r2 parameter</p>
</td></tr>
<tr><td><code>var_best</code></td>
<td>
<p>length-one numeric vector with overall minimum value of the sizes variance</p>
</td></tr>
<tr><td><code>nsubpops_best</code></td>
<td>
<p>length-one numeric vector with overall best value for the number of subpopulations</p>
</td></tr>
<tr><td><code>all_res</code></td>
<td>
<p>numeric matrix with the details of all the calculations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Bonetti, Sergio Venturini
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>
<p>Lazar AA, Cole BF, Bonetti M, Gelber RD.  Evaluation of treatment-effect heterogeneity using biomarkers measured on a
continuous scale: subpopulation treatment effect pattern plot.  Journal of Clinical Oncology, 2010; 28(29): 4539-4544.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(balance_example, package = "stepp")
ranger2 &lt;- c(950, 1050)
ranger1 &lt;- c(300, 500)
maxnsubpops &lt;- 50

res_bal &lt;- balance_patients(ranger1, ranger2, maxnsubpops, balance_example$covar,
  plot = TRUE, verbose = TRUE, contour = TRUE, nlevels = 6)

## End(Not run)
</code></pre>

<hr>
<h2 id='bigCI'>
The BIG 1-98 trial dataset for cumulative incidence STEPP.
</h2><span id='topic+bigCI'></span>

<h3>Description</h3>

<p>This data set contains 2,685 patients in the Breast International Group (BIG) 1-98 randomized clinical trial.  The BIG 1-98 is a Phase III
clinical trial of 8,010 post menopausal women with hormone-receptor-positive early invasive breast cancer who were randomly assigned adjuvant
therapy of letrozole or tamoxifen.  Patterns of treatment effects for varying levels of the biomarker Ki-67 labeling index, a measure of 
cell proliferation, were analyzed using STEPP.  The STEPP analysis showed that letrozole was more effective than tamoxifen for patients with 
tumors expressing the highest levels of the Ki-67 labeling index.  The two treatment arms are letrozole and tamoxifen. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bigCI)</code></pre>


<h3>Format</h3>

<p>There are four columns of numeric values: 
trt (treatment group),
time (time to event),
event (competing event types), and
ki67 (continuous measurement of biomarker Ki-67).
</p>


<h3>Source</h3>

<p>The Breast International Group (BIG) 1-98 Steering Committee and the International Breast Cancer Study Group (IBCSG) are acknowledged for 
permission to use the data from the BIG 1-98 trial.
</p>


<h3>References</h3>

<p>Lazar A, Cole B, Bonetti M, Gelber R (2010), &quot;Evaluation of treatment-effect heterogeneity using biomarkers measured on a continuous scale: subpopulation treatment effect pattern plot.&quot;
J Clin Oncol, 28(29), 4539-44.
</p>
<p>Viale G et al (2008), &quot;Prognostic and predictive value of cnetrally reviewed Ki-67 labeling index in postmenopausal women with endocrine-responsive breast cancer:
results from Breast International Group Trial 1-98 comparing adjuvant tamoxifen and letrozole.&quot; J Clin Oncol, 28(34), 5569-75.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bigCI)

rxgroup &lt;- bigCI$trt
time    &lt;- bigCI$time
evt     &lt;- bigCI$event
cov     &lt;- bigCI$ki67

# analyze using Cumulative Incidence method with
# sliding window size of 150 patients and a maximum of 50 patients in common
#
swin    &lt;- new("stwin", type="sliding", r1=50, r2=150) # create a sliding window
subp    &lt;- new("stsubpop")                             # create subpopulation object
subp    &lt;- generate(subp, win=swin, covariate=cov) # generate the subpopulations
summary(subp)					   # summary of the subpopulations

# create a stepp model using Cumulative Incidences to analyze the data
#
smodel  &lt;- new("stmodelCI", coltrt=rxgroup, trts=c(1,2), coltime=time, coltype=evt, timePoint=4)

statCI  &lt;- new("steppes")		  # create a test object based on subpopulation and window
statCI  &lt;- estimate(statCI, subp, smodel) # estimate the subpopulation results
# Warning: In this example, the permutations have been set to 0 to allow the function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
statCI  &lt;- test(statCI, nperm=0)       # permutation test with 0 iterations

print(statCI)				  # print the estimates and test statistics
plot(statCI, ncex=0.65, legendy=30, pline=-15.5, color=c("blue","gold"),
        pointwise=FALSE, 
        xlabel="Median Ki-67 LI in Subpopulation (% immunoreactivity)",
        ylabel="4-year Cumulative Incidence", 
        tlegend=c("Letrozole", "Tamoxifen"), nlas=3)

</code></pre>

<hr>
<h2 id='bigKM'>
The BIG 1-98 trial dataset for Kaplan-Meier STEPP.
</h2><span id='topic+bigKM'></span>

<h3>Description</h3>

<p>This data set contains 2,685 patients in the Breast International Group (BIG) 1-98 randomized clinical trial.  The BIG 1-98 is a Phase III
clinical trial of 8,010 post menopausal women with hormone-receptor-positive early invasive breast cancer who were randomly assigned adjuvant
therapy of letrozole or tamoxifen.  Patterns of treatment effects for varying levels of the biomarker Ki-67 labeling index, a measure of 
cell proliferation, were analyzed using STEPP.  The STEPP analysis showed that letrozole was more effective than tamoxifen for patients with 
tumors expressing the highest levels of the Ki-67 labeling index.  The two treatment arms are letrozole and tamoxifen. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bigKM)</code></pre>


<h3>Format</h3>

<p>There are four columns of numeric values: 
trt (treatment group),
time (time to event),
event (competing event types), and
ki67 (continuous measurement of biomarker Ki-67).
</p>


<h3>Source</h3>

<p>The Breast International Group (BIG) 1-98 Steering Committee and the International Breast Cancer Study Group (IBCSG) are acknowledged for 
permission to use the data from the BIG 1-98 trial.
</p>


<h3>References</h3>

<p>Lazar A, Cole B, Bonetti M, Gelber R (2010), &quot;Evaluation of treatment-effect heterogeneity using biomarkers measured on a continuous scale: subpopulation treatment effect pattern plot.&quot;
J Clin Oncol, 28(29), 4539-44.
</p>
<p>Viale G et al (2008), &quot;Prognostic and predictive value of cnetrally reviewed Ki-67 labeling index in postmenopausal women with endocrine-responsive breast cancer:
results from Breast International Group Trial 1-98 comparing adjuvant tamoxifen and letrozole.&quot; J Clin Oncol, 28(34), 5569-75.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bigKM)

rxgroup &lt;- bigKM$trt
time    &lt;- bigKM$time
evt     &lt;- bigKM$event
cov     &lt;- bigKM$ki67

# analyze using Cumulative Incidence method with
# sliding window size of 150 patients and a maximum of 50 patients in common
#
swin    &lt;- new("stwin", type="sliding", r1=50, r2=150) # create a sliding window
subp    &lt;- new("stsubpop")                             # create subpopulation object
subp    &lt;- generate(subp, win=swin, covariate=cov) # generate the subpopulations
summary(subp)					   # summary of the subpopulations

# create a stepp model using Kaplan Meier Method to analyze the data
#
smodel  &lt;- new("stmodelKM", coltrt=rxgroup, trts=c(1,2), survTime=time, censor=evt, timePoint=4)

statKM  &lt;- new("steppes")		  # create a test object based on subpopulation and window
statKM  &lt;- estimate(statKM, subp, smodel) # estimate the subpopulation results
# Warning: In this example, the permutations have been set to 0 to allow the function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
statKM  &lt;- test(statKM, nperm=0)       # permutation test with 0 iterations

print(statKM)				  # print the estimates and test statistics
plot(statKM, ncex=0.65, legendy=30, pline=-15.5, color=c("blue","gold"),
        pointwise=FALSE, 
        xlabel="Median Ki-67 LI in Subpopulation (% immunoreactivity)",
        ylabel="4-year Disease Free Survival", 
        tlegend=c("Letrozole", "Tamoxifen"), nlas=3)



	
</code></pre>

<hr>
<h2 id='estimate'>
The standard generic function for all estimate methods
</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p>The default generic function for estimate methods for all stepp models classes and the steppes class.
</p>
<p>For detail, please refer to the documentation in the estimate method in the S4 class: steppes.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+generate">generate</a></code>
</p>

<hr>
<h2 id='gen.tailwin'>
Utility function to generate tail-oriented window 
</h2><span id='topic+gen.tailwin'></span>

<h3>Description</h3>

<p>Utility function to generate tail-oriented windows inputs given the approximate number of subpopulations
desired. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gen.tailwin(covariate, nsub, dir="LE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.tailwin_+3A_covariate">covariate</code></td>
<td>
<p>covariate values</p>
</td></tr>
<tr><td><code id="gen.tailwin_+3A_nsub">nsub</code></td>
<td>
<p>number of tail-oriented subpopulations to be generated</p>
</td></tr>
<tr><td><code id="gen.tailwin_+3A_dir">dir</code></td>
<td>
<p>&quot;LE&quot; (default) or &quot;GE&quot; - subpopulations with covariate values less than or equal/greater than or equal 
to the generated values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this together with the constructor, stepp.win, to generate tail-oriented windows.
</p>


<h3>Value</h3>

<p>It returns a list with fields: $v - vector of covariate values to be used in the constructor stepp.win. 
$np - vector of subpopulation size associate with each tail-oriented window defined by $v.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,  <code><a href="#topic+stepp.win">stepp.win</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bigKM)

rxgroup &lt;- bigKM$trt
time    &lt;- bigKM$time
evt     &lt;- bigKM$event
cov     &lt;- bigKM$ki67

# analyze using Kaplan-Meier method with tail-oriented window
#
nsubpop_tmp &lt;- 10
win_tmp &lt;- gen.tailwin(cov, nsub = nsubpop_tmp, dir = "LE")
nsubpop &lt;- length(win_tmp$v)
# create a tail-oriented window
swin &lt;- new("stwin", type = "tail-oriented", r1 = win_tmp$v, r2 = rep(min(cov), nsubpop))
subp &lt;- new("stsubpop")                             # create subpopulation object
subp &lt;- generate(subp, win = swin, covariate = cov) # generate the subpopulations
summary(subp)                             # summary of the subpopulations

# create a stepp model using Kaplan Meier Method to analyze the data
#
smodel  &lt;- new("stmodelKM", coltrt=rxgroup, trts=c(1,2), survTime=time, censor=evt, timePoint=4)

statKM  &lt;- new("steppes")     # create a test object based on subpopulation and window
statKM  &lt;- estimate(statKM, subp, smodel) # estimate the subpopulation results
# Warning: IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO  PROVIDE STABLE RESULTS.
statKM &lt;- test(statKM, nperm = 10)       # permutation test with 10 iterations

print(statKM)         # print the estimates and test statistics
plot(statKM, ncex=0.65, legendy=30, pline=-15.5, color=c("blue","gold"),
     pointwise=FALSE, 
     xlabel="Median Ki-67 LI in Subpopulation (% immunoreactivity)",
     ylabel="4-year Disease Free Survival", 
     tlegend=c("Letrozole", "Tamoxifen"), nlas=3)
</code></pre>

<hr>
<h2 id='generate'>
The standard generic function for the generate method in stsubpop class
</h2><span id='topic+generate'></span>

<h3>Description</h3>

<p>The default generic function for the generate method for stsubpop class.
</p>
<p>For detail, please refer to the documentation in the generate method in the S4 class: stsubpop.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>
</p>

<hr>
<h2 id='simdataKM'>
Simulated data for Kaplan-Meier STEPP analysis.
</h2><span id='topic+simdataKM'></span>

<h3>Description</h3>

<p>Simulated data to use in a Kaplan-Meier STEPP analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdataKM)</code></pre>


<h3>Format</h3>


<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> object with columns:
</p>

<dl>
<dt>time</dt><dd><p>time-to-event data</p>
</dd>
<dt>censor</dt><dd><p>censoring indicator</p>
</dd>
<dt>trt</dt><dd><p>treatment indicator</p>
</dd>
<dt>covar</dt><dd><p>covariate values</p>
</dd>
</dl>




<h3>Examples</h3>

<pre><code class='language-R'>### the following code generates the data in the object ###

set.seed(101)
n &lt;- 1000

# generate the treatment indicator
Txassign &lt;- sample(c(1, 2), n, replace = TRUE, prob = rep(.5, 2))
n1 &lt;- sum(Txassign == 1)
n2 &lt;- n - n1

# generate the covariate values
mean_cov &lt;- 55
sd_cov &lt;- 7
covariate &lt;- rnorm(n, mean = mean_cov, sd = sd_cov)

# generate the survival times and censoring indicator assuming a treatment-covariate interaction
Entry &lt;- sort(runif(n, 0, 5))
SurvT1 &lt;- .5
beta0 &lt;- -65/75
beta1 &lt;- 2/75
Surv &lt;- rep(0, n)
lambda1 &lt;- -log(SurvT1)/4
Surv[Txassign == 1] &lt;- rexp(n1, lambda1)
Surv[Txassign == 2] &lt;- rexp(n2, (lambda1*(beta0 + beta1*covariate[Txassign == 2])))
EventTimes &lt;- rep(0, n)
EventTimes &lt;- Entry + Surv
censor &lt;- time &lt;- rep(0, n)
for (i in 1:n) {
  censor[i] &lt;- ifelse(EventTimes[i] &lt;= 7, 1, 0)
  time[i] &lt;- ifelse(EventTimes[i] &lt; 7, Surv[i], 7 - Entry[i])
}
simdataKM &lt;- data.frame(time = time, censor = censor, trt = Txassign, covar = covariate)

# overall survival analysis
simdataKM_surv &lt;- Surv(simdataKM$time, simdataKM$censor)
simdataKM_fit &lt;- survfit(simdataKM_surv ~ trt, data = simdataKM)
plot(simdataKM_fit, lty = 2:3, lwd = rep(2, 2), col = 2:3)
legend("topright", c("Treatment 1", "Treatment 2"), lty = 2:3, lwd = rep(2, 2), col = 2:3)
title("Kaplan-Meier Curves\nfor simulated data")
survdiff(simdataKM_surv ~ trt, data = simdataKM, rho = 0)
</code></pre>

<hr>
<h2 id='stepp'>
Analyze survival or competing risks data
</h2><span id='topic+stepp'></span>

<h3>Description</h3>

<p>This method will be deprecated in the future.  Please use S4 classes (stmodelCI, stmodelKM) 
and corresponding constructors (stepp.CI and stepp.KM) for future development.
</p>
<p>A method to explore the treatment-effect interactions in either survival or competing risks data
arising from two treatment arms of a clinical trial. A permutation distribution approach
to inference is implemented, based on permuting covariate values within each treatment group. 
The statistical significance of observed heterogeneity of treatment effects is calculated using 
permutation tests:<br /><br />
1) for the maximum difference between each subpopulation effect and the overall population 
treatment effect or supremum based test statistic; <br />
2) for the difference between each subpopulation effect and the overall population treatment 
effect, which resembles the chi-square statistic. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp(trttype, coltrt, coltime, colcens=0, coltype=0, covar, trts, 
        patspop, minpatspop, timest, noperm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp_+3A_trttype">trttype</code></td>
<td>
<p>type of analysis methods to use: &quot;KM&quot; for Kaplan-Maier and &quot;CI&quot; for Cumulative Incidence</p>
</td></tr>
<tr><td><code id="stepp_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="stepp_+3A_coltime">coltime</code></td>
<td>
<p>the time to event variable</p>
</td></tr>
<tr><td><code id="stepp_+3A_colcens">colcens</code></td>
<td>
<p>the censoring variable. If specified, the KM method will be used</p>
</td></tr>
<tr><td><code id="stepp_+3A_coltype">coltype</code></td>
<td>
<p>variable with distinct codes for different causes of failure where coltype=0 for censored observations; 
coltype=1 for event of interest; coltype=2 for other causes of failure. If specified, the cumulative incidence method will be used.</p>
</td></tr>
<tr><td><code id="stepp_+3A_covar">covar</code></td>
<td>
<p>the covariate of interest</p>
</td></tr>
<tr><td><code id="stepp_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment arms, 1st and 2nd treatment arms, respectively</p>
</td></tr>
<tr><td><code id="stepp_+3A_patspop">patspop</code></td>
<td>
<p>larger parameter(r2) for subpopulation construction that determines how many patients are in each subpopulation</p>
</td></tr>
<tr><td><code id="stepp_+3A_minpatspop">minpatspop</code></td>
<td>
<p>smaller parameter(r1) for subpopulation construction that determines the largest number of patients in common among consecutive subpopulations</p>
</td></tr>
<tr><td><code id="stepp_+3A_timest">timest</code></td>
<td>
<p>timepoint to estimate survival</p>
</td></tr>
<tr><td><code id="stepp_+3A_noperm">noperm</code></td>
<td>
<p>the desired number of permutations; must be 0 or above</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical method to explore treatment by covariate interactions in survival or competing risks data arising from two 
treatment arms of a clinical trial. The method is based on constructing overlapping subpopulations 
of patients with respect to a covariate of interest, and in observing the pattern of the treatment 
effects estimated across subpopulations. A plot of these treatment effects is called STEPP, or 
Subpopulation Treatment Effect Pattern Plot. STEPP uses the permutation distribution based approach
for inference.
</p>
<p>One can explore the window parameters without invoking the permutation analysis by setting noperm 
to 0.  In that case, pvalue and the covarance matrix will not be available.
</p>
<p>We acknowledge Robert J. Gray for permitting us to use the cmprsk package. 
</p>


<h3>Value</h3>

<p>stepp does all the computation and anlaysis but does not generate any Subpopulation Treatment Effect
Pattern Plot (STEPP).  A steppes object is returned and the user can use stepp_summary, stepp_print,
or stepp_plot to display the information and to generate the plots for further analysis. 
</p>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>
<p>A few tips to keep in mind:
</p>
<p>The variables coltrt, coltime, coltype, and covar must be numeric. No formatting allowed.
</p>
<p>If you receive the error &quot;Error in solve.default(sigma): system is computationally singular; reciprocal condition number = 0&quot; then we recommend changing the seed by re-running stepp. If this error persists after several runs, then the program cannot provide reliable results. Please try modifying your choices of the two parameters minpatspop(r1) and patspop(r2) that define the subpopulation.
</p>
<p>The number of permutations specified in noperm, the sample size, and the number of subpopulations generated will affect how long stepp takes to execute. The results are stable if 2500 or more permutations are specified. Furthermore, varying the number of subpopulations will affect inference.
</p>
<p>The time point selected to estimate survival in timest must be in the same units (e.g., months) as the coltime variable.
</p>
<p>The order of the treatments in the vector trts must be in the same order in the vector tlegend. 
</p>


<h3>Note</h3>

<p>STEPP is an exploratory tool, with graphical features that make it easy for clinicians to interpret 
the results of the analysis. Positive results should prompt the need 
for confirmation from other datasets investigating similar treatment comparisons. It should also be 
clear that STEPP is not meant to estimate specific cutpoints in the range of values of the covariate 
of interest, but rather to provide some indication on ranges of values where treatment effect might 
have a particular behavior.
</p>
<p>STEPP considers the case in which the subpopulations are constructed according to a sliding window 
pattern. The larger parameter (patspop) determines how many patients are in each subpopulation, and 
the smaller parameter (minpatspop) determines the largest number of patients in common among 
consecutive subpopulations. A minimum of 80-100 patients should be in each subpopulation, 
but that is not strictly necessary. The difference (patspop-minpatspop) is the approximate number of 
patients replaced between any two subsequent subpopulations, and can be used to determine the number 
of subpopulations once patspop is fixed. The choice of the values of the parameters patspop and 
minpatspop to be used does change the appearance of the plot and the corresponding p-value. It is 
probably reasonable to experiment with a few combinations to ensure that the significance (or lack 
of significance) is stable with respect to that choice.
</p>
<p>For best results, consider implementing 2500 permutations of the covariate (vector of subpopulations)
to obtain a rich distribution in which to draw inference. 
</p>


<h3>Author(s)</h3>

<p>Ann Lazar, Wai-ki Yip, David Zahrieh, Bernard Cole, Marco Bonetti, Richard Gelber
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>
<p>Lazar AA, Cole BF, Bonetti M, Gelber RD.  Evaluation of treatment-effect heterogeneity using biomarkers measured on a
continuous scale: subpopulation treatment effect pattern plot.  Journal of Clinical Oncology, 2010; 28(29): 4539-4544.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,                                         
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>,
</p>
<p>Old functions to be deprecated: stepp_summary, stepp_print, stepp_plot, analyze.KM.stepp and analyze.CumInc.stepp. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE TREATMENT VARIABLE:
n &lt;- 1000		# set the sample size
mu &lt;- 0			# set the mean and sd of the covariate
sigma &lt;- 1

beta0 &lt;- log(-log(0.5)) # set the intercept for the log hazard
beta1 &lt;- -0.2		# set the slope on the covariate
beta2 &lt;- 0.5		# set the slope on the treatment indicator
beta3 &lt;- 0.7		# set the slope on the interaction

prob2 &lt;- 0.2		# set the proportion type 2 events
cprob &lt;- 0.3		# set the proportion censored

set.seed(7775432) 	# set the random number seed
covariate &lt;- rnorm(n,mean=mu,sd=sigma)	# generate the covariate values
Txassign &lt;- rbinom(n,1,0.5)		# generate the treatment indicator
x3 &lt;- covariate*Txassign		# compute interaction term
					# compute the hazard for type 1 event
lambda1 &lt;- exp(beta0+beta1*covariate+beta2*Txassign+beta3*x3)
lambda2 &lt;- prob2*lambda1/(1-prob2)	# compute the hazard for the type 2 event
					# compute the hazard for censoring time
lambda0 &lt;- cprob*(lambda1+lambda2)/(1-cprob)
t1 &lt;- rexp(n,rate=lambda1)		# generate the survival time for type 1 event
t2 &lt;- rexp(n,rate=lambda2)		# generate the survival time for type 2 event
t0 &lt;- rexp(n,rate=lambda0)		# generate the censoring time
time &lt;- pmin(t0,t1,t2)			# compute the observed survival time
type &lt;- rep(0,n)
type[(t1 &lt; t0)&amp;(t1 &lt; t2)] &lt;- 1
type[(t2 &lt; t0)&amp;(t2 &lt; t1)] &lt;- 2

# Call stepp to analyze the data
# Warning: In this example, the permutations have been set to 0 to allow the stepp function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
steppCI &lt;- stepp("CI", coltrt=Txassign, trts=c(0,1), coltime=time, coltype=type, 
  covar=covariate, patspop=300, minpatspop=200, timest=1.0, noperm=0)

stepp_summary(steppCI)
stepp_print(steppCI)
stepp_plot(steppCI, 
  ncex=0.70,legendy=30,pline=-2.5,color=c("red", "black"),
  xlabel="Subpopulations by Median Age",ylabel="4-year Cancer Relapse",
  tlegend=c("Treatment A", "Treatment B"), nlas=3,pointwise=FALSE)
</code></pre>

<hr>
<h2 id='stepp_plot'>
A function to generate the stepp plots
</h2><span id='topic+stepp_plot'></span>

<h3>Description</h3>

<p>This function will be deprecated in the future.  Please use S4 classes and its generic
function e.g. summary, print and plot for future development.
</p>
<p>A method to generate the 3 stepp plots for users to examine the treatment-covariate interactions
in various models data arising from two treatment arms of a clinical trial. Three plots are
generated:<br /><br />
1. effect estimates of both treatments against the median of each subpopulation<br />
2. effect differences (in absolute scale) between the two treatments against the
median of each subpopulation.<br />
3. effect ratios (in relative scale) between the two treatments against the median
of each subpopulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp_plot(x, legendy = 30, pline = -2.5, color = c("red", "black"), 
    ylabel= "Specify Timepoint &amp; Endpoint", xlabel="Subpopulations by Median Covariate", 
    ncex = 0.7, tlegend=c("Specify 1st Treatment", "Specify 2nd Treatment"), 
    nlas = 0, alpha = 0.05, pointwise = FALSE, ci = TRUE, pv = TRUE, 
    showss = TRUE, ylimit=c(0,100,-100,100,0,3), which="", 
    noyscale=FALSE, at=NA, subplot=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp_plot_+3A_x">x</code></td>
<td>
<p>the steppes object returned from stepp, analyze.KM.stepp or analyze.CumInc.stepp</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_legendy">legendy</code></td>
<td>
<p>optional - the vertical location of the legend according to the units on the y-axis; default is 30</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_pline">pline</code></td>
<td>
<p>optional - specify the vertical location of the p-value, that is, on which MARgin line, starting at 0 counting outwards; default is -2.5</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_color">color</code></td>
<td>
<p>optional - a vector containing the line colors for the 1st and 2nd treatment, respectively; default is &quot;red&quot; and &quot;black&quot;</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_ylabel">ylabel</code></td>
<td>
<p>optional - specify the label for the y-axis; default is &quot;Specify Timepoint &amp; Endpoint&quot;</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_xlabel">xlabel</code></td>
<td>
<p>optional - specify the label for the x-axis; default is &quot;Subpopulations by Median Covariate&quot;</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_ncex">ncex</code></td>
<td>
<p>optional - specify the size of the text for the sample size annotation, that is, the character expansion factor; default is 0.7</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_tlegend">tlegend</code></td>
<td>
<p>optional - a vector containing the treatment labels, 1st and 2nd treatment, respectively; default is c(&quot;Specify 1st Treatment&quot;, &quot;Specify 2nd Treatment&quot;</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_nlas">nlas</code></td>
<td>
<p>optional - specify the las paramter (0,1,2,3) to determine the orientation of the sample size annotation; default is 0</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_alpha">alpha</code></td>
<td>
<p>optional - specify the significance level; default is 0.05</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_pointwise">pointwise</code></td>
<td>
<p>optional - specify pointwise confidence intervals (pointwise=TRUE), or confidence bands; default is FALSE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_ci">ci</code></td>
<td>
<p>optional - specify if you want to display the conf. interval or band; default is TRUE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_pv">pv</code></td>
<td>
<p>optional - pvalue will be displayed in the plots; FALSE: pvalue will not be displayed in the plots; default is TRUE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_showss">showss</code></td>
<td>
<p>optional - specify the label for the x-axisoptional - show the sample size; FALSE: sample size will not be shown in the plots; default is TRUE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_ylimit">ylimit</code></td>
<td>
<p>optional - pvalue will be displayed in the plots; FALSE: pvalue will not be displayed in the plots; default is TRUE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_which">which</code></td>
<td>
<p>optional - if a subset of the plots is required, specify a subset of the numbers 1:3, which is the default</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_noyscale">noyscale</code></td>
<td>
<p>optional - do not scale to the y-axis; default is FALSE</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_at">at</code></td>
<td>
<p>optional - specify the horizontal position of the p-value; use together with pline; default is at the minimal value of x</p>
</td></tr>
<tr><td><code id="stepp_plot_+3A_subplot">subplot</code></td>
<td>
<p>optional - generate a subpopulation distribution subplot on top of the first STEPP plot; default is FALSE (no subplot)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the function to generate three stepp plots for user to explore treatment-covariate 
interactions in various models data arising from two treatment arms of a clinical trial. You can choose
to produce a single figure with all the three plots or only a subset of these through the use of the &lsquo;which&rsquo; argument.
</p>
<p>Through these plots, the user can examine the differences in effects (either in absolute or relative scale)
with respect to each subpopulation.
</p>
<p>This is mainly a graphics function.  The STEPP analysis is done.  Most of the parameters are for
graphics control so that one can customize the plots for presentation purposes.
</p>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip, David Zahrieh, Marco Bonetti, Bernard Cole, Ann Lazar, Richard Gelber
</p>


<h3>See Also</h3>

<p>The S4 classes: stwin, stsubpop, stmodelKM, stmodelCI, stmodelCOX, stmodelGLM, and steppes.
</p>
<p>Old functions to be deprecated: stepp, stepp_summary, stepp_print, analyze.KM.stepp and analyze.CumInc.stepp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # see example in the documentation for the function stepp.
</code></pre>

<hr>
<h2 id='stepp_print'>
The function to print the estimate, covariance matrices and test statistics.
</h2><span id='topic+stepp_print'></span>

<h3>Description</h3>

<p>This function will be deprecated in the future.  Please use S4 classes and generic
functions summary, print and plot for future development.
</p>
<p>A method to print three essential information resulting from the STEPP analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp_print(x, estimate=TRUE, cov=TRUE, test=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp_print_+3A_x">x</code></td>
<td>
<p>a steppes object returned from stepp, analyze.KM.stepp or analyze.CumInc.stepp function</p>
</td></tr>
<tr><td><code id="stepp_print_+3A_estimate">estimate</code></td>
<td>
<p>whether to print the effect estimates; default to yes</p>
</td></tr>
<tr><td><code id="stepp_print_+3A_cov">cov</code></td>
<td>
<p>whether to print the covariance matrices; default to yes</p>
</td></tr>
<tr><td><code id="stepp_print_+3A_test">test</code></td>
<td>
<p>whether to print the test statistics; default to yes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The STEPP analysis produces three important pieces of information.  User can decide to print them
all or individually.  The three pieces of information are:<br /><br />
1. effect estimates of each subpopulation for the two treatments, the differences in absolute 
scale of the effects and the ratio in relative scale of the effects.<br />
2. covariance matrics of the differences, logratios, differences in homogeneous association and 
logratios in homogeneous association.<br />
3. various permutation p values based on test statistics: supremum pvalues, homogeneous association pvalues, 
chisquare pvalue. Not all statistics are available for all models.    
</p>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip, David Zahrieh, Marco Bonetti, Bernard Cole, Ann Lazar, Richard Gelber
</p>


<h3>See Also</h3>

<p>The S4 classes: stwin, stsubpop, stmodelKM, stmodelCI, stmodelCOX, stmodelGLM, and steppes.
</p>
<p>Old functions to be deprecated: stepp, stepp_summary, stepp_plot, analyze.CumInc.stepp and analyze.KM.stepp. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see example in the documentation for the function stepp.
</code></pre>

<hr>
<h2 id='stepp_summary'>
The function to produce a summary of the size and various attributes of each subpopulation
</h2><span id='topic+stepp_summary'></span>

<h3>Description</h3>

<p>This function will be deprecated in the future.  Please use S4 classes and 
corresponding generic functions e.g. summary, print and plot for future development.
</p>
<p>A method to print the summary of the size and various attributes for
each subpopulation used in the STEPP analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp_summary(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp_summary_+3A_x">x</code></td>
<td>
<p>a steppes object returned from stepp, analyze.KM.stepp or analyze.CumInc.stepp function</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>This function together with other old functions will be depreciated in the future.  A new set of S4 classes are
implemented to replace old interfaces.  Please use them for future development.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip, David Zahrieh, Marco Bonetti, Bernard Cole, Ann Lazar, Richard Gelber
</p>


<h3>See Also</h3>

<p>The S4 classes: stwin, stsubpop, stmodelKM, stmodelCI, stmodelCOX, stmodelGLM, and steppes.
</p>
<p>Old functions to be deprecated: stepp, stepp_print, stepp_plot, analyze.KM.stepp, and analyze.CumInc.stepp 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set example in the documentation for the function stepp.

</code></pre>

<hr>
<h2 id='stepp.CI'>
The constructor to create the stmodelCI object
</h2><span id='topic+stepp.CI'></span>

<h3>Description</h3>

<p>This is the constructor function for the stmodelCI object. This object sets up the data with
a stepp model using competing risks method for analysis. (CI stands for Cumulative Incidence.)<br />
</p>
<p>The model explores the treatment-effect interactions in competing risks data arising 
from two or more treatment arms of a clinical trial. A permutation distribution approach to inference 
is implemented that permutes covariate values within a treatment group. 
The statistical significance of observed heterogeneity of treatment effects is calculated using 
permutation tests:<br /><br />
1) for the maximum difference between each subpopulation effect and the overall population 
treatment effect or supremum based test statistic; <br />
2) for the difference between each subpopulation effect and the overall population treatment 
effect, which resembles the chi-square statistic. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	stepp.CI(coltrt, coltime, coltype, trts, timePoint)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.CI_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="stepp.CI_+3A_coltime">coltime</code></td>
<td>
<p>the time to event variable</p>
</td></tr>
<tr><td><code id="stepp.CI_+3A_coltype">coltype</code></td>
<td>
<p>variable with distinct codes for different causes of failure where coltype=0 for censored observations; coltype=1 for event of interest; coltype=2 for other causes of failure</p>
</td></tr>
<tr><td><code id="stepp.CI_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment groups, 1st and 2nd treatment groups, respectively</p>
</td></tr>
<tr><td><code id="stepp.CI_+3A_timepoint">timePoint</code></td>
<td>
<p>timepoint to estimate survival</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the stmodelCI object.
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>
<p>Lazar AA, Cole BF, Bonetti M, Gelber RD.  Evaluation of treatment-effect heterogeneity usiing biomarkers measured
on a continuous scale: subpopulation treatment effect pattern plot.  Journal of Clinical Oncology, 2010; 28(29): 4539-4544.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
n &lt;- 1000		# set the sample size
mu &lt;- 0			# set the mean and sd of the covariate
sigma &lt;- 1

beta0 &lt;- log(-log(0.5)) # set the intercept for the log hazard
beta1 &lt;- -0.2		# set the slope on the covariate
beta2 &lt;- 0.5		# set the slope on the treatment indicator
beta3 &lt;- 0.7		# set the slope on the interaction

prob2 &lt;- 0.2		# set the proportion type 2 events
cprob &lt;- 0.3		# set the proportion censored

set.seed(7775432) 	# set the random number seed
covariate &lt;- rnorm(n,mean=mu,sd=sigma)	# generate the covariate values
Txassign &lt;- rbinom(n,1,0.5)		# generate the treatment indicator
x3 &lt;- covariate*Txassign		# compute interaction term
					# compute the hazard for type 1 event
lambda1 &lt;- exp(beta0+beta1*covariate+beta2*Txassign+beta3*x3)
lambda2 &lt;- prob2*lambda1/(1-prob2)	# compute the hazard for the type 2 event
					# compute the hazard for censoring time
lambda0 &lt;- cprob*(lambda1+lambda2)/(1-cprob)
t1 &lt;- rexp(n,rate=lambda1)		# generate the survival time for type 1 event
t2 &lt;- rexp(n,rate=lambda2)		# generate the survival time for type 2 event
t0 &lt;- rexp(n,rate=lambda0)		# generate the censoring time
time &lt;- pmin(t0,t1,t2)			# compute the observed survival time
type &lt;- rep(0,n)
type[(t1 &lt; t0)&amp;(t1 &lt; t2)] &lt;- 1
type[(t2 &lt; t0)&amp;(t2 &lt; t1)] &lt;- 2

# create the stepp model object to analyze the data using Cumulative Incidence approach
x &lt;- stepp.CI(coltrt=Txassign, trts=c(0,1), coltime=time, coltype=type, timePoint=1.0)

</code></pre>

<hr>
<h2 id='stepp.edge'>
The method performs an edge analysis on the STEPP GLM model estimate objects.
</h2><span id='topic+stepp.edge'></span>

<h3>Description</h3>

<p>Perform an edge analysis on the STEPP GLM model estimate objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp.edge(est, criteria, j=2, boot=0, seed=17, showstatus=TRUE, debug=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.edge_+3A_est">est</code></td>
<td>
<p>a STEPP estimate object.</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_criteria">criteria</code></td>
<td>
<p>criteria to be used to identify the cut point; abs or rel scale and by how much.</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_j">j</code></td>
<td>
<p>number of treatment, default to 2</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_boot">boot</code></td>
<td>
<p>perform a bootstrap analysis, default is none (0).</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_seed">seed</code></td>
<td>
<p>seed used for bootstrap, default is 17.</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_showstatus">showstatus</code></td>
<td>
<p>show the status of bootstrap, default is TRUE.</p>
</td></tr>
<tr><td><code id="stepp.edge_+3A_debug">debug</code></td>
<td>
<p>internal debug flag, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The criteria argument is a list with three elements:
</p>
<p>trtid - the treatment id;
</p>
<p>scale - &quot;A&quot; for absolute scale or &quot;R&quot; for relative scale;
</p>
<p>threshold - amount in either absolute or relative scale that would consider a jump.
</p>
<p>e.g. crit &lt;- list(trtid=1, scale=&quot;A&quot;, threshold=-0.03)
</p>
<p>Only support for STEPP GLM models for now. Bootstrap is computational time intensive  but it will
provide you with a quantification of the variability of the edge identified.
</p>


<h3>Value</h3>

<p>It returns the result of the identified edge with the STEPP subpopulations.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code> 
</p>

<hr>
<h2 id='stepp.GLM'>
The constructor to create the stmodelGLM object
</h2><span id='topic+stepp.GLM'></span>

<h3>Description</h3>

<p>This is the constructor function for stmodelGLM object.  Three kinds of GLMs are supported at this time:
gaussian with identity link, binomial with logit link and Poisson with log link.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	stepp.GLM(coltrt, trts, colY, MM, glm, link)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.GLM_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="stepp.GLM_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment arms, 1st and 2nd treatment groups, respectively</p>
</td></tr>
<tr><td><code id="stepp.GLM_+3A_coly">colY</code></td>
<td>
<p>a vector containing the outcome</p>
</td></tr>
<tr><td><code id="stepp.GLM_+3A_mm">MM</code></td>
<td>
<p>a model matrix for additional covariates; default is NULL<br />
no logical values or factors allowed<br />
these values need to be converted to numeric with some encoding scheme</p>
</td></tr>
<tr><td><code id="stepp.GLM_+3A_glm">glm</code></td>
<td>
<p>the glm to be used for analysis: &quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;</p>
</td></tr>
<tr><td><code id="stepp.GLM_+3A_link">link</code></td>
<td>
<p>the link function; reserved for future use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stmodelGLM object.
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>References</h3>

<p>Yip WK, Bonetti M, Cole BF, Barcella W, Wang XV, Lazar A and Gelber R (2016), 
&quot;STEPP- Subpopulation Analysis for Continuous, Binary and Count Outcomes&quot;,
Clinical Trials 2016 August ; 13(4): 382-290, doi:10.1177/1740774516643297.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# see the example for the aspirin data for an example for a binomial glm model
#
</code></pre>

<hr>
<h2 id='stepp.KM'>
The constructor to create the stmodelKM object
</h2><span id='topic+stepp.KM'></span>

<h3>Description</h3>

<p>This is the constructor function for the stmodelKM object.  This object sets up the data with 
a stepp model using the Kaplan-Meier method for analysis.<br />
</p>
<p>The model explores the treatment-covariate interactions in survival data arising 
from two treatment arms of a clinical trial. The treatment effects are measured using survival 
functions at a specified time point estimated from the Kaplan-Meier method and the hazard ratio 
based on observed-minus-expected estimation. A permutation distribution approach to inference 
is implemented, based on permuting the covariate values within each treatment group. 
The statistical significance of observed heterogeneity of treatment effects is calculated using 
permutation tests:<br /><br />
1) for the maximum difference between each subpopulation effect and the overall population 
treatment effect or supremum based test statistic; <br />
2) for the difference between each subpopulation effect and the overall population treatment 
effect, which resembles the chi-square statistic. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	stepp.KM(coltrt, survTime, censor, trts, timePoint)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.KM_+3A_coltrt">coltrt</code></td>
<td>
<p>the treatment variable</p>
</td></tr>
<tr><td><code id="stepp.KM_+3A_survtime">survTime</code></td>
<td>
<p>the time to event variable</p>
</td></tr>
<tr><td><code id="stepp.KM_+3A_censor">censor</code></td>
<td>
<p>the censor variable</p>
</td></tr>
<tr><td><code id="stepp.KM_+3A_trts">trts</code></td>
<td>
<p>a vector containing the codes for the 2 treatment arms, 1st and 2nd treatment groups, respectively</p>
</td></tr>
<tr><td><code id="stepp.KM_+3A_timepoint">timePoint</code></td>
<td>
<p>timepoint to estimate survival</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the stmodelKM object.
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>References</h3>

<p>Bonetti M, Gelber RD. Patterns of treatment effects in subsets of patients in clinical trials. Biostatistics 2004; 5(3):465-481.
</p>
<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE TREATMENT VARIABLE:
N &lt;- 1000
Txassign &lt;- sample(c(1,2), N, replace=TRUE, prob=c(1/2, 1/2))
n1 &lt;- length(Txassign[Txassign==1])
n2 &lt;- N - n1
#GENERATE A COVARIATE:
covariate &lt;- rnorm(N, 55, 7)
#GENERATE SURVIVAL AND CENSORING VARIABLES ASSUMING A TREATMENT COVARIATE INTERACTION:
Entry &lt;- sort( runif(N, 0, 5) )
SurvT1 &lt;- .5
beta0 &lt;-  -65 / 75
beta1 &lt;- 2 / 75
Surv &lt;- rep(0, N)
lambda1 &lt;- -log(SurvT1) / 4
Surv[Txassign==1] &lt;- rexp(n1, lambda1)
Surv[Txassign==2] &lt;- rexp(n2, (lambda1*(beta0+beta1*covariate[Txassign==2])))
EventTimes &lt;- rep(0, N)
EventTimes &lt;- Entry + Surv
censor &lt;- rep(0, N)
time &lt;- rep(0,N)
for ( i in 1:N )
   {
     censor[i] &lt;- ifelse( EventTimes[i] &lt;= 7, 1, 0 )
     time[i] &lt;- ifelse( EventTimes[i] &lt; 7, Surv[i], 7 - Entry[i] ) 
   }

modKM &lt;- stepp.KM( coltrt=Txassign, survTime=time, censor=censor, trts=c(1,2), timePoint=4)

</code></pre>

<hr>
<h2 id='stepp.rnote'>
The method to print the release note for STEPP.
</h2><span id='topic+stepp.rnote'></span>

<h3>Description</h3>

<p>This method will print the current stepp version and the corresponding release note.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp.rnote()
</code></pre>


<h3>Author(s)</h3>

<p>Wai-ki Yip, Marco Bonetti, Bernard Cole, Ann Lazar, Victoria Xin Wang, Richard Gelber
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  stepp.rnote()
</code></pre>

<hr>
<h2 id='stepp.subpop'>
The constructor to create the stsubpop object and generate the subpopulations based on the
specified stepp window and covariate of interest
</h2><span id='topic+stepp.subpop'></span>

<h3>Description</h3>

<p>This is the constructor function to create a stepp subpopulation object. In addition, 
it will also generate the stepp subpopulations based on the stepp window and covariate specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepp.subpop(swin, cov, coltype, coltrt, trts, minsubpops)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.subpop_+3A_swin">swin</code></td>
<td>
<p>the stepp window set up for the analysis</p>
</td></tr>
<tr><td><code id="stepp.subpop_+3A_cov">cov</code></td>
<td>
<p>the covariate of interest</p>
</td></tr>
<tr><td><code id="stepp.subpop_+3A_coltype">coltype</code></td>
<td>
<p>variable providing the event type; required only for event-based windows</p>
</td></tr>
<tr><td><code id="stepp.subpop_+3A_coltrt">coltrt</code></td>
<td>
<p>variable providing the treatment indicators; required only for event-based windows</p>
</td></tr>
<tr><td><code id="stepp.subpop_+3A_trts">trts</code></td>
<td>
<p>vector containing the treatments list; required only for event-based windows</p>
</td></tr>
<tr><td><code id="stepp.subpop_+3A_minsubpops">minsubpops</code></td>
<td>
<p>length-one numeric vector providing the minimum number of subpopulations to generate; required only for event-based windows</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the stsubpop object with subpopulations generated. 
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,                                        <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a steppp window
win1 &lt;- stepp.win(type="sliding", r1=5,r2=10)

# generate the covariate of interest
Y &lt;- rnorm(100)

# create and generate the stepp subpopulation
sp   &lt;- stepp.subpop(swin=win1, cov=Y)

# event-based windows using the BIG data set
data(bigKM)
rxgroup &lt;- bigKM$trt
time    &lt;- bigKM$time
evt     &lt;- bigKM$event
cov     &lt;- bigKM$ki67

swin_e &lt;- new("stwin", type = "sliding_events", e1 = 10, e2 = 20)
subp_e &lt;- new("stsubpop")
subp_e &lt;- generate(subp_e, win = swin_e, covariate = cov, coltype = evt,
                   coltrt = rxgroup, trts = c(1, 2), minsubpops = 5)
summary(subp_e)
</code></pre>

<hr>
<h2 id='stepp.test'>
The constructor to generate a complete steppes object with effect estimates and test statistics
</h2><span id='topic+stepp.test'></span>

<h3>Description</h3>

<p>This is a constructor function for the steppes object.   In addition, it estimates all the effects of
each subpopulations, performs permutation tests and generates all covariance matrices and statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp.test(subpop, model, nperm, showstatus = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.test_+3A_subpop">subpop</code></td>
<td>
<p>the filled stepp subpopulation object</p>
</td></tr>
<tr><td><code id="stepp.test_+3A_model">model</code></td>
<td>
<p>the model of the data to be used for stepp analysis</p>
</td></tr>
<tr><td><code id="stepp.test_+3A_nperm">nperm</code></td>
<td>
<p>number of permutation used in the permutation test</p>
</td></tr>
<tr><td><code id="stepp.test_+3A_showstatus">showstatus</code></td>
<td>
<p>display the progress bar for the permutation test; default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Permutation tests for all the statistics are done (see ref below).  For best results, considering
using 2500 permutations to obtain a rich distribution from which to draw inference.<br />
</p>


<h3>Value</h3>

<p>It returns a steppes object with all effects estimates, covariance matrices and statistics.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>References</h3>

<p>Bonetti M, Zahrieh D, Cole BF, Gelber RD. A small sample study of the STEPP approach to assessing treatment-covariate interactions in survival data. Statistics in Medicine 2009; 28(8):1255-68.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>,
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>,
<code><a href="#topic+steppes-class">steppes</a></code>,    <code><a href="#topic+stmodel-class">stmodel</a></code>,
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bigCI)

rxgroup &lt;- bigCI$trt
time    &lt;- bigCI$time
evt     &lt;- bigCI$event
cov     &lt;- bigCI$ki67

#
# using constructor functions
swin    &lt;- stepp.win(type="sliding", r1=50, r2=150)
subp    &lt;- stepp.subpop(swin=swin, cov=cov)
summary(subp)

smodel  &lt;- stepp.CI(coltrt=rxgroup, trts=c(1,2), coltime=time, coltype=evt, timePoint=4)
# Warning: In this example, the permutations have been set to 0 to allow the function
# to finish in a short amount of time.  IT IS RECOMMEND TO USE AT LEAST 2500 PERMUTATIONS TO 
# PROVIDE STABLE RESULTS.
statCI  &lt;- stepp.test(subpop=subp, model=smodel, nperm=0)

</code></pre>

<hr>
<h2 id='stepp.win'>
The constructor to create the stepp window object
</h2><span id='topic+stepp.win'></span>

<h3>Description</h3>

<p>This is the constructor function to create a stepp window object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stepp.win(type = "sliding", r1 = 5, r2 = 20, e1 = NULL, e2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepp.win_+3A_type">type</code></td>
<td>
<p>type of stepp window; &quot;sliding&quot;, &quot;sliding_events&quot; or &quot;tail-oriented&quot;</p>
</td></tr>
<tr><td><code id="stepp.win_+3A_r1">r1</code></td>
<td>
<p>sliding window: minimum number of patients allowed in overlapping windows;<br />
tail-oriented window: a vector of maximum covariate values for each subpopulation</p>
</td></tr>
<tr><td><code id="stepp.win_+3A_r2">r2</code></td>
<td>
<p>sliding window: size of subpopulation in each window;<br />
tail-oriented window: a vector of minimum covariate values for each subpopulation</p>
</td></tr>
<tr><td><code id="stepp.win_+3A_e1">e1</code></td>
<td>
<p>sliding window: minimum number of events allowed in overlapping windows</p>
</td></tr>
<tr><td><code id="stepp.win_+3A_e2">e2</code></td>
<td>
<p>sliding window: number of events in each subpopulation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the functional interface to construct a stepp window object besides
using new(&quot;stwin&quot;, ...). A STEPP window specifies a pattern of subpopulation you would like
to explore. There are three kinds of patterns: &quot;sliding window&quot;, &quot;event-based sliding window&quot;
and &quot;tail-oriented window&quot;.<br />
These patterns are specified through the following set of values (r1 and r2 for sliding and
tail-oriented windows, e1 and e2 for event-based sliding windows):<br />
<br />
1. for sliding windows based on the number of patients (&quot;sliding&quot;), r1 is the minimum number
of patients allowed in overlapping windows and r2 is the approximate size of subpopulation
in each window;<br />
<br />
2. for sliding windows based on the number of events (&quot;sliding_events&quot;), e1 is the minimum
number of events allowed in overlapping windows and e2 is the approximate size of
subpopulation in each window in terms of number of events;<br />
<br />
3. for tail-oriented window, r1 is a vector of maximum covariate value for each subpopulation
from the minimum value of the entire subpopulation, and r2 is a vector of minimum covariate
values for each subpopulation from the maximum value of the window. The utility function, 
gen.tailwin, can be used to generate these two vectors based on the number of desired 
subpopulations.<br />
<br />
When &quot;sliding_events&quot; is chosen r1 and r2 are set to <code>NULL</code>, while when &quot;sliding&quot; or
&quot;tail-oriented&quot; are chosen e1 and e2 are set to <code>NULL</code>.<br />
<br />
These pattern are based on all patients.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # create a stepp window object of type "sliding", 
  # subpopulation size is 200 and allows only 50 patients
  # between overlapping windows
  mywin &lt;- stepp.win(type="sliding", r1=50, r2=200)

  # print a summary of the stepp window object
  summary(mywin) 

  # create a stepp window object of type "sliding_events", 
  # (event-based) subpopulation size is 200 and allows
  # only 50 events between overlapping windows
  mywin &lt;- stepp.win(type="sliding_events", e1=50, e2=200)

  # print a summary of the stepp window object
  summary(mywin) 
</code></pre>

<hr>
<h2 id='steppes-class'>Class <code>"steppes"</code></h2><span id='topic+steppes-class'></span><span id='topic+estimate+2Csteppes-method'></span><span id='topic+plot+2Csteppes-method'></span><span id='topic+print+2Csteppes-method'></span><span id='topic+summary+2Csteppes-method'></span><span id='topic+test+2Csteppes-method'></span>

<h3>Description</h3>

<p>This is the stepp object for stepp results.  It keeps track of all the estimates, covariance matrices and
the test statistics
</p>


<h3>Value</h3>

<p>The new method returns the steppes object.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("steppes", ...)</code> or by the constructor function
stepp.test.
</p>


<h3>Slots</h3>


<dl>
<dt><code>subpop</code>:</dt><dd><p>Object of class <code>"stsubpop"</code> <br />
the filled stepp subpopulation object </p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class <code>"stmodel"</code> <br />
the model of the data to be used for stepp analysis </p>
</dd>
<dt><code>effect</code>:</dt><dd><p>Object of class <code>"ANY"</code> <br />
effect estimates of each subpopulation in absolute and relative scales <br />
list return from the estimate methods of various stepp models <br />
see documentation in various stepp models for details on what is in the list</p>
</dd>
<dt><code>testresults</code>:</dt><dd><p>Object of class <code>"ANY"</code> <br />
permutation or GEE test results and various covariance matrices <br />
list return from the test methods of various stepp models <br />
see documentation in various stepp models for details on what is in the list</p>
</dd>
<dt><code>nperm</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
number of permutation for the permutation test; default is 2500 </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>estimate</dt><dd><p><code>signature(.Object = "steppes", sp, model)</code>: <br />
estimate the effect in absolute and relative scale of the overall and each subpopulation for the specified subpopulation using the specified model. </p>
</dd>
<dt>plot</dt><dd><p><code>signature(.Object = "steppes")</code>: <br />
generate the three stepp plots</p>
</dd>
<dt>print</dt><dd><p><code>signature(.Object = "steppes", estimate=TRUE, cov=TRUE, test=TRUE)</code>: <br />
print the estimates, covariance matrices and statistics from the stepp analysis </p>
</dd>
<dt>summary</dt><dd><p><code>signature(.Object = "steppes")</code>: <br />
produce a summary of the steppes object </p>
</dd>
<dt>test</dt><dd><p><code>signature(.Object = "steppes", nperm=100, showstatus=TRUE)</code>: <br />
perform the permutation tests and obtain various statistics. Number of permutation is default to 100 and status bar to show.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The plot function for steppes class generates 3 plots at once. If you are using R studio for development, 
you can only get the last plot as R studio only allows one graphical device. There is a simple workaround.
By writing the plots to pdf files in your working directory, you can display them outside of R studio.
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>,<code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("steppes")
</code></pre>

<hr>
<h2 id='stmodel-class'>Class <code>"stmodel"</code></h2><span id='topic+stmodel-class'></span>

<h3>Description</h3>

<p>This is the S4 virtual class of all stepp models.
</p>


<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Methods</h3>

<p>No methods defined with class &quot;stmodel&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("stmodel")
</code></pre>

<hr>
<h2 id='stmodelCI-class'>Class <code>"stmodelCI"</code></h2><span id='topic+stmodelCI-class'></span><span id='topic+estimate+2CstmodelCI-method'></span><span id='topic+print+2CstmodelCI-method'></span><span id='topic+test+2CstmodelCI-method'></span>

<h3>Description</h3>

<p>This is the stepp model of survival data with competing risks.
</p>


<h3>Value</h3>

<p>The new method returns the stmodelCI object.
</p>
<p>The estimate method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;CIe&quot;</p>
</td></tr>
<tr><td><code>sObs1</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the 1st treatment</p>
</td></tr>
<tr><td><code>sSE1</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the 1st treatment</p>
</td></tr>
<tr><td><code>oObs1</code></td>
<td>
<p>effect estimate of the entire population based on the 1st treatment</p>
</td></tr>
<tr><td><code>oSE1</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the 1st treatment</p>
</td></tr>
<tr><td><code>sObs2</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the 1st treatment</p>
</td></tr>
<tr><td><code>sSE2</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the 1st treatment</p>
</td></tr>
<tr><td><code>oObs2</code></td>
<td>
<p>effect estimate of the entire population based on the 1st treatment</p>
</td></tr>
<tr><td><code>oSE2</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the 1st treatment</p>
</td></tr>
<tr><td><code>skmw</code></td>
<td>
<p>Wald's statistics for the effect estimate differences between the two treatments</p>
</td></tr>
<tr><td><code>logHR</code></td>
<td>
<p>a vector of log hazard ratio estimate of the subpopulations comparing 1st and 2nd treatments</p>
</td></tr>
<tr><td><code>logHRSE</code></td>
<td>
<p>a vector of standard error of the log hazard ratio estimate of the subpopulations comparing 1st and 2nd treatments</p>
</td></tr>
<tr><td><code>ologHR</code></td>
<td>
<p>the log hazard ratio estimate of the entire population comparing 1st and 2nd treatments</p>
</td></tr>
<tr><td><code>ologHRSE</code></td>
<td>
<p>the standard error of the log hazard ratio estimate of the entire population comparing 1st and 2nd treatments</p>
</td></tr>
<tr><td><code>logHRw</code></td>
<td>
<p>Wald's statistics for the log hazard ratio between the two treatments</p>
</td></tr>
</table>
<p>The test method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;CIt&quot;</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>hasigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>HRsigma</code></td>
<td>
<p>the covariance matrix for the subpopulations based on hazard ratio</p>
</td></tr>
<tr><td><code>haHRsigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on hazard ratio</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the supremum pvalue based on effect difference</p>
</td></tr>
<tr><td><code>chi2pvalue</code></td>
<td>
<p>the chisquare pvalue based on effect difference</p>
</td></tr>
<tr><td><code>hapvalue</code></td>
<td>
<p>the homogeneous association pvalue based on effect difference</p>
</td></tr>
<tr><td><code>HRpvalue</code></td>
<td>
<p>the supremum pvalue based on hazard ratio</p>
</td></tr>
<tr><td><code>haHRpvalue</code></td>
<td>
<p>the homogeneous association pvalue based on hazard ratio</p>
</td></tr>  
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("stmodelCI", ...)</code> or by <br />
the constructor function stepp.CI.
</p>


<h3>Slots</h3>


<dl>
<dt><code>coltrt</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the treatment variable</p>
</dd>
<dt><code>coltime</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the time to event variable</p>
</dd>
<dt><code>coltype</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
variable with distinct codes for different causes of failure where coltype=0 for censored observations; coltype=1 for event of interest; coltype=2 for other causes of failure</p>
</dd>
<dt><code>trts</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector containing the codes for the 2 treatment groups, 1st and 2nd treatment groups, respectively</p>
</dd>
<dt><code>timePoint</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
timepoint to estimate survival</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+stmodel-class">stmodel</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>estimate</dt><dd><p><code>signature(.Object = "stmodelCI")</code>: <br />
estimate the effect in absolute and relative scale of the overall and each subpopulation </p>
</dd>
<dt>print</dt><dd><p><code>signature(.Object = "stmodelCI")</code>: <br />
print the estimate, covariance matrices and statistics </p>
</dd>
<dt>test</dt><dd><p><code>signature(.Object = "stmodelCI")</code>: <br />
perform the permutation tests or GEE and obtain various statistics </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("stmodelCI")

##
n &lt;- 1000		# set the sample size
mu &lt;- 0			# set the mean and sd of the covariate
sigma &lt;- 1

beta0 &lt;- log(-log(0.5)) # set the intercept for the log hazard
beta1 &lt;- -0.2		# set the slope on the covariate
beta2 &lt;- 0.5		# set the slope on the treatment indicator
beta3 &lt;- 0.7		# set the slope on the interaction

prob2 &lt;- 0.2		# set the proportion type 2 events
cprob &lt;- 0.3		# set the proportion censored

set.seed(7775432) 	# set the random number seed
covariate &lt;- rnorm(n,mean=mu,sd=sigma)	# generate the covariate values
Txassign &lt;- rbinom(n,1,0.5)		# generate the treatment indicator
x3 &lt;- covariate*Txassign		# compute interaction term
					# compute the hazard for type 1 event
lambda1 &lt;- exp(beta0+beta1*covariate+beta2*Txassign+beta3*x3)
lambda2 &lt;- prob2*lambda1/(1-prob2)	# compute the hazard for the type 2 event
					# compute the hazard for censoring time
lambda0 &lt;- cprob*(lambda1+lambda2)/(1-cprob)
t1 &lt;- rexp(n,rate=lambda1)		# generate the survival time for type 1 event
t2 &lt;- rexp(n,rate=lambda2)		# generate the survival time for type 2 event
t0 &lt;- rexp(n,rate=lambda0)		# generate the censoring time
time &lt;- pmin(t0,t1,t2)			# compute the observed survival time
type &lt;- rep(0,n)
type[(t1 &lt; t0)&amp;(t1 &lt; t2)] &lt;- 1
type[(t2 &lt; t0)&amp;(t2 &lt; t1)] &lt;- 2

# create the stepp model object to analyze the data using Cumulative Incidence approach
x &lt;- new ("stmodelCI", coltrt=Txassign, trts=c(0,1), coltime=time, coltype=type, timePoint=1.0)

</code></pre>

<hr>
<h2 id='stmodelGLM-class'>Class <code>"stmodelGLM"</code></h2><span id='topic+stmodelGLM-class'></span><span id='topic+estimate+2CstmodelGLM-method'></span><span id='topic+print+2CstmodelGLM-method'></span><span id='topic+test+2CstmodelGLM-method'></span>

<h3>Description</h3>

<p>This is the stepp model for data arising from the following Generalized Linear Models:
1. gaussian with identity link,
2. binomial with logit link, and
3. Poisson with log link.
</p>
<p>One can specify additional covariates in the model using <code>model.matrix</code> in R.
</p>


<h3>Value</h3>

<p>The new method returns the stmodelGLM object.
</p>
<p>The estimate method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;GLMGe&quot; - Gaussian model, &quot;GLMBe&quot; - binomial model, and &quot;GLMPe&quot; - Poisson model</p>
</td></tr>
<tr><td><code>sObs1</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>sSE1</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>oObs1</code></td>
<td>
<p>effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>oSE1</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>sObs2</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>sSE2</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>oObs2</code></td>
<td>
<p>effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>oSE2</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>sglmw</code></td>
<td>
<p>Wald's statistics for the effect estimate differences between the two treatments</p>
</td></tr>
<tr><td><code>RD</code></td>
<td>
<p>a vector of effect estimates difference of all subpopulations between the two treatments</p>
</td></tr>
<tr><td><code>RDSE</code></td>
<td>
<p>a vector of the standard error effect estimates difference of all subpopulations between the two treatments</p>
</td></tr>
<tr><td><code>ORD</code></td>
<td>
<p>overall difference of effect estimates of the entire population between the two treatments</p>
</td></tr>
<tr><td><code>ORDSE</code></td>
<td>
<p>the standard error of the overall difference of the effect estimates of the entire population between the two treatments</p>
</td></tr>
<tr><td><code>logR</code></td>
<td>
<p>a vector of log ratio of effect estimates of all subpopulations between the two treatments</p>
</td></tr>
<tr><td><code>logRSE</code></td>
<td>
<p>a vector of standard error of log ratio of effect estimates of all subpopulations between the two treatments</p>
</td></tr>
<tr><td><code>ologR</code></td>
<td>
<p>log ratio of effect estimates of the entire population between the two treatments</p>
</td></tr>
<tr><td><code>ologRSE</code></td>
<td>
<p>the standard error of the log ratio of effect estimates of the entire population between the two treatments</p>
</td></tr>
<tr><td><code>sglmlogrw</code></td>
<td>
<p>Wald's statistics for the log ratio of effect estimates between the two treatments</p>
</td></tr>
</table>
<p>The test method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;GLMt&quot;</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>hasigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>HRsigma</code></td>
<td>
<p>the covariance matrix for the subpopulations based on hazard ratio</p>
</td></tr>
<tr><td><code>haHRsigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on hazard ratio</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the supremum pvalue based on effect difference</p>
</td></tr>
<tr><td><code>chi2pvalue</code></td>
<td>
<p>the chisquare pvalue based on effect difference</p>
</td></tr>
<tr><td><code>hapvalue</code></td>
<td>
<p>the homogeneous association pvalue based on effect difference</p>
</td></tr>
<tr><td><code>HRpvalue</code></td>
<td>
<p>the supremum pvalue based on hazard ratio</p>
</td></tr>
<tr><td><code>haHRpvalue</code></td>
<td>
<p>the homogeneous association pvalue based on hazard ratio</p>
</td></tr>  
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("stmodelGLM", ...)</code> or by <br /> 
the construction function stmodel.GLM.
</p>


<h3>Slots</h3>


<dl>
<dt><code>coltrt</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the treatment variable</p>
</dd>
<dt><code>colY</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector containing the outcome </p>
</dd>
<dt><code>trts</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector containing the codes for the 2 treatment groups, first and second treatment groups, respectively </p>
</dd>
<dt><code>MM</code>:</dt><dd><p>Object of class <code>"ANY"</code> <br />
a model matrix for extra adjustment covariates; default is NULL <br />
currently, stepp can only support covariates with numeric values, no logical values or factors allowed <br />
these values need to be converted to numeric with some encoding schemes</p>
</dd>
<dt><code>glm</code>:</dt><dd><p>Object of class <code>"character"</code> <br />
the glm to be used for analysis: &quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;</p>
</dd>
<dt><code>link</code>:</dt><dd><p>Object of class <code>"character"</code> <br />
the link function; reserved for future use </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+stmodel-class">stmodel</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>estimate</dt><dd><p><code>signature(.Object = "stmodelGLM")</code>: <br />
estimate the effect in absolute and relative scale of the overall and each subpopulation </p>
</dd>
<dt>print</dt><dd><p><code>signature(.Object = "stmodelGLM")</code>: <br />
print the estimate, covariance matrices and statistics </p>
</dd>
<dt>test</dt><dd><p><code>signature(.Object = "stmodelGLM")</code>: <br />
perform the permutation tests or GEE and obtain various statistics </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("stmodelGLM")
</code></pre>

<hr>
<h2 id='stmodelKM-class'>Class <code>"stmodelKM"</code></h2><span id='topic+stmodelKM-class'></span><span id='topic+estimate+2CstmodelKM-method'></span><span id='topic+print+2CstmodelKM-method'></span><span id='topic+test+2CstmodelKM-method'></span>

<h3>Description</h3>

<p>This is the S4 class for the stepp model of survival data using Kaplan-Meier method.
</p>


<h3>Value</h3>

<p>The new method returns the stmodelKM object.
</p>
<p>The estimate method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;KMe&quot;</p>
</td></tr>
<tr><td><code>sObs1</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>sSE1</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>oObs1</code></td>
<td>
<p>effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>oSE1</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>sObs2</code></td>
<td>
<p>a vector of effect estimates of all subpopulations based on the group treatment</p>
</td></tr>
<tr><td><code>sSE2</code></td>
<td>
<p>a vector of standard errors of effect estimates of all subpopulations based on the first treatment</p>
</td></tr>
<tr><td><code>oObs2</code></td>
<td>
<p>effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>oSE2</code></td>
<td>
<p>the standard error of the effect estimate of the entire population based on the first treatment</p>
</td></tr>
<tr><td><code>skmw</code></td>
<td>
<p>Wald's statistics for the effect estimate differences between the two treatments</p>
</td></tr>
<tr><td><code>logHR</code></td>
<td>
<p>a vector of log hazard ratio estimate of the subpopulations comparing first and second treatments</p>
</td></tr>
<tr><td><code>logHRSE</code></td>
<td>
<p>a vector of standard error of the log hazard ratio estimate of the subpopulations comparing first and second treatment</p>
</td></tr>
<tr><td><code>ologHR</code></td>
<td>
<p>the log hazard ratio estimate of the entire population comparing first and second treatment</p>
</td></tr>
<tr><td><code>ologHRSE</code></td>
<td>
<p>the standard error of the log hazard ratio estimate of the entire population comparing first and second treatment</p>
</td></tr>
<tr><td><code>logHRw</code></td>
<td>
<p>Wald's statistics for the log hazard ratio between the two treatment</p>
</td></tr>
</table>
<p>The test method returns a list with the following fields:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the stepp model - &quot;KMt&quot;</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>hasigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on effect differences</p>
</td></tr>
<tr><td><code>HRsigma</code></td>
<td>
<p>the covariance matrix for the subpopulations based on hazard ratios</p>
</td></tr>
<tr><td><code>haHRsigma</code></td>
<td>
<p>the homogeneous association covariance matrix for subpopulations based on hazard ratios</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the supremum pvalue based on effect difference</p>
</td></tr>
<tr><td><code>chi2pvalue</code></td>
<td>
<p>the chisquare pvalue based on effect difference</p>
</td></tr>
<tr><td><code>hapvalue</code></td>
<td>
<p>the homogeneous association pvalue based on effect difference</p>
</td></tr>
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("stmodelKM", ...)</code> or by <br />
the constructor function stmodel.KM.
</p>


<h3>Slots</h3>


<dl>
<dt><code>coltrt</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the treatment variable</p>
</dd>
<dt><code>survTime</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the time to event variable</p>
</dd>
<dt><code>censor</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the censor variable</p>
</dd>
<dt><code>trts</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector containing the codes for the 2 treatment groups, first and second treatment groups, respectively</p>
</dd>
<dt><code>timePoint</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
timepoint to estimate survival</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+stmodel-class">stmodel</a>"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>estimate</dt><dd><p><code>signature(.Object = "stmodelKM")</code>:  <br />
estimate the effect in absolute and relative scale of the overall population and each subpopulation.  </p>
</dd>
<dt>print</dt><dd><p><code>signature(.Object = "stmodelKM")</code>: <br />
print the estimate, covariance matrices and statistics. </p>
</dd>
<dt>test</dt><dd><p><code>signature(.Object = "stmodelKM")</code>:  <br />
perform the permutation tests or GEE and obtain various statistics. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wai-Ki YIp
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("stmodelKM")

#GENERATE TREATMENT VARIABLE:
N &lt;- 1000
Txassign &lt;- sample(c(1,2), N, replace=TRUE, prob=c(1/2, 1/2))
n1 &lt;- length(Txassign[Txassign==1])
n2 &lt;- N - n1
#GENERATE A COVARIATE:
covariate &lt;- rnorm(N, 55, 7)
#GENERATE SURVIVAL AND CENSORING VARIABLES ASSUMING A TREATMENT COVARIATE INTERACTION:
Entry &lt;- sort( runif(N, 0, 5) )
SurvT1 &lt;- .5
beta0 &lt;-  -65 / 75
beta1 &lt;- 2 / 75
Surv &lt;- rep(0, N)
lambda1 &lt;- -log(SurvT1) / 4
Surv[Txassign==1] &lt;- rexp(n1, lambda1)
Surv[Txassign==2] &lt;- rexp(n2, (lambda1*(beta0+beta1*covariate[Txassign==2])))
EventTimes &lt;- rep(0, N)
EventTimes &lt;- Entry + Surv
censor &lt;- rep(0, N)
time &lt;- rep(0,N)
for ( i in 1:N )
   {
     censor[i] &lt;- ifelse( EventTimes[i] &lt;= 7, 1, 0 )
     time[i] &lt;- ifelse( EventTimes[i] &lt; 7, Surv[i], 7 - Entry[i] ) 
   }

modKM &lt;- new("stmodelKM", coltrt=Txassign, survTime=time, censor=censor, trts=c(1,2), timePoint=4)

</code></pre>

<hr>
<h2 id='stsubpop-class'>Class <code>"stsubpop"</code></h2><span id='topic+stsubpop-class'></span><span id='topic+generate+2Cstsubpop-method'></span><span id='topic+summary+2Cstsubpop-method'></span>

<h3>Description</h3>

<p>This is the S4 class for stepp subpopulation object.  The subpopulations are generated
based on the stepp windows and the covariate of interest.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("stsubpop")</code> or the constructor method stepp.subpop.
</p>


<h3>Slots</h3>


<dl>
<dt><code>win</code>:</dt><dd><p>Object of class <code>"stwin"</code> <br />
the stepp window set up for the analysis </p>
</dd>
<dt><code>covar</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the covariate of interest </p>
</dd>
<dt><code>nsubpop</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
the number of subpopulations generated </p>
</dd>
<dt><code>subpop</code>:</dt><dd><p>Object of class <code>"ANY"</code> <br />
a matrix of subpopulations generated based on the stepp window and the specified covariate of interest </p>
</dd>
<dt><code>npatsub</code>:</dt><dd><p>Object of class <code>"numeric"</code> 
a vector of size of each subpopulation </p>
</dd>
<dt><code>medianz</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector of median value of the covariate of interest for each subpopulation </p>
</dd>
<dt><code>minc</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector of the minimum value of the covariate of interest for each subpopulation </p>
</dd>
<dt><code>maxc</code>:</dt><dd><p>Object of class <code>"numeric"</code> <br />
a vector of the maximum value of the covariate of interest for each subpopulation </p>
</dd>
<dt><code>neventsubTrt0</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br />
a vector containing the number of events in each subpopulation for the baseline treatment group</p>
</dd>
<dt><code>neventsubTrt1</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br />
a vector containing the number of events in each subpopulation for the active treatment group</p>
</dd>
<dt><code>init</code>:</dt><dd><p>Object of class <code>"logical"</code> <br />
a logical value indicating if the subpopulations have already been generated or not </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>generate</dt><dd><p><code>signature(.Object = "stsubpop", win, covariate, coltype, coltrt, trts, minsubpops)</code>: <br />
a method to generate the subpopulations based on the stepp window object and the specified covariate of interest. For event-based windows, also the event type (<code>coltype</code>), treatment indicator (<code>coltrt</code>), treatments list (<code>trts</code>) and minimum number of subpopulations (<code>minsubpops</code>) must be provided </p>
</dd>
<dt>summary</dt><dd><p><code>signature(.Object = "stsubpop")</code>: <br />
a method to display the summary of the subpopulations generated </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,                                     <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("stsubpop")

# create a steppp window
win1 &lt;- stepp.win(type="sliding", r1=5,r2=10)

# generate the covariate of interest
Y &lt;- rnorm(100)

# create and generate the stepp subpopulation
sp &lt;- new("stsubpop")
sp &lt;- generate(sp, win=win1, cov=Y)
summary(sp)

# event-based windows using the BIG data set
data(bigKM)
rxgroup &lt;- bigKM$trt
time    &lt;- bigKM$time
evt     &lt;- bigKM$event
cov     &lt;- bigKM$ki67

swin_e &lt;- new("stwin", type = "sliding_events", e1 = 10, e2 = 20)
subp_e &lt;- new("stsubpop")
subp_e &lt;- generate(subp_e, win = swin_e, covariate = cov, coltype = evt,
                   coltrt = rxgroup, trts = c(1, 2), minsubpops = 5)
summary(subp_e)
</code></pre>

<hr>
<h2 id='stwin-class'>Class <code>"stwin"</code></h2><span id='topic+stwin-class'></span><span id='topic+summary+2Cstwin-method'></span>

<h3>Description</h3>

<p>This the S4 class for the stepp window object.  The stepp window class describes the way
to set up the subpopulation for a stepp analysis.  It specifies a pattern of 
subpopulation you would like   to explore. There are three kinds of patterns: &quot;sliding window&quot;, 
&quot;event-based sliding window&quot; and &quot;tail-oriented window&quot;.
</p>
<p>These patterns are specified through the following set of values (r1 and r2 for sliding and
tail-oriented windows, e1 and e2 for event-based sliding windows):<br />
<br />
1. for sliding windows based on the number of patients (&quot;sliding&quot;), r1 is the minimum number
of patients allowed in overlapping windows and r2 is the approximate size of subpopulation
in each window;<br />
<br />
2. for sliding windows based on the number of events (&quot;sliding_events&quot;), e1 is the minimum
number of events allowed in overlapping windows and e2 is the approximate size of
subpopulation in each window in terms of number of events;<br />
<br />
3. for tail-oriented window, r1 is a vector of maximum covariate value for each subpopulation
from the minimum value of the entire subpopulation, and r2 is a vector of minimum covariate
values for each subpopulation from the maximum value of the window. The utility function 
<code><a href="#topic+gen.tailwin">gen.tailwin</a>()</code> can be used to generate these vectors based on the number of desired 
subpopulations.<br />
<br />
When &quot;sliding_events&quot; is chosen r1 and r2 are set to <code>NULL</code>, while when &quot;sliding&quot; or
&quot;tail-oriented&quot; are chosen e1 and e2 are set to <code>NULL</code>.<br />
<br />
These pattern are based on all patients.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("stwin", type="sliding", r1=5, r2=20)</code> or
the constructor function <code>stepp.win</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>type</code>:</dt><dd><p>Object of class <code>"character"</code> <br />
stepp window type; <code>"sliding"</code>, <code>"sliding_events"</code> or <code>"tail-oriented"</code></p>
</dd>
<dt><code>r1</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br /> 
sliding window: minimum number of patients allowed in overlapping windows;<br />
tail-oriented window: a vector of maximum covariate value for each subpopulation</p>
</dd>
<dt><code>r2</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br />
sliding window: size of subpopulation in each window;<br />
tail-oriented window: a vector of minimum covariate value for each subpopulation</p>
</dd>
<dt><code>e1</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br /> 
event-based sliding window: minimum number of events allowed in overlapping windows</p>
</dd>
<dt><code>e2</code>:</dt><dd><p>Object of class <code>"numeric"</code> or <code>NULL</code> <br />
event-based sliding window: number of events in each subpopulation</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>summary</dt><dd><p><code>signature(object = "stwin")</code>: <br />
print a summary of the stepp windows object </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wai-Ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+stepp.test">stepp.test</a></code>,       <code><a href="#topic+estimate">estimate</a></code>,         <code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  showClass("stwin")

  # create a stepp window of type "sliding" with (r2) size of subpopulation
  # in each window to be 200 and (r1) allows only 50 patients in the
  # overlapping windows
  mywin &lt;- new("stwin", type="sliding", r1=50, r2=200)

  # print a summary of the stepp window object created
  summary(mywin)

  # create a stepp window object of type "sliding_events", 
  # (event-based) subpopulation size is 200 and allows
  # only 50 events between overlapping windows
  mywin &lt;- stepp.win(type="sliding_events", e1=50, e2=200)

  # print a summary of the stepp window object
  summary(mywin) 
</code></pre>

<hr>
<h2 id='test'>
the standard generic function for all test methods
</h2><span id='topic+test'></span>

<h3>Description</h3>

<p>The default generic function for test methods for all stepp models classes and the steppes class.
</p>
<p>For detail, please refer to the documentation in the test method in the S4 class: stmodelCI, stmodelKM and stmodelGLM.
</p>


<h3>Author(s)</h3>

<p>Wai-ki Yip
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stwin-class">stwin</a></code>,     <code><a href="#topic+stsubpop-class">stsubpop</a></code>,  <code><a href="#topic+stmodelKM-class">stmodelKM</a></code>, 
<code><a href="#topic+stmodelCI-class">stmodelCI</a></code>, <code><a href="#topic+stmodelGLM-class">stmodelGLM</a></code>, 
<code><a href="#topic+steppes-class">steppes</a></code>,   <code><a href="#topic+stmodel-class">stmodel</a></code>, 
<code><a href="#topic+stepp.win">stepp.win</a></code>,        <code><a href="#topic+stepp.subpop">stepp.subpop</a></code>,     <code><a href="#topic+stepp.KM">stepp.KM</a></code>,
<code><a href="#topic+stepp.CI">stepp.CI</a></code>,         <code><a href="#topic+stepp.GLM">stepp.GLM</a></code>,
<code><a href="#topic+generate">generate</a></code>,         <code><a href="#topic+estimate">estimate</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
