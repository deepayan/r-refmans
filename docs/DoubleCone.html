<!DOCTYPE html><html lang="en"><head><title>Help for package DoubleCone</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DoubleCone}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DoubleCone-package'>
<p>Test against a Parametric Function</p></a></li>
<li><a href='#adhd'><p>Sub-clinical ADHD behaviors and classroom functioning in school-age children</p></a></li>
<li><a href='#agconst'><p>Test null hypothesis of constant regression function against a general, high-dimensional alternative</p></a></li>
<li><a href='#derby'><p>Kentucky Derby Winner Speed</p></a></li>
<li><a href='#doubconetest'><p>Test for a vector being in the null space of a double cone</p></a></li>
<li><a href='#partlintest'><p>Tests linear versus partial linear model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Test Against Parametric Regression Function</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Mary C Meyer, Bodhisattva Sen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mary C Meyer &lt;meyer@stat.colostate.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs hypothesis tests concerning a regression function in a least-squares model, where the null is a parametric function, and the alternative is the union of large-dimensional convex polyhedral cones. See Bodhisattva Sen and Mary C Meyer (2016) &lt;<a href="https://doi.org/10.1111%2Frssb.12178">doi:10.1111/rssb.12178</a>&gt; for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>graphics, grDevices, stats, utils, coneproj (&ge; 1.12), Matrix,
MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-02 14:44:29 UTC; xiyueliao</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-02 18:52:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='DoubleCone-package'>
Test against a Parametric Function</h2><span id='topic+DoubleCone-package'></span><span id='topic+DoubleCone'></span>

<h3>Description</h3>

<p>Given a response and predictors, the null hypothesis of a parametric regression function is tested versus a large-dimensional alternative in the form of a union of polyhedral convex cones.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DoubleCone</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-10-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The <code>doubconetest</code> function is the generic version.  The user provides an irreducible constraint matrix that defines two convex cones; the intersection of the cones is the null space of the matrix.   The function provides a p-value for the test that the expected value of a vector is in the null space using the double-cone alternative.   
</p>
<p>Given a vector <code>y</code> and a design matrix <code>X</code>, the <code>agconst</code> function performs a test of the null hypothesis that the expected value of <code>y</code> is constant versus the alternative that it is monotone (increasing or decreasing) in each of the predictors.   
</p>
<p>The function <code>partlintest</code> performs a test of a linear model versus a partial linear model, using a double-cone alternative.
</p>


<h3>Author(s)</h3>

<p>Mary C Meyer and Bodhisattva Sen
Maintainer: Mary C Meyer &lt;meyer@stat.colostate.edu&gt;
</p>


<h3>References</h3>

<p>TBA
</p>

<hr>
<h2 id='adhd'>Sub-clinical ADHD behaviors and classroom functioning in school-age children</h2><span id='topic+adhd'></span>

<h3>Description</h3>

<p>Observations on children aged 9-11 in classroom settings, for a study on the effects of sub-clinical hyperactive and inattentive behaviors on social and academic functioning.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(adhd)</code></pre>


<h3>Format</h3>

<p>A data frame with 686 observations on the following 4 variables.
</p>

<dl>
<dt><code>sex</code></dt><dd><p>1=boy; 2=girl</p>
</dd>
<dt><code>ethn</code></dt><dd><p>1=Colombian, 2=African American, 3=Hispanic American, 5=European American</p>
</dd>
<dt><code>hypb</code></dt><dd><p>Classroom hyperactive behavior level</p>
</dd>
<dt><code>fcn</code></dt><dd><p>A measure of social and academic functioning</p>
</dd>
</dl>



<h3>Source</h3>

<p>Brewis, A.A. Schmidt, K.L., and Meyer, M.C. (2000) ADHD-type behavior and harmful dysfunction in childhood: a cross-cultural model, American Anthropologist, 102(4), pp823-828.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(adhd)
plot(adhd$hypb,adhd$fcn) 
</code></pre>

<hr>
<h2 id='agconst'>Test null hypothesis of constant regression function against a general, high-dimensional alternative</h2><span id='topic+agconst'></span>

<h3>Description</h3>

<p>Given a response and 1-3 predictors, the function will test the null hypothesis that the response and predictors are not related (i.e., regression function is constant), against the alternative that the regression function is monotone in each of the predictors.   For one predictor, the alternative set is a double cone; for two predictors the alternative set is a quadruple cone, and an octuple cone alternative is used when there are three predictors.</p>


<h3>Usage</h3>

<pre><code class='language-R'>agconst(y, xmat, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="agconst_+3A_y">y</code></td>
<td>
<p>A numeric response vector, length n
</p>
</td></tr>
<tr><td><code id="agconst_+3A_xmat">xmat</code></td>
<td>
<p>an n by k design matrix, full column rank, where k=1,2, or 3.
</p>
</td></tr>
<tr><td><code id="agconst_+3A_nsim">nsim</code></td>
<td>
<p>The number of data sets simulated under the null hypothesis, to estimate the null distribution of the test statistic.  The default is 1000, make this larger if a more precise p-value is desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For one predictor, the set of non-decreasing regression functions can be described by an n-dimensional convex polyhedral cone, and the set of non-increasing regression functions is the &quot;opposite&quot; cone.  The one-dimensional null space is the intersection of these cones.   For two predictors, the alternative set consists of four cones, defined by combinations of increasing/decreasing assumptions, and for three predictors we have eight cones.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pval</code></td>
<td>
<p>The p-value for the test: H0: constant regression function</p>
</td></tr>
<tr><td><code>p1 through p8</code></td>
<td>
<p>monotone fits &ndash; only p1 and p2 are returned for one predictor, etc.</p>
</td></tr>
<tr><td><code>thetahat</code></td>
<td>
<p>The least-squares alternative fit &ndash; i.e., the projection onto the multiple-cone alternative</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mary C Meyer and Bodhisattva Sen</p>


<h3>References</h3>

<p>TBA
</p>


<h3>See Also</h3>

<p><code><a href="#topic+doubconetest">doubconetest</a></code>,<code><a href="#topic+partlintest">partlintest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	n=100
	x1=runif(n);x2=runif(n);xmat=cbind(x1,x2)
	mu=1:n;for(i in 1:n){mu[i]=20*max(x1[i]-2/3,x2[i]-2/3,0)^2}
	x1g=1:21/22;x2g=x1g
	par(mar=c(1,1,1,1))
	y=mu+rnorm(n)
	ans=agconst(y,xmat,nsim=0)
	grfit=matrix(nrow=21,ncol=21)
	for(i in 1:21){for(j in 1:21){
			if(sum(x1&gt;=x1g[i]&amp;x2&gt;=x2g[j])&gt;0){
				if(sum(x1&lt;=x1g[i]&amp;x2&lt;=x2g[j])&gt;0){
					f1=min(ans$thetahat[x1&gt;=x1g[i]&amp;x2&gt;=x2g[j]])
					f2=max(ans$thetahat[x1&lt;=x1g[i]&amp;x2&lt;=x2g[j]])
					grfit[i,j]=(f1+f2)/2
				}else{
					grfit[i,j]=min(ans$thetahat)
				}
			}else{grfit[i,j]=max(ans$thetahat)}
	}}
	persp(x1g,x2g,grfit,th=-50,tick="detailed",xlab="x1",ylab="x2",zlab="mu")
##to get p-value for test against constant function:
#	ans=agconst(y,xmat,nsim=1000)
#	ans$pval
</code></pre>

<hr>
<h2 id='derby'>Kentucky Derby Winner Speed</h2><span id='topic+derby'></span>

<h3>Description</h3>

<p>The Speeds of the Winning Horses in the Kentucky Derby, 1896-2012</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(derby)</code></pre>


<h3>Format</h3>

<p>A data frame with 117 observations on the following 4 variables.
</p>

<dl>
<dt><code>speed</code></dt><dd><p>winning speed</p>
</dd>
<dt><code>year</code></dt><dd><p>year of race</p>
</dd>
<dt><code>cond</code></dt><dd><p>track condition with levels <code>fast</code> <code>good</code> <code>heav</code> <code>mudd</code> <code>slop</code> <code>slow</code></p>
</dd>
<dt><code>name</code></dt><dd><p>Name of the winning horse</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="www.kentuckyderby.com">www.kentuckyderby.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(derby)
n=length(derby$year)
track=1:n*0+1
track[derby$cond=="good"]=2
track[derby$cond=="fast"]=3
plot(derby$year,derby$speed,col=track)
</code></pre>

<hr>
<h2 id='doubconetest'>Test for a vector being in the null space of a double cone
</h2><span id='topic+doubconetest'></span>

<h3>Description</h3>

<p>Given an n-vector y and the model y=m+e, and an m by n &quot;irreducible&quot; matrix amat, test the null hypothesis that the vector m is in the null space of amat.</p>


<h3>Usage</h3>

<pre><code class='language-R'>doubconetest(y, amat, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doubconetest_+3A_y">y</code></td>
<td>
<p>a vector of length n
</p>
</td></tr>
<tr><td><code id="doubconetest_+3A_amat">amat</code></td>
<td>
<p>an m by n &quot;irreducible&quot; matrix
</p>
</td></tr>
<tr><td><code id="doubconetest_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations to approximate null distribution &ndash; default is 1000, but choose more if a more precise p-value is desired
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix amat defines a polyhedral convex cone of vectors x such that amat%*%x&gt;=0, and also the opposite cone amat%*%x&lt;=0.   The linear space C is those x such that amat%*%x=0.  The function provides a p-value for the null hypothesis that m=E(y) is in C, versus the alternative that it is in one of the two cones defined by amat.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pval</code></td>
<td>
<p>The p-value for the test</p>
</td></tr> 
<tr><td><code>p0</code></td>
<td>
<p>The least-squares fit under the null hypothesis</p>
</td></tr>
<tr><td><code>p1</code></td>
<td>
<p>The least-squares fit to the &quot;positive&quot; cone</p>
</td></tr>
<tr><td><code>p2</code></td>
<td>
<p>The least-squares fit to the &quot;negative&quot; cone</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mary C Meyer and Bodhisattva Sen
</p>


<h3>References</h3>

<p>TBA,
Meyer, M.C. (1999) An Extension of the Mixed Primal-Dual Bases Algorithm to the Case of More Constraints than Dimensions, Journal of Statistical Planning and Inference, 81, pp13-31.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+agconst">agconst</a></code>,<code><a href="#topic+partlintest">partlintest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## test against a constant function
n=100
x=1:n/n
mu=4-5*(x-1/2)^2
y=mu+rnorm(n)
amat=matrix(0,nrow=n-1,ncol=n)
for(i in 1:(n-1)){amat[i,i]=-1;amat[i,i+1]=1}
ans=doubconetest(y,amat)
ans$pval
plot(x,y,col="slategray");lines(x,mu,lty=3,col=3)
lines(x,ans$p1,col=2)
lines(x,ans$p2,col=4)
</code></pre>

<hr>
<h2 id='partlintest'>Tests linear versus partial linear model
</h2><span id='topic+partlintest'></span>

<h3>Description</h3>

<p>Given a response y, a predictor x, and covariates z, the model y=m(x) +b'z +e is considered, where e is a mean-zero random error.   There are three options for the null hypothesis: h0=0 tests m(x) is constant; h0=1 tests m(x) is linear, and h0=2 tests m(x) is quadratic.   The (respective) alternatives are: m(x) is increasing or decreasing, m(x) is convex or concave, and m(x) is hyper-convex or hyper-concave (referring to the third derivative of m).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partlintest(x, y, zmat, h0 = 0, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partlintest_+3A_x">x</code></td>
<td>
<p>a vector of length n; this is the main predictor of interest
</p>
</td></tr>
<tr><td><code id="partlintest_+3A_y">y</code></td>
<td>
<p>a vector of length n; this is the response
</p>
</td></tr>
<tr><td><code id="partlintest_+3A_zmat">zmat</code></td>
<td>
<p>an n by k matrix of covariates, should be full column rank . 
</p>
</td></tr>
<tr><td><code id="partlintest_+3A_h0">h0</code></td>
<td>
<p>An indicator of what null hypothesis is to be tested: h0=0 for the null hypothesis: m(x) is constant; h0=1 tests m(x) is linear, and h0=2 tests m(x) is quadratic. 
</p>
</td></tr>
<tr><td><code id="partlintest_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations used in creating the null distribution of the test statistic.  The default is nsim=1000, if a more precise p-value is desired, make nsim larger.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the constant null hypothesis, the alternative fit is either the monotone increasing or monotone decreasing fit &ndash; whichever minimizes the sum of squared residuals.  For the linear null hypothsis, the alternative fit is either convex or concave, and for the quadratic null hypothesis, the alternative fit is constrained so that the third derivative is either positive or negative over the range of x-values.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pval</code></td>
<td>
<p>The p-value for the test</p>
</td></tr>
<tr><td><code>p0</code></td>
<td>
<p>The null hypothesis fit</p>
</td></tr>
<tr><td><code>p1</code></td>
<td>
<p>The &quot;positive&quot; fit</p>
</td></tr>
<tr><td><code>p2</code></td>
<td>
<p>The &quot;negative&quot; fit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mary C Meyer and Bodhisattva Sen
</p>


<h3>References</h3>

<p>TBA
</p>


<h3>See Also</h3>

<p><code><a href="#topic+agconst">agconst</a></code>,<code><a href="#topic+doubconetest">doubconetest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(derby)
n=length(derby$speed)
zmat=matrix(0,nrow=n,ncol=2);zvec=1:n*0+1
zmat[derby$cond=="good",1]=1;zvec[derby$cond=="good"]=2
zmat[derby$cond=="fast",2]=1;zvec[derby$cond=="fast"]=3
ans=partlintest(derby$year,derby$speed,zmat,h0=2)
ans$pval
par(mar=c(4,4,1,1));par(mfrow=c(1,2))
plot(derby$year,derby$speed,col=zvec,pch=zvec)
points(derby$year,ans$p0,pch=20,col=zvec)
title("Null fit")
legend(1980,51.6,pch=3:1,col=3:1,legend=c("fast","good","slow"))
plot(derby$year,derby$speed,col=zvec,pch=zvec)
points(derby$year,ans$p1,pch=20,col=zvec)
title("Alternative fit")

data(adhd)
n=length(adhd$sex)
zmat=matrix(0,nrow=n,ncol=2)
zmat[adhd$sex==1,1]=1
zmat[adhd$ethn&lt;5,2]=1
ans=partlintest(adhd$hypb,adhd$fcn,zmat,h0=1)
ans$pval
cols=c("pink3","lightskyblue3")
plot(adhd$hypb,adhd$fcn,col=cols[zmat[,1]+1],pch=zmat[,2]+1,
xlab="Hyperactive behavior level",ylab="Social and Academic Function Score")
cols2=c(2,4)
points(adhd$hypb,ans$p1,col=cols2[zmat[,1]+1],pch=20)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
