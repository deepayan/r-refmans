<!DOCTYPE html><html><head><title>Help for package nlmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fixef.nlmm'>
<p>Extract Generalized Mixed-Effects Models Coefficients</p></a></li>
<li><a href='#generate.data'>
<p>Simulate Data from Mixed-Effects Models</p></a></li>
<li><a href='#GenLaplace'>
<p>The Univariate Symmetric Generalized Laplace Distribution</p></a></li>
<li><a href='#Laplace'>
<p>The Laplace Distribution</p></a></li>
<li><a href='#logLik.nlmm'>
<p>Extract Log-Likelihood</p></a></li>
<li><a href='#lrt_nlmm'>
<p>Likelihood Ratio Test for Generalized Laplace Mixed-Effects Models</p></a></li>
<li><a href='#MultivariateGenLaplace'>
<p>The Multivariate Asymmetric Generalized Laplace Distribution</p></a></li>
<li><a href='#MultivariateLaplace'>
<p>The Multivariate Asymmetric Laplace Distribution</p></a></li>
<li><a href='#nlmm'>
<p>Fitting Generalized Laplace Mixed-Effects Models</p></a></li>
<li><a href='#nlmm-internal'><p>Internal nlmm objects</p></a></li>
<li><a href='#nlmm-package'><p>nlmm: Generalized Laplace Mixed-Effects Models</p></a></li>
<li><a href='#nlmmControl'>
<p>Control parameters for nlmm estimation</p></a></li>
<li><a href='#predict.nlmm'>
<p>Predictions from an <code>nlmm</code> Object</p></a></li>
<li><a href='#print.nlmm'>
<p>Print an <code>nlmm</code> Object</p></a></li>
<li><a href='#print.summary.nlmm'>
<p>Print an <code>nlmm</code> Summary Object</p></a></li>
<li><a href='#ranef.nlmm'>
<p>Extract Random Effects</p></a></li>
<li><a href='#rats'><p>Growth curves</p></a></li>
<li><a href='#residuals.nlmm'>
<p>Residuals from an <code>nlmm</code> Object</p></a></li>
<li><a href='#summary.nlmm'><p>Summary for an <code>nlmm</code> Object</p></a></li>
<li><a href='#VarCorr.nlmm'>
<p>Extract Variance-Covariance Matrix</p></a></li>
<li><a href='#vcov.nlmm'>
<p>Calculate Variance-Covariance Matrix for a Fitted Generalized Laplace Mixed-Effects Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Laplace Mixed-Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Geraci &lt;marco.geraci@uniroma1.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), nlme</td>
</tr>
<tr>
<td>Imports:</td>
<td>gsl, lqmm, MASS, Matrix, mvtnorm, numDeriv, statmod, stats,
Qtools, Rcpp (&ge; 0.12.13), utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, BH</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to fit linear mixed models
	based on convolutions of the generalized Laplace (GL) distribution.
	The GL mixed-effects model includes four special cases with normal random
	effects and normal errors (NN), normal random effects and Laplace errors (NL),
	Laplace random effects and normal errors (LN), and Laplace random effects
	and Laplace errors (LL). The methods are described in Geraci and Farcomeni (2020,
	Statistical Methods in Medical Research) &lt;<a href="https://doi.org/10.1177%2F0962280220903763">doi:10.1177/0962280220903763</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-24 12:00:43 UTC; marco</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco Geraci <a href="https://orcid.org/0000-0002-6311-8685"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph, cre],
  Alessio Farcomeni [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-24 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fixef.nlmm'>
Extract Generalized Mixed-Effects Models Coefficients
</h2><span id='topic+fixef'></span><span id='topic+fixef.nlmm'></span>

<h3>Description</h3>

<p><code>fixef</code> extracts estimated fixed effects from <code>nlmm</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
fixef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixef.nlmm_+3A_object">object</code></td>
<td>

<p>a <code>nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="fixef.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of estimated fixed effects. 
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
<code><a href="#topic+summary.nlmm">summary.nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)
fit &lt;- nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(multistart = FALSE))
fixef(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='generate.data'>
Simulate Data from Mixed-Effects Models
</h2><span id='topic+generate.data'></span>

<h3>Description</h3>

<p>This function generates data from a 2-level hierarchical design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.data(R, n, M, sigma_1 = NULL, sigma_2 = NULL,
	shape_1 = NULL, shape_2 = NULL, dist.u, dist.e,
	beta, gamma, fixed = FALSE, seed = round(runif(1,1,1000)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.data_+3A_r">R</code></td>
<td>

<p>number of replications.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_n">n</code></td>
<td>

<p>number of observations within cluster.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_m">M</code></td>
<td>

<p>number of clusters.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_sigma_1">sigma_1</code></td>
<td>

<p>scale parameter for the random effects.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_sigma_2">sigma_2</code></td>
<td>

<p>scale parameter for the errors.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_shape_1">shape_1</code></td>
<td>

<p>shape parameter for the random effects.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_shape_2">shape_2</code></td>
<td>

<p>shape parameter for the errors.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_dist.u">dist.u</code></td>
<td>

<p>distribution of the random effects.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_dist.e">dist.e</code></td>
<td>

<p>distribution of the errors.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_beta">beta</code></td>
<td>

<p>vector of coefficients for fixed effects.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_gamma">gamma</code></td>
<td>

<p>vector of coefficients for heteroscedasticity.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_fixed">fixed</code></td>
<td>

<p>logical flag. See details.
</p>
</td></tr>
<tr><td><code id="generate.data_+3A_seed">seed</code></td>
<td>

<p>seed for random number generation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates data as in the simulation study by Geraci and Farcomeni (2020). The data-generating model is
</p>
<p style="text-align: center;"><code class="reqn">
y[ij] = \beta[0] + \beta[1]x[ij] + \beta[2]z[ij] + u[i] + v[i]x[ij] + (\gamma[0] + \gamma[1]x[ij])e[ij]
</code>
</p>

<p>where <code class="reqn">(u[i],v[i])</code> follows a distribution with scale <code>sigma_1</code> and shape <code>shape_1</code>, and <code class="reqn">e</code> follows a distribution with scale <code>sigma_2</code> and shape <code>shape_2</code>.
</p>
<p>The scale parameter <code>sigma_1</code> must be a 1 by 1 or a 2 by 2 matrix. In the former case, the model will include only random intercepts. In the latter case, then both random intercepts and slopes will be included. Currently, no more than 2 random effects can be specified. The scale parameter <code>sigma_2</code> must be a matrix <code>n</code> by <code>n</code>.
</p>
<p>The options for <code>dist.u</code> and <code>dist.e</code> are: multivariate normal (&quot;norm&quot;) (<code><a href="mvtnorm.html#topic+rmvnorm">rmvnorm</a></code>), multivariate symmetric Laplace (&quot;laplace&quot;) (<code><a href="#topic+rmal">rmal</a></code>), multivariate symmetric generalized Laplace (&quot;genlaplace&quot;) <code><a href="#topic+rmgl">rmgl</a></code>, and multivariate Student's t (&quot;t&quot;) (<code><a href="mvtnorm.html#topic+rmvt">rmvt</a></code>).
</p>
<p>The shape parameter specifies the degrees of freedom for Student's t and chi-squared, and the kurtosis of the generalized Laplace.
</p>
<p>The values <code class="reqn">x[ij]</code> are generated as <code class="reqn">x[ij] = \delta[i] + \zeta[ij]</code>, where <code class="reqn">\delta[i]</code> and <code class="reqn">\zeta[ij]</code> are independent standard normal. If the argument <code>fixed = TRUE</code>, then <code class="reqn">x[ij] = j</code>. The values <code class="reqn">z[ij]</code> are generated from Bernoullis with probability 0.5.
</p>


<h3>Value</h3>

<p><code>nlmm</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>nlmm</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>nlmm</code> is a list containing the following components:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>a matrix <code class="reqn">R x N</code>, where <code class="reqn">N = n x M</code>, with responses</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>an array <code class="reqn">N x 3 x R</code> with fixed design matrix</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>vector of length <code class="reqn">N</code> with cluster labels</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>an array <code class="reqn">M x 2 x R</code> with random effects</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>a matrix <code class="reqn">R x N</code> with errors</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate 10 replications from a homoscedastic normal mixed model.
generate.data(R = 10, n = 3, M = 5, sigma_1 = diag(2), sigma_2 = diag(3),
shape_1 = NULL, shape_2 = NULL, dist.u = "norm", dist.e = "norm",
beta = c(1,2,1), gamma = c(1,0))

# Simulate 10 replications from a generalized Laplace. Note: the shape
# parameter that is passed to rmgl corresponds to the reciprocal of the
# parameter alpha in Geraci and Farcomeni (2020)
generate.data(R = 10, n = 3, M = 5, sigma_1 = diag(2), sigma_2 = diag(3),
shape_1 = 1/0.5, shape_2 = 1/0.5, dist.u = "genlaplace", dist.e = "genlaplace",
beta = c(1,2,1), gamma = c(1,0))
 
</code></pre>

<hr>
<h2 id='GenLaplace'>
The Univariate Symmetric Generalized Laplace Distribution
</h2><span id='topic+GenLaplace'></span><span id='topic+dgl'></span><span id='topic+pgl'></span><span id='topic+qgl'></span><span id='topic+rgl'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the univariate symmetric generalized Laplace distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgl(x, sigma = 1, shape = 1, log = FALSE)
pgl(x, sigma = 1, shape = 1, lower.tail = TRUE, log.p = FALSE)
qgl(p, sigma = 1, shape = 1, lower.tail = TRUE, log.p = FALSE)
rgl(n, sigma = 1, shape = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenLaplace_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_sigma">sigma</code></td>
<td>

<p>positive scale parameter.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_shape">shape</code></td>
<td>

<p>shape parameter.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_log">log</code>, <code id="GenLaplace_+3A_log.p">log.p</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities are log&ndash;transformed.
</p>
</td></tr>
<tr><td><code id="GenLaplace_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if <code>TRUE</code> (default), probabilities are <code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>. Similarly for quantiles.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The univariate symmetric generalized Laplace distribution (Kotz et al, 2001, p.190) has density
</p>
<p style="text-align: center;"><code class="reqn">
f(x) =
\frac{2}{\sqrt{2\pi}\Gamma(s)\sigma^{s+1/2}}(\frac{|x|}{\sqrt{2}})^{\omega}B_{\omega}(\frac{\sqrt{2}|x|}{\sigma})
</code>
</p>

<p>where <code class="reqn">\sigma</code> is the scale parameter, <code class="reqn">\omega = s - 1/2</code>, and <code class="reqn">s</code> is the shape parameter. <code class="reqn">\Gamma</code> denotes the Gamma function and <code class="reqn">B_{u}</code> the modified Bessel function of the third kind with index <code class="reqn">u</code>. The variance is <code class="reqn">s\sigma^{2}</code>.
</p>
<p>This distribution is the univariate and symmetric case of <code><a href="#topic+MultivariateGenLaplace">MultivariateGenLaplace</a></code>.
</p>


<h3>Value</h3>

<p><code>dgl</code> gives the density, <code>pgl</code> gives the distribution function, <code>qgl</code> gives the quantile function, and <code>rgl</code> generates random deviates.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Kotz, S., Kozubowski, T., and Podgorski, K. (2001). The Laplace distribution and generalizations. Boston, MA: Birkhauser.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultivariateGenLaplace">MultivariateGenLaplace</a></code>
</p>

<hr>
<h2 id='Laplace'>
The Laplace Distribution
</h2><span id='topic+Laplace'></span><span id='topic+dl'></span><span id='topic+pl'></span><span id='topic+ql'></span><span id='topic+rl'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the (symmetric) Laplace distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dl(x, mu = 0, sigma = 1, log = FALSE)
pl(x, mu = 0, sigma = 1, lower.tail = TRUE, log.p = FALSE)
ql(p, mu = 0, sigma = 1, lower.tail = TRUE, log.p = FALSE)
rl(n, mu = 0, sigma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Laplace_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_mu">mu</code></td>
<td>

<p>location parameter.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_sigma">sigma</code></td>
<td>

<p>positive scale parameter.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_log">log</code>, <code id="Laplace_+3A_log.p">log.p</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities are log&ndash;transformed.
</p>
</td></tr>
<tr><td><code id="Laplace_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if <code>TRUE</code> (default), probabilities are <code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>. Similarly for quantiles.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Laplace distribution has density
</p>
<p style="text-align: center;"><code class="reqn">
f(x) =
\frac{1}{\sqrt{2}\sigma}e^{-\frac{\sqrt(2)}{\sigma} |x - \mu|}
</code>
</p>

<p>where <code class="reqn">\mu</code> is the location parameter and <code class="reqn">\sigma</code> is the scale parameter. Note that based on this parameterization, the distribution has variance <code class="reqn">\sigma^2</code>.
</p>


<h3>Value</h3>

<p><code>dl</code> gives the density and <code>rl</code> generates random deviates.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Kotz, S., Kozubowski, T., and Podgorski, K. (2001). The Laplace distribution and generalizations. Boston, MA: Birkhauser.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultivariateLaplace">MultivariateLaplace</a></code>, <code><a href="#topic+GenLaplace">GenLaplace</a></code>
</p>

<hr>
<h2 id='logLik.nlmm'>
Extract Log-Likelihood
</h2><span id='topic+logLik.nlmm'></span>

<h3>Description</h3>

<p><code>logLik.nlmm</code> extracts the log-likelihood of a fitted nlmm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.nlmm_+3A_object">object</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> &quot;nlmm&quot;.
</p>
</td></tr>
<tr><td><code id="logLik.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the loglikelihood of the fitted model. This is a number with at one attribute, &quot;df&quot; (degrees of freedom), giving the number of (estimated) parameters in the model.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>

<hr>
<h2 id='lrt_nlmm'>
Likelihood Ratio Test for Generalized Laplace Mixed-Effects Models
</h2><span id='topic+lrt_nlmm'></span><span id='topic+print.lrt_nlmm'></span>

<h3>Description</h3>

<p>This function is used to perform a likelihood ratio test for two fitted generalized Laplace mixed-effects models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt_nlmm(object0, object1)
## S3 method for class 'lrt_nlmm'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrt_nlmm_+3A_object0">object0</code></td>
<td>

<p>object of class <code>nlmm</code> with estimates of the constrained model.
</p>
</td></tr>
<tr><td><code id="lrt_nlmm_+3A_object1">object1</code></td>
<td>

<p>object of class <code>nlmm</code> with estimates of the unconstrained model.
</p>
</td></tr>
<tr><td><code id="lrt_nlmm_+3A_x">x</code></td>
<td>

<p>a <code>lrt_nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="lrt_nlmm_+3A_digits">digits</code></td>
<td>

<p>a non-null value for digits specifies the minimum number of significant digits to be printed in values.
</p>
</td></tr>
<tr><td><code id="lrt_nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>lrt_nlmm</code> is a list containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>either the degrees of freedom of a chi-squared test or the weights of a chi-bar-squared test</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>the matrix based on which the weights for the chi-bar-squared test are calculated</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>values of the shape parameter in the constrained object</p>
</td></tr>
<tr><td><code>alpha.index</code></td>
<td>
<p>index of the constrained shape parameter</p>
</td></tr>
<tr><td><code>chibar</code></td>
<td>
<p>logical flag. If <code>TRUE</code>, the test statistic is a chi-bar</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function <code>lrt_nlmm</code> is a wrapper for routines developed by Alessio Farcomeni.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci and Alessio Farcomeni
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>

<hr>
<h2 id='MultivariateGenLaplace'>
The Multivariate Asymmetric Generalized Laplace Distribution
</h2><span id='topic+MultivariateGenLaplace'></span><span id='topic+dmgl'></span><span id='topic+rmgl'></span>

<h3>Description</h3>

<p>Density and random generation for the multivariate asymmetric generalized Laplace distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmgl(x, mu = rep(0, d), sigma = diag(d), shape = 1, log = FALSE)
rmgl(n, mu, sigma, shape = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultivariateGenLaplace_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="MultivariateGenLaplace_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="MultivariateGenLaplace_+3A_mu">mu</code></td>
<td>

<p>simmetry parameter.
</p>
</td></tr>
<tr><td><code id="MultivariateGenLaplace_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter &ndash; positive-definite matrix.
</p>
</td></tr>
<tr><td><code id="MultivariateGenLaplace_+3A_shape">shape</code></td>
<td>

<p>shape parameter.
</p>
</td></tr>
<tr><td><code id="MultivariateGenLaplace_+3A_log">log</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities are log&ndash;transformed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the distribution described by Kozubowski et al (2013) and has density
</p>
<p style="text-align: center;"><code class="reqn">
f(x) =
\frac{2\exp(\mu'\Sigma^{-1}x)}{(2\pi)^{d/2}\Gamma(s)|\Sigma|^{1/2}}(\frac{Q(x)}{C(\Sigma,\mu)})^{\omega}B_{\omega}(Q(x)C(\Sigma,\mu))
</code>
</p>

<p>where <code class="reqn">\mu</code> is the symmetry parameter, <code class="reqn">\Sigma</code> is the scale parameter, <code class="reqn">Q(x)=\sqrt{x'\Sigma^{-1}x}</code>, <code class="reqn">C(\Sigma,\mu)=\sqrt{2+\mu'\Sigma^{-1}\mu}</code>, <code class="reqn">\omega = s - d/2</code>, <code class="reqn">d</code> is the dimension of <code class="reqn">x</code>, and <code class="reqn">s</code> is the shape parameter (note that the parameterization in <code><a href="#topic+nlmm">nlmm</a></code> is <code class="reqn">\alpha = \frac{1}{s}</code>). <code class="reqn">\Gamma</code> denotes the Gamma function and <code class="reqn">B_{u}</code> the modified Bessel function of the third kind with index <code class="reqn">u</code>. The parameter <code class="reqn">\mu</code> is related to the skewness of the distribution (symmetric if <code class="reqn">\mu = 0</code>). The variance-covariance matrix is <code class="reqn">s(\Sigma + \mu\mu')</code>. The multivariate asymmetric Laplace is obtained when <code class="reqn">s = 1</code> (see <code><a href="#topic+MultivariateLaplace">MultivariateLaplace</a></code>). 
</p>
<p>In the symmetric case (<code class="reqn">\mu = 0</code>), the multivariate GL distribution has two special cases: multivariate normal for <code class="reqn">s \rightarrow \infty</code> and multivariate symmetric Laplace for <code class="reqn">s = 1</code>.
</p>
<p>The <b>univariate symmetric</b> GL distribution is provided via <code><a href="#topic+GenLaplace">GenLaplace</a></code>, which gives the distribution and quantile functions in addition to the density and random generation functions.
</p>


<h3>Value</h3>

<p><code>dmgl</code> gives the GL density of a <code class="reqn">d</code>-dimensional vector <code>x</code>. <code>rmgl</code> generates a sample of size <code>n</code> of <code class="reqn">d</code>-dimensional random GL variables.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>
<p>Kozubowski, T. J., K. Podgorski, and I. Rychlik (2013). Multivariate generalized Laplace distribution and related random fields. Journal of Multivariate Analysis 113, 59-72.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GenLaplace">GenLaplace</a></code>
</p>

<hr>
<h2 id='MultivariateLaplace'>
The Multivariate Asymmetric Laplace Distribution
</h2><span id='topic+MultivariateLaplace'></span><span id='topic+dmal'></span><span id='topic+rmal'></span>

<h3>Description</h3>

<p>Density and random generation for the multivariate asymmetric Laplace distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmal(x, mu = rep(0, d), sigma = diag(d), log = FALSE)
rmal(n, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultivariateLaplace_+3A_x">x</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="MultivariateLaplace_+3A_n">n</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="MultivariateLaplace_+3A_mu">mu</code></td>
<td>

<p>asymmetry parameter.
</p>
</td></tr>
<tr><td><code id="MultivariateLaplace_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter &ndash; positive-definite matrix.
</p>
</td></tr>
<tr><td><code id="MultivariateLaplace_+3A_log">log</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities are log&ndash;transformed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the multivariate extension of the (univariate) asymmetric Laplace distribution. It is a special case of <code><a href="#topic+MultivariateGenLaplace">MultivariateGenLaplace</a></code> with <code>shape = 1</code>.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Kotz, S., Kozubowski, T., and Podgorski, K. (2001). The Laplace distribution and generalizations. Boston, MA: Birkhauser.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Laplace">Laplace</a></code>, <code><a href="#topic+MultivariateGenLaplace">MultivariateGenLaplace</a></code>
</p>

<hr>
<h2 id='nlmm'>
Fitting Generalized Laplace Mixed-Effects Models
</h2><span id='topic+nlmm'></span>

<h3>Description</h3>

<p><code>nlmm</code> is used to fit mixed-effects models based on the generalized Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlmm(fixed, random, group, covariance = "pdDiag", data = sys.frame(sys.parent()),
subset, weights = NULL, na.action = na.fail, control = list(), contrasts = NULL,
fit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlmm_+3A_fixed">fixed</code></td>
<td>

<p>an object of class <code><a href="stats.html#topic+formula">formula</a></code> for fixed effects: a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_random">random</code></td>
<td>

<p>a one-sided formula of the form <code>~x1 + x2 + ... + xn</code> for random effects: a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_group">group</code></td>
<td>

<p>grouping factor.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_covariance">covariance</code></td>
<td>

<p>variance&ndash;covariance matrix of the random effects. Default is <code>pdDiag</code> (see details)
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_data">data</code></td>
<td>

<p>an optional data frame containing the variables named in <code>fixed</code>, <code>random</code>, <code>group</code>, and <code>weights</code>. By default the variables are taken from the environment from which <code>nlmm</code> is called.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used in the fitting process.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_weights">weights</code></td>
<td>

<p>an optional <code><a href="nlme.html#topic+varFunc">varFunc</a></code> object or one-sided formula describing the within-group heteroscedasticity structure. If given as a formula, it is used as the argument to <code><a href="nlme.html#topic+varFixed">varFixed</a></code>, corresponding to fixed variance weights. See the documentation on <code><a href="nlme.html#topic+varClasses">varClasses</a></code> in <code>nlme</code> package for a description of the available <code><a href="nlme.html#topic+varFunc">varFunc</a></code> classes. Defaults to <code>NULL</code>, corresponding to homoscedastic within-group errors.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_na.action">na.action</code></td>
<td>

<p>a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>nlmm</code> to print an error message and terminate if there are any
incomplete observations.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_control">control</code></td>
<td>

<p>list of control parameters of the fitting process. See <code><a href="#topic+nlmmControl">nlmmControl</a></code>.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_contrasts">contrasts</code></td>
<td>

<p>not yet implemented.
</p>
</td></tr>
<tr><td><code id="nlmm_+3A_fit">fit</code></td>
<td>

<p>logical flag. If <code>FALSE</code> the function returns a list of objects used for fitting.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function fits a generalized Laplace mixed-effects model conditional on the covariates, as specified by the <code>formula</code> argument, and on random effects, as specified by the <code>random</code> argument. The predictor is assumed to be linear. The function maximizes the (log)likelihood of the generalized Laplace regression as proposed by Geraci and Farcomeni (2020). The likelihood is numerically integrated via Gaussian quadrature techniques. The optimization algorithm can be either <code><a href="stats.html#topic+optim">optim</a></code> (Nelder-Mead by default) or <code><a href="stats.html#topic+nlminb">nlminb</a></code>. See <code><a href="#topic+nlmmControl">nlmmControl</a></code> for more details.
</p>
<p>By default, the function fits a mixed-effects model where both random effects and error term follow a generalized Laplace distribution (<code><a href="#topic+GenLaplace">GenLaplace</a></code>). This is a family of distributions that includes the normal and the Laplace distributions as special cases. Constrained fitting can be controlled via the arguments <code>alpha.index</code> and <code>alpha</code> in <code><a href="#topic+nlmmControl">nlmmControl</a></code>. For example, if <code>alpha.index = 0</code>, the model is Normal-Normal if <code>alpha = c(0,0)</code>, Normal-Laplace if <code>alpha = c(0,1)</code>, Laplace-Normal if <code>alpha = c(1,0)</code>, and Laplace-Laplace if <code>alpha = c(1,1)</code>. But any value of alpha between 0 (normal distribution) and 1 (Laplace distribution) is allowed.
</p>
<p>Different standard types of positive&ndash;definite matrices for the random effects can be specified: <code>pdIdent</code> multiple of an identity; <code>pdCompSymm</code> compound symmetry structure (constant diagonal and constant off&ndash;diagonal elements); <code>pdDiag</code> diagonal; <code>pdSymm</code> general positive&ndash;definite matrix, with no additional structure.
</p>
<p>Within-group heteroscedasticity can be modeled via the <code>weights</code> argument using <code>varClasses</code> in the <code>nlme</code> packages.
</p>


<h3>Value</h3>

<p><code>nlmm</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>nlmm</code>.
</p>
<p>The function <code>summary</code> is used to obtain and print a summary of the results.
</p>
<p>An object of class <code>nlmm</code> is a list containing the following components:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>a vector containing (in this order) fixed regression coefficients, parameters of the variance&ndash;covariance matrix of the random effects, shape parameter, scale parameter, and (optional) within-group variance function parameters. All parameters are unconstrained. See <code><a href="#topic+VarCorr.nlmm">VarCorr.nlmm</a></code> to extract the variance&ndash;covariance of the random effects from an &quot;nlmm&quot; object.</p>
</td></tr>
<tr><td><code>theta_x</code>, <code>theta_z</code></td>
<td>
<p>partition of <code>theta</code>: fixed regression coefficients (<code>theta_x</code>) and unique variance&ndash;covariance unconstrained parameters (<code>theta_z</code>).</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>unconstrained shape parameter.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>constrained shape parameter.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>unconstrained scale parameter.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>constrained scale parameter.</p>
</td></tr>
<tr><td><code>vf</code></td>
<td>
<p>(fitted) within-group variance function of class <code><a href="nlme.html#topic+varFunc">varFunc</a></code>. S3 methods (<code><a href="nlme.html#topic+summary.varFunc">summary.varFunc</a></code>, <code><a href="nlme.html#topic+varWeights.varFunc">varWeights.varFunc</a></code>, <code><a href="nlme.html#topic+coef.varFunc">coef.varFunc</a></code>) can be applied.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>negative log&ndash;likelihood.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>nn</code></td>
<td>
<p>column names of <code>mmf</code>.</p>
</td></tr>
<tr><td><code>mm</code></td>
<td>
<p>column names of <code>mmr</code>.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>dim_theta</code></td>
<td>
<p>the number of columns in <code>mmf</code> and <code>mmr</code>.</p>
</td></tr>
<tr><td><code>dim_theta_z</code></td>
<td>
<p>the length of <code>theta_z</code>.</p>
</td></tr>
<tr><td><code>mmf</code></td>
<td>
<p>the model matrix &ndash; fixed effects.</p>
</td></tr>
<tr><td><code>mmr</code></td>
<td>
<p>the model matrix &ndash; random effects.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the model response.</p>
</td></tr>
<tr><td><code>revOrder</code></td>
<td>
<p>original order of observations (now ordered according to <code>group</code>).</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>the grouping factor.</p>
</td></tr>
<tr><td><code>ngroups</code></td>
<td>
<p>the number of groups.</p>
</td></tr>
<tr><td><code>InitialPar</code></td>
<td>
<p>starting values for theta, included the fitted lme or lm object from where starting values have been taken.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>list of control parameters used for optimization (see <code><a href="#topic+nlmmControl">nlmmControl</a></code>).</p>
</td></tr>
<tr><td><code>cov_name</code></td>
<td>
<p>class of variance-covariance matrix for the random effects.</p>
</td></tr>
<tr><td><code>mfArgs</code></td>
<td>
<p>arguments for <code><a href="stats.html#topic+model.frame">model.frame</a></code> to return the full data frame.</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>model's distribution. &quot;Generalized Laplace&quot; if unconstrained estimation, or one of four special case for specific values of alpha (&quot;Normal-Normal&quot;, &quot;Normal-Laplace&quot;, &quot;Laplace-Normal&quot;, &quot;Laplace-Laplace&quot;).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci M (2017). Mixed-effects models using the normal and the Laplace distributions: A 2 x 2 convolution scheme for applied research. arXiv:1712.07216v1 [stat.ME]. URL: <a href="https://arxiv.org/abs/1712.07216v1">https://arxiv.org/abs/1712.07216v1</a>.
</p>
<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.nlmm">summary.nlmm</a>, <a href="#topic+fixef.nlmm">fixef.nlmm</a>, <a href="#topic+ranef.nlmm">ranef.nlmm</a>, <a href="#topic+VarCorr.nlmm">VarCorr.nlmm</a>, <a href="#topic+predict.nlmm">predict.nlmm</a>, <a href="#topic+residuals.nlmm">residuals.nlmm</a></code>, <code><a href="#topic+nlmmControl">nlmmControl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(rats)

nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(multistart = FALSE))
 
</code></pre>

<hr>
<h2 id='nlmm-internal'>Internal nlmm objects</h2><span id='topic+.First.lib'></span><span id='topic+.Last.lib'></span><span id='topic+AIC.nlmm'></span><span id='topic+lme2nlmm'></span><span id='topic+loglik_nlmm'></span><span id='topic+loglik_alpha_nlmm'></span><span id='topic+pchibarsq'></span><span id='topic+Vchibarsq'></span><span id='topic+wchibarsq'></span><span id='topic+C_wdensgl'></span><span id='topic+C_ll'></span><span id='topic+generate.dist'></span><span id='topic+generate.design'></span>

<h3>Description</h3>

<p>Internal nlmm objects.</p>


<h3>Details</h3>

<p>These are not intended to be called by the user.</p>

<hr>
<h2 id='nlmm-package'>nlmm: Generalized Laplace Mixed-Effects Models</h2><span id='topic+nlmm-package'></span>

<h3>Description</h3>

<p>The nlmm package provides functions to fit linear mixed models
based on convolutions of the generalized Laplace (GL) distribution.
The GL mixed-effects model includes four special cases with normal random
effects and normal errors (NN), normal random effects and Laplace errors (NL),
Laplace random effects and normal errors (LN), and Laplace random effects
and Laplace errors (LL). The methods are described in Geraci and Farcomeni (2020).
See also Geraci (2017) for details on special cases.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> nlmm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-11-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=3)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marco Geraci [aut, cph, cre], Alessio Farcomeni [ctb]
</p>
<p>Maintainer: Marco Geraci &lt;marco.geraci@uniroma1.it&gt;
</p>


<h3>References</h3>

<p>Geraci M (2017). Mixed-effects models using the normal and the Laplace distributions: A 2 x 2 convolution scheme for applied research. arXiv:1712.07216v1 [stat.ME]. URL: <a href="https://arxiv.org/abs/1712.07216v1">https://arxiv.org/abs/1712.07216v1</a>.
</p>
<p>Geraci, M. and Farcomeni A (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research 29(9), 2665-2682.
</p>

<hr>
<h2 id='nlmmControl'>
Control parameters for nlmm estimation
</h2><span id='topic+nlmmControl'></span>

<h3>Description</h3>

<p>A list of parameters for controlling the fitting process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlmmControl(method = "Nelder-Mead", nK = 8, multistart = TRUE,
	grid = c(0.001, 0.5, 0.999), alpha = c(0.5, 0.5), alpha.index = 9,
	lme = TRUE, lmeMethod = "REML", lmeOpt = "nlminb", verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlmmControl_+3A_method">method</code></td>
<td>

<p>character vector that specifies the optimization algorithm to fit a generalized Laplace mixed-effects model. The default is <code>"Nelder-Mead"</code>.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_nk">nK</code></td>
<td>

<p>number of knots for each of the two quadratures.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_multistart">multistart</code></td>
<td>

<p>logical flag. If <code>TRUE</code> (default), the algorithm is run with multiple starting values for the parameter alpha. See also <code>grid</code>.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_grid">grid</code></td>
<td>

<p>a vector of values for multi-start optimization. It can be used in conjunction with constrained estimation.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_alpha">alpha</code></td>
<td>

<p>vector of length 2 with starting values between 0 and 1 for the parameter alpha (ignored if multistart is <code>TRUE</code>) or values at which alpha is constrained if <code>alpha.index</code> is one of 0, 1, or 2. The first element is for the shape parameter of the random effects, the second for the error term. See Geraci and Farcomeni (2020).
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_alpha.index">alpha.index</code></td>
<td>

<p>the estimation with parameter alpha is unconstrained if <code>alpha.index</code> is equal to 9 (default). If equal to 0, both shape parameters (random effects and error term) are constrained during estimation and set equal to <code>alpha</code>. If equal to 1, the first shape parameter (random effects) is constrained during estimation and set equal to the first element of <code>alpha</code>. If equal to 2, the second shape parameter (error term) is constrained during estimation and set equal to the second element of <code>alpha</code>.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_lme">lme</code></td>
<td>

<p>logical flag. Should <code><a href="nlme.html#topic+lme">lme</a></code> be used to get starting values? If <code>FALSE</code>, <code><a href="stats.html#topic+lm">lm</a></code> is used instead.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_lmemethod">lmeMethod</code></td>
<td>

<p>fitting method for <code><a href="nlme.html#topic+lme">lme</a></code> when obtaining starting values. If &quot;REML&quot; the model is fit by maximizing the restricted log-likelihood. If &quot;ML&quot; the log-likelihood is maximized.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_lmeopt">lmeOpt</code></td>
<td>

<p>optimization algorithm for <code><a href="nlme.html#topic+lme">lme</a></code>. Either either <code><a href="stats.html#topic+nlminb">nlminb</a></code> (the default) or <code><a href="stats.html#topic+optim">optim</a></code>. This is passed to argument <code>opt</code> in <code><a href="nlme.html#topic+lmeControl">lmeControl</a></code>.
</p>
</td></tr>
<tr><td><code id="nlmmControl_+3A_verbose">verbose</code></td>
<td>

<p>logical flag. If <code>TRUE</code>, information about the fitting process is printed out.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation algorithm for fitting generalized Laplace mixed-effects (GLME) models is described in Geraci and Farcomeni (2020). For unconstrained estimation, it is recommended to leave the default arguments in <code>nlmmControl</code> unchanged.
</p>
<p>The integrated log-likelihood is maximized with either <code><a href="stats.html#topic+optim">optim</a></code>, in which case <code>method</code> has to be one of <code>optim</code>'s options (&quot;Nelder-Mead&quot;, &quot;BFGS&quot;, &quot;CG&quot;, &quot;L-BFGS-B&quot;, &quot;SANN&quot;, &quot;Brent&quot;), or <code><a href="stats.html#topic+nlminb">nlminb</a></code>, in which case one must use <code>method = "nlminb"</code>.
</p>
<p>Since the parameter alpha is bidimensional, care should be taken when increasing the number of quadrature knots <code>nK</code> since the total number of quadrature points is given by <code class="reqn">2^{nK}</code>. For the same reason, care should be taken when providing the <code>grid</code> values for multi-start optimization since the total number of starting points will be <code class="reqn">s^{2}</code>, where <code>s = length(grid)</code>.
</p>
<p>If <code>alpha.index</code> is 1 (or 2), the first (or second) element of the alpha parameter is constrained during estimation and set equal to the corresponding value of <code>alpha</code>. The element of the alpha parameter that is <em>unconstrained</em> is initialized with the corresponding element of <code>alpha</code> (if <code>multistart</code> is <code>FALSE</code>) or with values in <code>grid</code> (if <code>multistart</code> is <code>TRUE</code>).
</p>
<p>If <code>alpha.index</code> is 0, both elements of the alpha parameter are fixed and set equal to <code>alpha</code>. In this case, the argument <code>multistart</code> is ignored. If <code>alpha</code> is <code>c(0,0)</code>, the corresponding model is Normal-Normal and <code><a href="nlme.html#topic+lme">lme</a></code> is used for fitting (only via maximum likelihood). Note that in this case, <code>lmeOpt</code> can still be used.
</p>


<h3>Value</h3>

<p>a list of control parameters.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>

<hr>
<h2 id='predict.nlmm'>
Predictions from an <code>nlmm</code> Object
</h2><span id='topic+predict.nlmm'></span>

<h3>Description</h3>

<p>The predictions at level 0 correspond to predictions based only on the fixed effects estimates. The predictions at level 1 are obtained by adding the best linear predictions of the random effects to the predictions at level 0.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
predict(object, level = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.nlmm_+3A_object">object</code></td>
<td>

<p>an <code>nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="predict.nlmm_+3A_level">level</code></td>
<td>

<p>an integer vector giving the level of grouping to be used in obtaining the predictions.
</p>
</td></tr>
<tr><td><code id="predict.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of predictions.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>, <code><a href="#topic+ranef.nlmm">ranef.nlmm</a></code>, <code><a href="#topic+fixef.nlmm">fixef.nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)
fit &lt;- nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(multistart = FALSE))

# Individual growth trajectories
predict(fit, level = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.nlmm'>
Print an <code>nlmm</code> Object
</h2><span id='topic+print.nlmm'></span>

<h3>Description</h3>

<p>Print an object generated by <code><a href="#topic+nlmm">nlmm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nlmm_+3A_x">x</code></td>
<td>

<p>an <code>nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="print.nlmm_+3A_digits">digits</code></td>
<td>

<p>a non-null value for digits specifies the minimum number of significant digits to be printed in values.
</p>
</td></tr>
<tr><td><code id="print.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>

<hr>
<h2 id='print.summary.nlmm'>
Print an <code>nlmm</code> Summary Object
</h2><span id='topic+print.summary.nlmm'></span>

<h3>Description</h3>

<p>Print summary of an <code>nlmm</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.nlmm'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.nlmm_+3A_x">x</code></td>
<td>

<p>a <code>summary.nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="print.summary.nlmm_+3A_digits">digits</code></td>
<td>

<p>a non-null value for digits specifies the minimum number of significant digits to be printed in values.
</p>
</td></tr>
<tr><td><code id="print.summary.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>, <code><a href="#topic+summary.nlmm">summary.nlmm</a></code>
</p>

<hr>
<h2 id='ranef.nlmm'>
Extract Random Effects
</h2><span id='topic+ranef'></span><span id='topic+ranef.nlmm'></span>

<h3>Description</h3>

<p>This function computes random effects for a linear quantile mixed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef.nlmm_+3A_object">object</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> <code>nlmm</code>.
</p>
</td></tr>
<tr><td><code id="ranef.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prediction of the random effects is done via estimated best linear prediction (Geraci and Farcomeni, 2019). The generic function <code>ranef</code> is imported from the <code>nlme</code> package (Pinheiro et al, 2014).
</p>


<h3>Value</h3>

<p>a data frame of predicted random effects.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D and R Core Team (2014). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-117, <a href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>, <code><a href="#topic+fixef.nlmm">fixef.nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)
fit &lt;- nlmm(y ~ trt*time, random = ~ time, group = id, data = rats,
control = nlmmControl(multistart = FALSE))

# Predicted random intercepts and slopes
ranef(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='rats'>Growth curves</h2><span id='topic+rats'></span>

<h3>Description</h3>

<p>The <code>rats</code> data frame has 135 rows and 4 columns of the
change in weight measured over time for rats assigned to different treatment groups.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>id</dt><dd>
<p>grouping variable.
</p>
</dd>
<dt>time</dt><dd>
<p>time (week) of measurement (0, 1, 2, 3, 4).
</p>
</dd>
<dt>trt</dt><dd>
<p>treatment group (1, 2, 3).
</p>
</dd>
<dt>y</dt><dd>
<p>weight (grams)
</p>
</dd>
</dl>



<h3>Details</h3>

<p>In a weight gain experiment, 30 rats were randomly assigned to three treatment groups: treatment 1, a control (no additive); treatments 2 and 3, which consisted of two different additives (thiouracil and thyroxin respectively) to the rats drinking water (Box, 1950). Weight (grams) of the rats was measured at baseline (week 0) and at weeks 1, 2, 3, and 4. Data on three of the 10 rats from the thyroxin group were subsequently removed due to an accident at the beginning of the study.
</p>


<h3>Source</h3>

<p>G. E. P. Box, Problems in the analysis of growth and wear curves, Biometrics 6 (4) (1950) 362-389.
</p>

<hr>
<h2 id='residuals.nlmm'>
Residuals from an <code>nlmm</code> Object
</h2><span id='topic+residuals.nlmm'></span>

<h3>Description</h3>

<p>The residuals at level 0 correspond to population residuals (based only on the fixed effects estimates). The residuals at level 1 are obtained by adding the best linear predictions of the random effects to the predictions at level 0 and the subtracting these from the model response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
residuals(object, level = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.nlmm_+3A_object">object</code></td>
<td>

<p>an <code>nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="residuals.nlmm_+3A_level">level</code></td>
<td>

<p>an optional integer vector giving the level of grouping to be used in obtaining the predictions. Level zero corresponds to the population residuals.
</p>
</td></tr>
<tr><td><code id="residuals.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of residuals.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci</p>


<h3>References</h3>

<p>Geraci, M. and Farcomeni A. (2020). A family of linear mixed-effects models using the generalized Laplace distribution. Statistical Methods in Medical Research, 29(9), 2665-2682.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>, <code><a href="#topic+predict.nlmm">predict.nlmm</a></code>, <code><a href="#topic+fixef.nlmm">fixef.nlmm</a></code>, <code><a href="#topic+ranef.nlmm">ranef.nlmm</a></code>,
</p>

<hr>
<h2 id='summary.nlmm'>Summary for an <code>nlmm</code> Object</h2><span id='topic+summary.nlmm'></span>

<h3>Description</h3>

<p>Summary method for class <code>nlmm</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
summary(object, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nlmm_+3A_object">object</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> <code>nlmm</code>.
</p>
</td></tr>
<tr><td><code id="summary.nlmm_+3A_alpha">alpha</code></td>
<td>

<p>significance level.
</p>
</td></tr>
<tr><td><code id="summary.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.summary.nlmm</code> formats the coefficients, standard errors, etc. and additionally gives &lsquo;significance stars&rsquo;.</p>


<h3>Value</h3>

<p>an object of class <code>summary.nlmm</code>. The function <code>summary.nlmm</code> computes and returns a list of summary statistics of the fitted generalized Laplace mixed-effects model given in <code>object</code>, using the components (list elements) from its argument, plus
</p>
<table>
<tr><td><code>tTable</code></td>
<td>
<p>a matrix with estimates, standard errors, etc.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Geraci</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.summary.nlmm">print.summary.nlmm</a></code>
<code><a href="#topic+nlmm">nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)
fit &lt;- nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(multistart = FALSE))
summary(fit)


## End(Not run)
</code></pre>

<hr>
<h2 id='VarCorr.nlmm'>
Extract Variance-Covariance Matrix
</h2><span id='topic+VarCorr'></span><span id='topic+VarCorr.nlmm'></span>

<h3>Description</h3>

<p>This function extracts the variance-covariance matrix of the random effects from a fitted <code>nlmm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
VarCorr(x, sigma = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarCorr.nlmm_+3A_x">x</code></td>
<td>

<p>an object of <code><a href="base.html#topic+class">class</a></code> &quot;nlmm&quot;.
</p>
</td></tr>
<tr><td><code id="VarCorr.nlmm_+3A_sigma">sigma</code></td>
<td>

<p>not used.
</p>
</td></tr>
<tr><td><code id="VarCorr.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the variance or the variance-covariance matrix of the random effects. The generic function <code>VarCorr</code> is imported from the <code>nlme</code> package (Pinheiro et al, 2014).
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Pinheiro J, Bates D, DebRoy S, Sarkar D and R Core Team (2014). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-117, <a href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)
fit &lt;- nlmm(y ~ trt*time, random = ~ time, group = id, data = rats, cov = "pdSymm",
control = nlmmControl(multistart = FALSE))

# Symmetric variance-covariance of random intercepts and slopes
VarCorr(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='vcov.nlmm'>
Calculate Variance-Covariance Matrix for a Fitted Generalized Laplace Mixed-Effects Object
</h2><span id='topic+vcov.nlmm'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the all the parameters of a fitted <code>nlmm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmm'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.nlmm_+3A_object">object</code></td>
<td>

<p>an <code>nlmm</code> object.
</p>
</td></tr>
<tr><td><code id="vcov.nlmm_+3A_...">...</code></td>
<td>

<p>not used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gives the variance-covariance matrix of the GLME estimator, on the scale of the unconstrained, unrestricted parameters. The size is <code class="reqn">d x d</code>, <code class="reqn">d = p + r + 2 + 1 + s</code>, with <code class="reqn">p</code> fixed coefficients, <code class="reqn">r</code> non-redundant parameters of the random effects distribution, 2 shape parameters, 1 scale parameter, <code class="reqn">s</code> parameters of the residual variance function (if specified in the model), in this order.
</p>


<h3>Value</h3>

<p>a matrix.
</p>


<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlmm">nlmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(rats)

# Number of parameters is d = 6 + 3 + 2 + 1 + 0 = 12
fit &lt;- nlmm(y ~ trt*time, random = ~ time, group = id, data = rats,
cov = "pdSymm", control = nlmmControl(multistart = FALSE))
fit$par
vcov(fit)

# Number of parameters is d = 6 + 1 + 2 + 1 + 4 = 14
fit &lt;- nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(multistart = FALSE), weights = varIdent(form = ~ 1|time))
fit$par
vcov(fit)

# Number of parameters is d = 6 + 1 + 0 + 1 + 0 = 8
# Note that the shape parameters are now constrained
fit &lt;- nlmm(y ~ trt*time, random = ~ 1, group = id, data = rats,
control = nlmmControl(alpha.index = 0, multistart = FALSE))
fit$par
vcov(fit)


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
