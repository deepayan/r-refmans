<!DOCTYPE html><html><head><title>Help for package stpm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stpm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#stpm'><p>Stochastic Process Model for Analysis of Longitudinal and Time-to-Event Outcomes</p></a></li>
<li><a href='#assign_to_global'><p>function loading results in global environment</p></a></li>
<li><a href='#ex_data'><p>This is the longitudinal genetic dataset.</p></a></li>
<li><a href='#func1'><p>An internal function to compute m and gamma based on</p>
continuous-time model (Yashin et. al., 2007)</a></li>
<li><a href='#get.column.index'><p>An internal function to obtain column index by its name</p></a></li>
<li><a href='#getNextY.cont'><p>An internal function to compute next Y based on</p>
continous-time model (Yashin et. al., 2007)</a></li>
<li><a href='#getNextY.cont2'><p>An internal function to compute next value of physiological variable Y</p></a></li>
<li><a href='#getNextY.discr'><p>An internal function to compute the next value of physiological variable Y</p>
based on discrete-time model (Akushevich et. al., 2005)</a></li>
<li><a href='#getNextY.discr.m'><p>An internal function to compute next m based on dicrete-time model</p></a></li>
<li><a href='#getPrevY.discr'><p>An internal function to compute previous value of</p>
physiological variable Y based on
discrete-time model</a></li>
<li><a href='#getPrevY.discr.m'><p>An internal function to compute previous m based on discrete-time model</p></a></li>
<li><a href='#longdat'><p>This is the longitudinal dataset.</p></a></li>
<li><a href='#LRTest'><p>Likelihood-ratio test</p></a></li>
<li><a href='#m'><p>An internal function to compute m from</p></a></li>
<li><a href='#make.short.format'><p>An internal function which construct short data format from a given long</p></a></li>
<li><a href='#mu'><p>An internal function to compute mu</p></a></li>
<li><a href='#prepare_data'><p>Data pre-processing for analysis with stochastic process model methodology.</p></a></li>
<li><a href='#prepare_data_cont'><p>Prepares continuouts-time dataset.</p></a></li>
<li><a href='#prepare_data_discr'><p>Prepares discrete-time dataset.</p></a></li>
<li><a href='#sigma_sq'><p>An internal function to compute sigma square analytically</p></a></li>
<li><a href='#sim_pobs'><p>Multi-dimension simulation function for data with partially observed covariates (multidimensional GenSPM) with arbitrary intervals</p></a></li>
<li><a href='#simdata_cont'><p>Multi-dimensional simulation function for continuous-time SPM.</p></a></li>
<li><a href='#simdata_discr'><p>Multi-dimension simulation function</p></a></li>
<li><a href='#simdata_gamma_frailty'><p>This script simulates data using familial frailty model.</p>
We use the following variation: gamma(mu, ssq), where mu is the mean and ssq is sigma square.
See: https://www.rocscience.com/help/swedge/webhelp/swedge/Gamma_Distribution.htm</a></li>
<li><a href='#simdata_time_dep'><p>Simulation function for continuous trait with time-dependant coefficients.</p></a></li>
<li><a href='#spm'><p>A central function that estimates Stochastic Process Model parameters a from given dataset.</p></a></li>
<li><a href='#spm_con_1d'><p>Fitting a 1-D SPM model with constant parameters</p></a></li>
<li><a href='#spm_con_1d_g'><p>Fitting a 1-D genetic SPM model with constant parameters</p></a></li>
<li><a href='#spm_cont_lin'><p>Continuous multi-dimensional optimization with linear terms in mu only</p></a></li>
<li><a href='#spm_cont_quad_lin'><p>Continuous multi-dimensional optimization with quadratic and linear terms</p></a></li>
<li><a href='#spm_continuous'><p>Continuous multi-dimensional optimization</p></a></li>
<li><a href='#spm_discrete'><p>Discrete multi-dimensional optimization</p></a></li>
<li><a href='#spm_pobs'><p>Continuous-time multi-dimensional optimization for SPM with partially observed covariates (multidimensional GenSPM)</p></a></li>
<li><a href='#spm_projection'><p>A data projection with previously estimated or user-defined parameters.</p>
Projections are constructed for a cohort with fixed or
normally distributed initial covariates.</a></li>
<li><a href='#spm_time_dep'><p>A function for the model with time-dependent model parameters.</p></a></li>
<li><a href='#spm.impute'><p>Multiple Data Imputation with SPM</p></a></li>
<li><a href='#trim'><p>Returns string w/o leading or trailing whitespace</p></a></li>
<li><a href='#trim.leading'><p>Returns string w/o leading whitespace</p></a></li>
<li><a href='#trim.trailing'><p>Returns string w/o trailing whitespace</p></a></li>
<li><a href='#vitstat'><p>Vital (mortality) statistics.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stochastic Process Model for Analysis of Longitudinal and
Time-to-Event Outcomes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-06</td>
</tr>
<tr>
<td>Author:</td>
<td>I. Zhbannikov, Liang He, K. Arbeev, I. Akushevich, A. Yashin.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ilya Y. Zhbannikov &lt;ilya.zhbannikov@duke.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Utilities to estimate parameters of the models with survival functions 
             induced by stochastic covariates. Miscellaneous functions for data preparation 
             and simulation are also provided. For more information, see: 
             (i)"Stochastic model for analysis of longitudinal data on aging and mortality" 
             by Yashin A. et al. (2007), 
             Mathematical Biosciences, 208(2), 538-551, &lt;<a href="https://doi.org/10.1016%2Fj.mbs.2006.11.006">doi:10.1016/j.mbs.2006.11.006</a>&gt;;
             (ii) "Health decline, aging and mortality: how are they related?" 
             by Yashin A. et al. (2007), 
             Biogerontology 8(3), 291(302), &lt;<a href="https://doi.org/10.1007%2Fs10522-006-9073-3">doi:10.1007/s10522-006-9073-3</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>sas7bdat,stats,nloptr,survival,tools,MASS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp,RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), Rcpp (&ge; 0.11.1)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.11), rmarkdown (&ge; 1.9)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-05 14:52:16 UTC; iz12</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-05 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='stpm'>Stochastic Process Model for Analysis of Longitudinal and Time-to-Event Outcomes</h2><span id='topic+stpm'></span><span id='topic+stpm-package'></span>

<h3>Description</h3>

<p>Utilities to estimate parameters of the models with survival functions induced by 
stochastic covariates. Miscellaneous functions for data preparation and simulation 
are also provided. For more information, see: &quot;Stochastic model for analysis of 
longitudinal data on aging and mortality&quot; by Yashin A. et al, 2007, Mathematical 
Biosciences, 208(2), 538-551 &lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Author(s)</h3>

<p>I. Y. Zhbannikov, Liang He, K. G. Arbeev, I. Akushevich, A. I. Yashin.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.
</p>
<p>Akushevich I., Kulminski A. and Manton K. (2005). Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. Mathematical Popu-lation Studies, 12(2), pp.: 51-80.
&lt;DOI: 10.1080/08898480590932296&gt;.
</p>
<p>Yashin, A. et al (2007), Health decline, aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(stpm)
#Prepare data for optimization
data &lt;- prepare_data(x=system.file("extdata","longdat.csv",package="stpm"), covariates="BMI")
#Parameters estimation (default model: discrete-time):
p.discr.model &lt;- spm(data)
p.discr.model
# Continuous-time model:
p.cont.model &lt;- spm(data, model="continuous")
p.cont.model
#Model with time-dependent coefficients:
data &lt;- prepare_data(x=system.file("extdata","longdat.csv",package="stpm"), covariates="BMI")
p.td.model &lt;- spm(data, model="time-dependent")
p.td.model

## End(Not run)
</code></pre>

<hr>
<h2 id='assign_to_global'>function loading results in global environment</h2><span id='topic+assign_to_global'></span>

<h3>Description</h3>

<p>function loading results in global environment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_to_global(pos = 1, what, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assign_to_global_+3A_pos">pos</code></td>
<td>
<p>defaults to 1 which equals an assingment to global environment</p>
</td></tr>
<tr><td><code id="assign_to_global_+3A_what">what</code></td>
<td>
<p>variable to assign to</p>
</td></tr>
<tr><td><code id="assign_to_global_+3A_value">value</code></td>
<td>
<p>value to assign</p>
</td></tr>
</table>

<hr>
<h2 id='ex_data'>This is the longitudinal genetic dataset.</h2><span id='topic+ex_data'></span>

<h3>Description</h3>

<p>This is the longitudinal genetic dataset.
</p>


<h3>Author(s)</h3>

<p>Liang He
</p>

<hr>
<h2 id='func1'>An internal function to compute m and gamma based on 
continuous-time model (Yashin et. al., 2007)</h2><span id='topic+func1'></span>

<h3>Description</h3>

<p>An internal function to compute m and gamma based on 
continuous-time model (Yashin et. al., 2007)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func1(tt, y, a, f1, Q, f, b, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="func1_+3A_tt">tt</code></td>
<td>
<p>tt - time</p>
</td></tr>
<tr><td><code id="func1_+3A_y">y</code></td>
<td>
<p>y</p>
</td></tr>
<tr><td><code id="func1_+3A_a">a</code></td>
<td>
<p>a (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="func1_+3A_f1">f1</code></td>
<td>
<p>f1 (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="func1_+3A_q">Q</code></td>
<td>
<p>Q (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="func1_+3A_f">f</code></td>
<td>
<p>f (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="func1_+3A_b">b</code></td>
<td>
<p>b (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="func1_+3A_theta">theta</code></td>
<td>
<p>theta</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list(m, gamma) Next values of m and gamma (see Yashin et. al, 2007)
</p>

<hr>
<h2 id='get.column.index'>An internal function to obtain column index by its name</h2><span id='topic+get.column.index'></span>

<h3>Description</h3>

<p>An internal function to obtain column index by its name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.column.index(x, col.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.column.index_+3A_x">x</code></td>
<td>
<p>Dataset</p>
</td></tr>
<tr><td><code id="get.column.index_+3A_col.name">col.name</code></td>
<td>
<p>Column name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>column index(es) in the provided dataset
</p>

<hr>
<h2 id='getNextY.cont'>An internal function to compute next Y based on 
continous-time model (Yashin et. al., 2007)</h2><span id='topic+getNextY.cont'></span>

<h3>Description</h3>

<p>An internal function to compute next Y based on 
continous-time model (Yashin et. al., 2007)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNextY.cont(y1, t1, t2, a, f1, Q, f, b, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNextY.cont_+3A_y1">y1</code></td>
<td>
<p>y1</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_t1">t1</code></td>
<td>
<p>t1</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_t2">t2</code></td>
<td>
<p>t2</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_a">a</code></td>
<td>
<p>a (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_f1">f1</code></td>
<td>
<p>f1 (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_q">Q</code></td>
<td>
<p>Q (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_f">f</code></td>
<td>
<p>f (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_b">b</code></td>
<td>
<p>b (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont_+3A_theta">theta</code></td>
<td>
<p>theta (see Yashin et. al, 2007)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y.next Next value of Y
</p>

<hr>
<h2 id='getNextY.cont2'>An internal function to compute next value of physiological variable Y</h2><span id='topic+getNextY.cont2'></span>

<h3>Description</h3>

<p>An internal function to compute next value of physiological variable Y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNextY.cont2(y1, t1, t2, b, a, f1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNextY.cont2_+3A_y1">y1</code></td>
<td>
<p>y1</p>
</td></tr>
<tr><td><code id="getNextY.cont2_+3A_t1">t1</code></td>
<td>
<p>t1</p>
</td></tr>
<tr><td><code id="getNextY.cont2_+3A_t2">t2</code></td>
<td>
<p>t2</p>
</td></tr>
<tr><td><code id="getNextY.cont2_+3A_b">b</code></td>
<td>
<p>b (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont2_+3A_a">a</code></td>
<td>
<p>a (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="getNextY.cont2_+3A_f1">f1</code></td>
<td>
<p>f1 (see Yashin et. al, 2007)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y.next Next value of y
</p>

<hr>
<h2 id='getNextY.discr'>An internal function to compute the next value of physiological variable Y
based on discrete-time model (Akushevich et. al., 2005)</h2><span id='topic+getNextY.discr'></span>

<h3>Description</h3>

<p>An internal function to compute the next value of physiological variable Y
based on discrete-time model (Akushevich et. al., 2005)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNextY.discr(y1, u, R, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNextY.discr_+3A_y1">y1</code></td>
<td>
<p>y1</p>
</td></tr>
<tr><td><code id="getNextY.discr_+3A_u">u</code></td>
<td>
<p>u (see Akushevich et. al, 2005)</p>
</td></tr>
<tr><td><code id="getNextY.discr_+3A_r">R</code></td>
<td>
<p>R (see Akushevich et. al, 2005)</p>
</td></tr>
<tr><td><code id="getNextY.discr_+3A_sigma">Sigma</code></td>
<td>
<p>Sigma (see Akushevich et. al, 2005)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y.next Next value of y
</p>

<hr>
<h2 id='getNextY.discr.m'>An internal function to compute next m based on dicrete-time model</h2><span id='topic+getNextY.discr.m'></span>

<h3>Description</h3>

<p>An internal function to compute next m based on dicrete-time model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNextY.discr.m(y1, u, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNextY.discr.m_+3A_y1">y1</code></td>
<td>
<p>y1</p>
</td></tr>
<tr><td><code id="getNextY.discr.m_+3A_u">u</code></td>
<td>
<p>u</p>
</td></tr>
<tr><td><code id="getNextY.discr.m_+3A_r">R</code></td>
<td>
<p>R</p>
</td></tr>
</table>


<h3>Value</h3>

<p>m Next value of m (see Yashin et. al, 2007)
</p>

<hr>
<h2 id='getPrevY.discr'>An internal function to compute previous value of
physiological variable Y based on 
discrete-time model</h2><span id='topic+getPrevY.discr'></span>

<h3>Description</h3>

<p>An internal function to compute previous value of
physiological variable Y based on 
discrete-time model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPrevY.discr(y2, u, R, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPrevY.discr_+3A_y2">y2</code></td>
<td>
<p>y2</p>
</td></tr>
<tr><td><code id="getPrevY.discr_+3A_u">u</code></td>
<td>
<p>u</p>
</td></tr>
<tr><td><code id="getPrevY.discr_+3A_r">R</code></td>
<td>
<p>R</p>
</td></tr>
<tr><td><code id="getPrevY.discr_+3A_sigma">Sigma</code></td>
<td>
<p>Sigma</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y1 Previous value of y
</p>

<hr>
<h2 id='getPrevY.discr.m'>An internal function to compute previous m based on discrete-time model</h2><span id='topic+getPrevY.discr.m'></span>

<h3>Description</h3>

<p>An internal function to compute previous m based on discrete-time model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPrevY.discr.m(y2, u, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPrevY.discr.m_+3A_y2">y2</code></td>
<td>
<p>y2</p>
</td></tr>
<tr><td><code id="getPrevY.discr.m_+3A_u">u</code></td>
<td>
<p>u</p>
</td></tr>
<tr><td><code id="getPrevY.discr.m_+3A_r">R</code></td>
<td>
<p>R</p>
</td></tr>
</table>


<h3>Value</h3>

<p>m Next value of m (see Yashin et. al, 2007)
</p>

<hr>
<h2 id='longdat'>This is the longitudinal dataset.</h2><span id='topic+longdat'></span>

<h3>Description</h3>

<p>This is the longitudinal dataset.
</p>


<h3>Author(s)</h3>

<p>Ilya Y Zhbannikov <a href="mailto:ilya.zhbannikov@duke.edu">ilya.zhbannikov@duke.edu</a>
</p>

<hr>
<h2 id='LRTest'>Likelihood-ratio test</h2><span id='topic+LRTest'></span>

<h3>Description</h3>

<p>Likelihood-ratio test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRTest(LA, L0, df = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRTest_+3A_la">LA</code></td>
<td>
<p>Log-likelihood for alternative hyphotesis</p>
</td></tr>
<tr><td><code id="LRTest_+3A_l0">L0</code></td>
<td>
<p>Log-likelihood for null hyphotesis</p>
</td></tr>
<tr><td><code id="LRTest_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for Chi-square test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value of LR test.
</p>

<hr>
<h2 id='m'>An internal function to compute m from</h2><span id='topic+m'></span>

<h3>Description</h3>

<p>An internal function to compute m from
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m(y, t1, t2, a, f1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m_+3A_y">y</code></td>
<td>
<p>Current value of Y</p>
</td></tr>
<tr><td><code id="m_+3A_t1">t1</code></td>
<td>
<p>t1</p>
</td></tr>
<tr><td><code id="m_+3A_t2">t2</code></td>
<td>
<p>t2</p>
</td></tr>
<tr><td><code id="m_+3A_a">a</code></td>
<td>
<p>a (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="m_+3A_f1">f1</code></td>
<td>
<p>f1 (see Yashin et. al, 2007)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>m m (see Yashin et. al, 2007)
</p>

<hr>
<h2 id='make.short.format'>An internal function which construct short data format from a given long</h2><span id='topic+make.short.format'></span>

<h3>Description</h3>

<p>An internal function which construct short data format from a given long
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.short.format(
  x,
  col.id = 1,
  col.status = 2,
  col.t1 = 3,
  col.t2 = 4,
  col.cov = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.short.format_+3A_x">x</code></td>
<td>
<p>Dataset</p>
</td></tr>
<tr><td><code id="make.short.format_+3A_col.id">col.id</code></td>
<td>
<p>Column ID index</p>
</td></tr>
<tr><td><code id="make.short.format_+3A_col.status">col.status</code></td>
<td>
<p>Column status index</p>
</td></tr>
<tr><td><code id="make.short.format_+3A_col.t1">col.t1</code></td>
<td>
<p>Column t1 index</p>
</td></tr>
<tr><td><code id="make.short.format_+3A_col.t2">col.t2</code></td>
<td>
<p>Column t2 index</p>
</td></tr>
<tr><td><code id="make.short.format_+3A_col.cov">col.cov</code></td>
<td>
<p>Column covariates indices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>column index(es) in the provided dataset
</p>

<hr>
<h2 id='mu'>An internal function to compute mu</h2><span id='topic+mu'></span>

<h3>Description</h3>

<p>An internal function to compute mu
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu(y, mu0, b, Q, theta, tt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mu_+3A_y">y</code></td>
<td>
<p>Current value of y</p>
</td></tr>
<tr><td><code id="mu_+3A_mu0">mu0</code></td>
<td>
<p>mu0 (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="mu_+3A_b">b</code></td>
<td>
<p>b (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="mu_+3A_q">Q</code></td>
<td>
<p>Q (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="mu_+3A_theta">theta</code></td>
<td>
<p>theta (see Yashin et. al, 2007)</p>
</td></tr>
<tr><td><code id="mu_+3A_tt">tt</code></td>
<td>
<p>t (time)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mu Next value of mu
</p>

<hr>
<h2 id='prepare_data'>Data pre-processing for analysis with stochastic process model methodology.</h2><span id='topic+prepare_data'></span>

<h3>Description</h3>

<p>Data pre-processing for analysis with stochastic process model methodology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_data(
  x,
  col.id = NA,
  col.status = NA,
  col.age = NA,
  col.age.event = NA,
  covariates = NA,
  interval = 1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_data_+3A_x">x</code></td>
<td>
<p>A path to the file with table of follow-up oservations (longitudinal table). 
File formats: csv, sas7bdat</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_col.id">col.id</code></td>
<td>
<p>A name of column containing subject ID. 
This ID should be the same in both x (longitudinal) and y (vital statistics) tables.
None: if col.id not provided, the first column of the x and 
first column of the y will be used by default.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_col.status">col.status</code></td>
<td>
<p>A name of the column containing status variable 
(0/1, which is an indicator of death/censoring). 
Note: if not provided - then the column #2 from the y (vital statistics) dataset will be used.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_col.age">col.age</code></td>
<td>
<p>A name of age column (also called 't1'). 
This column represents a time (age) of measurement.
If not provided then the 3rd column from the longitudinal dataset (x) will be used.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_col.age.event">col.age.event</code></td>
<td>
<p>A name of 'event' column.
The event column indicates a time when the even occured (e.g. system failure).
Note: if not provided then the 3rd column from the y (vital statistics) dataset will be used.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_covariates">covariates</code></td>
<td>
<p>A list of covariates (physiological variables). 
If covariates not provided, then all columns from longitudinal table having index &gt; 3 will be used as covariates.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_interval">interval</code></td>
<td>
<p>A number of breaks between observations for data for discrete model. 
This interval must be integer and should be equal or greater than 1.
Default = 1 unit of time.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_verbose">verbose</code></td>
<td>
<p>A verbosing output indicator. Default=FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two elements: first element contains a preprocessed data for continuous model, with arbitrary intervals between observations  and 
second element contains a prepocessed data table for a discrete model (with constant intervals between observations).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(stpm) 
data &lt;- prepare_data(x=system.file("extdata","longdat.csv",package="stpm"))
head(data[[1]])
head(data[[2]])

## End(Not run)
</code></pre>

<hr>
<h2 id='prepare_data_cont'>Prepares continuouts-time dataset.</h2><span id='topic+prepare_data_cont'></span>

<h3>Description</h3>

<p>Prepares continuouts-time dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_data_cont(
  merged.data,
  col.status.ind,
  col.id.ind,
  col.age.ind,
  col.age.event.ind,
  col.covar.ind,
  verbose,
  dt
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_data_cont_+3A_merged.data">merged.data</code></td>
<td>
<p>a longitudinal study dataset.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_col.status.ind">col.status.ind</code></td>
<td>
<p>index of &quot;status&quot; column.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_col.id.ind">col.id.ind</code></td>
<td>
<p>subject id column index.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_col.age.ind">col.age.ind</code></td>
<td>
<p>index of the age column.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_col.age.event.ind">col.age.event.ind</code></td>
<td>
<p>an index of the column which represents the time in which event occured.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_col.covar.ind">col.covar.ind</code></td>
<td>
<p>a set of column indexes which represent covariates.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_verbose">verbose</code></td>
<td>
<p>turns on/off verbosing output.</p>
</td></tr>
<tr><td><code id="prepare_data_cont_+3A_dt">dt</code></td>
<td>
<p>interval between observations.</p>
</td></tr>
</table>

<hr>
<h2 id='prepare_data_discr'>Prepares discrete-time dataset.</h2><span id='topic+prepare_data_discr'></span>

<h3>Description</h3>

<p>Prepares discrete-time dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_data_discr(
  merged.data,
  interval,
  col.status.ind,
  col.id.ind,
  col.age.ind,
  col.age.event.ind,
  col.covar.ind,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_data_discr_+3A_merged.data">merged.data</code></td>
<td>
<p>a longitudinal study dataset.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_interval">interval</code></td>
<td>
<p>interval between observations.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_col.status.ind">col.status.ind</code></td>
<td>
<p>index of &quot;status&quot; column.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_col.id.ind">col.id.ind</code></td>
<td>
<p>subject id column index.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_col.age.ind">col.age.ind</code></td>
<td>
<p>index of the age column.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_col.age.event.ind">col.age.event.ind</code></td>
<td>
<p>an index of the column which represents the time in which event occured.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_col.covar.ind">col.covar.ind</code></td>
<td>
<p>a set of column indexes which represent covariates.</p>
</td></tr>
<tr><td><code id="prepare_data_discr_+3A_verbose">verbose</code></td>
<td>
<p>turns on/off verbosing output.
Filling the last cell</p>
</td></tr>
</table>

<hr>
<h2 id='sigma_sq'>An internal function to compute sigma square analytically</h2><span id='topic+sigma_sq'></span>

<h3>Description</h3>

<p>An internal function to compute sigma square analytically
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigma_sq(t1, t2, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigma_sq_+3A_t1">t1</code></td>
<td>
<p>t1</p>
</td></tr>
<tr><td><code id="sigma_sq_+3A_t2">t2</code></td>
<td>
<p>t2</p>
</td></tr>
<tr><td><code id="sigma_sq_+3A_b">b</code></td>
<td>
<p>b (see Yashin et. al, 2007)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sigma_square (see Akushevich et. al, 2005)
</p>

<hr>
<h2 id='sim_pobs'>Multi-dimension simulation function for data with partially observed covariates (multidimensional GenSPM) with arbitrary intervals</h2><span id='topic+sim_pobs'></span>

<h3>Description</h3>

<p>Multi-dimension simulation function for data with partially observed covariates (multidimensional GenSPM) with arbitrary intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_pobs(
  N = 10,
  aH = -0.05,
  aL = -0.01,
  f1H = 60,
  f1L = 80,
  QH = 2e-08,
  QL = 2.5e-08,
  fH = 60,
  fL = 80,
  bH = 4,
  bL = 5,
  mu0H = 8e-06,
  mu0L = 1e-05,
  thetaH = 0.08,
  thetaL = 0.1,
  p = 0.25,
  ystart = 80,
  tstart = 30,
  tend = 105,
  dt = 1,
  sd0 = 1,
  mode = "observed",
  gomp = FALSE,
  nobs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_pobs_+3A_n">N</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_ah">aH</code></td>
<td>
<p>A k by k matrix, which characterize the rate of the adaptive response when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_al">aL</code></td>
<td>
<p>A k by k matrix, which characterize the rate of the adaptive response when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_f1h">f1H</code></td>
<td>
<p>A particular state, which if a deviation from the normal (or optimal) when Z = 1.
This is a vector with length of k.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_f1l">f1L</code></td>
<td>
<p>A particular state, which if a deviation from the normal (or optimal) when Z = 0. 
This is a vector with length of k.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_qh">QH</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_ql">QL</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_fh">fH</code></td>
<td>
<p>A vector-function (with length k) of the normal (or optimal) state when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_fl">fL</code></td>
<td>
<p>A vector-function (with length k) of the normal (or optimal) state when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_bh">bH</code></td>
<td>
<p>A diffusion coefficient, k by k matrix when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_bl">bL</code></td>
<td>
<p>A diffusion coefficient, k by k matrix when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_mu0h">mu0H</code></td>
<td>
<p>mortality at start period of time when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_mu0l">mu0L</code></td>
<td>
<p>mortality at start period of time when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_thetah">thetaH</code></td>
<td>
<p>A displacement coefficient of the Gompertz function when Z = 1.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_thetal">thetaL</code></td>
<td>
<p>A displacement coefficient of the Gompertz function when Z = 0.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_p">p</code></td>
<td>
<p>A proportion of carriers in a sumulated population (default p = 0.25).</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_ystart">ystart</code></td>
<td>
<p>A vector with length equal to number of dimensions used, defines starting values of covariates.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_tstart">tstart</code></td>
<td>
<p>A number that defines starting time (30 by default).</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_tend">tend</code></td>
<td>
<p>A number, defines final time (105 by default).</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_dt">dt</code></td>
<td>
<p>A discrete step size between two observations. A random uniform value is then added to this step size.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_sd0">sd0</code></td>
<td>
<p>A standard deviation for modelling the next physiological variable (covariate) value.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_mode">mode</code></td>
<td>
<p>Can have the following values: &quot;observed&quot; (default), &quot;unobserved&quot;.
This represents a type of group to simulate: a group with observed variable Z, or group with unbobserved variable Z.</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 and Q are used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="sim_pobs_+3A_nobs">nobs</code></td>
<td>
<p>A number of observations (lines) for individual observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with simulated data.
</p>


<h3>References</h3>

<p>Arbeev, K.G. et al (2009). Genetic model for longitudinal studies of aging, health, and longevity
</p>
<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
dat &lt;- sim_pobs(N=50)
head(dat)

</code></pre>

<hr>
<h2 id='simdata_cont'>Multi-dimensional simulation function for continuous-time SPM.</h2><span id='topic+simdata_cont'></span>

<h3>Description</h3>

<p>Multi-dimensional simulation function for continuous-time SPM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata_cont(
  N = 10,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 1e-05,
  theta = 0.08,
  ystart = 80,
  tstart = 30,
  tend = 105,
  dt = 1,
  sd0 = 1,
  nobs = NULL,
  gomp = TRUE,
  format = "long"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simdata_cont_+3A_n">N</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_a">a</code></td>
<td>
<p>A k by k matrix, represents the adaptive capacity of the organism</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_f1">f1</code></td>
<td>
<p>A trajectory that corresponds to the long-term average value of the stochastic process Y(t), 
which describes a trajectory of individual covariate (physiological variable) influenced by different 
factors represented by a random Wiener process W(t).
This is a vector with length of k.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_q">Q</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix, 
represents a sensitivity of risk function to deviation from the norm.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_f">f</code></td>
<td>
<p>A vector with length of k, represents the normal (or optimal) state of physiological variable.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_b">b</code></td>
<td>
<p>A diffusion coefficient, k by k matrix, 
characterizes a strength of the random disturbances from Wiener process W(t).</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_mu0">mu0</code></td>
<td>
<p>A baseline mortality.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_theta">theta</code></td>
<td>
<p>A displacement coefficient.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_ystart">ystart</code></td>
<td>
<p>A vector with length equal of k, defines starting values of covariates.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_tstart">tstart</code></td>
<td>
<p>A number that defines starting time (30 by default).</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_tend">tend</code></td>
<td>
<p>A number, defines final time (105 by default).</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_dt">dt</code></td>
<td>
<p>A discrete step size between two observations. A random uniform value is then added to this step size.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_sd0">sd0</code></td>
<td>
<p>a standard deviation for modelling the next covariate value.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_nobs">nobs</code></td>
<td>
<p>A number of observations (lines) for individual observations.</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 and Q are used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="simdata_cont_+3A_format">format</code></td>
<td>
<p>Data format: &quot;long&quot; (default), &quot;short&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with simulated data.
</p>


<h3>References</h3>

<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
dat &lt;- simdata_cont(N=50)
head(dat)

</code></pre>

<hr>
<h2 id='simdata_discr'>Multi-dimension simulation function</h2><span id='topic+simdata_discr'></span>

<h3>Description</h3>

<p>Multi-dimension simulation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata_discr(
  N = 100,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 1e-05,
  theta = 0.08,
  ystart = 80,
  tstart = 30,
  tend = 105,
  dt = 1,
  nobs = NULL,
  format = "long"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simdata_discr_+3A_n">N</code></td>
<td>
<p>Number of individuals</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_a">a</code></td>
<td>
<p>A k by k matrix, which characterize the rate of the adaptive response.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_f1">f1</code></td>
<td>
<p>A particular state, which is a deviation from the normal (or optimal). This is a vector with length of k.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_q">Q</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_f">f</code></td>
<td>
<p>A vector-function (with length k) of the normal (or optimal) state.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_b">b</code></td>
<td>
<p>A diffusion coefficient, k by k matrix.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_mu0">mu0</code></td>
<td>
<p>mortality at start period of time.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_theta">theta</code></td>
<td>
<p>A displacement coefficient of the Gompertz function.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_ystart">ystart</code></td>
<td>
<p>A vector with length equal to number of dimensions used, defines starting values of covariates.
Default ystart = 80.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_tstart">tstart</code></td>
<td>
<p>Starting time (age). 
Can be a number (30 by default) or a vector of two numbers: c(a, b) - in this case, starting value of time 
is simulated via uniform(a,b) distribution.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_tend">tend</code></td>
<td>
<p>A number, defines final time (105 by default).</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_dt">dt</code></td>
<td>
<p>A time step (1 by default).</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_nobs">nobs</code></td>
<td>
<p>A number, defines a number of observations (lines) for an individual, NULL by default.</p>
</td></tr>
<tr><td><code id="simdata_discr_+3A_format">format</code></td>
<td>
<p>Data format: &quot;long&quot; (default), &quot;short&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with simulated data.
</p>


<h3>References</h3>

<p>Akushevich I., Kulminski A. and Manton K. (2005), Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. Mathematical Population Studies, 12(2), pp.: 51-80.
&lt;DOI:10.1080/08898480590932296&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
data &lt;- simdata_discr(N=100)
head(data)

</code></pre>

<hr>
<h2 id='simdata_gamma_frailty'>This script simulates data using familial frailty model. 
We use the following variation: gamma(mu, ssq), where mu is the mean and ssq is sigma square.
See: https://www.rocscience.com/help/swedge/webhelp/swedge/Gamma_Distribution.htm</h2><span id='topic+simdata_gamma_frailty'></span>

<h3>Description</h3>

<p>This script simulates data using familial frailty model. 
We use the following variation: gamma(mu, ssq), where mu is the mean and ssq is sigma square.
See: https://www.rocscience.com/help/swedge/webhelp/swedge/Gamma_Distribution.htm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata_gamma_frailty(
  N = 10,
  f = list(at = "-0.05", f1t = "80", Qt = "2e-8", ft = "80", bt = "5", mu0t = "1e-3"),
  step = 1,
  tstart = 30,
  tend = 105,
  ystart = 80,
  sd0 = 1,
  nobs = NULL,
  gamma_mu = 1,
  gamma_ssq = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simdata_gamma_frailty_+3A_n">N</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_f">f</code></td>
<td>
<p>a list of formulas that define age (time) - dependency. Default: list(at=&quot;a&quot;, f1t=&quot;f1&quot;, Qt=&quot;Q*exp(theta*t)&quot;, ft=&quot;f&quot;, bt=&quot;b&quot;, mu0t=&quot;mu0*exp(theta*t)&quot;)</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_step">step</code></td>
<td>
<p>An interval between two observations, a random uniformally-distributed value is then added to this step.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_tstart">tstart</code></td>
<td>
<p>Starting time (age).
Can be a number (30 by default) or a vector of two numbers: c(a, b) - in this case, starting value of time 
is simulated via uniform(a,b) distribution.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_tend">tend</code></td>
<td>
<p>A number, defines final time (105 by default).</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_ystart">ystart</code></td>
<td>
<p>A starting value of covariates.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_sd0">sd0</code></td>
<td>
<p>A standard deviation for modelling the next covariate value, sd0 = 1 by default.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_nobs">nobs</code></td>
<td>
<p>A number of observations (lines) for individual observations.</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_gamma_mu">gamma_mu</code></td>
<td>
<p>A parameter which is a mean value, default = 1</p>
</td></tr>
<tr><td><code id="simdata_gamma_frailty_+3A_gamma_ssq">gamma_ssq</code></td>
<td>
<p>A sigma squared, default = 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with simulated data.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Health decline, aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
dat &lt;- simdata_gamma_frailty(N=10)
head(dat)

</code></pre>

<hr>
<h2 id='simdata_time_dep'>Simulation function for continuous trait with time-dependant coefficients.</h2><span id='topic+simdata_time_dep'></span>

<h3>Description</h3>

<p>Simulation function for continuous trait with time-dependant coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata_time_dep(
  N = 10,
  f = list(at = "-0.05", f1t = "80", Qt = "2e-8", ft = "80", bt = "5", mu0t = "1e-3"),
  step = 1,
  tstart = 30,
  tend = 105,
  ystart = 80,
  sd0 = 1,
  nobs = NULL,
  format = "short"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simdata_time_dep_+3A_n">N</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_f">f</code></td>
<td>
<p>a list of formulas that define age (time) - dependency. Default: list(at=&quot;a&quot;, f1t=&quot;f1&quot;, Qt=&quot;Q*exp(theta*t)&quot;, ft=&quot;f&quot;, bt=&quot;b&quot;, mu0t=&quot;mu0*exp(theta*t)&quot;)</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_step">step</code></td>
<td>
<p>An interval between two observations, a random uniformally-distributed value is then added to this step.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_tstart">tstart</code></td>
<td>
<p>Starting time (age).
Can be a number (30 by default) or a vector of two numbers: c(a, b) - in this case, starting value of time 
is simulated via uniform(a,b) distribution.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_tend">tend</code></td>
<td>
<p>A number, defines final time (105 by default).</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_ystart">ystart</code></td>
<td>
<p>A starting value of covariates.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_sd0">sd0</code></td>
<td>
<p>A standard deviation for modelling the next covariate value, sd0 = 1 by default.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_nobs">nobs</code></td>
<td>
<p>A number of observations (lines) for individual observations.</p>
</td></tr>
<tr><td><code id="simdata_time_dep_+3A_format">format</code></td>
<td>
<p>Data format: &quot;short&quot; (default), &quot;long&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table with simulated data.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Health decline, aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
dat &lt;- simdata_time_dep(N=100)
head(dat)

</code></pre>

<hr>
<h2 id='spm'>A central function that estimates Stochastic Process Model parameters a from given dataset.</h2><span id='topic+spm'></span>

<h3>Description</h3>

<p>A central function that estimates Stochastic Process Model parameters a from given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm(
  x,
  model = "discrete",
  formulas = list(at = "a", f1t = "f1", Qt = "Q", ft = "f", bt = "b", mu0t = "mu0"),
  start = NULL,
  tol = NULL,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  pinv.tol = 0.01,
  theta.range = seq(0.01, 0.2, by = 0.001),
  verbose = FALSE,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_+3A_x">x</code></td>
<td>
<p>A dataset: is the output from prepare_data(...) function and consists of two separate data tables:
(1) a data table for continuous-time model and (2) a data table for discrete-time model.</p>
</td></tr>
<tr><td><code id="spm_+3A_model">model</code></td>
<td>
<p>A model type. Choices are: &quot;discrete&quot;, &quot;continuous&quot; or &quot;time-dependent&quot;.</p>
</td></tr>
<tr><td><code id="spm_+3A_formulas">formulas</code></td>
<td>
<p>A list of parameter formulas used in the &quot;time-dependent&quot; model.
Default: <code>formulas=list(at="a", f1t="f1", Qt="Q", ft="f", bt="b", mu0t="mu0")</code>.</p>
</td></tr>
<tr><td><code id="spm_+3A_start">start</code></td>
<td>
<p>A starting values of coefficients in the &quot;time-dependent&quot; model.</p>
</td></tr>
<tr><td><code id="spm_+3A_tol">tol</code></td>
<td>
<p>A tolerance threshold for matrix inversion (NULL by default).</p>
</td></tr>
<tr><td><code id="spm_+3A_stopifbound">stopifbound</code></td>
<td>
<p>A flag (default=FALSE) if it is set then the optimization stops 
when any of the parametrs achives lower or upper boundary.</p>
</td></tr>
<tr><td><code id="spm_+3A_lb">lb</code></td>
<td>
<p>Lower boundary, default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="spm_+3A_ub">ub</code></td>
<td>
<p>Upper boundary, default <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="spm_+3A_pinv.tol">pinv.tol</code></td>
<td>
<p>A tolerance threshold for matrix pseudo-inverse. Default: 0.01.</p>
</td></tr>
<tr><td><code id="spm_+3A_theta.range">theta.range</code></td>
<td>
<p>A user-defined range of the parameter <code>theta</code> used in 
discrete-time optimization and estimating of starting point for continuous-time optimization.</p>
</td></tr>
<tr><td><code id="spm_+3A_verbose">verbose</code></td>
<td>
<p>A verbosing output indicator (FALSE by default).</p>
</td></tr>
<tr><td><code id="spm_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 and Q are used:
mu0 = mu0*exp(theta*t), Q = Q*exp(theta*t).</p>
</td></tr>
<tr><td><code id="spm_+3A_opts">opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For &quot;discrete&quot; (dmodel) and &quot;continuous&quot; (cmodel) model types: 
(1) a list of model parameter estimates for the discrete model type described in 
&quot;Life tables with covariates: Dynamic Model for Nonlinear Analysis of Longitudinal Data&quot;, 
Akushevich et al, 2005.&lt;DOI:10.1080/08898480590932296&gt;,  and  
(2) a list of model parameter estimates for the continuous model type described in 
&quot;Stochastic model for analysis of longitudinal data on aging and mortality&quot;, 
Yashin et al, 2007, Math Biosci.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>
<p>For the &quot;time-dependent&quot; model (model parameters depend on time): a set of model parameter estimates.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.
</p>
<p>Akushevich I., Kulminski A. and Manton K. (2005). Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. Mathematical Popu-lation Studies, 12(2), pp.: 51-80.
&lt;DOI: 10.1080/08898480590932296&gt;.
</p>
<p>Yashin, A. et al (2007), Health decline, aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(stpm)
data.continuous &lt;- simdata_cont(N=1000)
data.discrete &lt;- simdata_discr(N=1000)
data &lt;- list(data.continuous, data.discrete)
p.discr.model &lt;- spm(data)
p.discr.model
p.cont.model &lt;- spm(data, model="continuous")
p.cont.model
p.td.model &lt;- spm(data, 
model="time-dependent",f=list(at="aa*t+bb", f1t="f1", Qt="Q", ft="f", bt="b", mu0t="mu0"), 
start=list(a=-0.001, bb=0.05, f1=80, Q=2e-8, f=80, b=5, mu0=1e-3))
p.td.model

## End(Not run)
</code></pre>

<hr>
<h2 id='spm_con_1d'>Fitting a 1-D SPM model with constant parameters</h2><span id='topic+spm_con_1d'></span>

<h3>Description</h3>

<p>This function implements a analytical solution to estimate the parameters in the continuous SPM model by assuming all the parameters are constants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_con_1d(
  spm_data,
  a = NA,
  b = NA,
  q = NA,
  f = NA,
  f1 = NA,
  mu0 = NA,
  theta = NA,
  lower = c(),
  upper = c(),
  control = list(xtol_rel = 1e-06),
  global = FALSE,
  verbose = TRUE,
  ahessian = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_con_1d_+3A_spm_data">spm_data</code></td>
<td>
<p>A dataset for the SPM model. See the STPM package for more details about the format.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_a">a</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">a</code>. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_b">b</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">b</code>. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_q">q</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">q</code>. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_f">f</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f</code>. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_f1">f1</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f_1</code>. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_mu0">mu0</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\mu_0</code> in the baseline hazard. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_theta">theta</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\theta</code> in the baseline hazard. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_lower">lower</code></td>
<td>
<p>A vector of the lower bound of the parameters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_upper">upper</code></td>
<td>
<p>A vector of the upper bound of the parameters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_control">control</code></td>
<td>
<p>A list of the control parameters for the optimization paramters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_global">global</code></td>
<td>
<p>A logical variable indicating whether the MLSL (TRUE) or the L-BFGS (FALSE) algorithm is used for the optimization.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_verbose">verbose</code></td>
<td>
<p>A logical variable indicating whether initial information is printed.</p>
</td></tr>
<tr><td><code id="spm_con_1d_+3A_ahessian">ahessian</code></td>
<td>
<p>A logical variable indicating whether the approximate (FALSE) or analytical (TRUE) Hessian is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>est The estimates of the parameters.
</p>
<p>hessian The Hessian matrix of the estimates.
</p>
<p>lik The minus log-likelihood.
</p>
<p>con A number indicating the convergence. See the 'nloptr' package for more details.
</p>
<p>message Extra message about the convergence. See the 'nloptr' package for more details.
</p>


<h3>References</h3>

<p>He, L., Zhbannikov, I., Arbeev, K. G., Yashin, A. I., and Kulminski, A.M., 2017. Genetic stochastic process model for detecting pleiotropic and interaction effects with longitudinal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{ 
library(stpm) 
dat &lt;- simdata_cont(N=500)
colnames(dat) &lt;- c("id", "xi", "t1", "t2", "y", "y.next")
res &lt;- spm_con_1d(as.data.frame(dat), a=-0.05, b=2, q=1e-8, f=80, f1=90, mu0=1e-3, theta=0.08)
}
</code></pre>

<hr>
<h2 id='spm_con_1d_g'>Fitting a 1-D genetic SPM model with constant parameters</h2><span id='topic+spm_con_1d_g'></span>

<h3>Description</h3>

<p>This function implements a continuous genetic SPM model by assuming all the parameters are constants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_con_1d_g(
  spm_data,
  gene_data,
  a = NA,
  b = NA,
  q = NA,
  f = NA,
  f1 = NA,
  mu0 = NA,
  theta = NA,
  effect = c("a"),
  lower = c(),
  upper = c(),
  control = list(xtol_rel = 1e-06),
  global = FALSE,
  verbose = TRUE,
  ahessian = FALSE,
  method = "lbfgs",
  method.hessian = "L-BFGS-B"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_con_1d_g_+3A_spm_data">spm_data</code></td>
<td>
<p>A dataset for the SPM model. See the STPM pacakge for more details about the format.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_gene_data">gene_data</code></td>
<td>
<p>A two column dataset containing the genotypes for the individuals in spm_data. 
The first column <code>id</code> is the ID of the individuals in spm_data, 
and the second column <code>geno</code> is the genotype.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_a">a</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">a</code>. 
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_b">b</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">b</code>. 
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_q">q</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">q</code>. 
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_f">f</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f</code>. 
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_f1">f1</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">f_1</code>. 
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_mu0">mu0</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\mu_0</code> 
in the baseline hazard.
The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_theta">theta</code></td>
<td>
<p>The initial value for the paramter <code class="reqn">\theta</code> 
in the baseline hazard. The initial value will be predicted if not specified.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_effect">effect</code></td>
<td>
<p>A character vector of the parameters that are linked to genotypes. 
The vector can contain any combination of <code>a</code>, <code>b</code>, <code>q</code>, <code>f</code>, <code>mu0</code>.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_lower">lower</code></td>
<td>
<p>A vector of the lower bound of the parameters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_upper">upper</code></td>
<td>
<p>A vector of the upper bound of the parameters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_control">control</code></td>
<td>
<p>A list of the control parameters for the optimization paramters.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_global">global</code></td>
<td>
<p>A logical variable indicating whether the MLSL (TRUE) or 
the L-BFGS (FALSE) algorithm is used for the optimization.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_verbose">verbose</code></td>
<td>
<p>A logical variable indicating whether initial 
information is printed.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_ahessian">ahessian</code></td>
<td>
<p>A logical variable indicating whether the 
approximate (FALSE) or analytical (TRUE) Hessian is returned.</p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_method">method</code></td>
<td>
<p>Optimization method. 
Can be one of the following: lbfgs, mlsl, mma, slsqp, tnewton, varmetric.
Default: <code>lbfgs.</code></p>
</td></tr>
<tr><td><code id="spm_con_1d_g_+3A_method.hessian">method.hessian</code></td>
<td>
<p>Optimization method for hessian calculation (if ahessian=F).
Default: <code>L-BFGS-B</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>est The estimates of the parameters.
</p>
<p>hessian The Hessian matrix of the estimates.
</p>
<p>hessian The Hessian matrix of the estimates.
</p>
<p>lik The minus log-likelihood.
</p>
<p>con A number indicating the convergence. See the 'nloptr' package for more details.
</p>
<p>message Extra message about the convergence. See the 'nloptr' package for more details.
</p>
<p>beta The coefficients of the genetic effect on the parameters to be linked to genotypes.
</p>


<h3>References</h3>

<p>He, L., Zhbannikov, I., Arbeev, K. G., Yashin, A. I., and Kulminski, A.M., 2017. 
Genetic stochastic process model for detecting pleiotropic and interaction effects with longitudinal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(stpm) 
data(ex_spmcon1dg)
res &lt;- spm_con_1d_g(ex_data$spm_data, ex_data$gene_data, 
a = -0.02, b=0.2, q=0.01, f=3, f1=3, mu0=0.01, theta=1e-05, 
upper=c(-0.01,3,0.1,10,10,0.1,1e-05), lower=c(-1,0.01,0.00001,1,1,0.001,1e-05), 
effect=c('q'))

## End(Not run)
</code></pre>

<hr>
<h2 id='spm_cont_lin'>Continuous multi-dimensional optimization with linear terms in mu only</h2><span id='topic+spm_cont_lin'></span>

<h3>Description</h3>

<p>Continuous multi-dimensional optimization with linear terms in mu only
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_cont_lin(
  dat,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 2e-05,
  theta = 0.08,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  pinv.tol = 0.01,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_cont_lin_+3A_dat">dat</code></td>
<td>
<p>A data table.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_a">a</code></td>
<td>
<p>A starting value of the rate of adaptive response to any deviation of Y from f1(t).</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_f1">f1</code></td>
<td>
<p>A starting value of the average age trajectories of the variables which process is forced to follow.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_q">Q</code></td>
<td>
<p>Starting values of the linear hazard term.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_f">f</code></td>
<td>
<p>A starting value of the &quot;optimal&quot; value of variable which corresponds to the minimum of hazard rate at a respective time.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_b">b</code></td>
<td>
<p>A starting value of a diffusion coefficient representing a strength of the random disturbance from Wiener Process.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_mu0">mu0</code></td>
<td>
<p>A starting value of the baseline hazard.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_theta">theta</code></td>
<td>
<p>A starting value of the parameter theta (axe displacement of Gompertz function).</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_stopifbound">stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter achieves lower or upper boundaries.
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_lb">lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_ub">ub</code></td>
<td>
<p>Upper bound of parameters under estimation.
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_verbose">verbose</code></td>
<td>
<p>An indicator of verbosing output.</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_pinv.tol">pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="spm_cont_lin_+3A_opts">opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>spm_continuous</code> runs much slower that discrete but more precise and can handle time 
intervals with different lengths.
</p>


<h3>Value</h3>

<p>A set of estimated parameters a, f1, Q, f, b, mu0, theta and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by nloptr optimization function (see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
set.seed(123)
#Reading the data:
data &lt;- simdata_cont(N=2)
head(data)
#Parameters estimation:
pars &lt;- spm_cont_lin(dat=data,a=-0.05, f1=80, 
					           Q=2e-8, f=80, b=5, mu0=2e-5)
pars

</code></pre>

<hr>
<h2 id='spm_cont_quad_lin'>Continuous multi-dimensional optimization with quadratic and linear terms</h2><span id='topic+spm_cont_quad_lin'></span>

<h3>Description</h3>

<p>Continuous multi-dimensional optimization with quadratic and linear terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_cont_quad_lin(
  dat,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 2e-05,
  theta = 0.08,
  Q1 = 1e-08,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  pinv.tol = 0.01,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_cont_quad_lin_+3A_dat">dat</code></td>
<td>
<p>A data table.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_a">a</code></td>
<td>
<p>A starting value of the rate of adaptive response to any deviation of Y from f1(t).</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_f1">f1</code></td>
<td>
<p>A starting value of the average age trajectories of the variables which process is forced to follow.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_q">Q</code></td>
<td>
<p>Starting values of the quadratic hazard term.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_f">f</code></td>
<td>
<p>A starting value of the &quot;optimal&quot; value of variable which corresponds to the minimum of hazard rate at a respective time.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_b">b</code></td>
<td>
<p>A starting value of a diffusion coefficient representing a strength of the random disturbance from Wiener Process.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_mu0">mu0</code></td>
<td>
<p>A starting value of the baseline hazard.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_theta">theta</code></td>
<td>
<p>A starting value of the parameter theta (axe displacement of Gompertz function).</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_q1">Q1</code></td>
<td>
<p>Q for linear term</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_stopifbound">stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter achieves lower or upper boundaries.
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_lb">lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_ub">ub</code></td>
<td>
<p>Upper bound of parameters under estimation.
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_verbose">verbose</code></td>
<td>
<p>An indicator of verbosing output.</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_pinv.tol">pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="spm_cont_quad_lin_+3A_opts">opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>spm_continuous</code> runs much slower that discrete but more precise and can handle time 
intervals with different lengths.
</p>


<h3>Value</h3>

<p>A set of estimated parameters a, f1, Q, f, b, mu0, theta and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by nloptr optimization function (see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
set.seed(123)
#Reading the data:
data &lt;- simdata_cont(N=2)
head(data)
#Parameters estimation:
pars &lt;- spm_cont_quad_lin(dat=data,a=-0.05, f1=80, 
					           Q=2e-8, f=80, b=5, mu0=2e-5, Q1=1e-08)
pars

</code></pre>

<hr>
<h2 id='spm_continuous'>Continuous multi-dimensional optimization</h2><span id='topic+spm_continuous'></span>

<h3>Description</h3>

<p>Continuous multi-dimensional optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_continuous(
  dat,
  a = -0.05,
  f1 = 80,
  Q = 2e-08,
  f = 80,
  b = 5,
  mu0 = 2e-05,
  theta = 0.08,
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  pinv.tol = 0.01,
  gomp = FALSE,
  opts = list(algorithm = "NLOPT_LN_NELDERMEAD", maxeval = 100, ftol_rel = 1e-08),
  logmu0 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_continuous_+3A_dat">dat</code></td>
<td>
<p>A data table.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_a">a</code></td>
<td>
<p>A starting value of the rate of adaptive response to any deviation of Y from f1(t).</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_f1">f1</code></td>
<td>
<p>A starting value of the average age trajectories of the variables which process is forced to follow.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_q">Q</code></td>
<td>
<p>Starting values of the quadratic hazard term.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_f">f</code></td>
<td>
<p>A starting value of the &quot;optimal&quot; value of variable which corresponds to the minimum of hazard rate at a respective time.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_b">b</code></td>
<td>
<p>A starting value of a diffusion coefficient representing a strength of the random disturbance from Wiener Process.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_mu0">mu0</code></td>
<td>
<p>A starting value of the baseline hazard.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_theta">theta</code></td>
<td>
<p>A starting value of the parameter theta (axe displacement of Gompertz function).</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_stopifbound">stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter achieves lower or upper boundaries.
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_lb">lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_ub">ub</code></td>
<td>
<p>Upper bound of parameters under estimation.
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_verbose">verbose</code></td>
<td>
<p>An indicator of verbosing output.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_pinv.tol">pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_opts">opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td></tr>
<tr><td><code id="spm_continuous_+3A_logmu0">logmu0</code></td>
<td>
<p>Natural logarith of baseline mortality.
Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>spm_continuous</code> runs much slower that discrete but more precise and can handle time 
intervals with different lengths.
</p>


<h3>Value</h3>

<p>A set of estimated parameters a, f1, Q, f, b, mu0, theta and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by nloptr optimization function (see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
set.seed(123)
#Reading the data:
data &lt;- simdata_cont(N=2)
head(data)
#Parameters estimation:
pars &lt;- spm_continuous(dat=data,a=-0.05, f1=80, 
					           Q=2e-8, f=80, b=5, mu0=2e-5)
pars

</code></pre>

<hr>
<h2 id='spm_discrete'>Discrete multi-dimensional optimization</h2><span id='topic+spm_discrete'></span>

<h3>Description</h3>

<p>Discrete multi-dimensional optimization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_discrete(
  dat,
  theta_range = seq(0.02, 0.2, by = 0.001),
  tol = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_discrete_+3A_dat">dat</code></td>
<td>
<p>A data table.</p>
</td></tr>
<tr><td><code id="spm_discrete_+3A_theta_range">theta_range</code></td>
<td>
<p>A range of <code>theta</code> parameter (axe displacement of Gompertz function), default: from 0.001 to 0.09 with step of 0.001.</p>
</td></tr>
<tr><td><code id="spm_discrete_+3A_tol">tol</code></td>
<td>
<p>A tolerance threshold for matrix inversion (NULL by default).</p>
</td></tr>
<tr><td><code id="spm_discrete_+3A_verbose">verbose</code></td>
<td>
<p>An indicator of verbosing output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is way more faster that continuous <code>spm_continuous_MD(...)</code> (but less precise) and used mainly in 
estimation a starting point for the <code>spm_continuous_MD(...)</code>.
</p>


<h3>Value</h3>

<p>A list of two elements (&quot;dmodel&quot;, &quot;cmodel&quot;): (1) estimated parameters u, R, b, Sigma, Q, mu0, theta for discrete-time model and
(2) estimated parameters a, f1, Q, f, b, mu0, theta for continuous-time model. Note: b and mu0 from first list are different 
from b and mu0 from the second list.
</p>


<h3>References</h3>

<p>Akushevich I., Kulminski A. and Manton K. (2005), Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. Mathematical Population Studies, 12(2), pp.: 51-80.
&lt;DOI:10.1080/08898480590932296&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
data &lt;- simdata_discr(N=10)
#Parameters estimation
pars &lt;- spm_discrete(data)
pars

</code></pre>

<hr>
<h2 id='spm_pobs'>Continuous-time multi-dimensional optimization for SPM with partially observed covariates (multidimensional GenSPM)</h2><span id='topic+spm_pobs'></span>

<h3>Description</h3>

<p>Continuous-time multi-dimensional optimization for SPM with partially observed covariates (multidimensional GenSPM)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_pobs(
  x = NULL,
  y = NULL,
  aH = -0.05,
  aL = -0.01,
  f1H = 60,
  f1L = 80,
  QH = 2e-08,
  QL = 2.5e-08,
  fH = 60,
  fL = 80,
  bH = 4,
  bL = 5,
  mu0H = 8e-06,
  mu0L = 1e-05,
  thetaH = 0.08,
  thetaL = 0.1,
  p = 0.25,
  stopifbound = FALSE,
  algorithm = "NLOPT_LN_NELDERMEAD",
  lb = NULL,
  ub = NULL,
  maxeval = 500,
  verbose = FALSE,
  pinv.tol = 0.01,
  mode = "observed",
  gomp = TRUE,
  ftol_rel = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_pobs_+3A_x">x</code></td>
<td>
<p>A data table with genetic component.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_y">y</code></td>
<td>
<p>A data table without genetic component.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_ah">aH</code></td>
<td>
<p>A k by k matrix. Characterizes the rate of the adaptive response for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_al">aL</code></td>
<td>
<p>A k by k matrix. Characterize the rate of the adaptive response for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_f1h">f1H</code></td>
<td>
<p>A deviation from the norm (or optimal) state for Z = 1.
This is a vector of length k.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_f1l">f1L</code></td>
<td>
<p>A deviation from the norm (or optimal) for Z = 0. 
This is a vector of length k.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_qh">QH</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_ql">QL</code></td>
<td>
<p>A matrix k by k, which is a non-negative-definite symmetric matrix for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_fh">fH</code></td>
<td>
<p>A vector with length of k. Represents the normal (or optimal) state for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_fl">fL</code></td>
<td>
<p>A vector with length of k. Represents the normal (or optimal) state for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_bh">bH</code></td>
<td>
<p>A diffusion coefficient, k by k matrix for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_bl">bL</code></td>
<td>
<p>A diffusion coefficient, k by k matrix for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_mu0h">mu0H</code></td>
<td>
<p>A baseline mortality for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_mu0l">mu0L</code></td>
<td>
<p>A baseline mortality for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_thetah">thetaH</code></td>
<td>
<p>A displacement coefficient for Z = 1.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_thetal">thetaL</code></td>
<td>
<p>A displacement coefficient for Z = 0.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_p">p</code></td>
<td>
<p>a hyphotetical percentage of presence of partially observed covariate in a population (default p=0.25).</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_stopifbound">stopifbound</code></td>
<td>
<p>If TRUE then estimation stops if at least one parameter achieves lower or upper boundaries.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_algorithm">algorithm</code></td>
<td>
<p>An optimization algorithm used, can be one of those provided by <code>nloptr</code>. 
#'Check the NLopt website for a description of
the algorithms. Default: NLOPT_LN_NELDERMEAD</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_lb">lb</code></td>
<td>
<p>Lower bound of parameter values.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_ub">ub</code></td>
<td>
<p>Upper bound of parameter values.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_maxeval">maxeval</code></td>
<td>
<p>Maximum number of iterations of the algorithm for <code>nloptr</code> optimization. 
The program stops when the number of function evaluations exceeds maxeval. Default: 500.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_verbose">verbose</code></td>
<td>
<p>An indicator of verbosing output (FALSE by default).</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_pinv.tol">pinv.tol</code></td>
<td>
<p>A tolerance value for pseudo-inverse of matrix gamma (see Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.)</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_mode">mode</code></td>
<td>
<p>Can be one of the following: &quot;observed&quot; (default), &quot;unobserved&quot; or &quot;combined&quot;. 
mode = &quot;observed&quot; represents analysing only dataset with observed variable Z.
mode = &quot;unobserved&quot; represents analysing only dataset of unobserved variable Z.
mode = &quot;combined&quot; denoted joint analysis of both observed and unobserved datasets.</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). When it is set, then time-dependent exponential form of mu0 is used:
mu0 = mu0*exp(theta*t).</p>
</td></tr>
<tr><td><code id="spm_pobs_+3A_ftol_rel">ftol_rel</code></td>
<td>
<p>Relative tolerance threshold for likelihood function (defalult: 1e-6), 
see http://ab-initio.mit.edu/wiki/index.php/NLopt_Reference</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A set of estimated parameters aH, aL, f1H, f1H, QH, QL, fH, fL, bH, bL, mu0H, mu0L, thetaH, thetaL, p and
additional variable <code>limit</code> which indicates if any parameter 
achieved lower or upper boundary conditions (FALSE by default).
</p>


<h3>References</h3>

<p>Arbeev, K.G. et al (2009). Genetic model for longitudinal studies of aging, health, and longevity
</p>
<p>Yashin, A.I. et al (2007). Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.&lt;DOI:10.1016/j.mbs.2006.11.006&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(stpm)
#Reading the data:
data &lt;- sim_pobs(N=1000)
head(data)
#Parameters estimation:
pars &lt;- spm_pobs(x=data)
pars

## End(Not run)
</code></pre>

<hr>
<h2 id='spm_projection'>A data projection with previously estimated or user-defined parameters. 
Projections are constructed for a cohort with fixed or 
normally distributed initial covariates.</h2><span id='topic+spm_projection'></span>

<h3>Description</h3>

<p>A data projection with previously estimated or user-defined parameters. 
Projections are constructed for a cohort with fixed or 
normally distributed initial covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_projection(
  x,
  N = 100,
  ystart = 80,
  model = "discrete",
  tstart = 30,
  tend = 105,
  dt = 1,
  sd0 = 1,
  nobs = NULL,
  gomp = TRUE,
  format = "short"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_projection_+3A_x">x</code></td>
<td>
<p>A list of parameters from output of the <code>spm(...)</code> function.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_n">N</code></td>
<td>
<p>A number of individuals to simulate, N=100 by default.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_ystart">ystart</code></td>
<td>
<p>A vector of starting values of covariates (variables), ystart=80 by default.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_model">model</code></td>
<td>
<p>A model type. Choices are: &quot;discrete&quot;, &quot;continuous&quot; or &quot;time-dependent&quot;.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_tstart">tstart</code></td>
<td>
<p>Start time (age), default=30. Can be an interval: c(a, b) - in this case,
the starting time is sumulated via <code>runif(1, a, b)</code>.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_tend">tend</code></td>
<td>
<p>End time (age), default=105.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_dt">dt</code></td>
<td>
<p>A time interval between observations, dt=1 by default.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_sd0">sd0</code></td>
<td>
<p>A standard deviation value for simulation of the next value of variable.
sd0=1 by default.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_nobs">nobs</code></td>
<td>
<p>A number of observations (lines) for i-th individual.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_gomp">gomp</code></td>
<td>
<p>A flag (FALSE by default). 
When it is set, then time-dependent exponential form of mu0 and Q are used:
mu0 = mu0*exp(theta*t), Q = Q*exp(theta*t). 
Only for continous-time SPM.</p>
</td></tr>
<tr><td><code id="spm_projection_+3A_format">format</code></td>
<td>
<p>Data format: &quot;short&quot; (default), &quot;long&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of 'spm.projection' class with two elements. 
(1) A simulated data set.
(2) A summary statistics which includes (i) age-specific means of state variables and
(ii) Survival probabilities.
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), 
Stochastic model for analysis of longitudinal data on aging 
and mortality. Mathematical Biosciences, 208(2), 538-551.
</p>
<p>Akushevich I., Kulminski A. and Manton K. (2005). 
Life tables with covariates: Dynamic model 
for Nonlinear Analysis of Longitudinal Data. 
Mathematical Popu-lation Studies, 12(2), pp.: 51-80.
&lt;DOI: 10.1080/08898480590932296&gt;.
</p>
<p>Yashin, A. et al (2007), Health decline, 
aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(stpm)
set.seed(123)
# Setting up the model
model.par &lt;- list()
model.par$a &lt;- matrix(c(-0.05, 1e-3, 2e-3, -0.05), nrow=2, ncol=2, byrow=TRUE)
model.par$f1 &lt;- matrix(c(90, 35), nrow=1, ncol=2)
model.par$Q &lt;- matrix(c(1e-8, 1e-9, 1e-9, 1e-8), nrow=2, ncol=2, byrow=TRUE)
model.par$f &lt;- matrix(c(80, 27), nrow=1, ncol=2)
model.par$b &lt;- matrix(c(6, 2), nrow=2, ncol=2)
model.par$mu0 &lt;- 1e-6
model.par$theta &lt;- 0.09
# Projection
# Discrete-time model
data.proj.discrete &lt;- spm_projection(model.par, N=5000, ystart=c(80, 27))
plot(data.proj.discrete$stat$srv.prob)
# Continuous-time model
data.proj.continuous &lt;- spm_projection(model.par, N=5000, 
ystart=c(80, 27), model="continuous")
plot(data.proj.continuous$stat$srv.prob)
# Time-dependent model
model.par &lt;- list(at = "-0.05", f1t = "80", Qt = "2e-8", 
ft= "80", bt = "5", mu0t = "1e-5*exp(0.11*t)")
data.proj.time_dependent &lt;- spm_projection(model.par, N=500, 
ystart=80, model="time-dependent")
plot(data.proj.time_dependent$stat$srv.prob, xlim = c(30,105))

## End(Not run)
</code></pre>

<hr>
<h2 id='spm_time_dep'>A function for the model with time-dependent model parameters.</h2><span id='topic+spm_time_dep'></span>

<h3>Description</h3>

<p>A function for the model with time-dependent model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm_time_dep(
  x,
  start = list(a = -0.05, f1 = 80, Q = 2e-08, f = 80, b = 5, mu0 = 0.001),
  frm = list(at = "a", f1t = "f1", Qt = "Q", ft = "f", bt = "b", mu0t = "mu0"),
  stopifbound = FALSE,
  lb = NULL,
  ub = NULL,
  verbose = FALSE,
  opts = NULL,
  lrtest = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm_time_dep_+3A_x">x</code></td>
<td>
<p>Input data table.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_start">start</code></td>
<td>
<p>A list of starting parameters, default: 
<code>start=list(a=-0.5, f1=80, Q=2e-8, f=80, b=5, mu0=1e-5)</code>.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_frm">frm</code></td>
<td>
<p>A list of formulas that define age (time) - dependency. 
Default: <code>frm=list(at="a", f1t="f1", Qt="Q", ft="f", bt="b", 
mu0t="mu0")</code>.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_stopifbound">stopifbound</code></td>
<td>
<p>Estimation stops if at least one parameter 
achieves lower or upper boundaries. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_lb">lb</code></td>
<td>
<p>Lower bound of parameters under estimation.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_ub">ub</code></td>
<td>
<p>Upper bound of parameters under estimation.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_verbose">verbose</code></td>
<td>
<p>Turns on verbosing output.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_opts">opts</code></td>
<td>
<p>A list of options for <code>nloptr</code>.
Default value: <code>opt=list(algorithm="NLOPT_LN_NELDERMEAD", 
maxeval=100, ftol_rel=1e-8)</code>.</p>
</td></tr>
<tr><td><code id="spm_time_dep_+3A_lrtest">lrtest</code></td>
<td>
<p>Indicates should Likelihood-Ratio test be performed.
Possible values: <code>TRUE</code>, <code>H01</code>, <code>H02</code>, <code>H03</code>,
<code>H04</code>, <code>H05</code> (see package Vignette for details)
Default value: <code>FALSE</code>.
Please see <code>nloptr</code> documentation for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A set of estimates of <code>a</code>, <code>f1</code>, <code>Q</code>, 
<code>f</code>, <code>b</code>, <code>mu0</code>.
</p>
<p>status Optimization status (see documentation for nloptr package).
</p>
<p>LogLik A logarithm likelihood.
</p>
<p>objective A value of objective function (given by nloptr).
</p>
<p>message A message given by <code>nloptr</code> optimization function 
(see documentation for nloptr package).
</p>


<h3>References</h3>

<p>Yashin, A. et al (2007), Health decline, 
aging and mortality: how are they related? 
Biogerontology, 8(3), 291-302.&lt;DOI:10.1007/s10522-006-9073-3&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(stpm)
set.seed(123)
#Data preparation:
n &lt;- 5
data &lt;- simdata_time_dep(N=n)
# Estimation:
opt.par &lt;- spm_time_dep(data)
opt.par
</code></pre>

<hr>
<h2 id='spm.impute'>Multiple Data Imputation with SPM</h2><span id='topic+spm.impute'></span>

<h3>Description</h3>

<p>Multiple Data Imputation with SPM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spm.impute(
  x,
  id = 1,
  case = 2,
  t1 = 3,
  t2 = 3,
  covariates = 4,
  minp = 5,
  theta_range = seq(0.01, 0.2, by = 0.001)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spm.impute_+3A_x">x</code></td>
<td>
<p>A longitudinal dataset with missing observations</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_id">id</code></td>
<td>
<p>A name (text) or index (numeric) of ID column. Default: 1</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_case">case</code></td>
<td>
<p>A case status column name (text) or index (numeric). Default: 2</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_t1">t1</code></td>
<td>
<p>A t1 (or t if short format is used) column name (text) or index (numeric). Default: 3</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_t2">t2</code></td>
<td>
<p>A t2 column name (if long format is used) (text) or index (numeric). Default: 4</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_covariates">covariates</code></td>
<td>
<p>A list of covariate column names or indices. Default: 5</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_minp">minp</code></td>
<td>
<p>Number of imputations. Default: 5</p>
</td></tr>
<tr><td><code id="spm.impute_+3A_theta_range">theta_range</code></td>
<td>
<p>A range of parameter theta used for optimization, default: seq(0.01, 0.15, by=0.001).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list(imputed, imputations)
</p>
<p>imputed An imputed dataset.
</p>
<p>imputations Temporary imputed datasets used in multiple imputaitons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(stpm) 
##Data preparation ##
data &lt;- simdata_discr(N=1000, dt = 2)
miss.id &lt;- sample(x=dim(data)[1], size=round(dim(data)[1]/4)) # ~25% missing data
incomplete.data &lt;- data
incomplete.data[miss.id,5] &lt;- NA
incomplete.data[miss.id-1,6] &lt;- NA
## End of data preparation ##

# Estimate parameters from the complete dataset #
p &lt;- spm_discrete(data, theta_range = seq(0.075, 0.09, by=0.001))
p

##### Multiple imputation with SPM #####
imp.data &lt;- spm.impute(x=incomplete.data, 
                      minp=5, 
                      theta_range=seq(0.075, 0.09, by=0.001))$imputed
head(imp.data)
## Estimate SPM parameters from imputed data and compare them to the p ##
pp.test &lt;- spm_discrete(imp.data, theta_range = seq(0.075, 0.09, by=0.001))
pp.test

## End(Not run)
</code></pre>

<hr>
<h2 id='trim'>Returns string w/o leading or trailing whitespace</h2><span id='topic+trim'></span>

<h3>Description</h3>

<p>Returns string w/o leading or trailing whitespace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trim_+3A_x">x</code></td>
<td>
<p>a string to trim</p>
</td></tr>
</table>

<hr>
<h2 id='trim.leading'>Returns string w/o leading whitespace</h2><span id='topic+trim.leading'></span>

<h3>Description</h3>

<p>Returns string w/o leading whitespace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim.leading(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trim.leading_+3A_x">x</code></td>
<td>
<p>a string to trim</p>
</td></tr>
</table>

<hr>
<h2 id='trim.trailing'>Returns string w/o trailing whitespace</h2><span id='topic+trim.trailing'></span>

<h3>Description</h3>

<p>Returns string w/o trailing whitespace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim.trailing(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trim.trailing_+3A_x">x</code></td>
<td>
<p>a string to trim</p>
</td></tr>
</table>

<hr>
<h2 id='vitstat'>Vital (mortality) statistics.</h2><span id='topic+vitstat'></span>

<h3>Description</h3>

<p>Vital (mortality) statistics.
</p>


<h3>Author(s)</h3>

<p>Ilya Y Zhbannikov <a href="mailto:ilya.zhbannikov@duke.edu">ilya.zhbannikov@duke.edu</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
