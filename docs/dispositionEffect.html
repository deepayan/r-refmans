<!DOCTYPE html><html><head><title>Help for package dispositionEffect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dispositionEffect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#checks'><p>Checks functions</p></a></li>
<li><a href='#closest_market_price'><p>Closest market price</p></a></li>
<li><a href='#DEanalysis'><p>Real sample data for Disposition Effect analysis</p></a></li>
<li><a href='#difference_in_time'><p>Difference in time</p></a></li>
<li><a href='#disposition_effect'><p>Disposition Effect</p></a></li>
<li><a href='#dispositionEffect-package'><p>dispositionEffect: behavioral Analysis on Financial Data</p></a></li>
<li><a href='#evaluate'><p>Portfolio evaluation</p></a></li>
<li><a href='#gains_losses'><p>Gains &amp; Losses</p></a></li>
<li><a href='#initializers'><p>Initializers functions</p></a></li>
<li><a href='#investor'><p>Sample investor financial transactions</p></a></li>
<li><a href='#manipulate_initial_data'><p>Pre-process transactions and market prices data frames</p></a></li>
<li><a href='#marketprices'><p>Market prices of assets traded by the sample investor</p></a></li>
<li><a href='#negative_match'><p>Negative match operator</p></a></li>
<li><a href='#paper_compute'><p>Papers' estimation</p></a></li>
<li><a href='#portfolio_compute'><p>Portfolio Compute</p></a></li>
<li><a href='#portfolio_results'><p>Realized and paper results</p></a></li>
<li><a href='#portfolio_results_ts'><p>Realized and paper results</p></a></li>
<li><a href='#realized_compute'><p>Realized estimation</p></a></li>
<li><a href='#updates'><p>Update results over time</p></a></li>
<li><a href='#utils'><p>Utilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Disposition Effect on Financial Portfolios</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluate the presence of disposition effect and others irrational
    investor's behaviors based solely on investor's transactions and financial
    market data. Experimental data can also be used to perform the analysis.  
    Four different methodologies are implemented to account for the different
    nature of human behaviors on financial markets.  
    Novel analyses such as portfolio driven and time series disposition effect
    are also allowed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, purrr, lubridate, magrittr, progress</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools, knitr, rmarkdown, roxygen2, testthat, covr, tidyr,
skimr, ggplot2, ggridges, furrr, future, foreach, doParallel,
parallel, bench</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://marcozanotti.github.io/dispositionEffect/">https://marcozanotti.github.io/dispositionEffect/</a>,
<a href="https://github.com/marcozanotti/dispositionEffect">https://github.com/marcozanotti/dispositionEffect</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/marcozanotti/dispositionEffect/issues">https://github.com/marcozanotti/dispositionEffect/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-30 07:37:37 UTC; marco</td>
</tr>
<tr>
<td>Author:</td>
<td>Lorenzo Mazzucchelli [aut],
  Marco Zanotti [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Zanotti &lt;zanottimarco17@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-30 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>

<hr>
<h2 id='checks'>Checks functions</h2><span id='topic+checks'></span><span id='topic+check_values'></span><span id='topic+check_gainloss'></span><span id='topic+release_questions'></span>

<h3>Description</h3>

<p>Functions to perform checks on arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_values(
  input_values,
  target_values,
  no_exception = FALSE,
  weak_target = FALSE
)

check_gainloss(df)

release_questions()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checks_+3A_input_values">input_values</code></td>
<td>
<p>Input to check against target.</p>
</td></tr>
<tr><td><code id="checks_+3A_target_values">target_values</code></td>
<td>
<p>Target to check for in input.</p>
</td></tr>
<tr><td><code id="checks_+3A_no_exception">no_exception</code></td>
<td>
<p>Logical. If TRUE different values of inputs from targets
are not allowed to exist.</p>
</td></tr>
<tr><td><code id="checks_+3A_weak_target">weak_target</code></td>
<td>
<p>Logical. If TRUE inputs do not need to contain all the
targets.</p>
</td></tr>
<tr><td><code id="checks_+3A_df">df</code></td>
<td>
<p>Data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A result message or NULL.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>check_values</code>: Check consistency of values against targets and vice versa.
</p>
</li>
<li> <p><code>check_gainloss</code>: Check consistency of gains and losses &quot;values&quot; results.
</p>
</li>
<li> <p><code>release_questions</code>: Release questions
</p>
</li></ul>

<hr>
<h2 id='closest_market_price'>Closest market price</h2><span id='topic+closest_market_price'></span>

<h3>Description</h3>

<p>Find the market price closest to a certain datetime and for
specific assets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closest_market_price(
  asset,
  datetime,
  market_prices,
  price_only = FALSE,
  exact = FALSE,
  substitute_datetime = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="closest_market_price_+3A_asset">asset</code></td>
<td>
<p>Character vector of assets' names to look for.</p>
</td></tr>
<tr><td><code id="closest_market_price_+3A_datetime">datetime</code></td>
<td>
<p>POSIXct of the datetime at which looking for the asset's
price.</p>
</td></tr>
<tr><td><code id="closest_market_price_+3A_market_prices">market_prices</code></td>
<td>
<p>Data frame containing the market prices.</p>
</td></tr>
<tr><td><code id="closest_market_price_+3A_price_only">price_only</code></td>
<td>
<p>Logical. If TRUE then only the price is returned.</p>
</td></tr>
<tr><td><code id="closest_market_price_+3A_exact">exact</code></td>
<td>
<p>Logical. If TRUE then it looks for market prices at the same
datetime only, otherwise it looks for the nearest before the datetime.</p>
</td></tr>
<tr><td><code id="closest_market_price_+3A_substitute_datetime">substitute_datetime</code></td>
<td>
<p>Logical. If TRUE the datetime is substituted
with the datetime argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The data frame of closest market prices.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate">evaluate</a></code>,
<code>lubridate::<a href="lubridate.html#topic+round_date">round_date</a></code>
</p>

<hr>
<h2 id='DEanalysis'>Real sample data for Disposition Effect analysis</h2><span id='topic+DEanalysis'></span>

<h3>Description</h3>

<p>A sample dataset containing 10 investors, their market
transactions and the market prices of the traded assets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEanalysis
</code></pre>


<h3>Format</h3>

<p>A list containing two data frames: transactions and marketprices.
</p>

<dl>
<dt>investor</dt><dd><p>id of the investor</p>
</dd>
<dt>type</dt><dd><p>binary variable indicating the type of operation, B = buy and S = sell</p>
</dd>
<dt>asset</dt><dd><p>id of the traded asset</p>
</dd>
<dt>quantity</dt><dd><p>quantity of the traded asset</p>
</dd>
<dt>price</dt><dd><p>market price of the traded asset</p>
</dd>
<dt>datetime</dt><dd><p>timestamp of the operation</p>
</dd>
</dl>


<hr>
<h2 id='difference_in_time'>Difference in time</h2><span id='topic+difference_in_time'></span><span id='topic+difftime_financial'></span><span id='topic+difftime_compare'></span>

<h3>Description</h3>

<p>Financial implementation of
<code>base::<a href="base.html#topic+difftime">difftime</a></code>, that takes into account
trading day horizons (including pre and after market hours.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>difftime_financial(
  from,
  to,
  pre_market = 8,
  after_market = 22,
  units = "hours"
)

difftime_compare(from, to, time_threshold = "0 mins")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difference_in_time_+3A_from">from</code></td>
<td>
<p>POSIXct for the initial date.</p>
</td></tr>
<tr><td><code id="difference_in_time_+3A_to">to</code></td>
<td>
<p>POSIXct for the final date.</p>
</td></tr>
<tr><td><code id="difference_in_time_+3A_pre_market">pre_market</code></td>
<td>
<p>numeric or character representing the hour of the day at
which the pre-market begins.</p>
</td></tr>
<tr><td><code id="difference_in_time_+3A_after_market">after_market</code></td>
<td>
<p>numeric or character representing the hour of the day at
which the after-market ends.</p>
</td></tr>
<tr><td><code id="difference_in_time_+3A_units">units</code></td>
<td>
<p>Character string specifying a time unit.
(See <code>base::<a href="base.html#topic+difftime">difftime</a></code>).</p>
</td></tr>
<tr><td><code id="difference_in_time_+3A_time_threshold">time_threshold</code></td>
<td>
<p>Character in the format &quot;value units&quot; indicating the
time threshold at which the computed financial difftime has to be evaluated
(for instance &quot;05 mins&quot; or &quot;20 hours&quot;).
The allowed units are &quot;secs&quot;, &quot;mins&quot;, &quot;hours&quot;, &quot;days&quot; and &quot;weeks&quot;
(See <code>base::<a href="base.html#topic+difftime">difftime</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>difftime_financial</code></dt><dd><p>returns a numeric value in hours.
To convert in a different time unit use
<code>base::<a href="base.html#topic+as.numeric">as.numeric</a></code> and specify the
<code>units</code> argument (units = c(&quot;secs&quot;, &quot;mins&quot;, &quot;hours&quot;, &quot;days&quot;,
&quot;weeks&quot;)).</p>
</dd>
<dt><code>difftime_compare</code></dt><dd><p>returns a character string whose possible
values are &quot;greater&quot; or &quot;smaller&quot;, indicating whether the
<code>difftime_financial</code> evaluated between the two dates is greater or
smaller than the chosen threshold.</p>
</dd>
</dl>



<h3>Functions</h3>


<ul>
<li> <p><code>difftime_financial</code>: Extension of the
<code>base::<a href="base.html#topic+difftime">difftime</a></code> function to calculate the
actual financial difftime taking into account pre and after market
moments and financial markets closing days.
</p>
</li>
<li> <p><code>difftime_compare</code>: Comparison of the <code>difftime_financial</code>
with respect to a given time threshold.
</p>
</li></ul>


<h3>See Also</h3>

<p><code>base::<a href="base.html#topic+difftime">difftime</a></code>
</p>

<hr>
<h2 id='disposition_effect'>Disposition Effect</h2><span id='topic+disposition_effect'></span><span id='topic+disposition_difference'></span><span id='topic+disposition_compute'></span><span id='topic+disposition_compute_ts'></span><span id='topic+disposition_summary'></span><span id='topic+disposition_summary_ts'></span>

<h3>Description</h3>

<p>Compute the disposition effect and the disposition
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disposition_effect(realized_gains, paper_gains, realized_losses, paper_losses)

disposition_difference(gains, losses)

disposition_compute(
  gainslosses,
  dispdiff_value = FALSE,
  aggregate_fun = NULL,
  ...
)

disposition_compute_ts(gainslosses, aggregate_fun = NULL, ...)

disposition_summary(gainslosses, dispdiff_value = FALSE)

disposition_summary_ts(de_timeseries)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disposition_effect_+3A_realized_gains">realized_gains</code></td>
<td>
<p>Numeric vector (or scalar) containing realized gains
values.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_paper_gains">paper_gains</code></td>
<td>
<p>Numeric vector (or scalar) containing paper gains
values.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_realized_losses">realized_losses</code></td>
<td>
<p>Numeric vector (or scalar) containing realized losses
values.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_paper_losses">paper_losses</code></td>
<td>
<p>Numeric vector (or scalar) containing paper losses
values.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_gains">gains</code></td>
<td>
<p>Numeric vector (or scalar) containing gains.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_losses">losses</code></td>
<td>
<p>Numeric vector (or scalar) containing losses.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_gainslosses">gainslosses</code></td>
<td>
<p>Data frame, the portfolio of the investor containing the
realized and paper gains and losses results (as those obtained via
<code><a href="#topic+portfolio_compute">portfolio_compute</a></code>).</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_dispdiff_value">dispdiff_value</code></td>
<td>
<p>Logical, if TRUE the disposition difference on the
&quot;value&quot; method is computed. Default to disposition effect (FALSE).</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_aggregate_fun">aggregate_fun</code></td>
<td>
<p>Function to use to aggregate results.
Default to <code>NULL</code>, that is no aggregation is performed and the
results of each asset are shown.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to the aggregate function.</p>
</td></tr>
<tr><td><code id="disposition_effect_+3A_de_timeseries">de_timeseries</code></td>
<td>
<p>Data frame, the time series of disposition effects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The disposition effect is defined as
<code class="reqn">DE = (Realized Gain / (Realized Gain - Paper Gain)) -
       (Realized Loss / (Realized Loss + Paper Loss))</code>
</p>
<p>The disposition difference is defined as
<code class="reqn">DD = Realized Gain - |Realized Loss|</code>
or
<code class="reqn">DD = Paper Gain - |Paper Loss|</code>
</p>


<h3>Value</h3>

<p>Numeric vector (or scalar) with the value(s) of disposition
effect(s) or disposition difference(s).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>disposition_effect</code>: Compute the disposition effect
</p>
</li>
<li> <p><code>disposition_difference</code>: Compute the disposition difference
</p>
</li>
<li> <p><code>disposition_compute</code>: Compute the disposition effect directly on
the investor's portfolio containing realized and paper gains and losses
results.
</p>
</li>
<li> <p><code>disposition_compute_ts</code>: Compute the time series disposition effect
on the gains and losses results.
</p>
</li>
<li> <p><code>disposition_summary</code>: Wrapper that returns the most important
summary statistics related to the disposition effect.
</p>
</li>
<li> <p><code>disposition_summary_ts</code>: Wrapper that returns the most important
summary statistics related to the time series disposition effect.
</p>
</li></ul>

<hr>
<h2 id='dispositionEffect-package'>dispositionEffect: behavioral Analysis on Financial Data</h2><span id='topic+dispositionEffect-package'></span>

<h3>Description</h3>

<p>The dispositionEffect package allows to perform different
types of behavioral analysis using financial market and experimental
data.
The analysis of disposition effect, portfolio-driven disposition
effect, and time series disposition effect can be performed with
four different implemented methods.
</p>


<h3>Main functions</h3>


<ul>
<li> <p><code>portfolio_compute</code> is a wrapper function that compute realized and
paper gains and losses from the investor's transactions and the market
prices of the traded assets and updates the investor's portfolio
</p>
</li>
<li> <p><code>gains_losses</code> is the core function of the package. It performs all
the necessary calculations and can be used for real-time processing
(it is intended for advanced users only)
</p>
</li>
<li> <p><code>disposition_effect</code> Compute the disposition effect based on
realized and paper gains and losses
</p>
</li>
<li> <p><code>disposition_difference</code> Compute the disposition difference
based on realized gains and losses
</p>
</li>
<li> <p><code>disposition_compute</code>and <code>disposition_summary</code>interfaces that allow
to easily compute disposition effect and summary statistics.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>L. Mazzucchelli &amp; M. Zanotti
</p>


<h3>References</h3>


<ul>
<li><p> An, Li and Engelberg, Joseph and Henriksson, Matthew and Wang, Baolian and Williams,
Jared, 2019, &quot;The Portfolio-Driven Disposition Effect&quot;.
</p>
</li>
<li><p> Filippin, Mazzucchelli and Zanotti, 2021, &quot;An analysis of the short selling impact on the disposition effect extended in the portfolio framework&quot; (working paper).
</p>
</li>
<li><p> Mazzucchelli, 2021, &quot;An Analysis of Short Selling and Volatility Impact on the Disposition Effect&quot; (working paper).
</p>
</li>
<li><p> Odean, Terrance, 1998, &quot;Are investors reluctant to realize their losses?&quot; Journal of Finance 53:5, 1775-98.
</p>
</li>
<li><p> Sakaguchi, Hiroaki and Stewart, Neil and Walasek, Lukasz, 2019, &quot;The Disposition Effect Varies with Portfolio
Composition Because People Take Gain-Loss-Domain-Level Sell Decisions&quot;.
</p>
</li>
<li><p> Shefrin, Hersh, and Meir Statman, 1985, &quot;The disposition to sell winners too early and ride losers too long&quot;,
Journal of Finance 40:3, 777-90.
</p>
</li>
<li><p> Weber, Martin, and Colin F. Camerer, 1998, &quot;The disposition effect in securities trading: An experimental analysis&quot;,
Journal of Economic Behavior and Organization 33:2, 167-84.
</p>
</li></ul>


<hr>
<h2 id='evaluate'>Portfolio evaluation</h2><span id='topic+evaluate'></span><span id='topic+evaluate_portfolio'></span>

<h3>Description</h3>

<p>Calculate the portfolio value as the sum of each
asset portfolio quantity times the excess return of each asset
with respect to the market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_portfolio(portfolio, market_prices)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_+3A_portfolio">portfolio</code></td>
<td>
<p>Data frame of the investor's portfolio at time t.</p>
</td></tr>
<tr><td><code id="evaluate_+3A_market_prices">market_prices</code></td>
<td>
<p>Data frame containing the market prices.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The portfolio value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+portfolio_compute">portfolio_compute</a></code>, <code><a href="#topic+gains_losses">gains_losses</a></code>,
<code><a href="#topic+closest_market_price">closest_market_price</a></code>
</p>

<hr>
<h2 id='gains_losses'>Gains &amp; Losses</h2><span id='topic+gains_losses'></span>

<h3>Description</h3>

<p>Calculation of the realized gains and losses and the paper
gains and losses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gains_losses(
  portfolio,
  market_prices,
  transaction_type,
  transaction_asset,
  transaction_quantity,
  transaction_price,
  transaction_datetime,
  previous_datetime,
  time_threshold = "0 mins",
  method = "all",
  allow_short = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gains_losses_+3A_portfolio">portfolio</code></td>
<td>
<p>Data frame of the investor's portfolio at time t.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_market_prices">market_prices</code></td>
<td>
<p>Data frame containing the market prices.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_transaction_type">transaction_type</code></td>
<td>
<p>Character string. Either &quot;B&quot; = buy or &quot;S&quot; = sell.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_transaction_asset">transaction_asset</code></td>
<td>
<p>Character string. The name of the traded asset.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_transaction_quantity">transaction_quantity</code></td>
<td>
<p>Numeric value. The quantity of the traded asset.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_transaction_price">transaction_price</code></td>
<td>
<p>Numeric value. The market price of the traded asset.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_transaction_datetime">transaction_datetime</code></td>
<td>
<p>POSIXct value. The date-time at which the transaction
is going to occur.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_previous_datetime">previous_datetime</code></td>
<td>
<p>POSIXct value. The date-time of the last transaction
performed by the investor.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_time_threshold">time_threshold</code></td>
<td>
<p>Character in the format &quot;value units&quot; indicating the
time threshold at which the computed financial difftime has to be evaluated
(for instance &quot;05 mins&quot; or &quot;20 hours&quot;).
The allowed units are &quot;secs&quot;, &quot;mins&quot;, &quot;hours&quot;, &quot;days&quot; and &quot;weeks&quot;
(See <code>base::<a href="base.html#topic+difftime">difftime</a></code>).</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_method">method</code></td>
<td>
<p>Character string. The method used to compute papers.
Allowed values are &quot;count&quot;, &quot;total&quot;, &quot;value&quot;, &quot;duration&quot; and &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_allow_short">allow_short</code></td>
<td>
<p>Logical. If TRUE short positions are allowed, otherwise only
long positions are allowed.</p>
</td></tr>
<tr><td><code id="gains_losses_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE than messages are printed to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is essentially a wrapper around <code><a href="#topic+paper_compute">paper_compute</a></code>
and <code><a href="#topic+realized_compute">realized_compute</a></code> functions.
It is the function that can be used for streaming computations of
gains and losses.
</p>


<h3>Value</h3>

<p>A data frame containing the values of realized and paper gains
and losses computed by means of the chosen method on each portfolio assets.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+realized_compute">realized_compute</a></code>, <code><a href="#topic+paper_compute">paper_compute</a></code>,
<code><a href="#topic+portfolio_compute">portfolio_compute</a></code>
</p>

<hr>
<h2 id='initializers'>Initializers functions</h2><span id='topic+initializers'></span><span id='topic+initializer_portfolio'></span><span id='topic+initializer_realized_and_paper'></span><span id='topic+initializer_timeseries_DE'></span>

<h3>Description</h3>

<p>Initializers functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializer_portfolio(investor, assets)

initializer_realized_and_paper(investor, assets, method = "all")

initializer_timeseries_DE(investor, assets, datetimes, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializers_+3A_investor">investor</code></td>
<td>
<p>Character string. The name of the investor.</p>
</td></tr>
<tr><td><code id="initializers_+3A_assets">assets</code></td>
<td>
<p>Character vector. The names of the assets traded by
the investor.</p>
</td></tr>
<tr><td><code id="initializers_+3A_method">method</code></td>
<td>
<p>Character string. The method used to compute papers.
Allowed values are &quot;count&quot;, &quot;total&quot;, &quot;value&quot;, &quot;duration&quot; and &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="initializers_+3A_datetimes">datetimes</code></td>
<td>
<p>POSIXct vector. The datetimes of the investors'
transactions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Empty <code>data.frame</code> of either investor's
portfolio, investor's realized and paper gains and losses results,
or time series Disposition Effect based on the chosen method.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>initializer_portfolio</code>: Empty <code>data.frame</code>
of investor's portfolio.
</p>
</li>
<li> <p><code>initializer_realized_and_paper</code>: Empty <code>data.frame</code>
of investor's realized and paper gains and losses results based on
the chosen method.
</p>
</li>
<li> <p><code>initializer_timeseries_DE</code>: Empty <code>data.frame</code>
of investor's time series disposition effect based on
the chosen method.
</p>
</li></ul>

<hr>
<h2 id='investor'>Sample investor financial transactions</h2><span id='topic+investor'></span>

<h3>Description</h3>

<p>A sample dataset containing 19 transactions over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>investor
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 6 variables:
</p>

<dl>
<dt>investor</dt><dd><p>id of the investor</p>
</dd>
<dt>type</dt><dd><p>binary variable indicating the type of operation, B = buy and S = sell</p>
</dd>
<dt>asset</dt><dd><p>id of the traded asset</p>
</dd>
<dt>quantity</dt><dd><p>quantity of the traded asset</p>
</dd>
<dt>price</dt><dd><p>market price of the traded asset</p>
</dd>
<dt>datetime</dt><dd><p>timestamp of the operation</p>
</dd>
</dl>


<hr>
<h2 id='manipulate_initial_data'>Pre-process transactions and market prices data frames</h2><span id='topic+manipulate_initial_data'></span><span id='topic+aggregate_transactions'></span><span id='topic+reduce_transactions'></span><span id='topic+clean_transactions'></span><span id='topic+aggregate_market_prices'></span><span id='topic+subset_market_prices'></span><span id='topic+generate_data'></span>

<h3>Description</h3>

<p>These functions allows to pre-process transactions
and market prices data frames performing aggregation and
subsetting operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregate_transactions(portfolio_transactions, unit = "1 mins")

reduce_transactions(portfolio_transactions, unit = "1 mins")

clean_transactions(portfolio_transactions, unit = "1 mins", reduce = FALSE)

aggregate_market_prices(market_prices, unit = NULL, aggregate_price_fun = mean)

subset_market_prices(
  market_prices,
  portfolio_assets,
  portfolio_datetimes,
  unit = NULL
)

generate_data(
  portfolio_transactions,
  market_prices,
  investor_name = NULL,
  unit = NULL,
  subset = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manipulate_initial_data_+3A_portfolio_transactions">portfolio_transactions</code></td>
<td>
<p>Data frame. The investor's transactions data frame.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_unit">unit</code></td>
<td>
<p>Character string specifying a time unit or a multiple of a
unit to be rounded to. Valid base units are second, minute, hour, day,
week, etc. See <code>lubridate::<a href="lubridate.html#topic+round_date">round_date</a></code>.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_reduce">reduce</code></td>
<td>
<p>Logical. If TRUE use <code>reduce_transactions</code>, otherwise use
<code>aggregate_transactions</code> to aggregate portfolio transactions.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_market_prices">market_prices</code></td>
<td>
<p>Data frame containing the market prices.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_aggregate_price_fun">aggregate_price_fun</code></td>
<td>
<p>Function to use to aggregate prices within
the round unit. Default to <code>mean</code>.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_portfolio_assets">portfolio_assets</code></td>
<td>
<p>Character vector of the transaction assets.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_portfolio_datetimes">portfolio_datetimes</code></td>
<td>
<p>POSIXct vector of the transaction datetimes.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_investor_name">investor_name</code></td>
<td>
<p>Character. The name to be assigned to the investor.</p>
</td></tr>
<tr><td><code id="manipulate_initial_data_+3A_subset">subset</code></td>
<td>
<p>Logical. If TRUE, <code>subset_market_prices</code> is used to generate
investor's data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified version of the input data frame.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>aggregate_transactions</code>: Aggregate the data frame of investors'
transactions that happened at the same datetime.
</p>
</li>
<li> <p><code>reduce_transactions</code>: Reduce the data frame of investors'
transactions by aggregating those transactions that happened within
a time interval.
</p>
</li>
<li> <p><code>clean_transactions</code>: Clean the data frame of investors'
transactions.
</p>
</li>
<li> <p><code>aggregate_market_prices</code>: Aggregate the data frame of market prices
with a specific aggregate function within a time interval.
</p>
</li>
<li> <p><code>subset_market_prices</code>: Subset the data frame of market prices
based on investor's traded assets and datetimes of transactions.
</p>
</li>
<li> <p><code>generate_data</code>: Generate investors' data from transactions
and market prices.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+closest_market_price">closest_market_price</a></code>,
<code>lubridate::<a href="lubridate.html#topic+round_date">round_date</a></code>
</p>

<hr>
<h2 id='marketprices'>Market prices of assets traded by the sample investor</h2><span id='topic+marketprices'></span>

<h3>Description</h3>

<p>A sample dataset containing 6895 market prices of 5 different assets over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marketprices
</code></pre>


<h3>Format</h3>

<p>A data frame with 6895 rows and 4 variables:
</p>

<dl>
<dt>asset</dt><dd><p>id of the asset</p>
</dd>
<dt>datetime</dt><dd><p>timestamp of market price</p>
</dd>
<dt>price</dt><dd><p>market price of the asset</p>
</dd>
</dl>


<hr>
<h2 id='negative_match'>Negative match operator</h2><span id='topic+negative_match'></span><span id='topic++25+21in+25'></span>

<h3>Description</h3>

<p>See <code>base::<a href="base.html#topic+match">%in%</a></code> for details on the
match operator.
The negative match operator is simply the negation of the match operator
obtained via the <code>base::<a href="base.html#topic+Negate">Negate</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %!in% table
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="negative_match_+3A_x">x</code></td>
<td>
<p>vector or NULL: the values to be matched. Long vectors are supported.</p>
</td></tr>
<tr><td><code id="negative_match_+3A_table">table</code></td>
<td>
<p>vector or NULL: the values to be matched against. Long vectors are
not supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical vector.
</p>

<hr>
<h2 id='paper_compute'>Papers' estimation</h2><span id='topic+paper_compute'></span><span id='topic+paper_count'></span><span id='topic+paper_total'></span><span id='topic+paper_value'></span><span id='topic+paper_duration'></span>

<h3>Description</h3>

<p>Compute paper gains and paper losses as either simple counts,
total quantities, expected returns and financial duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paper_count(
  portfolio_quantity,
  portfolio_price,
  market_price,
  allow_short = TRUE
)

paper_total(
  portfolio_quantity,
  portfolio_price,
  market_price,
  allow_short = TRUE
)

paper_value(
  portfolio_quantity,
  portfolio_price,
  market_price,
  allow_short = TRUE
)

paper_duration(
  portfolio_quantity,
  portfolio_price,
  market_price,
  datetime_difference = NULL,
  previous_datetime = NULL,
  transaction_datetime = NULL,
  allow_short = TRUE
)

paper_compute(
  portfolio_quantity,
  portfolio_price,
  market_price,
  previous_datetime,
  transaction_datetime,
  assets,
  allow_short = TRUE,
  method = "all"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paper_compute_+3A_portfolio_quantity">portfolio_quantity</code></td>
<td>
<p>Numeric vector. The portfolio quantities of assets into the
investor's portfolio.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_portfolio_price">portfolio_price</code></td>
<td>
<p>Numeric vector. The portfolio prices of assets into the
investor's portfolio.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_market_price">market_price</code></td>
<td>
<p>Numeric vector. The market prices of assets into the
investor's portfolio.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_allow_short">allow_short</code></td>
<td>
<p>Logical. If TRUE short positions are allowed, otherwise only
long positions are allowed.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_datetime_difference">datetime_difference</code></td>
<td>
<p>Numeric value of time difference between the previous_datetime
and the transaction_datetime, computed through <code><a href="#topic+difftime_financial">difftime_financial</a></code>.
If NULL, then previous_datetime and transaction_datetime must be specified.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_previous_datetime">previous_datetime</code></td>
<td>
<p>POSIXct value. The date-time of the last transaction
performed by the investor.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_transaction_datetime">transaction_datetime</code></td>
<td>
<p>POSIXct value. The date-time at which the transaction
is going to occur.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_assets">assets</code></td>
<td>
<p>Character vector. The name of assets into the investor's
portfolio but the traded asset.</p>
</td></tr>
<tr><td><code id="paper_compute_+3A_method">method</code></td>
<td>
<p>Character string. The method used to compute papers.
Allowed values are &quot;count&quot;, &quot;total&quot;, &quot;value&quot;, &quot;duration&quot; and &quot;all&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The described functions have different return behaviors
</p>

<ul>
<li> <p><code>paper_compute</code> returns a data frame containing the values of
paper gains and paper losses computed by means of the chosen method
on each portfolio assets.
</p>
</li>
<li> <p><code>paper_count</code> returns a named vector containing the values of
paper gains and paper losses computed using the count method.
</p>
</li>
<li> <p><code>paper_total</code> returns a named vector containing the values of
paper gains and paper losses computed using the total method.
</p>
</li>
<li> <p><code>paper_value</code> returns a named vector containing the values of
paper gains and paper losses computed using the value method.
</p>
</li>
<li> <p><code>paper_duration</code> returns a named vector containing the values
of paper gains and paper losses computed using the duration method.
</p>
</li></ul>

<p>In particular:
</p>

<ul>
<li> <p><code>RG_"method"</code> contains Realized Gains results
</p>
</li>
<li> <p><code>RL_"method"</code> contains Realized Losses results
</p>
</li>
<li> <p><code>PG_"method"</code> contains Paper Gains results
</p>
</li>
<li> <p><code>PL_"method"</code> contains Paper Losses results
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>paper_count</code>: Computation of paper gains and paper losses as
simple counts (default method).
</p>
</li>
<li> <p><code>paper_total</code>: Computation of paper gains and paper losses as
total quantity of assets.
</p>
</li>
<li> <p><code>paper_value</code>: Computation of paper gains and paper losses as
expected return of assets.
</p>
</li>
<li> <p><code>paper_duration</code>: Computation of paper gains and paper losses as
financial duration.
</p>
</li>
<li> <p><code>paper_compute</code>: Wrapper that calls other paper_. functions to
compute paper gains and paper losses based on the chosen method.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+realized_compute">realized_compute</a></code>, <code><a href="#topic+gains_losses">gains_losses</a></code>
</p>

<hr>
<h2 id='portfolio_compute'>Portfolio Compute</h2><span id='topic+portfolio_compute'></span>

<h3>Description</h3>

<p>Computation of all the transaction updates and the
realized and paper gains and losses for each assets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>portfolio_compute(
  portfolio_transactions,
  market_prices,
  method = "count",
  allow_short = TRUE,
  time_threshold = "0 mins",
  exact_market_prices = TRUE,
  portfolio_driven_DE = FALSE,
  time_series_DE = FALSE,
  assets_time_series_DE = NULL,
  verbose = c(0, 0),
  progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="portfolio_compute_+3A_portfolio_transactions">portfolio_transactions</code></td>
<td>
<p>Data frame. The investor's transactions data frame.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_market_prices">market_prices</code></td>
<td>
<p>Data frame containing the market prices.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_method">method</code></td>
<td>
<p>Character string containing the method to use to compute
realized and paper gains and losses. If &quot;none&quot; nothing is computed but the
investor's portfolio updates. Otherwise it has to be one of &quot;count&quot; (default),
&quot;total&quot;, &quot;value&quot;, &quot;duration&quot;, or &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_allow_short">allow_short</code></td>
<td>
<p>Logical. If TRUE short positions are allowed, otherwise only
long positions are allowed.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_time_threshold">time_threshold</code></td>
<td>
<p>Character in the format &quot;value units&quot; indicating the
time threshold at which the computed financial difftime has to be evaluated
(for instance &quot;05 mins&quot; or &quot;20 hours&quot;).
The allowed units are &quot;secs&quot;, &quot;mins&quot;, &quot;hours&quot;, &quot;days&quot; and &quot;weeks&quot;
(See <code>base::<a href="base.html#topic+difftime">difftime</a></code>).</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_exact_market_prices">exact_market_prices</code></td>
<td>
<p>Logical. If TRUE then <code><a href="#topic+closest_market_price">closest_market_price</a></code>
uses exact datetime match to look for the closest price of each asset.
It usually speeds up computation by a small degree, but it requires the
<code>market_prices</code> to have the prices for each transaction asset along each
transaction datetimes.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_portfolio_driven_de">portfolio_driven_DE</code></td>
<td>
<p>Logical. If TRUE the realized and paper gains and
losses for the positive (that is when the investor's portfolio value, as
computed through <code><a href="#topic+evaluate_portfolio">evaluate_portfolio</a></code>, is greater than zero)
and the negative (that is when the investor's portfolio value, as computed
through <code><a href="#topic+evaluate_portfolio">evaluate_portfolio</a></code>, is smaller than zero) portfolios
are returned.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_time_series_de">time_series_DE</code></td>
<td>
<p>Logical. If TRUE the time series of disposition effect
is computed on 'count' and 'value' methods only.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_assets_time_series_de">assets_time_series_DE</code></td>
<td>
<p>Character vector of assets' names as contained
into <code>portfolio_transactions</code> on which to compute the time series disposition
effect.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_verbose">verbose</code></td>
<td>
<p>Numeric or logical vector of length 2 that allows to control
for the function's verbosity.</p>
</td></tr>
<tr><td><code id="portfolio_compute_+3A_progress">progress</code></td>
<td>
<p>Logical. If TRUE a progress bar is displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the investor's
portfolio and the values of realized and paper gains and losses
computed by means of the chosen method on each portfolio assets.
</p>
<p>If time_series_DE is set to TRUE, then also time series disposition effect
results are returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+realized_compute">realized_compute</a></code>, <code><a href="#topic+paper_compute">paper_compute</a></code>,
<code><a href="#topic+gains_losses">gains_losses</a></code>
</p>

<hr>
<h2 id='portfolio_results'>Realized and paper results</h2><span id='topic+portfolio_results'></span>

<h3>Description</h3>

<p>Results obtained by means of <code>portfolio_compute</code> on the
data sets <code>investor</code> and <code>marketprices</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>portfolio_results
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows and 21 variables:
</p>

<dl>
<dt>investor</dt><dd><p>id of the investor</p>
</dd>
<dt>asset</dt><dd><p>id of the traded asset</p>
</dd>
<dt>quantity</dt><dd><p>quantity of the traded asset at the end of the portfolio
updating process</p>
</dd>
<dt>price</dt><dd><p>last market price of the traded asset</p>
</dd>
<dt>datetime</dt><dd><p>timestamp of the last operation</p>
</dd>
<dt>RG_count</dt><dd><p>realized gains via count method</p>
</dd>
<dt>RL_count</dt><dd><p>realized losses via count method</p>
</dd>
<dt>PG_count</dt><dd><p>paper gains via count method</p>
</dd>
<dt>PL_count</dt><dd><p>paper losses via count method</p>
</dd>
<dt>RG_total</dt><dd><p>realized gains via total method</p>
</dd>
<dt>RL_total</dt><dd><p>realized losses via total method</p>
</dd>
<dt>PG_total</dt><dd><p>paper gains via total method</p>
</dd>
<dt>PL_total</dt><dd><p>paper losses via total method</p>
</dd>
<dt>RG_value</dt><dd><p>realized gains via value method</p>
</dd>
<dt>RL_value</dt><dd><p>realized losses via value method</p>
</dd>
<dt>PG_value</dt><dd><p>paper gains via value method</p>
</dd>
<dt>PL_value</dt><dd><p>paper losses via value method</p>
</dd>
<dt>RG_duration</dt><dd><p>realized gains via duration method</p>
</dd>
<dt>RL_duration</dt><dd><p>realized losses via duration method</p>
</dd>
<dt>PG_duration</dt><dd><p>paper gains via duration method</p>
</dd>
<dt>PL_duration</dt><dd><p>paper losses via duration method</p>
</dd>
</dl>


<hr>
<h2 id='portfolio_results_ts'>Realized and paper results</h2><span id='topic+portfolio_results_ts'></span>

<h3>Description</h3>

<p>Results obtained by means of <code>portfolio_compute</code> on the
data sets <code>investor</code> and <code>marketprices</code> with <code>time_series_DE = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>portfolio_results_ts
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 6 variables:
</p>

<dl>
<dt>investor</dt><dd><p>id of the investor</p>
</dd>
<dt>datetime</dt><dd><p>timestamp of the last operation</p>
</dd>
<dt>DEts_count</dt><dd><p>Partial disposition effect computed at time t</p>
</dd>
<dt>DETs_count</dt><dd><p>Complete disposition effect computed after updating at time t</p>
</dd>
<dt>DEts_value</dt><dd><p>Partial disposition difference computed at time t</p>
</dd>
<dt>DETs_value</dt><dd><p>Complete disposition difference computed after updating at time t</p>
</dd>
</dl>


<hr>
<h2 id='realized_compute'>Realized estimation</h2><span id='topic+realized_compute'></span><span id='topic+realized_count'></span><span id='topic+realized_total'></span><span id='topic+realized_value'></span><span id='topic+realized_duration'></span><span id='topic+realized_empty'></span>

<h3>Description</h3>

<p>Compute realized gains and realized losses as either simple
counts, total quantities, expected returns and financial duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>realized_count(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type,
  allow_short = TRUE,
  realized_only = FALSE
)

realized_total(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type,
  allow_short = TRUE,
  realized_only = FALSE
)

realized_value(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type,
  allow_short = TRUE,
  realized_only = FALSE
)

realized_duration(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type,
  previous_transaction_datetime,
  previous_datetime,
  transaction_datetime,
  allow_short = TRUE,
  realized_only = FALSE
)

realized_compute(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type,
  previous_transaction_datetime,
  previous_datetime,
  transaction_datetime,
  transaction_asset,
  allow_short = TRUE,
  realized_only = FALSE,
  method = "all"
)

realized_empty(transaction_asset, method = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="realized_compute_+3A_portfolio_quantity">portfolio_quantity</code></td>
<td>
<p>Numeric vector. The portfolio quantities of assets into the
investor's portfolio.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_portfolio_price">portfolio_price</code></td>
<td>
<p>Numeric vector. The portfolio prices of assets into the
investor's portfolio.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_transaction_quantity">transaction_quantity</code></td>
<td>
<p>Numeric value. The quantity of the traded asset.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_transaction_price">transaction_price</code></td>
<td>
<p>Numeric value. The market price of the traded asset.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_transaction_type">transaction_type</code></td>
<td>
<p>Character string. Either &quot;B&quot; = buy or &quot;S&quot; = sell.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_allow_short">allow_short</code></td>
<td>
<p>Logical. If TRUE short positions are allowed, otherwise only
long positions are allowed.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_realized_only">realized_only</code></td>
<td>
<p>Logical. If TRUE only realized gains and realized
losses are computed. Otherwise also paper gains and paper losses on excess
quantity of the traded asset are computed.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_previous_transaction_datetime">previous_transaction_datetime</code></td>
<td>
<p>POSIXct value. The portfolio date-time related to the
last transaction of the traded asset.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_previous_datetime">previous_datetime</code></td>
<td>
<p>POSIXct value. The date-time of the last transaction
performed by the investor.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_transaction_datetime">transaction_datetime</code></td>
<td>
<p>POSIXct value. The date-time at which the transaction
is going to occur.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_transaction_asset">transaction_asset</code></td>
<td>
<p>Character string. The name of the traded asset.</p>
</td></tr>
<tr><td><code id="realized_compute_+3A_method">method</code></td>
<td>
<p>Character string. The method used to compute papers.
Allowed values are &quot;count&quot;, &quot;total&quot;, &quot;value&quot;, &quot;duration&quot; and &quot;all&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The described functions have different return behaviors
</p>

<ul>
<li> <p><code>realized_compute</code> returns a data frame
containing the values of realized and paper gains and losses computed by
means of the chosen method on each portfolio assets.
</p>
</li>
<li> <p><code>realized_count</code> returns a named vector containing the values
of realized and paper gains and losses computed using the count method.
</p>
</li>
<li> <p><code>realized_total</code> returns a named vector containing the values
of realized and paper gains and losses computed using the total method.
</p>
</li>
<li> <p><code>realized_value</code> returns a named vector containing the values
of realized and paper gains and losses computed using the value method.
</p>
</li>
<li> <p><code>realized_duration</code> returns a named vector containing the values
of realized and paper gains and losses computed using the duration method.
</p>
</li>
<li> <p><code>realized_empty</code> returns a named vector containing empty values
of realized and paper gains and losses computed using the chosen method.
</p>
</li></ul>

<p>In particular:
</p>

<ul>
<li> <p><code>RG_"method"</code> contains Realized Gains results
</p>
</li>
<li> <p><code>RL_"method"</code> contains Realized Losses results
</p>
</li>
<li> <p><code>PG_"method"</code> contains Paper Gains results
</p>
</li>
<li> <p><code>PL_"method"</code> contains Paper Losses results
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>realized_count</code>: Computation, as simple counts, of realized
gains and realized losses of the traded asset.
</p>
</li>
<li> <p><code>realized_total</code>: Computation, as total quantity, of realized
gains and realized losses of the traded asset.
</p>
</li>
<li> <p><code>realized_value</code>: Computation, as expected return, of
realized gains and realized losses of the traded asset.
</p>
</li>
<li> <p><code>realized_duration</code>: Computation, as financial duration, of
realized gains and realized losses of the traded asset.
</p>
</li>
<li> <p><code>realized_compute</code>: Wrapper that calls other realized_. functions to
compute realized gains and realized losses of the traded asset based on the
chosen method.
</p>
</li>
<li> <p><code>realized_empty</code>: Simple function to obtain empty results for
realized and paper computations based on the chosen method.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+paper_compute">paper_compute</a></code>, <code><a href="#topic+gains_losses">gains_losses</a></code>
</p>

<hr>
<h2 id='updates'>Update results over time</h2><span id='topic+updates'></span><span id='topic+update_price'></span><span id='topic+update_datetime'></span><span id='topic+update_quantity'></span><span id='topic+update_portfolio'></span><span id='topic+update_realized_and_paper'></span><span id='topic+update_timeseries_DE'></span><span id='topic+update_expectedvalue'></span>

<h3>Description</h3>

<p>Update investor's portfolio, realized and paper results
and time series disposition effect computations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_price(
  portfolio_quantity,
  portfolio_price,
  transaction_quantity,
  transaction_price,
  transaction_type
)

update_datetime(
  portfolio_quantity,
  portfolio_datetime,
  transaction_quantity,
  transaction_datetime,
  transaction_type
)

update_quantity(portfolio_quantity, transaction_quantity)

update_portfolio(
  portfolio,
  transaction_asset,
  transaction_quantity,
  transaction_price,
  transaction_datetime,
  transaction_type
)

update_realized_and_paper(realized_and_paper, new_realized_and_paper, method)

update_timeseries_DE(
  timeseries_DE,
  realized_and_paper,
  gainslosses,
  transaction_id,
  assets_time_series_DE = NULL,
  method
)

update_expectedvalue(realized_and_paper, num_transaction_assets)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updates_+3A_portfolio_quantity">portfolio_quantity</code></td>
<td>
<p>Numeric value. The portfolio quantity of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_portfolio_price">portfolio_price</code></td>
<td>
<p>Numeric value. The portfolio price of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_quantity">transaction_quantity</code></td>
<td>
<p>Numeric value. The quantity of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_price">transaction_price</code></td>
<td>
<p>Numeric value. The market price of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_type">transaction_type</code></td>
<td>
<p>Character string. Either &quot;B&quot; = buy or &quot;S&quot; = sell.</p>
</td></tr>
<tr><td><code id="updates_+3A_portfolio_datetime">portfolio_datetime</code></td>
<td>
<p>POSIXct value. The date-time of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_datetime">transaction_datetime</code></td>
<td>
<p>POSIXct value. The date-time at which the transaction
is going to occur.</p>
</td></tr>
<tr><td><code id="updates_+3A_portfolio">portfolio</code></td>
<td>
<p>Data frame of the investor's portfolio at time t.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_asset">transaction_asset</code></td>
<td>
<p>Character string. The name of the traded asset.</p>
</td></tr>
<tr><td><code id="updates_+3A_realized_and_paper">realized_and_paper</code></td>
<td>
<p>Data frame containing the realized and paper gains and
losses results to be updated.</p>
</td></tr>
<tr><td><code id="updates_+3A_new_realized_and_paper">new_realized_and_paper</code></td>
<td>
<p>Data frame containing the realized and paper gains and
losses results related to the new transaction.</p>
</td></tr>
<tr><td><code id="updates_+3A_method">method</code></td>
<td>
<p>Character string. The method used to compute papers.
Allowed values are &quot;count&quot;, &quot;total&quot;, &quot;value&quot;, &quot;duration&quot; and &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="updates_+3A_timeseries_de">timeseries_DE</code></td>
<td>
<p>Data frame of time series disposition effect results.</p>
</td></tr>
<tr><td><code id="updates_+3A_transaction_id">transaction_id</code></td>
<td>
<p>Numeric, the id of transaction.</p>
</td></tr>
<tr><td><code id="updates_+3A_assets_time_series_de">assets_time_series_DE</code></td>
<td>
<p>Character vector of assets' names as contained
into <code>portfolio_transactions</code> on which to compute the time series disposition
effect.</p>
</td></tr>
<tr><td><code id="updates_+3A_num_transaction_assets">num_transaction_assets</code></td>
<td>
<p>Data frame containing the number of transactions for
each asset traded by the investor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated input data.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>update_price</code>: Update the portfolio price of the traded asset.
</p>
</li>
<li> <p><code>update_datetime</code>: Update the portfolio datetime of the traded asset.
</p>
</li>
<li> <p><code>update_quantity</code>: Update the portfolio quantity of the traded asset.
</p>
</li>
<li> <p><code>update_portfolio</code>: Update the portfolio with the new quantity, price
and datetime of the traded asset.
</p>
</li>
<li> <p><code>update_realized_and_paper</code>: Update the realized and paper gains and losses
results with the results obtained on the last occurred transaction.
</p>
</li>
<li> <p><code>update_timeseries_DE</code>: Update the time series disposition effect
averaging values over time.
</p>
</li>
<li> <p><code>update_expectedvalue</code>: Update the realized and paper gains and losses
results averaging the total value by the number of transactions
for each asset.
</p>
</li></ul>

<hr>
<h2 id='utils'>Utilities</h2><span id='topic+utils'></span><span id='topic+ewise_mean'></span>

<h3>Description</h3>

<p>Utilities functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ewise_mean(x, y, na.rm = FALSE, zero.substitute = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utils_+3A_x">x</code>, <code id="utils_+3A_y">y</code></td>
<td>
<p>Numeric vectors of the same length.</p>
</td></tr>
<tr><td><code id="utils_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical evaluating to <code>TRUE</code> or <code>FALSE</code>
indicating whether <code>NA</code> values should be stripped before the
computation proceeds.</p>
</td></tr>
<tr><td><code id="utils_+3A_zero.substitute">zero.substitute</code></td>
<td>
<p>Logical. If TRUE zero values are substituted with
corresponding non-missing values whether possible.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>ewise_mean</code>: Element-wise mean calculation.
</p>
</li></ul>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
