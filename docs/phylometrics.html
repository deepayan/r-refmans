<!DOCTYPE html><html lang="en"><head><title>Help for package phylometrics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phylometrics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fpd'><p>calculate the Fritz &amp; Purvis D (FPD) metric</p></a></li>
<li><a href='#noto'><p>calculate the number of tips per origin (NoTO) metric</p></a></li>
<li><a href='#sscd'><p>calculate the sum of sister clade differences (SSCD) metric</p></a></li>
<li><a href='#tars'><p>calculate the tip age rank sum (TARS) metric</p></a></li>
<li><a href='#treesim'><p>Simulate trees with fixed number of sampled taxa and trait prevalance</p></a></li>
<li><a href='#treestat'><p>Significance test of user defined phylogenetic metric</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimating Statistical Errors of Phylogenetic Metrics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Xia Hua &lt;xia.hua@anu.edu.au&gt;, Lindell Bromham
    &lt;lindell.bromham@anu.edu.au&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xia Hua &lt;xia.hua@anu.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to estimate statistical errors of phylogenetic
    metrics particularly to detect binary trait influence on diversification, as
    well as a function to simulate trees with fixed number of sampled taxa and trait
    prevalence.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-11-14 03:09:19 UTC; xhua</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-11-17 14:40:44</td>
</tr>
</table>
<hr>
<h2 id='fpd'>calculate the Fritz &amp; Purvis D (FPD) metric</h2><span id='topic+fpd'></span>

<h3>Description</h3>

<p>This function calculates the FPD metric. To conduct significance test on FPD, use 'fpd' as input of 'func' in 'treestat'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fpd(state, phy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fpd_+3A_state">state</code></td>
<td>
<p>a vector of '0' and '1' for trait state of each tip, in the same order as the tip labels.</p>
</td></tr>
<tr><td><code id="fpd_+3A_phy">phy</code></td>
<td>
<p>an object of class 'phylo'.</p>
</td></tr>
</table>

<hr>
<h2 id='noto'>calculate the number of tips per origin (NoTO) metric</h2><span id='topic+noto'></span>

<h3>Description</h3>

<p>This function calculates the NoTO metric. To conduct significance test on NoTO, use 'noto' as input of 'func' in 'treestat'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noto(state, phy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="noto_+3A_state">state</code></td>
<td>
<p>a vector of '0' and '1' for trait state of each tip, in the same order as the tip labels.</p>
</td></tr>
<tr><td><code id="noto_+3A_phy">phy</code></td>
<td>
<p>an object of class 'phylo'.</p>
</td></tr>
</table>

<hr>
<h2 id='sscd'>calculate the sum of sister clade differences (SSCD) metric</h2><span id='topic+sscd'></span>

<h3>Description</h3>

<p>This function calculates the SSCD metric. To conduct significance test on SSCD, use 'sscd' as input of 'func' in 'treestat'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sscd(state, phy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sscd_+3A_state">state</code></td>
<td>
<p>a vector of '0' and '1' for trait state of each tip, in the same order as the tip labels.</p>
</td></tr>
<tr><td><code id="sscd_+3A_phy">phy</code></td>
<td>
<p>an object of class 'phylo'.</p>
</td></tr>
</table>

<hr>
<h2 id='tars'>calculate the tip age rank sum (TARS) metric</h2><span id='topic+tars'></span>

<h3>Description</h3>

<p>This function calculates the TARS metric. To conduct significance test on TARS, use 'tars' as input of 'func' in 'treestat'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tars(state, phy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tars_+3A_state">state</code></td>
<td>
<p>a vector of '0' and '1' for trait state of each tip, in the same order as the tip labels.</p>
</td></tr>
<tr><td><code id="tars_+3A_phy">phy</code></td>
<td>
<p>an object of class 'phylo'.</p>
</td></tr>
</table>

<hr>
<h2 id='treesim'>Simulate trees with fixed number of sampled taxa and trait prevalance</h2><span id='topic+treesim'></span>

<h3>Description</h3>

<p>This function generates a tree that contains a defined number of sampled taxa for each of the two trait states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treesim(pars, N0, N1, sampling.f, max.t = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treesim_+3A_pars">pars</code></td>
<td>
<p>a vector of parameters that describe the macroevolutionary processes of the tree.  Parameters are in order of speciation rate for trait state 0, speciation rate for trait state 1, extinction rate for trait state 0, extinction rate for trait state 1, transition rate from state 0 to state 1, transition rate from state 1 to state 0.</p>
</td></tr>
<tr><td><code id="treesim_+3A_n0">N0</code></td>
<td>
<p>the number of sampled taxa with trait state 0.</p>
</td></tr>
<tr><td><code id="treesim_+3A_n1">N1</code></td>
<td>
<p>the number of sampled taxa with trait state 1.</p>
</td></tr>
<tr><td><code id="treesim_+3A_sampling.f">sampling.f</code></td>
<td>
<p>a vector of sampling fraction of taxa with trait state 0 and trait state 1.</p>
</td></tr>
<tr><td><code id="treesim_+3A_max.t">max.t</code></td>
<td>
<p>the maximum amount of time, above which tree simulation stops and reports the tree as not being able to coalesce.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>phy &lt;- treesim(pars=c(0.1,0.1,0.05,0.05,0.1,0.1),N0=50,N1=50,sampling.f=c(1,1),max.t=Inf) 
</code></pre>

<hr>
<h2 id='treestat'>Significance test of user defined phylogenetic metric</h2><span id='topic+treestat'></span>

<h3>Description</h3>

<p>This function conducts the significance test of a phylogenetic metric defined by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treestat(phy, stlist = NULL, state = NULL, func, par = NULL,
  traitevol = NULL, a = NULL, alternative = "two.sided", simplify = T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treestat_+3A_phy">phy</code></td>
<td>
<p>an object of class 'phylo'.</p>
</td></tr>
<tr><td><code id="treestat_+3A_stlist">stlist</code></td>
<td>
<p>a vector of tip labels with trait state '1'.</p>
</td></tr>
<tr><td><code id="treestat_+3A_state">state</code></td>
<td>
<p>a vector of '0' and '1' for trait state of each tip, in the same order as the tip labels.</p>
</td></tr>
<tr><td><code id="treestat_+3A_func">func</code></td>
<td>
<p>name of the function that calculates the metric. The first two inputs of the function need to be the state vector and the phylo class.</p>
</td></tr>
<tr><td><code id="treestat_+3A_par">par</code></td>
<td>
<p>values of additional parameters used in the above function.</p>
</td></tr>
<tr><td><code id="treestat_+3A_traitevol">traitevol</code></td>
<td>
<p>the null model of trait evolution used in the significance test of the metric. traitevol = &quot;TBM&quot; is the threshold brownian motion with the same trait prevalence as observed. traitevol = &quot;random&quot; is the random reshuffle of tip states. If users only want to calculate the value of the metric or if the null model is defined in the 'func' already, traitevol = NULL.</p>
</td></tr>
<tr><td><code id="treestat_+3A_a">a</code></td>
<td>
<p>number of traits simulated under the null model of trait evolution.</p>
</td></tr>
<tr><td><code id="treestat_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis for the significant test of the metric. alternative = &quot;greater&quot;, if users want to test if the observed trait has significantly larger metric value than expected by the null model of trait evolution. alternative = &quot;less&quot;, if users want to test if the observed trait has significantly smaller metric value. alternative = &quot;two.sided&quot; (default), if users have no prior knowledge on how the observed trait may differ from the null model.</p>
</td></tr>
<tr><td><code id="treestat_+3A_simplify">simplify</code></td>
<td>
<p>if TRUE, the output is simplified. The full output includes the p.value, metric value of the observed trait, metric values of the simulated traits, a matrix, each row of which is the state vector of a simulated trait. The simplified output includes the p.value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the example, we conduct significane test on a metric defined by 'tars' function for a simulated phylogeny. The null hypothesis is that the trait is randomly distributed across tips. We don't know if the trait will have larger or smaller metric value than expected, so we apply a &quot;two.sided&quot; test. 1000 traits are simulated to generate the null distribution of the metric.
The state vector is included in the phylo class as the output of treesim, so we don't need to input state here.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phy &lt;- treesim(pars=c(0.1,0.1,0.05,0.05,0.1,0.1),N0=50,N1=50,sampling.f=c(1,1),max.t=Inf)
treestat(phy, func=tars, traitevol="random", a=1000, alternative="two.sided", simplify=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
