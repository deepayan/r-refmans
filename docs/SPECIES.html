<!DOCTYPE html><html><head><title>Help for package SPECIES</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SPECIES}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#butterfly'><p>Fisher's butterfly data</p></a></li>
<li><a href='#chao1984'><p>Lower-bound estimator for species richness</p></a></li>
<li><a href='#ChaoBunge'><p>Coverage-duplication estimator for species richness</p></a></li>
<li><a href='#ChaoLee1992'><p>Coverage-based estimators for species richness</p></a></li>
<li><a href='#cottontail'><p>Cottontail data</p></a></li>
<li><a href='#EST'><p>EST data</p></a></li>
<li><a href='#insects'><p>Insects data</p></a></li>
<li><a href='#jackknife'><p>Jackknife estimator for the species richness</p></a></li>
<li><a href='#microbial'><p>Microbial species data</p></a></li>
<li><a href='#pcg'><p>Poisson-compound Gamma estimator for the species richness</p></a></li>
<li><a href='#pnpmle'><p>Penalized conditional NPML estimator for species richness</p></a></li>
<li><a href='#SPECIES-package'><p>An R pacakge for species richness estimation</p></a></li>
<li><a href='#traffic'><p>Traffic data</p></a></li>
<li><a href='#unpmle'><p>Unconditional NPML estimator for the SPECIES number</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Package for Species Richness Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Ji-Ping Wang, &lt;jzwang@northwestern.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ji-Ping Wang &lt;jzwang@northwestern.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of various methods in estimation of species richness or diversity in Wang (2011)&lt;<a href="https://doi.org/10.18637%2Fjss.v040.i09">doi:10.18637/jss.v040.i09</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-20 20:56:59 UTC; jon</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-20 21:22:38 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
</table>
<hr>
<h2 id='butterfly'>Fisher's butterfly data</h2><span id='topic+butterfly'></span>

<h3>Description</h3>

<p>The famous Fisher's butterfly data originally appeared in Fisher 1943. It has been re-analyzed in
many publications in the literature.</p>


<h3>References</h3>

<p>Fisher, R. A., Corbet, A. S., andWilliams, C. B. ,1943, The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population, Journal of Animal Ecology, 12, 42-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(butterfly)
</code></pre>

<hr>
<h2 id='chao1984'>Lower-bound estimator for species richness</h2><span id='topic+chao1984'></span>

<h3>Description</h3>

<p>This function calculates the lower-bound estimator by Chao 1984.</p>


<h3>Usage</h3>

<pre><code class='language-R'>       chao1984(n,conf=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chao1984_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature.
The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample. </p>
</td></tr>
<tr><td><code id="chao1984_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>chao1984</code> returns a list of:  <code>Nhat</code>, <code>SE</code> and <code>CI</code>.
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>point estimate.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error of the point estimate.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>confidence interval using a log transformation explained in Chao 1987.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University </p>


<h3>References</h3>

<p>Chao, A. (1984), Nonparametric Estimation of the Number of Classes in a Population, Scandinavian Journal of Statistics, 11, 265-270.
</p>
<p>Chao, A. (1987). Estimating the population size for capture-recapture data with unequal catchability. Biometrics
43, 783-791.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)

##load data from the package, 
## \dQuote{butterfly}is the famous butterfly data by Fisher 1943.

data(butterfly)
chao1984(butterfly)
</code></pre>

<hr>
<h2 id='ChaoBunge'>Coverage-duplication estimator for species richness</h2><span id='topic+ChaoBunge'></span>

<h3>Description</h3>

<p>This function calculates coverage-duplication based estimator from a Poisson-Gamma model by Chao and Bunge 2002.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>       ChaoBunge(n, t = 10,conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChaoBunge_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample. </p>
</td></tr>
<tr><td><code id="ChaoBunge_+3A_t">t</code></td>
<td>
<p>a positive integer. <code>t</code> is the cutoff value to define the relatively less abundant species to be used in estimation. The frequencies <code class="reqn">n_j</code> of <code class="reqn">j&gt;t</code> will not be used in estimating the sample coverage. The default value is <code>t</code>=10.</p>
</td></tr>
<tr><td><code id="ChaoBunge_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>ChaoBunge</code> returns a list of:  <code>Nhat</code>, <code>SE</code> and <code>CI</code>.
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>point estimate.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error(s) of the point estimate.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>confidence interval using a log transformation explained in Chao 1987.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University </p>


<h3>References</h3>

<p>Chao, A. (1984), Nonparametric Estimation of the Number of Classes in a Population, Scandinavian Journal of Statistics, 11, 265-270.
</p>
<p>Chao, A., and Bunge, J. (2002), Estimating the Number of Species in a Stochastic Abundance Model, Biometrics, 58, 531-539.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)

##load data from the package, 
##"butterfly" is the famous butterfly data by Fisher 1943.

data(butterfly)

##output estimates from all 4 methods using cutoff t=10
ChaoBunge(butterfly,t=10)

</code></pre>

<hr>
<h2 id='ChaoLee1992'>Coverage-based estimators for species richness</h2><span id='topic+ChaoLee1992'></span>

<h3>Description</h3>

<p>This function calculates <code>ACE</code> and <code>ACE-1</code> estimators by Chao and Lee 1992 (<code>ACE-1</code> provides
further bias correction based on <code>ACE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>       ChaoLee1992(n, t = 10, method = "all",conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChaoLee1992_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample. </p>
</td></tr>
<tr><td><code id="ChaoLee1992_+3A_t">t</code></td>
<td>
<p>a positive integer. <code>t</code> is the cutoff value to define the relatively less abundant species to be used in estimation. The frequencies <code class="reqn">n_j</code> of <code class="reqn">j&gt;t</code> will not be used in estimating the sample coverage. The default value is <code>t</code>=10.</p>
</td></tr>
<tr><td><code id="ChaoLee1992_+3A_method">method</code></td>
<td>
<p>a string. It can be any one of  &ldquo;ACE&rdquo;, &ldquo;ACE-1&rdquo;, or &ldquo;all&rdquo;. The default is &ldquo;all&rdquo;.</p>
</td></tr>
<tr><td><code id="ChaoLee1992_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>ChaoLee1992</code> returns a list of:  <code>Nhat</code>, <code>SE</code> and <code>CI</code>.
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>point estimate of the specified method. If the default <code>method</code>=&ldquo;all&rdquo; is used, the function returns an estimate vector including <code>ACE, ACE-1</code>.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error(s) of the point estimate(s).</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>confidence interval using a log transformation explained in Chao 1987.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University </p>


<h3>References</h3>

<p>Chao, A. (1987). Estimating the population size for capture-recapture data with unequal catchability. Biometrics
43, 783-791.
</p>
<p>Chao, A., and Lee, S.-M. (1992), Estimating the Number of Classes via Sample Coverage, Journal of the American Statistical Association, 87, 210-217.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)

##load data from the package, 
## "butterfly" is the famous butterfly data by Fisher 1943.

data(butterfly)

##output estimates from all 4 methods using cutoff t=10
ChaoLee1992(butterfly,t=10,method="all")

##output estimates from ACE method using cutoff t=10
ChaoLee1992(butterfly,t=10,method="ACE")
</code></pre>

<hr>
<h2 id='cottontail'>Cottontail data</h2><span id='topic+cottontail'></span>

<h3>Description</h3>

<p>The cottontail data was analyzed in Chao 1987</p>


<h3>References</h3>

<p>Chao, A. (1987). Estimating the population size for capture-recapture data with unequal catchability. Biometrics
43, 783-791. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(cottontail)
</code></pre>

<hr>
<h2 id='EST'>EST data</h2><span id='topic+EST'></span>

<h3>Description</h3>

<p>The Arabidopsis thaliana expressed sequence tag (EST) data  originally appeared in Wang and Lindsay 2005. It was recently reanalyzed in Wang 2010. For convenience, the frequency at <code class="reqn">j=17</code>  is used to denote the total count of species with <code class="reqn">j\ge17</code>.</p>


<h3>References</h3>

<p>Wang, J.-P. Z. and Lindsay, B. G. ,(2005), A penalized nonparametric maximum likelilhood approach to species richness estimation. Journal of American Statistical Association, 2005,100(471):942-959
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(EST)
</code></pre>

<hr>
<h2 id='insects'>Insects data</h2><span id='topic+insects'></span>

<h3>Description</h3>

<p>The insects data was analyzed in Burnham and Overton 1979. The frequency at <code class="reqn">j=6</code> is used to denote the total count of species with <code class="reqn">j\ge 6</code>.</p>


<h3>References</h3>

<p>Burnham, K. P., and Overton,W. S. (1979), Robust Estimation of Population Size When Capture Probabilities Vary Among Animals, Ecology, 60, 927-936.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(insects)
</code></pre>

<hr>
<h2 id='jackknife'>Jackknife estimator for the species richness</h2><span id='topic+jackknife'></span>

<h3>Description</h3>

<p>A function implementing the jackknife estimator of the species 
number by Burnham and Overton 1978 and 1979.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jackknife(n, k = 5, conf = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jackknife_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample.  </p>
</td></tr>
<tr><td><code id="jackknife_+3A_k">k</code></td>
<td>
<p>a positive integer. <code>k</code> is the specified Jackknife order. The default is <code>k</code>=5. Burnham and Overton 1978 and 1979 provided a testing procedure for the maximum order to be used in this estimator. If the specified order <code>k</code> or default is greater than the 
order obtained from the testing procedure, the function will automatically use the determined order rather than <code>k</code>. 
Currently this function only provide jackknife estimate up to order 10.</p>
</td></tr>
<tr><td><code id="jackknife_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.
<code>conf</code> also specifies the critical value in the sequential test for jackknife order.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>jackknife</code> returns a list of:  <code>JackknifeOrder</code>, <code>Nhat</code>, <code>SE</code> and <code>CI</code>.
</p>
<table>
<tr><td><code>JackknifeOrder</code></td>
<td>
<p>the jackknife estimator order specified order by the user or determined by the testing procedure.</p>
</td></tr>
<tr><td><code>Nhat</code></td>
<td>
<p>jackknife estimate.</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error of the jackknife estimate.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>confidence interval of the jackknife estimate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University</p>


<h3>References</h3>

<p>Burnham, K. P., and Overton,W. S. (1978), Estimation of the Size of a Closed Population When Capture Probabilities Vary Among Animals, Biometrika, 65, 625-633.
</p>
<p>Burnham, K. P., and Overton,W. S. (1979), Robust Estimation of Population Size When Capture Probabilities Vary Among Animals, Ecology, 60, 927-936.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(SPECIES)

##load data from the package, 
## "butterfly" is the famous tterfly data by Fisher 1943.

data(butterfly)
jackknife(butterfly,k=5)
</code></pre>

<hr>
<h2 id='microbial'>Microbial species data</h2><span id='topic+microbial'></span>

<h3>Description</h3>

<p>The microbial species data originally appeared in Acinas et al 2004. Recently
it was re-analyzed by Bohning and Schon 2005, and Wang 2009.</p>


<h3>References</h3>

<p>Acinas, S., Klepac-Ceraj, V., Hunt, D., Pharino, C., Ceraj, I., Distel, D., and Polz, M. (2004), Fine-scale phylogenetic architecture of a complex bacterial community. Nature, 430, 551-554.
</p>
<p>Hong, S. H., and Bunge, J. and Jeon, S.O. and Epstein, S. (2006), Predicting microbial species richness, Proc. Natl. Acad. Sci, 103, 117-122.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(microbial)
</code></pre>

<hr>
<h2 id='pcg'>Poisson-compound Gamma estimator for the species richness </h2><span id='topic+pcg'></span>

<h3>Description</h3>

<p>Function to calculate the Poisson-compound Gamma estimators of the species number by Wang 2010. This method
is essentially a conditional NPMLE method. The species abundance here is assumed to follow a compound 
Gamma model. The confidence interval is obtained based on a bootstrap procedure.
A Fortran function is called to for the computing. This function requires Fortran compiler installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcg(n,t=35,C=0,alpha=c(1:10),b=200,seed=NULL,conf=0.95,dis=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcg_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample.  </p>
</td></tr>
<tr><td><code id="pcg_+3A_t">t</code></td>
<td>
<p>a positive integer. <code>t</code> is the cutoff value defining the relatively less abundant species to be used in estimation. The default value for <code>t</code>=35.
The  estimator is more sensitive to t compared with pnpmle or unpmle estimators. We recommend to use <code class="reqn">t \ge 20</code> if the maximum frequency (<code class="reqn">j</code>) is greater than 20. Otherwise use the maximum frequency of <code class="reqn">j</code> for <code>t</code>.</p>
</td></tr>
<tr><td><code id="pcg_+3A_c">C</code></td>
<td>
<p>integer either 0 or 1. It specifies whether bootstrap confidence interval should be calculated. &ldquo;<code>C</code>=1&rdquo; for YES and &ldquo;<code>C</code>=0&rdquo; for NO.The default of <code>C</code> is set as 0.</p>
</td></tr>
<tr><td><code id="pcg_+3A_b">b</code></td>
<td>
<p>integer. <code>b</code> specifies the number of bootstrap samples to be generated for confidence interval. It is ignored if &ldquo;<code>C</code>=0&rdquo;.</p>
</td></tr>
<tr><td><code id="pcg_+3A_alpha">alpha</code></td>
<td>
<p>a positive grid for Gamma shape parameter. <code>alpha</code> must be a numerical vector for positive numbers. A cross-validation will be used to select a unified shape parameter value for the compound Gamma from the specified &ldquo;<code>alpha</code>&rdquo; grid. The default &ldquo;<code>alpha</code>&rdquo; grid is <code class="reqn">1,2,\ldots,10</code>.</p>
</td></tr>
<tr><td><code id="pcg_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
<tr><td><code id="pcg_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as an integer. Seed for random number generation</p>
</td></tr>
<tr><td><code id="pcg_+3A_dis">dis</code></td>
<td>
<p>0 or 1. 1 for on-screen display of the mixture output, and 0 for none.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pcg</code> estimator is computing intensive. The computing of bootstrap confidence interval may take up to a few hours.
</p>


<h3>Value</h3>

<p>The function <code>pcg</code> returns a list of:  <code>Nhat</code>, <code>CI</code> (if &ldquo;<code>C</code>=1&rdquo;) and <code>AlphaModel</code>.
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>point estimate of <code>N</code>.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>bootstrap confidence interval.</p>
</td></tr>
<tr><td><code>AlphaModel</code></td>
<td>
<p>unified shape parameter of compound Gamma selected from cross-validation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University</p>


<h3>References</h3>

<p>Wang, J.-P. (2010), Estimating the species richness by a Poisson-Compound Gamma model, 97(3): 727-740</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)
##load data from the package, 
## \dQuote{butterfly} is the famous butterfly data by Fisher 1943.

data(butterfly)

##output estimate without confidence interval using cutoff t=15
##pcg(butterfly,t=20,C=0,alpha=c(1:10))

##output estimate with confidence interval using cutoff t=15
#pcg(butterfly,t=20,C=1,alpha=c(1:10),b=200)
</code></pre>

<hr>
<h2 id='pnpmle'>Penalized conditional NPML estimator for species richness</h2><span id='topic+pnpmle'></span>

<h3>Description</h3>

<p>This function calculate the penalized conditional NPML estimator of the species number by Wang and Lindsay 2005.
This estimator was based on the conditional likelihood of a Poisson mixture model. A penalty term was 
introduced into the  model to prevent the boundary problem discussed in Wang and Lindsay 2008. The confidence interval is 
calculated based on a bootstrap procedure. A Fortran function is called to for the computing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnpmle(n,t=15,C=0,b=200,seed=NULL,conf=0.95,dis=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pnpmle_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample. </p>
</td></tr>
<tr><td><code id="pnpmle_+3A_t">t</code></td>
<td>
<p>a positive integer. <code>t</code> is the cutoff value to define the relatively less abundant species to be used in estimation of the Poisson mixture. The default value is <code>t</code>=15. The recommendation is to use <code class="reqn">\code{t} \ge 10</code>.</p>
</td></tr>
<tr><td><code id="pnpmle_+3A_c">C</code></td>
<td>
<p>integer either 0 or 1. It specifies whether bootstrap confidence interval should be calculated. &ldquo;<code>C</code>=1&rdquo; for YES and &ldquo;<code>C</code>=0&rdquo; for NO.The default of <code>C</code> is set as 0.</p>
</td></tr>
<tr><td><code id="pnpmle_+3A_b">b</code></td>
<td>
<p>integer. <code>b</code> specifies the number of bootstrap samples to be generated for confidence interval. It is ignored if &ldquo;<code>C</code>=0&rdquo;.</p>
</td></tr>
<tr><td><code id="pnpmle_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
<tr><td><code id="pnpmle_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as an integer. Seed for random number generation</p>
</td></tr>
<tr><td><code id="pnpmle_+3A_dis">dis</code></td>
<td>
<p>0 or 1. 1 for on-screen display of the mixture output, and 0 for none.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>pnpmle</code> returns a list of:  <code>Nhat</code>, <code>CI</code> (if &ldquo;<code>C</code>=1&rdquo;).
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>Point estimate of <code>N</code></p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>bootstrap confidence interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ji-Ping Wang,Department of Statistics, Northwestern University</p>


<h3>References</h3>

<p> Wang, J.-P. Z. and Lindsay, B. G. ,2005, A penalized nonparametric maximum likelihood approach to species richness estimation. Journal of American Statistical Association, 2005,100(471):942-959
</p>
<p>Wang, J.-P.,  and Lindsay, B.G., 2008, An exponential partial prior for improving NPML estimation for mixtures, Statistical Methodology, 2008,5:30-45  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)

##load data from the package, 
## \dQuote{butterfly} is the famous butterfly data by Fisher 1943.
#data(butterfly)

##output estimate without confidence interval using cutoff t=15
#pnpmle(butterfly,t=15,C=0)

##output estimate with confidence interval using cutoff t=15
#pnpmle(butterfly,t=15,C=1, b=200)

</code></pre>

<hr>
<h2 id='SPECIES-package'>An R pacakge for species richness estimation</h2><span id='topic+SPECIES-package'></span><span id='topic+SPECIES'></span>

<h3>Description</h3>

<p><code>SPECIES</code> provides multiple functions to compute popular estimators for species richness.These estimators include:
(1) jackknife estimator by Burnham and Overton 1978, 1979; (2) lower-bound estimator by Chao 1984; (3) coverage-base estimators ACE, ACE-1 by Chao and Lee 1992; (4) coverage-duplication estimator from Poisson-Gamma model by Chao and Bunge 2002; (5) unconditional nonparametric maximum likelihood estimator by Norris and Pollock 1996, 1998; (6) penalized nonparametric maximum likelihood estimator by Wang and Lindsay 2005; and (7) Poisson-compound Gamma model with smooth nonparametric maximum likelihood estimation by Wang 2010.
</p>


<h3>Details</h3>

<p>functions: chao1984, ChaoBunge, ChaoLee1992, jackknife, pcg ,pnpmle, unpmle;
data: butterfly, cottontail,EST, insect, microbial, traffic
</p>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University
</p>
<p>Maintainer: jzwang@northwestern.edu
</p>


<h3>References</h3>

<p>Acinas, S., Klepac-Ceraj, V., Hunt, D., Pharino, C., Ceraj, I., Distel, D., and Polz, M. (2004), Fine-scale phylogenetic architecture of a complex bacterial community. Nature, 430, 551-554.
</p>
<p>Bohning, D. and Schon, D., Nonparametric maximum likelihood estimation of population size based on the counting distribution, Journal of the Royal Statistical Society,
Series C: Applied Statistics, 54, 721-737.
</p>
<p>Burnham, K. P., and Overton,W. S. (1978), Estimation of the Size of a Closed Population When Capture Probabilities Vary Among Animals, Biometrika, 65, 625-633.
</p>
<p>Burnham, K. P., and Overton,W. S. (1979), Robust Estimation of Population Size When Capture Probabilities Vary Among Animals, Ecology, 60, 927-936.
</p>
<p>Chao, A. (1984), Nonparametric Estimation of the Number of Classes in a Population, Scandinavian Journal of Statistics, 11, 265-270.
</p>
<p>Chao, A. (1987). Estimating the population size for capture-recapture data with unequal catchability. Biometrics 43, 783-791.
</p>
<p>Chao, A., and Lee, S.-M. (1992), Estimating the Number of Classes via Sample Coverage, Journal of the American Statistical Association, 87, 210-217.
</p>
<p>Chao, A., and Bunge, J. (2002), Estimating the Number of Species in a Stochastic Abundance Model, Biometrics, 58, 531-539.
</p>
<p>Fisher, R. A., Corbet, A. S., and Williams, C. B. ,(1943), The Relation Between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population, Journal of Animal Ecology, 12, 42-58.
</p>
<p>Hong, S. H., and Bunge, J. and Jeon, S.O. and Epstein, S. (2006), Predicting microbial species richness, Proc. Natl. Acad. Sci, 103, 117-122.
</p>
<p>Norris, J. L. I., and Pollock, K. H. (1996), Nonparametric MLE Under Two Closed Capture-Recapture Models With Heterogeneity, Biometrics, 52,639-649. 
</p>
<p>Norris, J. L. I., and Pollock, K. H.(1998), Non-Parametric MLE for Poisson Species Abundance Models Allowing for Heterogeneity Between Species, Environmental and Ecological Statistics, 5, 391-402.
</p>
<p>Simar, L. (1976), Maximum likelihood estimation of a compound Poisson process, Annals of Statistics, 4, 1200-1209.
</p>
<p>Wang, J.-P. Z. and Lindsay, B. G. (2005), A penalized nonparametric maximum likelihood approach to species richness estimation. Journal of American Statistical Association, 100(471):942-959.
</p>
<p>Wang, J.-P.,  and Lindsay, B.G. (2008), An exponential partial prior for improving NPML estimation for mixtures, Statistical Methodology, 5:30-45. 
</p>
<p>Wang, J.-P. (2010), Estimating the species richness by a Poisson-Compound Gamma model, Biometrika, 97(3): 727-740.
</p>
<p>Wang, J.-P. (2011), SPECIES: An R Package for Species Richness Estimation, Journal of Statistical Software, 40(9), 1-15, URL: http://www.jstatsoft.org/v40/i09/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

## "butterfly" is the famous butterfly data by Fisher 1943.

data(butterfly)

##jackknife method
jackknife(butterfly,k=5)

##using only 'ACE' coverage method
ChaoLee1992(butterfly,t=10, method="all")

##using chao1984 lower bound estimator
chao1984(butterfly)

##using Chao and Bunge coverage-duplication method
ChaoBunge(butterfly,t=10)

##penalized NPMLE method
#pnpmle(butterfly,t=15,C=1,b=200)

##unconditonal NPMLE method
#unpmle(butterfly,t=10,C=1,b=200)

##Poisson-compound Gamma method
#pcg(butterfly,t=20,C=1,b=200)
</code></pre>

<hr>
<h2 id='traffic'>Traffic data</h2><span id='topic+traffic'></span>

<h3>Description</h3>

<p>The traffice data originally appeared in Simar 1976 where the total number of N is knowns as 9461. Recently
it was re-analyzed by Bohning and Schon 2005.</p>


<h3>References</h3>

<p>Simar, L. (1976), Maximum likelihood estimation of a compound Poisson process, Annals of Statistics, 4, 1200-1209.
Bohning, D., and Schon, D. (2005), Nonparametric maximum likelihood estimation of population size based on the counting distribution, Journal of the Royal Statistical Society, Series C: Applied Statistics, 54, 721-737.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##load library
library(SPECIES)

##load data that coming with the package.
data(traffic)
chao1984(traffic)
</code></pre>

<hr>
<h2 id='unpmle'>Unconditional NPML estimator for the SPECIES number</h2><span id='topic+unpmle'></span>

<h3>Description</h3>

<p>This function calculate the unconditional NPML estimator of the species number by Norris and Pollock 1996, 1998.
This estimator was obtained from the full likelihood based on a Poisson mixture model. The confidence interval is 
calculated based on a bootstrap procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unpmle(n,t=15,C=0,method="W-L",b=200,conf=.95,seed=NULL,dis=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unpmle_+3A_n">n</code></td>
<td>
<p>a matrix or a numerical data frame of two columns. It is also called the &ldquo;frequency of frequencies&rdquo; data in literature. The first column is the frequency <code class="reqn">j=1, 2\ldots</code>; and the second column is <code class="reqn">n_j</code>, the  number of species  observed with <code class="reqn">j</code>
individuals in the sample.   </p>
</td></tr>
<tr><td><code id="unpmle_+3A_t">t</code></td>
<td>
<p>a positive integer. <code>t</code> specifies the cutoff value to define the relatively less abundant species to be used in estimation.  The default value for t=15. The estimator is fairly insensitive to the choice of <code>t</code>. The recommendation is
to use <code class="reqn">t \ge 10</code>.</p>
</td></tr>
<tr><td><code id="unpmle_+3A_c">C</code></td>
<td>
<p>integer either 0 or 1. It specifies whether bootstrap confidence interval should be calculated. &ldquo;<code>C</code>=1&rdquo; for YES and &ldquo;<code>C</code>=0&rdquo; for NO.The default of <code>C</code> is set as 0.</p>
</td></tr>
<tr><td><code id="unpmle_+3A_method">method</code></td>
<td>
<p>string either &ldquo;N-P&rdquo; or &ldquo;W-L&rdquo;(default). If <code>method</code>=&ldquo;N-P&rdquo;, unconditional NPMLE will be used using an algorithm by  Bonhing and Schon (2005). 
Sometimes this method can be extremely slow. Alternatively one can use method &ldquo;W-L&rdquo;, an approximate method (but with high precision and much faster) by Wang and Lindsay 2005.</p>
</td></tr>
<tr><td><code id="unpmle_+3A_b">b</code></td>
<td>
<p>integer. <code>b</code> specifies the number of bootstrap samples for confidence interval. It is ignored if &ldquo;<code>C</code>=0&rdquo;.</p>
</td></tr>
<tr><td><code id="unpmle_+3A_conf">conf</code></td>
<td>
<p>a positive number <code class="reqn">\le 1</code>. <code>conf</code> specifies the confidence level for confidence interval. The default is 0.95.</p>
</td></tr>
<tr><td><code id="unpmle_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as an integer. Seed for random number generation</p>
</td></tr>
<tr><td><code id="unpmle_+3A_dis">dis</code></td>
<td>
<p>0 or 1. 1 for on-screen display of the mixture output, and 0 for none.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computing is intensive if <code>method</code>=&ldquo;N-P&rdquo; is used particularly when extrapolation is large. 
It may takes hours to compute the bootstrap confidence interval. If <code>method</code>=&ldquo;W-L&rdquo; is used, computing usually 
is much much faster. Estimates from both methods are often identical.</p>


<h3>Value</h3>

<p>The function <code>unpmle</code> returns a list of:  <code>Nhat</code>, <code>CI</code> (if &ldquo;<code>C</code>=1&rdquo;)
</p>
<table>
<tr><td><code>Nhat</code></td>
<td>
<p>point estimate of N</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>bootstrap confidence interval.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The unconditional NPML estimator is unstable from either <code>method='N-P'</code> or <code>method='W-L'</code>. Extremely large estimates may occur. 
This is also reflected in that the upper confidence bound often greatly vary from different runs of bootstrap procedure. In contrast the penalized NPMLE by <code>pnpmle</code> function is much more stable.</p>


<h3>Author(s)</h3>

<p>Ji-Ping Wang, Department of Statistics, Northwestern University</p>


<h3>References</h3>

 
<p>Norris, J. L. I., and Pollock, K. H. (1996), Nonparametric MLE Under Two Closed Capture-Recapture Models With Heterogeneity, Biometrics, 52,639-649. 
</p>
<p>Norris, J. L. I., and Pollock, K. H.(1998), Non-Parametric MLE for Poisson Species Abundance Models Allowing for Heterogeneity Between Species, Environmental and Ecological Statistics, 5, 391-402.
</p>
<p>Bonhing, D. and Schon, D.,  (2005), Nonparametric maximum likelihood estimation of population size based on the counting distribution, Journal of the Royal Statistical Society,
Series C: Applied Statistics, 54, 721-737.
</p>
<p>Wang, J.-P. Z. and Lindsay, B. G. ,(2005), A penalized nonparametric maximum likelihood approach to species richness estimation. Journal of American Statistical Association, 2005,100(471):942-959
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SPECIES)

##load data from the package, 
## "butterfly" is the famous butterfly data by Fisher 1943.

data(butterfly)


##output estimate without confidence interval using cutoff t=15
#unpmle(butterfly,t=15,C=0)

##output estimate with confidence interval using cutoff t=15
#unpmle(butterfly,t=15,C=1,b=200)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
