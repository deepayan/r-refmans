<!DOCTYPE html><html><head><title>Help for package ppcc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ppcc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ppcc-package'><p>Goodness-of-Fit Tests using the</p>
Probability Plot Correlation Coefficient</a></li>
<li><a href='#ppccTest'><p>Probability Plot Correlation Coefficient Test</p></a></li>
<li><a href='#ppPositions'><p>Plotting Point Positions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Probability Plot Correlation Coefficient Test</td>
</tr>
<tr>
<td>Author:</td>
<td>Thorsten Pohlert</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thorsten Pohlert &lt;thorsten.pohlert@gmx.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates the Probability Plot Correlation Coefficient (PPCC) 
             between a continuous variable X and a specified distribution. The corresponding 
	     composite hypothesis test that was first introduced by 
	     Filliben (1975) &lt;<a href="https://doi.org/10.1080%2F00401706.1975.10489279">doi:10.1080/00401706.1975.10489279</a>&gt; 
	     can be performed to test whether the sample 
	     X is element of either the Normal, log-Normal, Exponential,
	     Uniform, Cauchy, Logistic, Generalized Logistic, Gumbel (GEVI), Weibull,
	     Generalized Extreme Value, Pearson III (Gamma 2), Mielke's Kappa, Rayleigh
	     or Generalized Logistic Distribution. The PPCC test is performed with
	     a fast Monte-Carlo simulation.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>VGAM (&ge; 1.0), nortest(&ge; 1.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Classification/MSC-2010:</td>
<td>62G10</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-01 20:20:54 UTC; thorsten</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-01 20:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ppcc-package'>Goodness-of-Fit Tests using the
Probability Plot Correlation Coefficient</h2><span id='topic+ppcc'></span><span id='topic+ppcc-package'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ppccTest">ppccTest</a></code> performs
the Probability Plot Correlation Coefficient test
for various continuous distribution functions.
</p>

<hr>
<h2 id='ppccTest'>Probability Plot Correlation Coefficient Test</h2><span id='topic+ppccTest'></span>

<h3>Description</h3>

<p>Performs the Probability Plot Correlation Coeffient
Test of Goodness-of-Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppccTest(
  x,
  qfn = c("qnorm", "qlnorm", "qunif", "qexp", "qcauchy", "qlogis", "qgumbel",
    "qweibull", "qpearson3", "qgev", "qkappa2", "qrayleigh", "qglogis"),
  shape = NULL,
  ppos = NULL,
  mc = 10000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppccTest_+3A_x">x</code></td>
<td>
<p>a numeric vector of data values; NA values will be silently ignored.</p>
</td></tr>
<tr><td><code id="ppccTest_+3A_qfn">qfn</code></td>
<td>
<p>a character vector naming a valid quantile function</p>
</td></tr>
<tr><td><code id="ppccTest_+3A_shape">shape</code></td>
<td>
<p>numeric, the shape parameter for the relevant distribution,
if applicable; defaults to NULL</p>
</td></tr>
<tr><td><code id="ppccTest_+3A_ppos">ppos</code></td>
<td>
<p>character, the method for estimating plotting point positions,
default's to <code>NULL</code>, see Details for corresponding
defaults and <code><a href="#topic+ppPositions">ppPositions</a></code> for available methods</p>
</td></tr>
<tr><td><code id="ppccTest_+3A_mc">mc</code></td>
<td>
<p>numeric, the number of Monte-Carlo replications, defaults to 10000</p>
</td></tr>
<tr><td><code id="ppccTest_+3A_...">...</code></td>
<td>
<p>further arguments, currently ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Filliben (1975) suggested a probability plot correlation
coeffient test to test a sample for normality. The ppcc is defined as
the product moment correlation coefficient between the
ordered data <code class="reqn">x_{(i)}</code> and the order statistic medians <code class="reqn">M_{i}</code>,
</p>
<p style="text-align: center;"><code class="reqn">
r =  \frac{\sum_{i = 1}^n \left(x_{(i)} - \bar{x} \right)~ \left(M_i - \bar{M}\right)}
{\sqrt{\sum_{i=1}^n \left(x_{(i)} - \bar{x}\right)^2 ~ \sum_{j = 1}^n \left(M_j - \bar{M} \right)^2}},</code>
</p>

<p>whereas the ordered statistic medians are related to the quantile function
of the standard normal distribution, <code class="reqn">M_{i} = \phi^{-1} (m_i)</code>.
The values of <code class="reqn">m_i</code> are estimated by plotting-point position procedures
(see <code><a href="#topic+ppPositions">ppPositions</a></code>).
</p>
<p>In this function the test is performed by Monte-Carlo simulation:
</p>

<ol>
<li><p> Calculate quantile-quantile <code class="reqn">\hat{r}</code> for the ordered
sample data <code>x</code>
and the specified <code>qfn</code> distribution (with <code>shape</code>, if applicable)
and given <code>ppos</code>.
</p>
</li>
<li><p> Draw <code>n</code> (pseudo) random deviates from the specified <code>qfn</code>
distribution, where <code>n</code> is the sample size of <code>x</code>.
</p>
</li>
<li><p> Calculate quantile-quantile <code class="reqn">r_i</code> for the random
deviates and the specified <code>qfn</code> distribution with given <code>ppos</code>.
</p>
</li>
<li><p> Repeat step 2 and 3 for <code class="reqn">i = \left\{1, 2, \ldots, mc\right\}</code>.
</p>
</li>
<li><p> Calculate <code class="reqn">S = \sum_{i=1}^n \mathrm{sgn}(\hat{r} - r_i)</code> with
sgn the sign-function.
</p>
</li>
<li><p> The estimated <code class="reqn">p</code>-value is <code class="reqn">p = S / mc</code>.
</p>
</li></ol>

<p>The probability plot correlation coeffient is invariant for <code>location</code>
and <code>scale</code>. Therefore, the null hypothesis is a
composite hypothesis, e.g. <code class="reqn">H0: X \in N(\mu, \sigma),
~~ \mu \in R,~~ \sigma \in R_{&gt;0}</code>.
Furthermore, distributions with one (additional) specified
<code>shape</code> parameter can be tested.
</p>
<p>The magnitude of <code class="reqn">\hat{r}</code> depends on the selected method for
plotting-point positions (see <code><a href="#topic+ppPositions">ppPositions</a></code>)
and the sample size. Several authors extended Filliben's method to
assess the goodness-of-fit to other distributions, whereas theoretical
quantiles were used as opposed to Filliben's medians.
</p>
<p>The default plotting positions (see <code><a href="#topic+ppPositions">ppPositions</a></code>)
depend on the selected <code>qfn</code>.
</p>
<p>Distributions with none or one single scale parameter
that can be tested:
</p>

<table>
<tr>
 <td style="text-align: left;">
Argument </td><td style="text-align: left;"> Function </td><td style="text-align: left;"> Default pppos </td><td style="text-align: left;"> Reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qunif</code> </td><td style="text-align: left;"> Uniform </td><td style="text-align: left;"> <code>Weibull</code> </td><td style="text-align: left;"> Vogel and Kroll (1989) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qexp</code> </td><td style="text-align: left;"> Exponential </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qgumbel</code> </td><td style="text-align: left;"> Gumbel </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;"> Vogel (1986) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qrayleigh</code> </td><td style="text-align: left;"> Rayleigh </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Distributions with <code>location</code> and <code>scale</code> parameters
that can be tested:
</p>

<table>
<tr>
 <td style="text-align: left;">
Argument </td><td style="text-align: left;"> Function </td><td style="text-align: left;"> Default pppos </td><td style="text-align: left;"> Reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qnorm</code> </td><td style="text-align: left;"> Normal </td><td style="text-align: left;"> <code>Blom</code> </td><td style="text-align: left;"> Looney and Gulledge (1985) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qlnorm</code> </td><td style="text-align: left;"> log-Normal </td><td style="text-align: left;"> <code>Blom</code> </td><td style="text-align: left;"> Vogel and Kroll (1989)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qcauchy</code> </td><td style="text-align: left;"> Cauchy </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qlogis</code> </td><td style="text-align: left;"> Logistic </td><td style="text-align: left;"> <code>Blom</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If Blom's plotting position is used for <code>qnorm</code>, than the ppcc-test
is related to the Shapiro-Francia
normality test (Royston 1993), where <code class="reqn">W' = r^2</code>. See
<code><a href="nortest.html#topic+sf.test">sf.test</a></code> and <code>example(ppccTest)</code>.
</p>
<p>Distributions with additional <code>shape</code> parameters
that can be tested:
</p>

<table>
<tr>
 <td style="text-align: left;">
Argument </td><td style="text-align: left;"> Function </td><td style="text-align: left;"> Default pppos </td><td style="text-align: left;"> Reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qweibull</code> </td><td style="text-align: left;"> Weibull </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qpearson3</code> </td><td style="text-align: left;"> Pearson III </td><td style="text-align: left;"> <code>Blom</code> </td><td style="text-align: left;"> Vogel and McMartin (1991)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qgev</code> </td><td style="text-align: left;"> GEV </td><td style="text-align: left;"> <code>Cunane</code> </td><td style="text-align: left;"> Chowdhury et al. (1991) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qkappa2</code> </td><td style="text-align: left;"> two-param. Kappa Dist. </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>qglogis</code> </td><td style="text-align: left;"> Generalized Logistic </td><td style="text-align: left;"> <code>Gringorton</code> </td><td style="text-align: left;">  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If <code>qfn = qpearson3</code> and <code>shape = 0</code> is selected, the
<code>qnorm</code> distribution is used. If <code>qfn = qgev</code> and
<code>shape = 0</code>, the <code>qgumbel</code> distribution is used.
If <code>qfn = qglogis</code> and <code>shape = 0</code> is selected, the
<code>qglogis</code> distribution is used.
</p>


<h3>Value</h3>

<p>a list with class 'htest'
</p>


<h3>Note</h3>

<p>As the <code>pvalue</code> is estimated through a Monte-Carlo simulation,
the results depend on the selected seed (see <code><a href="base.html#topic+set.seed">set.seed</a></code>)
and the total number of replicates (<code>mc</code>).
</p>
<p>The default of <code>mc = 10000</code> re-runs is sufficient for
testing the composite hypothesis on levels of <code class="reqn">\alpha = [0.1, 0.05]</code>.
If a level of <code class="reqn">\alpha = 0.01</code> is desired, than larger sizes
of re-runs (e.g. <code>mc = 100000</code>) might be required.
</p>


<h3>References</h3>

<p>J. U. Chowdhury, J. R. Stedinger, L.-H. Lu (1991), Goodness-of-Fit Tests
for Regional Generalized Extreme Value Flood Distributions,
<em>Water Resources Research</em> 27, 1765&ndash;1776.
</p>
<p>J. J. Filliben (1975), The Probability Plot Correlation
Coefficient Test for Normality, <em>Technometrics</em> 17, 111&ndash;117.
</p>
<p>S. Kim, H. Shin, T. Kim, J.-H. Heo (2010), Derivation of the Probability
Plot Correlation Coefficient Test Statistics for the Generalized Logistic
Distribution. Intern. Workshop Adv. in Stat. Hydrol., May 23 - 25, 2010
Taormina.
</p>
<p>S. W. Looney, T. R. Gulledge (1985), Use of Correlation Coefficient
with Normal Probability Plots, <em>The American Statistician</em> 39,
75&ndash;79.
</p>
<p>P. W. Mielke (1973), Another family of distributions for
describing and analyzing precipitation data.
<em>Journal of Applied Meteorology</em> 12, 275&ndash;280.
</p>
<p>P. Royston, P. (1993), A pocket-calculator algorithm for the
Shapiro-Francia test for non-normality: an application to
medicine. <em>Statistics in Medicine</em> 12, 181-184.
</p>
<p>R. M. Vogel (1986), The Probability Plot Correlation Coefficient
Test for the Normal, Lognormal, and Gumbel Distributional
Hypotheses, <em>Water Resources Research</em> 22, 587&ndash;590.
</p>
<p>R. M. Vogel, C. N. Kroll (1989), Low-flow frequency analysis using
probability-plot correlation coefficients, <em>Journal of Water
Resources Planning and Management</em> 115, 338&ndash;357.
</p>
<p>R. M. Vogel, D. E. McMartin (1991), Probability Plot Goodness-of-Fit
and Skewness Estimation Procedures for the Pearson Type 3
Distribution, <em>Water Resources Research</em> 27, 3149&ndash;3158.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqplot">qqplot</a></code>, <code><a href="stats.html#topic+qqnorm">qqnorm</a></code>, <code><a href="stats.html#topic+ppoints">ppoints</a></code>,
<code><a href="#topic+ppPositions">ppPositions</a></code>, <code><a href="stats.html#topic+Normal">Normal</a></code>,
<code><a href="stats.html#topic+Lognormal">Lognormal</a></code>, <code><a href="stats.html#topic+Uniform">Uniform</a></code>, <code><a href="stats.html#topic+Exponential">Exponential</a></code>, <code><a href="stats.html#topic+Cauchy">Cauchy</a></code>,
<code><a href="stats.html#topic+Logistic">Logistic</a></code>, <code><a href="VGAM.html#topic+qgumbel">qgumbel</a></code>, <code><a href="stats.html#topic+Weibull">Weibull</a></code>,
<code><a href="VGAM.html#topic+qgev">qgev</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Filliben (1975, p.116)
## Note: Filliben's result was 0.98538
## decimal accuracy in 1975 is assumed to be less than in 2017
x &lt;- c(6, 1, -4, 8, -2, 5, 0)
set.seed(100)
ppccTest(x, "qnorm", ppos="Filliben")
## p between .75 and .9
## see Table 1 of Filliben (1975, p.113)
##
set.seed(100)
## Note: default plotting position for
## qnorm is ppos ="Blom"
ppccTest(x, "qnorm")
## p between .75 and .9
## see Table 2 of Looney and Gulledge (1985, p.78)
##
## 
set.seed(300)
x &lt;- rnorm(30)
qn &lt;- ppccTest(x, "qnorm")
qn
## p between .5 and .75
## see Table 2 for n = 30 of Looney and Gulledge (1985, p.78)
##
## Compare with Shapiro-Francia test
if(require(nortest)){
   sn &lt;- sf.test(x)
   print(sn)
   W &lt;- sn$statistic
   rr &lt;- qn$statistic^2
   names(W) &lt;- NULL
   names(rr) &lt;- NULL
   print(all.equal(W, rr))
}
ppccTest(x, "qunif")
ppccTest(x, "qlnorm")
old &lt;- par()
par(mfrow=c(1,3))
xlab &lt;- "Theoretical Quantiles"
ylab &lt;- "Empirical Quantiles"
qqplot(x = qnorm(ppPositions(30, "Blom")),
       y = x, xlab=xlab, ylab=ylab, main = "Normal q-q-plot")
qqplot(x = qunif(ppPositions(30, "Weibull")),
       y = x, xlab=xlab, ylab=ylab, main = "Uniform q-q-plot")
qqplot(x = qlnorm(ppPositions(30, "Blom")),
       y = x, xlab=xlab, ylab=ylab, main = "log-Normal q-q-plot")
par(old)
##
if (require(VGAM)){
set.seed(300)
x &lt;- rgumbel(30)
gu &lt;- ppccTest(x, "qgumbel")
print(gu)
1000 * (1 -  gu$statistic)
}
##
## see Table 2 for n = 30 of Vogel (1986, p.589) 
## for n = 30 and Si = 0.5, the critical value is 16.9 
##
set.seed(200)
x &lt;- runif(30)
un &lt;- ppccTest(x, "qunif")
print(un)
1000 * (1 - un$statistic)
##
## see Table 1 for n = 30 of Vogel and Kroll (1989, p.343)
## for n = 30 and Si = 0.5, the critical value is 10.5
##
set.seed(200)
x &lt;- rweibull(30, shape = 2.5)
ppccTest(x, "qweibull", shape=2.5)
ppccTest(x, "qweibull", shape=1.5)
##
if (require(VGAM)){
set.seed(200)
x &lt;- rgev(30, shape = -0.2)
ev &lt;- ppccTest(x, "qgev", shape=-0.2)
print(ev)
1000 * (1 - ev$statistic)
##
## see Table 3 for n = 30 and shape = -0.2
## of Chowdhury et al. (1991, p.1770)
## The tabulated critical value is 80.
}

</code></pre>

<hr>
<h2 id='ppPositions'>Plotting Point Positions</h2><span id='topic+ppPositions'></span>

<h3>Description</h3>

<p>Calculates plotting point positions according
to different authors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppPositions(
  n,
  method = c("Gringorton", "Cunane", "Filliben", "Blom", "Weibull", "ppoints")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppPositions_+3A_n">n</code></td>
<td>
<p>numeric, the sample size</p>
</td></tr>
<tr><td><code id="ppPositions_+3A_method">method</code></td>
<td>
<p>a character string naming a valid method (see Details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods can by selected:
</p>
<p><code>"Gringorton"</code> the plotting point positions are
calculated as
</p>
<p style="text-align: center;"><code class="reqn">m_i = \left(i - 0.44\right) / \left(n + 0.12\right)</code>
</p>

<p><code>"Cunane"</code> the plotting point positions are
calculated as
</p>
<p style="text-align: center;"><code class="reqn">m_i = \left(i - 0.4\right) / \left(n + 0.2\right)</code>
</p>

<p><code>"Blom"</code> the plotting point positions are
calculated as
</p>
<p style="text-align: center;"><code class="reqn">m_i = \left(i - 0.3175\right) / \left(n + 0.25\right)</code>
</p>

<p><code>"Filliben"</code> the order statistic medians are calculated as:
</p>
<p style="text-align: center;"><code class="reqn">
m_i = \left\{
      \begin{array}{l l}
      1 - 0.5^{1/n} &amp; i = 1 \\
      \left(i - 0.3175\right)/\left(n + 0.365\right) &amp; i = 2,\ldots, n - 1 \\
      0.5^{1/n} &amp; i = n \\
      \end{array}\right.
</code>
</p>

<p><code>"ppoints"</code> R core's default plotting point positions
are calculated (see <code><a href="stats.html#topic+ppoints">ppoints</a></code>).
</p>


<h3>Value</h3>

<p>a vector of class numeric that contains the plotting positions
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
