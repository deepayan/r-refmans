<!DOCTYPE html><html><head><title>Help for package covafillr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covafillr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#covafill-class'><p>A Reference Class for Local Polynomial Regression with covafill.</p></a></li>
<li><a href='#covatree-class'><p>A Reference Class for Search Tree Approximated Local Polynomial Regression with covatree.</p></a></li>
<li><a href='#cxxFlags'><p>CXXFLAGS to compile with covafill</p></a></li>
<li><a href='#kde'><p>Kernel Density Estimation</p></a></li>
<li><a href='#loadJAGSModule'><p>load JAGS module.</p></a></li>
<li><a href='#stat_covafill'><p>Add a covafill smoother to an (x,y) plot</p></a></li>
<li><a href='#suggestBandwith'><p>Suggest bandwith for local polynomial regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Local Polynomial Regression of State Dependent Covariates in
State-Space Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christoffer Moesgaard Albertsen &lt;cmoe@aqua.dtu.dk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates local polynomial regression for state dependent covariates in state-space models. The functionality can also be used from 'C++' based model builder tools such as 'Rcpp'/'inline', 'TMB', or 'JAGS'.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/calbertsen/covafillr/issues">https://github.com/calbertsen/covafillr/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/calbertsen/covafillr">https://github.com/calbertsen/covafillr</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, Rcpp (&ge; 0.11.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppEigen</td>
</tr>
<tr>
<td>Suggests:</td>
<td>TMB, rjags, inline, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-22 09:45:30 UTC; cmoe</td>
</tr>
<tr>
<td>Author:</td>
<td>Christoffer Moesgaard Albertsen
    <a href="https://orcid.org/0000-0003-0088-4363"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-22 10:40:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='covafill-class'>A Reference Class for Local Polynomial Regression with covafill.</h2><span id='topic+covafill-class'></span><span id='topic+covafill'></span>

<h3>Description</h3>

<p>A Reference Class for Local Polynomial Regression with covafill.
</p>


<h3>Fields</h3>


<dl>
<dt><code>ptr</code></dt><dd><p>External pointer to the covafill C++ object</p>
</dd>
</dl>


<h3>Methods</h3>


<dl>
<dt><code>getBandwith()</code></dt><dd><p>Get the bandwith.</p>
</dd>
<dt><code>getDegree()</code></dt><dd><p>Get the polynomial degree.</p>
</dd>
<dt><code>getDim()</code></dt><dd><p>Get the dimension of the coordinates.</p>
</dd>
<dt><code>initialize(coord, obs, h = suggestBandwith(coord, p), p = 3L, ...)</code></dt><dd><p>Method to initialize the covafill. coord is a matrix of coordinates, obs is a vector of corresponding observations, h is a vector of bandwiths, and p is the polynomial degree.</p>
</dd>
<dt><code>predict(coord, se.fit = FALSE)</code></dt><dd><p>Predict function value and derivatives with local polynomial regression at coord. If se.fit=TRUE a list is returned with estimates and their standard deviations.</p>
</dd>
<dt><code>residuals(excludeRadius)</code></dt><dd><p>Get 'leave-neighborhood-out' residuals, i.e. local polynomial regression predictions excluding points within excludeRadius subtracted from the observation.</p>
</dd>
<dt><code>setBandwith(h)</code></dt><dd><p>Set the bandwith to h.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>getRefClass('covafill')
fn &lt;- function(x) x ^ 4 - x ^ 2
x &lt;- runif(2000,-3,3)
y &lt;- fn(x) + rnorm(2000,0,0.1)
cf &lt;- covafill(coord = x,obs = y,p = 5L)
cf$getDim()
cf$getDegree()
cf$getBandwith()
x0 &lt;- seq(-1,1,0.1)
y0 &lt;- cf$predict(x0)
par(mfrow=c(3,1))
plot(x0,y0[,1], main = "Function")
lines(x0,fn(x0))
plot(x0, y0[,2], main = "First derivative")
lines(x0, 4 * x0 ^ 3 - 2 * x0)
plot(x0, y0[,3], main = "Second derivative")
lines(x0, 3 * 4 * x0 ^ 2 - 2)
cf$setBandwith(1.0)
cf$getBandwith()

</code></pre>

<hr>
<h2 id='covatree-class'>A Reference Class for Search Tree Approximated Local Polynomial Regression with covatree.</h2><span id='topic+covatree-class'></span><span id='topic+covatree'></span>

<h3>Description</h3>

<p>A Reference Class for Search Tree Approximated Local Polynomial Regression with covatree.
</p>


<h3>Fields</h3>


<dl>
<dt><code>ptr</code></dt><dd><p>External pointer to the covatree C++ object</p>
</dd>
</dl>


<h3>Methods</h3>


<dl>
<dt><code>getDim()</code></dt><dd><p>Get the dimension of the coordinates.</p>
</dd>
<dt><code>initialize(
  coord,
  obs,
  h = suggestBandwith(coord, p),
  p = 3L,
  minLeft = length(obs)/10,
  ...
)</code></dt><dd><p>Method to initialize the covafill. coord is a matrix of coordinates, obs is a vector of corresponding observations, h is a vector of bandwiths, p is the polynomial degree, and minLeft is the minimum number of observations that will create a sub tree.</p>
</dd>
<dt><code>predict(coord)</code></dt><dd><p>Predict function value and first order derivatives with search tree approximated local polynomial regression at coord.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>getRefClass('covatree')
fn &lt;- function(x) x ^ 4 - x ^ 2
x &lt;- runif(2000,-3,3)
y &lt;- fn(x) + rnorm(2000,0,0.1)
ct &lt;- covatree(coord = x,obs = y,p = 5L, minLeft = 50)
ct$getDim()
x0 &lt;- seq(-1,1,0.1)
y0 &lt;- ct$predict(x0)
par(mfrow=c(2,1))
plot(x0,y0[,1], main = "Function")
lines(x0,fn(x0))
plot(x0, y0[,2], main = "First derivative")
lines(x0, 4 * x0 ^ 3 - 2 * x0)

</code></pre>

<hr>
<h2 id='cxxFlags'>CXXFLAGS to compile with covafill</h2><span id='topic+cxxFlags'></span>

<h3>Description</h3>

<p>Get CXXFLAGS to compile with covafill
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cxxFlags()
</code></pre>


<h3>Value</h3>

<p>Returns a string with the CXXFLAGS needed to compile C++ code using covafill.
</p>


<h3>Author(s)</h3>

<p>Christoffer Moesgaard Albertsen
</p>


<h3>See Also</h3>

<p><code><a href="TMB.html#topic+compile">compile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
if(require("TMB")){
   f &lt;- system.file("examples","tmbtest","tmbtest.cpp", package='covafillr')
   TMB::compile(f,CXXFLAGS = cxxFlags())
}

## End(Not run)
</code></pre>

<hr>
<h2 id='kde'>Kernel Density Estimation</h2><span id='topic+kde'></span>

<h3>Description</h3>

<p>Wrapper for the covafill reference class to do kernel density estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde(X, bw = suggestBandwith(X, -1), npred = 100, from = min(X), to = max(X))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kde_+3A_x">X</code></td>
<td>
<p>A numeric matrix or vector of data coordinates</p>
</td></tr>
<tr><td><code id="kde_+3A_bw">bw</code></td>
<td>
<p>Bandwith used</p>
</td></tr>
<tr><td><code id="kde_+3A_npred">npred</code></td>
<td>
<p>Number of coordinate wise equally spaced points at which the density is to be estimated. The numbers are repeated if the length is less than the dimension of the coordinates.</p>
</td></tr>
<tr><td><code id="kde_+3A_from">from</code></td>
<td>
<p>Coordinate wise lower bound of points at which the density is to be estimated. The numbers are repeated if the length is less than the dimension of the coordinates.</p>
</td></tr>
<tr><td><code id="kde_+3A_to">to</code></td>
<td>
<p>Coordinate wise upper bound of points at which the density is to be estimated. The numbers are repeated if the length is less than the dimension of the coordinates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of coordinates and corresponding density estimates
</p>


<h3>Author(s)</h3>

<p>Christoffer Moesgaard Albertsen
</p>

<hr>
<h2 id='loadJAGSModule'>load JAGS module.</h2><span id='topic+loadJAGSModule'></span>

<h3>Description</h3>

<p>Calls rjags::load.module with appropriate arguments to load the covafillr module.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadJAGSModule()
</code></pre>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Christoffer Moesgaard Albertsen
</p>


<h3>See Also</h3>

<p><code><a href="rjags.html#topic+load.module">load.module</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("rjags") &amp; covafillr:::.installed_with_jags)
   loadJAGSModule()
</code></pre>

<hr>
<h2 id='stat_covafill'>Add a covafill smoother to an (x,y) plot</h2><span id='topic+stat_covafill'></span>

<h3>Description</h3>

<p>As an extention to the <code>ggplot2</code> package, the function adds a covafill fit to an (x,y) plot. The fit is predicted to points on the interval range(x).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_covafill(
  mapping = NULL,
  data = NULL,
  geom = "smooth",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  n = 50,
  bandwith = NULL,
  polyDegree = 3L,
  level = 0.95,
  se = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_covafill_+3A_mapping">mapping</code></td>
<td>
<p>Set of mappings created by 'aes' from the <code>ggplot2</code> package. The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_geom">geom</code></td>
<td>
<p>The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_position">position</code></td>
<td>
<p>Position adjustments. The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_na.rm">na.rm</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_show.legend">show.legend</code></td>
<td>
<p>Should this legend be displayed? The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>The same as <code>ggplot2::stat_smooth</code>.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_n">n</code></td>
<td>
<p>Number of points to do prediction on.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_bandwith">bandwith</code></td>
<td>
<p>Bandwith used in covafill. Uses <code>suggestBandwith</code> by default.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_polydegree">polyDegree</code></td>
<td>
<p>Polynomial degree to use in covafill.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_level">level</code></td>
<td>
<p>Level of confidence interval to use.</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_se">se</code></td>
<td>
<p>Should confidence intervals be displayed?</p>
</td></tr>
<tr><td><code id="stat_covafill_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>layer</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> <code>layer</code>.
</p>


<h3>Author(s)</h3>

<p>Christoffer Moesgaard Albertsen
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+stat_smooth">stat_smooth</a></code>
</p>

<hr>
<h2 id='suggestBandwith'>Suggest bandwith for local polynomial regression</h2><span id='topic+suggestBandwith'></span>

<h3>Description</h3>

<p>The bandwith is suggested coordinate wise to be
</p>
<p style="text-align: center;"><code class="reqn">0.9 \sqrt{5} \min\left(sd(x),\frac{IQR(x)}{1.349}\right) n ^{-\frac{1}{d+4}} (p+1)</code>
</p>

<p>where p is the polynomial degree used and n is the number of coordinate points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suggestBandwith(X, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suggestBandwith_+3A_x">X</code></td>
<td>
<p>A numeric matrix or vector of data coordinates</p>
</td></tr>
<tr><td><code id="suggestBandwith_+3A_p">p</code></td>
<td>
<p>Polynomial degree to base the suggestion on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector or scalar of suggested bandwiths
</p>


<h3>Author(s)</h3>

<p>Christoffer Moesgaard Albertsen
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
