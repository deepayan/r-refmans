<!DOCTYPE html><html><head><title>Help for package vaccine</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vaccine}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#vaccine-package'><p>vaccine: Statistical Tools for Immune Correlates Analysis of Vaccine Clinical Trial Data</p></a></li>
<li><a href='#as_table'><p>Create table of estimates</p></a></li>
<li><a href='#diagnostics'><p>Run diagnostics</p></a></li>
<li><a href='#est_ce'><p>Estimate controlled effect curves</p></a></li>
<li><a href='#est_med'><p>Estimate mediation effects</p></a></li>
<li><a href='#est_overall'><p>Estimate overall risk and vaccine efficacy</p></a></li>
<li><a href='#hvtn505'><p>HVTN 505 Dataset</p></a></li>
<li><a href='#load_data'><p>Load and format data object</p></a></li>
<li><a href='#params_ce_cox'><p>Set parameters controlling Cox model estimation of controlled effect curves</p></a></li>
<li><a href='#params_ce_np'><p>Set parameters controlling nonparametric estimation of controlled effect</p>
curves</a></li>
<li><a href='#params_med_np'><p>Set parameters controlling nonparametric estimation of mediation effects</p></a></li>
<li><a href='#plot_ce'><p>Plotting controlled effect curves</p></a></li>
<li><a href='#summary_stats'><p>Calculate summary statistics</p></a></li>
<li><a href='#trim'><p>Trim data for plotting/reporting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Tools for Immune Correlates Analysis of Vaccine
Clinical Trial Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Various semiparametric and nonparametric statistical tools for
    immune correlates analysis of vaccine clinical trial data. This includes
    calculation of summary statistics and estimation of risk, vaccine efficacy,
    controlled effects (controlled risk and controlled vaccine efficacy), and
    mediation effects (natural direct effect, natural indirect effect,
    proportion mediated). See Gilbert P, Fong Y, Kenny A, and Carone, M (2022)
    &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxac024">doi:10.1093/biostatistics/kxac024</a>&gt; and Fay MP and Follmann DA (2023)
    &lt;<a href="https://doi.org/10.48550%2FarXiv.2208.06465">doi:10.48550/arXiv.2208.06465</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.10), fdrtool (&ge; 1.2.17), ggplot2 (&ge; 3.4.0),
ggpubr (&ge; 0.5.0), methods (&ge; 4.2.2), rlang (&ge; 1.0.6), Rsolnp
(&ge; 1.16), simest (&ge; 0.4), splines (&ge; 4.2.2), stats (&ge;
4.2.2), SuperLearner (&ge; 2.0.28), survival (&ge; 3.4.0), survML
(&ge; 0.0.0.9000), truncnorm (&ge; 1.0.8), e1071 (&ge; 1.7.12), gam
(&ge; 1.22.3), ranger (&ge; 0.16.0), utils (&ge; 4.3.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Avi-Kenny/vaccine">https://github.com/Avi-Kenny/vaccine</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Avi-Kenny/vaccine/issues">https://github.com/Avi-Kenny/vaccine/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 19:10:54 UTC; ak811</td>
</tr>
<tr>
<td>Author:</td>
<td>Avi Kenny [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Avi Kenny &lt;avi.kenny@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='vaccine-package'>vaccine: Statistical Tools for Immune Correlates Analysis of Vaccine Clinical Trial Data</h2><span id='topic+vaccine'></span><span id='topic+vaccine-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Various semiparametric and nonparametric statistical tools for immune correlates analysis of vaccine clinical trial data. This includes calculation of summary statistics and estimation of risk, vaccine efficacy, controlled effects (controlled risk and controlled vaccine efficacy), and mediation effects (natural direct effect, natural indirect effect, proportion mediated). See Gilbert P, Fong Y, Kenny A, and Carone, M (2022) <a href="https://doi.org/10.1093/biostatistics/kxac024">doi:10.1093/biostatistics/kxac024</a> and Fay MP and Follmann DA (2023) <a href="https://doi.org/10.48550/arXiv.2208.06465">doi:10.48550/arXiv.2208.06465</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Avi Kenny <a href="mailto:avi.kenny@gmail.com">avi.kenny@gmail.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/Avi-Kenny/vaccine">https://github.com/Avi-Kenny/vaccine</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Avi-Kenny/vaccine/issues">https://github.com/Avi-Kenny/vaccine/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as_table'>Create table of estimates</h2><span id='topic+as_table'></span>

<h3>Description</h3>

<p>Format estimates returned by <code><a href="#topic+est_ce">est_ce</a></code> as a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_table(..., which = "CR")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_table_+3A_...">...</code></td>
<td>
<p>One or more objects of class <code>"vaccine_est"</code> returned by
<code><a href="#topic+est_ce">est_ce</a></code>.</p>
</td></tr>
<tr><td><code id="as_table_+3A_which">which</code></td>
<td>
<p>One of c(&quot;CR&quot;, &quot;CVE&quot;); controls whether the table contains CR or
CVE values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table of CR or CVE values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_cox &lt;- est_ce(dat=dat, type="Cox", t_0=578)
ests_np &lt;- est_ce(dat=dat, type="NP", t_0=578)
ests_table &lt;- as_table(ests_cox, ests_np)
head(ests_table)

</code></pre>

<hr>
<h2 id='diagnostics'>Run diagnostics</h2><span id='topic+diagnostics'></span>

<h3>Description</h3>

<p>Run a set of diagnostic plots. Note that for this function to
work, <code><a href="#topic+est_ce">est_ce</a></code> must be run with <code>return_extras=T</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostics(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostics_+3A_obj">obj</code></td>
<td>
<p>An object of class <code>vaccine_est</code> returned by
<code><a href="#topic+est_ce">est_ce</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined plot of model diagnostics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_np &lt;- est_ce(dat=dat, type="NP", t_0=578, return_extras=TRUE)
diagnostics(ests_np)

</code></pre>

<hr>
<h2 id='est_ce'>Estimate controlled effect curves</h2><span id='topic+est_ce'></span>

<h3>Description</h3>

<p>Estimate controlled risk (CR) curves and/or controlled vaccine
efficacy (CVE) curves. See references for definitions of these curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_ce(
  dat,
  type = "Cox",
  t_0,
  cr = TRUE,
  cve = FALSE,
  s_out = seq(from = min(dat$s, na.rm = TRUE), to = max(dat$s, na.rm = TRUE), l = 101),
  ci_type = "transformed",
  placebo_risk_method = "KM",
  return_p_value = FALSE,
  return_extras = FALSE,
  params_cox = params_ce_cox(),
  params_np = params_ce_np()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_ce_+3A_dat">dat</code></td>
<td>
<p>A data object returned by load_data</p>
</td></tr>
<tr><td><code id="est_ce_+3A_type">type</code></td>
<td>
<p>One of c(&quot;Cox&quot;, &quot;NP&quot;). This specifies whether to estimate the
curve(s) using a marginalized Cox proportional hazards model or using a
monotone-constrained nonparametric estimator.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_t_0">t_0</code></td>
<td>
<p>Time point of interest</p>
</td></tr>
<tr><td><code id="est_ce_+3A_cr">cr</code></td>
<td>
<p>Boolean. If TRUE, the controlled risk (CR) curve is computed and
returned.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_cve">cve</code></td>
<td>
<p>Boolean. If TRUE, the controlled vaccine efficacy (CVE) curve is
computed and returned.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_s_out">s_out</code></td>
<td>
<p>A numeric vector of s-values (on the biomarker scale) for which
cve(s) and/or cr(s) are computed. Defaults to a grid of 101 points
between the min and max biomarker values.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_ci_type">ci_type</code></td>
<td>
<p>One of c(&quot;transformed&quot;, &quot;truncated&quot;, &quot;regular&quot;, &quot;none&quot;). If
ci_type=&quot;transformed&quot;, confidence intervals are computed on the logit(CR)
and/or log(1-CVE) scale to ensure that confidence limits lie within [0,1]
for CR and/or lie within (-inf,1] for CVE. If ci_type=&quot;truncated&quot;,
confidence limits are constructed on the CR and/or CVE scale but
truncated to lie within [0,1] for CR and/or lie within (-inf,1] for CVE.
If ci_type=&quot;regular&quot;, confidence limits are not transformed or truncated.
If ci_type=&quot;none&quot;, confidence intervals are not computed.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_placebo_risk_method">placebo_risk_method</code></td>
<td>
<p>One of c(&quot;KM&quot;, &quot;Cox&quot;). Method for estimating
overall risk in the placebo group. &quot;KM&quot; computes a Kaplan-Meier estimate
and &quot;Cox&quot; computes an estimate based on a marginalized Cox model survival
curve. Only relevant if cve=TRUE.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_return_p_value">return_p_value</code></td>
<td>
<p>Boolean; if TRUE, a P-value corresponding to the null
hypothesis that the CVE curve is flat is returned. The type of P-value
corresponds to the <code>type</code> argument.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_return_extras">return_extras</code></td>
<td>
<p>Boolean; if TRUE, objects useful for debugging are
returned.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_params_cox">params_cox</code></td>
<td>
<p>A list of options returned by
<code><a href="#topic+params_ce_cox">params_ce_cox</a></code> that are relevant if type=&quot;Cox&quot;.</p>
</td></tr>
<tr><td><code id="est_ce_+3A_params_np">params_np</code></td>
<td>
<p>A list of options returned by <code><a href="#topic+params_ce_np">params_ce_np</a></code>
that are relevant if type=&quot;NP&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the form <code>list(cr=list(...), cve=list(...))</code>
containing CR and/or CVE estimates. Each of the inner lists contains the
following: </p>

<ul>
<li><p><code>s</code>: a vector of marker values corresponding to s_out
</p>
</li>
<li><p><code>est</code>: a vector of point estimates
</p>
</li>
<li><p><code>ci_lower</code>: a vector of confidence interval lower limits
</p>
</li>
<li><p><code>ci_upper</code>: a vector of confidence interval upper limits
</p>
</li></ul>



<h3>References</h3>

<p>Gilbert P, Fong Y, Kenny A, and Carone, M (2022). A Controlled
Effects Approach to Assessing Immune Correlates of Protection.
&lt;doi:10.1093/biostatistics/kxac024&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_cox &lt;- est_ce(dat=dat, type="Cox", t_0=578)
ests_np &lt;- est_ce(dat=dat, type="NP", t_0=578)

</code></pre>

<hr>
<h2 id='est_med'>Estimate mediation effects</h2><span id='topic+est_med'></span>

<h3>Description</h3>

<p>Estimate mediation effects, including the natural direct effect
(NDE), the natural indirect effect (NIE), and the proportion mediated
(PM). See references for definitions of these objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_med(
  dat,
  type = "NP",
  t_0,
  nde = TRUE,
  nie = TRUE,
  pm = TRUE,
  scale = "RR",
  params_np = params_med_np()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_med_+3A_dat">dat</code></td>
<td>
<p>A data object returned by load_data</p>
</td></tr>
<tr><td><code id="est_med_+3A_type">type</code></td>
<td>
<p>One of c(&quot;NP&quot;, &quot;Cox&quot;). This specifies whether to estimate the
effects using a marginalized Cox proportional hazards model or using a
nonparametric estimator.</p>
</td></tr>
<tr><td><code id="est_med_+3A_t_0">t_0</code></td>
<td>
<p>Time point of interest</p>
</td></tr>
<tr><td><code id="est_med_+3A_nde">nde</code></td>
<td>
<p>Boolean. If TRUE, the natural direct effect is computed and
returned.</p>
</td></tr>
<tr><td><code id="est_med_+3A_nie">nie</code></td>
<td>
<p>Boolean. If TRUE, the natural indirect effect is computed and
returned.</p>
</td></tr>
<tr><td><code id="est_med_+3A_pm">pm</code></td>
<td>
<p>Boolean. If TRUE, the proportion mediated is computed and returned.</p>
</td></tr>
<tr><td><code id="est_med_+3A_scale">scale</code></td>
<td>
<p>One of c(&quot;RR&quot;, &quot;VE&quot;). This determines whether NDE and NIE
estimates and CIs are computed on the risk ratio (RR) scale or the
vaccine efficacy (VE) scale. The latter equals one minus the former.</p>
</td></tr>
<tr><td><code id="est_med_+3A_params_np">params_np</code></td>
<td>
<p>A list of options returned by <code><a href="#topic+params_med_np">params_med_np</a></code>
that are relevant if type=&quot;NP&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing the following columns: </p>

<ul>
<li><p><code>effect</code>: one of c(&quot;NDE&quot;, &quot;NIE&quot;, &quot;PM&quot;)
</p>
</li>
<li><p><code>est</code>: point estimate
</p>
</li>
<li><p><code>se</code>: standard error of point estimate
</p>
</li>
<li><p><code>ci_lower</code>: a confidence interval lower limit
</p>
</li>
<li><p><code>ci_upper</code>: a confidence interval upper limit
</p>
</li></ul>



<h3>References</h3>

<p>Fay MP and Follmann DA (2023). Mediation Analyses for the Effect
of Antibodies in Vaccination &lt;doi:10.48550/arXiv.2208.06465&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_np &lt;- est_med(dat=dat, type="NP", t_0=578)

</code></pre>

<hr>
<h2 id='est_overall'>Estimate overall risk and vaccine efficacy</h2><span id='topic+est_overall'></span>

<h3>Description</h3>

<p>Estimate overall risk and vaccine efficacy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_overall(dat, t_0, method = "Cox", risk = TRUE, ve = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_overall_+3A_dat">dat</code></td>
<td>
<p>A data object returned by load_data</p>
</td></tr>
<tr><td><code id="est_overall_+3A_t_0">t_0</code></td>
<td>
<p>Time point of interest</p>
</td></tr>
<tr><td><code id="est_overall_+3A_method">method</code></td>
<td>
<p>One of c(&quot;KM&quot;, &quot;Cox&quot;), corresponding to either a Kaplan-Meier
estimator (&quot;KM&quot;) or a marginalized Cox proportional hazards model
(&quot;Cox&quot;).</p>
</td></tr>
<tr><td><code id="est_overall_+3A_risk">risk</code></td>
<td>
<p>Boolean. If TRUE, the controlled risk (CR) curve is computed.</p>
</td></tr>
<tr><td><code id="est_overall_+3A_ve">ve</code></td>
<td>
<p>Boolean. If TRUE, the controlled vaccine efficacy (CVE) curve is
computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe containing estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)
est_overall(dat=dat, t_0=578, method="KM")
</code></pre>

<hr>
<h2 id='hvtn505'>HVTN 505 Dataset</h2><span id='topic+hvtn505'></span>

<h3>Description</h3>

<p>A dataset from the HVTN 505 clinical trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hvtn505)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1,950 rows and 10 variables:
</p>

<ul>
<li><p> pub_id: Unique individual identifier
</p>
</li>
<li><p> trt: Treatment Assignment: 1=Vaccine, 0=Placebo
</p>
</li>
<li><p> HIVwk28preunbl: Indicator of HIV-1 infection diagnosis on/after study
week 28 (day 196) prior to Unblinding Date (Apr 22, 2013).
</p>
</li>
<li><p> HIVwk28preunblfu: Follow-up time (in days) for HIV-1 infection
diagnosis endpoint as of the Unblinding Date (22Apr2013) occuring
on/after study week 28 (day 196).
</p>
</li>
<li><p> age: Age (in years) at randomization
</p>
</li>
<li><p> BMI: Body Mass Index: (Weight in Kg)/(Height in meters)**2
</p>
</li>
<li><p> bhvrisk: Baseline behavioral risk score
</p>
</li>
<li><p> casecontrol: Indicator of inclusion in the case-control cohort
</p>
</li>
<li><p> wt: Inverse-probability-of-sampling weights, for the case-control
cohort
</p>
</li>
<li><p> IgG_env: IgG Binding to gp120/140
</p>
</li>
<li><p> IgG_V2: IgG Binding to V1V2
</p>
</li>
<li><p> IgG_V3: IgG Binding to V3
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://atlas.scharp.org/cpas/project/HVTN%20Public%20Data/HVTN%20505/begin.view">https://atlas.scharp.org/cpas/project/HVTN%20Public%20Data/HVTN%20505/begin.view</a>
</p>

<hr>
<h2 id='load_data'>Load and format data object</h2><span id='topic+load_data'></span>

<h3>Description</h3>

<p>This function takes in user-supplied data and returns a data
object that can be read in by <code><a href="#topic+summary_stats">summary_stats</a></code>,
<code><a href="#topic+est_ce">est_ce</a></code>, <code><a href="#topic+est_med">est_med</a></code>, and other estimation
functions. Data is expected to come from a vaccine clinical trial,
possibly involving two-phase sampling and possibly including a biomarker
of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_data(
  time,
  event,
  vacc,
  marker,
  covariates,
  weights,
  ph2,
  strata = NA,
  data,
  covariates_ph2 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_data_+3A_time">time</code></td>
<td>
<p>A character string; the name of the numeric variable representing
observed event or censoring times.</p>
</td></tr>
<tr><td><code id="load_data_+3A_event">event</code></td>
<td>
<p>A character string; the name of the binary variable
corresponding to whether the observed time represents an event time (1)
or a censoring time (0). Either integer (0/1) or Boolean (T/F) values are
allowed.</p>
</td></tr>
<tr><td><code id="load_data_+3A_vacc">vacc</code></td>
<td>
<p>A character string; the name of the binary variable denoting
whether the individual is in the vaccine group (1) or the placebo group
(0). Accepts either integer (0/1) or Boolean (T/F) values.</p>
</td></tr>
<tr><td><code id="load_data_+3A_marker">marker</code></td>
<td>
<p>A character string; the name of the numeric variable of
biomarker values.</p>
</td></tr>
<tr><td><code id="load_data_+3A_covariates">covariates</code></td>
<td>
<p>A character vector; the names of the covariate columns.
Columns values should be either numeric, binary, or factors. Character
columns will be converted into factors.</p>
</td></tr>
<tr><td><code id="load_data_+3A_weights">weights</code></td>
<td>
<p>A character string; the name of the numeric variable
containing inverse-probability-of-sampling (IPS) weights.</p>
</td></tr>
<tr><td><code id="load_data_+3A_ph2">ph2</code></td>
<td>
<p>A character string; the name of the binary variable representing
whether the individual is in the phase-two cohort (1) or not (0). Accepts
either integer (0/1) or Boolean (T/F) values.</p>
</td></tr>
<tr><td><code id="load_data_+3A_strata">strata</code></td>
<td>
<p>A character string; the name of the variable containing strata
identifiers (for two-phase sampling strata).</p>
</td></tr>
<tr><td><code id="load_data_+3A_data">data</code></td>
<td>
<p>A dataframe containing the vaccine trial data.</p>
</td></tr>
<tr><td><code id="load_data_+3A_covariates_ph2">covariates_ph2</code></td>
<td>
<p>A boolean; if at least one of the covariates is
measured only in the phase-two cohort, set this to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>vaccine_dat</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)
</code></pre>

<hr>
<h2 id='params_ce_cox'>Set parameters controlling Cox model estimation of controlled effect curves</h2><span id='topic+params_ce_cox'></span>

<h3>Description</h3>

<p>This should be used in conjunction with <code><a href="#topic+est_ce">est_ce</a></code> to
set parameters controlling Cox model estimation of controlled effect
curves; see examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>params_ce_cox(spline_df = NA, spline_knots = NA, edge_ind = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="params_ce_cox_+3A_spline_df">spline_df</code></td>
<td>
<p>An integer; if the marker is modeled flexibly within the Cox
model linear predictor as a natural cubic spline, this option controls
the degrees of freedom in the spline; knots are chosen to be equally
spaced across the range of the marker.</p>
</td></tr>
<tr><td><code id="params_ce_cox_+3A_spline_knots">spline_knots</code></td>
<td>
<p>A numeric vector; as an alternative to specifying
<code>spline_df</code>, the exact locations of the knots in the spline
(including boundary knots) can be specified with this option.</p>
</td></tr>
<tr><td><code id="params_ce_cox_+3A_edge_ind">edge_ind</code></td>
<td>
<p>Boolean. If TRUE, an indicator variable corresponding to the
lower limit of the marker will be included in the Cox model linear
predictor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_cox &lt;- est_ce(
  dat = dat,
  type = "Cox",
  t_0 = 578,
  params_cox = params_ce_cox(spline_df=4)
)

</code></pre>

<hr>
<h2 id='params_ce_np'>Set parameters controlling nonparametric estimation of controlled effect
curves</h2><span id='topic+params_ce_np'></span>

<h3>Description</h3>

<p>This should be used in conjunction with <code><a href="#topic+est_ce">est_ce</a></code> to
set parameters controlling nonparametric estimation of controlled effect
curves; see examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>params_ce_np(
  dir = "decr",
  edge_corr = FALSE,
  grid_size = list(y = 101, s = 101, x = 5),
  surv_type = "survML-G",
  density_type = "binning",
  density_bins = 15,
  deriv_type = "m-spline",
  convex_type = "GCM"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="params_ce_np_+3A_dir">dir</code></td>
<td>
<p>One of c(&quot;decr&quot;, &quot;incr&quot;); controls the direction of monotonicity.
If dir=&quot;decr&quot;, it is assumed that CR decreases as a function of the
marker. If dir=&quot;incr&quot;, it is assumed that CR increases as a function of
the marker.</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_edge_corr">edge_corr</code></td>
<td>
<p>Boolean. If TRUE, the &quot;edge correction&quot; is performed to
adjust for bias near the marker lower limit (see references). It is
recommended that the edge correction is only performed if there are at
least (roughly) 10 events corresponding to the marker lower limit.</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_grid_size">grid_size</code></td>
<td>
<p>A list with keys <code>y</code>, <code>s</code>, and <code>x</code>; controls
the rounding of data values. Decreasing the grid size values results in
shorter computation times, and increasing the values results in more
precise estimates. If grid_size$s=101, this means that a grid of 101
equally-spaced points (defining 100 intervals) will be created from
min(S) to max(S), and each S value will be rounded to the nearest grid
point. For grid_size$y, a grid will be created from 0 to t_0, and then
extended to max(Y). For grid_size$x, a separate grid is created for each
covariate column (binary/categorical covariates are ignored).</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_surv_type">surv_type</code></td>
<td>
<p>One of c(&quot;Cox&quot;, &quot;survSL&quot;, &quot;survML-G&quot;, &quot;survML-L&quot;); controls
the method to use to estimate the conditional survival and conditional
censoring functions. If type=&quot;Cox&quot;, a survival function based on a Cox
proportional hazard model will be used. If type=&quot;survSL&quot;, the Super
Learner method of Westling 2023 is used. If type=&quot;survML-G&quot;, the global
survival stacking method of Wolock 2022 is used. If type=&quot;survML-L&quot;, the
local survival stacking method of Polley 2011 is used.</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_density_type">density_type</code></td>
<td>
<p>One of c(&quot;binning&quot;, &quot;parametric&quot;); controls the method to
use to estimate the density ratio f(S|X)/f(S).</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_density_bins">density_bins</code></td>
<td>
<p>An integer; if density_type=&quot;binning&quot;, the number of bins
to use. If density_bins=0, the number of bins will be selected via
cross-validation.</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_deriv_type">deriv_type</code></td>
<td>
<p>One of c(&quot;m-spline&quot;, &quot;linear&quot;); controls the method to use
to estimate the derivative of the CR curve. If deriv_type=&quot;linear&quot;, a
linear spline is constructed based on the midpoints of the jump points of
the estimated function (plus the estimated function evaluated at the
endpoints), which is then numerically differentiated.
deriv_type=&quot;m-spline&quot; is similar to deriv_type=&quot;linear&quot; but smooths the
set of points (using the method of Fritsch and Carlson 1980) before
differentiating.</p>
</td></tr>
<tr><td><code id="params_ce_np_+3A_convex_type">convex_type</code></td>
<td>
<p>One of c(&quot;GCM&quot;, &quot;CLS&quot;). Whether the greatest convex
minorant (&quot;GCM&quot;) or convex least squares (&quot;CLS&quot;) projection should be
used in the smoothing of the primitive estimator Gamma_n.
convex_type=&quot;CLS&quot; is experimental and should be used with caution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_np &lt;- est_ce(
  dat = dat,
  type = "NP",
  t_0 = 578,
  params_np = params_ce_np(edge_corr=TRUE, surv_type="survML-L")
)

</code></pre>

<hr>
<h2 id='params_med_np'>Set parameters controlling nonparametric estimation of mediation effects</h2><span id='topic+params_med_np'></span>

<h3>Description</h3>

<p>This should be used in conjunction with <code><a href="#topic+est_med">est_med</a></code> to
set parameters controlling nonparametric estimation of mediation effects;
see examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>params_med_np(
  grid_size = list(y = 101, s = 101, x = 5),
  surv_type = "survML-G",
  density_type = "binning",
  density_bins = 15
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="params_med_np_+3A_grid_size">grid_size</code></td>
<td>
<p>A list with keys <code>y</code>, <code>s</code>, and <code>x</code>; controls
the rounding of data values. Decreasing the grid size values results in
shorter computation times, and increasing the values results in more
precise estimates. If grid_size$s=101, this means that a grid of 101
equally-spaced points (defining 100 intervals) will be created from
min(S) to max(S), and each S value will be rounded to the nearest grid
point. For grid_size$y, a grid will be created from 0 to t_0, and then
extended to max(Y). For grid_size$x, a separate grid is created for each
covariate column (binary/categorical covariates are ignored).</p>
</td></tr>
<tr><td><code id="params_med_np_+3A_surv_type">surv_type</code></td>
<td>
<p>One of c(&quot;Cox&quot;, &quot;survSL&quot;, &quot;survML-G&quot;, &quot;survML-L&quot;); controls
the method to use to estimate the conditional survival and conditional
censoring functions. If type=&quot;Cox&quot;, a survival function based on a Cox
proportional hazard model will be used. If type=&quot;survSL&quot;, the Super
Learner method of Westling 2023 is used. If type=&quot;survML-G&quot;, the global
survival stacking method of Wolock 2022 is used. If type=&quot;survML-L&quot;, the
local survival stacking method of Polley 2011 is used.</p>
</td></tr>
<tr><td><code id="params_med_np_+3A_density_type">density_type</code></td>
<td>
<p>One of c(&quot;binning&quot;, &quot;parametric&quot;); controls the method to
use to estimate the density ratio f(S|X)/f(S).</p>
</td></tr>
<tr><td><code id="params_med_np_+3A_density_bins">density_bins</code></td>
<td>
<p>An integer; if density_type=&quot;binning&quot;, the number of bins
to use. If density_bins=0, the number of bins will be selected via
cross-validation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_med &lt;- est_med(
  dat = dat,
  type = "NP",
  t_0 = 578,
  params_np = params_med_np(surv_type="survML-L")
)

</code></pre>

<hr>
<h2 id='plot_ce'>Plotting controlled effect curves</h2><span id='topic+plot_ce'></span>

<h3>Description</h3>

<p>Plot CR and/or CVE curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ce(
  ...,
  which = "CR",
  density_type = "none",
  dat = NA,
  zoom_x = "zoom in",
  zoom_y = "zoom out"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ce_+3A_...">...</code></td>
<td>
<p>One or more objects of class <code>"vaccine_est"</code> returned by
<code><a href="#topic+est_ce">est_ce</a></code>.</p>
</td></tr>
<tr><td><code id="plot_ce_+3A_which">which</code></td>
<td>
<p>One of c(&quot;CR&quot;, &quot;CVE&quot;); controls whether to plot CR curves or CVE
curves.</p>
</td></tr>
<tr><td><code id="plot_ce_+3A_density_type">density_type</code></td>
<td>
<p>One of c(&quot;none&quot;, &quot;kde&quot;, &quot;kde edge&quot;).
Controls the type of estimator used for the background marker density
plot. For &quot;none&quot;, no density plot is displayed. For &quot;kde&quot;, a weighted
kernel density estimator is used. For &quot;kde edge&quot;, a modified version of
&quot;kde&quot; is used that allows for a possible point mass at the left edge of
the marker distribution.</p>
</td></tr>
<tr><td><code id="plot_ce_+3A_dat">dat</code></td>
<td>
<p>The data object originally passed into <code><a href="#topic+est_ce">est_ce</a></code>. It is
only necessary to pass this in if <code>density_type</code> is not set to
&quot;none&quot;.</p>
</td></tr>
<tr><td><code id="plot_ce_+3A_zoom_x">zoom_x</code></td>
<td>
<p>Either one of c(&quot;zoom in&quot;, &quot;zoom out&quot;) or a vector of
length 2. Controls the zooming on the X-axis. The default &quot;zoom in&quot; will
set the zoom limits to the plot estimates. Choosing &quot;zoom out&quot; will set
the zoom limits to show the entire distribution of the marker. Entering a
vector of length 2 will set the left and right zoom limits explicitly.</p>
</td></tr>
<tr><td><code id="plot_ce_+3A_zoom_y">zoom_y</code></td>
<td>
<p>Either &quot;zoom out&quot; or a vector of length 2. Controls the zooming
on the Y-axis. The default &quot;zoom out&quot; will show the entire vertical range
of the estimates. Entering a vector of length 2 will set the lower and
upper zoom limits explicitly.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of CR/CVE estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_cox &lt;- est_ce(dat=dat, type="Cox", t_0=578)
ests_np &lt;- est_ce(dat=dat, type="NP", t_0=578)
plot_ce(ests_cox, ests_np)

</code></pre>

<hr>
<h2 id='summary_stats'>Calculate summary statistics</h2><span id='topic+summary_stats'></span>

<h3>Description</h3>

<p>TO DO
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_stats(dat, quietly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_stats_+3A_dat">dat</code></td>
<td>
<p>A data object returned by 'load_data'.</p>
</td></tr>
<tr><td><code id="summary_stats_+3A_quietly">quietly</code></td>
<td>
<p>Boolean. If true, output will not be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing values of various summary statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)
summary_stats(dat=dat)
</code></pre>

<hr>
<h2 id='trim'>Trim data for plotting/reporting</h2><span id='topic+trim'></span>

<h3>Description</h3>

<p>Removes a subset of estimates returned by <code><a href="#topic+est_ce">est_ce</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim(ests, dat, quantiles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trim_+3A_ests">ests</code></td>
<td>
<p>An object of class <code>"vaccine_est"</code> returned by
<code><a href="#topic+est_ce">est_ce</a></code>.</p>
</td></tr>
<tr><td><code id="trim_+3A_dat">dat</code></td>
<td>
<p>The data object originally passed into <code><a href="#topic+est_ce">est_ce</a></code>.</p>
</td></tr>
<tr><td><code id="trim_+3A_quantiles">quantiles</code></td>
<td>
<p>A vector of length 2 representing the quantiles of the
marker distribution at which to trim the data; if, for example,
<code>quantiles=c(0.1,0.9)</code> is specified, values outside the 10
(weighted) quantiles of the marker distribution will be trimmed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified copy of <code>ests</code> with the data trimmed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hvtn505)
dat &lt;- load_data(time="HIVwk28preunblfu", event="HIVwk28preunbl", vacc="trt",
                 marker="IgG_V2", covariates=c("age","BMI","bhvrisk"),
                 weights="wt", ph2="casecontrol", data=hvtn505)

ests_cox &lt;- est_ce(dat=dat, type="Cox", t_0=578)
ests_cox &lt;- trim(ests_cox, dat=dat, quantiles=c(0.1,0.9))
plot_ce(ests_cox, density_type="kde", dat=dat)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
