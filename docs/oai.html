<!DOCTYPE html><html><head><title>Help for package oai</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {oai}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#count_identifiers'><p>Count OAI-PMH identifiers for a data provider.</p></a></li>
<li><a href='#dumpers'><p>Result dumpers</p></a></li>
<li><a href='#get_records'><p>Get records</p></a></li>
<li><a href='#id'><p>Identify the OAI-PMH service for each data provider.</p></a></li>
<li><a href='#list_identifiers'><p>List OAI-PMH identifiers</p></a></li>
<li><a href='#list_metadataformats'><p>List available metadata formats from various providers.</p></a></li>
<li><a href='#list_records'><p>List records</p></a></li>
<li><a href='#list_sets'><p>List sets</p></a></li>
<li><a href='#load_providers'><p>Load an updated cache</p></a></li>
<li><a href='#oai_available'><p>Test of OAI-PMH service is available</p></a></li>
<li><a href='#oai-package'><p>OAI-PMH Client</p></a></li>
<li><a href='#providers'><p>Metadata providers data.frame.</p></a></li>
<li><a href='#update_providers'><p>Update the locally stored OAI-PMH data providers table.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>General Purpose 'Oai-PMH' Services Client</td>
</tr>
<tr>
<td>Description:</td>
<td>A general purpose client to work with any 'OAI-PMH'
    (Open Archives Initiative Protocol for 'Metadata' Harvesting) service.
    The 'OAI-PMH' protocol is described at
    <a href="http://www.openarchives.org/OAI/openarchivesprotocol.html">http://www.openarchives.org/OAI/openarchivesprotocol.html</a>.
    Functions are provided to work with the 'OAI-PMH' verbs: 'GetRecord',
    'Identify', 'ListIdentifiers', 'ListMetadataFormats', 'ListRecords', and
    'ListSets'.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.ropensci.org/oai/">https://docs.ropensci.org/oai/</a>, <a href="https://github.com/ropensci/oai">https://github.com/ropensci/oai</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/oai/issues">https://github.com/ropensci/oai/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>xml2 (&ge; 1.0.0), httr (&ge; 1.2.0), plyr (&ge; 1.8.4), stringr (&ge;
1.1.0), tibble (&ge; 1.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DBI, knitr, RSQLite, testthat, markdown, covr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-10 11:32:01 UTC; mbojan</td>
</tr>
<tr>
<td>Author:</td>
<td>Scott Chamberlain [aut],
  Michal Bojanowski <a href="https://orcid.org/0000-0001-7503-852X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  National Science Centre [fnd] (Supported MB through grant
    2012/07/D/HS6/01971, &lt;https://ncn.gov.pl&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michal Bojanowski &lt;michal2992@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-10 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='count_identifiers'>Count OAI-PMH identifiers for a data provider.</h2><span id='topic+count_identifiers'></span>

<h3>Description</h3>

<p>Count OAI-PMH identifiers for a data provider.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_identifiers(url = "http://export.arxiv.org/oai2", prefix = "oai_dc", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count_identifiers_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="count_identifiers_+3A_prefix">prefix</code></td>
<td>
<p>Specifies the metadata format that the records will be
returned in</p>
</td></tr>
<tr><td><code id="count_identifiers_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that some OAI providers do not include the entry
<code>completeListSize</code>
(<a href="http://www.openarchives.org/OAI/openarchivesprotocol.html#FlowControl">http://www.openarchives.org/OAI/openarchivesprotocol.html#FlowControl</a>)
in which case we return an NA - which does not mean 0, but rather we don't
know.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
count_identifiers()

# curl options
# library("httr")
# count_identifiers(config = verbose())

## End(Not run)
</code></pre>

<hr>
<h2 id='dumpers'>Result dumpers</h2><span id='topic+dumpers'></span><span id='topic+dump_raw_to_txt'></span><span id='topic+dump_to_rds'></span><span id='topic+dump_raw_to_db'></span>

<h3>Description</h3>

<p>Result dumpers are functions allowing to handle the chunks of results from
OAI-PMH service &quot;on the fly&quot;. Handling can include processing, writing to
files, databases etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dump_raw_to_txt(
  res,
  args,
  as,
  file_pattern = "oaidump",
  file_dir = ".",
  file_ext = ".xml"
)

dump_to_rds(
  res,
  args,
  as,
  file_pattern = "oaidump",
  file_dir = ".",
  file_ext = ".rds"
)

dump_raw_to_db(res, args, as, dbcon, table_name, field_name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dumpers_+3A_res">res</code></td>
<td>
<p>results, depends on <code>as</code>, not to be specified by the user</p>
</td></tr>
<tr><td><code id="dumpers_+3A_args">args</code></td>
<td>
<p>list, query arguments, not to be specified by the user</p>
</td></tr>
<tr><td><code id="dumpers_+3A_as">as</code></td>
<td>
<p>character, type of result to return, not to be specified by the
user</p>
</td></tr>
<tr><td><code id="dumpers_+3A_file_pattern">file_pattern</code>, <code id="dumpers_+3A_file_dir">file_dir</code>, <code id="dumpers_+3A_file_ext">file_ext</code></td>
<td>
<p>character respectively: initial part of
the file name, directory name, and file extension used to create file
names. These arguments are passed to <code><a href="base.html#topic+tempfile">tempfile()</a></code> arguments
<code>pattern</code>, <code>tmpdir</code>, and <code>fileext</code> respectively.</p>
</td></tr>
<tr><td><code id="dumpers_+3A_dbcon">dbcon</code></td>
<td>
<p><span class="pkg">DBI</span>-compliant database connection</p>
</td></tr>
<tr><td><code id="dumpers_+3A_table_name">table_name</code></td>
<td>
<p>character, name of the database table to write into</p>
</td></tr>
<tr><td><code id="dumpers_+3A_field_name">field_name</code></td>
<td>
<p>character, name of the field in database table to write
into</p>
</td></tr>
<tr><td><code id="dumpers_+3A_...">...</code></td>
<td>
<p>arguments passed to/from other functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Often the result of a request to a OAI-PMH service are so large that it is
split into chunks that need to be requested separately using
<code>resumptionToken</code>. By default functions like
<code><a href="#topic+list_identifiers">list_identifiers()</a></code> or <code><a href="#topic+list_records">list_records()</a></code> request these
chunks under the hood and return all concatenated in a single R object. It
is convenient but insufficient when dealing with large result sets that
might not fit into RAM. A result dumper is a function that is called on
each result chunk. Dumper functions can write chunks to files or databases,
include initial pre-processing or extraction, and so on.
</p>
<p>A result dumper needs to be function that accepts at least the arguments:
<code>res</code>, <code>args</code>, <code>as</code>. They will get values by the enclosing
function internally. There may be additional arguments, including <code>...</code>.
Dumpers should return <code>NULL</code> or a value that will
be collected and returned by the function calling the dumper (e.g.
<code><a href="#topic+list_records">list_records()</a></code>).
</p>
<p>Currently result dumpers can be used with functions:
<code><a href="#topic+list_identifiers">list_identifiers()</a></code>, <code><a href="#topic+list_records">list_records()</a></code>, and <code><a href="#topic+list_sets">list_sets()</a></code>.
To use a dumper with one of these functions you need to:
</p>

<ul>
<li><p> Pass it as an additional argument <code>dumper</code>
</p>
</li>
<li><p> Pass optional addtional arguments to the dumper function in a list
as the <code>dumper_args</code> argument
</p>
</li></ul>

<p>See Examples. Below we provide more details on the dumpers currently
implemented.
</p>
<p><code>dump_raw_to_txt</code> writes raw XML to text files. It requires
<code>as=="raw"</code>. File names are created using <code><a href="base.html#topic+tempfile">tempfile()</a></code>. By
default they are written in the current working directory and have a format
<code>oaidump*.xml</code> where <code>*</code> is a random string in hex.
</p>
<p><code>dump_to_rds</code> saves results in an <code>.rds</code> file via <code><a href="base.html#topic+saveRDS">saveRDS()</a></code>.
Type of object being saved is determined by the <code>as</code> argument. File names
are generated in the same way as by <code>dump_raw_to_txt</code>, but with default
extension <code>.rds</code>
</p>
<p><code>dump_xml_to_db</code> writes raw XML to a single text column of a table in a
database. Requires <code>as == "raw"</code>. Database connection <code>dbcon</code>
should be a connection object as created by <code><a href="DBI.html#topic+dbConnect">DBI::dbConnect()</a></code> from
package <span class="pkg">DBI</span>. As such, it can connect to any database supported by
<span class="pkg">DBI</span>. The records are written to a field <code>field_name</code> in a table
<code>table_name</code> using <code><a href="DBI.html#topic+dbWriteTable">DBI::dbWriteTable()</a></code>. If the table does not
exist, it is created. If it does, the records are appended. Any additional
arguments are passed to <code><a href="DBI.html#topic+dbWriteTable">DBI::dbWriteTable()</a></code>
</p>


<h3>Value</h3>

<p>Dumpers should return <code>NULL</code> or a value that will be collected
and returned by the function using the dumper.
</p>
<p><code>dump_raw_to_txt</code> returns the name of the created file.
</p>
<p><code>dump_to_rds</code> returns the name of the created file.
</p>
<p><code>dump_xml_to_db</code> returns <code>NULL</code>
</p>


<h3>References</h3>

<p>OAI-PMH specification
<a href="https://www.openarchives.org/OAI/openarchivesprotocol.html">https://www.openarchives.org/OAI/openarchivesprotocol.html</a>
</p>


<h3>See Also</h3>

<p>Functions supporting the dumpers:
<code><a href="#topic+list_identifiers">list_identifiers()</a></code>, <code><a href="#topic+list_sets">list_sets()</a></code>, and <code><a href="#topic+list_records">list_records()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### Dumping raw XML to text files

# This will write a set of XML files to a temporary directory
fnames &lt;- list_identifiers(from="2018-06-01T",
                           until="2018-06-14T",
                           as="raw",
                           dumper=dump_raw_to_txt,
                           dumper_args=list(file_dir=tempdir()))
# vector of file names created
str(fnames)
all( file.exists(fnames) )
# clean-up
unlink(fnames)


### Dumping raw XML to a database

# Connect to in-memory SQLite database
con &lt;- DBI::dbConnect(RSQLite::SQLite(), dbname=":memory:")
# Harvest and dump the results into field "bar" of table "foo"
list_identifiers(from="2018-06-01T",
                 until="2018-06-14T",
                 as="raw",
                 dumper=dump_raw_to_db,
                 dumper_args=list(dbcon=con,
                                  table_name="foo",
                                  field_name="bar") )
# Count records, should be 101
DBI::dbGetQuery(con, "SELECT count(*) as no_records FROM foo")

DBI::dbDisconnect(con)





## End(Not run)
</code></pre>

<hr>
<h2 id='get_records'>Get records</h2><span id='topic+get_records'></span>

<h3>Description</h3>

<p>Get records
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_records(
  ids,
  prefix = "oai_dc",
  url = "http://api.gbif.org/v1/oai-pmh/registry",
  as = "parsed",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_records_+3A_ids">ids</code></td>
<td>
<p>The OAI-PMH identifier for the record. One or more. Required.</p>
</td></tr>
<tr><td><code id="get_records_+3A_prefix">prefix</code></td>
<td>
<p>specifies the metadata format that the records will be
returned in. Default: <code>oai_dc</code></p>
</td></tr>
<tr><td><code id="get_records_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="get_records_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;parsed&quot; (default),
or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="get_records_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are some finite set of results based on the OAI prefix.
We will provide parsers as we have time, and as users express interest.
For prefix types we have parsers for we return a list of data.frame's,
for each identifier, one data.frame for the <code>header</code> bits of data, and
one data.frame for the <code>metadata</code> bits of data.
</p>
<p>For prefixes we don't have parsers for, we fall back to returning raw
XML, so you can at least parse the XML yourself.
</p>
<p>Because some XML nodes are duplicated, we join values together of
duplicated node names, separated by a semicolon (<code style="white-space: pre;">&#8288;;&#8288;</code>) with no
spaces. You can seprarate them yourself easily.
</p>


<h3>Value</h3>

<p>a named list of data.frame's, or lists, or raw text
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
get_records("87832186-00ea-44dd-a6bf-c2896c4d09b4")

ids &lt;- c("87832186-00ea-44dd-a6bf-c2896c4d09b4", 
  "d981c07d-bc43-40a2-be1f-e786e25106ac")
(res &lt;- get_records(ids))
lapply(res, "[[", "header")
lapply(res, "[[", "metadata")
do.call(rbind, lapply(res, "[[", "header"))
do.call(rbind, lapply(res, "[[", "metadata"))

# Get raw text
get_records("d981c07d-bc43-40a2-be1f-e786e25106ac", as = "raw")

# from arxiv.org
get_records("oai:arXiv.org:0704.0001", url = "http://export.arxiv.org/oai2")

## End(Not run)
</code></pre>

<hr>
<h2 id='id'>Identify the OAI-PMH service for each data provider.</h2><span id='topic+id'></span>

<h3>Description</h3>

<p>Identify the OAI-PMH service for each data provider.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id(url, as = "parsed", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="id_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="id_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;parsed&quot; (default),
or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="id_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# arxiv
id("http://export.arxiv.org/oai2")

# GBIF - http://www.gbif.org/
id("http://api.gbif.org/v1/oai-pmh/registry")

# get back text instead of parsed
id("http://export.arxiv.org/oai2", as = "raw")
id("http://api.gbif.org/v1/oai-pmh/registry", as = "raw")

# curl options
library("httr")
id("http://export.arxiv.org/oai2", config = verbose())

## End(Not run)
</code></pre>

<hr>
<h2 id='list_identifiers'>List OAI-PMH identifiers</h2><span id='topic+list_identifiers'></span>

<h3>Description</h3>

<p>List OAI-PMH identifiers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_identifiers(
  url = "http://api.gbif.org/v1/oai-pmh/registry",
  prefix = "oai_dc",
  from = NULL,
  until = NULL,
  set = NULL,
  token = NULL,
  as = "df",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_identifiers_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_prefix">prefix</code></td>
<td>
<p>Specifies the metadata format that the records will be
returned in.</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_from">from</code></td>
<td>
<p>specifies that records returned must have been
created/update/deleted on or after this date.</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_until">until</code></td>
<td>
<p>specifies that records returned must have been
created/update/deleted on or before this date.</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_set">set</code></td>
<td>
<p>specifies the set that returned records must belong to.</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_token">token</code></td>
<td>
<p>a token previously provided by the server to resume a request
where it last left off.</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="list_identifiers_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# from
recently &lt;- format(Sys.Date() - 1, "%Y-%m-%d")
list_identifiers(from = recently)

# from and until
list_identifiers(from = '2018-06-01T', until = '2018-06-14T')

# set parameter - here, using ANDS - Australian National Data Service
list_identifiers(from = '2018-09-01T', until = '2018-09-05T',
  set = "dataset_type:CHECKLIST")

## End(Not run)
</code></pre>

<hr>
<h2 id='list_metadataformats'>List available metadata formats from various providers.</h2><span id='topic+list_metadataformats'></span>

<h3>Description</h3>

<p>List available metadata formats from various providers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_metadataformats(
  url = "http://api.gbif.org/v1/oai-pmh/registry",
  id = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_metadataformats_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="list_metadataformats_+3A_id">id</code></td>
<td>
<p>The OAI-PMH identifier for the record. Optional.</p>
</td></tr>
<tr><td><code id="list_metadataformats_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
list_metadataformats()

# no metadatformats for an identifier
list_metadataformats(id = "9da8a65a-1b9b-487c-a564-d184a91a2705")

# metadatformats available for an identifier
list_metadataformats(id = "ad7295e0-3261-4028-8308-b2047d51d408")

## End(Not run)
</code></pre>

<hr>
<h2 id='list_records'>List records</h2><span id='topic+list_records'></span>

<h3>Description</h3>

<p>List records
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_records(
  url = "http://api.gbif.org/v1/oai-pmh/registry",
  prefix = "oai_dc",
  from = NULL,
  until = NULL,
  set = NULL,
  token = NULL,
  as = "df",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_records_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="list_records_+3A_prefix">prefix</code></td>
<td>
<p>specifies the metadata format that the records will be
returned in. Default: <code>oai_dc</code></p>
</td></tr>
<tr><td><code id="list_records_+3A_from">from</code></td>
<td>
<p>specifies that records returned must have been
created/update/deleted on or after this date.</p>
</td></tr>
<tr><td><code id="list_records_+3A_until">until</code></td>
<td>
<p>specifies that records returned must have been
created/update/deleted on or before this date.</p>
</td></tr>
<tr><td><code id="list_records_+3A_set">set</code></td>
<td>
<p>specifies the set that returned records must belong to.</p>
</td></tr>
<tr><td><code id="list_records_+3A_token">token</code></td>
<td>
<p>(character) a token previously provided by the server to
resume a request where it last left off. 50 is max number of records
returned. We will loop for you internally to get all the records you
asked for.</p>
</td></tr>
<tr><td><code id="list_records_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="list_records_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# By default you get back a single data.frame
list_records(from = '2018-05-01T00:00:00Z', until = '2018-05-03T00:00:00Z')
list_records(from = '2018-05-01T', until = '2018-05-04T')

# Get a list
list_records(from = '2018-05-01T', until = '2018-05-04T', as = "list")

# Get raw text
list_records(from = '2018-05-01T', until = '2018-05-04T', as = "raw")
list_records(from = '2018-05-01T', until = '2018-05-04T', as = "raw")

# Use a resumption token
# list_records(token =
#  "1443799900201,2015-09-01T00:00:00Z,2015-10-01T23:59:59Z,50,null,oai_dc")

## End(Not run)
</code></pre>

<hr>
<h2 id='list_sets'>List sets</h2><span id='topic+list_sets'></span>

<h3>Description</h3>

<p>List sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_sets(
  url = "http://api.gbif.org/v1/oai-pmh/registry",
  token = NULL,
  as = "df",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_sets_+3A_url">url</code></td>
<td>
<p>(character) OAI-PMH base url. Defaults to the URL for
arXiv's OAI-PMH server (http://export.arxiv.org/oai2)
or GBIF's OAI-PMH server (http://api.gbif.org/v1/oai-pmh/registry)</p>
</td></tr>
<tr><td><code id="list_sets_+3A_token">token</code></td>
<td>
<p>(character) a token previously provided by the server to
resume a request where it last left off</p>
</td></tr>
<tr><td><code id="list_sets_+3A_as">as</code></td>
<td>
<p>(character) What to return. One of &quot;df&quot; (for data.frame; default),
&quot;list&quot;, or &quot;raw&quot; (raw text)</p>
</td></tr>
<tr><td><code id="list_sets_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">GET</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get back a data.frame
list_sets()

# Get back a list
list_sets(as = "list")

# Get back raw text
list_sets(as = "raw")

# curl options
library("httr")
list_sets(config = verbose())

## End(Not run)
</code></pre>

<hr>
<h2 id='load_providers'>Load an updated cache</h2><span id='topic+load_providers'></span>

<h3>Description</h3>

<p>Load an updated cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_providers(path = NULL, envir = .GlobalEnv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_providers_+3A_path">path</code></td>
<td>
<p>location where cache is located. Leaving to NULL loads
the version in the installed package</p>
</td></tr>
<tr><td><code id="load_providers_+3A_envir">envir</code></td>
<td>
<p>R environment to load data in to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loads the data object providers into the global workspace.
</p>


<h3>Value</h3>

<p>loads the object providers into the working space.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+update_providers">update_providers()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# By default the new providers table goes to directory ".", so just
# load from there
update_providers()
load_providers(path=".")

# Loads the version in the package
load_providers()

## End(Not run)
</code></pre>

<hr>
<h2 id='oai_available'>Test of OAI-PMH service is available</h2><span id='topic+oai_available'></span>

<h3>Description</h3>

<p>Silently test if OAI-PMH service is available under the URL provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oai_available(u, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oai_available_+3A_u">u</code></td>
<td>
<p>base URL to OAI-PMH service</p>
</td></tr>
<tr><td><code id="oai_available_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="#topic+id">id()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code> if the service is available.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
url_list &lt;- list(
  archivesic="http://archivesic.ccsd.cnrs.fr/oai/oai.php",
  datacite = "http://oai.datacite.org/oai",

  # No OAI-PMH here
  google = "http://google.com"
)

sapply(url_list, oai_available)

## End(Not run)
</code></pre>

<hr>
<h2 id='oai-package'>OAI-PMH Client</h2><span id='topic+oai-package'></span><span id='topic+_PACKAGE'></span><span id='topic+oai'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p><span class="pkg">oai</span> is an R client to work with OAI-PMH (Open Archives
Initiative Protocol for Metadata Harvesting) services, a protocol
developed by the Open Archives Initiative
(https://en.wikipedia.org/wiki/Open_Archives_Initiative).
OAI-PMH uses XML data format transported over HTTP.
</p>


<h3>OAI-PMH Info</h3>

<p>See the OAI-PMH V2 specification at
<a href="http://www.openarchives.org/OAI/openarchivesprotocol.html">http://www.openarchives.org/OAI/openarchivesprotocol.html</a>
</p>


<h3>Implementation details</h3>

<p>oai is built on <span class="pkg">xml2</span> and <span class="pkg">httr</span>. In addition, we give back
data.frame's whenever possible to make data comprehension, manipulation,
and visualization easier. We also have functions to fetch a large directory
of OAI-PMH services - it isn't exhaustive, but does contain a lot.
</p>


<h3>Paging</h3>

<p>Instead of paging with e.g., <code>page</code> and <code>per_page</code> parameters,
OAI-PMH uses (optionally) <code>resumptionTokens</code>, with an optional
expiration date. These tokens can be used to continue on to the next chunk
of data, if the first request did not get to the end. Often, OAI-PMH
services limit each request to 50 records, but this may vary by provider,
I don't know for sure. The API of this package is such that we <code>while</code>
loop for you internally until we get all records. We may in the future
expose e.g., a <code>limit</code> parameter so you can say how many records
you want, but we haven't done this yet.
</p>


<h3>Acknowledgements</h3>

<p>Michal Bojanowski contributions were supported by (Polish) National Science
Center (NCN) through grant 2012/07/D/HS6/01971.
</p>


<h3>Author(s)</h3>

<p>Scott Chamberlain <a href="mailto:myrmecocystus@gmail.com">myrmecocystus@gmail.com</a>
</p>
<p>Michal Bojanowski <a href="mailto:michal2992@gmail.com">michal2992@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.ropensci.org/oai/">https://docs.ropensci.org/oai/</a>
</p>
</li>
<li> <p><a href="https://github.com/ropensci/oai">https://github.com/ropensci/oai</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/oai/issues">https://github.com/ropensci/oai/issues</a>
</p>
</li></ul>


<hr>
<h2 id='providers'>Metadata providers data.frame.</h2><span id='topic+providers'></span>

<h3>Description</h3>

<p>Metadata providers data.frame.
</p>


<h3>Value</h3>

<p>A data.frame of three columns:
</p>

<ul>
<li><p> repo_name - Name of the OAI repository
</p>
</li>
<li><p> base_url - Base URL of the OAI repository
</p>
</li>
<li><p> oai_identifier - OAI identifier for the OAI repository
</p>
</li></ul>


<hr>
<h2 id='update_providers'>Update the locally stored OAI-PMH data providers table.</h2><span id='topic+update_providers'></span>

<h3>Description</h3>

<p>Data comes from
<a href="http://www.openarchives.org/Register/BrowseSites">http://www.openarchives.org/Register/BrowseSites</a>. It includes the
oai-identifier (if they have one) and the base URL. The website has
the name of the data provider too, but not provided in the data pulled
down here, but you can grab the name using the example below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_providers(path = ".", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_providers_+3A_path">path</code></td>
<td>
<p>Path to put data in.</p>
</td></tr>
<tr><td><code id="update_providers_+3A_...">...</code></td>
<td>
<p>Curl options passed on to <code><a href="httr.html#topic+GET">httr::GET()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This table is scraped from
<a href="http://www.openarchives.org/Register/BrowseSites">http://www.openarchives.org/Register/BrowseSites</a>.
I would get it from <a href="http://www.openarchives.org/pmh/registry/ListFriends">http://www.openarchives.org/pmh/registry/ListFriends</a>,
but it does not include repository names.
</p>
<p>This function updates the table for you. Does take a while though, so
go get a coffee.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+load_providers">load_providers()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
update_providers()
load_providers()

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
