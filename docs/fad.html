<!DOCTYPE html><html><head><title>Help for package fad</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fad}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fad'><p>Factor Analysis for data (high or low dimensional).</p></a></li>
<li><a href='#fads'><p>Factor Analysis for data on a sphere (high or low dimensional).</p></a></li>
<li><a href='#print.fad'><p>Print the Output of Factor Analysis</p></a></li>
<li><a href='#print.fads'><p>Print the Output of Factor Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Factor Analysis for Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-27</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Somak Dutta &lt;somakd@iastate.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Compute maximum likelihood estimators of parameters in a Gaussian factor model using
  the the matrix-free methodology described in Dai et al. (2020) &lt;<a href="https://doi.org/10.1080%2F10618600.2019.1704296">doi:10.1080/10618600.2019.1704296</a>&gt;.
  In contrast to the factanal() function from 'stats' package, fad() can handle high-dimensional datasets where
  number of variables exceed the sample size and is also substantially faster than the EM algorithms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/somakd/fad">https://github.com/somakd/fad</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/somakd/fad/issues">https://github.com/somakd/fad/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), methods, RSpectra (&ge; 0.16-1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix (&ge; 1.1-0), Rcpp (&ge; 0.11.5)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RSpectra, RcppEigen</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-01 03:39:04 UTC; somakd</td>
</tr>
<tr>
<td>Author:</td>
<td>Somak Dutta [aut, cre],
  Fan Dai [aut],
  Ranjan Maitra [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-01 14:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='fad'>Factor Analysis for data (high or low dimensional).</h2><span id='topic+fad'></span>

<h3>Description</h3>

<p>Perform fast matrix-free maximum-likelihood factor analysis on a
covariance matrix or data matrix, works if number of variables is more than
number of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fad(
  x,
  factors,
  data = NULL,
  covmat = NULL,
  n.obs = NA,
  subset,
  na.action,
  start = NULL,
  scores = c("none", "regression", "Bartlett"),
  rotation = "varimax",
  control = NULL,
  lower = 0.005,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fad_+3A_x">x</code></td>
<td>
<p>A formula or a numeric matrix or an object that can be coerced to a
numeric matrix.</p>
</td></tr>
<tr><td><code id="fad_+3A_factors">factors</code></td>
<td>
<p>The number of factors to be fitted.</p>
</td></tr>
<tr><td><code id="fad_+3A_data">data</code></td>
<td>
<p>An optional data frame (or similar: see <code><a href="stats.html#topic+model.frame">model.frame</a></code>),
used only if <code>x</code> is a formula.  By default the variables are taken
from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="fad_+3A_covmat">covmat</code></td>
<td>
<p>A covariance matrix, or a covariance list as returned by
<code><a href="stats.html#topic+cov.wt">cov.wt</a></code>. Of course, correlation matrices are covariance
matrices.</p>
</td></tr>
<tr><td><code id="fad_+3A_n.obs">n.obs</code></td>
<td>
<p>The number of observations, used if <code>covmat</code> is a
covariance matrix.</p>
</td></tr>
<tr><td><code id="fad_+3A_subset">subset</code></td>
<td>
<p>A specification of the cases to be used, if <code>x</code> is used as
a matrix or formula.</p>
</td></tr>
<tr><td><code id="fad_+3A_na.action">na.action</code></td>
<td>
<p>The <code>na.action</code> to be used if <code>x</code> is used as a
formula.</p>
</td></tr>
<tr><td><code id="fad_+3A_start">start</code></td>
<td>
<p><code>NULL</code> or a matrix of starting values, each column giving
an initial set of uniquenesses.</p>
</td></tr>
<tr><td><code id="fad_+3A_scores">scores</code></td>
<td>
<p>Type of scores to produce, if any.  The default is none,
<code>"regression"</code> gives Thompson's scores, <code>"Bartlett"</code> given
Bartlett's weighted least-squares scores. Partial matching allows these
names to be abbreviated. Also note that some of the scores-types are not
applicable when <code>p &gt; n</code>.</p>
</td></tr>
<tr><td><code id="fad_+3A_rotation">rotation</code></td>
<td>
<p>character. <code>"none"</code> or the name of a function to be used
to rotate the factors: it will be called with first argument the loadings
matrix, and should return a list with component <code>loadings</code> giving the
rotated loadings, or just the rotated loadings. The options included in the package are:
<code>varimax</code>, <code>promax</code>, <code>quartimax</code>, <code>equamax</code>.</p>
</td></tr>
<tr><td><code id="fad_+3A_control">control</code></td>
<td>
<p>A list of control values:
</p>

<dl>
<dt>nstart</dt><dd><p>The number of starting values to be tried if <code>start = NULL</code>. Default 1.</p>
</dd>
<dt>trace</dt><dd><p>logical. Output tracing information? Default <code>FALSE</code>.</p>
</dd>
<dt>opt</dt><dd><p>A list of control values to be passed to <code><a href="stats.html#topic+optim">optim</a></code>'s
<code>control</code> argument.</p>
</dd>
<dt>rotate</dt><dd><p>a list of additional arguments for the rotation function.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="fad_+3A_lower">lower</code></td>
<td>
<p>The lower bound for uniquenesses during optimization. Should be &gt; 0. Default 0.005.</p>
</td></tr>
<tr><td><code id="fad_+3A_...">...</code></td>
<td>
<p>Components of <code>control</code> can also be supplied as named arguments to <code>fad</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"fad"</code> with components
</p>
<table>
<tr><td><code>loadings</code></td>
<td>
<p>A matrix of loadings on the correlation scale, one column for each factor.  The
factors are ordered in decreasing order of sums of squares of
loadings, and given the sign that will make the sum of the loadings
positive.  This is of class <code>"loadings"</code></p>
</td></tr>
<tr><td><code>uniquenesses</code></td>
<td>
<p>The uniquenesses computed on the correlation scale.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The estimated standard deviations.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>The results of the optimization: the value of the
criterion (a linear function of the negative log-likelihood) and information
on the iterations used.</p>
</td></tr>
<tr><td><code>factors</code></td>
<td>
<p>The argument <code>factors</code>.</p>
</td></tr>
<tr><td><code>dof</code></td>
<td>
<p>The number of degrees of freedom of the factor analysis model.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method: always <code>"mle"</code>.</p>
</td></tr>
<tr><td><code>rotmat</code></td>
<td>
<p>The rotation matrix if relevant.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>If requested, a matrix of scores.  <code>napredict</code> is
applied to handle the treatment of values omitted by the <code>na.action</code>.</p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>The number of observations if available, or <code>NA</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>If relevant.</p>
</td></tr>
<tr><td><code>loglik</code>, <code>BIC</code></td>
<td>
<p>The maximum log-likelihood and the Bayesian Information Criteria.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+factanal">factanal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)

## Simulate a 200 x 3 loadings matrix ~i.i.d N(0,1)
L &lt;- matrix(rnorm(200*3),200,3) 

## Simulate the uniquenesses i.i.d U(0.2,0.9)
D &lt;- runif(200,0.2,0.9) 

## Generate a data matrix of size 50 x 200 with rows
## ~i.i.d. N(0,LL'+diag(D))
X &lt;- tcrossprod(matrix(rnorm(50*3),50,3),L) + matrix(rnorm(50*200),50,200) %*% diag(sqrt(D))

## Fit a factor model with 3 factors:
fit = fad(X,3)


## Print the loadings:
print(fit$loadings)

</code></pre>

<hr>
<h2 id='fads'>Factor Analysis for data on a sphere (high or low dimensional).</h2><span id='topic+fads'></span>

<h3>Description</h3>

<p>Perform fast matrix-free maximum-likelihood factor analysis on
data on sphere, works if number of variables is more than number of 
observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fads(
  inputs,
  q,
  ii = 123,
  M = NULL,
  L = NULL,
  D = NULL,
  gamma = NA,
  maxiter = 10000,
  epsi = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fads_+3A_inputs">inputs</code></td>
<td>
<p>A numeric matrix or an object that can be coerced to a
numeric matrix.</p>
</td></tr>
<tr><td><code id="fads_+3A_q">q</code></td>
<td>
<p>The number of factors to be fitted.</p>
</td></tr>
<tr><td><code id="fads_+3A_ii">ii</code></td>
<td>
<p>The random seeds for initialization. Default 123 if no initial 
values of parameters are imported.</p>
</td></tr>
<tr><td><code id="fads_+3A_m">M</code></td>
<td>
<p>The initial values of mean.</p>
</td></tr>
<tr><td><code id="fads_+3A_l">L</code></td>
<td>
<p>The initial values of loading matrix.</p>
</td></tr>
<tr><td><code id="fads_+3A_d">D</code></td>
<td>
<p>The initial values of uniquenesses.</p>
</td></tr>
<tr><td><code id="fads_+3A_gamma">gamma</code></td>
<td>
<p>The common constant used in the eBIC formula. Default 'NA'.</p>
</td></tr>
<tr><td><code id="fads_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum iterations. Default 10,000</p>
</td></tr>
<tr><td><code id="fads_+3A_epsi">epsi</code></td>
<td>
<p>The absolute difference between final data log-likelihood values
on consecutive step. Default 0.0001.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"fads"</code> with components
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>The estimate mean.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>A matrix of loadings on the correlation scale, one column for each factor.  The
factors are ordered in decreasing order of sums of squares of
loadings, and given the sign that will make the sum of the loadings
positive.This is of class <code>"loadings"</code></p>
</td></tr>
<tr><td><code>uniquenesses</code></td>
<td>
<p>The uniquenesses computed on the correlation scale.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The estimated standard deviations.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>The number of iterations</p>
</td></tr>
<tr><td><code>gerr</code></td>
<td>
<p>the difference between the gradients on consecutive step.</p>
</td></tr>
<tr><td><code>loglik</code>, <code>eBIC</code></td>
<td>
<p>The maximum log-likelihood the extended Bayesian 
Information Criteria (Chen and Chen,2008).</p>
</td></tr>
</table>

<hr>
<h2 id='print.fad'>Print the Output of Factor Analysis</h2><span id='topic+print.fad'></span>

<h3>Description</h3>

<p>Prints the output of the <code>fad</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fad'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fad_+3A_x">x</code></td>
<td>
<p>an object of class <code>fad</code>.</p>
</td></tr>
<tr><td><code id="print.fad_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use in printing uniquenesses and loadings.</p>
</td></tr>
<tr><td><code id="print.fad_+3A_...">...</code></td>
<td>
<p>further arguments to <code>print</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='print.fads'>Print the Output of Factor Analysis</h2><span id='topic+print.fads'></span>

<h3>Description</h3>

<p>Prints the output of the <code>fads</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fads'
print(x, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fads_+3A_x">x</code></td>
<td>
<p>an object of class <code>fads</code>.</p>
</td></tr>
<tr><td><code id="print.fads_+3A_digits">digits</code></td>
<td>
<p>number of decimal places to use in printing uniquenesses and loadings.</p>
</td></tr>
<tr><td><code id="print.fads_+3A_...">...</code></td>
<td>
<p>further arguments to <code>print</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
