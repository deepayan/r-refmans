<!DOCTYPE html><html lang="en"><head><title>Help for package cercospoRa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cercospoRa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc_c_closure'><p>Calculate canopy closure date</p></a></li>
<li><a href='#calc_DIV'><p>Calculate daily infection values</p></a></li>
<li><a href='#calc_epidemic_onset'><p>Calculate epidemic onset</p></a></li>
<li><a href='#calc_epidemic_onset_from_image'><p>Calculate epidemic onset from image</p></a></li>
<li><a href='#calc_r_x0'><p>Calculate growth rate and LAI at t0</p></a></li>
<li><a href='#format_weather'><p>Format weather data into a standardised format.</p></a></li>
<li><a href='#latent_period'><p>Calculate Cercospora Latent Period</p></a></li>
<li><a href='#read_sb_growth_parameter'><p>Read LAI images at several time points</p></a></li>
<li><a href='#temperature_index'><p>Get temperature index</p></a></li>
<li><a href='#weathr'><p>Weather station data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Process Based Epidemiological Model for Cercospora Leaf Spot of
Sugar Beet</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates sugar beet canopy closure with remotely sensed leaf area
    index and estimates when action might be needed to protect the crop from a 
    Leaf Spot epidemic with a negative prognosis model based on published 
    models.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), remotes, stats,
spelling</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, lubridate, sf, terra, minpack.lm, circular</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://paul.melloy.com.au/cercospoRa/">https://paul.melloy.com.au/cercospoRa/</a>,
<a href="https://github.com/PaulMelloy/cercospoRa">https://github.com/PaulMelloy/cercospoRa</a>,
<a href="http://paul.melloy.com.au/cercospoRa/">http://paul.melloy.com.au/cercospoRa/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/PaulMelloy/cercospoRa/issues">https://github.com/PaulMelloy/cercospoRa/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 10:11:12 UTC; paul</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Melloy <a href="https://orcid.org/0000-0003-4253-7167"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, trl, cph] (Translated equations from literature and developed
    package.),
  Rene Heim <a href="https://orcid.org/0000-0002-0666-2588"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph] (Code review and development of leaf area index model),
  Nathan Okole <a href="https://orcid.org/0000-0002-5375-2420"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb, cph] (Code review and development of leaf area index
    model),
  Facundo Ramón Ispizua Yamati
    <a href="https://orcid.org/0000-0001-5775-3554"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [dtc, ctb]
    (Code review),
  Anne-Katrin Mahlein
    <a href="https://orcid.org/0000-0003-1091-3690"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Melloy &lt;paul@melloy.com.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-13 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc_c_closure'>Calculate canopy closure date</h2><span id='topic+calc_c_closure'></span>

<h3>Description</h3>

<p>Calculate canopy closure date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_c_closure(param_rxt, x1 = 1.3, k = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_c_closure_+3A_param_rxt">param_rxt</code></td>
<td>
<p>Output of the function <a href="#topic+calc_r_x0">calc_r_x0</a>, which produces a
list containing parameters that are necessary to calculate <code>c_closure</code>.
These parameters are <code>r</code>, the growth rate, <code>x0</code>, the initial LAI
value, and <code>t0</code>, the initial date and the associated dates</p>
</td></tr>
<tr><td><code id="calc_c_closure_+3A_x1">x1</code></td>
<td>
<p>LAI value at which 90% canopy closure is reached. It is fixed to
1.3 for sugar beet.</p>
</td></tr>
<tr><td><code id="calc_c_closure_+3A_k">k</code></td>
<td>
<p>carrying capacity, which is the maximum LAI that can be attained.
This value can be cultivar-dependent. The default is fixed to 6</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates canopy closure dates from LAI and growth rate parameters
</p>


<h3>Value</h3>

<p><code>c_closure</code> date at which 90% canopy closure is reached at each
location.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img_dir &lt;- system.file("extdata", "uav_img",package = "cercospoRa")
epidemic_onset_param &lt;-
  read_sb_growth_parameter(img_files = list.files(img_dir,pattern = "tif",
                                                  full.names = TRUE),
                           img_dates = as.POSIXct(
                             c("2022-06-14","2022-06-28"),tz = "UTC"),
                           target_res = 10)
param_rxt &lt;- calc_r_x0(epidemic_onset_param,
                       min_r = 0.02,
                       max_r = 0.05,
                       k = 6)
c_closure &lt;- calc_c_closure(param_rxt,
                            x1 = 1.3,
                            k=6 )
</code></pre>

<hr>
<h2 id='calc_DIV'>Calculate daily infection values</h2><span id='topic+calc_DIV'></span>

<h3>Description</h3>

<p>This function calculates the daily infection values for <em>Cercospora beticola</em>
on sugar beet. Functions were adapted from Wolf and Verreet (2005)
and Wolf et al (2001)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_DIV(date_time, Tm, RH, rain, dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_DIV_+3A_date_time">date_time</code></td>
<td>
<p>POSIX_ct, date time the weather recording was taken</p>
</td></tr>
<tr><td><code id="calc_DIV_+3A_tm">Tm</code></td>
<td>
<p>numeric, temperature, in Celsius' at time increment in
<code>date_time</code></p>
</td></tr>
<tr><td><code id="calc_DIV_+3A_rh">RH</code></td>
<td>
<p>numeric, relative humidity (%) at time increment in <code>date_time</code></p>
</td></tr>
<tr><td><code id="calc_DIV_+3A_rain">rain</code></td>
<td>
<p>numeric, volume of rain in millimetres recorded between time recordings</p>
</td></tr>
<tr><td><code id="calc_DIV_+3A_dat">dat</code></td>
<td>
<p>data.frame, containing column names &quot;times&quot;,&quot;temp&quot;,&quot;rh&quot;,&quot;rain&quot; with
each of the respective arguments for input. provided as a convenience</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table, with probability of infection for each day, between 0 and 1
Undertaken with two methods by Wolf and Verreet (2005)
</p>


<h3>References</h3>

<p>Wolf, P. F. J., and J. A. Verreet. “Factors Affecting the Onset of Cercospora
Leaf Spot Epidemics in Sugar Beet and Establishment of Disease-Monitoring
Thresholds.” <em>Phytopathology®</em> 95, no. 3 (March 2005): 269–74.
https://doi.org/10.1094/PHYTO-95-0269.
</p>
<p>Wolf, P. F. J., M. Heindl, and J. A. Verreet. “Influence of Sugar Beet Leaf Mass
Development on Predisposition of the Crop to Cercospora Beticola (Sacc.).”
<em>Journal of Plant Diseases and Protection</em> 108, no. 6 (2001): 578–92.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date_t &lt;- Sys.time() + seq(0, 179 * 60 * 10, (60 * 10))
Tm &lt;- rnorm(180,20,10)
RH &lt;- runif(180,min = 40,90)
rain &lt;- rbinom(180,1,0.1) * runif(180,0.1,20)

DIV1 &lt;- calc_DIV(
date_time = date_t,
Tm = Tm,
RH = RH,
rain = rain
)
</code></pre>

<hr>
<h2 id='calc_epidemic_onset'>Calculate epidemic onset</h2><span id='topic+calc_epidemic_onset'></span>

<h3>Description</h3>

<p>Calculate epidemic onset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_epidemic_onset(start, end, c_closure, weather, cultivar_sus = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_epidemic_onset_+3A_start">start</code></td>
<td>
<p>POSIXct, start date in which to begin calculating the epidemic
onset, if not specified, the first date in the weather data will be used.</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_+3A_end">end</code></td>
<td>
<p>POSIXct, end date, last date to complete calculating the epidemic
onset, if not specified, the last date in the weather data will be used.</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_+3A_c_closure">c_closure</code></td>
<td>
<p>POSIXct formatted date to start the model running the model
This is usually at canopy closure (Wolf)</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_+3A_weather">weather</code></td>
<td>
<p>data.table, formatted with <code><a href="#topic+format_weather">format_weather</a></code></p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_+3A_cultivar_sus">cultivar_sus</code></td>
<td>
<p>character, susceptibility of the cultivar in &quot;R&quot; resistant,
&quot;S&quot; susceptible, &quot;MR&quot; moderately resistant etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the input weather is conducive for epidemic, the
function returns a POSIX_ct date when epidemic commences. If no epidemic
occurs, a numeric, proportion indicating the progress an epidemic is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wethr &lt;- read.csv(system.file("extdata", "clean_weather.csv",
                  package = "cercospoRa"))
wethr &lt;- format_weather(wethr,time_zone = "UTC")

calc_epidemic_onset(start = as.POSIXct("2022-04-25",tz = "UTC"),
                    end = as.POSIXct("2022-09-30",tz = "UTC"),
                    c_closure = as.POSIXct("2022-07-01",tz = "UTC"),
                    weather = wethr)
</code></pre>

<hr>
<h2 id='calc_epidemic_onset_from_image'>Calculate epidemic onset from image</h2><span id='topic+calc_epidemic_onset_from_image'></span>

<h3>Description</h3>

<p>Calculate epidemic onset from image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_epidemic_onset_from_image(
  start,
  end,
  c_closure,
  weather,
  cultivar_sus = 5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_epidemic_onset_from_image_+3A_start">start</code></td>
<td>
<p>POSIXct, start date in which to begin calculating the epidemic
onset, if not specified, the first date in the weather data will be used.</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_from_image_+3A_end">end</code></td>
<td>
<p>POSIXct, end date, last date to complete calculating the epidemic
onset, if not specified, the last date in the weather data will be used.</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_from_image_+3A_c_closure">c_closure</code></td>
<td>
<p>map of canopy closure dates formatted as number of days since
1970-01-01. It defines the date to start running the model (Wolf)</p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_from_image_+3A_weather">weather</code></td>
<td>
<p>data.table, formatted with <code><a href="#topic+format_weather">format_weather</a></code></p>
</td></tr>
<tr><td><code id="calc_epidemic_onset_from_image_+3A_cultivar_sus">cultivar_sus</code></td>
<td>
<p>character, susceptibility of the cultivar in &quot;R&quot; resistant,
&quot;S&quot; susceptible, &quot;MR&quot; moderately resistant etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the input weather is conducive for epidemic, the function returns a
POSIX_ct date when epidemic commences. If no epidemic occurs, a numeric,
proportion indicating the progress an epidemic is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wethr &lt;- read.csv(system.file("extdata", "clean_weather.csv",
                  package = "cercospoRa"))
wethr &lt;- format_weather(wethr,time_zone = "UTC")

img_dir &lt;- system.file("extdata", "uav_img",package = "cercospoRa")

epidemic_onset_param &lt;-
   read_sb_growth_parameter(
      list.files(img_dir,pattern = "tif",
                 full.names = TRUE),
      img_dates = as.POSIXct(c("2022-06-14","2022-06-28"),
                             tz = "UTC"),
      10)
param_rxt &lt;- calc_r_x0(epidemic_onset_param,
                       min_r = 0.02,
                       max_r = 0.05,
                       k = 6)
c_closure &lt;- calc_c_closure(param_rxt,
                            x1 = 1.3,
                            k=6 )
 # this takes about 20 sec to run
epidemic_onset_map &lt;- calc_epidemic_onset_from_image(start = as.POSIXct("2022-04-25",tz = "UTC"),
                                                     end = as.POSIXct("2022-09-30",tz = "UTC"),
                                                     c_closure = c_closure,
                                                     weather = wethr)

terra::plot(epidemic_onset_map)

</code></pre>

<hr>
<h2 id='calc_r_x0'>Calculate growth rate and LAI at t0</h2><span id='topic+calc_r_x0'></span>

<h3>Description</h3>

<p>Calculate growth rate and LAI at t0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_r_x0(param_r, min_r = 0.02, max_r = 0.05, k = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_r_x0_+3A_param_r">param_r</code></td>
<td>
<p>Output of the function <a href="#topic+read_sb_growth_parameter">read_sb_growth_parameter</a>,
which produces a list containing the LAI images and the associated dates</p>
</td></tr>
<tr><td><code id="calc_r_x0_+3A_min_r">min_r</code></td>
<td>
<p>minimum growth rate for sugar beet. Default <code>min_r</code> is fixed
to 0.02 to ensure that the growth rate at the inflection point of the sigmoid
is at least 1 unit of LAI per month.</p>
</td></tr>
<tr><td><code id="calc_r_x0_+3A_max_r">max_r</code></td>
<td>
<p>maximum growth rate for sugar beet. Default <code>max_r</code> is fixed
to 0.05 to ensure that the growth rate at the inflection point of the sigmoid
is at most 2.5 units of LAI per month.</p>
</td></tr>
<tr><td><code id="calc_r_x0_+3A_k">k</code></td>
<td>
<p>carrying capacity, which is the maximum LAI that can be attained.
This value can be cultivar-dependent. The default is fixed to 6</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits a non-linear model to remotely sensed LAI values and estimates the leaf
area index (LAI) and growth rate <em>r</em> at the start of the time window <em>t0</em>.
</p>


<h3>Value</h3>

<p>param_rxt: list containing parameters that are necessary to calculate
<code>c_closure</code>. These parameters are <code>r</code>, the growth rate, <code>x0</code>,
the initial LAI value, and <code>t0</code>, the initial date.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>img_dir &lt;- system.file("extdata", "uav_img",package = "cercospoRa")
epidemic_onset_param &lt;-
  read_sb_growth_parameter(img_files = list.files(img_dir,pattern = "tif",
                                                  full.names = TRUE),
                           img_dates = as.POSIXct(
                             c("2022-06-14","2022-06-28"),tz = "UTC"),
                           target_res = 10)
param_rxt &lt;- calc_r_x0(epidemic_onset_param,
                       min_r = 0.02,
                       max_r = 0.05,
                       k = 6)
</code></pre>

<hr>
<h2 id='format_weather'>Format weather data into a standardised format.</h2><span id='topic+format_weather'></span>

<h3>Description</h3>

<p>Formats raw weather data into an object suitable for use in the affiliated
spore dispersal packages such as <code>ascotraceR</code> and <code>blackspot.sp</code>. This
standardised data format ensures that the supplied weather data meet the
requirements for functions in the aforementioned packages. Input weather
data expects a 'long' data format, where each line is an observation at
a point in time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_weather(
  w,
  YYYY = NULL,
  MM = NULL,
  DD = NULL,
  hh = NULL,
  mm = NULL,
  ss = NULL,
  POSIXct_time = NULL,
  time_zone = NULL,
  temp,
  rain,
  rh,
  ws,
  wd,
  wd_sd,
  station,
  lon = NULL,
  lat = NULL,
  lonlat_file = NULL,
  data_check = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_weather_+3A_w">w</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> object of weather station data for
formatting.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_yyyy">YYYY</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the year when the
weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_mm">MM</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the month (numerical)
when the weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_dd">DD</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the day of month when
the weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_hh">hh</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the hour (24 hour) when
the weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_mm">mm</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the minute when the
weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_ss">ss</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the second when the
weather was logged.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_posixct_time">POSIXct_time</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> which contains a <code>POSIXct</code>
formatted time. This can be used instead of arguments <code>YYYY</code>, <code>MM</code>, <code>DD</code>,
<code>hh</code>, <code>mm.</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_time_zone">time_zone</code></td>
<td>
<p>Time zone (Olsen time zone format) <code>character</code> where the
weather station is located. May be in a column or supplied as a character string.
Optional, see also <code>r</code>. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_temp">temp</code></td>
<td>
<p>Column name <code>character</code> or index in <code>x</code> that refers to temperature in degrees
Celsius.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_rain">rain</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to rainfall in millimetres.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_rh">rh</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to relative
humidity as a percentage.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_ws">ws</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to wind speed in km / h.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_wd">wd</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to wind direction in
degrees.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_wd_sd">wd_sd</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to wind speed columns
standard deviation.  This is only applicable if weather data
is already summarised to hourly increments. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_station">station</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to the weather station
name or identifier. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lon">lon</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to weather station's
longitude. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lat">lat</code></td>
<td>
<p>Column name <code>character</code> or index in <code>w</code> that refers to weather station's
latitude. See details.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_lonlat_file">lonlat_file</code></td>
<td>
<p>A file path (<code>character</code>) to a <abbr><span class="acronym">CSV</span></abbr> which included station
name/id and longitude and latitude coordinates if they are not supplied in
the data. Optional, see also <code>lon</code> and <code>lat</code>.</p>
</td></tr>
<tr><td><code id="format_weather_+3A_data_check">data_check</code></td>
<td>
<p>If <code>TRUE</code>, it checks for NA values in all 'rain', 'temp',
'rh', 'wd' and 'ws' data and if any values which are unlikely. Use a character
vector of variable names, (wither any of 'rain', 'temp', 'rh', 'wd' or 'ws')
to check data from specific variables. If FALSE it ignores all variables and
could cause subsequent models using this data to fail.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>time_zone</code> The time-zone in which the <code>time</code> was recorded. All weather
stations in <code>w</code> must fall within the same time-zone.  If the required stations
are located in differing time zones, <code>format_weather()</code> should be run separately
on each object, then data can be combined after formatting.
</p>
<p><code>wd_sd</code> If weather data is
provided in hourly increments, a column
with the standard deviation of the wind direction over the hour is required
to be provided. If the weather data are sub-hourly, the standard deviation
will be calculated and returned automatically.
</p>
<p><code>lon</code>, <code>lat</code> and <code>lonlat_file</code> If <code>w</code> provides longitude and
latitude values for station locations, these may be specified in the <code>lon</code>
and <code>lat</code> columns.  If the coordinates are not relevant to the study
location <code>NA</code> can be specified and the function will drop these column
variables.  If these data are not included, (<code>NULL</code>) a separate file may be
provided that contains the longitude, latitude and matching station name to
provide station locations in the final <code>epiphy.weather</code> object that is
created by specifying the file path to a <abbr><span class="acronym">CSV</span></abbr> file using
<code>lonlat_file</code>.
</p>


<h3>Value</h3>

<p>A <code>epiphy.weather</code> object (an extension of <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a>)
containing the supplied weather aggregated to each hour in a suitable
format for use with disease models. Depending on the input weather, classes
will be given to the output object to indicate which models it meets the data
requirements for. Some of the columns returned are as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
<strong>times</strong>: </td><td style="text-align: left;"> Time in POSIXct format with "UTC" time-zone</td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>rain</strong>: </td><td style="text-align: left;"> Rainfall in mm </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>temp</strong>: </td><td style="text-align: left;"> Temperature in degrees Celsius </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>ws</strong>: </td><td style="text-align: left;"> Wind speed in km / h </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>wd</strong>: </td><td style="text-align: left;"> Wind direction in compass degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>wd_sd</strong>: </td><td style="text-align: left;"> Wind direction standard deviation in compass degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>lon</strong>: </td><td style="text-align: left;"> Station longitude in decimal degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>lat</strong>: </td><td style="text-align: left;"> Station latitude in decimal degrees </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>station</strong>: </td><td style="text-align: left;"> Unique station identifying name </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>YYYY</strong>: </td><td style="text-align: left;"> Year </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>MM</strong>: </td><td style="text-align: left;"> Month </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>DD</strong>: </td><td style="text-align: left;"> Day </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>hh</strong>: </td><td style="text-align: left;"> Hour </td>
</tr>
<tr>
 <td style="text-align: right;">
<strong>mm</strong>: </td><td style="text-align: left;"> Minute </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load the weather data to be formatted
weather_station_data &lt;-
   read.csv(system.file("extdata",
                        "scaddan_weather.csv",
                        package = "cercospoRa"))
weather_station_data$Local.Time &lt;-
   as.POSIXct(weather_station_data$Local.Time, format = "%Y-%m-%d %H:%M:%S",
              tz = "UTC")

weather &lt;- format_weather(
   w = weather_station_data,
   POSIXct_time = "Local.Time",
   ws = "meanWindSpeeds",
   wd_sd = "stdDevWindDirections",
   rain = "Rainfall",
   temp = "Temperature",
   wd = "meanWindDirections",
   lon = "Station.Longitude",
   lat = "Station.Latitude",
   station = "StationID",
   time_zone = "UTC"
)

# Reformat saved weather

# Create file path and save data
file_path_name &lt;- paste(tempdir(), "weather_saved.csv", sep = "\\")
write.csv(weather, file = file_path_name,
          row.names = FALSE)

# Read data back in to
weather2 &lt;- read.csv(file_path_name, stringsAsFactors = FALSE)

# reformat the data to have appropriate column classes and data class
weather2 &lt;- format_weather(weather2,
                           time_zone = "UTC")
unlink(file_path_name) # remove temporary weather file
</code></pre>

<hr>
<h2 id='latent_period'>Calculate Cercospora Latent Period</h2><span id='topic+latent_period'></span>

<h3>Description</h3>

<p>Calculate Cercospora Latent Period
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent_period(Tm, ref = "wolf")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="latent_period_+3A_tm">Tm</code></td>
<td>
<p>numeric, Average temperature in degrees Celsius for a hour of the day</p>
</td></tr>
<tr><td><code id="latent_period_+3A_ref">ref</code></td>
<td>
<p>character, method for calculating latent period. Default is
<code>"wolf"</code> also available <code>"jarroudi"</code>. See references for where
formulas were used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the latent period for <em>Cercospora beticola</em> infections on
sugar beet. Note the published formula in Wolf and Verreet (2005)
contains an error in the exponent. e(0.35 x (Tm - 10)) should be
e(-0.35 x (Tm - 10)). See issue #22 on Github for additional information.
</p>


<h3>Value</h3>

<p>numeric, Latent period for a given hour. <code>ref = "jarroudi"</code>
returns latent period in days.
</p>


<h3>References</h3>

<p>Wolf, P. F. J., and J. A. Verreet. “Factors Affecting the Onset of Cercospora
Leaf Spot Epidemics in Sugar Beet and Establishment of Disease-Monitoring
Thresholds.” <em>Phytopathology®</em> 95, no. 3 (March 2005): 269–74.
https://doi.org/10.1094/PHYTO-95-0269.
</p>
<p>El Jarroudi, Moussa, Fadia Chairi, Louis Kouadio, Kathleen Antoons,
Abdoul-Hamid Mohamed Sallah, and Xavier Fettweis. “Weather-Based Predictive
Modeling of Cercospora Beticola Infection Events in Sugar Beet in Belgium.”
<em>Journal of Fungi</em> 7, no. 9 (September 18, 2021): 777.
https://doi.org/10.3390/jof7090777.
</p>

<hr>
<h2 id='read_sb_growth_parameter'>Read LAI images at several time points</h2><span id='topic+read_sb_growth_parameter'></span>

<h3>Description</h3>

<p>Read LAI images at several time points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sb_growth_parameter(img_files, img_dates, target_res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_sb_growth_parameter_+3A_img_files">img_files</code></td>
<td>
<p>character vector providing the file paths of at least two
georeferenced images for the study location. Dates of image capture need to
be defined in <code>img_dates</code> respectively.</p>
</td></tr>
<tr><td><code id="read_sb_growth_parameter_+3A_img_dates">img_dates</code></td>
<td>
<p>POSIXct vector of dates corresponding to the images supplied in
<code>img_files</code> respectively.
To prevent timezone issues use UTC timezone <code>tz = "UTC"</code>.</p>
</td></tr>
<tr><td><code id="read_sb_growth_parameter_+3A_target_res">target_res</code></td>
<td>
<p>desired spatial resolution. <code>target_res</code> should be
equal to or larger than the actual resolution of the images expressed in
meters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SpatRast</code> with a layer for each input layer. Each layer
contains is named according to the <code>img_dates</code>. The output
<code>SpatRast</code> is suitable for input in <code>calc_r_x0()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>epidemic_onset_param &lt;-
  read_sb_growth_parameter(img_files = list.files(system.file("extdata", "uav_img",
                                                              package = "cercospoRa"),
                                                 pattern = ".tif",
                                                 full.names = TRUE),
                           img_dates = as.POSIXct(c("2022-06-14",
                                                    "2022-06-28"),
                                                  tz = "UTC"),
                           target_res = 10)
</code></pre>

<hr>
<h2 id='temperature_index'>Get temperature index</h2><span id='topic+temperature_index'></span>

<h3>Description</h3>

<p>Temperature index is a proportional representation of the latent period.
Temperatures at or above the optimum temperature for the disease cycle will
yield 1 and the lower the temperature the infinitely longer the latent period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temperature_index(Tm, opt_Tm = 21)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="temperature_index_+3A_tm">Tm</code></td>
<td>
<p>numeric, temperature for any given hour</p>
</td></tr>
<tr><td><code id="temperature_index_+3A_opt_tm">opt_Tm</code></td>
<td>
<p>numeric, the lowest temperature optimum at which all temperatures
above will have the same (fastest) latent period.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For equations and original documentation, see Wolf and Verreet (2005)
and Wolf et al. (2001)
</p>


<h3>Value</h3>

<p>numeric, proportion representing the speed of the latent period in relation
to the temperature optimum
</p>


<h3>References</h3>

<p>Wolf, P. F. J., and J. A. Verreet. “Factors Affecting the Onset of Cercospora
Leaf Spot Epidemics in Sugar Beet and Establishment of Disease-Monitoring
Thresholds.” <em>Phytopathology®</em> 95, no. 3 (March 2005): 269–74.
https://doi.org/10.1094/PHYTO-95-0269.
</p>
<p>Wolf, P. F. J., F.-J. Weis, and J.-A. Verreet. “Threshold Values as
Indicators of Fungicide Treatments for the Control of Leaf Blotching Caused
by Cercospora Beticola (Sacc.) in Sugar Beets.”
<em>Journal of Plant Diseases and Protection</em> 108, no. 3 (2001): 244–57.
</p>

<hr>
<h2 id='weathr'>Weather station data</h2><span id='topic+weathr'></span>

<h3>Description</h3>

<p>A unformatted weather station dataset from Germany
</p>


<h3>Author(s)</h3>

<p>Institute for Sugar Beet Research - IFZ
</p>


<h3>Source</h3>

<p>Climavi One + Climavi Soil, Agvolution GmbH, Gottingen, Germany
A data frame with 8,016 rows and 15 columns:
Weather station that accompanied field trial described in cercospora
manuscript
</p>

<dl>
<dt>Station</dt><dd><p>Identifier</p>
</dd>
<dt>Datum</dt><dd><p>Date</p>
</dd>
<dt>Stunde</dt><dd><p>hour</p>
</dd>
<dt>Minute</dt><dd><p>minute</p>
</dd>
<dt>T-005</dt><dd><p>Temperature in degrees Celcius at 5cm</p>
</dd>
<dt>T-200</dt><dd><p>Temperature in degrees Celcius at 200cm</p>
</dd>
<dt>T-020</dt><dd><p>Temperature in degrees Celcius at 20cm</p>
</dd>
<dt>F-200</dt><dd><p>Percentage Relative humidity at 200cm</p>
</dd>
<dt>GS200</dt><dd><p>Global radiation (W/m2) at 200cm</p>
</dd>
<dt>WR200</dt><dd><p>Wind direction degrees at 200cm</p>
</dd>
<dt>N100</dt><dd><p>Precipitation (mm) at 100cm</p>
</dd>
<dt>WG200</dt><dd><p>Wind Speed (m/s) at 200cm</p>
</dd>
</dl>
<p>...

</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
