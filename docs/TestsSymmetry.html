<!DOCTYPE html><html lang="en"><head><title>Help for package TestsSymmetry</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TestsSymmetry}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_quant_H0'><p>Calculate the necessary quantities under null hypothesis</p></a></li>
<li><a href='#getV'><p>Getting asymptotic variance of modified wilcox test statistic</p></a></li>
<li><a href='#mod.symm.test'><p>Wilcoxon and Sign tests for symmetry about an unknown center</p></a></li>
<li><a href='#model'><p>Tree_model</p></a></li>
<li><a href='#n.symm.test'><p>Sample size determination for nonparametric tests of symmetry when the center is unknown</p></a></li>
<li><a href='#plasma.silicon'><p>Dataset: plasma.silicon</p></a></li>
<li><a href='#tree_model_sign'><p>Tree_model_sign</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tests for Symmetry when the Center of Symmetry is Unknown</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiaojiao Zhou &lt;woerge99@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functionality of a statistical testing implementation whether a dataset comes from a symmetric distribution when the center of symmetry is unknown, including Wilcoxon test and sign test procedure. In addition, sample size determination for both tests is provided. The Wilcoxon test procedure is described in Vexler et al. (2023) <a href="https://www.sciencedirect.com/science/article/abs/pii/S0167947323000579">https://www.sciencedirect.com/science/article/abs/pii/S0167947323000579</a>, and the sign test is outlined in Gastwirth (1971) <a href="https://www.jstor.org/stable/2284233">https://www.jstor.org/stable/2284233</a>. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, MASS, e1071, rpart</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2.9000</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-29 19:58:36 UTC; jzhou54</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiaojiao Zhou [aut, cre],
  Xinyu Gao [aut],
  Albert Vexler [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-01 15:02:40 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_quant_H0'>Calculate the necessary quantities under null hypothesis</h2><span id='topic+get_quant_H0'></span>

<h3>Description</h3>

<p>Calculate the necessary quantities under null hypothesis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_quant_H0(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_quant_H0_+3A_x">x</code></td>
<td>
<p>pilot sample</p>
</td></tr>
</table>

<hr>
<h2 id='getV'>Getting asymptotic variance of modified wilcox test statistic</h2><span id='topic+getV'></span>

<h3>Description</h3>

<p>Getting asymptotic variance of modified wilcox test statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getV(x_, y_ = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getV_+3A_x_">x_</code></td>
<td>
<p>A data set</p>
</td></tr>
<tr><td><code id="getV_+3A_y_">y_</code></td>
<td>
<p>Another data set, default is NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Asymptotic variance of modified wilcoxon test statistic
</p>

<hr>
<h2 id='mod.symm.test'>Wilcoxon and Sign tests for symmetry about an unknown center</h2><span id='topic+mod.symm.test'></span>

<h3>Description</h3>

<p>R built-in function 'wilcox.test()' is designed to perform both the one- and two-sample Wilcoxon test when the center of symmetry is specified. The procedure 'mod.symm.test()' extends the capabilities of 
'wilcox.test()' for situations where the center of symmetry is unknown. Such cases can be found in, e.g., regression residuals evaluations, 
as well as in the book 'Nonparametric statistical methods using R' by Kloke and McKean, and in the scholarly work of Gastwirth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mod.symm.test(
  x,
  y = NULL,
  alternative = c("two.sided", "left.skewed", "right.skewed"),
  method = "wilcox"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mod.symm.test_+3A_x">x</code></td>
<td>
<p>numeric vector of data values. Non-finite (e.g., infinite or missing) values will be omitted.</p>
</td></tr>
<tr><td><code id="mod.symm.test_+3A_y">y</code></td>
<td>
<p>an optional numeric vector of data values: as with x non-finite values will be omitted.</p>
</td></tr>
<tr><td><code id="mod.symm.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of &quot;two sided&quot; (default), &quot;right.skewed&quot;, or &quot;left.skewed&quot;.
You can specify just the initial letter.
&quot;right.skewed&quot;: test whether positively skewed, 
&quot;left.skewed&quot; : test whether negatively skewed.</p>
</td></tr>
<tr><td><code id="mod.symm.test_+3A_method">method</code></td>
<td>
<p>a character string specifying which symmetry test to be used, &quot;wilcox&quot; refers to Wilcoxon signed-rank test,
and &quot;sign&quot; is sign test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When &quot;wilcox&quot;, the default method, is used, the test statistic 'W' has the form 
of the Wilcoxon test statistic with the unknown center of symmetry replaced by its sample mean estimator.
For more details, see Vexler et al. (2023)
</p>
<p>When method=&quot;sign&quot; is used, the test statistic 'S' is the total number of 
the observations that smaller than sample mean. For more details, see Gastwitrh (1971).
</p>


<h3>Value</h3>

<p>A list of class &quot;htest&quot; containing the following components:
</p>

<ul>
<li><p> statistic - the value of the test statistic.
</p>
</li>
<li><p> var - the asymptotic variance.
</p>
</li>
<li><p> alternative - a character string describing the alternative hypothesis.
</p>
</li>
<li><p> p.value - the p-value for the test.
</p>
</li>
<li><p> method - the type of test applied.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jiaojiao Zhou, Xinyu Gao, Albert Vexler
</p>


<h3>References</h3>

<p>Vexler, A., Gao, X., &amp; Zhou, J. (2023). How to implement signed-rank 'wilcox.test()' type procedures when a center of symmetry is unknown. Computational Statistics &amp; Data Analysis, 107746. 
</p>
<p>Gastwirth, J. L. (1971). On the Sign Test for Symmetry. Journal of the American Statistical Association, 66(336), 821-823.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # A study measures the plasma silicon levels before and after silicone implants surgery in 30
  # women to evaluate the effect of the surgery. Informally speaking, we can be interested
  # in that there is an unknown constant shift such that the the plasma silicon level of 
  # post-surgery can be explained completely based on that of pre-surgery. This can be stated 
  # as the null hypothesis `H_0` The difference of plasma silicon level between post-surgery and 
  # pre-surgery has a symmetric distribution around a shift that is unknown.  
  data("plasma.silicon")
  post &lt;- plasma.silicon$postoperative 
  pre &lt;- plasma.silicon$preoperative
  # post &lt;- c(0.21,0.24,0.1,0.12,0.28,0.25,0.22,0.21,0.22,0.23,0.22,0.24,0.45,0.38,
  #           0.23,0.22,0.18,0.15,0.04,0.14,0.24,0.2,0.24,0.18,0.19,0.15,0.26,0.3,0.22,0.24)
  # pre &lt;- c(0.15,0.13,0.39,0.2,0.39,0.42,0.24,0.18,0.26,0.12,0.1,0.11,0.19, 0.15,0.27,
  #          0.28,0.11,0.11,0.18,0.18,0.24,0.48,0.27,0.22,0.18,0.19,0.32,0.31,0.19,0.21)
  mod.symm.test(x=post, y=pre, alternative ="two.sided", method = "wilcox")
  
  # Result:
  # Modified Wilcoxon signed-rank test
  # data:  post and pre
  # W = 238, p-value = 0.767
  # alternative hypothesis: two.sided
  
  # Interpretation:
  # Test statistic `W` is the number of walsh average higher than sample mean, see more details 
  # in paper authored by Vexler, etc. 
  # p-value is 0.767, which implies there is no clue to reject the null hypothesis that
  # the distribution of the difference of plasma silicon levels before and after 
  # silicone implants surgery is symmetric. 

</code></pre>

<hr>
<h2 id='model'>Tree_model</h2><span id='topic+model'></span>

<h3>Description</h3>

<p>Tree model object for wilcox method to find the optimal alp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model
</code></pre>


<h3>Format</h3>

<p>An rpart object that contains a tree model which fits alp to npilot, sk, kur, sd and distance_p2_half.
</p>

<hr>
<h2 id='n.symm.test'>Sample size determination for nonparametric tests of symmetry when the center is unknown</h2><span id='topic+n.symm.test'></span>

<h3>Description</h3>

<p>Determine the sample size required for one-sample Wilcoxon signed-rank test or Sign test 
with an unknown symmetry center estimated by sample mean given a target power.The function uses learning sample 
in order to predict (calculate) sample size needed to reach a preassumed power based on the underlying data that
is exemplified by the learning sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.symm.test(
  x,
  sig.level = 0.05,
  power = 0.8,
  method = "wilcox",
  alternative = c("two.sided")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n.symm.test_+3A_x">x</code></td>
<td>
<p>learning sample data, numeric vector of data values</p>
</td></tr>
<tr><td><code id="n.symm.test_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level (Type I error probability), the default value is 0.05</p>
</td></tr>
<tr><td><code id="n.symm.test_+3A_power">power</code></td>
<td>
<p>power of test (1 minus Type II error probability), the default value is 0.8</p>
</td></tr>
<tr><td><code id="n.symm.test_+3A_method">method</code></td>
<td>
<p>a character string specifying which symmetry test to be used, &quot;wilcox&quot; refers to Wilcoxon signed-rank test,
and &quot;sign&quot; sign test</p>
</td></tr>
<tr><td><code id="n.symm.test_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis
&quot;two.sided&quot; : test whether skewed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Normal approximation to the power requires specification of some unknown quantities in the nonparametric context. 
In this regard, empirical smoothed CDF and Bootstrap methods were leveraged to estimate these quantities using learning sample 'x'.  
</p>
<p>Remark: If the test provides a power, say, P, based on the learning data and P is higher than the target power, a warning
message will be shown. However, a needed sample size N to reach the target power will be conducted.
</p>


<h3>Value</h3>

<p>A list of class &quot;power.htest&quot; containing the following components:
</p>

<ul>
<li><p> N - sample size estimated
</p>
</li>
<li><p> sig.level - significance level (Type I error probability)
</p>
</li>
<li><p> power - power of test (1 minus Type II error probability)
</p>
</li>
<li><p> method - the test method applied
</p>
</li>
<li><p> alternative - two-sided test. Can be abbreviated
</p>
</li></ul>



<h3>References</h3>

<p>Chakraborti, S., Hong, B., &amp; van de Wiel, M. A. (2006). A Note on Sample Size Determination for a Nonparametric Test of Location. Technometrics, 48(1), 88-94.
</p>
<p>Vexler, A., Gao, X., &amp; Zhou, J. (2023). How to implement signed-rank 'wilcox.test()' type procedures when a center of symmetry is unknown. Computational Statistics &amp; Data Analysis, 107746. 
</p>
<p>Gastwirth, J. L. (1971). On the Sign Test for Symmetry. Journal of the American Statistical Association, 66(336), 821-823.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 data("plasma.silicon")
 post &lt;- plasma.silicon$postoperative 
 pre &lt;- plasma.silicon$preoperative
 diff &lt;- post - pre
 n.symm.test(diff, sig.level = 0.05, power = 0.5, method = "wilcox", alternative ="two.sided" )

# Result:
# Sample size calculation under wilcox procedure 

#           N = 83
#   sig.level = 0.05
#       power = 0.5
#        type = wilcox
# alternative = two.sided

# Interpretation: 
# Given the pilot sample `diff` and the significance level 0.05. The sample size of 
# the data that is expected toprovide the target power 0.5 of the Wilcoxon test procedure 
# is computed as 83.

</code></pre>

<hr>
<h2 id='plasma.silicon'>Dataset: plasma.silicon</h2><span id='topic+plasma.silicon'></span>

<h3>Description</h3>

<p>A study was conducted to measure the plasma silicon level in blood within 30 women 
who have been taken a silicone implants surgery. Plasma silicon levels (microg per gram dry weight) 
were taken prior to surgical placement of the implants. A post-surgery washout period was allowed, 
and the plasma silicon levels were retaken.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plasma.silicon
</code></pre>


<h3>Format</h3>

<p>A data frame contains 30 rows and 3 variables:
</p>

<dl>
<dt>PatientNo</dt><dd><p>Patient Number.</p>
</dd>
<dt>preoperative</dt><dd><p>pre-operative measurement of plasma silicion level.</p>
</dd>
<dt>postoperative</dt><dd><p>post-operative measurement of plasma silicion level.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Riffenburgh, R. H., &amp; Gillen, D. L. (2020). Statistics in medicine. Academic press. Appendix 2 databases
</p>


<h3>References</h3>

<p>Riffenburgh, R. H., &amp; Gillen, D. L. (2020). Statistics in medicine. Academic press.
</p>

<hr>
<h2 id='tree_model_sign'>Tree_model_sign</h2><span id='topic+tree_model_sign'></span>

<h3>Description</h3>

<p>Tree model object to find the optimal alp for sign test method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree_model_sign
</code></pre>


<h3>Format</h3>

<p>An rpart object that contains a tree model which fits alp to npilot, sk, kur, sd.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
