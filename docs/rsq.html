<!DOCTYPE html><html lang="en"><head><title>Help for package rsq</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rsq}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hcrabs'>
<p>Satellites of Female Horseshoe Crabs</p></a></li>
<li><a href='#hschool'>
<p>Attendance Behavior of High School Juniors</p></a></li>
<li><a href='#lifetime'>
<p>Lifetimes in Two Different Environments.</p></a></li>
<li><a href='#pcor'>
<p>Partial Correlation for Generalized Linear Models</p></a></li>
<li><a href='#rsq'><p>R-Squared for Generalized Linear (Mixed) Models</p></a></li>
<li><a href='#rsq.glmm'><p>R-Squared for Generalized Linear Mixed Models</p></a></li>
<li><a href='#rsq.kl'><p>KL-Divergence-Based R-Squared</p></a></li>
<li><a href='#rsq.lmm'><p>R-Squared for Linear Mixed Models</p></a></li>
<li><a href='#rsq.lr'><p>Likelihood-Ratio-Based R-Squared</p></a></li>
<li><a href='#rsq.n'><p>Corrected Likelihood-Ratio-Based R-Squared</p></a></li>
<li><a href='#rsq.partial'>
<p>Partial R-Squared for Generalized Linear Models</p></a></li>
<li><a href='#rsq.sse'><p>SSE-Based R-Squared</p></a></li>
<li><a href='#rsq.v'><p>Variance-Function-Based R-Squared</p></a></li>
<li><a href='#simglm'><p>Simulate Data from Generalized Linear Models</p></a></li>
<li><a href='#simglmm'><p>Simulate Data from Generalized Linear Mixed Models</p></a></li>
<li><a href='#toxo'>
<p>Toxoplasmosis Test in El Salvador</p></a></li>
<li><a href='#vresidual'><p>Variance-Function-Based Residuals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-26</td>
</tr>
<tr>
<td>Title:</td>
<td>R-Squared and Related Measures</td>
</tr>
<tr>
<td>Author:</td>
<td>Dabao Zhang [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dabao Zhang &lt;dabao.zhang@uci.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, MASS, lme4, nlme, Deriv, Matrix, deming, mcr</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate generalized R-squared, partial R-squared, and partial correlation coefficients for generalized linear (mixed) models (including quasi models with well defined variance functions).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-29 04:52:04 UTC; dabaozhang</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-29 05:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='hcrabs'>
Satellites of Female Horseshoe Crabs
</h2><span id='topic+hcrabs'></span>

<h3>Description</h3>

<p>Recorded are the numbers of male satellites, and other characteristics of 173 female horseshoe crabs. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("hcrabs")</code></pre>


<h3>Format</h3>

<p>A data frame with 173 observations on the following 5 variables.
</p>

<dl>
<dt><code>color</code></dt><dd><p> the female crab's color, coded 1: light; 2: medium light; 3: medium; 4: medium dark; 5: dark. Not all of these colors appear.</p>
</dd>
<dt><code>spine</code></dt><dd><p> the female crab's spine condition, coded 1: both good; 2: one worn or broken; 3: both worn or broker.</p>
</dd>
<dt><code>width</code></dt><dd><p> the female crab's carapace width (cm).</p>
</dd>
<dt><code>num.satellites</code></dt><dd><p> the number of satellite males.</p>
</dd>
<dt><code>weight</code></dt><dd><p> the female crab's weight (kg).</p>
</dd>
</dl>



<h3>Details</h3>

<p>A nesting female horseshoe crab may have male crabs residing nearby, called satellites, besides the male crab residing in her nest. Brockmann (1996) investigated factors (including the female crab's color, spine condition, weight, and carapace width) which may influence the presence/obsence of satellite males. This data set has been discussed by Agresti (2002).
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>Source</h3>

<p>Agresti, A. (2012). <em>An Introduction to Categorical Data Analysis</em>, 3rd edition. Wiley: New Jersey.
</p>


<h3>References</h3>

<p>Brockmann, H. J. (1996). Satellite male groups in horseshoe crabs. <em>Limulus polyphemus. Ethology</em>, 102: 1-21.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+simglm">simglm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
summary(hcrabs)
head(hcrabs)

attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq(bnfit)
rsq(bnfit,adj=TRUE)
rsq.partial(bnfit)

quasips &lt;- glm(num.satellites~color+spine+width+weight,family=quasipoisson)
rsq(quasips)
rsq(quasips,adj=TRUE)
rsq.partial(quasips)
</code></pre>

<hr>
<h2 id='hschool'>
Attendance Behavior of High School Juniors
</h2><span id='topic+hschool'></span>

<h3>Description</h3>

<p>Recorded are the number of days of absence, gender, and two test scores of 316 high school juniors from two urban high schools. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("hschool")</code></pre>


<h3>Format</h3>

<p>A data frame with 316 observations on the following 5 variables.
</p>

<dl>
<dt><code>school</code></dt><dd><p> school of the two, coded 1 or 2;</p>
</dd>
<dt><code>male</code></dt><dd><p> whether the student is male, coded 1: male; 0: female;</p>
</dd>
<dt><code>math</code></dt><dd><p> the standardized test score for math;</p>
</dd>
<dt><code>langarts</code></dt><dd><p> the standardized test score for language arts;</p>
</dd>
<dt><code>daysabs</code></dt><dd><p> the number of days of absence.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Some school administrators studied the attendance behavior of high school juniors at two schools. Predictors of the number of days of absence include gender of the student and standardized test scores in math and language arts. The original source of this data set is unknown.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>Source</h3>

<p>UCLA IDRE Statistical Consulting Group for data analysis.</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+simglm">simglm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hschool)
summary(hschool)
head(hschool)

require(MASS)
absfit &lt;- glm.nb(daysabs~school+male+math+langarts,data=hschool)
summary(absfit)
rsq(absfit)
rsq(absfit,adj=TRUE)

rsq.partial(absfit)
</code></pre>

<hr>
<h2 id='lifetime'>
Lifetimes in Two Different Environments.
</h2><span id='topic+lifetime'></span>

<h3>Description</h3>

<p>There are 27 tests in each of the two environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lifetime")</code></pre>


<h3>Format</h3>

<p>A data frame with 54 observations on the following 2 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p> the lifetime (x10).</p>
</dd>
<dt><code>env</code></dt><dd><p> the environment of each test (kg/mm^2).</p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set is discussed by Wang et al. (1992).
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>Source</h3>

<p>Wang, H., Ma, B., and Shi, J. (1992). Estimation of environmental factors for the inverse gaussian distribution. <em>Microelectron. Reliab.</em>, 32: 931-934.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+simglm">simglm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lifetime)
summary(lifetime)
head(lifetime)

attach(lifetime)
igfit &lt;- glm(time~env,family=inverse.gaussian)
rsq(igfit)
rsq(igfit,adj=TRUE)
</code></pre>

<hr>
<h2 id='pcor'>
Partial Correlation for Generalized Linear Models
</h2><span id='topic+pcor'></span>

<h3>Description</h3>

<p>Calculate the partial correlation for both linear and generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcor(objF,objR=NULL,adj=FALSE,type=c('v','kl','sse','lr','n'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcor_+3A_objf">objF</code></td>
<td>
<p>  an object of class &quot;lm&quot; or &quot;glm&quot;, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a> to fit the full model.</p>
</td></tr>
<tr><td><code id="pcor_+3A_objr">objR</code></td>
<td>
<p>  an object of class &quot;lm&quot; or &quot;glm&quot;, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a> to fit the reduced model.</p>
</td></tr>
<tr><td><code id="pcor_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted partial R^2.</p>
</td></tr>
<tr><td><code id="pcor_+3A_type">type</code></td>
<td>
<p>  the type of R-squared used:
</p>
<p>'v' (default) &ndash; variance-function-based (Zhang, 2016), calling <a href="#topic+rsq.v">rsq.v</a>;
</p>
<p>'kl' &ndash; KL-divergence-based (Cameron and Windmeijer, 1997), calling <a href="#topic+rsq.kl">rsq.kl</a>; 
</p>
<p>'sse' &ndash; SSE-based (Efron, 1978), calling <a href="#topic+rsq.sse">rsq.sse</a>; 
</p>
<p>'lr' &ndash; likelihood-ratio-based (Maddala, 1983; Cox and Snell, 1989; Magee, 1990), calling <a href="#topic+rsq.lr">rsq.lr</a>; 
</p>
<p>'n' &ndash; corrected version of 'lr' (Nagelkerke, 1991), calling <a href="#topic+rsq.n">rsq.n</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the fitting object of the reduced model is not specified, the partial correlation of each covariate (excluding factor covariates with more than two levels) in the model will be calculated.
</p>


<h3>Value</h3>

<p>The partial correlation coefficient is returned.
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cameron, A. C. and Windmeijer, A. G. (1997) An R-squared measure of goodness of fit for some common nonlinear regression models. <em>Journal of Econometrics</em>, 77: 329-342.
</p>
<p>Cox, D. R. and Snell, E. J. (1989) <em>The Analysis of Binary Data</em>, 2nd ed. London: Chapman and Hall.
</p>
<p>Efron, B. (1978) Regression and ANOVA with zero-one data: measures of residual variation. <em>Journal of the American Statistical Association</em>, 73: 113-121.
</p>
<p>Maddala, G. S. (1983) <em>Limited-Dependent and Qualitative Variables in Econometrics</em>. Cambridge University.
</p>
<p>Magee, L. (1990) R^2 measures based on Wald and likelihood ratio joint significance tests. <em>The American Statistician</em>, 44: 250-253.
</p>
<p>Nagelkerke, N. J. D. (1991) A note on a general definition of the coefficient of determination. <em>Biometrika</em>, 78: 691-692.
</p>
<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.partial(bnfit)

bnfitr &lt;- glm(y~color+weight,family=binomial)
rsq.partial(bnfit,bnfitr)

quasibn &lt;- glm(y~color+spine+width+weight,family=quasibinomial)
rsq.partial(quasibn)

quasibnr &lt;- glm(y~color+weight,family=binomial)
rsq.partial(quasibn,quasibnr)
</code></pre>

<hr>
<h2 id='rsq'>R-Squared for Generalized Linear (Mixed) Models</h2><span id='topic+rsq'></span>

<h3>Description</h3>

<p>Calculate the coefficient of determination, aka R^2, for  both linear and generalized linear (mixed) models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq(fitObj,adj=FALSE,type=c('v','kl','sse','lr','n'))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot;, &quot;glm&quot;, &quot;merMod&quot;, &quot;lmerMod&quot;, &quot;lme&quot;, &quot;deming&quot;, or &quot;MCResultResampling&quot;; usually a result of call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, <a href="MASS.html#topic+glm.nb">glm.nb</a>, <a href="lme4.html#topic+lmer">lmer</a>, <a href="lme4.html#topic+glmer">glmer</a>, <a href="lme4.html#topic+glmer.nb">glmer.nb</a>, <a href="nlme.html#topic+lme">lme</a>, <a href="deming.html#topic+deming">deming</a>, or <a href="mcr.html#topic+mcreg">mcreg</a>.</p>
</td></tr>
<tr><td><code id="rsq_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
<tr><td><code id="rsq_+3A_type">type</code></td>
<td>
<p>  the type of R-squared (only applicable for generalized linear models):
</p>
<p>'v' (default) &ndash; variance-function-based (Zhang, 2017), calling <a href="#topic+rsq.v">rsq.v</a>; 
</p>
<p>'kl' &ndash; KL-divergence-based (Cameron and Windmeijer, 1997), calling <a href="#topic+rsq.kl">rsq.kl</a>; 
</p>
<p>'sse' &ndash; SSE-based (Efron, 1978), calling <a href="#topic+rsq.sse">rsq.sse</a>; 
</p>
<p>'lr' &ndash; likelihood-ratio-based (Maddala, 1983; Cox and Snell, 1989; Magee, 1990), calling <a href="#topic+rsq.lr">rsq.lr</a>; 
</p>
<p>'n' &ndash; corrected version of 'lr' (Nagelkerke, 1991), calling <a href="#topic+rsq.n">rsq.n</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate the R-squared for (generalized) linear models. For (generalized) linear mixed models, there are three types of R^2 calculated on the basis of observed response values, estimates of fixed effects, and variance components, i.e., model-based R_M^2 (proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors), fixed-effects R_F^2 (proportion of variation explained by the fixed-effects factors), and random-effects R_R^2 (proportion of variation explained by the random-effects factors).
</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2. For (generalized) linear mixed models,
</p>
<table role = "presentation">
<tr><td><code>R_M^2</code></td>
<td>
<p>proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors.</p>
</td></tr>
<tr><td><code>R_F^2</code></td>
<td>
<p>proportion of variation explained by the fixed-effects factors.</p>
</td></tr>
<tr><td><code>R_R^2</code></td>
<td>
<p>proportion of variation explained by the random-effects factors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cameron, A. C. and Windmeijer, A. G. (1997) An R-squared measure of goodness of fit for some common nonlinear regression models. <em>Journal of Econometrics</em>, 77: 329-342.
</p>
<p>Cox, D. R. and Snell, E. J. (1989) <em>The Analysis of Binary Data</em>, 2nd ed. London: Chapman and Hall.
</p>
<p>Efron, B. (1978) Regression and ANOVA with zero-one data: measures of residual variation. <em>Journal of the American Statistical Association</em>, 73: 113-121.
</p>
<p>Maddala, G. S. (1983) <em>Limited-Dependent and Qualitative Variables in Econometrics</em>. Cambridge University.
</p>
<p>Magee, L. (1990) R^2 measures based on Wald and likelihood ratio joint significance tests. <em>The American Statistician</em>, 44: 250-253.
</p>
<p>Nagelkerke, N. J. D. (1991) A note on a general definition of the coefficient of determination. <em>Biometrika</em>, 78: 691-692.
</p>
<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>
<p>Zhang, D. (2022). Coefficients of determination for mixed-effects models.
<em>Journal of Agricultural, Biological and Environmental Statistics</em>, 27: 674-689.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq.partial">rsq.partial</a>,<a href="#topic+pcor">pcor</a>,<a href="#topic+simglm">simglm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq(bnfit)
rsq(bnfit,adj=TRUE)

quasibn &lt;- glm(y~color+spine+width+weight,family=quasibinomial)
rsq(quasibn)
rsq(quasibn,adj=TRUE)

psfit &lt;- glm(num.satellites~color+spine+width+weight,family=poisson)
rsq(psfit)
rsq(psfit,adj=TRUE)

quasips &lt;- glm(num.satellites~color+spine+width+weight,family=quasipoisson)
rsq(quasips)
rsq(quasips,adj=TRUE)

# Linear mixed models
require(lme4)
lmm1 &lt;- lmer(Reaction~Days+(Days|Subject),data=sleepstudy)
rsq(lmm1)
rsq.lmm(lmm1)

# Generalized linear mixed models
data(cbpp)
glmm1 &lt;- glmer(cbind(incidence,size-incidence)~period+(1|herd),data=cbpp,family=binomial)
rsq(glmm1)
</code></pre>

<hr>
<h2 id='rsq.glmm'>R-Squared for Generalized Linear Mixed Models</h2><span id='topic+rsq.glmm'></span>

<h3>Description</h3>

<p>Calculate the variance-function-based R-squared for generalized linear mixed models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.glmm(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.glmm_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;glmerMod&quot;, usually, a result of a call to <a href="lme4.html#topic+glmer">glmer</a> or <a href="lme4.html#topic+glmer.nb">glmer.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.glmm_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three types of R^2 calculated on the basis of observed response values, estimates of fixed effects, and variance components, i.e., model-based R_M^2 (proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors), fixed-effects R_F^2 (proportion of variation explained by the fixed-effects factors), and random-effects R_R^2 (proportion of variation explained by the random-effects factors).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>R_M^2</code></td>
<td>
<p>proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors.</p>
</td></tr>
<tr><td><code>R_F^2</code></td>
<td>
<p>proportion of variation explained by the fixed-effects factors.</p>
</td></tr>
<tr><td><code>R_R^2</code></td>
<td>
<p>proportion of variation explained by the random-effects factors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>
<p>Zhang, D. (2022). Coefficients of determination for mixed-effects models.
<em>Journal of Agricultural, Biological and Environmental Statistics</em>, 27: 674-689.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vresidual">vresidual</a>, <a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.v">rsq.v</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lme4)
data(cbpp)
glmm1 &lt;- glmer(cbind(incidence,size-incidence)~period+(1|herd),data=cbpp,family=binomial)
rsq.glmm(glmm1)
rsq(glmm1)
</code></pre>

<hr>
<h2 id='rsq.kl'>KL-Divergence-Based R-Squared</h2><span id='topic+rsq.kl'></span>

<h3>Description</h3>

<p>The Kullback-Leibler-divergence-based R^2 for generalized linear models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.kl(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.kl_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot; or &quot;glm&quot;, usually, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.kl_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This version of R^2 was proposed by Cameron and Windmeijer (1997). It is extended to quasi models (Zhang, 2017) based on the quasi-likelihood function (McCullagh, 1983).</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cameron, A. C. and Windmeijer, A. G. (1997) An R-squared measure of goodness of fit for some common nonlinear regression models. <em>Journal of Econometrics</em>, 77: 329-342.
</p>
<p>McCullagh, P. (1983) Quasi-likelihood functions. <em>Annals of Statistics</em>, 11: 59-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.kl(bnfit)
rsq.kl(bnfit,adj=TRUE)

psfit &lt;- glm(num.satellites~color+spine+width+weight,family=poisson)
rsq.kl(psfit)
rsq.kl(psfit,adj=TRUE)

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family=binomial)
rsq.kl(tbn)
rsq.kl(tbn,adj=TRUE)
</code></pre>

<hr>
<h2 id='rsq.lmm'>R-Squared for Linear Mixed Models</h2><span id='topic+rsq.lmm'></span>

<h3>Description</h3>

<p>Calculate the R-squared for linear mixed models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.lmm(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.lmm_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;merMod&quot; or &quot;lmerMod&quot; or &quot;lme&quot;, usually, a result of a call to <a href="lme4.html#topic+lmer">lmer</a>, or <a href="nlme.html#topic+lme">lme</a>.</p>
</td></tr>
<tr><td><code id="rsq.lmm_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three types of R^2 calculated on the basis of observed response values, estimates of fixed effects, and variance components, i.e., model-based R_M^2 (proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors), fixed-effects R_F^2 (proportion of variation explained by the fixed-effects factors), and random-effects R_R^2 (proportion of variation explained by the random-effects factors).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>R_M^2</code></td>
<td>
<p>proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors.</p>
</td></tr>
<tr><td><code>R_F^2</code></td>
<td>
<p>proportion of variation explained by the fixed-effects factors.</p>
</td></tr>
<tr><td><code>R_R^2</code></td>
<td>
<p>proportion of variation explained by the random-effects factors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2022). Coefficients of determination for mixed-effects models.
<em>Journal of Agricultural, Biological and Environmental Statistics</em>, 27: 674-689.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.v">rsq.v</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># lmer in lme4
require(lme4)
lmm1 &lt;- lmer(Reaction~Days+(Days|Subject),data=sleepstudy)
rsq(lmm1)
rsq.lmm(lmm1)

# lme in nlme
require(nlme)
lmm2 &lt;- lme(Reaction~Days,data=sleepstudy,random=~Days|Subject)
rsq(lmm2)
rsq.lmm(lmm2)
</code></pre>

<hr>
<h2 id='rsq.lr'>Likelihood-Ratio-Based R-Squared</h2><span id='topic+rsq.lr'></span>

<h3>Description</h3>

<p>Calculate the likelihood-ratio-based R^2 for generalized linear models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.lr(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.lr_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot; or &quot;glm&quot;, usually, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.lr_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Proposed by Maddala (1983), Cox and Snell (1989), and Magee (1990), this version of R^2 is defined with the likelihood ratio statistics, so it is not defined for quasi models. It reduces to the classical R^2 when the variance function is constant or linear.
</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cox, D. R. and Snell, E. J. (1989) <em>The Analysis of Binary Data</em>, 2nd ed. London: Chapman and Hall.
</p>
<p>Maddala, G. S. (1983) <em>Limited-Dependent and Qualitative Variables in Econometrics</em>. Cambridge University.
</p>
<p>Magee, L. (1990) R^2 measures based on Wald and likelihood ratio joint significance tests. <em>The American Statistician</em>, 44: 250-253.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+rsq.n">rsq.n</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.lr(bnfit)
rsq.lr(bnfit,adj=TRUE)

psfit &lt;- glm(num.satellites~color+spine+width+weight,family=poisson)
rsq.lr(psfit)
rsq.lr(psfit,adj=TRUE)

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family=binomial)
rsq.lr(tbn)
rsq.lr(tbn,adj=TRUE)
</code></pre>

<hr>
<h2 id='rsq.n'>Corrected Likelihood-Ratio-Based R-Squared</h2><span id='topic+rsq.n'></span>

<h3>Description</h3>

<p>Corrected likelihood-ratio-based R^2 for generalized linear models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.n(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.n_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot; or &quot;glm&quot;, usually, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.n_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nagelkerke (1991) proposed this version of R^2 to correct the likelihood-ratio-statistic-based one which was proposed by Maddala (1983), Cox and Snell (1989), and Magee (1990). This corrected generalization of R^2 cannot reduce to the classical R^2 in case of linear models. It is not defined for quasi models.
</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cox, D. R. and Snell, E. J. (1989) <em>The Analysis of Binary Data</em>, 2nd ed. London: Chapman and Hall.
</p>
<p>Maddala, G. S. (1983) <em>Limited-Dependent and Qualitative Variables in Econometrics</em>. Cambridge University.
</p>
<p>Magee, L. (1990) R^2 measures based on Wald and likelihood ratio joint significance tests. <em>The American Statistician</em>, 44: 250-253.
</p>
<p>Nagelkerke, N. J. D. (1991) A note on a general definition of the coefficient of determination. <em>Biometrika</em>, 78: 691-692.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+rsq.lr">rsq.lr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.n(bnfit)
rsq.n(bnfit,adj=TRUE)

psfit &lt;- glm(num.satellites~color+spine+width+weight,family=poisson)
rsq.n(psfit)
rsq.n(psfit,adj=TRUE)

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family=binomial)
rsq.n(tbn)
rsq.n(tbn,adj=TRUE)
</code></pre>

<hr>
<h2 id='rsq.partial'>
Partial R-Squared for Generalized Linear Models
</h2><span id='topic+rsq.partial'></span>

<h3>Description</h3>

<p>Calculate the coefficient of partial determination, aka partial R^2, for both linear and generalized linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.partial(objF,objR=NULL,adj=FALSE,type=c('v','kl','sse','lr','n'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.partial_+3A_objf">objF</code></td>
<td>
<p>  an object of class &quot;lm&quot; or &quot;glm&quot;, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a> to fit the full model.</p>
</td></tr>
<tr><td><code id="rsq.partial_+3A_objr">objR</code></td>
<td>
<p>  an object of class &quot;lm&quot; or &quot;glm&quot;, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a> to fit the reduced model.</p>
</td></tr>
<tr><td><code id="rsq.partial_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted partial R^2.</p>
</td></tr>
<tr><td><code id="rsq.partial_+3A_type">type</code></td>
<td>
<p>  the type of R-squared:
</p>
<p>'v' (default) &ndash; variance-function-based (Zhang, 2017), calling <a href="#topic+rsq.v">rsq.v</a>;
</p>
<p>'kl' &ndash; KL-divergence-based (Cameron and Windmeijer, 1997), calling <a href="#topic+rsq.kl">rsq.kl</a>; 
</p>
<p>'sse' &ndash; SSE-based (Efron, 1978), calling <a href="#topic+rsq.sse">rsq.sse</a>; 
</p>
<p>'lr' &ndash; likelihood-ratio-based (Maddala, 1983; Cox and Snell, 1989; Magee, 1990), calling <a href="#topic+rsq.lr">rsq.lr</a>; 
</p>
<p>'n' &ndash; corrected version of 'lr' (Nagelkerke, 1991), calling <a href="#topic+rsq.n">rsq.n</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the fitting object of the reduced model is not specified, the partial R^2 of each term in the model will be calculated.
</p>


<h3>Value</h3>

<p>Returned values include <code>adjustment</code> and <code>partial.rsq</code>. When <code>objR</code> is not <code>NULL</code>, <code>variable.full</code> and <code>variable.reduced</code> are returned; otherwise <code>variable</code> is returned.
</p>
<table role = "presentation">
<tr><td><code>adjustment</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted partial R^2.</p>
</td></tr>
<tr><td><code>variable.full</code></td>
<td>
<p> all covariates in the full model.</p>
</td></tr>
<tr><td><code>variable.reduced</code></td>
<td>
<p> all covariates in the reduced model.</p>
</td></tr>
<tr><td><code>variable</code></td>
<td>
<p> all covariates in the full model.</p>
</td></tr>
<tr><td><code>partial.rsq</code></td>
<td>
<p> partial R^2 or the adjusted partial R^2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Cameron, A. C. and Windmeijer, A. G. (1997) An R-squared measure of goodness of fit for some common nonlinear regression models. <em>Journal of Econometrics</em>, 77: 329-342.
</p>
<p>Cox, D. R. and Snell, E. J. (1989) <em>The Analysis of Binary Data</em>, 2nd ed. London: Chapman and Hall.
</p>
<p>Efron, B. (1978) Regression and ANOVA with zero-one data: measures of residual variation. <em>Journal of the American Statistical Association</em>, 73: 113-121.
</p>
<p>Maddala, G. S. (1983) <em>Limited-Dependent and Qualitative Variables in Econometrics</em>. Cambridge University.
</p>
<p>Magee, L. (1990) R^2 measures based on Wald and likelihood ratio joint significance tests. <em>The American Statistician</em>, 44: 250-253.
</p>
<p>Nagelkerke, N. J. D. (1991) A note on a general definition of the coefficient of determination. <em>Biometrika</em>, 78: 691-692.
</p>
<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+pcor">pcor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.partial(bnfit)

bnfitr &lt;- glm(y~color+weight,family=binomial)
rsq.partial(bnfit,bnfitr)

quasibn &lt;- glm(y~color+spine+width+weight,family=quasibinomial)
rsq.partial(quasibn)

quasibnr &lt;- glm(y~color+weight,family=binomial)
rsq.partial(quasibn,quasibnr)
</code></pre>

<hr>
<h2 id='rsq.sse'>SSE-Based R-Squared</h2><span id='topic+rsq.sse'></span>

<h3>Description</h3>

<p>The sum-of-squared-errors-based R^2 for generalized linear models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.sse(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.sse_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot; or &quot;glm&quot;, usually, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, or <a href="MASS.html#topic+glm.nb">glm.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.sse_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This version of R^2 was proposed by Efron (1978). It is calculated on the basis of the formula of the classical R^2. </p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Efron, B. (1978) Regression and ANOVA with zero-one data: measures of residual variation. <em>Journal of the American Statistical Association</em>, 73: 113-121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.sse(bnfit)
rsq.sse(bnfit,adj=TRUE)

psfit &lt;- glm(num.satellites~color+spine+width+weight,family=poisson)
rsq.sse(psfit)
rsq.sse(psfit,adj=TRUE)

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family=binomial)
rsq.sse(tbn)
rsq.sse(tbn,adj=TRUE)
</code></pre>

<hr>
<h2 id='rsq.v'>Variance-Function-Based R-Squared</h2><span id='topic+rsq.v'></span>

<h3>Description</h3>

<p>Calculate the variance-function-based R-squared for generalized linear (mixed) models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq.v(fitObj,adj=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.v_+3A_fitobj">fitObj</code></td>
<td>
<p> an object of class &quot;lm&quot;, &quot;glm&quot;, &quot;lme&quot;, or &quot;glmerMod&quot;, usually, a result of a call to <a href="stats.html#topic+lm">lm</a>, <a href="stats.html#topic+glm">glm</a>, <a href="MASS.html#topic+glm.nb">glm.nb</a>, <a href="lme4.html#topic+glmer">glmer</a>, or <a href="lme4.html#topic+glmer.nb">glmer.nb</a>.</p>
</td></tr>
<tr><td><code id="rsq.v_+3A_adj">adj</code></td>
<td>
<p> logical; if TRUE, calculate the adjusted R^2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The R^2 relies on the variance function, and is well-defined for quasi models. It reduces to the classical R^2 when the variance function is constant or linear. For (generalized) linear mixed models, there are three types of R^2 calculated on the basis of observed response values, estimates of fixed effects, and variance components, i.e., model-based R_M^2 (proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors), fixed-effects R_F^2 (proportion of variation explained by the fixed-effects factors), and random-effects R_R^2 (proportion of variation explained by the random-effects factors).
</p>


<h3>Value</h3>

<p>The R^2 or adjusted R^2. For (generalized) linear mixed models,
</p>
<table role = "presentation">
<tr><td><code>R_M^2</code></td>
<td>
<p>proportion of variation explained by the model in total, including both fixed-effects and random-efffects factors.</p>
</td></tr>
<tr><td><code>R_F^2</code></td>
<td>
<p>proportion of variation explained by the fixed-effects factors.</p>
</td></tr>
<tr><td><code>R_R^2</code></td>
<td>
<p>proportion of variation explained by the random-effects factors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>
<p>Zhang, D. (2020). Coefficients of determination for mixed-effects models. arXiv:2007.08675.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vresidual">vresidual</a>, <a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.glmm">rsq.glmm</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family=binomial)
rsq.v(bnfit)
rsq.v(bnfit,adj=TRUE)

quasibn &lt;- glm(y~color+spine+width+weight,family=quasibinomial)
rsq.v(quasibn)
rsq.v(quasibn,adj=TRUE)

# Generalized linear mixed models
require(lme4)
data(cbpp)
glmm1 &lt;- glmer(cbind(incidence,size-incidence)~period+(1|herd),data=cbpp,family=binomial)
rsq.v(glmm1)
</code></pre>

<hr>
<h2 id='simglm'>Simulate Data from Generalized Linear Models</h2><span id='topic+simglm'></span>

<h3>Description</h3>

<p>Simulate data from linear and generalized linear models. Only the first covariate truely affects the response variable with coefficient equal to <code>lambda</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>simglm(family=c("binomial", "gaussian", "poisson","Gamma"),lambda=3,n=50,p=3)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simglm_+3A_family">family</code></td>
<td>
<p> the family of the distribution.</p>
</td></tr>
<tr><td><code id="simglm_+3A_lambda">lambda</code></td>
<td>
<p> size of the coefficient of the first covariate.</p>
</td></tr>
<tr><td><code id="simglm_+3A_n">n</code></td>
<td>
<p> the sample size.</p>
</td></tr>
<tr><td><code id="simglm_+3A_p">p</code></td>
<td>
<p> the number of covarites.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first covariate takes 1 in half of the observations, and 0 or -1 in the other half. When <code>lambda</code> gets larger, it is supposed to easier to predict the response variable.
</p>


<h3>Value</h3>

<p>Returned values include <code>yx</code> and <code>beta</code>.
</p>
<table role = "presentation">
<tr><td><code>yx</code></td>
<td>
<p> a data frame including the response <code>y</code> and covariates <code>x.1</code>, <code>x.2</code>, and so on.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p> true values of the regression coefficients.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Poisson Models
sdata &lt;- simglm(family="poisson",lambda=4)
fitf &lt;- glm(y~x.1+x.2+x.3,family=poisson,data=sdata$yx)
rsq(fitf)  # type='v'

fitr &lt;- glm(y~x.2+x.3,family=poisson,data=sdata$yx)
rsq(fitr)  # type='v'
rsq(fitr,type='kl')
rsq(fitr,type='lr')
rsq(fitr,type='n')

pcor(fitr)  # type='v'
pcor(fitr,type='kl')
pcor(fitr,type='lr')
pcor(fitr,type='n')

# Gamma models with shape=100
n &lt;- 50
sdata &lt;- simglm(family="Gamma",lambda=4,n=n)
fitf &lt;- glm(y~x.1+x.2+x.3,family=Gamma,data=sdata$yx)
rsq(fitf)  # type='v'
rsq.partial(fitf)  # type='v'

fitr &lt;- glm(y~x.2,family=Gamma,data=sdata$yx)
rsq(fitr)  # type='v'
rsq(fitr,type='kl')
rsq(fitr,type='lr')
rsq(fitr,type='n')

# Likelihood-ratio-based R-squared
y &lt;- sdata$yx$y
yhatr &lt;- fitr$fitted.values
fit0 &lt;- update(fitr,.~1)
yhat0 &lt;- fit0$fitted.values
llr &lt;- sum(log(dgamma(y,shape=100,scale=yhatr/100)))
ll0 &lt;- sum(log(dgamma(y,shape=100,scale=yhat0/100)))

# Likelihood-ratio-based R-squared
1-exp(-2*(llr-ll0)/n)

# Corrected likelihood-ratio-based R-squared
(1-exp(-2*(llr-ll0)/n))/(1-exp(2*ll0/n))
</code></pre>

<hr>
<h2 id='simglmm'>Simulate Data from Generalized Linear Mixed Models</h2><span id='topic+simglmm'></span>

<h3>Description</h3>

<p>Simulate data from linear and generalized linear mixed models. The coefficients of the two covariate are specified by <code>beta</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>simglmm(family=c("binomial","gaussian","poisson","negative.binomial"),
beta=c(2,0),tau=1,n=200,m=10,balance=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simglmm_+3A_family">family</code></td>
<td>
<p> the family of the distribution.</p>
</td></tr>
<tr><td><code id="simglmm_+3A_beta">beta</code></td>
<td>
<p> regression coefficients (excluding the intercept which is set as zero).</p>
</td></tr>
<tr><td><code id="simglmm_+3A_tau">tau</code></td>
<td>
<p> the variance of the random intercept.</p>
</td></tr>
<tr><td><code id="simglmm_+3A_n">n</code></td>
<td>
<p> the sample size.</p>
</td></tr>
<tr><td><code id="simglmm_+3A_m">m</code></td>
<td>
<p> the number of groups.</p>
</td></tr>
<tr><td><code id="simglmm_+3A_balance">balance</code></td>
<td>
<p> simulate balanced data if TRUE, unbalanced data otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first covariate takes 1 in half of the observations, and 0 or -1 in the other half. When <code>beta</code> gets larger, it is supposed to easier to predict the response variable.
</p>


<h3>Value</h3>

<p>Returned values include <code>yx</code>, <code>beta</code>, and <code>u</code>.
</p>
<table role = "presentation">
<tr><td><code>yx</code></td>
<td>
<p> a data frame including the response <code>y</code> and covariates <code>x1</code>, <code>x2</code>, and so on.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p> true values of the regression coefficients.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p> the random intercepts.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2022). Coefficients of determination for mixed-effects models.
<em>Journal of Agricultural, Biological and Environmental Statistics</em>, 27: 674-689.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.lmm">rsq.lmm</a>, <a href="#topic+rsq.glmm">rsq.glmm</a>, <a href="#topic+simglm">simglm</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(lme4)

# Linear mixed models
gdata &lt;- simglmm(family="gaussian")
lmm1 &lt;- lmer(y~x1+x2+(1|subject),data=gdata$yx)
rsq(lmm1)

# Generalized linear mixed models
bdata &lt;- simglmm(family="binomial",n=400,m=20)
glmm1 &lt;- glmer(y~x1+x2+(1|subject),family="binomial",data=bdata$yx)
rsq(glmm1)
</code></pre>

<hr>
<h2 id='toxo'>
Toxoplasmosis Test in El Salvador
</h2><span id='topic+toxo'></span>

<h3>Description</h3>

<p>Recorded are the numbers of subjects testing positive for toxoplasmosis in 34 cities of El Salvador. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("toxo")</code></pre>


<h3>Format</h3>

<p>A data frame with the test results in 34 cities of El Salvador, includingthe following 4 variables.
</p>

<dl>
<dt><code>city</code></dt><dd><p> index of each city.</p>
</dd>
<dt><code>positive</code></dt><dd><p> the number of subjects testing positive for toxoplasmosis.</p>
</dd>
<dt><code>nsubs</code></dt><dd><p> the total number of subjects tested.</p>
</dd>
<dt><code>rainfall</code></dt><dd><p> annual rainfall (mm) in home city of subject.</p>
</dd>
</dl>



<h3>Details</h3>

<p>All subjects are between 11 and 15 year old. The data set was abstracted from a larger data set in Rmington et al. (1970).
</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>Source</h3>

<p>Efron, B. (1978). Regression and ANOVA with zero-one data: measures of residual variation. <em>JASA</em>, 73: 113-121.
</p>


<h3>References</h3>

<p>Remington, J.S., Efron, B., Cavanaugh, E., Simon, H.J., and Trejos, A. (1970). 
Studies on toxoplasmosis in El Salvador, prevalence and incidence of toxoplasmosis
as measured by the Sabin-Feldman Dye test. 
<em>Transactions of the Royal Society of Tropical Medicine and Hygiene</em>, 64: 252-267.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq">rsq</a>, <a href="#topic+rsq.partial">rsq.partial</a>, <a href="#topic+pcor">pcor</a>, <a href="#topic+simglm">simglm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(toxo)
summary(toxo)
attach(toxo)

toxofit&lt;-glm(cbind(positive,nsubs-positive)~rainfall+I(rainfall^2)+I(rainfall^3),family=binomial)

rsq(toxofit)
rsq(toxofit,adj=TRUE)
rsq.partial(toxofit)

detach(toxo)
</code></pre>

<hr>
<h2 id='vresidual'>Variance-Function-Based Residuals</h2><span id='topic+vresidual'></span>

<h3>Description</h3>

<p>Calculate the variance-function-based residuals for generalized linear models, which are used to calculate the variance-function-based R-squared.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vresidual(y,yfit,family=binomial(),variance=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vresidual_+3A_y">y</code></td>
<td>
<p> a vector of observed values.</p>
</td></tr>
<tr><td><code id="vresidual_+3A_yfit">yfit</code></td>
<td>
<p> a vector of fitted values.</p>
</td></tr>
<tr><td><code id="vresidual_+3A_family">family</code></td>
<td>
 <p><a href="stats.html#topic+family">family</a> of the distribution.</p>
</td></tr>
<tr><td><code id="vresidual_+3A_variance">variance</code></td>
<td>
<p> variance function (specified by family by default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calcualted residual relies on the variance function, and is well-defined for quasi models. It reduces to the classical residual when the variance function is constant or linear. Note that only the variance function is required to specify, via either &quot;family&quot;&quot; or &quot;variance&quot;.
</p>


<h3>Value</h3>

<p>Variance-function-based residuals.</p>


<h3>Author(s)</h3>

<p>Dabao Zhang, Department of Epidemiology and Biostatistics, University of California, Irvine</p>


<h3>References</h3>

<p>Zhang, D. (2017). A coefficient of determination for generalized linear models. <em>The American Statistician</em>, 71(4): 310-316.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rsq.v">rsq.v</a>, <a href="#topic+rsq">rsq</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hcrabs)
attach(hcrabs)
y &lt;- ifelse(num.satellites&gt;0,1,0)
bnfit &lt;- glm(y~color+spine+width+weight,family="binomial")
vresidual(y,bnfit$fitted.values,family="binomial")

# Effectiveness of Bycycle Safety Helmets in Thompson et al. (1989)
y &lt;- matrix(c(17,218,233,758),2,2)
x &lt;- factor(c("yes","no"))
tbn &lt;- glm(y~x,family="binomial")
yfit &lt;- cbind(tbn$fitted.values, 1-tbn$fitted.values)
vr0 &lt;- vresidual(matrix(0,2,1),yfit[,1],family="binomial")
vr1 &lt;- vresidual(matrix(1,2,1),yfit[,2],family="binomial")
y[,1]*vr0+y[,2]*vr1
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
