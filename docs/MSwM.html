<!DOCTYPE html><html><head><title>Help for package MSwM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSwM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MSwM-package'>
<p>MSwM package</p></a></li>
<li><a href='#AIC-methods'>
<p>Akaike Information Criterion for Markov Switching models.</p></a></li>
<li><a href='#energy'>
<p>Price of energy in Spain</p></a></li>
<li><a href='#example'>
<p>Example data generated</p></a></li>
<li><a href='#intervals-methods'>
<p>Function: Confidence Intervals on Coefficients</p></a></li>
<li><a href='#MSM-internal'><p>Internal msmFit objects and methods</p></a></li>
<li><a href='#MSM.fitted-class'><p>Class &quot;MSM.fitted&quot;</p></a></li>
<li><a href='#MSM.glm-class'><p>Class &quot;MSM.glm&quot;</p></a></li>
<li><a href='#MSM.lm-class'><p>Class &quot;MSM.lm&quot;</p></a></li>
<li><a href='#msmFit'>
<p>Fitting Markov Switching Models</p></a></li>
<li><a href='#msmResid'>
<p>Extract Markov Switching Model Residuals</p></a></li>
<li><a href='#plot-methods'><p> Function: plot for Markov Switching Models</p></a></li>
<li><a href='#plotDiag'>
<p>Plot Diagnostics for an msm Object</p></a></li>
<li><a href='#plotProb'>
<p>Plot of filtered and smoothed probabilities with regimes specifications.</p></a></li>
<li><a href='#plotReg'>
<p>Comparative plots of response and explanatory variables with regime specifications.</p></a></li>
<li><a href='#summary-methods'><p> Function: Summary for Markov Switching Models</p></a></li>
<li><a href='#traffic'>
<p>Traffic Deads in Spain</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting Markov Switching Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Josep A. Sanchez-Espigares, Alberto Lopez-Moreno</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josep A. Sanchez-Espigares &lt;josep.a.sanchez@upc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation, inference and diagnostics for Univariate Autoregressive Markov Switching Models for Linear and Generalized Models. Distributions for the series include gaussian, Poisson, binomial and gamma cases. The EM algorithm is used for estimation (see Perlin (2012) &lt;<a href="https://doi.org/10.2139%2Fssrn.1714016">doi:10.2139/ssrn.1714016</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, graphics, parallel</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-05 18:08:13 UTC; josep</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-06 10:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='MSwM-package'>
MSwM package
</h2><span id='topic+MSwM-package'></span><span id='topic+MSwM'></span>

<h3>Description</h3>

<p>Univariate Autoregressive Markov Switching Models for Linear and Generalized Models by using the EM algorithm.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MSwM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-11-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods, nlme, graphics, parallel</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Josep Anton Sanchez Espigares, Alberto Lopez-Moreno
</p>
<p>Maintainer: Josep Anton Sanchez Espigares &lt;josep.a.sanchez@upc.edu&gt;
</p>


<h3>References</h3>

<p>Hamilton J.D. (1989). A New Approach to the Economic Analysis of Nonstionary Time Series and the Business Cycle. Econometrica 57: 357-384<br />
Hamilton, J.D. (1994). Time Series Analysis. Princeton University Press.<br />
Goldfeld, S., Quantd, R. (2005). 'A  Markov model for switching Regression',Journal of Econometrics 135, 349-376.<br />
Perlin, M. (2007). 'Estimation, Simulation and Forecasting of a Markov Switching Regression', (General case in Matlab).<br />
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='AIC-methods'>
Akaike Information Criterion for Markov Switching models.
</h2><span id='topic+AIC'></span><span id='topic+AIC-methods'></span><span id='topic+AIC+2CMSM.glm-method'></span><span id='topic+AIC+2CMSM.lm-method'></span><span id='topic+AIC.MSM.lm'></span><span id='topic+AIC.MSM.glm'></span>

<h3>Description</h3>

<p>Calculates the Akaike information criterion for one Markov Switching model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC-methods_+3A_object">object</code></td>
<td>
<p> an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;. </p>
</td></tr>
<tr><td><code id="AIC-methods_+3A_k">k</code></td>
<td>
<p> an optional numeric value for the penalty per parameter to be used. The default <code>k=2</code> is the classical AIC.</p>
</td></tr>
<tr><td><code id="AIC-methods_+3A_...">...</code></td>
<td>
<p> currently not used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value with the corresponding AIC (or BIC, or ..., depending on k).
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='energy'>
Price of energy in Spain
</h2><span id='topic+energy'></span>

<h3>Description</h3>

<p>Price of the energy in Spain with other economic data. Data from January 1, 2002 to October 31, 2008 (daily data, working days: Monday to Friday)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(energy)</code></pre>


<h3>Format</h3>

<p>A data frame with 1785 observations on the following 7 variables.
</p>

<dl>
<dt><code>Price</code></dt><dd><p>Average price of energy (Cent/kwh)</p>
</dd>
<dt><code>Oil</code></dt><dd><p>Oil price (Euro/barril)</p>
</dd>
<dt><code>Gas</code></dt><dd><p>Gas price (Euro/MWh)</p>
</dd>
<dt><code>Coal</code></dt><dd><p>Coal price (Euro/T)</p>
</dd>
<dt><code>EurDol</code></dt><dd><p>Exchange rate between Dolar-Euro (USD-Euro)</p>
</dd>
<dt><code>Ibex35</code></dt><dd><p>Ibex 35 index divided by one thousand</p>
</dd>
<dt><code>Demand</code></dt><dd><p>Daily demand of energy (GWh)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from the Spanish Market Operator of Energy (OMEL), the Bank of Spain and the U.S. Energy Information Administrationa
</p>


<h3>References</h3>

<p>S. Fontdecaba, M. P. Munyoz , J. A. Sanchez (2009). Estimating Markovian Switching Regression Models in R. An application to model energy price in Spain. The R UseR Conference 2009. Rennes, France.
</p>

<hr>
<h2 id='example'>
Example data generated
</h2><span id='topic+example'></span>

<h3>Description</h3>

<p>The <code>example</code> data is a generated data set to show how <code>msmFit</code> can detect the presence of two regimes in a data with autocorrelative periods and other periods that are correlated with the covariate <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(example)</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 2 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p> an uniform distribution with min=0 and max=1. </p>
</dd>
<dt><code>y</code></dt><dd><p> a variable generated through two models. For further information, see the vignette 'example' on this package.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(example)
plot(x~y,data=example)

##See the vignette
#vignette("examples")
</code></pre>

<hr>
<h2 id='intervals-methods'>
Function: Confidence Intervals on Coefficients
</h2><span id='topic+intervals'></span><span id='topic+intervals-methods'></span><span id='topic+intervals+2CMSM.glm-method'></span><span id='topic+intervals+2CMSM.lm-method'></span><span id='topic+intervals.MSM.lm'></span><span id='topic+intervals.MSM.glm'></span>

<h3>Description</h3>

<p>Confidence intervals are obtained for the parameters associated with the model represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intervals(object, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervals-methods_+3A_object">object</code></td>
<td>
<p> a fitted Markov Switching model object from which parameter estimates can be extracted.</p>
</td></tr>
<tr><td><code id="intervals-methods_+3A_level">level</code></td>
<td>
<p> an optional numeric value for the interval confidence level. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="intervals-methods_+3A_...">...</code></td>
<td>
<p> currently not used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print the coefficients with their intervals for each regime.
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='MSM-internal'>Internal msmFit objects and methods</h2><span id='topic+MSM-class'></span><span id='topic+MSM.linear-class'></span><span id='topic++5B+2CMSM-method'></span><span id='topic++5B+2CMSM.linear-method'></span><span id='topic+filter+2CMSM.linear-method'></span><span id='topic+smooth+2CMSM.linear-method'></span><span id='topic+em'></span><span id='topic+em+2CMSM.linear-method'></span>

<h3>Description</h3>

<p>These are not to be called by the user.<br />
If you have a specific need or for more details on msmFit, feel free to contact the author (who, even if he is very lazy, will be very happy to answer and -why not?- may start a new collaboration.)
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='MSM.fitted-class'>Class &quot;MSM.fitted&quot;</h2><span id='topic+MSM.fitted-class'></span><span id='topic++5B+2CMSM.fitted+2Ccharacter+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>MSM.fitted</code> contains the values of fitting the EM algorithm for Markov Switching Models. It is an internal class and is stored in objects of class <code>MSM.lm</code> and <code>MSM.glm</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>CondMean</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the conditional means for each state. </p>
</dd>
<dt><code>error</code>:</dt><dd><p>Object of class <code>"matrix"</code>, are the conditional residuals of the model for each state. </p>
</dd>
<dt><code>Likel</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains de likelihood of the parameters for each state. </p>
</dd>
<dt><code>margLik</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the marginal likelihood for each observation. </p>
</dd>
<dt><code>filtProb</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the filter probabilities for each state. </p>
</dd>
<dt><code>smoProb</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the smoothed probabilities for each state. </p>
</dd>
<dt><code>smoTransMat</code>:</dt><dd><p>Object of class <code>"list"</code>, contains the smoothed transition probabilities in a <code>"matrix"</code> for each observation between all the states. </p>
</dd>
<dt><code>logLikel</code>:</dt><dd><p>Object of class <code>"numeric"</code>, contains the global loglikelihood of the model. </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "MSM.fitted", i = "character", j = "missing", drop = "missing")</code>: extract the componentes of the model. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='MSM.glm-class'>Class &quot;MSM.glm&quot;</h2><span id='topic+MSM.glm-class'></span><span id='topic++5B+2CMSM.glm+2Ccharacter+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>MSM.glm</code> is an object containing Markov Switching model information for general linear models.
</p>


<h3>Objects from the Class</h3>

<p><code><a href="#topic+msmFit">msmFit</a></code> is an algorithm that builds a <code>MSM.glm</code> when the original model class is <code>glm</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>family</code>:</dt><dd><p>Object of class <code>"ANY"</code>, contains the family of the object <code>glm</code>. </p>
</dd>
<dt><code>Likelihood</code>:</dt><dd><p>Object of class <code>"function"</code>, is the function that allows calculation of the conditional density of the response.</p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class <code>"glm"</code>, contains the original model <code>glm</code>. </p>
</dd>
<dt><code>Coef</code>:</dt><dd><p>Object of class <code>"data.frame"</code>, contains the coefficientes of the model MSM where each row indicates the state.</p>
</dd>
<dt><code>seCoef</code>:</dt><dd><p>Object of class <code>"data.frame"</code>, contains the standard errors of the coefficients. </p>
</dd>
<dt><code>transMat</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the transition probabilities of the states. </p>
</dd>
<dt><code>iniProb</code>:</dt><dd><p>Object of class <code>"numeric"</code>, contains initial values of the parameters.  </p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"call"</code>, contains the object <code>call</code> which <code>msmFit</code> has been executed. </p>
</dd>
<dt><code>k</code>:</dt><dd><p>Object of class <code>"numeric"</code>, the numbers of states that the model has. </p>
</dd>
<dt><code>switch</code>:</dt><dd><p>Object of class <code>"logical"</code>, contains which coefficients have switching. </p>
</dd>
<dt><code>Fit</code>:</dt><dd><p>Object of class <code>"MSM.fitted"</code>, contains the values obtained for fitting an MSM model with EM algorithm. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+MSM.linear-class">MSM.linear</a>"</code>, directly.
Class <code>"<a href="#topic+MSM-class">MSM</a>"</code>, by class &quot;MSM.linear&quot;, distance 2.
</p>


<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "MSM.glm", i = "character", j = "missing", drop = "missing")</code>: extract the componentes of the model. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='MSM.lm-class'>Class &quot;MSM.lm&quot;</h2><span id='topic+MSM.lm-class'></span><span id='topic++5B+2CMSM.lm+2Ccharacter+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>MSM.lm</code> is an object containing Markov Switching model information for linear models.
</p>


<h3>Objects from the Class</h3>

<p><code><a href="#topic+msmFit">msmFit</a></code> is an algorithm that builds a <code>MSM.lm</code> when the original model class is <code>lm</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>std</code>:</dt><dd><p>Object of class <code>"numeric"</code>, contains the standard deviation for each state. </p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class <code>"glm"</code>, contains the original model <code>glm</code> </p>
</dd>
<dt><code>Coef</code>:</dt><dd><p>Object of class <code>"data.frame"</code>, contains the coefficientes of the model MSM, where each row indicates the state.</p>
</dd>
<dt><code>seCoef</code>:</dt><dd><p>Object of class <code>"data.frame"</code>, contains the standard errors of the coefficients. </p>
</dd>
<dt><code>transMat</code>:</dt><dd><p>Object of class <code>"matrix"</code>, contains the transition probabilities of the states. </p>
</dd>
<dt><code>iniProb</code>:</dt><dd><p>Object of class <code>"numeric"</code>, contains initial values of the parameters.  </p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"call"</code>, contains the object <code>call</code> which <code>msmFit</code> has been executed. </p>
</dd>
<dt><code>k</code>:</dt><dd><p>Object of class <code>"numeric"</code>, the numbers of states that the model has. </p>
</dd>
<dt><code>switch</code>:</dt><dd><p>Object of class <code>"logical"</code>, contains which coefficients have switching. </p>
</dd>
<dt><code>Fit</code>:</dt><dd><p>Object of class <code>"MSM.fitted"</code>, contains the values obtained for fitting a MSM model with EM algorithm. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="#topic+MSM.linear-class">MSM.linear</a>"</code>, directly.
Class <code>"<a href="#topic+MSM-class">MSM</a>"</code>, by class &quot;MSM.linear&quot;, distance 2.
</p>


<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "MSM.lm", i = "character", j = "missing", drop = "missing")</code>: extract the componentes of the model. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='msmFit'>
Fitting Markov Switching Models
</h2><span id='topic+msmFit'></span><span id='topic+msmFit-methods'></span><span id='topic+msmFit+2Cformula+2Cnumeric+2Clogical+2CANY+2Cdata.frame+2CANY-method'></span><span id='topic+msmFit+2Cglm+2Cnumeric+2Clogical+2CANY+2Cmissing+2CANY-method'></span><span id='topic+msmFit+2Clm+2Cnumeric+2Clogical+2CANY+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>msmFit</code> is an implementation for modeling Markov Switching Models using the EM algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	msmFit(object, k, sw, p, data, family, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msmFit_+3A_object">object</code></td>
<td>
<p> an object of class &quot;lm&quot; or &quot;glm&quot;, or &quot;formula&quot; with a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_k">k</code></td>
<td>
<p> numeric, the estimated number of regimes that the model has.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_sw">sw</code></td>
<td>
<p>a logical vector indicatig which coefficients have switching.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_p">p</code></td>
<td>
<p>integer, the number of AR coefficients that the MS model has to have. The default value is zero. If <code>p</code> is higher than zero, the last values of <code>sw</code> have to contain the AR coefficients which have switching.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_data">data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which &quot;glm&quot; is called.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_family">family</code></td>
<td>
<p>a character value indicating what family belongs to the model. It is only required when the object is a &quot;General linear formula&quot;.</p>
</td></tr>
<tr><td><code id="msmFit_+3A_control">control</code></td>
<td>
<p> a list of control parameters. See &quot;Details&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>control</code> argument is a list that can supply any of the following components:
</p>
<p>-<code>trace</code>: A logical value. If it is TRUE, tracing information on the progress of the optimization is produced.
</p>
<p>-<code>maxiter</code>: The maximum number of iterations in the EM method. Default is 100.
</p>
<p>-<code>tol</code>: Tolerance. The algorithm stops if it is unable to reduce the value by a factor of <code>tol</code> at a step. Default is 1e-8.
</p>
<p>-<code>maxiterOuter</code>: The number of short runs of the EM method to stablish the initial values. Default is 5
</p>
<p>-<code>maxiterInner</code>: The number of iterations in the EM method in each short run to stablish the initial values. Default is 10
</p>
<p>-<code>parallelization</code>: A logical value. Whether the process is done by using parallelization or not. Default is TRUE.
</p>


<h3>Value</h3>

<p><code>msm.fit</code> returns an object of class <code><a href="#topic+MSM.lm-class">MSM.lm</a></code> or <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, depending on the input model. 
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>References</h3>

<p>Hamilton J.D. (1989). A New Approach to the Economic Analysis of Nonstionary Time Series and the Business Cycle. Econometrica 57: 357-384<br />
Hamilton, J.D. (1994). Time Series Analysis. Princeton University Press.<br />
Goldfeld, S., Quantd, R. (2005). 'A  Markov model for switching Regression',Journal of Econometrics 135, 349-376.<br />
Perlin, M. (2007). 'Estimation, Simulation and Forecasting of a Markov Switching Regression', (General case in Matlab).<br />
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run
##	data(energy)
##	model=lm(Price~Oil+Gas+Coal+EurDol+Ibex35+Demand,energy)
##	mod=msmFit(model,k=2,sw=rep(TRUE,8))
##  summary(mod)
## End(Not run)</code></pre>

<hr>
<h2 id='msmResid'>
Extract Markov Switching Model Residuals
</h2><span id='topic+msmResid'></span><span id='topic+msmResid-methods'></span><span id='topic+msmResid+2CMSM.lm+2CANY-method'></span><span id='topic+msmResid+2CMSM.lm+2Cmissing-method'></span><span id='topic+msmResid+2CMSM.glm+2CANY-method'></span><span id='topic+msmResid+2CMSM.glm+2Cmissing-method'></span>

<h3>Description</h3>

<p><code>msmResid</code> is a function which extracts model residuals from objects returned by Markov Switching modeling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msmResid(object, regime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="msmResid_+3A_object">object</code></td>
<td>

<p>an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;.
</p>
</td></tr>
<tr><td><code id="msmResid_+3A_regime">regime</code></td>
<td>

<p>a number or a vector indicating which regimes are selected to get its residuals. If is missing, the function calculates the conditional residuals of the model.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with the pooled residuals or a matrix, when more than one regime is indicated, containing the residuals for each 
observation. When the attributed object is a glm, it returns the Pearson residuals.
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='plot-methods'> Function: plot for Markov Switching Models </h2><span id='topic+plot'></span><span id='topic+plot-methods'></span><span id='topic+plot+2CMSM.linear+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot that shows the rediduals for each regime with the conditional residuals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p> an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;. </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_y">y</code></td>
<td>
<p> currently not used. </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_...">...</code></td>
<td>
<p> currently not used. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='plotDiag'>
Plot Diagnostics for an msm Object
</h2><span id='topic+plotDiag'></span><span id='topic+plotDiag-methods'></span><span id='topic+plotDiag+2CMSM.linear+2CANY-method'></span><span id='topic+plotDiag+2CMSM.linear+2Cmissing-method'></span><span id='topic+plotDiag+2CMSM.linear+2Cmissing+2CANY-method'></span>

<h3>Description</h3>

<p>Creates several plots for the residual analysis. It shows a plot of residuals against fitted values, a Normal Q-Q plot, ACF/PACF of 
residuals and ACF/PACF of square residuals. Depending on the selection, it shows the pooled residuals or the residuals for each regime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDiag(x, regime, which)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDiag_+3A_x">x</code></td>
<td>

<p>an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;.
</p>
</td></tr>
<tr><td><code id="plotDiag_+3A_regime">regime</code></td>
<td>

<p>a single numeric value or vector indicating the regimes to show its residuals. In order to show all the regimes, it could be written 
<code>all</code>.
</p>
</td></tr>
<tr><td><code id="plotDiag_+3A_which">which</code></td>
<td>

<p>if a subset of the plots is required, specify a subset of the numbers 1:3. The default value is <code>c(1:3)</code>. See details for more information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>which</code> has three values:
</p>
<p>- <code>1</code>: represents the plot of residuals against fitted values. 
</p>
<p>- <code>2</code>: represents the Normal Q-Q plot. 
</p>
<p>- <code>3</code>: represents the ACF/PACF of residuals and ACF/PACF of square residuals. 
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='plotProb'>
Plot of filtered and smoothed probabilities with regimes specifications.
</h2><span id='topic+plotProb'></span><span id='topic+plotProb-methods'></span><span id='topic+plotProb+2CMSM.linear-method'></span><span id='topic+plotProb+2CMSM.linear+2CANY-method'></span>

<h3>Description</h3>

<p>Creates one plot (or more, depending on the number of states) that contains, for each regime, its smoothed and filtered probabilities. Finally, 
it shows a plot for each regime with the response variable versus the smoothed probabilities, showing the periods where the variable is in 
that regime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProb(x, which)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProb_+3A_x">x</code></td>
<td>

<p>an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;.</p>
</td></tr>
<tr><td><code id="plotProb_+3A_which">which</code></td>
<td>

<p>if a subset of the plots is required, specify a subset of the numbers 1:(number of regimes +1). See details for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>which</code> has  options:
</p>
<p>-<code>1</code>: represents the plots that contains, for each regime, its smoothed and filtered probabilities..
</p>
<p>-<code>2:(number of regimes +1)</code>: represents plot of the regime minus one with the response variable against the smoothed probabilities.
</p>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='plotReg'>
Comparative plots of response and explanatory variables with regime specifications.
</h2><span id='topic+plotReg'></span><span id='topic+plotReg-methods'></span><span id='topic+plotReg+2CMSM.linear+2Ccharacter-method'></span><span id='topic+plotReg+2CMSM.linear+2Cmissing-method'></span>

<h3>Description</h3>

<p>Creates a plot with the response and the explanatory variables with the smoothed probabilities of a specific regime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotReg(x, expl, regime = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotReg_+3A_x">x</code></td>
<td>
<p> an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;.
</p>
</td></tr>
<tr><td><code id="plotReg_+3A_expl">expl</code></td>
<td>
<p> a character vector containing the names of the covariates of the model to show. If it is missing, all the variables are plotted.
</p>
</td></tr>
<tr><td><code id="plotReg_+3A_regime">regime</code></td>
<td>

<p>a numeric value indicating which regime has to be shown. By defect the value is 1.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='summary-methods'> Function: Summary for Markov Switching Models</h2><span id='topic+summary'></span><span id='topic+summary-methods'></span><span id='topic+summary+2CMSM.glm-method'></span><span id='topic+summary+2CMSM.lm-method'></span>

<h3>Description</h3>

<p><code>summary</code> produces results summaries of the results of fitting Markov Switching Models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSM.lm'
summary(object)
## S4 method for signature 'MSM.glm'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p> an object of class &quot;MSM.lm&quot; or &quot;MSM.glm&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose A. Sanchez-Espigares, Alberto Lopez-Moreno
</p>


<h3>See Also</h3>

<p>Overview: <code><a href="#topic+MSwM-package">MSwM-package</a></code> <br />
Classes : <code><a href="#topic+MSM.lm-class">MSM.lm</a></code>, <code><a href="#topic+MSM.glm-class">MSM.glm</a></code>, <code><a href="#topic+MSM.fitted-class">MSM.fitted</a></code><br />
Methods : <code><a href="#topic+msmFit">msmFit</a></code>,<code><a href="#topic+summary">summary</a></code>,<code><a href="#topic+AIC">AIC</a></code>,<code><a href="#topic+intervals">intervals</a></code>,<code><a href="#topic+msmResid">msmResid</a></code><br />
Plot : <code><a href="#topic+plot">plot</a></code>,<code><a href="#topic+plotProb">plotProb</a></code>,<code><a href="#topic+plotReg">plotReg</a></code>,<code><a href="#topic+plotDiag">plotDiag</a></code><br />
</p>

<hr>
<h2 id='traffic'>
Traffic Deads in Spain
</h2><span id='topic+traffic'></span>

<h3>Description</h3>

<p>The <code>traffic</code> data contains the daily number of deaths in traffic accidents in Spain during the year 2010, the average daily temperature and
the daily sum of precipitations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(traffic)</code></pre>


<h3>Format</h3>

<p>A data frame with 210 observations on the following 2 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p> The date of each observation in format DD/MM/YYYY.</p>
</dd>
<dt><code>NDead</code></dt><dd><p> The number of daily traffic deaths.</p>
</dd>
<dt><code>Temp</code></dt><dd><p> The daily mean temperature in Spain (Celsius).</p>
</dd>
<dt><code>Prec</code></dt><dd><p> The daily mean precipitation in Spain (l/m2).</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtained from the General Directorate of Traffic (Direccion General de Trafico) and the State Meteorological Agency of Spain (Agencia Estatal de Meterorologia de Espanya).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data=data(traffic)
	ts.plot(traffic$NDead)
	
##See the vignette
#vignette("examples")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
