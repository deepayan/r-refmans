<!DOCTYPE html><html lang="en"><head><title>Help for package pvldcurve</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pvldcurve}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ApplyCombMod'><p>Apply a combined exponential and linear model</p></a></li>
<li><a href='#ApplyCombMod2'><p>Apply a combined exponential and linear model</p></a></li>
<li><a href='#Conductance'><p>Leaf Conductance</p></a></li>
<li><a href='#ExtractFitParam'><p>Extracts the fitting parameters from results list</p></a></li>
<li><a href='#ExtractParam'><p>Extracts parameters from result list</p></a></li>
<li><a href='#FitLeafArea'><p>Leaf area fitting</p></a></li>
<li><a href='#FittedFW'><p>Correct continuous fresh weight measurements</p></a></li>
<li><a href='#FWSaturated'><p>Saturated fresh weight estimation</p></a></li>
<li><a href='#Gmin'><p>Minimum leaf conductance</p></a></li>
<li><a href='#leaf_drying_data'><p>Experimentally determined leaf drying data</p></a></li>
<li><a href='#MergeDf'><p>Merges data to data frames</p></a></li>
<li><a href='#ModElasticity'><p>Modulus of elasticity</p></a></li>
<li><a href='#OrderCheck'><p>Order Check</p></a></li>
<li><a href='#OsmoticPot'><p>Pressure Volume Curve Analysis</p></a></li>
<li><a href='#PlotOutput'><p>Plot Output</p></a></li>
<li><a href='#pressure_volume_data'><p>Pressure volume curve data</p></a></li>
<li><a href='#RelativeWaterContent'><p>Relative Water Content (RWC)</p></a></li>
<li><a href='#RelativeWaterDeficit'><p>Relative Water Deficit (RWD)</p></a></li>
<li><a href='#RWDInterval'><p>Mean relative water deficit (RWD) of an interval</p></a></li>
<li><a href='#SaturationVaporPressure'><p>Saturation vapor pressure (VPsat)</p></a></li>
<li><a href='#StomatalClosure'><p>Point of stomatal closure</p></a></li>
<li><a href='#TimeInterval'><p>Time Interval</p></a></li>
<li><a href='#TimeSinceStart'><p>Time Since Start</p></a></li>
<li><a href='#Transpiration'><p>Leaf transpiration</p></a></li>
<li><a href='#TurgorLossPoint'><p>Turgor Loss Point</p></a></li>
<li><a href='#ValidityCheck'><p>Ensures the validity of the input data</p></a></li>
<li><a href='#ValidityCheckDetail'><p>Checks if column exists in data, is numeric and has the same lenghts as the others existence</p></a></li>
<li><a href='#VaporPressureDeficit'><p>Vapor Pressure Deficit (VPD)</p></a></li>
<li><a href='#weather_data'><p>Weather data</p></a></li>
<li><a href='#WeatherAllocation'><p>Weather Allocation</p></a></li>
<li><a href='#WeightDifference'><p>Weight Difference</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simplifies the Analysis of Pressure Volume and Leaf Drying
Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.6</td>
</tr>
<tr>
<td>Depends:</td>
<td>ggplot2, R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplifies the manufacturing, analysis and display of pressure volume and leaf drying curves. From the progression of the curves turgor loss point, osmotic potential, apoplastic fraction as well as minimum conductance and stomatal closure can be derived. Methods adapted from Bartlett, Scoffoni, Sack (2012) &lt;<a href="https://doi.org/10.1111%2Fj.1461-0248.2012.01751.x">doi:10.1111/j.1461-0248.2012.01751.x</a>&gt; and Sack, Scoffoni, PrometheusWikiContributors (2011) <a href="http://prometheuswiki.org/tiki-index.php?page=Minimum+epidermal+conductance+%28gmin%2C+a.k.a.+cuticular+conductance%29">http://prometheuswiki.org/tiki-index.php?page=Minimum+epidermal+conductance+%28gmin%2C+a.k.a.+cuticular+conductance%29</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-08-24 15:29:59 UTC; Anna</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Raesch [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Raesch &lt;annaraesch@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-05 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ApplyCombMod'>Apply a combined exponential and linear model</h2><span id='topic+ApplyCombMod'></span>

<h3>Description</h3>

<p>a non linear model combining an exponential and a linear fit is applied to the data using the Gauss-Newton algorithm of nls.
starting values are calculated
based on the data. Weights are applied to the model based on the estimated insecurity of the data quality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ApplyCombMod(data, y = "y", x = "x")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ApplyCombMod_+3A_data">data</code></td>
<td>
<p>data frame containg x and y data to which the model is ought to be applied to</p>
</td></tr>
<tr><td><code id="ApplyCombMod_+3A_y">y</code></td>
<td>
<p>name of column in data containing y data</p>
</td></tr>
<tr><td><code id="ApplyCombMod_+3A_x">x</code></td>
<td>
<p>name of column in data containing x data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model parameters
</p>

<hr>
<h2 id='ApplyCombMod2'>Apply a combined exponential and linear model</h2><span id='topic+ApplyCombMod2'></span>

<h3>Description</h3>

<p>a non linear model combining an exponential and a linear fit is applied to the data using nls. starting values are calculated
based on the data. Constraints are applied to the model based on the known constraints of the aimed model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ApplyCombMod2(data, y = "y", x = "x")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ApplyCombMod2_+3A_data">data</code></td>
<td>
<p>data frame containg x and y data to which combined exponentail and linear model is ought to be applied to</p>
</td></tr>
<tr><td><code id="ApplyCombMod2_+3A_y">y</code></td>
<td>
<p>name of column in data containing y data</p>
</td></tr>
<tr><td><code id="ApplyCombMod2_+3A_x">x</code></td>
<td>
<p>name of column in data containing x data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model parameters
</p>

<hr>
<h2 id='Conductance'>Leaf Conductance</h2><span id='topic+Conductance'></span>

<h3>Description</h3>

<p>Calculates mole-based or concentraction-based conductance (stomatal or minimal
conductance) (mmol s^-1 m^-2 or mm s^-1) of the double-sided leaf area by experimental weight loss
data and weather data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Conductance(data, sample = "sample", fresh.weight = "fitted.fw",
  date.and.time = "date.and.time", leaf.area = "leaf.area",
  humidity = "humidity", temperature = "temperature",
  atmospheric.pressure = 101.35, driving.force = "mole")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Conductance_+3A_data">data</code></td>
<td>
<p>data frame, with columns of equal length containg at least columns with
time (and date) of the fresh weight measurements,the measured fresh
weights (g) and the single-sided leaf area (cm^2) of the sample as well as the average relative
humidity (%) and temperature (degree Celsius) during the measurement intervals. The data is to be ordered chronologically by sample.
A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="Conductance_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID; default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="Conductance_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the numeric fresh weight values (g);
default: &quot;fitted.fw&quot; (fresh weight corrected by noises as outputted for leaf drying curves by the function FittedFW)</p>
</td></tr>
<tr><td><code id="Conductance_+3A_date.and.time">date.and.time</code></td>
<td>
<p>optional name of the column in data containing the time of the fresh weight measurements
as class POSIXct; default: &quot;date.and.time&quot;</p>
</td></tr>
<tr><td><code id="Conductance_+3A_leaf.area">leaf.area</code></td>
<td>
<p>optional name of the column in data containing the numeric single-sided leaf area values (cm^2);
default: &quot;leaf.area&quot;</p>
</td></tr>
<tr><td><code id="Conductance_+3A_humidity">humidity</code></td>
<td>
<p>optional name of the column in data containing the numeric humidity values (%);
default: &quot;humidity&quot;</p>
</td></tr>
<tr><td><code id="Conductance_+3A_temperature">temperature</code></td>
<td>
<p>optional name of the column in data containing the numeric temperature values (degree Celsius);
default: &quot;temperature&quot;</p>
</td></tr>
<tr><td><code id="Conductance_+3A_atmospheric.pressure">atmospheric.pressure</code></td>
<td>
<p>optional, giving the numeric atmospheric pressure in kPA, default = 101.325 (atmospheric pressure at sea level)</p>
</td></tr>
<tr><td><code id="Conductance_+3A_driving.force">driving.force</code></td>
<td>
<p>optional; possible values: mole or conc; defines whether conductance is expressed on the basis
of a mole fraction-based (default) or a concentration-based driving force</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates mole-based conductance (mmol s^-1 m^-2) as:
</p>
<p style="text-align: center;"><code class="reqn">g = T / VPD</code>
</p>

<p>whereas T = transpiration (mmol s^-1 m^-2) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">T = \Delta FM * 1000 * (\Delta t * 60 * LA * 2 /10000 * 18.01528)^-1</code>
</p>

<p>whereas <code class="reqn">\Delta</code>FM = fresh matter reduction (g), <code class="reqn">\Delta</code>t = time interval (min),
LA = single-sided leaf area (cm^2)
and VPD = vapor pressure deficit (mol * mol^-1) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn"> VPD = (1 - RH / 100) * (VPsat / AP)</code>
</p>

<p>whereas RH = relative humidity (%), VPsat = saturation vapor pressure (kPA),
AP = atmospheric pressure (kPA), whereas:
</p>
<p style="text-align: center;"><code class="reqn">VPsat = 0.61121 * exp ((18.678 - T / 234.5) (T * 257.14 + T))</code>
</p>

<p>where T = air temperature (degree Celsius) <br /> <br />
Concentration based conductance (mm s^-1) is derived from mole-based conductance g(mol) as:
</p>
<p style="text-align: center;"><code class="reqn">g(conc) = g(mol) * R * (T + 273.15) / AP / 1000</code>
</p>

<p>whereas: R = gas constant (8.3144598 J (mol * K)^-1) and T = absolute temperature (degree Celsius)
</p>


<h3>Value</h3>

<p>The original data frame extended by a numeric column with the mole-based or the concentration-
based conductance (mmol s^-1 m^-2, mm s^-1) of
the double-sided leaf area (conductance). The first value of each sample is NA since conductance values are computed
from row i and i-1
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
weight_loss_data &lt;- leaf_drying_data
weather_data &lt;- weather_data
df &lt;- WeatherAllocation(weight_loss_data, weather_data)   # allocate weather to weight loss data

# extend the data frame by mole-based conductance values
df_with_conductance &lt;- Conductance(df, fresh.weight = "fresh.weight")

# extend the data frame by concentration-based conductance values
df_with_conductance &lt;- Conductance(df, fresh.weight = "fresh.weight", driving.force = "conc")

# calculate with atmospheric pressure of 99.8 kPA
df_with_conductance &lt;- Conductance(df, fresh.weight = "fresh.weight", atmospheric.pressure = 99.8)

</code></pre>

<hr>
<h2 id='ExtractFitParam'>Extracts the fitting parameters from results list</h2><span id='topic+ExtractFitParam'></span>

<h3>Description</h3>

<p>Extracts the coefficients and confidence intervals from the fitting results of the functions analysing the pressure volume curve
(TurgorLossPoint, OsmoticPot and ModElasticity) or the functions analysing the leaf drying curve
(StomatalClosure and Gmin)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtractFitParam(result_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExtractFitParam_+3A_result_list">result_list</code></td>
<td>
<p>output list from the functions TurgorLossPoint, OsmoticPot, ModElasticity,
StomatalClosure or Gmin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing the coefficients and the 0.95 confidence interval of the coefficients from the fit
</p>

<hr>
<h2 id='ExtractParam'>Extracts parameters from result list</h2><span id='topic+ExtractParam'></span>

<h3>Description</h3>

<p>Extracts the curve parameters from the result lists of the functions analysing the pressure volume curve
(TurgorLossPoint, OsmoticPot and ModElasticity) or the functions analysing the leaf drying curve
(StomatalClosure and Gmin)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtractParam(result_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExtractParam_+3A_result_list">result_list</code></td>
<td>
<p>output list from the functions TurgorLossPoint, OsmoticPot, ModElasticity,
StomatalClosure or Gmin</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing the results from the curve analysis only, depending on the function used, relative water deficit at
turgor loss point (rwd.tlp), water potential at turgor loss point (water.pot.tlp), apoplastic fraction (apo.fract),
osmotic potential at full saturation (osmotic.pot.full.sat), modulus of elasticity (modulus.elasticity),
time since start of desiccation of stomatal closure (stom.clos.time), relative water deficit at stomatal closure
(stom.clos.rwd), minimum conductance determined by the intercept of the leaf drying curve fit with the point of stomatal closure
(stom.clos.gmin), by taking the mean from all minimum conductance values
(mean.gmin) or minimum conductance determined by extrapolation of minimum conductance curve linearly to full
saturation (gmin.full.sat)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use pressure volume data provided by package
pv_data &lt;- pressure_volume_data

# do pressure volume curve analysis
pv_data &lt;- RelativeWaterDeficit(pv_data)
results &lt;- OsmoticPot(pv_data, graph = FALSE)

# extract curve values
ExtractParam(results)


</code></pre>

<hr>
<h2 id='FitLeafArea'>Leaf area fitting</h2><span id='topic+FitLeafArea'></span>

<h3>Description</h3>

<p>Fits randomly measured leaf area values linearly to fresh weight values. Useful if the leaf area changes during a measurement
series but is only randomly measured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitLeafArea(data, sample = "sample", fresh.weight = "fresh.weight",
  leaf.area = "leaf.area")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitLeafArea_+3A_data">data</code></td>
<td>
<p>data frame, with columns of equal length, containing at least columns with the the fresh.weight (g)
and the leaf.area (cm^2) values, ordered by sample by descending fresh weight. A column containing the sample IDs is optionally required
if several samples were measured.At least 3 leaf area values are required.</p>
</td></tr>
<tr><td><code id="FitLeafArea_+3A_sample">sample</code></td>
<td>
<p>string, optional name of the column in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="FitLeafArea_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the numeric fresh weight values (g);
default: &quot;fresh.weight&quot;</p>
</td></tr>
<tr><td><code id="FitLeafArea_+3A_leaf.area">leaf.area</code></td>
<td>
<p>optional name of the column in data containing the numeric single-sided leaf area values (cm^2);
default: &quot;leaf.area&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fits given leaf area values linearly to the respective fresh weight values and calculates leaf area values
for the fresh weight values based on the fit
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column containing the fitted leaf area values (leaf.area.fitted)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- data.frame(
  sample = c(as.integer(rep(1, times = 6))),
  fresh.weight = c(1.23, 1.19, 1.15, 1.12, 1.09, 1.0),
  leaf.area = c(10.5, NA, NA, 9.8, NA, 8.4))
# fit leaf area
df_new &lt;- FitLeafArea(df)

</code></pre>

<hr>
<h2 id='FittedFW'>Correct continuous fresh weight measurements</h2><span id='topic+FittedFW'></span>

<h3>Description</h3>

<p>Corrects fresh weight, measured continuously on a desiccating leaf for determination of minimum conductance, by fitting
the fresh weight values to a combined exponential and linear model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FittedFW(data, sample = "sample", fresh.weight = "fresh.weight",
  time.since.start = "time.since.start", graph = TRUE,
  show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FittedFW_+3A_data">data</code></td>
<td>
<p>data frame, at least with a column containing numeric fresh weight (g) and time since start (min) values,
ordered by sample by descending fresh.weight.
A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="FittedFW_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample IDs, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="FittedFW_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the fresh weight values (g), default: &quot;fresh weight&quot;</p>
</td></tr>
<tr><td><code id="FittedFW_+3A_time.since.start">time.since.start</code></td>
<td>
<p>optional name of the column in data containing the time since start (min) values, default: &quot;time.since.start&quot;</p>
</td></tr>
<tr><td><code id="FittedFW_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="FittedFW_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Determination of minimum conductance via a leaf drying curve requires fresh weight to be measured continuously on a
desiccating leaf. The fresh weight values are then used to calculate leaf conductance. If several leaves are measured on one scale, the
measurements are prone to noises, which influence conductance values largely. Here, the fresh weight data is corrected for noises by
fitting it to a combined linear and exponential model using the port algorithm of nls(). <br />
Before using this function, check the raw
data for an initial plateau. If the exponential decline does not onset directly, fitting might not succeed.
</p>


<h3>Value</h3>

<p>the original data frame (data) extended by a numeric column containing the fitted fresh weight values (&quot;fitted.fw&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- TimeSinceStart(leaf_drying_data)
# remove plateauing data
df &lt;- df[df$fw.plateau != "yes",]
# extend the data frame by saturated fresh weight
df &lt;- FittedFW(df)

</code></pre>

<hr>
<h2 id='FWSaturated'>Saturated fresh weight estimation</h2><span id='topic+FWSaturated'></span>

<h3>Description</h3>

<p>Calculates saturated fresh weight by fitting fresh weight values above the turgor loss point linearly to water potential values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FWSaturated(data, sample = "sample",
  water.potential = "water.potential", fresh.weight = "fresh.weight",
  dry.weight = "dry.weight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FWSaturated_+3A_data">data</code></td>
<td>
<p>data frame, at least with a column containing numeric water potential (bar), fresh.weight (g) and dry.weight (g) values,
ordered by sample by descending water potential.
A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="FWSaturated_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample IDs, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="FWSaturated_+3A_water.potential">water.potential</code></td>
<td>
<p>optional name of the column in data containing the water potential values (bar), default = &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="FWSaturated_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the fresh weight values (g), default: &quot;fresh weight&quot;</p>
</td></tr>
<tr><td><code id="FWSaturated_+3A_dry.weight">dry.weight</code></td>
<td>
<p>optional name of the column containing the dry weight values (g), default: &quot;dry.weight&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Above the turgor loss point, a linear relationship between water content and water potential exists. Based on this premise,
saturated water content is found where water potential is zero. First, turgor loss point is calculated based on the relative leaf water
loss (fresh weight minus dry weight relativized by the maximum
leaf water content value). Then, data above the turgor loss point is extracted and fresh weight is fitted linearly to water potential.
The point where water potential of the linear regression line is zero is the saturated water content.
</p>


<h3>Value</h3>

<p>the original data frame (data) extended by a numeric column containing the saturated fresh weight values (&quot;fresh.weight.saturated&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- pressure_volume_data
# extend the data frame by saturated fresh weight
df &lt;- FWSaturated(df)

</code></pre>

<hr>
<h2 id='Gmin'>Minimum leaf conductance</h2><span id='topic+Gmin'></span>

<h3>Description</h3>

<p>Determines mean minimum leaf conductance and minimum leaf conducance at full turgidity and stomatal closure in
experimentally obtained water loss curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gmin(data, sample = "sample", time.since.start = "time.since.start",
  conductance = "conductance", RWD = "RWD.interval",
  stom.clos.threshold = FALSE, graph = TRUE, show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gmin_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving the
coordinates of the curve: time since start (minutes), conductance (mmol m^-2 s^-1) and RWD (%), ordered by sample by ascending time
since start. A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="Gmin_+3A_sample">sample</code></td>
<td>
<p>optional column name in data containing the sample ID, default: sample</p>
</td></tr>
<tr><td><code id="Gmin_+3A_time.since.start">time.since.start</code></td>
<td>
<p>optional column name in data containing the numerical values for time since start of
the experiment (min), default: time.since.start</p>
</td></tr>
<tr><td><code id="Gmin_+3A_conductance">conductance</code></td>
<td>
<p>optional column name in data containing the numerical conductance values (mmol m^-2 s^-1), default:
&quot;conductance&quot;</p>
</td></tr>
<tr><td><code id="Gmin_+3A_rwd">RWD</code></td>
<td>
<p>optional column name in data containing the numerical relative water deficit values (%), default: &quot;RWD.interval&quot; (RWD
average of an interval, as outputted by RWDInterval)</p>
</td></tr>
<tr><td><code id="Gmin_+3A_stom.clos.threshold">stom.clos.threshold</code></td>
<td>
<p>threshold value for stomatal closure. Automatic determination by default.</p>
</td></tr>
<tr><td><code id="Gmin_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="Gmin_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates of stomatal closure are determined via the function StomatalClosure(). <br />
Conductance data including and following stomatal closure are then extracted and the average is taken (mean.gmin). A linear regression is
applied to the data and the y axis intercept (gmin.full.sat) and the coordinate at the RWD point of stomatal
closure (lin.gmin) are calculated from the function. <br /> <br />
Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table role = "presentation">
<tr><td><code>gmin</code></td>
<td>
<p>mean minimum conductance (mean.gmin) (mmol m^-2 s^-1) after stomatal closure of the measurement interval,
minimum conductance at full saturation (gmin.full.sat) (mmol m^-2 s^-1) and minimum conductance at stomatal closure based on the linear
fit (lin.gmin) (mmol m^-2 s^-1)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the linear regression of gmin vs. RWD</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of linear fit</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted original data is displayed with the x-axis intercept of the point of
stomatal closure and the linear regression line of gmin showing the point of y-intercept (gminfullsat).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- WeatherAllocation(leaf_drying_data, weather_data)   # allocate weather to weight loss data
df &lt;- TimeSinceStart(df) # calculate time since start
df &lt;- df[df$fw.plateau != "yes",] # remove plateauing data
df &lt;- FittedFW(df, graph = FALSE) # correct noises in fresh weight
df &lt;- RWDInterval(df, fresh.weight = "fitted.fw") # calculate RWD based in the intervals
df &lt;- Conductance(df, fresh.weight = "fitted.fw") # calculate conductance

# calculate gmin and plot graphs
gmin &lt;- Gmin(df)

</code></pre>

<hr>
<h2 id='leaf_drying_data'>Experimentally determined leaf drying data</h2><span id='topic+leaf_drying_data'></span>

<h3>Description</h3>

<p>A dataset containing repeatedly measured fresh weights of transpiring leaves subjected to
different soil moisture conditions during their growth (n = 6) and their saturated fresh weight and dry weight.
togeher with their saturated fresh weight, their fresh weight before saturation, their dry weight and leaf area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaf_drying_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 172 rows and 9 variables:</p>


<h3>Details</h3>


<ul>
<li><p> treatment: Soil moisture conditions during the last 6 days of Kohlrabi growth (10-30 
</p>
</li>
<li><p> sample: Sample ID (1 - 12)
</p>
</li>
<li><p> dry.weight: Dry weight of the sample in gramm (0.3922 - 0.6692)
</p>
</li>
<li><p> fresh.weight.harvest: Fresh weight directly after cutting before over night saturation of the sample in gramm (2.8062 - 7.1009)
</p>
</li>
<li><p> fresh.weight.saturated: Saturated fresh weight of the sample in gramm (4.2186 - 7.3179)
</p>
</li>
<li><p> leaf.area: leaf area of the sample in cm^2 (91 - 148)
</p>
</li>
<li><p> date.and.time: Time (and date) of the fresh weight measurement of the transpiring sample (2019-03-26 09:48:00 - 2019-03-27 09:51:00)
</p>
</li>
<li><p> fresh.weight. Fresh weight of the transpiring sample in gramm (3.5112 - 7.3179)
</p>
</li>
<li><p> fw.plateau: Indicates plateauing fresh.weight values before the onset of the exponential decline. Remove values for analysis where fw.plateau = yes
</p>
</li></ul>


<hr>
<h2 id='MergeDf'>Merges data to data frames</h2><span id='topic+MergeDf'></span>

<h3>Description</h3>

<p>merges data frames containing all neccessary informations for plotting with PlotOutput()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MergeDf(x, y, y2 = FALSE, y3 = FALSE, legend, legend.y2 = FALSE,
  legend.y3 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MergeDf_+3A_x">x</code></td>
<td>
<p>vector containing the x values</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y">y</code></td>
<td>
<p>vector containing the y values</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y2">y2</code></td>
<td>
<p>optional vector containing the values for the second y coordinates</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_y3">y3</code></td>
<td>
<p>optional vector containing the values for the third y coordinates</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend">legend</code></td>
<td>
<p>name of the y values in the legend</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend.y2">legend.y2</code></td>
<td>
<p>optional name of the second y values in the legend</p>
</td></tr>
<tr><td><code id="MergeDf_+3A_legend.y3">legend.y3</code></td>
<td>
<p>optional name of the third y values in the legend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with columns containing all above information in equalized length as requested by gglot
</p>

<hr>
<h2 id='ModElasticity'>Modulus of elasticity</h2><span id='topic+ModElasticity'></span>

<h3>Description</h3>

<p>Determines pressure potential and the modulus of elasticity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModElasticity(data, sample = "sample",
  water.potential = "water.potential", RWD = "RWD", graph = TRUE,
  show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ModElasticity_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving the numerical
coordinates of the curve: water potential (bar) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_sample">sample</code></td>
<td>
<p>optional column name in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_water.potential">water.potential</code></td>
<td>
<p>optional column name in data containing the water potential values of the leaf
(bar), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_rwd">RWD</code></td>
<td>
<p>optional column name in data containing the relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="ModElasticity_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water deficit at turgor loss point is determined via the function TurgorLossPoint() and
osmotic potential is calculated via the function OsmoticPot(). <br /> <br /> Pressure potential is derived by
subtracting osmotic potential from water potential. The part of the pressure potential prior the turgor loss
point is then fitted linearly and the modulus of elasticity (M.Elasticity) equals the slope of the fitted line. <br /> <br />
Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table role = "presentation">
<tr><td><code>modulus.elasticity</code></td>
<td>
<p>modulus of elasticity (bar)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the transformed linear osmotic potential fit (1/-bar) and the pressure potential (bar) fit</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of the osmotic (1/-bar) and pressure potential (bar) fit</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the original data is displayed with the x- and y-axis intercepts of the turgor loss
point, the osmotic potential fit and
the linear regression line of the pressure potential.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get example data, calculate Relative Water Deficit
data &lt;- RelativeWaterDeficit(pressure_volume_data)[pressure_volume_data$sample == 1, ]

# determine modulus of elasticity and the fitting parameters. Do not plot results.
m_elasticity &lt;- ModElasticity(data, graph = FALSE)

</code></pre>

<hr>
<h2 id='OrderCheck'>Order Check</h2><span id='topic+OrderCheck'></span>

<h3>Description</h3>

<p>Checks for the correct ordering of the data: increasing for date.and.time and time.since start, decreasing for fresh.weight and
water.potential. Done separatly for each sample. An individualized warning is printed if not ordered correctly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrderCheck(data, sample = FALSE, date.and.time = FALSE,
  fresh.weight = FALSE, water.potential = FALSE,
  time.since.start = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OrderCheck_+3A_data">data</code></td>
<td>
<p>data frame containing the data to be checked</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_sample">sample</code></td>
<td>
<p>name of the column containing the sample IDs, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_date.and.time">date.and.time</code></td>
<td>
<p>name of the column containing the date and time (POSIXct) of the measurements, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>name of the column containing the numeric fresh weight values, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_water.potential">water.potential</code></td>
<td>
<p>name of the column containing the numeric water potential values, if present in data</p>
</td></tr>
<tr><td><code id="OrderCheck_+3A_time.since.start">time.since.start</code></td>
<td>
<p>name of the column containing the numeric time since start values, if present in data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

<hr>
<h2 id='OsmoticPot'>Pressure Volume Curve Analysis</h2><span id='topic+OsmoticPot'></span>

<h3>Description</h3>

<p>Determines the coordinates of the turgor loss point, osmotic potential at full hydration
and apoplastic fraction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OsmoticPot(data, sample = "sample",
  water.potential = "water.potential", RWD = "RWD", graph = TRUE,
  show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OsmoticPot_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving the numerical
coordinates of the curve: water potential (bar) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_sample">sample</code></td>
<td>
<p>optional column name in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_water.potential">water.potential</code></td>
<td>
<p>optional column name in data containing the numeric water potential values
(bar), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_rwd">RWD</code></td>
<td>
<p>optional column name in data containing the relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="OsmoticPot_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RWD at turgor loss point is derived by the function TurgorLossPoint(). <br /> <br />
The pressure-volume curve data is converted to -1/bar. The osmotic potential is then derived by fitting a linear
regression line with the Gauss-Newton algorithm of nls() to the water potential data following the turgor loss point. The y- and
x-axis intercept of the regression line gives the osmotic potential at full hydration (op.full.sat) and the apoplastic fraction
(apo.fract), respectively. Water potential at turgor loss point equals the value of the osmotic potential fit at the relative
water deficit at turgor loss point.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table role = "presentation">
<tr><td><code>turgor.loss.point</code></td>
<td>
<p>x and y coordinates of the turgor loss point (RWD (%) and water.potential (bar), respectively)</p>
</td></tr>
<tr><td><code>osmotic.potential</code></td>
<td>
<p>x and y intercepts of the osmotic potential fit (apoplasic fraction (apo.fract) (%) and op.full.sat (bar), respectively)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the linear osmotic potential fit</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of the linear model</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted tranformed data is displayed with the x- and y-axis
intercepts of the turgor loss point and the
linear regression line of the osmotic potential showing the point of y-intercept (op.full.sat) and x-intercept (apo.fract). <br />
Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data, calculate Relative Water Deficit
data &lt;- RelativeWaterDeficit(pressure_volume_data)

# calculate pressure volume curve characteristics and plot graphs
pv_analysis &lt;- OsmoticPot(data)

</code></pre>

<hr>
<h2 id='PlotOutput'>Plot Output</h2><span id='topic+PlotOutput'></span>

<h3>Description</h3>

<p>plots the data as specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotOutput(sub.sample, x, y, y2 = FALSE, y3 = FALSE, legend.y,
  legend.y2 = FALSE, legend.y3 = FALSE, x.axis, y.axis,
  x.intercept = FALSE, y.intercept = FALSE,
  legend.x.intercept = FALSE, line.x, line.y, line.y2 = FALSE,
  line.y3 = FALSE, legend.line.y, legend.line.y2 = FALSE,
  legend.line.y3 = FALSE, show.legend = show.legend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotOutput_+3A_sub.sample">sub.sample</code></td>
<td>
<p>sample ID</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x">x</code></td>
<td>
<p>vector containing the x coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y">y</code></td>
<td>
<p>vector containing the y coodinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y2">y2</code></td>
<td>
<p>optional vector containing the second y coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y3">y3</code></td>
<td>
<p>optional vector containing the third y coordinates of the data to be plotted as points</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y">legend.y</code></td>
<td>
<p>string, name of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y2">legend.y2</code></td>
<td>
<p>string, optional name of second set of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.y3">legend.y3</code></td>
<td>
<p>string, optional name of third set of data points to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x.axis">x.axis</code></td>
<td>
<p>string, label of x axis</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y.axis">y.axis</code></td>
<td>
<p>sring, label of y axis</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_x.intercept">x.intercept</code></td>
<td>
<p>vector containg the x coordinate of the intercept</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_y.intercept">y.intercept</code></td>
<td>
<p>optional vector containg the y coordinate of the intercept</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.x.intercept">legend.x.intercept</code></td>
<td>
<p>string, name of x.intercept to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.x">line.x</code></td>
<td>
<p>vector containing the x coordinate for the lines</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y">line.y</code></td>
<td>
<p>vector containing the y coordinates for the line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y2">line.y2</code></td>
<td>
<p>vector containing the y coordinates for the second line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_line.y3">line.y3</code></td>
<td>
<p>vector containing the y coordinates for the second line</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y">legend.line.y</code></td>
<td>
<p>string, name of line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y2">legend.line.y2</code></td>
<td>
<p>string, name of second line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_legend.line.y3">legend.line.y3</code></td>
<td>
<p>string, name of third line to be printed in the legend</p>
</td></tr>
<tr><td><code id="PlotOutput_+3A_show.legend">show.legend</code></td>
<td>
<p>boolean, specifies whether a legend is to be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>graphic
</p>

<hr>
<h2 id='pressure_volume_data'>Pressure volume curve data</h2><span id='topic+pressure_volume_data'></span>

<h3>Description</h3>

<p>A dataset containing water potential and fresh weight measurements of repeatedly measured drying kohlrabi leaves subjected to
different soil moisture conditions during their growth (n = 6) and their saturated fresh weight and dry weight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pressure_volume_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 160 rows and 8 variables</p>


<h3>Details</h3>


<ul>
<li><p> date: Date of measurement
</p>
</li>
<li><p> treatment: Soil moisture conditions during the last 6 days of Kohlrabi growth (10-30 
</p>
</li>
<li><p> sample: Sample ID (1 - 12)
</p>
</li>
<li><p> fresh.weight.harvest: Fresh weight measured at harvest (12 h prior measurement of fresh.weight.saturated) (2.9813 - 7.1557)
</p>
</li>
<li><p> fresh.weight.saturated: Saturated fresh weight of the leaf in gramms (4.1276 - 7.0867)
</p>
</li>
<li><p> fresh.weight: Fresh weight of the leaf in gramms (2.7215 - 6.8246)
</p>
</li>
<li><p> dry.weight: Dry weight of the leaf in gramms (0.2937 - 0.7267)
</p>
</li>
<li><p> water.potential: Water potential of the leaf in bar (-16.2 - -2.4)
</p>
</li></ul>


<hr>
<h2 id='RelativeWaterContent'>Relative Water Content (RWC)</h2><span id='topic+RelativeWaterContent'></span>

<h3>Description</h3>

<p>Calculates relative water content (RWC, %)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelativeWaterContent(data, fresh.weight = "fresh.weight",
  dry.weight = "dry.weight",
  fresh.weight.saturated = "fresh.weight.saturated")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RelativeWaterContent_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containing at least columns with the fresh weight (g),
the dry weight (g) and the saturated fresh weight (g)</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric fresh weight values (g); default: &quot;fresh.weight&quot;</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_dry.weight">dry.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric dry weight values (g); default: &quot;dry.weight&quot;</p>
</td></tr>
<tr><td><code id="RelativeWaterContent_+3A_fresh.weight.saturated">fresh.weight.saturated</code></td>
<td>
<p>optional name of the column in data containing
the numeric saturated fresh weight values (g); default: &quot;fresh.weight.saturated&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water content (%) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">RWC = 100 * ((FW - DW) (FWs - DW)^-1)</code>
</p>

<p>whereas FW = fresh weight, DW = dry weight and FWs = fresh weight at water saturation.
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the relative water content (RWC) (%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- leaf_drying_data

# extend df by RWC
df_with_RWC &lt;- RelativeWaterContent(df)

</code></pre>

<hr>
<h2 id='RelativeWaterDeficit'>Relative Water Deficit (RWD)</h2><span id='topic+RelativeWaterDeficit'></span>

<h3>Description</h3>

<p>Calculates relative water deficit (%)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelativeWaterDeficit(data, fresh.weight = "fresh.weight",
  dry.weight = "dry.weight",
  fresh.weight.saturated = "fresh.weight.saturated")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RelativeWaterDeficit_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containing at least columns with the fresh weight (g),
the dry weight (g) and the saturated fresh weight (g)</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric fresh weight values (g); default: fresh.weight</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_dry.weight">dry.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric dry weight values (g); default: dry.weight</p>
</td></tr>
<tr><td><code id="RelativeWaterDeficit_+3A_fresh.weight.saturated">fresh.weight.saturated</code></td>
<td>
<p>optional name of the column in data containing
the numeric saturated fresh weight values (g); default: fresh.weight.saturated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relative water deficit (%) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">RWD = 100 - 100 * ((FW - DW) (FWs - DW)^-1)</code>
</p>

<p>whereas FW = fresh weight, DW = dry weight and FWs = fresh weight at water saturation.
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the relative water deficit (RWD) (%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- leaf_drying_data

# extend df by RWD
df_with_RWD &lt;- RelativeWaterDeficit(df)

</code></pre>

<hr>
<h2 id='RWDInterval'>Mean relative water deficit (RWD) of an interval</h2><span id='topic+RWDInterval'></span>

<h3>Description</h3>

<p>Calculates relative water deficit (%) as mean value of a measurement interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RWDInterval(data, sample = "sample", fresh.weight = "fitted.fw",
  dry.weight = "dry.weight",
  fresh.weight.saturated = "fresh.weight.saturated")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RWDInterval_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containing at least columns with the fresh weight (g),
the dry weight (g) and the saturated fresh weight (g), ordered by sample by descending by fresh weight. A column containing
the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="RWDInterval_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample IDs, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="RWDInterval_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric fresh weight values (g); default: &quot;fitted.fw&quot;</p>
</td></tr>
<tr><td><code id="RWDInterval_+3A_dry.weight">dry.weight</code></td>
<td>
<p>optional name of the column in data containing
the numeric dry weight values (g); default: &quot;dry.weight&quot;</p>
</td></tr>
<tr><td><code id="RWDInterval_+3A_fresh.weight.saturated">fresh.weight.saturated</code></td>
<td>
<p>optional name of the column in data containing
the numeric saturated fresh weight values (g); default: &quot;fresh.weight.saturated&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, the mean fresh weight is calculated for each measurement interval. Relative water deficit (%) is
then calculated as:
</p>
<p style="text-align: center;"><code class="reqn">RWD = 100 - 100 * ((mFW - DW) (FWs - DW)^-1)</code>
</p>

<p>whereas mFW = mean fresh weight, DW = dry weight and FWs = fresh weight at water saturation.
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the mean relative water deficit for the measurement
interal (RWD.interval) (%).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- leaf_drying_data

# extend df by RWD
df_with_RWD &lt;- RWDInterval(df, fresh.weight = "fresh.weight")

</code></pre>

<hr>
<h2 id='SaturationVaporPressure'>Saturation vapor pressure (VPsat)</h2><span id='topic+SaturationVaporPressure'></span>

<h3>Description</h3>

<p>Calculates saturation vapor pressure (kPa) using the Arden Buck equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SaturationVaporPressure(data, temperature = "temperature")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SaturationVaporPressure_+3A_data">data</code></td>
<td>
<p>data frame with at least a numeric column containing temperature (degree Celsius)</p>
</td></tr>
<tr><td><code id="SaturationVaporPressure_+3A_temperature">temperature</code></td>
<td>
<p>optional name of the column in data containing the temperature values;
default: &quot;temperature&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates saturation vapor pressure (kPa) over liquid by temperature using the Arden Buck equation:
</p>
<p style="text-align: center;"><code class="reqn">VPsat = 0.61121 exp ((18.678 - T 234.5^-1) (T 257.14 + T))</code>
</p>

<p>where T = air temperature (degree Celsius)
</p>


<h3>Value</h3>

<p>the original data frame extended by a numeric column with the saturation vapor pressure (kPa).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate example data frame
df &lt;- data.frame(temperature = c(23.1, 23.2))

# extend df by saturation vapor pressure
df_with_VPsat &lt;- SaturationVaporPressure(df)

</code></pre>

<hr>
<h2 id='StomatalClosure'>Point of stomatal closure</h2><span id='topic+StomatalClosure'></span>

<h3>Description</h3>

<p>Determines the point of stomatal closure in a set of experimentally obtained leaf drying curves.
Stomatal closure happens when the curve irreversibly settles to linear water loss.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StomatalClosure(data, sample = "sample",
  time.since.start = "time.since.start", conductance = "conductance",
  RWD = "RWD.interval", threshold = FALSE, graph = TRUE,
  show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StomatalClosure_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal length giving the numerical
coordinates of the curve: time since start (minutes), conductance (mmol m^-2 s^-1) and RWD (%), ordered by sample by ascending
time since start. A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID (if available), default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_time.since.start">time.since.start</code></td>
<td>
<p>optional name of the column in data containing numeric time since start values (min), default: &quot;time.since.start&quot;</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_conductance">conductance</code></td>
<td>
<p>optional name of the column in data containing numeric leaf conductance values (mmol m^-2 s^-1), default: &quot;conductance&quot;</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_rwd">RWD</code></td>
<td>
<p>optional name of the column in data containing numeric relative water deficit (%) values, default: &quot;RWD.interval&quot; (RWD average
of an interval as outputted by RWDInterval)</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_threshold">threshold</code></td>
<td>
<p>sensitivity for the determination of stomatal closure. 60 by default.</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="StomatalClosure_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed. <br />
The conductances by time since start curves are fitted using the Gauss-Newton algorithm of nls() to a
combined exponential and linear model. The exponential and linear parts are extracted and time since start at stomatal closure is
localized at the point where the slope of the exponential part of the fit is higher than a threshold value. The threshold value
is calculated by the use of the parameter b of the exponential part of the fit
(a * exp(b * x)): -(b^2 * sens). The sensitivity constant (sens) is 60 by default and can be specified individually by the argument
'threshold'. <br />
Minimum conductance (gmin) at stomatal closure is the conductance value of the overall fit at stomatal closure.
RWD at stomatal closure is then calculated by linear regression of RWD and time since start.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table role = "presentation">
<tr><td><code>stomatal.closure</code></td>
<td>
<p>coordinates of the point of stomatal closure (time.since.start, RWD, conductance)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the exponential and linear part of the combined fits</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of combined model</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted original data is displayed with the exponential and
linear fit of the combined model as well as the x-coordinate (time.since.start) of the point of stomatal closure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- WeatherAllocation(leaf_drying_data, weather_data)   # allocate weather to weight loss data
df &lt;- TimeSinceStart(df) # calculate time since start
df &lt;- df[df$fw.plateau != "yes",] # remove plateauing data
df &lt;- FittedFW(df, graph = FALSE) # correct noises in fresh weight
df &lt;- RWDInterval(df, fresh.weight = "fitted.fw") # calculate RWD based in the intervals
df &lt;- Conductance(df, fresh.weight = "fitted.fw") # calculate conductance

# identify stomatal closure in curve and get graphs
sc &lt;- StomatalClosure(df)

</code></pre>

<hr>
<h2 id='TimeInterval'>Time Interval</h2><span id='topic+TimeInterval'></span>

<h3>Description</h3>

<p>Calculates time intervals (min) between temporally repeated measurements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TimeInterval(data, sample = "sample", date.and.time = "date.and.time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TimeInterval_+3A_data">data</code></td>
<td>
<p>data frame containing at least a column giving the time (and date) (class POSIXct) of the measurements ordered by
sample and chronologically. A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="TimeInterval_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="TimeInterval_+3A_date.and.time">date.and.time</code></td>
<td>
<p>optional name of the column in data containing the time (and date) as class POSIXct,
default: &quot;date.and.time&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the original data frame extended by a numerical vecor containing the time intervals
(min) between the measurements of a sample. The first values of each sample is NA since
time intervals are computed from row i and i-1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- leaf_drying_data

# extend df by time interval
df_with_ti &lt;- TimeInterval(df)

</code></pre>

<hr>
<h2 id='TimeSinceStart'>Time Since Start</h2><span id='topic+TimeSinceStart'></span>

<h3>Description</h3>

<p>Calculates time since start (min) of measurement for temporally repeated measurements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TimeSinceStart(data, sample = "sample",
  date.and.time = "date.and.time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TimeSinceStart_+3A_data">data</code></td>
<td>
<p>data frame containing at least a column giving the the time (and date) of the
measurements ordered by sample and chronologically. A column containing the sample IDs is optionally required if several samples
were measured.</p>
</td></tr>
<tr><td><code id="TimeSinceStart_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample
IDs, default: &quot;sample&quot;.</p>
</td></tr>
<tr><td><code id="TimeSinceStart_+3A_date.and.time">date.and.time</code></td>
<td>
<p>optional name of the column in data containing the time (and date) as class POSIXct,
default: &quot;date.and.time&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original data frame extended by a numerical vector containing time since start
(min) of the measurements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data frame
df &lt;- leaf_drying_data

# extend df by time since start
df_with_tss &lt;- TimeSinceStart(df)

</code></pre>

<hr>
<h2 id='Transpiration'>Leaf transpiration</h2><span id='topic+Transpiration'></span>

<h3>Description</h3>

<p>Calculates transpiration of a plant part from experimentally determined weight loss per time unit
and double-sided leaf area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Transpiration(data, sample = "sample", date.and.time = "date.and.time",
  fresh.weight = "fitted.fw", leaf.area = "leaf.area",
  output.unit = "mmol")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Transpiration_+3A_data">data</code></td>
<td>
<p>data frame with columns of equal length containg at least columns with the time (and date) of the fresh weight
measurements as well as columns with the measured fresh weights (g) and the single-sided leaf area (cm^2) of the sample. The
data is to be ordered chronologically by sample. A column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="Transpiration_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID; default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="Transpiration_+3A_date.and.time">date.and.time</code></td>
<td>
<p>optional name of the column in data containing the time of the fresh weight measurements
as class POSIXct; default: &quot;date.and.time&quot;</p>
</td></tr>
<tr><td><code id="Transpiration_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the numeric fresh weight values (g);
default: &quot;fitted.fw&quot;</p>
</td></tr>
<tr><td><code id="Transpiration_+3A_leaf.area">leaf.area</code></td>
<td>
<p>optional name of the column in data containing the numeric single-sided leaf area values (cm^2);
default: &quot;leaf.area&quot;</p>
</td></tr>
<tr><td><code id="Transpiration_+3A_output.unit">output.unit</code></td>
<td>
<p>optional; possible values: &quot;mg&quot; or &quot;mmol&quot;; defines whether transpiration is given in
mmol m^-2 s^-1 (Default) or in mg m^-2 s^-1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transpiration (mmol s^-1 m^-2) is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">T = \Delta FM * 1000 * (\Delta t * 60 * LA * 2 /10000 * 18.01528)^-1</code>
</p>

<p>whereas T = transpiration, <code class="reqn">\Delta</code>FW = reduction of fresh weight (g),
<code class="reqn">\Delta</code>t = time unit (min), LA = single-sided leaf area (cm^2)
</p>


<h3>Value</h3>

<p>The original data frame extended by a numeric column with the transpiration
(mg s^-1 m^-2 or mmol s^-1 m^-2) of the double-sided leaf area. The first value of each sample is
NA, since transpiration values are computed from row i and i-1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data and allocate
df &lt;- WeatherAllocation(leaf_drying_data, weather_data)

# extend df by transpiration in mmol s^-1 m^-2
df_with_transpiration &lt;- Transpiration(df, fresh.weight = "fresh.weight")

# extend df by transpiration in mg s^-1 m^-2
df_with_transpiration &lt;- Transpiration(df, fresh.weight = "fresh.weight", output.unit = "mg")

</code></pre>

<hr>
<h2 id='TurgorLossPoint'>Turgor Loss Point</h2><span id='topic+TurgorLossPoint'></span>

<h3>Description</h3>

<p>Determines the x coordinate (RWD) of the turgor loss point in a set of experimentally obtained
pressure volume curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TurgorLossPoint(data, sample = "sample",
  water.potential = "water.potential", RWD = "RWD", graph = TRUE,
  show.legend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TurgorLossPoint_+3A_data">data</code></td>
<td>
<p>data frame containing columns of equal lengths giving at least the numerical
coordinates of the curve: water potential (bar) and RWD (%), ordered by sample by descending water potential. A
column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_water.potential">water.potential</code></td>
<td>
<p>optional name of the column in data containing the numeric water potential values (bar), default: &quot;water.potential&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_rwd">RWD</code></td>
<td>
<p>optional name of the column in data containing numeric relative water deficit values (%), default: &quot;RWD&quot;</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_graph">graph</code></td>
<td>
<p>set FALSE if no plots are to be returned</p>
</td></tr>
<tr><td><code id="TurgorLossPoint_+3A_show.legend">show.legend</code></td>
<td>
<p>set FALSE if no legend is to be shown in the plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before using this function, check the raw data for an initial plateau. If the exponential decline does not onset directly,
fitting might not succeed. <br /> <br />
The data is fitted using the Gauss-Newton algorithm of nls() to a combined exponential and linear
model. The exponential and linear parts are extracted and RWD at turgor loss point is localized at their point of minimum distance.
</p>


<h3>Value</h3>

<p>List splitted by sample consisting of
</p>
<table role = "presentation">
<tr><td><code>turgor.loss.point</code></td>
<td>
<p>coordinates of the turgor loss point (RWD)</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>formula of the exponential and linear part of the combined fits</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>coefficients of combined model</p>
</td></tr>
<tr><td><code>conf_int</code></td>
<td>
<p>upper (97.5 %) and lower (2.5 %) border of 95 % confidence interval of model parameters</p>
</td></tr>
</table>
<p>If graph = TRUE, the plotted original data is displayed with the exponential and
linear fit of the combined model as well as the x-coordinate (RWD) of the turgor loss point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get sample data
data &lt;- RelativeWaterDeficit(pressure_volume_data)[pressure_volume_data$sample == 1, ]

# identify turgor loss point in curve
turgor_loss_point &lt;- TurgorLossPoint(data)

</code></pre>

<hr>
<h2 id='ValidityCheck'>Ensures the validity of the input data</h2><span id='topic+ValidityCheck'></span>

<h3>Description</h3>

<p>Ensures the validity of the input data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValidityCheck(data, sample = FALSE, leaf.area = FALSE,
  date.and.time = FALSE, dry.weight = FALSE,
  fresh.weight.saturated = FALSE, fresh.weight = FALSE,
  water.potential = FALSE, RWD = FALSE, conductance = FALSE,
  time.since.start = FALSE, temperature = FALSE, humidity = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ValidityCheck_+3A_data">data</code></td>
<td>
<p>data frame containing the data to be checked</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_sample">sample</code></td>
<td>
<p>name of column containing the sample ID (default: sample)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_leaf.area">leaf.area</code></td>
<td>
<p>name of column containing the leaf area (cm^2) (default: leaf.area)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_date.and.time">date.and.time</code></td>
<td>
<p>name of column containing the date and time (default: date and time)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_dry.weight">dry.weight</code></td>
<td>
<p>name of column containing the dry weight (g) (default: dry weight)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_fresh.weight.saturated">fresh.weight.saturated</code></td>
<td>
<p>name of column containing the saturated fresh weight (g) (default: fresh.weight.saturated)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>name of column containing the fresh weight (g) (default: fresh.weight)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_water.potential">water.potential</code></td>
<td>
<p>name of column containing the water potential (bar) (default: water.potential)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_rwd">RWD</code></td>
<td>
<p>name of column containing the relative water deficit (default: RWD)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_conductance">conductance</code></td>
<td>
<p>name of column containing the conductance values (default: conductance)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_time.since.start">time.since.start</code></td>
<td>
<p>name of column containing the time since start values (default: time.since.start)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_temperature">temperature</code></td>
<td>
<p>name of column containing the temperature values (default: temperature)</p>
</td></tr>
<tr><td><code id="ValidityCheck_+3A_humidity">humidity</code></td>
<td>
<p>name of column containing the humidity values (default: humidity)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

<hr>
<h2 id='ValidityCheckDetail'>Checks if column exists in data, is numeric and has the same lenghts as the others existence</h2><span id='topic+ValidityCheckDetail'></span>

<h3>Description</h3>

<p>Checks if column exists in data, is numeric and has the same lenghts as the others existence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValidityCheckDetail(data_in, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ValidityCheckDetail_+3A_data_in">data_in</code></td>
<td>
<p>data frame to be checked</p>
</td></tr>
<tr><td><code id="ValidityCheckDetail_+3A_value">value</code></td>
<td>
<p>column in data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value
</p>

<hr>
<h2 id='VaporPressureDeficit'>Vapor Pressure Deficit (VPD)</h2><span id='topic+VaporPressureDeficit'></span>

<h3>Description</h3>

<p>Calculates mole fraction vapor pressure deficit (mol * mol^-1) of the air.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VaporPressureDeficit(data, humidity = "humidity",
  temperature = "temperature", atmospheric.pressure = 101.325)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VaporPressureDeficit_+3A_data">data</code></td>
<td>
<p>data frame at least with two numeric columns of equal length containg humidity (%)
and temperature (degree Celsius)</p>
</td></tr>
<tr><td><code id="VaporPressureDeficit_+3A_humidity">humidity</code></td>
<td>
<p>optional name of the column in data containing the humidity values;
default: &quot;humidity&quot;</p>
</td></tr>
<tr><td><code id="VaporPressureDeficit_+3A_temperature">temperature</code></td>
<td>
<p>optional name of the column in data containing the temperature values;
default: &quot;temperature&quot;</p>
</td></tr>
<tr><td><code id="VaporPressureDeficit_+3A_atmospheric.pressure">atmospheric.pressure</code></td>
<td>
<p>optional; default = 101.325 (atmospheric pressure at sea level)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mole fraction vapor pressure deficit is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">(1 - RH / 100) * (VPsat / AP)</code>
</p>

<p>whereas RH = relative humidity (%), VPsat = saturation vapor pressure (kPA),
AP = atmospheric pressure (kPA), whereas:
</p>
<p style="text-align: center;"><code class="reqn">VPsat = 0.61121 exp ((18.678 - T 234.5^-1) (T 257.14 + T))</code>
</p>

<p>where T = air temperature (degree Celsius)
</p>


<h3>Value</h3>

<p>The original data frame extended by a numeric column with the vapor pressure deficit
(mol * mol^-1).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- weather_data

# calculate vapor pressure deficit from weather data measured at sea level
df_with_VPD &lt;- VaporPressureDeficit(df)

# calculate vapor pressure deficit from weather data measured at 2000 m altitude
df_with_VPD &lt;- VaporPressureDeficit(df, atmospheric.pressure = 79.495)

</code></pre>

<hr>
<h2 id='weather_data'>Weather data</h2><span id='topic+weather_data'></span>

<h3>Description</h3>

<p>A dataset containing weather data obtained by a data logger at the site of the measurement of the leaf drying data
(leaf_drying_data)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weather_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 253 rows and 3 variables</p>


<h3>Details</h3>


<ul>
<li><p> date.and.time: Time (and date) of the weather logging event (2019-03-25 00:00:00 - 2019-03-27 15:00:00)
</p>
</li>
<li><p> temperature: Air temperature in degree Celsius (18.05 - 26.81)
</p>
</li>
<li><p> humidity: Relative air humidity in percentage (35.1 - 65.07)
</p>
</li></ul>


<hr>
<h2 id='WeatherAllocation'>Weather Allocation</h2><span id='topic+WeatherAllocation'></span>

<h3>Description</h3>

<p>Calculates average weather (humidity, temperature) values within a measurement period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeatherAllocation(weight_loss_data, weather_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeatherAllocation_+3A_weight_loss_data">weight_loss_data</code></td>
<td>
<p>data frame containing at least a column named &quot;date.and.time&quot; of the
class POSIXct with the time (and date) of the measuring events. A column named &quot;sample&quot;
containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="WeatherAllocation_+3A_weather_data">weather_data</code></td>
<td>
<p>data frame containing at least a column named &quot;date.and.time&quot; of the
class POSIXct with the time (and date) of the weather measurements and two columns
named &quot;humidity&quot; and &quot;temperature&quot; containing the numerical weather data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Averages within a measurement period are determined by
approximate integration and normalization of the weather as a function of time.
</p>


<h3>Value</h3>

<p>The original weight loss data frame extended by the approximatively integrated and
normalized weather data for each period between two weight measurements. The first value of
each sample is NA since weather values are averaged from row i to i-1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
weight_loss_data &lt;- leaf_drying_data
weather_data &lt;- weather_data

# allocate averaged weather data to weight loss data
weight_loss_data_with_weather &lt;- WeatherAllocation(weight_loss_data, weather_data)

</code></pre>

<hr>
<h2 id='WeightDifference'>Weight Difference</h2><span id='topic+WeightDifference'></span>

<h3>Description</h3>

<p>Calculates weight changes between temporally repeated measurements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeightDifference(data, sample = "sample",
  fresh.weight = "fresh.weight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WeightDifference_+3A_data">data</code></td>
<td>
<p>data frame containing at least a numeric column containing the measured weights (g), ordered chronologically by sample. A
column containing the sample IDs is optionally required if several samples were measured.</p>
</td></tr>
<tr><td><code id="WeightDifference_+3A_sample">sample</code></td>
<td>
<p>optional name of the column in data containing the sample ID, default: &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="WeightDifference_+3A_fresh.weight">fresh.weight</code></td>
<td>
<p>optional name of the column in data containing the numeric fresh weight (g) values, default: &quot;fresh.weight&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the original data frame extended by a numeric column containing the absolute
differences in fresh weight (g) beween the measurements of a sample. The first value of each
sample is NA since weight differences are computed from row i and i-1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get example data
df &lt;- leaf_drying_data

# extend df by weight difference
df_with_WD &lt;- WeightDifference(df)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
