<!DOCTYPE html><html lang="en"><head><title>Help for package aftables</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aftables}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aftables-package'><p>aftables: Create Spreadsheet Publications Following Best Practice</p></a></li>
<li><a href='#as_aftable'><p>Coerce To An 'aftable' Object</p></a></li>
<li><a href='#at_template_aftable'><p>Insert Demo 'create_aftable' Template</p></a></li>
<li><a href='#at_template_workflow'><p>Insert Full Demo 'aftables' Template Workflow</p></a></li>
<li><a href='#create_aftable'><p>Create An 'aftable' Object</p></a></li>
<li><a href='#demo_aftable'><p>A Demo 'aftables' Object</p></a></li>
<li><a href='#demo_df'><p>A Demo 'data.frame' Object</p></a></li>
<li><a href='#demo_workbook'><p>A Demo 'Workbook' Object</p></a></li>
<li><a href='#generate_workbook'><p>Generate A Workbook Object From An 'aftable'</p></a></li>
<li><a href='#summary.aftable'><p>Summarise An 'aftable' Object</p></a></li>
<li><a href='#tbl_sum.aftable'><p>Provide A Succinct Summary Of An 'aftable' Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Create Spreadsheet Publications Following Best Practice</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Generate spreadsheet publications that follow best practice
    guidance from the UK government's Analysis Function, available at 
    <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/">https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/</a>,
    with a focus on accessibility. See also the 'Python' package 'gptables'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://best-practice-and-impact.github.io/aftables/">https://best-practice-and-impact.github.io/aftables/</a>,
<a href="https://github.com/best-practice-and-impact/aftables">https://github.com/best-practice-and-impact/aftables</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/best-practice-and-impact/aftables/issues">https://github.com/best-practice-and-impact/aftables/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>openxlsx, pillar</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, rstudioapi, testthat (&ge; 3.0.0),
tibble</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-19 16:01:27 UTC; OBoxPower</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Dray [aut],
  Tim Taylor [ctb],
  Matt Kerlogue [ctb],
  Crown Copyright [cph],
  Olivia Box Power [cre, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivia Box Power &lt;Olivia.BoxPower@dhsc.gov.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-19 16:40:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='aftables-package'>aftables: Create Spreadsheet Publications Following Best Practice</h2><span id='topic+aftables'></span><span id='topic+aftables-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Generate spreadsheet publications that follow best practice guidance from the UK government's Analysis Function, available at <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/">https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/</a>, with a focus on accessibility. See also the 'Python' package 'gptables'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Olivia Box Power <a href="mailto:Olivia.BoxPower@dhsc.gov.uk">Olivia.BoxPower@dhsc.gov.uk</a> [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Matt Dray <a href="mailto:mwdray@gmail.com">mwdray@gmail.com</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Tim Taylor [contributor]
</p>
</li>
<li><p> Matt Kerlogue [contributor]
</p>
</li>
<li><p> Crown Copyright [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://best-practice-and-impact.github.io/aftables/">https://best-practice-and-impact.github.io/aftables/</a>
</p>
</li>
<li> <p><a href="https://github.com/best-practice-and-impact/aftables">https://github.com/best-practice-and-impact/aftables</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/best-practice-and-impact/aftables/issues">https://github.com/best-practice-and-impact/aftables/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as_aftable'>Coerce To An 'aftable' Object</h2><span id='topic+as_aftable'></span><span id='topic+is_aftable'></span>

<h3>Description</h3>

<p>Functions to check if an object is an aftable, or coerce it if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_aftable(x)

is_aftable(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_aftable_+3A_x">x</code></td>
<td>
<p>A data.frame object to coerce.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>as_aftable</code> returns an object of class aftable if possible.
<code>is_aftable</code> returns <code>TRUE</code> if the object has class
aftable, otherwise <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as_aftable(demo_df)
is_aftable(demo_aftable)

</code></pre>

<hr>
<h2 id='at_template_aftable'>Insert Demo 'create_aftable' Template</h2><span id='topic+at_template_aftable'></span>

<h3>Description</h3>

<p>Insert at the cursor a template for <code><a href="#topic+create_aftable">create_aftable</a></code> from the
'aftable' package, pre-filled with demo data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>at_template_aftable()
</code></pre>


<h3>Value</h3>

<p>Empty list. Function is used for side effect.
</p>

<hr>
<h2 id='at_template_workflow'>Insert Full Demo 'aftables' Template Workflow</h2><span id='topic+at_template_workflow'></span>

<h3>Description</h3>

<p>Insert at the cursor (a) demo templates for cover, contents and notes
tables, and (b) a call to <code><a href="#topic+create_aftable">create_aftable</a></code> pre-filled with
demo data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>at_template_workflow()
</code></pre>


<h3>Value</h3>

<p>Empty list. Function is used for side effect.
</p>

<hr>
<h2 id='create_aftable'>Create An 'aftable' Object</h2><span id='topic+create_aftable'></span>

<h3>Description</h3>

<p>Create a new aftable-class object, which is a special data.frame that
contains all the information needed in your output spreadsheet. In turn, the
object created by this function can be used to populate an 'openxlsx'
Workbook-class object with the function <code><a href="#topic+generate_workbook">generate_workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_aftable(
  tab_titles,
  sheet_types = c("cover", "contents", "notes", "tables"),
  sheet_titles,
  blank_cells = NA_character_,
  sources = NA_character_,
  custom_rows = list(NA_character_),
  tables
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_aftable_+3A_tab_titles">tab_titles</code></td>
<td>
<p>Required character vector, one value per sheet. Each title
will appear literally on each tab of the final spreadsheet output. Keep
brief. Letters and numbers only; do not start with a number; use
underscores for spaces. For example: 'Cover', 'Contents', 'Notes',
'Table_1'. Will be corrected automatically unless there's an error.</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_sheet_types">sheet_types</code></td>
<td>
<p>Required character vector, one value per sheet. Sheets
that don't contain publication tables ('meta' sheets) should be of type
'contents', 'cover' or 'notes'. Sheets that contain statistical tables of
data are type 'tables'.</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_sheet_titles">sheet_titles</code></td>
<td>
<p>Required character vector, one value per sheet. The main
title for each sheet, which will appear in cell A1 (top-left corner).</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_blank_cells">blank_cells</code></td>
<td>
<p>Optional character vector, one value per sheet. A short
sentence to explain the reason for any blank cells in the sheet. Supply
as <code>NA_character_</code> if empty. Most likely to be used with sheet type
'tables'.</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_sources">sources</code></td>
<td>
<p>Optional character vector, one value per sheet. The origin of
the data for a given sheet. Supply as <code>NA_character_</code> if empty. To
be used with sheet type 'tables'.</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_custom_rows">custom_rows</code></td>
<td>
<p>Optional list of character vectors. One list element per
sheet, one character vector element per row of pre-table metadata. Supply
a list element as <code>NA_character_</code> if empty. To be used with sheet
type 'tables', but can also be used for sheet types 'contents' and
'notes'.</p>
</td></tr>
<tr><td><code id="create_aftable_+3A_tables">tables</code></td>
<td>
<p>Required list of data.frames (though the cover sheet may be
supplied as a list), one per sheet. See details.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>How to supply data to the 'tables' argument</h4>

<p>Formats for the elements collected as a list and passed to the 'tables'
argument, depending on the sheet type.
</p>

<ul>
<li><p> Sheet type 'cover': either (a) a list where each element name is a
section header and each element's content is a character vector
whose elements will make up separate rows of that section
(recommended), or (b) a data.frame with one row per subsection, with
one column for section titles and one column for corresponding for
that section's body text. For example, you may have a section with
the title 'Contact details' that contains an email address and
telephone number. You can use line breaks (i.e. '\n') to separate
text into paragraphs.
</p>
</li>
<li><p> Sheet type 'contents': one row per sheet, two columns suggested at
least (named 'Tab title' and 'Worksheet title').
</p>
</li>
<li><p> Sheet type 'notes': one row per note, two columns suggested (named
'Note number', 'Note text'), where notes are in the form
'[note 1]'.
</p>
</li>
<li><p> Sheet type 'tables': a tidy, rectangular data.frame containing the
data to be published. It's the user's responsibility to add notes in
the form '[note 1]' to column headers, or in a special 'Notes' row.
</p>
</li></ul>




<h4>How to supply hyperlinks</h4>

<p>You can provide text in Markdown link syntax (e.g.
'[GOV.UK](https://www.gov.uk)', adding 'mailto:' before an
email address) and the containing cell will be rendered as a hyperlink in the
output spreadsheet. Note that whole cells will become hyperlinks; there is no
support for selected words in a sentence to be rendered as a hyperlink.
</p>
<p>Hyperlinks can be supplied in the character strings to three arguments:
</p>

<ul>
<li><p> To the 'tables' argument for sheet type 'cover' only. It's
recommended to supply the cover information as a list rather than a
data.frame, which will allow you to make specific rows within a
section (e.g. 'contact us') into hyperlinks.
</p>
</li>
<li><p> To the 'custom_rows' argument for sheets of type 'contents, 'notes'
and 'tables'.
</p>
</li>
<li><p> To the 'source' argument for sheets of type 'table' only.
</p>
</li></ul>




<h3>Value</h3>

<p>An object with classes 'aftable', 'tbl' and 'data.frame'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare some demo tables of information

set.seed(1066)

cover_list &lt;- list(
  "Section 1" = c("First row of Section 1.", "Second row of Section 1."),
  "Section 2" = "The only row of Section 2.",
  "Section 3" = c(
    "[Website](https://best-practice-and-impact.github.io/aftables/)",
    "[Email address](mailto:fake.address@aftables.com)"
  )
)

contents_df &lt;- data.frame(
  "Sheet name" = c("Notes", "Table_1", "Table_2"),
  "Sheet title" = c(
    "Notes used in this workbook",
    "First Example Sheet",
    "Second Example Sheet"
  ),
  check.names = FALSE
)

notes_df &lt;- data.frame(
  "Note number" = paste0("[note ", 1:2, "]"),
  "Note text" = c("First note.", "Second note."),
  check.names = FALSE
)


table_1_df &lt;- data.frame(
  Category = LETTERS[1:10],
  "Numeric [note 1]" = 1:10,
  "Numeric suppressed" = c(1:4, "[c]", 6:9, "[x]"),
  "Numeric thousands" = abs(round(rnorm(10), 4) * 1e5),
  "Numeric decimal" = abs(round(rnorm(10), 5)),
  "Long name that means that the column width needs to be widened" = 1:10,
  Notes = c("[note 1]", rep(NA_character_, 4), "[note 2]",
            rep(NA_character_, 4)),
  check.names = FALSE
)

table_2_df &lt;- data.frame(Category = LETTERS[1:10], Numeric = 1:10)

# Create 'aftables' object

x &lt;- aftables::create_aftable(
  tab_titles = c("Cover", "Contents", "Notes", "Table_1", "Table_2"),
  sheet_types = c("cover", "contents", "notes", "tables", "tables"),
  sheet_titles = c(
    "The 'aftables' Demo Workbook",
    "Table of contents",
    "Notes",
    "Table 1: First Example Sheet",
    "Table 2: Second Example Sheet"
  ),
  blank_cells = c(
    rep(NA_character_, 3),
    "Blank cells indicate that there's no note in that row.",
    NA_character_
  ),
  custom_rows = list(
    NA_character_,
    NA_character_,
    "A custom row.",
    c(
      paste0("First custom row [with a hyperlink.]",
             "(https://best-practice-and-impact.github.io/aftables/)"),
      "Second custom row."
    ),
    "A custom row."
  ),
  sources = c(
    rep(NA_character_, 3),
    paste0("[The Source Material, 2024.]",#
           "(https://best-practice-and-impact.github.io/aftables/)"),
    "The Source Material, 2024."
  ),
  tables = list(cover_list, contents_df, notes_df, table_1_df, table_2_df)
)

# Test that 'aftable' is one of the object's classes
is_aftable(x)

# Look at the structure of the object
str(x, max.level = 2)

</code></pre>

<hr>
<h2 id='demo_aftable'>A Demo 'aftables' Object</h2><span id='topic+demo_aftable'></span>

<h3>Description</h3>

<p>A pre-created 'aftables' object ready to be converted to an 'openxlsx'
Workbook-class object with <code><a href="#topic+generate_workbook">generate_workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demo_aftable
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6 rows and 7 columns:
</p>

<dl>
<dt>tab_title</dt><dd><p>Character. Text to appear on each sheet's tab.</p>
</dd>
<dt>sheet_type</dt><dd><p>Character. The content type for each sheet: 'cover', 'contents', 'notes', or 'tables'.</p>
</dd>
<dt>sheet_title</dt><dd><p>Character. The title that will appear in cell A1 (top-left) of each sheet.</p>
</dd>
<dt>blank_cells</dt><dd><p>Character. An explanation for any blank cells in the table.</p>
</dd>
<dt>custom_rows</dt><dd><p>List-column of character vectors. Additional arbitrary pre-table information provided by the user.</p>
</dd>
<dt>source</dt><dd><p>Character. The origin of the data, if relevant.</p>
</dd>
<dt>table</dt><dd><p>List-column of data.frames (apart from the cover, which is a list) containing the statistical tables.</p>
</dd>
</dl>


<hr>
<h2 id='demo_df'>A Demo 'data.frame' Object</h2><span id='topic+demo_df'></span>

<h3>Description</h3>

<p>A pre-created data.frame ready to be converted to an aftables-class object
with <code><a href="#topic+as_aftable">as_aftable</a></code> and then an 'openxlsx' Workbook-class object
with <code><a href="#topic+generate_workbook">generate_workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demo_df
</code></pre>


<h3>Format</h3>

<p>A data.frame with 6 rows and 7 columns:
</p>

<dl>
<dt>tab_title</dt><dd><p>Character. Text to appear on each sheet's tab.</p>
</dd>
<dt>sheet_type</dt><dd><p>Character. The content type for each sheet: 'cover', 'contents', 'notes', or 'tables'.</p>
</dd>
<dt>sheet_title</dt><dd><p>Character. The title that will appear in cell A1 (top-left) of each sheet.</p>
</dd>
<dt>blank_cells</dt><dd><p>Character. An explanation for any blank cells in the table.</p>
</dd>
<dt>custom_rows</dt><dd><p>List-column of character vectors. Additional arbitrary pre-table information provided by the user.</p>
</dd>
<dt>source</dt><dd><p>Character. The origin of the data, if relevant.</p>
</dd>
<dt>table</dt><dd><p>List-column of data.frames (apart from the cover, which is a list) containing the statistical tables.</p>
</dd>
</dl>


<hr>
<h2 id='demo_workbook'>A Demo 'Workbook' Object</h2><span id='topic+demo_workbook'></span>

<h3>Description</h3>

<p>A pre-created 'openxlsx' Workbook'-class object generated from an
aftables-class object with <code><a href="#topic+generate_workbook">generate_workbook</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demo_workbook
</code></pre>


<h3>Format</h3>

<p>An 'openxlsx' Workbook-class object with 5 sheets.
</p>

<hr>
<h2 id='generate_workbook'>Generate A Workbook Object From An 'aftable'</h2><span id='topic+generate_workbook'></span>

<h3>Description</h3>

<p>Populate an 'openxlsx' Workbook-class object with content from an
aftable-class object. In turn, the output can be passed to
<code><a href="openxlsx.html#topic+saveWorkbook">saveWorkbook</a></code> from 'openxlsx'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_workbook(aftable)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_workbook_+3A_aftable">aftable</code></td>
<td>
<p>An aftable-class object created using
<code><a href="#topic+create_aftable">create_aftable</a></code> (or <code><a href="#topic+as_aftable">as_aftable</a></code>), which
contains the data and information needed to create a workbook.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Workbook-class object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert an aftable to a Workbook-class object
x &lt;- generate_workbook(demo_aftable)
class(x)

# As above, using a compliant data.frame and the base pipe
y &lt;- demo_df |&gt;
  as_aftable() |&gt;
  generate_workbook()

</code></pre>

<hr>
<h2 id='summary.aftable'>Summarise An 'aftable' Object</h2><span id='topic+summary.aftable'></span>

<h3>Description</h3>

<p>A concise result summary of an aftable-class object to see information
about the sheet content. Shows a numbered list of sheets with each tab title,
sheet type and table dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aftable'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.aftable_+3A_object">object</code></td>
<td>
<p>An aftable-class object for which to get a summary.</p>
</td></tr>
<tr><td><code id="summary.aftable_+3A_...">...</code></td>
<td>
<p>Other arguments to pass.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>object</code> unaltered.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Print a concise summary of the aftable-class object
summary(demo_aftable)

# Alternatively, look at the structure
str(demo_aftable, max.level = 2)

</code></pre>

<hr>
<h2 id='tbl_sum.aftable'>Provide A Succinct Summary Of An 'aftable' Object</h2><span id='topic+tbl_sum.aftable'></span>

<h3>Description</h3>

<p>A brief text description of an aftable-class object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'aftable'
tbl_sum(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbl_sum.aftable_+3A_x">x</code></td>
<td>
<p>An aftable-class object to summarise.</p>
</td></tr>
<tr><td><code id="tbl_sum.aftable_+3A_...">...</code></td>
<td>
<p>Other arguments to pass.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Print with description
print(demo_aftable)

# Print description only (package 'tibble' must be installed)
tibble::tbl_sum(demo_aftable)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
