<!DOCTYPE html><html lang="en"><head><title>Help for package spCP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spCP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#diagnostics'><p>diagnostics</p></a></li>
<li><a href='#GarwayHeath'><p>Garway-Heath angles for the HFA-II</p></a></li>
<li><a href='#HFAII_Queen'><p>HFAII Queen Adjacency Matrix</p></a></li>
<li><a href='#HFAII_QueenHF'><p>HFAII Queen Hemisphere Adjacency Matrix</p></a></li>
<li><a href='#HFAII_Rook'><p>HFAII Rook Adjacency Matrix</p></a></li>
<li><a href='#is.spCP'><p>is.spCP</p></a></li>
<li><a href='#PlotCP'><p>PlotCP</p></a></li>
<li><a href='#predict.spCP'><p>predict.spCP</p></a></li>
<li><a href='#spCP'><p>MCMC sampler for spatially varying change point model.</p></a></li>
<li><a href='#VFSeries'><p>Visual field series for one patient.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatially Varying Change Points</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-04</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a spatially varying change point model with 
    unique intercepts, slopes, variance intercepts and slopes, and 
    change points at each location. Inference is within the 
    Bayesian setting using Markov chain Monte Carlo (MCMC). The 
    response variable can be modeled as Gaussian (no nugget), 
    probit or Tobit link and the five spatially varying parameter
    are modeled jointly using a multivariate conditional 
    autoregressive (MCAR) prior. The MCAR is a unique process that
    allows for a dissimilarity metric to dictate the local spatial 
    dependencies. Full details of the package can be found in the accompanying vignette.
    Furthermore, the details of the package can be found in the corresponding paper on arXiv
    by Berchuck et al (2018): "A spatially varying change points model for monitoring glaucoma 
    progression using visual field data", &lt;<a href="https://doi.org/10.48550/arXiv.1811.11038">doi:10.48550/arXiv.1811.11038</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, msm (&ge; 1.0.0), mvtnorm (&ge; 1.0-0), Rcpp
(&ge; 0.12.9), stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda, classInt, knitr, rmarkdown, womblR (&ge; 1.0.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.7.500.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-05 00:37:02 UTC; sib2</td>
</tr>
<tr>
<td>Author:</td>
<td>Samuel I. Berchuck [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel I. Berchuck &lt;sib2@duke.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-05 06:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='diagnostics'>diagnostics</h2><span id='topic+diagnostics'></span>

<h3>Description</h3>

<p>Calculates diagnostic metrics using output from the <code><a href="#topic+spCP">spCP</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostics(
  obj,
  diags = c("dic", "dinf", "waic"),
  keepDeviance = FALSE,
  keepPPD = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostics_+3A_obj">obj</code></td>
<td>
<p>A <code><a href="#topic+spCP">spCP</a></code> model object for which diagnostics
are desired from.</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_diags">diags</code></td>
<td>
<p>A vector of character strings indicating the diagnostics to compute.
Options include: Deviance Information Criterion (&quot;dic&quot;), d-infinity (&quot;dinf&quot;) and
Watanabe-Akaike information criterion (&quot;waic&quot;). At least one option must be included.
Note: The probit model cannot compute the DIC or WAIC diagnostics due to computational
issues with computing the multivariate normal CDF.</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_keepdeviance">keepDeviance</code></td>
<td>
<p>A logical indicating whether the posterior deviance distribution
is returned (default = FALSE).</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_keepppd">keepPPD</code></td>
<td>
<p>A logical indicating whether the posterior predictive distribution
at each observed location is returned (default = FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To assess model fit, DIC, d-infinity and WAIC are used. DIC is based on the
deviance statistic and penalizes for the complexity of a model with an effective
number of parameters estimate pD (Spiegelhalter et al 2002). The d-infinity posterior
predictive measure is an alternative diagnostic tool to DIC, where d-infinity=P+G.
The G term decreases as goodness of fit increases, and P, the penalty term, inflates
as the model becomes over-fit, so small values of both of these terms and, thus, small
values of d-infinity are desirable (Gelfand and Ghosh 1998). WAIC is invariant to
parametrization and is asymptotically equal to Bayesian cross-validation
(Watanabe 2010). WAIC = -2 * (lppd - p_waic_2). Where lppd is the log pointwise
predictive density and p_waic_2 is the estimated effective number of parameters
based on the variance estimator from Vehtari et al. 2016. (p_waic_1 is the mean
estimator).
</p>


<h3>Value</h3>

<p><code>diagnostics</code> returns a list containing the diagnostics requested and
possibly the deviance and/or posterior predictive distribution objects.
</p>


<h3>Author(s)</h3>

<p>Samuel I. Berchuck
</p>


<h3>References</h3>

<p>Gelfand, A. E., &amp; Ghosh, S. K. (1998). Model choice: a minimum posterior predictive loss approach. Biometrika, 1-11.
</p>
<p>Spiegelhalter, D. J., Best, N. G., Carlin, B. P., &amp; Van Der Linde, A. (2002). Bayesian measures of model complexity and fit. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 64(4), 583-639.
</p>
<p>Vehtari, A., Gelman, A., &amp; Gabry, J. (2016). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing, 1-20.
</p>
<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely applicable information criterion in singular learning theory. Journal of Machine Learning Research, 11(Dec), 3571-3594.
</p>

<hr>
<h2 id='GarwayHeath'>Garway-Heath angles for the HFA-II</h2><span id='topic+GarwayHeath'></span>

<h3>Description</h3>

<p>These Garway-Heath angles are used as the dissimilarity metric when implementing the boundary
detection model for a longitudinal series of visual fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GarwayHeath)
</code></pre>


<h3>Format</h3>

<p>A vector with length 54, where each entry represents the angle (in degrees) that the
underlying retinal nerve fiber enters the optic nerve head. The measure ranges from 0-360,
where 0  is designated at the 9-o’clock position (right eye) and angles are counted counter
clockwise. These angles are estimates for the Humphrey Field Analyzer-II (Carl Zeiss Meditec
Inc., Dublin, CA). The 26th and 35th entries are missing as they correspond to a natural
blind spot.
</p>


<h3>References</h3>

<p>Garway-Heath, et al. (2000). Ophthalmology 107:10:1809–1815.
(<a href="https://pubmed.ncbi.nlm.nih.gov/11013178/">PubMed</a>)
</p>

<hr>
<h2 id='HFAII_Queen'>HFAII Queen Adjacency Matrix</h2><span id='topic+HFAII_Queen'></span>

<h3>Description</h3>

<p>Binary adjacency matrix for the Humphrey Field Analyzer-II (Carl Zeiss Meditec Inc., Dublin, CA)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HFAII_Queen)
</code></pre>


<h3>Format</h3>

<p>This adjacency matrix is formatted using queen neighbor criteria, meaning two locations on
the visual field are only considered neighbors if they share an edge or corner. The adjacency matrix is a
54 x 54 dimensional binary object with zeros on the diagonal and the column and row sums are equal
to the number of neighbors.
</p>

<hr>
<h2 id='HFAII_QueenHF'>HFAII Queen Hemisphere Adjacency Matrix</h2><span id='topic+HFAII_QueenHF'></span>

<h3>Description</h3>

<p>Binary adjacency matrix for the Humphrey Field Analyzer-II (Carl Zeiss Meditec Inc., Dublin, CA)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HFAII_QueenHF)
</code></pre>


<h3>Format</h3>

<p>This adjacency matrix is formatted using queen neighbor criteria, meaning two locations on
the visual field are only considered neighbors if they share an edge or corner. An additional criterion
is included that locations are not considered neighbors if they fall within different hemispheres on the
visual field. The adjacency matrix is a 54 x 54 dimensional binary object with zeros on the diagonal and
the column and row sums are equal to the number of neighbors.
</p>

<hr>
<h2 id='HFAII_Rook'>HFAII Rook Adjacency Matrix</h2><span id='topic+HFAII_Rook'></span>

<h3>Description</h3>

<p>Binary adjacency matrix for the Humphrey Field Analyzer-II (Carl Zeiss Meditec Inc., Dublin, CA)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HFAII_Rook)
</code></pre>


<h3>Format</h3>

<p>This adjacency matrix is formatted using rook neighbor criteria, meaning two locations on
the visual field are only considered neighbors if they share an edge. The adjacency matrix is a
54 x 54 dimensional binary object with zeros on the diagonal and the column and row sums are equal
to the number of neighbors.
</p>

<hr>
<h2 id='is.spCP'>is.spCP</h2><span id='topic+is.spCP'></span>

<h3>Description</h3>

<p><code>is.spCP</code> is a general test of an object being interpretable as a
<code><a href="#topic+spCP">spCP</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.spCP(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.spCP_+3A_x">x</code></td>
<td>
<p>object to be tested.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+spCP">spCP</a></code> class is defined as the regression object that
results from the <code><a href="#topic+spCP">spCP</a></code> regression function.
</p>

<hr>
<h2 id='PlotCP'>PlotCP</h2><span id='topic+PlotCP'></span>

<h3>Description</h3>

<p>Plots estimated visual field sensitivities using change point model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotCP(
  object,
  data,
  location = "Location",
  time = "Time",
  dls = "DLS",
  line = TRUE,
  ci = TRUE,
  lwd = 1,
  lty = 1,
  col = 2,
  ci.lwd = 1,
  ci.lty = 2,
  ci.col = 2,
  cp.line = FALSE,
  cp.ci = FALSE,
  cp.lwd = 1,
  cp.lty = 1,
  cp.col = 4,
  cp.ci.lwd = 1,
  cp.ci.lty = 2,
  cp.ci.col = 4,
  main = "Estimated visual field sensitivity\nusing change points",
  xlab = "Years from baseline visit",
  ylab = "Sensitivity (dB)"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotCP_+3A_object">object</code></td>
<td>
<p>a spCP regression object.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_data">data</code></td>
<td>
<p>a dataframe containing the raw sensitivities.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_location">location</code></td>
<td>
<p>a character string indicating the column name in data of the variable of locations on the visual field.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_time">time</code></td>
<td>
<p>a character string indicating the column name in data of the variable of visual field testing times.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_dls">dls</code></td>
<td>
<p>a character string indicating the column name in data of the variable of the raw visual field sensitivities.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_line">line</code></td>
<td>
<p>logical, determines if there are regression lines printed (default = TRUE).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_ci">ci</code></td>
<td>
<p>logical, determines if there are confidence intervals printed (default = TRUE).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_lwd">lwd</code></td>
<td>
<p>integer, specifies the width of the regression line (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_lty">lty</code></td>
<td>
<p>integer, specifies the type of regression line (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_col">col</code></td>
<td>
<p>color for the regression line, either character string corresponding
to a color or a integer (default = &quot;red&quot;).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_ci.lwd">ci.lwd</code></td>
<td>
<p>integer, specifies the width of the confidence intervals (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_ci.lty">ci.lty</code></td>
<td>
<p>integer, specifies the type of confidence intervals (default = 2).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_ci.col">ci.col</code></td>
<td>
<p>color for the confidence intervals for the regression line, either character string corresponding
to a color or a integer (default = &quot;red&quot;).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.line">cp.line</code></td>
<td>
<p>logical, determines if there the change point is printed (default = FALSE).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.ci">cp.ci</code></td>
<td>
<p>logical, determines if there the change point confidence intervals are printed (default = FALSE).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.lwd">cp.lwd</code></td>
<td>
<p>integer, specifies the width of the change point line (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.lty">cp.lty</code></td>
<td>
<p>integer, specifies the type of change point line (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.col">cp.col</code></td>
<td>
<p>color for the optional change point, either character string corresponding
to a color or a integer (default = &quot;blue&quot;).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.ci.lwd">cp.ci.lwd</code></td>
<td>
<p>integer, specifies the width of the change point confidence intervals (default = 1).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.ci.lty">cp.ci.lty</code></td>
<td>
<p>integer, specifies the type of change point confidence intervals (default = 2).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_cp.ci.col">cp.ci.col</code></td>
<td>
<p>color for the confidence intervals of the optional change point, either character string corresponding
to a color or a integer (default = &quot;blue&quot;).</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis.</p>
</td></tr>
<tr><td><code id="PlotCP_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PlotCP</code> is used in the application of glaucoma progression.
The function is capable of plotting the observed DLS values across the visual field,
along with the estimated mean process (with 95 percent credible intervals) and the
estimated mean posterior change point location (with 95 percent credible intervals).
</p>


<h3>Author(s)</h3>

<p>Samuel I. Berchuck
</p>

<hr>
<h2 id='predict.spCP'>predict.spCP</h2><span id='topic+predict.spCP'></span>

<h3>Description</h3>

<p>Predicts future observations from the <code><a href="#topic+spCP">spCP</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spCP'
predict(object, NewTimes, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.spCP_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+spCP">spCP</a></code> model object for which predictions
are desired from.</p>
</td></tr>
<tr><td><code id="predict.spCP_+3A_newtimes">NewTimes</code></td>
<td>
<p>a numeric vector including desired time(s) points for prediction.</p>
</td></tr>
<tr><td><code id="predict.spCP_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.spCP</code> uses Bayesian krigging to obtain posterior samples
from future time points.
</p>


<h3>Value</h3>

<p><code>predict.spCP</code> returns a list containing the following objects.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>A <code>list</code> containing a matrix of predictions for each future time
point. Each matrix has one column for each location and contains posterior
samples obtained by Bayesian krigging.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel I. Berchuck
</p>

<hr>
<h2 id='spCP'>MCMC sampler for spatially varying change point model.</h2><span id='topic+spCP'></span>

<h3>Description</h3>

<p><code>spCP</code> is a Markov chain Monte Carlo (MCMC) sampler for a spatially varying change point
model with spatially varying slopes, intercepts, and unique variances at each spatial-temporal
location. The model is implemented using a Bayesian hierarchical framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spCP(
  Y,
  DM,
  W,
  Time,
  Starting = NULL,
  Hypers = NULL,
  Tuning = NULL,
  MCMC = NULL,
  Family = "tobit",
  Weights = "continuous",
  Distance = "circumference",
  Rho = 0.99,
  ScaleY = 10,
  ScaleDM = 100,
  Seed = 54
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spCP_+3A_y">Y</code></td>
<td>
<p>An <code>N</code> dimensional vector containing the observed outcome data.
Here, <code>N = M * Nu</code>, where <code>M</code> represents the number of spatial locations
and <code>Nu</code> the number of temporal visits. The observations in <code>Y</code> must be first
ordered spatially and then temporally, meaning the first <code>M</code> observations
in <code>Y</code> should come from the initial time point.</p>
</td></tr>
<tr><td><code id="spCP_+3A_dm">DM</code></td>
<td>
<p>An <code>M</code> dimensional vector containing a dissimilarity metric
for each spatial location. The order of the spatial locations must match the order from
<code>Y</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_w">W</code></td>
<td>
<p>An <code>M x M</code> dimensional binary adjacency matrix for dictating the
spatial neighborhood structure.</p>
</td></tr>
<tr><td><code id="spCP_+3A_time">Time</code></td>
<td>
<p>A <code>Nu</code> dimensional vector containing the observed time points for each
vector of outcomes in increasing order.</p>
</td></tr>
<tr><td><code id="spCP_+3A_starting">Starting</code></td>
<td>
<p>Either <code>NULL</code> or a <code>list</code> containing starting values
to be specified for the MCMC sampler. If <code>NULL</code> is not chosen then none, some or all
of the starting values may be specified.
</p>
<p>When <code>NULL</code> is chosen then default starting values are automatically generated.
Otherwise a <code>list</code> must be provided with names <code>Delta</code>, <code>Alpha</code> or
<code>Sigma</code> containing appropriate objects. <code>Delta</code> must be a <code>5</code> dimensional
vector, <code>Sigma</code> a <code>5 x 5</code> dimensional matrix and <code>Alpha</code> a scalar.</p>
</td></tr>
<tr><td><code id="spCP_+3A_hypers">Hypers</code></td>
<td>
<p>Either <code>NULL</code> or a <code>list</code> containing hyperparameter values
to be specified for the MCMC sampler. If <code>NULL</code> is not chosen then none, some or all
of the hyperparameter values may be specified.
</p>
<p>When <code>NULL</code> is chosen then default hyperparameter values are automatically
generated. These default hyperparameters are described in detail in (Berchuck et al.).
Otherwise a <code>list</code> must be provided with names <code>Delta</code>, <code>Sigma</code> or
<code>Alpha</code> containing further hyperparameter information. These objects are themselves
<code>lists</code> and may be constructed as follows.
</p>
<p><code>Delta</code> is a <code>list</code> with one object, <code>Kappa2</code>. <code>Kappa2</code> represents
the prior variance and must be a scalar. <code>Sigma</code> is a <code>list</code> with two objects,
<code>Xi</code> and <code>Psi</code>. <code>Xi</code> represents the degrees of freedom parameter for the
inverse-Wishart hyperprior and must be a real number scalar, while <code>Psi</code> represents
the scale matrix and must be a <code>5 x 5</code> dimensional positive definite matrix.
</p>
<p><code>Alpha</code> is a <code>list</code> with two objects, <code>AAlpha</code> and <code>BAlpha</code>. <code>AAlpha</code>
represents the lower bound for the uniform hyperprior, while <code>BAlpha</code> represents
the upper bound. The bounds must be specified carefully.</p>
</td></tr>
<tr><td><code id="spCP_+3A_tuning">Tuning</code></td>
<td>
<p>Either <code>NULL</code> or a <code>list</code> containing tuning values
to be specified for the MCMC Metropolis steps. If <code>NULL</code> is not chosen then all
of the tuning values must be specified.
</p>
<p>When <code>NULL</code> is chosen then default tuning values are automatically generated to
<code>1</code>. Otherwise a <code>list</code> must be provided with names <code>Lambda0Vec</code>,
<code>Lambda1Vec</code>, <code>EtaVec</code> and <code>Alpha</code>. <code>Lambda0Vec</code>, <code>Lambda1Vec</code>,
and <code>EtaVec</code> must be <code>M</code> dimensional vectors and <code>Alpha</code> a scalar.
Each containing tuning variances for their corresponding Metropolis updates.</p>
</td></tr>
<tr><td><code id="spCP_+3A_mcmc">MCMC</code></td>
<td>
<p>Either <code>NULL</code> or a <code>list</code> containing input values to be used
for implementing the MCMC sampler. If <code>NULL</code> is not chosen then all
of the MCMC input values must be specified.
</p>
<p><code>NBurn</code>: The number of sampler scans included in the burn-in phase. (default =
<code>10,000</code>)
</p>
<p><code>NSims</code>: The number of post-burn-in scans for which to perform the
sampler. (default = <code>100,000</code>)
</p>
<p><code>NThin</code>: Value such that during the post-burn-in phase, only every
<code>NThin</code>-th scan is recorded for use in posterior inference (For return values
we define, NKeep = NSims / NThin (default = <code>10</code>).
</p>
<p><code>NPilot</code>: The number of times during the burn-in phase that pilot adaptation
is performed (default = <code>20</code>)</p>
</td></tr>
<tr><td><code id="spCP_+3A_family">Family</code></td>
<td>
<p>Character string indicating the distribution of the observed data. Options
include: <code>"normal"</code>, <code>"probit"</code>, <code>"tobit"</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_weights">Weights</code></td>
<td>
<p>Character string indicating the type of weight used. Options include:
<code>"continuous"</code> and <code>"binary"</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_distance">Distance</code></td>
<td>
<p>Character string indicating the distance metric for computing the
dissimilarity metric. Options include: <code>"euclidean"</code> and <code>"circumference"</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_rho">Rho</code></td>
<td>
<p>A scalar in <code>(0,1)</code> that dictates the magnitude of local spatial sharing.
By default it is fixed at <code>0.99</code> as suggested by Lee and Mitchell (2012).</p>
</td></tr>
<tr><td><code id="spCP_+3A_scaley">ScaleY</code></td>
<td>
<p>A positive scalar used for scaling the observed data, <code>Y</code>. This is
used to aid numerically for MCMC convergence, as scaling large observations often
stabilizes chains. By default it is fixed at <code>10</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_scaledm">ScaleDM</code></td>
<td>
<p>A positive scalar used for scaling the dissimilarity metric distances,
<code>DM</code>. This is used to aid numerically for MCMC convergence. as scaling spatial
distances is often used for improved MCMC convergence. By default it is fixed at <code>100</code>.</p>
</td></tr>
<tr><td><code id="spCP_+3A_seed">Seed</code></td>
<td>
<p>An integer value used to set the seed for the random number generator
(default = 54).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details of the underlying statistical model proposed by proposed by
Berchuck et al. 2018. are forthcoming.
</p>


<h3>Value</h3>

<p><code>spCP</code> returns a list containing the following objects
</p>

<dl>
<dt><code>beta0</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>beta0</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>beta1</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>beta1</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>lambda0</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>lambda0</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>lambda1</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>lambda1</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>eta</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>eta</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>theta</code></dt><dd><p><code>NKeep x M</code> <code>matrix</code> of posterior samples for <code>theta</code>.
The s-th column contains posterior samples from the the s-th location.</p>
</dd>
<dt><code>delta</code></dt><dd><p><code>NKeep x 5</code> <code>matrix</code> of posterior samples for <code>delta</code>.
The columns have names that describe the samples within them.</p>
</dd>
<dt><code>sigma</code></dt><dd><p><code>NKeep x 15</code> <code>matrix</code> of posterior samples for <code>Sigma</code>. The
columns have names that describe the samples within them. The row is listed first, e.g.,
<code>Sigma32</code> refers to the entry in row <code>3</code>, column <code>2</code>.</p>
</dd>
<dt><code>alpha</code></dt><dd><p><code>NKeep x 1</code> <code>matrix</code> of posterior samples for <code>Alpha</code>.</p>
</dd>
<dt><code>metropolis</code></dt><dd><p><code>(3 * M + 1) x 3</code> <code>matrix</code> of metropolis
acceptance rates, updated tuners, and original tuners that result from the pilot
adaptation. The first <code>M</code> correspond to the <code>Lambda0Vec</code> parameters,
the next <code>M</code> correspond to the <code>Lambda1Vec</code>, the next <code>M</code> correspond
to the <code>EtaVec</code> parameters and the last row give the <code>Alpha</code> values.</p>
</dd>
<dt><code>runtime</code></dt><dd><p>A <code>character</code> string giving the runtime of the MCMC sampler.</p>
</dd>
<dt><code>datobj</code></dt><dd><p>A <code>list</code> of data objects that are used in future <code>spCP</code> functions
and should be ignored by the user.</p>
</dd>
<dt><code>dataug</code></dt><dd><p>A <code>list</code> of data augmentation objects that are used in future
<code>spCP</code> functions and should be ignored by the user.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel I. Berchuck <a href="mailto:sib2@duke.edu">sib2@duke.edu</a>
</p>


<h3>References</h3>

<p>Reference for Berchuck et al. 2018 is forthcoming.
</p>

<hr>
<h2 id='VFSeries'>Visual field series for one patient.</h2><span id='topic+VFSeries'></span>

<h3>Description</h3>

<p>A dataset containing 9 visual field series from a patient of the Vein Pulsation Study
Trial in Glaucoma and the Lions Eye Institute trial registry, Perth, Western Australia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(VFSeries)
</code></pre>


<h3>Format</h3>

<p>A data frame with 486 rows and 4 variables:
</p>

<dl>
<dt>Visit</dt><dd><p>The visual field test visit number, (1, 2, ... , 9).</p>
</dd>
<dt>DLS</dt><dd><p>The observed outcome variable, differential light sensitivity (DLS).</p>
</dd>
<dt>Time</dt><dd><p>The time of the visual field test (in days from baseline).</p>
</dd>
<dt>Location</dt><dd><p>The location on the visual field of a Humphrey Field Analyzer-II
(Carl Zeiss Meditec Inc., Dublin, CA) (1, 2, ... , 54).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://anzctr.org.au/Trial/Registration/TrialReview.aspx?ACTRN=12608000274370">https://anzctr.org.au/Trial/Registration/TrialReview.aspx?ACTRN=12608000274370</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
