<!DOCTYPE html><html><head><title>Help for package FieldSimR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FieldSimR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compsym_asr_input'><p>Simulate genetic values based on a compound symmetry model for GxE interaction - 'AlphaSimR'</p>
input parameters</a></li>
<li><a href='#compsym_asr_output'><p>Simulate genetic values based on a compound symmetry model for GxE interaction -</p>
Simulation using 'AlphaSimR'</a></li>
<li><a href='#df_error_bivar'><p>Plot errors - example data frame</p></a></li>
<li><a href='#df_gv_unstr'><p>Genetic values - example data frame</p></a></li>
<li><a href='#field_trial_error'><p>Simulate plot errors in multi-environment field trials</p></a></li>
<li><a href='#make_phenotypes'><p>Simulate phenotypes - Combine simulated genetic values and plot errors</p></a></li>
<li><a href='#plot_effects'><p>Graphics for plot effects</p></a></li>
<li><a href='#qq_plot'><p>Q-Q plot</p></a></li>
<li><a href='#rand_cor_mat'><p>Random correlation matrix</p></a></li>
<li><a href='#sample_variogram'><p>Sample variogram</p></a></li>
<li><a href='#theoretical_variogram'><p>Theoretical variogram</p></a></li>
<li><a href='#unstr_asr_input'><p>Simulate genetic values based on an unstructured model for GxE interaction - 'AlphaSimR' input</p>
parameters</a></li>
<li><a href='#unstr_asr_output'><p>Simulate genetic values based on an unstructured model for GxE interaction -</p>
Simulation using 'AlphaSimR'</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Simulation of Plot Errors and Phenotypes in Plant Breeding Field
Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-02</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Werner &lt;werner.christian@proton.me&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulates plot data in field trials for multiple 
	traits across multiple environments. Its core function generates plot errors comprising 1) 
	a spatially correlated error term, 2) a random error term, and 3) an extraneous error 
	term. Spatially correlated errors are simulated using either bivariate interpolation 
	or a two-dimensional autoregressive process of order one (AR1:AR1). The three error 
	terms are combined at a user-defined ratio. Plot phenotypes can be generated 
	by combining the simulated errors with genetic values (e.g. true, simulated 
	or predicted). 'FieldSimR' provides wrapper functions to simulate genetic values for 
	multiple traits across multiple environments using the 'R' package 'AlphaSimR'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/crWerner/fieldsimr">https://github.com/crWerner/fieldsimr</a>,
<a href="https://crwerner.github.io/fieldsimr/">https://crwerner.github.io/fieldsimr/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, interp, lattice, matrixcalc, mbend</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AlphaSimR, knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-03 17:05:39 UTC; CWERNER</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Werner <a href="https://orcid.org/0000-0001-9400-5061"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Daniel Tolhurst <a href="https://orcid.org/0000-0002-4787-080X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Chris Gaynor <a href="https://orcid.org/0000-0003-0558-6656"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Giovanny Covarrubias-Pazaran
    <a href="https://orcid.org/0000-0002-7194-3837"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Lorena Batista <a href="https://orcid.org/0000-0001-8472-8776"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-03 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compsym_asr_input'>Simulate genetic values based on a compound symmetry model for GxE interaction - 'AlphaSimR'
input parameters</h2><span id='topic+compsym_asr_input'></span>

<h3>Description</h3>

<p>Creates a list of input parameters for
<a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> to simulate
genetic values for multiple traits across multiple environments based on a compound symmetry
model for genotype-by-environment (GxE) interaction. <br />
By default, 'AlphaSimR' does not support complex models for GxE interaction. However, its
functionality to simulate correlated genetic values can be utilised for this purpose by
providing the required variance structures. <code>compsym_asr_input</code> is a wrapper function to
construct the variance structures required to simulate GxE interaction in 'AlphaSimR' based on
a multi-trait compound symmetry model. This function assumes a separable structure between
traits and environments. After simulating the genetic values, the wrapper function
<a href="#topic+compsym_asr_output">compsym_asr_output</a> can be used to obtain data frames with the values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compsym_asr_input(
  n_envs = 3,
  n_traits = 2,
  mean = 0,
  var = 1,
  rel_main_eff_A = 0.5,
  cor_A = NULL,
  mean_DD = NULL,
  var_DD = NULL,
  rel_main_eff_DD = NULL,
  cor_DD = NULL,
  rel_AA = NULL,
  rel_main_eff_AA = NULL,
  cor_AA = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compsym_asr_input_+3A_n_envs">n_envs</code></td>
<td>
<p>Number of environments to be simulated. A minimum of two environments is required.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_n_traits">n_traits</code></td>
<td>
<p>Number of traits to be simulated.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_mean">mean</code></td>
<td>
<p>A vector of mean genetic values for each environment-within-trait combination.
If only one value is specified, all environment-within-trait combinations will be assigned
the same mean.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_var">var</code></td>
<td>
<p>A vector of genetic variances for each trait. Simulated traits are restricted by the
compound symmetry model to having the same variance for each environment (i.e., main
effect variance + GxE interaction variance) and the same covariance between each pair of
environments (main effect variance). <br />
<strong>Note:</strong> When <code>useVarA = TRUE</code> is specified in 'AlphaSimR' (default) the values in
<code>var</code> represent the <code>additive</code> genetic variances, otherwise they will represent the
<code>total</code> (additive + non-additive) genetic variances.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_rel_main_eff_a">rel_main_eff_A</code></td>
<td>
<p>A vector defining the magnitude of the additive main effect variance
relative to the additive main effect + GxE interaction variance for each trait. If only one
value is specified, all traits will be assigned the same relative magnitude. <br />
<strong>Note:</strong> <code>0 &lt; rel_main_eff_A &lt; 1</code>.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_cor_a">cor_A</code></td>
<td>
<p>A matrix of additive genetic correlations between traits. By default, a diagonal
matrix is constructed.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_mean_dd">mean_DD</code></td>
<td>
<p>A vector of mean dominance degrees for each environment-within-trait combination
(similar to <code>mean</code>). If only one value is specified, all environment-within-trait
combinations will be assigned the same mean. By default, <code>mean_DD = NULL</code> and dominance
is not simulated.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_var_dd">var_DD</code></td>
<td>
<p>A vector of dominance degree variances for each trait. Simulated traits have the
same dominance degree variance for each environment and the same dominance degree covariance
between each pair of environments (similar to <code>var</code>).</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_rel_main_eff_dd">rel_main_eff_DD</code></td>
<td>
<p>A vector defining the magnitude of the dominance degree main effect
variance relative to the main effect + GxE interaction variance for each trait (similar to
<code>rel_main_eff_A</code>). If only one value is specified, all traits will be assigned the same
relative magnitude. <br />
<strong>Note:</strong> <code>0 &lt; rel_main_eff_DD &lt; 1</code>.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_cor_dd">cor_DD</code></td>
<td>
<p>A matrix of dominance degree correlations between traits (similar
to <code>cor_A</code>). If not specified and dominance is simulated, a diagonal matrix is constructed.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_rel_aa">rel_AA</code></td>
<td>
<p>A vector defining the magnitude of additive-by-additive (epistatic) variance
relative to the additive genetic variance for each trait, that is in a diploid organism with
allele frequency 0.5. Simulated traits have the same epistatic variance for each environment
and the same epistatic covariance between each pair of environments (similar to <code>var</code>).
If only one value is specified, all traits will be assigned the same relative magnitude.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_rel_main_eff_aa">rel_main_eff_AA</code></td>
<td>
<p>A vector defining the magnitude of the epistatic main effect variance
relative to the main effect + GxE interaction variance for each trait (similar to
<code>rel_main_eff_A</code>). If only one value is specified, all traits will be assigned the
same relative magnitude. <br />
<strong>Note:</strong> <code>0 &lt; rel_main_eff_AA &lt; 1</code>.</p>
</td></tr>
<tr><td><code id="compsym_asr_input_+3A_cor_aa">cor_AA</code></td>
<td>
<p>A matrix of epistatic correlations between traits (similar to
<code>cor_A</code>). If not specified and epistasis is simulated, a diagonal matrix is constructed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Note:</strong> 'AlphaSimR' can simulate different biological effects (see:
<a href="https://gaynorr.github.io/AlphaSimR/reference/SimParam.html">SimParam</a>).
</p>

<ul>
<li><p> For additive traits use <code>addTraitA()</code>.
</p>
</li>
<li><p> For additive + dominance traits use <code>addTraitAD()</code>.
</p>
</li>
<li><p> For additive + epistatic traits use <code>addTraitAE()</code>.
</p>
</li>
<li><p> For additive + dominance + epistatic traits use <code>addTraitADE()</code>.
</p>
</li></ul>

<p>If non-additive effects are to be simulated, check the <code>useVarA</code> argument of these
functions.
</p>


<h3>Value</h3>

<p>A list containing input parameters for 'AlphaSimR', which is used to simulate
correlated genetic effects based on a compound symmetry model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate genetic values in 'AlphaSimR' for two additive + dominance traits across
# two environments based on a compound symmetry model for GxE interaction.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
mean_DD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same values in the two environments.

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.08, 13) # Different values set for traits 1 and 2.
var_DD &lt;- c(0.2, 0.2) # The same value set for traits 1 and 2.

# Relative magnitude of the additive and dominance degree main effect variances.
rel_main_eff_A &lt;- c(0.4, 0.6) # Different values set for traits 1 and 2.
rel_main_eff_DD &lt;- 0.4 # The same value set for traits 1 and 2.

# Additive and dominance degree correlations between the two simulated traits.
cor_A &lt;- matrix( # Additive correlation matrix.
  c(
    1.0, 0.5,
    0.5, 1.0
  ),
  ncol = 2
)
cor_DD &lt;- diag(2) # Dominance correlation matrix - assume independence.

input_asr &lt;- compsym_asr_input(
  n_envs = 2,
  n_traits = 2,
  mean = mean,
  var = var,
  rel_main_eff_A = rel_main_eff_A,
  cor_A = cor_A,
  mean_DD = mean_DD,
  var_DD = var_DD,
  rel_main_eff_DD = rel_main_eff_DD,
  cor_DD = cor_DD
)
</code></pre>

<hr>
<h2 id='compsym_asr_output'>Simulate genetic values based on a compound symmetry model for GxE interaction -
Simulation using 'AlphaSimR'</h2><span id='topic+compsym_asr_output'></span>

<h3>Description</h3>

<p>Creates a data frame of simulated genetic values for multiple traits across multiple environments
based on a compound symmetry model for genotype-by-environment (GxE) interaction. This function
requires an <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> population object
generated using the function <a href="#topic+compsym_asr_input">compsym_asr_input</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compsym_asr_output(pop, n_envs, n_traits, n_reps, effects = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compsym_asr_output_+3A_pop">pop</code></td>
<td>
<p>An <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> population object
(<a href="https://gaynorr.github.io/AlphaSimR/reference/Pop-class.html">Pop-class</a> or
<a href="https://gaynorr.github.io/AlphaSimR/reference/HybridPop-class.html">HybridPop-class</a>)
generated using <a href="#topic+compsym_asr_input">compsym_asr_input</a>.</p>
</td></tr>
<tr><td><code id="compsym_asr_output_+3A_n_envs">n_envs</code></td>
<td>
<p>Number of simulated environments (same number used in
<a href="#topic+compsym_asr_input">compsym_asr_input</a>).</p>
</td></tr>
<tr><td><code id="compsym_asr_output_+3A_n_traits">n_traits</code></td>
<td>
<p>Number of simulated traits (same number used in <a href="#topic+compsym_asr_input">compsym_asr_input</a>).</p>
</td></tr>
<tr><td><code id="compsym_asr_output_+3A_n_reps">n_reps</code></td>
<td>
<p>A vector defining the number of replicates in each environment. If only one value
is specified, all environments will be assigned the same number.</p>
</td></tr>
<tr><td><code id="compsym_asr_output_+3A_effects">effects</code></td>
<td>
<p>When <code>TRUE</code>, a list is returned with additional entries containing the total
(additive + dominance + epistatic) main effects and GxE interaction effects for each
environment-within-trait combination. By default, <code>effects = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns 'env', 'rep', genotype 'id', and the
simulated genetic values for each trait. When <code>effects = TRUE</code>, a list is returned with
additional entries containing the total (additive + dominance + epistatic) main effects and
GxE interaction effects for each environment-within-trait combination.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate genetic values in 'AlphaSimR' for two additive + dominance traits across
# two environments based on a compound symmetry model for GxE interaction.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
mean_DD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same values in the two environments.

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.08, 13) # Different values set for traits 1 and 2.
var_DD &lt;- c(0.2, 0.2) # The same value set for traits 1 and 2.

# Relative magnitude of the additive and dominance degree main effect variances.
rel_main_eff_A &lt;- c(0.4, 0.6) # Different values set for traits 1 and 2.
rel_main_eff_DD &lt;- 0.4 # The same value set for traits 1 and 2.

# Additive and dominance degree correlations between the two simulated traits.
cor_A &lt;- matrix( # Additive correlation matrix.
  c(
    1.0, 0.5,
    0.5, 1.0
  ),
  ncol = 2
)
cor_DD &lt;- diag(2) # Dominance correlation matrix - assume independence.

input_asr &lt;- compsym_asr_input(
  n_envs = 2,
  n_traits = 2,
  mean = mean,
  var = var,
  rel_main_eff_A = rel_main_eff_A,
  cor_A = cor_A,
  mean_DD = mean_DD,
  var_DD = var_DD,
  rel_main_eff_DD = rel_main_eff_DD,
  cor_DD = cor_DD
)


# 2. Use input_asr to simulate genetic values in 'AlphaSimR' based on a compound symmetry model
# for GxE interaction.

library("AlphaSimR")
FOUNDERPOP &lt;- quickHaplo(
  nInd = 10,
  nChr = 1,
  segSites = 20
)

SP &lt;- SimParam$new(FOUNDERPOP)



SP$addTraitAD(
  nQtlPerChr = 20,
  mean = input_asr$mean,
  var = input_asr$var,
  meanDD = input_asr$mean_DD,
  varDD = input_asr$var_DD,
  corA = input_asr$cor_A,
  corDD = input_asr$cor_DD,
  useVarA = TRUE
)

# By default, the value provided in 'var' represents the additive variance.
# If useVarA = FALSE, 'var' represents the total genetic variance.

pop &lt;- newPop(FOUNDERPOP)


# 3. Create a data frame containing the simulated genetic values for the two traits across the
# two environments.

n_reps &lt;- c(2, 2) # Vector containing the number of complete replicates in each environment.

gv_df &lt;- compsym_asr_output(
  pop = pop,
  n_envs = 2,
  n_traits = 2,
  n_reps = n_reps,
  effects = TRUE
)
</code></pre>

<hr>
<h2 id='df_error_bivar'>Plot errors - example data frame</h2><span id='topic+df_error_bivar'></span>

<h3>Description</h3>

<p>An example data frame of simulated plot errors for two traits across three locations. The first
and the third location include two blocks, and the second location includes three blocks.
Each block comprises 20 rows and 5 columns. The data frame was generated using the
function <a href="#topic+field_trial_error">field_trial_error</a> with bivariate interpolation. The simulation of
the plot errors is shown in the vignette on the
<a href="https://crwerner.github.io/fieldsimr/articles/spatial_error_demo.html">Simulation of plot errors and phenotypes for a multi-environment plant breeding trial</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_error_bivar
</code></pre>


<h3>Format</h3>

<p>A data frame with 700 rows and 6 columns:
</p>

<dl>
<dt>env</dt><dd><p>Environment id</p>
</dd>
<dt>block</dt><dd><p>Block id</p>
</dd>
<dt>col</dt><dd><p>Column id</p>
</dd>
<dt>row</dt><dd><p>Row id</p>
</dd>
<dt>e.Trait.1</dt><dd><p>Simulated plot error for trait 1</p>
</dd>
<dt>e.Trait.2</dt><dd><p>Simulated plot error for trait 2</p>
</dd>
</dl>


<hr>
<h2 id='df_gv_unstr'>Genetic values - example data frame</h2><span id='topic+df_gv_unstr'></span>

<h3>Description</h3>

<p>An example data frame of simulated genetic values for 100 genotypes with two traits across
three environments. The data frame was generated using the wrapper functions
<a href="#topic+unstr_asr_input">unstr_asr_input</a> and <a href="#topic+unstr_asr_output">unstr_asr_output</a> to simulate correlated
genetic values based on an unstructured model for genotype-by-environment (GxE) interaction
with <a href="https://CRAN.R-project.org/package=AlphaSimR">&lsquo;AlphaSimR&rsquo;</a>. The simulation of
the genetic values is shown in the vignette on the
<a href="https://crwerner.github.io/fieldsimr/articles/unstructured_GxE_demo.html">Simulation of genetic values using an unstructured GxE interaction model</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_gv_unstr
</code></pre>


<h3>Format</h3>

<p>A data frame with 700 rows and 5 columns:
</p>

<dl>
<dt>env</dt><dd><p>Environment id</p>
</dd>
<dt>rep</dt><dd><p>Replicate id</p>
</dd>
<dt>id</dt><dd><p>Genotype id</p>
</dd>
<dt>gv.Trait.1</dt><dd><p>Simulated genetic values for trait 1</p>
</dd>
<dt>gv.Trait.2</dt><dd><p>Simulated genetic values for trait 2</p>
</dd>
</dl>


<hr>
<h2 id='field_trial_error'>Simulate plot errors in multi-environment field trials</h2><span id='topic+field_trial_error'></span>

<h3>Description</h3>

<p>Creates a data frame of simulated plot errors for multi-environment field trials with one or
more traits. The plot errors comprise spatially correlated error (trend), random error (noise)
and extraneous error. The spatially correlated error is simulated according to either
1) bivariate interpolation using the <code>interp</code> function of the package
<a href="https://CRAN.R-project.org/package=interp">&lsquo;interp&rsquo;</a>, or 2) a separable first-order
autoregressive process (AR1:AR1). The random error is simulated using an independent process.
The extraneous error is simulated as the sum of column and/or row terms, where the user can
choose from an independent or a correlated process. The spatially correlated, random, and extraneous
errors are combined according to a user-defined ratio. <br />
For multiple traits, correlated errors can be simulated assuming 1) correlated spatial error
between traits, 2) correlated random error between traits, 3) correlated extraneous error
between traits, or 4) some combination of 1-3. <br />
A separable correlation structure is assumed between traits and environments, but different
variances can be assigned to different environment-within-trait combinations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>field_trial_error(
  n_envs = 1,
  n_traits = 1,
  n_blocks = 2,
  n_cols = 10,
  n_rows = 20,
  block_dir = "col",
  var_R = 1,
  S_cor_R = NULL,
  R_cor_R = NULL,
  E_cor_R = NULL,
  spatial_model = "Bivariate",
  complexity = NULL,
  plot_length = 5,
  plot_width = 2,
  col_cor = 0.5,
  row_cor = 0.7,
  prop_spatial = 0.4,
  prop_ext = 0,
  ext_dir = "row",
  ext_ord = "random",
  return_effects = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="field_trial_error_+3A_n_envs">n_envs</code></td>
<td>
<p>Number of environments to be simulated (same number used for <code>compsym_asr_input</code>
or <code>unstr_asr_output</code>, where applicable).</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_n_traits">n_traits</code></td>
<td>
<p>Number of traits to be simulated.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_n_blocks">n_blocks</code></td>
<td>
<p>A vector specifying the number of blocks in each environment.
If only one value is provided, all environments will be assigned the same number.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_n_cols">n_cols</code></td>
<td>
<p>A vector specifying the total number of columns in each environment. If only one
value is provided, all environments will be assigned the same number.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_n_rows">n_rows</code></td>
<td>
<p>A vector specifying the total number of rows in each environment. If only one
value is provided, all environments will be assigned the same number.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_block_dir">block_dir</code></td>
<td>
<p>A vector specifying the block direction in each environment. Use
'col' for a side-by-side arrangement (default), 'row' for an above-and-below arrangement, or
NA if only one block is simulated. If only one value is provided, all environments
will be assigned the same block direction (where applicable).</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_var_r">var_R</code></td>
<td>
<p>A vector of error variances for each environment-within-trait combination. If only
one value is provided, all environment-within-trait combinations will be assigned the same
error variance.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_s_cor_r">S_cor_R</code></td>
<td>
<p>A matrix of spatial error correlations between traits. If not specified and
spatial error is simulated, a diagonal matrix is constructed.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_r_cor_r">R_cor_R</code></td>
<td>
<p>A matrix of random error correlations between traits. If not specified and
random error is simulated, a diagonal matrix is constructed.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_e_cor_r">E_cor_R</code></td>
<td>
<p>A matrix of extraneous error correlations between traits. If not specified and
an extraneous error is simulated, a diagonal matrix is constructed. <br />
<strong>Note:</strong> the same correlation between traits is used for the column and row errors
(where applicable). Currently only implemented when <code>ext_ord = "random"</code>.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_spatial_model">spatial_model</code></td>
<td>
<p>A character string specifying the model used to simulate the two-dimensional
spatial error term. One of either 'Bivariate' (bivariate interpolation, the default) or 'AR1:AR1'
(separable first-order autoregressive process).</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_complexity">complexity</code></td>
<td>
<p>A vector specifying the complexity of the bivariate interpolation in each
environment. If only one value is provided, all environments will be assigned the same complexity.
If not specified and <code>spatial_model = "Bivariate"</code>, the complexity is set to half the maximum
number of columns and rows in each environment. This generally provides good results. See
<a href="https://CRAN.R-project.org/package=interp">&lsquo;interp&rsquo;</a> for further details.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_plot_length">plot_length</code></td>
<td>
<p>A vector of plot lengths (column direction, usually longer side) for each
environment. If only one value is provided, all environments will be assigned the same plot
length. Only required when <code>spatial_model = "Bivariate"</code>.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_plot_width">plot_width</code></td>
<td>
<p>A vector of plot widths (row direction, usually shorter side) for each
environment. If only one value is provided, all environments will be assigned the same plot
width. Only required when <code>spatial_model = "Bivariate"</code>.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_col_cor">col_cor</code></td>
<td>
<p>A vector of column autocorrelations for each environment used in the AR1:AR1
spatial error model. If only one value is provided, all environments will be assigned the same
column autocorrelation. Only required when <code>spatial_model = "AR1:AR1"</code>.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_row_cor">row_cor</code></td>
<td>
<p>A vector of row autocorrelations for each environment used in the AR1:AR1 spatial
error model. If only one value is provided, all environments will be assigned the same row
autocorrelation. Only required when <code>spatial_model = "AR1:AR1"</code>.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_prop_spatial">prop_spatial</code></td>
<td>
<p>A vector specifying the proportion of spatial error variance to total error
variance (spatial + random + extraneous) for each environment-within-trait combination. If only
one value is provided, all environment-within-trait combinations will be assigned the proportion
of spatial error variance.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_prop_ext">prop_ext</code></td>
<td>
<p>A vector specifying the proportion of extraneous error variance to total error
variance (spatial + random + extraneous) for each environment-within-trait combination. If only
one value is provided, all environment-within-trait combinations will be assigned the proportion
of extraneous error variance.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_ext_dir">ext_dir</code></td>
<td>
<p>A vector specifying the direction of extraneous variation for each environment.
Use 'col' to simulate variation in the column direction, 'row' (default) for variation in the
row direction, 'both' for variation in both directions, or NA if zero extraneous variation is
simulated. When <code>ext_dir = "both"</code>, half the variance is assigned to the columns and
half is assigned to the rows. If only one value is provided, all environments will be
assigned the same direction (where applicable).</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_ext_ord">ext_ord</code></td>
<td>
<p>A character string specifying the method used to simulate the extraneous error term.
One of either 'random' (the default) or 'zig-zag'. The zig-zag ordering is achieved by alternating
positive and negative values between neighbouring columns and rows.</p>
</td></tr>
<tr><td><code id="field_trial_error_+3A_return_effects">return_effects</code></td>
<td>
<p>When <code>TRUE</code>, a list is returned with additional entries for each trait
containing the spatial, random and extraneous errors. By default, <code>return_effects = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns 'env', 'block', 'col' and 'row', as well as the
simulated error for each trait. When <code>return_effects = TRUE</code>, a list is returned with
additional columns for each trait providing the spatial, random and extraneous errors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate plot errors for two traits across two environments using an AR1 model
# for spatial variation.

# Error variances for the four environment-within-trait combinations.
var_R &lt;- c(0.2, 0.4, 10, 15) # Trait 1 x 2 environments, trait 2 x 2 environments.

# Spatial error correlations between the two simulated traits.
S_cor_R &lt;- matrix(
  c(
    1.0, 0.2,
    0.2, 1.0
  ),
  ncol = 2
)

error_df &lt;- field_trial_error(
  n_envs = 2,
  n_traits = 2,
  n_blocks = c(2, 2),
  n_cols = 10,
  n_rows = c(20, 20),
  block_dir = "row",
  var_R = var_R,
  S_cor_R = S_cor_R,
  spatial_model = "AR1:AR1",
  col_cor = 0.5,
  row_cor = 0.7,
  prop_spatial = 0.4,
  prop_ext = 0.2,
  ext_dir = "row",
  ext_ord = "random",
  return_effects = FALSE
)
</code></pre>

<hr>
<h2 id='make_phenotypes'>Simulate phenotypes - Combine simulated genetic values and plot errors</h2><span id='topic+make_phenotypes'></span>

<h3>Description</h3>

<p>Creates a data frame of simulated phenotypes for one or more traits by
combining simulated plot errors with genetic values (e.g. true, simulated or predicted).
The genetic values can be generated externally, but note that they must be stored in a
data frame as described below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_phenotypes(gv_df, error_df, randomise = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_phenotypes_+3A_gv_df">gv_df</code></td>
<td>
<p>A data frame of genetic values. Must contain the columns 'env', 'rep', and 'id',
followed by the genetic values for each trait.</p>
</td></tr>
<tr><td><code id="make_phenotypes_+3A_error_df">error_df</code></td>
<td>
<p>A data frame of plot errors. Must contain the columns 'env', 'block',
'col', and 'row', followed by the plot errors for each trait.</p>
</td></tr>
<tr><td><code id="make_phenotypes_+3A_randomise">randomise</code></td>
<td>
<p>When TRUE, genotypes are randomly allocated to plots within blocks to generate
a randomized complete block design (RCBD).<br />
<strong>Note:</strong> Other experimental designs must be generated externally.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns 'env', 'block', 'column', 'row' and 'genotype', followed by
the phenotypes for each trait.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate phenotypes by combining the genetic values and plot errors provided in
# the two example data frames 'df_gv_unstr' and 'df_error_bivar'.

gv_df &lt;- df_gv_unstr
error_df &lt;- df_error_bivar

pheno_df &lt;- make_phenotypes(
  gv_df,
  error_df,
  randomise = TRUE
)
</code></pre>

<hr>
<h2 id='plot_effects'>Graphics for plot effects</h2><span id='topic+plot_effects'></span>

<h3>Description</h3>

<p>Graphically displays plot effects (e.g., phenotypes, genetic values, plot errors) onto a
field array, in which the colour gradient ranges from red (low value) to green (high value).
The function requires a data frame generated with field_trial_error as an input, or any data
frame with columns 'col', 'row', and the effect to be displayed. When the data frame contains a
'block' column, the field array is split into blocks if <code>blocks = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_effects(df, effect, blocks = TRUE, labels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_effects_+3A_df">df</code></td>
<td>
<p>A data frame with columns 'col', 'row', and the effect to be plotted. When <code>df</code>
also contains a 'block' column, the field array is split into blocks if <code>blocks = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_effects_+3A_effect">effect</code></td>
<td>
<p>The effect to be plotted.</p>
</td></tr>
<tr><td><code id="plot_effects_+3A_blocks">blocks</code></td>
<td>
<p>When <code>TRUE</code> (default), the field array is split into blocks.</p>
</td></tr>
<tr><td><code id="plot_effects_+3A_labels">labels</code></td>
<td>
<p>When <code>TRUE</code>, row and column numbers are plotted. By default,
<code>labels = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graphical field array, in which the colour gradient ranges from red (low value)
to green (high value).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot the simulated plot errors for trait 2 in environment 2 provided in the example data
# frame 'df_error_bivar'.

error_df &lt;- df_error_bivar[df_error_bivar$env == 2, ]

plot_effects(
  df = error_df,
  effect = "e.Trait.2"
)
</code></pre>

<hr>
<h2 id='qq_plot'>Q-Q plot</h2><span id='topic+qq_plot'></span>

<h3>Description</h3>

<p>Creates a quantile-quantile (Q-Q) plot which compares the theoretical quantiles of a normal
distribution with the sample quantiles of the distribution of user effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qq_plot(df, effect, labels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qq_plot_+3A_df">df</code></td>
<td>
<p>A data frame containing the effect to be plotted.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_effect">effect</code></td>
<td>
<p>The name of the effect to be plotted.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_labels">labels</code></td>
<td>
<p>When <code>FALSE</code> (default), data points without labels are plotted. When
<code>TRUE</code>, column and row labels are shown in the Q-Q plot. This requires additional
columns 'col' and 'row' in the data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Q-Q plot with the x- and y-axes displaying the theoretical and sample quantiles of
the effect to be plotted, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Q-Q plot of the simulated plot errors for trait 2 in environment 2 provided in the example
# data frame 'df_error_bivar'.

error_df &lt;- df_error_bivar[df_error_bivar$env == 2, ]

qq &lt;- qq_plot(
  df = error_df,
  effect = "e.Trait.2",
  labels = TRUE
)

# Q-Q plot
qq

# Extraction of a data frame containing the theoretical and sample quantiles of
# the effect to be plotted.
qq_df &lt;- qq$data

</code></pre>

<hr>
<h2 id='rand_cor_mat'>Random correlation matrix</h2><span id='topic+rand_cor_mat'></span>

<h3>Description</h3>

<p>Creates a symmetric <code>p x p</code> correlation matrix with user-defined minimum and maximum
correlation values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand_cor_mat(p, min_cor = -1, max_cor = 1, pos_def = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rand_cor_mat_+3A_p">p</code></td>
<td>
<p>A scalar defining the dimensions of the correlation matrix.</p>
</td></tr>
<tr><td><code id="rand_cor_mat_+3A_min_cor">min_cor</code></td>
<td>
<p>A scalar defining the minimum potential value.</p>
</td></tr>
<tr><td><code id="rand_cor_mat_+3A_max_cor">max_cor</code></td>
<td>
<p>A scalar defining the maximum potential value.</p>
</td></tr>
<tr><td><code id="rand_cor_mat_+3A_pos_def">pos_def</code></td>
<td>
<p>When <code>TRUE</code>, the function 'bend' of the package
<a href="https://cran.r-project.org/package=mbend">&lsquo;mbend&rsquo;</a> is used with default arguments to
bend a non-positive-definite correlation matrix to a positive-definite matrix (when
appropriate). By default, <code>pos_def = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric <code>p x p</code> correlation matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cor_A &lt;- rand_cor_mat(10, min_cor = -0.2, max_cor = 0.8, pos_def = TRUE)
</code></pre>

<hr>
<h2 id='sample_variogram'>Sample variogram</h2><span id='topic+sample_variogram'></span>

<h3>Description</h3>

<p>Creates a sample variogram. The x- and y-axes display the row and column displacements,
respectively. The z-axis displays the semi-variance (variogram ordinates).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_variogram(df, effect, min_np = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_variogram_+3A_df">df</code></td>
<td>
<p>A data frame containing the columns 'col', 'row', and the effect to be plotted.</p>
</td></tr>
<tr><td><code id="sample_variogram_+3A_effect">effect</code></td>
<td>
<p>The name of the effect to be plotted.</p>
</td></tr>
<tr><td><code id="sample_variogram_+3A_min_np">min_np</code></td>
<td>
<p>Only semi variances based on at least <code>min_np</code> pairs of plots will be
displayed. By default, <code>min_np = 30</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Graphic of the sample variogram, where the x- and y-axes display the row and
column displacements and the z-axis displays the semi-variance (variogram ordinates).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sample variogram of the simulated plot errors for trait 2 in environment 2 provided in the
# example data frame 'df_error_bivar'.

error_df &lt;- df_error_bivar[df_error_bivar$env == 2, ]

vario &lt;- sample_variogram(
  df = error_df,
  effect = "e.Trait.2",
)

# Sample variogram
vario

# Extraction of a data frame containing the column and row displacements as well as the
# semi-variances (sample variogram ordinates).

sample_df &lt;- vario$data

</code></pre>

<hr>
<h2 id='theoretical_variogram'>Theoretical variogram</h2><span id='topic+theoretical_variogram'></span>

<h3>Description</h3>

<p>Creates a theoretical variogram. The x- and y-axes display the row and column displacements,
respectively. The z-axis displays the semi-variance (variogram ordinates).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theoretical_variogram(
  n_cols,
  n_rows,
  var_R = 1,
  prop_spatial = 0.5,
  col_cor,
  row_cor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theoretical_variogram_+3A_n_cols">n_cols</code></td>
<td>
<p>A scalar defining the number of columns.</p>
</td></tr>
<tr><td><code id="theoretical_variogram_+3A_n_rows">n_rows</code></td>
<td>
<p>A scalar defining the number of rows.</p>
</td></tr>
<tr><td><code id="theoretical_variogram_+3A_var_r">var_R</code></td>
<td>
<p>A scalar defining the total error variance.</p>
</td></tr>
<tr><td><code id="theoretical_variogram_+3A_prop_spatial">prop_spatial</code></td>
<td>
<p>A scalar defining the proportion of spatial error variance to total error
variance (spatial + random).</p>
</td></tr>
<tr><td><code id="theoretical_variogram_+3A_col_cor">col_cor</code></td>
<td>
<p>A scalar defining the column autocorrelation value.</p>
</td></tr>
<tr><td><code id="theoretical_variogram_+3A_row_cor">row_cor</code></td>
<td>
<p>A scalar defining the row autocorrelation value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Graphic of the theoretical variogram, where the x- and y- axes display the row and
column displacements and the z-axis displays the semi-variance (variogram ordinates).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Theoretical variogram for a field with 10 columns and 20 rows, using column and row
# autocorrelations of 0.4 and 0.8.

vario &lt;- theoretical_variogram(
  n_cols = 10,
  n_rows = 20,
  var_R = 1,
  prop_spatial = 0.5,
  col_cor = 0.4,
  row_cor = 0.8
)

# Theoretical variogram
vario

# Extraction of a data frame containing the column and row displacements as well as the
# semi-variances (theoretical variogram ordinates).

theoretical_df &lt;- vario$data

</code></pre>

<hr>
<h2 id='unstr_asr_input'>Simulate genetic values based on an unstructured model for GxE interaction - 'AlphaSimR' input
parameters</h2><span id='topic+unstr_asr_input'></span>

<h3>Description</h3>

<p>Creates a list of input parameters for
<a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> to simulate
genetic values for multiple traits across multiple environments based on an unstructured model
for genotype-by-environment (GxE) interaction. <br />
By default, 'AlphaSimR' does not support complex models for GxE interaction. However, its
functionality to simulate correlated genetic values can be utilised for this purpose by
providing the required variance structures. <code>unstr_asr_input</code> is a wrapper function to
construct the variance structures required to simulate GxE interaction in 'AlphaSimR' based on
a multi-trait unstructured model. This function can handle separable and non-separable structures between traits and
environments (see below). After simulating the genetic values, the wrapper function
<a href="#topic+unstr_asr_output">unstr_asr_output</a> can be used to obtain a data frame with the relevant values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unstr_asr_input(
  n_envs = 3,
  n_traits = 2,
  mean = 0,
  var = 1,
  T_var = NULL,
  E_var = NULL,
  cor_A = NULL,
  T_cor_A = NULL,
  E_cor_A = NULL,
  mean_DD = NULL,
  var_DD = NULL,
  T_var_DD = NULL,
  E_var_DD = NULL,
  cor_DD = NULL,
  T_cor_DD = NULL,
  E_cor_DD = NULL,
  rel_AA = NULL,
  T_rel_AA = NULL,
  E_rel_AA = NULL,
  cor_AA = NULL,
  T_cor_AA = NULL,
  E_cor_AA = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unstr_asr_input_+3A_n_envs">n_envs</code></td>
<td>
<p>Number of environments to be simulated. A minimum of two environments is required.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_n_traits">n_traits</code></td>
<td>
<p>Number of traits to be simulated.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_mean">mean</code></td>
<td>
<p>A vector of mean genetic values for each environment-within-trait combination.
If only one value is specified, all environment-within-trait combinations will be assigned
the same mean.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_var">var</code></td>
<td>
<p>A vector of genetic variances for each environment-within-trait combination.
If only one value is specified, all environment-within-trait combinations will be assigned
the same mean. <br />
<strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>T_var</code> and <code>E_var</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_var">T_var</code></td>
<td>
<p>A vector of genetic variances for each trait. Must be provided in combination with
<code>E_var</code>. <br />
<strong>Alternatively</strong>, <code>var</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_var">E_var</code></td>
<td>
<p>A vector of genetic variances for each environment. Must be provided in
combination with <code>T_var</code>. <br />
<strong>Alternatively</strong>, <code>var</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_cor_a">cor_A</code></td>
<td>
<p>A matrix of additive genetic correlations between all environment-within-trait
combinations. By default, a diagonal matrix is constructed. <br />
<strong>Alternatively</strong>, <code>T_cor_A</code> and <code>E_cor_A</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_cor_a">T_cor_A</code></td>
<td>
<p>A matrix of additive genetic correlations between traits. Must be provided in
combination with <code>E_cor_A</code>. <br />
<strong>Alternatively</strong>, <code>cor_A</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_cor_a">E_cor_A</code></td>
<td>
<p>A matrix of additive genetic correlations between environments.
Must be provided in combination with <code>T_cor_A</code>. <br />
<strong>Alternatively</strong>, <code>cor_A</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_mean_dd">mean_DD</code></td>
<td>
<p>A vector of mean dominance degrees for each environment-within-trait combination
(similar to <code>mean</code>). If only one value is specified, all environment-within-trait
combinations will be assigned the same mean. By default, <code>mean_DD = NULL</code> and dominance
is not simulated.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_var_dd">var_DD</code></td>
<td>
<p>A vector of dominance degree variances for each environment-within-trait
combination (similar to <code>var</code>). If only one value is specified, all environment-within-trait
combinations will be assigned the same variance. <br />
<strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>T_var_DD</code> and <code>E_var_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_var_dd">T_var_DD</code></td>
<td>
<p>A vector of dominance degree variances for each trait (similar to <code>T_var</code>).
Must be provided in combination with <code>E_var_DD</code>. <br />
<strong>Alternatively</strong>, <code>var_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_var_dd">E_var_DD</code></td>
<td>
<p>A vector of dominance degree genetic variances for each environment (similar to
<code>E_var</code>). Must be provided in combination with <code>T_var_DD</code>. <br />
<strong>Alternatively</strong>, <code>var_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_cor_dd">cor_DD</code></td>
<td>
<p>A matrix of dominance degree correlations between all environment-within-trait
combinations (similar to <code>cor_A</code>). If not specified and dominance is simulated, a
diagonal matrix is constructed. <br />
<strong>Alternatively</strong>, <code>T_cor_DD</code> and <code>E_cor_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_cor_dd">T_cor_DD</code></td>
<td>
<p>A matrix of dominance degree correlations between traits (similar to
<code>T_cor_A</code>). Must be provided in combination with <code>E_cor_DD</code>. <br />
<strong>Alternatively</strong>, <code>cor_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_cor_dd">E_cor_DD</code></td>
<td>
<p>A matrix of dominance degree correlations between environments (similar to
<code>E_cor_A</code>). Must be provided in combination with <code>T_cor_DD</code>. <br />
<strong>Alternatively</strong>, <code>cor_DD</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_rel_aa">rel_AA</code></td>
<td>
<p>A vector defining the magnitude of additive-by-additive (epistatic) variance
relative to additive genetic variance for each environment-within-trait combination,
that is in a diploid organism with allele frequency 0.5. If only one value is specified,
all environment-within-trait combinations will be assigned the same value. By default,
<code>rel_AA = NULL</code> and epistasis is not simulated. <br />
<strong>Alternatively</strong>, if a separable structure between traits and environments is desired,
<code>T_rel_AA</code> and <code>E_rel_AA</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_rel_aa">T_rel_AA</code></td>
<td>
<p>A vector defining the magnitude of additive-by-additive (epistatic) variance
relative to the additive genetic variance for each trait. Must be provided in combination
with <code>E_rel_AA</code>. <br />
<strong>Alternatively</strong>, <code>rel_AA</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_rel_aa">E_rel_AA</code></td>
<td>
<p>A vector defining the magnitude of additive-by-additive (epistatic) variance
relative to the additive genetic variance for each environment. Must be provided in
combination with <code>T_rel_AA</code>. <br />
<strong>Alternatively</strong>, <code>rel_AA</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_cor_aa">cor_AA</code></td>
<td>
<p>A matrix of epistatic correlations between all environment-within-trait
combinations (similar to <code>cor_A</code>). If not specified and epistasis is simulated, a
diagonal matrix is constructed. <br />
<strong>Alternatively</strong>, <code>T_cor_AA</code> and <code>E_cor_AA</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_t_cor_aa">T_cor_AA</code></td>
<td>
<p>A matrix of epistatic correlations between traits (similar to <code>T_cor_A</code>).
Must be provided in combination with <code>E_cor_AA</code>. <br />
<strong>Alternatively</strong>, <code>cor_AA</code> can be specified.</p>
</td></tr>
<tr><td><code id="unstr_asr_input_+3A_e_cor_aa">E_cor_AA</code></td>
<td>
<p>A matrix of epistatic correlations between environments (similar to
<code>E_cor_A</code>). Must be provided in combination with <code>T_cor_AA</code>. <br />
<strong>Alternatively</strong>, <code>cor_AA</code> can be specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>unstr_asr_input</code> can handle separable and non-separable structures between traits and
environments.
</p>

<ul>
<li><p> For separable structures, provide (1) <code>T_var</code> &amp; <code>E_var</code>, and (2)
<code>T_cor_A</code> &amp; <code>E_cor_A</code>.
</p>
</li>
<li><p> For non-separable structures, provide (1) <code>var</code>, and (2) <code>cor_A</code>. <br />
</p>
</li></ul>

<p><strong>Note:</strong> 'AlphaSimR' can simulate different biological effects (see:
<a href="https://gaynorr.github.io/AlphaSimR/reference/SimParam.html">SimParam</a>).
</p>

<ul>
<li><p> For additive traits use <code>addTraitA()</code>.
</p>
</li>
<li><p> For additive + dominance traits use <code>addTraitAD()</code>.
</p>
</li>
<li><p> For additive + epistatic traits use <code>addTraitAE()</code>.
</p>
</li>
<li><p> For additive + dominance + epistatic traits use <code>addTraitADE()</code>.
</p>
</li></ul>

<p>If non-additive effects are to be simulated, check the <code>useVarA</code> argument of these
functions.
</p>


<h3>Value</h3>

<p>A list containing input parameters for 'AlphaSimR', which is used to simulate
correlated genetic effects based on an unstructured model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate genetic values in 'AlphaSimR' for two additive + dominance traits across
# two environments based on an unstructured model for GxE interaction.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
mean_DD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same values in the two environments.

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.085, 0.12, 15.1, 8.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
var_DD &lt;- rep(0.2, 4) # The same value set for traits 1 and 2.

# Additive genetic correlations between the two simulated traits.
T_cor_A &lt;- matrix(
  c(
    1.0, 0.6,
    0.6, 1.0
  ),
  ncol = 2
)

# Additive genetic correlations between the two simulated environments.
E_cor_A &lt;- matrix(
  c(
    1.0, 0.2,
    0.2, 1.0
  ),
  ncol = 2
)

# Dominance degree correlations between the four environment-within-trait combinations.
cor_DD &lt;- diag(4) # Assuming independence between traits

input_asr &lt;- unstr_asr_input(
  n_envs = 2,
  n_traits = 2,
  mean = mean,
  var = var,
  T_cor_A = T_cor_A,
  E_cor_A = E_cor_A,
  mean_DD = mean_DD,
  var_DD = var_DD,
  cor_DD = cor_DD
)
</code></pre>

<hr>
<h2 id='unstr_asr_output'>Simulate genetic values based on an unstructured model for GxE interaction -
Simulation using 'AlphaSimR'</h2><span id='topic+unstr_asr_output'></span>

<h3>Description</h3>

<p>Creates a data frame of simulated genetic values for multiple traits across multiple environments
based on an unstructured model for genotype-by-environment (GxE) interaction. This function
requires an <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> population object
generated using the <a href="#topic+unstr_asr_input">unstr_asr_input</a> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unstr_asr_output(pop, n_envs, n_traits, n_reps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unstr_asr_output_+3A_pop">pop</code></td>
<td>
<p>An <a href="https://CRAN.R-project.org/package=AlphaSimR">'AlphaSimR'</a> population object
(<a href="https://gaynorr.github.io/AlphaSimR/reference/Pop-class.html">Pop-class</a> or
<a href="https://gaynorr.github.io/AlphaSimR/reference/HybridPop-class.html">HybridPop-class</a>)
generated using <a href="#topic+unstr_asr_input">unstr_asr_input</a>.</p>
</td></tr>
<tr><td><code id="unstr_asr_output_+3A_n_envs">n_envs</code></td>
<td>
<p>Number of simulated environments (same number used in <a href="#topic+unstr_asr_input">unstr_asr_input</a>).</p>
</td></tr>
<tr><td><code id="unstr_asr_output_+3A_n_traits">n_traits</code></td>
<td>
<p>Number of simulated traits (same number used in <a href="#topic+unstr_asr_input">unstr_asr_input</a>).</p>
</td></tr>
<tr><td><code id="unstr_asr_output_+3A_n_reps">n_reps</code></td>
<td>
<p>A vector defining the number of replicates in each environment. If only one value
is specified, all environments will be assigned the same number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns 'env', 'rep', genotype 'id', and the
simulated genetic values for each trait.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate genetic values in 'AlphaSimR' for two additive + dominance traits across
# two environments based on an unstructured model for GxE interaction.

# 1. Define the genetic architecture of the simulated traits.
# Mean genetic values and mean dominance degrees.
mean &lt;- c(4.9, 5.4, 235.2, 228.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
mean_DD &lt;- c(0.4, 0.4, 0.1, 0.1) # Trait 1 and 2, same values in the two environments.

# Additive genetic variances and dominance degree variances.
var &lt;- c(0.085, 0.12, 15.1, 8.5) # Trait 1 x 2 environments, trait 2 x 2 environments.
var_DD &lt;- rep(0.2, 4) # The same value set for traits 1 and 2.

# Additive genetic correlations between the two simulated traits.
T_cor_A &lt;- matrix(
  c(
    1.0, 0.6,
    0.6, 1.0
  ),
  ncol = 2
)

# Additive genetic correlations between the two simulated environments.
E_cor_A &lt;- matrix(
  c(
    1.0, 0.2,
    0.2, 1.0
  ),
  ncol = 2
)

# Dominance degree correlations between the four environment-within-trait combinations.
cor_DD &lt;- diag(4) # Assuming independence between traits

input_asr &lt;- unstr_asr_input(
  n_envs = 2,
  n_traits = 2,
  mean = mean,
  var = var,
  T_cor_A = T_cor_A,
  E_cor_A = E_cor_A,
  mean_DD = mean_DD,
  var_DD = var_DD,
  cor_DD = cor_DD
)


# 2. Use input_asr to simulate genetic values in 'AlphaSimR' based on an unstructured model for
# GxE interaction.

library("AlphaSimR")
FOUNDERPOP &lt;- quickHaplo(
  nInd = 10,
  nChr = 1,
  segSites = 20
)

SP &lt;- SimParam$new(FOUNDERPOP)



SP$addTraitAD(
  nQtlPerChr = 20,
  mean = input_asr$mean,
  var = input_asr$var,
  meanDD = input_asr$mean_DD,
  varDD = input_asr$var_DD,
  corA = input_asr$cor_A,
  corDD = input_asr$cor_DD,
  useVarA = TRUE
)

# By default, the value provided in 'var' represents the additive variance.
# If useVarA = FALSE, 'var' represents the total genetic variance.

pop &lt;- newPop(FOUNDERPOP)


# 3. Create a data frame containing the simulated genetic values for the two traits across the
# two environments.

n_reps &lt;- c(2, 2) # Vector containing the number of complete replicates in each environment.

gv_df &lt;- unstr_asr_output(
  pop = pop,
  n_envs = 2,
  n_traits = 2,
  n_reps = n_reps
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
