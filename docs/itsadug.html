<!DOCTYPE html><html><head><title>Help for package itsadug</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {itsadug}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acf_n_plots'><p>Generate N ACF plots of individual or aggregated time series.</p></a></li>
<li><a href='#acf_plot'><p>Generate an ACF plot of an aggregated time series.</p></a></li>
<li><a href='#acf_resid'><p>Generate an ACF plot of model residuals. Works for lm, lmer, gam, bam, ....</p></a></li>
<li><a href='#check_resid'><p>Inspect residuals of regression models.</p></a></li>
<li><a href='#compareML'><p>Function for comparing two GAMM models.</p></a></li>
<li><a href='#convertNonAlphanumeric'><p>Prepare string for regular expressions</p>
(backslash for all non-letter and non-digit characters)</a></li>
<li><a href='#corfit'><p>Calculate the correlation between the fitted model and data.</p></a></li>
<li><a href='#derive_timeseries'><p>Derive the time series used in the AR1 model.</p></a></li>
<li><a href='#diagnostics'><p>Visualization of the model fit for time series data.</p></a></li>
<li><a href='#diff_terms'><p>Compare the formulas of two models and return the difference(s).</p></a></li>
<li><a href='#dispersion'><p>Calculate the dispersion of the residuals</p></a></li>
<li><a href='#eeg'><p>Raw EEG data, single trial, 50Hz.</p></a></li>
<li><a href='#fadeRug'><p>Fade out the areas in a surface without data.</p></a></li>
<li><a href='#find_difference'><p>Return the regions in which the smooth is significantly different from zero.</p></a></li>
<li><a href='#fvisgam'><p>Visualization of nonlinear interactions, summed effects.</p></a></li>
<li><a href='#gamtabs'><p>Convert model summary into Latex/HTML table for knitr/R Markdown reports.</p></a></li>
<li><a href='#get_coefs'><p>Get coefficients for the parametric terms (intercepts and random slopes).</p></a></li>
<li><a href='#get_difference'><p>Get model predictions for differences between conditions.</p></a></li>
<li><a href='#get_fitted'><p>Get model all fitted values.</p></a></li>
<li><a href='#get_modelterm'><p>Get estimated for selected model terms.</p></a></li>
<li><a href='#get_pca_predictions'><p>Return PCA predictions.</p></a></li>
<li><a href='#get_predictions'><p>Get model predictions for specific conditions.</p></a></li>
<li><a href='#get_random'><p>Get coefficients for the random intercepts and random slopes.</p></a></li>
<li><a href='#info'><p>Information on how to cite this package</p></a></li>
<li><a href='#infoMessages'><p>Turn on or off information messages.</p></a></li>
<li><a href='#inspect_random'><p>Inspection and interpretation of random factor smooths.</p></a></li>
<li><a href='#itsadug'><p>Interpreting Time Series, Autocorrelated Data Using GAMMs (itsadug)</p></a></li>
<li><a href='#missing_est'><p>Return indices of data that were not fitted by the model.</p></a></li>
<li><a href='#modeledf'><p>Retrieve the degrees of freedom specified in the model.</p></a></li>
<li><a href='#observations'><p>Number of observations in the model.</p></a></li>
<li><a href='#plot_data'><p>Visualization of the model fit for time series data.</p></a></li>
<li><a href='#plot_diff'><p>Plot difference curve based on model predictions.</p></a></li>
<li><a href='#plot_diff2'><p>Plot difference surface based on model predictions.</p></a></li>
<li><a href='#plot_modelfit'><p>Visualization of the model fit for time series data.</p></a></li>
<li><a href='#plot_parametric'><p>Visualization of group estimates.</p></a></li>
<li><a href='#plot_pca_surface'><p>Visualization of the effect predictors in nonlinear interactions with</p>
principled components.</a></li>
<li><a href='#plot_smooth'><p>Visualization of smooths.</p></a></li>
<li><a href='#plot_topo'><p>Visualization of EEG topo maps.</p></a></li>
<li><a href='#print_summary'><p>Print a named list of strings, output from <code>summary_data</code>.</p></a></li>
<li><a href='#pvisgam'><p>Visualization of partial nonlinear interactions.</p></a></li>
<li><a href='#refLevels'><p>Return a list with reference levels for each factor.</p></a></li>
<li><a href='#report_stats'><p>Returns a description of the statistics of the smooth terms for reporting.</p></a></li>
<li><a href='#res_df'><p>Retrieve the residual degrees of freedom from the model.</p></a></li>
<li><a href='#resid_gam'><p>Extract model residuals and remove the autocorrelation accounted for.</p></a></li>
<li><a href='#rug_model'><p>Add rug to plot, based on model.</p></a></li>
<li><a href='#simdat'><p>Simulated time series data.</p></a></li>
<li><a href='#start_event'><p>Determine the starting point for each time series.</p></a></li>
<li><a href='#start_value_rho'><p>Extract the Lag 1 value from the ACF of the residuals of a gam, bam, lm,</p>
lmer model, ...</a></li>
<li><a href='#summary_data'><p>Print a descriptive summary of a data frame.</p></a></li>
<li><a href='#timeBins'><p>Label timestamps as timebins of a given binsize.</p></a></li>
<li><a href='#wald_gam'><p>Function for post-hoc comparison of the contrasts in a single GAMM model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-17</td>
</tr>
<tr>
<td>Title:</td>
<td>Interpreting Time Series and Autocorrelated Data Using GAMMs</td>
</tr>
<tr>
<td>Author:</td>
<td>Jacolien van Rij [aut, cre],
  Martijn Wieling [aut],
  R. Harald Baayen [aut],
  Hedderik van Rijn [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jacolien van Rij &lt;vanrij.jacolien@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>GAMM (Generalized Additive Mixed Modeling; Lin &amp; Zhang, 1999)
    as implemented in the R package 'mgcv' (Wood, S.N., 2006; 2011) is a nonlinear
    regression analysis which is particularly useful for time course data such as
    EEG, pupil dilation, gaze data (eye tracking), and articulography recordings,
    but also for behavioral data such as reaction times and response data. As time
    course measures are sensitive to autocorrelation problems, GAMMs implements
    methods to reduce the autocorrelation problems. This package includes functions
    for the evaluation of GAMM models (e.g., model comparisons, determining regions
    of significance, inspection of autocorrelational structure in residuals)
    and interpreting of GAMMs (e.g., visualization of complex interactions, and
    contrasts).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), mgcv (&ge; 1.8), plotfunctions (&ge; 1.4)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, xtable, sp, data.table</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-17 14:55:33 UTC; jacolien</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-17 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='acf_n_plots'>Generate N ACF plots of individual or aggregated time series.</h2><span id='topic+acf_n_plots'></span>

<h3>Description</h3>

<p>Generate N ACF plots of individual or aggregated time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf_n_plots(
  x,
  n = 5,
  split_by = NULL,
  cond = NULL,
  max_lag = NULL,
  fun = mean,
  plot = TRUE,
  random = F,
  mfrow = NULL,
  add = FALSE,
  print.summary = getOption("itsadug_print"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf_n_plots_+3A_x">x</code></td>
<td>
<p>A vector with time series data, typically residuals of a 
regression model.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_n">n</code></td>
<td>
<p>The number of plots to generate.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_split_by">split_by</code></td>
<td>
<p>List of vectors (each with equal length as <code>x</code>) that 
group the values of <code>x</code> into trials or timeseries events. 
Generally other columns from the same data frame.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_cond">cond</code></td>
<td>
<p>Named list with a selection of the time series events
specified in <code>split_by</code>. Default is NULL, indicating that 
all time series are being processed, rather than a selection.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_max_lag">max_lag</code></td>
<td>
<p>Maximum lag at which to calculate the acf. 
Default is the maximum for the longest time series.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_fun">fun</code></td>
<td>
<p>The function used when aggregating over time series 
(depending on the value of <code>split_by</code>).</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to produce plot. Default is TRUE.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_random">random</code></td>
<td>
<p>Logical: determine randomly which <code>n</code> (aggregated) time 
series are plotted, or use the <code><a href="stats.html#topic+quantile">quantile</a></code> function to find a 
range of different time series to plot. Default is FALSE (not random).</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_mfrow">mfrow</code></td>
<td>
<p>A vector of the form c(nr, nc). The figures will be drawn in 
an nr-by-nc array on the device by rows.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_add">add</code></td>
<td>
<p>Logical: whether to add the plots to an exiting plot window or 
not. 
Default is FALSE.</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="acf_n_plots_+3A_...">...</code></td>
<td>
<p>Other arguments for plotting, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>n</code> ACF plots providing information about the autocorrelation 
in <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij, R. Harald Baayen
</p>


<h3>See Also</h3>

<p>Use <code><a href="stats.html#topic+acf">acf</a></code> for the original ACF function, 
and <code><a href="#topic+acf_plot">acf_plot</a></code> for an ACF that takes into account time series 
in the data.
</p>
<p>Other functions for model criticism: 
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Separate ACF for each time series:
acf_n_plots(simdat$Y, split_by=list(simdat$Subject, simdat$Trial))

# Average ACF per participant:
acf_n_plots(simdat$Y, split_by=list(simdat$Subject))

## Not run: 
# Data treated as single time series. Plot is added to current window.
# Note: 1 time series results in 1 plot.
acf_n_plots(simdat$Y, add=TRUE)
# Plot 4 ACF plots doesn't work without splitting data:
acf_n_plots(simdat$Y, add=TRUE, n=4)

# Plot ACFs of 4 randomly selected time series:
acf_n_plots(simdat$Y, random=TRUE, n=4, add=TRUE, 
    split_by=list(simdat$Subject, simdat$Trial))


## End(Not run)

#---------------------------------------------
# When using model residuals
#---------------------------------------------

## Not run: 
# add missing values to simdat:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA
# simple linear model:
m1 &lt;- lm(Y ~ Time, data=simdat)

# This will generate an error:
# acf_n_plots(resid(m1), split_by=list(simdat$Subject, simdat$Trial))

# This should work:
el.na &lt;- missing_est(m1)
acf_n_plots(resid(m1), 
     split_by=list(simdat[-el.na,]$Subject, simdat[-el.na,]$Trial))

# This should also work:
simdat$res &lt;- NA
simdat[!is.na(simdat$Y),]$res &lt;- resid(m1)
acf_n_plots(simdat$res, split_by=list(simdat$Subject, simdat$Trial))

## End(Not run)

# see the vignette for examples:
vignette('acf', package='itsadug')
</code></pre>

<hr>
<h2 id='acf_plot'>Generate an ACF plot of an aggregated time series.</h2><span id='topic+acf_plot'></span>

<h3>Description</h3>

<p>Generate an ACF plot of an aggregated time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf_plot(
  x,
  split_by = NULL,
  max_lag = NULL,
  plot = TRUE,
  fun = mean,
  cond = NULL,
  return_all = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf_plot_+3A_x">x</code></td>
<td>
<p>A vector with time series data, typically residuals of a 
regression model. 
(See examples for how to avoid errors due to missing values.)</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_split_by">split_by</code></td>
<td>
<p>List of vectors (each with equal length as <code>x</code>) that 
group the values of <code>x</code> into trials or timeseries events. 
Generally other columns from the same data frame.</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_max_lag">max_lag</code></td>
<td>
<p>Maximum lag at which to calculate the acf. 
Default is the maximum for the longest time series.</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to plot the ACF. Default is TRUE.</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_fun">fun</code></td>
<td>
<p>The function used when aggregating over time series 
(depending on the value of <code>split_by</code>).</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_cond">cond</code></td>
<td>
<p>Named list with a selection of the time series events
specified in <code>split_by</code>. Default is NULL, indicating that 
all time series are being processed, rather than a selection.</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_return_all">return_all</code></td>
<td>
<p>Returning acfs for all time series.</p>
</td></tr>
<tr><td><code id="acf_plot_+3A_...">...</code></td>
<td>
<p>Other arguments for plotting, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An aggregated ACF plot and / or optionally a list with the aggregated ACF values.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Use <code><a href="stats.html#topic+acf">acf</a></code> for the original ACF function, 
and <code><a href="#topic+acf_n_plots">acf_n_plots</a></code> for inspection of individual time series.
</p>
<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Default acf function:
acf(simdat$Y)
# Same plot with acf_plot:
acf_plot(simdat$Y)
# Average of ACFs per time series:
acf_plot(simdat$Y, split_by=list(simdat$Subject, simdat$Trial))
# Median of ACFs per time series:
acf_plot(simdat$Y, split_by=list(simdat$Subject, simdat$Trial), fun=median)

# extract value of Lag1:
lag1 &lt;- acf_plot(simdat$Y, 
   split_by=list(Subject=simdat$Subject, Trial=simdat$Trial), 
   plot=FALSE)['1']

#---------------------------------------------
# When using model residuals
#---------------------------------------------

# add missing values to simdat:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA
# simple linear model:
m1 &lt;- lm(Y ~ Time, data=simdat)

## Not run: 
# This will generate an error:
acf_plot(resid(m1), split_by=list(simdat$Subject, simdat$Trial))

## End(Not run)
# This should work:
el.na &lt;- missing_est(m1)
acf_plot(resid(m1), 
     split_by=list(simdat[-el.na,]$Subject, simdat[-el.na,]$Trial))

# This should also work:
simdat$res &lt;- NA
simdat[!is.na(simdat$Y),]$res &lt;- resid(m1)
acf_plot(simdat$res, split_by=list(simdat$Subject, simdat$Trial))

# see the vignette for examples:
vignette('acf', package='itsadug')

</code></pre>

<hr>
<h2 id='acf_resid'>Generate an ACF plot of model residuals. Works for lm, lmer, gam, bam, ....</h2><span id='topic+acf_resid'></span>

<h3>Description</h3>

<p>Wrapper around <code><a href="#topic+acf_plot">acf_plot</a></code> and 
<code><a href="#topic+acf_n_plots">acf_n_plots</a></code> for regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf_resid(
  model,
  split_pred = NULL,
  n = 1,
  plot = TRUE,
  check.rho = NULL,
  main = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf_resid_+3A_model">model</code></td>
<td>
<p>A regression model generated by <code>lm</code>, <code>glm</code>,
<code>lmer</code>, <code>glmer</code>, <code><a href="mgcv.html#topic+gam">gam</a></code>, 
or <code><a href="mgcv.html#topic+bam">bam</a></code>.
(See examples for how to avoid errors due to missing values.)</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_split_pred">split_pred</code></td>
<td>
<p>Vector with names of model predictors that determine
the time series in the data, or should be used to split the ACF plot by.
Alternatively, <code>split_pred</code> can be a named list as being used by 
<code><a href="#topic+acf_plot">acf_plot</a></code> and <code><a href="#topic+acf_n_plots">acf_n_plots</a></code>.
Yet another option is to provide the text string 'AR.start', for a model 
that includes an AR1 model. The events are derived from the AR.start column 
if that is provided.</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_n">n</code></td>
<td>
<p>The number of plots to generate. If <code>n</code>=1 (default) then 
<code><a href="#topic+acf_plot">acf_plot</a></code> is being called. If <code>n</code>&gt;1 then 
<code><a href="#topic+acf_n_plots">acf_n_plots</a></code> is being called.</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to produce plot. Default is TRUE.</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_check.rho">check.rho</code></td>
<td>
<p>Numeric value: Generally leave at NULL. This value does 
not change anything, but it is used to check whether the model's AR1 
coefficient matches the expected value of rho.</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_main">main</code></td>
<td>
<p>Text string, title of plot.</p>
</td></tr>
<tr><td><code id="acf_resid_+3A_...">...</code></td>
<td>
<p>Other arguments as input for <code><a href="#topic+acf_plot">acf_plot</a></code> 
or <code><a href="#topic+acf_n_plots">acf_n_plots</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An aggregated ACF plot and / or optionally a list with the aggregated ACF values.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Use <code><a href="stats.html#topic+acf">acf</a></code> for the original ACF function, 
and <code><a href="#topic+acf_plot">acf_plot</a></code>, or <code><a href="#topic+acf_n_plots">acf_n_plots</a></code>.
</p>
<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# add missing values to simdat:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA

## Not run: 
# Run GAMM model:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Subject, bs='re'), data=simdat)

# Using a list to split the data:
acf_resid(m1, split_pred=list(simdat$Subject, simdat$Trial))
# ...or using model predictors:
acf_resid(m1, split_pred=c('Subject', 'Trial'))

# Calling acf_n_plots:
acf_resid(m1, split_pred=c('Subject', 'Trial'), n=4)
# add some arguments:
acf_resid(m1, split_pred=c('Subject', 'Trial'), n=4, max_lag=10)

# This does not work...
m2 &lt;- lm(Y ~ Time, data=simdat)
acf_resid(m2, split_pred=c('Subject', 'Trial'))
# ... but this is ok:
acf_resid(m2, split_pred=list(simdat$Subject, simdat$Trial))

# Using AR.start column:
simdat &lt;- start_event(simdat, event=c('Subject', 'Trial'))
r1 &lt;- start_value_rho(m1)
m3 &lt;- bam(Y ~ te(Time, Trial)+s(Subject, bs='re'), data=simdat, 
    rho=r1, AR.start=simdat$start.event)
acf_resid(m3, split_pred='AR.start')
# this is the same:
acf_resid(m3, split_pred=c('Subject', 'Trial'))
# Note: use model comparison to find better value for rho

## End(Not run)
# see the vignette for examples:
vignette('acf', package='itsadug')
</code></pre>

<hr>
<h2 id='check_resid'>Inspect residuals of regression models.</h2><span id='topic+check_resid'></span>

<h3>Description</h3>

<p>Inspect residuals of regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_resid(
  model,
  AR_start = NULL,
  split_pred = NULL,
  ask = TRUE,
  select = 1:4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_resid_+3A_model">model</code></td>
<td>
<p>A regression model, resulting from the functions
<code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+bam">bam</a></code>, or <code>lm</code>,
<code>glm</code>, <code>lmer</code>, or <code>glmer</code>.</p>
</td></tr>
<tr><td><code id="check_resid_+3A_ar_start">AR_start</code></td>
<td>
<p>Defaults to NULL. 
Only use this when the model was run in an old versions of package 
<code>mgcv</code> and the function cannot retrieve the used AR.start values from 
the <code>model</code>. When an error is shown with newer versions of 
<code>mgcv</code>, please check the column provided as values of AR.start.
when using old versions of package <code>mgcv</code>.
Function will give error when it cannot find AR.start.</p>
</td></tr>
<tr><td><code id="check_resid_+3A_split_pred">split_pred</code></td>
<td>
<p>A names list indicating time series in the data.</p>
</td></tr>
<tr><td><code id="check_resid_+3A_ask">ask</code></td>
<td>
<p>Logical: whether or not to show the plots one by one. 
Defaults to TRUE. When set to FALSE, make sure to have specified 
sufficient rows and columns to show the X plots. Alternatively, 
use <code>select</code> to plot only specific plots.</p>
</td></tr>
<tr><td><code id="check_resid_+3A_select">select</code></td>
<td>
<p>Vector or numeric value indicating which plots to return 
(see Notes). Defaults to 1:4 (all).</p>
</td></tr>
</table>


<h3>Note</h3>


<ul>
<li><p> Plot 1: distribution of residuals with QQ norm plot.
</p>
</li>
<li><p> Plot 2: distribution of residuals with density plot.
</p>
</li>
<li><p> Plot 3: ACF plot of residuals. In case an AR1 model is included, 
the gray lines indicate standard residuals, and the thick black lines 
indicate AR1 corrected residuals. 
</p>
</li>
<li><p> Plot 4 (optional): In case the <code>split_pred</code> predictors are 
specified an ACF plot averaged over the time series is produced. dashed 
lines indicate the maximum and minimum time series (w.r.t. lag 2), the 
solid lines the 25
mean of all time series.
</p>
</li></ul>

<p>See the examples on how to specify a selection of these plots.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model evaluation: 
<code><a href="#topic+diagnostics">diagnostics</a>()</code>,
<code><a href="#topic+plot_modelfit">plot_modelfit</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Add start event column:
simdat &lt;- start_event(simdat, event=c('Subject', 'Trial'))
head(simdat)

# bam model with AR1 model (toy example, not serious model):
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), 
   data=simdat, rho=.5, AR.start=simdat$start.event)

# Warning, no time series specified:
check_resid(m1)

# Time series specified, results in a 'standard' ACF plot, 
# treating all residuals as single time seriesand,
# and an ACF plot with the average ACF over time series:
check_resid(m1, split_pred=list(Subject=simdat$Subject, Trial=simdat$Trial))
# Note: residuals do not look very good.
# Alternative (results in the same, see help(acf_resid) ):
check_resid(m1, split_pred='AR.start')

# Define larger plot window (choose which line you need):
dev.new(width=8, height=8) # on windows or mac
quartz(,8,8)               # on mac
x11(width=8, height=8)     # on linux or mac

par(mfrow=c(2,2), cex=1.1)
check_resid(m1, split_pred='AR.start', ask=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='compareML'>Function for comparing two GAMM models.</h2><span id='topic+compareML'></span>

<h3>Description</h3>

<p>Function for comparing two GAMM models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareML(
  model1,
  model2,
  signif.stars = TRUE,
  suggest.report = FALSE,
  print.output = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareML_+3A_model1">model1</code></td>
<td>
<p>First model.</p>
</td></tr>
<tr><td><code id="compareML_+3A_model2">model2</code></td>
<td>
<p>Second model.</p>
</td></tr>
<tr><td><code id="compareML_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Logical (default = TRUE). Whether or not to display 
stars indicating the level of significance on 95% confidence level.</p>
</td></tr>
<tr><td><code id="compareML_+3A_suggest.report">suggest.report</code></td>
<td>
<p>Logical (default = FALSE). Whether or not to 
present a suggestion on how one could report the information. If 
<code>print.output</code> is set to FALSE, <code>suggest.report</code> will 
set to FALSE too. Please inspect yourself whether the label between 
square bracket fits your own standards. Note: the <code>X2</code> should be 
replaced by a proper Chi-Square symbol <code class="reqn">\chi^2</code>.</p>
</td></tr>
<tr><td><code id="compareML_+3A_print.output">print.output</code></td>
<td>
<p>Logical: whether or not to print the output. 
By default set to true, even if the the messages are not allowed by 
a global package option using the function <code><a href="#topic+infoMessages">infoMessages</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As an Chi-Square test is performed on two times the difference in 
minimized smoothing parameter selection score (GCV, fREML, REML, ML), 
and the difference in degrees of freedom specified in the model. 
The degrees of freedom of the model terms are the sum of
1) the number of estimated smoothing parameters for the model, 
2) number of parametric (non-smooth) model terms including the intercept, 
and 3) the sum of the penalty null space dimensions of each smooth object.
</p>
<p>This method is preferred over other functions such as <code><a href="stats.html#topic+AIC">AIC</a></code> for 
models that include an AR1 model or random effects (especially nonlinear 
random smooths using <code>bs='fs'</code>). CompareML also reports the AIC 
difference, but that value should be treated with care.
</p>
<p>Note that the Chi-Square test will result in a very low p-value
when the difference in degrees of freedom approaches zero. Use common sense 
to determine if the difference between the two models is meaningful. 
A warning is presented when the difference in score is smaller 
than 5.
</p>
<p>The order of the two models is not important.
Model comparison is only implemented for the methods GCV, fREML, REML, and ML.
</p>


<h3>Value</h3>

<p>Optionally returns the Chi-Square test table.
</p>


<h3>Notes</h3>

<p>For suppressing the output and all warnings, set infoMessages to FALSE 
(<code>infoMessages('off')</code> ), set the argument <code>print.output</code> to FALSE,
and use the function 
<code><a href="base.html#topic+suppressWarnings">suppressWarnings</a></code> to suppress warning messages.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij. With many thanks to Simon N. Wood for his feedback.
</p>


<h3>See Also</h3>

<p>For models without AR1 model or random effects <code><a href="stats.html#topic+AIC">AIC</a></code> can be used.
</p>
<p>Other Testing for significance: 
<code><a href="#topic+plot_diff2">plot_diff2</a>()</code>,
<code><a href="#topic+plot_diff">plot_diff</a>()</code>,
<code><a href="#topic+report_stats">report_stats</a>()</code>,
<code><a href="#topic+wald_gam">wald_gam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
infoMessages('on')
# some arbitrary models:
m1 &lt;- bam(Y~Group + s(Time, by=Group), method='fREML', data=simdat)
m2 &lt;- bam(Y~Group + s(Time), method='fREML', data=simdat)

compareML(m1, m2)

# exclude significance stars:
compareML(m1, m2, signif.stars=FALSE)

m3 &lt;- bam(Y~Group + s(Time, by=Group, k=25), method='fREML', 
    data=simdat)
compareML(m1, m3)

# do not print output, but save table for later use:
cml &lt;- compareML(m1, m2, print.output=FALSE)$table
cml

# Use suppressWarnings to also suppress warnings:
suppressWarnings(cml &lt;- compareML(m1, m2, print.output=FALSE)$table)


## End(Not run)
</code></pre>

<hr>
<h2 id='convertNonAlphanumeric'>Prepare string for regular expressions 
(backslash for all non-letter and non-digit characters)</h2><span id='topic+convertNonAlphanumeric'></span>

<h3>Description</h3>

<p>Prepare string for regular expressions 
(backslash for all non-letter and non-digit characters)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertNonAlphanumeric(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertNonAlphanumeric_+3A_text">text</code></td>
<td>
<p>A text string (smooth term label) that needs to be converted 
to a regular expression.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A regular expression string.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
# Model for illustrating coefficients:
m0 &lt;- bam(Y ~ s(Time) + s(Subject, bs='re') 
+ s(Time, Subject, bs='re'), data=simdat)

# get all coefficients:
coef(m0)
# to get only the Subject intercepts:
coef(m0)[grepl(convertNonAlphanumeric('s(Subject)'), names(coef(m0)))]
# to get only the Subject slopes:
coef(m0)[grepl(convertNonAlphanumeric('s(Time,Subject)'), names(coef(m0)))]

</code></pre>

<hr>
<h2 id='corfit'>Calculate the correlation between the fitted model and data.</h2><span id='topic+corfit'></span>

<h3>Description</h3>

<p>Calculate the correlation between the fitted model and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corfit(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corfit_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value: correlation between fitted model and data.
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Fit simple GAM model:
gam1 &lt;- bam(Y ~ s(Time), data=simdat, discrete=TRUE)
corfit(gam1)

</code></pre>

<hr>
<h2 id='derive_timeseries'>Derive the time series used in the AR1 model.</h2><span id='topic+derive_timeseries'></span>

<h3>Description</h3>

<p>Derive the time series used in the AR1 model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derive_timeseries(model, AR.start = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derive_timeseries_+3A_model">model</code></td>
<td>
<p>GAMM model that includes an AR1 model.</p>
</td></tr>
<tr><td><code id="derive_timeseries_+3A_ar.start">AR.start</code></td>
<td>
<p>Vector with AR.start information, 
necessary for the AR1 model. Optional, defaults to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with time series indication based on the AR1 model.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# add missing values to simdat:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA
simdat &lt;- start_event(simdat, event=c('Subject', 'Trial'))

## Not run: 
# Run GAMM model:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Subject, bs='re'), data=simdat, 
    rho=.5, AR.start=simdat$start.event)
simdat$Event &lt;- NA
simdat[!is.na(simdat$Y),]$Event &lt;- derive_timeseries(m1)
acf_resid(m1, split_pred=list(Event=simdat$Event))

# And this works too:
simdat$Event &lt;- derive_timeseries(simdat$start.event)
acf_resid(m1, split_pred=list(Event=simdat$Event))

# Note that acf_resid automatically makes use of derive_timeseries:
acf_resid(m1, split_pred='AR.start')

## End(Not run)
</code></pre>

<hr>
<h2 id='diagnostics'>Visualization of the model fit for time series data.</h2><span id='topic+diagnostics'></span>

<h3>Description</h3>

<p>Diagnostic plots for evaluating the model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostics(
  model,
  plot = "all",
  ask = TRUE,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostics_+3A_model">model</code></td>
<td>
<p>A lm or gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_plot">plot</code></td>
<td>
<p>A text string or numeric vector indicating which diagnostic 
plots to show. Default is 'all'. See Section 'Details' for the different 
options.</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_ask">ask</code></td>
<td>
<p>Logical: whether the user is prompted before starting a new 
page of output. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="diagnostics_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>plot='all'</code>, the following plots are generated:
</p>

<ol>
<li><p> Residuals by fitted values. Used for inspection of general trends 
in the residuals.
</p>
</li>
<li><p> Residuals ordered by predictor. Useful for checking how the trends 
of individual predictors are captured by the model.
</p>
</li>
<li><p> Distribution of residuals. QQ plot that compares the distribution 
of the residuals with the normal distribution. 
</p>
</li>
<li><p> ACF of residuals. Inspection of autocorrelation in the residuals. 
See also <code><a href="#topic+acf_resid">acf_resid</a></code>.
</p>
</li>
<li><p> Trends in the random smooths. Be careful with the interpretation of 
the 'fixed' effects and interactions when the random smooths show trends. 
See examples below.
</p>
</li>
<li><p> Printing distributions of numeric predictors.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model evaluation: 
<code><a href="#topic+check_resid">check_resid</a>()</code>,
<code><a href="#topic+plot_modelfit">plot_modelfit</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(simdat)
## Not run: 
# no random smooths:
m1 &lt;- bam(Y ~ Group + s(Time, by=Group) + s(Trial) + s(Subject, bs='re'), data=simdat)
diagnostics(m1)

# only plot residuals by predictor:
diagnostics(m1, plot=2)

# without prompts:
par(mfrow=c(2,2))
diagnostics(m1, plot=1:4, ask=FALSE)

# only plot random smooths:
diagnostics(m1, plot=5)
# Note: the plot does not change,
# because there are no random smooths to plot.

# with random smooths
m2 &lt;- bam(Y ~ Group + s(Time, by=Group) + s(Time, Subject, bs='fs', m=1), data=simdat)  
diagnostics(m2)  

## INSPECTION OF RANDOM SMOOTHS 
## ----------------------------

# In this underspecified model (too much smoothing for the interaction)
# part of the effect of Time is captured by the random smooths:
m3 &lt;- bam(Y ~ te(Time, Trial, k=c(3,3)) + s(Time, Subject, bs='fs', m=1), data=simdat) 

# The plot shows a clear trend in the average of the random smooths, 
# and the amplitude of the mean (!) curve is almost as large as the 
# amplitude of the 'fixed' effect of Time:
diagnostics(m3, plot=5, ask=FALSE)

# Compare with the following models:
m4 &lt;- bam(Y ~ te(Time, Trial, k=c(10,5)) + s(Time, Subject, bs='fs', m=1), data=simdat) 
diagnostics(m4, plot=5, ask=FALSE)

m5 &lt;- bam(Y ~ s(Time) + s(Trial) + ti(Time, Trial) 
    + s(Time, Subject, bs='fs', m=1), data=simdat) 
diagnostics(m5, plot=5, ask=FALSE)


## End(Not run)
</code></pre>

<hr>
<h2 id='diff_terms'>Compare the formulas of two models and return the difference(s).</h2><span id='topic+diff_terms'></span>

<h3>Description</h3>

<p>Compare the formulas of two models and return the difference(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_terms(model1, model2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diff_terms_+3A_model1">model1</code></td>
<td>
<p>A fitted regression model (using lm, glm, gam, or bam).</p>
</td></tr>
<tr><td><code id="diff_terms_+3A_model2">model2</code></td>
<td>
<p>A fitted regression model (using lm, glm, gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with model terms that are not shared by both models.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Fit simple GAM model:
gam1 &lt;- bam(Y ~ s(Time), data=simdat)
gam2 &lt;- bam(Y ~ Group+s(Time), data=simdat)
diff_terms(gam1, gam2)

</code></pre>

<hr>
<h2 id='dispersion'>Calculate the dispersion of the residuals</h2><span id='topic+dispersion'></span>

<h3>Description</h3>

<p>Calculate the dispersion of the residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dispersion(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dispersion_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value: dispersion of the residuals.
</p>


<h3>See Also</h3>

<p>Other Functions for model inspection: 
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trial &lt;- function(f=.95){
    x &lt;- rep(1-f,101)
    x[round(runif(1,1,50)):length(x)] &lt;- f
    return(rbinom(101,1,x))
}
set.seed(123)
dat &lt;- data.frame(Time=rep( seq(0,1,length=101),100),
    y = unlist(replicate(100, trial(f=1), simplify=FALSE)),
    stringsAsFactors=FALSE)
# under dispersion:
gam1 &lt;- gam(y ~ s(Time), data=dat, family=binomial)
summary(gam1)
dispersion(gam1)
# but not here:
gam2 &lt;- gam(y ~ 1, data=dat, family=binomial)
summary(gam2)
dispersion(gam2)
# and not here:
dat &lt;- data.frame(Time=rep( seq(0,1,length=101),100),
    y = unlist(replicate(100, trial(f=.75), simplify=FALSE)),
    stringsAsFactors=FALSE)
gam3 &lt;- gam(y ~ s(Time), data=dat, family=binomial)
summary(gam3)
dispersion(gam3)

</code></pre>

<hr>
<h2 id='eeg'>Raw EEG data, single trial, 50Hz.</h2><span id='topic+eeg'></span>

<h3>Description</h3>

<p>A dataset containing a single EEG trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eeg
</code></pre>


<h3>Format</h3>

<p>A data frame with 1504 rows and 5 variables:
</p>

<dl>
<dt><code>Electrode</code></dt><dd><p>Electrode that recorded the EEG.</p>
</dd>
<dt><code>Time</code></dt><dd><p>Time, time measure from onset of the stimulus.</p>
</dd>
<dt><code>Ampl</code></dt><dd><p>EEG amplitude, recorded by 32 electrodes.</p>
</dd>
<dt><code>X</code></dt><dd><p>Approximation of electrode position, relative to Cz. 
Left is negative.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Approximation of electrode position, relative to Cz. 
Back is negative.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>

<hr>
<h2 id='fadeRug'>Fade out the areas in a surface without data.</h2><span id='topic+fadeRug'></span>

<h3>Description</h3>

<p>Add a transparency Rug to a contour plot or image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fadeRug(
  x,
  y,
  n.grid = 30,
  too.far = 0.03,
  col = "white",
  alpha = 1,
  use.data.range = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fadeRug_+3A_x">x</code></td>
<td>
<p>Observations on x-axis.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_y">y</code></td>
<td>
<p>Observations on y-axis.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_n.grid">n.grid</code></td>
<td>
<p>Resolution of Rug. Defaults to 30, 
which means that the x- and y-axis are divided in 30 bins. 
A two-value vector ould be used to specify different bins for 
x- and y-axis.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_too.far">too.far</code></td>
<td>
<p>plot grid nodes that are too far from the points defined by 
the variables given in view can be excluded from the plot. too.far 
determines what is too far. The grid is scaled into the unit square along 
with the view variables and then grid nodes more than too.far from the 
predictor variables are excluded. Based on 
<code><a href="mgcv.html#topic+exclude.too.far">exclude.too.far</a></code> of Simon N. Wood.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_col">col</code></td>
<td>
<p>Color representing missing data. Defaults to 'white'.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_alpha">alpha</code></td>
<td>
<p>Transparency, number between 0 (completely 
transparent) and 1 (non-transparent). Defaults to 1.</p>
</td></tr>
<tr><td><code id="fadeRug_+3A_use.data.range">use.data.range</code></td>
<td>
<p>Logical value, indicating whether <code>x</code> and 
<code>y</code> are the data that the plot is based on. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots a shaded image over the contour plot or image.
</p>


<h3>Warning</h3>

<p>On Linux <code><a href="grDevices.html#topic+x11">x11</a></code> devices may not support transparency. 
In that case, a solution might be to write the plots immediately to a file 
using functions such as <code><a href="grDevices.html#topic+pdf">pdf</a></code>, or <code><a href="grDevices.html#topic+png">png</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij, based on Simon N. Wood's 
<code><a href="mgcv.html#topic+exclude.too.far">exclude.too.far</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+rug">rug</a></code>, <code><a href="graphics.html#topic+contour">contour</a></code>, 
<code><a href="graphics.html#topic+image">image</a></code>
</p>
<p>Other Functions for plotting: 
<code><a href="#topic+rug_model">rug_model</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Introduce extreme values:
set.seed(123)
newdat &lt;- simdat[sample(which(simdat$Time &lt; 1500),
    size=round(.5*length(which(simdat$Time &lt; 1500)))),]
newdat &lt;- rbind(newdat, 
    simdat[sample(which(simdat$Time &gt; 1500),
    size=5),])
# Some simple GAM with tensor:
m1 &lt;- bam(Y ~ te(Time, Trial), data=newdat)
# plot summed effects:
fvisgam(m1, view=c('Time', 'Trial'), zlim=c(-15,15))
fadeRug(newdat$Time, newdat$Trial)
# check with data points:
points(newdat$Time, newdat$Trial, pch=16, col=alpha(1))

# compare with default rug:
fvisgam(m1, view=c('Time', 'Trial'), zlim=c(-15,15))
rug(newdat$Time)
rug(newdat$Trial, side=2)
fadeRug(newdat$Time, newdat$Trial)
# and compare with too.far:
fvisgam(m1, view=c('Time', 'Trial'), zlim=c(-15,15),
    too.far=.03)
vis.gam(m1, view=c('Time', 'Trial'), zlim=c(-15,15),
    too.far=.03, plot.type='contour', color='topo')

# in case fade rug overlaps with color legend:
fvisgam(m1, view=c('Time', 'Trial'), zlim=c(-15,15),
     add.color.legend=FALSE)
fadeRug(newdat$Time, newdat$Trial, alpha=.75)
gradientLegend(c(-15,15), pos=.875)

# change x- and y-grid, and color:
fvisgam(m1, view=c('Time', 'Trial'), zlim=c(-15,15))
points(newdat$Time, newdat$Trial)
fadeRug(newdat$Time, newdat$Trial, n.grid=c(100,10), col='gray')
</code></pre>

<hr>
<h2 id='find_difference'>Return the regions in which the smooth is significantly different from zero.</h2><span id='topic+find_difference'></span>

<h3>Description</h3>

<p>Return the regions in which the smooth is significantly different from zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_difference(mean, se, xVals = NULL, f = 1, as.vector = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_difference_+3A_mean">mean</code></td>
<td>
<p>A vector with smooth predictions.</p>
</td></tr>
<tr><td><code id="find_difference_+3A_se">se</code></td>
<td>
<p>A vector with the standard error on the smooth predictions.</p>
</td></tr>
<tr><td><code id="find_difference_+3A_xvals">xVals</code></td>
<td>
<p>Optional vector with x values for the smooth. 
When <code>xVals</code> is provided, the regions are returned in terms of x-
values, otherwise as indices.</p>
</td></tr>
<tr><td><code id="find_difference_+3A_f">f</code></td>
<td>
<p>A number to multiply the <code>se</code> with, to convert the <code>se</code> 
into confidence intervals. Use 1.96 for 95% CI and 2.58 for 99%CI.</p>
</td></tr>
<tr><td><code id="find_difference_+3A_as.vector">as.vector</code></td>
<td>
<p>Logical: whether or not to return the data points as 
vector, or not. Default is FALSE, and a list with start and end points will
be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with start points of each region 
(<code>start</code>) and end points of each region (<code>end</code>). The logical 
<code>xVals</code> indicates whether the returned values are on the x-scale 
(TRUE) or indices (FALSE).
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Use aggregate to calculate mean and standard deviation per timestamp:
avg &lt;- aggregate(simdat$Y, by=list(Time=simdat$Time),
    function(x){c(mean=mean(x), sd=sd(x))})
head(avg)
# Note that column x has two values in each row:
head(avg$x)
head(avg$x[,1])

# Plot line and standard deviation:
emptyPlot(range(avg$Time), c(-20,20), h0=0)
plot_error(avg$Time, avg$x[,'mean'], avg$x[,'sd'], 
   shade=TRUE, lty=3, lwd=3)

# Show difference with 0:
x &lt;- find_difference(avg$x[,'mean'], avg$x[,'sd'], xVals=avg$Time)
# Add arrows:
abline(v=c(x$start, x$end), lty=3, col='red')
arrows(x0=x$start, x1=x$end, y0=-5, y1=-5, code=3, length=.1, col='red')
</code></pre>

<hr>
<h2 id='fvisgam'>Visualization of nonlinear interactions, summed effects.</h2><span id='topic+fvisgam'></span>

<h3>Description</h3>

<p>Produces perspective or contour plot views of gam model 
predictions of the additive effects interactions.
The code is based on the script for <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>, 
but allows to cancel random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fvisgam(
  x,
  view = NULL,
  cond = list(),
  n.grid = 30,
  too.far = 0,
  col = NA,
  color = "terrain",
  contour.col = NULL,
  add.color.legend = TRUE,
  se = -1,
  sim.ci = FALSE,
  plot.type = "contour",
  xlim = NULL,
  ylim = NULL,
  zlim = NULL,
  nCol = 50,
  rm.ranef = TRUE,
  print.summary = getOption("itsadug_print"),
  transform = NULL,
  transform.view = NULL,
  hide.label = FALSE,
  dec = NULL,
  show.diff = FALSE,
  col.diff = 1,
  alpha.diff = 0.5,
  f = 1.96,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fvisgam_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_view">view</code></td>
<td>
<p>A two-value vector containing the names of the two main effect 
terms to be displayed on the x and y dimensions of the plot. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view). Used for choosing between smooths that share the same view 
predictors.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_too.far">too.far</code></td>
<td>
<p>Plot grid nodes that are too far from the points defined by 
the variables given in view can be excluded from the plot. too.far 
determines what is too far. The grid is scaled into the unit square along 
with the view variables and then grid nodes more than too.far from the 
predictor variables are excluded.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_col">col</code></td>
<td>
<p>The colors for the facets of the plot.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_color">color</code></td>
<td>
<p>The color scheme to use for plots. One of 'topo', 'heat', 
'cm', 'terrain', 'gray' or 'bw'. Alternatively a vector with some colors 
can be provided for a custom color palette (see examples).</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_contour.col">contour.col</code></td>
<td>
<p>sets the color of contours when using plot.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_add.color.legend">add.color.legend</code></td>
<td>
<p>Logical: whether or not to add a color legend. 
Default is TRUE. If FALSE (omitted), one could use the function
<code><a href="plotfunctions.html#topic+gradientLegend">gradientLegend</a></code> to add a legend manually at any position.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface is 
plotted, but if greater than zero, then 3 surfaces are plotted, one at the 
predicted values minus se standard errors, one at the predicted values and 
one at the predicted values plus se standard errors.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_plot.type">plot.type</code></td>
<td>
<p>one of 'contour' or 'persp' (default is 'contour').</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_xlim">xlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the x-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_ylim">ylim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the y-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_zlim">zlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the z-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_ncol">nCol</code></td>
<td>
<p>The number of colors to use in color schemes.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_transform">transform</code></td>
<td>
<p>Function for transforming the fitted values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_transform.view">transform.view</code></td>
<td>
<p>List with two functions for transforming 
the values on the x- and y-axis respectively. If one of the axes 
need to be transformed, set the other to NULL (no transformation).
See examples below.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'fitted values'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_dec">dec</code></td>
<td>
<p>Numeric: number of decimals for rounding the color legend. 
When NULL, no rounding (default). If -1, automatically determined.  
Note: if value = -1, rounding will be applied also when 
<code>zlim</code> is provided.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_show.diff">show.diff</code></td>
<td>
<p>Logical: whether or not to indicate the regions that 
are significantly different from zero. Note that these regions are just 
an indication and dependent on the value of <code>n.grid</code>. 
Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_col.diff">col.diff</code></td>
<td>
<p>Color to shade the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_alpha.diff">alpha.diff</code></td>
<td>
<p>Level of transparency to mark the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_f">f</code></td>
<td>
<p>Scaling factor to determine the CI from the se, for marking the 
difference with 0. Only applies when <code>se</code> is smaller or equal to zero 
and <code>show.diff</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="fvisgam_+3A_...">...</code></td>
<td>
<p>other options to pass on to persp, image or contour. In 
particular ticktype='detailed' will add proper axes labeling to the plots.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>When the argument <code>show.diff</code> is set to TRUE a shading area indicates 
where the confidence intervals include zero. Or, in other words, the areas 
that are not significantly different from zero. Be careful with the 
interpretation, however, as the precise shape of the surface is dependent 
on model constraints such as the value of <code><a href="mgcv.html#topic+choose.k">choose.k</a></code> and the 
smooth function used, and the size of the confidence intervals are 
dependent on the model fit and model characteristics 
(see <code>vignette('acf', package='itsadug')</code>). In addition, the value of 
<code>n.grid</code> determines the precision of the plot.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij and Martijn Wieling. 
Modification of <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code> from 
package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code> of Simon N. Wood.
</p>


<h3>See Also</h3>

<p><code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>, <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>
</p>
<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Model with random effect and interactions:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)

# Plot summed effects:
vis.gam(m1, view=c('Time', 'Trial'), plot.type='contour', color='topo')
# Same plot:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=FALSE)
# Without random effects included:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE)

# Notes on the color legend:
# Labels can easily fall off the plot, therefore the numbers can be
# automatically rounded.
# To do the rounding, set dec=-1:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
     dec=-1)
# For custom rounding, set dec to a value:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
     dec=0)
# To increase the left marging of the plot (so that the numbers fit):
oldmar &lt;- par()$mar
par(mar=oldmar + c(0,0,0,1) ) # add one line to the right
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
     dec=3)
par(mar=oldmar) # restore to default settings

# changing the color palette:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
    color='terrain')
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
    color=c('blue', 'white', 'red'), col=1)

# Using transform
# Plot log-transformed dependent predictor on measurement scale:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE, transform=exp)

# Notes on transform.view: 
# This will generate an error, because x-values &lt;= 0 will result in NaN:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
   transform.view=list(log, NULL))
# adjusting the x-axis helps:
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE,
   xlim=c(1,2000), transform.view=list(log, NULL))

# too.far: 
n &lt;- which(simdat$Time &gt; 1500 &amp; simdat$Trial &gt; 5)
simdat[n,]$Y &lt;- NA
simdat[simdat$Trial == -3,]$Y &lt;- NA
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)
fvisgam(m1, view=c('Time', 'Trial'), rm.ranef=TRUE, too.far=.03)


## End(Not run)
# see the vignette for examples:
vignette('inspect', package='itsadug')
</code></pre>

<hr>
<h2 id='gamtabs'>Convert model summary into Latex/HTML table for knitr/R Markdown reports.</h2><span id='topic+gamtabs'></span>

<h3>Description</h3>

<p>Convert model summary into Latex/HTML table for knitr/R Markdown reports.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamtabs(
  model,
  caption = " ",
  label = "tab.gam",
  pnames = NA,
  snames = NA,
  ptab = NA,
  stab = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamtabs_+3A_model">model</code></td>
<td>
<p>A GAM(M) model build in the package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code> 
using <code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+bam">bam</a></code>.
Alternatively, a summary of a GAMM model could be provided.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_caption">caption</code></td>
<td>
<p>A string with the caption for the table.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_label">label</code></td>
<td>
<p>A string for the label to refer to the table in the markdown 
document.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_pnames">pnames</code></td>
<td>
<p>A vector with labels to relabel the rows in the parametric 
part of the summary.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_snames">snames</code></td>
<td>
<p>A vector with labels to relabel the rows in the smooth
part of the summary.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_ptab">ptab</code></td>
<td>
<p>A vector with labels to relabel the column names of the 
parametric summary.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_stab">stab</code></td>
<td>
<p>A vector with labels to relabel the column names of the 
smooth summary.</p>
</td></tr>
<tr><td><code id="gamtabs_+3A_...">...</code></td>
<td>
<p>Optional additional arguments which are passed to 
<code>xtable</code> (see 'help(xtable)').</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with color values.
</p>


<h3>Note</h3>

<p>This function is useful for markdown documents using the package 
<code>knitr</code> to integrate R code with Latex and Sweave. This 
function requires the package <code>xtable</code>.
</p>


<h3>Author(s)</h3>

<p>R. Harald Baayen
</p>


<h3>See Also</h3>

<p><code><a href="mgcv.html#topic+summary.gam">summary.gam</a></code>, <code><a href="mgcv.html#topic+gam">gam</a></code>, 
<code><a href="mgcv.html#topic+bam">bam</a></code>.
</p>
<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
## Not run: 
# Model with random effect and interactions:
m1 &lt;- bam(Y ~ Group+te(Time, Trial, by=Group),
    data=simdat)
summary(m1)
gamtabs(m1, caption='Summary of m1')

## End(Not run)
# See for more examples:
vignette('inspect', package='itsadug')
</code></pre>

<hr>
<h2 id='get_coefs'>Get coefficients for the parametric terms (intercepts and random slopes).</h2><span id='topic+get_coefs'></span>

<h3>Description</h3>

<p>Wrapper around the function <code><a href="stats.html#topic+coef">coef</a></code>, 
and loosely based on <code><a href="mgcv.html#topic+summary.gam">summary.gam</a></code>. This function 
provides a much faster alternative for <code>summary(model)$p.table</code>.
The function <code><a href="mgcv.html#topic+summary.gam">summary.gam</a></code>) may take considerably 
more time for large models, because it additionally needs to calculate 
estimates for the smooth term table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_coefs(model, se = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_coefs_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_coefs_+3A_se">se</code></td>
<td>
<p>Logical: whether or not to return the standard errors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The coefficients of the parametric terms.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_difference">get_difference</a>()</code>,
<code><a href="#topic+get_fitted">get_fitted</a>()</code>,
<code><a href="#topic+get_modelterm">get_modelterm</a>()</code>,
<code><a href="#topic+get_predictions">get_predictions</a>()</code>,
<code><a href="#topic+get_random">get_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Condition as factor, to have a random intercept
# for illustration purposes:
simdat$Condition &lt;- as.factor(simdat$Condition)

# Model with random effect and interactions:
m1 &lt;- bam(Y ~ Group * Condition + s(Time),
    data=simdat)

# extract all parametric coefficients:
get_coefs(m1)
# calculate t-values:
test &lt;- get_coefs(m1)
test &lt;- cbind(test, test[,1] / test[,2] )
colnames(test)[3] &lt;- 't-value'
test

# get_coefs returns the same numbers as shown in the parametric summary:
summary(m1)
# get_coefs is based on the function coef. This function returns 
# values of all coefficients, and does not provide SE:
coef(m1)

</code></pre>

<hr>
<h2 id='get_difference'>Get model predictions for differences between conditions.</h2><span id='topic+get_difference'></span>

<h3>Description</h3>

<p>Get model predictions for differences between conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_difference(
  model,
  comp,
  cond = NULL,
  rm.ranef = TRUE,
  se = TRUE,
  sim.ci = FALSE,
  f = 1.96,
  return.n.posterior = 0,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_difference_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_comp">comp</code></td>
<td>
<p>A named list with the two levels to compare.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor 
terms. Variables omitted from this list will have the closest observed 
value to the median for continuous variables, or the reference level for 
factors.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE. Alternatively a vector of numbers with the 
mdoelterm number of the random effect(s) to remove. 
(See notes.)</p>
</td></tr>
<tr><td><code id="get_difference_+3A_se">se</code></td>
<td>
<p>Logical: whether or not to return the confidence interval or 
standard error around the estimates.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
In addition, make sure to specify at least 200 points for each smooth 
for the simulations when using simultaneous CI.
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_f">f</code></td>
<td>
<p>A number to scale the standard error. Defaults to 1.96, resulting 
in 95% confidence intervals. For 99% confidence intervals use a value of 
2.58.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_return.n.posterior">return.n.posterior</code></td>
<td>
<p>Numeric: N samples from 
the posterior distribution of the fitted model are returned. 
Default value is 0 (no samples returned). 
Only workes when <code>sim.ci=TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_difference_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with the estimates of the difference and 
optionally the confidence intervals around that estimate.
</p>


<h3>Notes</h3>

<p>Other, not specified effects and random effects are generally canceled 
out, when calculating the difference. When the predictors that 
specify the conditions to compare are involved in other interactions
or included as random slopes, it may be useful to specify the values
of other predictors with <code>cond</code> or remove the random effects with
<code>rm.ranef</code>.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij, Martijn Wieling
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_coefs">get_coefs</a>()</code>,
<code><a href="#topic+get_fitted">get_fitted</a>()</code>,
<code><a href="#topic+get_modelterm">get_modelterm</a>()</code>,
<code><a href="#topic+get_predictions">get_predictions</a>()</code>,
<code><a href="#topic+get_random">get_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# first fit a simple model:
m1 &lt;- bam(Y ~ Group+te(Time, Trial, by=Group), data=simdat)

# get difference estimates:
diff &lt;- get_difference(m1, comp=list(Group=c('Adults', 'Children')), 
    cond=list(Time=seq(0,500,length=100)))
head(diff)
</code></pre>

<hr>
<h2 id='get_fitted'>Get model all fitted values.</h2><span id='topic+get_fitted'></span>

<h3>Description</h3>

<p>Get model all fitted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fitted(
  model,
  se = 1.96,
  rm.ranef = NULL,
  as.data.frame = FALSE,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fitted_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_fitted_+3A_se">se</code></td>
<td>
<p>A number to scale the standard error. Defaults to 1.96, resulting 
in 95% confidence intervals. For 99% confidence intervals use a value of 
2.58.</p>
</td></tr>
<tr><td><code id="get_fitted_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is FALSE. Alternatively a string (or vector of strings) with the 
name of the random effect(s) to remove.</p>
</td></tr>
<tr><td><code id="get_fitted_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>Logical: return values as data frame or as vector. 
Default is FALSE (as vector).</p>
</td></tr>
<tr><td><code id="get_fitted_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with estimates and optionally errors.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_coefs">get_coefs</a>()</code>,
<code><a href="#topic+get_difference">get_difference</a>()</code>,
<code><a href="#topic+get_modelterm">get_modelterm</a>()</code>,
<code><a href="#topic+get_predictions">get_predictions</a>()</code>,
<code><a href="#topic+get_random">get_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
## Not run: 
m1 &lt;- bam(Y ~ Group + s(Time, by=Group)+ s(Subject, bs='re'), 
    data=simdat)

# as.data.frame FALSE and rm.ranef=NULL results in fitted():
all( get_fitted(m1) == fitted(m1) )

# now fitted values without random effects:
all( get_fitted(m1, rm.ranef=TRUE) == fitted(m1) )
head(get_fitted(m1, rm.ranef=TRUE))

# without summary:
infoMessages('off')
head(get_fitted(m1, rm.ranef=TRUE))
infoMessages('on')

## End(Not run)
</code></pre>

<hr>
<h2 id='get_modelterm'>Get estimated for selected model terms.</h2><span id='topic+get_modelterm'></span>

<h3>Description</h3>

<p>Get estimated for selected model terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_modelterm(
  model,
  select,
  cond = NULL,
  n.grid = 30,
  se = TRUE,
  f = 1.96,
  as.data.frame = TRUE,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_modelterm_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_select">select</code></td>
<td>
<p>A number, indicating the model term to be selected.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to restrict the estimates for the 
predictor terms. When NULL (default) values are automatically selected.
Only relevant for complex interactions, which involve more than two 
dimensions.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_n.grid">n.grid</code></td>
<td>
<p>Number of data points estimated for each random smooth.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_se">se</code></td>
<td>
<p>Logical: whether or not to return the confidence interval or 
standard error around the estimates.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_f">f</code></td>
<td>
<p>A number to scale the standard error. Defaults to 1.96, resulting 
in 95% confidence intervals. For 99% confidence intervals use a value of 
2.58.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>Logical: whether or not to return a data.frame. 
Default is TRUE, and a list will be returned.</p>
</td></tr>
<tr><td><code id="get_modelterm_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with estimates for the selected smooth term.
Or a list with two or more elements:
</p>

<ul>
<li> <p><code>fit</code>: Numeric vector with the fitted values;
</p>
</li>
<li> <p><code>se.fit</code>: Optionally, only with <code>se=TRUE</code>.
Numeric vector with the error or confidence interval values (f*SE);
</p>
</li>
<li> <p><code>f</code>: The multiplication factor for generating 
the confidence interval values;
</p>
</li>
<li> <p><code>terms</code>: Numeric vector (for 1-dimensional smooth) 
or data frame (more 2- or more dimensional surfaces) 
with values of the modelterms.
</p>
</li>
<li> <p><code>title</code>: String with name of the model term.
</p>
</li>
<li> <p><code>xlab</code>, <code>ylab</code>, or <code>labels</code>:
Labels for x-axis and optionally y-axis. Precise structure depends 
on type of smooth term: for 1-dimensional smooth only x-label is provided, 
for 2-dimensional smooths x-label and y-label are provided, 
for more complex smooths a vector of of labels is provided.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_coefs">get_coefs</a>()</code>,
<code><a href="#topic+get_difference">get_difference</a>()</code>,
<code><a href="#topic+get_fitted">get_fitted</a>()</code>,
<code><a href="#topic+get_predictions">get_predictions</a>()</code>,
<code><a href="#topic+get_random">get_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run:  
# Model with random effect and interactions:
m1 &lt;- bam(Y ~ s(Time) + s(Trial) 
+ti(Time, Trial)
+s(Time, Subject, bs='fs', m=1),
data=simdat)

# Get data frame with predictions:
p &lt;- get_modelterm(m1, select=1)
emptyPlot(range(p$terms), range(p$fit), h=0)
plot_error(p$terms, p$fit, p$se.fit, shade=TRUE, xpd=TRUE)

# Plot random effects in separate panels:
pp &lt;- get_modelterm(m1, select=4, as.data.frame=TRUE)
require(lattice)
lattice::xyplot(fit~Time|Subject, 
    data=pp, type='l',
    xlab='Time', ylab='Partial effect')

# Plot selection of subjects:
pp &lt;- get_modelterm(m1, select=4, 
    cond=list(Subject=c('a01', 'a03', 'c16')),
    as.data.frame=TRUE)
lattice::xyplot(fit~Time|Subject, 
    data=pp, type='l',
    xlab='Time', ylab='Partial effect')

# Or using the package ggplot2:
require(ggplot2)
pp &lt;- get_modelterm(m1, select=4, as.data.frame=TRUE)
pg &lt;- ggplot2::qplot(Time, fit, data = pp, 
    geom = c('point', 'line'), colour = Subject)
pg + ggplot2::guides(col = guide_legend(nrow = 18))

## End(Not run)

</code></pre>

<hr>
<h2 id='get_pca_predictions'>Return PCA predictions.</h2><span id='topic+get_pca_predictions'></span>

<h3>Description</h3>

<p>Produces perspective or contour plot views of gam model 
predictions of the additive effects interactions.
The code is based on the script for <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>, 
but allows to cancel random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pca_predictions(
  x,
  pca.term = NULL,
  weights = NULL,
  view = NULL,
  cond = list(),
  select = NULL,
  n.grid = 30,
  se = 1.96,
  xlim = NULL,
  ylim = NULL,
  partial = TRUE,
  rm.ranef = NULL,
  as.data.frame = TRUE,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pca_predictions_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_pca.term">pca.term</code></td>
<td>
<p>Text string, name of model predictor that represents a 
principle component.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_weights">weights</code></td>
<td>
<p>Named list with the predictors that are combined in the PC 
and their weights. See examples.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_view">view</code></td>
<td>
<p>A two-value vector containing the names of the two terms to 
plot. The two terms should be part of the PC. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor 
terms (not in view). Used for choosing between smooths that share the 
same view predictors.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_select">select</code></td>
<td>
<p>A number, selecting a single model term for printing. e.g. 
if you want the plot for the second smooth term set select=2.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface 
is plotted, but if greater than zero, then 3 surfaces are plotted, one at 
the predicted values minus se standard errors, one at the predicted 
values and one at the predicted values plus se standard errors.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_xlim">xlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the x-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_ylim">ylim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the y-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_partial">partial</code></td>
<td>
<p>Logical value: whether or not to plot the partial effect 
(TRUE) or the summed effect (FALSE, default).</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>Logical: whether the output is returned as data 
frame (TRUE, default) or as list (FALSE).</p>
</td></tr>
<tr><td><code id="get_pca_predictions_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p><code>plot_pca_surface</code>, <code><a href="stats.html#topic+prcomp">prcomp</a></code>
</p>
<p>Other Functions for PCA interpretation: 
<code><a href="#topic+plot_pca_surface">plot_pca_surface</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
# add hypothetical correlated term:
simdat$predictor &lt;-  (simdat$Trial+10)^.75 + rnorm(nrow(simdat))
# principal components analysis:
pca &lt;- prcomp(simdat[, c('Trial', 'predictor')])
# only first PC term contributes:
summary(pca)
# get rotation (weights of predictors in PC):
pcar &lt;- pca$rotation
# add PC1 to data:
simdat$PC1 &lt;- pca$x[,1]

## Not run: 
# model:
m1 &lt;- bam(Y ~ Group + te(Time, PC1, by=Group) 
    + s(Time, Subject, bs='fs', m=1, k=5), data=simdat)
# inspect surface:
fvisgam(m1, view=c('Time', 'PC1'), cond=list(Group='Children'),
    rm.ranef=TRUE)
# how does Trial contribute?
p &lt;- get_pca_predictions(m1, pca.term='PC1', weights=pcar[,'PC1'], 
    view=c('Time', 'Trial'), cond=list(Group='Children'),
    rm.ranef=TRUE, partial=FALSE)
# Note that the range of Trial is estimated based on the values of PC1.
# A better solution is to specify the range:
p &lt;- get_pca_predictions(m1, pca.term='PC1', weights=pcar[,'PC1'], 
    view=list(Time=range(simdat$Time), Trial=range(simdat$Trial)), 
    cond=list(Group='Children'),rm.ranef=TRUE, partial=FALSE)
# plotting of the surface:
plot_pca_surface(m1, pca.term='PC1', weights=pcar[,'PC1'], 
    view=c('Time', 'Trial'), cond=list(Group='Children'),rm.ranef=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_predictions'>Get model predictions for specific conditions.</h2><span id='topic+get_predictions'></span>

<h3>Description</h3>

<p>Get model predictions for specific conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_predictions(
  model,
  cond = NULL,
  rm.ranef = TRUE,
  se = TRUE,
  sim.ci = FALSE,
  f = 1.96,
  return.n.posterior = 0,
  print.summary = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_predictions_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the predictor terms. 
Variables omitted from this list will have the closest observed value to 
the median for continuous variables, or the reference level for factors.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE. Alternatively a vector with numbers (modelterms) 
of the random effect(s) to remove.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_se">se</code></td>
<td>
<p>Logical: whether or not to return the confidence interval or 
standard error around the estimates.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
In addition, make sure to specify at least 200 points for each smooth 
for the simulations when using simultaneous CI.
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_f">f</code></td>
<td>
<p>A number to scale the standard error. Defaults to 1.96, resulting 
in 95% confidence intervals. For 99% confidence intervals use a value of 
2.58.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_return.n.posterior">return.n.posterior</code></td>
<td>
<p>Numeric: N samples from 
the posterior distribution of the fitted model are returned. 
Default value is 0 (no samples returned). 
Only workes when <code>sim.ci=TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_predictions_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with estimates and optionally errors.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_coefs">get_coefs</a>()</code>,
<code><a href="#topic+get_difference">get_difference</a>()</code>,
<code><a href="#topic+get_fitted">get_fitted</a>()</code>,
<code><a href="#topic+get_modelterm">get_modelterm</a>()</code>,
<code><a href="#topic+get_random">get_random</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
m1 &lt;- bam(Y ~ Group + s(Time, by=Group), data=simdat)

# Time value is automatically set:
pp &lt;- get_predictions(m1, cond=list(Group='Adults'))
head(pp)

# Range of time values:
pp &lt;- get_predictions(m1, 
    cond=list(Group='Adults', Time=seq(0,500,length=100)))
# plot:
emptyPlot(500, range(pp$fit), h=0)
plot_error(pp$Time, pp$fit, pp$CI, shade=TRUE, xpd=TRUE)

# Warning: also unrealistical values are possible
range(simdat$Time)
pp &lt;- get_predictions(m1, 
    cond=list(Group='Adults', Time=seq(-500,0,length=100)))
# plot of predictions that are not supported by data:
emptyPlot(c(-500,0), range(pp$fit), h=0)
plot_error(pp$Time, pp$fit, pp$CI, shade=TRUE, xpd=TRUE) 

m2 &lt;- bam(Y ~ Group + s(Time, by=Group)
    + s(Time, Subject, bs='fs', m=1), 
    data=simdat, discrete=TRUE)
# Simultaneous CI vs pointwise CI
# NOTE: USE AT LEST 200 DATAPOINTS FOR SIMULTANEOUS CI
pp &lt;- get_predictions(m2, 
    cond=list(Group='Adults', Time=seq(0,2000,length=200)), 
    rm.ranef=TRUE, sim.ci=TRUE)
head(pp)
# plot:
emptyPlot(2000, range(pp$fit), h=0)
plot_error(pp$Time, pp$fit, pp$CI, shade=TRUE, xpd=TRUE)
plot_error(pp$Time, pp$fit, pp$sim.CI, shade=FALSE, col=2, xpd=TRUE)



## End(Not run)

</code></pre>

<hr>
<h2 id='get_random'>Get coefficients for the random intercepts and random slopes.</h2><span id='topic+get_random'></span>

<h3>Description</h3>

<p>Get coefficients for the random intercepts and random slopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_random(model, cond = NULL, print.summary = getOption("itsadug_print"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_random_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="get_random_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to restrict the estimates for the 
random predictor terms. When NULL (default) all levels are returned.
Only relevant for complex interactions, which involve more than two 
dimensions.</p>
</td></tr>
<tr><td><code id="get_random_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The coefficients of the random intercepts 
and slopes.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model predictions: 
<code><a href="#topic+get_coefs">get_coefs</a>()</code>,
<code><a href="#topic+get_difference">get_difference</a>()</code>,
<code><a href="#topic+get_fitted">get_fitted</a>()</code>,
<code><a href="#topic+get_modelterm">get_modelterm</a>()</code>,
<code><a href="#topic+get_predictions">get_predictions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Condition as factor, to have a random intercept
# for illustration purposes:
simdat$Condition &lt;- as.factor(simdat$Condition)

# Model with random effect and interactions:
m2 &lt;- bam(Y ~ s(Time) + s(Trial)
+ ti(Time, Trial)
+ s(Condition, bs='re')
+ s(Time, Subject, bs='re'),
data=simdat)

# extract all random effects combined:
newd &lt;- get_random(m2)
head(newd)

# extract coefficients for the random intercept for Condition:
# Make bar plot:
barplot(newd[[1]])
abline(h=0)

# or select:
get_random(m2, cond=list(Condition=c('2','3')))

## End(Not run)

</code></pre>

<hr>
<h2 id='info'>Information on how to cite this package</h2><span id='topic+info'></span>

<h3>Description</h3>

<p>Information on how to cite this package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>info(input = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="info_+3A_input">input</code></td>
<td>
<p>Optional parameter. Normally (NULL) the citation info is 
printed. If value 'version' then only the version is printed.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+citation">citation</a></code>, <code><a href="base.html#topic+R.version">R.version</a></code>,
<code><a href="utils.html#topic+sessionInfo">sessionInfo</a></code>
</p>
<p>Other Functions for package use: 
<code><a href="#topic+infoMessages">infoMessages</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>info()
info('version')
citation(package='itsadug')
# To get info about R version:
R.version.string
</code></pre>

<hr>
<h2 id='infoMessages'>Turn on or off information messages.</h2><span id='topic+infoMessages'></span>

<h3>Description</h3>

<p>Turn on or off information messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infoMessages(input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infoMessages_+3A_input">input</code></td>
<td>
<p>Input variable indicating to print info messages 
('on', or 1, or TRUE) or not ('off', 0, or FALSE).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other Functions for package use: 
<code><a href="#topic+info">info</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To turn on the info messages (all the same):
infoMessages('on')
infoMessages(1)
infoMessages(TRUE)
# To turn off the info messages (all the same):
infoMessages('off')
infoMessages(0)
infoMessages(FALSE)
# checking output:
(out &lt;- infoMessages(FALSE))
</code></pre>

<hr>
<h2 id='inspect_random'>Inspection and interpretation of random factor smooths.</h2><span id='topic+inspect_random'></span>

<h3>Description</h3>

<p>Inspection and interpretation of random factor smooths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect_random(
  model,
  select = 1,
  fun = NULL,
  cond = NULL,
  n.grid = 30,
  print.summary = getOption("itsadug_print"),
  plot = TRUE,
  add = FALSE,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  ylim = NULL,
  h0 = 0,
  v0 = NULL,
  eegAxis = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect_random_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_select">select</code></td>
<td>
<p>A number, indicating the model term to be selected.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_fun">fun</code></td>
<td>
<p>A string or function description to apply to the random effects 
estimates. When NULL (default), the estimates for the random effects are 
returned.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to restrict the estimates for the 
random predictor terms. When NULL (default) all levels are returned.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_n.grid">n.grid</code></td>
<td>
<p>Number of data points estimated for each random smooth.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary of the 
values selected for each predictor. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to plot the random effect estimates 
(TRUE by default).</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_add">add</code></td>
<td>
<p>Logical: whether or not to add the random effect estimates 
to an existing plot (FALSE by default).</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_main">main</code></td>
<td>
<p>Changing the main title for the plot, see also title.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_xlab">xlab</code></td>
<td>
<p>Changing the label for the x axis, 
defaults to a description of x.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_ylab">ylab</code></td>
<td>
<p>Changing the label for the y axis, 
defaults to a description of y.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_ylim">ylim</code></td>
<td>
<p>Changing the y limits of the plot.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_h0">h0</code></td>
<td>
<p>A vector indicating where to add solid horizontal lines 
for reference. By default 0.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_v0">v0</code></td>
<td>
<p>A vector indicating where to add dotted vertical lines 
for reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_eegaxis">eegAxis</code></td>
<td>
<p>Whether or not to reverse the y-axis 
(plotting negative upwards).</p>
</td></tr>
<tr><td><code id="inspect_random_+3A_...">...</code></td>
<td>
<p>other options to pass on to <code><a href="graphics.html#topic+lines">lines</a></code>, 
see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with estimates for random effects
is optionally returned.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data:
data(simdat)

## Not run: 
# Condition as factor, to have a random intercept
# for illustration purposes:
simdat$Condition &lt;- as.factor(simdat$Condition)

# Model with random effect and interactions:
m2 &lt;- bam(Y ~ s(Time) + s(Trial)
+ ti(Time, Trial)
+ s(Condition, bs='re')
+ s(Time, Subject, bs='fs', m=1),
data=simdat)

# extract with wrong select value:
newd &lt;- inspect_random(m2, select=4)
# results in warning, automatically takes select=5
head(newd)
inspect_random(m2, select=5, cond=list(Subject=c('a01','a02','a03')))

# Alternatively, fix random effect of Condition, and plot 
# random effects for subjects with lattice:
newd &lt;- inspect_random(m2, select=5,
    cond=list(Subject=unique(simdat[simdat$Condition==0,'Subject'])),
    plot=FALSE)

# Make lattice plot:
require(lattice)
lattice::xyplot(fit~Time | Subject,
    data=newd, type='l',
    xlab='Time', ylab='Partial effect')

# Using argument 'fun':
inspect_random(m2, select=5, fun=mean, 
    cond=list(Subject=unique(simdat[simdat$Condition==0,'Subject'])))
inspect_random(m2, select=5, fun=mean, 
    cond=list(Subject=unique(simdat[simdat$Condition==2,'Subject'])),
    col='red', add=TRUE)

## End(Not run)

# see the vignette for examples:
vignette('overview', package='itsadug')
</code></pre>

<hr>
<h2 id='itsadug'>Interpreting Time Series, Autocorrelated Data Using GAMMs (itsadug)</h2><span id='topic+itsadug'></span>

<h3>Description</h3>

<p>Itsadug provides a set of functions that facilitate the evaluation, 
interpretation, and visualization of GAMM models that are implemented in 
the package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code>.
</p>


<h3>Tutorials</h3>


<ul>
<li> <p><code>vignette('inspect', package='itsadug')</code> - summarizes different 
functions for visualizing the model.
</p>
</li>
<li> <p><code>vignette('test', package='itsadug')</code> - summarizes 
different functions for significance testing.
</p>
</li>
<li> <p><code>vignette('acf', package='itsadug')</code> - summarizes how to check 
and account for autocorrelation in the residuals.
</p>
</li></ul>

<p>Also available online on <a href="https://www.jacolienvanrij.com">https://www.jacolienvanrij.com</a>.
</p>


<h3>Interpretation and visualization</h3>

<p>Main functions that are provided in <code>itsadug</code> for interpretation and 
visualization of GAMM models:
</p>

<ul>
<li> <p><code><a href="#topic+pvisgam">pvisgam</a></code> plots partial interaction surfaces; it also 
allows for visualizing 3-way or higher interactions.
</p>
</li>
<li> <p><code><a href="#topic+fvisgam">fvisgam</a></code> plots summed interaction surfaces, with the 
possibility to exclude random effects.
</p>
</li>
<li> <p><code><a href="#topic+plot_smooth">plot_smooth</a></code> plots 1D model estimates, and has the 
possibility to exclude random effects. 
</p>
</li>
<li> <p><code><a href="#topic+plot_parametric">plot_parametric</a></code> plot group estimates.
</p>
</li>
<li> <p><code><a href="#topic+inspect_random">inspect_random</a></code> plots and optionally averages random 
smooths
</p>
</li>
<li> <p><code><a href="#topic+plot_data">plot_data</a></code> plots the data
</p>
</li>
<li> <p><code><a href="#topic+plot_topo">plot_topo</a></code> plots EEG topographies
</p>
</li></ul>



<h3>Testing for significance</h3>


<ul>
<li> <p><code><a href="#topic+compareML">compareML</a></code> Performs Chisquare test on two models
</p>
</li>
<li> <p><code><a href="#topic+plot_diff">plot_diff</a></code> Calculates and visualizes the difference 
between two conditions within a model
</p>
</li>
<li> <p><code><a href="#topic+plot_diff2">plot_diff2</a></code> Calculates and visualizes the 2 dimensional 
difference between two conditions within a model
</p>
</li></ul>



<h3>Evaluation of the model</h3>


<ul>
<li> <p><code><a href="#topic+check_resid">check_resid</a></code> plots four different plots to inspect the 
distribution of and structure in the residuals
</p>
</li>
<li> <p><code><a href="#topic+plot_modelfit">plot_modelfit</a></code> plots an overlay of the data and the 
modelfit for randomly selected trials
</p>
</li>
<li> <p><code><a href="#topic+diagnostics">diagnostics</a></code> produces plots of the distributions of 
residuals and predictors in the model
</p>
</li></ul>



<h3>Checking and handling autocorrelation</h3>


<ul>
<li> <p><code><a href="#topic+acf_resid">acf_resid</a></code> different ways to inspect autocorrelation in 
the residuals
</p>
</li>
<li> <p><code><a href="#topic+start_event">start_event</a></code> creates an AR.start column 
</p>
</li>
<li> <p><code><a href="#topic+resid_gam">resid_gam</a></code> returns residuals corrected for the AR1 model
</p>
</li></ul>



<h3>Predictions</h3>

<p>Further, there are some wrappers around the <code><a href="mgcv.html#topic+predict.gam">predict.gam</a></code>
function to facilitate the extraction of model predictions. These can be 
used for customized plots. See for an example in the vignette 
'plotfunctions' 
(<code>vignette('plotfunctions', package='itsadug')</code>).
</p>

<ul>
<li> <p><code><a href="#topic+get_predictions">get_predictions</a></code> for getting the estimates for given 
settings of some or all of the model predictors;
</p>
</li>
<li> <p><code><a href="#topic+get_difference">get_difference</a></code> for extracting the difference between 
two conditions or two smooths or two surfaces.
</p>
</li>
<li> <p><code><a href="#topic+get_modelterm">get_modelterm</a></code> for extracting the smooth term (
partial) estimates.
</p>
</li>
<li> <p><code><a href="#topic+inspect_random">inspect_random</a></code> and <code><a href="#topic+get_random">get_random</a></code> for 
extracting random effects only.
</p>
</li></ul>



<h3>Notes</h3>


<ul>
<li><p> Use <code><a href="#topic+infoMessages">infoMessages</a>(FALSE)</code> to suppress all 
information messages for the current session. 
This may be helpful when creating knitr or
R markdown reports.
</p>
</li>
<li><p> The vignettes are available via <code>browseVignettes()</code>. 
When working on a server via the command line, 
using <code>ssh -X</code> instead of <code>ssh</code> may make the 
HTML files available.
</p>
</li>
<li><p> A list of all available functions is provided in 
<code>help(package='itsadug')</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jacolien van Rij, Martijn Wieling, R.Harald Baayen, Hedderik van Rijn
</p>
<p>Maintainer: Jacolien van Rij (<a href="mailto:vanrij.jacolien@gmail.com">vanrij.jacolien@gmail.com</a>)
</p>
<p>University of Groningen, The Netherlands
</p>

<hr>
<h2 id='missing_est'>Return indices of data that were not fitted by the model.</h2><span id='topic+missing_est'></span>

<h3>Description</h3>

<p>Return indices of data that were not fitted by the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>missing_est(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="missing_est_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using lm, glm, gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The indices of the data that were not fitted by the model.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Add missing values:
set.seed(123)
simdat[sample(nrow(simdat), size=20),]$Y &lt;- NA
# Fit simple linear model:
lm1 &lt;- lm(Y ~ Time, data=simdat)
na.el &lt;- missing_est(lm1)
length(na.el)

</code></pre>

<hr>
<h2 id='modeledf'>Retrieve the degrees of freedom specified in the model.</h2><span id='topic+modeledf'></span>

<h3>Description</h3>

<p>Retrieve the degrees of freedom specified in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modeledf(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modeledf_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value: degrees of freedom specified in the model.
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# models take somewhat longer time to run:

# Fit simple GAM model:
gam1 &lt;- bam(Y ~ s(Time), data=simdat, discrete=TRUE)
modeledf(gam1)
gam2 &lt;- bam(Y ~ s(Time)+s(Time, Subject, bs='fs', m=1), 
    data=simdat, discrete=TRUE)
modeledf(gam2)
gam3 &lt;- bam(Y ~ Subject+s(Time, by=Subject), 
    data=simdat, discrete=TRUE)
modeledf(gam3)
gam4 &lt;- bam(Y ~ Group+s(Time)+s(Time, Subject, bs='fs', m=1), 
    data=simdat, discrete=TRUE)
modeledf(gam4) 
gam5 &lt;- bam(Y ~ Group+s(Time, by=Group)+s(Time, Subject, bs='fs', m=1), 
    data=simdat, discrete=TRUE)
modeledf(gam5) 

# Fit a gamm:
gam6 &lt;- gamm(Y ~ Group+s(Time), random=list(Subject=~1) data=simdat, discrete=TRUE)
# this produces an error...
modeledf(gam6)
# ... but this works:
modeledf(gam6$gam)

## End(Not run)

</code></pre>

<hr>
<h2 id='observations'>Number of observations in the model.</h2><span id='topic+observations'></span>

<h3>Description</h3>

<p>Number of observations in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>observations(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="observations_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using gam, bam, (g)lm, (g)lmer).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value: number of observations that are considered by the 
model.
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
# simulate some missing data:
simdat[sample(1:nrow(simdat), size=15),]$Y &lt;- NA
simdat[sample(1:nrow(simdat), size=7),]$Group &lt;- NA

# Fit simple GAM models:
gam1 &lt;- bam(Y ~ s(Time), data=simdat, discrete=TRUE)
gam2 &lt;- bam(Y ~ Group + s(Time, by=Group), data=simdat, discrete=TRUE)

# number of data points in data frame:
nrow(simdat)

# observations model gam1:
observations(gam1)
# observations model gam2:
observations(gam2)

</code></pre>

<hr>
<h2 id='plot_data'>Visualization of the model fit for time series data.</h2><span id='topic+plot_data'></span>

<h3>Description</h3>

<p>Plots the data, fitted values, or residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_data(
  model,
  view,
  split_by = NULL,
  cond = NULL,
  input = "data",
  rm.ranef = NULL,
  alpha = NULL,
  col = NULL,
  add = FALSE,
  eegAxis = FALSE,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  ylim = NULL,
  h0 = 0,
  v0 = NULL,
  hide.label = FALSE,
  transform = NULL,
  transform.view = NULL,
  print.summary = getOption("itsadug_print"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_data_+3A_model">model</code></td>
<td>
<p>A lm or gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_view">view</code></td>
<td>
<p>Text string containing the predictor or column in the data 
to be displayed on the x-axis. 
Note that variables coerced to factors in the model formula 
won't work as view variables.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_split_by">split_by</code></td>
<td>
<p>Vector with names of model predictors that determine
the time series in the data, or should be used to split the ACF plot by.
Alternatively, <code>split_pred</code> can be a named list 
(each with equal length as the data) that 
group the data, fitted values or residuals 
values of <code>x</code> into trials or timeseries events. 
Generally other columns from the same data frame as the model was fitted on.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view) or to select specific trials or time series to plot.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_input">input</code></td>
<td>
<p>Text string: 'data' (default) plots the data, 'resid' plots 
the model residuals, and 'fitted' plots the fitted values.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to include the random effects in 
the model predictions. Default is TRUE. Relevant for <code>input='fitted'</code> 
and <code>input='resid'</code> (i.e., whether or not the residuals contain the 
random effects, TRUE and FALSE respectively ).</p>
</td></tr>
<tr><td><code id="plot_data_+3A_alpha">alpha</code></td>
<td>
<p>Value between 0 and 1 indicating the transparency. 
A value of 0 is completely transparant, whereas a value of 1 is completely 
untransparant.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_col">col</code></td>
<td>
<p>Vector with one color value (i.e., all data points will have the 
same color), color values for each grouping condition specified in 
<code>split_by</code> or a vector with color values for each data point.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_add">add</code></td>
<td>
<p>Logical: whether or not to add the lines/points to an existing 
plot, or start a new plot (default).</p>
</td></tr>
<tr><td><code id="plot_data_+3A_eegaxis">eegAxis</code></td>
<td>
<p>Logical: whether or not to reverse the y-axis, plotting the 
negative amplitudes upwards as traditionally is done in EEG research.
If eeg.axes is TRUE, labels for x- and y-axis are provided, when not 
provided by the user. Default value is FALSE.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_main">main</code></td>
<td>
<p>Changing the main title for the plot, see also title.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_xlab">xlab</code></td>
<td>
<p>Changing the label for the x axis, 
defaults to a description of x.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_ylab">ylab</code></td>
<td>
<p>Changing the label for the y axis, 
defaults to a description of y.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_h0">h0</code></td>
<td>
<p>A vector indicating where to add solid horizontal lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_v0">v0</code></td>
<td>
<p>A vector indicating where to add dotted vertical lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'fitted values'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_transform">transform</code></td>
<td>
<p>Function for transforming the fitted values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_transform.view">transform.view</code></td>
<td>
<p>Function for transforming the view values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_data_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_data_+3A_...">...</code></td>
<td>
<p>other options to pass on to lines and plot, 
see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Notes</h3>

<p>This function plots the fitted effects, including intercept and other 
predictors.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij, idea of Tino Sering
</p>


<h3>See Also</h3>

<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Create grouping predictor for time series:
simdat$Event &lt;- interaction(simdat$Subject, simdat$Trial)

# model without random effects:
m1 &lt;- bam(Y ~ te(Time, Trial) + s(Subject, bs='re'),
    data=simdat)

# All data points, without clustering:
plot_data(m1, view='Time')

# All data, clustered by Trial (very small dots):
plot_data(m1, view='Time', split_by='Trial',
    cex=.25)
# Add a smooth for each trial:
plot_smooth(m1, view='Time', plot_all='Trial', 
    add=TRUE, rm.ranef=TRUE)
# Add the model predictions in same color:
plot_smooth(m1, view='Time', plot_all='Trial', add=TRUE, rm.ranef=TRUE)

# Alternatively, use data to select events:
plot_data(m1, view='Time', split_by=list(Event=simdat$Event),
    type='l')
# which is the same as:
plot_data(m1, view='Time', split_by=list(Subject=simdat$Subject, Trial=simdat$Trial),
    type='l')
# Only for Trial=0
plot_data(m1, view='Time', split_by=list(Event=simdat$Event),
   cond=list(Trial=0), type='l')
# This is the same:
plot_data(m1, view='Time', split_by='Subject',
   cond=list(Trial=0), type='l')
# Add subject smooths:
plot_smooth(m1, view='Time', plot_all='Subject', 
    cond=list(Trial=0), add=TRUE)

# Change the colors:
plot_data(m1, view='Time', split_by='Subject',
   cond=list(Trial=0), type='l', col='gray', alpha=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot_diff'>Plot difference curve based on model predictions.</h2><span id='topic+plot_diff'></span><span id='topic+plotDiff'></span>

<h3>Description</h3>

<p>Plot difference curve based on model predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_diff(
  model,
  view,
  comp,
  cond = NULL,
  se = 1.96,
  sim.ci = FALSE,
  n.grid = 100,
  add = FALSE,
  rm.ranef = TRUE,
  mark.diff = TRUE,
  col.diff = "red",
  col = "black",
  eegAxis = FALSE,
  transform.view = NULL,
  print.summary = getOption("itsadug_print"),
  plot = TRUE,
  main = NULL,
  ylab = NULL,
  xlab = NULL,
  xlim = NULL,
  ylim = NULL,
  hide.label = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_diff_+3A_model">model</code></td>
<td>
<p>A GAMM model, resulting from the functions
<code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_view">view</code></td>
<td>
<p>Name of continuous predictor that should be plotted on the x-
axis.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_comp">comp</code></td>
<td>
<p>Named list with the grouping predictor (categorical variable)
and the 2 levels to calculate the difference for.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the predictor terms. 
Variables omitted from this list will have the closest observed value to 
the median for continuous variables, or the reference level for factors.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted smooth is 
plotted, but if greater than zero, then the predicted values plus 
confidence intervals are plotted. 
The value of <code>se</code> will be multiplied with 
the standard error (i.e., 1.96 results in 95%CI and 2.58). 
Default is set to 1.96 (95%CI).</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_n.grid">n.grid</code></td>
<td>
<p>Number of data points sampled as predictions. Defaults to 100.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_add">add</code></td>
<td>
<p>Logical: whether or not to add the line to an existing plot. 
Default is FALSE.
When no plot window is available and <code>add=TRUE</code>, 
the function will generate an error.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE. Alternatively a string (or vector of strings) with the 
name of the random effect(s) to remove.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_mark.diff">mark.diff</code></td>
<td>
<p>Logical: whether or not marking where the difference 
is significantly different from 0.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_col.diff">col.diff</code></td>
<td>
<p>Color to mark differences (red by default).</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_col">col</code></td>
<td>
<p>Line color. Shading color is derived from line color.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_eegaxis">eegAxis</code></td>
<td>
<p>Logical: whether or not to reverse the y-axis, plotting 
negative values upwards. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_transform.view">transform.view</code></td>
<td>
<p>Function for transforming 
the values on the x-axis. Defaults to NULL (no transformation). 
(See <code><a href="#topic+plot_smooth">plot_smooth</a></code> for more info.)</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print the summary. 
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to plot the difference. If FALSE, then 
the output is returned as a list, with the estimated difference 
(<code>est</code>) and the standard error over the estimate (<code>se.est</code>) and 
the x-values (<code>x</code>). Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_main">main</code></td>
<td>
<p>Text string, alternative title for plot.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_ylab">ylab</code></td>
<td>
<p>Text string, alternative label for y-axis.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_xlab">xlab</code></td>
<td>
<p>Text string, alternative label for x-axis.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_xlim">xlim</code></td>
<td>
<p>Range of x-axis. If not specified, the function automatically 
generates an appropriate x-axis.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_ylim">ylim</code></td>
<td>
<p>Range of y-axis. If not specified, the function automatically 
generates an appropriate y-axis.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'difference'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_diff_+3A_...">...</code></td>
<td>
<p>Optional arguments for <code><a href="plotfunctions.html#topic+emptyPlot">emptyPlot</a></code>, 
or <code><a href="plotfunctions.html#topic+plot_error">plot_error</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the result is not being plotted, a list is 
returned with the estimated difference (<code>est</code>) and the standard error 
over the estimate (<code>se</code>) and the x-values (<code>x</code>) is returned.
</p>


<h3>Author(s)</h3>

<p>Martijn Wieling, Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Testing for significance: 
<code><a href="#topic+compareML">compareML</a>()</code>,
<code><a href="#topic+plot_diff2">plot_diff2</a>()</code>,
<code><a href="#topic+report_stats">report_stats</a>()</code>,
<code><a href="#topic+wald_gam">wald_gam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
## Not run: 
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group)
    + s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)
plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')))
# in this model, excluding random effects does not change the difference:
plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')), 
    rm.ranef=TRUE)
# simultaneous CI:
plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')), 
    rm.ranef=TRUE, sim.ci=TRUE)
# Reversed y-axis (for EEG data) and no shading:
plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')), 
    eegAxis=TRUE, shade=FALSE)
plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')),
density=15, angle=90, ci.lwd=3)
# Retrieving plot values...
out &lt;- plot_diff(m1, view='Time', comp=list(Group=c('Children', 'Adults')), 
   plot=FALSE)
#... which might be used for indicating differences:
x &lt;- find_difference(out$est, out$se, f=1.96, xVals=out$xVals)
# add lines:
arrows(x0=x$start, x1=x$end, y0=0, y1=0,code=3, length=.1, col='red')

## End(Not run)

</code></pre>

<hr>
<h2 id='plot_diff2'>Plot difference surface based on model predictions.</h2><span id='topic+plot_diff2'></span><span id='topic+plotDiff2D'></span>

<h3>Description</h3>

<p>Plot difference surface based on model predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_diff2(
  model,
  view,
  comp,
  cond = NULL,
  color = "terrain",
  nCol = 100,
  col = NULL,
  add.color.legend = TRUE,
  se = 1.96,
  sim.ci = FALSE,
  show.diff = FALSE,
  col.diff = 1,
  alpha.diff = 0.5,
  n.grid = 30,
  nlevels = 10,
  zlim = NULL,
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  rm.ranef = TRUE,
  transform.view = NULL,
  hide.label = FALSE,
  dec = NULL,
  f = 1.96,
  print.summary = getOption("itsadug_print"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_diff2_+3A_model">model</code></td>
<td>
<p>A GAMM model, resulting from the functions
<code><a href="mgcv.html#topic+gam">gam</a></code> or <code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_view">view</code></td>
<td>
<p>Name of continuous predictors that should be plotted on the x-
and y-axes. Vector of two values.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_comp">comp</code></td>
<td>
<p>Named list with the grouping predictor (categorical variable)
and the 2 levels to calculate the difference for.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_cond">cond</code></td>
<td>
<p>Named list of the values to use for the other predictor terms 
(not in view).</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_color">color</code></td>
<td>
<p>The color scheme to use for plots. One of 'topo', 'heat', 
'cm', 'terrain', 'gray' or 'bw'. Alternatively a vector with some colors 
can be provided for a custom color palette.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_ncol">nCol</code></td>
<td>
<p>Range of colors of background of contour plot.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_col">col</code></td>
<td>
<p>Line color.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_add.color.legend">add.color.legend</code></td>
<td>
<p>Logical: whether or not to add a color legend. 
Default is TRUE. If FALSE (omitted), one could use the function
<code><a href="plotfunctions.html#topic+gradientLegend">gradientLegend</a></code> to add a legend manually at any position.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface is 
plotted, but if greater than zero, then the predicted values plus 
confidence intervals are plotted. 
The value of <code>se</code> will be multiplied with 
the standard error (i.e., 1.96 results in 95%CI and 2.58). 
Default is set to 1.96 (95%CI).</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_show.diff">show.diff</code></td>
<td>
<p>Logical: whether or not to indicate the regions that 
are significantly different from zero. Note that these regions are just 
an indication and dependent on the value of <code>n.grid</code>. 
Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_col.diff">col.diff</code></td>
<td>
<p>Color to shade the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_alpha.diff">alpha.diff</code></td>
<td>
<p>Level of transparency to mark the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_n.grid">n.grid</code></td>
<td>
<p>Resolution.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_nlevels">nlevels</code></td>
<td>
<p>Levels of contour lines.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_zlim">zlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the z-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_xlim">xlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the x-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_ylim">ylim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the y-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_main">main</code></td>
<td>
<p>Title of plot.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_xlab">xlab</code></td>
<td>
<p>Label x-axis.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_ylab">ylab</code></td>
<td>
<p>Label y-axis.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE. Alternatively a string (or vector of strings) with the 
name of the random effect(s) to remove.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_transform.view">transform.view</code></td>
<td>
<p>List with two functions for transforming 
the values on the x- and y-axis respectively. If one of the axes 
need to be transformed, set the other to NULL (no transformation). 
(See <code><a href="#topic+fvisgam">fvisgam</a></code> for more info.)</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'difference'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_dec">dec</code></td>
<td>
<p>Numeric: number of decimals for rounding the color legend. 
When NULL (default), no rounding. If -1 (default), automatically determined. 
Note: if value = -1 (default), rounding will be applied also when 
<code>zlim</code> is provided.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_f">f</code></td>
<td>
<p>Scaling factor to determine the CI from the se, for marking the 
difference with 0. Only applies when <code>se</code> is smaller or equal to zero 
and <code>show.diff</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_diff2_+3A_...">...</code></td>
<td>
<p>Optional arguments for <code><a href="plotfunctions.html#topic+plotsurface">plotsurface</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the result is not being plotted, a list is 
returned with the estimated difference (<code>est</code>) and the standard error 
over the estimate (<code>se.est</code>) and the x-values (<code>x</code>) is returned.
</p>


<h3>Warning</h3>

<p>When the argument <code>show.diff</code> is set to TRUE a shading area indicates 
where the confidence intervals include zero. Or, in other words, the areas 
that are not significantly different from zero. Be careful with the 
interpretation, however, as the precise shape of the surface is dependent 
on model constraints such as the value of <code><a href="mgcv.html#topic+choose.k">choose.k</a></code> and the 
smooth function used, and the size of the confidence intervals are 
dependent on the model fit and model characteristics 
(see <code>vignette('acf', package='itsadug')</code>). In addition, the value of 
<code>n.grid</code> determines the precision of the plot.
</p>


<h3>Author(s)</h3>

<p>Martijn Wieling, reimplemented by Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Testing for significance: 
<code><a href="#topic+compareML">compareML</a>()</code>,
<code><a href="#topic+plot_diff">plot_diff</a>()</code>,
<code><a href="#topic+report_stats">report_stats</a>()</code>,
<code><a href="#topic+wald_gam">wald_gam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
## Not run: 
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group),
    data=simdat)
plot_diff2(m1, view=c('Time', 'Trial'), 
    comp=list(Group=c('Children', 'Adults')))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_modelfit'>Visualization of the model fit for time series data.</h2><span id='topic+plot_modelfit'></span>

<h3>Description</h3>

<p>Plots the fitted values and the data for <code>n</code> 
trials of time series data. For example, plots <code>n</code> trials 
of the same participant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_modelfit(
  x,
  view,
  event = NULL,
  n = 3,
  random = TRUE,
  cond = NULL,
  col = c(alpha(1), "red"),
  add = FALSE,
  eegAxis = FALSE,
  fill = FALSE,
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  ylim = NULL,
  h0 = 0,
  v0 = NULL,
  transform = NULL,
  hide.label = FALSE,
  hide.legend = FALSE,
  print.summary = getOption("itsadug_print"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_modelfit_+3A_x">x</code></td>
<td>
<p>A lm or gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_view">view</code></td>
<td>
<p>Text string containing the predictor or column in the data 
to be displayed on the x-axis. 
Note that variables coerced to factors in the model formula 
won't work as view variables.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_event">event</code></td>
<td>
<p>column name from the data 
that specifies the time series from which <code>n</code> are being plotted.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_n">n</code></td>
<td>
<p>Number of time series to plot. Default is 3. Set to -1 for plotting 
all time series (which may take a considerable time).</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_random">random</code></td>
<td>
<p>Numeric: if set to TRUE (default), <code>n</code> random events are 
selected to plot. If set to FALSE, the first <code>n</code> events are selected 
to plot. The events could be precisely controlled with the argument 
<code>cond</code>.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view) or to select specific trials or time series to plot.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_col">col</code></td>
<td>
<p>Two value vector specifiying the colors for the data and 
the modelfit respectively.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_add">add</code></td>
<td>
<p>Logical: whether or not to add the lines to an existing plot, or 
start a new plot (default).</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_eegaxis">eegAxis</code></td>
<td>
<p>Logical: whether or not to reverse the y-axis, plotting the 
negative amplitudes upwards as traditionally is done in EEG research.
If eeg.axes is TRUE, labels for x- and y-axis are provided, when not 
provided by the user. Default value is FALSE.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_fill">fill</code></td>
<td>
<p>Logical: whether or not to fill the area between the data and 
the fitted values with shading. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_main">main</code></td>
<td>
<p>Changing the main title for the plot, see also title.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_xlab">xlab</code></td>
<td>
<p>Changing the label for the x axis, 
defaults to a description of x.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_ylab">ylab</code></td>
<td>
<p>Changing the label for the y axis, 
defaults to a description of y.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_h0">h0</code></td>
<td>
<p>A vector indicating where to add solid horizontal lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_v0">v0</code></td>
<td>
<p>A vector indicating where to add dotted vertical lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_transform">transform</code></td>
<td>
<p>Function for transforming the fitted values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'fitted values'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_hide.legend">hide.legend</code></td>
<td>
<p>Logical: whether or not to hide the legend. 
Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_modelfit_+3A_...">...</code></td>
<td>
<p>other options to pass on to lines and plot, 
see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Notes</h3>

<p>This function plots the fitted effects, including intercept and other 
predictors.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Model evaluation: 
<code><a href="#topic+check_resid">check_resid</a>()</code>,
<code><a href="#topic+diagnostics">diagnostics</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Create grouping predictor for time series:
simdat$Event &lt;- interaction(simdat$Subject, simdat$Trial)

# model without random effects:
m1 &lt;- bam(Y ~ te(Time, Trial),
    data=simdat)
plot_modelfit(m1, view='Time', event=simdat$Event)

# colorizing residuals:
plot_modelfit(m1, view='Time', event=simdat$Event, fill=TRUE)

# All trials of one subject:
## Not run: 
# this produces error:
plot_modelfit(m1, view='Time', event=simdat$Event, 
    cond=list(Subject='a01'), n=-1)

## End(Not run)
# instead try this:
simdat$Subj &lt;- ifelse(simdat$Subject=='a01', TRUE, FALSE)
plot_modelfit(m1, view='Time', event=simdat$Event, 
    cond=list(Subject=simdat$Subj), n=-1)

## Not run: 
# Model with random intercepts for subjects:
m2 &lt;- bam(Y ~ te(Time, Trial)+s(Subject, bs='re'),
    data=simdat)
# now selecting a subject works, because it is in the model:
plot_modelfit(m2, view='Time', event=simdat$Event, 
    cond=list(Subject='a01'), n=-1, ylim=c(-13,13))

# Model with random effect and interactions:
m3 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat)
plot_modelfit(m3, view='Time', event=simdat$Event, 
    cond=list(Subject='a01'), n=-1, ylim=c(-13,13))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_parametric'>Visualization of group estimates.</h2><span id='topic+plot_parametric'></span>

<h3>Description</h3>

<p>Plots a smooth from a <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code> model based on predictions.
In contrast with the default <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, this function 
plots the summed effects and optionally removes the random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_parametric(
  x,
  pred,
  cond = list(),
  parametricOnly = FALSE,
  rm.ranef = TRUE,
  col = "black",
  se = 1.96,
  print.summary = getOption("itsadug_print"),
  main = NULL,
  xlab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_parametric_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_pred">pred</code></td>
<td>
<p>A named list of the values to use for the predictor terms 
to plot.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view). Used for choosing between smooths that share the same view 
predictors.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_parametriconly">parametricOnly</code></td>
<td>
<p>Logical: whether or not to cancel out all smooth 
terms and only use the predictors in the parametric summary.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_col">col</code></td>
<td>
<p>The colors for the lines and the error bars of the plot.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface is 
plotted, but if greater than zero, then the predicted values plus 
confidence intervals are plotted. The value of se will be multiplied with 
the standard error (i.e., 1.96 results in 95%CI and 2.58).</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_main">main</code></td>
<td>
<p>Changing the main title for the plot, see also title.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_xlab">xlab</code></td>
<td>
<p>Changing the label for the x axis, 
defaults to a description of x.</p>
</td></tr>
<tr><td><code id="plot_parametric_+3A_...">...</code></td>
<td>
<p>other options to pass on to <code><a href="plotfunctions.html#topic+dotplot_error">dotplot_error</a></code>, 
see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Use <code>parametricOnly</code> with care! When set to TRUE, all smooth 
predictors are set to 0. Note that this might result in strange 
predictions, because a value of 0 does not always represents a realistic 
situation (e.g., body temperature of 0 is highly unlikely).  
Note that linear slopes are not set to zero, because they are 
considered as parametric terms. If <code>cond</code> does not specify a value for 
these continuous predictors, the closes value to the mean is automatically  
selected.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij, based on a function of Fabian Tomaschek
</p>


<h3>See Also</h3>

<p><code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>
</p>
<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
## Not run: 
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group)
    + s(Time, Subject, bs='fs', m=1), data=simdat)
plot_parametric(m1, pred=list(Group=c('Adults', 'Children')))
# Note the summary that is printed.

# use rm.ranef to cancel random effects:
plot_parametric(m1, pred=list(Group=c('Adults', 'Children')),
    rm.ranef = TRUE)

# It is possible to get estimates that do not make sense:
out &lt;- plot_parametric(m1, 
    pred=list(Group=c('Adults', 'Children'), Subject=c('a01', 'a02', 'c01')))
print(out)

## End(Not run)

# see the vignette for examples:
vignette('overview', package='itsadug')
</code></pre>

<hr>
<h2 id='plot_pca_surface'>Visualization of the effect predictors in nonlinear interactions with 
principled components.</h2><span id='topic+plot_pca_surface'></span>

<h3>Description</h3>

<p>Produces perspective or contour plot views of gam model 
predictions of the additive effects interactions.
The code is based on the script for <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>, 
but allows to cancel random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pca_surface(
  x,
  pca.term = NULL,
  weights = NULL,
  view = NULL,
  cond = list(),
  partial = FALSE,
  select = NULL,
  se = -1,
  n.grid = 30,
  too.far = 0,
  rm.ranef = NULL,
  col = NA,
  color = "topo",
  contour.col = NULL,
  nCol = 50,
  plotCI = FALSE,
  add.color.legend = TRUE,
  plot.type = "contour",
  xlim = NULL,
  ylim = NULL,
  zlim = NULL,
  print.summary = getOption("itsadug_print"),
  transform = NULL,
  transform.view = NULL,
  hide.label = FALSE,
  dec = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pca_surface_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_pca.term">pca.term</code></td>
<td>
<p>Text string, name of model predictor that represents a 
principle component.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_weights">weights</code></td>
<td>
<p>Named list with the predictors that are combined in the PC 
and their weights. See examples.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_view">view</code></td>
<td>
<p>A two-value vector containing the names of the two terms to 
plot. The two terms should be part of the PC. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor 
terms (not in view). Used for choosing between smooths that share the 
same view predictors.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_partial">partial</code></td>
<td>
<p>Logical value: whether or not to plot the partial effect 
(TRUE) or the summed effect (FALSE, default).</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_select">select</code></td>
<td>
<p>Numeric value, model term. In case <code>partial=TRUE</code> a 
model term needs to be selected.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface 
is plotted, but if greater than zero, then 3 surfaces are plotted, one at 
the predicted values minus se standard errors, one at the predicted 
values and one at the predicted values plus se standard errors.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_too.far">too.far</code></td>
<td>
<p>Plot grid nodes that are too far from the points defined by 
the variables given in view can be excluded from the plot. too.far 
determines what is too far. The grid is scaled into the unit square along 
with the view variables and then grid nodes more than too.far from the 
predictor variables are excluded.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_col">col</code></td>
<td>
<p>The colors for the facets of the plot.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_color">color</code></td>
<td>
<p>The color scheme to use for plots. One of 'topo', 'heat', 
'cm', 'terrain', 'gray' or 'bw'.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_contour.col">contour.col</code></td>
<td>
<p>sets the color of contours when using plot.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_ncol">nCol</code></td>
<td>
<p>The number of colors to use in color schemes.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_plotci">plotCI</code></td>
<td>
<p>Logical: whether or not to plot the confidence intervals. 
The value of <code>se</code> determines the size of the CI.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_add.color.legend">add.color.legend</code></td>
<td>
<p>Logical: whether or not to add a color legend. 
Default is TRUE. If FALSE (omitted), one could use the function
<code><a href="plotfunctions.html#topic+gradientLegend">gradientLegend</a></code> to add a legend manually at any position.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_plot.type">plot.type</code></td>
<td>
<p>one of 'contour' or 'persp' (default is 'contour').</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_xlim">xlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the x-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_ylim">ylim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the y-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_zlim">zlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the z-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print a summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_transform">transform</code></td>
<td>
<p>Function for transforming the fitted values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_transform.view">transform.view</code></td>
<td>
<p>List with two functions for transforming 
the values on the x- and y-axis respectively. If one of the axes 
need to be transformed, set the other to NULL (no transformation).
See examples below.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'fitted values'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_dec">dec</code></td>
<td>
<p>Numeric: number of decimals for rounding the color legend. 
When NULL, no rounding (default). If -1, automatically determined.  
Note: if value = -1, rounding will be applied also when 
<code>zlim</code> is provided.</p>
</td></tr>
<tr><td><code id="plot_pca_surface_+3A_...">...</code></td>
<td>
<p>other options to pass on to persp, image or contour. In 
particular ticktype='detailed' will add proper axes labeling to the plots.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jacolien van Rij
data(simdat)
# add hypothetical correlated term:
simdat$predictor &lt;-  (simdat$Trial+10)^.75 + rnorm(nrow(simdat))
# principal components analysis:
pca &lt;- prcomp(simdat[, c('Trial', 'predictor')])
# only first PC term contributes:
summary(pca)
# get rotation (weights of predictors in PC):
pcar &lt;- pca$rotation
# add PC1 to data:
simdat$PC1 &lt;- pca$x[,1]
</p>
<p># model:
m1 &lt;- bam(Y ~ Group + te(Time, PC1, by=Group) 
+ s(Time, Subject, bs='fs', m=1, k=5), data=simdat)
# inspect surface:
fvisgam(m1, view=c('Time', 'PC1'), cond=list(Group='Children'),
rm.ranef=TRUE)
# how does Trial contribute?
plot_pca_surface(m1, pca.term='PC1', weights=pcar[,'PC1'], 
view=c('Time', 'Trial'), cond=list(Group='Children'),rm.ranef=TRUE)
# Note that the range of Trial is estimated based on the values of PC1.
# A better solution is to specify the range:
plot_pca_surface(m1, pca.term='PC1', weights=pcar[,'PC1'], 
view=list(Time=range(simdat$Time), Trial=range(simdat$Trial)), 
cond=list(Group='Children'),rm.ranef=TRUE)
</p>
<p># Partial effects:
pvisgam(m1, view=c('Time', 'PC1'), cond=list(Group='Children'),
select=1, rm.ranef=TRUE)
# PCA:
plot_pca_surface(m1, pca.term='PC1', weights=pcar[,'PC1'], 
partial=TRUE, select=1,
view=list(Time=range(simdat$Time), Trial=range(simdat$Trial)), 
cond=list(Group='Children'))
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fvisgam">fvisgam</a></code>, <code><a href="#topic+pvisgam">pvisgam</a></code>
</p>
<p>Other Functions for PCA interpretation: 
<code><a href="#topic+get_pca_predictions">get_pca_predictions</a>()</code>
</p>

<hr>
<h2 id='plot_smooth'>Visualization of smooths.</h2><span id='topic+plot_smooth'></span>

<h3>Description</h3>

<p>Plots a smooth from a <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code> model based on predictions.
In contrast with the default <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, this function 
plots the summed effects and optionally removes the random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_smooth(
  x,
  view = NULL,
  cond = list(),
  plot_all = NULL,
  rm.ranef = TRUE,
  n.grid = 30,
  rug = NULL,
  add = FALSE,
  se = 1.96,
  sim.ci = FALSE,
  shade = TRUE,
  eegAxis = FALSE,
  col = NULL,
  lwd = NULL,
  lty = NULL,
  print.summary = getOption("itsadug_print"),
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  xlim = NULL,
  ylim = NULL,
  h0 = 0,
  v0 = NULL,
  transform = NULL,
  transform.view = NULL,
  legend_plot_all = NULL,
  hide.label = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_smooth_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_view">view</code></td>
<td>
<p>Text string containing the name of the smooth
to be displayed. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view). Used for choosing between smooths that share the same view 
predictors.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_plot_all">plot_all</code></td>
<td>
<p>A vector with a name / names of model predictors, 
for which all levels should be plotted.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_rug">rug</code></td>
<td>
<p>Logical: when TRUE then the covariate to which the 
plot applies is displayed as a rug plot at the foot of each plot. 
By default set to NULL, which sets rug to TRUE when 
the dataset size is &lt;= 10000 and FALSE otherwise.
Setting to FALSE will speed up plotting for large datasets.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_add">add</code></td>
<td>
<p>Logical: whether or not to add the lines to an existing plot, or 
start a new plot (default).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface is 
plotted, but if greater than zero, then the predicted values plus 
confidence intervals are plotted. 
The value of <code>se</code> will be multiplied with 
the standard error (i.e., 1.96 results in 95%CI and 2.58). 
Default is set to 1.96 (95%CI).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_sim.ci">sim.ci</code></td>
<td>
<p>Logical: Using simultaneous confidence intervals or not 
(default set to FALSE). The implementation of simultaneous CIs follows 
Gavin Simpson's blog of December 15, 2016: 
<a href="https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/">https://fromthebottomoftheheap.net/2016/12/15/simultaneous-interval-revisited/</a>. 
This interval is calculated from simulations based. 
Please specify a seed (e.g., <code>set.seed(123)</code>) for reproducable results. 
Note: in contrast with Gavin Simpson's code, here the Bayesian posterior 
covariance matrix of the parameters is uncertainty corrected 
(<code>unconditional=TRUE</code>) to reflect the uncertainty on the estimation of 
smoothness parameters.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_shade">shade</code></td>
<td>
<p>Logical: Set to TRUE to produce shaded regions as confidence 
bands for smooths (not avaliable for parametric terms, which are plotted 
using termplot).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_eegaxis">eegAxis</code></td>
<td>
<p>Logical: whether or not to reverse the y-axis, plotting the 
negative amplitudes upwards as traditionally is done in EEG research.
If eeg.axes is TRUE, labels for x- and y-axis are provided, when not 
provided by the user. Default value is FALSE.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_col">col</code></td>
<td>
<p>The colors for the lines and the error bars of the plot.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_lwd">lwd</code></td>
<td>
<p>The line width for the lines of the plot.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_lty">lty</code></td>
<td>
<p>The line type for the lines of the plot.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_main">main</code></td>
<td>
<p>Changing the main title for the plot, see also title.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_xlab">xlab</code></td>
<td>
<p>Changing the label for the x axis, 
defaults to a description of x.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_ylab">ylab</code></td>
<td>
<p>Changing the label for the y axis, 
defaults to a description of y.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_xlim">xlim</code></td>
<td>
<p>the x limits of the plot.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_h0">h0</code></td>
<td>
<p>A vector indicating where to add solid horizontal lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_v0">v0</code></td>
<td>
<p>A vector indicating where to add dotted vertical lines for 
reference. By default no values provided.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_transform">transform</code></td>
<td>
<p>Function for transforming the fitted values. 
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_transform.view">transform.view</code></td>
<td>
<p>Function for transforming 
the values on the x-axis. Defaults to NULL (no transformation).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_legend_plot_all">legend_plot_all</code></td>
<td>
<p>Legend location. This could be a keyword from 
the list 'bottomright', 'bottom', 'bottomleft', 'left', 'topleft', 'top', 
'topright', 'right' and 'center', or a list with <code>x</code> and <code>y</code> 
coordinate (e.g., <code>list(x=0,y=0)</code>).</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'fitted values'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_smooth_+3A_...">...</code></td>
<td>
<p>other options to pass on to lines and plot, 
see <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Notes</h3>

<p>This function plots the summed effects, including intercept and other 
predictors. For plotting partial effects, see the function 
<code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, or see the examples with 
<code><a href="#topic+get_modelterm">get_modelterm</a></code> for more flexibility (e.g., plotting using the 
<code>lattice</code> package or <code>ggplots</code>).
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij and Martijn Wieling.
</p>


<h3>See Also</h3>

<p><code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, <code><a href="#topic+plot_diff">plot_diff</a></code>
</p>
<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Model with random effect and interactions:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)

# Default plot produces only surface of Time x Trial:
plot(m1, select=1)
# Only the Time component:
plot_smooth(m1, view='Time')
# Note the summary that is printed.

# without random effects:
plot_smooth(m1, view='Time', rm.ranef=TRUE)

# Plot summed effects:
dev.new(width=8, height=4) # use x11(,8,4) on Linux
par(mfrow=c(1,2))
fvisgam(m1, view=c('Time', 'Trial'), 
    plot.type='contour', color='topo', main='interaction',
    rm.ranef=TRUE)
arrows(x0=0, x1=2200, y0=-5, y1=-5, col='red', 
    code=2, length=.1, lwd=2, xpd=TRUE)
plot_smooth(m1, view='Time', cond=list(Trial=-5),
    main='Trial=-5', rm.ranef=TRUE)


# Model with random effect and interactions:
m2 &lt;- bam(Y ~ Group + s(Time, by=Group)
    +s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)

# Plot all levels of a predictor:
plot_smooth(m2, view='Time', plot_all='Group',
    rm.ranef=TRUE)
# It also possible to combine predictors in plot_all.
# Note: this is not a meaningfull plot, because Subjects
# fall in only one group. Just for illustration purposes!
plot_smooth(m2, view='Time', plot_all=c('Group', 'Subject'))
# Clearly visible difference in confidence interval, because  
# a01 does not occur in Group 'Children':
# (Note that this plot generates warning)
plot_smooth(m2, view='Time', plot_all=c('Group', 'Subject'), cond=list(Subject='a01'))

# Using sim.ci: simultaneous CI instead of pointwise CI
dev.new(width=8, height=4) # use x11(,8,4) on Linux
par(mfrow=c(1,2))
plot_smooth(m2, view='Time', plot_all='Group', rm.ranef=TRUE)
plot_smooth(m2, view='Time', rm.ranef=TRUE, plot_all='Group', sim.ci=TRUE, 
    add=TRUE, shade=FALSE, xpd=TRUE)
plot_smooth(m2, view='Time', rm.ranef=TRUE, sim.ci=TRUE, col='red')



# Using transform
# Plot log-transformed dependent predictor on original scale:
plot_smooth(m1, view='Time', rm.ranef=TRUE, transform=exp)

# Notes on transform.view: 
# This will generate an error, because x-values &lt;= 0 will result in NaN:
plot_smooth(m1, view='Time', rm.ranef=TRUE, transform.view=log)
# adjusting the x-axis helps:
plot_smooth(m1, view='Time', rm.ranef=TRUE, transform.view=log,
   xlim=c(1,2000))


## End(Not run)

# and for a quick overview of plotfunctions:
vignette('overview', package='itsadug')

</code></pre>

<hr>
<h2 id='plot_topo'>Visualization of EEG topo maps.</h2><span id='topic+plot_topo'></span>

<h3>Description</h3>

<p>Visualization of EEG topo maps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_topo(
  model,
  view,
  el.pos = NULL,
  fun = "fvisgam",
  add.color.legend = TRUE,
  size = 5,
  n.grid = 100,
  col = 1,
  pch = 21,
  bg = alpha(1),
  color = "bwr",
  xlab = "",
  ylab = "",
  setmargins = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_topo_+3A_model">model</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_view">view</code></td>
<td>
<p>A two-value vector containing the names of the two main effect 
terms to be displayed on the x and y dimensions of the plot. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_el.pos">el.pos</code></td>
<td>
<p>A list with X and Y positions and Electrodes, which are used
for fitting the model.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_fun">fun</code></td>
<td>
<p>Text string, 'fvisgam', 'pvisgam', or 'plot_diff2' signalling 
which function to use for plotting.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_add.color.legend">add.color.legend</code></td>
<td>
<p>Logical: whether or not to add a color legend. 
Default is TRUE. If FALSE (omitted), one could use the function
<code><a href="plotfunctions.html#topic+gradientLegend">gradientLegend</a></code> to add a legend manually at any position.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_size">size</code></td>
<td>
<p>Size in inch of plot window.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_col">col</code></td>
<td>
<p>The colors for the background of the plot.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_pch">pch</code></td>
<td>
<p>The type of points as indications for the electrode positions. 
The value NA will suppress the plotting of electrode positions.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_bg">bg</code></td>
<td>
<p>The background color of the points.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_color">color</code></td>
<td>
<p>The color scheme to use for plots. One of 'topo', 'heat', 
'cm', 'terrain', 'gray', 'bw', or 'rwb' (red-white-blue; default).</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_xlab">xlab</code></td>
<td>
<p>Label x-axis. Default excluded.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_ylab">ylab</code></td>
<td>
<p>Label y-axis. Default excluded.</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_setmargins">setmargins</code></td>
<td>
<p>Logical: whether or not to automatically set the margins. 
By default set to TRUE. If set to false, the size can</p>
</td></tr>
<tr><td><code id="plot_topo_+3A_...">...</code></td>
<td>
<p>other options to pass on to <code><a href="#topic+fvisgam">fvisgam</a></code>,
<code><a href="#topic+pvisgam">pvisgam</a></code>, or <code><a href="#topic+plot_diff2">plot_diff2</a></code>.</p>
</td></tr>
</table>


<h3>Notes</h3>

<p>X-positions of electrodes should have lower values for electrodes on the
left hemisphere (e.g. T7) than for electrodes on the right 
hemisphere.
Y-positions of electrodes should have lower values for electrodes at the 
back of the head than for the frontal electrodes.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+pvisgam">pvisgam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(eeg)

## Not run: 
# simple GAMM model:
m1 &lt;- gam(Ampl ~ te(Time, X, Y, k=c(10,5,5), 
    d=c(1,2)), data=eeg)

# topo plot, by default uses fvisgam 
# and automatically selects a timestamp (270ms):
plot_topo(m1, view=c('X', 'Y'))
# or:
plot_topo(m1, view=c('X', 'Y'), setmargins=FALSE, size=1)

# add electrodes:
electrodes &lt;- eeg[,c('X','Y','Electrode')]
electrodes &lt;- as.list( electrodes[!duplicated(electrodes),] )
plot_topo(m1, view=c('X', 'Y'), el.pos=electrodes)

# some formatting options:
plot_topo(m1, view=c('X', 'Y'), el.pos=electrodes,
    main='Topo plot', zlim=c(-.5,.5), 
    pch=15, col='red', color='terrain')

# plotting more than one panel only works if 
# each figure region is a square:
dev.new(width=12, height=4) 
par(mfrow=c(1,3))

for(i in c(100, 200, 300)){
    # make sure to keep zlim constant:
\t   plot_topo(m1, view=c('X', 'Y'), zlim=c(-.5, .5), 
    cond=list(Time=i), el.pos=electrodes,
    main=i)
}

dev.new(width=12, height=4) 
par(mfrow=c(1,3), cex=1.1)
# The three different functions for plotting:
plot_topo(m1, view=c('X', 'Y'), zlim=c(-.5, .5), 
    el.pos=electrodes,
    fun='fvisgam', main='fvisgam', 
    cond=list(Time=200), rm.ranef=TRUE)
plot_topo(m1, view=c('X', 'Y'), zlim=c(-.5, .5), 
    el.pos=electrodes, select=1,
    fun='pvisgam', main='pvisgam', 
    cond=list(Time=200))
plot_topo(m1, view=c('X', 'Y'), zlim=c(-.5, .5), 
    el.pos=electrodes, comp=list(Time=c(300,100)),
    fun='plot_diff2', main='plot_diff2', 
    plotCI=TRUE)

# Add labels:
plot_topo(m1, view=c('X', 'Y'), zlim=c(-.5, .5), 
    fun='fvisgam', main='', 
    cond=list(Time=200), add.color.legend=FALSE)
text(electrodes[['X']], electrodes[['Y']], 
    labels=electrodes[['Electrode']], cex=.75, 
    xpd=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='print_summary'>Print a named list of strings, output from <code><a href="#topic+summary_data">summary_data</a></code>.</h2><span id='topic+print_summary'></span>

<h3>Description</h3>

<p>Print a named list of strings, output from <code><a href="#topic+summary_data">summary_data</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_summary(sumlist, title = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_summary_+3A_sumlist">sumlist</code></td>
<td>
<p>Named list, output of <code><a href="#topic+summary_data">summary_data</a></code>.</p>
</td></tr>
<tr><td><code id="print_summary_+3A_title">title</code></td>
<td>
<p>Optional, text string that will be printed as title.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>

<hr>
<h2 id='pvisgam'>Visualization of partial nonlinear interactions.</h2><span id='topic+pvisgam'></span>

<h3>Description</h3>

<p>Produces perspective or contour plot views of gam model 
predictions of the partial effects interactions. Combines the function 
<code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code> for interaction surfaces with the function 
<code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>. Similar to <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, 
<code>pvisgam</code> plots the partial interaction surface, without including 
values for other predictors that are not being shown. Similar to 
<code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code> the user can set the two predictors to be 
viewed, and colors are added behind the contours to facilitate 
interpretation. In contrast to <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>, this function 
allows to plotting of interactions with three of more continuous predictors 
by breaking it down in two-dimensional surfaces.
The code is derivated from the script for <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pvisgam(
  x,
  view = NULL,
  select = NULL,
  cond = list(),
  n.grid = 30,
  too.far = 0,
  col = NA,
  color = "terrain",
  contour.col = NULL,
  add.color.legend = TRUE,
  se = 0,
  plot.type = "contour",
  zlim = NULL,
  xlim = NULL,
  ylim = NULL,
  nCol = 50,
  labcex = 0.6,
  hide.label = FALSE,
  print.summary = getOption("itsadug_print"),
  show.diff = FALSE,
  col.diff = 1,
  alpha.diff = 0.5,
  dec = NULL,
  f = 1.96,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pvisgam_+3A_x">x</code></td>
<td>
<p>A gam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_view">view</code></td>
<td>
<p>A two-value vector containing the names of the two main effect 
terms to be displayed on the x and y dimensions of the plot. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_select">select</code></td>
<td>
<p>A number, selecting a single model term for printing. e.g. 
if you want the plot for the second smooth term set select=2.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view). Used for choosing between smooths that share the same view 
predictors.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_n.grid">n.grid</code></td>
<td>
<p>The number of grid nodes in each direction used for 
calculating the plotted surface.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_too.far">too.far</code></td>
<td>
<p>Plot grid nodes that are too far from the points defined by 
the variables given in view can be excluded from the plot. too.far 
determines what is too far. The grid is scaled into the unit square along 
with the view variables and then grid nodes more than too.far from the 
predictor variables are excluded.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_col">col</code></td>
<td>
<p>The colors for the facets of the plot.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_color">color</code></td>
<td>
<p>The color scheme to use for plots. One of 'topo', 'heat', 
'cm', 'terrain', 'gray' or 'bw'. Alternatively a vector with some colors 
can be provided for a custom color palette (see examples).</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_contour.col">contour.col</code></td>
<td>
<p>sets the color of contours when using plot.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_add.color.legend">add.color.legend</code></td>
<td>
<p>Logical: whether or not to add a color legend. 
Default is TRUE. If FALSE (omitted), one could use the function
<code><a href="plotfunctions.html#topic+gradientLegend">gradientLegend</a></code> to add a legend manually at any position.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_se">se</code></td>
<td>
<p>If less than or equal to zero then only the predicted surface is 
plotted, but if greater than zero, then 3 surfaces are plotted, one at the 
predicted values minus se standard errors, one at the predicted values and 
one at the predicted values plus se standard errors.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_plot.type">plot.type</code></td>
<td>
<p>one of 'contour' or 'persp' (default is 'contour').</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_zlim">zlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the z-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_xlim">xlim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the x-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_ylim">ylim</code></td>
<td>
<p>A two item array giving the lower and upper limits for the y-
axis scale. NULL to choose automatically.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_ncol">nCol</code></td>
<td>
<p>The number of colors to use in color schemes.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_labcex">labcex</code></td>
<td>
<p>Size of the contour labels.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_hide.label">hide.label</code></td>
<td>
<p>Logical: whether or not to hide the label 
(i.e., 'partial effect'). Default is FALSE.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print summary.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_show.diff">show.diff</code></td>
<td>
<p>Logical: whether or not to indicate the regions that 
are significantly different from zero. Note that these regions are just 
an indication and dependent on the value of <code>n.grid</code>. 
Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_col.diff">col.diff</code></td>
<td>
<p>Color to shade the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_alpha.diff">alpha.diff</code></td>
<td>
<p>Level of transparency to mark the nonsignificant areas.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_dec">dec</code></td>
<td>
<p>Numeric: number of decimals for rounding the color legend. 
When NULL (default), no rounding. If -1 the values are automatically determined. 
Note: if value = -1 (default), rounding will be applied also when 
<code>zlim</code> is provided.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_f">f</code></td>
<td>
<p>Scaling factor to determine the CI from the se, for marking the 
difference with 0. Only applies when <code>se</code> is smaller or equal to zero 
and <code>show.diff</code> is set to TRUE.</p>
</td></tr>
<tr><td><code id="pvisgam_+3A_...">...</code></td>
<td>
<p>other options to pass on to persp, image or contour. In 
particular ticktype='detailed' will add proper axes labeling to the plots.</p>
</td></tr>
</table>


<h3>Warnings</h3>


<ul>
<li><p> In contrast to vis.gam, do not specify other predictors in <code>cond</code> that 
are not to be plotted.
</p>
</li>
<li><p> When the argument <code>show.diff</code> is set to TRUE a shading area indicates 
where the confidence intervals include zero. Or, in other words, the areas 
that are not significantly different from zero. Be careful with the 
interpretation, however, as the precise shape of the surface is dependent 
on model constraints such as the value of <code><a href="mgcv.html#topic+choose.k">choose.k</a></code> and the 
smooth function used, and the size of the confidence intervals are 
dependent on the model fit and model characteristics 
(see <code>vignette('acf', package='itsadug')</code>). In addition, the value of 
<code>n.grid</code> determines the precision of the plot.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jacolien van Rij. Modification of <code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code> from 
package <code><a href="mgcv.html#topic+mgcv">mgcv</a></code> of Simon N. Wood.
</p>


<h3>See Also</h3>

<p><code><a href="mgcv.html#topic+vis.gam">vis.gam</a></code>, <code><a href="mgcv.html#topic+plot.gam">plot.gam</a></code>
</p>
<p>Other Functions for model inspection: 
<code><a href="#topic+dispersion">dispersion</a>()</code>,
<code><a href="#topic+fvisgam">fvisgam</a>()</code>,
<code><a href="#topic+gamtabs">gamtabs</a>()</code>,
<code><a href="#topic+inspect_random">inspect_random</a>()</code>,
<code><a href="#topic+plot_data">plot_data</a>()</code>,
<code><a href="#topic+plot_parametric">plot_parametric</a>()</code>,
<code><a href="#topic+plot_smooth">plot_smooth</a>()</code>,
<code><a href="#topic+plot_topo">plot_topo</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Model with random effect and interactions:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)

# Plot summed effects:
vis.gam(m1, view=c('Time', 'Trial'), plot.type='contour', color='topo')
# Partial effect of interaction:
pvisgam(m1, view=c('Time', 'Trial'), select=1)
# Same:
plot(m1, select=1, scheme=2)
plot(m1, select=1)
# Alternatives:
pvisgam(m1, view=c('Trial', 'Time'), select=1)
pvisgam(m1, view=c('Trial', 'Time'), select=1, zlim=c(-20,20))
pvisgam(m1, view=c('Trial', 'Time'), select=1, zlim=c(-20,20), 
    color='terrain')
pvisgam(m1, view=c('Trial', 'Time'), select=1, zlim=c(-20,20), 
    color=c('blue', 'white', 'red'))

# Notes on the color legend:
# Labels can easily fall off the plot, therefore the numbers are 
# automatically rounded.
# To undo the rounding, set dec=NULL:
pvisgam(m1, view=c('Time', 'Trial'), dec=NULL)
# For custom rounding, set dec to a value:
pvisgam(m1, view=c('Time', 'Trial'), dec=1)
# To increase the left marging of the plot (so that the numbers fit):
oldmar &lt;- par()$mar
par(mar=oldmar + c(0,0,0,1) ) # add one line to the right
pvisgam(m1, view=c('Time', 'Trial'), dec=3)
par(mar=oldmar) # restore to default settings

# too.far: 
n &lt;- which(simdat$Time &gt; 1500 &amp; simdat$Trial &gt; 5)
simdat[n,]$Y &lt;- NA
simdat[simdat$Trial == -3,]$Y &lt;- NA
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Time, Subject, bs='fs', m=1),
    data=simdat, discrete=TRUE)
pvisgam(m1, view=c('Time', 'Trial'), select=1, too.far=0.03)


## End(Not run)
# see the vignette for examples:
vignette('overview', package='itsadug')
</code></pre>

<hr>
<h2 id='refLevels'>Return a list with reference levels for each factor.</h2><span id='topic+refLevels'></span>

<h3>Description</h3>

<p>Function for retrieving all reference levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refLevels(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refLevels_+3A_data">data</code></td>
<td>
<p>Data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with reference levels for each factor.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>

<hr>
<h2 id='report_stats'>Returns a description of the statistics of the smooth terms for reporting.</h2><span id='topic+report_stats'></span>

<h3>Description</h3>

<p>Returns a description of the statistics of the smooth terms 
for reporting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_stats(model, summary = NULL, print.summary = getOption("itsadug_print"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="report_stats_+3A_model">model</code></td>
<td>
<p>A gam or bam object, produced by <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="report_stats_+3A_summary">summary</code></td>
<td>
<p>Optionally include the summary of the model when available, which may speed up the process for large models.</p>
</td></tr>
<tr><td><code id="report_stats_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print the output.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Testing for significance: 
<code><a href="#topic+compareML">compareML</a>()</code>,
<code><a href="#topic+plot_diff2">plot_diff2</a>()</code>,
<code><a href="#topic+plot_diff">plot_diff</a>()</code>,
<code><a href="#topic+wald_gam">wald_gam</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# model without random effects:
m1 &lt;- bam(Y ~ te(Time, Trial), data=simdat)
report_stats(m1)
# save report for later use:
report &lt;- report_stats(m1, print.summary=FALSE)
report[3,2]

</code></pre>

<hr>
<h2 id='res_df'>Retrieve the residual degrees of freedom from the model.</h2><span id='topic+res_df'></span>

<h3>Description</h3>

<p>Retrieve the residual degrees of freedom from the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>res_df(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="res_df_+3A_model">model</code></td>
<td>
<p>A fitted regression model (using gam, or bam).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value: residual degrees of freedom from the model.
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# Fit simple GAM model:
gam1 &lt;- bam(Y ~ s(Time), data=simdat, discrete=TRUE)
res_df(gam1)
# ... which is the same as:

modeledf(gam1)

</code></pre>

<hr>
<h2 id='resid_gam'>Extract model residuals and remove the autocorrelation accounted for.</h2><span id='topic+resid_gam'></span><span id='topic+resid.gam'></span>

<h3>Description</h3>

<p>Extract model residuals and remove the autocorrelation accounted for.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_gam(model, AR_start = NULL, incl_na = FALSE, return_all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_gam_+3A_model">model</code></td>
<td>
<p>A GAMM model build with <code><a href="mgcv.html#topic+gam">gam</a></code> or 
<code><a href="mgcv.html#topic+bam">bam</a></code>.</p>
</td></tr>
<tr><td><code id="resid_gam_+3A_ar_start">AR_start</code></td>
<td>
<p>Optional: vector with logicals, indicating the start of 
events. 
Default is NULL, because generally the function can retrieve all necessary 
information from the model.</p>
</td></tr>
<tr><td><code id="resid_gam_+3A_incl_na">incl_na</code></td>
<td>
<p>Whether or not to include missing values (NA)when returning 
the residuals. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="resid_gam_+3A_return_all">return_all</code></td>
<td>
<p>Default is FALSE. Returns a list with normal residuals, 
corrected residuals, and the value of rho.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected residuals.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+resid">resid</a></code>, <code><a href="#topic+missing_est">missing_est</a></code>
</p>
<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

## Not run: 
# Add start event column:
simdat &lt;- start_event(simdat, event=c('Subject', 'Trial'))
head(simdat)
# bam model with AR1 model (toy example, not serious model):
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), 
   data=simdat, rho=.5, AR.start=simdat$start.event)
# Standard residuals:
res1 &lt;- resid(m1)
# Corrected residuals:
res2 &lt;- resid_gam(m1)

# Result in different ACF's:
par(mfrow=c(1,2))
acf(res1)
acf(res2)

# Without AR.start included in the model:
m2 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), 
   data=simdat)
acf(resid_gam(m2), plot=F)
# Same as resid(m2)!
acf(resid(m2), plot=F)

### MISSING VALUES ###
# Note that corrected residuals cannot be calculated for the last 
# point of each time series. These missing values are by default
# excluded.

# Therefore, this will result in an error...
simdat$res &lt;- resid_gam(m1)
# ... and this will give an error too:
simdat$res &lt;- NA
simdat[!is.na(simdat$Y),] &lt;- resid_gam(m1)
# ... but this works:
simdat$res &lt;- resid_gam(m1, incl_na=TRUE)

# The parameter incl_na will NOT add missing values
# for missing values in the *data*. 
# Example:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA
# Without AR.start included in the model:
m2 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), 
   data=simdat)
# This works:
acf(resid_gam(m2))
# ...but this results in error, although no AR1 model specified:
simdat$res &lt;- resid_gam(m2)
# ... for this type of missing data, this does not solve the problem:
simdat$res &lt;- resid_gam(m2, incl_na=TRUE)
# instead try this:
simdat$res &lt;- NA
simdat[-missing_est(m2),]$res &lt;- resid_gam(m2)

# With AR.start included in the model:
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), 
   data=simdat, rho=.5, AR.start=simdat$start.event)
# This works (incl_na=TRUE):
simdat$res &lt;- NA
simdat[-missing_est(m2),]$res &lt;- resid_gam(m2, incl_na=TRUE)


## End(Not run)
</code></pre>

<hr>
<h2 id='rug_model'>Add rug to plot, based on model.</h2><span id='topic+rug_model'></span>

<h3>Description</h3>

<p>Add rug based on model data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rug_model(
  model,
  view,
  cond = NULL,
  data.rows = NULL,
  rm.ranef = NULL,
  print.summary = getOption("itsadug_print"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rug_model_+3A_model">model</code></td>
<td>
<p>gam or bam object.</p>
</td></tr>
<tr><td><code id="rug_model_+3A_view">view</code></td>
<td>
<p>Text string containing the name of the smooth
to be displayed. Note that 
variables coerced to factors in the model formula won't work as view 
variables.</p>
</td></tr>
<tr><td><code id="rug_model_+3A_cond">cond</code></td>
<td>
<p>A named list of the values to use for the other predictor terms 
(not in view). Used for choosing between smooths that share the same view 
predictors.</p>
</td></tr>
<tr><td><code id="rug_model_+3A_data.rows">data.rows</code></td>
<td>
<p>Vector of numbers (indices of rows in data) or vector of 
logical vales (same length as rows in data) for selecting specific data 
points.</p>
</td></tr>
<tr><td><code id="rug_model_+3A_rm.ranef">rm.ranef</code></td>
<td>
<p>Logical: whether or not to remove random effects. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="rug_model_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical: whether or not to print information messages.
Default set to the print info messages option 
(see <code><a href="#topic+infoMessages">infoMessages</a></code>).</p>
</td></tr>
<tr><td><code id="rug_model_+3A_...">...</code></td>
<td>
<p>Optional graphical parameters (see <code><a href="graphics.html#topic+rug">rug</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Functions for plotting: 
<code><a href="#topic+fadeRug">fadeRug</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(cars$speed, cars$dist, pch=16, col=alpha(1))
lm1 &lt;- lm(dist ~ speed, dat=cars)
abline(lm1, col='red', lwd=2)
rug_model(lm1, view='speed')
rug_model(lm1, view='dist', side=2)

## Not run: 
library(itsadug)
data(simdat)
m1 &lt;- bam(Y ~ Group + te(Time, Trial, by=Group), data=simdat)
# plot:
fvisgam(m1, view=c('Time', 'Trial'), cond=list(Group='Adults'))
rug_model(m1, view='Time', cond=list(Group='Adults'))
rug_model(m1, view='Trial', cond=list(Group='Adults'), side=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='simdat'>Simulated time series data.</h2><span id='topic+simdat'></span>

<h3>Description</h3>

<p>A dataset containing the sine wave data with random noise added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdat
</code></pre>


<h3>Format</h3>

<p>A data frame with 75600 rows and 6 variables:
</p>

<dl>
<dt><code>Group</code></dt><dd><p>Age group of participants: Adults or Children.</p>
</dd>
<dt><code>Time</code></dt><dd><p>Time, time measure from start of each time series.</p>
</dd>
<dt><code>Trial</code></dt><dd><p>Trial in the experiment, centered around zero.</p>
</dd>
<dt><code>Condition</code></dt><dd><p>Continuous variable, ranging from -1 to 4. 
For example, stimulus onset asynchrony.</p>
</dd>
<dt><code>Subject</code></dt><dd><p>Code for individual participants.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Time series measure. 
Similar to pupil size, sensor position, or voltage.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>

<hr>
<h2 id='start_event'>Determine the starting point for each time series.</h2><span id='topic+start_event'></span>

<h3>Description</h3>

<p>Determine the starting point for each time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>start_event(
  data,
  column = "Time",
  event = "Event",
  label = "start.event",
  label.event = NULL,
  order = TRUE,
  newcode = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="start_event_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="start_event_+3A_column">column</code></td>
<td>
<p>Test string, name of the column that describes the order 
withing the time series. Default is 'Time'.</p>
</td></tr>
<tr><td><code id="start_event_+3A_event">event</code></td>
<td>
<p>A text string or vector indicating the columns that define the 
unique time series. Default is 'Event'.</p>
</td></tr>
<tr><td><code id="start_event_+3A_label">label</code></td>
<td>
<p>The name of the new column with the start point of each time 
series. Default is 'start.event'.</p>
</td></tr>
<tr><td><code id="start_event_+3A_label.event">label.event</code></td>
<td>
<p>In case <code>event</code> is not a single column, providing a 
text string will add a column with this name that defines unique time 
series. Default is NULL (no new column for time series is created).</p>
</td></tr>
<tr><td><code id="start_event_+3A_order">order</code></td>
<td>
<p>Logical: whether or not to order each time series. 
Default is TRUE, maybe set to FALSE with large data frames that are already ordered.</p>
</td></tr>
<tr><td><code id="start_event_+3A_newcode">newcode</code></td>
<td>
<p>Logical: whether or not to use the new (and hopefully faster) code.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame.
</p>


<h3>Note</h3>

<p>When working with large data frames, it may be worth installing the package 
<code>data.table</code>. Although not required for the package, the function 
<code>start_event</code> will check if <code>data.table</code> is available and will 
use it's much faster function <code>rbindlist</code>. This speeds up the function 
<code>start_event</code>. Run the command 
<code>install.packages('data.table', repos='http://cran.us.r-project.org')</code> 
in the command window for installing the package <code>data.table</code>.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_value_rho">start_value_rho</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
head(simdat)
simdat &lt;- simdat[sample(1:nrow(simdat)),]
simdat$Condition &lt;- relevel(factor(simdat$Condition), ref="0")
contrasts(simdat$Condition) &lt;- "contr.poly"
contrasts(simdat$Condition)
test &lt;- start_event(simdat, event=c('Subject', 'Trial'), label.event='Event') 
contrasts(test$Condition)
head(test)
test &lt;- start_event(simdat, event="Subject")
test &lt;- start_event(simdat, event=c('Subject', 'Trial'))
</code></pre>

<hr>
<h2 id='start_value_rho'>Extract the Lag 1 value from the ACF of the residuals of a gam, bam, lm, 
lmer model, ...</h2><span id='topic+start_value_rho'></span>

<h3>Description</h3>

<p>Wrapper around <code><a href="#topic+acf_plot">acf_plot</a></code> for regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>start_value_rho(model, plot = FALSE, lag = 2, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="start_value_rho_+3A_model">model</code></td>
<td>
<p>A regression model generated by <code>lm</code>, <code>glm</code>,
<code>lmer</code>, <code>glmer</code>, <code><a href="mgcv.html#topic+gam">gam</a></code>, 
or <code><a href="mgcv.html#topic+bam">bam</a></code>.
(See examples for how to avoid errors due to missing values.)</p>
</td></tr>
<tr><td><code id="start_value_rho_+3A_plot">plot</code></td>
<td>
<p>Logical: whether or not to produce plot. Default is TRUE.</p>
</td></tr>
<tr><td><code id="start_value_rho_+3A_lag">lag</code></td>
<td>
<p>Numeric value, indicating the lag. Default is 2.</p>
</td></tr>
<tr><td><code id="start_value_rho_+3A_main">main</code></td>
<td>
<p>Text string, title of ACF plot.</p>
</td></tr>
<tr><td><code id="start_value_rho_+3A_...">...</code></td>
<td>
<p>Other arguments for plotting the acf, see 
<code><a href="stats.html#topic+acf">acf</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The autocorrelation value of data points with the data points 
at lag <code>lag</code>.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Use <code><a href="stats.html#topic+acf">acf</a></code> for the original ACF function, 
and <code><a href="#topic+acf_plot">acf_plot</a></code>, or <code><a href="#topic+acf_resid">acf_resid</a></code>.
</p>
<p>Other functions for model criticism: 
<code><a href="#topic+acf_n_plots">acf_n_plots</a>()</code>,
<code><a href="#topic+acf_plot">acf_plot</a>()</code>,
<code><a href="#topic+acf_resid">acf_resid</a>()</code>,
<code><a href="#topic+derive_timeseries">derive_timeseries</a>()</code>,
<code><a href="#topic+resid_gam">resid_gam</a>()</code>,
<code><a href="#topic+start_event">start_event</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)

# add missing values to simdat:
simdat[sample(nrow(simdat), 15),]$Y &lt;- NA

## Not run: 
# Run GAMM model:
m1 &lt;- bam(Y ~ te(Time, Trial)+s(Subject, bs='re'), data=simdat)

# No plotting:
start_value_rho(m1)
# With plot:
rhom1 &lt;- start_value_rho(m1, plot=TRUE)


## End(Not run)
# see the vignette for examples:
vignette('acf', package='itsadug')
</code></pre>

<hr>
<h2 id='summary_data'>Print a descriptive summary of a data frame.</h2><span id='topic+summary_data'></span>

<h3>Description</h3>

<p>The function prints a summary of the data. 
Similar to the function <code><a href="utils.html#topic+str">str</a></code>, but easier readable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_data(data, print = TRUE, n = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_data_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="summary_data_+3A_print">print</code></td>
<td>
<p>Logical: whether or not to print the summary.</p>
</td></tr>
<tr><td><code id="summary_data_+3A_n">n</code></td>
<td>
<p>Number: maximum number of values being mentioned in the summary.
If NULL all values are being mentioned. Defaults to 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optionally returns a named list with info.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+timeBins">timeBins</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
summary_data(simdat)
</code></pre>

<hr>
<h2 id='timeBins'>Label timestamps as timebins of a given binsize.</h2><span id='topic+timeBins'></span>

<h3>Description</h3>

<p>Function for calculating timebins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeBins(x, binsize, pos = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timeBins_+3A_x">x</code></td>
<td>
<p>Numerical vector with timestamp information.</p>
</td></tr>
<tr><td><code id="timeBins_+3A_binsize">binsize</code></td>
<td>
<p>Size of the timebin, measured in the same units (often ms) 
as <code>x</code>.</p>
</td></tr>
<tr><td><code id="timeBins_+3A_pos">pos</code></td>
<td>
<p>Numerical value that determines the label of the binsize 
as proportion of the binsize. A value of 0 will provide the minimum 
timestamp within the bin as label, a value of 1 will provide the maximum 
value within the bin as label. Defaults to 0.5, the center of the bin.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Anumerical vector of the same size as <code>x</code> with timebin 
information.
</p>


<h3>Author(s)</h3>

<p>Jacolien van Rij
</p>


<h3>See Also</h3>

<p>Other Utility functions: 
<code><a href="#topic+convertNonAlphanumeric">convertNonAlphanumeric</a>()</code>,
<code><a href="#topic+corfit">corfit</a>()</code>,
<code><a href="#topic+diff_terms">diff_terms</a>()</code>,
<code><a href="#topic+find_difference">find_difference</a>()</code>,
<code><a href="#topic+missing_est">missing_est</a>()</code>,
<code><a href="#topic+modeledf">modeledf</a>()</code>,
<code><a href="#topic+observations">observations</a>()</code>,
<code><a href="#topic+print_summary">print_summary</a>()</code>,
<code><a href="#topic+refLevels">refLevels</a>()</code>,
<code><a href="#topic+res_df">res_df</a>()</code>,
<code><a href="#topic+summary_data">summary_data</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
# grouping Time values in bins:
simdat$Timebin &lt;- timeBins(simdat$Time, 200)
head(simdat)

# different labels:
simdat$Timebin2 &lt;- timeBins(simdat$Time, 200, pos=0)
head(simdat)
</code></pre>

<hr>
<h2 id='wald_gam'>Function for post-hoc comparison of the contrasts in a single GAMM model.</h2><span id='topic+wald_gam'></span>

<h3>Description</h3>

<p>Function for post-hoc comparison of the intercept differences 
for different factors in a single GAMM model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wald_gam(
  model,
  comp = NULL,
  select = NULL,
  t.test = FALSE,
  null.hypothesis = 0,
  summ = NULL,
  signif.stars = TRUE,
  print.output = getOption("itsadug_print")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wald_gam_+3A_model">model</code></td>
<td>
<p>Model, currently only implemented for models generated with 
<code><a href="mgcv.html#topic+bam">bam</a></code> or <code><a href="mgcv.html#topic+gam">gam</a></code>.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_comp">comp</code></td>
<td>
<p>Named list with predictors (specified as names) and their levels
to compare. Defaults to NULL, which returns all comparisons, 
unless <code>select</code> is specified.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_select">select</code></td>
<td>
<p>Contrast matrix for manually specified contrasts. 
Alternatively, a vector or list could be provided as input. 
See examples below.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_t.test">t.test</code></td>
<td>
<p>Logical default = FALSE), whether or not to return 
the t-test scores instead of the Wald test. Only implemented for 
Gaussian models.  This option is not implemented for use with <code>select</code>.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_null.hypothesis">null.hypothesis</code></td>
<td>
<p>Numeric, value of null hypothesis. Defaults to 0 and 
is generally not changed.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_summ">summ</code></td>
<td>
<p>Optional summary object. Defaults to NULL. For very large GAMM 
models it takes a long time to retrieve the summary. In these cases the 
summary could be provided to reduce processing time. 
However, it is generally recommended not to specifify a summary object, 
to reduce the chance of mismatch errors.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Logical (default = TRUE). Whether or not to display 
stars indicating the level of significance on 95% confidence level.</p>
</td></tr>
<tr><td><code id="wald_gam_+3A_print.output">print.output</code></td>
<td>
<p>Logical: whether or not to print the output. 
By default controlled globally in the package options:  
If the function <code><a href="#topic+infoMessages">infoMessages</a></code> is set to TRUE, the output 
will be automatically printed.
Could be also set by explicitly providing TRUE or FALSE. See examples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optionally returns a data frame with test statistics.
</p>


<h3>Warning</h3>

<p>This function is intended for testing intercept differences only.
This function compares purely the parametric components, without 
considering any interactions with smooth terms. So this could be 
considered as a partial effect comparison. For comparing the averages 
of conditions use <code><a href="#topic+get_difference">get_difference</a></code>, which outputs the 
difference in summed effects for different factor levels.
</p>


<h3>Author(s)</h3>

<p>Petar Milin and Jacolien van Rij.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_parametric">plot_parametric</a></code>, <code><a href="#topic+plot_diff">plot_diff</a></code>, 
<code><a href="#topic+plot_diff2">plot_diff2</a></code>
</p>
<p>Other Testing for significance: 
<code><a href="#topic+compareML">compareML</a>()</code>,
<code><a href="#topic+plot_diff2">plot_diff2</a>()</code>,
<code><a href="#topic+plot_diff">plot_diff</a>()</code>,
<code><a href="#topic+report_stats">report_stats</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdat)
# Convert Condition to factorial predictor for illustration purposes:
simdat$Condition &lt;- as.factor(simdat$Condition)

infoMessages('on')

## Not run: 
# some arbitrary model:
m1 &lt;- bam(Y ~ Condition*Group  
\t+ s(Time, by=Condition) 
\t+ s(Time, by=Group)
\t+ s(Subject, bs='re'), 
\tdata=simdat)

# print summary to inspect parametric terms:
summary(m1)

# return all contrasts:
wald_gam(m1)

# USE OF COMP
# return only contrasts for Adults:
wald_gam(m1, comp=list(Condition=levels(simdat$Condition)))
# return specific contrasts:
wald_gam(m1, comp=list(Condition=c('-1', '0', '1'), 
    Group=c('Adults', 'Children')))

# USE OF SELECT
# Specify contrast matrix. 
# Note that intercept should be 0.
# Example: Compare Condition 0 with Conditions 2 and 3 for children.
# Method 1: matrix or vector:
R = matrix( c(0,-2,0,1,1,0,0,0,0,0,0,0), nrow=1)
wald_gam(m1, select=R) 
wald_gam(m1, select=c(0,-2,0,1,1,0,0,0,0,0,0,0)) 
# Method 2: list
# first list element are reference coefficients, 
# second list element are coefficients to compare
wald_gam(m1, select=list(2, c(4,5))) 
# Replication of contrasts given in summary:
wald_gam(m1, select=c(0,1,0,0,0,0,0,0,0,0,0,0))

# USE OF T.TEST
# This option is not implemented for use with select
# Compare with second line of parametric summary:
wald_gam(m1, comp=list(Condition=c('-1', '0'), 
    Group='Children'), t.test=TRUE)
# Compare with Wald test:
wald_gam(m1, comp=list(Condition=c('-1', '0'), 
    Group='Children'))

# exclude significance stars:
wald_gam(m1, comp=list(Condition=c('-1', '0'), 
    Group='Children'), signif.stars=FALSE)

# do not print output, but save table for later use:
test &lt;- wald_gam(m1, comp=list(Condition=c('-1', '0'), 
    Group='Children'), print.output=FALSE)
test
# alternative way:
infoMessages('off')
test2 &lt;- wald_gam(m1, comp=list(Condition=c('-1', '0'), 
    Group='Children'))
infoMessages('on')


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
