<!DOCTYPE html><html><head><title>Help for package GCCfactor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GCCfactor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AsymCI_local_loading'><p>Get an asymptotic confidence interval for the local component</p></a></li>
<li><a href='#Bartlett'><p>Bartlett kernel function</p></a></li>
<li><a href='#BS_global_comp'><p>Get a bootstrap confidence interval for the global component</p></a></li>
<li><a href='#BS_global_factor'><p>Get bootstrap confidence intervals for the global factors</p></a></li>
<li><a href='#BS_global_loading'><p>Get a bootstrap confidence interval for the global factor loadings</p></a></li>
<li><a href='#BS_local_comp'><p>Get a bootstrap confidence interval for the global component</p></a></li>
<li><a href='#BS_local_factor'><p>Get a bootstrap confidence interval for the local factors</p></a></li>
<li><a href='#check_data'><p>Check validity of the data and headers</p></a></li>
<li><a href='#dwBS'><p>Dependent wild bootstrap for resampling time series</p></a></li>
<li><a href='#GCC'><p>Generalised canonical correlation estimation for the global factors</p></a></li>
<li><a href='#get_bw'><p>Get an optimal bandwidth using Bartlett kernel</p></a></li>
<li><a href='#infocrit'><p>Selection criteria for the approximate factor model</p></a></li>
<li><a href='#multilevel'><p>Full estimation of the multilevel factor model</p></a></li>
<li><a href='#panel2list'><p>data.frame to list of data matrices</p></a></li>
<li><a href='#PC'><p>Principal component (PC) estimation of the approximate factor model</p></a></li>
<li><a href='#summary.multi_result'><p>Print the relative importance ratios</p></a></li>
<li><a href='#UKhouse'><p>England and Wales House Price Growth Data Categorised by Regions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>GCC Estimation of the Multilevel Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rui Lin &lt;ruilin1081@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for model selection, estimation, bootstrap inference, and simulation for the 
    multilevel factor model, based on the principal component estimation and generalised 
    canonical correlation approach. Details can be found in "Generalised Canonical Correlation 
    Estimation of the Multilevel Factor Model." Lin and Shin (2023) &lt;<a href="https://doi.org/10.2139%2Fssrn.4295429">doi:10.2139/ssrn.4295429</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, stringr, sandwich</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel, plm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-30 04:53:45 UTC; Administrator</td>
</tr>
<tr>
<td>Author:</td>
<td>Rui Lin [aut, cre],
  Yongcheol Shin [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-30 05:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AsymCI_local_loading'>Get an asymptotic confidence interval for the local component</h2><span id='topic+AsymCI_local_loading'></span>

<h3>Description</h3>

<p>This function computes the asymptotic confidence intervals
for the local loadings for the <code class="reqn">j</code>-th individual in block <code class="reqn">i</code>.
See Lin and Shin (2023) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsymCI_local_loading(object, i, j, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsymCI_local_loading_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="AsymCI_local_loading_+3A_i">i</code></td>
<td>
<p>An integer indicating the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="AsymCI_local_loading_+3A_j">j</code></td>
<td>
<p>An integer indicating the <code class="reqn">j</code>-th individual in the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="AsymCI_local_loading_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_local_loading_11 &lt;- AsymCI_local_loading(est_multi, i = 1, j = 1)

</code></pre>

<hr>
<h2 id='Bartlett'>Bartlett kernel function</h2><span id='topic+Bartlett'></span>

<h3>Description</h3>

<p>Evaluate the Bartlett kernel function: <code class="reqn">Bartlett(x)=1-|x|</code> if
<code class="reqn">|x|\leq 1</code> and <code class="reqn">Bartlett(x)=1-|x|</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bartlett(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bartlett_+3A_x">x</code></td>
<td>
<p>A single numeric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single numeric between 0 and 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Bartlett(0.5)

</code></pre>

<hr>
<h2 id='BS_global_comp'>Get a bootstrap confidence interval for the global component</h2><span id='topic+BS_global_comp'></span>

<h3>Description</h3>

<p>This function employs a bootstrap procedure to obtain confidence intervals
for the global component for the <code class="reqn">j</code>-th individual in block <code class="reqn">i</code> at time <code class="reqn">t</code>.
See Lin and Shin (2023) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS_global_comp(object, i, j, t, BB = 599, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BS_global_comp_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="BS_global_comp_+3A_i">i</code></td>
<td>
<p>An integer indicating the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_global_comp_+3A_j">j</code></td>
<td>
<p>An integer indicating the <code class="reqn">j</code>-th individual in the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_global_comp_+3A_t">t</code></td>
<td>
<p>An integer specifying the time point at which the CI is constructed.</p>
</td></tr>
<tr><td><code id="BS_global_comp_+3A_bb">BB</code></td>
<td>
<p>An integer indicating the number of bootstrap repetition. 599 by default.</p>
</td></tr>
<tr><td><code id="BS_global_comp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_gcomp_111 &lt;- BS_global_comp(est_multi, i = 1, j = 1, t = 1)

</code></pre>

<hr>
<h2 id='BS_global_factor'>Get bootstrap confidence intervals for the global factors</h2><span id='topic+BS_global_factor'></span>

<h3>Description</h3>

<p>This function employs a bootstrap procedure to obtain confidence intervals
for the global factors at time <code class="reqn">t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS_global_factor(object, t, BB = 599, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BS_global_factor_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="BS_global_factor_+3A_t">t</code></td>
<td>
<p>An integer specifying the time point at which the CI is constructed.</p>
</td></tr>
<tr><td><code id="BS_global_factor_+3A_bb">BB</code></td>
<td>
<p>An integer indicating the number of bootstrap repetition. 599 by default.</p>
</td></tr>
<tr><td><code id="BS_global_factor_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_global_mid &lt;- BS_global_factor(est_multi, t = est_multi$T / 2)

</code></pre>

<hr>
<h2 id='BS_global_loading'>Get a bootstrap confidence interval for the global factor loadings</h2><span id='topic+BS_global_loading'></span>

<h3>Description</h3>

<p>This function employs a bootstrap procedure to obtain confidence intervals
for the global factor loadings for the <code class="reqn">j</code>-th individual in block <code class="reqn">i</code>. See Lin
and Shin (2023) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS_global_loading(object, i, j, BB = 599, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BS_global_loading_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by [multilevel()].</p>
</td></tr>
<tr><td><code id="BS_global_loading_+3A_i">i</code></td>
<td>
<p>An integer indicating the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_global_loading_+3A_j">j</code></td>
<td>
<p>An integer indicating the <code class="reqn">j</code>-th individual in the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_global_loading_+3A_bb">BB</code></td>
<td>
<p>An integer indicating the number of bootstrap repetition. 599 by default.</p>
</td></tr>
<tr><td><code id="BS_global_loading_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_gamma_11 &lt;- BS_global_loading(est_multi, i = 1, j = 1)

</code></pre>

<hr>
<h2 id='BS_local_comp'>Get a bootstrap confidence interval for the global component</h2><span id='topic+BS_local_comp'></span>

<h3>Description</h3>

<p>This function employs a bootstrap procedure to obtain confidence intervals
for the local component for the <code class="reqn">j</code>-th individual in block <code class="reqn">i</code> at time <code class="reqn">t</code>.
See Lin and Shin (2023) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS_local_comp(object, i, j, t, BB = 599, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BS_local_comp_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="BS_local_comp_+3A_i">i</code></td>
<td>
<p>An integer indicating the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_local_comp_+3A_j">j</code></td>
<td>
<p>An integer indicating the <code class="reqn">j</code>-th individual in the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_local_comp_+3A_t">t</code></td>
<td>
<p>An integer specifying the time point at which the CI is constructed.</p>
</td></tr>
<tr><td><code id="BS_local_comp_+3A_bb">BB</code></td>
<td>
<p>An integer indicating the number of bootstrap repetition. 599 by default.</p>
</td></tr>
<tr><td><code id="BS_local_comp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_fcomp_111 &lt;- BS_local_comp(est_multi, i = 1, j = 1, t = 1)

</code></pre>

<hr>
<h2 id='BS_local_factor'>Get a bootstrap confidence interval for the local factors</h2><span id='topic+BS_local_factor'></span>

<h3>Description</h3>

<p>This function employs a bootstrap procedure to obtain confidence intervals
for the local factors in block <code class="reqn">i</code> at time <code class="reqn">t</code>. See Lin and Shin (2023) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BS_local_factor(object, i, t, BB = 599, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BS_local_factor_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="BS_local_factor_+3A_i">i</code></td>
<td>
<p>An integer indicating the <code class="reqn">i</code>-th block.</p>
</td></tr>
<tr><td><code id="BS_local_factor_+3A_t">t</code></td>
<td>
<p>An integer specifying the time point at which the CI is constructed.</p>
</td></tr>
<tr><td><code id="BS_local_factor_+3A_bb">BB</code></td>
<td>
<p>An integer indicating the number of bootstrap repetition. 599 by default.</p>
</td></tr>
<tr><td><code id="BS_local_factor_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, a single numeric between 0 and 1. 0.05 by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the upper and lower band.
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
bs_local_factor_11 &lt;- BS_local_factor(est_multi, i = 1, t = 1)

</code></pre>

<hr>
<h2 id='check_data'>Check validity of the data and headers</h2><span id='topic+check_data'></span>

<h3>Description</h3>

<p>This is an internal function which checks the validity of the data and
provide a list of matrices of length <code class="reqn">R</code> for estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_data(
  data,
  depvar_header = NULL,
  i_header = NULL,
  j_header = NULL,
  t_header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_data_+3A_data">data</code></td>
<td>
<p>Either a data.frame or a list of data matrices of length <code class="reqn">R</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="check_data_+3A_depvar_header">depvar_header</code></td>
<td>
<p>A character string specifying the header of the dependent variable. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="check_data_+3A_i_header">i_header</code></td>
<td>
<p>A character string specifying the header of the block identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="check_data_+3A_j_header">j_header</code></td>
<td>
<p>A character string specifying the header of the individual identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="check_data_+3A_t_header">t_header</code></td>
<td>
<p>A character string specifying the header of the time identifier. See <strong>Details</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <strong>Details</strong> of GCC().
</p>


<h3>Value</h3>

<p>A list of data matrices of length <code class="reqn">R</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>panel &lt;- UKhouse # load the data
Y_list &lt;- check_data(panel,
  depvar_header = "dlPrice", i_header = "Region",
  j_header = "LPA_Type", t_header = "Date"
)
</code></pre>

<hr>
<h2 id='dwBS'>Dependent wild bootstrap for resampling time series</h2><span id='topic+dwBS'></span>

<h3>Description</h3>

<p>Select an optimal bandwidth parameter and apply the dependent wild bootstrap
with Bartlett kernel to obtain the resampled time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwBS(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dwBS_+3A_y">y</code></td>
<td>
<p>A <code class="reqn">T\times 1</code> vector of time series to be resampled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">T\times 1</code> matrix of resampled time series.
</p>


<h3>References</h3>

<p>Shao, X., 2010. The dependent wild bootstrap. Journal of the
American Statistical Association, 105(489), pp.218-235.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
G_star &lt;- dwBS(est_multi$G)
</code></pre>

<hr>
<h2 id='GCC'>Generalised canonical correlation estimation for the global factors</h2><span id='topic+GCC'></span>

<h3>Description</h3>

<p>This function is one of the main functions the package, employing the
generalized canonical correlation estimation for both the global factors
<code class="reqn">\boldsymbol{G}</code> and, when not explicitly provided, for the number of
global factors <code class="reqn">r_{0}</code>. Typically, this function is intended for internal
purposes. However, users one can opt for GCC() instead of multilevel(),
if the users only need to estimate the number of global factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GCC(
  data,
  standarise = TRUE,
  r_max = 10,
  r0 = NULL,
  ri = NULL,
  depvar_header = NULL,
  i_header = NULL,
  j_header = NULL,
  t_header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GCC_+3A_data">data</code></td>
<td>
<p>Either a data.frame or a list of data matrices of length <code class="reqn">R</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_standarise">standarise</code></td>
<td>
<p>A logical indicating whether the data is standardised before estimation or not. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_r_max">r_max</code></td>
<td>
<p>An integer indicating the maximum number of factors allowed. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_r0">r0</code></td>
<td>
<p>An integer of the number of global factors. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_ri">ri</code></td>
<td>
<p>An array of length <code class="reqn">R</code> containing the number of local factors in each block. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_depvar_header">depvar_header</code></td>
<td>
<p>A character string specifying the header of the dependent variable. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_i_header">i_header</code></td>
<td>
<p>A character string specifying the header of the block identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_j_header">j_header</code></td>
<td>
<p>A character string specifying the header of the individual identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="GCC_+3A_t_header">t_header</code></td>
<td>
<p>A character string specifying the header of the time identifier. See <strong>Details</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user-supplied data.frame should contain at least four columns, namely the
dependent variable (<code class="reqn">y_{ijt}</code>), block identifier (<code class="reqn">i</code>), individual
identifier (<code class="reqn">j</code>), and time (<code class="reqn">t</code>). The user needs to supply their corresponding
headers in the data.frame to the function using the parameters &quot;depvar_header&quot;,
&quot;i_header&quot;, &quot;j_header&quot;, and &quot;t_header&quot;, respectively. If the data is supplied
as a list, these arguments will not be used.
</p>
<p>If either r0 = NULL or ri = NULL, both of them will be estimated.
In such case, &quot;r_max&quot; must be supplied. If &quot;r0&quot; and &quot;ri&quot; are supplied then
&quot;r_max&quot; is not needed and will be ignored.
</p>
<p>If standarise = TRUE, each time series will be standardised so it has zero mean
and unit variance. It is recommended to standardise the data before estimation.
</p>
<p>See Lin and Shin (2023) for more details.
</p>


<h3>Value</h3>

<p>A list containing the estimated number of global factors <code class="reqn">\hat{r}_{0}</code>,
the global factors <code class="reqn">\widehat{\boldsymbol{G}}</code>, and the other elements that are
used in multilevel().
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
Y_list &lt;- panel2list(panel, depvar_header = "dlPrice", i_header = "Region",
                                       j_header = "LPA_Type", t_header = "Date")
est_GCC &lt;- GCC(Y_list, r_max = 10)
r0_hat &lt;- est_GCC$r0 # number of global factors
G_hat &lt;- est_GCC$G # global factors
</code></pre>

<hr>
<h2 id='get_bw'>Get an optimal bandwidth using Bartlett kernel</h2><span id='topic+get_bw'></span>

<h3>Description</h3>

<p>Automatic bandwidth selection of Andrews (1991) using Bartlett kernel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_bw(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_bw_+3A_y">y</code></td>
<td>
<p>A <code class="reqn">T\times 1</code> vector of time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric.
</p>


<h3>References</h3>

<p>Andrews, D.W., 1991. Heteroskedasticity and autocorrelation
consistent covariance matrix estimation. Econometrica: Journal of the
Econometric Society, pp.817-858.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
lT_G &lt;- get_bw(est_multi$G)
</code></pre>

<hr>
<h2 id='infocrit'>Selection criteria for the approximate factor model</h2><span id='topic+infocrit'></span>

<h3>Description</h3>

<p>This function performs model selection for the (2D) approximate factor model
and returns the estimated number of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>infocrit(Y, method, r_max = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infocrit_+3A_y">Y</code></td>
<td>
<p>A <code class="reqn">T \times N</code> data matrix. T = number of time series observations,
N = cross-sectional dimension.</p>
</td></tr>
<tr><td><code id="infocrit_+3A_method">method</code></td>
<td>
<p>A character string indicating which criteria to use.</p>
</td></tr>
<tr><td><code id="infocrit_+3A_r_max">r_max</code></td>
<td>
<p>An integer indicating the maximum number of factors allowed. 10 by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&quot;method&quot; can be one of the following: &quot;ICp2&quot; and &quot;BIC3&quot; by Bai and Ng (2002),
&quot;ER&quot; by Ahn and Horenstein (2013), &quot;ED&quot; by Onatski (2010).
</p>


<h3>Value</h3>

<p>The estimated number of factors.
</p>


<h3>References</h3>

<p>Bai, J. and Ng, S., 2002. Determining the number of factors in approximate factor models.
Econometrica, 70(1), pp.191-221.
</p>
<p>Ahn, S.C. and Horenstein, A.R., 2013. Eigenvalue ratio test for the number of factors.
Econometrica, 81(3), pp.1203-1227.
</p>
<p>Onatski, A., 2010. Determining the number of factors from empirical distribution of eigenvalues.
The Review of Economics and Statistics, 92(4), pp.1004-1016.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate data

T &lt;- 100
N &lt;- 50
r &lt;- 2
F &lt;- matrix(stats::rnorm(T * r, 0, 1), nrow = T)
Lambda &lt;- matrix(stats::rnorm(N * r, 0, 1), nrow = N)
err &lt;- matrix(stats::rnorm(T * N, 0, 1), nrow = T)
Y &lt;- F %*% t(Lambda) + err

# estimation

r_hat &lt;- infocrit(Y, "BIC3", r_max = 10)
</code></pre>

<hr>
<h2 id='multilevel'>Full estimation of the multilevel factor model</h2><span id='topic+multilevel'></span>

<h3>Description</h3>

<p>This is one of the main functions of this package which performs full estimation
of the multilevel factor model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multilevel(
  data,
  ic = "BIC3",
  standarise = TRUE,
  r_max = 10,
  r0 = NULL,
  ri = NULL,
  depvar_header = NULL,
  i_header = NULL,
  j_header = NULL,
  t_header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multilevel_+3A_data">data</code></td>
<td>
<p>Either a data.frame or a list of data matrices of length <code class="reqn">R</code>. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_ic">ic</code></td>
<td>
<p>A character string of selection criteria to use for estimation of the numbers of local factors. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_standarise">standarise</code></td>
<td>
<p>A logical indicating whether the data is standardised before estimation or not. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_r_max">r_max</code></td>
<td>
<p>An integer indicating the maximum number of factors allowed. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_r0">r0</code></td>
<td>
<p>An integer of the number of global factors. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_ri">ri</code></td>
<td>
<p>An array of length <code class="reqn">R</code> containing the number of local factors in each block. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_depvar_header">depvar_header</code></td>
<td>
<p>A character string specifying the header of the dependent variable. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_i_header">i_header</code></td>
<td>
<p>A character string specifying the header of the block identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_j_header">j_header</code></td>
<td>
<p>A character string specifying the header of the individual identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="multilevel_+3A_t_header">t_header</code></td>
<td>
<p>A character string specifying the header of the time identifier. See <strong>Details</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user-supplied data.frame should contain at least four columns, namely the
dependent variable (<code class="reqn">y_{ijt}</code>), block identifier (<code class="reqn">i</code>), individual
identifier (<code class="reqn">j</code>), and time (<code class="reqn">t</code>). The user needs to supply their corresponding
headers in the data.frame to the function using the parameters &quot;depvar_header&quot;,
&quot;i_header&quot;, &quot;j_header&quot;, and &quot;t_header&quot;, respectively. If the data is supplied
as a list, these arguments will not be used.
</p>
<p>If either r0 = NULL or ri = NULL, then both of them will be estimated.
In such case, &quot;r_max&quot; must be supplied. If &quot;r0&quot; and &quot;ri&quot; are supplied then
&quot;r_max&quot; is not needed and will be ignored.
</p>
<p>If standarise = TRUE, each time series will be standardised so it has zero mean
and unit variance. It is recommended to standardise the data before estimation.
</p>
<p>See Lin and Shin (2023) for more details.
</p>


<h3>Value</h3>

<p>The return value is an S3 object of class &quot;multi_result&quot;.
It contains a list of the following items:
</p>

<ul>
<li><p> G = A matrix of the estimated global factors.
</p>
</li>
<li><p> Gamma = A list of length <code class="reqn">R</code> containing matrices of the estimated global loading matrices for each block.
</p>
</li>
<li><p> F = A list of length <code class="reqn">R</code> containing matrices of the estimated local factors for each block.
</p>
</li>
<li><p> Lambda = A list of length <code class="reqn">R</code> containing matrices of the estimated global loading matrices for each block.
</p>
</li>
<li><p> N = The total number of cross-sections in the panel.
</p>
</li>
<li><p> Ni = An array of length <code class="reqn">R</code> containing the number of cross-sections in each block.
</p>
</li>
<li><p> r0 = The number of global factors. Unchanged if pre-specified.
</p>
</li>
<li><p> ri = An array of length <code class="reqn">R</code> containing the number of local factors for each block. Unchanged if pre-specified.
</p>
</li>
<li><p> d = An array of length <code class="reqn">R</code> containing the maximum total number of factors allowed for each block.
The elements are identically equal to r_max if either r0 or ri is supplied as NULL.
</p>
</li>
<li><p> Resid = A list of length <code class="reqn">R</code> containing the residual matrices for each block.
</p>
</li>
<li><p> delta2 = An array of the mock and the <code class="reqn">r_{\max} + 1</code> largest squared singular values.
</p>
</li>
<li><p> ic = Selection criteria used for estimating the numbers of local factors.
</p>
</li>
<li><p> block_names = A array of block names.
</p>
</li></ul>



<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation
of the Multilevel Factor Model. Available at SSRN 4295429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data

# use data.frame
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
# or one can use a list of data matrices
Y_list &lt;- panel2list(panel, depvar_header = "dlPrice", i_header = "Region",
                                       j_header = "LPA_Type", t_header = "Date")
est_multi &lt;- multilevel(Y_list, ic = "BIC3", standarise = TRUE, r_max = 5)
</code></pre>

<hr>
<h2 id='panel2list'>data.frame to list of data matrices</h2><span id='topic+panel2list'></span>

<h3>Description</h3>

<p>This function converts the data.frame to a list of data matrices and finds
the dimensions of the multilevel panel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panel2list(
  panel,
  depvar_header = NULL,
  i_header = NULL,
  j_header = NULL,
  t_header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panel2list_+3A_panel">panel</code></td>
<td>
<p>The user-supplied data frame for the multilevel panel data. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="panel2list_+3A_depvar_header">depvar_header</code></td>
<td>
<p>A character string specifying the header of the dependent variable. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="panel2list_+3A_i_header">i_header</code></td>
<td>
<p>A character string specifying the header of the block identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="panel2list_+3A_j_header">j_header</code></td>
<td>
<p>A character string specifying the header of the individual identifier. See <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="panel2list_+3A_t_header">t_header</code></td>
<td>
<p>A character string specifying the header of the time identifier. See <strong>Details</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the details of GCC().
</p>


<h3>Value</h3>

<p>A list containing the data matrices of the <code class="reqn">R</code> blocks. Each of them
has dimension <code class="reqn">T\times N_{i}</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data

# panel$Region identifies different blocks i=1,...,R.
# panel$LPA_Type identifies different individuals j=1,...,N_i.

Y_list&lt;- panel2list(panel, depvar_header = "dlPrice", i_header = "Region",
                                       j_header = "LPA_Type", t_header = "Date")

</code></pre>

<hr>
<h2 id='PC'>Principal component (PC) estimation of the approximate factor model</h2><span id='topic+PC'></span>

<h3>Description</h3>

<p>Perform PC estimation of the (2D) approximate factor model:
</p>
<p style="text-align: center;"><code class="reqn">y_{it}=\boldsymbol{\lambda}_{i}^{\prime}\boldsymbol{F}_{t}+e_{it},</code>
</p>

<p>or in matrix notation:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{Y}=\boldsymbol{F}\boldsymbol{\Lambda}^{\prime}+\boldsymbol{e}.</code>
</p>

<p>The factors <code class="reqn">\boldsymbol{F}</code> is estimated as <code class="reqn">\sqrt{T}</code> times the <code class="reqn">r</code> eigenvectors of
the matrix <code class="reqn">\boldsymbol{Y}\boldsymbol{Y}^{\prime}</code> corresponding to the <code class="reqn">r</code>
largest eigenvalues in descending order, and the loading matrix is estimated by
<code class="reqn">\boldsymbol{\Lambda}=T^{-1}\boldsymbol{Y}^{\prime}\boldsymbol{F}</code>.
See e.g. Bai and Ng (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC(Y, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PC_+3A_y">Y</code></td>
<td>
<p>A <code class="reqn">T \times N</code> data matrix. T = number of time series observations,
N = cross-sectional dimension.</p>
</td></tr>
<tr><td><code id="PC_+3A_r">r</code></td>
<td>
<p>= the number of factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the factors and factor loadings:
</p>

<ul>
<li><p> factor = a <code class="reqn">T \times r</code> matrix of the estimated factors.
</p>
</li>
<li><p> loading = a <code class="reqn">N \times r</code> matrix of the estimated factor loadings.
</p>
</li></ul>



<h3>References</h3>

<p>Bai, J. and Ng, S., 2002. Determining the number of factors in approximate factor models.
Econometrica, 70(1), pp.191-221.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simulate data

T &lt;- 100
N &lt;- 50
r &lt;- 2
F &lt;- matrix(stats::rnorm(T * r, 0, 1), nrow = T)
Lambda &lt;- matrix(stats::rnorm(N * r, 0, 1), nrow = N)
err &lt;- matrix(stats::rnorm(T * N, 0, 1), nrow = T)
Y &lt;- F %*% t(Lambda) + err

# estimation

est_PC &lt;- PC(Y, r)
</code></pre>

<hr>
<h2 id='summary.multi_result'>Print the relative importance ratios</h2><span id='topic+summary.multi_result'></span>

<h3>Description</h3>

<p>Print the relative importance ratios
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multi_result'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.multi_result_+3A_object">object</code></td>
<td>
<p>An S3 object of class 'multi_result' created by multilevel().</p>
</td></tr>
<tr><td><code id="summary.multi_result_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the summary of the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
panel &lt;- UKhouse # load the data
est_multi &lt;- multilevel(panel, ic = "BIC3", standarise = TRUE, r_max = 5,
                           depvar_header = "dlPrice", i_header = "Region",
                           j_header = "LPA_Type", t_header = "Date")
summary(est_multi)

</code></pre>

<hr>
<h2 id='UKhouse'>England and Wales House Price Growth Data Categorised by Regions</h2><span id='topic+UKhouse'></span>

<h3>Description</h3>

<p>A data.frame containing the quarterly (mean) house prices of four different types of properties,
(detached, semi-detached, terraced and flats/maisonettes) for 331 local planning
authorities (LPA) over the period 1996Q1 to 2021Q2. See also Lin and Shin (2023).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UKhouse
</code></pre>


<h3>Format</h3>

<p>## 'UKhouse'
</p>


<h3>Details</h3>

<p>Each LPA belongs to one of the ten regions: North East (NE), North West (NW),
Yorkshire and the Humber (YH), East Midlands (EM), West Midlands(WM),
East of England (EE), London (LD), South East (SE), South West (SW) and Wales (WA).
The real house price growth of the <code class="reqn">j</code>-th LPA-type pair in region
<code class="reqn">i</code> by deflating the nominal house price by CPI and log-differencing it as
</p>
<p style="text-align: center;"><code class="reqn">\pi_{ijt}=100\times \log\left(\frac{PRICE_{ijt}}{CPI_{t}}\right)-100 \times
 \log\left(\frac{PRICE_{ij,t-1}}{CPI_{t-1}}\right).</code>
</p>

<p>By removing the series with missing observations, it ends up with a balanced panel
with <code class="reqn">R = 10</code>, <code class="reqn">N =\sum_{i=1}^{R} N_{i} = 1300</code> and <code class="reqn">T = 102</code>.
</p>
<p>Columns in the dataset:
</p>

<ul>
<li><p> &quot;Date&quot; Time variable.
</p>
</li>
<li><p> &quot;Region&quot; Name of region which the LPA belongs to.
</p>
</li>
<li><p> &quot;LPA&quot; Name of the LPA.
</p>
</li>
<li><p> &quot;Type&quot; Name of the house type.
</p>
</li>
<li><p> &quot;LPA_Type&quot; Name of the LPA-type pair.
</p>
</li></ul>



<h3>Source</h3>

<p>Office for National Statistics (ONS), ONS website, statistical bulletin, House price statistics for small areas in England and Wales: year ending June 2021
</p>


<h3>References</h3>

<p>Lin, R. and Shin, Y., 2022. Generalised Canonical Correlation Estimation of the Multilevel Factor Model. Available at SSRN 4295429.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
