<!DOCTYPE html><html><head><title>Help for package cosinor2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cosinor2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#correct.acrophase'><p>Acrophase Correction</p></a></li>
<li><a href='#cosinor.detect'><p>Rhythm Detection Test</p></a></li>
<li><a href='#cosinor.poptests'><p>Comparison of Cosinor Parameters of Two Populations</p></a></li>
<li><a href='#cosinor.PR'><p>Percent Rhythm</p></a></li>
<li><a href='#PA_extraverts'><p>Self-reported positive affect of extraverts</p></a></li>
<li><a href='#PA_introverts'><p>Self-reported positive affect of introverts</p></a></li>
<li><a href='#PA_time'><p>Measurement times of self-reported positive affect</p></a></li>
<li><a href='#PANAS_november'><p>Self-reported mood</p></a></li>
<li><a href='#PANAS_time'><p>Measurement times of self-reported mood</p></a></li>
<li><a href='#periodogram'><p>Periodogram</p></a></li>
<li><a href='#population.cosinor.lm'><p>Population-Mean Cosinor</p></a></li>
<li><a href='#ssections'><p>Serial Sections</p></a></li>
<li><a href='#temperature_zg'><p>Daily air temperature in Zagreb</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Extended Tools for Cosinor Analysis of Rhythms</td>
</tr>
<tr>
<td>Description:</td>
<td>Statistical procedures for calculating population–mean cosinor, non–stationary cosinor, estimation of best–fitting period, tests of population rhythm differences and more. See Cornélissen, G. (2014). &lt;<a href="https://doi.org/10.1186%2F1742-4682-11-16">doi:10.1186/1742-4682-11-16</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Augustin Mutak &lt;mutak94@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Augustin Mutak &lt;mutak94@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), cosinor (&ge; 1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cowplot (&ge; 0.9.3), scales (&ge; 1.0.0), magrittr (&ge; 1.5),
stringr (&ge; 1.3.1), purrr(&ge; 0.2.5), ggplot2 (&ge; 3.0.0),
matrixStats (&ge; 0.52.2), Hmisc (&ge; 4.0-3)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>LazyData:</td>
<td>True</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/amutak/cosinor2">https://github.com/amutak/cosinor2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/amutak/cosinor2/issues">https://github.com/amutak/cosinor2/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-01</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-15 15:36:37 UTC; Augustin</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-15 16:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='correct.acrophase'>Acrophase Correction</h2><span id='topic+correct.acrophase'></span>

<h3>Description</h3>

<p>Corrects the value of the acrophase parameter of the cosinor model, placing it in the appropriate quadrant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct.acrophase(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct.acrophase_+3A_x">x</code></td>
<td>
<p>An object of the <code>cosinor.lm</code> class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The acrophase parameter of a cosinor model is found by solving an equation with inverse tangent of an expression which contains linearized cosinor parameters. However, multiple numeric entities may result in a same value of tangent and just calculating the inverse tangent may result with the wrong value of the acrophase. This function corrects the acrophase from the <code>cosinor.lm</code> object according to the procedure from Bingham et al. (1982).
More specifically, the acrophase is calculated as: </p>
<p style="text-align: center;"><code class="reqn">K + g * arctan \vert\frac{\gamma}{\beta}\vert</code>
</p>

<p>where values of <code class="reqn">K</code> and <code class="reqn">g</code> depend on the signs of <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> and can be derived from the following table:
</p>

<table>
<tr>
 <td style="text-align: center;">
sign <code class="reqn">\beta</code> </td><td style="text-align: center;"> sign <code class="reqn">\gamma</code> </td><td style="text-align: center;"> K </td><td style="text-align: center;"> g </td>
</tr>
<tr>
 <td style="text-align: center;">
+ </td><td style="text-align: center;"> + </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> -1 </td>
</tr>
<tr>
 <td style="text-align: center;">
+ </td><td style="text-align: center;"> - </td><td style="text-align: center;"> -2<code class="reqn">\pi</code> </td><td style="text-align: center;"> 1 </td>
</tr>
<tr>
 <td style="text-align: center;">
- </td><td style="text-align: center;"> + </td><td style="text-align: center;"> -<code class="reqn">\pi</code> </td><td style="text-align: center;"> 1 </td>
</tr>
<tr>
 <td style="text-align: center;">
- </td><td style="text-align: center;"> - </td><td style="text-align: center;"> -<code class="reqn">\pi</code> </td><td style="text-align: center;"> -1
</td>
</tr>

</table>



<h3>References</h3>

<p>Bingham, C., Arbogast, B., Guillaume Cornélissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit.temperature&lt;-cosinor.lm(Temperature~time(Time), period = 24, data = temperature_zg)
correct.acrophase(fit.temperature)
</code></pre>

<hr>
<h2 id='cosinor.detect'>Rhythm Detection Test</h2><span id='topic+cosinor.detect'></span>

<h3>Description</h3>

<p>Performs the rhythm detection test, a global test for the significance of the estimated model for single cosinor and population-mean cosinor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor.detect(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor.detect_+3A_x">x</code></td>
<td>
<p>An object of the <code>cosinor.lm</code> or <code>population.cosinor.lm</code> class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rhythm detection test, also called the zero-amplitude test, tests the overall significance of the cosinor model. The test is actually an F-ratio and is calculated as following (according to the procedure described in Cornélissen, 2014):
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{\frac{\sum(\widehat{Y}_i - \bar{Y})^2}{2}}{\frac{\sum(Y_i - \bar{Y})^2}{N - 3}}</code>
</p>
<p> with <code class="reqn">df_1 = 2</code> and <code class="reqn">df_2 = N - 3</code>
, where <code class="reqn">\widehat{Y}_i</code> is the <code class="reqn">i</code>th estimated value, <code class="reqn">Y_i</code> is the <code class="reqn">i</code>th observed value, <code class="reqn">\bar{Y}</code> is the arithmetic mean of observed values and <code class="reqn">N</code> is the number of timepoints.
For the population-mean cosinor model, the test is calculated according to the procedure described in Bingham et al. (1982) as follows:
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{k(k-2)}{2(k-1)}\frac{1}{1-(\frac{\widehat{\sigma}_{\beta\gamma}}{\widehat{\sigma}_\beta \widehat{\sigma}_\gamma})^2}[\frac{\beta^2}{\widehat{\sigma}^2_\beta}-2\frac{\widehat{\sigma}_{\beta\gamma}}{\widehat{\sigma}_\beta \widehat{\sigma}_\gamma}\frac{\beta \gamma}{\widehat{\sigma}_\beta \widehat{\sigma}_\gamma}+\frac{\gamma^2}{\widehat{\sigma}^2_\gamma}]</code>
</p>
<p> with <code class="reqn">df_1 = 2</code> and <code class="reqn">df_2 = k - 2</code>
, where <code class="reqn">k</code> is the number of subjects in the population, <code class="reqn">\widehat{\sigma}_\beta</code> and <code class="reqn">\widehat{\sigma}_\gamma</code> are standard deviations of population <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> coefficients and <code class="reqn">\widehat{\sigma}_{\beta\gamma}</code> is the covariance of population <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> coefficients.
</p>


<h3>References</h3>

<p>Cornélissen, G. (2014). Cosinor-Based Rhythmometry. <em>Theoretical Biology and Medical Modeling</em>, <em>11</em>, Article 16.
</p>
<p>Bingham, C., Arbogast, B., Guillaume Cornélissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit.temperature&lt;-cosinor.lm(Temperature~time(Time), period = 24, data = temperature_zg)
cosinor.detect(fit.temperature)

fit.november&lt;-population.cosinor.lm(data = PANAS_november, time = PANAS_time,
period = 7)
cosinor.detect(fit.november)
</code></pre>

<hr>
<h2 id='cosinor.poptests'>Comparison of Cosinor Parameters of Two Populations</h2><span id='topic+cosinor.poptests'></span>

<h3>Description</h3>

<p>Runs the tests that compare MESORs, amplitudes and acrophases of two different populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor.poptests(pop1, pop2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor.poptests_+3A_pop1">pop1</code></td>
<td>
<p>An object of the <code>population.cosinor.lm</code> class calculated on the first population.</p>
</td></tr>
<tr><td><code id="cosinor.poptests_+3A_pop2">pop2</code></td>
<td>
<p>An object of the <code>population.cosinor.lm</code> class calculated on the second population.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bingham et al. (1982) describe tests for comparing population MESORs, amplitudes and acrophases. These tests are esentially F-ratios with <code class="reqn">df_1 = m - 1</code> and <code class="reqn">df_2 = K - m</code>, where <code class="reqn">m</code> is the number of populations and <code class="reqn">K</code> is the total number of subjects. The tests for MESOR, amplitude and acrophase differences respectively are calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">F_M = \frac{\sum_{j = 1}^{m}k_j(\widehat{M}_j - \widehat{M})^2}{(m-1)\widehat{\sigma}_M^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">F_\phi = \frac{\frac{\sum_{j = 1}^{m}k_j A_j^2 * sin^2(\widehat{\phi}_j - \tilde{\phi})}{m - 1}} {\widehat{\sigma}_\beta^2 sin^2\tilde{\phi} + 2\widehat{\sigma}_{\beta \gamma} cos\tilde{\phi}sin\tilde{\phi} + \widehat{\sigma}_\gamma^2 cos^2\tilde{\phi}}</code>
</p>

<p style="text-align: center;"><code class="reqn">F_A = \frac{\frac{\sum_{j = 1}^{m}(\widehat{A}_j - \widehat{A})^2}{m - 1}}{\widehat{\sigma}^2_\beta cos^2\widehat{\phi} - 2\widehat{\sigma}_{\beta \gamma}cos\widehat{\phi}sin\widehat{\phi} + \widehat{\sigma}^2_\gamma sin^2 \widehat{\phi}}</code>
</p>

<p>where <code class="reqn">\widehat{M}</code>, <code class="reqn">\widehat{A}</code> and <code class="reqn">\widehat{\phi}</code> are weighted averages of parameters across populations calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{M} = \frac{\sum_{j = 1}^{m}k_j\widehat{M}_j}{K}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{A} = \frac{\sum_{j = 1}^{m}k_j\widehat{A}_j}{K}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\phi} = \frac{\sum_{j = 1}^{m}k_j\widehat{\phi}_j}{K}</code>
</p>

<p><code class="reqn">\tilde{\phi}</code> is derived from the following expression:
</p>
<p style="text-align: center;"><code class="reqn">tan 2\tilde{\phi} = \frac{\sum_{j = 1}^{m}k_j\widehat{A}^2_j sin 2\widehat{\phi}_j}{\sum_{j = 1}^{m}k_j\widehat{A}^2_j cos 2\widehat{\phi}_j}</code>
</p>

<p>where <code class="reqn">2\tilde{\phi}</code> lies between <code class="reqn">-\frac{\pi}{2}</code> and <code class="reqn">\frac{\pi}{2}</code> if the denomanator is positive or between <code class="reqn">\frac{\pi}{2}</code> and <code class="reqn">\frac{3\pi}{2}</code> if the denominator is negative, <code class="reqn">k_j</code> is the number of subjects in the <code class="reqn">j</code>th population, <code class="reqn">\widehat{M}_j</code>, <code class="reqn">\widehat{A}_j</code> and <code class="reqn">\widehat{\phi}_j</code> are the cosinor parameters of the <code class="reqn">j</code>th population and <code class="reqn">\widehat{\sigma}_\beta</code>,<code class="reqn">\widehat{\sigma}_\gamma</code> and <code class="reqn">\widehat{\sigma}_{\beta \gamma}</code> are the estimates of pooled standard deviations (and covariance) calculated as following:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_\beta = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{\beta_j}}{K - m}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_\gamma = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{\gamma_j}}{K - m}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_{\beta \gamma} = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{{\beta_j} {\gamma_j}}}{K - m}</code>
</p>

<p>where <code class="reqn">\widehat{\sigma}_{\beta_j}</code>, <code class="reqn">\widehat{\sigma}_{\gamma_j}</code> and <code class="reqn">\widehat{\sigma}_{{\beta_j} {\gamma_j}}</code> are the standard devations and covariance of <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters in the <code class="reqn">j</code>th population.
</p>


<h3>Note</h3>

<p>These tests should only be performed on independent samples. If the acrophases of two populations are significantly different, the results of the amplitude difference test are not reliable and should not be interpreted. While it's possible to perform tests which compare more than two populations, this function can only compare two populations.
</p>


<h3>References</h3>

<p>Bingham, C., Arbogast, B., Guillaume Cornélissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit.extraverts&lt;-population.cosinor.lm(data = PA_extraverts, time = PA_time,
period = 24)
fit.introverts&lt;-population.cosinor.lm(data = PA_introverts, time = PA_time,
period = 24)
cosinor.poptests(pop1 = fit.extraverts, pop2 = fit.introverts)
</code></pre>

<hr>
<h2 id='cosinor.PR'>Percent Rhythm</h2><span id='topic+cosinor.PR'></span>

<h3>Description</h3>

<p>Calculates Percent Rhythm, the measure of the relative strength of a rhythm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosinor.PR(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cosinor.PR_+3A_x">x</code></td>
<td>
<p>An object of the <code>cosinor.lm</code> or <code>population.cosinor.lm</code> class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Percent Rhythm is the coefficient of determination obtained by squaring the correlation between observed and estimated values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit.temperature&lt;-cosinor.lm(Temperature~time(Time), period = 24, data = temperature_zg)
cosinor.PR(fit.temperature)

fit.november&lt;-population.cosinor.lm(data = PANAS_november, time = PANAS_time,
period = 7)
cosinor.PR(fit.november)
</code></pre>

<hr>
<h2 id='PA_extraverts'>Self-reported positive affect of extraverts</h2><span id='topic+PA_extraverts'></span>

<h3>Description</h3>

<p>A dataset containing the responses of 24 subjects on the Positive Affect scale of the shortened version of the PANAS questionnaire (Watson, Clark &amp; Tellegen, 1988) in January 2017.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PA_extraverts
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 6 variables:
</p>

<dl>
<dt>X1, X2, X3, X4, X5, X6</dt><dd><p>Responses of subjects at 6 measurement points (hours).</p>
</dd>
</dl>


<h3>Details</h3>

<p>Measurements were taken at 10 AM, 12 PM, 2 PM, 4 PM, 6 PM and 8 PM <code class="reqn">\pm</code> 30 minutes in the period of January 16 - 22, 2017. The data contained in this dataset has been averaged for each hour across 7 days of measurement.
</p>


<h3>Source</h3>

<p>Mutak, A., Pavlović, M. &amp; Zibar, K. (2017, May). <em>Postoje li razlike između introverata i ekstraverata u cirkadijurnim ritmovima raspoloženja?</em> [<em>Are There Differences Between Introverts and Extraverts in Circadian Mood Rhythms?</em>]. Study presented at the 3rd <em>Regionalni susret studenata psihologije - SPIRI</em> [<em>Regional Meeting of Psychology Students - SPIRI</em>] conference, Rijeka, Croatia.
</p>


<h3>References</h3>

<p>Watson, D., Clark, L. A. &amp; Tellegen, A. (1988). Development and Validation of Brief Measures of Positive and Negative Affect: The PANAS Scales. <em>Journal of Personality and Social Psychology</em>, <em>54(6)</em>, 1063-1070.
</p>

<hr>
<h2 id='PA_introverts'>Self-reported positive affect of introverts</h2><span id='topic+PA_introverts'></span>

<h3>Description</h3>

<p>A dataset containing the responses of 29 subjects on the Positive Affect scale of the shortened version of the PANAS questionnaire (Watson, Clark &amp; Tellegen, 1988) in January 2017.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PA_introverts
</code></pre>


<h3>Format</h3>

<p>A data frame with 29 rows and 6 variables:
</p>

<dl>
<dt>X1, X2, X3, X4, X5, X6</dt><dd><p>Responses of subjects at 6 measurement points (hours).</p>
</dd>
</dl>


<h3>Details</h3>

<p>Measurements were taken at 10 AM, 12 PM, 2 PM, 4 PM, 6 PM and 8 PM <code class="reqn">\pm</code> 30 minutes in the period of January 16 - 22, 2017. The data contained in this dataset has been averaged for each hour across 7 days of measurement.
</p>


<h3>Source</h3>

<p>Mutak, A., Pavlović, M. &amp; Zibar, K. (2017, May). <em>Postoje li razlike između introverata i ekstraverata u cirkadijurnim ritmovima raspoloženja?</em> [<em>Are There Differences Between Introverts and Extraverts in Circadian Mood Rhythms?</em>]. Study presented at the 3rd <em>Regionalni susret studenata psihologije - SPIRI</em> [<em>Regional Meeting of Psychology Students - SPIRI</em>] conference, Rijeka, Croatia.
</p>


<h3>References</h3>

<p>Watson, D., Clark, L. A. &amp; Tellegen, A. (1988). Development and Validation of Brief Measures of Positive and Negative Affect: The PANAS Scales. <em>Journal of Personality and Social Psychology</em>, <em>54(6)</em>, 1063-1070.
</p>

<hr>
<h2 id='PA_time'>Measurement times of self-reported positive affect</h2><span id='topic+PA_time'></span>

<h3>Description</h3>

<p>A dataset containing the measurement times (hours) of self reported positive affect contained in the data frames <code>PA_extravers</code> and <code>PA_introverts</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PA_time
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 6.</p>


<h3>Source</h3>

<p>Mutak, A., Pavlović, M. &amp; Zibar, K. (2017, May). <em>Postoje li razlike između introverata i ekstraverata u cirkadijurnim ritmovima raspoloženja?</em> [<em>Are There Differences Between Introverts and Extraverts in Circadian Mood Rhythms?</em>]. Study presented at the 3rd <em>Regionalni susret studenata psihologije - SPIRI</em> [<em>Regional Meeting of Psychology Students - SPIRI</em>] conference, Rijeka, Croatia.
</p>

<hr>
<h2 id='PANAS_november'>Self-reported mood</h2><span id='topic+PANAS_november'></span>

<h3>Description</h3>

<p>A dataset containing the responses of 19 subjects on the shortened version of the PANAS questionnaire (Watson, Clark &amp; Tellegen, 1988) in November 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PANAS_november
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 30 variables:
</p>

<dl>
<dt>X01, X02, X03, X04, X05, X06, X07, X08, X09, X10, X11, X12, X13, X14, X15, X16, X17, X18, X19, X20, X21, X22, X23, X24, X25, X26, X27, X28, X29, X30</dt><dd><p>Responses of subjects at 30 measurement points (days).</p>
</dd></dl>


<h3>Details</h3>

<p>Measurements were taken every day after 8 PM.
</p>


<h3>Note</h3>

<p>The data contained in this dataset has been reduced compared to the original data that included more subjects. This dataset contains only the subjects that have responded to the PANAS questionnaire on more than 85% of the timepoints in both of the research cycles (July and November).
</p>


<h3>Source</h3>

<p>Mutak, A. i Vukasović Hlupić, T. (2017). Exogeneity of the Circaseptan Mood Rhythm and Its Relation to the Working Week. <em>Review of Psychology</em>, <em>24</em> (1-2), 15-28.
</p>


<h3>References</h3>

<p>Watson, D., Clark, L. A. &amp; Tellegen, A. (1988). Development and Validation of Brief Measures of Positive and Negative Affect: The PANAS Scales. <em>Journal of Personality and Social Psychology</em>, <em>54(6)</em>, 1063-1070.
</p>

<hr>
<h2 id='PANAS_time'>Measurement times of self-reported mood</h2><span id='topic+PANAS_time'></span>

<h3>Description</h3>

<p>A dataset containing the measurement times (dates) of self reported mood contained in the data frame <code>PANAS_november</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PANAS_time
</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 30.</p>


<h3>Source</h3>

<p>Mutak, A. i Vukasović Hlupić, T. (2017). Exogeneity of the Circaseptan Mood Rhythm and Its Relation to the Working Week. <em>Review of Psychology</em>, <em>24</em> (1-2), 15-28.
</p>

<hr>
<h2 id='periodogram'>Periodogram</h2><span id='topic+periodogram'></span>

<h3>Description</h3>

<p>Estimates the best-fitting period using iterative cosinor procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>periodogram(data, time, periods = time, na.action = na.omit,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodogram_+3A_data">data</code></td>
<td>
<p>A data frame containing responses of subjects collected over time, with subjects in the rows and timepoints in the columns.</p>
</td></tr>
<tr><td><code id="periodogram_+3A_time">time</code></td>
<td>
<p>A vector containing the times at which the data was collected. If this vector includes midnight, it should be coded as 24 instead of 0.</p>
</td></tr>
<tr><td><code id="periodogram_+3A_periods">periods</code></td>
<td>
<p>A vector containing periods that are to be included in the periodogram. Defaults to the same periods as provided in the vector <code>time</code>.</p>
</td></tr>
<tr><td><code id="periodogram_+3A_na.action">na.action</code></td>
<td>
<p>Action to be performed on missing values. Defaults to <code>na.omit</code>.</p>
</td></tr>
<tr><td><code id="periodogram_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for determining if a rhythm with a given period is significant or not. Defaults to .05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Iterative cosinor procedure is performed as described in Klemfuss &amp; Clopton (1993). Cosinor is performed iteratively with the period (<code class="reqn">\tau</code>) increased by 1 in each iteration. Percent Rhythm is calculated in each iteration, which allows for an estimation of the best fitting period. A periodogram can be plotted, which shows Percent Rhythm (coefficient of determination) for each period. On the plot, periods with significant rhythm are shown as a point and periods with insignificant rhythm are shown as a cross.
</p>


<h3>Note</h3>

<p>The range of periods included in iterations starts from 3 (sinusoidality of the curve is not achieved for <code class="reqn">\tau</code> &lt; 3) and ends with the number of timepoints in the data.
</p>


<h3>References</h3>

<p>Klemfuss, H. &amp; Clopton, P. L. (1993). Seeking Tau: A Comparison of Six Methods. <em>Journal of Interdisciplinary Cycle Research</em>, <em>24(1)</em>, 1-16.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosinor.PR">cosinor.PR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>periodogram(data = PANAS_november, time = PANAS_time)

periodogram(data = t(data.frame(temperature_zg$Temperature)), time = temperature_zg$Time)
</code></pre>

<hr>
<h2 id='population.cosinor.lm'>Population-Mean Cosinor</h2><span id='topic+population.cosinor.lm'></span>

<h3>Description</h3>

<p>Calculates the population-mean cosinor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>population.cosinor.lm(data, time, period, na.action = na.omit,
  alpha = 0.05, plot = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="population.cosinor.lm_+3A_data">data</code></td>
<td>
<p>A data frame containing responses of subjects collected over time, with subjects in the rows and timepoints in the columns.</p>
</td></tr>
<tr><td><code id="population.cosinor.lm_+3A_time">time</code></td>
<td>
<p>A vector containing the times at which the data was collected.</p>
</td></tr>
<tr><td><code id="population.cosinor.lm_+3A_period">period</code></td>
<td>
<p>Duration of one cycle of rhythm.</p>
</td></tr>
<tr><td><code id="population.cosinor.lm_+3A_na.action">na.action</code></td>
<td>
<p>Action to be performed on missing values. Defaults to <code>na.omit</code>.</p>
</td></tr>
<tr><td><code id="population.cosinor.lm_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for calculating population cosinor parameters confidence intervals. Defaults to .05 (confidence intervals are 5% risk intervals).</p>
</td></tr>
<tr><td><code id="population.cosinor.lm_+3A_plot">plot</code></td>
<td>
<p>Logical, display plot after calculation? Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to the procedure described in Cornélissen (2014), to calculate population-mean cosinor, single cosinors are first performed on each subject and linearized parameters are averaged, which allows for calculation of delinearized parameters. After such a procedure is completed, confidence intervals of population-mean cosinor parameters can be calculated as described in Bingham et al. (1982) using the following formulae:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{M} \pm \frac{t_{1-\frac{\alpha}{2}}\widehat{\sigma}_M}{\sqrt{k}}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\phi}+arctan(\frac{c_{23} t_{1-\frac{\alpha}{2}}^2 \pm t_{1-\frac{\alpha}{2}}\sqrt{c_{33}} \sqrt{\widehat{A}^2-\frac{(c_{22}c_{33}-c_{23}^2)t_{1-\frac{\alpha}{2}}^2}{c_{33}}}}{\widehat{A}^2 - c_{22} t_{1-\frac{\alpha}{2}}^2})</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{A} \pm t_{1-\frac{\alpha}{2}} \sqrt{c_{22}}</code>
</p>

<p>where <code class="reqn">c_{22}</code>, <code class="reqn">c_{23}</code> and <code class="reqn">c_{33}</code> are elements of the sampling scheme matrix, calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">c_{22}=\frac{\widehat{\sigma}^2_{\beta}\widehat{\beta}^2+2\widehat{\sigma}_{\beta \gamma}\widehat{\beta}\widehat{\gamma}+\widehat{\sigma}^2_{\gamma}\widehat{\gamma}^2}{k\widehat{A}^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">c_{23}=\frac{-(\widehat{\sigma}^2_{\beta}-\widehat{\sigma}^2_{\gamma})(\widehat{\beta}\widehat{\gamma})+\widehat{\sigma}_{\beta \gamma}(\widehat{\beta}^2-\widehat{\gamma}^2)}{k\widehat{A}^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">c_{33}=\frac{\widehat{\sigma}^2_{\beta}\widehat{\gamma}^2-2\widehat{\sigma}_{\beta \gamma}\widehat{\beta}\widehat{\gamma}+\widehat{\sigma}^2_{\gamma}\widehat{\beta}^2}{k\widehat{A}^2}</code>
</p>

<p>where <code class="reqn">\widehat{M}</code>, <code class="reqn">\widehat{A}</code>, <code class="reqn">\widehat{\phi}</code>, <code class="reqn">\widehat{\beta}</code> and <code class="reqn">\widehat{\gamma}</code> are population-mean cosinor parameters, <code class="reqn">\widehat{\sigma}_M</code>, <code class="reqn">\widehat{\sigma}_{\beta}</code> and <code class="reqn">\widehat{\sigma}_{\gamma}</code> are the standard deviations of the single cosinor parameters, <code class="reqn">\widehat{\sigma}_{\beta \gamma}</code> is the covariance of the single cosinor <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> coefficients, <code class="reqn">k</code> is the number of subjects in a population and <code class="reqn">t_{1-\frac{\alpha}{2}}</code> is the two-tailed inverse of the t-distribution with <code class="reqn">\alpha</code> level of significance and <code class="reqn">k - 1</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>Object of the <code>population.cosinor.lm</code> class containing the following objects:
</p>
<table>
<tr><td><code>single.cos</code></td>
<td>
<p>A list of objects containing all performed single cosinors.</p>
</td></tr>
<tr><td><code>pop.mat</code></td>
<td>
<p>A data frame containing the cosinor parameters of each subject in the population.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>Delinearized population-mean cosinor coefficients.</p>
</td></tr>
<tr><td><code>emp.mean</code></td>
<td>
<p>Empirical mean of the data across all timepoints.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>Estimated values of the rhythm caclculated using the cosinor model.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The difference between empirical mean and the fitted values.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>Values of upper and lower limits of confidence intervals of delinearized cosinor parameters.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the confidence interval of the population amplitude includes zero, confidence interval of the acrophase cannot be calculated reliably. If this case occurs while using this function, the user will be warned and acrophase confidence interval limits will be set to NA.
</p>


<h3>References</h3>

<p>Cornélissen, G. (2014). Cosinor-Based Rhythmometry. <em>Theoretical Biology and Medical Modeling</em>, <em>11</em>, Article 16.
</p>
<p>Bingham, C., Arbogast, B., Guillaume Cornélissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>population.cosinor.lm(data = PANAS_november, time = PANAS_time,
period = 7, na.action = "na.exclude")
</code></pre>

<hr>
<h2 id='ssections'>Serial Sections</h2><span id='topic+ssections'></span>

<h3>Description</h3>

<p>Performs serial section analysis of rhythmic data and fits non-stationary cosinor models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssections(data, time, period, interval, increment, na.action = na.omit,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssections_+3A_data">data</code></td>
<td>
<p>A data frame containing responses of subjects collected over time, with subjects in the rows and timepoints in the columns.</p>
</td></tr>
<tr><td><code id="ssections_+3A_time">time</code></td>
<td>
<p>A vector containing the times at which the data was collected.</p>
</td></tr>
<tr><td><code id="ssections_+3A_period">period</code></td>
<td>
<p>Duration of one cycle of rhythm.</p>
</td></tr>
<tr><td><code id="ssections_+3A_interval">interval</code></td>
<td>
<p>Length of an interval (number of timepoints) on which cosinor analyses will be ran.</p>
</td></tr>
<tr><td><code id="ssections_+3A_increment">increment</code></td>
<td>
<p>A number indicating for how much timepoints should the interval be displaced throughout the data. Note that the value of the increment cannot be higher than the value of the interval.</p>
</td></tr>
<tr><td><code id="ssections_+3A_na.action">na.action</code></td>
<td>
<p>Action to be performed on missing values. Defaults to <code>na.omit</code>.</p>
</td></tr>
<tr><td><code id="ssections_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for calculating population cosinor parameters confidence intervals. Defaults to .05 (confidence intervals are 5% risk intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cornélissen (2014) describes procedures for rhythmometric analysis of non-stationary data. First, an interval of an user-specified length (<code class="reqn">I</code>) is chosen and usual cosinor analysis (i.e. single cosinor or population-mean cosinor) is performed on the interval. The interval is then displaced throughout the data by an user-specified increment (<code class="reqn">\Delta t</code>) and cosinor analysis is then performed on the new interval. Intervals can be overlapping (<code class="reqn">\Delta t</code>&lt;I) or non-overlapping (<code class="reqn">\Delta t</code>=I). A rhythm detection test is also calculated in each interval. After values of cosinor parameters have been obtained for each interval, they and their confidence intervals can be plotted, along with the <em>p</em>-values from the rhythm detection test.
</p>


<h3>Value</h3>

<p>Object of the <code>Serial sections</code> class containing the following objects:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>Cosinor coefficients in each of the intervals.</p>
</td></tr>
<tr><td><code>emp.mean</code></td>
<td>
<p>Empirical mean of the data across all timepoints.</p>
</td></tr>
<tr><td><code>p-values</code></td>
<td>
<p><em>p</em>-values from the rhythm detection test in each interval.</p>
</td></tr>
<tr><td><code>cosinors</code></td>
<td>
<p>A list containing all cosinor objects calculated in each interval.</p>
</td></tr>
<tr><td><code>plots</code></td>
<td>
<p>Stacked plots showing the empirical data, cosinor parameters and their confidence intervals, p-values of the rhythm detection test and number of measurements across time.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The value of increment cannot be higher than the value of the interval.
</p>


<h3>References</h3>

<p>Cornélissen, G. (2014). Cosinor-Based Rhythmometry. <em>Theoretical Biology and Medical Modeling</em>, <em>11</em>, Article 16.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ssections(data = PANAS_november, time = PANAS_time, period = 7,
interval = 7, increment = 1)
</code></pre>

<hr>
<h2 id='temperature_zg'>Daily air temperature in Zagreb</h2><span id='topic+temperature_zg'></span>

<h3>Description</h3>

<p>A dataset containing the air temperature in Zagreb on July 1, 2015.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temperature_zg
</code></pre>


<h3>Format</h3>

<p>A data frame with two variables:
</p>

<dl>
<dt>Temperature</dt><dd><p>Air temperature in Zagreb on July 1, 2015.</p>
</dd>
<dt>Time</dt><dd><p>Time of the day when the temperature was measured.</p>
</dd>
</dl>


<h3>Details</h3>

<p>Measurements were taken every 30 minutes throughout the whole day.
</p>


<h3>Source</h3>

<p>Croatian Meteorological and Hydrological Service, <a href="http://www.meteo.hr">http://www.meteo.hr</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
