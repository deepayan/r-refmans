<!DOCTYPE html><html><head><title>Help for package INLAjoint</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {INLAjoint}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.INLAjoint'><p>Extracts model coefficients from a given model fitted with INLAjoint</p></a></li>
<li><a href='#family.INLAjoint'><p>Extracts family from a given model fitted with INLAjoint</p></a></li>
<li><a href='#fitted.INLAjoint'><p>Extracts fitted values from a given model fitted with INLAjoint</p></a></li>
<li><a href='#fixef.INLAjoint'><p>Extracts fixed effects values from a given model fitted with INLAjoint</p></a></li>
<li><a href='#formula.INLAjoint'><p>Extracts formula from a given model fitted with INLAjoint</p></a></li>
<li><a href='#INLAjoint'><p>INLAjoint</p></a></li>
<li><a href='#INLAjoint.ginv'><p>Setup ginv</p></a></li>
<li><a href='#INLAjoint.object'><p>Fitted <code>joint</code> object</p></a></li>
<li><a href='#INLAjoint.rw'><p>Setup rw</p></a></li>
<li><a href='#INLAjoint.rw2'><p>Setup rw2</p></a></li>
<li><a href='#INLAjoint.scopy.define'><p>Setup scopy</p></a></li>
<li><a href='#joint'><p>Fit a multivariate joint model for longitudinal and/or survival data</p></a></li>
<li><a href='#joint.rerun'><p>Rerun a model fitted with INLAjoint</p></a></li>
<li><a href='#logLik.INLAjoint'><p>Extracts log-likelihood value from a given model fitted with INLAjoint</p></a></li>
<li><a href='#LongMS'><p>Simulated univariate longitudinal dataset</p></a></li>
<li><a href='#Longsim'><p>Simulated multivariate longitudinal dataset</p></a></li>
<li><a href='#nobs.INLAjoint'><p>Extracts number of observations of each composant from a given model fitted with INLAjoint</p></a></li>
<li><a href='#plot.INLAjoint'><p>Plot the output from a multivariate joint model for longitudinal and/or survival data</p></a></li>
<li><a href='#predict.INLAjoint'><p>Computes predictions for a given model fitted with INLAjoint</p></a></li>
<li><a href='#print.plot.INLAjoint'><p>Prints plot the output from a multivariate joint model for longitudinal and/or survival data</p></a></li>
<li><a href='#ranef.INLAjoint'><p>Extracts random effects values from a given model fitted with INLAjoint</p></a></li>
<li><a href='#setup_FE_model'><p>Setup fixed effects part for longitudinal marker k</p></a></li>
<li><a href='#setup_RE_model'><p>Setup random effects part for longitudinal marker k</p></a></li>
<li><a href='#setup_S_model'><p>Setup survival part for outcome m</p></a></li>
<li><a href='#setup_Y_model'><p>Setup outcome for longitudinal marker</p></a></li>
<li><a href='#SurvMS'><p>Simulated multi-state survival dataset</p></a></li>
<li><a href='#Survsim'><p>Simulated competing risks survival dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Joint Modeling for Longitudinal and Time-to-Event
Outcomes with 'INLA'</td>
</tr>
<tr>
<td>Version:</td>
<td>24.3.25</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of joint models for multivariate longitudinal markers (with various distributions available) and survival outcomes (possibly accounting for competing risks) with Integrated Nested Laplace Approximations (INLA). The flexible and user friendly function joint() facilitates the use of the fast and reliable inference technique implemented in the 'INLA' package for joint modeling. More details are given in the help page of the joint() function (accessible via ?joint in the R console) and the vignette associated to the joint() function (accessible via vignette("INLAjoint") in the R console).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DenisRustand/INLAjoint">https://github.com/DenisRustand/INLAjoint</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DenisRustand/INLAjoint/issues">https://github.com/DenisRustand/INLAjoint/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), utils, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, lme4, ggplot2, methods, Matrix, nlme, mvtnorm</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://inla.r-inla-download.org/R/testing">https://inla.r-inla-download.org/R/testing</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>INLA, knitr, rmarkdown, splines, graphics, grDevices, R.rsp,
survival, JMbayes2, rstanarm, frailtypack, smcure</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Denis Rustand &lt;INLAjoint@gmail.com&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 08:20:45 UTC; dr</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis Rustand <a href="https://orcid.org/0000-0001-9708-5220"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Elias Teixeira Krainski
    <a href="https://orcid.org/0000-0002-7063-2615"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Haavard Rue <a href="https://orcid.org/0000-0002-0222-1881"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Janet van Niekerk <a href="https://orcid.org/0000-0002-4334-2057"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.INLAjoint'>Extracts model coefficients from a given model fitted with INLAjoint</h2><span id='topic+coef.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts model coefficients from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="coef.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='family.INLAjoint'>Extracts family from a given model fitted with INLAjoint</h2><span id='topic+family.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts family from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
family(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="family.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="family.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='fitted.INLAjoint'>Extracts fitted values from a given model fitted with INLAjoint</h2><span id='topic+fitted.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts fitted values from INLAjoint objects.
Values are associated to a name to keep track of the outcome related to each fitted value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="fitted.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='fixef.INLAjoint'>Extracts fixed effects values from a given model fitted with INLAjoint</h2><span id='topic+fixef.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts fixed effects values from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
fixef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixef.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="fixef.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='formula.INLAjoint'>Extracts formula from a given model fitted with INLAjoint</h2><span id='topic+formula.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts formula from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.INLAjoint_+3A_x">x</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="formula.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='INLAjoint'>INLAjoint</h2><span id='topic+INLAjoint'></span>

<h3>Description</h3>

<p>INLAjoint is a package that fits joint models for multivariate longitudinal markers
(with various distributions available) and survival outcomes (possibly accounting
for competing risks) with Integrated Nested Laplace Approximations (INLA). The
flexible and user friendly function joint() facilitates the use of the fast and
reliable inference technique implemented in INLA package for joint modeling. More
details are given in the help page of the joint function (accessible via ?joint in
the R console), the vignette associated to the joint() function (accessible via
vignette(&quot;INLAjoint&quot;) in the R console).
</p>
<p>Contact: <a href="mailto:INLAjoint@gmail.com">INLAjoint@gmail.com</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint()
</code></pre>

<hr>
<h2 id='INLAjoint.ginv'>Setup ginv</h2><span id='topic+INLAjoint.ginv'></span>

<h3>Description</h3>

<p>Setup random walk
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint.ginv(x, tol = sqrt(.Machine$double.eps), rankdef = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INLAjoint.ginv_+3A_x">x</code></td>
<td>
<p>input</p>
</td></tr>
<tr><td><code id="INLAjoint.ginv_+3A_tol">tol</code></td>
<td>
<p>tolerance</p>
</td></tr>
<tr><td><code id="INLAjoint.ginv_+3A_rankdef">rankdef</code></td>
<td>
<p>rank
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ginv
</p>

<hr>
<h2 id='INLAjoint.object'>Fitted <code>joint</code> object</h2><span id='topic+INLAjoint.object'></span>

<h3>Description</h3>

<p>An object of class <code>INLAjoint</code> returned by the <code>joint</code>
function that fits a joint model to multivariate longitudinal and
time-to-event data. The following functions can apply to objects of this
class: <code>plot</code>, <code>print</code>, <code>summary</code> and <code>priors.used</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint.object
</code></pre>


<h3>Format</h3>

<p>An object of class <code>NULL</code> of length 0.
</p>


<h3>Value</h3>

<p>A list with the following components: </p>

<dl>
<dt><code>names.fixed</code></dt><dd><p>a vector with the name of the fixed effects of
the model. The corresponding submodel is indicated by the suffix including
a letter and a number (&quot;L&quot; for longitudinal and &quot;S&quot; for survival).</p>
</dd>
<dt><code>summary.fixed</code></dt><dd><p>summary statistics for the fixed effects of
the model. The summary statistics sorted by longitudinal and
survival components are available by applying the <code>summary</code> function
to the <code>INLAjoint</code> object.</p>
</dd>
<dt><code>summary.fixed</code></dt><dd><p>marginals for the fixed effects of the model.</p>
</dd>
<dt><code>mlik</code></dt><dd><p>log marginal-likelihood.</p>
</dd>
<dt><code>cpo</code></dt><dd><p>Conditional Predictive Ordinate.</p>
</dd>
<dt><code>gcpo</code></dt><dd><p>Group-Conditional Predictive Ordinate.</p>
</dd>
<dt><code>po</code></dt><dd><p>Predictive ordinate.</p>
</dd>
<dt><code>waic</code></dt><dd><p>Widely applicable Bayesian information criterion</p>
</dd>
<dt><code>model.random</code></dt><dd><p>a vector with the name of the random parameters of
the model, possibly including the following components: </p>

<dl>
<dt><code>RW1 model and RW2 model</code></dt><dd><p>Random walk of order 1 or 2
corresponding to Bayesian smoothing splines for the baseline hazard risk</p>
</dd>
<dt><code>IID model</code></dt><dd><p>Univariate random effect.</p>
</dd>
<dt><code>IIDKD model</code></dt><dd><p>Multivariate random effects.</p>
</dd>
<dt><code>Copy</code></dt><dd><p>association parameter.</p>
</dd></dl>
</dd>
<dt><code>summary.random</code></dt><dd><p>summary statistics for the random parameters of the model.</p>
</dd>
<dt><code>marginals.random</code></dt><dd><p>marginals for the random parameters of the model.</p>
</dd>
<dt><code>size.random</code></dt><dd><p>size of the random parameters of the model.</p>
</dd>
<dt><code>summary.linear.predictor</code></dt><dd><p>summary statistics of the linear predictors.</p>
</dd>
<dt><code>marginals.linear.predictor</code></dt><dd><p>marginals for the linear predictors.</p>
</dd>
<dt><code>summary.fitted.values</code></dt><dd><p>summary statistics of the fitted values.</p>
</dd>
<dt><code>marginals.fitted.values</code></dt><dd><p>marginals for the fitted values.</p>
</dd>
<dt><code>size.linear.predictor</code></dt><dd><p>size of the linear predictors.</p>
</dd>
<dt><code>summary.hyperpar</code></dt><dd><p>summary statistics for the hyperparameters of
the model. The summary statistics sorted by longitudinal and
survival components are available by applying the <code>summary</code> function
to the <code>INLAjoint</code> object. Particularly, this is the raw output of INLA
and therefore the precision of the residual errors and baseline hazard functions
hyperparameters are provided. Similarly, the Cholesky matrix is given for the
random-effects. The summary function can easily return either variance and covariance
or standard deviations and correlations for all these hyperparameters.</p>
</dd>
<dt><code>marginals.hyperpar</code></dt><dd><p>marginals for the hyperparameters of the model.</p>
</dd>
<dt><code>internal.summary.hyperpar</code></dt><dd><p>summary of the internal hyperparameters,
this is similar to the summary of the hyperparameters but here they are provided as used
for the computations (logarithm scale for residual error and baseline risk hyperparameters).</p>
</dd>
<dt><code>internal.marginals.hyperpar</code></dt><dd><p>marginals for the internal hyperparameters of the model.</p>
</dd>
<dt><code>misc</code></dt><dd><p>miscellaneous (as provided in the INLA output).</p>
</dd>
<dt><code>dic</code></dt><dd><p>Deviance Information Criterion.</p>
</dd>
<dt><code>mode</code></dt><dd><p>.</p>
</dd>
<dt><code>joint.hyper</code></dt><dd><p>.</p>
</dd>
<dt><code>nhyper</code></dt><dd><p>.</p>
</dd>
<dt><code>version</code></dt><dd><p>Version of INLA.</p>
</dd>
<dt><code>cpu.used</code></dt><dd><p>Computation time of INLA.</p>
</dd>
<dt><code>all.hyper</code></dt><dd><p>.</p>
</dd>
<dt><code>.args</code></dt><dd><p>.</p>
</dd>
<dt><code>call</code></dt><dd><p>INLA call.</p>
</dd>
<dt><code>selection</code></dt><dd><p>information about parameters for sampling with inla.rjmarginal.</p>
</dd>
<dt><code>cureVar</code></dt><dd><p>informations about cure fraction submodel for mixture cure survival models.</p>
</dd>
<dt><code>variant</code></dt><dd><p>information about variant for Weibull baseline hazards.</p>
</dd>
<dt><code>SurvInfo</code></dt><dd><p>some information about survival submodels (names of event
indicator and event time variables as well as baseline hazard).</p>
</dd>
<dt><code>famLongi</code></dt><dd><p>list of distributions for the longitudinal markers.</p>
</dd>
<dt><code>corLong</code></dt><dd><p>boolean indicating if random effects are correlated accross markers.</p>
</dd>
<dt><code>control.link</code></dt><dd><p>informations about link function (1=default).</p>
</dd>
<dt><code>longOutcome</code></dt><dd><p>name of longitudinal outcomes.</p>
</dd>
<dt><code>survOutcome</code></dt><dd><p>name of survival outcomes.</p>
</dd>
<dt><code>assoc</code></dt><dd><p>vector with names of all association parameters (longi-surv).</p>
</dd>
<dt><code>id</code></dt><dd><p>name of the id variable.</p>
</dd>
<dt><code>timeVar</code></dt><dd><p>name of time variable.</p>
</dd>
<dt><code>range</code></dt><dd><p>information about range of X-axis values for non-linear associations.</p>
</dd>
<dt><code>REstruc</code></dt><dd><p>names of the grouped random effects for the longitudinal markers.</p>
</dd>
<dt><code>mat_k</code></dt><dd><p>contains the list of random effects covariance matrices when they are
fixed as they are not part of the estimated parameters (used for displaying them in summary).</p>
</dd>
<dt><code>fixRE</code></dt><dd><p>list of the size of number of groups of random effects, each element is a
boolean indicating if the random effects of the group is fixed (TRUE) or estimated (FALSE).</p>
</dd>
<dt><code>lonFacChar</code></dt><dd><p>list of factors and character covariates included in the longitudinal
submodels to keep track of modalities (used internally when doing predictions to reconstruct
categorical covariates).</p>
</dd>
<dt><code>survFacChar</code></dt><dd><p>same as lonFacChar but for survival submodels.</p>
</dd>
<dt><code>corRE</code></dt><dd><p>list indicating if groups of random effects are correlated within
longitudinal submodels.</p>
</dd>
<dt><code>basRisk</code></dt><dd><p>list of the baseline risk used for each survival submodel.</p>
</dd>
<dt><code>priors_used</code></dt><dd><p>informations about priors used in the model, internally used
to display priors in plots (with argument priors=TRUE in the call of the plot function).
Note that priors can also be displayed with the function priors.used() applied to an
INLAjoint object.</p>
</dd>
<dt><code>dataLong</code></dt><dd><p>name of the longitudinal dataset.</p>
</dd>
<dt><code>dataSurv</code></dt><dd><p>name of the survival dataset.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+joint">joint</a></code>.
</p>

<hr>
<h2 id='INLAjoint.rw'>Setup rw</h2><span id='topic+INLAjoint.rw'></span>

<h3>Description</h3>

<p>Setup random walk
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint.rw(n, order = 1L, sparse = TRUE, scale.model = FALSE, cyclic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INLAjoint.rw_+3A_n">n</code></td>
<td>
<p>number of knots</p>
</td></tr>
<tr><td><code id="INLAjoint.rw_+3A_order">order</code></td>
<td>
<p>order 1</p>
</td></tr>
<tr><td><code id="INLAjoint.rw_+3A_sparse">sparse</code></td>
<td>
<p>boolean, sparsity</p>
</td></tr>
<tr><td><code id="INLAjoint.rw_+3A_scale.model">scale.model</code></td>
<td>
<p>boolean, scale</p>
</td></tr>
<tr><td><code id="INLAjoint.rw_+3A_cyclic">cyclic</code></td>
<td>
<p>boolean, cyclic
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>random walk 1
</p>

<hr>
<h2 id='INLAjoint.rw2'>Setup rw2</h2><span id='topic+INLAjoint.rw2'></span>

<h3>Description</h3>

<p>Setup random walk of order 2
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint.rw2(n, order = 2L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INLAjoint.rw2_+3A_n">n</code></td>
<td>
<p>number of knots</p>
</td></tr>
<tr><td><code id="INLAjoint.rw2_+3A_order">order</code></td>
<td>
<p>order 2</p>
</td></tr>
<tr><td><code id="INLAjoint.rw2_+3A_...">...</code></td>
<td>
<p>additional arguments passed to INLAjoint.rw
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>random walk 2
</p>

<hr>
<h2 id='INLAjoint.scopy.define'>Setup scopy</h2><span id='topic+INLAjoint.scopy.define'></span>

<h3>Description</h3>

<p>Setup weights for non-linear effects
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>INLAjoint.scopy.define(n = 5L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INLAjoint.scopy.define_+3A_n">n</code></td>
<td>
<p>number of knots
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with weights for scopy
</p>

<hr>
<h2 id='joint'>Fit a multivariate joint model for longitudinal and/or survival data</h2><span id='topic+joint'></span>

<h3>Description</h3>

<p>This function fits a multivariate joint model for longitudinal and/or survival data.
The longitudinal outcomes are modeled with mixed effects models and can handle various distributions.
The survival outcomes (i.e., terminal event with possibly competing risks) are modeled with Cox proportional
hazards regression models. Various association structures can be specified between the longitudinal and
survival outcomes. The inference is based on Integrated Nested Laplace Approximations (Rue et al., 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint(
  formSurv = NULL,
  formLong = NULL,
  dataSurv = NULL,
  dataLong = NULL,
  id = NULL,
  timeVar = NULL,
  family = "gaussian",
  link = "default",
  basRisk = "rw1",
  NbasRisk = 15,
  cutpoints = NULL,
  assoc = NULL,
  assocSurv = NULL,
  corLong = FALSE,
  corRE = TRUE,
  dataOnly = FALSE,
  longOnly = FALSE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joint_+3A_formsurv">formSurv</code></td>
<td>
<p>the formula for the time-to-event outcome, with the response given as an inla.surv() object.
Keep it as NULL if no survival part is needed and give a list of formulas for competing risks.</p>
</td></tr>
<tr><td><code id="joint_+3A_formlong">formLong</code></td>
<td>
<p>the formula for the longitudinal outcome, structured as with the lme4 package
(Mächler et al., 2015) for linear mixed-effects models (i.e., including random effects within parenthesis).
Keep it as NULL if no longitudinal part is needed and give a list of formulas for multivariate longitudinal.</p>
</td></tr>
<tr><td><code id="joint_+3A_datasurv">dataSurv</code></td>
<td>
<p>the dataset for the survival part. Keep it as NULL if no survival part is needed or if
the survival data is in the longitudinal dataset (it will extract the last line for each individual as
the survival dataset).</p>
</td></tr>
<tr><td><code id="joint_+3A_datalong">dataLong</code></td>
<td>
<p>the dataset for the longitudinal part. Keep it as NULL if no longitudinal part is needed.
For multivariate longitudinal models, either give one dataset with all outcomes and covariates or
a list of datasets for each longitudinal marker.</p>
</td></tr>
<tr><td><code id="joint_+3A_id">id</code></td>
<td>
<p>the name of the variable to identify individuals or grouped repeated measurements.
Keep is as NULL if no longitudinal part is needed.</p>
</td></tr>
<tr><td><code id="joint_+3A_timevar">timeVar</code></td>
<td>
<p>a character string (or a vector) giving the name of the time-varying variable(s). Functions of time can
be included in formulas, they first need to be set up as a univariate function with name fX,
where X is a number between 1 and 20. Then the function can be used directly in the formula (see example below).</p>
</td></tr>
<tr><td><code id="joint_+3A_family">family</code></td>
<td>
<p>a character string (or a vector) giving the name of families for the longitudinal outcomes. The
list of the available families is given by names(inla.models()$likelihood).</p>
</td></tr>
<tr><td><code id="joint_+3A_link">link</code></td>
<td>
<p>a character string (or a vector) giving the link function associated to the families for the longitudinal
outcomes. The links available for a family is given in the associated doc: inla.doc(&quot;familyName&quot;).
The link should be a vector of the same size as the family parameter and should be set to &quot;default&quot; for default
(i.e., identity for gaussian, log for poisson, logit for bimomial,...).</p>
</td></tr>
<tr><td><code id="joint_+3A_basrisk">basRisk</code></td>
<td>
<p>the baseline risk of event (should be a vector in case of competing risks). It can be defined as
parametric with either &quot;exponentialsurv&quot; for exponential baseline or &quot;weibullsurv&quot; for Weibull baseline
(note that there are two formulations of the Weibull distribution, see 'inla.doc(&quot;weibull&quot;)' for more details,
default is variant = 0).
Alternatively, there are two options to avoid parametric assumptions on the shape of the baseline risk: &quot;rw1&quot;
for random walks of order one prior that corresponds to a smooth spline function based
on first order differences. The second option &quot;rw2&quot; assigns a random walk order two prior that
corresponds to a smooth spline function based on second order differences. This second option
provides a smoother spline compared to order one since the smoothing is then done on the second order.</p>
</td></tr>
<tr><td><code id="joint_+3A_nbasrisk">NbasRisk</code></td>
<td>
<p>the number of intervals for the baseline risk function, only one value should be provided
and the same number of intervals is used for each risk submodel in case of competing risks.</p>
</td></tr>
<tr><td><code id="joint_+3A_cutpoints">cutpoints</code></td>
<td>
<p>a vector with baseline hazard cutpoints if not using equidistant (if not NULL, this replaces the
NbasRisk parameter).</p>
</td></tr>
<tr><td><code id="joint_+3A_assoc">assoc</code></td>
<td>
<p>a character string that specifies the association between the longitudinal and survival
components. The available options are &quot;CV&quot; for sharing the current value of the linear predictor, &quot;CS&quot;
for the current slope, &quot;CV_CS&quot; for the current value and the current slope, &quot;SRE&quot; for shared random effects
(i.e., sharing the individual deviation from the mean at time t as defined by the random effects),
&quot;SRE_ind&quot; for shared random effect independent (each random effect's individual deviation is associated
to an association parameter in the survival submodel) and &quot;&quot;
(empty string) for no association. When there are either
multiple longitudinal markers or multiple competing events, this should be a vector. In
case of both multiple markers and events, it should be a list with one element per longitudinal marker
and each element is a vector of association for each competing event. Keep it as NULL to have no
association between longitudinal and survival components or if there is no survival component.</p>
</td></tr>
<tr><td><code id="joint_+3A_assocsurv">assocSurv</code></td>
<td>
<p>a boolean that indicates if a frailty term (i.e., random effect) from a survival model
should be shared into another survival model. The order is important, the first model in the list of
survival formulas ('formSurv') should include a random effect and it can be shared in the next formulas.
Multiple survival models with random effects can be accomodated and a random effect can be shared in
multiple survival models, following the same structure as 'assoc' (i.e., vector of booleans if one random effect is
shared in multiple survival and list of vectors if multiple survival models with random effects share
their random effects in multiple survival models).</p>
</td></tr>
<tr><td><code id="joint_+3A_corlong">corLong</code></td>
<td>
<p>a boolean that only applies when multiple longitudinal markers are fitted: should
the random effects  accross markers be correlated (TRUE) or independent (FALSE)? Default is FALSE.</p>
</td></tr>
<tr><td><code id="joint_+3A_corre">corRE</code></td>
<td>
<p>list of the size of number of groups of random effects (i.e., equal to 1 if there is only one
longitudinal marker or if corLong is TRUE and equal to the number of markers otherwise), each element is a
boolean indicating if the random effects of the group must be correlated or independent (i.e.,
diagonal variance-covariance). Default is FALSE.</p>
</td></tr>
<tr><td><code id="joint_+3A_dataonly">dataOnly</code></td>
<td>
<p>a boolean to only prepare the data with the correct format without running the model.</p>
</td></tr>
<tr><td><code id="joint_+3A_longonly">longOnly</code></td>
<td>
<p>a boolean to only prepare the data for the longitudinal part of a longitudinal-survival joint model
with the correct format without running the model.</p>
</td></tr>
<tr><td><code id="joint_+3A_control">control</code></td>
<td>
<p>a list of control values that can be set with control=list(), with components: </p>

<dl>
<dt><code>priorFixed</code></dt><dd><p>list with mean and standard deviations for the Gaussian prior distribution
for the fixed effects. Default is <code>list(mean=0, prec=0.01, mean.intercept=0, prec.intercept=0.01)</code>,
where mean and prec are the mean and precision (i.e., inverse of the variance) of the fixed effects,
respectively and mean.intercept and prec.intercept are the corresponding parameters for the fixed
intercept.</p>
</dd>
<dt><code>priorAssoc</code></dt><dd><p>list with mean and standard deviations for the Gaussian prior distribution
for the association parameters (does not apply to &quot;SRE_ind&quot; association and shared random effect from survival
models (frailty), see next item for those two). Default is <code>list(mean=0, prec=0.01)</code></p>
</dd>
<dt><code>priorSRE_ind</code></dt><dd><p>list with mean and standard deviations for the Gaussian prior distribution
for the association of independent random effects (&quot;SRE_ind&quot; and survival frailty random effects shared).
Default is <code>list(mean=0, prec=1)</code></p>
</dd>
<dt><code>priorRandom</code></dt><dd><p>list with prior distribution for the multivariate random effects
(Inverse Wishart). Default is <code>list(r=10, R=1)</code>, see &quot;inla.doc(&quot;iidkd&quot;) for more details.</p>
</dd>
<dt><code>initVC</code></dt><dd><p>list of the size of number of groups of random effects giving initial values for
variance-covariance of random effects, first values are variance and then covariances (as displayed in summary).
All the elements of the covariance matrix must be fixed but in case of multiple groups of random effects,
it is possible to fix initial values for only some groups, then elements in the list that are not initialized must be an empty string.</p>
</dd>
<dt><code>initSD</code></dt><dd><p>same as initVC but to fix standard deviations and correlations instead
(only one of these two arguments can be used).</p>
</dd>
<dt><code>strata</code></dt><dd><p>list of the same size as the number of survival submodels, giving the name of
covariates for stratified proportional hazards model (default is NULL).</p>
</dd>
<dt><code>fixRE</code></dt><dd><p>list of the size of number of groups of random effects, each element is a
boolean indicating if the random effects of the group must be fixed or estimated.</p>
</dd>
<dt><code>assocInit</code></dt><dd><p>Initial value for all the association parameters (default is 0.1).</p>
</dd>
<dt><code>int.strategy</code></dt><dd><p>a character string giving the strategy for the numerical integration
used to approximate the marginal posterior distributions of the latent field. Available options are
&quot;ccd&quot; (default), &quot;grid&quot; or &quot;eb&quot; (empirical Bayes). The empirical Bayes uses only the mode of the
approximations for the integration, which speed up and simplifies computations. It can be pictured as
a tradeoff between Bayesian and frequentist estimation strategies while the default full Bayesian
accounts for uncertainty by using the mode and the curvature at the mode.</p>
</dd>
<dt><code>Ntrials</code></dt><dd><p>Number of trials for binomial and Betabinomial distributions, default is NULL.</p>
</dd>
<dt><code>cpo</code></dt><dd><p>TRUE/FALSE: Default is FALSE, set to TRUE to compute the Conditional Predictive Ordinate.</p>
</dd>
<dt><code>cfg</code></dt><dd><p>TRUE/FALSE: Default is FALSE, set to TRUE to be able to sample from the posterior
distribution.</p>
</dd>
<dt><code>safemode</code></dt><dd><p>TRUE/FALSE: use the INLA safe mode (automatically reruns in case of negative
eigenvalue(s) in the Hessian, reruns with adjusted starting values in case of crash). Default is TRUE
(activated).
The message &ldquo;'*** inla.core.safe&ldquo;' appears when the safe mode is running, it improves the inference
of the hyperparameters and can be ignored. To remove this safe mode, switch the boolean to FALSE (it can
save some computation time but may return slightly less precise estimates for some hyperparameters).
</p>
</dd>
<dt><code>rerun</code></dt><dd><p>TRUE/FALSE: the model reruns to improve numerical stability (default is FALSE).</p>
</dd>
<dt><code>tolerance</code></dt><dd><p>accuracy in the inner optimization (default is 0.005).</p>
</dd>
<dt><code>h</code></dt><dd><p>step-size for the hyperparameters (default is 0.005).</p>
</dd>
<dt><code>verbose</code></dt><dd><p>TRUE/FALSE: prints details of the INLA algorithm. Default is FALSE.</p>
</dd>
<dt><code>keep</code></dt><dd><p>TRUE/FALSE: keep internal files. Default is FALSE. (expert option)</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>INLAjoint</code>. See <code><a href="#topic+INLAjoint.object">INLAjoint.object</a></code> for
details.
</p>


<h3>References</h3>

<p>Rustand, D., van Niekerk, J., Teixeira Krainski, E., Rue, H. and Proust-Lima, C. (2023).
Fast and flexible inference for joint models of multivariate longitudinal and survival
data using integrated nested Laplace approximations. Biostatistics, 2023, kxad019.
https://doi.org/10.1093/biostatistics/kxad019
https://arxiv.org/abs/2203.06256
</p>
<p>Rustand, D., van Niekerk, J., Rue, H., Tournigand, C., Rondeau, V. and Briollais, L. (2023).
Bayesian Estimation of Two-Part Joint Models for a Longitudinal Semicontinuous Biomarker
and a Terminal Event with R-INLA: Interests for Cancer Clinical Trial Evaluation.
Biometrical Journal, 65, 2100322.
https://doi.org/10.1002/bimj.202100322
https://arxiv.org/abs/2010.13704
</p>
<p>Rue, H., Martino, S. and Chopin, N. (2009). Approximate Bayesian inference for latent
Gaussian models by using integrated nested Laplace approximations. Journal of the Royal
Statistical Society: Series B (Statistical Methodology), 71: 319-392.
https://doi.org/10.1111/j.1467-9868.2008.00700.x
</p>
<p>Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2015). Fitting Linear Mixed-Effects
Models Using lme4. Journal of Statistical Software, 67(1), 1–48.
https://doi.org/10.18637/jss.v067.i01
</p>
<p>Contact: <a href="mailto:INLAjoint@gmail.com">INLAjoint@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># joint model with 3 longitudinal / 3 competing risks of event
data(Longsim)
data(Survsim)
f1 &lt;- function(x) x^2 # quadratic function of time for first marker
Nsplines &lt;- splines::ns(Longsim$time, knots=2) # 2 ns splines for second marker
f2 &lt;- function(x) predict(Nsplines, x)[,1]
f3 &lt;- function(x) predict(Nsplines, x)[,2]

if(requireNamespace("INLA")){
 JMINLA &lt;- joint(
  formLong = list(Y1 ~ time + f1(time) + ctsX + binX + (1 + time + f1(time) | Id),
                  Y2 ~ time + f2(time) + f3(time) + ctsX + binX + (1 | Id),
                  Y3 ~ time + ctsX + binX + (1 | Id)),
  formSurv = list(INLA::inla.surv(deathTimes, Event1) ~ binX + ctsX,
                  INLA::inla.surv(deathTimes, Event2) ~ binX,
                  INLA::inla.surv(deathTimes, Event3) ~ ctsX),
  dataLong = Longsim, dataSurv=Survsim, id = "Id", timeVar = "time", corLong=TRUE,
  family = c("gaussian", "poisson", "binomial"), basRisk = c("rw1", "rw1", "rw1"),
  assoc = list(c("CV", "CS", ""),  c("CV", "", "SRE"), c("", "CV", "")),
  control=list(int.strategy="eb"))

 summary(JMINLA)
 # 'sdcor' to switch from variance-covariance to standard
 # deviation-correlation and 'hazr' to switch parameters
 # in survival submodels from mean to hazard ratios (exp(mean)).
 summary(JMINLA, sdcor=TRUE, hazr=TRUE)
}
</code></pre>

<hr>
<h2 id='joint.rerun'>Rerun a model fitted with INLAjoint</h2><span id='topic+joint.rerun'></span>

<h3>Description</h3>

<p>Reruns inla() for an object of class <code>INLAjoint</code> returned by the <code>joint</code>
function. The rerun starts with posterior values from previous run and can sometimes improve the model fit
(for very complex models or unstable parameter estimates due to low information in the data)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint.rerun(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joint.rerun_+3A_model">model</code></td>
<td>
<p>an object containing a model fitted with the joint() function.</p>
</td></tr>
<tr><td><code id="joint.rerun_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>INLAjoint</code> containing a model fitted with the joint() function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+joint">joint</a></code>.
</p>

<hr>
<h2 id='logLik.INLAjoint'>Extracts log-likelihood value from a given model fitted with INLAjoint</h2><span id='topic+logLik.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts log-likelihood value from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="logLik.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='LongMS'>Simulated univariate longitudinal dataset</h2><span id='topic+LongMS'></span>

<h3>Description</h3>

<p>A simulated dataset used to illustrate joint models with univariate longitudinal and multi-state survival component (see joint longitudinal and multi-state model in INLAjoint vignette). The corresponding survival dataset is named 'SurvMS'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LongMS
</code></pre>


<h3>Format</h3>

<p>## 'LongMS'
A data frame with 96 rows and 7 columns:
</p>

<dl>
<dt>id</dt><dd><p>Individual id</p>
</dd>
<dt>time</dt><dd><p>Visit times</p>
</dd>
<dt>X</dt><dd><p>Continuous covariate</p>
</dd>
<dt>y</dt><dd><p>Gaussian longitudinal outcome</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='Longsim'>Simulated multivariate longitudinal dataset</h2><span id='topic+Longsim'></span>

<h3>Description</h3>

<p>A simulated dataset used to illustrate some models (e.g., example of joint() function in the documentation). The corresponding survival dataset is named 'Survsim'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Longsim
</code></pre>


<h3>Format</h3>

<p>## 'Longsim'
A data frame with 96 rows and 7 columns:
</p>

<dl>
<dt>Id</dt><dd><p>Individual id</p>
</dd>
<dt>time</dt><dd><p>Visit times</p>
</dd>
<dt>ctsX</dt><dd><p>Continuous covariate</p>
</dd>
<dt>binX</dt><dd><p>Binary covariate</p>
</dd>
<dt>Y1, Y2, Y3</dt><dd><p>Gaussian Longitudinal outcomes</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='nobs.INLAjoint'>Extracts number of observations of each composant from a given model fitted with INLAjoint</h2><span id='topic+nobs.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts number of observations of each composant from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="nobs.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.INLAjoint'>Plot the output from a multivariate joint model for longitudinal and/or survival data</h2><span id='topic+plot.INLAjoint'></span>

<h3>Description</h3>

<p>This function provide plots for the output of a
multivariate joint model for longitudinal and/or survival data.
The output can be stored into an object and manipulated as
a list of ggplot outputs, described bellow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.INLAjoint_+3A_x">x</code></td>
<td>
<p>an object with the output of the the <a href="#topic+joint">joint</a> function</p>
</td></tr>
<tr><td><code id="plot.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments including:
<code>sdcor</code>: logical indicating if the random effects
correlation are to be shown. If FALSE the covariance is shown.
<code>priors</code>: logical indicating if the priors are added to the posterior marginals plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a named list of <code>ggplot</code> objects containing:
</p>

<dl>
<dt><code>Outcomes</code></dt><dd>
<p>as a list of length equal the number of longitudinal
outcomes plus the number of survival outcomes, each one including
the plot for the posterior marginals of the associated fixed effects
and residual or baseline variance (or standard error).
Each element contains the plot for the posterior marginal.</p>
</dd>
<dt><code>Covariances</code></dt><dd>
<p>the plots for the posterior marginal distribution of the
covariance parameters.</p>
</dd>
<dt><code>Associations</code></dt><dd>
<p>the plots for the posterior marginal distribution of the
association parameters.</p>
</dd>
<dt><code>Random</code></dt><dd>
<p>The plot for the fitted baseline risk functions as shown
as the posterior mean and credible interval.</p>
</dd>
</dl>


<hr>
<h2 id='predict.INLAjoint'>Computes predictions for a given model fitted with INLAjoint</h2><span id='topic+predict.INLAjoint'></span>

<h3>Description</h3>

<p>This function allows to compute predictions for a given model fitted with INLAjoint,
the default behavior (without arguments) returns fitted values for each component of the model. It
is also possible to supply a dataset for which predictions are required, this dataset must have
the same structure as the dataset used for the model fitting (i.e., same columns). The default
returned predictions corresponds to the linear predictors for each outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
predict(
  object,
  newData = NULL,
  timePoints = NULL,
  NtimePoints = 50,
  strategy = 1,
  Nsample = 300,
  NsampleRE = 50,
  loopRE = FALSE,
  id = NULL,
  Csurv = NULL,
  horizon = NULL,
  baselineHaz = "interpolation",
  return.samples = FALSE,
  survival = FALSE,
  CIF = FALSE,
  inv.link = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_newdata">newData</code></td>
<td>
<p>a dataset with the same columns as those used to fit the model. When using a longitudinal
marker to predict longitudinal and subsequent survival outcomes, only the longitudinal information (i.e.,
structure of the longitudinal data) is required. It is also possible to predict the average trajectories
conditional on covariates by setting the value of the longitudinal outcomes included in the model to NA.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_timepoints">timePoints</code></td>
<td>
<p>a vector of the time points at which predictions are computed (for both longitudinal
and survival outcomes), this also control the precision of the integration for time-dependent shared
terms and the computation of cumulative risks (e.g., for survival or CIF curves), thus many time points
will increase the accuracy of predictions. Default is NULL as these time points are automatically computed
when not defined manually.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_ntimepoints">NtimePoints</code></td>
<td>
<p>number of time points at which the predictions are computed (for both longitudinal
and survival outcomes), these time points are equidistant between time 0 and horizon time.
This also control the precision of the integration for time-dependent shared
terms and the computation of cumulative risks (e.g., for survival or CIF curves), thus many time points
will increase the accuracy of predictions.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_strategy">strategy</code></td>
<td>
<p>strategy to compute predictions. Only strategy 1 is implemented at the moment, soon
more efficient strategies are going to be implemented to allow for large scale preeictions.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_nsample">Nsample</code></td>
<td>
<p>number of samples for fixed effects and hyperparameters used to assess uncertainty
when computing predictions. Default is 300.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_nsamplere">NsampleRE</code></td>
<td>
<p>number of random effects realizations for each sample specified in 'Nsample'. These
random effects realizations are conditional on observed longitudinal outcomes values provided in
'newData'. When outcomes are set to NA, the realizations are sampled from the marginal distribution
of random effects.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_loopre">loopRE</code></td>
<td>
<p>boolean with default to FALSE. When 'NsampleRE' and 'Nsample' are large, the amount of
information to store in the random access memory of the computer can be large (creation of large matrices
for the computation of predictions), turning this boolean to TRUE will decompose the computation of
predictions to avoid reaching the limit of RAM of the computer (which would crash the program).</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_id">id</code></td>
<td>
<p>name of the individual id variable, default is NULL as it is automatically grabbed from the
fitted model but when fitting simple survival models, providing id when fitting the model is not
mandatory and thus this can be useful (an explicit message is printed in this specific case).</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_csurv">Csurv</code></td>
<td>
<p>conditional survival, gives the starting value of the at-risk period (i.e., starting value
at which risk predictions for survival models are computed).
Default is the last longitudinal observation time provided in 'newData' but this is
replaced by the value of 'Csurv' when provided.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_horizon">horizon</code></td>
<td>
<p>horizon of the prediction.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_baselinehaz">baselineHaz</code></td>
<td>
<p>method used to evaluate the baseline hazard value, default is 'interpolation'
which is currently recommended. Experimental alternatives are being developed, including 'splines'
for an interpolation with splines but has not been properly validated with simulations yet.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_return.samples">return.samples</code></td>
<td>
<p>boolean, when set to TRUE the samples are returned instead of summary
statistics over the samples. Default is FALSE.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_survival">survival</code></td>
<td>
<p>boolean, when set to TRUE the summary statistics over survival functions are
computed in addition to the summary statistics over the risk functions.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_cif">CIF</code></td>
<td>
<p>boolean, when set to TRUE the summary statistics over cumulative incidence functions are
computed in addition to the summary statistics over the risk functions. Only applies to competing risks.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_inv.link">inv.link</code></td>
<td>
<p>boolean, when set to TRUE the summary statistics are computed over the predictions of
longitudinal components after applying the inverse link function for each samples in addition to the
summary statistics over the linear predictors.</p>
</td></tr>
<tr><td><code id="predict.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.plot.INLAjoint'>Prints plot the output from a multivariate joint model for longitudinal and/or survival data</h2><span id='topic+print.plot.INLAjoint'></span>

<h3>Description</h3>

<p>The plots of a model are grouped by categories, first are the fixed effects and
residual error of longitudinal and survival submodels, referred to as 'Outcomes' or 'O'. Then the
variance-covariance of random effects (or standard deviations and correlations when the
argument 'sdcor' is set to TRUE in the call of the plot function), referred to as
'Covariances' or 'C'. Association parameters referred to as 'Associations' or 'A' for
linear associations and 'NL_Associations' or 'N' for non-linear associations. Baseline
hazard curves referred to as 'Baseline' or 'B' and baseline hazard related parameters
referred to as 'ParamBaseline' or 'P'. It is possible to select specific plots to
print by specifying the names or corresponding letters in the argument 'which'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot.INLAjoint'
print(
  x,
  which = c("all", "Outcomes", "Covariances", "Associations", "Baseline"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.plot.INLAjoint_+3A_x">x</code></td>
<td>
<p>an object with the output of the the <a href="#topic+joint">joint</a> function</p>
</td></tr>
<tr><td><code id="print.plot.INLAjoint_+3A_which">which</code></td>
<td>
<p>name of required plots. Default is &quot;all&quot;.
It can be a character or named list.
If it is a list, each element can be either character or numeric to
select from the elements to be visualized.
Ex.: which = list(Outcomes = &quot;L1&quot;) and list(Outcomes = 1)
will produce the same output.</p>
</td></tr>
<tr><td><code id="print.plot.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='ranef.INLAjoint'>Extracts random effects values from a given model fitted with INLAjoint</h2><span id='topic+ranef.INLAjoint'></span>

<h3>Description</h3>

<p>This function extracts random effects values from INLAjoint objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'INLAjoint'
ranef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef.INLAjoint_+3A_object">object</code></td>
<td>
<p>an object that contains a model fitted with INLAjoint.</p>
</td></tr>
<tr><td><code id="ranef.INLAjoint_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='setup_FE_model'>Setup fixed effects part for longitudinal marker k</h2><span id='topic+setup_FE_model'></span>

<h3>Description</h3>

<p>Setup fixed effects part for longitudinal marker k  (internal function)
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_FE_model(formula, dataset, timeVar, k, dataOnly)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_FE_model_+3A_formula">formula</code></td>
<td>
<p>with lme4 format (fixed effects and random effects in the same object)</p>
</td></tr>
<tr><td><code id="setup_FE_model_+3A_dataset">dataset</code></td>
<td>
<p>that contains the outcome</p>
</td></tr>
<tr><td><code id="setup_FE_model_+3A_timevar">timeVar</code></td>
<td>
<p>name of time variable</p>
</td></tr>
<tr><td><code id="setup_FE_model_+3A_k">k</code></td>
<td>
<p>identifies the longitudinal marker among 1:K markers</p>
</td></tr>
<tr><td><code id="setup_FE_model_+3A_dataonly">dataOnly</code></td>
<td>
<p>boolean for internal use, indicates if only preparing data (i.e., not fitting the model)
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>colnames(FE) names of the fixed effects (interactions are separated
by &quot;.X.&quot; instead of &quot;:&quot; to facilitate their manipulation)
</p>
<p>FE values of the fixed effects
</p>

<hr>
<h2 id='setup_RE_model'>Setup random effects part for longitudinal marker k</h2><span id='topic+setup_RE_model'></span>

<h3>Description</h3>

<p>Setup random effects part for longitudinal marker k  (internal function)
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_RE_model(formula, dataset, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_RE_model_+3A_formula">formula</code></td>
<td>
<p>with lme4 format (fixed effects and random effects in the same object)</p>
</td></tr>
<tr><td><code id="setup_RE_model_+3A_dataset">dataset</code></td>
<td>
<p>that contains the outcome</p>
</td></tr>
<tr><td><code id="setup_RE_model_+3A_k">k</code></td>
<td>
<p>identifies the longitudinal marker among 1:K markers
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>colnames(RE_mat) names of the random effects
</p>
<p>RE_mat values of the random effects
</p>

<hr>
<h2 id='setup_S_model'>Setup survival part for outcome m</h2><span id='topic+setup_S_model'></span>

<h3>Description</h3>

<p>Setup survival part for outcome m (internal function)
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_S_model(
  formula,
  formLong,
  dataSurv,
  LSurvdat,
  timeVar,
  assoc,
  id,
  m,
  K,
  M,
  NFT,
  corLong,
  dataOnly,
  SurvInfo,
  strata
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_S_model_+3A_formula">formula</code></td>
<td>
<p>with inla.surv() object as an outcome</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_formlong">formLong</code></td>
<td>
<p>formula from the longitudinal part, if any</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_datasurv">dataSurv</code></td>
<td>
<p>dataset(s) for the survival part</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_lsurvdat">LSurvdat</code></td>
<td>
<p>dataset for the longitudinal part converted to survival format (internal, used to get covariates
if missing in the survival dataset when sharing linear predictors including covariates from longitudinal into survival)</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_timevar">timeVar</code></td>
<td>
<p>names of the variables that are time-dependent (only linear for now)</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_assoc">assoc</code></td>
<td>
<p>association parameters between K longitudinal outcomes and M survival outcomes (list of K vectors of size M)</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_id">id</code></td>
<td>
<p>name of the variable that gives the individual id</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_m">m</code></td>
<td>
<p>identifies the outcome among 1:M time-to-event outcomes</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_k">K</code></td>
<td>
<p>number of longitudinal outcomes</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_m">M</code></td>
<td>
<p>number of survival outcomes</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_nft">NFT</code></td>
<td>
<p>maximum number of functions of time (fixed value)</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_corlong">corLong</code></td>
<td>
<p>boolean that indicates if random effects across longitudinal markers are correlated,
when multiple longitudinal markers are included in the model</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_dataonly">dataOnly</code></td>
<td>
<p>boolean for internal use, indicates if only preparing data (i.e., not fitting the model)</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_survinfo">SurvInfo</code></td>
<td>
<p>information about survival submodels for internal use</p>
</td></tr>
<tr><td><code id="setup_S_model_+3A_strata">strata</code></td>
<td>
<p>covariate for stratified proportional hazards model
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>YS_data includes the values of the survival outcome and covariates associated to this survival part,
with the association parameters but the provided id are temporary and they will be updated after
the cox expansion to make them unique and allow for time dependency
</p>
<p>YSformF formula for this survival outcome (not including association parameters)
</p>

<hr>
<h2 id='setup_Y_model'>Setup outcome for longitudinal marker</h2><span id='topic+setup_Y_model'></span>

<h3>Description</h3>

<p>Setup outcome for longitudinal marker  (internal function)
input:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_Y_model(formula, dataset, family, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_Y_model_+3A_formula">formula</code></td>
<td>
<p>with lme4 format (fixed effects and random effects in the same object)</p>
</td></tr>
<tr><td><code id="setup_Y_model_+3A_dataset">dataset</code></td>
<td>
<p>that contains the outcome</p>
</td></tr>
<tr><td><code id="setup_Y_model_+3A_family">family</code></td>
<td>
<p>of the outcome (given to check if the distribution matches but the check is not done yet)</p>
</td></tr>
<tr><td><code id="setup_Y_model_+3A_k">k</code></td>
<td>
<p>identifies the longitudinal marker among 1:K markers
output:</p>
</td></tr>
</table>


<h3>Value</h3>

<p>YL.name name of the outcome
</p>
<p>YL values of the outcome
</p>

<hr>
<h2 id='SurvMS'>Simulated multi-state survival dataset</h2><span id='topic+SurvMS'></span>

<h3>Description</h3>

<p>A simulated dataset used to illustrate multi-state models (see multi-state model and joint longitudinal and multi-state model in INLAjoint vignette). The corresponding longitudinal dataset is named 'LongMS'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvMS
</code></pre>


<h3>Format</h3>

<p>## 'SurvMS'
A list of 3 data frames with 50 rows and 5 columns, 50 rows and 5 columns, 28 rows and 5 columns for each of the 3 transition intensities, respectively:
</p>

<dl>
<dt>id</dt><dd><p>Individual id</p>
</dd>
<dt>Tstart</dt><dd><p>Beginning of the 'at-risk' period</p>
</dd>
<dt>Tstop</dt><dd><p>Event time</p>
</dd>
<dt>status</dt><dd><p>Transition indicator</p>
</dd>
<dt>X</dt><dd><p>Continuous covariate</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='Survsim'>Simulated competing risks survival dataset</h2><span id='topic+Survsim'></span>

<h3>Description</h3>

<p>A simulated dataset used to illustrate some models (e.g., example of joint() function in the documentation). The corresponding longitudinal dataset is named 'Longsim'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Survsim
</code></pre>


<h3>Format</h3>

<p>## 'Survsim'
A data frame with 15 rows and 5 columns:
</p>

<dl>
<dt>Id</dt><dd><p>Individual id</p>
</dd>
<dt>deathTimes</dt><dd><p>Event time</p>
</dd>
<dt>ctsX</dt><dd><p>Continuous covariate</p>
</dd>
<dt>binX</dt><dd><p>Binary covariate</p>
</dd>
<dt>Event1, Event2, Event3</dt><dd><p>Event indicator for the 3 competing risks (individual is censored when the 3 events are 0)</p>
</dd>
</dl>
<p>...

</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
