<!DOCTYPE html><html><head><title>Help for package RespirAnalyzer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RespirAnalyzer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Data'><p>An example of respiratory data</p></a></li>
<li><a href='#find.peaks'><p>Function to find the peak-to-peak intervals of a respiratory signal.</p></a></li>
<li><a href='#fit.model'><p>Function to fit the MFDFA result with the extended binomial multifractal model.</p></a></li>
<li><a href='#GroupComparison.fn'><p>Function to calculate the statistics for each Group</p></a></li>
<li><a href='#Groupplot.fn'><p>Function to plot the mean and error bar by group</p></a></li>
<li><a href='#HqData'><p>The Hurst exponent of respiratory data</p></a></li>
<li><a href='#Individualplot.fn'><p>Function to plot multiscale entropy or MFDFA results by individual.</p></a></li>
<li><a href='#LowPSD'><p>Function to calculate the power spectral density (PSD)</p></a></li>
<li><a href='#MFDFA'><p>MultiFractal Detrended Fluctuation Analysis</p></a></li>
<li><a href='#MFDFAplot.fn'><p>Function to plot the results of MFDFA analysis</p></a></li>
<li><a href='#MovingAverage'><p>Function to calculate Moving Average of a series</p></a></li>
<li><a href='#MSE'><p>Function to compute the multiscale entropy(MSE)</p></a></li>
<li><a href='#RespirAnalyzer-package'>
<p>Analysis Functions of Respiratory Data</p></a></li>
<li><a href='#Seriesplot.fn'><p>Function to plot series data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis Functions of Respiratory Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-6-7</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaohua Douglas Zhang [aut, cph],
  Teng Zhang [aut],
  Xinzheng Dong [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xinzheng Dong &lt;dong.xinzheng@foxmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for the complete analysis of respiratory data. Consists of a set of functions that allow to preprocessing respiratory data,  calculate both regular statistics and nonlinear statistics, conduct group comparison and visualize the results. Especially, Power Spectral Density ('PSD') (A. Eke (2000) &lt;<a href="https://doi.org/10.1007%2Fs004249900135">doi:10.1007/s004249900135</a>&gt;), 'MultiScale Entropy(MSE)' ('Madalena Costa(2002)' &lt;<a href="https://doi.org/10.1103%2FPhysRevLett.89.068102">doi:10.1103/PhysRevLett.89.068102</a>&gt;) and 'MultiFractal Detrended Fluctuation Analysis(MFDFA)' ('Jan W.Kantelhardt' (2002) &lt;<a href="https://doi.org/10.1016%2FS0378-4371%2802%2901383-3">doi:10.1016/S0378-4371(02)01383-3</a>&gt;) were applied for the analysis of respiratory data. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.2), signal, pracma</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-08 11:56:20 UTC; 11547</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-08 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Data'>An example of respiratory data</h2><span id='topic+Data'></span>

<h3>Description</h3>

<p>The respiratory data of a healthy people.
</p>


<h3>Details</h3>

<p>This is an data to be included in my package
</p>


<h3>Source</h3>

<p>Fantasia Database, PhysioNet
</p>


<h3>References</h3>

<p>&quot;https://doi.org/10.13026/C2RG61&quot;
</p>

<hr>
<h2 id='find.peaks'>Function to find the peak-to-peak intervals of a respiratory signal.</h2><span id='topic+find.peaks'></span>

<h3>Description</h3>

<p>function to find the peak-to-peak intervals of a respiratory signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.peaks(
  y,
  Fs,
  lowpass = TRUE,
  freq = 1,
  MovingAv = FALSE,
  W = FALSE,
  filter = TRUE,
  threshold = 0.2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.peaks_+3A_y">y</code></td>
<td>
<p>a numeric vector, with respiratory data for a regularly spaced time series..</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_fs">Fs</code></td>
<td>
<p>a positive value. sampling frequency of airflow signal.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_lowpass">lowpass</code></td>
<td>
<p>logical. Whether to use low-pass filtering to preprocess the airflow signal.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_freq">freq</code></td>
<td>
<p>an optional values. Cut-off frequency of low-pass filter. The default value is 1.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_movingav">MovingAv</code></td>
<td>
<p>logical.Whether to use Moving Average to preprocess the airflow signal.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_w">W</code></td>
<td>
<p>an optional values. the windows of Moving Average.  The default value is equal to the sampling frequency Fs.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_filter">filter</code></td>
<td>
<p>logical.Whether to filter the points of peaks.</p>
</td></tr>
<tr><td><code id="find.peaks_+3A_threshold">threshold</code></td>
<td>
<p>an optional value. A threshold is the minimum height difference between the wave crest and wave trough. The default value is 0.2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe for the information of peaks. &quot;PeakIndex&quot; is the position of the peaks and &quot;PeakHeight&quot; is the height of the peaks
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData") # load Data from TestData dataset
Fs=50 ## sampling frequency is 50Hz
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
Peaks


</code></pre>

<hr>
<h2 id='fit.model'>Function to fit the MFDFA result with the extended binomial multifractal model.</h2><span id='topic+fit.model'></span>

<h3>Description</h3>

<p>function to fit the result of Multifractal detrended fluctuation analysis (MFDFA) with the extended binomial multifractal model.
Return the results as a vector which contain the parameters of the model and the goodness of fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.model(Hq, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.model_+3A_hq">Hq</code></td>
<td>
<p>a nurmeric vector for the generalized Hurst exponent.</p>
</td></tr>
<tr><td><code id="fit.model_+3A_q">q</code></td>
<td>
<p>a vector of integers, q-order of the moment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector for fitting parameters.&quot;a&quot; and &quot;b&quot; is the coefficients of the extended binomial multifractal model.
&quot;Goodness&quot; is the goodness of fit
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData") # load Data from TestData dataset
Fs=50 ## sampling frequency is 50Hz
Peaks=find.peaks(Data[,2],Fs)
PP_interval=diff(Peaks[,1])/Fs
exponents=seq(3, 8, by=1/4)
scale=2^exponents
q=-10:10
m=2
Result &lt;- MFDFA(PP_interval, scale, m, q)
Coeff &lt;- fit.model(Result$Hq,q)
Coeff
</code></pre>

<hr>
<h2 id='GroupComparison.fn'>Function to calculate the statistics for each Group</h2><span id='topic+GroupComparison.fn'></span>

<h3>Description</h3>

<p>function to calculate the statistics for each Group: Number of Samples,
mean, standard deviation (SD), standard error (SE), median, confident interval, p-value of ANOVA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GroupComparison.fn(Data, GroupName, na.rm = TRUE, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GroupComparison.fn_+3A_data">Data</code></td>
<td>
<p>vector for response values</p>
</td></tr>
<tr><td><code id="GroupComparison.fn_+3A_groupname">GroupName</code></td>
<td>
<p>vector for group names</p>
</td></tr>
<tr><td><code id="GroupComparison.fn_+3A_na.rm">na.rm</code></td>
<td>
<p>whether to remove value for calculation</p>
</td></tr>
<tr><td><code id="GroupComparison.fn_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe for the statistics for each Group. Number of Samples, mean
</p>
<p>standard deviation (SD), median,  upper and lower bounds of CI, p-value of ANOVA
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HqData")
PP_Hq &lt;- HqData
filenames &lt;- row.names(PP_Hq)
q &lt;- -10:10
ClassNames &lt;- c(substr(filenames[1:19], start = 1, stop = 3),
                substr(filenames[20:38], start = 1, stop = 5))
Class &lt;- unique(ClassNames)
Data &lt;- GroupComparison.fn(PP_Hq[,1],ClassNames)
Data

</code></pre>

<hr>
<h2 id='Groupplot.fn'>Function to plot the mean and error bar by group</h2><span id='topic+Groupplot.fn'></span>

<h3>Description</h3>

<p>function to plot the mean and error bar of sample entropy
or the MFDFA results by group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Groupplot.fn(
  x,
  Average,
  GroupName,
  errorbar = NA,
  xRange = NA,
  yRange = NA,
  col = NA,
  pch = NA,
  Position = "topright",
  cex.legend = 0.75,
  xlab = "",
  ylab = "",
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Groupplot.fn_+3A_x">x</code></td>
<td>
<p>a vector for x axis.</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_average">Average</code></td>
<td>
<p>Matrix for average in each group</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_groupname">GroupName</code></td>
<td>
<p>a vector of names for each group</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_errorbar">errorbar</code></td>
<td>
<p>matrix for value of erorr bar</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_xrange">xRange</code></td>
<td>
<p>range for the x-axis</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_yrange">yRange</code></td>
<td>
<p>range for the y-axis</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_col">col</code></td>
<td>
<p>a vector for the colors to indicate groups</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_pch">pch</code></td>
<td>
<p>a vector for points types to indicate groups</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_position">Position</code></td>
<td>
<p>position for the legend</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_cex.legend">cex.legend</code></td>
<td>
<p>cex for legend</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis</p>
</td></tr>
<tr><td><code id="Groupplot.fn_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HqData")
PP_Hq &lt;- HqData
filenames &lt;- row.names(PP_Hq)
q &lt;- -10:10
ClassNames &lt;- c(substr(filenames[1:19], start = 1, stop = 3),
                substr(filenames[20:38], start = 1, stop = 5))
Class &lt;- unique(ClassNames)
for (i in 1:length(q)){
  Data &lt;- GroupComparison.fn(PP_Hq[,i],ClassNames)
  Result_mean_vec &lt;- Data[,"Mean"]
  Result_sd_vec &lt;- Data[,"SE"]
  if( i == 1 ) {
    Result_mean_mat &lt;- Result_mean_vec
    Result_sd_mat &lt;- Result_sd_vec
  } else {
    Result_mean_mat &lt;- rbind(Result_mean_mat, Result_mean_vec)
    Result_sd_mat &lt;- rbind(Result_sd_mat, Result_sd_vec)
 }
}
Groupplot.fn (q[1:10],Result_mean_mat[1:10,],Class,errorbar = Result_sd_mat[1:10,],
              xRange = NA, yRange = NA, col = NA, pch = rep(16,4), Position = "topright",
              cex.legend = 1, xlab="q",ylab="Hurst exponent",main = "")
Groupplot.fn (q[11:21],Result_mean_mat[11:21,],Class,errorbar = Result_sd_mat[11:21,],
              xRange = NA, yRange = NA, col = NA, pch = rep(16,4), Position = "topright",
              cex.legend = 1, xlab="q",ylab="Hurst exponent",main = "")

</code></pre>

<hr>
<h2 id='HqData'>The Hurst exponent of respiratory data</h2><span id='topic+HqData'></span>

<h3>Description</h3>

<p>The Hurst exponent extracted from the MFDFA result of respiratory data.
</p>


<h3>Details</h3>

<p>This is an data to be included in my package
</p>


<h3>Source</h3>

<p>Fantasia Database, PhysioNet
</p>


<h3>References</h3>

<p>&quot;https://doi.org/10.13026/C2RG61&quot;
</p>

<hr>
<h2 id='Individualplot.fn'>Function to plot multiscale entropy or MFDFA results by individual.</h2><span id='topic+Individualplot.fn'></span>

<h3>Description</h3>

<p>function to plot multiscale entropy or MFDFA results by individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Individualplot.fn(
  x,
  y,
  Name = NA,
  xRange = NA,
  yRange = NA,
  col = NA,
  pch = NA,
  Position = "topright",
  cex.legend = 0.75,
  xlab = "",
  ylab = "",
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Individualplot.fn_+3A_x">x</code></td>
<td>
<p>a vector for x-axis coordinate.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_y">y</code></td>
<td>
<p>Matrix for response values.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_name">Name</code></td>
<td>
<p>vector of names for each line.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_xrange">xRange</code></td>
<td>
<p>range for the x-axis.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_yrange">yRange</code></td>
<td>
<p>range for the y-axis.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_col">col</code></td>
<td>
<p>vector for the colors to indicate groups.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_pch">pch</code></td>
<td>
<p>vector for points types to indicate groups.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_position">Position</code></td>
<td>
<p>position for the legend.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_cex.legend">cex.legend</code></td>
<td>
<p>cex for legend.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_xlab">xlab</code></td>
<td>
<p>a title for x axis.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_ylab">ylab</code></td>
<td>
<p>a title for y axis.</p>
</td></tr>
<tr><td><code id="Individualplot.fn_+3A_main">main</code></td>
<td>
<p>main title for the picture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HqData")
PP_Hq &lt;- HqData
filenames &lt;- row.names(PP_Hq)
q=-10:10
ClassNames &lt;- c(substr(filenames[1:19], start = 1, stop = 3),
                substr(filenames[20:38], start = 1, stop = 5))
Class &lt;- unique(ClassNames)
col_vec &lt;- rep(NA, nrow(PP_Hq) )
pch_vec &lt;- rep(16, nrow(PP_Hq) )
for( i in 1:length(Class) ) { col_vec[ ClassNames == Class[i] ] &lt;- i }
Individualplot.fn(q,PP_Hq,Name=Class,col=col_vec,pch=pch_vec, xlab="q",ylab="Hurst exponent")
legend("topright", legend=paste0(Class, "(N=", table( ClassNames ), ")"),
      col=1:4, cex=1, lty=1, pch=16)

</code></pre>

<hr>
<h2 id='LowPSD'>Function to calculate the power spectral density (PSD)</h2><span id='topic+LowPSD'></span>

<h3>Description</h3>

<p>function to calculate the power spectral density (PSD) of a time series. Methods derived from A. Eke (2000) &quot;Physiological time series: distinguishing fractal noises from motions&quot; &lt;doi:10.1007/s004249900135&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LowPSD(series, plot = TRUE, min = 1/8, max = 1/2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LowPSD_+3A_series">series</code></td>
<td>
<p>a numeric vector, with data for a regularly spaced time series.</p>
</td></tr>
<tr><td><code id="LowPSD_+3A_plot">plot</code></td>
<td>
<p>logical. whether to draw the plot of log power vs. log frequency</p>
</td></tr>
<tr><td><code id="LowPSD_+3A_min">min</code>, <code id="LowPSD_+3A_max">max</code></td>
<td>
<p>the optional values. Frequency range of power spectral density. The default value is 1/2 and 1/8 and cannot be set to a negative number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value of spectral exponent(beta) which the the slope of the  of the fitting line on plot of log power vs. log frequency
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData")
Fs &lt;- 50
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
PP_interval=diff(Peaks[,1])/Fs
LowPSD(series=PP_interval,plot=TRUE,min=1/64, max=1/2)

</code></pre>

<hr>
<h2 id='MFDFA'>MultiFractal Detrended Fluctuation Analysis</h2><span id='topic+MFDFA'></span>

<h3>Description</h3>

<p>Applies the MultiFractal Detrended Fluctuation Analysis (MFDFA) to time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFDFA(tsx, scale, m, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MFDFA_+3A_tsx">tsx</code></td>
<td>
<p>Univariate time series (must be a vector).</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_scale">scale</code></td>
<td>
<p>Vector of scales.</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_m">m</code></td>
<td>
<p>An integer of the polynomial order for the detrending.</p>
</td></tr>
<tr><td><code id="MFDFA_+3A_q">q</code></td>
<td>
<p>q-order of the moment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following elements:
</p>

<ul>
<li><p><code>Hq</code> q-order Hurst exponent.
</p>
</li>
<li><p><code>tau_q</code> Mass exponent.
</p>
</li>
<li><p><code>hq</code> Holder exponent.
</p>
</li>
<li><p><code>Dq</code> singularity dimension.
</p>
</li>
<li><p><code>Fqi</code> q-order fluctuation function.
</p>
</li>
<li><p><code>line</code> linear fitting line of fluctuation function.
</p>
</li></ul>



<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData") # load Data from TestData dataset
Fs &lt;- 50
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
head(Peaks)
PP_interval &lt;- diff(Peaks$PeakIndex)/Fs
## Computing Multifractal
exponents=seq(3, 9, by=1/4)
scale=2^exponents
q=-10:10
m=2
Result &lt;- MFDFA(PP_interval, scale, m, q)
Coeff &lt;- fit.model(Result$Hq,q)
print(Coeff)
Para&lt;- -log(Coeff)/log(2)
Para[3]=Para[1]-Para[2]
names(Para)&lt;-c("Hmax","Hmin","DeltaH")
Para

PP_Hq &lt;- Result$Hq
PP_hq &lt;- Result$hq
PP_Dq &lt;- Result$Dq
PP_Para &lt;-Para
</code></pre>

<hr>
<h2 id='MFDFAplot.fn'>Function to plot the results of MFDFA analysis</h2><span id='topic+MFDFAplot.fn'></span>

<h3>Description</h3>

<p>function to plot the results of MFDFA analysis: q-orde
fluctuation function, Hurst exponent,mass exponent and multifractal
spectrum. The fitting result of binomial multifratcal model can be also
shown by the fitting line
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFDFAplot.fn(
  Result,
  scale,
  q,
  cex.lab = 1.6,
  cex.axis = 1.6,
  col.points = 1,
  col.line = 1,
  lty = 1,
  pch = 16,
  lwd = 2,
  model = TRUE,
  cex.legend = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MFDFAplot.fn_+3A_result">Result</code></td>
<td>
<p>a list of the MFDFA results.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_scale">scale</code></td>
<td>
<p>a vector of scales used to calculate the MFDFA results.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_q">q</code></td>
<td>
<p>a vector, q-order of the moment used to calculate the MFDFA results.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_cex.lab">cex.lab</code></td>
<td>
<p>the size of the tick label numbers/text with a numeric value of length 1.The default value is 1.6.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_cex.axis">cex.axis</code></td>
<td>
<p>the size of the axis label text with a numeric value of length 1.The default value is 1.6.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_col.points">col.points</code></td>
<td>
<p>color of the and point.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_col.line">col.line</code></td>
<td>
<p>color of the line</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_lty">lty</code></td>
<td>
<p>line types.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_pch">pch</code></td>
<td>
<p>points types.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_lwd">lwd</code></td>
<td>
<p>line width.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_model">model</code></td>
<td>
<p>whether to use the model to fit the results and draw a line of fit.</p>
</td></tr>
<tr><td><code id="MFDFAplot.fn_+3A_cex.legend">cex.legend</code></td>
<td>
<p>the size of the legend text with a numeric value of length 1.The default value is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData")
Fs=50 ## sampling frequency is 50Hz
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
PP_interval=diff(Peaks[,1])/Fs
exponents=seq(3, 9, by=1/4)
scale=2^exponents
q=-10:10
m=2
Result &lt;- MFDFA(PP_interval, scale, m, q)
MFDFAplot.fn(Result,scale,q)

</code></pre>

<hr>
<h2 id='MovingAverage'>Function to calculate Moving Average of a series</h2><span id='topic+MovingAverage'></span>

<h3>Description</h3>

<p>function to calculate Moving Average of a series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MovingAverage(y, W)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MovingAverage_+3A_y">y</code></td>
<td>
<p>a numeric vector, with respiratory data for a regularly spaced time series.</p>
</td></tr>
<tr><td><code id="MovingAverage_+3A_w">W</code></td>
<td>
<p>a Positive integer, the windows of Moving Average.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new numeric vector after calculate the moving average.
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData")
W &lt;- 50
y &lt;- MovingAverage(Data[,2],W)
</code></pre>

<hr>
<h2 id='MSE'>Function to compute the multiscale entropy(MSE)</h2><span id='topic+MSE'></span>

<h3>Description</h3>

<p>function to perform a multiscale entropy (MSE) analysis of a regularly spaced time series.
Return the results as an R data frame. Methods derived from Madalena Costa(2002) &quot;Multiscale entropy analysis of complex physiologic time series&quot; &lt;doi:10.1103/PhysRevLett.89.068102&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSE(x, tau, m, r, I)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSE_+3A_x">x</code></td>
<td>
<p>a numeric vector, with data for a regularly spaced time series. NA's are not allowed (because the C program is not set up to handle them).</p>
</td></tr>
<tr><td><code id="MSE_+3A_tau">tau</code></td>
<td>
<p>a vector of scale factors to use for MSE.  Scale factors are positive integers that specify bin size for the MSE algorithm:
the number ofconsecutive observations in 'x' that form a bin and are averaged in the first step of the algorithm.
Must be a sequence of equally-spaced integers starting at 1. The largest value must still leave a sufficient number of bins to estimate entropy.</p>
</td></tr>
<tr><td><code id="MSE_+3A_m">m</code></td>
<td>
<p>a positive integers giving the window size for the entropy calculations in the second step of the algorithm, Typical values are 1, 2, or 3.</p>
</td></tr>
<tr><td><code id="MSE_+3A_r">r</code></td>
<td>
<p>a positive value of coefficients for similarity thresholds, such as r=0.15, r*sd(y) must be in the same units as 'x'.
Averages in two bins are defined to be similar if they differ by 'r*sd(y)' or less. NOTE: Currently only a single threshold is allowed per run; i.e.,'r' must be a scalar.</p>
</td></tr>
<tr><td><code id="MSE_+3A_i">I</code></td>
<td>
<p>the maximal number of points to be used for calculating MSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with with one row for each combination of 'tau', 'm' and 'rSD'. Columns are &quot;tau&quot;, &quot;m&quot;, &quot;rSD&quot;, and &quot;SampEn&quot; (the calculated sample entropy).
The data frame will also have an attribute &quot;SD&quot;, the standard deviation of 'x'. rSD = r*sd(y)
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData") # load Data from TestData dataset
oldoptions &lt;- options(scipen=999)
Fs &lt;- 50 # sampling frequency
scale_raw &lt;- seq(1,90,by=2)
MSER &lt;-  MSE(Data[1:10000,2], tau=scale_raw, m=2,
            r=0.15, I=40000)
print(MSER)
options(oldoptions)

</code></pre>

<hr>
<h2 id='RespirAnalyzer-package'>
Analysis Functions of Respiratory Data
</h2><span id='topic+RespirAnalyzer-package'></span><span id='topic+RespirAnalyzer'></span>

<h3>Description</h3>

<p>Provides functions for the complete analysis of respiratory data. Consists of a set of functions that allow to preprocessing respiratory data,  calculate both regular statistics and nonlinear statistics, conduct group comparison and visualize the results. Especially, Power Spectral Density ('PSD') (A. Eke (2000) &lt;doi:10.1007/s004249900135&gt;), 'MultiScale Entropy(MSE)' ('Madalena Costa(2002)' &lt;doi:10.1103/PhysRevLett.89.068102&gt;) and 'MultiFractal Detrended Fluctuation Analysis(MFDFA)' ('Jan W.Kantelhardt' (2002) &lt;doi:10.1016/S0378-4371(02)01383-3&gt;) were applied for the analysis of respiratory data. 
</p>


<h3>Details</h3>

<p>The R package RespirAnalyzer contains functions for analyzing respiratory data.
</p>


<h3>Author(s)</h3>

<p>Xiaohua Douglas Zhang [aut, cph], Teng Zhang [aut], Xinzheng Dong [aut, cre]
</p>
<p>Maintainer: Xinzheng Dong &lt;dong.xinzheng@foxmail.com&gt;
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load Data from TestData dataset
data("TestData")
Seriesplot.fn(Data[1:2000,1],Data[1:2000,2],points=FALSE,
              xlab="Time(s)",ylab="Respiratory")
Fs=50 ## sampling frequency is 50Hz
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
points(Data[Peaks[2:13,1],1],Data[Peaks[2:13,1],2],col=2)
PP_interval &lt;- diff(Peaks[,1])/Fs
Seriesplot.fn(1:length(PP_interval),PP_interval,points=FALSE,xlab="Count",
          ylab="Inter-breath Interval(s)")
#### Moving Average
W &lt;- FS &lt;- 50
Data[,3] &lt;- MovingAverage(Data[,2],W)
Seriesplot.fn(Data[1:2000,1],Data[1:2000,2],points=FALSE,
              xlab="Time(s)",ylab="Respiratory")
lines(Data[1:2000,1],Data[1:2000,3],col=2)
#### Low pass filter
bf &lt;- signal::butter(2, 2/Fs, type="low")
Data[,4] &lt;- signal::filtfilt(bf,Data[,2])
Seriesplot.fn(Data[1:2000,1],Data[1:2000,2],points=FALSE,
              xlab="Time(s)",ylab="Respiratory")
lines(Data[1:2000,1],Data[1:2000,4],col=2)
#### entropy of  rawdata
scale_raw &lt;- seq(1,90,2)
MSE &lt;-  MSE(Data$V2[seq(1,100000,2)], tau=scale_raw, m=2, r=0.15, I=40000)
Seriesplot.fn(MSE$tau ,MSE$SampEn,points=TRUE,
              xlab="Scale",ylab="Sample entropy")
#### entropy of IBI
scale_PP &lt;- 1:10
MSE &lt;-  MSE(PP_interval, tau=scale_PP, m=2, r=0.15, I=40000)
Seriesplot.fn(MSE$tau ,MSE$SampEn,points=TRUE,
              xlab="Scale",ylab="Sample entropy")

#### PSD analysis
LowPSD(PP_interval, plot=TRUE,min=1/64, max=1/2)
#### MFDFA
exponents=seq(3, 9, by=1/4)
scale=2^exponents
q=-10:10
m=2
Result &lt;- MFDFA(PP_interval, scale, m, q)
MFDFAplot.fn(Result,scale,q,model = TRUE)
#### fit.model
Coeff &lt;- fit.model(Result$Hq,q)
Coeff
Para&lt;- -log(Coeff)/log(2);Para[3]=Para[1]-Para[2]
names(Para)&lt;-c("Hmax","Hmin","i÷H")
Para

#### Individualplot
data("HqData")
PP_Hq &lt;- HqData
filenames &lt;- row.names(PP_Hq)
q=-10:10
ClassNames &lt;- c(substr(filenames[1:19], start = 1, stop = 3),
                substr(filenames[20:38], start = 1, stop = 5))
Class &lt;- unique(ClassNames)
col_vec &lt;- rep(NA, nrow(PP_Hq) )
pch_vec &lt;- rep(16, nrow(PP_Hq) )
for( i in 1:length(Class) ) { col_vec[ ClassNames == Class[i] ] &lt;- i }
Individualplot.fn(q,PP_Hq,Name=Class,col=col_vec,pch=pch_vec, xlab="q",ylab="Hurst exponent")
legend("topright", legend=paste0(Class, "(N=", table( ClassNames ), ")"),
      col=1:4, cex=1, lty=1, pch=16)

#### Groupplot
data("HqData")
PP_Hq &lt;- HqData
filenames &lt;- row.names(PP_Hq)
q &lt;- -10:10
ClassNames &lt;- c(substr(filenames[1:19], start = 1, stop = 3),
                substr(filenames[20:38], start = 1, stop = 5))
Class &lt;- unique(ClassNames)
for (i in 1:length(q)){
  Data &lt;- GroupComparison.fn(PP_Hq[,i],ClassNames)
  Result_mean_vec &lt;- Data[,"Mean"]
  Result_sd_vec &lt;- Data[,"SE"]
  if( i == 1 ) {
    Result_mean_mat &lt;- Result_mean_vec
    Result_sd_mat &lt;- Result_sd_vec
  } else {
    Result_mean_mat &lt;- rbind(Result_mean_mat, Result_mean_vec)
    Result_sd_mat &lt;- rbind(Result_sd_mat, Result_sd_vec)
 }
}
Groupplot.fn (q[1:10],Result_mean_mat[1:10,],Class,errorbar = Result_sd_mat[1:10,],
              xRange = NA, yRange = NA, col = NA, pch = rep(16,4), Position = "topright",
              cex.legend = 1, xlab="q",ylab="Hurst exponent",main = "")
Groupplot.fn (q[11:21],Result_mean_mat[11:21,],Class,errorbar = Result_sd_mat[11:21,],
              xRange = NA, yRange = NA, col = NA, pch = rep(16,4), Position = "topright",
              cex.legend = 1, xlab="q",ylab="Hurst exponent",main = "")


</code></pre>

<hr>
<h2 id='Seriesplot.fn'>Function to plot series data</h2><span id='topic+Seriesplot.fn'></span>

<h3>Description</h3>

<p>function to plot series data. including Respiration data and
Peak-to-Peak intervals series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Seriesplot.fn(
  x,
  y,
  xRange = NA,
  yRange = NA,
  points = TRUE,
  pch = 1,
  col.point = 1,
  cex.point = 1,
  line = TRUE,
  lty = 1,
  col.line = 1,
  lwd = 1,
  xlab = "x",
  ylab = "y",
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Seriesplot.fn_+3A_x">x</code></td>
<td>
<p>a vector for the x-axis coordinate of a sequence.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_y">y</code></td>
<td>
<p>a vector for the y-axis coordinates of a sequence.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_xrange">xRange</code></td>
<td>
<p>range for the x-axis.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_yrange">yRange</code></td>
<td>
<p>range for the y-axis.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_points">points</code></td>
<td>
<p>whether to draw the points of the sequence. If points = TRUE, a sequence of points will be plotted. otherwise, will not plot the points.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_pch">pch</code></td>
<td>
<p>points types.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_col.point">col.point</code></td>
<td>
<p>color code or name of the points.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_cex.point">cex.point</code></td>
<td>
<p>cex of points</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_line">line</code></td>
<td>
<p>whether to draw a line of the sequence. If line = TRUE, a line of sequence will be plotted. otherwise, will not plot the line.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_lty">lty</code></td>
<td>
<p>line types.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_col.line">col.line</code></td>
<td>
<p>color code or name of the line.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_lwd">lwd</code></td>
<td>
<p>line width.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis.</p>
</td></tr>
<tr><td><code id="Seriesplot.fn_+3A_main">main</code></td>
<td>
<p>main title for the picture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value return
</p>


<h3>References</h3>

<p>Zhang T, Dong X, Chen C, Wang D, Zhang XD. RespirAnalyzer: an R package for continuous monitoring of respiratory signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("TestData")
oldpar &lt;- par(mfrow=c(1,2))
Seriesplot.fn(Data[1:10000,1],Data[1:10000,2],points=FALSE,xlab="Time(s)",ylab="Respiration")
Fs=50 ## sampling frequency is 50Hz
Peaks &lt;- find.peaks(Data[,2],Fs,lowpass=TRUE,freq=1,MovingAv=FALSE,
                    W=FALSE,filter=TRUE,threshold=0.05)
PP_interval=diff(Peaks[,1])/Fs
Seriesplot.fn(1:length(PP_interval),PP_interval,points=FALSE,xlab="Count",ylab="Interval(s)")
par(oldpar)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
