<!DOCTYPE html><html><head><title>Help for package reflimR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {reflimR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjust_digits'><p>Plausible rounding</p></a></li>
<li><a href='#bowley'><p>Bowley skewness</p></a></li>
<li><a href='#conf_int95'><p>Confidence intervals of estimated reference limits</p></a></li>
<li><a href='#Dataset+3A+20livertests'><p>Dataset: livertests</p></a></li>
<li><a href='#Dataset+3A+20targetvalues'><p>Dataset: target values</p></a></li>
<li><a href='#iboxplot'><p>Removal of pathological values</p></a></li>
<li><a href='#interpretation'><p>Colors and text modules to interprete deviations from given  target values</p></a></li>
<li><a href='#lognorm'><p>Lognormal distribution model</p></a></li>
<li><a href='#permissible_uncertainty'><p>Tolerance intervals of estimated and target limits</p></a></li>
<li><a href='#reflim'><p>Reference limits (main function)</p></a></li>
<li><a href='#ri_hist'><p>Histogram with density plots and reference limits</p></a></li>
<li><a href='#truncated_qqplot'><p>Quantile-Quantile plot of truncated laboratory results</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reference Limit Estimation Using Routine Laboratory Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Georg Hoffmann &lt;georg.hoffmann@trillium.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Uses an indirect method based on truncated quantile-quantile plots to estimate reference limits from routine laboratory data. The principle of the method was developed by Robert G Hoffmann (1963) &lt;<a href="https://doi.org/10.1001%2Fjama.1963.03060110068020">doi:10.1001/jama.1963.03060110068020</a>&gt; and modified by Georg Hoffmann and colleagues (2015) &lt;<a href="https://doi.org/10.1515%2Flabmed-2015-0104">doi:10.1515/labmed-2015-0104</a>&gt;, (2020) &lt;<a href="https://doi.org/10.1515%2Flabmed-2020-0005">doi:10.1515/labmed-2020-0005</a>&gt;, and (2022) &lt;<a href="https://doi.org/10.1007%2F978-3-031-15509-3_31">doi:10.1007/978-3-031-15509-3_31</a>&gt;. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/reflim/reflimR">https://github.com/reflim/reflimR</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/reflim/reflimR/issues">https://github.com/reflim/reflimR/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-09 04:02:39 UTC; georg</td>
</tr>
<tr>
<td>Author:</td>
<td>Georg Hoffmann [aut, cre],
  Sandra Klawitter [aut],
  Frank Klawonn [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjust_digits'>Plausible rounding</h2><span id='topic+adjust_digits'></span>

<h3>Description</h3>

<p>Rounds a quantitative laboratory result to a reasonable number of decimal places.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjust_digits(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjust_digits_+3A_x">x</code></td>
<td>
<p>numeric</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing a rounded value of x and the number of decimal places
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adjust_digits(0.001234)
adjust_digits(0)
adjust_digits(-12.34)
adjust_digits(5.4321)$digits
</code></pre>

<hr>
<h2 id='bowley'>Bowley skewness</h2><span id='topic+bowley'></span>

<h3>Description</h3>

<p>Calculates a robust skewness measure for x based on the interquartile range (or any other quantile range).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bowley(x, alpha = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bowley_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="bowley_+3A_alpha">alpha</code></td>
<td>
<p>lower quantile of the range to be regarded (e. g. 0.25)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bowley's quantile skewness is calculated from (q[1] - 2 * q[2] + q[3]) / (q[3] - q[1]), where q is a vector of quantiles alpha, 0.5, and 1 - alpha. The default value for alpha = 0.25 indicates an interval from the first to the third quartile.
</p>


<h3>Value</h3>

<p>Bowley's quantile skewness
</p>


<h3>References</h3>

<p>1. Bowley, AL (1920). Elements of Statistics. London : P.S. King &amp; Son, Ltd.
</p>
<p>2. Klawonn F, Hoffmann G, Orth M. Quantitative laboratory results: normal or lognormal distribution. J Lab Med 2020; 44: 143–50. <a href="https://doi.org/10.1515/labmed-2020-0005">doi:10.1515/labmed-2020-0005</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bowley(1 : 100)
bowley(rnorm(1000, 3, 0.2))
bowley(rlnorm(1000, 3, 0.5))
</code></pre>

<hr>
<h2 id='conf_int95'>Confidence intervals of estimated reference limits</h2><span id='topic+conf_int95'></span>

<h3>Description</h3>

<p>Calculates 95 percent confidence intervals for the lower and upper reference limits obtained with the reflim algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  conf_int95(n, lower.limit, upper.limit, lognormal = TRUE,
             apply.rounding = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conf_int95_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="conf_int95_+3A_lower.limit">lower.limit</code></td>
<td>
<p>positive number indicating the lower limit of the reference interval</p>
</td></tr>
<tr><td><code id="conf_int95_+3A_upper.limit">upper.limit</code></td>
<td>
<p>positive number indicating the upper limit of the reference interval</p>
</td></tr>
<tr><td><code id="conf_int95_+3A_lognormal">lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed</p>
</td></tr>
<tr><td><code id="conf_int95_+3A_apply.rounding">apply.rounding</code></td>
<td>
<p>Boolean indicating whether the confidence limits should be rounded</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The confidence limits depend on the reference range (upper minus lower limit), and are proportional to 1/sqrt(n).
</p>
<p>The coefficients used in this function have been determined by 100,000 Monte-Carlo simulations for sample sizes between n = 200 and n = 2,000 based on a standard normal distribution.
</p>


<h3>Value</h3>

<p>95 percent confidence limits and total number of observations for the lower and the upper reference limit (ranging from lower.lim.low to lower.lim.upp for the lower reference limit, and from upper.lim.low to upper.lim.upp for the upper reference limit)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>conf_int95(n = 250, lower.limit = 10, upper.limit = 50)
conf_int95(250, 135, 145, FALSE, FALSE)
</code></pre>

<hr>
<h2 id='Dataset+3A+20livertests'>Dataset: livertests</h2><span id='topic+livertests'></span>

<h3>Description</h3>

<p>Example data showing eight different biomarkers (laboratory tests), which are frequently measured in healthy controls and patients with liver diseases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>livertests
</code></pre>


<h3>Format</h3>

<p>A data frame with 612 rows and 11 columns:
</p>

<dl>
<dt>Category</dt><dd><p>healthy reference individual or patient</p>
</dd>
<dt>Age</dt><dd><p>age in years</p>
</dd>
<dt>Sex</dt><dd><p>sex f = female or m = male</p>
</dd>
<dt>ALB</dt><dd><p>albumin, g/L</p>
</dd>
<dt>ALT</dt><dd><p>alanine aminotransferase, U/L</p>
</dd>
<dt>AST</dt><dd><p>aspartate aminotransferase, U/L</p>
</dd>
<dt>BIL</dt><dd><p>bilirubin, µmol/l</p>
</dd>
<dt>CHE</dt><dd><p>choline esterase, kU/L</p>
</dd>
<dt>CREA</dt><dd><p>creatinine, µmol/L</p>
</dd>
<dt>GGT</dt><dd><p>gamma-glutamyl transferase, U/L</p>
</dd>
<dt>PROT</dt><dd><p>total protein, mg/L</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://archive.ics.uci.edu/ml/datasets/HCV+data&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(livertests)
pie(table(livertests$Category), labels = c("patients", "controls"))
plot(livertests$Age, livertests$ALB, xlab = "Age [yr]", ylab = "ALB [g/L]")
grid()
abline(lm(livertests$ALB ~ livertests$Age))

che &lt;- livertests$CHE
ref &lt;- livertests$CHE[livertests$Category == "reference"]
pat &lt;- livertests$CHE[livertests$Category == "patient"]

hist(che, breaks = 1 : 20, col = "white", main = "cholinesterase", xlab = "kU/L")
hist(ref, breaks = 1 : 20, col = rgb(0, 1, 0, 0.5), add = TRUE)
hist(pat, breaks = 1 : 20, col = rgb(1, 0, 0, 0.5), add = TRUE)
legend("topright", fill = c(rgb(1,1,1,1), rgb(0,1,0,0.5), rgb(1,0,0,0.5)),
    legend = c("all", "controls", "patients"))

t.test(ref, pat)
var.test(ref, pat)

che.f &lt;- livertests$CHE[livertests$Sex == "f"]
che.m &lt;- livertests$CHE[livertests$Sex == "m"]
plot(density(che.f), xlim = c(0, 20), col = "red",
   main = "cholinesterase", xlab = "kU/L")
lines(density(che.m), col = "blue")
legend("topright", lty = 1, col = c("red", "blue"), legend = c("females", "males"))

reflim(che.m, main = "CHE (m)", xlab = "kU/L")
reflim(livertests$AST[livertests$Sex == "m"], main = "AST (m)", xlab = "U/L")
</code></pre>

<hr>
<h2 id='Dataset+3A+20targetvalues'>Dataset: target values</h2><span id='topic+targetvalues'></span>

<h3>Description</h3>

<p>Test names (analytes), units and reference limits from a textbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>targetvalues</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 6 columns:
</p>

<dl>
<dt>analyte</dt><dd><p>short name of the analyte</p>
</dd>
<dt>unit</dt><dd><p>measuring unit</p>
</dd>
<dt>ll.female, ul.female</dt><dd><p>lower and upper reference limits for women</p>
</dd>
<dt>ll.male, ul.male</dt><dd><p>lower and upper reference limits for men</p>
</dd>
</dl>


<h3>Details</h3>

<p>The table was created from the data in the textbook (web version 2023, https://www.clinical-laboratory-diagnostics.com). Missing data (i.e. the lower limits for ALT, AST and GGT) were supplemented from the product sheets of the respective tests.</p>


<h3>Source</h3>

<p>Thomas L. Clinical Laboratory Diagnostics, 2023</p>


<h3>Examples</h3>

<pre><code class='language-R'>targetvalues[, 1 : 4]
reflim(livertests$ALB[livertests$Sex == "m"],
main = targetvalues[1, 1], xlab = targetvalues[1, 2],
targets = targetvalues[1, 5 : 6])
</code></pre>

<hr>
<h2 id='iboxplot'>Removal of pathological values</h2><span id='topic+iboxplot'></span>

<h3>Description</h3>

<p>Iteratively truncates a vector of quantitative laboratory results until no more values outside the specified truncation interval are left.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iboxplot(x, lognormal = NULL, perc.trunc = 2.5,
apply.rounding = TRUE,
plot.it = TRUE, main = "iBoxplot", xlab = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iboxplot_+3A_x">x</code></td>
<td>
<p>vector of positive numbers</p>
</td></tr>
<tr><td><code id="iboxplot_+3A_lognormal">lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed (NULL means that the distribution type is defined automatically)</p>
</td></tr>
<tr><td><code id="iboxplot_+3A_perc.trunc">perc.trunc</code></td>
<td>
<p>percentage of presumably normal values to be removed from each side</p>
</td></tr>
<tr><td><code id="iboxplot_+3A_apply.rounding">apply.rounding</code></td>
<td>
<p>Boolean indicating whether the estimated reference limits should be rounded</p>
</td></tr>
<tr><td><code id="iboxplot_+3A_plot.it">plot.it</code></td>
<td>
<p>Boolean indicating whether a graphic should be created</p>
</td></tr>
<tr><td><code id="iboxplot_+3A_main">main</code>, <code id="iboxplot_+3A_xlab">xlab</code></td>
<td>
<p>title and x label of the graphic</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The truncated vector represents the estimated central 95 percent of values, which follow the assumed distribution (normal or lognormal). If the distribution of the reference values is unknown, medical laboratory results should be assumed to be lognormally distributed [2].
</p>


<h3>Value</h3>

<table>
<tr><td><code>$trunc</code></td>
<td>
<p>truncated vector x</p>
</td></tr>
<tr><td><code>$limits</code></td>
<td>
<p>truncation points, preliminary reference limits</p>
</td></tr>
<tr><td><code>$lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution has been assumed</p>
</td></tr>
<tr><td><code>$perc.norm</code></td>
<td>
<p>proportion of the assumed non-pathological values</p>
</td></tr>
<tr><td><code>$progress</code></td>
<td>
<p>results of the iterative truncation</p>
</td></tr>
</table>


<h3>References</h3>

<p>1. Klawonn F, Hoffmann G. Using fuzzy cluster analysis to find interesting clusters. In: L.A. Garcia-Escuderoet al. (eds.): Building bridges between soft and statistical methodologies for data science. Springer, Cham (2023), 231-239. <a href="https://doi.org/10.1007/978-3-031-15509-3_31">doi:10.1007/978-3-031-15509-3_31</a>.
</p>
<p>2. Haeckel R, Wosniok W. Observed unknown distributions of clinical chemical quantities should be considered to be log-normal. Clin Chem Lab Med 2010; 48: 1393-6. <a href="https://doi.org/10.1515/CCLM.2010.273">doi:10.1515/CCLM.2010.273</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
iboxplot(rlnorm(n = 250, meanlog = 3,  sdlog = 0.3))

iboxplot(rnorm(1000, 100, 10), apply.rounding = FALSE, plot.it = FALSE)$truncation.points

alb.trunc &lt;- iboxplot(livertests$ALB, main = "ALB", xlab = "g/L")$trunc
summary(alb.trunc)
</code></pre>

<hr>
<h2 id='interpretation'>Colors and text modules to interprete deviations from given  target values</h2><span id='topic+interpretation'></span>

<h3>Description</h3>

<p>Creates traffic light colors green, yellow, and red as well as a textual description such as 'slightly increased'. This function is called by reflim(), if target values are available, and provides the required color information for ri_hist().</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpretation(limits, targets)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpretation_+3A_limits">limits</code></td>
<td>
<p>vector of two numbers indicating the reference limits that have been calculated by the reflim function (or any other suitable algorithm)</p>
</td></tr>
<tr><td><code id="interpretation_+3A_targets">targets</code></td>
<td>
<p>vector of two numbers indicating target reference limits that may have been obtained from external sources</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This algorithm compares the positions and tolerance intervals of the estimated upper and lower reference limits with the tolerance limits of the respective target values.
</p>
<p>If the estimated reference limit is within the tolerance of the target value, the dev.lim text says 'within tolerance' and the color code #00FF0080 for semi-transparent green is returned.
</p>
<p>If the position is outside and the two tolerance limits overlap, the dev.lim text says 'slightly increased' or 'slightly decreased' and the color code #FFFF0080 for semi-transparent yellow is returned.
</p>
<p>If the tolerance limits do not overlap, the dev.lim text says 'markedly increased' or 'markedly decreased' and the color code #FF000080 for semi transparent red is returned.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$tol.lim and $tol.tar</code></td>
<td>
<p>tolerance limits for the estimated reference limits and the respective target values. If targets are not provided, the latter tolerance limits are returned as NA.</p>
</td></tr>
<tr><td><code>$col.lim and $col.tar</code></td>
<td>
<p>hexadecimal rgb values, indicating the traffic light colors green, yellow, and red</p>
</td></tr>
<tr><td><code>$dev.lim</code></td>
<td>
<p>short text describing the deviations of the observed limit values from the target values</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>interpretation(limits = c(10, 50), targets = c(11, 49))
interpretation(limits = c(10, 50), targets = c(8, 60))$dev.lim
</code></pre>

<hr>
<h2 id='lognorm'>Lognormal distribution model</h2><span id='topic+lognorm'></span>

<h3>Description</h3>

<p>Suggests lognormal modelling of a numeric vector x by comparing Bowley's quantile skewness for x and log(x). Lognormality is suggested if bowley(x) - bowley(log(x)) &gt;= cutoff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognorm(x, cutoff = 0.05, alpha = 0.25, digits = 3,
          plot.it = TRUE, plot.logtype = TRUE,
          main = "Bowley skewness", xlab = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognorm_+3A_x">x</code></td>
<td>
<p>numeric vector of positive numbers</p>
</td></tr>
<tr><td><code id="lognorm_+3A_cutoff">cutoff</code></td>
<td>
<p>a skewness threshold for the suggestion of a lognormal distribution</p>
</td></tr>
<tr><td><code id="lognorm_+3A_alpha">alpha</code></td>
<td>
<p>lower quantile of the range to be regarded (e. g. 0.25 for IQR)</p>
</td></tr>
<tr><td><code id="lognorm_+3A_digits">digits</code></td>
<td>
<p>number of digits to be displayed for the Bowley skewness</p>
</td></tr>
<tr><td><code id="lognorm_+3A_plot.it">plot.it</code></td>
<td>
<p>Boolean indicating whether a graphic should be created</p>
</td></tr>
<tr><td><code id="lognorm_+3A_plot.logtype">plot.logtype</code></td>
<td>
<p>Boolean indicating whether the distribution type should be printed in the graphic</p>
</td></tr>
<tr><td><code id="lognorm_+3A_main">main</code>, <code id="lognorm_+3A_xlab">xlab</code></td>
<td>
<p>title and x label of the graphic</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If $lognorm is TRUE, a lognormal distribution is suggested for right-skewed density curves (bowley(x) &gt; 0). The decision for a lognormal distribution is based on the difference between the skewness of the original and the logtransformed values (cut-off defaults to 0.05).
</p>
<p>In the unusual case of a left-skewed distribution (bowley(x) &lt; 0), a normal distribution is suggested (lognormal = FALSE), assuming that the left skew is caused by pathological low values rather than an unusual distribution of laboratory results.
</p>
<p>The plot illustrates the skewness of x and log(x) showing density curves and boxplots with separate x-axes for the original values (bottom axis) and the log-transformed values (top axis). A skewness delta below the cut-off value means that both curves are quite symmetric. In this case, x can be approximated by a normal distribution. If the delta exceeds the cut-off, the density curve of the original values and the respective boxplot are right-skewed and become more symmetric after log-transformation.
</p>
<p>The plot.logtype argument is used internally to suppress printing the automated definition of the distribution in case that the type has been set manually.
</p>
<p>Extreme values are removed before plotting to improve the graphic.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$lognorm</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed</p>
</td></tr>
<tr><td><code>$BowleySkewness</code></td>
<td>
<p>Bowley skewness of the original and the logtransformed values as well as the difference</p>
</td></tr>
</table>


<h3>References</h3>

<p>1. Klawonn F, Hoffmann G, Orth M. Quantitative laboratory results: normal or lognormal distribution? J Lab Med 2020; 44: 143-50. <a href="https://doi.org/10.1515/labmed-2020-0005">doi:10.1515/labmed-2020-0005</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lognorm(rnorm(n = 1000, mean = 20, sd = 2))
lognorm(rlnorm(n = 1000, meanlog = 3,  sdlog = 0.3))
lognorm(livertests$ALB, main = "albumin", xlab = "g/L")
lognorm(livertests$BIL, main = "bilirubin", xlab = "µmol/L")
</code></pre>

<hr>
<h2 id='permissible_uncertainty'>Tolerance intervals of estimated and target limits</h2><span id='topic+permissible_uncertainty'></span>

<h3>Description</h3>

<p>Returns the permissible uncertainty of reference limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permissible_uncertainty(lower.limit, upper.limit, apply.rounding = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permissible_uncertainty_+3A_lower.limit">lower.limit</code></td>
<td>
<p>positive number indicating the lower limit of the reference interval</p>
</td></tr>
<tr><td><code id="permissible_uncertainty_+3A_upper.limit">upper.limit</code></td>
<td>
<p>positive number indicating the upper limit of the reference interval</p>
</td></tr>
<tr><td><code id="permissible_uncertainty_+3A_apply.rounding">apply.rounding</code></td>
<td>
<p>Boolean indicating whether the tolerance limits should be rounded</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tolerance limits (also called equivalence limits) indicate the permissible uncertainty of a reference limit from a medical point of view (in contrast to the confidence interval, which reflects the statistical point of view). The calculation is based on a recommendation made by the DGKL [1, 2].
</p>


<h3>Value</h3>

<p>Tolerance intervals for the lower and upper reference limits (ranging from lower.lim.low to lower.lim.upp for the lower reference limit and from upper.lim.low to upper.lim.upp for the upper reference limit)
</p>


<h3>References</h3>

<p>1. Haeckel R et al. Permissible limits for uncertainty of measurement in laboratory medicine. Clin Chem Lab Med 2015;53:1161–71. <a href="https://doi.org/10.1515/cclm-2014-0874">doi:10.1515/cclm-2014-0874</a>.
</p>
<p>2. Haeckel R et al. Equivalence limits of reference intervals for partitioning of population data. J Lab Med 2016; 40: 199-205. <a href="https://doi.org/10.1515/labmed-2016-0002">doi:10.1515/labmed-2016-0002</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>permissible_uncertainty(lower.limit = 10, upper.limit = 50)
permissible_uncertainty(10, 50, FALSE)
</code></pre>

<hr>
<h2 id='reflim'>Reference limits (main function)</h2><span id='topic+reflim'></span>

<h3>Description</h3>

<p>Estimation of reference limits from mixed distributions of normal and pathological laboratory results. Estimates lower and upper reference limits and provides statistical characteristics and graphics to evaluate the results.</p>


<h3>Usage</h3>

<pre><code class='language-R'>reflim(x, lognormal = NULL, targets = NULL,
              perc.trunc = 2.5, n.min = 200, apply.rounding = TRUE,
              plot.it = TRUE, plot.all = FALSE, print.n = TRUE,
              main = "reference limits", xlab = "x")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reflim_+3A_x">x</code></td>
<td>
<p>vector of positive numbers</p>
</td></tr>
<tr><td><code id="reflim_+3A_lognormal">lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed (NULL means that the distribution type is defined automatically)</p>
</td></tr>
<tr><td><code id="reflim_+3A_targets">targets</code></td>
<td>
<p>vector of two numbers indicating target reference limits that may have been obtained from external sources</p>
</td></tr>
<tr><td><code id="reflim_+3A_perc.trunc">perc.trunc</code></td>
<td>
<p>percentage of presumably normal values to be removed from each side</p>
</td></tr>
<tr><td><code id="reflim_+3A_n.min">n.min</code></td>
<td>
<p>minimum number of observations needed for a robust estimate of reference intervals</p>
</td></tr>
<tr><td><code id="reflim_+3A_apply.rounding">apply.rounding</code></td>
<td>
<p>Boolean indicating whether the estimated reference limits should be rounded</p>
</td></tr>
<tr><td><code id="reflim_+3A_plot.it">plot.it</code></td>
<td>
<p>Boolean indicating whether graphics should be created</p>
</td></tr>
<tr><td><code id="reflim_+3A_plot.all">plot.all</code></td>
<td>
<p>Boolean indicating whether graphics of all process steps should be created</p>
</td></tr>
<tr><td><code id="reflim_+3A_print.n">print.n</code></td>
<td>
<p>Boolean indicating whether the number of cases after truncation should be printed on the graph</p>
</td></tr>
<tr><td><code id="reflim_+3A_main">main</code>, <code id="reflim_+3A_xlab">xlab</code></td>
<td>
<p>title and x label of the graphic</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The reflim function estimates reference limits from the linear part of a normal probability-probability or quantile-quantile plot [1, 2]. It combines several functions to determine the distribution type [3], to truncate the input vector [4], and to generate a truncated quantile-quantile plot [2, 4]. For details concerning the individual functions, which are called by reflim(), you may enter *help(package = reflimR)*.
</p>
<p>The default value of perc.trunc is 2.5 meaning that 2.5 percent of the assumed non-pathological values are truncated on both sides of the quantile-quantile plot. By increasing perc.trunc (e.g. to 5 percent), a stronger cut can be applied to reduce the influence of potentially overlapping pathological values.
</p>
<p>The argument plot.it is used to compare the observed and the theoretical distribution curves graphically. If target values have been specified, the tolerance intervals of the calculated reference limits will be drawn as colored vertical lines. Green means that the calculated limit is within the tolerance interval of the respective target, yellow means that the calculated limit falls outside but the two tolerance intervals overlap, and red means that there is no overlap between the tolerance intervals.
</p>
<p>More detailed graphs of the three underlying steps can be generated by setting plot.all = TRUE. When plot.all is set to TRUE, plot.it is automatically set to TRUE as well.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$stats</code></td>
<td>
<p>mean and sd (or meanlog and sdlog) of the truncated vector, number of cases before and after truncation</p>
</td></tr>
<tr><td><code>$lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution has been assumed</p>
</td></tr>
<tr><td><code>$limits</code></td>
<td>
<p>estimated reference limits with tolerance intervals</p>
</td></tr>
<tr><td><code>$targets</code></td>
<td>
<p>target values with tolerance intervals</p>
</td></tr>
<tr><td><code>perc.norm</code></td>
<td>
<p>estimated percentage of non-pathological values</p>
</td></tr>
<tr><td><code>$confidence.int</code></td>
<td>
<p>95 percent confidence intervals for the estimated reference limits (depends on n)</p>
</td></tr>
<tr><td><code>$interpretation</code></td>
<td>
<p>short text describing the deviation of observed limits from target values</p>
</td></tr>
<tr><td><code>remarks</code></td>
<td>
<p>short text describing potential reasons why the reflim function could not be executed</p>
</td></tr>
</table>


<h3>References</h3>

<p>1. Holmes D, Buhr K. Widespread incorrect implementation of the Hoffmann method, the correct approach, and modern alternatives. Am. J. Clin. Pathol. 2018; 151:328-36. <a href="https://doi.org/10.1093/ajcp/aqy149">doi:10.1093/ajcp/aqy149</a>.
</p>
<p>2. Hoffmann G, Lichtinghagen R, Wosniok W. Simple estimation of reference intervals from routine laboratory data. J Lab Med 2015; 39: 389-402. <a href="https://doi.org/10.1515/labmed-2015-0104">doi:10.1515/labmed-2015-0104</a>.
</p>
<p>3. Klawonn F, Hoffmann G, Orth M. Quantitative laboratory results: normal or lognormal distribution? J Lab Med 2020; 44: 143-50. <a href="https://doi.org/10.1515/labmed-2020-0005">doi:10.1515/labmed-2020-0005</a>.
</p>
<p>4. Klawonn F, Hoffmann G. Using fuzzy cluster analysis to find interesting clusters. In: L.A. Garcia-Escuderoet al. (eds.): Building bridges between soft and statistical methodologies for data science. Springer, Cham (2023), 231-239. <a href="https://doi.org/10.1007/978-3-031-15509-3_31">doi:10.1007/978-3-031-15509-3_31</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(rnorm(800, 100, 10), rnorm(100, 70, 15), rnorm(100, 125, 15))
reflim(x, targets = qnorm(c(0.025, 0.975), 100, 10))

x.f &lt;- subset(livertests, livertests$Sex == "f")
reflim(x.f$AST)
reflim(x.f$AST, targets = c(13, 40))
reflim(x.f$AST, targets = targetvalues[3, 3 : 4],
main = "AST/GOT", xlab = targetvalues[3, 2])
reflim(x.f$AST, plot.all = TRUE, main = "AST/GOT", xlab = "U/L")$limits
reflim(x.f$ALB, targets = targetvalues[1, 3 : 4],
  plot.all = TRUE, main = "ALB", xlab = "g/L")$limits
</code></pre>

<hr>
<h2 id='ri_hist'>Histogram with density plots and reference limits</h2><span id='topic+ri_hist'></span>

<h3>Description</h3>

<p>Creates a graphic illustrating the results of the reflim function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ri_hist(x, lognormal, stats, limits, perc.norm,
                    targets = NULL, remove.extremes = TRUE,
                    main = "reflim", xlab = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ri_hist_+3A_x">x</code></td>
<td>
<p>vector of positive numbers</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_lognormal">lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_stats">stats</code></td>
<td>
<p>vector of mean and sd, or meanlog and sdlog, respectively</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_limits">limits</code></td>
<td>
<p>vector of reference limits calculated by the reflim function (or any other suitable algorithm)</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_perc.norm">perc.norm</code></td>
<td>
<p>estimated percentage of non-pathological values (usually provided by the iboxplot function)</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_targets">targets</code></td>
<td>
<p>vector of target reference limits obtained from external sources</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_remove.extremes">remove.extremes</code></td>
<td>
<p>Boolean indicating whether extreme values should be removed to improve the graphic</p>
</td></tr>
<tr><td><code id="ri_hist_+3A_main">main</code>, <code id="ri_hist_+3A_xlab">xlab</code></td>
<td>
<p>title and x label of the graphic</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ri_hist is called by the reflim function, but it can also be used to illustrate the results of other software packages (e. g. refineR), if the required arguments are available (see details).
</p>
<p>It creates a graphic, which includes a histogram and a density curve of x, as well as a theoretical density curve of presumably non-pathological values (blue) and a calculated density curve of presumably pathological values (red). Calculated reference limits and target limits are shown as vertical lines, and their tolerance intervals (i. e., the permissible uncertainties) are represented by surrounding boxes. If target values are provided, traffic light colors indicate the deviation between target and actual results.
</p>
<p>If the arguments lognormal or perc.norm are unknown, they can be set according to the user's expertise. For example, if the distribution type is unknown, a lognormal distribution can be assumed [1]. If the percentage of non-pathological values has not been provided by a foreign algorithm (e. g. refineR), it can be roughly estimated, if density curves of normal and pathological values are available (the argument perc.norm does not influence the result; its only effect is on the shape of the theoretical density curve).
</p>


<h3>Value</h3>

<table>
<tr><td><code>$lognormal</code></td>
<td>
<p>assumed distribution model</p>
</td></tr>
<tr><td><code>$percent_normal</code></td>
<td>
<p>assumed percentage of non-pathological values</p>
</td></tr>
<tr><td><code>$interpretation</code></td>
<td>
<p>text describing the deviation of observed limits from target values</p>
</td></tr>
</table>


<h3>References</h3>

<p>1. Haeckel R, Wosniok W. Observed unknown distributions of clinical chemical quantities should be considered to be log-normal. Clin Chem Lab Med 2010; 48: 1393-6. <a href="https://doi.org/10.1515/CCLM.2010.273">doi:10.1515/CCLM.2010.273</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x1 &lt;- rlnorm(800, 3, 0.3)
lim &lt;- quantile(x1, c(0.025, 0.975))
ri_hist(x1, lognormal = TRUE, stats = c(3, 0.3), limits = lim, perc.norm = 100)

x2 &lt;- rlnorm(200, 3.5, 0.4)
x &lt;- c(x1, x2)
tar &lt;- quantile(x, c(0.025, 0.975))
ri_hist(x, lognormal = TRUE, stats = c(3, 0.3), limits = lim, targets = tar, perc.norm = 80)
</code></pre>

<hr>
<h2 id='truncated_qqplot'>Quantile-Quantile plot of truncated laboratory results</h2><span id='topic+truncated_qqplot'></span>

<h3>Description</h3>

<p>Generates and plots a quantile-quantile plot (q-q plot) with a theoretical normal distribution on the x-axis and the corresponding empirical distribution on the y-axis. Returns intercept, slope, and estimated quantiles 0.025 and 0.975 (i.e., reference limits).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncated_qqplot(x.trunc, lognormal = NULL, perc.trunc = 2.5, n.min = 200,
        apply.rounding = TRUE, plot.it = TRUE,
        main = "Q-Q plot",
        xlab = "theoretical quantiles",
        ylab = "sample quantiles")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truncated_qqplot_+3A_x.trunc">x.trunc</code></td>
<td>
<p>truncated numeric vector of positive numbers, usually generated by iboxplot()</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_lognormal">lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution should be assumed (NULL means that the distribution type is defined automatically)</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_perc.trunc">perc.trunc</code></td>
<td>
<p>percentage of values that has been removed from each side by truncation</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_n.min">n.min</code></td>
<td>
<p>minimal number of values in x.trunc for a robust estimate of reference limits</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_apply.rounding">apply.rounding</code></td>
<td>
<p>Boolean indicating whether the reference limits should be rounded</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_plot.it">plot.it</code></td>
<td>
<p>Boolean indicating whether a graphic should be created</p>
</td></tr>
<tr><td><code id="truncated_qqplot_+3A_main">main</code>, <code id="truncated_qqplot_+3A_xlab">xlab</code>, <code id="truncated_qqplot_+3A_ylab">ylab</code></td>
<td>
<p>title and labels of the graphic</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Intercept and slope of the q-q plot represent the robust mean and standard deviation of x.trunc. They serve as parameters to estimate the reference limits being represented by the quantiles 0.025 and 0.975 of a presumably normal subset of x.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$stats</code></td>
<td>
<p>intercept and slope of the q-q plot, lower and upper truncation points</p>
</td></tr>
<tr><td><code>$lognormal</code></td>
<td>
<p>Boolean indicating whether a lognormal distribution has been assumed</p>
</td></tr>
</table>


<h3>References</h3>

<p>1. Hoffmann G et al. Simple estimation of reference intervals from routine laboratory data. J Lab Med 2016. <a href="https://doi.org/10.1515/labmed-2015-0104">doi:10.1515/labmed-2015-0104</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x &lt;- rlnorm(n = 250, meanlog = 3,  sdlog = 0.3)
x.trunc &lt;- iboxplot(x, plot.it = FALSE)$trunc
truncated_qqplot(x.trunc)

x.f &lt;- subset(livertests, livertests$Sex == "f")
x.trunc &lt;- iboxplot(x.f$ALT, plot.it = FALSE)$trunc
truncated_qqplot(x.trunc, n.min = length(x.trunc), main = "ALT")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
