<!DOCTYPE html><html><head><title>Help for package SpTe2M</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpTe2M}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SpTe2M-package'><p>Nonparametric Modeling and Monitoring of Spatio-Temporal Data</p></a></li>
<li><a href='#cv_mspe'><p>Cross-validation mean squared prediction error</p></a></li>
<li><a href='#ili_dat'><p>Florida influenza-like illness data</p></a></li>
<li><a href='#mod_cv'><p>Modifed cross-validation for bandwidth selection</p></a></li>
<li><a href='#pm25_dat'><p>PM2.5 concentration data</p></a></li>
<li><a href='#sim_dat'><p>A simulated spatio-temporal dataset</p></a></li>
<li><a href='#spte_covest'><p>Estimate the spatio-temporal covariance function</p></a></li>
<li><a href='#spte_decor'><p>Decorrelate the spatio-temporal data</p></a></li>
<li><a href='#spte_meanest'><p>Estimate the spatio-temporal mean function</p></a></li>
<li><a href='#spte_semiparmreg'><p>Fit the semiparametric spatio-temporal model</p></a></li>
<li><a href='#sptemnt_cusum'><p>Online spatio-temporal process monitoring by a CUSUM chart</p></a></li>
<li><a href='#sptemnt_ewmac'><p>Spatio-temporal process monitoring using covariate information</p></a></li>
<li><a href='#sptemnt_ewsl'><p>Spatio-temporal process monitoring using exponentially weighted spatial LASSO</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Modeling and Monitoring of Spatio-Temporal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-9-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Spatio-temporal data have become increasingly popular in many research fields. Such data often have complex structures that are difficult to describe and estimate. This package provides reliable tools for modeling complicated spatio-temporal data. It also includes tools of online process monitoring to detect possible change-points in a spatio-temporal process over time. More specifically, the package implements the spatio-temporal mean estimation procedure described in Yang and Qiu (2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7622">doi:10.1002/sim.7622</a>&gt;, the spatio-temporal covariance estimation procedure discussed in Yang and Qiu (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.8315">doi:10.1002/sim.8315</a>&gt;, the three-step method for the joint estimation of spatio-temporal mean and covariance functions suggested by Yang and Qiu (2022) &lt;<a href="https://doi.org/10.1007%2Fs10463-021-00787-2">doi:10.1007/s10463-021-00787-2</a>&gt;, the spatio-temporal disease surveillance method discussed in Qiu and Yang (2021) &lt;<a href="https://doi.org/10.1002%2Fsim.9150">doi:10.1002/sim.9150</a>&gt; that can accommodate the covariate effect, the spatial-LASSO-based process monitoring method proposed by Qiu and Yang (2023) &lt;<a href="https://doi.org/10.1080%2F00224065.2022.2081104">doi:10.1080/00224065.2022.2081104</a>&gt;, and the online spatio-temporal disease surveillance method described in Yang and Qiu (2020) &lt;<a href="https://doi.org/10.1080%2F24725854.2019.1696496">doi:10.1080/24725854.2019.1696496</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-29 23:26:49 UTC; kaiyang</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet, MASS, ggplot2, maps, mapproj, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Author:</td>
<td>Kai Yang [aut, cre],
  Peihua Qiu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kai Yang &lt;kayang@mcw.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-30 01:12:49 UTC</td>
</tr>
</table>
<hr>
<h2 id='SpTe2M-package'>Nonparametric Modeling and Monitoring of Spatio-Temporal Data</h2><span id='topic+SpTe2M'></span><span id='topic+SpTe2M-package'></span>

<h3>Description</h3>

<p>Spatio-temporal data have become increasingly popular in many research fields. 
Such data often have complex structures that are difficult to describe and 
estimate. This package provides reliable tools for modeling complicated 
spatio-temporal data. It also includes tools of online process monitoring to 
detect possible change-points in a spatio-temporal process over time. More 
specifically, it implements the nonparametric spatio-temporal data modeling 
methods described in Yang and Qiu (2018, 2019, and 2022), as well as the 
online spatio-temporal process monitoring methods discussed in
Qiu and Yang (2021 and 2023) and Yang and Qiu (2020).
</p>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
Maintainer: Kai Yang &lt;kayang@mcw.edu&gt;
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2021). Effective Disease Surveillance by Using 
Covariate Information. <em>Statistics in Medicine</em>, <strong>40</strong>, 5725-5745.
</p>
<p>Qiu, P. and Yang, K. (2023). Spatio-Temporal Process Monitoring Using 
Exponentially Weighted Spatial LASSO. <em>Journal of Quality Technology</em>, 
<strong>55</strong>, 163-180.
</p>
<p>Yang, K. and Qiu, P. (2018). Spatio-Temporal Incidence Rate Data Analysis by 
Nonparametric Regression. <em>Statistics in Medicine</em>, <strong>37</strong>, 2094-2107.
</p>
<p>Yang, K. and Qiu, P. (2019). Nonparametric Estimation of the Spatio-Temporal 
Covariance Structure. <em>Statistics in Medicine</em>, <strong>38</strong>, 4555-4565.
</p>
<p>Yang, K. and Qiu, P. (2020). Online Sequential Monitoring of Spatio-Temporal 
Disease Incidence Rates. <em>IISE Transactions</em>, <strong>52</strong>, 1218-1233.
</p>
<p>Yang, K. and Qiu, P. (2022). A Three-Step Local Smoothing Approach for 
Estimating the Mean and Covariance Functions of Spatio-Temporal Data. 
<em>Annals of the Institute of Statistical Mathematics</em>, <strong>74</strong>, 49-68.
</p>

<hr>
<h2 id='cv_mspe'>Cross-validation mean squared prediction error</h2><span id='topic+cv_mspe'></span>

<h3>Description</h3>

<p>The spatio-temporal covariance function is estimated by the 
weighted moment estimation method in Yang and Qiu (2019). The function 
<code>cv_mspe</code> is developed to select the bandwidths <code>(gt,gs)</code> used 
in the estimation of the spatio-temporal covariance function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_mspe(y, st, gt = NULL, gs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv_mspe_+3A_y">y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing data of the observed response 
<code class="reqn">y(t,s)</code>, where <code class="reqn">N</code> is the total number of observations over space 
and time.</p>
</td></tr>
<tr><td><code id="cv_mspe_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations 
(i.e., (<code class="reqn">s_u</code>,<code class="reqn">s_v</code>)) and times (i.e., <code class="reqn">t</code>) for all the 
observations in <code>y</code>. The three columns of <code>st</code> correspond to 
<code class="reqn">s_u</code>, <code class="reqn">s_v</code> and <code class="reqn">t</code>, respectively.</p>
</td></tr>
<tr><td><code id="cv_mspe_+3A_gt">gt</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>gt</code> provided by users; 
default is <code>NULL</code>,  and <code>cv_mspe</code> will choose its own sequence 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="cv_mspe_+3A_gs">gs</code></td>
<td>
<p>A sequence of spatial kernel bandwidth <code>gs</code> provided by users; 
default is <code>NULL</code>,  and <code>cv_mspe</code> will choose its own sequence 
if <code>gs=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bandwidth</code></td>
<td>
<p>A matrix containing all the bandwidths 
(<code>gt</code>, <code>gs</code>) provided by users.</p>
</td></tr>
<tr><td><code>mspe</code></td>
<td>
<p>The mean squared prediction errors for all the bandwidths 
provided by users.</p>
</td></tr>
<tr><td><code>bandwidth.opt</code></td>
<td>
<p>The bandwidths <code>(gt, gs)</code> that minimizes the 
mean squared prediction error.</p>
</td></tr> 
<tr><td><code>mspe.opt</code></td>
<td>
<p>The minimal mean squared prediction error.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2019). Nonparametric Estimation of the Spatio-Temporal 
Covariance Structure. <em>Statistics in Medicine</em>, <strong>38</strong>, 4555-4565.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
gt &lt;- seq(0.3,0.4,0.1); gs &lt;- seq(0.3,0.4,0.1)
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
mspe &lt;- cv_mspe(y.sub,st.sub,gt,gs)
</code></pre>

<hr>
<h2 id='ili_dat'>Florida influenza-like illness data</h2><span id='topic+ili_dat'></span>

<h3>Description</h3>

<p>Daily influenza-like illness (ILI) incidence rates at 67 Florida counties 
during years 2012-2014. The ILI incidence rates were collected by the 
Electronic Surveillance System for the Early Notification of Community-based 
Epidemics (ESSENCE) that was developed by the Florida Department of Health. 
Researchers can have an access to the ESSENCE database after a proper online 
registration. Moreover, some weather conditions during years 2012-2014 can 
be obtained from  the official website of the National Oceanic and Atmospheric 
Administration of the United States. The ILI dataset used here contains 8 
variables, including <code>County</code>, <code>Date</code>, <code>Lat</code>, <code>Long</code>, 
<code>Time</code>, <code>Rate</code> (ILI incidence rate), <code>Temp</code> (temperature) 
and <code>RH</code> (relative humidity), from the two databases mentioned above, 
where <code>Long</code> and <code>Lat</code> refer to the longitude and latitude of the 
geometric centers of each Florida county, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ili_dat)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing <code class="reqn">N=73,432</code> observations of 8 variables.
</p>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>

<hr>
<h2 id='mod_cv'>Modifed cross-validation for bandwidth selection</h2><span id='topic+mod_cv'></span>

<h3>Description</h3>

<p>The spatio-temporal mean function can be estimated by the local linear kernel 
smoothing procedure (cf., Yang and Qiu 2018). The function <code>mod_cv</code> 
provides a reliable tool for selecting bandwidths <code>(ht, hs)</code> used in 
the local linear kernel smoothing procedure in cases when data are 
spatio-temporally correlated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mod_cv(y, st, ht = NULL, hs = NULL, eps = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mod_cv_+3A_y">y</code></td>
<td>
<p>A vector of the spatio-temporal response <code class="reqn">y(t,s)</code>.</p>
</td></tr>
<tr><td><code id="mod_cv_+3A_st">st</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mod_cv_+3A_ht">ht</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>ht</code> provided by users; default 
is <code>NULL</code>, and <code>mod_cv</code> chooses its own sequence if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="mod_cv_+3A_hs">hs</code></td>
<td>
<p>A sequence of temporal kernel bandwidth <code>hs</code> provided by users; default 
is <code>NULL</code>, and <code>mod_cv</code> chooses its own sequence if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="mod_cv_+3A_eps">eps</code></td>
<td>
<p>The value of this parametric is between 0 and 1. Default is 0.1. The 
following bimodal kernel function (cf., Yang and Qiu 2018) is used when 
calculting the modified cross-validation score:
</p>
<p style="text-align: center;"><code class="reqn">K_{\epsilon}(x) = \frac{4}{4-3\epsilon-\epsilon^3}
\left\{ \begin{array}{ll}
\frac{3}{4}(1-x^2)\mbox{I}(|x|\leq 1), &amp; \mbox{ if } |x| \geq \epsilon, \\
\frac{3(1-\epsilon^2)}{4\epsilon}|x|, &amp; \mbox{ otherwise}.
\end{array}
\right.</code>
</p>

<p>The argument <code>eps</code> represents the parameter <code class="reqn">\epsilon</code> in the above 
bimodal kernel, which controls the closeness of the bimodal kernel to the 
Epanechnikov kernel <code class="reqn">K_e(x)=0.75(1-x^2)\mbox{I}(|x|\leq 1)</code>. The smaller 
the value, the closer the two kernels.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bandwidth</code></td>
<td>
<p>A matrix containing all the bandwidths (<code>ht</code>, <code>hs</code>) 
provided by users.</p>
</td></tr>
<tr><td><code>mcv</code></td>
<td>
<p>The modified cross-validation scores for all the bandwidths 
provided by users.</p>
</td></tr>
<tr><td><code>bandwidth.opt</code></td>
<td>
<p>The selected bandwidths <code>(ht, hs)</code> by the modified 
cross-validation.</p>
</td></tr>
<tr><td><code>mcv.opt</code></td>
<td>
<p>The modified cross-validation score of the selected 
bandwidths.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2018). Spatio-Temporal Incidence Rate Data Analysis by 
Nonparametric Regression. <em>Statistics in Medicine</em>, <strong>37</strong>, 2094-2107.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ht &lt;- seq(0.10,0.15,0.05); hs &lt;- seq(0.20,0.30,0.10)
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
mcv &lt;- mod_cv(y.sub,st.sub,ht,hs,eps=0.1)
</code></pre>

<hr>
<h2 id='pm25_dat'>PM2.5 concentration data</h2><span id='topic+pm25_dat'></span>

<h3>Description</h3>

<p>Daily PM2.5 concentration levels at 183 major cities in China during years 
2014-2016. This dataset was collected by the China National Environmental 
Monitoring Centre (CNEMC). It can be downloaded directly from the CNEMC 
offical web page. The PM2.5 dataset used here contains 6 variables, including 
<code>Year</code>, <code>Time</code>, <code>Long</code> (longitude), <code>Lat</code> (latitude), 
<code>City</code>, and <code>PM2.5</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pm25_dat)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing <code class="reqn">N=200,385</code> observations of 6 variables.
</p>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>

<hr>
<h2 id='sim_dat'>A simulated spatio-temporal dataset</h2><span id='topic+sim_dat'></span>

<h3>Description</h3>

<p>This simulated dataset is saved as a list, and it contains the following 
three elements:
</p>

<dl>
<dt>y</dt><dd><p>A vector of length <code class="reqn">N</code>; it contains the data of the observed 
response variable <code class="reqn">y</code>.</p>
</dd>
<dt>x</dt><dd><p>A vector of length <code class="reqn">N</code>; it contains the data of the covariate 
<code class="reqn">x</code>. </p>
</dd>
<dt>st</dt><dd><p>An <code class="reqn">N\times 3</code> matrix containing the spatial locations and 
times for all the observations in the dataset.</p>
</dd></dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(sim_dat)
</code></pre>


<h3>Format</h3>

<p>A list containing <code class="reqn">N=10,000</code> observations.
</p>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
set.seed(100)
n &lt;- 100; m &lt;- 100; N &lt;- n*m
t &lt;- rep(seq(0.01,1,0.01),each=m)
su &lt;- sv &lt;- seq(0.1,1,0.1)
su &lt;- rep(su,each=10); sv &lt;- rep(sv,10)
su &lt;- rep(su,n); sv &lt;- rep(sv,n)
st &lt;- matrix(0,N,3)
st[,1] &lt;- su; st[,2] &lt;- sv; st[,3] &lt;- t
mu &lt;- rep(0,N)
for(i in 1:N) {
  mu[i] &lt;- 2+sin(pi*su[i])*sin(pi*sv[i])+sin(2*pi*t[i]) 
}
dist &lt;- matrix(0,m,m) # distance matrix
for(i in 1:m) {
  for(j in 1:m) {
    dist[i,j] &lt;- sqrt((su[i]-su[j])^2+(sv[i]-sv[j])^2)
  }
}
cov.s &lt;- matrix(0,m,m) # spatial correlation
for(i in 1:m) {
  for(j in 1:m) {
    cov.s[i,j] &lt;- 0.3^2*exp(-30*dist[i,j]) 
  }
}
noise &lt;- matrix(0,n,m)
noise[1,] &lt;- MASS::mvrnorm(1,mu=rep(0,m),Sigma=cov.s) 
for(i in 2:n) {
  noise[i,] &lt;- 0.1*noise[i-1,]+sqrt(1-0.1^2)*
    MASS::mvrnorm(1,mu=rep(0,m),Sigma=cov.s)
}
noise &lt;- c(t(noise)); x &lt;- rnorm(N,0,0.3) 
beta &lt;- 0.5; y &lt;- mu+x*beta+noise
sim_dat &lt;- list(); sim_dat$y &lt;- y
sim_dat$x &lt;- x; sim_dat$st &lt;- st
</code></pre>

<hr>
<h2 id='spte_covest'>Estimate the spatio-temporal covariance function</h2><span id='topic+spte_covest'></span>

<h3>Description</h3>

<p>The function <code>spte_covest</code> is developed to estimate the spatio-temporal 
covariance <code class="reqn">V(t,t';s,s')=\mbox{Cov}(y(t,s),y(t',s'))</code> by the weighted 
moment estimation procedure (cf., Yang and Qiu 2019). It should be noted that 
the estimated covariance from <code>spte_covest</code> may not be positive 
semidefinite and thus it may not be a legitimate covariance function. In such 
cases, the projection-based modification needs to be used to make it positive 
semidefinite (cf., Yang and Qiu 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spte_covest(y, st, gt = NULL, gs = NULL, stE1 = NULL, stE2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spte_covest_+3A_y">y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing data of the observed response.</p>
</td></tr>
<tr><td><code id="spte_covest_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N \times 3</code> matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="spte_covest_+3A_gt">gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code>,  and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_covest_+3A_gs">gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,
and it will be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_covest_+3A_ste1">stE1</code></td>
<td>
<p>An <code class="reqn">N_1 \times 3</code> matrix specifying the spatial locations 
<code class="reqn">s</code> and times <code class="reqn">t</code>. Default value is NULL, and <code>stE1=st</code> if 
<code>stE1=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_covest_+3A_ste2">stE2</code></td>
<td>
<p>An <code class="reqn">N_2 \times 3</code> matrix specifying the spatial locations <code class="reqn">s'</code>
and times <code class="reqn">t'</code>. Default value is NULL, and <code>stE2=st</code> if 
<code>stE2=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stE1</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>stE2</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>The bandwidths <code>(gt, gs)</code> used in the weighted moment 
estimation procedure.</p>
</td></tr>
<tr><td><code>covhat</code></td>
<td>
<p>An <code class="reqn">N_1 \times N_2</code> covariance matrix estimate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2019). Nonparametric Estimation of the Spatio-Temporal 
Covariance Structure. <em>Statistics in Medicine</em>, <strong>38</strong>, 4555-4565.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
cov.est &lt;- spte_covest(y.sub,st.sub)
</code></pre>

<hr>
<h2 id='spte_decor'>Decorrelate the spatio-temporal data</h2><span id='topic+spte_decor'></span>

<h3>Description</h3>

<p>The function <code>spte_decor</code> uses the estimated spatio-temporal mean and 
covariance to decorrelate the observed spatio-temporal data. After data 
decorrelation, each decorrelated observation should have asymptotic mean of 
0 and asymptotic variance of 1, and the decorrelated data should be 
asymptotically uncorrelated with each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spte_decor(y, st, y0, st0, T = 1, ht = NULL, hs = NULL, gt = NULL, gs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spte_decor_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations to decorrelate.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_st">st</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and observation 
times of the observations to decorrelate.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_y0">y0</code></td>
<td>
<p>A vector of <code class="reqn">N_0</code> in-control (IC) spatio-temporal observations from 
which the IC spatio-temporal mean and covariance functions can be estimated
via <code>spte_meanest</code> and <code>spte_covest</code>.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_st0">st0</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y0</code>.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_t">T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code>, and it will 
be chosen by the modified cross-validation <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_gt">gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code>, and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_decor_+3A_gs">gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>st</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>std.res</code></td>
<td>
<p>The decorrelated data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2020). Online Sequential Monitoring of Spatio-Temporal 
Disease Incidence Rates. <em>IISE Transactions</em>, <strong>52</strong>, 1218-1233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
decor &lt;- spte_decor(y.sub,st.sub,y0=y.sub,st0=st.sub)
</code></pre>

<hr>
<h2 id='spte_meanest'>Estimate the spatio-temporal mean function</h2><span id='topic+spte_meanest'></span>

<h3>Description</h3>

<p>The function <code>spte_meanest</code> provides a major tool for estimating the 
spatio-temporal mean function nonparametrically 
(cf., Yang and Qiu 2018 and 2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spte_meanest(y, st, ht = NULL, hs = NULL, cor = FALSE, stE = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spte_meanest_+3A_y">y</code></td>
<td>
<p>A vector of spatio-temporal observations.</p>
</td></tr>
<tr><td><code id="spte_meanest_+3A_st">st</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times for all the 
spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="spte_meanest_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_meanest_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_meanest_+3A_cor">cor</code></td>
<td>
<p>A logical indicator where <code>cor=FALSE</code> implies that the covariance is not 
taken into account and the local linear kernel smoothing procedure is used for 
estimating the mean function (cf., Yang and Qiu 2018) and <code>cor=TRUE</code> 
implies that the covariance is accommodated and the three-step local smoothing 
approach is used to estimate the mean function (cf., Yang and Qiu 2022). 
Default is FALSE.</p>
</td></tr>
<tr><td><code id="spte_meanest_+3A_ste">stE</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times where 
we want to calculate the estimate of the mean. Default is NULL, and 
<code>stE=st</code> if <code>stE=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bandwidth</code></td>
<td>
<p>The bandwidths (<code>ht</code>, <code>hs</code>) used in the estimation 
procedure.</p>
</td></tr>
<tr><td><code>stE</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>muhat</code></td>
<td>
<p>The estimated mean values at the spatial locations and times 
specified by <code>stE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2018). Spatio-Temporal Incidence Rate Data Analysis by 
Nonparametric Regression. Statistics in Medicine, <strong>37</strong>, 2094-2107.
</p>
<p>Yang, K. and Qiu, P. (2022). A Three-Step Local Smoothing Approach for 
Estimating the Mean and Covariance Functions of Spatio-Temporal Data. 
<em>Annals of the Institute of Statistical Mathematics</em>, <strong>74</strong>, 49-68.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]
cov.est &lt;- spte_meanest(y.sub,st.sub)
</code></pre>

<hr>
<h2 id='spte_semiparmreg'>Fit the semiparametric spatio-temporal model</h2><span id='topic+spte_semiparmreg'></span>

<h3>Description</h3>

<p>The function <code>spte_semiparmreg</code> fits the semiparametric spatio-temporal 
model to study the relationship between the response <code class="reqn">y</code> and covariates 
<code class="reqn">\bm{x}</code> by the method discussed in Qiu and Yang (2021), in which an 
iterative algorithm is used to compute the estimated regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spte_semiparmreg(
  y,
  st,
  x,
  ht = NULL,
  hs = NULL,
  maxIter = 1000,
  tol = 10^(-4),
  stE = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spte_semiparmreg_+3A_y">y</code></td>
<td>
<p>A vector of length <code class="reqn">N</code> containing the data of the spatio-temporal 
response <code class="reqn">y(t,s)</code>.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N \times 3</code> matrix specifying the spatial locations and times for all 
the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_x">x</code></td>
<td>
<p>An <code class="reqn">N \times p</code> matrix containing the data of the <code class="reqn">p</code> covariates.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_maxiter">maxIter</code></td>
<td>
<p>A positive integer specifying the maximum number of iterations allowed. 
Default value is 1,000.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_tol">tol</code></td>
<td>
<p>A positive numeric value specifying the tolerance level for the convergence 
criterion. Default value is 0.0001.</p>
</td></tr>
<tr><td><code id="spte_semiparmreg_+3A_ste">stE</code></td>
<td>
<p>A three-column matrix specifying the spatial locations and times where we 
want to calculate the estimate of the mean. Default is NULL, and 
<code>stE=st</code> if <code>stE=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>bandwidth</code></td>
<td>
<p>The bandwidths (<code>ht</code>, <code>hs</code>) used in the estimation 
procedure.</p>
</td></tr>
<tr><td><code>stE</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>muhat</code></td>
<td>
<p>The estimated mean values at spatial locations and times 
specified by <code>stE</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The vector of the estimated regression coefficient vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2021). Effective Disease Surveillance by Using 
Covariate Information. <em>Statistics in Medicine</em>, <strong>40</strong>, 5725-5745.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(sim_dat)
y &lt;- sim_dat$y; st &lt;- sim_dat$st; x &lt;- sim_dat$x
ids &lt;- 1:500; y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]; x.sub &lt;- x[ids]
semi.est &lt;- spte_semiparmreg(y.sub,st.sub,x.sub,maxIter=2)   
</code></pre>

<hr>
<h2 id='sptemnt_cusum'>Online spatio-temporal process monitoring by a CUSUM chart</h2><span id='topic+sptemnt_cusum'></span>

<h3>Description</h3>

<p>The function <code>sptemnt_cusum</code> implements the sequential online monitoring 
procedure described in Yang and Qiu (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sptemnt_cusum(
  y,
  st,
  type,
  ARL0 = 200,
  gamma = 0.1,
  B = 1000,
  bs = 5,
  T = 1,
  ht = NULL,
  hs = NULL,
  gt = NULL,
  gs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sptemnt_cusum_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations and times for 
all the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_type">type</code></td>
<td>
<p>A vector of <code class="reqn">N</code> characters specifying the types of the observations. 
Here, <code>type</code> could be <code>IC1</code>, <code>IC2</code> or <code>Mnt</code>, where 
<code>type='IC1'</code> denotes the in-control (IC) observations used to perform 
the block bootstrap procedure to determine the control limit of the CUSUM 
chart, <code>type='IC2'</code> denotes the IC observations used to estimate the 
spatio-temporal mean and covariance functions by <code>spte_meanest</code> and 
<code>spte_covest</code>, and <code>type='Mnt'</code> denotes the observations used 
for online process monitoring (cf., Yang and Qiu 2020). If there are only 
data points with either <code>type='IC1'</code> or <code>type='IC2'</code>, then these 
data points will be used to estimate the model and conduct the bootstrap 
procedure as well. This function will return an error if there are no 
observations with <code>type='IC1'</code> or <code>type='IC2'</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_arl0">ARL0</code></td>
<td>
<p>The pre-specified IC average run length. Default is 200.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_gamma">gamma</code></td>
<td>
<p>The pre-specified allowance constant in the CUSUM chart. Default is 0.1.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_b">B</code></td>
<td>
<p>The bootstrap sizes used in the block bootstrap procedure for determining 
the control limit. Default value is 1,000.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_bs">bs</code></td>
<td>
<p>The block size of the block bootstrap procedure. Default value is 5.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_t">T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation via <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_gt">gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code> and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_cusum_+3A_gs">gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ARL0</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>cstat</code></td>
<td>
<p>The charting statistics which can be used to make 
a plot for the control chart.</p>
</td></tr>
<tr><td><code>cl</code></td>
<td>
<p>The control limit that is determined by the block bootstrap.</p>
</td></tr>
<tr><td><code>signal_time</code></td>
<td>
<p>The signal time (i.e., the first time point when the 
charting statistic <code>cstat</code> exceeds the control limit <code>cl</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Yang, K. and Qiu, P. (2020). Online Sequential Monitoring of Spatio-Temporal 
Disease Incidence Rates. <em>IISE Transactions</em>, <strong>52</strong>, 1218-1233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(ili_dat)
n &lt;- 365; m &lt;- 67
y &lt;- ili_dat$Rate; st &lt;- ili_dat[,3:5]
type &lt;- rep(c('IC1','IC2','Mnt'),c(m*(n+1),(m*n),(m*n)))
ids &lt;- c(1:(5*m),((n+1)*m+1):(m*(n+6)),((2*n+1)*m+1):(m*(2*n+6)))
y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]; type.sub &lt;- type[ids]
ili.cusum &lt;- sptemnt_cusum(y.sub,st.sub,type.sub,ht=0.05,hs=6.5,gt=0.25,gs=1.5)
</code></pre>

<hr>
<h2 id='sptemnt_ewmac'>Spatio-temporal process monitoring using covariate information</h2><span id='topic+sptemnt_ewmac'></span>

<h3>Description</h3>

<p>The function <code>sptemnt_ewmac</code> is developed to solve the spatio-temporal 
process montoring problems in cases when the information in covariates 
needs to be used. Please refer to Qiu and Yang (2021) for more details of 
the method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sptemnt_ewmac(
  y,
  x,
  st,
  type,
  ARL0 = 200,
  ARL0.z = 200,
  lambda = 0.1,
  B = 1000,
  bs = 5,
  T = 1,
  ht = NULL,
  hs = NULL,
  gt = NULL,
  gs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sptemnt_ewmac_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_x">x</code></td>
<td>
<p>An <code class="reqn">N\times p</code> matrix containing the data of <code class="reqn">p</code> covariates.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations and times for 
all the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_type">type</code></td>
<td>
<p>A vector of <code class="reqn">N</code> characters specifying the types of the observations. 
Here, <code>type</code> could be <code>IC1</code>, <code>IC2</code> or <code>Mnt</code>, where 
<code>type='IC1'</code> denotes the in-control (IC) observations used to perform 
the block bootstrap procedure to determine the control limit of the CUSUM 
chart, <code>type='IC2'</code> denotes the IC observations used to estimate the 
spatio-temporal mean and covariance functions by <code>spte_meanest</code> and 
<code>spte_covest</code>, and <code>type='Mnt'</code> denotes the observations used 
for online process monitoring (cf., Yang and Qiu 2021). If there are only 
data points with either <code>type='IC1'</code> or <code>type='IC2'</code>, then these 
data points will be used to estimate the model and conduct the bootstrap 
procedure as well. This function will return an error if there are no 
observations with <code>type='IC1'</code> or <code>type='IC2'</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_arl0">ARL0</code></td>
<td>
<p>The pre-specified IC average run length. Default is 200.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_arl0.z">ARL0.z</code></td>
<td>
<p>The pre-specified IC average run length for the covariate chart.
Default is 200. Usually, set <code>ARL0.z=ARL0</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_lambda">lambda</code></td>
<td>
<p>The pre-specified weighting parameter in the EWMAC chart. Default is 0.1.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_b">B</code></td>
<td>
<p>The bootstrap sizes used in the block bootstrap procedure for determining 
the control limit. Default value is 1,000.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_bs">bs</code></td>
<td>
<p>The block size of the block bootstrap procedure. Default value is 5.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_t">T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation via <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_gt">gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code> and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewmac_+3A_gs">gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ARL0</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>cstat</code></td>
<td>
<p>The charting statistics which can be used to make 
a plot for the control chart.</p>
</td></tr>
<tr><td><code>cl</code></td>
<td>
<p>The control limit that is determined by the block bootstrap.</p>
</td></tr>
<tr><td><code>signal_time</code></td>
<td>
<p>The signal time (i.e., the first time point when the 
charting statistic <code>cstat</code> exceeds the control limit <code>cl</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2021). Effective Disease Surveillance by Using Covariate 
Information. <em>Statistics in Medicine</em>, <strong>40</strong>, 5725-5745.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(ili_dat)
n &lt;- 365; m &lt;- 67
y &lt;- ili_dat$Rate; x &lt;- as.matrix(ili_dat[,7:8]); st &lt;- ili_dat[,3:5]
type &lt;- rep(c('IC1','IC2','Mnt'),c(m*(n+1),(m*n),(m*n)))
ids &lt;- c(1:(5*m),((n+1)*m+1):(m*(n+6)),((2*n+1)*m+1):(m*(2*n+6)))
y.sub &lt;- y[ids]; x.sub &lt;- x[ids,]; st.sub &lt;- st[ids,]; type.sub &lt;- type[ids]
ili.ewmac &lt;- sptemnt_ewmac(y.sub,x.sub,st.sub,type.sub,ht=0.05,hs=6.5,gt=0.25,gs=1.5)
</code></pre>

<hr>
<h2 id='sptemnt_ewsl'>Spatio-temporal process monitoring using exponentially weighted spatial LASSO</h2><span id='topic+sptemnt_ewsl'></span>

<h3>Description</h3>

<p>Implementation of the online spatio-temporal process monitoring procedure 
described in Qiu and Yang (2023), in which spatial locations with the detected 
shifts are guaranteed to be small clustered spatal regions by the exponentially 
weighted spatial LASSO.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sptemnt_ewsl(
  y,
  st,
  type,
  ARL0 = 200,
  lambda = 0.1,
  B = 1000,
  bs = 5,
  T = 1,
  ht = NULL,
  hs = NULL,
  gt = NULL,
  gs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sptemnt_ewsl_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">N</code> spatio-temporal observations.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_st">st</code></td>
<td>
<p>An <code class="reqn">N\times 3</code> matrix specifying the spatial locations and times for 
all the spatio-temporal observations in <code>y</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_type">type</code></td>
<td>
<p>A vector of <code class="reqn">N</code> characters specifying the types of the observations. 
Here, <code>type</code> could be <code>IC1</code>, <code>IC2</code> or <code>Mnt</code>, where 
<code>type='IC1'</code> denotes the in-control (IC) observations used to perform 
the block bootstrap procedure to determine the control limit of the CUSUM 
chart, <code>type='IC2'</code> denotes the IC observations used to estimate the 
spatio-temporal mean and covariance functions by <code>spte_meanest</code> and 
<code>spte_covest</code>, and <code>type='Mnt'</code> denotes the observations used 
for online process monitoring (cf., Yang and Qiu 2021). If there are only 
data points with either <code>type='IC1'</code> or <code>type='IC2'</code>, then these 
data points will be used to estimate the model and conduct the bootstrap 
procedure as well. This function will return an error if there are no 
observations with <code>type='IC1'</code> or <code>type='IC2'</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_arl0">ARL0</code></td>
<td>
<p>The pre-specified IC average run length. Default is 200.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_lambda">lambda</code></td>
<td>
<p>The pre-specified weighting parameter in the EWMAC chart. Default is 0.1.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_b">B</code></td>
<td>
<p>The bootstrap sizes used in the block bootstrap procedure for determining 
the control limit. Default value is 1,000.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_bs">bs</code></td>
<td>
<p>The block size of the block bootstrap procedure. Default value is 5.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_t">T</code></td>
<td>
<p>The period of the spatio-temporal mean and covariance. Default value is 1.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_ht">ht</code></td>
<td>
<p>The temporal kernel bandwidth <code>ht</code>; default is <code>NULL</code> and it will 
be chosen by the modified cross-validation via <code>mod_cv</code> if <code>ht=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_hs">hs</code></td>
<td>
<p>The spatial kernel bandwidth <code>hs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>mod_cv</code> if <code>hs=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_gt">gt</code></td>
<td>
<p>The temporal kernel bandwidth <code>gt</code>; default is <code>NULL</code> and it will 
be chosen by minimizing the mean squared prediction error via <code>cv_mspe</code> 
if <code>gt=NULL</code>.</p>
</td></tr>
<tr><td><code id="sptemnt_ewsl_+3A_gs">gs</code></td>
<td>
<p>The spatial kernel bandwidth <code>gs</code>; default is <code>NULL</code>,  and it will 
be chosen by the function <code>cv_mspe</code> if <code>gs=NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ARL0</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Same as the one in the arguments.</p>
</td></tr>
<tr><td><code>cstat</code></td>
<td>
<p>The charting statistics which can be used to make 
a plot for the control chart.</p>
</td></tr>
<tr><td><code>cl</code></td>
<td>
<p>The control limit that is determined by the block bootstrap.</p>
</td></tr>
<tr><td><code>signal_time</code></td>
<td>
<p>The signal time (i.e., the first time point when the 
charting statistic <code>cstat</code> exceeds the control limit <code>cl</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kai Yang <a href="mailto:kayang@mcw.edu">kayang@mcw.edu</a> and Peihua Qiu
</p>


<h3>References</h3>

<p>Qiu, P. and Yang, K. (2023). Spatio-Temporal Process Monitoring Using 
Exponentially Weighted Spatial LASSO. <em>Journal of Quality Technology</em>, 
<strong>55</strong>, 163-180.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SpTe2M)
data(ili_dat)
n &lt;- 365; m &lt;- 67
y &lt;- ili_dat$Rate; st &lt;- ili_dat[,3:5]
type &lt;- rep(c('IC1','IC2','Mnt'),c(m*(n+1),(m*n),(m*n)))
ids &lt;- c(1:(5*m),((n+1)*m+1):(m*(n+6)),((2*n+1)*m+1):(m*(2*n+6)))
y.sub &lt;- y[ids]; st.sub &lt;- st[ids,]; type.sub &lt;- type[ids]
ili.ewsl &lt;- sptemnt_ewsl(y.sub,st.sub,type.sub,ht=0.05,hs=6.5,gt=0.25,gs=1.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
