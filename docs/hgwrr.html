<!DOCTYPE html><html><head><title>Help for package hgwrr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hgwrr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.hgwrm'><p>Get estimated coefficients.</p></a></li>
<li><a href='#fitted.hgwrm'><p>Get fitted reponse.</p></a></li>
<li><a href='#hgwr'><p>Hierarchical and Geographically Weighted Regression</p></a></li>
<li><a href='#hgwrr-package'>
<p>HGWR: Hierarchical and Geographically Weighted Regression</p></a></li>
<li><a href='#matrix2char'><p>Convert a numeric matrix to character matrix according to a format string.</p></a></li>
<li><a href='#multisampling'><p>Simulated Spatial Multisampling Data (DataFrame)</p></a></li>
<li><a href='#multisampling.large'><p>Large Scale Simulated Spatial Multisampling Data (DataFrame)</p></a></li>
<li><a href='#parse.formula'><p>Parse a HGWR formula.</p></a></li>
<li><a href='#print.hgwrm'><p>Print description of a <code>hgwrm</code> object.</p></a></li>
<li><a href='#print.summary.hgwrm'><p>Print summary of an <code>hgwrm</code> object.</p></a></li>
<li><a href='#print.table.md'><p>Print a character matrix as a table.</p></a></li>
<li><a href='#residuals.hgwrm'><p>Get residuals.</p></a></li>
<li><a href='#summary.hgwrm'><p>Summary an <code>hgwrm</code> object.</p></a></li>
<li><a href='#wuhan.hp'><p>Wuhan Second-hand House Price and POI Data (DataFrame)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical and Geographically Weighted Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Yigong Hu, Richard Harris, Richard Timmerman</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yigong Hu &lt;yigong.hu@bristol.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This model divides coefficients into three types,
        i.e., local fixed effects, global fixed effects, and random effects (Hu et al., 2022)&lt;<a href="https://doi.org/10.1177%2F23998083211063885">doi:10.1177/23998083211063885</a>&gt;.
        If data have spatial hierarchical structures (especially are overlapping on some locations),
        it is worth trying this model to reach better fitness.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/HPDell/hgwr/">https://github.com/HPDell/hgwr/</a>, <a href="https://hpdell.github.io/hgwr/">https://hpdell.github.io/hgwr/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats, utils</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-26 09:38:35 UTC; yigong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-26 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.hgwrm'>Get estimated coefficients.</h2><span id='topic+coef.hgwrm'></span>

<h3>Description</h3>

<p>Get estimated coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hgwrm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.hgwrm_+3A_object">object</code></td>
<td>
<p>An <code>hgwrm</code> object returned by <code><a href="#topic+hgwr">hgwr()</a></code>.</p>
</td></tr>
<tr><td><code id="coef.hgwrm_+3A_...">...</code></td>
<td>
<p>Parameter received from other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>DataFrame</code> object consists of all estimated coefficients.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hgwr">hgwr()</a></code>, <code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>, <code><a href="#topic+fitted.hgwrm">fitted.hgwrm()</a></code> and <code><a href="#topic+residuals.hgwrm">residuals.hgwrm()</a></code>.
</p>

<hr>
<h2 id='fitted.hgwrm'>Get fitted reponse.</h2><span id='topic+fitted.hgwrm'></span>

<h3>Description</h3>

<p>Get fitted reponse.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hgwrm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.hgwrm_+3A_object">object</code></td>
<td>
<p>An <code>hgwrm</code> object returned by <code><a href="#topic+hgwr">hgwr()</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.hgwrm_+3A_...">...</code></td>
<td>
<p>Parameter received from other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector consists of fitted response values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hgwr">hgwr()</a></code>, <code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>, <code><a href="#topic+coef.hgwrm">coef.hgwrm()</a></code> and <code><a href="#topic+residuals.hgwrm">residuals.hgwrm()</a></code>.
</p>

<hr>
<h2 id='hgwr'>Hierarchical and Geographically Weighted Regression</h2><span id='topic+hgwr'></span>

<h3>Description</h3>

<p>A Hierarchical Linear Model (HLM) with local fixed effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hgwr(
  formula,
  data,
  local.fixed,
  coords,
  bw = "CV",
  kernel = c("gaussian", "bisquared"),
  alpha = 0.01,
  eps_iter = 1e-06,
  eps_gradient = 1e-06,
  max_iters = 1e+06,
  max_retries = 1e+06,
  ml_type = c("D_Only", "D_Beta"),
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hgwr_+3A_formula">formula</code></td>
<td>
<p>A formula.
Its structure is similar to <code><a href="lme4.html#topic+lmer">lmer</a></code> function
in <strong>lme4</strong> package.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_data">data</code></td>
<td>
<p>A DataFrame.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_local.fixed">local.fixed</code></td>
<td>
<p>A character vector.
It contains names of local fixed effects.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_coords">coords</code></td>
<td>
<p>A 2-column matrix.
It consists of coordinates for each group.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_bw">bw</code></td>
<td>
<p>A numeric value. It is the value of bandwidth or <code>"CV"</code>.
In this stage this function only support adaptive bandwidth.
And its unit must be the number of nearest neighbours.
If <code>"CV"</code> is specified, the algorithm will automatically select an
optimized bandwidth value.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_kernel">kernel</code></td>
<td>
<p>A character value. It specify which kernel function is used
in GWR part. Possible values are
</p>

<dl>
<dt><code>gaussian</code></dt><dd><p>Gaussian kernel function <code class="reqn">k(d)=\exp\left(-\frac{d^2}{b^2}\right)</code></p>
</dd>
<dt><code>bisquared</code></dt><dd><p>Bi-squared kernel function. If <code class="reqn">d&lt;b</code> then <code class="reqn">k(d)=\left(1-\frac{d^2}{b^2}\right)^2</code> else <code class="reqn">k(d)=0</code></p>
</dd>
</dl>
</td></tr>
<tr><td><code id="hgwr_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value. It is the size of the first trial step in
maximum likelihood algorithm.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_eps_iter">eps_iter</code></td>
<td>
<p>A numeric value. Terminate threshold of back-fitting.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_eps_gradient">eps_gradient</code></td>
<td>
<p>A numeric value. Terminate threshold of
maximum likelihood algorithm.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_max_iters">max_iters</code></td>
<td>
<p>An integer value. The maximum of iteration.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_max_retries">max_retries</code></td>
<td>
<p>An integer value. If the algorithm tends to be diverge,
it stops automatically after trying <em>max_retires</em> times.</p>
</td></tr>
<tr><td><code id="hgwr_+3A_ml_type">ml_type</code></td>
<td>
<p>An integer value. Represent which maximum likelihood
algorithm is used. Possible values are:
</p>

<dl>
<dt><code>D_Only</code></dt><dd><p>Only <code class="reqn">D</code> is specified by maximum likelihood.</p>
</dd>
<dt><code>D_Beta</code></dt><dd><p>Both <code class="reqn">D</code> and <code class="reqn">beta</code> is specified by maximum likelihood.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="hgwr_+3A_verbose">verbose</code></td>
<td>
<p>An integer value. Determine the log level.
Possible values are:
</p>

<dl>
<dt>0</dt><dd><p>no log is printed.</p>
</dd>
<dt>1</dt><dd><p>only logs in back-fitting are printed.</p>
</dd>
<dt>2</dt><dd><p>all logs are printed.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list describing the model with following fields.
</p>

<dl>
<dt><code>gamma</code></dt><dd><p>Coefficients of local fixed effects.</p>
</dd>
<dt><code>beta</code></dt><dd><p>Coefficients of global fixed effects.</p>
</dd>
<dt><code>mu</code></dt><dd><p>Coefficients of random effects.</p>
</dd>
<dt><code>D</code></dt><dd><p>Variance-covariance matrix of random effects.</p>
</dd>
<dt><code>sigma</code></dt><dd><p>Variance of errors.</p>
</dd>
<dt><code>effects</code></dt><dd><p>A list including names of all effects.</p>
</dd>
<dt><code>call</code></dt><dd><p>Calling of this function.</p>
</dd>
<dt><code>frame</code></dt><dd><p>The DataFrame object sent to this call.</p>
</dd>
<dt><code>frame.parsed</code></dt><dd><p>Variables extracted from the data.</p>
</dd>
<dt><code>groups</code></dt><dd><p>Unique group labels extracted from the data.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(multisampling)
hgwr(formula = y ~ g1 + g2 + x1 + (z1 | group),
     data = multisampling$data,
     local.fixed = c("g1", "g2"),
     coords = multisampling$coords,
     bw = 10)

</code></pre>

<hr>
<h2 id='hgwrr-package'>
HGWR: Hierarchical and Geographically Weighted Regression
</h2><span id='topic+hgwrr-package'></span><span id='topic+hgwrr'></span>

<h3>Description</h3>

<p>An R and C++ implementation of Hierarchical and Geographically Weighted
Regression (HGWR) model is provided in this package. This model divides
coefficients into three types: local fixed effects, global fixed effects,
and random effects. If data have spatial hierarchical structures
(especially are overlapping on some locations),
it is worth trying this model to reach better fitness.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> hgwrr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Hierarchical and Geographically Weighted Regression</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.3-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-05-24</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Yigong Hu, Richard Harris, Richard Timmerman</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Yigong Hu &lt;yigong.hu@bristol.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> This model divides coefficients into three types,
        i.e., local fixed effects, global fixed effects, and random effects (Hu et al., 2022)&lt;doi:10.1177/23998083211063885&gt;.
        If data have spatial hierarchical structures (especially are overlapping on some locations),
        it is worth trying this model to reach better fitness.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://github.com/HPDell/hgwr/, https://hpdell.github.io/hgwr/</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> Rcpp (&gt;= 1.0.8)</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp, RcppArmadillo</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0), stats, utils</td>
</tr>
<tr>
 <td style="text-align: left;">
SystemRequirements: </td><td style="text-align: left;"> GNU make</td>
</tr>
<tr>
 <td style="text-align: left;">
Roxygen: </td><td style="text-align: left;"> list(markdown = TRUE)</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.2.3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
coef.hgwrm              Get estimated coefficients.
fitted.hgwrm            Get fitted reponse.
hgwr                    Hierarchical and Geographically Weighted
                        Regression
hgwrr-package           HGWR: Hierarchical and Geographically Weighted
                        Regression
matrix2char             Convert a numeric matrix to character matrix
                        according to a format string.
multisampling           Simulated Spatial Multisampling Data
                        (DataFrame)
multisampling.large     Large Scale Simulated Spatial Multisampling
                        Data (DataFrame)
parse.formula           Parse a HGWR formula.
print.hgwrm             Print description of a 'hgwrm' object.
print.summary.hgwrm     Print summary of an 'hgwrm' object.
print.table.md          Print a character matrix as a table.
residuals.hgwrm         Get residuals.
summary.hgwrm           Summary an 'hgwrm' object.
wuhan.hp                Wuhan Second-hand House Price and POI Data
                        (DataFrame)
</pre>


<h3>Author(s)</h3>

<p>Yigong Hu, Richard Harris, Richard Timmerman
</p>
<p>Maintainer: Yigong Hu &lt;yigong.hu@bristol.ac.uk&gt;
</p>


<h3>References</h3>

<p>Hu, Y., Lu, B., Ge, Y., Dong, G., 2022.
Uncovering spatial heterogeneity in real estate prices via
combined hierarchical linear model and geographically weighted regression.
Environment and Planning B: Urban Analytics and City Science.
DOI: 10.1177/23998083211063885.
</p>

<hr>
<h2 id='matrix2char'>Convert a numeric matrix to character matrix according to a format string.</h2><span id='topic+matrix2char'></span>

<h3>Description</h3>

<p>Convert a numeric matrix to character matrix according to a format string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix2char(m, fmt = "%.6f")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix2char_+3A_m">m</code></td>
<td>
<p>A numeric matrix.</p>
</td></tr>
<tr><td><code id="matrix2char_+3A_fmt">fmt</code></td>
<td>
<p>Format string. Passing to <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sprintf">base::sprintf()</a></code>, <code><a href="#topic+print.hgwrm">print.hgwrm()</a></code>, <code><a href="#topic+print.summary.hgwrm">print.summary.hgwrm()</a></code>.
</p>

<hr>
<h2 id='multisampling'>Simulated Spatial Multisampling Data (DataFrame)</h2><span id='topic+multisampling'></span>

<h3>Description</h3>

<p>A simulation data of spatial hierarchical structure and
samples overlapping on certain locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(multisampling)</code></pre>


<h3>Format</h3>

<p>A list of two items called &quot;data&quot; and &quot;coord&quot;.
Item &quot;data&quot; is a data frame with 484 observations at 16 locations
on the following 6 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a numeric vector, dependent variable <code class="reqn">y</code></p>
</dd>
<dt><code>g1</code></dt><dd><p>a numeric vector, group level independent variable <code class="reqn">g_1</code></p>
</dd>
<dt><code>g2</code></dt><dd><p>a numeric vector, group level independent variable <code class="reqn">g_2</code></p>
</dd>
<dt><code>z1</code></dt><dd><p>a numeric vector, sample level independent variable <code class="reqn">z_1</code></p>
</dd>
<dt><code>x1</code></dt><dd><p>a numeric vector, sample level independent variable <code class="reqn">x_1</code></p>
</dd>
<dt><code>group</code></dt><dd><p>a numeric vector, group id of each sample</p>
</dd>
</dl>

<p>where <code>g1</code> and <code>g2</code> are used to estimate local fixed effects;
<code>x1</code> is used to estimate global fixed effects
and <code>z1</code> is used to estimate random effects.
</p>


<h3>Author(s)</h3>

<p>Yigong Hu <a href="mailto:yigong.hu@bristol.ac.uk">yigong.hu@bristol.ac.uk</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(multisampling)
hgwr(formula = y ~ g1 + g2 + x1 + (z1 | group),
     data = multisampling$data,
     local.fixed = c("g1", "g2"),
     coords = multisampling$coords,
     bw = 10)
</code></pre>

<hr>
<h2 id='multisampling.large'>Large Scale Simulated Spatial Multisampling Data (DataFrame)</h2><span id='topic+multisampling.large'></span>

<h3>Description</h3>

<p>A large scale simulation data of spatial hierarchical structure and
samples overlapping on certain locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(multisampling)</code></pre>


<h3>Format</h3>

<p>A list of three items called &quot;data&quot;, &quot;coords&quot; and &quot;beta&quot;.
Item &quot;data&quot; is a data frame with 13862 observations at 200 locations
and the following 6 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>a numeric vector, dependent variable <code class="reqn">y</code></p>
</dd>
<dt><code>g1</code></dt><dd><p>a numeric vector, group level independent variable <code class="reqn">g_1</code></p>
</dd>
<dt><code>g2</code></dt><dd><p>a numeric vector, group level independent variable <code class="reqn">g_2</code></p>
</dd>
<dt><code>z1</code></dt><dd><p>a numeric vector, sample level independent variable <code class="reqn">z_1</code></p>
</dd>
<dt><code>x1</code></dt><dd><p>a numeric vector, sample level independent variable <code class="reqn">x_1</code></p>
</dd>
<dt><code>group</code></dt><dd><p>a numeric vector, group id of each sample</p>
</dd>
</dl>

<p>where <code>g1</code> and <code>g2</code> are used to estimate local fixed effects;
<code>x1</code> is used to estimate global fixed effects
and <code>z1</code> is used to estimate random effects.
</p>


<h3>Author(s)</h3>

<p>Yigong Hu <a href="mailto:yigong.hu@bristol.ac.uk">yigong.hu@bristol.ac.uk</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(multisampling.large)
hgwr(formula = y ~ g1 + g2 + x1 + (z1 | group),
     data = multisampling.large$data,
     local.fixed = c("g1", "g2"),
     coords = multisampling.large$coords,
     bw = 32, kernel = "bisquared")

## End(Not run)
</code></pre>

<hr>
<h2 id='parse.formula'>Parse a HGWR formula.</h2><span id='topic+parse.formula'></span><span id='topic+stack.push'></span><span id='topic+stack.pop'></span>

<h3>Description</h3>

<p>This function accept an R formula object and extract names of
the group variable, local fixed effects, global fixed effects
and random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse.formula(formula)

## S3 method for class 'push'
stack(s, x)

## S3 method for class 'pop'
stack(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse.formula_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object.
Its format is much like the formula used in <code><a href="lme4.html#topic+lmer">lmer</a></code>
from package &rdquo;<strong>lme4</strong>&rdquo;.</p>
</td></tr>
<tr><td><code id="parse.formula_+3A_s">s</code></td>
<td>
<p>A <code>list</code>, <code>vector</code> or any other object which works with
function <code><a href="base.html#topic+c">c</a></code></p>
</td></tr>
<tr><td><code id="parse.formula_+3A_x">x</code></td>
<td>
<p>An object which can be appended to <code>s</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> consists of:
- <code>response</code>: name of dependent (response) variable.
- <code>group</code>: name of group variable.
- <code>random.effects</code>: a vector of names of random effects.
- <code>fixed.effects</code>: a vector of names of fixed effects.
</p>

<hr>
<h2 id='print.hgwrm'>Print description of a <code>hgwrm</code> object.</h2><span id='topic+print.hgwrm'></span>

<h3>Description</h3>

<p>Print description of a <code>hgwrm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hgwrm'
print(x, decimal.fmt = "%.6f", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hgwrm_+3A_x">x</code></td>
<td>
<p>An <code>hgwrm</code> object returned by <code><a href="#topic+hgwr">hgwr()</a></code>.</p>
</td></tr>
<tr><td><code id="print.hgwrm_+3A_decimal.fmt">decimal.fmt</code></td>
<td>
<p>The format string passing to <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>.</p>
</td></tr>
<tr><td><code id="print.hgwrm_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+print.table.md">print.table.md</a></code>
</p>

<dl>
<dt><code>col.sep</code></dt><dd><p>Column seperator. Default to <code>""</code>.</p>
</dd>
<dt><code>header.sep</code></dt><dd><p>Header seperator. Default to <code>"-"</code>.</p>
</dd>
<dt><code>row.begin</code></dt><dd><p>Character at the beginning of each row.
Default to <code>col.sep</code>.</p>
</dd>
<dt><code>row.end</code></dt><dd><p>Character at the ending of each row.
Default to <code>col.sep</code>.</p>
</dd>
<dt><code>table.style</code></dt><dd><p>Name of pre-defined style.
Possible values are <code>"plain"</code>, <code>"md"</code> or <code>"latex"</code>. Default to <code>"plain"</code>.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>No return.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>, <code><a href="#topic+print.table.md">print.table.md()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(multisampling)
model &lt;- hgwr(formula = y ~ g1 + g2 + x1 + (z1 | group),
              data = multisampling$data,
              local.fixed = c("g1", "g2"),
              coords = multisampling$coords,
              bw = 10)
print(model)
print(model, table.style = "md")

</code></pre>

<hr>
<h2 id='print.summary.hgwrm'>Print summary of an <code>hgwrm</code> object.</h2><span id='topic+print.summary.hgwrm'></span>

<h3>Description</h3>

<p>Print summary of an <code>hgwrm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.hgwrm'
print(x, decimal.fmt = "%.6f", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.hgwrm_+3A_x">x</code></td>
<td>
<p>An object returned from <code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.hgwrm_+3A_decimal.fmt">decimal.fmt</code></td>
<td>
<p>The format string passing to <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>.</p>
</td></tr>
<tr><td><code id="print.summary.hgwrm_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+print.table.md">print.table.md</a></code>
</p>

<dl>
<dt><code>col.sep</code></dt><dd><p>Column seperator. Default to <code>""</code>.</p>
</dd>
<dt><code>header.sep</code></dt><dd><p>Header seperator. Default to <code>"-"</code>.</p>
</dd>
<dt><code>row.begin</code></dt><dd><p>Character at the beginning of each row.
Default to <code>col.sep</code>.</p>
</dd>
<dt><code>row.end</code></dt><dd><p>Character at the ending of each row.
Default to <code>col.sep</code>.</p>
</dd>
<dt><code>table.style</code></dt><dd><p>Name of pre-defined style.
Possible values are <code>"plain"</code>, <code>"md"</code> or <code>"latex"</code>. Default to <code>"plain"</code>.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>No return.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>, <code><a href="#topic+print.table.md">print.table.md()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(multisampling)
model &lt;- hgwr(formula = y ~ g1 + g2 + x1 + (z1 | group),
              data = multisampling$data,
              local.fixed = c("g1", "g2"),
              coords = multisampling$coords,
              bw = 10)
summary(model)

</code></pre>

<hr>
<h2 id='print.table.md'>Print a character matrix as a table.</h2><span id='topic+print.table.md'></span>

<h3>Description</h3>

<p>Print a character matrix as a table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'table.md'
print(
  x,
  col.sep = "",
  header.sep = "",
  row.begin = "",
  row.end = "",
  table.style = c("plain", "md", "latex"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.table.md_+3A_x">x</code></td>
<td>
<p>A character matrix.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_col.sep">col.sep</code></td>
<td>
<p>Column seperator. Default to <code>""</code>.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_header.sep">header.sep</code></td>
<td>
<p>Header seperator. Default to <code>"-"</code>.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_row.begin">row.begin</code></td>
<td>
<p>Character at the beginning of each row.
Default to <code>col.sep</code>.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_row.end">row.end</code></td>
<td>
<p>Character at the ending of each row.
Default to <code>col.sep</code>.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_table.style">table.style</code></td>
<td>
<p>Name of pre-defined style.
Possible values are <code>"plain"</code>, <code>"md"</code> or <code>"latex"</code>. Default to <code>"plain"</code>.</p>
</td></tr>
<tr><td><code id="print.table.md_+3A_...">...</code></td>
<td>
<p>Additional style control arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>table.style</code> is specified, <code>col.sep</code>, <code>header.sep</code>, <code>row.begin</code>
and <code>row.end</code> would not take effects.
Because this function will automatically set their values.
For each possible value of <code>table.style</code>, its corresponding style settings
are shown in the following table.
</p>

<table>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> <strong><code>plain</code></strong> </td><td style="text-align: left;"> <strong><code>md</code></strong> </td><td style="text-align: left;"> <strong><code>latex</code></strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>col.sep</code>    </td><td style="text-align: left;"> <code>""</code>             </td><td style="text-align: left;"> <code>"|"</code>         </td><td style="text-align: left;"> <code>"&amp;"</code>            </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>header.sep</code> </td><td style="text-align: left;"> <code>""</code>             </td><td style="text-align: left;"> <code>"-"</code>         </td><td style="text-align: left;"> <code>""</code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>row.begin</code>  </td><td style="text-align: left;"> <code>""</code>             </td><td style="text-align: left;"> <code>"|"</code>         </td><td style="text-align: left;"> <code>""</code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>row.end</code>    </td><td style="text-align: left;"> <code>""</code>             </td><td style="text-align: left;"> <code>"|"</code>         </td><td style="text-align: left;"> <code>"\\"</code>
</td>
</tr>

</table>

<p>In this function, characters are right padded by spaces.
</p>


<h3>Value</h3>

<p>No return.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.hgwrm">print.hgwrm()</a></code>, <code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>.
</p>

<hr>
<h2 id='residuals.hgwrm'>Get residuals.</h2><span id='topic+residuals.hgwrm'></span>

<h3>Description</h3>

<p>Get residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hgwrm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.hgwrm_+3A_object">object</code></td>
<td>
<p>An <code>hgwrm</code> object returned by <code><a href="#topic+hgwr">hgwr()</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.hgwrm_+3A_...">...</code></td>
<td>
<p>Parameter received from other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector consists of residuals.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hgwr">hgwr()</a></code>, <code><a href="#topic+summary.hgwrm">summary.hgwrm()</a></code>, <code><a href="#topic+coef.hgwrm">coef.hgwrm()</a></code> and <code><a href="#topic+fitted.hgwrm">fitted.hgwrm()</a></code>.
</p>

<hr>
<h2 id='summary.hgwrm'>Summary an <code>hgwrm</code> object.</h2><span id='topic+summary.hgwrm'></span>

<h3>Description</h3>

<p>Summary an <code>hgwrm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hgwrm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.hgwrm_+3A_object">object</code></td>
<td>
<p>An <code>hgwrm</code> object returned from <code><a href="#topic+hgwr">hgwr()</a></code>.</p>
</td></tr>
<tr><td><code id="summary.hgwrm_+3A_...">...</code></td>
<td>
<p>Other arguments passed from other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing summary informations of this <code>hgwrm</code> object
with the following fields.
</p>

<dl>
<dt><code>diagnostic</code></dt><dd><p>A list of diagnostic information.</p>
</dd>
<dt><code>random.stddev</code></dt><dd><p>The standard deviation of random effects.</p>
</dd>
<dt><code>random.corr</code></dt><dd><p>The correlation matrix of random effects.</p>
</dd>
<dt><code>residuals</code></dt><dd><p>The residual vector.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+hgwr">hgwr()</a></code>.
</p>

<hr>
<h2 id='wuhan.hp'>Wuhan Second-hand House Price and POI Data (DataFrame)</h2><span id='topic+wuhan.hp'></span>

<h3>Description</h3>

<p>A data set of second-hand house price in Wuhan, China collected in 2018.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(multisampling)</code></pre>


<h3>Format</h3>

<p>A list of two items called &quot;data&quot; and &quot;coords&quot;.
Item &quot;data&quot; is a data frame with 13862 second-hand properties at 779 neighbourhoods
and the following 22 variables.
</p>

<dl>
<dt><code>Price</code></dt><dd><p>House price per square metre.</p>
</dd>
<dt><code>Floor.High</code></dt><dd><p>1 if a property is on a high floor, otherwise 0.</p>
</dd>
<dt><code>Floor.Low</code></dt><dd><p>1 if a property is on a low floor, otherwise 0.</p>
</dd>
<dt><code>Decoration.Fine</code></dt><dd><p>1 if a property is well decorated, otherwise 0.</p>
</dd>
<dt><code>PlateTower</code></dt><dd><p>1 if a property is of the plate-tower type, otherwise 0.</p>
</dd>
<dt><code>Steel</code></dt><dd><p>1 if a property is of 'steel' structure, otherwise 0.</p>
</dd>
<dt><code>BuildingArea</code></dt><dd><p>Building area in square metres.</p>
</dd>
<dt><code>Fee</code></dt><dd><p>Management fee per square meter per month.</p>
</dd>
<dt><code>d.Commercial</code></dt><dd><p>Distance to the nearest commercial area.</p>
</dd>
<dt><code>d.Greenland</code></dt><dd><p>Distance to the nearest green land.</p>
</dd>
<dt><code>d.Water</code></dt><dd><p>Distance to the nearest river or lake.</p>
</dd>
<dt><code>d.University</code></dt><dd><p>Distance to the nearest university.</p>
</dd>
<dt><code>d.HighSchool</code></dt><dd><p>Distance to the nearest high school.</p>
</dd>
<dt><code>d.MiddleSchool</code></dt><dd><p>Distance to the nearest middle school.</p>
</dd>
<dt><code>d.PrimarySchool</code></dt><dd><p>Distance to the nearest primary school.</p>
</dd>
<dt><code>d.Kindergarten</code></dt><dd><p>Distance to the nearest kindergarten.</p>
</dd>
<dt><code>d.SubwayStation</code></dt><dd><p>Distance to the nearest subway station.</p>
</dd>
<dt><code>d.Supermarket</code></dt><dd><p>Distance to the nearest supermarket.</p>
</dd>
<dt><code>d.ShoppingMall</code></dt><dd><p>Distance to the nearest shopping mall.</p>
</dd>
<dt><code>lon</code></dt><dd><p>Longitude coordinates (Projected CRS: EPSG 3857).</p>
</dd>
<dt><code>lat</code></dt><dd><p>Latitude coordinates (Projected CRS: EPSE 3857).</p>
</dd>
<dt><code>group</code></dt><dd><p>Group id of each sample.</p>
</dd>
</dl>

<p>The following variables are group level:
</p>
<p>- <code>Fee</code>
- <code>d.Commercial</code>
- <code>d.Greenland</code>
- <code>d.Water</code>
- <code>d.University</code>
- <code>d.HighSchool</code>
- <code>d.MiddleSchool</code>
- <code>d.PrimarySchool</code>
- <code>d.Kindergarten</code>
- <code>d.SubwayStation</code>
- <code>d.Supermarket</code>
- <code>d.ShoppingMall</code>
</p>
<p>The follwoing variables are sample level:
</p>
<p>- <code>Price</code>
- <code>Floor.High</code>
- <code>Floor.Low</code>
- <code>Decoration.Fine</code>
- <code>PlateTower</code>
- <code>Steel</code>
- <code>BuildingArea</code>
</p>
<p>Item &quot;coords&quot; is a 779-by-2 matrix of coordinates of all neighbourhoods.
</p>


<h3>Author(s)</h3>

<p>Yigong Hu <a href="mailto:yigong.hu@bristol.ac.uk">yigong.hu@bristol.ac.uk</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(wuhan.hp)
hgwr(
  formula = Price ~ d.Water + d.Commercial + d.PrimarySchool +
            d.Kindergarten + Fee + BuildingArea + (Floor.High | group),
  data = wuhan.hp$data,
  local.fixed = c("d.Water", "d.Commercial", "d.PrimarySchool",
                  "d.Kindergarten", "Fee"),
  coords = wuhan.hp$coords, bw = 50, kernel = "bisquared")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
