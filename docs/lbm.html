<!DOCTYPE html><html><head><title>Help for package lbm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lbm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lbm'><p>Log binomial regression model in Exact method</p></a></li>
<li><a href='#lbm.control'><p>Auxiliary control for <code>lbm</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Log Binomial Regression Model in Exact Method</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Chao Zhu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chao Zhu &lt;zhuchao9966@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit the log binomial regression model (LBM) by Exact method. Limited parameter space of 
    LBM causes trouble to find admissible estimates and fail to converge when MLE is close to or on 
    the boundary of space. Exact method utilizes the property of boundary vectors to re-parametrize 
    the model without losing any information, and fits the model on the standard fitting algorithm 
    with no convergence issues. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 3.5.0), utils (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-31 22:39:40 UTC; czhu0035</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-02 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lbm'>Log binomial regression model in Exact method</h2><span id='topic+lbm'></span>

<h3>Description</h3>

<p>If the maximum likelihood (ML) solution lies on the boundary of the
parameter space in log binomial model, a special method is needed
since the standard fitting algorithm may meet numerical difficulties.
Exact method can overcome the difficulties and address the ML solution
when it lies on the boundary of the parameter space.<code>lbm</code>
implemented the exact method to address the ML solution in the log binomial model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbm(formula, data,contrasts = NULL,subset,na.action,lfv=0.95,
           vce = "oim",rescode=NULL,control=lbm.control(),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lbm_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that
can be coerced to that class): a symbolic description of the model
to be fitted. The details of model specification are given under &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="lbm_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing the variables
in the model. If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which <code>lbm</code>
is called.</p>
</td></tr>
<tr><td><code id="lbm_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code>model.matrix.default</code>.</p>
</td></tr>
<tr><td><code id="lbm_+3A_subset">subset</code></td>
<td>
<p>a specification of the rows to be used: defaults to all rows.
This can be any valid indexing vector (see [<code>.data.frame</code>] for the
rows of data or if that is not supplied, a data frame made up of the
variables used in formula.</p>
</td></tr>
<tr><td><code id="lbm_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code><a href="stats.html#topic+na.action">na.action</a></code>, and is <code><a href="stats.html#topic+na.fail">na.fail</a></code> if that
is unset. The 'factory-fresh' default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.
Another possible value is <code>NULL</code>, no action. Value
<code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.</p>
</td></tr>
<tr><td><code id="lbm_+3A_lfv">lfv</code></td>
<td>
<p>a testing range option which decides the range of boundary vector candidates included for testing.
The default value is 0.95, which means the covariate vectors with probability
greater than 0.95 will be included into boundary pairing system as boundary vector candidates.</p>
</td></tr>
<tr><td><code id="lbm_+3A_vce">vce</code></td>
<td>
<p>the type of the information matrix used to attain the variance-covariance matrix.
Two options could be selected, observed information matrix (OIM) and expected information
matrix (EIM). The default <code>vce</code> is <code>"OIM"</code>. This argument only works in the data with
boundary vector. If there is no boundary vector included in the data, the results
are from <code>glm</code>. In the <code>glm</code>, the standard error is calculated
by expected information matrix.</p>
</td></tr>
<tr><td><code id="lbm_+3A_rescode">rescode</code></td>
<td>
<p>is an option to code the response variable if it is a factor.</p>
</td></tr>
<tr><td><code id="lbm_+3A_control">control</code></td>
<td>
<p>The <code>control</code> argument of <code>lbm</code> is by default passed to the arguments of <code><a href="#topic+lbm.control">lbm.control</a></code>.</p>
</td></tr>
<tr><td><code id="lbm_+3A_...">...</code></td>
<td>
<p>For <code>lbm</code>, arguments to be used to form the default control argument if it is not supplied directly.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A typical predictor has the form <code>response ~ terms</code> where
response is the (numeric) response vector and terms is a series of
terms which specifies a linear predictor for response. A terms
specification of the form <code>first + second</code> indicates all the
terms in first together with all the terms in second with any
duplicates removed.
A specification of the form <code>first:second</code> indicates the set of
terms obtained by taking the interactions of all terms in first with
all terms in second. The specification <code>first*second</code> indicates
the cross of first and second. This is the same as
<code>first + second + first:second</code>.
The terms in the formula will be re-ordered so that main effects come
first, followed by the interactions, all second-order, all third-order
and so on: to avoid this pass a terms object as the formula.
</p>


<h3>Value</h3>

<p><code>lbm</code> returns an object of class inheriting from <code>"lbm"</code> which
inherits from the class <code>"lbm"</code>. The function <code>summary</code> (i.e.,
<code>summary.lbm</code>) can be used to obtain or print a summary of the estimates
and the relevant confidence interval. The argument <code>CF.lvl</code> in
<code>summary</code> represents the level of confidence interval claimed in the
model. The default value is <code>CF.lvl=0.95</code>. Optionally, Risk ratio estimates
and their related confidence interval are offered as an argument <code>RR</code> in
the <code>summary</code>. The default <code>RR=FALSE</code> is not to display them.
</p>
<p>An object of class <code>"lbm"</code> is a list containing at least the following
components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the working residuals, that is the residuals in the final
iteration of the IWLS fit.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming the
linear predictors by the inverse of the log link function.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear fit on log scale.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>twice the absolute value of maximized log-likelihood.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>A version of Akaike's An Information Criterion, minus twice the
maximized log-likelihood plus twice the number of parameters, computed by
the <code>aic</code> component of the family. For the binomial model, the dispersion
is fixed at one and the number of parameters is the number of coefficients.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>The deviance for the null model, comparable with
<code>deviance</code>. The null model will only include an intercept if there is
one in the model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>the response vector used in the mode.l</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the unscaled (<code>dispersion = 1</code>) estimated covariance matrix
of the estimated coefficients.</p>
</td></tr>
<tr><td><code>vce</code></td>
<td>
<p>the type of information matrix applied.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>(where relevant) information returned by <code>stats::model.frame</code>
on the special handling of <code>NA</code>.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>(where relevant) the contrasts used.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula supplied.</p>
</td></tr>
<tr><td><code>factor</code></td>
<td>
<p>the order of factors used in the response variable.</p>
</td></tr>
<tr><td><code>bvector</code></td>
<td>
<p>the matrix of boundary vectors.</p>
</td></tr>
<tr><td><code>bv</code></td>
<td>
<p>logical. Determines whether the model has boundary vectors.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Petersen, M. R. &amp; Deddens, J. A. (2010). Maximum likelihood estimation
of the log-binomial model. <em>Communications in Statistics - Theory
and Methods</em>, 39: 5, 874 - 883.
</p>


<h3>See Also</h3>

<p><code>glm</code>, <code>lm</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Two examples are from Petersen, M. R. &amp; Deddens, J. A. (2010).

## Example 1.
x&lt;-c(1:10)
y&lt;-c(0,0,0,0,1,0,1,1,1,1)
data&lt;-data.frame(x,y)
a&lt;-lbm(formula=y~x,data=data,vce="eim")

## Example 2.
x1&lt;-c(1:11)
x2&lt;-x1^2
y&lt;-c(10,6,4,3,3,2,3,3,4,6,10)
dat&lt;-cbind(x1,x2,y)
dat1&lt;-apply(dat, 1, function(t) {
  temp&lt;-data.frame(x1=rep(t[1],10),x2=rep(t[2],10),y=0)
  temp$y[1:t[3]]&lt;-1
  return(temp)
})
data&lt;-do.call(rbind, dat1)
a&lt;-lbm(formula=y~x1+x2,data=data)
summary(a)

</code></pre>

<hr>
<h2 id='lbm.control'>Auxiliary control for <code>lbm</code></h2><span id='topic+lbm.control'></span>

<h3>Description</h3>

<p>Auxiliary function for <code>lbm</code> fitting. Only used
internally by <code>lbm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lbm.control(epsilon = 1e-8, maxit = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lbm.control_+3A_epsilon">epsilon</code></td>
<td>
<p>positive convergence tolerance <code>epsilon</code>;</p>
</td></tr>
<tr><td><code id="lbm.control_+3A_maxit">maxit</code></td>
<td>
<p>integer giving the maximal number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components named as the arguments.
</p>


<h3>See Also</h3>

<p><code>glm.control</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
