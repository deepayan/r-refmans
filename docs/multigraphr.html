<!DOCTYPE html><html lang="en"><head><title>Help for package multigraphr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multigraphr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_degree_seq'><p>Degree sequence of a multigraph</p></a></li>
<li><a href='#get_edge_assignment_probs'><p>Edge assignment probabilities under IEA model given fixed degrees</p></a></li>
<li><a href='#get_edge_multip_seq'><p>Edge multiplicity sequences of multigraphs given fixed degrees</p></a></li>
<li><a href='#gof_sim'><p>Goodness of fit test simulations for random multigraph models</p></a></li>
<li><a href='#gof_stats'><p>Exact probability distributions and moments of goodness of fit statistics</p></a></li>
<li><a href='#gof_test'><p>Goodness of fit tests for random multigraph models</p></a></li>
<li><a href='#iea_model'><p>Independent edge assignment model for multigraphs</p></a></li>
<li><a href='#nsumk'><p>Ordered <em>n</em>-tuples of non-negative integers summing to <em>k</em></p></a></li>
<li><a href='#rsm_model'><p>Random stub matching model for multigraphs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Probability Models and Statistical Analysis of Random
Multigraphs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods and models for analysing multigraphs as introduced by Shafie (2015) &lt;<a href="https://doi.org/10.21307%2Fjoss-2019-011">doi:10.21307/joss-2019-011</a>&gt;, including methods to study local and global properties &lt;<a href="https://doi.org/10.1080%2F0022250X.2016.1219732">doi:10.1080/0022250X.2016.1219732</a>&gt; and goodness of fit tests.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/termehs/multigraphr">https://github.com/termehs/multigraphr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/termehs/multigraphr/issues">https://github.com/termehs/multigraphr/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 16:47:53 UTC; termehshafie</td>
</tr>
<tr>
<td>Author:</td>
<td>Termeh Shafie [aut, cre],
  David Schoch <a href="https://orcid.org/0000-0003-2952-4812"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Termeh Shafie &lt;termeh.shafie@uni-konstanz.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-20 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_degree_seq'>Degree sequence of a multigraph</h2><span id='topic+get_degree_seq'></span>

<h3>Description</h3>

<p>Finds the degree sequence of the adjacency matrix of an observed graph or multigraph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_degree_seq(adj, type = "multigraph")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_degree_seq_+3A_adj">adj</code></td>
<td>
<p>matrix of integers representing graph adjacency matrix.</p>
</td></tr>
<tr><td><code id="get_degree_seq_+3A_type">type</code></td>
<td>
<p>equals <code>'graph'</code> if adjacency matrix is for graphs (default),
equals <code>'multigraph'</code> if it is the equivalence of the adjacency matrix for multigraphs
(with matrix diagonal representing edge loops double counted).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gives the degree sequence of the adjacency matrix of an observed graph or multigraph.
Note that the matrix diagonal should be even if the matrix represents a multigraph.
</p>


<h3>Value</h3>

<p>Vector of integers representing the degree sequence of a (multi)graph.
</p>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
<br />
</p>
<p>#' Shafie, T., Schoch, D. (2021). Multiplexity analysis of networks using multigraph representations.
<em>Statistical Methods &amp; Applications</em> 30, 1425–1444.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Adjacency matrix for undirected network with 3 nodes
 A &lt;-  matrix(c(0, 1, 2,
                1, 2, 1,
                2, 1, 2), nrow=3, ncol=3)

 # If A represents a graph
 get_degree_seq(adj = A, type = 'graph')

 # If A represents a multigraph
 get_degree_seq(adj = A, type = 'multigraph')
</code></pre>

<hr>
<h2 id='get_edge_assignment_probs'>Edge assignment probabilities under IEA model given fixed degrees</h2><span id='topic+get_edge_assignment_probs'></span>

<h3>Description</h3>

<p>Calculates the edge assignment probabilities
given specified degree sequence under the two ways in which the RSM
model can be approximated by the IEA model: <br />
- the IEAS (independent edge assignment of stubs) model, <br />
- the ISA (independent stub assignment) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_edge_assignment_probs(m, deg.seq, model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_edge_assignment_probs_+3A_m">m</code></td>
<td>
<p>integer giving number of edges in multigraph.</p>
</td></tr>
<tr><td><code id="get_edge_assignment_probs_+3A_deg.seq">deg.seq</code></td>
<td>
<p>vector of integers with the sum equal to 2<code>m</code> representing
the degree sequence of the multigraph.</p>
</td></tr>
<tr><td><code id="get_edge_assignment_probs_+3A_model">model</code></td>
<td>
<p>character string, either <code>'IEAS'</code> or <code>'ISA'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The IEAS and ISA edge assignment probabilities to
possible vertex pairs are calculated given a fixed degree sequence <code>deq.seq</code>
under the IEAS model, and <code>deg.seq</code>/2<code>m</code> under the ISA model.
</p>
<p>Number of possible vertex pair sites (and thus the length of the edge assignment sequence) is given by
<code class="reqn">(n+1)n/2</code> where <em>n</em> is number of vertices.
</p>


<h3>Value</h3>

<p>A numeric vector representing the edge assignment probabilities
to all possible vertex pair sites. The number of vertex pair sites is given by <code class="reqn">n(n+1)/2</code>.
</p>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
<br />
</p>
<p>#' Shafie, T., Schoch, D. (2021). Multiplexity analysis of networks using multigraph representations.
<em>Statistical Methods &amp; Applications</em> 30, 1425–1444.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_degree_seq">get_degree_seq</a></code>, <code><a href="#topic+iea_model">iea_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Under the IEAS model with 10 possible vertex pair sites (4 vertices)
get_edge_assignment_probs(m = 8, deg.seq = c(4, 4, 4, 4), model = "IEAS")

# Under the ISA model with 21 possible vertex pair sites (6 vertices)
get_edge_assignment_probs(m = 10, deg.seq = c(8, 4, 2, 2, 2, 2), model = "ISA")
</code></pre>

<hr>
<h2 id='get_edge_multip_seq'>Edge multiplicity sequences of multigraphs given fixed degrees</h2><span id='topic+get_edge_multip_seq'></span>

<h3>Description</h3>

<p>Given a degree sequence, this function finds all unique multigraphs
represented by their edge multiplicity sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_edge_multip_seq(deg.seq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_edge_multip_seq_+3A_deg.seq">deg.seq</code></td>
<td>
<p>vector of integers with the sum equal to 2<code>m</code> representing
the degree sequence of the multigraph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multigraphs are represented by their edge multiplicity sequence <strong>M</strong> with elements <em>M(i,j)</em>,
denoting edge multiplicity at possible vertex pair sites <em>(i,j)</em> ordered according to<br />
<em>(1,1) &lt; (1,2) &lt;···&lt; (1,n) &lt; (2,2) &lt; (2,3) &lt;···&lt; (n,n)</em>, <br />
where <em>n</em> is number of nodes.
</p>
<p>Only practical for small multigraphs.
</p>


<h3>Value</h3>

<p>All unique edge multiplicity sequences as rows in a data frame.
Each row in the data frame represents a unique multigraph given the degree sequence.
</p>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
<br />
#' Shafie, T., Schoch, D. (2021). Multiplexity analysis of networks using multigraph representations.
<em>Statistical Methods &amp; Applications</em> 30, 1425–1444.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_degree_seq">get_degree_seq</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Adjacency matrix for undirected network with 3 nodes
A &lt;- matrix(c(
    0, 1, 2,
    1, 2, 1,
    2, 1, 2
), nrow = 3, ncol = 3)
deg &lt;- get_degree_seq(A, "multigraph")
get_edge_multip_seq(deg)
</code></pre>

<hr>
<h2 id='gof_sim'>Goodness of fit test simulations for random multigraph models</h2><span id='topic+gof_sim'></span>

<h3>Description</h3>

<p>Goodness of fits test simulations of specified multigraph models using Pearson (<em>S</em>) and
information divergence (<em>A</em>) test statistics under the random stub matching (RSM)
and the independent edge assignments (IEA) model,
where the latter is either independent edge assignments of stubs (IEAS) or
independent stub assignment (ISA).
</p>
<p>These can be used to check the reliability of the tests by examining the exact probability
distributions of the test statistics and their fit to their asymptotic  chi^2-distributions.
Only practical for small multigraphs as exact distributions are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_sim(m, model, deg.mod, hyp, deg.hyp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_sim_+3A_m">m</code></td>
<td>
<p>integer giving number of edges in multigraph.</p>
</td></tr>
<tr><td><code id="gof_sim_+3A_model">model</code></td>
<td>
<p>character string representing assumed model, either <code>'RSM'</code>, <code>'IEAS'</code> or <code>'ISA'</code>.</p>
</td></tr>
<tr><td><code id="gof_sim_+3A_deg.mod">deg.mod</code></td>
<td>
<p>vector of integers with the sum equal to 2<code>m</code> representing
the degree sequence of the multigraph under specified model.</p>
</td></tr>
<tr><td><code id="gof_sim_+3A_hyp">hyp</code></td>
<td>
<p>character string representing the hypothesized null model, either <code>'IEAS'</code> or <code>'ISA'</code>.</p>
</td></tr>
<tr><td><code id="gof_sim_+3A_deg.hyp">deg.hyp</code></td>
<td>
<p>vector of integers with the sum equal to to 2<code>m</code> representing the hypothetical
degree sequence of the multigraph under the null model: <br />
- if <code>hyp = 'IEAS'</code>, then simple IEAS hypothesis with fully specified degree sequence <code>deg.hyp</code><br />
- if <code>hyp = 'ISA'</code>, then simple ISA hypothesis with with fully specified stub assignment probabilities <code>deg.hyp</code>/2<code>m</code><br />
- if <code>hyp = 'IEAS'</code> and <code>deg.hyp = 0</code>, then composite IEAS hypothesis with edge multiplicity sequence estimated from data<br />
- if <code>hyp = 'ISA'</code> and <code>deg.hyp = 0</code>, then composite ISA hypothesis with edge multiplicity sequence estimated from data<br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tests are performed using goodness-of-fit measures between simulated
edge multiplicity sequence of a multigraph according to an RSM or IEA model,
and the expected multiplicity sequence according to a simple or composite IEA hypothesis.
</p>
<p>Test statistics of Pearson type (<em>S</em>) and
of information divergence (<em>A</em>) type are used and summary
of tests given these two statistics are given as output. The adjusted statistics and
chi^2-distributions are useful for better power calculations.
</p>


<h3>Value</h3>

<p>Output is generated from function <code><a href="#topic+gof_stats">gof_stats</a></code>:
</p>
<table role = "presentation">
<tr><td><code>test.summary</code></td>
<td>
<p>Expected value and variances of test statistics (<code>stat</code>),
critical values (<code>cv</code>) according to asymptotic chi^2-distribution and
according to cdf's of test statistics,
significance level (alpha) according to asymptotic chi^2 distribution,
power of tests (<code>P(stat&gt;cv)</code>), critical values and power
according to the distributions of test statistics (<code>cv(stat)</code>
and <code> P(Stat&gt;cv(Stat))</code>).</p>
</td></tr>
<tr><td><code>degrees.of.freedom</code></td>
<td>
<p>Degrees of freedom for tests performed.</p>
</td></tr>
<tr><td><code>probS</code></td>
<td>
<p>Probability distributions of Pearson statistic <code>S</code>.</p>
</td></tr>
<tr><td><code>probA</code></td>
<td>
<p>Probability distributions of information divergence statistic <code>A</code>.</p>
</td></tr>
<tr><td><code>adjusted.stats</code></td>
<td>
<p>Expected values and variances for adjusted test statistics,
preferred adjusted statistics.</p>
</td></tr>
<tr><td><code>adjusted.chi2</code></td>
<td>
<p>Degrees of freedom for adjusted  chi^2-distribution.</p>
</td></tr>
<tr><td><code>power.apx</code></td>
<td>
<p>Power approximations according to adjusted statistics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gof_stats">gof_stats</a></code>,<code><a href="#topic+get_edge_assignment_probs">get_edge_assignment_probs</a></code>,
<code><a href="#topic+nsumk">nsumk</a></code>,<code><a href="#topic+rsm_model">rsm_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Testing a simple IEAS hypothesis with degree sequence [6,6,6] against
# an IEAS model with degree sequence [14,2,2] on a multigraph with n = 3 nodes and m = 9 edges
deg.mod &lt;- c(14,2,2)
deg.hyp &lt;- c(6,6,6)
test1 &lt;- gof_sim(9, 'IEAS', deg.mod, 'IEAS', deg.hyp)

# Non-null distributions (pdf's and cdf's) of test statistics S and A are given by
test1$probS
test1$probA

# Testing a simple ISA hypothesis with degree sequence [6,6,6] against
# an IEAS model with degree sequence [12,3,3] on a multigraph with n = 3 nodes and m = 9 edges
deg.mod &lt;- c(12,3,3)
deg.hyp &lt;- c(6,6,6)
test2 &lt;- gof_sim(9, 'IEAS', deg.mod, 'ISA', deg.hyp)

# Testing a composite IEAS hypothesis against
# an RSM model with degree sequence [6,6,6,6] on a multigraph with n = 4 nodes and m = 20 edges.
deg.mod &lt;- c(6,6,6,6)
test3 &lt;- gof_sim(12, 'RSM', deg.mod, 'IEAS', deg.hyp = 0)

</code></pre>

<hr>
<h2 id='gof_stats'>Exact probability distributions and moments of goodness of fit statistics</h2><span id='topic+gof_stats'></span>

<h3>Description</h3>

<p>Goodness of fit between two specified edge multiplicity sequences
(e.g. observed vs. expected).
Pearson (<em>S</em>) and information divergence (<em>A</em>) tests statistics are used and
the exact distribution of these statistics,  their asymptotic chi^2-distributions,
and their first two central moments are calculated using this function.
Only practical for small multigraphs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_stats(m, dof, m.seq, prob.mg, Q.seq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_stats_+3A_m">m</code></td>
<td>
<p>integer giving number of edges in multigraph.</p>
</td></tr>
<tr><td><code id="gof_stats_+3A_dof">dof</code></td>
<td>
<p>integer giving degrees of freedom of test performed.</p>
</td></tr>
<tr><td><code id="gof_stats_+3A_m.seq">m.seq</code></td>
<td>
<p>matrix of integers, each row representing the
edge multiplicity sequence of a multigraph (which correspond to observed values).</p>
</td></tr>
<tr><td><code id="gof_stats_+3A_prob.mg">prob.mg</code></td>
<td>
<p>numerical vector representing a given probability distribution of
multigraphs/edge multiplicity sequences in <code>m.seq</code>.</p>
</td></tr>
<tr><td><code id="gof_stats_+3A_q.seq">Q.seq</code></td>
<td>
<p>a numeric vector representing the hypothetical edge assignment probabilities
to all possible vertex pair sites (from which expected values are calculate).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tests are performed using goodness-of-fit measures between two edge multiplicity sequences
(e.g. observed vs. expected).
</p>
<p>Test statistics of Pearson type (<em>S</em>) and
of information divergence (<em>A</em>) type are used and summary
of tests given these two statistics are given as output. The adjusted statistics and
chi^2-distributions are useful for better power calculations.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>test.summary</code></td>
<td>
<p>Expected value and variances of test statistics (<code>stat</code>),
critical values (<code>cv</code>) according to asymptotic chi^2-distribution and
according to cdf's of test statistics,
significance level (alpha) according to asymptotic chi^2 distribution,
power of tests (<code>P(stat&gt;cv)</code>), critical values and power
according to the distributions of test statistics (<code>cv(stat)</code>
and <code> P(Stat&gt;cv(Stat))</code>).</p>
</td></tr>
<tr><td><code>degrees.of.freedom</code></td>
<td>
<p>Degrees of freedom for tests performed.</p>
</td></tr>
<tr><td><code>probS</code></td>
<td>
<p>Probability distributions of Pearson statistic <code>S</code>.</p>
</td></tr>
<tr><td><code>probA</code></td>
<td>
<p>Probability distributions of information divergence statistic <code>A</code>.</p>
</td></tr>
<tr><td><code>adjusted.stats</code></td>
<td>
<p>Expected values and variances for adjusted test statistics,
preferred adjusted statistics.</p>
</td></tr>
<tr><td><code>adjusted.chi2</code></td>
<td>
<p>Degrees of freedom for adjusted  chi^2-distribution.</p>
</td></tr>
<tr><td><code>power.apx</code></td>
<td>
<p>Power approximations according to adjusted statistics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gof_sim">gof_sim</a></code>,<code><a href="#topic+get_edge_assignment_probs">get_edge_assignment_probs</a></code>,
<code><a href="#topic+nsumk">nsumk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a set of edge multiplicity sequences (random multigraphs) and
# its probability distribution using rsm_model() with degree sequence [4,4,6,6]
rsm &lt;- rsm_model(deg.seq = c(4,4,6,6))
mg &lt;- as.matrix(rsm$m.seq)
mg.p &lt;- rsm$prob.dists[, 1]

# Generate edge assignment probabilities from which the second set of
# edge multiplicity sequences is generated from using the iea_model()
deg.f &lt;- (4*5)/2 - 1
eap &lt;- get_edge_assignment_probs(m = 10,
                   deg.seq = c(4,4,6,6), model = 'IEAS')

# Perform the test
test &lt;- gof_stats(m = 10, dof = deg.f,
                   m.seq = mg, prob.mg = mg.p, eap)

</code></pre>

<hr>
<h2 id='gof_test'>Goodness of fit tests for random multigraph models</h2><span id='topic+gof_test'></span>

<h3>Description</h3>

<p>Goodness of fit tests between an observed edge multiplicity sequence and
an expected edge multiplicity sequence according to specified RSM or IEA hypotheses
using Pearson (<em>S</em>) and information divergence (<em>A</em>) tests statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof_test(adj, type, hyp, deg.hyp, dof)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof_test_+3A_adj">adj</code></td>
<td>
<p>matrix of integer representing graph adjacency matrix.</p>
</td></tr>
<tr><td><code id="gof_test_+3A_type">type</code></td>
<td>
<p>equals <code>'graph'</code> if adjacency matrix is for graphs (default),
equals <code>'multigraph'</code> if it is the equivalence of the adjacency matrix for multigraphs
(with matrix diagonal representing loops double counted).</p>
</td></tr>
<tr><td><code id="gof_test_+3A_hyp">hyp</code></td>
<td>
<p>character string representing the null model, either <code>'IEAS'</code> or <code>'ISA'</code>.</p>
</td></tr>
<tr><td><code id="gof_test_+3A_deg.hyp">deg.hyp</code></td>
<td>
<p>vector of integers with the sum equal to to 2<code>m</code> representing the
degree sequence of the multigraph under the null model: <br />
- if <code>hyp = 'IEAS'</code>, then simple IEAS hypothesis with fully specified degree sequence <code>deg.hyp</code><br />
- if <code>hyp = 'ISA'</code>, then simple ISA hypothesis with with fully specified stub assignment probabilities <code>deg.hyp</code>/2<code>m</code><br />
- if <code>hyp = 'IEAS'</code> and <code>deg.hyp = 0</code>, then composite IEAS hypothesis with edge multiplicity sequence estimated from data<br />
- if <code>hyp = 'ISA'</code> and <code>deg.hyp = 0</code>, then composite ISA hypothesis with edge multiplicity sequence estimated from data<br /></p>
</td></tr>
<tr><td><code id="gof_test_+3A_dof">dof</code></td>
<td>
<p>integer giving degrees of freedom of test,
<em>r-1</em> for simple hypotheses and <em>r-n</em> for composite hypotheses where <em>r = n(n+1)/2</em></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to test whether there is a significant difference between
observed multigraph and the expected multiplicity sequence according
to a simple or composite IEA hypothesis.
</p>
<p>Test statistics of Pearson (<em>S</em>) and of information divergence (<em>A</em>) type are used and
test summary based on these two statistics are given as output.
</p>
<p><em>p</em>-values indicate whether we have sufficient evidence to reject the null
that there is no significant difference between the observed and
expected edge multiplicity sequence.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>summary</code></td>
<td>
<p>Data frame including observed  values of test statistics <code>S</code> and <code>A</code>,
degrees of freedom for the asymptotic chi^2-distributions of tests statistics,
and <em>p</em>-values for the tests performed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs.
<em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
</p>
<p>#' Shafie, T., Schoch, D. (2021). Multiplexity analysis of networks using multigraph representations.
<em>Statistical Methods &amp; Applications</em> 30, 1425–1444.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_degree_seq">get_degree_seq</a></code>,<code><a href="#topic+get_edge_assignment_probs">get_edge_assignment_probs</a></code>,
<code><a href="#topic+gof_sim">gof_sim</a></code> to check the reliability of your test
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Adjacency matrix of observed network (multigraph), n = 4 nodes , m = 15 edges
A &lt;- t(matrix(c( 0, 1, 0, 3,
                   0, 0, 1, 7,
                   0, 1, 0, 3,
                   3, 6, 3, 2), nrow= 4, ncol=4))
deg &lt;- get_degree_seq(adj = A, type = 'multigraph')

# Testing a simple IEAS hypothesis with above degree sequence
gof_test(adj = A, type = 'multigraph', hyp = 'IEAS', deg.hyp = deg, dof = 9)

# Testing a composite IEAS hypothesis
gof_test(adj = A, type  = 'multigraph', hyp = 'IEAS', deg.hyp = 0, dof = 6)
</code></pre>

<hr>
<h2 id='iea_model'>Independent edge assignment model for multigraphs</h2><span id='topic+iea_model'></span>

<h3>Description</h3>

<p>Summary of estimated statistics for analyzing
global structure of random multigraphs under the independent edge assignment model
given observed adjacency matrix.
</p>
<p>Two versions of the IEA model are implemented,
both of which can be used to approximate the RSM model:
<br />
1. independent edge assignment of stubs (IEAS) given an edge probability sequence<br />
2. independent stub assignment (ISA) given a stub probability sequence <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iea_model(
  adj,
  type = "multigraph",
  model = "IEAS",
  K = 0,
  apx = FALSE,
  p.seq = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iea_model_+3A_adj">adj</code></td>
<td>
<p>matrix of integers representing graph adjacency matrix.</p>
</td></tr>
<tr><td><code id="iea_model_+3A_type">type</code></td>
<td>
<p>equals <code>'graph'</code> if adjacency matrix is for graphs (default),
equals <code>'multigraph'</code> if it is the equivalence of the adjacency matrix for multigraphs
(with matrix diagonal representing loops double counted).</p>
</td></tr>
<tr><td><code id="iea_model_+3A_model">model</code></td>
<td>
<p>character string representing which IEA model: either <code>'IEAS'</code> (default) or <code>'ISA'</code>.</p>
</td></tr>
<tr><td><code id="iea_model_+3A_k">K</code></td>
<td>
<p>upper limit for the complexity statistics <em>R(k)</em>,
<em>k</em>=(0,1,...,<code>K</code>), representing the sequence of frequencies of edge multiplicities
(default is maximum observed in adjacency matrix).</p>
</td></tr>
<tr><td><code id="iea_model_+3A_apx">apx</code></td>
<td>
<p>logical (default = <code>'FALSE'</code>). if <code>'TRUE'</code>, the IEA model is used to approximate
the statistics under the random stub matching model given observed degree sequence.</p>
</td></tr>
<tr><td><code id="iea_model_+3A_p.seq">p.seq</code></td>
<td>
<p>if <code>model = ISA</code> and <code>apx = FALSE</code>, then specify this numerical vector of
stub assignment probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using the IEAS model: <br /> If the IEAS model is used
as an approximation to the RSM model, then the edge assignment probabilities are estimated
by using the observed degree sequence. Otherwise, the edge assignment probabilities are
estimated by using the observed edge multiplicities  (maximum likelihood estimates). <br />
</p>
<p>When using the ISA model: <br /> If the ISA model is used
as an approximation to the RSM model, then the stub assignment probabilities are estimated by using
the observed degree sequence over <em>2m</em>.  Otherwise, a sequence containing the stub assignment
probabilities (for example based on prior belief) should be given as argument <code>p.seq</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>nr.multigraphs</code></td>
<td>
<p>Number of unique multigraphs possible.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Summary and interval estimates for <em>number of loops</em> (<code>M1</code>) and
<em>number of multiple edges</em> (<code>M2</code>).</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Summary and interval estimates for frequencies of edge multiplicities
<code>R1</code>,<code>R2</code>,...,<code>RK</code>, where <code>K</code> is a function argument.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs.
<em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
<br />
</p>
<p>Shafie, T., Schoch, D. (2021). Multiplexity analysis of networks using multigraph representations.
<em>Statistical Methods &amp; Applications</em> 30, 1425–1444.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_degree_seq">get_degree_seq</a></code>, <code><a href="#topic+get_edge_multip_seq">get_edge_multip_seq</a></code>, <code><a href="#topic+iea_model">iea_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Adjacency matrix of a small graph on 3 nodes
A &lt;-  matrix(c(1, 1, 0,
               1, 2, 2,
               0, 2, 0),
             nrow = 3, ncol = 3)

# When the IEAS model is used
iea_model(adj = A , type = 'graph', model = 'IEAS', K = 0, apx = FALSE)

# When the IEAS model is used to approximate the RSM model
iea_model(adj = A , type = 'graph', model = 'IEAS', K = 0, apx = TRUE)

# When the ISA model is used to approximate the RSM model
iea_model(adj = A , type = 'graph', model = 'ISA', K = 0, apx = TRUE)

# When the ISA model is used with a pre-specified stub assignment probabilities
iea_model(adj = A , type = 'graph', model = 'ISA', K = 0, apx = FALSE, p.seq = c(1/3, 1/3, 1/3))
</code></pre>

<hr>
<h2 id='nsumk'>Ordered <em>n</em>-tuples of non-negative integers summing to <em>k</em></h2><span id='topic+nsumk'></span>

<h3>Description</h3>

<p>Finds ordered <em>n</em>-tuples of non-integers summing to <em>k</em>.
Only practical for <em>n</em> &lt; 15.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsumk(n, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nsumk_+3A_n">n</code></td>
<td>
<p>a positive integer.</p>
</td></tr>
<tr><td><code id="nsumk_+3A_k">k</code></td>
<td>
<p>a positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Useful for finding all possible degree sequences for a network with <code>n</code> nodes
and <code>k</code>/2 number of edges, or for finding all possible
edge multiplicity sequence <code>n</code> that sum up to <em>k</em> number of edges.
The number of vertex pair sites (or length of edge multiplicity sequence) for
a multigraph with <em>n</em> nodes is given by <code class="reqn">n(n+1)/2</code>.
</p>


<h3>Value</h3>

<p>A matrix with <code>choose(k+n-1,n-1)</code> rows and <code>n</code> columns.
Each row comprises non-negative integers summing to <code>k</code>.
</p>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gof_sim">gof_sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># All possible degree sequences for
# a network with 4 nodes and 5 edges
D &lt;- nsumk(4, 10)

# Remove degree sequences with isolated nodes
D &lt;- D[-which(rowSums(D == 0) &gt; 0), ]

# All edge multiplicity sequences/multigraph with 2 nodes and 4 edges
r &lt;- (2*3)/2 # vertex pair sites (or length of edge multiplicity sequences)
mg &lt;- nsumk(r,4) # number of rows give number of possible multigraphs
</code></pre>

<hr>
<h2 id='rsm_model'>Random stub matching model for multigraphs</h2><span id='topic+rsm_model'></span>

<h3>Description</h3>

<p>Given a specified degree sequence,
this function finds all unique multigraphs represented
by their edge multiplicity sequences. Different
complexity statistics together with their
probability distributions and moments are calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsm_model(deg.seq)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsm_model_+3A_deg.seq">deg.seq</code></td>
<td>
<p>vector of integers representing the degree sequence of a multigraph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability distributions of all unique multigraphs given fixed degree sequence,
together with the first two central moments and interval estimates of the statistics
<em>M1 = number of loops</em> and <em>M2 = number of multiple edges</em>, under the RSM model are calculated.
</p>
<p>For other structural statistics and for large multigraphs,
use the IEA approximation of the RSM model via the function <code><a href="#topic+iea_model">iea_model</a></code>
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>m.seq</code></td>
<td>
<p>possible multigraphs represented by edge multiplicity sequences</p>
</td></tr>
<tr><td><code>prob.dists</code></td>
<td>
<p>probability distribution of the multigraphs/edge multiplicity sequences,
and the probability distributions of the statistics <em>number of loops</em>,
<em>number of multiple edges</em>, and
<em>simple graph</em> (logical) for each multigraph</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>summary of moments and interval estimates for
<em>number of loops</em> and <em>number of multiple edges</em> (<code>M1</code> and <code>M2</code>)).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Termeh Shafie
</p>


<h3>References</h3>

<p>Shafie, T. (2015). A Multigraph Approach to Social Network Analysis. <em>Journal of Social Structure</em>, 16.
<br />
</p>
<p>Shafie, T. (2016). Analyzing Local and Global Properties of Multigraphs. <em>The Journal of Mathematical Sociology</em>, 40(4), 239-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_degree_seq">get_degree_seq</a></code>, <code><a href="#topic+get_edge_multip_seq">get_edge_multip_seq</a></code>, <code><a href="#topic+iea_model">iea_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Given a specified degree sequence
D &lt;- c(2, 2, 3, 3) # degree sequence
mod1 &lt;- rsm_model(D)
mod1$m.seq
mod1$prob.dists
mod1$M

# Given an observed graph
A &lt;- matrix(c(
    0, 1, 2,
    1, 2, 1,
    2, 1, 2
), nrow = 3, ncol = 3)
D &lt;- get_degree_seq(adj = A, type = "graph")
mod2 &lt;- rsm_model(D)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
