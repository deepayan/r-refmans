<!DOCTYPE html><html><head><title>Help for package manta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {manta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AS204'><p>Algorithm AS 204</p></a></li>
<li><a href='#biomarkers'><p>Simulated Measurements of Five Disease Biomarkers</p></a></li>
<li><a href='#manta'><p>Non-parametric, Asymptotic P-values for Multivariate Linear Models</p></a></li>
<li><a href='#manta.ss'><p>Sums of Squares and Pseudo-F Statistics from a Multivariate Fit</p></a></li>
<li><a href='#p.asympt'><p>Asymptotic P-values</p></a></li>
<li><a href='#patients'><p>Simulated Metadata for 100 Patients</p></a></li>
<li><a href='#printCoefmat.mp'><p>Print Coefficient Matrices (Multiple P-value Precision Limits)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Multivariate Asymptotic Non-Parametric Test of Association</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-09</td>
</tr>
<tr>
<td>Description:</td>
<td>The Multivariate Asymptotic Non-parametric Test of Association (MANTA) enables 
    non-parametric, asymptotic P-value computation for multivariate linear models. MANTA
    relies on the asymptotic null distribution of the PERMANOVA test statistic. P-values are
    computed using a highly accurate approximation of the corresponding cumulative distribution 
    function. Garrido-Martín et al. (2022) &lt;<a href="https://doi.org/10.1101%2F2022.06.06.493041">doi:10.1101/2022.06.06.493041</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dgarrimar/manta">https://github.com/dgarrimar/manta</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dgarrimar/manta/issues">https://github.com/dgarrimar/manta/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-09 16:21:35 UTC; dgarrido</td>
</tr>
<tr>
<td>Author:</td>
<td>Diego Garrido-Martín [aut, cre],
  Ferran Reverter [aut],
  Miquel Calvo [aut],
  Roderic Guigó [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Diego Garrido-Martín &lt;dgarrido@ub.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-10 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AS204'>Algorithm AS 204</h2><span id='topic+AS204'></span>

<h3>Description</h3>

<p>Distribution of a positive linear combination of <code class="reqn">\chi^2</code> random variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AS204(
  c,
  lambda,
  mult = rep(1, length(lambda)),
  delta = rep(0, length(lambda)),
  maxit = 1e+05,
  eps = 1e-14,
  mode = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AS204_+3A_c">c</code></td>
<td>
<p>value point at which distribution is to be evaluated.</p>
</td></tr>
<tr><td><code id="AS204_+3A_lambda">lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_j</code>.</p>
</td></tr>
<tr><td><code id="AS204_+3A_mult">mult</code></td>
<td>
<p>the multiplicities <code class="reqn">m_j</code>.</p>
</td></tr>
<tr><td><code id="AS204_+3A_delta">delta</code></td>
<td>
<p>the non-centrality parameters <code class="reqn">\delta^2_j</code>.</p>
</td></tr>
<tr><td><code id="AS204_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of terms <code class="reqn">K</code> (see Details).</p>
</td></tr>
<tr><td><code id="AS204_+3A_eps">eps</code></td>
<td>
<p>the desired level of accuracy.</p>
</td></tr>
<tr><td><code id="AS204_+3A_mode">mode</code></td>
<td>
<p>if &quot;<code>mode</code>&quot; &gt; 0 then <code class="reqn">\beta=mode\lambda_{min}</code>,
otherwise <code class="reqn">\beta=2/(1/\lambda_{min}+1/\lambda_{max})</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Algorithm AS 204 evaluates the expression
</p>
<p style="text-align: center;"><code class="reqn">
P [X &lt; c] = P [ \sum_{j=1}^n \lambda_j \chi^2(m_j, \delta^2_j) &lt; c ]
</code>
</p>

<p>where <code class="reqn">\lambda_j</code> and <code class="reqn">c</code> are positive constants and 
<code class="reqn">\chi^2(m_j, \delta^2_j)</code> represents an independent <code class="reqn">\chi^2</code> 
random variable with <code class="reqn">m_j</code> degrees of freedom and non-centrality
parameter <code class="reqn">\delta^2_j</code>. This can be approximated by the truncated series 
</p>
<p style="text-align: center;"><code class="reqn">
\sum_{k=0}^{K-1} a_k P [\chi^2(m+2k) &lt; c/\beta]
</code>
</p>
 
<p>where <code class="reqn">m = \sum_{j=1}^n m_j</code> and <code class="reqn">\beta</code> is an arbitrary constant 
(as given by argument &quot;mode&quot;). 
</p>
<p>The <code>C++</code> implementation of algorithm AS 204 used here is identical 
to the one employed by the <code><a href="CompQuadForm.html#topic+farebrother">farebrother</a></code> method
in the <code>CompQuadForm</code> package, with minor modifications.
</p>


<h3>Value</h3>

<p>The function returns the probability <code class="reqn">P[X &gt; c] = 1 - P[X &lt; c]</code> 
if the AS 204 fault indicator is 0 (see Note below), and <code>NULL</code> if 
the fault indicator is 4, 5 or 9, as the corresponding faults can be
corrected by increasing &quot;<code>eps</code>&quot;. Other faults raise an error.
</p>


<h3>Note</h3>

<p>The algorithm AS 204 defines the following fault indicators:
<strong>-j)</strong> one or more of the constraints <code class="reqn">\lambda_j &gt; 0</code>, 
<code class="reqn">m_j &gt; 0</code> and <code class="reqn">\delta^2_j \ge 0</code> is not satisfied.
<strong>1)</strong> non-fatal underflow of <code class="reqn">a_0</code>.
<strong>2)</strong> one or more of the constraints <code class="reqn">n &gt; 0</code>, 
<code class="reqn">c &gt; 0</code>, <code class="reqn">maxit &gt; 0</code> and <code class="reqn">eps &gt; 0</code> is not satisfied.
<strong>3)</strong> the current estimate of the probability is &lt; -1.
<strong>4)</strong> the required accuracy could not be obtained in <code class="reqn">maxit</code> iterations.
<strong>5)</strong> the value returned by the procedure does not satisfy 
<code class="reqn">0 \le P [X &lt; c] \le 1</code>.
<strong>6)</strong> the density of the linear form is negative.
<strong>9)</strong> faults 4 and 5.
<strong>10)</strong> faults 4 and 6. 
<strong>0)</strong> otherwise.
</p>


<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: 
Further comparisons between the Liu-Tang-Zhang approximation and exact methods, 
Computational Statistics and Data Analysis, Vol. 54, (2010), 858-862 
</p>
<p>Farebrother R.W., Algorithm AS 204: The distribution of a Positive Linear Combination 
of chi-squared random variables, Journal of the Royal Statistical Society, 
Series C (applied Statistics), Vol. 33, No. 3 (1984), 332-339
</p>


<h3>See Also</h3>

<p><a href="CompQuadForm.html#topic+farebrother">farebrother</a>
</p>

<hr>
<h2 id='biomarkers'>Simulated Measurements of Five Disease Biomarkers</h2><span id='topic+biomarkers'></span>

<h3>Description</h3>

<p>A simulated dataset containing the levels of 5 biomarkers, 
measured in 100 individuals, with different scales. 
Missing observations appear as <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biomarkers)
</code></pre>


<h3>Format</h3>

<p>A matrix with 100 rows and 5 numerical variables:
</p>

<dl>
<dt>biomarker1</dt><dd><p>levels of biomarker1</p>
</dd>
<dt>biomarker2</dt><dd><p>levels of biomarker2</p>
</dd>
<dt>...</dt><dd></dd>
</dl>



<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>

<hr>
<h2 id='manta'>Non-parametric, Asymptotic P-values for Multivariate Linear Models</h2><span id='topic+manta'></span>

<h3>Description</h3>

<p>Fits a multivariate linear model and computes test statistics and asymptotic 
P-values for predictors in a non-parametric manner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manta(
  formula,
  data,
  transform = "none",
  type = "II",
  contrasts = NULL,
  subset = NULL,
  fit = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manta_+3A_formula">formula</code></td>
<td>
<p>object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot; (or one that can be 
coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="manta_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible 
by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the variables in 
the model. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which <code>manta</code> 
is called.</p>
</td></tr>
<tr><td><code id="manta_+3A_transform">transform</code></td>
<td>
<p>transformation of the response variables: &quot;<code>none</code>&quot;, 
&quot;<code>sqrt</code>&quot; or &quot;<code>log</code>&quot;. Default is &quot;<code>none</code>&quot;.</p>
</td></tr>
<tr><td><code id="manta_+3A_type">type</code></td>
<td>
<p>type of sum of squares: &quot;<code>I</code>&quot;, &quot;<code>II</code>&quot; or &quot;<code>III</code>&quot;. 
Default is &quot;<code>II</code>&quot;.</p>
</td></tr>
<tr><td><code id="manta_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See <code>contrasts.arg</code> in 
<code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code>. Default is &quot;<code><a href="stats.html#topic+contr.sum">contr.sum</a></code>&quot; 
for ordered factors and &quot;<code><a href="stats.html#topic+contr.poly">contr.poly</a></code>&quot; for unordered factors. 
Note that this is different from the default setting in <code><a href="base.html#topic+options">options</a>("contrasts")</code>.</p>
</td></tr>
<tr><td><code id="manta_+3A_subset">subset</code></td>
<td>
<p>subset of predictors for which summary statistics will be 
reported. Note that this is different from the &quot;<code>subset</code>&quot; argument in <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="manta_+3A_fit">fit</code></td>
<td>
<p>logical. If <code>TRUE</code> the multivariate fit on transformed and 
centered responses is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>Y</code> matrix is obtained after transforming (optionally) and centering 
the original response variables. Then, the multivariate fit obtained by 
<code><a href="stats.html#topic+lm">lm</a></code> can be used to compute sums of squares (type-I, type-II or 
type-III), pseudo-F statistics and asymptotic P-values for the terms specified
by the <code>formula</code> in a non-parametric manner. The designations &quot;type-II&quot; 
and &quot;type-III&quot; correspond exactly to those used in <code><a href="car.html#topic+Anova">Anova</a></code>. 
&quot;type-I&quot; refers to sequential sums of squares.
</p>


<h3>Value</h3>

<p><code>manta</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;manta&quot;, a list containing:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>aov.tab</code></td>
<td>
<p>ANOVA table with Df, Sum Sq, Mean Sq, F values, 
partial R-squared and P-values.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the type of sum of squares (<code>"I"</code>, <code>"II"</code> or <code>"III"</code>).</p>
</td></tr>
<tr><td><code>precision</code></td>
<td>
<p>the precision in P-value computation.</p>
</td></tr>
<tr><td><code>transform</code></td>
<td>
<p>the transformation applied to the response variables.</p>
</td></tr>
<tr><td><code>na.omit</code></td>
<td>
<p>incomplete cases removed (see <code><a href="stats.html#topic+na.omit">na.omit</a></code>).</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>if <code>fit = TRUE</code> the multivariate fit done on the transformed 
and centered response variables is also returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="car.html#topic+Anova">Anova</a></code>
</p>

<hr>
<h2 id='manta.ss'>Sums of Squares and Pseudo-F Statistics from a Multivariate Fit</h2><span id='topic+manta.ss'></span>

<h3>Description</h3>

<p>Computes the sum of squares, degrees of freedom, pseudo-F statistics and
partial R-squared for each predictor from a multivariate <code>fit</code>. 
It also returns the eigenvalues of the residual covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manta.ss(fit, X, type = "II", subset = NULL, tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manta.ss_+3A_fit">fit</code></td>
<td>
<p>multivariate fit obtained by <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="manta.ss_+3A_x">X</code></td>
<td>
<p>design matrix obtained by <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>.</p>
</td></tr>
<tr><td><code id="manta.ss_+3A_type">type</code></td>
<td>
<p>type of sum of squares (&quot;<code>I</code>&quot;, &quot;<code>II</code>&quot; or &quot;<code>III</code>&quot;). 
Default is &quot;<code>II</code>&quot;.</p>
</td></tr>
<tr><td><code id="manta.ss_+3A_subset">subset</code></td>
<td>
<p>subset of predictors for which summary statistics will be reported.
Note that this is different from the &quot;<code>subset</code>&quot; argument in <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="manta.ss_+3A_tol">tol</code></td>
<td>
<p><code>e[e/sum(e) &gt; tol]</code>, where <code>e</code> is the vector of eigenvalues
of the residual covariance matrix. Required to prevent long running times of 
algorithm AS 204. Default is 0.001 to ensure minimal loss of accuracy.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Different types of sums of squares (i.e. &quot;<code>I</code>&quot;, &quot;<code>II</code>&quot; and 
&quot;<code>III</code>&quot;) are available.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>SS</code></td>
<td>
<p>sums of squares for all predictors (and residuals).</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom for all predictors (and residuals).</p>
</td></tr>
<tr><td><code>f.tilde</code></td>
<td>
<p>pseudo-F statistics for all predictors.</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>partial R-squared for all predictors.</p>
</td></tr>
<tr><td><code>e</code></td>
<td>
<p>eigenvalues of the residual covariance matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AS204">AS204</a></code>
</p>

<hr>
<h2 id='p.asympt'>Asymptotic P-values</h2><span id='topic+p.asympt'></span>

<h3>Description</h3>

<p>Computes asymptotic P-values given the numerator of the pseudo-F statistic, 
its degrees of freedom and the eigenvalues of the residual covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.asympt(ss, df, lambda, eps = 1e-14, eps.updt = 2, eps.stop = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.asympt_+3A_ss">ss</code></td>
<td>
<p>numerator of the pseudo-F statistic.</p>
</td></tr>
<tr><td><code id="p.asympt_+3A_df">df</code></td>
<td>
<p>degrees of freedom of the numerator of the pseudo-F statistic.</p>
</td></tr>
<tr><td><code id="p.asympt_+3A_lambda">lambda</code></td>
<td>
<p>eigenvalues of the residual covariance matrix.</p>
</td></tr>
<tr><td><code id="p.asympt_+3A_eps">eps</code></td>
<td>
<p>the desired level of accuracy.</p>
</td></tr>
<tr><td><code id="p.asympt_+3A_eps.updt">eps.updt</code></td>
<td>
<p>factor by which <code>eps</code> is updated to retry execution of
algorithm AS 204 when it fails with fault indicator 4, 5 or 9.</p>
</td></tr>
<tr><td><code id="p.asympt_+3A_eps.stop">eps.stop</code></td>
<td>
<p>if <code>eps &gt; eps.stop</code>, execution of algorithm AS 204 is 
not retried and the function raises an error. Default is <code>1e-10</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the P-value and the level of accuracy.
</p>


<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>


<h3>See Also</h3>

<p><code><a href="#topic+AS204">AS204</a></code>
</p>

<hr>
<h2 id='patients'>Simulated Metadata for 100 Patients</h2><span id='topic+patients'></span>

<h3>Description</h3>

<p>A simulated dataset containing the age, gender and disease status of 100
individuals. Missing observations appear as <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(patients)
</code></pre>


<h3>Format</h3>

<p>A matrix with 100 rows and 3 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age of the patient (numerical)</p>
</dd>
<dt>gender</dt><dd><p>Gender of the patient (factor with levels: &quot;male&quot; and 
&quot;female&quot;)</p>
</dd>
<dt>status</dt><dd><p>Disease status of the patient (ordered factor with levels:
&quot;healthy&quot;, &quot;mild&quot; and &quot;severe&quot;)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>

<hr>
<h2 id='printCoefmat.mp'>Print Coefficient Matrices (Multiple P-value Precision Limits)</h2><span id='topic+printCoefmat.mp'></span>

<h3>Description</h3>

<p>Modification of <code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code> to use multiple P-value 
precision limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printCoefmat.mp(
  x,
  digits = max(3L, getOption("digits") - 2L),
  signif.stars = getOption("show.signif.stars"),
  signif.legend = signif.stars,
  dig.tst = max(1L, min(5L, digits - 1L)),
  cs.ind = 1:k,
  tst.ind = k + 1,
  zap.ind = integer(),
  P.values = NULL,
  has.Pvalue = nc &gt;= 4 &amp;&amp; substr(colnames(x)[nc], 1, 3) == "Pr(",
  eps.Pvalue = .Machine$double.eps,
  na.print = "NA",
  ...
)
</code></pre>


<h3>Author(s)</h3>

<p>Diego Garrido-Martín
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
