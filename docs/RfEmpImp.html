<!DOCTYPE html><html><head><title>Help for package RfEmpImp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RfEmpImp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#conv.factor'><p>Convert variables to factors</p></a></li>
<li><a href='#gen.mcar'><p>Generate missing (completely at random) cells in a data set</p></a></li>
<li><a href='#imp.rfemp'><p>Perform multiple imputation using the empirical error distributions and</p>
predicted probabilities of random forests</a></li>
<li><a href='#imp.rfnode.cond'><p>Perform multiple imputation based on the conditional distribution formed by</p>
prediction nodes of random forests</a></li>
<li><a href='#imp.rfnode.prox'><p>Perform multiple imputation based on the conditional distribution formed</p>
using node proximity</a></li>
<li><a href='#mice.impute.rfemp'><p>Univariate sampler function for mixed types of variables for</p>
prediction-based imputation, using empirical distribution of out-of-bag
prediction errors and predicted probabilities of random forests</a></li>
<li><a href='#mice.impute.rfnode'><p>Univariate sampler function for mixed types of variables for node-based</p>
imputation, using predicting nodes of random forests</a></li>
<li><a href='#mice.impute.rfpred.cate'><p>Univariate sampler function for categorical variables for prediction-based</p>
imputation, using predicted probabilities of random forest</a></li>
<li><a href='#mice.impute.rfpred.emp'><p>Univariate sampler function for continuous variables using the empirical</p>
error distributions</a></li>
<li><a href='#mice.impute.rfpred.norm'><p>Univariate sampler function for continuous variables for prediction-based</p>
imputation, assuming normality for prediction errors of random forest</a></li>
<li><a href='#query.rf.pred.idx'><p>Identify corresponding observations indexes under the terminal nodes for a</p>
random forest model by <code>ranger</code></a></li>
<li><a href='#query.rf.pred.val'><p>Identify corresponding observed values for the response variable under the</p>
terminal nodes for a random forest model by <code>ranger</code></a></li>
<li><a href='#rangerCallerSafe'><p>Remove unnecessary arguments for <code>ranger</code> function</p></a></li>
<li><a href='#reg.ests'><p>Get regression estimates for pooled object</p></a></li>
<li><a href='#RfEmpImp-package'><p>RfEmpImp: Multiple Imputation using Chained Random Forests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Imputation using Chained Random Forests</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shangzhi Hong &lt;shangzhi-hong@hotmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An R package for multiple imputation using chained random forests.
    Implemented methods can handle missing data in mixed types of variables by
    using prediction-based or node-based conditional distributions constructed
    using random forests. For prediction-based imputation, the method based on
    the empirical distribution of out-of-bag prediction errors of random forests
    and the method based on normality assumption for prediction errors of random
    forests are provided for imputing continuous variables. And the method based
    on predicted probabilities is provided for imputing categorical variables.
    For node-based imputation, the method based on the conditional distribution
    formed by the predicting nodes of random forests, and the method based on
    proximity measures of random forests are provided. More details of the
    statistical methods can be found in Hong et al. (2020) &lt;<a href="https://arxiv.org/abs/2004.14823">arXiv:2004.14823</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), mice (&ge; 3.9.0), ranger (&ge; 0.12.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shangzhi-hong/RfEmpImp">https://github.com/shangzhi-hong/RfEmpImp</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shangzhi-hong/RfEmpImp/issues">https://github.com/shangzhi-hong/RfEmpImp/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-20 04:44:21 UTC; HONG</td>
</tr>
<tr>
<td>Author:</td>
<td>Shangzhi Hong [aut, cre],
  Henry S. Lynn [ths]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-20 07:17:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='conv.factor'>Convert variables to factors</h2><span id='topic+conv.factor'></span>

<h3>Description</h3>

<p>Convert variables to factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conv.factor(data, convNames = NULL, exceptNames = NULL, uniqueNum = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conv.factor_+3A_data">data</code></td>
<td>
<p>Input data frame.</p>
</td></tr>
<tr><td><code id="conv.factor_+3A_convnames">convNames</code></td>
<td>
<p>Names of variable to convert, the default is
<code>convNames = NULL</code>.</p>
</td></tr>
<tr><td><code id="conv.factor_+3A_exceptnames">exceptNames</code></td>
<td>
<p>Names of variables to be excluded from conversion, the
default is <code>convNames = NULL</code>.</p>
</td></tr>
<tr><td><code id="conv.factor_+3A_uniquenum">uniqueNum</code></td>
<td>
<p>Variables of less than or equal to a specific number of
unique values in the  to be converted to factors, the default is
<code>uniqueNum = 5</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of converted variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nhanes.fix &lt;- conv.factor(data = nhanes, convNames = c("age", "hyp"))

</code></pre>

<hr>
<h2 id='gen.mcar'>Generate missing (completely at random) cells in a data set</h2><span id='topic+gen.mcar'></span>

<h3>Description</h3>

<p>Generate missing (completely at random) cells in a data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.mcar(df, prop.na = 0.2, warn.empty.row = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.mcar_+3A_df">df</code></td>
<td>
<p>Input data frame or matrix.</p>
</td></tr>
<tr><td><code id="gen.mcar_+3A_prop.na">prop.na</code></td>
<td>
<p>Proportion of generated missing cells. The default is
<code>prop.na = 0.2</code>.</p>
</td></tr>
<tr><td><code id="gen.mcar_+3A_warn.empty.row">warn.empty.row</code></td>
<td>
<p>Show a warning if empty rows were present in the
output data set.</p>
</td></tr>
<tr><td><code id="gen.mcar_+3A_...">...</code></td>
<td>
<p>Other parameters (will be ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or matrix containing generated missing cells.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mtcars")
mtcars.mcar &lt;- gen.mcar(mtcars, warn.empty.row = FALSE)

</code></pre>

<hr>
<h2 id='imp.rfemp'>Perform multiple imputation using the empirical error distributions and
predicted probabilities of random forests</h2><span id='topic+imp.rfemp'></span>

<h3>Description</h3>

<p><code>RfEmp</code> multiple imputation method is for mixed types of variables,
and calls corresponding functions based on variable types.
Categorical variables should be of type <code>factor</code> or <code>logical</code>, etc.
</p>
<p><code>RfPred.Emp</code> is used for continuous variables, and <code>RfPred.Cate</code>
is used for categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imp.rfemp(
  data,
  num.imp = 5,
  max.iter = 5,
  num.trees = 10,
  alpha.emp = 0,
  sym.dist = TRUE,
  pre.boot = TRUE,
  num.trees.cont = NULL,
  num.trees.cate = NULL,
  num.threads = NULL,
  print.flag = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imp.rfemp_+3A_data">data</code></td>
<td>
<p>A data frame or a matrix containing the incomplete data. Missing
values should be coded as <code>NA</code>s.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_num.imp">num.imp</code></td>
<td>
<p>Number of multiple imputations. The default is
<code>num.imp = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_max.iter">max.iter</code></td>
<td>
<p>Number of iterations. The default is <code>max.iter = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build. The default is
<code>num.trees = 10</code>.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_alpha.emp">alpha.emp</code></td>
<td>
<p>The &quot;significance level&quot; for the empirical distribution of
out-of-bag prediction errors, can be used for prevention for outliers
(helpful for highly skewed variables).
For example, set alpha = 0.05 to use 95% confidence level.
The default is <code>alpha.emp = 0.0</code>, and the empirical distribution of
out-of-bag prediction errors will be kept intact.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_sym.dist">sym.dist</code></td>
<td>
<p>If <code>TRUE</code>, the empirical distribution of out-of-bag
prediction errors will be assumed to be symmetric; if <code>FALSE</code>, the
empirical distribution will be kept intact. The default is
<code>sym.dist = TRUE</code>.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_pre.boot">pre.boot</code></td>
<td>
<p>If <code>TRUE</code>, bootstrapping prior to imputation will be
performed to perform 'proper' multiple imputation, for accommodating sampling
variation in estimating population regression parameters
(refer to Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is valid even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_num.trees.cont">num.trees.cont</code></td>
<td>
<p>Number of trees to build for continuous variables.
The default is <code>num.trees.cont = NULL</code> and the value of <code>num.trees</code>
will be used.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_num.trees.cate">num.trees.cate</code></td>
<td>
<p>Number of trees to build for categorical variables,
The default is <code>num.trees.cate = NULL</code> and the value of <code>num.trees</code>
will be used.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_num.threads">num.threads</code></td>
<td>
<p>Number of threads for parallel computing. The default is
<code>num.threads = NULL</code> and all the processors available can be used.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_print.flag">print.flag</code></td>
<td>
<p>If <code>TRUE</code>, details will be sent to console. The
default is <code>print.flag = FALSE</code>.</p>
</td></tr>
<tr><td><code id="imp.rfemp_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For continuous variables, <code>mice.impute.rfpred.emp</code> is called, performing
imputation based on the empirical distribution of out-of-bag
prediction errors of random forests.
</p>
<p>For categorical variables, <code>mice.impute.rfpred.cate</code> is called,
performing imputation based on predicted probabilities.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>mids</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. &quot;Random Forest Prediction Intervals.&quot;
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- nhanes
nhanes.fix[, c("age", "hyp")] &lt;- lapply(nhanes[, c("age", "hyp")], as.factor)
# Perform imputation using imp.rfemp
imp &lt;- imp.rfemp(nhanes.fix)
# Do repeated analyses
anl &lt;- with(imp, lm(chl ~ bmi + hyp))
# Pool the results
pool &lt;- pool(anl)
# Get pooled estimates
reg.ests(pool)

</code></pre>

<hr>
<h2 id='imp.rfnode.cond'>Perform multiple imputation based on the conditional distribution formed by
prediction nodes of random forests</h2><span id='topic+imp.rfnode.cond'></span>

<h3>Description</h3>

<p><code>RfNode.Cond</code> multiple imputation method is for mixed types of variables,
using conditional distribution formed by predicting nodes of random forest
(out-of-bag observations will be excluded).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imp.rfnode.cond(
  data,
  num.imp = 5,
  max.iter = 5,
  num.trees = 10,
  pre.boot = TRUE,
  print.flag = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imp.rfnode.cond_+3A_data">data</code></td>
<td>
<p>A data frame or a matrix containing the incomplete data. Missing
values should be coded as <code>NA</code>s.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_num.imp">num.imp</code></td>
<td>
<p>Number of multiple imputations. The default is
<code>num.imp = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_max.iter">max.iter</code></td>
<td>
<p>Number of iterations. The default is <code>max.iter = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build. The default is
<code>num.trees = 10</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_pre.boot">pre.boot</code></td>
<td>
<p>If <code>TRUE</code>, bootstrapping prior to imputation will be
performed to perform 'proper' multiple imputation, for accommodating sampling
variation in estimating population regression parameters
(see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_print.flag">print.flag</code></td>
<td>
<p>If <code>TRUE</code>, details will be sent to console. The
default is <code>print.flag = FALSE</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.cond_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>During imputation using <code>imp.rfnode.cond</code>, for missing observations, the
candidate non-missing observations will be found by the predicting nodes
of random trees in the random forest model. Only the in-bag observations
for each random tree will be used for imputation.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>mids</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. &quot;Random Forest Prediction Intervals.&quot;
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- nhanes
nhanes.fix[, c("age", "hyp")] &lt;- lapply(nhanes[, c("age", "hyp")], as.factor)
# Perform imputation using imp.rfnode.cond
imp &lt;- imp.rfnode.cond(nhanes.fix)
# Do repeated analyses
anl &lt;- with(imp, lm(chl ~ bmi + hyp))
# Pool the results
pool &lt;- pool(anl)
# Get pooled estimates
reg.ests(pool)

</code></pre>

<hr>
<h2 id='imp.rfnode.prox'>Perform multiple imputation based on the conditional distribution formed
using node proximity</h2><span id='topic+imp.rfnode.prox'></span>

<h3>Description</h3>

<p><code>RfNodeProx</code> multiple imputation method is for mixed types of variables,
using conditional distributions formed by proximity measures of random
forests (both in-bag and out-of-bag observations will be used for imputation).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imp.rfnode.prox(
  data,
  num.imp = 5,
  max.iter = 5,
  num.trees = 10,
  pre.boot = TRUE,
  print.flag = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imp.rfnode.prox_+3A_data">data</code></td>
<td>
<p>A data frame or a matrix containing the incomplete data. Missing
values should be coded as <code>NA</code>s.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_num.imp">num.imp</code></td>
<td>
<p>Number of multiple imputations. The default is
<code>num.imp = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_max.iter">max.iter</code></td>
<td>
<p>Number of iterations. The default is <code>max.iter = 5</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build. The default is
<code>num.trees = 10</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_pre.boot">pre.boot</code></td>
<td>
<p>If <code>TRUE</code>, bootstrapping prior to imputation will be
performed to perform 'proper' multiple imputation, for accommodating sampling
variation in estimating population regression parameters
(see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_print.flag">print.flag</code></td>
<td>
<p>If <code>TRUE</code>, details will be sent to console. The
default is <code>print.flag = FALSE</code>.</p>
</td></tr>
<tr><td><code id="imp.rfnode.prox_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>During imputation using <code>imp.rfnode.prox</code>, for missing observations, the
candidate non-missing observations will be found by whether two observations
can be retrieved from the same predicting node during prediction. The
observations used for imputation may not be necessarily be contained in the
terminal node of random forest model.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>mids</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. &quot;Random Forest Prediction Intervals.&quot;
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- nhanes
nhanes.fix[, c("age", "hyp")] &lt;- lapply(nhanes[, c("age", "hyp")], as.factor)
# Perform imputation using imp.rfnode.prox
imp &lt;- imp.rfnode.prox(nhanes.fix)
# Do repeated analyses
anl &lt;- with(imp, lm(chl ~ bmi + hyp))
# Pool the results
pool &lt;- pool(anl)
# Get pooled estimates
reg.ests(pool)

</code></pre>

<hr>
<h2 id='mice.impute.rfemp'>Univariate sampler function for mixed types of variables for
prediction-based imputation, using empirical distribution of out-of-bag
prediction errors and predicted probabilities of random forests</h2><span id='topic+mice.impute.rfemp'></span>

<h3>Description</h3>

<p>Please note that functions with names starting with &quot;mice.impute&quot; are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p><code>RfEmpImp</code> multiple imputation method, adapter for <code>mice</code> samplers.
These functions can be called by the <code>mice</code> sampler function. In the
<code>mice()</code> function, set <code>method = "rfemp"</code> to use the <code>RfEmp</code>
method.
</p>
<p><code>mice.impute.rfemp</code> is for mixed types of variables, and it calls
corresponding functions according to variable types. Categorical variables
should be of type <code>factor</code> or <code>logical</code> etc.
</p>
<p>For continuous variables, <code>mice.impute.rfpred.emp</code> is called, performing
imputation based on the empirical distribution of out-of-bag prediction
errors of random forests.
</p>
<p>For categorical variables, <code>mice.impute.rfpred.cate</code> is called,
performing imputation based on predicted probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.rfemp(
  y,
  ry,
  x,
  wy = NULL,
  num.trees = 10,
  alpha.emp = 0,
  sym.dist = TRUE,
  pre.boot = TRUE,
  num.trees.cont = NULL,
  num.trees.cate = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.rfemp_+3A_y">y</code></td>
<td>
<p>Vector to be imputed.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_ry">ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_x">x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_wy">wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build, default to <code>10</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_alpha.emp">alpha.emp</code></td>
<td>
<p>The &quot;significance level&quot; for empirical distribution of
prediction errors, can be used for prevention for outliers (useful for highly
skewed variables). For example, set alpha = 0.05 to use 95% confidence level
for empirical distribution of prediction errors.
Default is <code>0.0</code>, and the empirical error distribution is kept intact.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_sym.dist">sym.dist</code></td>
<td>
<p>If <code>TRUE</code>, the empirical distribution of out-of-bag
prediction errors will be assumed to be symmetric; if <code>FALSE</code>, the
empirical distribution will be kept intact. The default is
<code>sym.dist = TRUE</code>.
This option is invalid when <code>emp.err.cont</code> is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_pre.boot">pre.boot</code></td>
<td>
<p>Perform bootstrap prior to imputation to get 'proper'
multiple imputation, i.e. accommodating sampling variation in estimating
population regression parameters (see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_num.trees.cont">num.trees.cont</code></td>
<td>
<p>Number of trees to build for continuous variables,
default to <code>NULL</code> to use the value of <code>num.trees</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_num.trees.cate">num.trees.cate</code></td>
<td>
<p>Number of trees to build for categorical variables,
default to <code>NULL</code> to use the value of <code>num.trees</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfemp_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>RfEmpImp</code> imputation sampler, the <code>mice.impute.rfemp</code> calls
<code>mice.impute.rfpred.emp</code> if the variable <code>is.numeric</code> is
<code>TRUE</code>, otherwise it calls <code>mice.impute.rfpred.cate</code>.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. &quot;Random Forest Prediction Intervals.&quot;
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- conv.factor(nhanes, c("age", "hyp"))

# This function is exported to be visible to the mice sampler functions, and
# users can set method = "rfemp" in call to mice to use this function.
# Users are recommended to use the imp.rfemp function instead:
impObj &lt;- mice(nhanes.fix, method = "rfemp", m = 5,
maxit = 5, maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE
)

</code></pre>

<hr>
<h2 id='mice.impute.rfnode'>Univariate sampler function for mixed types of variables for node-based
imputation, using predicting nodes of random forests</h2><span id='topic+mice.impute.rfnode'></span><span id='topic+mice.impute.rfnode.cond'></span><span id='topic+mice.impute.rfnode.prox'></span>

<h3>Description</h3>

<p>Please note that functions with names starting with &quot;mice.impute&quot; are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p><code>RfNode</code> imputation methods, adapter for <code>mice</code> samplers.
These functions can be called by the <code>mice</code> sampler functions.
</p>
<p><code>mice.impute.rfnode.cond</code> is for imputation using the conditional formed
by the predicting nodes of random forests. To use this function, set
<code>method = "rfnode.cond"</code> in <code>mice</code> function.
</p>
<p><code>mice.impute.rfnode.prox</code> is for imputation based on proximity measures
from random forests, and provides functionality similar to
<code>mice.impute.rf</code>. To use this function, set
<code>method = "rfnode.prox"</code> in <code>mice</code> function.
</p>
<p><code>mice.impute.rfnode</code> is the main function for performing imputation, and
both <code>mice.impute.rfnode.cond</code> and <code>mice.impute.rfnode.prox</code> call
this function. By default, <code>mice.impute.rfnode</code> works like
<code>mice.impute.rfnode.cond</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.rfnode(
  y,
  ry,
  x,
  wy = NULL,
  num.trees.node = 10,
  pre.boot = TRUE,
  use.node.cond.dist = TRUE,
  obs.eq.prob = FALSE,
  do.sample = TRUE,
  num.threads = NULL,
  ...
)

mice.impute.rfnode.cond(
  y,
  ry,
  x,
  wy = NULL,
  num.trees = 10,
  pre.boot = TRUE,
  obs.eq.prob = FALSE,
  ...
)

mice.impute.rfnode.prox(
  y,
  ry,
  x,
  wy = NULL,
  num.trees = 10,
  pre.boot = TRUE,
  obs.eq.prob = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.rfnode_+3A_y">y</code></td>
<td>
<p>Vector to be imputed.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_ry">ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_x">x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_wy">wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_num.trees.node">num.trees.node</code></td>
<td>
<p>Number of trees to build, default to <code>10</code>. For
function <code>mice.impute.rfnode</code> only.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_pre.boot">pre.boot</code></td>
<td>
<p>Perform bootstrap prior to imputation to get 'proper'
imputation, i.e. accommodating sampling variation in estimating population
regression parameters (see Shah et al. 2014).</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_use.node.cond.dist">use.node.cond.dist</code></td>
<td>
<p>If <code>TRUE</code>, use conditional distribution formed
by predicting nodes of random forest (out-of-bag observations were excluded);
if <code>FALSE</code>, use proximity-based imputation.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_obs.eq.prob">obs.eq.prob</code></td>
<td>
<p>If <code>TRUE</code>, the candidate observations will be sampled
with equal probability.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_do.sample">do.sample</code></td>
<td>
<p>If <code>TRUE</code>, draw samples for missing observations.
If <code>FALSE</code>, the corresponding observations numbers will be returned,
for testing purposes only, and WILL CAUSE ERRORS for the <code>mice</code> sampler
function.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_num.threads">num.threads</code></td>
<td>
<p>Number of threads for parallel computing. The default is
<code>num.threads = NULL</code> and all the processors available can be used.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
<tr><td><code id="mice.impute.rfnode_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build, default to <code>10</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Advanced users can get more flexibility from <code>mice.impute.rfnode</code>
function, as it provides more options than <code>mice.impute.rfnode.cond</code> or
<code>mice.impute.rfnode.prox</code>.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Doove, Lisa L., Stef Van Buuren, and Elise Dusseldorp.
&quot;Recursive partitioning for missing data imputation in the presence of
interaction effects.&quot;
Computational Statistics &amp; Data Analysis 72 (2014): 92-104.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data: convert categorical variables to factors
nhanes.fix &lt;- conv.factor(nhanes, c("age", "hyp"))

# Using "rfnode.cond" or "rfnode"
impRfNodeCond &lt;- mice(nhanes.fix, method = "rfnode.cond", m = 5,
maxit = 5, maxcor = 1.0, eps = 0, printFlag = FALSE)

# Using "rfnode.prox"
impRfNodeProx &lt;- mice(nhanes.fix, method = "rfnode.prox", m = 5,
maxit = 5, maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE)

</code></pre>

<hr>
<h2 id='mice.impute.rfpred.cate'>Univariate sampler function for categorical variables for prediction-based
imputation, using predicted probabilities of random forest</h2><span id='topic+mice.impute.rfpred.cate'></span>

<h3>Description</h3>

<p>Please note that functions with names starting with &quot;mice.impute&quot; are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p>For categorical variables only.
</p>
<p>Part of project <code>RfEmpImp</code>, the function <code>mice.impute.rfpred.cate</code>
is for categorical variables, performing imputation based on predicted
probabilities for the categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.rfpred.cate(
  y,
  ry,
  x,
  wy = NULL,
  num.trees.cate = 10,
  use.pred.prob.cate = TRUE,
  forest.vote.cate = FALSE,
  pre.boot = TRUE,
  num.threads = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.rfpred.cate_+3A_y">y</code></td>
<td>
<p>Vector to be imputed.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_ry">ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_x">x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_wy">wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_num.trees.cate">num.trees.cate</code></td>
<td>
<p>Number of trees to build for categorical variables,
default to <code>10</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_use.pred.prob.cate">use.pred.prob.cate</code></td>
<td>
<p>Logical, <code>TRUE</code> for assigning categories based
on predicted probabilities, <code>FALSE</code> for imputation based on random draws
from predictions of classification trees, default to <code>TRUE</code>. Note that
if <code>forest.vote.cate = TRUE</code>, then this option is invalid.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_forest.vote.cate">forest.vote.cate</code></td>
<td>
<p>Logical, <code>TRUE</code> for assigning categories based
on majority votes of random forests, <code>FALSE</code> for imputation based on
control of option <code>use.pred.prob.cate</code>, default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_pre.boot">pre.boot</code></td>
<td>
<p>Perform bootstrap prior to imputation to get 'proper'
multiple imputation, i.e. accommodating sampling variation in estimating
population regression parameters (see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_num.threads">num.threads</code></td>
<td>
<p>Number of threads for parallel computing. The default is
<code>num.threads = NULL</code> and all the processors available can be used.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.cate_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>RfEmpImp</code> Imputation sampler for: categorical variables based on
predicted probabilities.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Prepare data
mtcars.catmcar &lt;- mtcars
mtcars.catmcar[, c("gear", "carb")] &lt;-
    gen.mcar(mtcars.catmcar[, c("gear", "carb")], warn.empty.row = FALSE)
mtcars.catmcar &lt;- conv.factor(mtcars.catmcar, c("gear", "carb"))
# Perform imputation
impObj &lt;- mice(mtcars.catmcar, method = "rfpred.cate", m = 5, maxit = 5,
maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE)

</code></pre>

<hr>
<h2 id='mice.impute.rfpred.emp'>Univariate sampler function for continuous variables using the empirical
error distributions</h2><span id='topic+mice.impute.rfpred.emp'></span>

<h3>Description</h3>

<p>Please note that functions with names starting with &quot;mice.impute&quot; are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p>For continuous variables only.
</p>
<p>This function is for <code>RfPred.Emp</code> multiple imputation method, adapter
for <code>mice</code> samplers. In the <code>mice()</code> function, set
<code>method = "rfpred.emp"</code> to call it.
</p>
<p>The function performs multiple imputation based on the empirical distribution
of out-of-bag prediction errors of random forests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.rfpred.emp(
  y,
  ry,
  x,
  wy = NULL,
  num.trees.cont = 10,
  sym.dist = TRUE,
  alpha.emp = 0,
  pre.boot = TRUE,
  num.threads = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.rfpred.emp_+3A_y">y</code></td>
<td>
<p>Vector to be imputed.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_ry">ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_x">x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_wy">wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_num.trees.cont">num.trees.cont</code></td>
<td>
<p>Number of trees to build for continuous variables.
The default is <code>num.trees = 10</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_sym.dist">sym.dist</code></td>
<td>
<p>If <code>TRUE</code>, the empirical distribution of out-of-bag
prediction errors will be assumed to be symmetric; if <code>FALSE</code>, the
empirical distribution will be kept intact. The default is
<code>sym.dist = TRUE</code>.
This option is invalid when <code>emp.err.cont = FALSE</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_alpha.emp">alpha.emp</code></td>
<td>
<p>The &quot;significance level&quot; for the empirical distribution of
out-of-bag prediction errors, can be used for prevention for outliers
(useful for highly skewed variables).
For example, set alpha = 0.05 to use 95% confidence level.
The default is <code>alpha.emp = 0.0</code>, and the empirical distribution of
out-of-bag prediction errors will be kept intact.
This option is invalid when <code>emp.err.cont = FALSE</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_pre.boot">pre.boot</code></td>
<td>
<p>If <code>TRUE</code>, bootstrapping prior to imputation will be
performed to perform 'proper' multiple imputation, for accommodating sampling
variation in estimating population regression parameters
(see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_num.threads">num.threads</code></td>
<td>
<p>Number of threads for parallel computing. The default is
<code>num.threads = NULL</code> and all the processors available can be used.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.emp_+3A_num.trees">num.trees</code></td>
<td>
<p>Number of trees to build. The default is
<code>num.trees = 10</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>RfPred.Emp</code> imputation sampler.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Hong, Shangzhi, et al. &quot;Multiple imputation using chained random forests.&quot;
Preprint, submitted April 30, 2020. https://arxiv.org/abs/2004.14823.
</p>
<p>Zhang, Haozhe, et al. &quot;Random Forest Prediction Intervals.&quot;
The American Statistician (2019): 1-20.
</p>
<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>
<p>Malley, James D., et al. &quot;Probability machines.&quot; Methods of information
in medicine 51.01 (2012): 74-81.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Users can set method = "rfpred.emp" in call to mice to use this method
data("airquality")
impObj &lt;- mice(airquality, method = "rfpred.emp", m = 5,
maxit = 5, maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE)

</code></pre>

<hr>
<h2 id='mice.impute.rfpred.norm'>Univariate sampler function for continuous variables for prediction-based
imputation, assuming normality for prediction errors of random forest</h2><span id='topic+mice.impute.rfpred.norm'></span>

<h3>Description</h3>

<p>Please note that functions with names starting with &quot;mice.impute&quot; are
exported to be visible for the mice sampler functions. Please do not call
these functions directly unless you know exactly what you are doing.
</p>
<p>For continuous variables only.
</p>
<p>This function is for <code>RfPred.Norm</code>
multiple imputation method, adapter for <code>mice</code> samplers.
In the <code>mice()</code> function, set <code>method = "rfpred.norm"</code> to call it.
</p>
<p>The function performs multiple imputation based on normality assumption using
out-of-bag mean squared error as the estimate for the variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mice.impute.rfpred.norm(
  y,
  ry,
  x,
  wy = NULL,
  num.trees.cont = 10,
  norm.err.cont = TRUE,
  alpha.oob = 0,
  pre.boot = TRUE,
  num.threads = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mice.impute.rfpred.norm_+3A_y">y</code></td>
<td>
<p>Vector to be imputed.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_ry">ry</code></td>
<td>
<p>Logical vector of length <code>length(y)</code> indicating the
the subset <code>y[ry]</code> of elements in <code>y</code> to which the imputation
model is fitted. The <code>ry</code> generally distinguishes the observed
(<code>TRUE</code>) and missing values (<code>FALSE</code>) in <code>y</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_x">x</code></td>
<td>
<p>Numeric design matrix with <code>length(y)</code> rows with predictors for
<code>y</code>. Matrix <code>x</code> may have no missing values.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_wy">wy</code></td>
<td>
<p>Logical vector of length <code>length(y)</code>. A <code>TRUE</code> value
indicates locations in <code>y</code> for which imputations are created.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_num.trees.cont">num.trees.cont</code></td>
<td>
<p>Number of trees to build for continuous variables.
The default is <code>num.trees = 10</code>.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_norm.err.cont">norm.err.cont</code></td>
<td>
<p>Use normality assumption for prediction errors of random
forests. The default is <code>norm.err.cont = TRUE</code>, and normality will be
assumed for the distribution for the prediction errors, the variance estimate
equals to overall out-of-bag prediction error, i.e. out-of-bag mean squared
error (see Shah et al. 2014). If <code>FALSE</code>, then the predictions of random
forest are used.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_alpha.oob">alpha.oob</code></td>
<td>
<p>The &quot;significance level&quot; for individual out-of-bag
prediction errors used for the calculation for out-of-bag mean squared error,
useful when presence of extreme values.
For example, set alpha = 0.05 to use 95% confidence level.
The default is <code>alpha.oob = 0.0</code>, and all the individual out-of-bag
prediction errors will be kept intact.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_pre.boot">pre.boot</code></td>
<td>
<p>If <code>TRUE</code>, bootstrapping prior to imputation will be
performed to perform 'proper' multiple imputation, for accommodating sampling
variation in estimating population regression parameters
(see Shah et al. 2014).
It should be noted that if <code>TRUE</code>, this option is in effect even if the
number of trees is set to one.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_num.threads">num.threads</code></td>
<td>
<p>Number of threads for parallel computing. The default is
<code>num.threads = NULL</code> and all the processors available can be used.</p>
</td></tr>
<tr><td><code id="mice.impute.rfpred.norm_+3A_...">...</code></td>
<td>
<p>Other arguments to pass down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>RfPred.Norm</code> imputation sampler.
</p>


<h3>Value</h3>

<p>Vector with imputed data, same type as <code>y</code>, and of length
<code>sum(wy)</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>References</h3>

<p>Shah, Anoop D., et al. &quot;Comparison of random forest and parametric
imputation models for imputing missing data using MICE: a CALIBER study.&quot;
American journal of epidemiology 179.6 (2014): 764-774.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Users can set method = "rfpred.norm" in call to mice to use this method
data("airquality")
impObj &lt;- mice(airquality, method = "rfpred.norm", m = 5,
maxit = 5, maxcor = 1.0, eps = 0,
remove.collinear = FALSE, remove.constant = FALSE,
printFlag = FALSE)

</code></pre>

<hr>
<h2 id='query.rf.pred.idx'>Identify corresponding observations indexes under the terminal nodes for a
random forest model by <code>ranger</code></h2><span id='topic+query.rf.pred.idx'></span>

<h3>Description</h3>

<p>The observation indexes (row numbers) constituting the terminal node
associated with each observation are queried using the <code>ranger</code> object
and the training data.
The parameter <code>keep.inbag = TRUE</code> should be applied to call to
<code>ranger</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>query.rf.pred.idx(obj, data, id.name = FALSE, unique.by.id = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="query.rf.pred.idx_+3A_obj">obj</code></td>
<td>
<p>An R object of class <code>ranger</code>.</p>
</td></tr>
<tr><td><code id="query.rf.pred.idx_+3A_data">data</code></td>
<td>
<p>Input for training data.</p>
</td></tr>
<tr><td><code id="query.rf.pred.idx_+3A_id.name">id.name</code></td>
<td>
<p>Use the IDs of the terminal nodes as names for the lists.</p>
</td></tr>
<tr><td><code id="query.rf.pred.idx_+3A_unique.by.id">unique.by.id</code></td>
<td>
<p>Only return results of unique terminal node IDs.</p>
</td></tr>
<tr><td><code id="query.rf.pred.idx_+3A_...">...</code></td>
<td>
<p>Other parameters (will be ignored).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observations are found based on terminal node IDs. It should be noted
that the out-of-bag observations are not present in the indexes.
</p>


<h3>Value</h3>

<p>A nested list of length <code>num.trees</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
rfObj &lt;- ranger(
    Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width + Species,
    data = iris, num.trees = 5, keep.inbag = TRUE)
outList &lt;- query.rf.pred.idx(rfObj, iris)

</code></pre>

<hr>
<h2 id='query.rf.pred.val'>Identify corresponding observed values for the response variable under the
terminal nodes for a random forest model by <code>ranger</code></h2><span id='topic+query.rf.pred.val'></span>

<h3>Description</h3>

<p>The observed values (for the response variable) constituting the terminal
node associated with each observation are queried using the <code>ranger</code>
object and the training data.
The parameter <code>keep.inbag = TRUE</code> should be applied to call to
<code>ranger</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>query.rf.pred.val(obj, data, id.name = FALSE, unique.by.id = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="query.rf.pred.val_+3A_obj">obj</code></td>
<td>
<p>An R object of class <code>ranger</code>.</p>
</td></tr>
<tr><td><code id="query.rf.pred.val_+3A_data">data</code></td>
<td>
<p>Input for training data.</p>
</td></tr>
<tr><td><code id="query.rf.pred.val_+3A_id.name">id.name</code></td>
<td>
<p>Use the IDs of the terminal nodes as names for the lists.</p>
</td></tr>
<tr><td><code id="query.rf.pred.val_+3A_unique.by.id">unique.by.id</code></td>
<td>
<p>Only return results of unique terminal node IDs.</p>
</td></tr>
<tr><td><code id="query.rf.pred.val_+3A_...">...</code></td>
<td>
<p>Other parameters (will be ignored).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observations are found based on terminal node IDs. It should be noted
that the out-of-bag observations are not present in the indexes.
</p>


<h3>Value</h3>

<p>A nested list of length <code>num.trees</code>.
</p>


<h3>Author(s)</h3>

<p>Shangzhi Hong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
rfObj &lt;- ranger(
    Sepal.Length ~ Sepal.Width + Petal.Length + Petal.Width + Species,
    data = iris, num.trees = 5, keep.inbag = TRUE)
outList &lt;- query.rf.pred.val(rfObj, iris)

</code></pre>

<hr>
<h2 id='rangerCallerSafe'>Remove unnecessary arguments for <code>ranger</code> function</h2><span id='topic+rangerCallerSafe'></span>

<h3>Description</h3>

<p>This function serves as an workaround for ranger function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rangerCallerSafe(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rangerCallerSafe_+3A_...">...</code></td>
<td>
<p>Parameters to pass down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructed <code>ranger</code> object.
</p>

<hr>
<h2 id='reg.ests'>Get regression estimates for pooled object</h2><span id='topic+reg.ests'></span>

<h3>Description</h3>

<p>Get the estimates with corresponding confidence intervals after pooling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.ests(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reg.ests_+3A_obj">obj</code></td>
<td>
<p>Pooled object from function <code>pool()</code>.</p>
</td></tr>
<tr><td><code id="reg.ests_+3A_...">...</code></td>
<td>
<p>Other parameters to pass down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing coefficient estimates and corresponding
confidence intervals.
</p>

<hr>
<h2 id='RfEmpImp-package'>RfEmpImp: Multiple Imputation using Chained Random Forests</h2><span id='topic+RfEmpImp'></span><span id='topic+RfEmpImp-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>An R package for multiple imputation using chained random forests. Implemented methods can handle missing data in mixed types of variables by using prediction-based or node-based conditional distributions constructed using random forests. For prediction-based imputation, the method based on the empirical distribution of out-of-bag prediction errors of random forests and the method based on normality assumption for prediction errors of random forests are provided for imputing continuous variables. And the method based on predicted probabilities is provided for imputing categorical variables. For node-based imputation, the method based on the conditional distribution formed by the predicting nodes of random forests, and the method based on proximity measures of random forests are provided. More details of the statistical methods can be found in Hong et al. (2020) <a href="https://arxiv.org/abs/2004.14823">arXiv:2004.14823</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Shangzhi Hong <a href="mailto:shangzhi-hong@hotmail.com">shangzhi-hong@hotmail.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Henry S. Lynn [thesis advisor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/shangzhi-hong/RfEmpImp">https://github.com/shangzhi-hong/RfEmpImp</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/shangzhi-hong/RfEmpImp/issues">https://github.com/shangzhi-hong/RfEmpImp/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
