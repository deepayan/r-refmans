<!DOCTYPE html><html><head><title>Help for package lnmCluster</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lnmCluster}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#initial_variational_gaussian'><p>Gives default initial guesses for logistic-normal multinomial biclustering algorithm.</p></a></li>
<li><a href='#initial_variational_lasso'><p>Gives default initial guesses for penalized logistic-normal multinomial Factor analyzer algorithm.</p></a></li>
<li><a href='#initial_variational_PGMM'><p>Gives default initial guesses for logistic-normal multinomial Factor analyzer algorithm.</p></a></li>
<li><a href='#lnmbiclust'><p>Logistic Normal Multinomial Biclustering algorithm</p></a></li>
<li><a href='#lnmfa'><p>Logistic Normal Multinomial factor analyzer algorithm</p></a></li>
<li><a href='#Mico_bi_jensens'><p>run main microbiome bicluster algorithm.</p></a></li>
<li><a href='#Mico_bi_lasso'><p>Penalized Logistic Normal Multinomial factor analyzer main estimation process</p></a></li>
<li><a href='#Mico_bi_PGMM'><p>run main microbiome Factor Analyzer algorithm.</p></a></li>
<li><a href='#model_selection'><p>Model selections for <code>lnmbicluster</code></p></a></li>
<li><a href='#model_selection_lasso'><p>Model selections for <code>plnmfa</code></p></a></li>
<li><a href='#model_selection_PGMM'><p>Model selections for <code>lnmfa</code></p></a></li>
<li><a href='#plnmfa'><p>Penalized Logistic Normal Multinomial factor analyzer algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Perform Logistic Normal Multinomial Clustering for Microbiome
Compositional Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wangshu Tu &lt;wangshu.tu@carleton.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of logistic normal multinomial (LNM) clustering. It is an extension of LNM mixture model proposed by Fang and Subedi (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2011.06682">doi:10.48550/arXiv.2011.06682</a>&gt;, and is designed for clustering compositional data. The package includes 3 extended models: LNM Factor Analyzer (LNM-FA), LNM Bicluster Mixture Model (LNM-BMM) and Penalized LNM Factor Analyzer (LNM-FA). There are several advantages of LNM models: 1. LNM provides more flexible covariance structure; 2. Factor analyzer can reduce the number of parameters to estimate; 3. Bicluster can simultaneously cluster subjects and taxa, and provides significant biological insights; 4. Penalty term allows sparse estimation in the covariance matrix. Details for model assumptions and interpretation can be found in papers: Tu and Subedi (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2101.01871">doi:10.48550/arXiv.2101.01871</a>&gt; and Tu and Subedi (2022) &lt;<a href="https://doi.org/10.1002%2Fsam.11555">doi:10.1002/sam.11555</a>&gt;.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>mclust, foreach, MASS, stringr, gtools, pgmm, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, mvtnorm</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.50)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-19 19:53:07 UTC; wangshutu</td>
</tr>
<tr>
<td>Author:</td>
<td>Wangshu Tu [aut, cre],
  Sanjeena Dang [aut],
  Yuan Fang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-20 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='initial_variational_gaussian'>Gives default initial guesses for logistic-normal multinomial biclustering algorithm.</h2><span id='topic+initial_variational_gaussian'></span>

<h3>Description</h3>

<p>Gives default initial guesses for logistic-normal multinomial biclustering algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial_variational_gaussian(W_count, G, Q_g, cov_str, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initial_variational_gaussian_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="initial_variational_gaussian_+3A_g">G</code></td>
<td>
<p>The number of component</p>
</td></tr>
<tr><td><code id="initial_variational_gaussian_+3A_q_g">Q_g</code></td>
<td>
<p>The number of biclusters for each component, a vector.</p>
</td></tr>
<tr><td><code id="initial_variational_gaussian_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 16 different models belongs to
this family:UUU, UUG, UUD, UUC, UGU, UGG, UGD, UGC, GUU, GUG, GUD, GUC, GGU, GGG, GGD, GGC.</p>
</td></tr>
<tr><td><code id="initial_variational_gaussian_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>new_pi_g</code> Initial guess of proportion
</p>
<p><code>new_mu_g</code> Initial guess of mean vector
</p>
<p><code>new_sig_g</code> Initial guess of covariance matrix for each component
</p>
<p><code>new_T_g</code> Initial guess of covariance of latent variable: u
</p>
<p><code>new_B_g</code> Initial guess of bicluster membership
</p>
<p><code>new_D_g</code> Initial guess of error matrix
</p>
<p><code>new_m</code> Initial guess of variational mean
</p>
<p><code>new_V</code> Initial guess of variational varaince
</p>
<p><code>new_beta_g</code> Initial guess of covariates coefficients.
</p>

<hr>
<h2 id='initial_variational_lasso'>Gives default initial guesses for penalized logistic-normal multinomial Factor analyzer algorithm.</h2><span id='topic+initial_variational_lasso'></span>

<h3>Description</h3>

<p>Gives default initial guesses for penalized logistic-normal multinomial Factor analyzer algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial_variational_lasso(W_count, G, Q_g, cov_str, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initial_variational_lasso_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="initial_variational_lasso_+3A_g">G</code></td>
<td>
<p>The number of component</p>
</td></tr>
<tr><td><code id="initial_variational_lasso_+3A_q_g">Q_g</code></td>
<td>
<p>A specific number of latent dimension.</p>
</td></tr>
<tr><td><code id="initial_variational_lasso_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 2 different models belongs to
this family:UUU, GUU.</p>
</td></tr>
<tr><td><code id="initial_variational_lasso_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>new_pi_g</code> Initial guess of proportion
</p>
<p><code>new_mu_g</code> Initial guess of mean vector
</p>
<p><code>new_sig_g</code> Initial guess of covariance matrix for each component
</p>
<p><code>new_B_g</code> Initial guess of loading matrix.
</p>
<p><code>new_T_g</code> The identity matrix of latent variable: u
</p>
<p><code>new_D_g</code> Initial guess of error matrix
</p>
<p><code>new_m</code> Initial guess of variational mean
</p>
<p><code>new_V</code> Initial guess of variational varaince
</p>
<p><code>new_beta_g</code> Initial guess of covariates coefficients.
</p>

<hr>
<h2 id='initial_variational_PGMM'>Gives default initial guesses for logistic-normal multinomial Factor analyzer algorithm.</h2><span id='topic+initial_variational_PGMM'></span>

<h3>Description</h3>

<p>Gives default initial guesses for logistic-normal multinomial Factor analyzer algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial_variational_PGMM(W_count, G, Q_g, cov_str, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initial_variational_PGMM_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="initial_variational_PGMM_+3A_g">G</code></td>
<td>
<p>The number of component</p>
</td></tr>
<tr><td><code id="initial_variational_PGMM_+3A_q_g">Q_g</code></td>
<td>
<p>The number of latent dimensions for each component, a vector.</p>
</td></tr>
<tr><td><code id="initial_variational_PGMM_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 8 different models belongs to
this family:UUU, UUG, UUD, UUC, GUU, GUG, GUD, GUC.</p>
</td></tr>
<tr><td><code id="initial_variational_PGMM_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>new_pi_g</code> Initial guess of proportion
</p>
<p><code>new_mu_g</code> Initial guess of mean vector
</p>
<p><code>new_sig_g</code> Initial guess of covariance matrix for each component
</p>
<p><code>new_B_g</code> Initial guess of loading matrix.
</p>
<p><code>new_T_g</code> The identity matrix of latent variable: u
</p>
<p><code>new_D_g</code> Initial guess of error matrix
</p>
<p><code>new_m</code> Initial guess of variational mean
</p>
<p><code>new_V</code> Initial guess of variational varaince
</p>
<p><code>new_beta_g</code> Initial guess of covariates coefficients.
</p>

<hr>
<h2 id='lnmbiclust'>Logistic Normal Multinomial Biclustering algorithm</h2><span id='topic+lnmbiclust'></span>

<h3>Description</h3>

<p>Main function that can do LNM biclustering and select the best model based on BIC, AIC or ICL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnmbiclust(W_count, range_G, range_Q, model, criteria, iter, permutation, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lnmbiclust_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_range_g">range_G</code></td>
<td>
<p>All possible number of components. A vector.</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_range_q">range_Q</code></td>
<td>
<p>All possible number of bicluster for each component. A vector</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_model">model</code></td>
<td>
<p>The covaraince structure you choose, there are 16 different models belongs to
this family:UUU, UUG, UUD, UUC, UGU, UGG, UGD, UGC, GUU, GUG, GUD, GUC, GGU, GGG, GGD, GGC. You can
choose more than 1 covarance structure to do model selection.</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_criteria">criteria</code></td>
<td>
<p>one of AIC, BIC or ICL. The best model is depends on the criteria you choose. The default is BIC</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_iter">iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_permutation">permutation</code></td>
<td>
<p>Only has effect when model contains UUU, UUG, UUD or UUC. If TRUE,
it assume the number of biclusters could be different for different components. If FALSE,
it assume the number of biclusters are the same cross all components. Default is FALSE.</p>
</td></tr>
<tr><td><code id="lnmbiclust_+3A_x">X</code></td>
<td>
<p>The regression covariate matrix, which is generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated bicluster membership
</p>
<p>T_g Estimated covariance of latent variable u
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated sparsity component covariance
</p>
<p>beta_g Estimated covariate coefficients
</p>
<p>sigma Estimated original component covariance
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>
<p>all_fitted_model display all names of fitted models in a data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate toy data with n=100, K=5,
#set up parameters
n&lt;-100
p&lt;-5
mu1&lt;-c(-2.8,-1.3,-1.6,-3.9,-2.6)
B1&lt;-matrix(c(1,0,1,0,1,0,0,1,0,1),nrow = p, byrow=TRUE)
T1&lt;-diag(c(2.9,0.5))
D1&lt;-diag(c(0.52, 1.53, 0.56, 0.19, 1.32))
cov1&lt;-B1%*%T1%*%t(B1)+D1
mu2&lt;-c(1.5,-2.7,-1.1,-0.4,-1.4)
B2&lt;-matrix(c(1,0,1,0,0,1,0,1,0,1),nrow = p, byrow=TRUE)
T2&lt;-diag(c(0.2,0.003))
D2&lt;-diag(c(0.01, 0.62, 0.45, 0.01, 0.37))
cov2&lt;-B2%*%T2%*%t(B2)+D2

#generate normal distribution
library(mvtnorm)
simp&lt;-rmultinom(n,1,c(0.6,0.4))
lab&lt;-as.factor(apply(t(simp),1,which.max))
df&lt;-matrix(0,nrow=n,ncol=p)
for (i in 1:n) {
 if(lab[i]==1){df[i,]&lt;-rmvnorm(1,mu1,sigma = cov1)}
 else if(lab[i]==2){df[i,]&lt;-rmvnorm(1,mu2,sigma = cov2)}
}
#apply inverse of additive log ratio and transform normal to count data
f_df&lt;-cbind(df,0)
z&lt;-exp(f_df)/rowSums(exp(f_df))
W_count&lt;-matrix(0,nrow=n,ncol=p+1)
for (i in 1:n) {
 W_count[i,]&lt;-rmultinom(1,runif(1,10000,20000),z[i,])
}

#'#if run one model let range_Q be an integer
res&lt;-lnmbiclust(W_count,2,2,model="UUU")

#following will run 2 combinations of Q: 2 2, and 3 3 with G=2.
res&lt;-lnmbiclust(W_count,2,range_Q=c(2:3),model="UUU")

#if run model selection let range_Q and range_G be a vector.
#model selection for all 16 models with G=1 to 3, Q=1 to 3.
res&lt;-lnmbiclust(W_count,c(1:3),c(1:3))





</code></pre>

<hr>
<h2 id='lnmfa'>Logistic Normal Multinomial factor analyzer algorithm</h2><span id='topic+lnmfa'></span>

<h3>Description</h3>

<p>Main function that can do LNM factor analyzer and select the best model based on BIC, AIC or ICL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnmfa(W_count, range_G, range_Q, model, criteria, iter, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lnmfa_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_range_g">range_G</code></td>
<td>
<p>All possible number of components. A vector.</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_range_q">range_Q</code></td>
<td>
<p>All possible number of bicluster for each component. A vector</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_model">model</code></td>
<td>
<p>The covaraince structure you choose, there are 8 different models belongs to
this family:UUU, UUG, UUD, UUC, GUU, GUG, GUD, GUC. You can
choose more than 1 covarance structure to do model selection.</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_criteria">criteria</code></td>
<td>
<p>one of AIC, BIC or ICL. The best model is depends on the criteria you choose. The default is BIC</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_iter">iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td></tr>
<tr><td><code id="lnmfa_+3A_x">X</code></td>
<td>
<p>The regression covariate matrix, which is generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated bicluster membership
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated component covariance
</p>
<p>beta_g Estimated covariate coefficients
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>
<p>all_fitted_model display all names of fitted models in a data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate toy data with n=100, K=5,
#set up parameters
n&lt;-100
p&lt;-5
mu1&lt;-c(-2.8,-1.3,-1.6,-3.9,-2.6)
B1&lt;-matrix(c(1,0,1,0,1,0,0,1,0,1),nrow = p, byrow=TRUE)
T1&lt;-diag(c(2.9,0.5))
D1&lt;-diag(c(0.52, 1.53, 0.56, 0.19, 1.32))
cov1&lt;-B1%*%T1%*%t(B1)+D1
mu2&lt;-c(1.5,-2.7,-1.1,-0.4,-1.4)
B2&lt;-matrix(c(1,0,1,0,0,1,0,1,0,1),nrow = p, byrow=TRUE)
T2&lt;-diag(c(0.2,0.003))
D2&lt;-diag(c(0.01, 0.62, 0.45, 0.01, 0.37))
cov2&lt;-B2%*%T2%*%t(B2)+D2

#generate normal distribution
library(mvtnorm)
simp&lt;-rmultinom(n,1,c(0.6,0.4))
lab&lt;-as.factor(apply(t(simp),1,which.max))
df&lt;-matrix(0,nrow=n,ncol=p)
for (i in 1:n) {
 if(lab[i]==1){df[i,]&lt;-rmvnorm(1,mu1,sigma = cov1)}
 else if(lab[i]==2){df[i,]&lt;-rmvnorm(1,mu2,sigma = cov2)}
}
#apply inverse of additive log ratio and transform normal to count data
f_df&lt;-cbind(df,0)
z&lt;-exp(f_df)/rowSums(exp(f_df))
W_count&lt;-matrix(0,nrow=n,ncol=p+1)
for (i in 1:n) {
 W_count[i,]&lt;-rmultinom(1,runif(1,10000,20000),z[i,])
}

#'#if run one model let range_Q be an integer
res&lt;-lnmfa(W_count,2,2,model="UUU")

#following will run 2 combinations of Q: 2 2, and 3 3 with G=2.
res&lt;-lnmfa(W_count,2,range_Q=c(2:3),model="UUU")

#if run model selection let range_Q and range_G be a vector.
#model selection for all 16 models with G=1 to 3, Q=1 to 3.
res&lt;-lnmfa(W_count,c(1:3),c(1:3))






</code></pre>

<hr>
<h2 id='Mico_bi_jensens'>run main microbiome bicluster algorithm.</h2><span id='topic+Mico_bi_jensens'></span>

<h3>Description</h3>

<p>run main microbiome bicluster algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mico_bi_jensens(
  W_count,
  G,
  Q_g,
  pi_g,
  mu_g,
  sig_g,
  V,
  m,
  B_g,
  T_g,
  D_g,
  cov_str,
  iter,
  const,
  beta_g,
  X
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Mico_bi_jensens_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_g">G</code></td>
<td>
<p>The number of component</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_q_g">Q_g</code></td>
<td>
<p>The number of biclusters for each component, a vector.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_pi_g">pi_g</code></td>
<td>
<p>A vector of initial guesses of component proportion</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_mu_g">mu_g</code></td>
<td>
<p>A list of initial guess of mean vector</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_sig_g">sig_g</code></td>
<td>
<p>A list of initial guess of covariance matrix for each component</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_v">V</code></td>
<td>
<p>A list of initial guess of variational varaince</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_m">m</code></td>
<td>
<p>A list of initial guess of variational mean</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_b_g">B_g</code></td>
<td>
<p>A list of initial guess of bicluster membership</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_t_g">T_g</code></td>
<td>
<p>A list of initial guess of covariance of latent variable: u</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_d_g">D_g</code></td>
<td>
<p>A list of initial guess of error matrix</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 16 different models belongs to
this family:UUU, UUG, UUD, UUC, UGU, UGG, UGD, UGC, GUU, GUG, GUD, GUC, GGU, GGG, GGD, GGC.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_iter">iter</code></td>
<td>
<p>Max iterations, default is 150.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_const">const</code></td>
<td>
<p>the permutation constant in multinomial distribution. Calculated before the main
algorithm in order to save computation time.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_beta_g">beta_g</code></td>
<td>
<p>initial guess of covariates coefficients.</p>
</td></tr>
<tr><td><code id="Mico_bi_jensens_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated bicluster membership
</p>
<p>T_g Estimated covariance of latent variable u
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated sparsity component covariance
</p>
<p>beta_g Estimated covariates coefficients.
</p>
<p>sigma Estimated original component covariance
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>

<hr>
<h2 id='Mico_bi_lasso'>Penalized Logistic Normal Multinomial factor analyzer main estimation process</h2><span id='topic+Mico_bi_lasso'></span>

<h3>Description</h3>

<p>Main function will perform PLNM factor analyzer and return parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mico_bi_lasso(
  W_count,
  G,
  Q_g,
  pi_g,
  mu_g,
  sig_g,
  V,
  m,
  B_K,
  T_K,
  D_K,
  cov_str,
  tuning,
  iter,
  const,
  beta_g,
  X
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Mico_bi_lasso_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_g">G</code></td>
<td>
<p>All possible number of components. A vector.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_q_g">Q_g</code></td>
<td>
<p>A specific number of latent dimension.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_pi_g">pi_g</code></td>
<td>
<p>A vector of initial guesses of component proportion</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_mu_g">mu_g</code></td>
<td>
<p>A list of initial guess of mean vector</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_sig_g">sig_g</code></td>
<td>
<p>A list of initial guess of covariance matrix for each component</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_v">V</code></td>
<td>
<p>A list of initial guess of variational varaince</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_m">m</code></td>
<td>
<p>A list of initial guess of variational mean</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_b_k">B_K</code></td>
<td>
<p>A list of initial guess of loading matrix.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_t_k">T_K</code></td>
<td>
<p>A list of identity matrix with dimension q.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_d_k">D_K</code></td>
<td>
<p>A list of initial guess of error matrix</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 2 different models belongs to
this family:UUU and GUU. You can choose more than 1 covarance structure to do model selection.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_tuning">tuning</code></td>
<td>
<p>length G vector with range 0-1, define the tuning parameter for each component</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_iter">iter</code></td>
<td>
<p>Max iterations, default is 150.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_const">const</code></td>
<td>
<p>the permutation constant in multinomial distribution. Calculated before the main
algorithm in order to save computation time.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_beta_g">beta_g</code></td>
<td>
<p>initial guess of covariates coefficients.</p>
</td></tr>
<tr><td><code id="Mico_bi_lasso_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated sparsity loading matrix
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated component covariance
</p>
<p>beta_g Estimated covariates coefficients.
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>
<p>tuning display the tuning parameter you specified.
</p>

<hr>
<h2 id='Mico_bi_PGMM'>run main microbiome Factor Analyzer algorithm.</h2><span id='topic+Mico_bi_PGMM'></span>

<h3>Description</h3>

<p>run main microbiome Factor Analyzer algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mico_bi_PGMM(
  W_count,
  G,
  Q_g,
  pi_g,
  mu_g,
  sig_g,
  V,
  m,
  B_K,
  T_K,
  D_K,
  cov_str,
  iter,
  const,
  beta_g,
  X
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Mico_bi_PGMM_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_g">G</code></td>
<td>
<p>The number of component</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_q_g">Q_g</code></td>
<td>
<p>The number of latent dimensions for each component, a vector.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_pi_g">pi_g</code></td>
<td>
<p>A vector of initial guesses of component proportion</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_mu_g">mu_g</code></td>
<td>
<p>A list of initial guess of mean vector</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_sig_g">sig_g</code></td>
<td>
<p>A list of initial guess of covariance matrix for each component</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_v">V</code></td>
<td>
<p>A list of initial guess of variational varaince</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_m">m</code></td>
<td>
<p>A list of initial guess of variational mean</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_b_k">B_K</code></td>
<td>
<p>A list of initial guess of loading matrix.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_t_k">T_K</code></td>
<td>
<p>A list of identity matrix with dimension q.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_d_k">D_K</code></td>
<td>
<p>A list of initial guess of error matrix</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_cov_str">cov_str</code></td>
<td>
<p>The covaraince structure you choose, there are 8 different models belongs to
this family:UUU, UUG, UUD, UUC, GUU, GUG, GUD, GUC.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_iter">iter</code></td>
<td>
<p>Max iterations, default is 150.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_const">const</code></td>
<td>
<p>the permutation constant in multinomial distribution. Calculated before the main
algorithm in order to save computation time.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_beta_g">beta_g</code></td>
<td>
<p>initial guess of covariates coefficients.</p>
</td></tr>
<tr><td><code id="Mico_bi_PGMM_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated loading matix.
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated component covariance
</p>
<p>beta_g Estimated covariates coefficients.
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>

<hr>
<h2 id='model_selection'>Model selections for <code>lnmbicluster</code></h2><span id='topic+model_selection'></span>

<h3>Description</h3>

<p>fit several models for lnmbicluster along with 3 criteria values: AIC BIC and ICL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_selection(W_count, range_G, range_Q, model, permutation, iter, const, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_selection_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_range_g">range_G</code></td>
<td>
<p>All possible number of component groups, a vector.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_range_q">range_Q</code></td>
<td>
<p>All possible number of bicluster groups Q, a vector.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_model">model</code></td>
<td>
<p>A vector of string that contain cov_str you want to select. Default is all 16 models.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_permutation">permutation</code></td>
<td>
<p>Only has effect when model contains UUU, UUG, UUD or UUC. If TRUE,
it assume the number of biclusters could be different for different components. If FALSE,
it assume the number of biclusters are the same cross all components.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_iter">iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_const">const</code></td>
<td>
<p>Constant permutation term in multinomial distribution.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates from model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that contain the cov_str, K, Q, AIC, BIC, ICL values for model. There may
be a lot rows if large K and Q, because of lots of combinations: it is a sum of a geometric
series with multiplier max(Q) from 1 to max(K).
</p>

<hr>
<h2 id='model_selection_lasso'>Model selections for <code>plnmfa</code></h2><span id='topic+model_selection_lasso'></span>

<h3>Description</h3>

<p>fit several models for plnmfa along with 3 criteria values: AIC BIC and ICL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_selection_lasso(W_count, K, Q_K, model, range_tuning, iter, const, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_selection_lasso_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_k">K</code></td>
<td>
<p>A specific number of component</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_q_k">Q_K</code></td>
<td>
<p>A specific number of latent dimension.</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_model">model</code></td>
<td>
<p>A specific model name, UUU or GUU</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_range_tuning">range_tuning</code></td>
<td>
<p>A range of tuning parameters specified, ranged from 0-1.</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_iter">iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_const">const</code></td>
<td>
<p>Constant permutation term in multinomial distribution.</p>
</td></tr>
<tr><td><code id="model_selection_lasso_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates from model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that contain the cov_str, K, Q, AIC, BIC, ICL values for model. There may
be a lot rows if long range of tuning parameters.
</p>

<hr>
<h2 id='model_selection_PGMM'>Model selections for <code>lnmfa</code></h2><span id='topic+model_selection_PGMM'></span>

<h3>Description</h3>

<p>fit several models for lnmfa along with 3 criteria values: AIC BIC and ICL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_selection_PGMM(
  W_count,
  range_G,
  range_Q,
  model,
  permutation,
  iter,
  const,
  X
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_selection_PGMM_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix that you want to analyze.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_range_g">range_G</code></td>
<td>
<p>All possible number of component groups, a vector.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_range_q">range_Q</code></td>
<td>
<p>All possible number of bicluster groups Q, a vector.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_model">model</code></td>
<td>
<p>A vector of string that contain cov_str you want to select. Default is all 8 models.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_permutation">permutation</code></td>
<td>
<p>Only has effect when model contains UUU, UUG, UUD or UUC. If TRUE,
it assume the number of latent dimension could be different for different components. If FALSE,
it assume the number of latent dimension are the same cross all components.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_iter">iter</code></td>
<td>
<p>Max iterations, defaul is 150.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_const">const</code></td>
<td>
<p>Constant permutation term in multinomial distribution.</p>
</td></tr>
<tr><td><code id="model_selection_PGMM_+3A_x">X</code></td>
<td>
<p>The regression covariates matrix, which generates from model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe that contain the cov_str, K, Q, AIC, BIC, ICL values for model. There may
be a lot rows if large K and Q, because of lots of combinations: it is a sum of a geometric
series with multiplier max(Q) from 1 to max(K).
</p>

<hr>
<h2 id='plnmfa'>Penalized Logistic Normal Multinomial factor analyzer algorithm</h2><span id='topic+plnmfa'></span>

<h3>Description</h3>

<p>Main function that can do PLNM factor analyzer and select the best model based on BIC, AIC or ICL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plnmfa(W_count, range_G, range_Q, model, criteria, range_tuning, iter, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plnmfa_+3A_w_count">W_count</code></td>
<td>
<p>The microbiome count matrix</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_range_g">range_G</code></td>
<td>
<p>All possible number of components. A vector.</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_range_q">range_Q</code></td>
<td>
<p>A specific number of latent dimension.</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_model">model</code></td>
<td>
<p>The covaraince structure you choose, there are 2 different models belongs to
this family:UUU and GUU. You can choose more than 1 covarance structure to do model selection.</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_criteria">criteria</code></td>
<td>
<p>one of AIC, BIC or ICL. The best model is depends on the criteria you choose. The default is BIC</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_range_tuning">range_tuning</code></td>
<td>
<p>A range of tuning parameters specified, ranged from 0-1.</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_iter">iter</code></td>
<td>
<p>Max iterations, default is 150.</p>
</td></tr>
<tr><td><code id="plnmfa_+3A_x">X</code></td>
<td>
<p>The regression covariate matrix, which is generated by model.matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>z_ig Estimated latent variable z
</p>
<p>cluster Component labels
</p>
<p>mu_g Estimated component mean
</p>
<p>pi_g Estimated component proportion
</p>
<p>B_g Estimated bicluster membership
</p>
<p>D_g Estimated error covariance
</p>
<p>COV Estimated component covariance
</p>
<p>beta_g Estimated covariate coefficients
</p>
<p>overall_loglik Complete log likelihood value for each iteration
</p>
<p>ICL ICL value
</p>
<p>BIC BIC value
</p>
<p>AIC AIC value
</p>
<p>all_fitted_model display all names of fitted models in a data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#'#generate toy data with n=100, K=5,
#set up parameters
n&lt;-100
p&lt;-5
mu1&lt;-c(-2.8,-1.3,-1.6,-3.9,-2.6)
B1&lt;-matrix(c(1,0,1,0,1,0,0,1,0,1),nrow = p, byrow=TRUE)
T1&lt;-diag(c(2.9,0.5))
D1&lt;-diag(c(0.52, 1.53, 0.56, 0.19, 1.32))
cov1&lt;-B1%*%T1%*%t(B1)+D1
mu2&lt;-c(1.5,-2.7,-1.1,-0.4,-1.4)
B2&lt;-matrix(c(1,0,1,0,0,1,0,1,0,1),nrow = p, byrow=TRUE)
T2&lt;-diag(c(0.2,0.003))
D2&lt;-diag(c(0.01, 0.62, 0.45, 0.01, 0.37))
cov2&lt;-B2%*%T2%*%t(B2)+D2

#generate normal distribution
library(mvtnorm)
simp&lt;-rmultinom(n,1,c(0.6,0.4))
lab&lt;-as.factor(apply(t(simp),1,which.max))
df&lt;-matrix(0,nrow=n,ncol=p)
for (i in 1:n) {
 if(lab[i]==1){df[i,]&lt;-rmvnorm(1,mu1,sigma = cov1)}
 else if(lab[i]==2){df[i,]&lt;-rmvnorm(1,mu2,sigma = cov2)}
}
#apply inverse of additive log ratio and transform normal to count data
f_df&lt;-cbind(df,0)
z&lt;-exp(f_df)/rowSums(exp(f_df))
W_count&lt;-matrix(0,nrow=n,ncol=p+1)
for (i in 1:n) {
 W_count[i,]&lt;-rmultinom(1,runif(1,10000,20000),z[i,])
}

#if run one model let range_G, and range_tuning be an integer
#remember you can always overspecify Q, so we don't suggest to run models with a range of Q.
res&lt;-plnmfa(W_count,2,2,model="UUU",range_tuning=0.6)

#if run model selection let any \code{range_} parameters be a vector.
res&lt;-plnmfa(W_count,c(2:3),3,range_tuning=seq(0.5,0.8,by=0.1))






</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
