<!DOCTYPE html><html><head><title>Help for package PoisNor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PoisNor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PoisNor-package'>
<p>Simultaneous Generation of Multivariate Data with Poisson and Normal Marginals</p></a></li>
<li><a href='#cmat.star'>
<p>Computes the correlation of intermediate multivariate normal data before subsequent inverse CDF transformation</p></a></li>
<li><a href='#Cor.PN.Limit'>
<p>Finds the feasible correlation range for a pair of Poisson and normal variables</p></a></li>
<li><a href='#Cor.PP.Limit'>
<p>Finds the feasible correlation range for a pair of Poisson variables</p></a></li>
<li><a href='#genPoisNor'>
<p>Generates a data set with Poisson and normal variables</p></a></li>
<li><a href='#Valid.correlation'>
<p>Computes the lower and upper correlation bounds in the form of two matrices</p></a></li>
<li><a href='#Validate.correlation'>
<p>Checks the target correlation matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simultaneous Generation of Multivariate Data with Poisson and
Normal Marginals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Anup Amatya, Hakan Demirtas, Ran Gao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ran Gao &lt;rgao8@uic.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, corpcor, Matrix</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates multivariate data with count and continuous variables with a pre-specified correlation matrix. The count and continuous variables are assumed to have Poisson and normal marginals, respectively. The data generation mechanism is a combination of the normal to anything principle and a connection between Poisson and normal correlations in the mixture.
             The details of the method are explained in Yahav et al. (2012) &lt;<a href="https://doi.org/10.1002%2Fasmb.901">doi:10.1002/asmb.901</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-21 22:10:36 UTC; rangao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-21 22:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PoisNor-package'>
Simultaneous Generation of Multivariate Data with Poisson and Normal Marginals
</h2><span id='topic+PoisNor-package'></span><span id='topic+PoisNor'></span>

<h3>Description</h3>

<p>The package implements a procedure for simultaneous generation of multivariate data with count and continuous variables with a pre-specified correlation matrix. The count and continuous variables are assumed to have Poisson and normal marginals, respectively. The data generation mechanism is a combination of the normal to anything principle and a connection between Poisson and normal correlations in the mixture. Data generation is accomplished by first calculating an intermediate correlation matrix (<code><a href="#topic+cmat.star">cmat.star</a></code>) which is used to generate a sample from multivariate normal distribution. Then, the first few components (corresponding to number of Poisson variables) are transformed to Poisson variables via the inverse CDF method. The resulting data are composed of a mixture of Poisson and normal variables that conform with pre-specified marginal distributions and correlation structure.<br /><br />
The function <code><a href="#topic+Valid.correlation">Valid.correlation</a></code> returns the lower and upper bounds of the correlation coefficients of Poisson-Poisson and Poisson-normal pairs given their marginal distributions, i.e. returns the range of feasible pairwise correlations. The function <code><a href="#topic+Validate.correlation">Validate.correlation</a></code> checks the validity of the values of pairwise correlations. Additionally, it checks positive definiteness, symmetry and correctness of the dimensions. The engine function <code><a href="#topic+genPoisNor">genPoisNor</a></code> generates mixed data in accordance with the specified marginal and correlational quantities.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PoisNor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-03-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Anup Amatya, Hakan Demirtas, Ran Gao
</p>
<p>Maintainer: Ran Gao &lt;rgao8@uic.edu&gt;
</p>

<hr>
<h2 id='cmat.star'>
Computes the correlation of intermediate multivariate normal data before subsequent inverse CDF transformation
</h2><span id='topic+cmat.star'></span>

<h3>Description</h3>

<p>The function computes an intermediate correlation matrix which leads to the target correlation matrix after inverse CDF transformation of the samples generated from a multivariate normal distribution with the intermediate correlation matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmat.star(no.pois, no.norm, corMat, lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cmat.star_+3A_no.pois">no.pois</code></td>
<td>

<p>Number of Poisson variables in the data.
</p>
</td></tr>
<tr><td><code id="cmat.star_+3A_no.norm">no.norm</code></td>
<td>

<p>Number of normal variables in the data.
</p>
</td></tr>
<tr><td><code id="cmat.star_+3A_cormat">corMat</code></td>
<td>

<p>A positive definite target correlation matrix whose entries are within the valid limits.
</p>
</td></tr>
<tr><td><code id="cmat.star_+3A_lamvec">lamvec</code></td>
<td>

<p>Vector of Poisson rates (means).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An intermediate correlation matrix of size <code class="reqn">(no.pois + no.norm) \times (no.pois+ no.norm) </code>
</p>


<h3>References</h3>

<p>I. Yahav and G. Shmueli (2012). On generating multivariate poisson data in management science applications. <em>Applied Stochastic Models in Business and Industry</em>; 28(1):91-102.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Validate.correlation">Validate.correlation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lamvec= c(0.5,0.7,0.9)
M=c(0.352, 0.265, 0.342, 0.09, 0.141, 0.121, 0.297, 
  -0.022, 0.177, 0.294, -0.044, 0.129, 0.1, 0.354, 0.386)

N=diag(6)
N[lower.tri(N)]=M
TV=N+t(N)
diag(TV)&lt;-1

cstar = cmat.star(no.pois=3, no.norm=3, TV, lamvec)

## End(Not run)
</code></pre>

<hr>
<h2 id='Cor.PN.Limit'>
Finds the feasible correlation range for a pair of Poisson and normal variables
</h2><span id='topic+Cor.PN.Limit'></span>

<h3>Description</h3>

<p>The function computes the lower and upper bounds of a pairwise correlation between a Poisson and a normal variable via the method of Demirtas and Hedeker (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cor.PN.Limit(lam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cor.PN.Limit_+3A_lam">lam</code></td>
<td>

<p>A marginal rate for a Poisson variable of the pair.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two elements. The first element is the lower bound and the second element is the upper bound.
</p>


<h3>References</h3>

<p>Demirtas, H., Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. <em>The American Statistician</em>; 65(2):104-109.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cor.PN.Limit(0.05)

</code></pre>

<hr>
<h2 id='Cor.PP.Limit'>
Finds the feasible correlation range for a pair of Poisson variables
</h2><span id='topic+Cor.PP.Limit'></span>

<h3>Description</h3>

<p>The function computes the lower and upper bounds of a pairwise correlation between a pair of Poisson variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cor.PP.Limit(lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cor.PP.Limit_+3A_lamvec">lamvec</code></td>
<td>

<p>A vector of marginal rates for a pair of Poisson variables.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of two elements. The first element is the lower bound and the second element is the upper bound.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cor.PP.Limit(c(0.05, 0.07) )
</code></pre>

<hr>
<h2 id='genPoisNor'>
Generates a data set with Poisson and normal variables
</h2><span id='topic+genPoisNor'></span>

<h3>Description</h3>

<p>The function simulates multivariate data with Poisson and normal components with a pre-specified correlation matrix and marginal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genPoisNor(n, no.norm, no.pois, cmat.star, lamvec, sd.vec, mean.vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genPoisNor_+3A_n">n</code></td>
<td>

<p>Number of rows
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_no.pois">no.pois</code></td>
<td>

<p>Number of Poisson variables.
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_no.norm">no.norm</code></td>
<td>

<p>Number of normal variables.
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_cmat.star">cmat.star</code></td>
<td>

<p>The intermediate correlation matrix obtained from <code><a href="#topic+cmat.star">cmat.star</a></code> function.
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_lamvec">lamvec</code></td>
<td>

<p>A vector of marginal rates for Poisson variables.
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_mean.vec">mean.vec</code></td>
<td>

<p>A vector of means for the normal variables.
</p>
</td></tr>
<tr><td><code id="genPoisNor_+3A_sd.vec">sd.vec</code></td>
<td>

<p>A vector of standard deviations for the normal variables.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of size <code class="reqn">n \times (no.pois + no.norm)</code>, of which first <code>no.pois</code> are Poisson variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  lamvec= c(0.05,0.07,0.09)
  M=c(0.352, 0.265, 0.342, 0.09, 0.141, 0.121, 0.297, 
		-0.022, 0.177, 0.294, -0.044, 0.129, 0.1, 0.354, 0.386)
  N=diag(6)
  N[lower.tri(N)]=M
  TV=N+t(N)
  diag(TV)&lt;-1
  
  cstar = cmat.star(no.pois=3, no.norm=3, TV, lamvec)
  mydata=genPoisNor(n=200, no.norm=3,  no.pois=3, cmat.star=cstar,
		 lamvec, sd.vec=c(1,1,1), mean.vec=c(0,0,0))

## End(Not run)
</code></pre>

<hr>
<h2 id='Valid.correlation'>
Computes the lower and upper correlation bounds in the form of two matrices
</h2><span id='topic+Valid.correlation'></span>

<h3>Description</h3>

<p>The function computes the lower and upper bounds for the target correlations based on the marginal rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Valid.correlation(no.pois, no.norm, lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Valid.correlation_+3A_no.pois">no.pois</code></td>
<td>

<p>Number of Poisson variables.
</p>
</td></tr>
<tr><td><code id="Valid.correlation_+3A_no.norm">no.norm</code></td>
<td>

<p>Number of normal variables.
</p>
</td></tr>
<tr><td><code id="Valid.correlation_+3A_lamvec">lamvec</code></td>
<td>

<p>A vector of marginal rates for Poisson variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a list of two matrices. The <code>min</code> contains the lower bounds and the <code>max</code> contains the upper bounds of the feasible correlations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lamvec= c(0.05,0.07,0.09)
Valid.correlation(no.pois=3, no.norm=3,lamvec)

</code></pre>

<hr>
<h2 id='Validate.correlation'>
Checks the target correlation matrix
</h2><span id='topic+Validate.correlation'></span>

<h3>Description</h3>

<p>The function checks the validity of the values of pairwise correlations. Additionally, it checks positive definiteness, symmetry and correctness of the dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Validate.correlation(no.pois, no.norm, corMat, lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Validate.correlation_+3A_no.pois">no.pois</code></td>
<td>

<p>Number of Poisson variables.
</p>
</td></tr>
<tr><td><code id="Validate.correlation_+3A_no.norm">no.norm</code></td>
<td>

<p>Number of normal variables.
</p>
</td></tr>
<tr><td><code id="Validate.correlation_+3A_cormat">corMat</code></td>
<td>

<p>The target correlation matrix which must be positive definite and within the valid limits.
</p>
</td></tr>
<tr><td><code id="Validate.correlation_+3A_lamvec">lamvec</code></td>
<td>

<p>A vector of marginal rates for Poisson variables.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition to being positive definite and symmetric, the values of pairwise correlations in the target correlation matrix must also fall within the limits imposed by the marginal distributions in the system. The function ensures that the supplied correlation matrix is valid for simulation. If a violation occurs, an error message is displayed that identifies the violation. The function returns a logical value <code>TRUE</code> when no such violation occurs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# An example with a valid target correlation matrix.

lamvec= c(0.05,0.07,0.09)
M=c(0.352, 0.265, 0.342, 0.09, 0.141, 0.121, 0.297, 
	-0.022, 0.177, 0.294, -0.044, 0.129, 0.1, 0.354, 0.386)

N=diag(6)
N[lower.tri(N)]=M
TV=N+t(N)
diag(TV)&lt;-1

Validate.correlation(no.pois=3, no.norm=3, corMat=TV, lamvec)


# An example with an invalid target correlation matrix (bound violation).

lamvec= c(0.05,0.07,0.09)
M=c(-0.151, -0.085, -0.11, 0.29, 0.6, 0.132, 0.161, 0.139, 
	-0.088, 0.075, -0.025, -0.293, -0.67, -0.03, 0.61)
N=diag(6)
N[lower.tri(N)]=M
TV1=N+t(N)
diag(TV1)&lt;-1
Validate.correlation(no.pois=3, no.norm=3, corMat=TV1, lamvec)

# Examples with an incorrect dimension specification.

lamvec= c(0.05,0.07,0.09)
Validate.correlation(no.pois=3, no.norm=2, corMat=TV, lamvec)
Validate.correlation(no.pois=2, no.norm=3, corMat=TV, lamvec)

# An example with a non-positive definite correlation matrix.

TV1=TV
TV1[5,1]=TV1[1,5] = 1.5
Validate.correlation(no.pois=3, no.norm=3, corMat=TV1, lamvec)

# An example with a non-symmetric correlation matrix.

TV1=TV
TV1[5,1] = 0.1
Validate.correlation(no.pois=3, no.norm=3, corMat=TV1, lamvec)

# An example with an invalid diagonal element in the correlation matrix.

TV1=TV
TV1[5,5] = 2
Validate.correlation(no.pois=3, no.norm=3, corMat=TV1, lamvec)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
